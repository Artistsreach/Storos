function aO(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var bv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function o0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var lO={exports:{}},a0={},cO={exports:{}},on={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yg=Symbol.for("react.element"),Mq=Symbol.for("react.portal"),Lq=Symbol.for("react.fragment"),Fq=Symbol.for("react.strict_mode"),Oq=Symbol.for("react.profiler"),Vq=Symbol.for("react.provider"),$q=Symbol.for("react.context"),Uq=Symbol.for("react.forward_ref"),Bq=Symbol.for("react.suspense"),zq=Symbol.for("react.memo"),Gq=Symbol.for("react.lazy"),Rk=Symbol.iterator;function Wq(t){return t===null||typeof t!="object"?null:(t=Rk&&t[Rk]||t["@@iterator"],typeof t=="function"?t:null)}var uO={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dO=Object.assign,hO={};function wf(t,e,n){this.props=t,this.context=e,this.refs=hO,this.updater=n||uO}wf.prototype.isReactComponent={};wf.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};wf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function fO(){}fO.prototype=wf.prototype;function w1(t,e,n){this.props=t,this.context=e,this.refs=hO,this.updater=n||uO}var b1=w1.prototype=new fO;b1.constructor=w1;dO(b1,wf.prototype);b1.isPureReactComponent=!0;var jk=Array.isArray,mO=Object.prototype.hasOwnProperty,_1={current:null},pO={key:!0,ref:!0,__self:!0,__source:!0};function gO(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)mO.call(e,r)&&!pO.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:yg,type:t,key:i,ref:o,props:s,_owner:_1.current}}function Hq(t,e){return{$$typeof:yg,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function S1(t){return typeof t=="object"&&t!==null&&t.$$typeof===yg}function qq(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Dk=/\/+/g;function y_(t,e){return typeof t=="object"&&t!==null&&t.key!=null?qq(""+t.key):e.toString(36)}function Px(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case yg:case Mq:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+y_(o,0):r,jk(s)?(n="",t!=null&&(n=t.replace(Dk,"$&/")+"/"),Px(s,e,n,"",function(u){return u})):s!=null&&(S1(s)&&(s=Hq(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Dk,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",jk(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+y_(i,l);o+=Px(i,e,n,c,s)}else if(c=Wq(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+y_(i,l++),o+=Px(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function vy(t,e,n){if(t==null)return t;var r=[],s=0;return Px(t,r,"","",function(i){return e.call(n,i,s++)}),r}function Kq(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Zs={current:null},Ax={transition:null},Yq={ReactCurrentDispatcher:Zs,ReactCurrentBatchConfig:Ax,ReactCurrentOwner:_1};function yO(){throw Error("act(...) is not supported in production builds of React.")}on.Children={map:vy,forEach:function(t,e,n){vy(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return vy(t,function(){e++}),e},toArray:function(t){return vy(t,function(e){return e})||[]},only:function(t){if(!S1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};on.Component=wf;on.Fragment=Lq;on.Profiler=Oq;on.PureComponent=w1;on.StrictMode=Fq;on.Suspense=Bq;on.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yq;on.act=yO;on.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=dO({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=_1.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)mO.call(e,c)&&!pO.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:yg,type:t.type,key:s,ref:i,props:r,_owner:o}};on.createContext=function(t){return t={$$typeof:$q,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Vq,_context:t},t.Consumer=t};on.createElement=gO;on.createFactory=function(t){var e=gO.bind(null,t);return e.type=t,e};on.createRef=function(){return{current:null}};on.forwardRef=function(t){return{$$typeof:Uq,render:t}};on.isValidElement=S1;on.lazy=function(t){return{$$typeof:Gq,_payload:{_status:-1,_result:t},_init:Kq}};on.memo=function(t,e){return{$$typeof:zq,type:t,compare:e===void 0?null:e}};on.startTransition=function(t){var e=Ax.transition;Ax.transition={};try{t()}finally{Ax.transition=e}};on.unstable_act=yO;on.useCallback=function(t,e){return Zs.current.useCallback(t,e)};on.useContext=function(t){return Zs.current.useContext(t)};on.useDebugValue=function(){};on.useDeferredValue=function(t){return Zs.current.useDeferredValue(t)};on.useEffect=function(t,e){return Zs.current.useEffect(t,e)};on.useId=function(){return Zs.current.useId()};on.useImperativeHandle=function(t,e,n){return Zs.current.useImperativeHandle(t,e,n)};on.useInsertionEffect=function(t,e){return Zs.current.useInsertionEffect(t,e)};on.useLayoutEffect=function(t,e){return Zs.current.useLayoutEffect(t,e)};on.useMemo=function(t,e){return Zs.current.useMemo(t,e)};on.useReducer=function(t,e,n){return Zs.current.useReducer(t,e,n)};on.useRef=function(t){return Zs.current.useRef(t)};on.useState=function(t){return Zs.current.useState(t)};on.useSyncExternalStore=function(t,e,n){return Zs.current.useSyncExternalStore(t,e,n)};on.useTransition=function(){return Zs.current.useTransition()};on.version="18.3.1";cO.exports=on;var p=cO.exports;const ht=o0(p),l0=aO({__proto__:null,default:ht},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jq=p,Xq=Symbol.for("react.element"),Qq=Symbol.for("react.fragment"),Zq=Object.prototype.hasOwnProperty,eK=Jq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tK={key:!0,ref:!0,__self:!0,__source:!0};function xO(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Zq.call(e,r)&&!tK.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Xq,type:t,key:i,ref:o,props:s,_owner:eK.current}}a0.Fragment=Qq;a0.jsx=xO;a0.jsxs=xO;lO.exports=a0;var a=lO.exports,gC={},vO={exports:{}},Xi={},wO={exports:{}},bO={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,Y){var V=H.length;H.push(Y);e:for(;0<V;){var $=V-1>>>1,z=H[$];if(0<s(z,Y))H[$]=Y,H[V]=z,V=$;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var Y=H[0],V=H.pop();if(V!==Y){H[0]=V;e:for(var $=0,z=H.length,F=z>>>1;$<F;){var Z=2*($+1)-1,fe=H[Z],xe=Z+1,ge=H[xe];if(0>s(fe,V))xe<z&&0>s(ge,fe)?(H[$]=ge,H[xe]=V,$=xe):(H[$]=fe,H[Z]=V,$=Z);else if(xe<z&&0>s(ge,V))H[$]=ge,H[xe]=V,$=xe;else break e}}return Y}function s(H,Y){var V=H.sortIndex-Y.sortIndex;return V!==0?V:H.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,g=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(H){for(var Y=n(u);Y!==null;){if(Y.callback===null)r(u);else if(Y.startTime<=H)r(u),Y.sortIndex=Y.expirationTime,e(c,Y);else break;Y=n(u)}}function T(H){if(x=!1,C(H),!g)if(n(c)!==null)g=!0,W(R);else{var Y=n(u);Y!==null&&Q(T,Y.startTime-H)}}function R(H,Y){g=!1,x&&(x=!1,v(I),I=-1),m=!0;var V=f;try{for(C(Y),h=n(c);h!==null&&(!(h.expirationTime>Y)||H&&!j());){var $=h.callback;if(typeof $=="function"){h.callback=null,f=h.priorityLevel;var z=$(h.expirationTime<=Y);Y=t.unstable_now(),typeof z=="function"?h.callback=z:h===n(c)&&r(c),C(Y)}else r(c);h=n(c)}if(h!==null)var F=!0;else{var Z=n(u);Z!==null&&Q(T,Z.startTime-Y),F=!1}return F}finally{h=null,f=V,m=!1}}var A=!1,E=null,I=-1,P=5,k=-1;function j(){return!(t.unstable_now()-k<P)}function D(){if(E!==null){var H=t.unstable_now();k=H;var Y=!0;try{Y=E(!0,H)}finally{Y?M():(A=!1,E=null)}}else A=!1}var M;if(typeof _=="function")M=function(){_(D)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,B=G.port2;G.port1.onmessage=D,M=function(){B.postMessage(null)}}else M=function(){w(D,0)};function W(H){E=H,A||(A=!0,M())}function Q(H,Y){I=w(function(){H(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,W(R))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(H){switch(f){case 1:case 2:case 3:var Y=3;break;default:Y=f}var V=f;f=Y;try{return H()}finally{f=V}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,Y){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var V=f;f=H;try{return Y()}finally{f=V}},t.unstable_scheduleCallback=function(H,Y,V){var $=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?$+V:$):V=$,H){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=V+z,H={id:d++,callback:Y,priorityLevel:H,startTime:V,expirationTime:z,sortIndex:-1},V>$?(H.sortIndex=V,e(u,H),n(c)===null&&H===n(u)&&(x?(v(I),I=-1):x=!0,Q(T,V-$))):(H.sortIndex=z,e(c,H),g||m||(g=!0,W(R))),H},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(H){var Y=f;return function(){var V=f;f=Y;try{return H.apply(this,arguments)}finally{f=V}}}})(bO);wO.exports=bO;var nK=wO.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rK=p,qi=nK;function Qe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _O=new Set,wp={};function cd(t,e){Uh(t,e),Uh(t+"Capture",e)}function Uh(t,e){for(wp[t]=e,t=0;t<e.length;t++)_O.add(e[t])}var tl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yC=Object.prototype.hasOwnProperty,sK=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mk={},Lk={};function iK(t){return yC.call(Lk,t)?!0:yC.call(Mk,t)?!1:sK.test(t)?Lk[t]=!0:(Mk[t]=!0,!1)}function oK(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function aK(t,e,n,r){if(e===null||typeof e>"u"||oK(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ei(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ys={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ys[t]=new ei(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ys[e]=new ei(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ys[t]=new ei(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ys[t]=new ei(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ys[t]=new ei(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ys[t]=new ei(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ys[t]=new ei(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ys[t]=new ei(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ys[t]=new ei(t,5,!1,t.toLowerCase(),null,!1,!1)});var C1=/[\-:]([a-z])/g;function E1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(C1,E1);ys[e]=new ei(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(C1,E1);ys[e]=new ei(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(C1,E1);ys[e]=new ei(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ys[t]=new ei(t,1,!1,t.toLowerCase(),null,!1,!1)});ys.xlinkHref=new ei("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ys[t]=new ei(t,1,!1,t.toLowerCase(),null,!0,!0)});function T1(t,e,n,r){var s=ys.hasOwnProperty(e)?ys[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(aK(e,n,s,r)&&(n=null),r||s===null?iK(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var pl=rK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wy=Symbol.for("react.element"),Zd=Symbol.for("react.portal"),eh=Symbol.for("react.fragment"),I1=Symbol.for("react.strict_mode"),xC=Symbol.for("react.profiler"),SO=Symbol.for("react.provider"),CO=Symbol.for("react.context"),N1=Symbol.for("react.forward_ref"),vC=Symbol.for("react.suspense"),wC=Symbol.for("react.suspense_list"),P1=Symbol.for("react.memo"),Fl=Symbol.for("react.lazy"),EO=Symbol.for("react.offscreen"),Fk=Symbol.iterator;function Bf(t){return t===null||typeof t!="object"?null:(t=Fk&&t[Fk]||t["@@iterator"],typeof t=="function"?t:null)}var _r=Object.assign,x_;function ym(t){if(x_===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);x_=e&&e[1]||""}return`
`+x_+t}var v_=!1;function w_(t,e){if(!t||v_)return"";v_=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{v_=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ym(t):""}function lK(t){switch(t.tag){case 5:return ym(t.type);case 16:return ym("Lazy");case 13:return ym("Suspense");case 19:return ym("SuspenseList");case 0:case 2:case 15:return t=w_(t.type,!1),t;case 11:return t=w_(t.type.render,!1),t;case 1:return t=w_(t.type,!0),t;default:return""}}function bC(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case eh:return"Fragment";case Zd:return"Portal";case xC:return"Profiler";case I1:return"StrictMode";case vC:return"Suspense";case wC:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case CO:return(t.displayName||"Context")+".Consumer";case SO:return(t._context.displayName||"Context")+".Provider";case N1:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case P1:return e=t.displayName||null,e!==null?e:bC(t.type)||"Memo";case Fl:e=t._payload,t=t._init;try{return bC(t(e))}catch{}}return null}function cK(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return bC(e);case 8:return e===I1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function vc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function TO(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function uK(t){var e=TO(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function by(t){t._valueTracker||(t._valueTracker=uK(t))}function IO(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=TO(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function _v(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function _C(t,e){var n=e.checked;return _r({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ok(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=vc(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function NO(t,e){e=e.checked,e!=null&&T1(t,"checked",e,!1)}function SC(t,e){NO(t,e);var n=vc(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?CC(t,e.type,n):e.hasOwnProperty("defaultValue")&&CC(t,e.type,vc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Vk(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function CC(t,e,n){(e!=="number"||_v(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var xm=Array.isArray;function _h(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+vc(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function EC(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Qe(91));return _r({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function $k(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Qe(92));if(xm(n)){if(1<n.length)throw Error(Qe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:vc(n)}}function PO(t,e){var n=vc(e.value),r=vc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Uk(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function AO(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function TC(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?AO(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var _y,kO=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(_y=_y||document.createElement("div"),_y.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_y.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function bp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Om={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dK=["Webkit","ms","Moz","O"];Object.keys(Om).forEach(function(t){dK.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Om[e]=Om[t]})});function RO(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Om.hasOwnProperty(t)&&Om[t]?(""+e).trim():e+"px"}function jO(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=RO(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var hK=_r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function IC(t,e){if(e){if(hK[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Qe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Qe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Qe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Qe(62))}}function NC(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var PC=null;function A1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var AC=null,Sh=null,Ch=null;function Bk(t){if(t=wg(t)){if(typeof AC!="function")throw Error(Qe(280));var e=t.stateNode;e&&(e=f0(e),AC(t.stateNode,t.type,e))}}function DO(t){Sh?Ch?Ch.push(t):Ch=[t]:Sh=t}function MO(){if(Sh){var t=Sh,e=Ch;if(Ch=Sh=null,Bk(t),e)for(t=0;t<e.length;t++)Bk(e[t])}}function LO(t,e){return t(e)}function FO(){}var b_=!1;function OO(t,e,n){if(b_)return t(e,n);b_=!0;try{return LO(t,e,n)}finally{b_=!1,(Sh!==null||Ch!==null)&&(FO(),MO())}}function _p(t,e){var n=t.stateNode;if(n===null)return null;var r=f0(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Qe(231,e,typeof n));return n}var kC=!1;if(tl)try{var zf={};Object.defineProperty(zf,"passive",{get:function(){kC=!0}}),window.addEventListener("test",zf,zf),window.removeEventListener("test",zf,zf)}catch{kC=!1}function fK(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Vm=!1,Sv=null,Cv=!1,RC=null,mK={onError:function(t){Vm=!0,Sv=t}};function pK(t,e,n,r,s,i,o,l,c){Vm=!1,Sv=null,fK.apply(mK,arguments)}function gK(t,e,n,r,s,i,o,l,c){if(pK.apply(this,arguments),Vm){if(Vm){var u=Sv;Vm=!1,Sv=null}else throw Error(Qe(198));Cv||(Cv=!0,RC=u)}}function ud(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function VO(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function zk(t){if(ud(t)!==t)throw Error(Qe(188))}function yK(t){var e=t.alternate;if(!e){if(e=ud(t),e===null)throw Error(Qe(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return zk(s),t;if(i===r)return zk(s),e;i=i.sibling}throw Error(Qe(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(Qe(189))}}if(n.alternate!==r)throw Error(Qe(190))}if(n.tag!==3)throw Error(Qe(188));return n.stateNode.current===n?t:e}function $O(t){return t=yK(t),t!==null?UO(t):null}function UO(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=UO(t);if(e!==null)return e;t=t.sibling}return null}var BO=qi.unstable_scheduleCallback,Gk=qi.unstable_cancelCallback,xK=qi.unstable_shouldYield,vK=qi.unstable_requestPaint,Mr=qi.unstable_now,wK=qi.unstable_getCurrentPriorityLevel,k1=qi.unstable_ImmediatePriority,zO=qi.unstable_UserBlockingPriority,Ev=qi.unstable_NormalPriority,bK=qi.unstable_LowPriority,GO=qi.unstable_IdlePriority,c0=null,pa=null;function _K(t){if(pa&&typeof pa.onCommitFiberRoot=="function")try{pa.onCommitFiberRoot(c0,t,void 0,(t.current.flags&128)===128)}catch{}}var Vo=Math.clz32?Math.clz32:EK,SK=Math.log,CK=Math.LN2;function EK(t){return t>>>=0,t===0?32:31-(SK(t)/CK|0)|0}var Sy=64,Cy=4194304;function vm(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Tv(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=vm(l):(i&=o,i!==0&&(r=vm(i)))}else o=n&~s,o!==0?r=vm(o):i!==0&&(r=vm(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Vo(e),s=1<<n,r|=t[n],e&=~s;return r}function TK(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function IK(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Vo(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=TK(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function jC(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function WO(){var t=Sy;return Sy<<=1,!(Sy&4194240)&&(Sy=64),t}function __(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function xg(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Vo(e),t[e]=n}function NK(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Vo(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function R1(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Vo(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ln=0;function HO(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var qO,j1,KO,YO,JO,DC=!1,Ey=[],Xl=null,Ql=null,Zl=null,Sp=new Map,Cp=new Map,$l=[],PK="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wk(t,e){switch(t){case"focusin":case"focusout":Xl=null;break;case"dragenter":case"dragleave":Ql=null;break;case"mouseover":case"mouseout":Zl=null;break;case"pointerover":case"pointerout":Sp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cp.delete(e.pointerId)}}function Gf(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=wg(e),e!==null&&j1(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function AK(t,e,n,r,s){switch(e){case"focusin":return Xl=Gf(Xl,t,e,n,r,s),!0;case"dragenter":return Ql=Gf(Ql,t,e,n,r,s),!0;case"mouseover":return Zl=Gf(Zl,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Sp.set(i,Gf(Sp.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Cp.set(i,Gf(Cp.get(i)||null,t,e,n,r,s)),!0}return!1}function XO(t){var e=_u(t.target);if(e!==null){var n=ud(e);if(n!==null){if(e=n.tag,e===13){if(e=VO(n),e!==null){t.blockedOn=e,JO(t.priority,function(){KO(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function kx(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=MC(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);PC=r,n.target.dispatchEvent(r),PC=null}else return e=wg(n),e!==null&&j1(e),t.blockedOn=n,!1;e.shift()}return!0}function Hk(t,e,n){kx(t)&&n.delete(e)}function kK(){DC=!1,Xl!==null&&kx(Xl)&&(Xl=null),Ql!==null&&kx(Ql)&&(Ql=null),Zl!==null&&kx(Zl)&&(Zl=null),Sp.forEach(Hk),Cp.forEach(Hk)}function Wf(t,e){t.blockedOn===e&&(t.blockedOn=null,DC||(DC=!0,qi.unstable_scheduleCallback(qi.unstable_NormalPriority,kK)))}function Ep(t){function e(s){return Wf(s,t)}if(0<Ey.length){Wf(Ey[0],t);for(var n=1;n<Ey.length;n++){var r=Ey[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Xl!==null&&Wf(Xl,t),Ql!==null&&Wf(Ql,t),Zl!==null&&Wf(Zl,t),Sp.forEach(e),Cp.forEach(e),n=0;n<$l.length;n++)r=$l[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<$l.length&&(n=$l[0],n.blockedOn===null);)XO(n),n.blockedOn===null&&$l.shift()}var Eh=pl.ReactCurrentBatchConfig,Iv=!0;function RK(t,e,n,r){var s=Ln,i=Eh.transition;Eh.transition=null;try{Ln=1,D1(t,e,n,r)}finally{Ln=s,Eh.transition=i}}function jK(t,e,n,r){var s=Ln,i=Eh.transition;Eh.transition=null;try{Ln=4,D1(t,e,n,r)}finally{Ln=s,Eh.transition=i}}function D1(t,e,n,r){if(Iv){var s=MC(t,e,n,r);if(s===null)R_(t,e,r,Nv,n),Wk(t,r);else if(AK(s,t,e,n,r))r.stopPropagation();else if(Wk(t,r),e&4&&-1<PK.indexOf(t)){for(;s!==null;){var i=wg(s);if(i!==null&&qO(i),i=MC(t,e,n,r),i===null&&R_(t,e,r,Nv,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else R_(t,e,r,null,n)}}var Nv=null;function MC(t,e,n,r){if(Nv=null,t=A1(r),t=_u(t),t!==null)if(e=ud(t),e===null)t=null;else if(n=e.tag,n===13){if(t=VO(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nv=t,null}function QO(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wK()){case k1:return 1;case zO:return 4;case Ev:case bK:return 16;case GO:return 536870912;default:return 16}default:return 16}}var ql=null,M1=null,Rx=null;function ZO(){if(Rx)return Rx;var t,e=M1,n=e.length,r,s="value"in ql?ql.value:ql.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Rx=s.slice(t,1<r?1-r:void 0)}function jx(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ty(){return!0}function qk(){return!1}function Qi(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ty:qk,this.isPropagationStopped=qk,this}return _r(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ty)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ty)},persist:function(){},isPersistent:Ty}),e}var bf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},L1=Qi(bf),vg=_r({},bf,{view:0,detail:0}),DK=Qi(vg),S_,C_,Hf,u0=_r({},vg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:F1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Hf&&(Hf&&t.type==="mousemove"?(S_=t.screenX-Hf.screenX,C_=t.screenY-Hf.screenY):C_=S_=0,Hf=t),S_)},movementY:function(t){return"movementY"in t?t.movementY:C_}}),Kk=Qi(u0),MK=_r({},u0,{dataTransfer:0}),LK=Qi(MK),FK=_r({},vg,{relatedTarget:0}),E_=Qi(FK),OK=_r({},bf,{animationName:0,elapsedTime:0,pseudoElement:0}),VK=Qi(OK),$K=_r({},bf,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),UK=Qi($K),BK=_r({},bf,{data:0}),Yk=Qi(BK),zK={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},GK={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WK={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HK(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=WK[t])?!!e[t]:!1}function F1(){return HK}var qK=_r({},vg,{key:function(t){if(t.key){var e=zK[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=jx(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?GK[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:F1,charCode:function(t){return t.type==="keypress"?jx(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?jx(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),KK=Qi(qK),YK=_r({},u0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jk=Qi(YK),JK=_r({},vg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:F1}),XK=Qi(JK),QK=_r({},bf,{propertyName:0,elapsedTime:0,pseudoElement:0}),ZK=Qi(QK),eY=_r({},u0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),tY=Qi(eY),nY=[9,13,27,32],O1=tl&&"CompositionEvent"in window,$m=null;tl&&"documentMode"in document&&($m=document.documentMode);var rY=tl&&"TextEvent"in window&&!$m,eV=tl&&(!O1||$m&&8<$m&&11>=$m),Xk=String.fromCharCode(32),Qk=!1;function tV(t,e){switch(t){case"keyup":return nY.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nV(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var th=!1;function sY(t,e){switch(t){case"compositionend":return nV(e);case"keypress":return e.which!==32?null:(Qk=!0,Xk);case"textInput":return t=e.data,t===Xk&&Qk?null:t;default:return null}}function iY(t,e){if(th)return t==="compositionend"||!O1&&tV(t,e)?(t=ZO(),Rx=M1=ql=null,th=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return eV&&e.locale!=="ko"?null:e.data;default:return null}}var oY={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!oY[t.type]:e==="textarea"}function rV(t,e,n,r){DO(r),e=Pv(e,"onChange"),0<e.length&&(n=new L1("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Um=null,Tp=null;function aY(t){mV(t,0)}function d0(t){var e=sh(t);if(IO(e))return t}function lY(t,e){if(t==="change")return e}var sV=!1;if(tl){var T_;if(tl){var I_="oninput"in document;if(!I_){var eR=document.createElement("div");eR.setAttribute("oninput","return;"),I_=typeof eR.oninput=="function"}T_=I_}else T_=!1;sV=T_&&(!document.documentMode||9<document.documentMode)}function tR(){Um&&(Um.detachEvent("onpropertychange",iV),Tp=Um=null)}function iV(t){if(t.propertyName==="value"&&d0(Tp)){var e=[];rV(e,Tp,t,A1(t)),OO(aY,e)}}function cY(t,e,n){t==="focusin"?(tR(),Um=e,Tp=n,Um.attachEvent("onpropertychange",iV)):t==="focusout"&&tR()}function uY(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return d0(Tp)}function dY(t,e){if(t==="click")return d0(e)}function hY(t,e){if(t==="input"||t==="change")return d0(e)}function fY(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zo=typeof Object.is=="function"?Object.is:fY;function Ip(t,e){if(zo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!yC.call(e,s)||!zo(t[s],e[s]))return!1}return!0}function nR(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function rR(t,e){var n=nR(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=nR(n)}}function oV(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?oV(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function aV(){for(var t=window,e=_v();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=_v(t.document)}return e}function V1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function mY(t){var e=aV(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&oV(n.ownerDocument.documentElement,n)){if(r!==null&&V1(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=rR(n,i);var o=rR(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var pY=tl&&"documentMode"in document&&11>=document.documentMode,nh=null,LC=null,Bm=null,FC=!1;function sR(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;FC||nh==null||nh!==_v(r)||(r=nh,"selectionStart"in r&&V1(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Bm&&Ip(Bm,r)||(Bm=r,r=Pv(LC,"onSelect"),0<r.length&&(e=new L1("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=nh)))}function Iy(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var rh={animationend:Iy("Animation","AnimationEnd"),animationiteration:Iy("Animation","AnimationIteration"),animationstart:Iy("Animation","AnimationStart"),transitionend:Iy("Transition","TransitionEnd")},N_={},lV={};tl&&(lV=document.createElement("div").style,"AnimationEvent"in window||(delete rh.animationend.animation,delete rh.animationiteration.animation,delete rh.animationstart.animation),"TransitionEvent"in window||delete rh.transitionend.transition);function h0(t){if(N_[t])return N_[t];if(!rh[t])return t;var e=rh[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in lV)return N_[t]=e[n];return t}var cV=h0("animationend"),uV=h0("animationiteration"),dV=h0("animationstart"),hV=h0("transitionend"),fV=new Map,iR="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kc(t,e){fV.set(t,e),cd(e,[t])}for(var P_=0;P_<iR.length;P_++){var A_=iR[P_],gY=A_.toLowerCase(),yY=A_[0].toUpperCase()+A_.slice(1);kc(gY,"on"+yY)}kc(cV,"onAnimationEnd");kc(uV,"onAnimationIteration");kc(dV,"onAnimationStart");kc("dblclick","onDoubleClick");kc("focusin","onFocus");kc("focusout","onBlur");kc(hV,"onTransitionEnd");Uh("onMouseEnter",["mouseout","mouseover"]);Uh("onMouseLeave",["mouseout","mouseover"]);Uh("onPointerEnter",["pointerout","pointerover"]);Uh("onPointerLeave",["pointerout","pointerover"]);cd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cd("onBeforeInput",["compositionend","keypress","textInput","paste"]);cd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xY=new Set("cancel close invalid load scroll toggle".split(" ").concat(wm));function oR(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,gK(r,e,void 0,t),t.currentTarget=null}function mV(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;oR(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;oR(s,l,u),i=c}}}if(Cv)throw t=RC,Cv=!1,RC=null,t}function nr(t,e){var n=e[BC];n===void 0&&(n=e[BC]=new Set);var r=t+"__bubble";n.has(r)||(pV(e,t,2,!1),n.add(r))}function k_(t,e,n){var r=0;e&&(r|=4),pV(n,t,r,e)}var Ny="_reactListening"+Math.random().toString(36).slice(2);function Np(t){if(!t[Ny]){t[Ny]=!0,_O.forEach(function(n){n!=="selectionchange"&&(xY.has(n)||k_(n,!1,t),k_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ny]||(e[Ny]=!0,k_("selectionchange",!1,e))}}function pV(t,e,n,r){switch(QO(e)){case 1:var s=RK;break;case 4:s=jK;break;default:s=D1}n=s.bind(null,e,n,t),s=void 0,!kC||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function R_(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=_u(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}OO(function(){var u=i,d=A1(n),h=[];e:{var f=fV.get(t);if(f!==void 0){var m=L1,g=t;switch(t){case"keypress":if(jx(n)===0)break e;case"keydown":case"keyup":m=KK;break;case"focusin":g="focus",m=E_;break;case"focusout":g="blur",m=E_;break;case"beforeblur":case"afterblur":m=E_;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Kk;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=LK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=XK;break;case cV:case uV:case dV:m=VK;break;case hV:m=ZK;break;case"scroll":m=DK;break;case"wheel":m=tY;break;case"copy":case"cut":case"paste":m=UK;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Jk}var x=(e&4)!==0,w=!x&&t==="scroll",v=x?f!==null?f+"Capture":null:f;x=[];for(var _=u,C;_!==null;){C=_;var T=C.stateNode;if(C.tag===5&&T!==null&&(C=T,v!==null&&(T=_p(_,v),T!=null&&x.push(Pp(_,T,C)))),w)break;_=_.return}0<x.length&&(f=new m(f,g,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==PC&&(g=n.relatedTarget||n.fromElement)&&(_u(g)||g[nl]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(g=n.relatedTarget||n.toElement,m=u,g=g?_u(g):null,g!==null&&(w=ud(g),g!==w||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(x=Kk,T="onMouseLeave",v="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(x=Jk,T="onPointerLeave",v="onPointerEnter",_="pointer"),w=m==null?f:sh(m),C=g==null?f:sh(g),f=new x(T,_+"leave",m,n,d),f.target=w,f.relatedTarget=C,T=null,_u(d)===u&&(x=new x(v,_+"enter",g,n,d),x.target=C,x.relatedTarget=w,T=x),w=T,m&&g)t:{for(x=m,v=g,_=0,C=x;C;C=Id(C))_++;for(C=0,T=v;T;T=Id(T))C++;for(;0<_-C;)x=Id(x),_--;for(;0<C-_;)v=Id(v),C--;for(;_--;){if(x===v||v!==null&&x===v.alternate)break t;x=Id(x),v=Id(v)}x=null}else x=null;m!==null&&aR(h,f,m,x,!1),g!==null&&w!==null&&aR(h,w,g,x,!0)}}e:{if(f=u?sh(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var R=lY;else if(Zk(f))if(sV)R=hY;else{R=uY;var A=cY}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(R=dY);if(R&&(R=R(t,u))){rV(h,R,n,d);break e}A&&A(t,f,u),t==="focusout"&&(A=f._wrapperState)&&A.controlled&&f.type==="number"&&CC(f,"number",f.value)}switch(A=u?sh(u):window,t){case"focusin":(Zk(A)||A.contentEditable==="true")&&(nh=A,LC=u,Bm=null);break;case"focusout":Bm=LC=nh=null;break;case"mousedown":FC=!0;break;case"contextmenu":case"mouseup":case"dragend":FC=!1,sR(h,n,d);break;case"selectionchange":if(pY)break;case"keydown":case"keyup":sR(h,n,d)}var E;if(O1)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else th?tV(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(eV&&n.locale!=="ko"&&(th||I!=="onCompositionStart"?I==="onCompositionEnd"&&th&&(E=ZO()):(ql=d,M1="value"in ql?ql.value:ql.textContent,th=!0)),A=Pv(u,I),0<A.length&&(I=new Yk(I,t,null,n,d),h.push({event:I,listeners:A}),E?I.data=E:(E=nV(n),E!==null&&(I.data=E)))),(E=rY?sY(t,n):iY(t,n))&&(u=Pv(u,"onBeforeInput"),0<u.length&&(d=new Yk("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=E))}mV(h,e)})}function Pp(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Pv(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=_p(t,n),i!=null&&r.unshift(Pp(t,i,s)),i=_p(t,e),i!=null&&r.push(Pp(t,i,s))),t=t.return}return r}function Id(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function aR(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=_p(n,i),c!=null&&o.unshift(Pp(n,c,l))):s||(c=_p(n,i),c!=null&&o.push(Pp(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var vY=/\r\n?/g,wY=/\u0000|\uFFFD/g;function lR(t){return(typeof t=="string"?t:""+t).replace(vY,`
`).replace(wY,"")}function Py(t,e,n){if(e=lR(e),lR(t)!==e&&n)throw Error(Qe(425))}function Av(){}var OC=null,VC=null;function $C(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var UC=typeof setTimeout=="function"?setTimeout:void 0,bY=typeof clearTimeout=="function"?clearTimeout:void 0,cR=typeof Promise=="function"?Promise:void 0,_Y=typeof queueMicrotask=="function"?queueMicrotask:typeof cR<"u"?function(t){return cR.resolve(null).then(t).catch(SY)}:UC;function SY(t){setTimeout(function(){throw t})}function j_(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ep(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ep(e)}function ec(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function uR(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var _f=Math.random().toString(36).slice(2),aa="__reactFiber$"+_f,Ap="__reactProps$"+_f,nl="__reactContainer$"+_f,BC="__reactEvents$"+_f,CY="__reactListeners$"+_f,EY="__reactHandles$"+_f;function _u(t){var e=t[aa];if(e)return e;for(var n=t.parentNode;n;){if(e=n[nl]||n[aa]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=uR(t);t!==null;){if(n=t[aa])return n;t=uR(t)}return e}t=n,n=t.parentNode}return null}function wg(t){return t=t[aa]||t[nl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function sh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Qe(33))}function f0(t){return t[Ap]||null}var zC=[],ih=-1;function Rc(t){return{current:t}}function ir(t){0>ih||(t.current=zC[ih],zC[ih]=null,ih--)}function Jn(t,e){ih++,zC[ih]=t.current,t.current=e}var wc={},Fs=Rc(wc),pi=Rc(!1),Uu=wc;function Bh(t,e){var n=t.type.contextTypes;if(!n)return wc;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function gi(t){return t=t.childContextTypes,t!=null}function kv(){ir(pi),ir(Fs)}function dR(t,e,n){if(Fs.current!==wc)throw Error(Qe(168));Jn(Fs,e),Jn(pi,n)}function gV(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Qe(108,cK(t)||"Unknown",s));return _r({},n,r)}function Rv(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||wc,Uu=Fs.current,Jn(Fs,t),Jn(pi,pi.current),!0}function hR(t,e,n){var r=t.stateNode;if(!r)throw Error(Qe(169));n?(t=gV(t,e,Uu),r.__reactInternalMemoizedMergedChildContext=t,ir(pi),ir(Fs),Jn(Fs,t)):ir(pi),Jn(pi,n)}var Fa=null,m0=!1,D_=!1;function yV(t){Fa===null?Fa=[t]:Fa.push(t)}function TY(t){m0=!0,yV(t)}function jc(){if(!D_&&Fa!==null){D_=!0;var t=0,e=Ln;try{var n=Fa;for(Ln=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Fa=null,m0=!1}catch(s){throw Fa!==null&&(Fa=Fa.slice(t+1)),BO(k1,jc),s}finally{Ln=e,D_=!1}}return null}var oh=[],ah=0,jv=null,Dv=0,io=[],oo=0,Bu=null,Ua=1,Ba="";function ou(t,e){oh[ah++]=Dv,oh[ah++]=jv,jv=t,Dv=e}function xV(t,e,n){io[oo++]=Ua,io[oo++]=Ba,io[oo++]=Bu,Bu=t;var r=Ua;t=Ba;var s=32-Vo(r)-1;r&=~(1<<s),n+=1;var i=32-Vo(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Ua=1<<32-Vo(e)+s|n<<s|r,Ba=i+t}else Ua=1<<i|n<<s|r,Ba=t}function $1(t){t.return!==null&&(ou(t,1),xV(t,1,0))}function U1(t){for(;t===jv;)jv=oh[--ah],oh[ah]=null,Dv=oh[--ah],oh[ah]=null;for(;t===Bu;)Bu=io[--oo],io[oo]=null,Ba=io[--oo],io[oo]=null,Ua=io[--oo],io[oo]=null}var Wi=null,$i=null,ur=!1,jo=null;function vV(t,e){var n=co(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function fR(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Wi=t,$i=ec(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Wi=t,$i=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Bu!==null?{id:Ua,overflow:Ba}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=co(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Wi=t,$i=null,!0):!1;default:return!1}}function GC(t){return(t.mode&1)!==0&&(t.flags&128)===0}function WC(t){if(ur){var e=$i;if(e){var n=e;if(!fR(t,e)){if(GC(t))throw Error(Qe(418));e=ec(n.nextSibling);var r=Wi;e&&fR(t,e)?vV(r,n):(t.flags=t.flags&-4097|2,ur=!1,Wi=t)}}else{if(GC(t))throw Error(Qe(418));t.flags=t.flags&-4097|2,ur=!1,Wi=t}}}function mR(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Wi=t}function Ay(t){if(t!==Wi)return!1;if(!ur)return mR(t),ur=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!$C(t.type,t.memoizedProps)),e&&(e=$i)){if(GC(t))throw wV(),Error(Qe(418));for(;e;)vV(t,e),e=ec(e.nextSibling)}if(mR(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Qe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){$i=ec(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}$i=null}}else $i=Wi?ec(t.stateNode.nextSibling):null;return!0}function wV(){for(var t=$i;t;)t=ec(t.nextSibling)}function zh(){$i=Wi=null,ur=!1}function B1(t){jo===null?jo=[t]:jo.push(t)}var IY=pl.ReactCurrentBatchConfig;function qf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Qe(309));var r=n.stateNode}if(!r)throw Error(Qe(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Qe(284));if(!n._owner)throw Error(Qe(290,t))}return t}function ky(t,e){throw t=Object.prototype.toString.call(e),Error(Qe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function pR(t){var e=t._init;return e(t._payload)}function bV(t){function e(v,_){if(t){var C=v.deletions;C===null?(v.deletions=[_],v.flags|=16):C.push(_)}}function n(v,_){if(!t)return null;for(;_!==null;)e(v,_),_=_.sibling;return null}function r(v,_){for(v=new Map;_!==null;)_.key!==null?v.set(_.key,_):v.set(_.index,_),_=_.sibling;return v}function s(v,_){return v=sc(v,_),v.index=0,v.sibling=null,v}function i(v,_,C){return v.index=C,t?(C=v.alternate,C!==null?(C=C.index,C<_?(v.flags|=2,_):C):(v.flags|=2,_)):(v.flags|=1048576,_)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,_,C,T){return _===null||_.tag!==6?(_=U_(C,v.mode,T),_.return=v,_):(_=s(_,C),_.return=v,_)}function c(v,_,C,T){var R=C.type;return R===eh?d(v,_,C.props.children,T,C.key):_!==null&&(_.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Fl&&pR(R)===_.type)?(T=s(_,C.props),T.ref=qf(v,_,C),T.return=v,T):(T=$x(C.type,C.key,C.props,null,v.mode,T),T.ref=qf(v,_,C),T.return=v,T)}function u(v,_,C,T){return _===null||_.tag!==4||_.stateNode.containerInfo!==C.containerInfo||_.stateNode.implementation!==C.implementation?(_=B_(C,v.mode,T),_.return=v,_):(_=s(_,C.children||[]),_.return=v,_)}function d(v,_,C,T,R){return _===null||_.tag!==7?(_=Du(C,v.mode,T,R),_.return=v,_):(_=s(_,C),_.return=v,_)}function h(v,_,C){if(typeof _=="string"&&_!==""||typeof _=="number")return _=U_(""+_,v.mode,C),_.return=v,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case wy:return C=$x(_.type,_.key,_.props,null,v.mode,C),C.ref=qf(v,null,_),C.return=v,C;case Zd:return _=B_(_,v.mode,C),_.return=v,_;case Fl:var T=_._init;return h(v,T(_._payload),C)}if(xm(_)||Bf(_))return _=Du(_,v.mode,C,null),_.return=v,_;ky(v,_)}return null}function f(v,_,C,T){var R=_!==null?_.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return R!==null?null:l(v,_,""+C,T);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case wy:return C.key===R?c(v,_,C,T):null;case Zd:return C.key===R?u(v,_,C,T):null;case Fl:return R=C._init,f(v,_,R(C._payload),T)}if(xm(C)||Bf(C))return R!==null?null:d(v,_,C,T,null);ky(v,C)}return null}function m(v,_,C,T,R){if(typeof T=="string"&&T!==""||typeof T=="number")return v=v.get(C)||null,l(_,v,""+T,R);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case wy:return v=v.get(T.key===null?C:T.key)||null,c(_,v,T,R);case Zd:return v=v.get(T.key===null?C:T.key)||null,u(_,v,T,R);case Fl:var A=T._init;return m(v,_,C,A(T._payload),R)}if(xm(T)||Bf(T))return v=v.get(C)||null,d(_,v,T,R,null);ky(_,T)}return null}function g(v,_,C,T){for(var R=null,A=null,E=_,I=_=0,P=null;E!==null&&I<C.length;I++){E.index>I?(P=E,E=null):P=E.sibling;var k=f(v,E,C[I],T);if(k===null){E===null&&(E=P);break}t&&E&&k.alternate===null&&e(v,E),_=i(k,_,I),A===null?R=k:A.sibling=k,A=k,E=P}if(I===C.length)return n(v,E),ur&&ou(v,I),R;if(E===null){for(;I<C.length;I++)E=h(v,C[I],T),E!==null&&(_=i(E,_,I),A===null?R=E:A.sibling=E,A=E);return ur&&ou(v,I),R}for(E=r(v,E);I<C.length;I++)P=m(E,v,I,C[I],T),P!==null&&(t&&P.alternate!==null&&E.delete(P.key===null?I:P.key),_=i(P,_,I),A===null?R=P:A.sibling=P,A=P);return t&&E.forEach(function(j){return e(v,j)}),ur&&ou(v,I),R}function x(v,_,C,T){var R=Bf(C);if(typeof R!="function")throw Error(Qe(150));if(C=R.call(C),C==null)throw Error(Qe(151));for(var A=R=null,E=_,I=_=0,P=null,k=C.next();E!==null&&!k.done;I++,k=C.next()){E.index>I?(P=E,E=null):P=E.sibling;var j=f(v,E,k.value,T);if(j===null){E===null&&(E=P);break}t&&E&&j.alternate===null&&e(v,E),_=i(j,_,I),A===null?R=j:A.sibling=j,A=j,E=P}if(k.done)return n(v,E),ur&&ou(v,I),R;if(E===null){for(;!k.done;I++,k=C.next())k=h(v,k.value,T),k!==null&&(_=i(k,_,I),A===null?R=k:A.sibling=k,A=k);return ur&&ou(v,I),R}for(E=r(v,E);!k.done;I++,k=C.next())k=m(E,v,I,k.value,T),k!==null&&(t&&k.alternate!==null&&E.delete(k.key===null?I:k.key),_=i(k,_,I),A===null?R=k:A.sibling=k,A=k);return t&&E.forEach(function(D){return e(v,D)}),ur&&ou(v,I),R}function w(v,_,C,T){if(typeof C=="object"&&C!==null&&C.type===eh&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case wy:e:{for(var R=C.key,A=_;A!==null;){if(A.key===R){if(R=C.type,R===eh){if(A.tag===7){n(v,A.sibling),_=s(A,C.props.children),_.return=v,v=_;break e}}else if(A.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Fl&&pR(R)===A.type){n(v,A.sibling),_=s(A,C.props),_.ref=qf(v,A,C),_.return=v,v=_;break e}n(v,A);break}else e(v,A);A=A.sibling}C.type===eh?(_=Du(C.props.children,v.mode,T,C.key),_.return=v,v=_):(T=$x(C.type,C.key,C.props,null,v.mode,T),T.ref=qf(v,_,C),T.return=v,v=T)}return o(v);case Zd:e:{for(A=C.key;_!==null;){if(_.key===A)if(_.tag===4&&_.stateNode.containerInfo===C.containerInfo&&_.stateNode.implementation===C.implementation){n(v,_.sibling),_=s(_,C.children||[]),_.return=v,v=_;break e}else{n(v,_);break}else e(v,_);_=_.sibling}_=B_(C,v.mode,T),_.return=v,v=_}return o(v);case Fl:return A=C._init,w(v,_,A(C._payload),T)}if(xm(C))return g(v,_,C,T);if(Bf(C))return x(v,_,C,T);ky(v,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,_!==null&&_.tag===6?(n(v,_.sibling),_=s(_,C),_.return=v,v=_):(n(v,_),_=U_(C,v.mode,T),_.return=v,v=_),o(v)):n(v,_)}return w}var Gh=bV(!0),_V=bV(!1),Mv=Rc(null),Lv=null,lh=null,z1=null;function G1(){z1=lh=Lv=null}function W1(t){var e=Mv.current;ir(Mv),t._currentValue=e}function HC(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Th(t,e){Lv=t,z1=lh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(di=!0),t.firstContext=null)}function yo(t){var e=t._currentValue;if(z1!==t)if(t={context:t,memoizedValue:e,next:null},lh===null){if(Lv===null)throw Error(Qe(308));lh=t,Lv.dependencies={lanes:0,firstContext:t}}else lh=lh.next=t;return e}var Su=null;function H1(t){Su===null?Su=[t]:Su.push(t)}function SV(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,H1(e)):(n.next=s.next,s.next=n),e.interleaved=n,rl(t,r)}function rl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ol=!1;function q1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function CV(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function tc(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,gn&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,rl(t,n)}return s=r.interleaved,s===null?(e.next=e,H1(r)):(e.next=s.next,s.next=e),r.interleaved=e,rl(t,n)}function Dx(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,R1(t,n)}}function gR(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Fv(t,e,n,r){var s=t.updateQueue;Ol=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,m=l.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=t,x=l;switch(f=e,m=n,x.tag){case 1:if(g=x.payload,typeof g=="function"){h=g.call(m,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,f=typeof g=="function"?g.call(m,h,f):g,f==null)break e;h=_r({},h,f);break e;case 2:Ol=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(1);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Gu|=o,t.lanes=o,t.memoizedState=h}}function yR(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Qe(191,s));s.call(r)}}}var bg={},ga=Rc(bg),kp=Rc(bg),Rp=Rc(bg);function Cu(t){if(t===bg)throw Error(Qe(174));return t}function K1(t,e){switch(Jn(Rp,e),Jn(kp,t),Jn(ga,bg),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:TC(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=TC(e,t)}ir(ga),Jn(ga,e)}function Wh(){ir(ga),ir(kp),ir(Rp)}function EV(t){Cu(Rp.current);var e=Cu(ga.current),n=TC(e,t.type);e!==n&&(Jn(kp,t),Jn(ga,n))}function Y1(t){kp.current===t&&(ir(ga),ir(kp))}var yr=Rc(0);function Ov(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var M_=[];function J1(){for(var t=0;t<M_.length;t++)M_[t]._workInProgressVersionPrimary=null;M_.length=0}var Mx=pl.ReactCurrentDispatcher,L_=pl.ReactCurrentBatchConfig,zu=0,wr=null,Yr=null,os=null,Vv=!1,zm=!1,jp=0,NY=0;function Es(){throw Error(Qe(321))}function X1(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!zo(t[n],e[n]))return!1;return!0}function Q1(t,e,n,r,s,i){if(zu=i,wr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Mx.current=t===null||t.memoizedState===null?RY:jY,t=n(r,s),zm){i=0;do{if(zm=!1,jp=0,25<=i)throw Error(Qe(301));i+=1,os=Yr=null,e.updateQueue=null,Mx.current=DY,t=n(r,s)}while(zm)}if(Mx.current=$v,e=Yr!==null&&Yr.next!==null,zu=0,os=Yr=wr=null,Vv=!1,e)throw Error(Qe(300));return t}function Z1(){var t=jp!==0;return jp=0,t}function na(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return os===null?wr.memoizedState=os=t:os=os.next=t,os}function xo(){if(Yr===null){var t=wr.alternate;t=t!==null?t.memoizedState:null}else t=Yr.next;var e=os===null?wr.memoizedState:os.next;if(e!==null)os=e,Yr=t;else{if(t===null)throw Error(Qe(310));Yr=t,t={memoizedState:Yr.memoizedState,baseState:Yr.baseState,baseQueue:Yr.baseQueue,queue:Yr.queue,next:null},os===null?wr.memoizedState=os=t:os=os.next=t}return os}function Dp(t,e){return typeof e=="function"?e(t):e}function F_(t){var e=xo(),n=e.queue;if(n===null)throw Error(Qe(311));n.lastRenderedReducer=t;var r=Yr,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((zu&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,wr.lanes|=d,Gu|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,zo(r,e.memoizedState)||(di=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,wr.lanes|=i,Gu|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function O_(t){var e=xo(),n=e.queue;if(n===null)throw Error(Qe(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);zo(i,e.memoizedState)||(di=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function TV(){}function IV(t,e){var n=wr,r=xo(),s=e(),i=!zo(r.memoizedState,s);if(i&&(r.memoizedState=s,di=!0),r=r.queue,eI(AV.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||os!==null&&os.memoizedState.tag&1){if(n.flags|=2048,Mp(9,PV.bind(null,n,r,s,e),void 0,null),ls===null)throw Error(Qe(349));zu&30||NV(n,e,s)}return s}function NV(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=wr.updateQueue,e===null?(e={lastEffect:null,stores:null},wr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function PV(t,e,n,r){e.value=n,e.getSnapshot=r,kV(e)&&RV(t)}function AV(t,e,n){return n(function(){kV(e)&&RV(t)})}function kV(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!zo(t,n)}catch{return!0}}function RV(t){var e=rl(t,1);e!==null&&$o(e,t,1,-1)}function xR(t){var e=na();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dp,lastRenderedState:t},e.queue=t,t=t.dispatch=kY.bind(null,wr,t),[e.memoizedState,t]}function Mp(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=wr.updateQueue,e===null?(e={lastEffect:null,stores:null},wr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function jV(){return xo().memoizedState}function Lx(t,e,n,r){var s=na();wr.flags|=t,s.memoizedState=Mp(1|e,n,void 0,r===void 0?null:r)}function p0(t,e,n,r){var s=xo();r=r===void 0?null:r;var i=void 0;if(Yr!==null){var o=Yr.memoizedState;if(i=o.destroy,r!==null&&X1(r,o.deps)){s.memoizedState=Mp(e,n,i,r);return}}wr.flags|=t,s.memoizedState=Mp(1|e,n,i,r)}function vR(t,e){return Lx(8390656,8,t,e)}function eI(t,e){return p0(2048,8,t,e)}function DV(t,e){return p0(4,2,t,e)}function MV(t,e){return p0(4,4,t,e)}function LV(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function FV(t,e,n){return n=n!=null?n.concat([t]):null,p0(4,4,LV.bind(null,e,t),n)}function tI(){}function OV(t,e){var n=xo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&X1(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function VV(t,e){var n=xo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&X1(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function $V(t,e,n){return zu&21?(zo(n,e)||(n=WO(),wr.lanes|=n,Gu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,di=!0),t.memoizedState=n)}function PY(t,e){var n=Ln;Ln=n!==0&&4>n?n:4,t(!0);var r=L_.transition;L_.transition={};try{t(!1),e()}finally{Ln=n,L_.transition=r}}function UV(){return xo().memoizedState}function AY(t,e,n){var r=rc(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},BV(t))zV(e,n);else if(n=SV(t,e,n,r),n!==null){var s=Xs();$o(n,t,r,s),GV(n,e,r)}}function kY(t,e,n){var r=rc(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(BV(t))zV(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,zo(l,o)){var c=e.interleaved;c===null?(s.next=s,H1(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=SV(t,e,s,r),n!==null&&(s=Xs(),$o(n,t,r,s),GV(n,e,r))}}function BV(t){var e=t.alternate;return t===wr||e!==null&&e===wr}function zV(t,e){zm=Vv=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function GV(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,R1(t,n)}}var $v={readContext:yo,useCallback:Es,useContext:Es,useEffect:Es,useImperativeHandle:Es,useInsertionEffect:Es,useLayoutEffect:Es,useMemo:Es,useReducer:Es,useRef:Es,useState:Es,useDebugValue:Es,useDeferredValue:Es,useTransition:Es,useMutableSource:Es,useSyncExternalStore:Es,useId:Es,unstable_isNewReconciler:!1},RY={readContext:yo,useCallback:function(t,e){return na().memoizedState=[t,e===void 0?null:e],t},useContext:yo,useEffect:vR,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Lx(4194308,4,LV.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Lx(4194308,4,t,e)},useInsertionEffect:function(t,e){return Lx(4,2,t,e)},useMemo:function(t,e){var n=na();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=na();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=AY.bind(null,wr,t),[r.memoizedState,t]},useRef:function(t){var e=na();return t={current:t},e.memoizedState=t},useState:xR,useDebugValue:tI,useDeferredValue:function(t){return na().memoizedState=t},useTransition:function(){var t=xR(!1),e=t[0];return t=PY.bind(null,t[1]),na().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=wr,s=na();if(ur){if(n===void 0)throw Error(Qe(407));n=n()}else{if(n=e(),ls===null)throw Error(Qe(349));zu&30||NV(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,vR(AV.bind(null,r,i,t),[t]),r.flags|=2048,Mp(9,PV.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=na(),e=ls.identifierPrefix;if(ur){var n=Ba,r=Ua;n=(r&~(1<<32-Vo(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=jp++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=NY++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},jY={readContext:yo,useCallback:OV,useContext:yo,useEffect:eI,useImperativeHandle:FV,useInsertionEffect:DV,useLayoutEffect:MV,useMemo:VV,useReducer:F_,useRef:jV,useState:function(){return F_(Dp)},useDebugValue:tI,useDeferredValue:function(t){var e=xo();return $V(e,Yr.memoizedState,t)},useTransition:function(){var t=F_(Dp)[0],e=xo().memoizedState;return[t,e]},useMutableSource:TV,useSyncExternalStore:IV,useId:UV,unstable_isNewReconciler:!1},DY={readContext:yo,useCallback:OV,useContext:yo,useEffect:eI,useImperativeHandle:FV,useInsertionEffect:DV,useLayoutEffect:MV,useMemo:VV,useReducer:O_,useRef:jV,useState:function(){return O_(Dp)},useDebugValue:tI,useDeferredValue:function(t){var e=xo();return Yr===null?e.memoizedState=t:$V(e,Yr.memoizedState,t)},useTransition:function(){var t=O_(Dp)[0],e=xo().memoizedState;return[t,e]},useMutableSource:TV,useSyncExternalStore:IV,useId:UV,unstable_isNewReconciler:!1};function No(t,e){if(t&&t.defaultProps){e=_r({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function qC(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:_r({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var g0={isMounted:function(t){return(t=t._reactInternals)?ud(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Xs(),s=rc(t),i=qa(r,s);i.payload=e,n!=null&&(i.callback=n),e=tc(t,i,s),e!==null&&($o(e,t,s,r),Dx(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Xs(),s=rc(t),i=qa(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=tc(t,i,s),e!==null&&($o(e,t,s,r),Dx(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Xs(),r=rc(t),s=qa(n,r);s.tag=2,e!=null&&(s.callback=e),e=tc(t,s,r),e!==null&&($o(e,t,r,n),Dx(e,t,r))}};function wR(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ip(n,r)||!Ip(s,i):!0}function WV(t,e,n){var r=!1,s=wc,i=e.contextType;return typeof i=="object"&&i!==null?i=yo(i):(s=gi(e)?Uu:Fs.current,r=e.contextTypes,i=(r=r!=null)?Bh(t,s):wc),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=g0,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function bR(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&g0.enqueueReplaceState(e,e.state,null)}function KC(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},q1(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=yo(i):(i=gi(e)?Uu:Fs.current,s.context=Bh(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(qC(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&g0.enqueueReplaceState(s,s.state,null),Fv(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Hh(t,e){try{var n="",r=e;do n+=lK(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function V_(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function YC(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var MY=typeof WeakMap=="function"?WeakMap:Map;function HV(t,e,n){n=qa(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Bv||(Bv=!0,iE=r),YC(t,e)},n}function qV(t,e,n){n=qa(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){YC(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){YC(t,e),typeof r!="function"&&(nc===null?nc=new Set([this]):nc.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function _R(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new MY;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=YY.bind(null,t,e,n),e.then(t,t))}function SR(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function CR(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=qa(-1,1),e.tag=2,tc(n,e,1))),n.lanes|=1),t)}var LY=pl.ReactCurrentOwner,di=!1;function qs(t,e,n,r){e.child=t===null?_V(e,null,n,r):Gh(e,t.child,n,r)}function ER(t,e,n,r,s){n=n.render;var i=e.ref;return Th(e,s),r=Q1(t,e,n,r,i,s),n=Z1(),t!==null&&!di?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,sl(t,e,s)):(ur&&n&&$1(e),e.flags|=1,qs(t,e,r,s),e.child)}function TR(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!cI(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,KV(t,e,i,r,s)):(t=$x(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ip,n(o,r)&&t.ref===e.ref)return sl(t,e,s)}return e.flags|=1,t=sc(i,r),t.ref=e.ref,t.return=e,e.child=t}function KV(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ip(i,r)&&t.ref===e.ref)if(di=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(di=!0);else return e.lanes=t.lanes,sl(t,e,s)}return JC(t,e,n,r,s)}function YV(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jn(uh,Di),Di|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Jn(uh,Di),Di|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Jn(uh,Di),Di|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Jn(uh,Di),Di|=r;return qs(t,e,s,n),e.child}function JV(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function JC(t,e,n,r,s){var i=gi(n)?Uu:Fs.current;return i=Bh(e,i),Th(e,s),n=Q1(t,e,n,r,i,s),r=Z1(),t!==null&&!di?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,sl(t,e,s)):(ur&&r&&$1(e),e.flags|=1,qs(t,e,n,s),e.child)}function IR(t,e,n,r,s){if(gi(n)){var i=!0;Rv(e)}else i=!1;if(Th(e,s),e.stateNode===null)Fx(t,e),WV(e,n,r),KC(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=yo(u):(u=gi(n)?Uu:Fs.current,u=Bh(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&bR(e,o,r,u),Ol=!1;var f=e.memoizedState;o.state=f,Fv(e,r,o,s),c=e.memoizedState,l!==r||f!==c||pi.current||Ol?(typeof d=="function"&&(qC(e,n,d,r),c=e.memoizedState),(l=Ol||wR(e,n,l,r,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,CV(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:No(e.type,l),o.props=u,h=e.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=yo(c):(c=gi(n)?Uu:Fs.current,c=Bh(e,c));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&bR(e,o,r,c),Ol=!1,f=e.memoizedState,o.state=f,Fv(e,r,o,s);var g=e.memoizedState;l!==h||f!==g||pi.current||Ol?(typeof m=="function"&&(qC(e,n,m,r),g=e.memoizedState),(u=Ol||wR(e,n,u,r,f,g,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return XC(t,e,n,r,i,s)}function XC(t,e,n,r,s,i){JV(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&hR(e,n,!1),sl(t,e,i);r=e.stateNode,LY.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Gh(e,t.child,null,i),e.child=Gh(e,null,l,i)):qs(t,e,l,i),e.memoizedState=r.state,s&&hR(e,n,!0),e.child}function XV(t){var e=t.stateNode;e.pendingContext?dR(t,e.pendingContext,e.pendingContext!==e.context):e.context&&dR(t,e.context,!1),K1(t,e.containerInfo)}function NR(t,e,n,r,s){return zh(),B1(s),e.flags|=256,qs(t,e,n,r),e.child}var QC={dehydrated:null,treeContext:null,retryLane:0};function ZC(t){return{baseLanes:t,cachePool:null,transitions:null}}function QV(t,e,n){var r=e.pendingProps,s=yr.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Jn(yr,s&1),t===null)return WC(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=v0(o,r,0,null),t=Du(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=ZC(n),e.memoizedState=QC,t):nI(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return FY(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=sc(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=sc(l,i):(i=Du(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?ZC(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=QC,r}return i=t.child,t=i.sibling,r=sc(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function nI(t,e){return e=v0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ry(t,e,n,r){return r!==null&&B1(r),Gh(e,t.child,null,n),t=nI(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function FY(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=V_(Error(Qe(422))),Ry(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=v0({mode:"visible",children:r.children},s,0,null),i=Du(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Gh(e,t.child,null,o),e.child.memoizedState=ZC(o),e.memoizedState=QC,i);if(!(e.mode&1))return Ry(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(Qe(419)),r=V_(i,r,void 0),Ry(t,e,o,r)}if(l=(o&t.childLanes)!==0,di||l){if(r=ls,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,rl(t,s),$o(r,t,s,-1))}return lI(),r=V_(Error(Qe(421))),Ry(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=JY.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,$i=ec(s.nextSibling),Wi=e,ur=!0,jo=null,t!==null&&(io[oo++]=Ua,io[oo++]=Ba,io[oo++]=Bu,Ua=t.id,Ba=t.overflow,Bu=e),e=nI(e,r.children),e.flags|=4096,e)}function PR(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),HC(t.return,e,n)}function $_(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function ZV(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(qs(t,e,r.children,n),r=yr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&PR(t,n,e);else if(t.tag===19)PR(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Jn(yr,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Ov(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),$_(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ov(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}$_(e,!0,n,null,i);break;case"together":$_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Fx(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function sl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Gu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Qe(153));if(e.child!==null){for(t=e.child,n=sc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=sc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function OY(t,e,n){switch(e.tag){case 3:XV(e),zh();break;case 5:EV(e);break;case 1:gi(e.type)&&Rv(e);break;case 4:K1(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Jn(Mv,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Jn(yr,yr.current&1),e.flags|=128,null):n&e.child.childLanes?QV(t,e,n):(Jn(yr,yr.current&1),t=sl(t,e,n),t!==null?t.sibling:null);Jn(yr,yr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return ZV(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Jn(yr,yr.current),r)break;return null;case 22:case 23:return e.lanes=0,YV(t,e,n)}return sl(t,e,n)}var e$,eE,t$,n$;e$=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};eE=function(){};t$=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Cu(ga.current);var i=null;switch(n){case"input":s=_C(t,s),r=_C(t,r),i=[];break;case"select":s=_r({},s,{value:void 0}),r=_r({},r,{value:void 0}),i=[];break;case"textarea":s=EC(t,s),r=EC(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Av)}IC(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(wp.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(wp.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&nr("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};n$=function(t,e,n,r){n!==r&&(e.flags|=4)};function Kf(t,e){if(!ur)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ts(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function VY(t,e,n){var r=e.pendingProps;switch(U1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ts(e),null;case 1:return gi(e.type)&&kv(),Ts(e),null;case 3:return r=e.stateNode,Wh(),ir(pi),ir(Fs),J1(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ay(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,jo!==null&&(lE(jo),jo=null))),eE(t,e),Ts(e),null;case 5:Y1(e);var s=Cu(Rp.current);if(n=e.type,t!==null&&e.stateNode!=null)t$(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Qe(166));return Ts(e),null}if(t=Cu(ga.current),Ay(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[aa]=e,r[Ap]=i,t=(e.mode&1)!==0,n){case"dialog":nr("cancel",r),nr("close",r);break;case"iframe":case"object":case"embed":nr("load",r);break;case"video":case"audio":for(s=0;s<wm.length;s++)nr(wm[s],r);break;case"source":nr("error",r);break;case"img":case"image":case"link":nr("error",r),nr("load",r);break;case"details":nr("toggle",r);break;case"input":Ok(r,i),nr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},nr("invalid",r);break;case"textarea":$k(r,i),nr("invalid",r)}IC(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Py(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Py(r.textContent,l,t),s=["children",""+l]):wp.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&nr("scroll",r)}switch(n){case"input":by(r),Vk(r,i,!0);break;case"textarea":by(r),Uk(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Av)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=AO(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[aa]=e,t[Ap]=r,e$(t,e,!1,!1),e.stateNode=t;e:{switch(o=NC(n,r),n){case"dialog":nr("cancel",t),nr("close",t),s=r;break;case"iframe":case"object":case"embed":nr("load",t),s=r;break;case"video":case"audio":for(s=0;s<wm.length;s++)nr(wm[s],t);s=r;break;case"source":nr("error",t),s=r;break;case"img":case"image":case"link":nr("error",t),nr("load",t),s=r;break;case"details":nr("toggle",t),s=r;break;case"input":Ok(t,r),s=_C(t,r),nr("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=_r({},r,{value:void 0}),nr("invalid",t);break;case"textarea":$k(t,r),s=EC(t,r),nr("invalid",t);break;default:s=r}IC(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?jO(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&kO(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&bp(t,c):typeof c=="number"&&bp(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(wp.hasOwnProperty(i)?c!=null&&i==="onScroll"&&nr("scroll",t):c!=null&&T1(t,i,c,o))}switch(n){case"input":by(t),Vk(t,r,!1);break;case"textarea":by(t),Uk(t);break;case"option":r.value!=null&&t.setAttribute("value",""+vc(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?_h(t,!!r.multiple,i,!1):r.defaultValue!=null&&_h(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Av)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ts(e),null;case 6:if(t&&e.stateNode!=null)n$(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Qe(166));if(n=Cu(Rp.current),Cu(ga.current),Ay(e)){if(r=e.stateNode,n=e.memoizedProps,r[aa]=e,(i=r.nodeValue!==n)&&(t=Wi,t!==null))switch(t.tag){case 3:Py(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Py(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[aa]=e,e.stateNode=r}return Ts(e),null;case 13:if(ir(yr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ur&&$i!==null&&e.mode&1&&!(e.flags&128))wV(),zh(),e.flags|=98560,i=!1;else if(i=Ay(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Qe(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Qe(317));i[aa]=e}else zh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ts(e),i=!1}else jo!==null&&(lE(jo),jo=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||yr.current&1?Jr===0&&(Jr=3):lI())),e.updateQueue!==null&&(e.flags|=4),Ts(e),null);case 4:return Wh(),eE(t,e),t===null&&Np(e.stateNode.containerInfo),Ts(e),null;case 10:return W1(e.type._context),Ts(e),null;case 17:return gi(e.type)&&kv(),Ts(e),null;case 19:if(ir(yr),i=e.memoizedState,i===null)return Ts(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Kf(i,!1);else{if(Jr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ov(t),o!==null){for(e.flags|=128,Kf(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Jn(yr,yr.current&1|2),e.child}t=t.sibling}i.tail!==null&&Mr()>qh&&(e.flags|=128,r=!0,Kf(i,!1),e.lanes=4194304)}else{if(!r)if(t=Ov(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Kf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ur)return Ts(e),null}else 2*Mr()-i.renderingStartTime>qh&&n!==1073741824&&(e.flags|=128,r=!0,Kf(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Mr(),e.sibling=null,n=yr.current,Jn(yr,r?n&1|2:n&1),e):(Ts(e),null);case 22:case 23:return aI(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Di&1073741824&&(Ts(e),e.subtreeFlags&6&&(e.flags|=8192)):Ts(e),null;case 24:return null;case 25:return null}throw Error(Qe(156,e.tag))}function $Y(t,e){switch(U1(e),e.tag){case 1:return gi(e.type)&&kv(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Wh(),ir(pi),ir(Fs),J1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Y1(e),null;case 13:if(ir(yr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Qe(340));zh()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ir(yr),null;case 4:return Wh(),null;case 10:return W1(e.type._context),null;case 22:case 23:return aI(),null;case 24:return null;default:return null}}var jy=!1,Rs=!1,UY=typeof WeakSet=="function"?WeakSet:Set,vt=null;function ch(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Cr(t,e,r)}else n.current=null}function tE(t,e,n){try{n()}catch(r){Cr(t,e,r)}}var AR=!1;function BY(t,e){if(OC=Iv,t=aV(),V1(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++u===s&&(l=o),f===i&&++d===r&&(c=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(VC={focusedElem:t,selectionRange:n},Iv=!1,vt=e;vt!==null;)if(e=vt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,vt=t;else for(;vt!==null;){e=vt;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,w=g.memoizedState,v=e.stateNode,_=v.getSnapshotBeforeUpdate(e.elementType===e.type?x:No(e.type,x),w);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Qe(163))}}catch(T){Cr(e,e.return,T)}if(t=e.sibling,t!==null){t.return=e.return,vt=t;break}vt=e.return}return g=AR,AR=!1,g}function Gm(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&tE(e,n,i)}s=s.next}while(s!==r)}}function y0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function nE(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function r$(t){var e=t.alternate;e!==null&&(t.alternate=null,r$(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[aa],delete e[Ap],delete e[BC],delete e[CY],delete e[EY])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function s$(t){return t.tag===5||t.tag===3||t.tag===4}function kR(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||s$(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function rE(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Av));else if(r!==4&&(t=t.child,t!==null))for(rE(t,e,n),t=t.sibling;t!==null;)rE(t,e,n),t=t.sibling}function sE(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(sE(t,e,n),t=t.sibling;t!==null;)sE(t,e,n),t=t.sibling}var ds=null,Ao=!1;function _l(t,e,n){for(n=n.child;n!==null;)i$(t,e,n),n=n.sibling}function i$(t,e,n){if(pa&&typeof pa.onCommitFiberUnmount=="function")try{pa.onCommitFiberUnmount(c0,n)}catch{}switch(n.tag){case 5:Rs||ch(n,e);case 6:var r=ds,s=Ao;ds=null,_l(t,e,n),ds=r,Ao=s,ds!==null&&(Ao?(t=ds,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ds.removeChild(n.stateNode));break;case 18:ds!==null&&(Ao?(t=ds,n=n.stateNode,t.nodeType===8?j_(t.parentNode,n):t.nodeType===1&&j_(t,n),Ep(t)):j_(ds,n.stateNode));break;case 4:r=ds,s=Ao,ds=n.stateNode.containerInfo,Ao=!0,_l(t,e,n),ds=r,Ao=s;break;case 0:case 11:case 14:case 15:if(!Rs&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&tE(n,e,o),s=s.next}while(s!==r)}_l(t,e,n);break;case 1:if(!Rs&&(ch(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Cr(n,e,l)}_l(t,e,n);break;case 21:_l(t,e,n);break;case 22:n.mode&1?(Rs=(r=Rs)||n.memoizedState!==null,_l(t,e,n),Rs=r):_l(t,e,n);break;default:_l(t,e,n)}}function RR(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new UY),e.forEach(function(r){var s=XY.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Eo(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:ds=l.stateNode,Ao=!1;break e;case 3:ds=l.stateNode.containerInfo,Ao=!0;break e;case 4:ds=l.stateNode.containerInfo,Ao=!0;break e}l=l.return}if(ds===null)throw Error(Qe(160));i$(i,o,s),ds=null,Ao=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Cr(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)o$(e,t),e=e.sibling}function o$(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Eo(e,t),ea(t),r&4){try{Gm(3,t,t.return),y0(3,t)}catch(x){Cr(t,t.return,x)}try{Gm(5,t,t.return)}catch(x){Cr(t,t.return,x)}}break;case 1:Eo(e,t),ea(t),r&512&&n!==null&&ch(n,n.return);break;case 5:if(Eo(e,t),ea(t),r&512&&n!==null&&ch(n,n.return),t.flags&32){var s=t.stateNode;try{bp(s,"")}catch(x){Cr(t,t.return,x)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&NO(s,i),NC(l,o);var u=NC(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?jO(s,h):d==="dangerouslySetInnerHTML"?kO(s,h):d==="children"?bp(s,h):T1(s,d,h,u)}switch(l){case"input":SC(s,i);break;case"textarea":PO(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?_h(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?_h(s,!!i.multiple,i.defaultValue,!0):_h(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ap]=i}catch(x){Cr(t,t.return,x)}}break;case 6:if(Eo(e,t),ea(t),r&4){if(t.stateNode===null)throw Error(Qe(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(x){Cr(t,t.return,x)}}break;case 3:if(Eo(e,t),ea(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ep(e.containerInfo)}catch(x){Cr(t,t.return,x)}break;case 4:Eo(e,t),ea(t);break;case 13:Eo(e,t),ea(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(iI=Mr())),r&4&&RR(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Rs=(u=Rs)||d,Eo(e,t),Rs=u):Eo(e,t),ea(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(vt=t,d=t.child;d!==null;){for(h=vt=d;vt!==null;){switch(f=vt,m=f.child,f.tag){case 0:case 11:case 14:case 15:Gm(4,f,f.return);break;case 1:ch(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(x){Cr(r,n,x)}}break;case 5:ch(f,f.return);break;case 22:if(f.memoizedState!==null){DR(h);continue}}m!==null?(m.return=f,vt=m):DR(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=RO("display",o))}catch(x){Cr(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){Cr(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Eo(e,t),ea(t),r&4&&RR(t);break;case 21:break;default:Eo(e,t),ea(t)}}function ea(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(s$(n)){var r=n;break e}n=n.return}throw Error(Qe(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(bp(s,""),r.flags&=-33);var i=kR(t);sE(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=kR(t);rE(t,l,o);break;default:throw Error(Qe(161))}}catch(c){Cr(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function zY(t,e,n){vt=t,a$(t)}function a$(t,e,n){for(var r=(t.mode&1)!==0;vt!==null;){var s=vt,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||jy;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Rs;l=jy;var u=Rs;if(jy=o,(Rs=c)&&!u)for(vt=s;vt!==null;)o=vt,c=o.child,o.tag===22&&o.memoizedState!==null?MR(s):c!==null?(c.return=o,vt=c):MR(s);for(;i!==null;)vt=i,a$(i),i=i.sibling;vt=s,jy=l,Rs=u}jR(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,vt=i):jR(t)}}function jR(t){for(;vt!==null;){var e=vt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Rs||y0(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Rs)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:No(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&yR(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}yR(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Ep(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Qe(163))}Rs||e.flags&512&&nE(e)}catch(f){Cr(e,e.return,f)}}if(e===t){vt=null;break}if(n=e.sibling,n!==null){n.return=e.return,vt=n;break}vt=e.return}}function DR(t){for(;vt!==null;){var e=vt;if(e===t){vt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,vt=n;break}vt=e.return}}function MR(t){for(;vt!==null;){var e=vt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{y0(4,e)}catch(c){Cr(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Cr(e,s,c)}}var i=e.return;try{nE(e)}catch(c){Cr(e,i,c)}break;case 5:var o=e.return;try{nE(e)}catch(c){Cr(e,o,c)}}}catch(c){Cr(e,e.return,c)}if(e===t){vt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,vt=l;break}vt=e.return}}var GY=Math.ceil,Uv=pl.ReactCurrentDispatcher,rI=pl.ReactCurrentOwner,fo=pl.ReactCurrentBatchConfig,gn=0,ls=null,Vr=null,gs=0,Di=0,uh=Rc(0),Jr=0,Lp=null,Gu=0,x0=0,sI=0,Wm=null,ui=null,iI=0,qh=1/0,Ma=null,Bv=!1,iE=null,nc=null,Dy=!1,Kl=null,zv=0,Hm=0,oE=null,Ox=-1,Vx=0;function Xs(){return gn&6?Mr():Ox!==-1?Ox:Ox=Mr()}function rc(t){return t.mode&1?gn&2&&gs!==0?gs&-gs:IY.transition!==null?(Vx===0&&(Vx=WO()),Vx):(t=Ln,t!==0||(t=window.event,t=t===void 0?16:QO(t.type)),t):1}function $o(t,e,n,r){if(50<Hm)throw Hm=0,oE=null,Error(Qe(185));xg(t,n,r),(!(gn&2)||t!==ls)&&(t===ls&&(!(gn&2)&&(x0|=n),Jr===4&&Ul(t,gs)),yi(t,r),n===1&&gn===0&&!(e.mode&1)&&(qh=Mr()+500,m0&&jc()))}function yi(t,e){var n=t.callbackNode;IK(t,e);var r=Tv(t,t===ls?gs:0);if(r===0)n!==null&&Gk(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Gk(n),e===1)t.tag===0?TY(LR.bind(null,t)):yV(LR.bind(null,t)),_Y(function(){!(gn&6)&&jc()}),n=null;else{switch(HO(r)){case 1:n=k1;break;case 4:n=zO;break;case 16:n=Ev;break;case 536870912:n=GO;break;default:n=Ev}n=p$(n,l$.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function l$(t,e){if(Ox=-1,Vx=0,gn&6)throw Error(Qe(327));var n=t.callbackNode;if(Ih()&&t.callbackNode!==n)return null;var r=Tv(t,t===ls?gs:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Gv(t,r);else{e=r;var s=gn;gn|=2;var i=u$();(ls!==t||gs!==e)&&(Ma=null,qh=Mr()+500,ju(t,e));do try{qY();break}catch(l){c$(t,l)}while(1);G1(),Uv.current=i,gn=s,Vr!==null?e=0:(ls=null,gs=0,e=Jr)}if(e!==0){if(e===2&&(s=jC(t),s!==0&&(r=s,e=aE(t,s))),e===1)throw n=Lp,ju(t,0),Ul(t,r),yi(t,Mr()),n;if(e===6)Ul(t,r);else{if(s=t.current.alternate,!(r&30)&&!WY(s)&&(e=Gv(t,r),e===2&&(i=jC(t),i!==0&&(r=i,e=aE(t,i))),e===1))throw n=Lp,ju(t,0),Ul(t,r),yi(t,Mr()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(Qe(345));case 2:au(t,ui,Ma);break;case 3:if(Ul(t,r),(r&130023424)===r&&(e=iI+500-Mr(),10<e)){if(Tv(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Xs(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=UC(au.bind(null,t,ui,Ma),e);break}au(t,ui,Ma);break;case 4:if(Ul(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Vo(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Mr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*GY(r/1960))-r,10<r){t.timeoutHandle=UC(au.bind(null,t,ui,Ma),r);break}au(t,ui,Ma);break;case 5:au(t,ui,Ma);break;default:throw Error(Qe(329))}}}return yi(t,Mr()),t.callbackNode===n?l$.bind(null,t):null}function aE(t,e){var n=Wm;return t.current.memoizedState.isDehydrated&&(ju(t,e).flags|=256),t=Gv(t,e),t!==2&&(e=ui,ui=n,e!==null&&lE(e)),t}function lE(t){ui===null?ui=t:ui.push.apply(ui,t)}function WY(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!zo(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ul(t,e){for(e&=~sI,e&=~x0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Vo(e),r=1<<n;t[n]=-1,e&=~r}}function LR(t){if(gn&6)throw Error(Qe(327));Ih();var e=Tv(t,0);if(!(e&1))return yi(t,Mr()),null;var n=Gv(t,e);if(t.tag!==0&&n===2){var r=jC(t);r!==0&&(e=r,n=aE(t,r))}if(n===1)throw n=Lp,ju(t,0),Ul(t,e),yi(t,Mr()),n;if(n===6)throw Error(Qe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,au(t,ui,Ma),yi(t,Mr()),null}function oI(t,e){var n=gn;gn|=1;try{return t(e)}finally{gn=n,gn===0&&(qh=Mr()+500,m0&&jc())}}function Wu(t){Kl!==null&&Kl.tag===0&&!(gn&6)&&Ih();var e=gn;gn|=1;var n=fo.transition,r=Ln;try{if(fo.transition=null,Ln=1,t)return t()}finally{Ln=r,fo.transition=n,gn=e,!(gn&6)&&jc()}}function aI(){Di=uh.current,ir(uh)}function ju(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,bY(n)),Vr!==null)for(n=Vr.return;n!==null;){var r=n;switch(U1(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&kv();break;case 3:Wh(),ir(pi),ir(Fs),J1();break;case 5:Y1(r);break;case 4:Wh();break;case 13:ir(yr);break;case 19:ir(yr);break;case 10:W1(r.type._context);break;case 22:case 23:aI()}n=n.return}if(ls=t,Vr=t=sc(t.current,null),gs=Di=e,Jr=0,Lp=null,sI=x0=Gu=0,ui=Wm=null,Su!==null){for(e=0;e<Su.length;e++)if(n=Su[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Su=null}return t}function c$(t,e){do{var n=Vr;try{if(G1(),Mx.current=$v,Vv){for(var r=wr.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Vv=!1}if(zu=0,os=Yr=wr=null,zm=!1,jp=0,rI.current=null,n===null||n.return===null){Jr=1,Lp=e,Vr=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=gs,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=SR(o);if(m!==null){m.flags&=-257,CR(m,o,l,i,e),m.mode&1&&_R(i,u,e),e=m,c=u;var g=e.updateQueue;if(g===null){var x=new Set;x.add(c),e.updateQueue=x}else g.add(c);break e}else{if(!(e&1)){_R(i,u,e),lI();break e}c=Error(Qe(426))}}else if(ur&&l.mode&1){var w=SR(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),CR(w,o,l,i,e),B1(Hh(c,l));break e}}i=c=Hh(c,l),Jr!==4&&(Jr=2),Wm===null?Wm=[i]:Wm.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=HV(i,c,e);gR(i,v);break e;case 1:l=c;var _=i.type,C=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(nc===null||!nc.has(C)))){i.flags|=65536,e&=-e,i.lanes|=e;var T=qV(i,l,e);gR(i,T);break e}}i=i.return}while(i!==null)}h$(n)}catch(R){e=R,Vr===n&&n!==null&&(Vr=n=n.return);continue}break}while(1)}function u$(){var t=Uv.current;return Uv.current=$v,t===null?$v:t}function lI(){(Jr===0||Jr===3||Jr===2)&&(Jr=4),ls===null||!(Gu&268435455)&&!(x0&268435455)||Ul(ls,gs)}function Gv(t,e){var n=gn;gn|=2;var r=u$();(ls!==t||gs!==e)&&(Ma=null,ju(t,e));do try{HY();break}catch(s){c$(t,s)}while(1);if(G1(),gn=n,Uv.current=r,Vr!==null)throw Error(Qe(261));return ls=null,gs=0,Jr}function HY(){for(;Vr!==null;)d$(Vr)}function qY(){for(;Vr!==null&&!xK();)d$(Vr)}function d$(t){var e=m$(t.alternate,t,Di);t.memoizedProps=t.pendingProps,e===null?h$(t):Vr=e,rI.current=null}function h$(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=$Y(n,e),n!==null){n.flags&=32767,Vr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Jr=6,Vr=null;return}}else if(n=VY(n,e,Di),n!==null){Vr=n;return}if(e=e.sibling,e!==null){Vr=e;return}Vr=e=t}while(e!==null);Jr===0&&(Jr=5)}function au(t,e,n){var r=Ln,s=fo.transition;try{fo.transition=null,Ln=1,KY(t,e,n,r)}finally{fo.transition=s,Ln=r}return null}function KY(t,e,n,r){do Ih();while(Kl!==null);if(gn&6)throw Error(Qe(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Qe(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(NK(t,i),t===ls&&(Vr=ls=null,gs=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Dy||(Dy=!0,p$(Ev,function(){return Ih(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=fo.transition,fo.transition=null;var o=Ln;Ln=1;var l=gn;gn|=4,rI.current=null,BY(t,n),o$(n,t),mY(VC),Iv=!!OC,VC=OC=null,t.current=n,zY(n),vK(),gn=l,Ln=o,fo.transition=i}else t.current=n;if(Dy&&(Dy=!1,Kl=t,zv=s),i=t.pendingLanes,i===0&&(nc=null),_K(n.stateNode),yi(t,Mr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Bv)throw Bv=!1,t=iE,iE=null,t;return zv&1&&t.tag!==0&&Ih(),i=t.pendingLanes,i&1?t===oE?Hm++:(Hm=0,oE=t):Hm=0,jc(),null}function Ih(){if(Kl!==null){var t=HO(zv),e=fo.transition,n=Ln;try{if(fo.transition=null,Ln=16>t?16:t,Kl===null)var r=!1;else{if(t=Kl,Kl=null,zv=0,gn&6)throw Error(Qe(331));var s=gn;for(gn|=4,vt=t.current;vt!==null;){var i=vt,o=i.child;if(vt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(vt=u;vt!==null;){var d=vt;switch(d.tag){case 0:case 11:case 15:Gm(8,d,i)}var h=d.child;if(h!==null)h.return=d,vt=h;else for(;vt!==null;){d=vt;var f=d.sibling,m=d.return;if(r$(d),d===u){vt=null;break}if(f!==null){f.return=m,vt=f;break}vt=m}}}var g=i.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var w=x.sibling;x.sibling=null,x=w}while(x!==null)}}vt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,vt=o;else e:for(;vt!==null;){if(i=vt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Gm(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,vt=v;break e}vt=i.return}}var _=t.current;for(vt=_;vt!==null;){o=vt;var C=o.child;if(o.subtreeFlags&2064&&C!==null)C.return=o,vt=C;else e:for(o=_;vt!==null;){if(l=vt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:y0(9,l)}}catch(R){Cr(l,l.return,R)}if(l===o){vt=null;break e}var T=l.sibling;if(T!==null){T.return=l.return,vt=T;break e}vt=l.return}}if(gn=s,jc(),pa&&typeof pa.onPostCommitFiberRoot=="function")try{pa.onPostCommitFiberRoot(c0,t)}catch{}r=!0}return r}finally{Ln=n,fo.transition=e}}return!1}function FR(t,e,n){e=Hh(n,e),e=HV(t,e,1),t=tc(t,e,1),e=Xs(),t!==null&&(xg(t,1,e),yi(t,e))}function Cr(t,e,n){if(t.tag===3)FR(t,t,n);else for(;e!==null;){if(e.tag===3){FR(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(nc===null||!nc.has(r))){t=Hh(n,t),t=qV(e,t,1),e=tc(e,t,1),t=Xs(),e!==null&&(xg(e,1,t),yi(e,t));break}}e=e.return}}function YY(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Xs(),t.pingedLanes|=t.suspendedLanes&n,ls===t&&(gs&n)===n&&(Jr===4||Jr===3&&(gs&130023424)===gs&&500>Mr()-iI?ju(t,0):sI|=n),yi(t,e)}function f$(t,e){e===0&&(t.mode&1?(e=Cy,Cy<<=1,!(Cy&130023424)&&(Cy=4194304)):e=1);var n=Xs();t=rl(t,e),t!==null&&(xg(t,e,n),yi(t,n))}function JY(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),f$(t,n)}function XY(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Qe(314))}r!==null&&r.delete(e),f$(t,n)}var m$;m$=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||pi.current)di=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return di=!1,OY(t,e,n);di=!!(t.flags&131072)}else di=!1,ur&&e.flags&1048576&&xV(e,Dv,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Fx(t,e),t=e.pendingProps;var s=Bh(e,Fs.current);Th(e,n),s=Q1(null,e,r,t,s,n);var i=Z1();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,gi(r)?(i=!0,Rv(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,q1(e),s.updater=g0,e.stateNode=s,s._reactInternals=e,KC(e,r,t,n),e=XC(null,e,r,!0,i,n)):(e.tag=0,ur&&i&&$1(e),qs(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Fx(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=ZY(r),t=No(r,t),s){case 0:e=JC(null,e,r,t,n);break e;case 1:e=IR(null,e,r,t,n);break e;case 11:e=ER(null,e,r,t,n);break e;case 14:e=TR(null,e,r,No(r.type,t),n);break e}throw Error(Qe(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:No(r,s),JC(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:No(r,s),IR(t,e,r,s,n);case 3:e:{if(XV(e),t===null)throw Error(Qe(387));r=e.pendingProps,i=e.memoizedState,s=i.element,CV(t,e),Fv(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Hh(Error(Qe(423)),e),e=NR(t,e,r,n,s);break e}else if(r!==s){s=Hh(Error(Qe(424)),e),e=NR(t,e,r,n,s);break e}else for($i=ec(e.stateNode.containerInfo.firstChild),Wi=e,ur=!0,jo=null,n=_V(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(zh(),r===s){e=sl(t,e,n);break e}qs(t,e,r,n)}e=e.child}return e;case 5:return EV(e),t===null&&WC(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,$C(r,s)?o=null:i!==null&&$C(r,i)&&(e.flags|=32),JV(t,e),qs(t,e,o,n),e.child;case 6:return t===null&&WC(e),null;case 13:return QV(t,e,n);case 4:return K1(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Gh(e,null,r,n):qs(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:No(r,s),ER(t,e,r,s,n);case 7:return qs(t,e,e.pendingProps,n),e.child;case 8:return qs(t,e,e.pendingProps.children,n),e.child;case 12:return qs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Jn(Mv,r._currentValue),r._currentValue=o,i!==null)if(zo(i.value,o)){if(i.children===s.children&&!pi.current){e=sl(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=qa(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),HC(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Qe(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),HC(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}qs(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Th(e,n),s=yo(s),r=r(s),e.flags|=1,qs(t,e,r,n),e.child;case 14:return r=e.type,s=No(r,e.pendingProps),s=No(r.type,s),TR(t,e,r,s,n);case 15:return KV(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:No(r,s),Fx(t,e),e.tag=1,gi(r)?(t=!0,Rv(e)):t=!1,Th(e,n),WV(e,r,s),KC(e,r,s,n),XC(null,e,r,!0,t,n);case 19:return ZV(t,e,n);case 22:return YV(t,e,n)}throw Error(Qe(156,e.tag))};function p$(t,e){return BO(t,e)}function QY(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function co(t,e,n,r){return new QY(t,e,n,r)}function cI(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ZY(t){if(typeof t=="function")return cI(t)?1:0;if(t!=null){if(t=t.$$typeof,t===N1)return 11;if(t===P1)return 14}return 2}function sc(t,e){var n=t.alternate;return n===null?(n=co(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function $x(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")cI(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case eh:return Du(n.children,s,i,e);case I1:o=8,s|=8;break;case xC:return t=co(12,n,e,s|2),t.elementType=xC,t.lanes=i,t;case vC:return t=co(13,n,e,s),t.elementType=vC,t.lanes=i,t;case wC:return t=co(19,n,e,s),t.elementType=wC,t.lanes=i,t;case EO:return v0(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case SO:o=10;break e;case CO:o=9;break e;case N1:o=11;break e;case P1:o=14;break e;case Fl:o=16,r=null;break e}throw Error(Qe(130,t==null?t:typeof t,""))}return e=co(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Du(t,e,n,r){return t=co(7,t,r,e),t.lanes=n,t}function v0(t,e,n,r){return t=co(22,t,r,e),t.elementType=EO,t.lanes=n,t.stateNode={isHidden:!1},t}function U_(t,e,n){return t=co(6,t,null,e),t.lanes=n,t}function B_(t,e,n){return e=co(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function eJ(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=__(0),this.expirationTimes=__(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=__(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function uI(t,e,n,r,s,i,o,l,c){return t=new eJ(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=co(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},q1(i),t}function tJ(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zd,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function g$(t){if(!t)return wc;t=t._reactInternals;e:{if(ud(t)!==t||t.tag!==1)throw Error(Qe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(gi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Qe(171))}if(t.tag===1){var n=t.type;if(gi(n))return gV(t,n,e)}return e}function y$(t,e,n,r,s,i,o,l,c){return t=uI(n,r,!0,t,s,i,o,l,c),t.context=g$(null),n=t.current,r=Xs(),s=rc(n),i=qa(r,s),i.callback=e??null,tc(n,i,s),t.current.lanes=s,xg(t,s,r),yi(t,r),t}function w0(t,e,n,r){var s=e.current,i=Xs(),o=rc(s);return n=g$(n),e.context===null?e.context=n:e.pendingContext=n,e=qa(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=tc(s,e,o),t!==null&&($o(t,s,o,i),Dx(t,s,o)),o}function Wv(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function OR(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function dI(t,e){OR(t,e),(t=t.alternate)&&OR(t,e)}function nJ(){return null}var x$=typeof reportError=="function"?reportError:function(t){console.error(t)};function hI(t){this._internalRoot=t}b0.prototype.render=hI.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Qe(409));w0(t,e,null,null)};b0.prototype.unmount=hI.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Wu(function(){w0(null,t,null,null)}),e[nl]=null}};function b0(t){this._internalRoot=t}b0.prototype.unstable_scheduleHydration=function(t){if(t){var e=YO();t={blockedOn:null,target:t,priority:e};for(var n=0;n<$l.length&&e!==0&&e<$l[n].priority;n++);$l.splice(n,0,t),n===0&&XO(t)}};function fI(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function _0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function VR(){}function rJ(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Wv(o);i.call(u)}}var o=y$(e,r,t,0,null,!1,!1,"",VR);return t._reactRootContainer=o,t[nl]=o.current,Np(t.nodeType===8?t.parentNode:t),Wu(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Wv(c);l.call(u)}}var c=uI(t,0,!1,null,null,!1,!1,"",VR);return t._reactRootContainer=c,t[nl]=c.current,Np(t.nodeType===8?t.parentNode:t),Wu(function(){w0(e,c,n,r)}),c}function S0(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Wv(o);l.call(c)}}w0(e,o,t,s)}else o=rJ(n,e,t,s,r);return Wv(o)}qO=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=vm(e.pendingLanes);n!==0&&(R1(e,n|1),yi(e,Mr()),!(gn&6)&&(qh=Mr()+500,jc()))}break;case 13:Wu(function(){var r=rl(t,1);if(r!==null){var s=Xs();$o(r,t,1,s)}}),dI(t,1)}};j1=function(t){if(t.tag===13){var e=rl(t,134217728);if(e!==null){var n=Xs();$o(e,t,134217728,n)}dI(t,134217728)}};KO=function(t){if(t.tag===13){var e=rc(t),n=rl(t,e);if(n!==null){var r=Xs();$o(n,t,e,r)}dI(t,e)}};YO=function(){return Ln};JO=function(t,e){var n=Ln;try{return Ln=t,e()}finally{Ln=n}};AC=function(t,e,n){switch(e){case"input":if(SC(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=f0(r);if(!s)throw Error(Qe(90));IO(r),SC(r,s)}}}break;case"textarea":PO(t,n);break;case"select":e=n.value,e!=null&&_h(t,!!n.multiple,e,!1)}};LO=oI;FO=Wu;var sJ={usingClientEntryPoint:!1,Events:[wg,sh,f0,DO,MO,oI]},Yf={findFiberByHostInstance:_u,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iJ={bundleType:Yf.bundleType,version:Yf.version,rendererPackageName:Yf.rendererPackageName,rendererConfig:Yf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=$O(t),t===null?null:t.stateNode},findFiberByHostInstance:Yf.findFiberByHostInstance||nJ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var My=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!My.isDisabled&&My.supportsFiber)try{c0=My.inject(iJ),pa=My}catch{}}Xi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sJ;Xi.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fI(e))throw Error(Qe(200));return tJ(t,e,null,n)};Xi.createRoot=function(t,e){if(!fI(t))throw Error(Qe(299));var n=!1,r="",s=x$;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=uI(t,1,!1,null,null,n,!1,r,s),t[nl]=e.current,Np(t.nodeType===8?t.parentNode:t),new hI(e)};Xi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Qe(188)):(t=Object.keys(t).join(","),Error(Qe(268,t)));return t=$O(e),t=t===null?null:t.stateNode,t};Xi.flushSync=function(t){return Wu(t)};Xi.hydrate=function(t,e,n){if(!_0(e))throw Error(Qe(200));return S0(null,t,e,!0,n)};Xi.hydrateRoot=function(t,e,n){if(!fI(t))throw Error(Qe(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=x$;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=y$(e,null,t,1,n??null,s,!1,i,o),t[nl]=e.current,Np(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new b0(e)};Xi.render=function(t,e,n){if(!_0(e))throw Error(Qe(200));return S0(null,t,e,!1,n)};Xi.unmountComponentAtNode=function(t){if(!_0(t))throw Error(Qe(40));return t._reactRootContainer?(Wu(function(){S0(null,null,t,!1,function(){t._reactRootContainer=null,t[nl]=null})}),!0):!1};Xi.unstable_batchedUpdates=oI;Xi.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!_0(n))throw Error(Qe(200));if(t==null||t._reactInternals===void 0)throw Error(Qe(38));return S0(t,e,n,!1,r)};Xi.version="18.3.1-next-f1338f8080-20240426";function v$(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(v$)}catch(t){console.error(t)}}v$(),vO.exports=Xi;var gl=vO.exports;const mI=o0(gl),oJ=aO({__proto__:null,default:mI},[gl]);var $R=gl;gC.createRoot=$R.createRoot,gC.hydrateRoot=$R.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lr(){return lr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lr.apply(this,arguments)}var Dr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Dr||(Dr={}));const UR="popstate";function aJ(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Fp("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Hu(s)}return cJ(e,n,null,t)}function sn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Kh(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function lJ(){return Math.random().toString(36).substr(2,8)}function BR(t,e){return{usr:t.state,key:t.key,idx:e}}function Fp(t,e,n,r){return n===void 0&&(n=null),lr({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?yl(e):e,{state:n,key:e&&e.key||r||lJ()})}function Hu(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function yl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function cJ(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=Dr.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(lr({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){l=Dr.Pop;let w=d(),v=w==null?null:w-u;u=w,c&&c({action:l,location:x.location,delta:v})}function f(w,v){l=Dr.Push;let _=Fp(x.location,w,v);n&&n(_,w),u=d()+1;let C=BR(_,u),T=x.createHref(_);try{o.pushState(C,"",T)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;s.location.assign(T)}i&&c&&c({action:l,location:x.location,delta:1})}function m(w,v){l=Dr.Replace;let _=Fp(x.location,w,v);n&&n(_,w),u=d();let C=BR(_,u),T=x.createHref(_);o.replaceState(C,"",T),i&&c&&c({action:l,location:x.location,delta:0})}function g(w){let v=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof w=="string"?w:Hu(w);return _=_.replace(/ $/,"%20"),sn(v,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,v)}let x={get action(){return l},get location(){return t(s,o)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(UR,h),c=w,()=>{s.removeEventListener(UR,h),c=null}},createHref(w){return e(s,w)},createURL:g,encodeLocation(w){let v=g(w);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:m,go(w){return o.go(w)}};return x}var Dn;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Dn||(Dn={}));const uJ=new Set(["lazy","caseSensitive","path","id","index","children"]);function dJ(t){return t.index===!0}function Hv(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,i)=>{let o=[...n,String(i)],l=typeof s.id=="string"?s.id:o.join("-");if(sn(s.index!==!0||!s.children,"Cannot specify children on an index route"),sn(!r[l],'Found a route id collision on id "'+l+`".  Route id's must be globally unique within Data Router usages`),dJ(s)){let c=lr({},s,e(s),{id:l});return r[l]=c,c}else{let c=lr({},s,e(s),{id:l,children:void 0});return r[l]=c,s.children&&(c.children=Hv(s.children,e,o,r)),c}})}function mu(t,e,n){return n===void 0&&(n="/"),Ux(t,e,n,!1)}function Ux(t,e,n,r){let s=typeof e=="string"?yl(e):e,i=Sf(s.pathname||"/",n);if(i==null)return null;let o=w$(t);fJ(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=CJ(i);l=_J(o[c],u,r)}return l}function hJ(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function w$(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(sn(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Ka([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(sn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),w$(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:wJ(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of b$(i.path))s(i,o,c)}),e}function b$(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=b$(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function fJ(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:bJ(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const mJ=/^:[\w-]+$/,pJ=3,gJ=2,yJ=1,xJ=10,vJ=-2,zR=t=>t==="*";function wJ(t,e){let n=t.split("/"),r=n.length;return n.some(zR)&&(r+=vJ),e&&(r+=gJ),n.filter(s=>!zR(s)).reduce((s,i)=>s+(mJ.test(i)?pJ:i===""?yJ:xJ),r)}function bJ(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function _J(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=GR({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h&&u&&n&&!r[r.length-1].route.index&&(h=GR({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:Ka([i,h.pathname]),pathnameBase:IJ(Ka([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=Ka([i,h.pathnameBase]))}return o}function GR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=SJ(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,h)=>{let{paramName:f,isOptional:m}=d;if(f==="*"){let x=l[h]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const g=l[h];return m&&!g?u[f]=void 0:u[f]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function SJ(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Kh(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function CJ(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Kh(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Sf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function EJ(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?yl(t):t;return{pathname:n?n.startsWith("/")?n:TJ(n,e):e,search:NJ(r),hash:PJ(s)}}function TJ(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function z_(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function _$(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function C0(t,e){let n=_$(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function E0(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=yl(t):(s=lr({},t),sn(!s.pathname||!s.pathname.includes("?"),z_("?","pathname","search",s)),sn(!s.pathname||!s.pathname.includes("#"),z_("#","pathname","hash",s)),sn(!s.search||!s.search.includes("#"),z_("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let h=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}l=h>=0?e[h]:"/"}let c=EJ(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Ka=t=>t.join("/").replace(/\/\/+/g,"/"),IJ=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),NJ=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,PJ=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class qv{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function Op(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const S$=["post","put","patch","delete"],AJ=new Set(S$),kJ=["get",...S$],RJ=new Set(kJ),jJ=new Set([301,302,303,307,308]),DJ=new Set([307,308]),G_={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},MJ={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Jf={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},pI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LJ=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),C$="remix-router-transitions";function FJ(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;sn(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let J=t.detectErrorBoundary;s=ue=>({hasErrorBoundary:J(ue)})}else s=LJ;let i={},o=Hv(t.routes,s,void 0,i),l,c=t.basename||"/",u=t.dataStrategy||UJ,d=t.patchRoutesOnNavigation,h=lr({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,m=new Set,g=null,x=null,w=null,v=t.hydrationData!=null,_=mu(o,t.history.location,c),C=!1,T=null;if(_==null&&!d){let J=ci(404,{pathname:t.history.location.pathname}),{matches:ue,route:we}=tj(o);_=ue,T={[we.id]:J}}_&&!t.hydrationData&&mn(_,o,t.history.location.pathname).active&&(_=null);let R;if(_)if(_.some(J=>J.route.lazy))R=!1;else if(!_.some(J=>J.route.loader))R=!0;else if(h.v7_partialHydration){let J=t.hydrationData?t.hydrationData.loaderData:null,ue=t.hydrationData?t.hydrationData.errors:null;if(ue){let we=_.findIndex(Le=>ue[Le.route.id]!==void 0);R=_.slice(0,we+1).every(Le=>!uE(Le.route,J,ue))}else R=_.every(we=>!uE(we.route,J,ue))}else R=t.hydrationData!=null;else if(R=!1,_=[],h.v7_partialHydration){let J=mn(null,o,t.history.location.pathname);J.active&&J.matches&&(C=!0,_=J.matches)}let A,E={historyAction:t.history.action,location:t.history.location,matches:_,initialized:R,navigation:G_,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||T,fetchers:new Map,blockers:new Map},I=Dr.Pop,P=!1,k,j=!1,D=new Map,M=null,G=!1,B=!1,W=[],Q=new Set,H=new Map,Y=0,V=-1,$=new Map,z=new Set,F=new Map,Z=new Map,fe=new Set,xe=new Map,ge=new Map,Re;function Ue(){if(f=t.history.listen(J=>{let{action:ue,location:we,delta:Le}=J;if(Re){Re(),Re=void 0;return}Kh(ge.size===0||Le!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Ze=wt({currentLocation:E.location,nextLocation:we,historyAction:ue});if(Ze&&Le!=null){let X=new Promise(ne=>{Re=ne});t.history.go(Le*-1),Et(Ze,{state:"blocked",location:we,proceed(){Et(Ze,{state:"proceeding",proceed:void 0,reset:void 0,location:we}),X.then(()=>t.history.go(Le))},reset(){let ne=new Map(E.blockers);ne.set(Ze,Jf),Ce({blockers:ne})}});return}return Me(ue,we)}),n){tX(e,D);let J=()=>nX(e,D);e.addEventListener("pagehide",J),M=()=>e.removeEventListener("pagehide",J)}return E.initialized||Me(Dr.Pop,E.location,{initialHydration:!0}),A}function ze(){f&&f(),M&&M(),m.clear(),k&&k.abort(),E.fetchers.forEach((J,ue)=>Ae(ue)),E.blockers.forEach((J,ue)=>Te(ue))}function he(J){return m.add(J),()=>m.delete(J)}function Ce(J,ue){ue===void 0&&(ue={}),E=lr({},E,J);let we=[],Le=[];h.v7_fetcherPersist&&E.fetchers.forEach((Ze,X)=>{Ze.state==="idle"&&(fe.has(X)?Le.push(X):we.push(X))}),fe.forEach(Ze=>{!E.fetchers.has(Ze)&&!H.has(Ze)&&Le.push(Ze)}),[...m].forEach(Ze=>Ze(E,{deletedFetchers:Le,viewTransitionOpts:ue.viewTransitionOpts,flushSync:ue.flushSync===!0})),h.v7_fetcherPersist?(we.forEach(Ze=>E.fetchers.delete(Ze)),Le.forEach(Ze=>Ae(Ze))):Le.forEach(Ze=>fe.delete(Ze))}function Pe(J,ue,we){var Le,Ze;let{flushSync:X}=we===void 0?{}:we,ne=E.actionData!=null&&E.navigation.formMethod!=null&&ko(E.navigation.formMethod)&&E.navigation.state==="loading"&&((Le=J.state)==null?void 0:Le._isRedirect)!==!0,me;ue.actionData?Object.keys(ue.actionData).length>0?me=ue.actionData:me=null:ne?me=E.actionData:me=null;let q=ue.loaderData?ZR(E.loaderData,ue.loaderData,ue.matches||[],ue.errors):E.loaderData,ie=E.blockers;ie.size>0&&(ie=new Map(ie),ie.forEach((Ve,Se)=>ie.set(Se,Jf)));let be=P===!0||E.navigation.formMethod!=null&&ko(E.navigation.formMethod)&&((Ze=J.state)==null?void 0:Ze._isRedirect)!==!0;l&&(o=l,l=void 0),G||I===Dr.Pop||(I===Dr.Push?t.history.push(J,J.state):I===Dr.Replace&&t.history.replace(J,J.state));let Ie;if(I===Dr.Pop){let Ve=D.get(E.location.pathname);Ve&&Ve.has(J.pathname)?Ie={currentLocation:E.location,nextLocation:J}:D.has(J.pathname)&&(Ie={currentLocation:J,nextLocation:E.location})}else if(j){let Ve=D.get(E.location.pathname);Ve?Ve.add(J.pathname):(Ve=new Set([J.pathname]),D.set(E.location.pathname,Ve)),Ie={currentLocation:E.location,nextLocation:J}}Ce(lr({},ue,{actionData:me,loaderData:q,historyAction:I,location:J,initialized:!0,navigation:G_,revalidation:"idle",restoreScrollPosition:mr(J,ue.matches||E.matches),preventScrollReset:be,blockers:ie}),{viewTransitionOpts:Ie,flushSync:X===!0}),I=Dr.Pop,P=!1,j=!1,G=!1,B=!1,W=[]}async function ve(J,ue){if(typeof J=="number"){t.history.go(J);return}let we=cE(E.location,E.matches,c,h.v7_prependBasename,J,h.v7_relativeSplatPath,ue==null?void 0:ue.fromRouteId,ue==null?void 0:ue.relative),{path:Le,submission:Ze,error:X}=WR(h.v7_normalizeFormMethod,!1,we,ue),ne=E.location,me=Fp(E.location,Le,ue&&ue.state);me=lr({},me,t.history.encodeLocation(me));let q=ue&&ue.replace!=null?ue.replace:void 0,ie=Dr.Push;q===!0?ie=Dr.Replace:q===!1||Ze!=null&&ko(Ze.formMethod)&&Ze.formAction===E.location.pathname+E.location.search&&(ie=Dr.Replace);let be=ue&&"preventScrollReset"in ue?ue.preventScrollReset===!0:void 0,Ie=(ue&&ue.flushSync)===!0,Ve=wt({currentLocation:ne,nextLocation:me,historyAction:ie});if(Ve){Et(Ve,{state:"blocked",location:me,proceed(){Et(Ve,{state:"proceeding",proceed:void 0,reset:void 0,location:me}),ve(J,ue)},reset(){let Se=new Map(E.blockers);Se.set(Ve,Jf),Ce({blockers:Se})}});return}return await Me(ie,me,{submission:Ze,pendingError:X,preventScrollReset:be,replace:ue&&ue.replace,enableViewTransition:ue&&ue.viewTransition,flushSync:Ie})}function de(){if(Ee(),Ce({revalidation:"loading"}),E.navigation.state!=="submitting"){if(E.navigation.state==="idle"){Me(E.historyAction,E.location,{startUninterruptedRevalidation:!0});return}Me(I||E.historyAction,E.navigation.location,{overrideNavigation:E.navigation,enableViewTransition:j===!0})}}async function Me(J,ue,we){k&&k.abort(),k=null,I=J,G=(we&&we.startUninterruptedRevalidation)===!0,Tn(E.location,E.matches),P=(we&&we.preventScrollReset)===!0,j=(we&&we.enableViewTransition)===!0;let Le=l||o,Ze=we&&we.overrideNavigation,X=we!=null&&we.initialHydration&&E.matches&&E.matches.length>0&&!C?E.matches:mu(Le,ue,c),ne=(we&&we.flushSync)===!0;if(X&&E.initialized&&!B&&qJ(E.location,ue)&&!(we&&we.submission&&ko(we.submission.formMethod))){Pe(ue,{matches:X},{flushSync:ne});return}let me=mn(X,Le,ue.pathname);if(me.active&&me.matches&&(X=me.matches),!X){let{error:ot,notFoundMatches:lt,route:jt}=xt(ue.pathname);Pe(ue,{matches:lt,loaderData:{},errors:{[jt.id]:ot}},{flushSync:ne});return}k=new AbortController;let q=Nd(t.history,ue,k.signal,we&&we.submission),ie;if(we&&we.pendingError)ie=[pu(X).route.id,{type:Dn.error,error:we.pendingError}];else if(we&&we.submission&&ko(we.submission.formMethod)){let ot=await Ge(q,ue,we.submission,X,me.active,{replace:we.replace,flushSync:ne});if(ot.shortCircuited)return;if(ot.pendingActionResult){let[lt,jt]=ot.pendingActionResult;if(Mi(jt)&&Op(jt.error)&&jt.error.status===404){k=null,Pe(ue,{matches:ot.matches,loaderData:{},errors:{[lt]:jt.error}});return}}X=ot.matches||X,ie=ot.pendingActionResult,Ze=W_(ue,we.submission),ne=!1,me.active=!1,q=Nd(t.history,q.url,q.signal)}let{shortCircuited:be,matches:Ie,loaderData:Ve,errors:Se}=await yt(q,ue,X,me.active,Ze,we&&we.submission,we&&we.fetcherSubmission,we&&we.replace,we&&we.initialHydration===!0,ne,ie);be||(k=null,Pe(ue,lr({matches:Ie||X},ej(ie),{loaderData:Ve,errors:Se})))}async function Ge(J,ue,we,Le,Ze,X){X===void 0&&(X={}),Ee();let ne=ZJ(ue,we);if(Ce({navigation:ne},{flushSync:X.flushSync===!0}),Ze){let ie=await Ft(Le,ue.pathname,J.signal);if(ie.type==="aborted")return{shortCircuited:!0};if(ie.type==="error"){let be=pu(ie.partialMatches).route.id;return{matches:ie.partialMatches,pendingActionResult:[be,{type:Dn.error,error:ie.error}]}}else if(ie.matches)Le=ie.matches;else{let{notFoundMatches:be,error:Ie,route:Ve}=xt(ue.pathname);return{matches:be,pendingActionResult:[Ve.id,{type:Dn.error,error:Ie}]}}}let me,q=bm(Le,ue);if(!q.route.action&&!q.route.lazy)me={type:Dn.error,error:ci(405,{method:J.method,pathname:ue.pathname,routeId:q.route.id})};else if(me=(await xn("action",E,J,[q],Le,null))[q.route.id],J.signal.aborted)return{shortCircuited:!0};if(Eu(me)){let ie;return X&&X.replace!=null?ie=X.replace:ie=JR(me.response.headers.get("Location"),new URL(J.url),c)===E.location.pathname+E.location.search,await Lt(J,me,!0,{submission:we,replace:ie}),{shortCircuited:!0}}if(Yl(me))throw ci(400,{type:"defer-action"});if(Mi(me)){let ie=pu(Le,q.route.id);return(X&&X.replace)!==!0&&(I=Dr.Push),{matches:Le,pendingActionResult:[ie.route.id,me]}}return{matches:Le,pendingActionResult:[q.route.id,me]}}async function yt(J,ue,we,Le,Ze,X,ne,me,q,ie,be){let Ie=Ze||W_(ue,X),Ve=X||ne||rj(Ie),Se=!G&&(!h.v7_partialHydration||!q);if(Le){if(Se){let In=Pt(be);Ce(lr({navigation:Ie},In!==void 0?{actionData:In}:{}),{flushSync:ie})}let tn=await Ft(we,ue.pathname,J.signal);if(tn.type==="aborted")return{shortCircuited:!0};if(tn.type==="error"){let In=pu(tn.partialMatches).route.id;return{matches:tn.partialMatches,loaderData:{},errors:{[In]:tn.error}}}else if(tn.matches)we=tn.matches;else{let{error:In,notFoundMatches:si,route:ii}=xt(ue.pathname);return{matches:si,loaderData:{},errors:{[ii.id]:In}}}}let ot=l||o,[lt,jt]=qR(t.history,E,we,Ve,ue,h.v7_partialHydration&&q===!0,h.v7_skipActionErrorRevalidation,B,W,Q,fe,F,z,ot,c,be);if(pt(tn=>!(we&&we.some(In=>In.route.id===tn))||lt&&lt.some(In=>In.route.id===tn)),V=++Y,lt.length===0&&jt.length===0){let tn=ce();return Pe(ue,lr({matches:we,loaderData:{},errors:be&&Mi(be[1])?{[be[0]]:be[1].error}:null},ej(be),tn?{fetchers:new Map(E.fetchers)}:{}),{flushSync:ie}),{shortCircuited:!0}}if(Se){let tn={};if(!Le){tn.navigation=Ie;let In=Pt(be);In!==void 0&&(tn.actionData=In)}jt.length>0&&(tn.fetchers=en(jt)),Ce(tn,{flushSync:ie})}jt.forEach(tn=>{Oe(tn.key),tn.controller&&H.set(tn.key,tn.controller)});let vn=()=>jt.forEach(tn=>Oe(tn.key));k&&k.signal.addEventListener("abort",vn);let{loaderResults:ts,fetcherResults:Vn}=await te(E,we,lt,jt,J);if(J.signal.aborted)return{shortCircuited:!0};k&&k.signal.removeEventListener("abort",vn),jt.forEach(tn=>H.delete(tn.key));let Wr=Ly(ts);if(Wr)return await Lt(J,Wr.result,!0,{replace:me}),{shortCircuited:!0};if(Wr=Ly(Vn),Wr)return z.add(Wr.key),await Lt(J,Wr.result,!0,{replace:me}),{shortCircuited:!0};let{loaderData:ri,errors:$s}=QR(E,we,ts,be,jt,Vn,xe);xe.forEach((tn,In)=>{tn.subscribe(si=>{(si||tn.done)&&xe.delete(In)})}),h.v7_partialHydration&&q&&E.errors&&($s=lr({},E.errors,$s));let Us=ce(),Bs=_e(V),ns=Us||Bs||jt.length>0;return lr({matches:we,loaderData:ri,errors:$s},ns?{fetchers:new Map(E.fetchers)}:{})}function Pt(J){if(J&&!Mi(J[1]))return{[J[0]]:J[1].data};if(E.actionData)return Object.keys(E.actionData).length===0?null:E.actionData}function en(J){return J.forEach(ue=>{let we=E.fetchers.get(ue.key),Le=Xf(void 0,we?we.data:void 0);E.fetchers.set(ue.key,Le)}),new Map(E.fetchers)}function fn(J,ue,we,Le){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Oe(J);let Ze=(Le&&Le.flushSync)===!0,X=l||o,ne=cE(E.location,E.matches,c,h.v7_prependBasename,we,h.v7_relativeSplatPath,ue,Le==null?void 0:Le.relative),me=mu(X,ne,c),q=mn(me,X,ne);if(q.active&&q.matches&&(me=q.matches),!me){le(J,ue,ci(404,{pathname:ne}),{flushSync:Ze});return}let{path:ie,submission:be,error:Ie}=WR(h.v7_normalizeFormMethod,!0,ne,Le);if(Ie){le(J,ue,Ie,{flushSync:Ze});return}let Ve=bm(me,ie),Se=(Le&&Le.preventScrollReset)===!0;if(be&&ko(be.formMethod)){an(J,ue,ie,Ve,me,q.active,Ze,Se,be);return}F.set(J,{routeId:ue,path:ie}),dn(J,ue,ie,Ve,me,q.active,Ze,Se,be)}async function an(J,ue,we,Le,Ze,X,ne,me,q){Ee(),F.delete(J);function ie($n){if(!$n.route.action&&!$n.route.lazy){let oi=ci(405,{method:q.formMethod,pathname:we,routeId:ue});return le(J,ue,oi,{flushSync:ne}),!0}return!1}if(!X&&ie(Le))return;let be=E.fetchers.get(J);ee(J,eX(q,be),{flushSync:ne});let Ie=new AbortController,Ve=Nd(t.history,we,Ie.signal,q);if(X){let $n=await Ft(Ze,new URL(Ve.url).pathname,Ve.signal,J);if($n.type==="aborted")return;if($n.type==="error"){le(J,ue,$n.error,{flushSync:ne});return}else if($n.matches){if(Ze=$n.matches,Le=bm(Ze,we),ie(Le))return}else{le(J,ue,ci(404,{pathname:we}),{flushSync:ne});return}}H.set(J,Ie);let Se=Y,lt=(await xn("action",E,Ve,[Le],Ze,J))[Le.route.id];if(Ve.signal.aborted){H.get(J)===Ie&&H.delete(J);return}if(h.v7_fetcherPersist&&fe.has(J)){if(Eu(lt)||Mi(lt)){ee(J,Rl(void 0));return}}else{if(Eu(lt))if(H.delete(J),V>Se){ee(J,Rl(void 0));return}else return z.add(J),ee(J,Xf(q)),Lt(Ve,lt,!1,{fetcherSubmission:q,preventScrollReset:me});if(Mi(lt)){le(J,ue,lt.error);return}}if(Yl(lt))throw ci(400,{type:"defer-action"});let jt=E.navigation.location||E.location,vn=Nd(t.history,jt,Ie.signal),ts=l||o,Vn=E.navigation.state!=="idle"?mu(ts,E.navigation.location,c):E.matches;sn(Vn,"Didn't find any matches after fetcher action");let Wr=++Y;$.set(J,Wr);let ri=Xf(q,lt.data);E.fetchers.set(J,ri);let[$s,Us]=qR(t.history,E,Vn,q,jt,!1,h.v7_skipActionErrorRevalidation,B,W,Q,fe,F,z,ts,c,[Le.route.id,lt]);Us.filter($n=>$n.key!==J).forEach($n=>{let oi=$n.key,_o=E.fetchers.get(oi),Qo=Xf(void 0,_o?_o.data:void 0);E.fetchers.set(oi,Qo),Oe(oi),$n.controller&&H.set(oi,$n.controller)}),Ce({fetchers:new Map(E.fetchers)});let Bs=()=>Us.forEach($n=>Oe($n.key));Ie.signal.addEventListener("abort",Bs);let{loaderResults:ns,fetcherResults:tn}=await te(E,Vn,$s,Us,vn);if(Ie.signal.aborted)return;Ie.signal.removeEventListener("abort",Bs),$.delete(J),H.delete(J),Us.forEach($n=>H.delete($n.key));let In=Ly(ns);if(In)return Lt(vn,In.result,!1,{preventScrollReset:me});if(In=Ly(tn),In)return z.add(In.key),Lt(vn,In.result,!1,{preventScrollReset:me});let{loaderData:si,errors:ii}=QR(E,Vn,ns,void 0,Us,tn,xe);if(E.fetchers.has(J)){let $n=Rl(lt.data);E.fetchers.set(J,$n)}_e(Wr),E.navigation.state==="loading"&&Wr>V?(sn(I,"Expected pending action"),k&&k.abort(),Pe(E.navigation.location,{matches:Vn,loaderData:si,errors:ii,fetchers:new Map(E.fetchers)})):(Ce({errors:ii,loaderData:ZR(E.loaderData,si,Vn,ii),fetchers:new Map(E.fetchers)}),B=!1)}async function dn(J,ue,we,Le,Ze,X,ne,me,q){let ie=E.fetchers.get(J);ee(J,Xf(q,ie?ie.data:void 0),{flushSync:ne});let be=new AbortController,Ie=Nd(t.history,we,be.signal);if(X){let lt=await Ft(Ze,new URL(Ie.url).pathname,Ie.signal,J);if(lt.type==="aborted")return;if(lt.type==="error"){le(J,ue,lt.error,{flushSync:ne});return}else if(lt.matches)Ze=lt.matches,Le=bm(Ze,we);else{le(J,ue,ci(404,{pathname:we}),{flushSync:ne});return}}H.set(J,be);let Ve=Y,ot=(await xn("loader",E,Ie,[Le],Ze,J))[Le.route.id];if(Yl(ot)&&(ot=await gI(ot,Ie.signal,!0)||ot),H.get(J)===be&&H.delete(J),!Ie.signal.aborted){if(fe.has(J)){ee(J,Rl(void 0));return}if(Eu(ot))if(V>Ve){ee(J,Rl(void 0));return}else{z.add(J),await Lt(Ie,ot,!1,{preventScrollReset:me});return}if(Mi(ot)){le(J,ue,ot.error);return}sn(!Yl(ot),"Unhandled fetcher deferred data"),ee(J,Rl(ot.data))}}async function Lt(J,ue,we,Le){let{submission:Ze,fetcherSubmission:X,preventScrollReset:ne,replace:me}=Le===void 0?{}:Le;ue.response.headers.has("X-Remix-Revalidate")&&(B=!0);let q=ue.response.headers.get("Location");sn(q,"Expected a Location header on the redirect Response"),q=JR(q,new URL(J.url),c);let ie=Fp(E.location,q,{_isRedirect:!0});if(n){let lt=!1;if(ue.response.headers.has("X-Remix-Reload-Document"))lt=!0;else if(pI.test(q)){const jt=t.history.createURL(q);lt=jt.origin!==e.location.origin||Sf(jt.pathname,c)==null}if(lt){me?e.location.replace(q):e.location.assign(q);return}}k=null;let be=me===!0||ue.response.headers.has("X-Remix-Replace")?Dr.Replace:Dr.Push,{formMethod:Ie,formAction:Ve,formEncType:Se}=E.navigation;!Ze&&!X&&Ie&&Ve&&Se&&(Ze=rj(E.navigation));let ot=Ze||X;if(DJ.has(ue.response.status)&&ot&&ko(ot.formMethod))await Me(be,ie,{submission:lr({},ot,{formAction:q}),preventScrollReset:ne||P,enableViewTransition:we?j:void 0});else{let lt=W_(ie,Ze);await Me(be,ie,{overrideNavigation:lt,fetcherSubmission:X,preventScrollReset:ne||P,enableViewTransition:we?j:void 0})}}async function xn(J,ue,we,Le,Ze,X){let ne,me={};try{ne=await BJ(u,J,ue,we,Le,Ze,X,i,s)}catch(q){return Le.forEach(ie=>{me[ie.route.id]={type:Dn.error,error:q}}),me}for(let[q,ie]of Object.entries(ne))if(KJ(ie)){let be=ie.result;me[q]={type:Dn.redirect,response:WJ(be,we,q,Ze,c,h.v7_relativeSplatPath)}}else me[q]=await GJ(ie);return me}async function te(J,ue,we,Le,Ze){let X=J.matches,ne=xn("loader",J,Ze,we,ue,null),me=Promise.all(Le.map(async be=>{if(be.matches&&be.match&&be.controller){let Ve=(await xn("loader",J,Nd(t.history,be.path,be.controller.signal),[be.match],be.matches,be.key))[be.match.route.id];return{[be.key]:Ve}}else return Promise.resolve({[be.key]:{type:Dn.error,error:ci(404,{pathname:be.path})}})})),q=await ne,ie=(await me).reduce((be,Ie)=>Object.assign(be,Ie),{});return await Promise.all([XJ(ue,q,Ze.signal,X,J.loaderData),QJ(ue,ie,Le)]),{loaderResults:q,fetcherResults:ie}}function Ee(){B=!0,W.push(...pt()),F.forEach((J,ue)=>{H.has(ue)&&Q.add(ue),Oe(ue)})}function ee(J,ue,we){we===void 0&&(we={}),E.fetchers.set(J,ue),Ce({fetchers:new Map(E.fetchers)},{flushSync:(we&&we.flushSync)===!0})}function le(J,ue,we,Le){Le===void 0&&(Le={});let Ze=pu(E.matches,ue);Ae(J),Ce({errors:{[Ze.route.id]:we},fetchers:new Map(E.fetchers)},{flushSync:(Le&&Le.flushSync)===!0})}function K(J){return Z.set(J,(Z.get(J)||0)+1),fe.has(J)&&fe.delete(J),E.fetchers.get(J)||MJ}function Ae(J){let ue=E.fetchers.get(J);H.has(J)&&!(ue&&ue.state==="loading"&&$.has(J))&&Oe(J),F.delete(J),$.delete(J),z.delete(J),h.v7_fetcherPersist&&fe.delete(J),Q.delete(J),E.fetchers.delete(J)}function Ne(J){let ue=(Z.get(J)||0)-1;ue<=0?(Z.delete(J),fe.add(J),h.v7_fetcherPersist||Ae(J)):Z.set(J,ue),Ce({fetchers:new Map(E.fetchers)})}function Oe(J){let ue=H.get(J);ue&&(ue.abort(),H.delete(J))}function He(J){for(let ue of J){let we=K(ue),Le=Rl(we.data);E.fetchers.set(ue,Le)}}function ce(){let J=[],ue=!1;for(let we of z){let Le=E.fetchers.get(we);sn(Le,"Expected fetcher: "+we),Le.state==="loading"&&(z.delete(we),J.push(we),ue=!0)}return He(J),ue}function _e(J){let ue=[];for(let[we,Le]of $)if(Le<J){let Ze=E.fetchers.get(we);sn(Ze,"Expected fetcher: "+we),Ze.state==="loading"&&(Oe(we),$.delete(we),ue.push(we))}return He(ue),ue.length>0}function Be(J,ue){let we=E.blockers.get(J)||Jf;return ge.get(J)!==ue&&ge.set(J,ue),we}function Te(J){E.blockers.delete(J),ge.delete(J)}function Et(J,ue){let we=E.blockers.get(J)||Jf;sn(we.state==="unblocked"&&ue.state==="blocked"||we.state==="blocked"&&ue.state==="blocked"||we.state==="blocked"&&ue.state==="proceeding"||we.state==="blocked"&&ue.state==="unblocked"||we.state==="proceeding"&&ue.state==="unblocked","Invalid blocker state transition: "+we.state+" -> "+ue.state);let Le=new Map(E.blockers);Le.set(J,ue),Ce({blockers:Le})}function wt(J){let{currentLocation:ue,nextLocation:we,historyAction:Le}=J;if(ge.size===0)return;ge.size>1&&Kh(!1,"A router only supports one blocker at a time");let Ze=Array.from(ge.entries()),[X,ne]=Ze[Ze.length-1],me=E.blockers.get(X);if(!(me&&me.state==="proceeding")&&ne({currentLocation:ue,nextLocation:we,historyAction:Le}))return X}function xt(J){let ue=ci(404,{pathname:J}),we=l||o,{matches:Le,route:Ze}=tj(we);return pt(),{notFoundMatches:Le,route:Ze,error:ue}}function pt(J){let ue=[];return xe.forEach((we,Le)=>{(!J||J(Le))&&(we.cancel(),ue.push(Le),xe.delete(Le))}),ue}function At(J,ue,we){if(g=J,w=ue,x=we||null,!v&&E.navigation===G_){v=!0;let Le=mr(E.location,E.matches);Le!=null&&Ce({restoreScrollPosition:Le})}return()=>{g=null,w=null,x=null}}function On(J,ue){return x&&x(J,ue.map(Le=>hJ(Le,E.loaderData)))||J.key}function Tn(J,ue){if(g&&w){let we=On(J,ue);g[we]=w()}}function mr(J,ue){if(g){let we=On(J,ue),Le=g[we];if(typeof Le=="number")return Le}return null}function mn(J,ue,we){if(d)if(J){if(Object.keys(J[0].params).length>0)return{active:!0,matches:Ux(ue,we,c,!0)}}else return{active:!0,matches:Ux(ue,we,c,!0)||[]};return{active:!1,matches:null}}async function Ft(J,ue,we,Le){if(!d)return{type:"success",matches:J};let Ze=J;for(;;){let X=l==null,ne=l||o,me=i;try{await d({signal:we,path:ue,matches:Ze,fetcherKey:Le,patch:(be,Ie)=>{we.aborted||YR(be,Ie,ne,me,s)}})}catch(be){return{type:"error",error:be,partialMatches:Ze}}finally{X&&!we.aborted&&(o=[...o])}if(we.aborted)return{type:"aborted"};let q=mu(ne,ue,c);if(q)return{type:"success",matches:q};let ie=Ux(ne,ue,c,!0);if(!ie||Ze.length===ie.length&&Ze.every((be,Ie)=>be.route.id===ie[Ie].route.id))return{type:"success",matches:null};Ze=ie}}function Xt(J){i={},l=Hv(J,s,void 0,i)}function or(J,ue){let we=l==null;YR(J,ue,l||o,i,s),we&&(o=[...o],Ce({}))}return A={get basename(){return c},get future(){return h},get state(){return E},get routes(){return o},get window(){return e},initialize:Ue,subscribe:he,enableScrollRestoration:At,navigate:ve,fetch:fn,revalidate:de,createHref:J=>t.history.createHref(J),encodeLocation:J=>t.history.encodeLocation(J),getFetcher:K,deleteFetcher:Ne,dispose:ze,getBlocker:Be,deleteBlocker:Te,patchRoutes:or,_internalFetchControllers:H,_internalActiveDeferreds:xe,_internalSetRoutes:Xt},A}function OJ(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function cE(t,e,n,r,s,i,o,l){let c,u;if(o){c=[];for(let h of e)if(c.push(h),h.route.id===o){u=h;break}}else c=e,u=e[e.length-1];let d=E0(s||".",C0(c,i),Sf(t.pathname,n)||t.pathname,l==="path");if(s==null&&(d.search=t.search,d.hash=t.hash),(s==null||s===""||s===".")&&u){let h=yI(d.search);if(u.route.index&&!h)d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index";else if(!u.route.index&&h){let f=new URLSearchParams(d.search),m=f.getAll("index");f.delete("index"),m.filter(x=>x).forEach(x=>f.append("index",x));let g=f.toString();d.search=g?"?"+g:""}}return r&&n!=="/"&&(d.pathname=d.pathname==="/"?n:Ka([n,d.pathname])),Hu(d)}function WR(t,e,n,r){if(!r||!OJ(r))return{path:n};if(r.formMethod&&!JJ(r.formMethod))return{path:n,error:ci(405,{method:r.formMethod})};let s=()=>({path:n,error:ci(400,{type:"invalid-body"})}),i=r.formMethod||"get",o=t?i.toUpperCase():i.toLowerCase(),l=I$(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!ko(o))return s();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((m,g)=>{let[x,w]=g;return""+m+x+"="+w+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!ko(o))return s();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return s()}}}sn(typeof FormData=="function","FormData is not available in this environment");let c,u;if(r.formData)c=dE(r.formData),u=r.formData;else if(r.body instanceof FormData)c=dE(r.body),u=r.body;else if(r.body instanceof URLSearchParams)c=r.body,u=XR(c);else if(r.body==null)c=new URLSearchParams,u=new FormData;else try{c=new URLSearchParams(r.body),u=XR(c)}catch{return s()}let d={formMethod:o,formAction:l,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(ko(d.formMethod))return{path:n,submission:d};let h=yl(n);return e&&h.search&&yI(h.search)&&c.append("index",""),h.search="?"+c,{path:Hu(h),submission:d}}function HR(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(s=>s.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function qR(t,e,n,r,s,i,o,l,c,u,d,h,f,m,g,x){let w=x?Mi(x[1])?x[1].error:x[1].data:void 0,v=t.createURL(e.location),_=t.createURL(s),C=n;i&&e.errors?C=HR(n,Object.keys(e.errors)[0],!0):x&&Mi(x[1])&&(C=HR(n,x[0]));let T=x?x[1].statusCode:void 0,R=o&&T&&T>=400,A=C.filter((I,P)=>{let{route:k}=I;if(k.lazy)return!0;if(k.loader==null)return!1;if(i)return uE(k,e.loaderData,e.errors);if(VJ(e.loaderData,e.matches[P],I)||c.some(M=>M===I.route.id))return!0;let j=e.matches[P],D=I;return KR(I,lr({currentUrl:v,currentParams:j.params,nextUrl:_,nextParams:D.params},r,{actionResult:w,actionStatus:T,defaultShouldRevalidate:R?!1:l||v.pathname+v.search===_.pathname+_.search||v.search!==_.search||E$(j,D)}))}),E=[];return h.forEach((I,P)=>{if(i||!n.some(G=>G.route.id===I.routeId)||d.has(P))return;let k=mu(m,I.path,g);if(!k){E.push({key:P,routeId:I.routeId,path:I.path,matches:null,match:null,controller:null});return}let j=e.fetchers.get(P),D=bm(k,I.path),M=!1;f.has(P)?M=!1:u.has(P)?(u.delete(P),M=!0):j&&j.state!=="idle"&&j.data===void 0?M=l:M=KR(D,lr({currentUrl:v,currentParams:e.matches[e.matches.length-1].params,nextUrl:_,nextParams:n[n.length-1].params},r,{actionResult:w,actionStatus:T,defaultShouldRevalidate:R?!1:l})),M&&E.push({key:P,routeId:I.routeId,path:I.path,matches:k,match:D,controller:new AbortController})}),[A,E]}function uE(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,s=n!=null&&n[t.id]!==void 0;return!r&&s?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!s}function VJ(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function E$(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function KR(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function YR(t,e,n,r,s){var i;let o;if(t){let u=r[t];sn(u,"No route found to patch children into: routeId = "+t),u.children||(u.children=[]),o=u.children}else o=n;let l=e.filter(u=>!o.some(d=>T$(u,d))),c=Hv(l,s,[t||"_","patch",String(((i=o)==null?void 0:i.length)||"0")],r);o.push(...c)}function T$(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var s;return(s=e.children)==null?void 0:s.some(i=>T$(n,i))}):!1}async function $J(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];sn(s,"No route found in manifest");let i={};for(let o in r){let c=s[o]!==void 0&&o!=="hasErrorBoundary";Kh(!c,'Route "'+s.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!c&&!uJ.has(o)&&(i[o]=r[o])}Object.assign(s,i),Object.assign(s,lr({},e(s),{lazy:void 0}))}async function UJ(t){let{matches:e}=t,n=e.filter(s=>s.shouldLoad);return(await Promise.all(n.map(s=>s.resolve()))).reduce((s,i,o)=>Object.assign(s,{[n[o].route.id]:i}),{})}async function BJ(t,e,n,r,s,i,o,l,c,u){let d=i.map(m=>m.route.lazy?$J(m.route,c,l):void 0),h=i.map((m,g)=>{let x=d[g],w=s.some(_=>_.route.id===m.route.id);return lr({},m,{shouldLoad:w,resolve:async _=>(_&&r.method==="GET"&&(m.route.lazy||m.route.loader)&&(w=!0),w?zJ(e,r,m,x,_,u):Promise.resolve({type:Dn.data,result:void 0}))})}),f=await t({matches:h,request:r,params:i[0].params,fetcherKey:o,context:u});try{await Promise.all(d)}catch{}return f}async function zJ(t,e,n,r,s,i){let o,l,c=u=>{let d,h=new Promise((g,x)=>d=x);l=()=>d(),e.signal.addEventListener("abort",l);let f=g=>typeof u!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):u({request:e,params:n.params,context:i},...g!==void 0?[g]:[]),m=(async()=>{try{return{type:"data",result:await(s?s(x=>f(x)):f())}}catch(g){return{type:"error",result:g}}})();return Promise.race([m,h])};try{let u=n.route[t];if(r)if(u){let d,[h]=await Promise.all([c(u).catch(f=>{d=f}),r]);if(d!==void 0)throw d;o=h}else if(await r,u=n.route[t],u)o=await c(u);else if(t==="action"){let d=new URL(e.url),h=d.pathname+d.search;throw ci(405,{method:e.method,pathname:h,routeId:n.route.id})}else return{type:Dn.data,result:void 0};else if(u)o=await c(u);else{let d=new URL(e.url),h=d.pathname+d.search;throw ci(404,{pathname:h})}sn(o.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(u){return{type:Dn.error,result:u}}finally{l&&e.signal.removeEventListener("abort",l)}return o}async function GJ(t){let{result:e,type:n}=t;if(N$(e)){let h;try{let f=e.headers.get("Content-Type");f&&/\bapplication\/json\b/.test(f)?e.body==null?h=null:h=await e.json():h=await e.text()}catch(f){return{type:Dn.error,error:f}}return n===Dn.error?{type:Dn.error,error:new qv(e.status,e.statusText,h),statusCode:e.status,headers:e.headers}:{type:Dn.data,data:h,statusCode:e.status,headers:e.headers}}if(n===Dn.error){if(nj(e)){var r,s;if(e.data instanceof Error){var i,o;return{type:Dn.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}}return{type:Dn.error,error:new qv(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:Op(e)?e.status:void 0,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:Dn.error,error:e,statusCode:Op(e)?e.status:void 0}}if(YJ(e)){var l,c;return{type:Dn.deferred,deferredData:e,statusCode:(l=e.init)==null?void 0:l.status,headers:((c=e.init)==null?void 0:c.headers)&&new Headers(e.init.headers)}}if(nj(e)){var u,d;return{type:Dn.data,data:e.data,statusCode:(u=e.init)==null?void 0:u.status,headers:(d=e.init)!=null&&d.headers?new Headers(e.init.headers):void 0}}return{type:Dn.data,data:e}}function WJ(t,e,n,r,s,i){let o=t.headers.get("Location");if(sn(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!pI.test(o)){let l=r.slice(0,r.findIndex(c=>c.route.id===n)+1);o=cE(new URL(e.url),l,s,!0,o,i),t.headers.set("Location",o)}return t}function JR(t,e,n){if(pI.test(t)){let r=t,s=r.startsWith("//")?new URL(e.protocol+r):new URL(r),i=Sf(s.pathname,n)!=null;if(s.origin===e.origin&&i)return s.pathname+s.search+s.hash}return t}function Nd(t,e,n,r){let s=t.createURL(I$(e)).toString(),i={signal:n};if(r&&ko(r.formMethod)){let{formMethod:o,formEncType:l}=r;i.method=o.toUpperCase(),l==="application/json"?(i.headers=new Headers({"Content-Type":l}),i.body=JSON.stringify(r.json)):l==="text/plain"?i.body=r.text:l==="application/x-www-form-urlencoded"&&r.formData?i.body=dE(r.formData):i.body=r.formData}return new Request(s,i)}function dE(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function XR(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function HJ(t,e,n,r,s){let i={},o=null,l,c=!1,u={},d=n&&Mi(n[1])?n[1].error:void 0;return t.forEach(h=>{if(!(h.route.id in e))return;let f=h.route.id,m=e[f];if(sn(!Eu(m),"Cannot handle redirect results in processLoaderData"),Mi(m)){let g=m.error;if(d!==void 0&&(g=d,d=void 0),o=o||{},s)o[f]=g;else{let x=pu(t,f);o[x.route.id]==null&&(o[x.route.id]=g)}i[f]=void 0,c||(c=!0,l=Op(m.error)?m.error.status:500),m.headers&&(u[f]=m.headers)}else Yl(m)?(r.set(f,m.deferredData),i[f]=m.deferredData.data,m.statusCode!=null&&m.statusCode!==200&&!c&&(l=m.statusCode),m.headers&&(u[f]=m.headers)):(i[f]=m.data,m.statusCode&&m.statusCode!==200&&!c&&(l=m.statusCode),m.headers&&(u[f]=m.headers))}),d!==void 0&&n&&(o={[n[0]]:d},i[n[0]]=void 0),{loaderData:i,errors:o,statusCode:l||200,loaderHeaders:u}}function QR(t,e,n,r,s,i,o){let{loaderData:l,errors:c}=HJ(e,n,r,o,!1);return s.forEach(u=>{let{key:d,match:h,controller:f}=u,m=i[d];if(sn(m,"Did not find corresponding fetcher result"),!(f&&f.signal.aborted))if(Mi(m)){let g=pu(t.matches,h==null?void 0:h.route.id);c&&c[g.route.id]||(c=lr({},c,{[g.route.id]:m.error})),t.fetchers.delete(d)}else if(Eu(m))sn(!1,"Unhandled fetcher revalidation redirect");else if(Yl(m))sn(!1,"Unhandled fetcher deferred data");else{let g=Rl(m.data);t.fetchers.set(d,g)}}),{loaderData:l,errors:c}}function ZR(t,e,n,r){let s=lr({},e);for(let i of n){let o=i.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(s[o]=e[o]):t[o]!==void 0&&i.route.loader&&(s[o]=t[o]),r&&r.hasOwnProperty(o))break}return s}function ej(t){return t?Mi(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function pu(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function tj(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function ci(t,e){let{pathname:n,routeId:r,method:s,type:i,message:o}=e===void 0?{}:e,l="Unknown Server Error",c="Unknown @remix-run/router error";return t===400?(l="Bad Request",s&&n&&r?c="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?c="defer() is not supported in actions":i==="invalid-body"&&(c="Unable to encode submission body")):t===403?(l="Forbidden",c='Route "'+r+'" does not match URL "'+n+'"'):t===404?(l="Not Found",c='No route matches URL "'+n+'"'):t===405&&(l="Method Not Allowed",s&&n&&r?c="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(c='Invalid request method "'+s.toUpperCase()+'"')),new qv(t||500,l,new Error(c),!0)}function Ly(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,s]=e[n];if(Eu(s))return{key:r,result:s}}}function I$(t){let e=typeof t=="string"?yl(t):t;return Hu(lr({},e,{hash:""}))}function qJ(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function KJ(t){return N$(t.result)&&jJ.has(t.result.status)}function Yl(t){return t.type===Dn.deferred}function Mi(t){return t.type===Dn.error}function Eu(t){return(t&&t.type)===Dn.redirect}function nj(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function YJ(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function N$(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function JJ(t){return RJ.has(t.toLowerCase())}function ko(t){return AJ.has(t.toLowerCase())}async function XJ(t,e,n,r,s){let i=Object.entries(e);for(let o=0;o<i.length;o++){let[l,c]=i[o],u=t.find(f=>(f==null?void 0:f.route.id)===l);if(!u)continue;let d=r.find(f=>f.route.id===u.route.id),h=d!=null&&!E$(d,u)&&(s&&s[u.route.id])!==void 0;Yl(c)&&h&&await gI(c,n,!1).then(f=>{f&&(e[l]=f)})}}async function QJ(t,e,n){for(let r=0;r<n.length;r++){let{key:s,routeId:i,controller:o}=n[r],l=e[s];t.find(u=>(u==null?void 0:u.route.id)===i)&&Yl(l)&&(sn(o,"Expected an AbortController for revalidating fetcher deferred result"),await gI(l,o.signal,!0).then(u=>{u&&(e[s]=u)}))}}async function gI(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Dn.data,data:t.deferredData.unwrappedData}}catch(s){return{type:Dn.error,error:s}}return{type:Dn.data,data:t.deferredData.data}}}function yI(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function bm(t,e){let n=typeof e=="string"?yl(e).search:e.search;if(t[t.length-1].route.index&&yI(n||""))return t[t.length-1];let r=_$(t);return r[r.length-1]}function rj(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:i,json:o}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function W_(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function ZJ(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Xf(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function eX(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Rl(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function tX(t,e){try{let n=t.sessionStorage.getItem(C$);if(n){let r=JSON.parse(n);for(let[s,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function nX(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(C$,JSON.stringify(n))}catch(r){Kh(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vp(){return Vp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Vp.apply(this,arguments)}const T0=p.createContext(null),P$=p.createContext(null),Dc=p.createContext(null),I0=p.createContext(null),Na=p.createContext({outlet:null,matches:[],isDataRoute:!1}),A$=p.createContext(null);function rX(t,e){let{relative:n}=e===void 0?{}:e;Cf()||sn(!1);let{basename:r,navigator:s}=p.useContext(Dc),{hash:i,pathname:o,search:l}=R$(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Ka([r,o])),s.createHref({pathname:c,search:l,hash:i})}function Cf(){return p.useContext(I0)!=null}function xl(){return Cf()||sn(!1),p.useContext(I0).location}function k$(t){p.useContext(Dc).static||p.useLayoutEffect(t)}function bi(){let{isDataRoute:t}=p.useContext(Na);return t?yX():sX()}function sX(){Cf()||sn(!1);let t=p.useContext(T0),{basename:e,future:n,navigator:r}=p.useContext(Dc),{matches:s}=p.useContext(Na),{pathname:i}=xl(),o=JSON.stringify(C0(s,n.v7_relativeSplatPath)),l=p.useRef(!1);return k$(()=>{l.current=!0}),p.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let h=E0(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ka([e,h.pathname])),(d.replace?r.replace:r.push)(h,d.state,d)},[e,r,o,i,t])}const iX=p.createContext(null);function oX(t){let e=p.useContext(Na).outlet;return e&&p.createElement(iX.Provider,{value:t},e)}function N0(){let{matches:t}=p.useContext(Na),e=t[t.length-1];return e?e.params:{}}function R$(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=p.useContext(Dc),{matches:s}=p.useContext(Na),{pathname:i}=xl(),o=JSON.stringify(C0(s,r.v7_relativeSplatPath));return p.useMemo(()=>E0(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function aX(t,e,n,r){Cf()||sn(!1);let{navigator:s}=p.useContext(Dc),{matches:i}=p.useContext(Na),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=xl(),d;if(e){var h;let w=typeof e=="string"?yl(e):e;c==="/"||(h=w.pathname)!=null&&h.startsWith(c)||sn(!1),d=w}else d=u;let f=d.pathname||"/",m=f;if(c!=="/"){let w=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(w.length).join("/")}let g=mu(t,{pathname:m}),x=hX(g&&g.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:Ka([c,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:Ka([c,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,n,r);return e&&x?p.createElement(I0.Provider,{value:{location:Vp({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Dr.Pop}},x):x}function lX(){let t=gX(),e=Op(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},e),n?p.createElement("pre",{style:s},n):null,i)}const cX=p.createElement(lX,null);class uX extends p.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?p.createElement(Na.Provider,{value:this.props.routeContext},p.createElement(A$.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dX(t){let{routeContext:e,match:n,children:r}=t,s=p.useContext(T0);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),p.createElement(Na.Provider,{value:e},r)}function hX(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let d=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||sn(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:m}=n,g=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||g){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,f)=>{let m,g=!1,x=null,w=null;n&&(m=l&&h.route.id?l[h.route.id]:void 0,x=h.route.errorElement||cX,c&&(u<0&&f===0?(xX("route-fallback",!1),g=!0,w=null):u===f&&(g=!0,w=h.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,f+1)),_=()=>{let C;return m?C=x:g?C=w:h.route.Component?C=p.createElement(h.route.Component,null):h.route.element?C=h.route.element:C=d,p.createElement(dX,{match:h,routeContext:{outlet:d,matches:v,isDataRoute:n!=null},children:C})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?p.createElement(uX,{location:n.location,revalidation:n.revalidation,component:x,error:m,children:_(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):_()},null)}var j$=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(j$||{}),Kv=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Kv||{});function fX(t){let e=p.useContext(T0);return e||sn(!1),e}function mX(t){let e=p.useContext(P$);return e||sn(!1),e}function pX(t){let e=p.useContext(Na);return e||sn(!1),e}function D$(t){let e=pX(),n=e.matches[e.matches.length-1];return n.route.id||sn(!1),n.route.id}function gX(){var t;let e=p.useContext(A$),n=mX(Kv.UseRouteError),r=D$(Kv.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function yX(){let{router:t}=fX(j$.UseNavigateStable),e=D$(Kv.UseNavigateStable),n=p.useRef(!1);return k$(()=>{n.current=!0}),p.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Vp({fromRouteId:e},i)))},[t,e])}const sj={};function xX(t,e,n){!e&&!sj[t]&&(sj[t]=!0)}function vX(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function M$(t){let{to:e,replace:n,state:r,relative:s}=t;Cf()||sn(!1);let{future:i,static:o}=p.useContext(Dc),{matches:l}=p.useContext(Na),{pathname:c}=xl(),u=bi(),d=E0(e,C0(l,i.v7_relativeSplatPath),c,s==="path"),h=JSON.stringify(d);return p.useEffect(()=>u(JSON.parse(h),{replace:n,state:r,relative:s}),[u,h,s,n,r]),null}function wX(t){return oX(t.context)}function bX(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Dr.Pop,navigator:i,static:o=!1,future:l}=t;Cf()&&sn(!1);let c=e.replace(/^\/*/,"/"),u=p.useMemo(()=>({basename:c,navigator:i,static:o,future:Vp({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=yl(r));let{pathname:d="/",search:h="",hash:f="",state:m=null,key:g="default"}=r,x=p.useMemo(()=>{let w=Sf(d,c);return w==null?null:{location:{pathname:w,search:h,hash:f,state:m,key:g},navigationType:s}},[c,d,h,f,m,g,s]);return x==null?null:p.createElement(Dc.Provider,{value:u},p.createElement(I0.Provider,{children:n,value:x}))}new Promise(()=>{});function _X(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:p.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:p.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:p.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $p(){return $p=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$p.apply(this,arguments)}function SX(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function CX(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function EX(t,e){return t.button===0&&(!e||e==="_self")&&!CX(t)}const TX=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],IX="6";try{window.__reactRouterVersion=IX}catch{}function NX(t,e){return FJ({basename:e==null?void 0:e.basename,future:$p({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:aJ({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||PX(),routes:t,mapRouteProperties:_X,dataStrategy:e==null?void 0:e.dataStrategy,patchRoutesOnNavigation:e==null?void 0:e.patchRoutesOnNavigation,window:e==null?void 0:e.window}).initialize()}function PX(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=$p({},e,{errors:AX(e.errors)})),e}function AX(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new qv(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let o=new i(s.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let i=new Error(s.message);i.stack="",n[r]=i}}else n[r]=s;return n}const kX=p.createContext({isTransitioning:!1}),RX=p.createContext(new Map),jX="startTransition",ij=l0[jX],DX="flushSync",oj=oJ[DX];function MX(t){ij?ij(t):t()}function Qf(t){oj?oj(t):t()}let LX=class{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}};function FX(t){let{fallbackElement:e,router:n,future:r}=t,[s,i]=p.useState(n.state),[o,l]=p.useState(),[c,u]=p.useState({isTransitioning:!1}),[d,h]=p.useState(),[f,m]=p.useState(),[g,x]=p.useState(),w=p.useRef(new Map),{v7_startTransition:v}=r||{},_=p.useCallback(I=>{v?MX(I):I()},[v]),C=p.useCallback((I,P)=>{let{deletedFetchers:k,flushSync:j,viewTransitionOpts:D}=P;I.fetchers.forEach((G,B)=>{G.data!==void 0&&w.current.set(B,G.data)}),k.forEach(G=>w.current.delete(G));let M=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!D||M){j?Qf(()=>i(I)):_(()=>i(I));return}if(j){Qf(()=>{f&&(d&&d.resolve(),f.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:D.currentLocation,nextLocation:D.nextLocation})});let G=n.window.document.startViewTransition(()=>{Qf(()=>i(I))});G.finished.finally(()=>{Qf(()=>{h(void 0),m(void 0),l(void 0),u({isTransitioning:!1})})}),Qf(()=>m(G));return}f?(d&&d.resolve(),f.skipTransition(),x({state:I,currentLocation:D.currentLocation,nextLocation:D.nextLocation})):(l(I),u({isTransitioning:!0,flushSync:!1,currentLocation:D.currentLocation,nextLocation:D.nextLocation}))},[n.window,f,d,w,_]);p.useLayoutEffect(()=>n.subscribe(C),[n,C]),p.useEffect(()=>{c.isTransitioning&&!c.flushSync&&h(new LX)},[c]),p.useEffect(()=>{if(d&&o&&n.window){let I=o,P=d.promise,k=n.window.document.startViewTransition(async()=>{_(()=>i(I)),await P});k.finished.finally(()=>{h(void 0),m(void 0),l(void 0),u({isTransitioning:!1})}),m(k)}},[_,o,d,n.window]),p.useEffect(()=>{d&&o&&s.location.key===o.location.key&&d.resolve()},[d,f,s.location,o]),p.useEffect(()=>{!c.isTransitioning&&g&&(l(g.state),u({isTransitioning:!0,flushSync:!1,currentLocation:g.currentLocation,nextLocation:g.nextLocation}),x(void 0))},[c.isTransitioning,g]),p.useEffect(()=>{},[]);let T=p.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:I=>n.navigate(I),push:(I,P,k)=>n.navigate(I,{state:P,preventScrollReset:k==null?void 0:k.preventScrollReset}),replace:(I,P,k)=>n.navigate(I,{replace:!0,state:P,preventScrollReset:k==null?void 0:k.preventScrollReset})}),[n]),R=n.basename||"/",A=p.useMemo(()=>({router:n,navigator:T,static:!1,basename:R}),[n,T,R]),E=p.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return p.useEffect(()=>vX(r,n.future),[r,n.future]),p.createElement(p.Fragment,null,p.createElement(T0.Provider,{value:A},p.createElement(P$.Provider,{value:s},p.createElement(RX.Provider,{value:w.current},p.createElement(kX.Provider,{value:c},p.createElement(bX,{basename:R,location:s.location,navigationType:s.historyAction,navigator:T,future:E},s.initialized||n.future.v7_partialHydration?p.createElement(OX,{routes:n.routes,future:n.future,state:s}):e))))),null)}const OX=p.memo(VX);function VX(t){let{routes:e,future:n,state:r}=t;return aX(e,void 0,r,n)}const $X=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",UX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sr=p.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h}=e,f=SX(e,TX),{basename:m}=p.useContext(Dc),g,x=!1;if(typeof u=="string"&&UX.test(u)&&(g=u,$X))try{let C=new URL(window.location.href),T=u.startsWith("//")?new URL(C.protocol+u):new URL(u),R=Sf(T.pathname,m);T.origin===C.origin&&R!=null?u=R+T.search+T.hash:x=!0}catch{}let w=rX(u,{relative:s}),v=BX(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:h});function _(C){r&&r(C),C.defaultPrevented||v(C)}return p.createElement("a",$p({},f,{href:g||w,onClick:x||i?r:_,ref:n,target:c}))});var aj;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(aj||(aj={}));var lj;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(lj||(lj={}));function BX(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=bi(),u=xl(),d=R$(t,{relative:o});return p.useCallback(h=>{if(EX(h,n)){h.preventDefault();let f=r!==void 0?r:Hu(u)===Hu(d);c(t,{replace:f,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[u,c,d,r,s,n,t,i,o,l])}var zX="@vercel/analytics",GX="1.5.0",WX=()=>{window.va||(window.va=function(...e){(window.vaq=window.vaq||[]).push(e)})};function L$(){return typeof window<"u"}function F$(){try{const t="production"}catch{}return"production"}function HX(t="auto"){if(t==="auto"){window.vam=F$();return}window.vam=t}function qX(){return(L$()?window.vam:F$())||"production"}function hE(){return qX()==="development"}function KX(t){return t.scriptSrc?t.scriptSrc:hE()?"https://va.vercel-scripts.com/v1/script.debug.js":t.basePath?`${t.basePath}/insights/script.js`:"/_vercel/insights/script.js"}function YX(t={debug:!0}){var e;if(!L$())return;HX(t.mode),WX(),t.beforeSend&&((e=window.va)==null||e.call(window,"beforeSend",t.beforeSend));const n=KX(t);if(document.head.querySelector(`script[src*="${n}"]`))return;const r=document.createElement("script");r.src=n,r.defer=!0,r.dataset.sdkn=zX+(t.framework?`/${t.framework}`:""),r.dataset.sdkv=GX,t.disableAutoTrack&&(r.dataset.disableAutoTrack="1"),t.endpoint?r.dataset.endpoint=t.endpoint:t.basePath&&(r.dataset.endpoint=`${t.basePath}/insights`),t.dsn&&(r.dataset.dsn=t.dsn),r.onerror=()=>{const s=hE()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log(`[Vercel Web Analytics] Failed to load script from ${n}. ${s}`)},hE()&&t.debug===!1&&(r.dataset.debug="false"),document.head.appendChild(r)}function JX({route:t,path:e}){var n;(n=window.va)==null||n.call(window,"pageview",{route:t,path:e})}function XX(){if(!(typeof process>"u"||typeof process.env>"u"))return{}.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH}function QX(t){return p.useEffect(()=>{var e;t.beforeSend&&((e=window.va)==null||e.call(window,"beforeSend",t.beforeSend))},[t.beforeSend]),p.useEffect(()=>{YX({framework:t.framework||"react",basePath:t.basePath??XX(),...t.route!==void 0&&{disableAutoTrack:!0},...t})},[]),p.useEffect(()=>{t.route&&t.path&&JX({route:t.route,path:t.path})},[t.route,t.path]),null}function O$(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=O$(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function V$(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=O$(t))&&(r&&(r+=" "),r+=e);return r}function ZX(){for(var t=0,e,n,r="";t<arguments.length;)(e=arguments[t++])&&(n=$$(e))&&(r&&(r+=" "),r+=n);return r}function $$(t){if(typeof t=="string")return t;for(var e,n="",r=0;r<t.length;r++)t[r]&&(e=$$(t[r]))&&(n&&(n+=" "),n+=e);return n}var xI="-";function eQ(t){var e=nQ(t),n=t.conflictingClassGroups,r=t.conflictingClassGroupModifiers,s=r===void 0?{}:r;function i(l){var c=l.split(xI);return c[0]===""&&c.length!==1&&c.shift(),U$(c,e)||tQ(l)}function o(l,c){var u=n[l]||[];return c&&s[l]?[].concat(u,s[l]):u}return{getClassGroupId:i,getConflictingClassGroupIds:o}}function U$(t,e){var o;if(t.length===0)return e.classGroupId;var n=t[0],r=e.nextPart.get(n),s=r?U$(t.slice(1),r):void 0;if(s)return s;if(e.validators.length!==0){var i=t.join(xI);return(o=e.validators.find(function(l){var c=l.validator;return c(i)}))==null?void 0:o.classGroupId}}var cj=/^\[(.+)\]$/;function tQ(t){if(cj.test(t)){var e=cj.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}function nQ(t){var e=t.theme,n=t.prefix,r={nextPart:new Map,validators:[]},s=sQ(Object.entries(t.classGroups),n);return s.forEach(function(i){var o=i[0],l=i[1];fE(l,r,o,e)}),r}function fE(t,e,n,r){t.forEach(function(s){if(typeof s=="string"){var i=s===""?e:uj(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(rQ(s)){fE(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(function(o){var l=o[0],c=o[1];fE(c,uj(e,l),n,r)})})}function uj(t,e){var n=t;return e.split(xI).forEach(function(r){n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n}function rQ(t){return t.isThemeGetter}function sQ(t,e){return e?t.map(function(n){var r=n[0],s=n[1],i=s.map(function(o){return typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(l){var c=l[0],u=l[1];return[e+c,u]})):o});return[r,i]}):t}function iQ(t){if(t<1)return{get:function(){},set:function(){}};var e=0,n=new Map,r=new Map;function s(i,o){n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)}return{get:function(o){var l=n.get(o);if(l!==void 0)return l;if((l=r.get(o))!==void 0)return s(o,l),l},set:function(o,l){n.has(o)?n.set(o,l):s(o,l)}}}var B$="!";function oQ(t){var e=t.separator||":",n=e.length===1,r=e[0],s=e.length;return function(o){for(var l=[],c=0,u=0,d,h=0;h<o.length;h++){var f=o[h];if(c===0){if(f===r&&(n||o.slice(h,h+s)===e)){l.push(o.slice(u,h)),u=h+s;continue}if(f==="/"){d=h;continue}}f==="["?c++:f==="]"&&c--}var m=l.length===0?o:o.substring(u),g=m.startsWith(B$),x=g?m.substring(1):m,w=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:g,baseClassName:x,maybePostfixModifierPosition:w}}}function aQ(t){if(t.length<=1)return t;var e=[],n=[];return t.forEach(function(r){var s=r[0]==="[";s?(e.push.apply(e,n.sort().concat([r])),n=[]):n.push(r)}),e.push.apply(e,n.sort()),e}function lQ(t){return{cache:iQ(t.cacheSize),splitModifiers:oQ(t),...eQ(t)}}var cQ=/\s+/;function uQ(t,e){var n=e.splitModifiers,r=e.getClassGroupId,s=e.getConflictingClassGroupIds,i=new Set;return t.trim().split(cQ).map(function(o){var l=n(o),c=l.modifiers,u=l.hasImportantModifier,d=l.baseClassName,h=l.maybePostfixModifierPosition,f=r(h?d.substring(0,h):d),m=!!h;if(!f){if(!h)return{isTailwindClass:!1,originalClassName:o};if(f=r(d),!f)return{isTailwindClass:!1,originalClassName:o};m=!1}var g=aQ(c).join(":"),x=u?g+B$:g;return{isTailwindClass:!0,modifierId:x,classGroupId:f,originalClassName:o,hasPostfixModifier:m}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var l=o.modifierId,c=o.classGroupId,u=o.hasPostfixModifier,d=l+c;return i.has(d)?!1:(i.add(d),s(c,u).forEach(function(h){return i.add(l+h)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function dQ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,s,i,o=l;function l(u){var d=e[0],h=e.slice(1),f=h.reduce(function(m,g){return g(m)},d());return r=lQ(f),s=r.cache.get,i=r.cache.set,o=c,c(u)}function c(u){var d=s(u);if(d)return d;var h=uQ(u,r);return i(u,h),h}return function(){return o(ZX.apply(null,arguments))}}function tr(t){var e=function(r){return r[t]||[]};return e.isThemeGetter=!0,e}var z$=/^\[(?:([a-z-]+):)?(.+)\]$/i,hQ=/^\d+\/\d+$/,fQ=new Set(["px","full","screen"]),mQ=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,pQ=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,gQ=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function To(t){return Tu(t)||fQ.has(t)||hQ.test(t)||mE(t)}function mE(t){return dd(t,"length",_Q)}function yQ(t){return dd(t,"size",G$)}function xQ(t){return dd(t,"position",G$)}function vQ(t){return dd(t,"url",SQ)}function Fy(t){return dd(t,"number",Tu)}function Tu(t){return!Number.isNaN(Number(t))}function wQ(t){return t.endsWith("%")&&Tu(t.slice(0,-1))}function Zf(t){return dj(t)||dd(t,"number",dj)}function ln(t){return z$.test(t)}function em(){return!0}function Sl(t){return mQ.test(t)}function bQ(t){return dd(t,"",CQ)}function dd(t,e,n){var r=z$.exec(t);return r?r[1]?r[1]===e:n(r[2]):!1}function _Q(t){return pQ.test(t)}function G$(){return!1}function SQ(t){return t.startsWith("url(")}function dj(t){return Number.isInteger(Number(t))}function CQ(t){return gQ.test(t)}function EQ(){var t=tr("colors"),e=tr("spacing"),n=tr("blur"),r=tr("brightness"),s=tr("borderColor"),i=tr("borderRadius"),o=tr("borderSpacing"),l=tr("borderWidth"),c=tr("contrast"),u=tr("grayscale"),d=tr("hueRotate"),h=tr("invert"),f=tr("gap"),m=tr("gradientColorStops"),g=tr("gradientColorStopPositions"),x=tr("inset"),w=tr("margin"),v=tr("opacity"),_=tr("padding"),C=tr("saturate"),T=tr("scale"),R=tr("sepia"),A=tr("skew"),E=tr("space"),I=tr("translate"),P=function(){return["auto","contain","none"]},k=function(){return["auto","hidden","clip","visible","scroll"]},j=function(){return["auto",ln,e]},D=function(){return[ln,e]},M=function(){return["",To]},G=function(){return["auto",Tu,ln]},B=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},W=function(){return["solid","dashed","dotted","double","none"]},Q=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},H=function(){return["start","end","center","between","around","evenly","stretch"]},Y=function(){return["","0",ln]},V=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},$=function(){return[Tu,Fy]},z=function(){return[Tu,ln]};return{cacheSize:500,theme:{colors:[em],spacing:[To],blur:["none","",Sl,ln],brightness:$(),borderColor:[t],borderRadius:["none","","full",Sl,ln],borderSpacing:D(),borderWidth:M(),contrast:$(),grayscale:Y(),hueRotate:z(),invert:Y(),gap:D(),gradientColorStops:[t],gradientColorStopPositions:[wQ,mE],inset:j(),margin:j(),opacity:$(),padding:D(),saturate:$(),scale:$(),sepia:Y(),skew:z(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",ln]}],container:["container"],columns:[{columns:[Sl]}],"break-after":[{"break-after":V()}],"break-before":[{"break-before":V()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(B(),[ln])}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Zf]}],basis:[{basis:j()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ln]}],grow:[{grow:Y()}],shrink:[{shrink:Y()}],order:[{order:["first","last","none",Zf]}],"grid-cols":[{"grid-cols":[em]}],"col-start-end":[{col:["auto",{span:["full",Zf]},ln]}],"col-start":[{"col-start":G()}],"col-end":[{"col-end":G()}],"grid-rows":[{"grid-rows":[em]}],"row-start-end":[{row:["auto",{span:[Zf]},ln]}],"row-start":[{"row-start":G()}],"row-end":[{"row-end":G()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ln]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ln]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal"].concat(H())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(H(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(H(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[w]}],mx:[{mx:[w]}],my:[{my:[w]}],ms:[{ms:[w]}],me:[{me:[w]}],mt:[{mt:[w]}],mr:[{mr:[w]}],mb:[{mb:[w]}],ml:[{ml:[w]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",ln,e]}],"min-w":[{"min-w":["min","max","fit",ln,To]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Sl]},Sl,ln]}],h:[{h:[ln,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",ln,To]}],"max-h":[{"max-h":[ln,e,"min","max","fit"]}],"font-size":[{text:["base",Sl,mE]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Fy]}],"font-family":[{font:[em]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ln]}],"line-clamp":[{"line-clamp":["none",Tu,Fy]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ln,To]}],"list-image":[{"list-image":["none",ln]}],"list-style-type":[{list:["none","disc","decimal",ln]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(W(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",To]}],"underline-offset":[{"underline-offset":["auto",ln,To]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ln]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ln]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(B(),[xQ])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",yQ]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},vQ]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[].concat(W(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:W()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(W())}],"outline-offset":[{"outline-offset":[ln,To]}],"outline-w":[{outline:[To]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[To]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Sl,bQ]}],"shadow-color":[{shadow:[em]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":Q()}],"bg-blend":[{"bg-blend":Q()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Sl,ln]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[C]}],sepia:[{sepia:[R]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[C]}],"backdrop-sepia":[{"backdrop-sepia":[R]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ln]}],duration:[{duration:z()}],ease:[{ease:["linear","in","out","in-out",ln]}],delay:[{delay:z()}],animate:[{animate:["none","spin","ping","pulse","bounce",ln]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[T]}],"scale-x":[{"scale-x":[T]}],"scale-y":[{"scale-y":[T]}],rotate:[{rotate:[Zf,ln]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[A]}],"skew-y":[{"skew-y":[A]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ln]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ln]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ln]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[To,Fy]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var TQ=dQ(EQ);let Oy;const IQ=new Uint8Array(16);function NQ(){if(!Oy&&(Oy=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Oy))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Oy(IQ)}const us=[];for(let t=0;t<256;++t)us.push((t+256).toString(16).slice(1));function PQ(t,e=0){return us[t[e+0]]+us[t[e+1]]+us[t[e+2]]+us[t[e+3]]+"-"+us[t[e+4]]+us[t[e+5]]+"-"+us[t[e+6]]+us[t[e+7]]+"-"+us[t[e+8]]+us[t[e+9]]+"-"+us[t[e+10]]+us[t[e+11]]+us[t[e+12]]+us[t[e+13]]+us[t[e+14]]+us[t[e+15]]}const AQ=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),hj={randomUUID:AQ};function kQ(t,e,n){if(hj.randomUUID&&!e&&!t)return hj.randomUUID();t=t||{};const r=t.random||(t.rng||NQ)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=r[s];return e}return PQ(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let RQ,jQ;function DQ(){return{geminiUrl:RQ,vertexUrl:jQ}}function MQ(t,e,n){var r,s,i;if(!(!((r=t.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=DQ();return t.vertexai?(s=o.vertexUrl)!==null&&s!==void 0?s:e:(i=o.geminiUrl)!==null&&i!==void 0?i:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _g{}function qt(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const i=e[s];return i!=null?String(i):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function S(t,e,n){for(let i=0;i<e.length-1;i++){const o=e[i];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in t))if(Array.isArray(n))t[l]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[l])){const c=t[l];if(Array.isArray(n))for(let u=0;u<c.length;u++){const d=c[u];S(d,e.slice(i+1),n[u])}else for(const u of c)S(u,e.slice(i+1),n)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in t||(t[l]=[{}]);const c=t[l];S(c[0],e.slice(i+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],s=t[r];if(s!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===s)return;if(typeof s=="object"&&typeof n=="object"&&s!==null&&n!==null)Object.assign(s,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else t[r]=n}function b(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in t){const i=t[s];return Array.isArray(i)?i.map(o=>b(o,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dr(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function W$(t,e){const n=dr(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function H$(t,e){return Array.isArray(e)?e.map(n=>Yv(t,n)):[Yv(t,e)]}function Yv(t,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function LQ(t,e){const n=Yv(t,e);if(n.mimeType&&n.mimeType.startsWith("image/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function FQ(t,e){const n=Yv(t,e);if(n.mimeType&&n.mimeType.startsWith("audio/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function fj(t,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function q$(t,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(n=>fj(t,n)):[fj(t,e)]}function pE(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function mj(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function pj(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function hi(t,e){if(e==null)throw new Error("ContentUnion is required");return pE(e)?e:{role:"user",parts:q$(t,e)}}function K$(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=hi(t,n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=hi(t,e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>hi(t,n)):[hi(t,e)]}function Mc(t,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(mj(e)||pj(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[hi(t,e)]}const n=[],r=[],s=pE(e[0]);for(const i of e){const o=pE(i);if(o!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)n.push(i);else{if(mj(i)||pj(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(i)}}return s||n.push({role:"user",parts:q$(t,r)}),n}function Y$(t,e){return e}function J$(t,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function P0(t,e){return e}function A0(t,e){if(!Array.isArray(e))throw new Error("tool is required and must be an array of Tools");return e}function OQ(t,e,n,r=1){const s=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:s?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:s?`${n}/${e}`:e}function Lc(t,e){if(typeof e!="string")throw new Error("name must be a string");return OQ(t,e,"cachedContents")}function X$(t,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Fc(t,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function VQ(t){return t!=null&&typeof t=="object"&&"name"in t}function $Q(t){return t!=null&&typeof t=="object"&&"video"in t}function UQ(t){return t!=null&&typeof t=="object"&&"uri"in t}function Q$(t,e){var n;let r;if(VQ(e)&&(r=e.name),!(UQ(e)&&(r=e.uri,r===void 0))&&!($Q(e)&&(r=(n=e.video)===null||n===void 0?void 0:n.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const i=r.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${r}`);r=i[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function Z$(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function e3(t,e){for(const n of["models","tunedModels","publisherModels"])if(BQ(e,n))return e[n];return[]}function BQ(t,e){return t!==null&&typeof t=="object"&&e in t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zQ(t,e){const n={};if(b(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function GQ(t,e){const n={};if(b(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],zQ(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function gj(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>GQ(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function WQ(){return{}}function HQ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function qQ(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],HQ(t,r)),n}function KQ(t,e){const n={};if(b(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");b(e,["googleSearch"])!=null&&S(n,["googleSearch"],WQ());const s=b(e,["googleSearchRetrieval"]);if(s!=null&&S(n,["googleSearchRetrieval"],qQ(t,s)),b(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(b(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=b(e,["codeExecution"]);i!=null&&S(n,["codeExecution"],i);const o=b(e,["functionDeclarations"]);return o!=null&&S(n,["functionDeclarations"],o),n}function YQ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function JQ(t,e){const n={},r=b(e,["functionCallingConfig"]);if(r!=null&&S(n,["functionCallingConfig"],YQ(t,r)),b(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}function XQ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);n!==void 0&&i!=null&&S(n,["expireTime"],i);const o=b(e,["displayName"]);n!==void 0&&o!=null&&S(n,["displayName"],o);const l=b(e,["contents"]);if(n!==void 0&&l!=null){let h=Mc(t,l);Array.isArray(h)&&(h=h.map(f=>gj(t,f))),S(n,["contents"],h)}const c=b(e,["systemInstruction"]);n!==void 0&&c!=null&&S(n,["systemInstruction"],gj(t,hi(t,c)));const u=b(e,["tools"]);if(n!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(f=>KQ(t,f))),S(n,["tools"],h)}const d=b(e,["toolConfig"]);return n!==void 0&&d!=null&&S(n,["toolConfig"],JQ(t,d)),r}function QQ(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["model"],W$(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],XQ(t,s,n)),n}function ZQ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Lc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function eZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Lc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function tZ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);return n!==void 0&&i!=null&&S(n,["expireTime"],i),r}function nZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Lc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],tZ(t,s,n)),n}function rZ(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);return n!==void 0&&i!=null&&S(n,["_query","pageToken"],i),r}function sZ(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],rZ(t,r,n)),n}function iZ(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function oZ(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],iZ(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function yj(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>oZ(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function aZ(){return{}}function lZ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function cZ(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],lZ(t,r)),n}function uZ(){return{}}function dZ(t,e){const n={},r=b(e,["apiKeyString"]);return r!=null&&S(n,["apiKeyString"],r),n}function hZ(t,e){const n={},r=b(e,["apiKeyConfig"]);r!=null&&S(n,["apiKeyConfig"],dZ(t,r));const s=b(e,["authType"]);s!=null&&S(n,["authType"],s);const i=b(e,["googleServiceAccountConfig"]);i!=null&&S(n,["googleServiceAccountConfig"],i);const o=b(e,["httpBasicAuthConfig"]);o!=null&&S(n,["httpBasicAuthConfig"],o);const l=b(e,["oauthConfig"]);l!=null&&S(n,["oauthConfig"],l);const c=b(e,["oidcConfig"]);return c!=null&&S(n,["oidcConfig"],c),n}function fZ(t,e){const n={},r=b(e,["authConfig"]);return r!=null&&S(n,["authConfig"],hZ(t,r)),n}function mZ(t,e){const n={},r=b(e,["retrieval"]);r!=null&&S(n,["retrieval"],r),b(e,["googleSearch"])!=null&&S(n,["googleSearch"],aZ());const i=b(e,["googleSearchRetrieval"]);i!=null&&S(n,["googleSearchRetrieval"],cZ(t,i)),b(e,["enterpriseWebSearch"])!=null&&S(n,["enterpriseWebSearch"],uZ());const l=b(e,["googleMaps"]);l!=null&&S(n,["googleMaps"],fZ(t,l));const c=b(e,["codeExecution"]);c!=null&&S(n,["codeExecution"],c);const u=b(e,["functionDeclarations"]);return u!=null&&S(n,["functionDeclarations"],u),n}function pZ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function gZ(t,e){const n={},r=b(e,["latitude"]);r!=null&&S(n,["latitude"],r);const s=b(e,["longitude"]);return s!=null&&S(n,["longitude"],s),n}function yZ(t,e){const n={},r=b(e,["latLng"]);return r!=null&&S(n,["latLng"],gZ(t,r)),n}function xZ(t,e){const n={},r=b(e,["functionCallingConfig"]);r!=null&&S(n,["functionCallingConfig"],pZ(t,r));const s=b(e,["retrievalConfig"]);return s!=null&&S(n,["retrievalConfig"],yZ(t,s)),n}function vZ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);n!==void 0&&i!=null&&S(n,["expireTime"],i);const o=b(e,["displayName"]);n!==void 0&&o!=null&&S(n,["displayName"],o);const l=b(e,["contents"]);if(n!==void 0&&l!=null){let h=Mc(t,l);Array.isArray(h)&&(h=h.map(f=>yj(t,f))),S(n,["contents"],h)}const c=b(e,["systemInstruction"]);n!==void 0&&c!=null&&S(n,["systemInstruction"],yj(t,hi(t,c)));const u=b(e,["tools"]);if(n!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(f=>mZ(t,f))),S(n,["tools"],h)}const d=b(e,["toolConfig"]);return n!==void 0&&d!=null&&S(n,["toolConfig"],xZ(t,d)),r}function wZ(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["model"],W$(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],vZ(t,s,n)),n}function bZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Lc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function _Z(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Lc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function SZ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);return n!==void 0&&i!=null&&S(n,["expireTime"],i),r}function CZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Lc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],SZ(t,s,n)),n}function EZ(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);return n!==void 0&&i!=null&&S(n,["_query","pageToken"],i),r}function TZ(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],EZ(t,r,n)),n}function Bx(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["model"]);i!=null&&S(n,["model"],i);const o=b(e,["createTime"]);o!=null&&S(n,["createTime"],o);const l=b(e,["updateTime"]);l!=null&&S(n,["updateTime"],l);const c=b(e,["expireTime"]);c!=null&&S(n,["expireTime"],c);const u=b(e,["usageMetadata"]);return u!=null&&S(n,["usageMetadata"],u),n}function IZ(){return{}}function NZ(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>Bx(t,o))),S(n,["cachedContents"],i)}return n}function zx(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["model"]);i!=null&&S(n,["model"],i);const o=b(e,["createTime"]);o!=null&&S(n,["createTime"],o);const l=b(e,["updateTime"]);l!=null&&S(n,["updateTime"],l);const c=b(e,["expireTime"]);c!=null&&S(n,["expireTime"],c);const u=b(e,["usageMetadata"]);return u!=null&&S(n,["usageMetadata"],u),n}function PZ(){return{}}function AZ(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>zx(t,o))),S(n,["cachedContents"],i)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Yh;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Yh||(Yh={}));class k0{constructor(e,n,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,s)}init(e,n,r){var s,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(i=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var xj;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(xj||(xj={}));var vj;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(vj||(vj={}));var Nr;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Nr||(Nr={}));var wj;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(wj||(wj={}));var Pr;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Pr||(Pr={}));var bj;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(bj||(bj={}));var _j;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(_j||(_j={}));var Ke;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT"})(Ke||(Ke={}));var Sj;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY"})(Sj||(Sj={}));var Cj;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Cj||(Cj={}));var Ej;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Ej||(Ej={}));var Tj;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(Tj||(Tj={}));var Ij;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Ij||(Ij={}));var bn;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(bn||(bn={}));var Nj;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Nj||(Nj={}));var gE;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(gE||(gE={}));var Pj;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Pj||(Pj={}));var Aj;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Aj||(Aj={}));var kj;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(kj||(kj={}));var Rj;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(Rj||(Rj={}));var jj;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(jj||(jj={}));var Dj;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Dj||(Dj={}));var Mj;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})(Mj||(Mj={}));var Lj;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Lj||(Lj={}));var Fj;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Fj||(Fj={}));var Oj;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Oj||(Oj={}));var Vj;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Vj||(Vj={}));var $j;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})($j||($j={}));var Uj;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(Uj||(Uj={}));var Bj;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Bj||(Bj={}));var zj;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(zj||(zj={}));var Gj;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Gj||(Gj={}));var Wj;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Wj||(Wj={}));var Hj;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Hj||(Hj={}));class Vy{get text(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",d=!1;const h=[];for(const f of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[m,g]of Object.entries(f))m!=="text"&&m!=="thought"&&(g!==null||g!==void 0)&&h.push(m);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;d=!0,u+=f.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?u:void 0}get data(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const d=[];for(const h of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[f,m]of Object.entries(h))f!=="inlineData"&&(m!==null||m!==void 0)&&d.push(f);h.inlineData&&typeof h.inlineData.data=="string"&&(u+=atob(h.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,s,i,o,l,c,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,s,i,o,l,c,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.output}}class qj{}class Kj{}class kZ{}class RZ{}class Yj{}class Jj{}class Xj{}class jZ{}class Qj{}class Zj{}class e2{}class DZ{}class yE{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class MZ{}class LZ{}class FZ{get text(){var e,n,r;let s="",i=!1;const o=[];for(const l of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,u]of Object.entries(l))c!=="text"&&c!=="thought"&&u!==null&&o.push(c);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;i=!0,s+=l.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?s:void 0}get data(){var e,n,r;let s="";const i=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(o))l!=="inlineData"&&c!==null&&i.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class OZ extends _g{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new k0(Yh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=wZ(this.apiClient,e);return l=qt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>zx(this.apiClient,d))}else{const u=QQ(this.apiClient,e);return l=qt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Bx(this.apiClient,d))}}async get(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=bZ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>zx(this.apiClient,d))}else{const u=ZQ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Bx(this.apiClient,d))}}async delete(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=_Z(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(()=>{const d=PZ(),h=new Zj;return Object.assign(h,d),h})}else{const u=eZ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=IZ(),h=new Zj;return Object.assign(h,d),h})}}async update(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=CZ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>zx(this.apiClient,d))}else{const u=nZ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Bx(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=TZ(this.apiClient,e);return l=qt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=AZ(this.apiClient,d),f=new e2;return Object.assign(f,h),f})}else{const u=sZ(this.apiClient,e);return l=qt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=NZ(this.apiClient,d),f=new e2;return Object.assign(f,h),f})}}}function t2(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function As(t){return this instanceof As?(this.v=t,this):new As(t)}function Jv(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(g){return Promise.resolve(g).then(m,h)}}function l(m,g){r[m]&&(s[m]=function(x){return new Promise(function(w,v){i.push([m,x,w,v])>1||c(m,x)})},g&&(s[m]=g(s[m])))}function c(m,g){try{u(r[m](g))}catch(x){f(i[0][3],x)}}function u(m){m.value instanceof As?Promise.resolve(m.value.v).then(d,h):f(i[0][2],m)}function d(m){c("next",m)}function h(m){c("throw",m)}function f(m,g){m(g),i.shift(),i.length&&c(i[0][0],i[0][1])}}function xE(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof t2=="function"?t2(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(l,c){o=t[i](o),s(l,c,o.done,o.value)})}}function s(i,o,l,c){Promise.resolve(c).then(function(u){i({value:u,done:l})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function VZ(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:t3(n)}function t3(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||e.text!==void 0&&e.text==="")return!1;return!0}function $Z(t){if(t.length!==0){if(t[0].role!=="user")throw new Error("History must start with a user turn.");for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function UZ(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0,s=t[0];for(;r<n;)if(t[r].role==="user")s=t[r],r++;else{const i=[];let o=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),o&&!t3(t[r])&&(o=!1),r++;o&&(e.push(s),e.push(...i))}return e}class BZ{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new zZ(this.apiClient,this.modelsModule,e.model,e.config,e.history)}}let zZ=class{constructor(e,n,r,s={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=s,this.history=i,this.sendPromise=Promise.resolve(),$Z(i)}async sendMessage(e){var n;await this.sendPromise;const r=hi(this.apiClient,e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,o;const c=(o=(i=(await s).candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content,u=c?[c]:[];this.recordHistory(r,u)})(),await this.sendPromise,s}async sendMessageStream(e){var n;await this.sendPromise;const r=hi(this.apiClient,e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const i=await s;return this.processStreamResponse(i,r)}getHistory(e=!1){return e?UZ(this.history):this.history}processStreamResponse(e,n){var r,s;return Jv(this,arguments,function*(){var o,l,c,u;const d=[];try{for(var h=!0,f=xE(e),m;m=yield As(f.next()),o=m.done,!o;h=!0){u=m.value,h=!1;const g=u;if(VZ(g)){const x=(s=(r=g.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content;x!==void 0&&d.push(x)}yield yield As(g)}}catch(g){l={error:g}}finally{try{!h&&!o&&(c=f.return)&&(yield As(c.call(f)))}finally{if(l)throw l.error}}this.recordHistory(n,d)})}recordHistory(e,n){let r=[];n.length>0&&n.every(s=>s.role==="model")?r=n:r.push({role:"model",parts:[]}),this.history.push(e),this.history.push(...r)}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function GZ(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);return n!==void 0&&i!=null&&S(n,["_query","pageToken"],i),r}function WZ(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],GZ(t,r,n)),n}function HZ(t,e){const n={},r=b(e,["details"]);r!=null&&S(n,["details"],r);const s=b(e,["message"]);s!=null&&S(n,["message"],s);const i=b(e,["code"]);return i!=null&&S(n,["code"],i),n}function qZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["mimeType"]);i!=null&&S(n,["mimeType"],i);const o=b(e,["sizeBytes"]);o!=null&&S(n,["sizeBytes"],o);const l=b(e,["createTime"]);l!=null&&S(n,["createTime"],l);const c=b(e,["expirationTime"]);c!=null&&S(n,["expirationTime"],c);const u=b(e,["updateTime"]);u!=null&&S(n,["updateTime"],u);const d=b(e,["sha256Hash"]);d!=null&&S(n,["sha256Hash"],d);const h=b(e,["uri"]);h!=null&&S(n,["uri"],h);const f=b(e,["downloadUri"]);f!=null&&S(n,["downloadUri"],f);const m=b(e,["state"]);m!=null&&S(n,["state"],m);const g=b(e,["source"]);g!=null&&S(n,["source"],g);const x=b(e,["videoMetadata"]);x!=null&&S(n,["videoMetadata"],x);const w=b(e,["error"]);return w!=null&&S(n,["error"],HZ(t,w)),n}function KZ(t,e){const n={},r=b(e,["file"]);r!=null&&S(n,["file"],qZ(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function YZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","file"],Q$(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function JZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","file"],Q$(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function XZ(t,e){const n={},r=b(e,["details"]);r!=null&&S(n,["details"],r);const s=b(e,["message"]);s!=null&&S(n,["message"],s);const i=b(e,["code"]);return i!=null&&S(n,["code"],i),n}function vE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["mimeType"]);i!=null&&S(n,["mimeType"],i);const o=b(e,["sizeBytes"]);o!=null&&S(n,["sizeBytes"],o);const l=b(e,["createTime"]);l!=null&&S(n,["createTime"],l);const c=b(e,["expirationTime"]);c!=null&&S(n,["expirationTime"],c);const u=b(e,["updateTime"]);u!=null&&S(n,["updateTime"],u);const d=b(e,["sha256Hash"]);d!=null&&S(n,["sha256Hash"],d);const h=b(e,["uri"]);h!=null&&S(n,["uri"],h);const f=b(e,["downloadUri"]);f!=null&&S(n,["downloadUri"],f);const m=b(e,["state"]);m!=null&&S(n,["state"],m);const g=b(e,["source"]);g!=null&&S(n,["source"],g);const x=b(e,["videoMetadata"]);x!=null&&S(n,["videoMetadata"],x);const w=b(e,["error"]);return w!=null&&S(n,["error"],XZ(t,w)),n}function QZ(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["files"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>vE(t,o))),S(n,["files"],i)}return n}function ZZ(){return{}}function eee(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let tee=class extends _g{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new k0(Yh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>vE(this.apiClient,n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=WZ(this.apiClient,e);return i=qt("files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=QZ(this.apiClient,c),d=new DZ;return Object.assign(d,u),d})}}async createInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=KZ(this.apiClient,e);return i=qt("upload/v1beta/files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=ZZ(),u=new MZ;return Object.assign(u,c),u})}}async get(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=YZ(this.apiClient,e);return i=qt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>vE(this.apiClient,c))}}async delete(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=JZ(this.apiClient,e);return i=qt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=eee(),u=new LZ;return Object.assign(u,c),u})}}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nee(t,e){const n={};if(b(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function ree(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function see(t,e){const n={};if(b(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],nee(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function iee(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],ree(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function oee(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>see(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function aee(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>iee(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function lee(){return{}}function cee(){return{}}function uee(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function dee(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function hee(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],uee(t,r)),n}function fee(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],dee(t,r)),n}function mee(){return{}}function pee(t,e){const n={},r=b(e,["apiKeyString"]);return r!=null&&S(n,["apiKeyString"],r),n}function gee(t,e){const n={},r=b(e,["apiKeyConfig"]);r!=null&&S(n,["apiKeyConfig"],pee(t,r));const s=b(e,["authType"]);s!=null&&S(n,["authType"],s);const i=b(e,["googleServiceAccountConfig"]);i!=null&&S(n,["googleServiceAccountConfig"],i);const o=b(e,["httpBasicAuthConfig"]);o!=null&&S(n,["httpBasicAuthConfig"],o);const l=b(e,["oauthConfig"]);l!=null&&S(n,["oauthConfig"],l);const c=b(e,["oidcConfig"]);return c!=null&&S(n,["oidcConfig"],c),n}function yee(t,e){const n={},r=b(e,["authConfig"]);return r!=null&&S(n,["authConfig"],gee(t,r)),n}function xee(t,e){const n={};if(b(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");b(e,["googleSearch"])!=null&&S(n,["googleSearch"],lee());const s=b(e,["googleSearchRetrieval"]);if(s!=null&&S(n,["googleSearchRetrieval"],hee(t,s)),b(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(b(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=b(e,["codeExecution"]);i!=null&&S(n,["codeExecution"],i);const o=b(e,["functionDeclarations"]);return o!=null&&S(n,["functionDeclarations"],o),n}function vee(t,e){const n={},r=b(e,["retrieval"]);r!=null&&S(n,["retrieval"],r),b(e,["googleSearch"])!=null&&S(n,["googleSearch"],cee());const i=b(e,["googleSearchRetrieval"]);i!=null&&S(n,["googleSearchRetrieval"],fee(t,i)),b(e,["enterpriseWebSearch"])!=null&&S(n,["enterpriseWebSearch"],mee());const l=b(e,["googleMaps"]);l!=null&&S(n,["googleMaps"],yee(t,l));const c=b(e,["codeExecution"]);c!=null&&S(n,["codeExecution"],c);const u=b(e,["functionDeclarations"]);return u!=null&&S(n,["functionDeclarations"],u),n}function wee(t,e){const n={},r=b(e,["handle"]);if(r!=null&&S(n,["handle"],r),b(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return n}function bee(t,e){const n={},r=b(e,["handle"]);r!=null&&S(n,["handle"],r);const s=b(e,["transparent"]);return s!=null&&S(n,["transparent"],s),n}function n2(){return{}}function r2(){return{}}function _ee(t,e){const n={},r=b(e,["disabled"]);r!=null&&S(n,["disabled"],r);const s=b(e,["startOfSpeechSensitivity"]);s!=null&&S(n,["startOfSpeechSensitivity"],s);const i=b(e,["endOfSpeechSensitivity"]);i!=null&&S(n,["endOfSpeechSensitivity"],i);const o=b(e,["prefixPaddingMs"]);o!=null&&S(n,["prefixPaddingMs"],o);const l=b(e,["silenceDurationMs"]);return l!=null&&S(n,["silenceDurationMs"],l),n}function See(t,e){const n={},r=b(e,["disabled"]);r!=null&&S(n,["disabled"],r);const s=b(e,["startOfSpeechSensitivity"]);s!=null&&S(n,["startOfSpeechSensitivity"],s);const i=b(e,["endOfSpeechSensitivity"]);i!=null&&S(n,["endOfSpeechSensitivity"],i);const o=b(e,["prefixPaddingMs"]);o!=null&&S(n,["prefixPaddingMs"],o);const l=b(e,["silenceDurationMs"]);return l!=null&&S(n,["silenceDurationMs"],l),n}function Cee(t,e){const n={},r=b(e,["automaticActivityDetection"]);r!=null&&S(n,["automaticActivityDetection"],_ee(t,r));const s=b(e,["activityHandling"]);s!=null&&S(n,["activityHandling"],s);const i=b(e,["turnCoverage"]);return i!=null&&S(n,["turnCoverage"],i),n}function Eee(t,e){const n={},r=b(e,["automaticActivityDetection"]);r!=null&&S(n,["automaticActivityDetection"],See(t,r));const s=b(e,["activityHandling"]);s!=null&&S(n,["activityHandling"],s);const i=b(e,["turnCoverage"]);return i!=null&&S(n,["turnCoverage"],i),n}function Tee(t,e){const n={},r=b(e,["targetTokens"]);return r!=null&&S(n,["targetTokens"],r),n}function Iee(t,e){const n={},r=b(e,["targetTokens"]);return r!=null&&S(n,["targetTokens"],r),n}function Nee(t,e){const n={},r=b(e,["triggerTokens"]);r!=null&&S(n,["triggerTokens"],r);const s=b(e,["slidingWindow"]);return s!=null&&S(n,["slidingWindow"],Tee(t,s)),n}function Pee(t,e){const n={},r=b(e,["triggerTokens"]);r!=null&&S(n,["triggerTokens"],r);const s=b(e,["slidingWindow"]);return s!=null&&S(n,["slidingWindow"],Iee(t,s)),n}function Aee(t,e,n){const r={},s=b(e,["generationConfig"]);n!==void 0&&s!=null&&S(n,["setup","generationConfig"],s);const i=b(e,["responseModalities"]);n!==void 0&&i!=null&&S(n,["setup","generationConfig","responseModalities"],i);const o=b(e,["temperature"]);n!==void 0&&o!=null&&S(n,["setup","generationConfig","temperature"],o);const l=b(e,["topP"]);n!==void 0&&l!=null&&S(n,["setup","generationConfig","topP"],l);const c=b(e,["topK"]);n!==void 0&&c!=null&&S(n,["setup","generationConfig","topK"],c);const u=b(e,["maxOutputTokens"]);n!==void 0&&u!=null&&S(n,["setup","generationConfig","maxOutputTokens"],u);const d=b(e,["mediaResolution"]);n!==void 0&&d!=null&&S(n,["setup","generationConfig","mediaResolution"],d);const h=b(e,["seed"]);n!==void 0&&h!=null&&S(n,["setup","generationConfig","seed"],h);const f=b(e,["speechConfig"]);n!==void 0&&f!=null&&S(n,["setup","generationConfig","speechConfig"],f);const m=b(e,["systemInstruction"]);n!==void 0&&m!=null&&S(n,["setup","systemInstruction"],oee(t,hi(t,m)));const g=b(e,["tools"]);if(n!==void 0&&g!=null){let T=A0(t,g);Array.isArray(T)&&(T=T.map(R=>xee(t,P0(t,R)))),S(n,["setup","tools"],T)}const x=b(e,["sessionResumption"]);n!==void 0&&x!=null&&S(n,["setup","sessionResumption"],wee(t,x));const w=b(e,["inputAudioTranscription"]);n!==void 0&&w!=null&&S(n,["setup","inputAudioTranscription"],n2());const v=b(e,["outputAudioTranscription"]);n!==void 0&&v!=null&&S(n,["setup","outputAudioTranscription"],n2());const _=b(e,["realtimeInputConfig"]);n!==void 0&&_!=null&&S(n,["setup","realtimeInputConfig"],Cee(t,_));const C=b(e,["contextWindowCompression"]);return n!==void 0&&C!=null&&S(n,["setup","contextWindowCompression"],Nee(t,C)),r}function kee(t,e,n){const r={},s=b(e,["generationConfig"]);n!==void 0&&s!=null&&S(n,["setup","generationConfig"],s);const i=b(e,["responseModalities"]);n!==void 0&&i!=null&&S(n,["setup","generationConfig","responseModalities"],i);const o=b(e,["temperature"]);n!==void 0&&o!=null&&S(n,["setup","generationConfig","temperature"],o);const l=b(e,["topP"]);n!==void 0&&l!=null&&S(n,["setup","generationConfig","topP"],l);const c=b(e,["topK"]);n!==void 0&&c!=null&&S(n,["setup","generationConfig","topK"],c);const u=b(e,["maxOutputTokens"]);n!==void 0&&u!=null&&S(n,["setup","generationConfig","maxOutputTokens"],u);const d=b(e,["mediaResolution"]);n!==void 0&&d!=null&&S(n,["setup","generationConfig","mediaResolution"],d);const h=b(e,["seed"]);n!==void 0&&h!=null&&S(n,["setup","generationConfig","seed"],h);const f=b(e,["speechConfig"]);n!==void 0&&f!=null&&S(n,["setup","generationConfig","speechConfig"],f);const m=b(e,["systemInstruction"]);n!==void 0&&m!=null&&S(n,["setup","systemInstruction"],aee(t,hi(t,m)));const g=b(e,["tools"]);if(n!==void 0&&g!=null){let T=A0(t,g);Array.isArray(T)&&(T=T.map(R=>vee(t,P0(t,R)))),S(n,["setup","tools"],T)}const x=b(e,["sessionResumption"]);n!==void 0&&x!=null&&S(n,["setup","sessionResumption"],bee(t,x));const w=b(e,["inputAudioTranscription"]);n!==void 0&&w!=null&&S(n,["setup","inputAudioTranscription"],r2());const v=b(e,["outputAudioTranscription"]);n!==void 0&&v!=null&&S(n,["setup","outputAudioTranscription"],r2());const _=b(e,["realtimeInputConfig"]);n!==void 0&&_!=null&&S(n,["setup","realtimeInputConfig"],Eee(t,_));const C=b(e,["contextWindowCompression"]);return n!==void 0&&C!=null&&S(n,["setup","contextWindowCompression"],Pee(t,C)),r}function Ree(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["setup","model"],dr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],Aee(t,s,n)),n}function jee(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["setup","model"],dr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],kee(t,s,n)),n}function Dee(){return{}}function Mee(){return{}}function Lee(){return{}}function Fee(){return{}}function Oee(t,e){const n={},r=b(e,["media"]);r!=null&&S(n,["mediaChunks"],H$(t,r));const s=b(e,["audio"]);s!=null&&S(n,["audio"],FQ(t,s));const i=b(e,["audioStreamEnd"]);i!=null&&S(n,["audioStreamEnd"],i);const o=b(e,["video"]);o!=null&&S(n,["video"],LQ(t,o));const l=b(e,["text"]);return l!=null&&S(n,["text"],l),b(e,["activityStart"])!=null&&S(n,["activityStart"],Dee()),b(e,["activityEnd"])!=null&&S(n,["activityEnd"],Lee()),n}function Vee(t,e){const n={},r=b(e,["media"]);if(r!=null&&S(n,["mediaChunks"],H$(t,r)),b(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const s=b(e,["audioStreamEnd"]);if(s!=null&&S(n,["audioStreamEnd"],s),b(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(b(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return b(e,["activityStart"])!=null&&S(n,["activityStart"],Mee()),b(e,["activityEnd"])!=null&&S(n,["activityEnd"],Fee()),n}function $ee(){return{}}function Uee(){return{}}function Bee(t,e){const n={},r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function zee(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function Gee(t,e){const n={},r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],Bee(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function Wee(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],zee(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function Hee(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Gee(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function qee(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Wee(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function s2(t,e){const n={},r=b(e,["text"]);r!=null&&S(n,["text"],r);const s=b(e,["finished"]);return s!=null&&S(n,["finished"],s),n}function i2(t,e){const n={},r=b(e,["text"]);r!=null&&S(n,["text"],r);const s=b(e,["finished"]);return s!=null&&S(n,["finished"],s),n}function Kee(t,e){const n={},r=b(e,["modelTurn"]);r!=null&&S(n,["modelTurn"],Hee(t,r));const s=b(e,["turnComplete"]);s!=null&&S(n,["turnComplete"],s);const i=b(e,["interrupted"]);i!=null&&S(n,["interrupted"],i);const o=b(e,["groundingMetadata"]);o!=null&&S(n,["groundingMetadata"],o);const l=b(e,["generationComplete"]);l!=null&&S(n,["generationComplete"],l);const c=b(e,["inputTranscription"]);c!=null&&S(n,["inputTranscription"],s2(t,c));const u=b(e,["outputTranscription"]);return u!=null&&S(n,["outputTranscription"],s2(t,u)),n}function Yee(t,e){const n={},r=b(e,["modelTurn"]);r!=null&&S(n,["modelTurn"],qee(t,r));const s=b(e,["turnComplete"]);s!=null&&S(n,["turnComplete"],s);const i=b(e,["interrupted"]);i!=null&&S(n,["interrupted"],i);const o=b(e,["groundingMetadata"]);o!=null&&S(n,["groundingMetadata"],o);const l=b(e,["generationComplete"]);l!=null&&S(n,["generationComplete"],l);const c=b(e,["inputTranscription"]);c!=null&&S(n,["inputTranscription"],i2(t,c));const u=b(e,["outputTranscription"]);return u!=null&&S(n,["outputTranscription"],i2(t,u)),n}function Jee(t,e){const n={},r=b(e,["id"]);r!=null&&S(n,["id"],r);const s=b(e,["args"]);s!=null&&S(n,["args"],s);const i=b(e,["name"]);return i!=null&&S(n,["name"],i),n}function Xee(t,e){const n={},r=b(e,["args"]);r!=null&&S(n,["args"],r);const s=b(e,["name"]);return s!=null&&S(n,["name"],s),n}function Qee(t,e){const n={},r=b(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>Jee(t,i))),S(n,["functionCalls"],s)}return n}function Zee(t,e){const n={},r=b(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>Xee(t,i))),S(n,["functionCalls"],s)}return n}function ete(t,e){const n={},r=b(e,["ids"]);return r!=null&&S(n,["ids"],r),n}function tte(t,e){const n={},r=b(e,["ids"]);return r!=null&&S(n,["ids"],r),n}function $y(t,e){const n={},r=b(e,["modality"]);r!=null&&S(n,["modality"],r);const s=b(e,["tokenCount"]);return s!=null&&S(n,["tokenCount"],s),n}function Uy(t,e){const n={},r=b(e,["modality"]);r!=null&&S(n,["modality"],r);const s=b(e,["tokenCount"]);return s!=null&&S(n,["tokenCount"],s),n}function nte(t,e){const n={},r=b(e,["promptTokenCount"]);r!=null&&S(n,["promptTokenCount"],r);const s=b(e,["cachedContentTokenCount"]);s!=null&&S(n,["cachedContentTokenCount"],s);const i=b(e,["responseTokenCount"]);i!=null&&S(n,["responseTokenCount"],i);const o=b(e,["toolUsePromptTokenCount"]);o!=null&&S(n,["toolUsePromptTokenCount"],o);const l=b(e,["thoughtsTokenCount"]);l!=null&&S(n,["thoughtsTokenCount"],l);const c=b(e,["totalTokenCount"]);c!=null&&S(n,["totalTokenCount"],c);const u=b(e,["promptTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(g=>$y(t,g))),S(n,["promptTokensDetails"],m)}const d=b(e,["cacheTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(g=>$y(t,g))),S(n,["cacheTokensDetails"],m)}const h=b(e,["responseTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>$y(t,g))),S(n,["responseTokensDetails"],m)}const f=b(e,["toolUsePromptTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>$y(t,g))),S(n,["toolUsePromptTokensDetails"],m)}return n}function rte(t,e){const n={},r=b(e,["promptTokenCount"]);r!=null&&S(n,["promptTokenCount"],r);const s=b(e,["cachedContentTokenCount"]);s!=null&&S(n,["cachedContentTokenCount"],s);const i=b(e,["candidatesTokenCount"]);i!=null&&S(n,["responseTokenCount"],i);const o=b(e,["toolUsePromptTokenCount"]);o!=null&&S(n,["toolUsePromptTokenCount"],o);const l=b(e,["thoughtsTokenCount"]);l!=null&&S(n,["thoughtsTokenCount"],l);const c=b(e,["totalTokenCount"]);c!=null&&S(n,["totalTokenCount"],c);const u=b(e,["promptTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(x=>Uy(t,x))),S(n,["promptTokensDetails"],g)}const d=b(e,["cacheTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(x=>Uy(t,x))),S(n,["cacheTokensDetails"],g)}const h=b(e,["candidatesTokensDetails"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(x=>Uy(t,x))),S(n,["responseTokensDetails"],g)}const f=b(e,["toolUsePromptTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(x=>Uy(t,x))),S(n,["toolUsePromptTokensDetails"],g)}const m=b(e,["trafficType"]);return m!=null&&S(n,["trafficType"],m),n}function ste(t,e){const n={},r=b(e,["timeLeft"]);return r!=null&&S(n,["timeLeft"],r),n}function ite(t,e){const n={},r=b(e,["timeLeft"]);return r!=null&&S(n,["timeLeft"],r),n}function ote(t,e){const n={},r=b(e,["newHandle"]);r!=null&&S(n,["newHandle"],r);const s=b(e,["resumable"]);s!=null&&S(n,["resumable"],s);const i=b(e,["lastConsumedClientMessageIndex"]);return i!=null&&S(n,["lastConsumedClientMessageIndex"],i),n}function ate(t,e){const n={},r=b(e,["newHandle"]);r!=null&&S(n,["newHandle"],r);const s=b(e,["resumable"]);s!=null&&S(n,["resumable"],s);const i=b(e,["lastConsumedClientMessageIndex"]);return i!=null&&S(n,["lastConsumedClientMessageIndex"],i),n}function lte(t,e){const n={};b(e,["setupComplete"])!=null&&S(n,["setupComplete"],$ee());const s=b(e,["serverContent"]);s!=null&&S(n,["serverContent"],Kee(t,s));const i=b(e,["toolCall"]);i!=null&&S(n,["toolCall"],Qee(t,i));const o=b(e,["toolCallCancellation"]);o!=null&&S(n,["toolCallCancellation"],ete(t,o));const l=b(e,["usageMetadata"]);l!=null&&S(n,["usageMetadata"],nte(t,l));const c=b(e,["goAway"]);c!=null&&S(n,["goAway"],ste(t,c));const u=b(e,["sessionResumptionUpdate"]);return u!=null&&S(n,["sessionResumptionUpdate"],ote(t,u)),n}function cte(t,e){const n={};b(e,["setupComplete"])!=null&&S(n,["setupComplete"],Uee());const s=b(e,["serverContent"]);s!=null&&S(n,["serverContent"],Yee(t,s));const i=b(e,["toolCall"]);i!=null&&S(n,["toolCall"],Zee(t,i));const o=b(e,["toolCallCancellation"]);o!=null&&S(n,["toolCallCancellation"],tte(t,o));const l=b(e,["usageMetadata"]);l!=null&&S(n,["usageMetadata"],rte(t,l));const c=b(e,["goAway"]);c!=null&&S(n,["goAway"],ite(t,c));const u=b(e,["sessionResumptionUpdate"]);return u!=null&&S(n,["sessionResumptionUpdate"],ate(t,u)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ute(t,e){const n={};if(b(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function dte(t,e){const n={};if(b(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],ute(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function R0(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>dte(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function hte(t,e){const n={};if(b(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=b(e,["category"]);r!=null&&S(n,["category"],r);const s=b(e,["threshold"]);return s!=null&&S(n,["threshold"],s),n}function fte(){return{}}function mte(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function pte(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],mte(t,r)),n}function gte(t,e){const n={};if(b(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");b(e,["googleSearch"])!=null&&S(n,["googleSearch"],fte());const s=b(e,["googleSearchRetrieval"]);if(s!=null&&S(n,["googleSearchRetrieval"],pte(t,s)),b(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(b(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=b(e,["codeExecution"]);i!=null&&S(n,["codeExecution"],i);const o=b(e,["functionDeclarations"]);return o!=null&&S(n,["functionDeclarations"],o),n}function yte(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function xte(t,e){const n={},r=b(e,["functionCallingConfig"]);if(r!=null&&S(n,["functionCallingConfig"],yte(t,r)),b(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}function vte(t,e){const n={},r=b(e,["voiceName"]);return r!=null&&S(n,["voiceName"],r),n}function wte(t,e){const n={},r=b(e,["prebuiltVoiceConfig"]);return r!=null&&S(n,["prebuiltVoiceConfig"],vte(t,r)),n}function bte(t,e){const n={},r=b(e,["voiceConfig"]);r!=null&&S(n,["voiceConfig"],wte(t,r));const s=b(e,["languageCode"]);return s!=null&&S(n,["languageCode"],s),n}function _te(t,e){const n={},r=b(e,["includeThoughts"]);r!=null&&S(n,["includeThoughts"],r);const s=b(e,["thinkingBudget"]);return s!=null&&S(n,["thinkingBudget"],s),n}function Ste(t,e,n){const r={},s=b(e,["systemInstruction"]);n!==void 0&&s!=null&&S(n,["systemInstruction"],R0(t,hi(t,s)));const i=b(e,["temperature"]);i!=null&&S(r,["temperature"],i);const o=b(e,["topP"]);o!=null&&S(r,["topP"],o);const l=b(e,["topK"]);l!=null&&S(r,["topK"],l);const c=b(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const u=b(e,["maxOutputTokens"]);u!=null&&S(r,["maxOutputTokens"],u);const d=b(e,["stopSequences"]);d!=null&&S(r,["stopSequences"],d);const h=b(e,["responseLogprobs"]);h!=null&&S(r,["responseLogprobs"],h);const f=b(e,["logprobs"]);f!=null&&S(r,["logprobs"],f);const m=b(e,["presencePenalty"]);m!=null&&S(r,["presencePenalty"],m);const g=b(e,["frequencyPenalty"]);g!=null&&S(r,["frequencyPenalty"],g);const x=b(e,["seed"]);x!=null&&S(r,["seed"],x);const w=b(e,["responseMimeType"]);w!=null&&S(r,["responseMimeType"],w);const v=b(e,["responseSchema"]);if(v!=null&&S(r,["responseSchema"],Y$(t,v)),b(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(b(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=b(e,["safetySettings"]);if(n!==void 0&&_!=null){let k=_;Array.isArray(k)&&(k=k.map(j=>hte(t,j))),S(n,["safetySettings"],k)}const C=b(e,["tools"]);if(n!==void 0&&C!=null){let k=A0(t,C);Array.isArray(k)&&(k=k.map(j=>gte(t,P0(t,j)))),S(n,["tools"],k)}const T=b(e,["toolConfig"]);if(n!==void 0&&T!=null&&S(n,["toolConfig"],xte(t,T)),b(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=b(e,["cachedContent"]);n!==void 0&&R!=null&&S(n,["cachedContent"],Lc(t,R));const A=b(e,["responseModalities"]);A!=null&&S(r,["responseModalities"],A);const E=b(e,["mediaResolution"]);E!=null&&S(r,["mediaResolution"],E);const I=b(e,["speechConfig"]);if(I!=null&&S(r,["speechConfig"],bte(t,J$(t,I))),b(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=b(e,["thinkingConfig"]);return P!=null&&S(r,["thinkingConfig"],_te(t,P)),r}function o2(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["contents"]);if(s!=null){let o=Mc(t,s);Array.isArray(o)&&(o=o.map(l=>R0(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["generationConfig"],Ste(t,i,n)),n}function Cte(t,e,n){const r={},s=b(e,["taskType"]);n!==void 0&&s!=null&&S(n,["requests[]","taskType"],s);const i=b(e,["title"]);n!==void 0&&i!=null&&S(n,["requests[]","title"],i);const o=b(e,["outputDimensionality"]);if(n!==void 0&&o!=null&&S(n,["requests[]","outputDimensionality"],o),b(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(b(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function Ete(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["contents"]);s!=null&&S(n,["requests[]","content"],K$(t,s));const i=b(e,["config"]);i!=null&&S(n,["config"],Cte(t,i,n));const o=b(e,["model"]);return o!==void 0&&S(n,["requests[]","model"],dr(t,o)),n}function Tte(t,e,n){const r={};if(b(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(b(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=b(e,["numberOfImages"]);n!==void 0&&s!=null&&S(n,["parameters","sampleCount"],s);const i=b(e,["aspectRatio"]);n!==void 0&&i!=null&&S(n,["parameters","aspectRatio"],i);const o=b(e,["guidanceScale"]);if(n!==void 0&&o!=null&&S(n,["parameters","guidanceScale"],o),b(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=b(e,["safetyFilterLevel"]);n!==void 0&&l!=null&&S(n,["parameters","safetySetting"],l);const c=b(e,["personGeneration"]);n!==void 0&&c!=null&&S(n,["parameters","personGeneration"],c);const u=b(e,["includeSafetyAttributes"]);n!==void 0&&u!=null&&S(n,["parameters","includeSafetyAttributes"],u);const d=b(e,["includeRaiReason"]);n!==void 0&&d!=null&&S(n,["parameters","includeRaiReason"],d);const h=b(e,["language"]);n!==void 0&&h!=null&&S(n,["parameters","language"],h);const f=b(e,["outputMimeType"]);n!==void 0&&f!=null&&S(n,["parameters","outputOptions","mimeType"],f);const m=b(e,["outputCompressionQuality"]);if(n!==void 0&&m!=null&&S(n,["parameters","outputOptions","compressionQuality"],m),b(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(b(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function Ite(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["config"]);return i!=null&&S(n,["config"],Tte(t,i,n)),n}function Nte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],dr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Pte(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);n!==void 0&&o!=null&&S(n,["_query","filter"],o);const l=b(e,["queryBase"]);return n!==void 0&&l!=null&&S(n,["_url","models_url"],Z$(t,l)),r}function Ate(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],Pte(t,r,n)),n}function kte(t,e,n){const r={},s=b(e,["displayName"]);n!==void 0&&s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);n!==void 0&&i!=null&&S(n,["description"],i);const o=b(e,["defaultCheckpointId"]);return n!==void 0&&o!=null&&S(n,["defaultCheckpointId"],o),r}function Rte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],dr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],kte(t,s,n)),n}function jte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],dr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Dte(t,e){const n={};if(b(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(b(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(b(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return n}function Mte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["contents"]);if(s!=null){let o=Mc(t,s);Array.isArray(o)&&(o=o.map(l=>R0(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["config"],Dte(t,i)),n}function Lte(t,e){const n={};if(b(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=b(e,["imageBytes"]);r!=null&&S(n,["bytesBase64Encoded"],Fc(t,r));const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function Fte(t,e,n){const r={},s=b(e,["numberOfVideos"]);if(n!==void 0&&s!=null&&S(n,["parameters","sampleCount"],s),b(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(b(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=b(e,["durationSeconds"]);if(n!==void 0&&i!=null&&S(n,["parameters","durationSeconds"],i),b(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=b(e,["aspectRatio"]);if(n!==void 0&&o!=null&&S(n,["parameters","aspectRatio"],o),b(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=b(e,["personGeneration"]);if(n!==void 0&&l!=null&&S(n,["parameters","personGeneration"],l),b(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=b(e,["negativePrompt"]);if(n!==void 0&&c!=null&&S(n,["parameters","negativePrompt"],c),b(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function Ote(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["image"]);i!=null&&S(n,["instances[0]","image"],Lte(t,i));const o=b(e,["config"]);return o!=null&&S(n,["config"],Fte(t,o,n)),n}function Vte(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function $te(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],Vte(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function Ef(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>$te(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function Ute(t,e){const n={},r=b(e,["featureSelectionPreference"]);return r!=null&&S(n,["featureSelectionPreference"],r),n}function Bte(t,e){const n={},r=b(e,["method"]);r!=null&&S(n,["method"],r);const s=b(e,["category"]);s!=null&&S(n,["category"],s);const i=b(e,["threshold"]);return i!=null&&S(n,["threshold"],i),n}function zte(){return{}}function Gte(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function Wte(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],Gte(t,r)),n}function Hte(){return{}}function qte(t,e){const n={},r=b(e,["apiKeyString"]);return r!=null&&S(n,["apiKeyString"],r),n}function Kte(t,e){const n={},r=b(e,["apiKeyConfig"]);r!=null&&S(n,["apiKeyConfig"],qte(t,r));const s=b(e,["authType"]);s!=null&&S(n,["authType"],s);const i=b(e,["googleServiceAccountConfig"]);i!=null&&S(n,["googleServiceAccountConfig"],i);const o=b(e,["httpBasicAuthConfig"]);o!=null&&S(n,["httpBasicAuthConfig"],o);const l=b(e,["oauthConfig"]);l!=null&&S(n,["oauthConfig"],l);const c=b(e,["oidcConfig"]);return c!=null&&S(n,["oidcConfig"],c),n}function Yte(t,e){const n={},r=b(e,["authConfig"]);return r!=null&&S(n,["authConfig"],Kte(t,r)),n}function n3(t,e){const n={},r=b(e,["retrieval"]);r!=null&&S(n,["retrieval"],r),b(e,["googleSearch"])!=null&&S(n,["googleSearch"],zte());const i=b(e,["googleSearchRetrieval"]);i!=null&&S(n,["googleSearchRetrieval"],Wte(t,i)),b(e,["enterpriseWebSearch"])!=null&&S(n,["enterpriseWebSearch"],Hte());const l=b(e,["googleMaps"]);l!=null&&S(n,["googleMaps"],Yte(t,l));const c=b(e,["codeExecution"]);c!=null&&S(n,["codeExecution"],c);const u=b(e,["functionDeclarations"]);return u!=null&&S(n,["functionDeclarations"],u),n}function Jte(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function Xte(t,e){const n={},r=b(e,["latitude"]);r!=null&&S(n,["latitude"],r);const s=b(e,["longitude"]);return s!=null&&S(n,["longitude"],s),n}function Qte(t,e){const n={},r=b(e,["latLng"]);return r!=null&&S(n,["latLng"],Xte(t,r)),n}function Zte(t,e){const n={},r=b(e,["functionCallingConfig"]);r!=null&&S(n,["functionCallingConfig"],Jte(t,r));const s=b(e,["retrievalConfig"]);return s!=null&&S(n,["retrievalConfig"],Qte(t,s)),n}function ene(t,e){const n={},r=b(e,["voiceName"]);return r!=null&&S(n,["voiceName"],r),n}function tne(t,e){const n={},r=b(e,["prebuiltVoiceConfig"]);return r!=null&&S(n,["prebuiltVoiceConfig"],ene(t,r)),n}function nne(t,e){const n={},r=b(e,["voiceConfig"]);r!=null&&S(n,["voiceConfig"],tne(t,r));const s=b(e,["languageCode"]);return s!=null&&S(n,["languageCode"],s),n}function rne(t,e){const n={},r=b(e,["includeThoughts"]);r!=null&&S(n,["includeThoughts"],r);const s=b(e,["thinkingBudget"]);return s!=null&&S(n,["thinkingBudget"],s),n}function sne(t,e,n){const r={},s=b(e,["systemInstruction"]);n!==void 0&&s!=null&&S(n,["systemInstruction"],Ef(t,hi(t,s)));const i=b(e,["temperature"]);i!=null&&S(r,["temperature"],i);const o=b(e,["topP"]);o!=null&&S(r,["topP"],o);const l=b(e,["topK"]);l!=null&&S(r,["topK"],l);const c=b(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const u=b(e,["maxOutputTokens"]);u!=null&&S(r,["maxOutputTokens"],u);const d=b(e,["stopSequences"]);d!=null&&S(r,["stopSequences"],d);const h=b(e,["responseLogprobs"]);h!=null&&S(r,["responseLogprobs"],h);const f=b(e,["logprobs"]);f!=null&&S(r,["logprobs"],f);const m=b(e,["presencePenalty"]);m!=null&&S(r,["presencePenalty"],m);const g=b(e,["frequencyPenalty"]);g!=null&&S(r,["frequencyPenalty"],g);const x=b(e,["seed"]);x!=null&&S(r,["seed"],x);const w=b(e,["responseMimeType"]);w!=null&&S(r,["responseMimeType"],w);const v=b(e,["responseSchema"]);v!=null&&S(r,["responseSchema"],Y$(t,v));const _=b(e,["routingConfig"]);_!=null&&S(r,["routingConfig"],_);const C=b(e,["modelSelectionConfig"]);C!=null&&S(r,["modelConfig"],Ute(t,C));const T=b(e,["safetySettings"]);if(n!==void 0&&T!=null){let G=T;Array.isArray(G)&&(G=G.map(B=>Bte(t,B))),S(n,["safetySettings"],G)}const R=b(e,["tools"]);if(n!==void 0&&R!=null){let G=A0(t,R);Array.isArray(G)&&(G=G.map(B=>n3(t,P0(t,B)))),S(n,["tools"],G)}const A=b(e,["toolConfig"]);n!==void 0&&A!=null&&S(n,["toolConfig"],Zte(t,A));const E=b(e,["labels"]);n!==void 0&&E!=null&&S(n,["labels"],E);const I=b(e,["cachedContent"]);n!==void 0&&I!=null&&S(n,["cachedContent"],Lc(t,I));const P=b(e,["responseModalities"]);P!=null&&S(r,["responseModalities"],P);const k=b(e,["mediaResolution"]);k!=null&&S(r,["mediaResolution"],k);const j=b(e,["speechConfig"]);j!=null&&S(r,["speechConfig"],nne(t,J$(t,j)));const D=b(e,["audioTimestamp"]);D!=null&&S(r,["audioTimestamp"],D);const M=b(e,["thinkingConfig"]);return M!=null&&S(r,["thinkingConfig"],rne(t,M)),r}function a2(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["contents"]);if(s!=null){let o=Mc(t,s);Array.isArray(o)&&(o=o.map(l=>Ef(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["generationConfig"],sne(t,i,n)),n}function ine(t,e,n){const r={},s=b(e,["taskType"]);n!==void 0&&s!=null&&S(n,["instances[]","task_type"],s);const i=b(e,["title"]);n!==void 0&&i!=null&&S(n,["instances[]","title"],i);const o=b(e,["outputDimensionality"]);n!==void 0&&o!=null&&S(n,["parameters","outputDimensionality"],o);const l=b(e,["mimeType"]);n!==void 0&&l!=null&&S(n,["instances[]","mimeType"],l);const c=b(e,["autoTruncate"]);return n!==void 0&&c!=null&&S(n,["parameters","autoTruncate"],c),r}function one(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["contents"]);s!=null&&S(n,["instances[]","content"],K$(t,s));const i=b(e,["config"]);return i!=null&&S(n,["config"],ine(t,i,n)),n}function ane(t,e,n){const r={},s=b(e,["outputGcsUri"]);n!==void 0&&s!=null&&S(n,["parameters","storageUri"],s);const i=b(e,["negativePrompt"]);n!==void 0&&i!=null&&S(n,["parameters","negativePrompt"],i);const o=b(e,["numberOfImages"]);n!==void 0&&o!=null&&S(n,["parameters","sampleCount"],o);const l=b(e,["aspectRatio"]);n!==void 0&&l!=null&&S(n,["parameters","aspectRatio"],l);const c=b(e,["guidanceScale"]);n!==void 0&&c!=null&&S(n,["parameters","guidanceScale"],c);const u=b(e,["seed"]);n!==void 0&&u!=null&&S(n,["parameters","seed"],u);const d=b(e,["safetyFilterLevel"]);n!==void 0&&d!=null&&S(n,["parameters","safetySetting"],d);const h=b(e,["personGeneration"]);n!==void 0&&h!=null&&S(n,["parameters","personGeneration"],h);const f=b(e,["includeSafetyAttributes"]);n!==void 0&&f!=null&&S(n,["parameters","includeSafetyAttributes"],f);const m=b(e,["includeRaiReason"]);n!==void 0&&m!=null&&S(n,["parameters","includeRaiReason"],m);const g=b(e,["language"]);n!==void 0&&g!=null&&S(n,["parameters","language"],g);const x=b(e,["outputMimeType"]);n!==void 0&&x!=null&&S(n,["parameters","outputOptions","mimeType"],x);const w=b(e,["outputCompressionQuality"]);n!==void 0&&w!=null&&S(n,["parameters","outputOptions","compressionQuality"],w);const v=b(e,["addWatermark"]);n!==void 0&&v!=null&&S(n,["parameters","addWatermark"],v);const _=b(e,["enhancePrompt"]);return n!==void 0&&_!=null&&S(n,["parameters","enhancePrompt"],_),r}function lne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["config"]);return i!=null&&S(n,["config"],ane(t,i,n)),n}function vI(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["gcsUri"],r);const s=b(e,["imageBytes"]);s!=null&&S(n,["bytesBase64Encoded"],Fc(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function cne(t,e){const n={},r=b(e,["maskMode"]);r!=null&&S(n,["maskMode"],r);const s=b(e,["segmentationClasses"]);s!=null&&S(n,["maskClasses"],s);const i=b(e,["maskDilation"]);return i!=null&&S(n,["dilation"],i),n}function une(t,e){const n={},r=b(e,["controlType"]);r!=null&&S(n,["controlType"],r);const s=b(e,["enableControlImageComputation"]);return s!=null&&S(n,["computeControl"],s),n}function dne(t,e){const n={},r=b(e,["styleDescription"]);return r!=null&&S(n,["styleDescription"],r),n}function hne(t,e){const n={},r=b(e,["subjectType"]);r!=null&&S(n,["subjectType"],r);const s=b(e,["subjectDescription"]);return s!=null&&S(n,["subjectDescription"],s),n}function fne(t,e){const n={},r=b(e,["referenceImage"]);r!=null&&S(n,["referenceImage"],vI(t,r));const s=b(e,["referenceId"]);s!=null&&S(n,["referenceId"],s);const i=b(e,["referenceType"]);i!=null&&S(n,["referenceType"],i);const o=b(e,["maskImageConfig"]);o!=null&&S(n,["maskImageConfig"],cne(t,o));const l=b(e,["controlImageConfig"]);l!=null&&S(n,["controlImageConfig"],une(t,l));const c=b(e,["styleImageConfig"]);c!=null&&S(n,["styleImageConfig"],dne(t,c));const u=b(e,["subjectImageConfig"]);return u!=null&&S(n,["subjectImageConfig"],hne(t,u)),n}function mne(t,e,n){const r={},s=b(e,["outputGcsUri"]);n!==void 0&&s!=null&&S(n,["parameters","storageUri"],s);const i=b(e,["negativePrompt"]);n!==void 0&&i!=null&&S(n,["parameters","negativePrompt"],i);const o=b(e,["numberOfImages"]);n!==void 0&&o!=null&&S(n,["parameters","sampleCount"],o);const l=b(e,["aspectRatio"]);n!==void 0&&l!=null&&S(n,["parameters","aspectRatio"],l);const c=b(e,["guidanceScale"]);n!==void 0&&c!=null&&S(n,["parameters","guidanceScale"],c);const u=b(e,["seed"]);n!==void 0&&u!=null&&S(n,["parameters","seed"],u);const d=b(e,["safetyFilterLevel"]);n!==void 0&&d!=null&&S(n,["parameters","safetySetting"],d);const h=b(e,["personGeneration"]);n!==void 0&&h!=null&&S(n,["parameters","personGeneration"],h);const f=b(e,["includeSafetyAttributes"]);n!==void 0&&f!=null&&S(n,["parameters","includeSafetyAttributes"],f);const m=b(e,["includeRaiReason"]);n!==void 0&&m!=null&&S(n,["parameters","includeRaiReason"],m);const g=b(e,["language"]);n!==void 0&&g!=null&&S(n,["parameters","language"],g);const x=b(e,["outputMimeType"]);n!==void 0&&x!=null&&S(n,["parameters","outputOptions","mimeType"],x);const w=b(e,["outputCompressionQuality"]);n!==void 0&&w!=null&&S(n,["parameters","outputOptions","compressionQuality"],w);const v=b(e,["editMode"]);n!==void 0&&v!=null&&S(n,["parameters","editMode"],v);const _=b(e,["baseSteps"]);return n!==void 0&&_!=null&&S(n,["parameters","editConfig","baseSteps"],_),r}function pne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["referenceImages"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>fne(t,c))),S(n,["instances[0]","referenceImages"],l)}const o=b(e,["config"]);return o!=null&&S(n,["config"],mne(t,o,n)),n}function gne(t,e,n){const r={},s=b(e,["includeRaiReason"]);n!==void 0&&s!=null&&S(n,["parameters","includeRaiReason"],s);const i=b(e,["outputMimeType"]);n!==void 0&&i!=null&&S(n,["parameters","outputOptions","mimeType"],i);const o=b(e,["outputCompressionQuality"]);n!==void 0&&o!=null&&S(n,["parameters","outputOptions","compressionQuality"],o);const l=b(e,["numberOfImages"]);n!==void 0&&l!=null&&S(n,["parameters","sampleCount"],l);const c=b(e,["mode"]);return n!==void 0&&c!=null&&S(n,["parameters","mode"],c),r}function yne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["image"]);s!=null&&S(n,["instances[0]","image"],vI(t,s));const i=b(e,["upscaleFactor"]);i!=null&&S(n,["parameters","upscaleConfig","upscaleFactor"],i);const o=b(e,["config"]);return o!=null&&S(n,["config"],gne(t,o,n)),n}function xne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],dr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function vne(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);n!==void 0&&o!=null&&S(n,["_query","filter"],o);const l=b(e,["queryBase"]);return n!==void 0&&l!=null&&S(n,["_url","models_url"],Z$(t,l)),r}function wne(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],vne(t,r,n)),n}function bne(t,e,n){const r={},s=b(e,["displayName"]);n!==void 0&&s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);n!==void 0&&i!=null&&S(n,["description"],i);const o=b(e,["defaultCheckpointId"]);return n!==void 0&&o!=null&&S(n,["defaultCheckpointId"],o),r}function _ne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],bne(t,s,n)),n}function Sne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],dr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Cne(t,e,n){const r={},s=b(e,["systemInstruction"]);n!==void 0&&s!=null&&S(n,["systemInstruction"],Ef(t,hi(t,s)));const i=b(e,["tools"]);if(n!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>n3(t,c))),S(n,["tools"],l)}const o=b(e,["generationConfig"]);return n!==void 0&&o!=null&&S(n,["generationConfig"],o),r}function Ene(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["contents"]);if(s!=null){let o=Mc(t,s);Array.isArray(o)&&(o=o.map(l=>Ef(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["config"],Cne(t,i,n)),n}function Tne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["contents"]);if(s!=null){let o=Mc(t,s);Array.isArray(o)&&(o=o.map(l=>Ef(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["config"],i),n}function Ine(t,e,n){const r={},s=b(e,["numberOfVideos"]);n!==void 0&&s!=null&&S(n,["parameters","sampleCount"],s);const i=b(e,["outputGcsUri"]);n!==void 0&&i!=null&&S(n,["parameters","storageUri"],i);const o=b(e,["fps"]);n!==void 0&&o!=null&&S(n,["parameters","fps"],o);const l=b(e,["durationSeconds"]);n!==void 0&&l!=null&&S(n,["parameters","durationSeconds"],l);const c=b(e,["seed"]);n!==void 0&&c!=null&&S(n,["parameters","seed"],c);const u=b(e,["aspectRatio"]);n!==void 0&&u!=null&&S(n,["parameters","aspectRatio"],u);const d=b(e,["resolution"]);n!==void 0&&d!=null&&S(n,["parameters","resolution"],d);const h=b(e,["personGeneration"]);n!==void 0&&h!=null&&S(n,["parameters","personGeneration"],h);const f=b(e,["pubsubTopic"]);n!==void 0&&f!=null&&S(n,["parameters","pubsubTopic"],f);const m=b(e,["negativePrompt"]);n!==void 0&&m!=null&&S(n,["parameters","negativePrompt"],m);const g=b(e,["enhancePrompt"]);return n!==void 0&&g!=null&&S(n,["parameters","enhancePrompt"],g),r}function Nne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],dr(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["image"]);i!=null&&S(n,["instances[0]","image"],vI(t,i));const o=b(e,["config"]);return o!=null&&S(n,["config"],Ine(t,o,n)),n}function Pne(t,e){const n={},r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function Ane(t,e){const n={},r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],Pne(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function kne(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Ane(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function Rne(t,e){const n={},r=b(e,["citationSources"]);return r!=null&&S(n,["citations"],r),n}function jne(t,e){const n={},r=b(e,["content"]);r!=null&&S(n,["content"],kne(t,r));const s=b(e,["citationMetadata"]);s!=null&&S(n,["citationMetadata"],Rne(t,s));const i=b(e,["tokenCount"]);i!=null&&S(n,["tokenCount"],i);const o=b(e,["finishReason"]);o!=null&&S(n,["finishReason"],o);const l=b(e,["avgLogprobs"]);l!=null&&S(n,["avgLogprobs"],l);const c=b(e,["groundingMetadata"]);c!=null&&S(n,["groundingMetadata"],c);const u=b(e,["index"]);u!=null&&S(n,["index"],u);const d=b(e,["logprobsResult"]);d!=null&&S(n,["logprobsResult"],d);const h=b(e,["safetyRatings"]);return h!=null&&S(n,["safetyRatings"],h),n}function l2(t,e){const n={},r=b(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>jne(t,c))),S(n,["candidates"],l)}const s=b(e,["modelVersion"]);s!=null&&S(n,["modelVersion"],s);const i=b(e,["promptFeedback"]);i!=null&&S(n,["promptFeedback"],i);const o=b(e,["usageMetadata"]);return o!=null&&S(n,["usageMetadata"],o),n}function Dne(t,e){const n={},r=b(e,["values"]);return r!=null&&S(n,["values"],r),n}function Mne(){return{}}function Lne(t,e){const n={},r=b(e,["embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Dne(t,o))),S(n,["embeddings"],i)}return b(e,["metadata"])!=null&&S(n,["metadata"],Mne()),n}function Fne(t,e){const n={},r=b(e,["bytesBase64Encoded"]);r!=null&&S(n,["imageBytes"],Fc(t,r));const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function r3(t,e){const n={},r=b(e,["safetyAttributes","categories"]);r!=null&&S(n,["categories"],r);const s=b(e,["safetyAttributes","scores"]);s!=null&&S(n,["scores"],s);const i=b(e,["contentType"]);return i!=null&&S(n,["contentType"],i),n}function One(t,e){const n={},r=b(e,["_self"]);r!=null&&S(n,["image"],Fne(t,r));const s=b(e,["raiFilteredReason"]);s!=null&&S(n,["raiFilteredReason"],s);const i=b(e,["_self"]);return i!=null&&S(n,["safetyAttributes"],r3(t,i)),n}function Vne(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>One(t,o))),S(n,["generatedImages"],i)}const s=b(e,["positivePromptSafetyAttributes"]);return s!=null&&S(n,["positivePromptSafetyAttributes"],r3(t,s)),n}function $ne(t,e){const n={},r=b(e,["baseModel"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["createTime"]);s!=null&&S(n,["createTime"],s);const i=b(e,["updateTime"]);return i!=null&&S(n,["updateTime"],i),n}function wE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);i!=null&&S(n,["description"],i);const o=b(e,["version"]);o!=null&&S(n,["version"],o);const l=b(e,["_self"]);l!=null&&S(n,["tunedModelInfo"],$ne(t,l));const c=b(e,["inputTokenLimit"]);c!=null&&S(n,["inputTokenLimit"],c);const u=b(e,["outputTokenLimit"]);u!=null&&S(n,["outputTokenLimit"],u);const d=b(e,["supportedGenerationMethods"]);return d!=null&&S(n,["supportedActions"],d),n}function Une(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["_self"]);if(s!=null){let i=e3(t,s);Array.isArray(i)&&(i=i.map(o=>wE(t,o))),S(n,["models"],i)}return n}function Bne(){return{}}function zne(t,e){const n={},r=b(e,["totalTokens"]);r!=null&&S(n,["totalTokens"],r);const s=b(e,["cachedContentTokenCount"]);return s!=null&&S(n,["cachedContentTokenCount"],s),n}function Gne(t,e){const n={},r=b(e,["video","uri"]);r!=null&&S(n,["uri"],r);const s=b(e,["video","encodedVideo"]);s!=null&&S(n,["videoBytes"],Fc(t,s));const i=b(e,["encoding"]);return i!=null&&S(n,["mimeType"],i),n}function Wne(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],Gne(t,r)),n}function Hne(t,e){const n={},r=b(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Wne(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function qne(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response","generateVideoResponse"]);return l!=null&&S(n,["response"],Hne(t,l)),n}function Kne(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function Yne(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],Kne(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function Jne(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Yne(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function Xne(t,e){const n={},r=b(e,["citations"]);return r!=null&&S(n,["citations"],r),n}function Qne(t,e){const n={},r=b(e,["content"]);r!=null&&S(n,["content"],Jne(t,r));const s=b(e,["citationMetadata"]);s!=null&&S(n,["citationMetadata"],Xne(t,s));const i=b(e,["finishMessage"]);i!=null&&S(n,["finishMessage"],i);const o=b(e,["finishReason"]);o!=null&&S(n,["finishReason"],o);const l=b(e,["avgLogprobs"]);l!=null&&S(n,["avgLogprobs"],l);const c=b(e,["groundingMetadata"]);c!=null&&S(n,["groundingMetadata"],c);const u=b(e,["index"]);u!=null&&S(n,["index"],u);const d=b(e,["logprobsResult"]);d!=null&&S(n,["logprobsResult"],d);const h=b(e,["safetyRatings"]);return h!=null&&S(n,["safetyRatings"],h),n}function c2(t,e){const n={},r=b(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>Qne(t,d))),S(n,["candidates"],u)}const s=b(e,["createTime"]);s!=null&&S(n,["createTime"],s);const i=b(e,["responseId"]);i!=null&&S(n,["responseId"],i);const o=b(e,["modelVersion"]);o!=null&&S(n,["modelVersion"],o);const l=b(e,["promptFeedback"]);l!=null&&S(n,["promptFeedback"],l);const c=b(e,["usageMetadata"]);return c!=null&&S(n,["usageMetadata"],c),n}function Zne(t,e){const n={},r=b(e,["truncated"]);r!=null&&S(n,["truncated"],r);const s=b(e,["token_count"]);return s!=null&&S(n,["tokenCount"],s),n}function ere(t,e){const n={},r=b(e,["values"]);r!=null&&S(n,["values"],r);const s=b(e,["statistics"]);return s!=null&&S(n,["statistics"],Zne(t,s)),n}function tre(t,e){const n={},r=b(e,["billableCharacterCount"]);return r!=null&&S(n,["billableCharacterCount"],r),n}function nre(t,e){const n={},r=b(e,["predictions[]","embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>ere(t,o))),S(n,["embeddings"],i)}const s=b(e,["metadata"]);return s!=null&&S(n,["metadata"],tre(t,s)),n}function rre(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["gcsUri"],r);const s=b(e,["bytesBase64Encoded"]);s!=null&&S(n,["imageBytes"],Fc(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function s3(t,e){const n={},r=b(e,["safetyAttributes","categories"]);r!=null&&S(n,["categories"],r);const s=b(e,["safetyAttributes","scores"]);s!=null&&S(n,["scores"],s);const i=b(e,["contentType"]);return i!=null&&S(n,["contentType"],i),n}function wI(t,e){const n={},r=b(e,["_self"]);r!=null&&S(n,["image"],rre(t,r));const s=b(e,["raiFilteredReason"]);s!=null&&S(n,["raiFilteredReason"],s);const i=b(e,["_self"]);i!=null&&S(n,["safetyAttributes"],s3(t,i));const o=b(e,["prompt"]);return o!=null&&S(n,["enhancedPrompt"],o),n}function sre(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>wI(t,o))),S(n,["generatedImages"],i)}const s=b(e,["positivePromptSafetyAttributes"]);return s!=null&&S(n,["positivePromptSafetyAttributes"],s3(t,s)),n}function ire(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>wI(t,i))),S(n,["generatedImages"],s)}return n}function ore(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>wI(t,i))),S(n,["generatedImages"],s)}return n}function are(t,e){const n={},r=b(e,["endpoint"]);r!=null&&S(n,["name"],r);const s=b(e,["deployedModelId"]);return s!=null&&S(n,["deployedModelId"],s),n}function lre(t,e){const n={},r=b(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["createTime"]);s!=null&&S(n,["createTime"],s);const i=b(e,["updateTime"]);return i!=null&&S(n,["updateTime"],i),n}function cre(t,e){const n={},r=b(e,["checkpointId"]);r!=null&&S(n,["checkpointId"],r);const s=b(e,["epoch"]);s!=null&&S(n,["epoch"],s);const i=b(e,["step"]);return i!=null&&S(n,["step"],i),n}function bE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);i!=null&&S(n,["description"],i);const o=b(e,["versionId"]);o!=null&&S(n,["version"],o);const l=b(e,["deployedModels"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(m=>are(t,m))),S(n,["endpoints"],f)}const c=b(e,["labels"]);c!=null&&S(n,["labels"],c);const u=b(e,["_self"]);u!=null&&S(n,["tunedModelInfo"],lre(t,u));const d=b(e,["defaultCheckpointId"]);d!=null&&S(n,["defaultCheckpointId"],d);const h=b(e,["checkpoints"]);if(h!=null){let f=h;Array.isArray(f)&&(f=f.map(m=>cre(t,m))),S(n,["checkpoints"],f)}return n}function ure(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["_self"]);if(s!=null){let i=e3(t,s);Array.isArray(i)&&(i=i.map(o=>bE(t,o))),S(n,["models"],i)}return n}function dre(){return{}}function hre(t,e){const n={},r=b(e,["totalTokens"]);return r!=null&&S(n,["totalTokens"],r),n}function fre(t,e){const n={},r=b(e,["tokensInfo"]);return r!=null&&S(n,["tokensInfo"],r),n}function mre(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["uri"],r);const s=b(e,["bytesBase64Encoded"]);s!=null&&S(n,["videoBytes"],Fc(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function pre(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],mre(t,r)),n}function gre(t,e){const n={},r=b(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>pre(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function yre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response"]);return l!=null&&S(n,["response"],gre(t,l)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xre="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function vre(t,e,n){const r=new FZ;let s;if(n.data instanceof Blob?s=JSON.parse(await n.data.text()):s=JSON.parse(n.data),t.isVertexAI()){const i=cte(t,s);Object.assign(r,i)}else{const i=lte(t,s);Object.assign(r,i)}e(r)}class wre{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r,s,i;const o=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion();let c;const u=Cre(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())c=`${o}/ws/google.cloud.aiplatform.${l}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const T=this.apiClient.getApiKey();c=`${o}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateContent?key=${T}`}let d=()=>{};const h=new Promise(T=>{d=T}),f=e.callbacks,m=function(){var T;(T=f==null?void 0:f.onopen)===null||T===void 0||T.call(f),d({})},g=this.apiClient,x={onopen:m,onmessage:T=>{vre(g,f.onmessage,T)},onerror:(n=f==null?void 0:f.onerror)!==null&&n!==void 0?n:function(T){},onclose:(r=f==null?void 0:f.onclose)!==null&&r!==void 0?r:function(T){}},w=this.webSocketFactory.create(c,Sre(u),x);w.connect(),await h;let v=dr(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&v.startsWith("publishers/")){const T=this.apiClient.getProject(),R=this.apiClient.getLocation();v=`projects/${T}/locations/${R}/`+v}let _={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[bn.AUDIO]}:e.config.responseModalities=[bn.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const C={model:v,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?_=jee(this.apiClient,C):_=Ree(this.apiClient,C),delete _.config,w.send(JSON.stringify(_)),new _re(w,this.apiClient)}}const bre={turnComplete:!0};class _re{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Mc(e,n.turns),e.isVertexAI()?r=r.map(s=>Ef(e,s)):r=r.map(s=>R0(e,s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(xre)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},bre),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:Vee(this.apiClient,e)}:n={realtimeInput:Oee(this.apiClient,e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function Sre(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function Cre(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Ere=class extends _g{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>await this.generateContentInternal(n),this.generateContentStream=async n=>await this.generateContentStreamInternal(n),this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var s;let i;const o=[];if(r!=null&&r.generatedImages)for(const c of r.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((s=c==null?void 0:c.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?i=c==null?void 0:c.safetyAttributes:o.push(c);let l;return i?l={generatedImages:o,positivePromptSafetyAttributes:i}:l={generatedImages:o},l}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new k0(Yh.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const s={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(s)}}async generateContentInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=a2(this.apiClient,e);return l=qt("{model}:generateContent",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=c2(this.apiClient,d),f=new Vy;return Object.assign(f,h),f})}else{const u=o2(this.apiClient,e);return l=qt("{model}:generateContent",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=l2(this.apiClient,d),f=new Vy;return Object.assign(f,h),f})}}async generateContentStreamInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=a2(this.apiClient,e);l=qt("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const d=this.apiClient;return o=d.requestStream({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(h){return Jv(this,arguments,function*(){var f,m,g,x;try{for(var w=!0,v=xE(h),_;_=yield As(v.next()),f=_.done,!f;w=!0){x=_.value,w=!1;const T=c2(d,yield As(x.json())),R=new Vy;Object.assign(R,T),yield yield As(R)}}catch(C){m={error:C}}finally{try{!w&&!f&&(g=v.return)&&(yield As(g.call(v)))}finally{if(m)throw m.error}}})})}else{const u=o2(this.apiClient,e);l=qt("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const d=this.apiClient;return o=d.requestStream({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(h){return Jv(this,arguments,function*(){var f,m,g,x;try{for(var w=!0,v=xE(h),_;_=yield As(v.next()),f=_.done,!f;w=!0){x=_.value,w=!1;const T=l2(d,yield As(x.json())),R=new Vy;Object.assign(R,T),yield yield As(R)}}catch(C){m={error:C}}finally{try{!w&&!f&&(g=v.return)&&(yield As(g.call(v)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=one(this.apiClient,e);return l=qt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=nre(this.apiClient,d),f=new qj;return Object.assign(f,h),f})}else{const u=Ete(this.apiClient,e);return l=qt("{model}:batchEmbedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Lne(this.apiClient,d),f=new qj;return Object.assign(f,h),f})}}async generateImagesInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=lne(this.apiClient,e);return l=qt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=sre(this.apiClient,d),f=new Kj;return Object.assign(f,h),f})}else{const u=Ite(this.apiClient,e);return l=qt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Vne(this.apiClient,d),f=new Kj;return Object.assign(f,h),f})}}async editImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=pne(this.apiClient,e);return i=qt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=ire(this.apiClient,c),d=new kZ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=yne(this.apiClient,e);return i=qt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=ore(this.apiClient,c),d=new RZ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=xne(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>bE(this.apiClient,d))}else{const u=Nte(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>wE(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=wne(this.apiClient,e);return l=qt("{models_url}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=ure(this.apiClient,d),f=new Yj;return Object.assign(f,h),f})}else{const u=Ate(this.apiClient,e);return l=qt("{models_url}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Une(this.apiClient,d),f=new Yj;return Object.assign(f,h),f})}}async update(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=_ne(this.apiClient,e);return l=qt("{model}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>bE(this.apiClient,d))}else{const u=Rte(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>wE(this.apiClient,d))}}async delete(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Sne(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(()=>{const d=dre(),h=new Jj;return Object.assign(h,d),h})}else{const u=jte(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=Bne(),h=new Jj;return Object.assign(h,d),h})}}async countTokens(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Ene(this.apiClient,e);return l=qt("{model}:countTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=hre(this.apiClient,d),f=new Xj;return Object.assign(f,h),f})}else{const u=Mte(this.apiClient,e);return l=qt("{model}:countTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=zne(this.apiClient,d),f=new Xj;return Object.assign(f,h),f})}}async computeTokens(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Tne(this.apiClient,e);return i=qt("{model}:computeTokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=fre(this.apiClient,c),d=new jZ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Nne(this.apiClient,e);return l=qt("{model}:predictLongRunning",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>yre(this.apiClient,d))}else{const u=Ote(this.apiClient,e);return l=qt("{model}:predictLongRunning",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>qne(this.apiClient,d))}}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Tre(t,e){const n={},r=b(e,["operationName"]);r!=null&&S(n,["_url","operationName"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Ire(t,e){const n={},r=b(e,["operationName"]);r!=null&&S(n,["_url","operationName"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Nre(t,e){const n={},r=b(e,["operationName"]);r!=null&&S(n,["operationName"],r);const s=b(e,["resourceName"]);s!=null&&S(n,["_url","resourceName"],s);const i=b(e,["config"]);return i!=null&&S(n,["config"],i),n}function Pre(t,e){const n={},r=b(e,["video","uri"]);r!=null&&S(n,["uri"],r);const s=b(e,["video","encodedVideo"]);s!=null&&S(n,["videoBytes"],Fc(t,s));const i=b(e,["encoding"]);return i!=null&&S(n,["mimeType"],i),n}function Are(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],Pre(t,r)),n}function kre(t,e){const n={},r=b(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Are(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function Rre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response","generateVideoResponse"]);return l!=null&&S(n,["response"],kre(t,l)),n}function jre(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["uri"],r);const s=b(e,["bytesBase64Encoded"]);s!=null&&S(n,["videoBytes"],Fc(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function Dre(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],jre(t,r)),n}function Mre(t,e){const n={},r=b(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Dre(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function u2(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response"]);return l!=null&&S(n,["response"],Mre(t,l)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Lre extends _g{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let i;return r&&"httpOptions"in r&&(i=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Ire(this.apiClient,e);return l=qt("{operationName}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>u2(this.apiClient,d))}else{const u=Tre(this.apiClient,e);return l=qt("{operationName}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Rre(this.apiClient,d))}}async fetchPredictVideosOperationInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Nre(this.apiClient,e);return i=qt("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>u2(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Fre="Content-Type",Ore="X-Server-Timeout",Vre="User-Agent",$re="x-goog-api-client",Ure="0.14.1",Bre=`google-genai-sdk/${Ure}`,zre="v1beta1",Gre="v1beta",d2=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class i3 extends Error{constructor(e,n){n?super(e,{cause:n}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class _E extends Error{constructor(e,n){n?super(e,{cause:n}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class Wre{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:zre,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:Gre,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const s=[this.getRequestUrlInternal(n)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))s.searchParams.append(o,String(l));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.unaryApiCall(s,i,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[s,i]of Object.entries(n))typeof i=="object"?r[s]=Object.assign(Object.assign({},r[s]),i):i!==void 0&&(r[s]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.streamApiCall(s,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const s=new AbortController,i=s.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>s.abort(),n.timeout),r&&r.addEventListener("abort",()=>{s.abort()}),e.signal=i}return e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await h2(s),new yE(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await h2(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var n;return Jv(this,arguments,function*(){const s=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),i=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:c}=yield As(s.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=i.decode(c);try{const h=JSON.parse(u);if("error"in h){const f=JSON.parse(JSON.stringify(h.error)),m=f.status,g=f.code,x=`got status: ${m}. ${JSON.stringify(h)}`;if(g>=400&&g<500)throw new i3(x);if(g>=500&&g<600)throw new _E(x)}}catch(h){const f=h;if(f.name==="ClientError"||f.name==="ServerError")throw h}o+=u;let d=o.match(d2);for(;d;){const h=d[1];try{const f=new Response(h,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield As(new yE(f)),o=o.slice(d[0].length),d=o.match(d2)}catch(f){throw new Error(`exception parsing stream chunk ${h}. ${f}`)}}}}finally{s.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=Bre+" "+this.clientOptions.userAgentExtra;return e[Vre]=n,e[$re]=n,e[Fre]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,s]of Object.entries(e.headers))n.append(r,s);e.timeout&&e.timeout>0&&n.append(Ore,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const i=this.clientOptions.uploader,o=await i.stat(e);s.sizeBytes=String(o.size);const l=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;const c=await this.fetchUploadUrl(s,n);return i.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let s={};n!=null&&n.httpOptions?s=n.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const i={file:e},o=await this.request({path:qt("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:s});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function h2(t){var e;if(t===void 0)throw new _E("response is undefined");if(!t.ok){const n=t.status,r=t.statusText;let s;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await t.json():s={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=`got status: ${n} ${r}. ${JSON.stringify(s)}`;throw n>=400&&n<500?new i3(i):n>=500&&n<600?new _E(i):new Error(i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Hre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function qre(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);return n!==void 0&&o!=null&&S(n,["_query","filter"],o),r}function Kre(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],qre(t,r,n)),n}function Yre(t,e){const n={},r=b(e,["textInput"]);r!=null&&S(n,["textInput"],r);const s=b(e,["output"]);return s!=null&&S(n,["output"],s),n}function Jre(t,e){const n={};if(b(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=b(e,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>Yre(t,i))),S(n,["examples","examples"],s)}return n}function Xre(t,e,n){const r={};if(b(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=b(e,["tunedModelDisplayName"]);if(n!==void 0&&s!=null&&S(n,["displayName"],s),b(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=b(e,["epochCount"]);n!==void 0&&i!=null&&S(n,["tuningTask","hyperparameters","epochCount"],i);const o=b(e,["learningRateMultiplier"]);if(o!=null&&S(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),b(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(b(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=b(e,["batchSize"]);n!==void 0&&l!=null&&S(n,["tuningTask","hyperparameters","batchSize"],l);const c=b(e,["learningRate"]);return n!==void 0&&c!=null&&S(n,["tuningTask","hyperparameters","learningRate"],c),r}function Qre(t,e){const n={},r=b(e,["baseModel"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["trainingDataset"]);s!=null&&S(n,["tuningTask","trainingData"],Jre(t,s));const i=b(e,["config"]);return i!=null&&S(n,["config"],Xre(t,i,n)),n}function Zre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function ese(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);return n!==void 0&&o!=null&&S(n,["_query","filter"],o),r}function tse(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],ese(t,r,n)),n}function nse(t,e,n){const r={},s=b(e,["gcsUri"]);if(n!==void 0&&s!=null&&S(n,["supervisedTuningSpec","trainingDatasetUri"],s),b(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function rse(t,e){const n={},r=b(e,["gcsUri"]);return r!=null&&S(n,["validationDatasetUri"],r),n}function sse(t,e,n){const r={},s=b(e,["validationDataset"]);n!==void 0&&s!=null&&S(n,["supervisedTuningSpec"],rse(t,s));const i=b(e,["tunedModelDisplayName"]);n!==void 0&&i!=null&&S(n,["tunedModelDisplayName"],i);const o=b(e,["description"]);n!==void 0&&o!=null&&S(n,["description"],o);const l=b(e,["epochCount"]);n!==void 0&&l!=null&&S(n,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=b(e,["learningRateMultiplier"]);n!==void 0&&c!=null&&S(n,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const u=b(e,["exportLastCheckpointOnly"]);n!==void 0&&u!=null&&S(n,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const d=b(e,["adapterSize"]);if(n!==void 0&&d!=null&&S(n,["supervisedTuningSpec","hyperParameters","adapterSize"],d),b(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(b(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function ise(t,e){const n={},r=b(e,["baseModel"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["trainingDataset"]);s!=null&&S(n,["supervisedTuningSpec","trainingDatasetUri"],nse(t,s,n));const i=b(e,["config"]);return i!=null&&S(n,["config"],sse(t,i,n)),n}function ose(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["model"],r);const s=b(e,["name"]);return s!=null&&S(n,["endpoint"],s),n}function o3(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["state"]);s!=null&&S(n,["state"],X$(t,s));const i=b(e,["createTime"]);i!=null&&S(n,["createTime"],i);const o=b(e,["tuningTask","startTime"]);o!=null&&S(n,["startTime"],o);const l=b(e,["tuningTask","completeTime"]);l!=null&&S(n,["endTime"],l);const c=b(e,["updateTime"]);c!=null&&S(n,["updateTime"],c);const u=b(e,["description"]);u!=null&&S(n,["description"],u);const d=b(e,["baseModel"]);d!=null&&S(n,["baseModel"],d);const h=b(e,["_self"]);h!=null&&S(n,["tunedModel"],ose(t,h));const f=b(e,["distillationSpec"]);f!=null&&S(n,["distillationSpec"],f);const m=b(e,["experiment"]);m!=null&&S(n,["experiment"],m);const g=b(e,["labels"]);g!=null&&S(n,["labels"],g);const x=b(e,["pipelineJob"]);x!=null&&S(n,["pipelineJob"],x);const w=b(e,["tunedModelDisplayName"]);return w!=null&&S(n,["tunedModelDisplayName"],w),n}function ase(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["tunedModels"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>o3(t,o))),S(n,["tuningJobs"],i)}return n}function lse(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);return o!=null&&S(n,["error"],o),n}function cse(t,e){const n={},r=b(e,["checkpointId"]);r!=null&&S(n,["checkpointId"],r);const s=b(e,["epoch"]);s!=null&&S(n,["epoch"],s);const i=b(e,["step"]);i!=null&&S(n,["step"],i);const o=b(e,["endpoint"]);return o!=null&&S(n,["endpoint"],o),n}function use(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["model"],r);const s=b(e,["endpoint"]);s!=null&&S(n,["endpoint"],s);const i=b(e,["checkpoints"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>cse(t,l))),S(n,["checkpoints"],o)}return n}function SE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["state"]);s!=null&&S(n,["state"],X$(t,s));const i=b(e,["createTime"]);i!=null&&S(n,["createTime"],i);const o=b(e,["startTime"]);o!=null&&S(n,["startTime"],o);const l=b(e,["endTime"]);l!=null&&S(n,["endTime"],l);const c=b(e,["updateTime"]);c!=null&&S(n,["updateTime"],c);const u=b(e,["error"]);u!=null&&S(n,["error"],u);const d=b(e,["description"]);d!=null&&S(n,["description"],d);const h=b(e,["baseModel"]);h!=null&&S(n,["baseModel"],h);const f=b(e,["tunedModel"]);f!=null&&S(n,["tunedModel"],use(t,f));const m=b(e,["supervisedTuningSpec"]);m!=null&&S(n,["supervisedTuningSpec"],m);const g=b(e,["tuningDataStats"]);g!=null&&S(n,["tuningDataStats"],g);const x=b(e,["encryptionSpec"]);x!=null&&S(n,["encryptionSpec"],x);const w=b(e,["partnerModelTuningSpec"]);w!=null&&S(n,["partnerModelTuningSpec"],w);const v=b(e,["distillationSpec"]);v!=null&&S(n,["distillationSpec"],v);const _=b(e,["experiment"]);_!=null&&S(n,["experiment"],_);const C=b(e,["labels"]);C!=null&&S(n,["labels"],C);const T=b(e,["pipelineJob"]);T!=null&&S(n,["pipelineJob"],T);const R=b(e,["tunedModelDisplayName"]);return R!=null&&S(n,["tunedModelDisplayName"],R),n}function dse(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["tuningJobs"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>SE(t,o))),S(n,["tuningJobs"],i)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hse extends _g{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new k0(Yh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let s="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?s=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(s=r.name.split("/operations/")[0]),{name:s,state:gE.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Zre(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>SE(this.apiClient,d))}else{const u=Hre(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>o3(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=tse(this.apiClient,e);return l=qt("tuningJobs",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=dse(this.apiClient,d),f=new Qj;return Object.assign(f,h),f})}else{const u=Kre(this.apiClient,e);return l=qt("tunedModels",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=ase(this.apiClient,d),f=new Qj;return Object.assign(f,h),f})}}async tuneInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=ise(this.apiClient,e);return i=qt("tuningJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>SE(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=Qre(this.apiClient,e);return i=qt("tunedModels",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>lse(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fse{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const mse=1024*1024*8,pse=3,gse=1e3,yse=2,H_="x-goog-upload-status";async function xse(t,e,n){var r,s,i;let o=0,l=0,c=new yE(new Response),u="upload";for(o=t.size;l<o;){const h=Math.min(mse,o-l),f=t.slice(l,l+h);l+h>=o&&(u+=", finalize");let m=0,g=gse;for(;m<pse&&(c=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(l),"Content-Length":String(h)}}}),!(!((r=c==null?void 0:c.headers)===null||r===void 0)&&r[H_]));)m++,await wse(g),g=g*yse;if(l+=h,((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s[H_])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const d=await(c==null?void 0:c.json());if(((i=c==null?void 0:c.headers)===null||i===void 0?void 0:i[H_])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return d.file}async function vse(t){return{size:t.size,type:t.type}}function wse(t){return new Promise(e=>setTimeout(e,t))}class bse{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await xse(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await vse(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _se{create(e,n,r){return new Sse(e,n,r)}}class Sse{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const f2="x-goog-api-key";class Cse{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(f2)===null&&e.append(f2,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ese="gl-node/";class En{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=MQ(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const s=new Cse(this.apiKey);this.apiClient=new Wre({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:Ese+"web",uploader:new bse,downloader:new fse}),this.models=new Ere(this.apiClient),this.live=new wre(this.apiClient,s,new _se),this.chats=new BZ(this.models,this.apiClient),this.caches=new OZ(this.apiClient),this.files=new tee(this.apiClient),this.operations=new Lre(this.apiClient),this.tunings=new hse(this.apiClient)}}const Yo="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s";async function bI(t){const e=new En({apiKey:Yo}),n={type:Ke.ARRAY,items:{type:Ke.STRING},description:"An array of 3 creative and catchy store name suggestions."};try{const r=`Suggest 3 creative and catchy store name options based on the following store name: "${t}". The suggestions should be relevant and similar. Return exactly 3 suggestions.`,s=await e.models.generateContent({model:"gemini-2.5-flash-lite-preview-06-17",contents:[{role:"user",parts:[{text:r}]}],config:{responseMimeType:"application/json",responseSchema:n}}),i=s.text;if(typeof i!="string"||i.trim()==="")throw console.error("Model did not return a text response for store name suggestions. Response:",JSON.stringify(s)),new Error("Model response for store name suggestions was empty or not a string.");try{const o=JSON.parse(i);return Array.isArray(o)&&o.every(l=>typeof l=="string")?{suggestions:o.slice(0,3).map(l=>l.trim()).filter(l=>l.length>0)}:(console.error("Parsed store name suggestions are not an array of strings:",o),{error:"AI response was not in the expected format (array of strings).",rawResponse:i})}catch(o){return console.error("Failed to parse JSON response for store names:",i,"ParseError:",o),{error:"Failed to parse store name suggestions from AI.",rawResponse:i}}}catch(r){return console.error("Error generating store name suggestions:",r),{error:`Error generating suggestions: ${r.message}`}}}async function a3(t){const e=new En({apiKey:Yo}),n={type:Ke.OBJECT,properties:{heroTitle:{type:Ke.STRING,description:"The catchy hero title for the store."},heroDescription:{type:Ke.STRING,description:"A short (1-2 sentences) engaging hero description."}},required:["heroTitle","heroDescription"]},{name:r,niche:s,description:i,targetAudience:o,style:l}=t;let c=`Generate a compelling hero title and a short, engaging hero description for an online store.
Store Name: ${r||"N/A"}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of products."}
Target Audience: ${o||"General consumers"}
Style/Vibe: ${l||"Modern and friendly"}

Return the hero title and description as a JSON object matching the schema.`;try{const u=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:c}]}],config:{responseMimeType:"application/json",responseSchema:n}}),d=u.text;if(typeof d!="string"||d.trim()==="")throw console.error("Model did not return a text response for hero content. Response:",JSON.stringify(u)),new Error("Model response for hero content was empty or not a string.");try{const h=JSON.parse(d);return h&&typeof h.heroTitle=="string"&&typeof h.heroDescription=="string"?{heroTitle:h.heroTitle,heroDescription:h.heroDescription}:(console.error("Parsed hero content is not in the expected format:",h),{error:"AI response was not in the expected format for hero content.",rawResponse:d})}catch(h){return console.error("Failed to parse JSON response for hero content:",d,"ParseError:",h),{error:"Failed to parse hero content from AI.",rawResponse:d}}}catch(u){return console.error("Error generating hero content:",u),{error:`Error generating hero content: ${u.message}`}}}async function Tse(t){if(!t||!t.name)return console.error("Product information (at least name) is required for image prompt suggestions."),{error:"Product information required."};const e=new En({apiKey:Yo}),{name:n,description:r,niche:s,storeName:i}=t,o={type:Ke.ARRAY,items:{type:Ke.STRING},description:"An array of 6 diverse and creative text prompts for AI image generation related to a product."};let l=`product named "${n}"`;r&&(l+=` with description "${r}"`),i&&(l+=` from a store called "${i}"`),s&&(l+=` in the "${s}" niche`);const c=`Based on a ${l}, generate 6 diverse and creative text prompts suitable for AI image generation. These prompts should aim to create visually appealing images for marketing this product. Examples: "A dynamic shot of [product name] on a clean, modern background with soft lighting", "Lifestyle image of [product name] being used by a happy customer in a [relevant setting]", "Close-up detail of [product name]'s unique feature with artistic blur". Return exactly 6 prompt suggestions.`;try{const u=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:c}]}],config:{responseMimeType:"application/json",responseSchema:o}}),d=u.text;if(typeof d!="string"||d.trim()==="")throw console.error("Model did not return a text response for image prompt suggestions. Response:",JSON.stringify(u)),new Error("Model response for image prompt suggestions was empty or not a string.");try{const h=JSON.parse(d);return Array.isArray(h)&&h.every(f=>typeof f=="string")?{suggestions:h.slice(0,6).map(f=>f.trim()).filter(f=>f.length>0)}:(console.error("Parsed image prompt suggestions are not an array of strings:",h),{error:"AI response was not in the expected format for image prompts (array of strings).",rawResponse:d})}catch(h){return console.error("Failed to parse JSON response for image prompt suggestions:",d,"ParseError:",h),{error:"Failed to parse image prompt suggestions from AI.",rawResponse:d}}}catch(u){return console.error("Error generating image prompt suggestions:",u),{error:`Error generating image prompt suggestions: ${u.message}`}}}async function Ise(t){const e=new En({apiKey:Yo}),n={name:"extract_store_name",description:`Extracts the desired store name if explicitly mentioned in the prompt using phrases like "store called 'My Store'", "named 'My Store'", or "store 'My Store'". The name should be the direct object of such phrases.`,parameters:{type:Ke.OBJECT,properties:{storeName:{type:Ke.STRING,description:"The explicitly mentioned name of the store."}},required:["storeName"]}};try{const i=(await e.getGenerativeModel({model:"gemini-pro"}).generateContent({contents:[{role:"user",parts:[{text:t}]}],tools:[{functionDeclarations:[n]}]})).response.functionCalls();return i&&i.length>0&&i[0].name==="extract_store_name"&&i[0].args&&i[0].args.storeName?(console.log(`[extractExplicitStoreName] Gemini identified store name: ${i[0].args.storeName}`),i[0].args.storeName):(console.log("[extractExplicitStoreName] Gemini did not identify an explicit store name via function call."),null)}catch(r){return console.error("Error during Gemini store name extraction:",r),null}}async function l3(t){const e=new En({apiKey:Yo}),n={type:Ke.OBJECT,properties:{title:{type:Ke.STRING,description:"The main title for 'The [StoreName] Way' section (e.g., 'The AwesomeStore Way')."},subtitle:{type:Ke.STRING,description:"A short, engaging subtitle for this section (1-2 sentences)."},items:{type:Ke.ARRAY,description:"An array of 3 to 4 items representing the store's core values or unique selling points.",items:{type:Ke.OBJECT,properties:{emoji:{type:Ke.STRING,description:"A single relevant emoji for the item (e.g., '✨', '🌿')."},title:{type:Ke.STRING,description:"A short title for the item (2-4 words)."},description:{type:Ke.STRING,description:"A brief description of the item (10-20 words)."}},required:["emoji","title","description"]},minItems:3,maxItems:4}},required:["title","subtitle","items"]},{name:r,niche:s,description:i,targetAudience:o,style:l}=t,c=r||"Our Store";let u=`Generate content for "The ${c} Way" section of an online store. This section highlights the store's core values and what makes it unique.
Store Name: ${c}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of quality products."}
Target Audience: ${o||"General consumers"}
Style/Vibe: ${l||"Modern and customer-focused"}

The content should include:
1.  A main title (e.g., "The ${c} Way"). This title should dynamically incorporate the actual store name.
2.  A short subtitle (1-2 sentences) that is specific and engaging for this store.
3.  3 to 4 items, each with:
    *   A unique and highly relevant emoji that visually represents the item's theme and is specific to this store's niche/style/keywords. This emoji is mandatory and must not be a generic placeholder. For example, if the store sells coffee, an emoji like ☕ or 🌿 (for organic beans) would be appropriate. If it's a tech store, 💡 or 🚀.
    *   A short, catchy title for the item (2-4 words, e.g., "Artisanal Roasts", "Cutting-Edge Tech"). This title must be specific to the store's theme.
    *   A brief description (10-20 words) elaborating on the item's title, specific to the store's values and offerings.

Return this content as a JSON object matching the schema. Ensure all text content and emojis are distinct, creative, and directly reflect the store's unique characteristics and offerings. Do not use generic examples in the output.`;try{const d=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:u}]}],config:{responseMimeType:"application/json",responseSchema:n}}),h=d.text;if(typeof h!="string"||h.trim()==="")throw console.error("Model did not return a text response for store way content. Response:",JSON.stringify(d)),new Error("Model response for store way content was empty or not a string.");try{const f=JSON.parse(h);return f&&typeof f.title=="string"&&typeof f.subtitle=="string"&&Array.isArray(f.items)&&f.items.length>=3&&f.items.length<=4&&f.items.every(m=>typeof m.emoji=="string"&&m.emoji.length>0&&typeof m.title=="string"&&typeof m.description=="string")?(f.title=`The ${c} Way`,f):(console.error("Parsed store way content is not in the expected format:",f),{error:"AI response was not in the expected format for store way content.",rawResponse:h})}catch(f){return console.error("Failed to parse JSON response for store way content:",h,"ParseError:",f),{error:"Failed to parse store way content from AI.",rawResponse:h}}}catch(d){return console.error("Error generating store way content:",d),{error:`Error generating store way content: ${d.message}`}}}async function _I(t){const e=[{iconName:"Truck",title:"Fast Shipping",description:"Get your orders delivered quickly and reliably."},{iconName:"ShieldCheck",title:"Secure Payments",description:"Shop with confidence using our secure payment gateways."},{iconName:"MessageSquare",title:"24/7 Support",description:"Our dedicated team is here to help you around the clock."},{iconName:"Repeat",title:"Easy Returns",description:"Hassle-free return and exchange policy if you're not satisfied."},{iconName:"Award",title:"Quality Guaranteed",description:"We stand by the quality of our products."},{iconName:"Gift",title:"Gift Options",description:"Special gift wrapping and messaging available."}],n=[{iconName:"Users",number:"10K+",label:"Active Users"},{iconName:"Star",number:"4.8",label:"Avg. Rating"},{iconName:"PackageCheck",number:"20K+",label:"Orders Shipped"},{iconName:"ShieldCheck",number:"100%",label:"Secure Checkout"},{iconName:"ThumbsUp",number:"95%",label:"Positive Feedback"},{iconName:"Globe",number:"Worldwide",label:"Shipping"}],r=new En({apiKey:Yo}),s={type:Ke.OBJECT,properties:{title:{type:Ke.STRING,description:"Main title for the features/experience section (e.g., 'An Exceptional Experience')."},subtitle:{type:Ke.STRING,description:"Engaging subtitle for the features section (1-2 sentences)."},items:{type:Ke.ARRAY,description:"An array of 3 to 4 feature items highlighting key store benefits.",items:{type:Ke.OBJECT,properties:{emoji:{type:Ke.STRING,description:"A single relevant emoji for the feature (e.g., '🛡️', '🌍', '💎')."},title:{type:Ke.STRING,description:"Short title for the feature (2-4 words, e.g., 'Secure Payments', 'Global Reach')."},description:{type:Ke.STRING,description:"Brief description of the feature (10-20 words)."}},required:["emoji","title","description"]},minItems:3,maxItems:4},secondaryItems:{type:Ke.ARRAY,description:"An array of up to 4 secondary feature items highlighting broader store benefits or values. The function will ensure 4 items are present by adding defaults if needed.",items:{type:Ke.OBJECT,properties:{iconName:{type:Ke.STRING,description:"Name of a Lucide icon (e.g., 'GlobeIcon', 'AwardIcon', 'UsersIcon', 'HeartIcon') for the secondary feature."},title:{type:Ke.STRING,description:"Short title for the secondary feature (2-4 words, e.g., 'Global Shipping', 'Quality Assured')."},description:{type:Ke.STRING,description:"Brief description of the secondary feature (10-15 words)."}},required:["iconName","title","description"]},minItems:0,maxItems:4},statsItems:{type:Ke.ARRAY,description:"An array of exactly 4 stat items highlighting key metrics or achievements.",items:{type:Ke.OBJECT,properties:{iconName:{type:Ke.STRING,description:"Name of a Lucide icon for the stat (e.g., 'UsersIcon', 'StarIcon', 'ZapIcon')."},number:{type:Ke.STRING,description:"The statistic value (e.g., '50K+', '99.9%', '4.9')."},label:{type:Ke.STRING,description:"The label for the statistic (e.g., 'Happy Customers', 'Uptime', 'Average Rating')."}},required:["iconName","number","label"]},minItems:4,maxItems:4}},required:["title","subtitle","items","secondaryItems","statsItems"]},{name:i,niche:o,description:l,targetAudience:c,style:u}=t,d=i||"Our Store";let h=`Generate content for a store features section, often titled "An Exceptional Experience" or similar, for an online store named "${d}".
This section should highlight key benefits and unique selling propositions.
Store Name: ${d}
Niche: ${o||"General E-commerce"}
Description/Keywords: ${l||"A variety of quality products."}
Target Audience: ${c||"General consumers"}
Style/Vibe: ${u||"Modern and customer-focused"}

The content should include:
1.  A main title for the section (e.g., "Why Choose Us?", "Our Commitment to You", "An Exceptional Experience").
2.  A short, engaging subtitle (1-2 sentences).
3.  3 to 4 feature items, each with:
    *   A unique and highly relevant emoji that visually represents the feature (e.g., ✨ for innovation,  for eco-friendly,  for smart tech). This emoji is mandatory and must be specific to the feature's theme.
    *   A short, catchy, and descriptive title for the feature (2-5 words, e.g., "Innovative Designs", "Sustainable Materials", "Smart Home Solutions"). This title will be used to search for a relevant background video, so make it evocative. The features should be specific to the store's niche and not generic e-commerce benefits like "Fast Shipping" or "Secure Payments" unless they are a core, unique part of the brand.
    *   A brief description (10-20 words) explaining the benefit of the feature.
4.  Up to 4 secondary feature items (the system will ensure 4 by adding defaults if fewer are provided by AI), each with:
    *   An \`iconName\` string representing a Lucide icon (e.g., "GlobeIcon", "AwardIcon", "UsersIcon", "HeartIcon"). Choose an icon name that best fits the feature. Examples: GlobeIcon, AwardIcon, UsersIcon, HeartIcon, PackageIcon, ShieldIcon, ZapIcon.
    *   A short title for the secondary feature (2-4 words, e.g., "Global Shipping", "Quality Assured", "Community Love", "Eco-Friendly Focus").
    *   A brief description (10-15 words) for the secondary feature. These should highlight broader store values or benefits.
5.  Exactly 4 stat items, each with:
    *   An \`iconName\` string for a Lucide icon (e.g., "UsersIcon", "StarIcon", "ZapIcon", "PackageIcon").
    *   A \`number\` or key metric (e.g., "50K+", "99.9%", "4.9", "1M+"). Avoid including symbols like ★ in the number string itself.
    *   A descriptive \`label\` (e.g., "Happy Customers", "Uptime Guarantee", "Average Rating", "Units Sold").

Return this content as a JSON object matching the schema. Ensure all text content, emojis, and iconNames are distinct, creative, and directly reflect positive attributes of a store like "${d}". Do not use generic examples in the output. Examples of main features could be related to payment security, shipping, product quality, customer service. Secondary features could be about global reach, quality assurance, community, sustainability etc. Stats should reflect plausible achievements or service levels for a store selling "${o||"various items"}".`;try{const f=await r.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:h}]}],config:{responseMimeType:"application/json",responseSchema:s}}),m=f.text;if(typeof m!="string"||m.trim()==="")throw console.error("Model did not return a text response for store features content. Response:",JSON.stringify(f)),new Error("Model response for store features content was empty or not a string.");try{const g=JSON.parse(m);if(g&&typeof g.title=="string"&&typeof g.subtitle=="string"&&Array.isArray(g.items)&&g.items.length>=3&&g.items.length<=4&&g.items.every(x=>typeof x.emoji=="string"&&x.emoji.length>0&&typeof x.title=="string"&&typeof x.description=="string")){let x=[];g.secondaryItems&&Array.isArray(g.secondaryItems)&&(x=g.secondaryItems.filter(C=>C&&typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.title=="string"&&C.title.length>0&&typeof C.description=="string"&&C.description.length>0).slice(0,4));const w=4-x.length;if(w>0){const C=new Set(x.map(R=>R.title)),T=e.filter(R=>!C.has(R.title)).slice(0,w);x.push(...T)}g.secondaryItems=x.slice(0,4);let v=[];g.statsItems&&Array.isArray(g.statsItems)&&(v=g.statsItems.filter(C=>C&&typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.number=="string"&&C.number.length>0&&typeof C.label=="string"&&C.label.length>0).slice(0,4));const _=4-v.length;if(_>0){const C=new Set(v.map(R=>R.label)),T=n.filter(R=>!C.has(R.label)).slice(0,_);v.push(...T)}return g.statsItems=v.slice(0,4),Array.isArray(g.secondaryItems)&&g.secondaryItems.every(C=>typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.title=="string"&&typeof C.description=="string")&&Array.isArray(g.statsItems)&&g.statsItems.length===4&&g.statsItems.every(C=>typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.number=="string"&&C.number.length>0&&typeof C.label=="string"&&C.label.length>0)?g:(console.error("Parsed store features content is not in the expected format after padding/validation:",g),(!g.statsItems||g.statsItems.length!==4)&&(console.warn("Stats items still not 4, forcing defaults for stats."),g.statsItems=n.slice(0,4)),(!g.secondaryItems||g.secondaryItems.length===0)&&(console.warn("Secondary items empty, forcing defaults for secondary."),g.secondaryItems=e.slice(0,Math.min(4,e.length))),g.title&&g.subtitle&&g.items?g:{error:"AI response format error after final processing.",rawResponse:m,processedContent:g})}else return console.error("Initial parsed store features content structure is invalid:",g),{error:"AI response (initial structure) was not in the expected format for store features content.",rawResponse:m}}catch(g){return console.error("Failed to parse JSON response for store features content:",m,"ParseError:",g),{error:"Failed to parse store features content from AI.",rawResponse:m}}}catch(f){return console.error("Error generating store features content:",f),{error:`Error generating store features content: ${f.message}`}}}async function c3(t){const e=new En({apiKey:Yo}),n={type:Ke.OBJECT,properties:{title:{type:Ke.STRING,description:"Catchy title for a section highlighting craftsmanship/quality (e.g., 'Our Commitment to Quality')."},subtitle:{type:Ke.STRING,description:"Engaging subtitle (1-2 sentences) related to the title."},text:{type:Ke.STRING,description:"Main descriptive text (2-3 sentences) about the store's dedication to quality, materials, or process."},listItems:{type:Ke.ARRAY,description:"An array of 3-4 short bullet points (3-5 words each) highlighting key aspects (e.g., 'Premium Materials', 'Expert Craftsmanship').",items:{type:Ke.STRING},minItems:3,maxItems:4},ctaText:{type:Ke.STRING,description:"Call to action button text (e.g., 'Explore Our Process', 'Learn More')."}},required:["title","subtitle","text","listItems","ctaText"]},{name:r,niche:s,description:i}=t,o=t.productExamples?`Key products include: ${t.productExamples}.`:"The store offers a range of specialized gear.",l=`Generate content for a website section for a store with a "sharp" and "tactical" aesthetic. This section has an image on the right and text on the left, emphasizing the store's precision, quality, craftsmanship, or unique process.
Store Name: "${r||"Our Store"}"
Niche/Type: "${s||"high-performance gear"}"
Store Description: "${i||"A store dedicated to excellence and precision."}"
${o}
Generate a title, subtitle, main text (2-3 sentences), 3-4 list items (3-5 words each), and a CTA button text.
The tone should be bold, confident, and precise, fitting a high-tech or tactical brand.
Focus on aspects like durability, advanced technology, expert design, or mission-readiness.
Return as a JSON object matching the schema.`;try{const u=(await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:l}]}],config:{responseMimeType:"application/json",responseSchema:n}})).text;if(!(u!=null&&u.trim()))throw new Error("Empty response from AI.");const d=JSON.parse(u);return d.title&&d.subtitle&&d.text&&Array.isArray(d.listItems)&&d.listItems.length>=3&&d.ctaText?d:(console.error("Invalid structure from AI for ImageRightSection:",d),{error:"AI response format error for ImageRightSection.",rawResponse:u})}catch(c){return console.error("Error generating ImageRightSection content:",c),{error:`Error generating ImageRightSection content: ${c.message}`}}}async function u3(t){const e=new En({apiKey:Yo}),n={type:Ke.OBJECT,properties:{title:{type:Ke.STRING,description:"Catchy title for a section showcasing a product or brand story via video (e.g., 'Experience the Difference')."},subtitle:{type:Ke.STRING,description:"Engaging subtitle (1-2 sentences) related to the video's theme."},text:{type:Ke.STRING,description:"Main descriptive text (2-3 sentences) complementing the video."},listItems:{type:Ke.ARRAY,description:"An array of 2-3 short bullet points (3-5 words each) highlighting key takeaways or features shown in a video.",items:{type:Ke.STRING},minItems:2,maxItems:3},ctaText:{type:Ke.STRING,description:"Call to action button text (e.g., 'Watch Now', 'See It In Action')."}},required:["title","subtitle","text","listItems","ctaText"]},{name:r,niche:s,description:i}=t,o=t.productExamples?`The video might showcase products like: ${t.productExamples}.`:"The video showcases our innovative products.",l=`Generate content for a website section for a store with a "sharp" and "tactical" aesthetic. This section has a video on the left and text on the right, aiming to engage users with a dynamic visual story or product demonstration.
Store Name: "${r||"Our Store"}"
Niche/Type: "${s||"cutting-edge solutions"}"
Store Description: "${i||"A store focused on performance and innovation."}"
${o}
Generate a title, subtitle, main text (2-3 sentences), 2-3 list items (3-5 words each highlighting video takeaways), and a CTA button text.
The tone should be energetic, impactful, and forward-thinking, suitable for a high-performance brand.
Focus on action, benefits, or the experience the video portrays.
Return as a JSON object matching the schema.`;try{const u=(await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:l}]}],config:{responseMimeType:"application/json",responseSchema:n}})).text;if(!(u!=null&&u.trim()))throw new Error("Empty response from AI.");const d=JSON.parse(u);return d.title&&d.subtitle&&d.text&&Array.isArray(d.listItems)&&d.listItems.length>=2&&d.ctaText?d:(console.error("Invalid structure from AI for VideoLeftSection:",d),{error:"AI response format error for VideoLeftSection.",rawResponse:u})}catch(c){return console.error("Error generating VideoLeftSection content:",c),{error:`Error generating VideoLeftSection content: ${c.message}`}}}async function Nse(t,e){const n=new En({apiKey:Yo}),r={type:Ke.OBJECT,properties:{description:{type:Ke.STRING,description:"A compelling and SEO-friendly product description."}},required:["description"]},{name:s,description:i}=t,{name:o,niche:l,targetAudience:c,style:u}=e;let d=`Generate a compelling, engaging, and SEO-friendly product description.
Store Name: ${o||"N/A"}
Store Niche: ${l||"General E-commerce"}
Store Style: ${u||"Modern and friendly"}
Target Audience: ${c||"General consumers"}

Product Name: "${s}"
${i?`Existing Description (for context, improve upon it): "${i}"`:""}

The new description should be persuasive, highlight key benefits, and be written in a tone that matches the store's style. It should be between 50 and 150 words.
Return the description as a JSON object matching the schema.`;try{const h=await n.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:d}]}],config:{responseMimeType:"application/json",responseSchema:r}}),f=h.text;if(typeof f!="string"||f.trim()==="")throw console.error("Model did not return a text response for product description. Response:",JSON.stringify(h)),new Error("Model response for product description was empty or not a string.");try{const m=JSON.parse(f);return m&&typeof m.description=="string"?{description:m.description}:(console.error("Parsed product description is not in the expected format:",m),{error:"AI response was not in the expected format for product description.",rawResponse:f})}catch(m){return console.error("Failed to parse JSON response for product description:",f,"ParseError:",m),{error:"Failed to parse product description from AI.",rawResponse:f}}}catch(h){return console.error("Error generating product description:",h),{error:`Error generating product description: ${h.message}`}}}async function d3(t){const e=new En({apiKey:Yo}),n={type:Ke.OBJECT,properties:{query:{type:Ke.STRING,description:"A concise and relevant search query for Pexels videos."}},required:["query"]},{name:r,niche:s,description:i}=t;let o=`Generate a concise and relevant search query for Pexels videos for an online store.
Store Name: ${r||"N/A"}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of products."}

The query should be 2-3 words and capture the essence of the store's brand and products.
Return the query as a JSON object matching the schema.`;try{const l=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:o}]}],config:{responseMimeType:"application/json",responseSchema:n}}),c=l.text;if(typeof c!="string"||c.trim()==="")throw console.error("Model did not return a text response for Pexels query. Response:",JSON.stringify(l)),new Error("Model response for Pexels query was empty or not a string.");try{const u=JSON.parse(c);return u&&typeof u.query=="string"?{query:u.query}:(console.error("Parsed Pexels query is not in the expected format:",u),{error:"AI response was not in the expected format for Pexels query.",rawResponse:c})}catch(u){return console.error("Failed to parse JSON response for Pexels query:",c,"ParseError:",u),{error:"Failed to parse Pexels query from AI.",rawResponse:c}}}catch(l){return console.error("Error generating Pexels video query:",l),{error:`Error generating Pexels video query: ${l.message}`}}}async function m2(t){const e=new En({apiKey:Yo}),n={type:Ke.OBJECT,properties:{primaryColor:{type:Ke.STRING,description:"The hex code for the primary color."},secondaryColor:{type:Ke.STRING,description:"The hex code for the secondary color."}},required:["primaryColor","secondaryColor"]},{name:r,niche:s,description:i}=t;let o=`Generate a primary and secondary color for a store's theme.
Store Name: ${r||"N/A"}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of products."}

The colors should be represented as hex codes.
Return the colors as a JSON object matching the schema.`;try{const l=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:o}]}],config:{responseMimeType:"application/json",responseSchema:n}}),c=l.text;if(typeof c!="string"||c.trim()==="")throw console.error("Model did not return a text response for theme colors. Response:",JSON.stringify(l)),new Error("Model response for theme colors was empty or not a string.");try{const u=JSON.parse(c);return u&&typeof u.primaryColor=="string"&&typeof u.secondaryColor=="string"?{primaryColor:u.primaryColor,secondaryColor:u.secondaryColor}:(console.error("Parsed theme colors are not in the expected format:",u),{error:"AI response was not in the expected format for theme colors.",rawResponse:c})}catch(u){return console.error("Failed to parse JSON response for theme colors:",c,"ParseError:",u),{error:"Failed to parse theme colors from AI.",rawResponse:c}}}catch(l){return console.error("Error generating theme colors:",l),{error:`Error generating theme colors: ${l.message}`}}}function Ct(...t){return TQ(V$(t))}function Dt(){return kQ()}const Pse="CEVWpXluVU77FgaVriTzqBCoN4FD3f0VL2Y8bXNPynNfqUg2DoUgPt8t";console.log("[utils.jsx] VITE_PEXELS_API_KEY loaded:","Exists");const h3=Pse,Ase="https://api.pexels.com/v1",kse="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s";console.log("[utils.jsx] VITE_GEMINI_API_KEY loaded:","Exists");const Rse=kse,jse="your-shop-name.myshopify.com",lo=async(t,e=1,n="landscape")=>{const r=`${Ase}/search?query=${encodeURIComponent(t)}&per_page=${e}&orientation=${n}`;try{const s=await fetch(r,{headers:{Authorization:h3}});if(!s.ok){const o=await s.json();throw console.error("Pexels API error:",o),new Error(`Pexels API request failed: ${s.statusText}`)}const i=await s.json();if(!i.photos||i.photos.length===0){console.warn(`No Pexels images found for query: "${t}". Attempting fallback.`);const o=(l,c,u)=>`https://via.placeholder.com/${l}x${c}.png?text=NoImage:${encodeURIComponent(u)}`;return Array(e).fill(null).map((l,c)=>({id:Dt(),src:{large:o(1200,800,`${t} ${c+1}`),medium:o(800,600,`${t} ${c+1}`),original:o(1920,1280,`${t} ${c+1}`),square:o(400,400,`${t} ${c+1}`),landscape:o(1200,800,`${t} ${c+1}`),portrait:o(800,1200,`${t} ${c+1}`),small:o(400,260,`${t} ${c+1}`),tiny:o(200,130,`${t} ${c+1}`)},photographer:"N/A",alt:`No image found for ${t} ${c+1}`}))}return i.photos.map(o=>({id:o.id,src:o.src,photographer:o.photographer,alt:o.alt||`Photo by ${o.photographer} of ${t}`}))}catch(s){console.error("Error fetching Pexels images:",s);const i=(o,l,c)=>`https://via.placeholder.com/${o}x${l}.png?text=${encodeURIComponent(c)}`;return Array(e).fill(null).map((o,l)=>({id:Dt(),src:{large:i(1200,800,`Error ${t} ${l+1}`),medium:i(800,600,`Error ${t} ${l+1}`),original:i(1920,1280,`Error ${t} ${l+1}`),square:i(400,400,`Error ${t} ${l+1}`),landscape:i(1200,800,`Error ${t} ${l+1}`),portrait:i(800,1200,`Error ${t} ${l+1}`),small:i(400,260,`Error ${t} ${l+1}`),tiny:i(200,130,`Error ${t} ${l+1}`)},photographer:"Placeholder Error",alt:`Placeholder Error for ${t} ${l+1}`}))}},Oa=async(t,e=1,n="landscape")=>{const r=`https://api.pexels.com/videos/search?query=${encodeURIComponent(t)}&per_page=${e}&orientation=${n}`;try{const s=await fetch(r,{headers:{Authorization:h3}});if(!s.ok){const o=await s.json();throw console.error("Pexels Videos API error:",o),new Error(`Pexels Videos API request failed: ${s.statusText}`)}const i=await s.json();return!i.videos||i.videos.length===0?(console.warn(`No Pexels videos found for query: "${t}".`),Array(e).fill(null).map((o,l)=>({id:Dt(),url:`https://videos.pexels.com/videos/no-video-${l+1}.mp4`,image:`https://via.placeholder.com/1280x720.png?text=No+Video+Found+${encodeURIComponent(t)}`,alt:`No video found for ${t} ${l+1}`}))):i.videos.map(o=>{var c,u;const l=o.video_files.find(d=>d.quality==="hd"&&d.file_type==="video/mp4")||o.video_files.find(d=>d.file_type==="video/mp4")||o.video_files[0];return{id:o.id,url:l?l.link:null,image:((c=o.video_pictures[0])==null?void 0:c.picture)||`https://via.placeholder.com/1280x720.png?text=${encodeURIComponent(o.url||t)}`,duration:o.duration,user:o.user,alt:`Video of ${t} by ${((u=o.user)==null?void 0:u.name)||"Pexels Contributor"}`}})}catch(s){return console.error("Error fetching Pexels videos:",s),Array(e).fill(null).map((i,o)=>({id:Dt(),url:`https://videos.pexels.com/videos/error-video-${o+1}.mp4`,image:`https://via.placeholder.com/1280x720.png?text=Video+Error+${encodeURIComponent(t)}`,alt:`Error fetching video for ${t} ${o+1}`}))}},j0=async t=>{try{const e=new En({apiKey:Rse}),n=[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE}];console.log(`[utils.jsx/generateImageWithGemini] Calling Gemini with prompt: "${t}"`);const r=await e.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:[{text:t}],safetySettings:n,config:{responseModalities:[bn.TEXT,bn.IMAGE]}});let s=null,i="image/png";if(r.candidates&&r.candidates.length>0&&r.candidates[0].content&&r.candidates[0].content.parts){for(const o of r.candidates[0].content.parts)if(o.inlineData&&o.inlineData.data){s=o.inlineData.data,i=o.inlineData.mimeType||"image/png",console.log(`[utils.jsx/generateImageWithGemini] Image generated. MimeType: ${i}`);break}}if(s)return{url:`data:${i};base64,${s}`,alt:`AI Generated Image for: ${t}`};throw new Error("No image data found in Gemini response.")}catch(e){return console.error("[utils.jsx/generateImageWithGemini] Error generating image with Gemini:",e),{url:`https://via.placeholder.com/512x512.png?text=Error:${encodeURIComponent(t.substring(0,20))}`,alt:`Error generating image for: ${t}`}}},Dse=(t,e)=>{const n={fashion:[`Elevate your style with our ${e}. Crafted for comfort and a modern look.`,`The ${e} is a must-have for any fashion-forward wardrobe. Versatile and chic.`,`Discover the perfect blend of quality and design in our ${e}. Ideal for any occasion.`],electronics:[`Experience next-level technology with the ${e}. Packed with features for modern life.`,`The ${e} offers superior performance and sleek design. Upgrade your tech today.`,`Unleash innovation with the ${e}. Reliable, powerful, and built to last.`],food:[`Savor the rich flavors of our ${e}. Made with the freshest, high-quality ingredients.`,`Our ${e} is a delicious treat for any time of day. Wholesome and satisfying.`,`Indulge in the authentic taste of ${e}. Perfect for sharing or enjoying solo.`],jewelry:[`Adorn yourself with the exquisite ${e}. A timeless piece that radiates elegance.`,`The ${e} is a symbol of sophistication and luxury. Crafted with precision.`,`Make a statement with our stunning ${e}. Perfect for special moments.`],general:[`Discover the quality and utility of the ${e}. A great addition to your collection.`,`The ${e} is designed for excellence and everyday use. You'll love it.`,`Enhance your life with the versatile ${e}. Built for performance and style.`]},r=n[t]||n.general;return r[Math.floor(Math.random()*r.length)]},SI=async(t,e,n="")=>{const r={niche:t,name:e,description:n};let s={heroTitle:`Welcome to ${e}`,heroDescription:`Discover amazing products at ${e}.`,featuresSectionTitle:"Why Shop With Us?",featuresSectionSubtitle:"We are committed to providing you with the best shopping experience.",featureTitles:["Fast Worldwide Shipping","Secure Online Payments","24/7 Customer Support","Easy Returns & Exchanges"],featureDescriptions:["Get your orders delivered quickly and reliably, no matter where you are.","Shop with confidence using our encrypted and secure payment gateways.","Our dedicated team is here to help you around the clock with any queries.","Not satisfied? We offer a hassle-free return and exchange policy."],featuresVideoQuery:`${t} abstract`,newsletterHeading:`Join the ${e} Family`,newsletterText:"Sign up for our newsletter to receive exclusive offers, new product alerts, and style tips directly to your inbox. Don't miss out!"};try{const l=await _I(r);if(l&&!l.error&&l.items&&(s.featuresSectionTitle=l.title,s.featuresSectionSubtitle=l.subtitle,s.featureTitles=l.items.map(c=>c.title),s.featureDescriptions=l.items.map(c=>c.description),s.featureTitles.length>0)){const c=await d3(r);s.featuresVideoQuery=c.query||`${e} ${t} ${s.featureTitles[0]}`}}catch(l){console.error("Failed to generate dynamic features content, using fallback.",l)}const i={fashion:`Step Into Style at ${e}`,electronics:`${e}: Your Tech Universe`,food:`Taste the Difference with ${e}`,jewelry:`Shine Bright with ${e}`,general:`Welcome to ${e} - Quality Finds!`},o={fashion:`Explore the latest trends and timeless classics. ${e} offers curated fashion for every individual. Express yourself with our unique collection.`,electronics:`Discover cutting-edge gadgets and essential electronics at ${e}. We bring you innovation, performance, and value, all in one place.`,food:`From farm-fresh produce to gourmet delights, ${e} is your source for delicious and wholesome food. Quality ingredients for a healthier life.`,jewelry:`Find exquisite pieces that tell your story. ${e} presents a stunning collection of fine jewelry, perfect for gifting or treating yourself.`,general:`Your one-stop shop for amazing products. ${e} offers a diverse range of quality items to meet your everyday needs and special desires.`};return s.heroTitle=i[t]||i.general,s.heroDescription=o[t]||o.general,s};function Mse(t,e){const[n,r]=p.useState(t);return p.useEffect(()=>{const s=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(s)}},[t,e]),n}function gt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function p2(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function D0(...t){return e=>{let n=!1;const r=t.map(s=>{const i=p2(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():p2(t[s],null)}}}}function yn(...t){return p.useCallback(D0(...t),t)}function Lse(t,e){const n=p.createContext(e),r=i=>{const{children:o,...l}=i,c=p.useMemo(()=>l,Object.values(l));return a.jsx(n.Provider,{value:c,children:o})};r.displayName=t+"Provider";function s(i){const o=p.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,s]}function _i(t,e=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];const u=h=>{var v;const{scope:f,children:m,...g}=h,x=((v=f==null?void 0:f[t])==null?void 0:v[c])||l,w=p.useMemo(()=>g,Object.values(g));return a.jsx(x.Provider,{value:w,children:m})};u.displayName=i+"Provider";function d(h,f){var x;const m=((x=f==null?void 0:f[t])==null?void 0:x[c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return p.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,Fse(s,...e)]}function Fse(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function qu(t){const e=Vse(t),n=p.forwardRef((r,s)=>{const{children:i,...o}=r,l=p.Children.toArray(i),c=l.find(Use);if(c){const u=c.props.children,d=l.map(h=>h===c?p.Children.count(u)>1?p.Children.only(null):p.isValidElement(u)?u.props.children:null:h);return a.jsx(e,{...o,ref:s,children:p.isValidElement(u)?p.cloneElement(u,void 0,d):null})}return a.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}var Ose=qu("Slot");function Vse(t){const e=p.forwardRef((n,r)=>{const{children:s,...i}=n;if(p.isValidElement(s)){const o=zse(s),l=Bse(i,s.props);return s.type!==p.Fragment&&(l.ref=r?D0(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var f3=Symbol("radix.slottable");function $se(t){const e=({children:n})=>a.jsx(a.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=f3,e}function Use(t){return p.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===f3}function Bse(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function zse(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function CI(t){const e=t+"CollectionProvider",[n,r]=_i(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=x=>{const{scope:w,children:v}=x,_=ht.useRef(null),C=ht.useRef(new Map).current;return a.jsx(s,{scope:w,itemMap:C,collectionRef:_,children:v})};o.displayName=e;const l=t+"CollectionSlot",c=qu(l),u=ht.forwardRef((x,w)=>{const{scope:v,children:_}=x,C=i(l,v),T=yn(w,C.collectionRef);return a.jsx(c,{ref:T,children:_})});u.displayName=l;const d=t+"CollectionItemSlot",h="data-radix-collection-item",f=qu(d),m=ht.forwardRef((x,w)=>{const{scope:v,children:_,...C}=x,T=ht.useRef(null),R=yn(w,T),A=i(d,v);return ht.useEffect(()=>(A.itemMap.set(T,{ref:T,...C}),()=>void A.itemMap.delete(T))),a.jsx(f,{[h]:"",ref:R,children:_})});m.displayName=d;function g(x){const w=i(t+"CollectionConsumer",x);return ht.useCallback(()=>{const _=w.collectionRef.current;if(!_)return[];const C=Array.from(_.querySelectorAll(`[${h}]`));return Array.from(w.itemMap.values()).sort((A,E)=>C.indexOf(A.ref.current)-C.indexOf(E.ref.current))},[w.collectionRef,w.itemMap])}return[{Provider:o,Slot:u,ItemSlot:m},g,r]}var Gse=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Yt=Gse.reduce((t,e)=>{const n=qu(`Primitive.${e}`),r=p.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function EI(t,e){t&&gl.flushSync(()=>t.dispatchEvent(e))}function $r(t){const e=p.useRef(t);return p.useEffect(()=>{e.current=t}),p.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function Wse(t,e=globalThis==null?void 0:globalThis.document){const n=$r(t);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var Hse="DismissableLayer",CE="dismissableLayer.update",qse="dismissableLayer.pointerDownOutside",Kse="dismissableLayer.focusOutside",g2,m3=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Sg=p.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=t,u=p.useContext(m3),[d,h]=p.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=p.useState({}),g=yn(e,E=>h(E)),x=Array.from(u.layers),[w]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),v=x.indexOf(w),_=d?x.indexOf(d):-1,C=u.layersWithOutsidePointerEventsDisabled.size>0,T=_>=v,R=Jse(E=>{const I=E.target,P=[...u.branches].some(k=>k.contains(I));!T||P||(s==null||s(E),o==null||o(E),E.defaultPrevented||l==null||l())},f),A=Xse(E=>{const I=E.target;[...u.branches].some(k=>k.contains(I))||(i==null||i(E),o==null||o(E),E.defaultPrevented||l==null||l())},f);return Wse(E=>{_===u.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&l&&(E.preventDefault(),l()))},f),p.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(g2=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),y2(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=g2)}},[d,f,n,u]),p.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),y2())},[d,u]),p.useEffect(()=>{const E=()=>m({});return document.addEventListener(CE,E),()=>document.removeEventListener(CE,E)},[]),a.jsx(Yt.div,{...c,ref:g,style:{pointerEvents:C?T?"auto":"none":void 0,...t.style},onFocusCapture:gt(t.onFocusCapture,A.onFocusCapture),onBlurCapture:gt(t.onBlurCapture,A.onBlurCapture),onPointerDownCapture:gt(t.onPointerDownCapture,R.onPointerDownCapture)})});Sg.displayName=Hse;var Yse="DismissableLayerBranch",p3=p.forwardRef((t,e)=>{const n=p.useContext(m3),r=p.useRef(null),s=yn(e,r);return p.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),a.jsx(Yt.div,{...t,ref:s})});p3.displayName=Yse;function Jse(t,e=globalThis==null?void 0:globalThis.document){const n=$r(t),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let c=function(){g3(qse,n,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=c,e.addEventListener("click",s.current,{once:!0})):c()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function Xse(t,e=globalThis==null?void 0:globalThis.document){const n=$r(t),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&g3(Kse,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function y2(){const t=new CustomEvent(CE);document.dispatchEvent(t)}function g3(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?EI(s,i):s.dispatchEvent(i)}var Qse=Sg,Zse=p3,Sa=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},eie="Portal",Cg=p.forwardRef((t,e)=>{var l;const{container:n,...r}=t,[s,i]=p.useState(!1);Sa(()=>i(!0),[]);const o=n||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?mI.createPortal(a.jsx(Yt.div,{...r,ref:e}),o):null});Cg.displayName=eie;function tie(t,e){return p.useReducer((n,r)=>e[n][r]??n,t)}var ws=t=>{const{present:e,children:n}=t,r=nie(e),s=typeof n=="function"?n({present:r.isPresent}):p.Children.only(n),i=yn(r.ref,rie(s));return typeof n=="function"||r.isPresent?p.cloneElement(s,{ref:i}):null};ws.displayName="Presence";function nie(t){const[e,n]=p.useState(),r=p.useRef(null),s=p.useRef(t),i=p.useRef("none"),o=t?"mounted":"unmounted",[l,c]=tie(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const u=By(r.current);i.current=l==="mounted"?u:"none"},[l]),Sa(()=>{const u=r.current,d=s.current;if(d!==t){const f=i.current,m=By(u);t?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),Sa(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=m=>{const x=By(r.current).includes(m.animationName);if(m.target===e&&x&&(c("ANIMATION_END"),!s.current)){const w=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=w)})}},f=m=>{m.target===e&&(i.current=By(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(u=>{r.current=u?getComputedStyle(u):null,n(u)},[])}}function By(t){return(t==null?void 0:t.animationName)||"none"}function rie(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var sie=l0[" useInsertionEffect ".trim().toString()]||Sa;function Oc({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[s,i,o]=iie({defaultProp:e,onChange:n}),l=t!==void 0,c=l?t:s;{const d=p.useRef(t!==void 0);p.useEffect(()=>{const h=d.current;h!==l&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,r])}const u=p.useCallback(d=>{var h;if(l){const f=oie(d)?d(t):d;f!==t&&((h=o.current)==null||h.call(o,f))}else i(d)},[l,t,i,o]);return[c,u]}function iie({defaultProp:t,onChange:e}){const[n,r]=p.useState(t),s=p.useRef(n),i=p.useRef(e);return sie(()=>{i.current=e},[e]),p.useEffect(()=>{var o;s.current!==n&&((o=i.current)==null||o.call(i,n),s.current=n)},[n,s]),[n,r,i]}function oie(t){return typeof t=="function"}var aie=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),lie="VisuallyHidden",TI=p.forwardRef((t,e)=>a.jsx(Yt.span,{...t,ref:e,style:{...aie,...t.style}}));TI.displayName=lie;var II="ToastProvider",[NI,cie,uie]=CI("Toast"),[y3,bje]=_i("Toast",[uie]),[die,M0]=y3(II),x3=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=t,[l,c]=p.useState(null),[u,d]=p.useState(0),h=p.useRef(!1),f=p.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${II}\`. Expected non-empty \`string\`.`),a.jsx(NI.Provider,{scope:e,children:a.jsx(die,{scope:e,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>d(m=>m+1),[]),onToastRemove:p.useCallback(()=>d(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};x3.displayName=II;var v3="ToastViewport",hie=["F8"],EE="toast.viewportPause",TE="toast.viewportResume",w3=p.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=hie,label:s="Notifications ({hotkey})",...i}=t,o=M0(v3,n),l=cie(n),c=p.useRef(null),u=p.useRef(null),d=p.useRef(null),h=p.useRef(null),f=yn(e,h,o.onViewportChange),m=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=o.toastCount>0;p.useEffect(()=>{const w=v=>{var C;r.length!==0&&r.every(T=>v[T]||v.code===T)&&((C=h.current)==null||C.focus())};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[r]),p.useEffect(()=>{const w=c.current,v=h.current;if(g&&w&&v){const _=()=>{if(!o.isClosePausedRef.current){const A=new CustomEvent(EE);v.dispatchEvent(A),o.isClosePausedRef.current=!0}},C=()=>{if(o.isClosePausedRef.current){const A=new CustomEvent(TE);v.dispatchEvent(A),o.isClosePausedRef.current=!1}},T=A=>{!w.contains(A.relatedTarget)&&C()},R=()=>{w.contains(document.activeElement)||C()};return w.addEventListener("focusin",_),w.addEventListener("focusout",T),w.addEventListener("pointermove",_),w.addEventListener("pointerleave",R),window.addEventListener("blur",_),window.addEventListener("focus",C),()=>{w.removeEventListener("focusin",_),w.removeEventListener("focusout",T),w.removeEventListener("pointermove",_),w.removeEventListener("pointerleave",R),window.removeEventListener("blur",_),window.removeEventListener("focus",C)}}},[g,o.isClosePausedRef]);const x=p.useCallback(({tabbingDirection:w})=>{const _=l().map(C=>{const T=C.ref.current,R=[T,...Eie(T)];return w==="forwards"?R:R.reverse()});return(w==="forwards"?_.reverse():_).flat()},[l]);return p.useEffect(()=>{const w=h.current;if(w){const v=_=>{var R,A,E;const C=_.altKey||_.ctrlKey||_.metaKey;if(_.key==="Tab"&&!C){const I=document.activeElement,P=_.shiftKey;if(_.target===w&&P){(R=u.current)==null||R.focus();return}const D=x({tabbingDirection:P?"backwards":"forwards"}),M=D.findIndex(G=>G===I);q_(D.slice(M+1))?_.preventDefault():P?(A=u.current)==null||A.focus():(E=d.current)==null||E.focus()}};return w.addEventListener("keydown",v),()=>w.removeEventListener("keydown",v)}},[l,x]),a.jsxs(Zse,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&a.jsx(IE,{ref:u,onFocusFromOutsideViewport:()=>{const w=x({tabbingDirection:"forwards"});q_(w)}}),a.jsx(NI.Slot,{scope:n,children:a.jsx(Yt.ol,{tabIndex:-1,...i,ref:f})}),g&&a.jsx(IE,{ref:d,onFocusFromOutsideViewport:()=>{const w=x({tabbingDirection:"backwards"});q_(w)}})]})});w3.displayName=v3;var b3="ToastFocusProxy",IE=p.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=M0(b3,n);return a.jsx(TI,{"aria-hidden":!0,tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(l))&&r()}})});IE.displayName=b3;var Eg="Toast",fie="toast.swipeStart",mie="toast.swipeMove",pie="toast.swipeCancel",gie="toast.swipeEnd",_3=p.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=t,[l,c]=Oc({prop:r,defaultProp:s??!0,onChange:i,caller:Eg});return a.jsx(ws,{present:n||l,children:a.jsx(vie,{open:l,...o,ref:e,onClose:()=>c(!1),onPause:$r(t.onPause),onResume:$r(t.onResume),onSwipeStart:gt(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:gt(t.onSwipeMove,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:gt(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:gt(t.onSwipeEnd,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})})});_3.displayName=Eg;var[yie,xie]=y3(Eg,{onClose(){}}),vie=p.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:m,...g}=t,x=M0(Eg,n),[w,v]=p.useState(null),_=yn(e,G=>v(G)),C=p.useRef(null),T=p.useRef(null),R=s||x.duration,A=p.useRef(0),E=p.useRef(R),I=p.useRef(0),{onToastAdd:P,onToastRemove:k}=x,j=$r(()=>{var B;(w==null?void 0:w.contains(document.activeElement))&&((B=x.viewport)==null||B.focus()),o()}),D=p.useCallback(G=>{!G||G===1/0||(window.clearTimeout(I.current),A.current=new Date().getTime(),I.current=window.setTimeout(j,G))},[j]);p.useEffect(()=>{const G=x.viewport;if(G){const B=()=>{D(E.current),u==null||u()},W=()=>{const Q=new Date().getTime()-A.current;E.current=E.current-Q,window.clearTimeout(I.current),c==null||c()};return G.addEventListener(EE,W),G.addEventListener(TE,B),()=>{G.removeEventListener(EE,W),G.removeEventListener(TE,B)}}},[x.viewport,R,c,u,D]),p.useEffect(()=>{i&&!x.isClosePausedRef.current&&D(R)},[i,R,x.isClosePausedRef,D]),p.useEffect(()=>(P(),()=>k()),[P,k]);const M=p.useMemo(()=>w?P3(w):null,[w]);return x.viewport?a.jsxs(a.Fragment,{children:[M&&a.jsx(wie,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:M}),a.jsx(yie,{scope:n,onClose:j,children:gl.createPortal(a.jsx(NI.ItemSlot,{scope:n,children:a.jsx(Qse,{asChild:!0,onEscapeKeyDown:gt(l,()=>{x.isFocusedToastEscapeKeyDownRef.current||j(),x.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(Yt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":x.swipeDirection,...g,ref:_,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:gt(t.onKeyDown,G=>{G.key==="Escape"&&(l==null||l(G.nativeEvent),G.nativeEvent.defaultPrevented||(x.isFocusedToastEscapeKeyDownRef.current=!0,j()))}),onPointerDown:gt(t.onPointerDown,G=>{G.button===0&&(C.current={x:G.clientX,y:G.clientY})}),onPointerMove:gt(t.onPointerMove,G=>{if(!C.current)return;const B=G.clientX-C.current.x,W=G.clientY-C.current.y,Q=!!T.current,H=["left","right"].includes(x.swipeDirection),Y=["left","up"].includes(x.swipeDirection)?Math.min:Math.max,V=H?Y(0,B):0,$=H?0:Y(0,W),z=G.pointerType==="touch"?10:2,F={x:V,y:$},Z={originalEvent:G,delta:F};Q?(T.current=F,zy(mie,h,Z,{discrete:!1})):x2(F,x.swipeDirection,z)?(T.current=F,zy(fie,d,Z,{discrete:!1}),G.target.setPointerCapture(G.pointerId)):(Math.abs(B)>z||Math.abs(W)>z)&&(C.current=null)}),onPointerUp:gt(t.onPointerUp,G=>{const B=T.current,W=G.target;if(W.hasPointerCapture(G.pointerId)&&W.releasePointerCapture(G.pointerId),T.current=null,C.current=null,B){const Q=G.currentTarget,H={originalEvent:G,delta:B};x2(B,x.swipeDirection,x.swipeThreshold)?zy(gie,m,H,{discrete:!0}):zy(pie,f,H,{discrete:!0}),Q.addEventListener("click",Y=>Y.preventDefault(),{once:!0})}})})})}),x.viewport)})]}):null}),wie=t=>{const{__scopeToast:e,children:n,...r}=t,s=M0(Eg,e),[i,o]=p.useState(!1),[l,c]=p.useState(!1);return Sie(()=>o(!0)),p.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:a.jsx(Cg,{asChild:!0,children:a.jsx(TI,{...r,children:i&&a.jsxs(a.Fragment,{children:[s.label," ",n]})})})},bie="ToastTitle",S3=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Yt.div,{...r,ref:e})});S3.displayName=bie;var _ie="ToastDescription",C3=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Yt.div,{...r,ref:e})});C3.displayName=_ie;var E3="ToastAction",T3=p.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?a.jsx(N3,{altText:n,asChild:!0,children:a.jsx(PI,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${E3}\`. Expected non-empty \`string\`.`),null)});T3.displayName=E3;var I3="ToastClose",PI=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,s=xie(I3,n);return a.jsx(N3,{asChild:!0,children:a.jsx(Yt.button,{type:"button",...r,ref:e,onClick:gt(t.onClick,s.onClose)})})});PI.displayName=I3;var N3=p.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...s}=t;return a.jsx(Yt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function P3(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),Cie(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...P3(r))}}),e}function zy(t,e,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?EI(s,i):s.dispatchEvent(i)}var x2=(t,e,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return e==="left"||e==="right"?i&&r>n:!i&&s>n};function Sie(t=()=>{}){const e=$r(t);Sa(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function Cie(t){return t.nodeType===t.ELEMENT_NODE}function Eie(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function q_(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var Tie=x3,A3=w3,k3=_3,R3=S3,j3=C3,D3=T3,M3=PI;const v2=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,w2=V$,AI=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return w2(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const f=v2(d)||v2(h);return s[u][f]}),l=n&&Object.entries(n).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:h,className:f,...m}=d;return Object.entries(m).every(g=>{let[x,w]=g;return Array.isArray(w)?w.includes({...i,...l}[x]):{...i,...l}[x]===w})?[...u,h,f]:u},[]);return w2(t,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};var Iie={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Nie=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qe=(t,e)=>{const n=p.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:l,...c},u)=>p.createElement("svg",{ref:u,...Iie,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${Nie(t)}`,...c},[...e.map(([d,h])=>p.createElement(d,h)),...(Array.isArray(l)?l:[l])||[]]));return n.displayName=`${t}`,n},K_=qe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Tg=qe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Go=qe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Mu=qe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Pie=qe("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),Aie=qe("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),Xv=qe("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),kie=qe("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Rie=qe("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),kI=qe("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),ya=qe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Ig=qe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Iu=qe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),jie=qe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),L3=qe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Die=qe("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),Mie=qe("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),RI=qe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Do=qe("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),b2=qe("DownloadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m8 17 4 4 4-4",key:"1ul180"}]]),jI=qe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Jh=qe("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),Lie=qe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Fie=qe("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),Sr=qe("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),F3=qe("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]),Lu=qe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Y_=qe("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),_2=qe("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),O3=qe("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Oie=qe("ImageDown",[["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10.8",key:"sqts6f"}],["path",{d:"m21 15-3.1-3.1a2 2 0 0 0-2.814.014L6 21",key:"1h47z9"}],["path",{d:"m14 19.5 3 3v-6",key:"1x9jmo"}],["path",{d:"m17 22.5 3-3",key:"xzuz0n"}]]),V3=qe("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),NE=qe("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Vie=qe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Gx=qe("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),$ie=qe("Layers3",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m6.08 9.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1e5n1m"}],["path",{d:"m6.08 14.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1iwflc"}]]),Uie=qe("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),Bie=qe("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),zie=qe("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),ft=qe("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Gie=qe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),S2=qe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),dh=qe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Wie=qe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Hie=qe("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),$3=qe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),qie=qe("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),Kie=qe("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),PE=qe("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),Yie=qe("MousePointer2",[["path",{d:"m4 4 7.07 17 2.51-7.39L21 11.07z",key:"1vqm48"}]]),U3=qe("MoveDown",[["path",{d:"M8 18L12 22L16 18",key:"cskvfv"}],["path",{d:"M12 2V22",key:"r89rzk"}]]),B3=qe("MoveUp",[["path",{d:"M8 6L12 2L16 6",key:"1yvkyx"}],["path",{d:"M12 2V22",key:"r89rzk"}]]),Oi=qe("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Qv=qe("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),Jie=qe("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),Xie=qe("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),Zv=qe("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),ew=qe("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),C2=qe("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),z3=qe("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),Qie=qe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Zie=qe("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),DI=qe("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Vi=qe("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),Nu=qe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),AE=qe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),G3=qe("Replace",[["path",{d:"M14 4c0-1.1.9-2 2-2",key:"1mvvbw"}],["path",{d:"M20 2c1.1 0 2 .9 2 2",key:"1mj6oe"}],["path",{d:"M22 8c0 1.1-.9 2-2 2",key:"v1wql3"}],["path",{d:"M16 10c-1.1 0-2-.9-2-2",key:"821ux0"}],["path",{d:"m3 7 3 3 3-3",key:"x25e72"}],["path",{d:"M6 10V5c0-1.7 1.3-3 3-3h1",key:"13af7h"}],["rect",{width:"8",height:"8",x:"2",y:"14",rx:"2",key:"17ihk4"}]]),eoe=qe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),J_=qe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),tw=qe("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]),ic=qe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),toe=qe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),noe=qe("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),Nh=qe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),roe=qe("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),soe=qe("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),Up=qe("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Er=qe("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),MI=qe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),ioe=qe("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]),Gy=qe("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),kE=qe("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),qm=qe("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),W3=qe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Wn=qe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),tm=qe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),nw=qe("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),ooe=qe("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),aoe=qe("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),Uo=qe("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]),H3=qe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),L0=qe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),E2=qe("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),Ca=qe("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),xa=qe("Wand",[["path",{d:"M15 4V2",key:"z1p9b7"}],["path",{d:"M15 16v-2",key:"px0unx"}],["path",{d:"M8 9h2",key:"1g203m"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M17.8 11.8 19 13",key:"yihg8r"}],["path",{d:"M15 9h0",key:"kg5t1u"}],["path",{d:"M17.8 6.2 19 5",key:"fd4us0"}],["path",{d:"m3 21 9-9",key:"1jfql5"}],["path",{d:"M12.2 6.2 11 5",key:"i3da3b"}]]),rw=qe("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ki=qe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),loe=qe("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),q3=qe("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),coe=Tie,K3=ht.forwardRef(({className:t,...e},n)=>a.jsx(A3,{ref:n,className:Ct("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));K3.displayName=A3.displayName;const uoe=AI("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Y3=ht.forwardRef(({className:t,variant:e,...n},r)=>a.jsx(k3,{ref:r,className:Ct(uoe({variant:e}),t),...n}));Y3.displayName=k3.displayName;const doe=ht.forwardRef(({className:t,...e},n)=>a.jsx(D3,{ref:n,className:Ct("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));doe.displayName=D3.displayName;const J3=ht.forwardRef(({className:t,...e},n)=>a.jsx(M3,{ref:n,className:Ct("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:a.jsx(Ki,{className:"h-4 w-4"})}));J3.displayName=M3.displayName;const X3=ht.forwardRef(({className:t,...e},n)=>a.jsx(R3,{ref:n,className:Ct("text-sm font-semibold",t),...e}));X3.displayName=R3.displayName;const Q3=ht.forwardRef(({className:t,...e},n)=>a.jsx(j3,{ref:n,className:Ct("text-sm opacity-90",t),...e}));Q3.displayName=j3.displayName;const hoe=1;let X_=0;function foe(){return X_=(X_+1)%Number.MAX_VALUE,X_.toString()}const Ws={state:{toasts:[]},listeners:[],getState:()=>Ws.state,setState:t=>{typeof t=="function"?Ws.state=t(Ws.state):Ws.state={...Ws.state,...t},Ws.listeners.forEach(e=>e(Ws.state))},subscribe:t=>(Ws.listeners.push(t),()=>{Ws.listeners=Ws.listeners.filter(e=>e!==t)})},moe=({...t})=>{const e=foe(),n=s=>Ws.setState(i=>({...i,toasts:i.toasts.map(o=>o.id===e?{...o,...s}:o)})),r=()=>Ws.setState(s=>({...s,toasts:s.toasts.filter(i=>i.id!==e)}));return Ws.setState(s=>({...s,toasts:[{...t,id:e,dismiss:r},...s.toasts].slice(0,hoe)})),{id:e,dismiss:r,update:n}};function bs(){const[t,e]=p.useState(Ws.getState());return p.useEffect(()=>Ws.subscribe(r=>{e(r)}),[]),p.useEffect(()=>{const n=[];return t.toasts.forEach(r=>{if(r.duration===1/0)return;const s=setTimeout(()=>{r.dismiss()},r.duration||5e3);n.push(s)}),()=>{n.forEach(r=>clearTimeout(r))}},[t.toasts]),{toast:moe,toasts:t.toasts}}function poe(){const{toasts:t}=bs();return a.jsxs(coe,{children:[t.map(({id:e,title:n,description:r,action:s,dismiss:i,...o})=>a.jsxs(Y3,{...o,children:[a.jsxs("div",{className:"grid gap-1",children:[n&&a.jsx(X3,{children:n}),r&&a.jsx(Q3,{children:r})]}),s,a.jsx(J3,{})]},e)),a.jsx(K3,{})]})}var goe=l0[" useId ".trim().toString()]||(()=>{}),yoe=0;function oc(t){const[e,n]=p.useState(goe());return Sa(()=>{t||n(r=>r??String(yoe++))},[t]),t||(e?`radix-${e}`:"")}var Q_="focusScope.autoFocusOnMount",Z_="focusScope.autoFocusOnUnmount",T2={bubbles:!1,cancelable:!0},xoe="FocusScope",F0=p.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[l,c]=p.useState(null),u=$r(s),d=$r(i),h=p.useRef(null),f=yn(e,x=>c(x)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let x=function(C){if(m.paused||!l)return;const T=C.target;l.contains(T)?h.current=T:jl(h.current,{select:!0})},w=function(C){if(m.paused||!l)return;const T=C.relatedTarget;T!==null&&(l.contains(T)||jl(h.current,{select:!0}))},v=function(C){if(document.activeElement===document.body)for(const R of C)R.removedNodes.length>0&&jl(l)};document.addEventListener("focusin",x),document.addEventListener("focusout",w);const _=new MutationObserver(v);return l&&_.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",w),_.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){N2.add(m);const x=document.activeElement;if(!l.contains(x)){const v=new CustomEvent(Q_,T2);l.addEventListener(Q_,u),l.dispatchEvent(v),v.defaultPrevented||(voe(Coe(Z3(l)),{select:!0}),document.activeElement===x&&jl(l))}return()=>{l.removeEventListener(Q_,u),setTimeout(()=>{const v=new CustomEvent(Z_,T2);l.addEventListener(Z_,d),l.dispatchEvent(v),v.defaultPrevented||jl(x??document.body,{select:!0}),l.removeEventListener(Z_,d),N2.remove(m)},0)}}},[l,u,d,m]);const g=p.useCallback(x=>{if(!n&&!r||m.paused)return;const w=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,v=document.activeElement;if(w&&v){const _=x.currentTarget,[C,T]=woe(_);C&&T?!x.shiftKey&&v===T?(x.preventDefault(),n&&jl(C,{select:!0})):x.shiftKey&&v===C&&(x.preventDefault(),n&&jl(T,{select:!0})):v===_&&x.preventDefault()}},[n,r,m.paused]);return a.jsx(Yt.div,{tabIndex:-1,...o,ref:f,onKeyDown:g})});F0.displayName=xoe;function voe(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(jl(r,{select:e}),document.activeElement!==n)return}function woe(t){const e=Z3(t),n=I2(e,t),r=I2(e.reverse(),t);return[n,r]}function Z3(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function I2(t,e){for(const n of t)if(!boe(n,{upTo:e}))return n}function boe(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function _oe(t){return t instanceof HTMLInputElement&&"select"in t}function jl(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&_oe(t)&&e&&t.select()}}var N2=Soe();function Soe(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=P2(t,e),t.unshift(e)},remove(e){var n;t=P2(t,e),(n=t[0])==null||n.resume()}}}function P2(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function Coe(t){return t.filter(e=>e.tagName!=="A")}var eS=0;function LI(){p.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??A2()),document.body.insertAdjacentElement("beforeend",t[1]??A2()),eS++,()=>{eS===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),eS--}},[])}function A2(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var js=function(){return js=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},js.apply(this,arguments)};function Tf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function eU(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var Km="right-scroll-bar-position",Ym="width-before-scroll-bar",Eoe="with-scroll-bars-hidden",Toe="--removed-body-scroll-bar-size";function tS(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Ioe(t,e){var n=p.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var Noe=typeof window<"u"?p.useLayoutEffect:p.useEffect,k2=new WeakMap;function tU(t,e){var n=Ioe(e||null,function(r){return t.forEach(function(s){return tS(s,r)})});return Noe(function(){var r=k2.get(n);if(r){var s=new Set(r),i=new Set(t),o=n.current;s.forEach(function(l){i.has(l)||tS(l,null)}),i.forEach(function(l){s.has(l)||tS(l,o)})}k2.set(n,t)},[t]),n}function Poe(t){return t}function Aoe(t,e){e===void 0&&(e=Poe);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(l){return i(l)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var l=n;n=[],l.forEach(i),o=n}var c=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),n={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),n}}}};return s}function nU(t){t===void 0&&(t={});var e=Aoe(null);return e.options=js({async:!0,ssr:!1},t),e}var rU=function(t){var e=t.sideCar,n=Tf(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return p.createElement(r,js({},n))};rU.isSideCarExport=!0;function sU(t,e){return t.useMedium(e),rU}var iU=nU(),nS=function(){},O0=p.forwardRef(function(t,e){var n=p.useRef(null),r=p.useState({onScrollCapture:nS,onWheelCapture:nS,onTouchMoveCapture:nS}),s=r[0],i=r[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,m=t.noRelative,g=t.noIsolation,x=t.inert,w=t.allowPinchZoom,v=t.as,_=v===void 0?"div":v,C=t.gapMode,T=Tf(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),R=f,A=tU([n,e]),E=js(js({},T),s);return p.createElement(p.Fragment,null,d&&p.createElement(R,{sideCar:iU,removeScrollBar:u,shards:h,noRelative:m,noIsolation:g,inert:x,setCallbacks:i,allowPinchZoom:!!w,lockRef:n,gapMode:C}),o?p.cloneElement(p.Children.only(l),js(js({},E),{ref:A})):p.createElement(_,js({},E,{className:c,ref:A}),l))});O0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};O0.classNames={fullWidth:Ym,zeroRight:Km};var R2,koe=function(){if(R2)return R2;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Roe(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=koe();return e&&t.setAttribute("nonce",e),t}function joe(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Doe(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Moe=function(){var t=0,e=null;return{add:function(n){t==0&&(e=Roe())&&(joe(e,n),Doe(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Loe=function(){var t=Moe();return function(e,n){p.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},FI=function(){var t=Loe(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},Foe={left:0,top:0,right:0,gap:0},rS=function(t){return parseInt(t||"",10)||0},Ooe=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[rS(n),rS(r),rS(s)]},Voe=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Foe;var e=Ooe(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},$oe=FI(),Ph="data-scroll-locked",Uoe=function(t,e,n,r){var s=t.left,i=t.top,o=t.right,l=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(Eoe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(Ph,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Km,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Ym,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Km," .").concat(Km,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Ym," .").concat(Ym,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Ph,`] {
    `).concat(Toe,": ").concat(l,`px;
  }
`)},j2=function(){var t=parseInt(document.body.getAttribute(Ph)||"0",10);return isFinite(t)?t:0},Boe=function(){p.useEffect(function(){return document.body.setAttribute(Ph,(j2()+1).toString()),function(){var t=j2()-1;t<=0?document.body.removeAttribute(Ph):document.body.setAttribute(Ph,t.toString())}},[])},oU=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;Boe();var i=p.useMemo(function(){return Voe(s)},[s]);return p.createElement($oe,{styles:Uoe(i,!e,s,n?"":"!important")})},RE=!1;if(typeof window<"u")try{var Wy=Object.defineProperty({},"passive",{get:function(){return RE=!0,!0}});window.addEventListener("test",Wy,Wy),window.removeEventListener("test",Wy,Wy)}catch{RE=!1}var Pd=RE?{passive:!1}:!1,zoe=function(t){return t.tagName==="TEXTAREA"},aU=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!zoe(t)&&n[e]==="visible")},Goe=function(t){return aU(t,"overflowY")},Woe=function(t){return aU(t,"overflowX")},D2=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=lU(t,r);if(s){var i=cU(t,r),o=i[1],l=i[2];if(o>l)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Hoe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},qoe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},lU=function(t,e){return t==="v"?Goe(e):Woe(e)},cU=function(t,e){return t==="v"?Hoe(e):qoe(e)},Koe=function(t,e){return t==="h"&&e==="rtl"?-1:1},Yoe=function(t,e,n,r,s){var i=Koe(t,window.getComputedStyle(e).direction),o=i*r,l=n.target,c=e.contains(l),u=!1,d=o>0,h=0,f=0;do{var m=cU(t,l),g=m[0],x=m[1],w=m[2],v=x-w-i*g;(g||v)&&lU(t,l)&&(h+=v,f+=g),l=l.parentNode.host||l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&(s&&Math.abs(h)<1||!s&&o>h)||!d&&(s&&Math.abs(f)<1||!s&&-o>f))&&(u=!0),u},Hy=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},M2=function(t){return[t.deltaX,t.deltaY]},L2=function(t){return t&&"current"in t?t.current:t},Joe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Xoe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Qoe=0,Ad=[];function Zoe(t){var e=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(Qoe++)[0],i=p.useState(FI)[0],o=p.useRef(t);p.useEffect(function(){o.current=t},[t]),p.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var x=eU([t.lockRef.current],(t.shards||[]).map(L2),!0).filter(Boolean);return x.forEach(function(w){return w.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),x.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=p.useCallback(function(x,w){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!o.current.allowPinchZoom;var v=Hy(x),_=n.current,C="deltaX"in x?x.deltaX:_[0]-v[0],T="deltaY"in x?x.deltaY:_[1]-v[1],R,A=x.target,E=Math.abs(C)>Math.abs(T)?"h":"v";if("touches"in x&&E==="h"&&A.type==="range")return!1;var I=D2(E,A);if(!I)return!0;if(I?R=E:(R=E==="v"?"h":"v",I=D2(E,A)),!I)return!1;if(!r.current&&"changedTouches"in x&&(C||T)&&(r.current=R),!R)return!0;var P=r.current||R;return Yoe(P,w,x,P==="h"?C:T,!0)},[]),c=p.useCallback(function(x){var w=x;if(!(!Ad.length||Ad[Ad.length-1]!==i)){var v="deltaY"in w?M2(w):Hy(w),_=e.current.filter(function(R){return R.name===w.type&&(R.target===w.target||w.target===R.shadowParent)&&Joe(R.delta,v)})[0];if(_&&_.should){w.cancelable&&w.preventDefault();return}if(!_){var C=(o.current.shards||[]).map(L2).filter(Boolean).filter(function(R){return R.contains(w.target)}),T=C.length>0?l(w,C[0]):!o.current.noIsolation;T&&w.cancelable&&w.preventDefault()}}},[]),u=p.useCallback(function(x,w,v,_){var C={name:x,delta:w,target:v,should:_,shadowParent:eae(v)};e.current.push(C),setTimeout(function(){e.current=e.current.filter(function(T){return T!==C})},1)},[]),d=p.useCallback(function(x){n.current=Hy(x),r.current=void 0},[]),h=p.useCallback(function(x){u(x.type,M2(x),x.target,l(x,t.lockRef.current))},[]),f=p.useCallback(function(x){u(x.type,Hy(x),x.target,l(x,t.lockRef.current))},[]);p.useEffect(function(){return Ad.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Pd),document.addEventListener("touchmove",c,Pd),document.addEventListener("touchstart",d,Pd),function(){Ad=Ad.filter(function(x){return x!==i}),document.removeEventListener("wheel",c,Pd),document.removeEventListener("touchmove",c,Pd),document.removeEventListener("touchstart",d,Pd)}},[]);var m=t.removeScrollBar,g=t.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:Xoe(s)}):null,m?p.createElement(oU,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function eae(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const tae=sU(iU,Zoe);var uU=p.forwardRef(function(t,e){return p.createElement(O0,js({},t,{ref:e,sideCar:tae}))});uU.classNames=O0.classNames;const OI=uU;var nae=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},kd=new WeakMap,qy=new WeakMap,Ky={},sS=0,dU=function(t){return t&&(t.host||dU(t.parentNode))},rae=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=dU(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},sae=function(t,e,n,r){var s=rae(e,Array.isArray(t)?t:[t]);Ky[n]||(Ky[n]=new WeakMap);var i=Ky[n],o=[],l=new Set,c=new Set(s),u=function(h){!h||l.has(h)||(l.add(h),u(h.parentNode))};s.forEach(u);var d=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(f){if(l.has(f))d(f);else try{var m=f.getAttribute(r),g=m!==null&&m!=="false",x=(kd.get(f)||0)+1,w=(i.get(f)||0)+1;kd.set(f,x),i.set(f,w),o.push(f),x===1&&g&&qy.set(f,!0),w===1&&f.setAttribute(n,"true"),g||f.setAttribute(r,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return d(e),l.clear(),sS++,function(){o.forEach(function(h){var f=kd.get(h)-1,m=i.get(h)-1;kd.set(h,f),i.set(h,m),f||(qy.has(h)||h.removeAttribute(r),qy.delete(h)),m||h.removeAttribute(n)}),sS--,sS||(kd=new WeakMap,kd=new WeakMap,qy=new WeakMap,Ky={})}},V0=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=e||nae(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),sae(r,s,n,"aria-hidden")):function(){return null}},$0="Dialog",[hU,fU]=_i($0),[iae,Jo]=hU($0),mU=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,l=p.useRef(null),c=p.useRef(null),[u,d]=Oc({prop:r,defaultProp:s??!1,onChange:i,caller:$0});return a.jsx(iae,{scope:e,triggerRef:l,contentRef:c,contentId:oc(),titleId:oc(),descriptionId:oc(),open:u,onOpenChange:d,onOpenToggle:p.useCallback(()=>d(h=>!h),[d]),modal:o,children:n})};mU.displayName=$0;var pU="DialogTrigger",gU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Jo(pU,n),i=yn(e,s.triggerRef);return a.jsx(Yt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":UI(s.open),...r,ref:i,onClick:gt(t.onClick,s.onOpenToggle)})});gU.displayName=pU;var VI="DialogPortal",[oae,yU]=hU(VI,{forceMount:void 0}),xU=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:s}=t,i=Jo(VI,e);return a.jsx(oae,{scope:e,forceMount:n,children:p.Children.map(r,o=>a.jsx(ws,{present:n||i.open,children:a.jsx(Cg,{asChild:!0,container:s,children:o})}))})};xU.displayName=VI;var sw="DialogOverlay",vU=p.forwardRef((t,e)=>{const n=yU(sw,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Jo(sw,t.__scopeDialog);return i.modal?a.jsx(ws,{present:r||i.open,children:a.jsx(lae,{...s,ref:e})}):null});vU.displayName=sw;var aae=qu("DialogOverlay.RemoveScroll"),lae=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Jo(sw,n);return a.jsx(OI,{as:aae,allowPinchZoom:!0,shards:[s.contentRef],children:a.jsx(Yt.div,{"data-state":UI(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Ku="DialogContent",wU=p.forwardRef((t,e)=>{const n=yU(Ku,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Jo(Ku,t.__scopeDialog);return a.jsx(ws,{present:r||i.open,children:i.modal?a.jsx(cae,{...s,ref:e}):a.jsx(uae,{...s,ref:e})})});wU.displayName=Ku;var cae=p.forwardRef((t,e)=>{const n=Jo(Ku,t.__scopeDialog),r=p.useRef(null),s=yn(e,n.contentRef,r);return p.useEffect(()=>{const i=r.current;if(i)return V0(i)},[]),a.jsx(bU,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gt(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:gt(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:gt(t.onFocusOutside,i=>i.preventDefault())})}),uae=p.forwardRef((t,e)=>{const n=Jo(Ku,t.__scopeDialog),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(bU,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),bU=p.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,l=Jo(Ku,n),c=p.useRef(null),u=yn(e,c);return LI(),a.jsxs(a.Fragment,{children:[a.jsx(F0,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(Sg,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":UI(l.open),...o,ref:u,onDismiss:()=>l.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(hae,{titleId:l.titleId}),a.jsx(mae,{contentRef:c,descriptionId:l.descriptionId})]})]})}),$I="DialogTitle",_U=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Jo($I,n);return a.jsx(Yt.h2,{id:s.titleId,...r,ref:e})});_U.displayName=$I;var SU="DialogDescription",CU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Jo(SU,n);return a.jsx(Yt.p,{id:s.descriptionId,...r,ref:e})});CU.displayName=SU;var EU="DialogClose",TU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Jo(EU,n);return a.jsx(Yt.button,{type:"button",...r,ref:e,onClick:gt(t.onClick,()=>s.onOpenChange(!1))})});TU.displayName=EU;function UI(t){return t?"open":"closed"}var IU="DialogTitleWarning",[dae,NU]=Lse(IU,{contentName:Ku,titleName:$I,docsSlug:"dialog"}),hae=({titleId:t})=>{const e=NU(IU),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return p.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},fae="DialogDescriptionWarning",mae=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${NU(fae).contentName}}.`;return p.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},pae=mU,gae=gU,PU=xU,BI=vU,zI=wU,GI=_U,WI=CU,U0=TU;const Xr=pae,yae=PU,il=U0,AU=ht.forwardRef(({className:t,...e},n)=>a.jsx(BI,{ref:n,className:Ct("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));AU.displayName=BI.displayName;const Ur=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(yae,{children:[a.jsx(AU,{}),a.jsxs(zI,{ref:r,className:Ct("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,a.jsxs(U0,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(Ki,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ur.displayName=zI.displayName;const Br=({className:t,...e})=>a.jsx("div",{className:Ct("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});Br.displayName="DialogHeader";const Ar=({className:t,...e})=>a.jsx("div",{className:Ct("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});Ar.displayName="DialogFooter";const zr=ht.forwardRef(({className:t,...e},n)=>a.jsx(GI,{ref:n,className:Ct("text-lg font-semibold leading-none tracking-tight",t),...e}));zr.displayName=GI.displayName;const Zi=ht.forwardRef(({className:t,...e},n)=>a.jsx(WI,{ref:n,className:Ct("text-sm text-muted-foreground",t),...e}));Zi.displayName=WI.displayName;const HI=AI("inline-flex items-center justify-center rounded-xl text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-foreground text-primary-foreground hover:bg-foreground/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-xl px-3",lg:"h-11 rounded-xl px-8",icon:"h-10 w-10 rounded-xl"}},defaultVariants:{variant:"default",size:"default"}}),O=ht.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},i)=>{const o=r?Ose:"button";return a.jsx(o,{className:Ct(HI({variant:e,size:n,className:t})),ref:i,...s})});O.displayName="Button";const Ye=ht.forwardRef(({className:t,type:e,...n},r)=>a.jsx("input",{type:e,className:Ct("flex h-10 w-full rounded-xl bg-white dark:bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-400 dark:placeholder:text-zinc-600 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n}));Ye.displayName="Input";const Pn=ht.forwardRef(({className:t,...e},n)=>a.jsx("textarea",{className:Ct("flex min-h-[80px] w-full rounded-xl bg-white dark:bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-zinc-400 dark:placeholder:text-zinc-600 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));Pn.displayName="Textarea";var xae="Label",kU=p.forwardRef((t,e)=>a.jsx(Yt.label,{...t,ref:e,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));kU.displayName=xae;var RU=kU;const De=ht.forwardRef(({className:t,...e},n)=>a.jsx(RU,{ref:n,className:Ct("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...e}));De.displayName=RU.displayName;var vae=p.createContext(void 0);function B0(t){const e=p.useContext(vae);return t||e||"ltr"}var iS="rovingFocusGroup.onEntryFocus",wae={bubbles:!1,cancelable:!0},Ng="RovingFocusGroup",[jE,jU,bae]=CI(Ng),[_ae,z0]=_i(Ng,[bae]),[Sae,Cae]=_ae(Ng),DU=p.forwardRef((t,e)=>a.jsx(jE.Provider,{scope:t.__scopeRovingFocusGroup,children:a.jsx(jE.Slot,{scope:t.__scopeRovingFocusGroup,children:a.jsx(Eae,{...t,ref:e})})}));DU.displayName=Ng;var Eae=p.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=t,f=p.useRef(null),m=yn(e,f),g=B0(i),[x,w]=Oc({prop:o,defaultProp:l??null,onChange:c,caller:Ng}),[v,_]=p.useState(!1),C=$r(u),T=jU(n),R=p.useRef(!1),[A,E]=p.useState(0);return p.useEffect(()=>{const I=f.current;if(I)return I.addEventListener(iS,C),()=>I.removeEventListener(iS,C)},[C]),a.jsx(Sae,{scope:n,orientation:r,dir:g,loop:s,currentTabStopId:x,onItemFocus:p.useCallback(I=>w(I),[w]),onItemShiftTab:p.useCallback(()=>_(!0),[]),onFocusableItemAdd:p.useCallback(()=>E(I=>I+1),[]),onFocusableItemRemove:p.useCallback(()=>E(I=>I-1),[]),children:a.jsx(Yt.div,{tabIndex:v||A===0?-1:0,"data-orientation":r,...h,ref:m,style:{outline:"none",...t.style},onMouseDown:gt(t.onMouseDown,()=>{R.current=!0}),onFocus:gt(t.onFocus,I=>{const P=!R.current;if(I.target===I.currentTarget&&P&&!v){const k=new CustomEvent(iS,wae);if(I.currentTarget.dispatchEvent(k),!k.defaultPrevented){const j=T().filter(W=>W.focusable),D=j.find(W=>W.active),M=j.find(W=>W.id===x),B=[D,M,...j].filter(Boolean).map(W=>W.ref.current);FU(B,d)}}R.current=!1}),onBlur:gt(t.onBlur,()=>_(!1))})})}),MU="RovingFocusGroupItem",LU=p.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:o,...l}=t,c=oc(),u=i||c,d=Cae(MU,n),h=d.currentTabStopId===u,f=jU(n),{onFocusableItemAdd:m,onFocusableItemRemove:g,currentTabStopId:x}=d;return p.useEffect(()=>{if(r)return m(),()=>g()},[r,m,g]),a.jsx(jE.ItemSlot,{scope:n,id:u,focusable:r,active:s,children:a.jsx(Yt.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...l,ref:e,onMouseDown:gt(t.onMouseDown,w=>{r?d.onItemFocus(u):w.preventDefault()}),onFocus:gt(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:gt(t.onKeyDown,w=>{if(w.key==="Tab"&&w.shiftKey){d.onItemShiftTab();return}if(w.target!==w.currentTarget)return;const v=Nae(w,d.orientation,d.dir);if(v!==void 0){if(w.metaKey||w.ctrlKey||w.altKey||w.shiftKey)return;w.preventDefault();let C=f().filter(T=>T.focusable).map(T=>T.ref.current);if(v==="last")C.reverse();else if(v==="prev"||v==="next"){v==="prev"&&C.reverse();const T=C.indexOf(w.currentTarget);C=d.loop?Pae(C,T+1):C.slice(T+1)}setTimeout(()=>FU(C))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:x!=null}):o})})});LU.displayName=MU;var Tae={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Iae(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Nae(t,e,n){const r=Iae(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Tae[r]}function FU(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function Pae(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var OU=DU,VU=LU,G0="Tabs",[Aae,_je]=_i(G0,[z0]),$U=z0(),[kae,qI]=Aae(G0),UU=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...u}=t,d=B0(l),[h,f]=Oc({prop:r,onChange:s,defaultProp:i??"",caller:G0});return a.jsx(kae,{scope:n,baseId:oc(),value:h,onValueChange:f,orientation:o,dir:d,activationMode:c,children:a.jsx(Yt.div,{dir:d,"data-orientation":o,...u,ref:e})})});UU.displayName=G0;var BU="TabsList",zU=p.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...s}=t,i=qI(BU,n),o=$U(n);return a.jsx(OU,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:r,children:a.jsx(Yt.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});zU.displayName=BU;var GU="TabsTrigger",WU=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=t,o=qI(GU,n),l=$U(n),c=KU(o.baseId,r),u=YU(o.baseId,r),d=r===o.value;return a.jsx(VU,{asChild:!0,...l,focusable:!s,active:d,children:a.jsx(Yt.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...i,ref:e,onMouseDown:gt(t.onMouseDown,h=>{!s&&h.button===0&&h.ctrlKey===!1?o.onValueChange(r):h.preventDefault()}),onKeyDown:gt(t.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(r)}),onFocus:gt(t.onFocus,()=>{const h=o.activationMode!=="manual";!d&&!s&&h&&o.onValueChange(r)})})})});WU.displayName=GU;var HU="TabsContent",qU=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...o}=t,l=qI(HU,n),c=KU(l.baseId,r),u=YU(l.baseId,r),d=r===l.value,h=p.useRef(d);return p.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),a.jsx(ws,{present:s||d,children:({present:f})=>a.jsx(Yt.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:u,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});qU.displayName=HU;function KU(t,e){return`${t}-trigger-${e}`}function YU(t,e){return`${t}-content-${e}`}var Rae=UU,JU=zU,XU=WU,QU=qU;const Si=Rae,ti=ht.forwardRef(({className:t,...e},n)=>a.jsx(JU,{ref:n,className:Ct("inline-flex h-10 items-center justify-center rounded-[18px] bg-white dark:bg-[#1c1c1c] p-1 text-muted-foreground",t),...e}));ti.displayName=JU.displayName;const Ot=ht.forwardRef(({className:t,...e},n)=>a.jsx(XU,{ref:n,className:Ct("inline-flex items-center justify-center whitespace-nowrap rounded-xl px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-gray-100 data-[state=active]:dark:bg-zinc-700 data-[state=active]:text-foreground data-[state=active]:shadow-sm data-[state=active]:border data-[state=active]:border-[#8d9499] data-[state=active]:relative data-[state=active]:-top-px",t),...e}));Ot.displayName=XU.displayName;const Vt=ht.forwardRef(({className:t,...e},n)=>a.jsx(QU,{ref:n,className:Ct("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));Vt.displayName=QU.displayName;var jae="Separator",F2="horizontal",Dae=["horizontal","vertical"],ZU=p.forwardRef((t,e)=>{const{decorative:n,orientation:r=F2,...s}=t,i=Mae(r)?r:F2,l=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return a.jsx(Yt.div,{"data-orientation":i,...l,...s,ref:e})});ZU.displayName=jae;function Mae(t){return Dae.includes(t)}var e5=ZU;const Ui=ht.forwardRef(({className:t,orientation:e="horizontal",decorative:n=!0,...r},s)=>a.jsx(e5,{ref:s,decorative:n,orientation:e,className:Ct("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...r}));Ui.displayName=e5.displayName;const t5="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s";console.log("[geminiImageGeneration Module] VITE_GEMINI_API_KEY loaded:",`"${t5.substring(0,5)}..."`);const n5="YsU4YZtXedeyLPn6bQaNT8PD";console.log("[geminiImageGeneration Module] VITE_REMOVE_BG_API_KEY loaded:",`"${n5.substring(0,5)}..."`);const vl=t5,KI=n5,Pa=[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_NONE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_NONE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_NONE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_NONE}];async function Lae(t,e,n){var r;try{const s=[{inlineData:{mimeType:e,data:t}},{text:"Describe the main colors of this logo. Is it primarily black, white, or colorful? If black or white, state which. If colorful, list the dominant colors."}],i=await n.models.generateContent({model:"gemini-2.0-flash",contents:s,safetySettings:Pa,config:{responseModalities:[bn.TEXT]}}),o=((r=i==null?void 0:i.text)==null?void 0:r.toLowerCase())||"";return console.log("[getLogoColorType] Gemini color description:",o),o.includes("primarily black")||o.includes("black logo")?"black":o.includes("primarily white")||o.includes("white logo")?"white":(o.includes("colorful")||o.includes("multiple colors")||o.includes("various colors")||console.warn("[getLogoColorType] Could not clearly determine logo color type. Defaulting to 'colored'. Desc:",o),"colored")}catch(s){return console.error("[getLogoColorType] Error analyzing logo color:",s),"colored"}}async function Pg(t,e=(n,r)=>console.log(`Logo Progress: ${n}%, Message: ${r||""}`)){var l,c,u,d;if(!t)throw new Error("Store name is required.");const n=new En({apiKey:vl}),r=`Create a modern, clean, and professional logo for an e-commerce store named "${t}". The logo should be suitable for a website header. Avoid text in the logo itself, or if text is present, ensure it is "${t}" and highly legible. Focus on an iconic and memorable design. Generate a square image. The main subject of the logo should be prominent.`;let s="",i=null,o=null;try{console.log("[generateLogoWithGemini] Generating initial logo for:",t),e(void 0,`Generating initial logo for ${t}...`);const h=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Pa,config:{responseModalities:[bn.TEXT,bn.IMAGE]}});if((u=(c=(l=h.candidates)==null?void 0:l[0])==null?void 0:c.content)!=null&&u.parts){for(const _ of h.candidates[0].content.parts)if(_.text)s+=_.text;else if((d=_.inlineData)!=null&&d.data){i=_.inlineData.data,o=_.inlineData.mimeType;break}}if(!i)throw new Error("Failed to generate initial image data. "+(s||"No text explanation."));console.log("[generateLogoWithGemini] Initial logo generated. MimeType:",o);let f=null,m=null,g=i,x=o;if(KI)try{console.log("[generateLogoWithGemini] Removing background."),e(void 0,"Removing logo background..."),g=await r5(i,o),x="image/png",console.log("[generateLogoWithGemini] Background removed."),e(void 0,"Background removed.")}catch(_){console.warn("[generateLogoWithGemini] BG removal failed, using original:",_.message),e(void 0,"Background removal failed.")}const w=await Lae(g,x,n),v=`data:${x};base64,${g}`;if(w==="black"){m=v;try{const _=await Wo(g,x,"Convert this black logo to a white logo, maintaining transparency and all details precisely. Output only the modified image.");if(_.editedImageData)f=`data:${_.newMimeType};base64,${_.editedImageData}`;else throw new Error("Inversion to white failed.")}catch(_){console.warn("[generateLogoWithGemini] Failed to make white version:",_.message),f=v}}else if(w==="white"){f=v;try{const _=await Wo(g,x,"Convert this white logo to a black logo, maintaining transparency and all details precisely. Output only the modified image.");if(_.editedImageData)m=`data:${_.newMimeType};base64,${_.editedImageData}`;else throw new Error("Inversion to black failed.")}catch(_){console.warn("[generateLogoWithGemini] Failed to make black version:",_.message),m=v}}else f=v,m=v;return{logoUrlLight:f,logoUrlDark:m,textResponse:s}}catch(h){throw console.error("[generateLogoWithGemini] Main error:",h.message,h.stack),new Error(`Logo generation failed: ${h.message||"Unknown error"}`)}}async function ca(t,e,n){return console.warn("Skipping image caption generation due to environment limitations."),["Generated image description."]}function Fae(t,e){const n=atob(t),r=new Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return new Blob([new Uint8Array(r)],{type:e})}async function r5(t,e){const n=Fae(t,e),r=new FormData;r.append("size","auto"),r.append("image_file",n,"logo_temp"+(e.startsWith("image/")?"."+e.substring(6):".bin")),r.append("format","png");try{const s=await fetch("https://api.remove.bg/v1.0/removebg",{method:"POST",headers:{"X-Api-Key":KI},body:r});if(!s.ok){const o=await s.text();throw new Error(`Remove.bg API Error ${s.status}: ${o}`)}const i=await s.arrayBuffer();return btoa(new Uint8Array(i).reduce((o,l)=>o+String.fromCharCode(l),""))}catch(s){throw console.error("[removeBackgroundFromLogo] Error:",s.message),s}}async function Wo(t,e,n){var i,o,l,c;if(!t||!e||!n)throw new Error("Image data, MIME type, and prompt required.");const r=new En({apiKey:vl}),s=[{text:n},{inlineData:{mimeType:e,data:t}}];try{const u=await r.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:s,safetySettings:Pa,config:{responseModalities:[bn.TEXT,bn.IMAGE]}});let d=null,h="",f=e;if((l=(o=(i=u.candidates)==null?void 0:i[0])==null?void 0:o.content)!=null&&l.parts){for(const m of u.candidates[0].content.parts)if(m.text)h+=m.text;else if((c=m.inlineData)!=null&&c.data){d=m.inlineData.data,f=m.inlineData.mimeType||e;break}}if(!d)throw new Error("Failed to edit image. "+(h||"No text explanation."));return{editedImageData:d,newMimeType:f,editTextResponse:h}}catch(u){throw console.error("[editImageWithGemini] Error:",u.message),new Error(`Image editing failed: ${u.message||"Unknown error"}`)}}async function s5(t,e){var s,i,o,l;if(!t)throw new Error("Product name required.");const n=new En({apiKey:vl});let r=`Generate a clean, commercial-style product image for "${t}".`;e&&(r+=` Description: "${e}".`),r+=" Main focus on product, simple/neutral/white background for e-commerce. Square image.";try{const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Pa,config:{responseModalities:[bn.TEXT,bn.IMAGE]}});let u=null,d="",h="image/png";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const f of c.candidates[0].content.parts)if(f.text)d+=f.text;else if((l=f.inlineData)!=null&&l.data){u=f.inlineData.data,h=f.inlineData.mimeType||"image/png";break}}if(!u)throw new Error("Failed to generate product image. "+(d||"No text explanation."));if(KI)try{return{imageData:await r5(u,h),textResponse:d}}catch(f){console.warn("[generateGenericProductImageWithGemini] BG removal failed, using original:",f.message)}return{imageData:u,textResponse:d}}catch(c){throw console.error("[generateGenericProductImageWithGemini] Error:",c.message),new Error(`Product image generation failed: ${c.message||"Unknown error"}`)}}async function Ag({prompt:t,referenceImage:e}){var i,o,l,c;if(!t)throw new Error("Prompt required.");const n=new En({apiKey:vl});let r;const s=`Generate visually appealing image/print design to place on a product based on the following user prompt for a store generator: "${t}". Solely the image/design alone that is intended to go on products (canvas, t-shirts, mugs) not the products themselves. Square image.`;e!=null&&e.base64Data&&(e!=null&&e.mimeType)?r=[{text:`Using the provided image as a reference, generate a new image based on the following concept: "${t}". Ensure the output is suitable for print-on-demand merchandise and is a square image.`},{inlineData:{mimeType:e.mimeType,data:e.base64Data}}]:r=s;try{const u=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Pa,config:{responseModalities:[bn.TEXT,bn.IMAGE]}});let d=null,h=null,f="";if((l=(o=(i=u.candidates)==null?void 0:i[0])==null?void 0:o.content)!=null&&l.parts){for(const m of u.candidates[0].content.parts)if(m.text)f+=m.text;else if((c=m.inlineData)!=null&&c.data){d=m.inlineData.data,h=m.inlineData.mimeType;break}}if(!d)throw new Error("Failed to generate image from prompt. "+(f||"No text explanation."));return{imageData:d,imageMimeType:h,textResponse:f}}catch(u){throw console.error("[generateImageFromPromptForPod] Error:",u.message),new Error(`Image generation for POD failed: ${u.message||"Unknown error"}`)}}async function Oae(t){try{const e=await fetch(t);if(!e.ok)throw console.warn(`Direct fetch for ${t} failed with status ${e.status}. Retrying without proxy for now.`),new Error(`Failed to fetch image ${t}: ${e.statusText}`);const n=await e.blob(),r=n.type;if(!r.startsWith("image/"))throw new Error(`Fetched content from ${t} is not an image. MIME type: ${r}`);const s=await n.arrayBuffer();return{base64Data:btoa(new Uint8Array(s).reduce((o,l)=>o+String.fromCharCode(l),"")),mimeType:r}}catch(e){throw console.error(`Error in fetchImageAsBase64 for ${t}:`,e),e}}async function Bp(t,e,n,r,s){var o,l,c,u;if(!t||!e||!n||!r||!s)throw console.error("[visualizeImageOnProductWithGemini] Missing required parameters."),new Error("Missing required parameters for product visualization.");const i=new En({apiKey:vl});try{console.log(`[visualizeImageOnProductWithGemini] Fetching base product image from: ${n}`);const{base64Data:d,mimeType:h}=await Oae(n);console.log(`[visualizeImageOnProductWithGemini] Fetched mockup: ${h}, length: ${d.length}`);const f={inlineData:{mimeType:e,data:t}},m={inlineData:{mimeType:h,data:d}},x=[{text:`You are an expert product visualization AI.
Task: Place the first provided image (the 'design') onto the second provided image (the '${s}' mockup).
Design Details: The design was conceptualized with the idea: "${r}".
Mockup: The mockup is a '${s}'.
Instructions:
1. Realistically superimpose the design onto the mockup.
2. Ensure the design conforms to the shape and texture of the mockup.
3. Maintain the original quality and details of both the design and the mockup where appropriate.
4. Output only the final visualized product image. Do not add any extra text or explanations in the image itself.
`},f,m];console.log(`[visualizeImageOnProductWithGemini] Calling Gemini API for ${s} with prompt: "${r}"`);const w=await i.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:x,safetySettings:Pa,config:{responseModalities:[bn.TEXT,bn.IMAGE]}});let v=null,_=null,C="";if((c=(l=(o=w.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const T of w.candidates[0].content.parts)if(T.text)C+=T.text;else if((u=T.inlineData)!=null&&u.data){v=T.inlineData.data,_=T.inlineData.mimeType;break}}if(console.log(`[visualizeImageOnProductWithGemini] API Text Response: ${C}`),!v)throw console.error("[visualizeImageOnProductWithGemini] Failed to get visualized image data from API.",C),new Error("Failed to visualize product. API did not return image data. "+(C||"No text explanation."));return console.log(`[visualizeImageOnProductWithGemini] Visualization successful for ${s}. MimeType: ${_}`),{visualizedImageData:v,visualizedImageMimeType:_,productDetails:{title:`Custom ${s} (Viz)`,price:24.99,description:`Unique ${s} featuring the design: "${r}".`},apiTextResponse:C}}catch(d){return console.error(`[visualizeImageOnProductWithGemini] Error visualizing ${s}:`,d),{visualizedImageData:null,visualizedImageMimeType:null,productDetails:{title:`Custom ${s}`,price:24.99,description:`Failed to visualize design on ${s}. Error: ${d.message}`},error:d.message}}}async function W0(t,e,n){var o,l,c,u;if(!t||!e||!n)throw new Error("Image data, MIME type, and product name required.");const r=new En({apiKey:vl}),s=[`Show this product, "${n}", from a slightly high front-left angle. Maintain product integrity.`,`Show this product, "${n}", from a direct side view. Maintain product integrity.`,`Show this product, "${n}", from a top-down perspective. Maintain product integrity.`],i=[];try{for(const d of s){const h=[{text:d},{inlineData:{mimeType:e,data:t}}],f=await r.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:h,safetySettings:Pa,config:{responseModalities:[bn.TEXT,bn.IMAGE]}});let m=null;if((c=(l=(o=f.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const g of f.candidates[0].content.parts)if((u=g.inlineData)!=null&&u.data){m=`data:${g.inlineData.mimeType};base64,${g.inlineData.data}`,i.push(m);break}}m||console.warn("[generateDifferentAnglesFromImage] No image data for one angle.")}if(i.length===0)throw new Error("Failed to generate any additional angle images.");return i}catch(d){throw console.error("[generateDifferentAnglesFromImage] Error:",d.message),new Error(`Generating different angles failed: ${d.message||"Unknown error"}`)}}async function i5(t,e){var s,i,o,l;if(!t)throw new Error("Collection name is required to generate an image.");const n=new En({apiKey:vl});let r=`Generate a visually appealing banner image for an e-commerce collection named "${t}".`;e&&(r+=` The collection is described as: "${e}".`),r+=" The image should be thematic or abstract, suitable for a collection header or card. It should evoke the essence of the collection. Consider a wide aspect ratio like 16:9 or a square image if more appropriate for a card.";try{console.log(`[generateCollectionImageWithGemini] Generating image for collection: ${t}`);const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:[{role:"user",parts:[{text:r}]}],safetySettings:Pa,config:{responseModalities:[bn.TEXT,bn.IMAGE]}});let u=null,d="image/png",h="";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const f of c.candidates[0].content.parts)if(f.text)h+=f.text;else if((l=f.inlineData)!=null&&l.data){u=f.inlineData.data,d=f.inlineData.mimeType||d;break}}if(!u)throw new Error("Failed to generate image data for the collection. "+(h||"No text explanation from AI."));return{imageData:u,imageMimeType:d,textResponse:h}}catch(c){throw console.error(`[generateCollectionImageWithGemini] Error generating image for collection "${t}":`,c),new Error(`Collection image generation failed for "${t}": ${c.message||"Unknown error"}`)}}async function o5(t,e=[]){var s,i,o,l;if(!t)throw new Error("Prompt is required.");const n=new En({apiKey:vl}),r=[{text:t}];e.forEach(c=>{r.push({inlineData:{mimeType:c.mimeType,data:c.data}})});try{const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Pa,config:{responseModalities:[bn.TEXT,bn.IMAGE]}});let u=null,d="";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const h of c.candidates[0].content.parts)if(h.text)d+=h.text;else if((l=h.inlineData)!=null&&l.data){u=h.inlineData.data;break}}if(!u)throw new Error(d||"Failed to generate image. No image data returned.");return{imageData:u,text:d}}catch(c){throw console.error("[generateImage] Error:",c.message),new Error(`Image generation failed: ${c.message||"Unknown error"}`)}}async function DE(t,e,n,r=[]){var o,l,c,u;if(!t||!e||!n)throw new Error("Prompt, image data, and MIME type are required.");const s=new En({apiKey:vl}),i=[{text:t},{inlineData:{mimeType:n,data:e}}];r.forEach(d=>{i.push({inlineData:{mimeType:d.mimeType,data:d.data}})});try{const d=await s.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:i,safetySettings:Pa,config:{responseModalities:[bn.TEXT,bn.IMAGE]}});let h=null,f="";if((c=(l=(o=d.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const m of d.candidates[0].content.parts)if(m.text)f+=m.text;else if((u=m.inlineData)!=null&&u.data){h=m.inlineData.data;break}}if(!h)throw new Error(f||"Failed to edit image. No image data returned.");return{imageData:h,text:f}}catch(d){throw console.error("[editImage] Error:",d.message),new Error(`Image editing failed: ${d.message||"Unknown error"}`)}}const Vae=Object.freeze(Object.defineProperty({__proto__:null,editImage:DE,editImageWithGemini:Wo,generateCaptionForImageData:ca,generateCollectionImageWithGemini:i5,generateDifferentAnglesFromImage:W0,generateGenericProductImageWithGemini:s5,generateImage:o5,generateImageFromPromptForPod:Ag,generateLogoWithGemini:Pg,visualizeImageOnProductWithGemini:Bp},Symbol.toStringTag,{value:"Module"})),YI="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s",iw=new En({apiKey:YI}),$ae=async(t,e={})=>{var n,r,s;if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required.");console.log(`Starting video generation with prompt: "${t}"`);try{let i=await iw.models.generateVideos({model:"veo-2.0-generate-001",prompt:t,config:{personGeneration:"dont_allow",aspectRatio:"16:9",numberOfVideos:1,durationSeconds:6,...e}});for(console.log("Video generation operation started:",i.name);!i.done;)console.log(`Polling operation ${i.name}, current status: ${((n=i.metadata)==null?void 0:n.state)||"UNKNOWN"}`),await new Promise(l=>setTimeout(l,1e4)),i=await iw.operations.getVideosOperation({operation:i});if(console.log("Video generation operation completed:",i.name,"Done:",i.done),i.error)throw console.error("Error during video generation operation:",i.error),new Error(`Video generation failed: ${i.error.message||"Unknown error"}`);const o=(r=i.response)==null?void 0:r.generatedVideos;if(o&&o.length>0&&((s=o[0].video)!=null&&s.uri)){const c=`${o[0].video.uri}&key=${YI}`;return console.log("Generated video URI (with key appended):",c),c}else throw console.error("No video URI found in the response:",i.response),new Error("Video generation completed, but no video URI was returned.")}catch(i){throw console.error("Failed to generate video with Veo:",i),i.message&&i.message.includes("Quota")?new Error("Video generation failed due to quota limits. Please check your Google Cloud project quotas."):i.message&&i.message.includes("API key not valid")?new Error("Video generation failed due to an invalid API key. Please check your VITE_GEMINI_API_KEY."):i}},JI=async(t,e,n,r={})=>{var s,i,o;if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required.");if(!e||typeof e!="string")throw new Error("Valid base64 image data string is required.");if(!n||typeof n!="string")throw new Error("Valid image MIME type string is required.");console.log(`Starting image-to-video generation with prompt: "${t}" and image (mimeType: ${n})`);try{const l={model:"veo-2.0-generate-001",prompt:t,image:{imageBytes:e,mimeType:n},config:{personGeneration:"dont_allow",aspectRatio:"16:9",numberOfVideos:1,durationSeconds:6,...r}};console.log("Veo image-to-video payload (excluding imageBytes):",{...l,image:{mimeType:l.image.mimeType,imageBytes:"..."}});let c=await iw.models.generateVideos(l);for(console.log("Image-to-video generation operation started:",c.name);!c.done;)console.log(`Polling operation ${c.name}, current status: ${((s=c.metadata)==null?void 0:s.state)||"UNKNOWN"}`),await new Promise(d=>setTimeout(d,1e4)),c=await iw.operations.getVideosOperation({operation:c});if(console.log("Image-to-video generation operation completed:",c.name,"Done:",c.done),c.error)throw console.error("Error during image-to-video generation operation:",c.error),new Error(`Image-to-video generation failed: ${c.error.message||"Unknown error"}`);const u=(i=c.response)==null?void 0:i.generatedVideos;if(u&&u.length>0&&((o=u[0].video)!=null&&o.uri)){const h=`${u[0].video.uri}&key=${YI}`;return console.log("Generated image-to-video URI (with key appended):",h),h}else throw console.error("No video URI found in the image-to-video response:",c.response),new Error("Image-to-video generation completed, but no video URI was returned.")}catch(l){throw console.error("Failed to generate image-to-video with Veo:",l),l.message&&l.message.includes("Quota")?new Error("Image-to-video generation failed due to quota limits."):l.message&&l.message.includes("API key not valid")?new Error("Image-to-video generation failed due to an invalid API key."):l}},XI=p.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),H0=p.createContext({}),q0=p.createContext(null),K0=typeof document<"u",kg=K0?p.useLayoutEffect:p.useEffect,a5=p.createContext({strict:!1}),QI=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Uae="framerAppearId",l5="data-"+QI(Uae);function Bae(t,e,n,r){const{visualElement:s}=p.useContext(H0),i=p.useContext(a5),o=p.useContext(q0),l=p.useContext(XI).reducedMotion,c=p.useRef();r=r||i.renderer,!c.current&&r&&(c.current=r(t,{visualState:e,parent:s,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current;p.useInsertionEffect(()=>{u&&u.update(n,o)});const d=p.useRef(!!(n[l5]&&!window.HandoffComplete));return kg(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),p.useEffect(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,window.HandoffComplete=!0))}),u}function hh(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function zae(t,e,n){return p.useCallback(r=>{r&&t.mount&&t.mount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):hh(n)&&(n.current=r))},[e])}function zp(t){return typeof t=="string"||Array.isArray(t)}function Y0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const ZI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],eN=["initial",...ZI];function J0(t){return Y0(t.animate)||eN.some(e=>zp(t[e]))}function c5(t){return!!(J0(t)||t.variants)}function Gae(t,e){if(J0(t)){const{initial:n,animate:r}=t;return{initial:n===!1||zp(n)?n:void 0,animate:zp(r)?r:void 0}}return t.inherit!==!1?e:{}}function Wae(t){const{initial:e,animate:n}=Gae(t,p.useContext(H0));return p.useMemo(()=>({initial:e,animate:n}),[O2(e),O2(n)])}function O2(t){return Array.isArray(t)?t.join(" "):t}const V2={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Gp={};for(const t in V2)Gp[t]={isEnabled:e=>V2[t].some(n=>!!e[n])};function Hae(t){for(const e in t)Gp[e]={...Gp[e],...t[e]}}const tN=p.createContext({}),u5=p.createContext({}),qae=Symbol.for("motionComponentSymbol");function Kae({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:s}){t&&Hae(t);function i(l,c){let u;const d={...p.useContext(XI),...l,layoutId:Yae(l)},{isStatic:h}=d,f=Wae(l),m=r(l,h);if(!h&&K0){f.visualElement=Bae(s,m,d,e);const g=p.useContext(u5),x=p.useContext(a5).strict;f.visualElement&&(u=f.visualElement.loadFeatures(d,x,t,g))}return p.createElement(H0.Provider,{value:f},u&&f.visualElement?p.createElement(u,{visualElement:f.visualElement,...d}):null,n(s,l,zae(m,f.visualElement,c),m,h,f.visualElement))}const o=p.forwardRef(i);return o[qae]=s,o}function Yae({layoutId:t}){const e=p.useContext(tN).id;return e&&t!==void 0?e+"-"+t:t}function Jae(t){function e(r,s={}){return Kae(t(r,s))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(r,s)=>(n.has(s)||n.set(s,e(s)),n.get(s))})}const Xae=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function nN(t){return typeof t!="string"||t.includes("-")?!1:!!(Xae.indexOf(t)>-1||/[A-Z]/.test(t))}const ow={};function Qae(t){Object.assign(ow,t)}const Rg=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],hd=new Set(Rg);function d5(t,{layout:e,layoutId:n}){return hd.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!ow[t]||t==="opacity")}const wi=t=>!!(t&&t.getVelocity),Zae={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ele=Rg.length;function tle(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},r,s){let i="";for(let o=0;o<ele;o++){const l=Rg[o];if(t[l]!==void 0){const c=Zae[l]||l;i+=`${c}(${t[l]}) `}}return e&&!t.z&&(i+="translateZ(0)"),i=i.trim(),s?i=s(t,r?"":i):n&&r&&(i="none"),i}const h5=t=>e=>typeof e=="string"&&e.startsWith(t),f5=h5("--"),ME=h5("var(--"),nle=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,rle=(t,e)=>e&&typeof t=="number"?e.transform(t):t,bc=(t,e,n)=>Math.min(Math.max(n,t),e),fd={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Jm={...fd,transform:t=>bc(0,1,t)},Yy={...fd,default:1},Xm=t=>Math.round(t*1e5)/1e5,X0=/(-)?([\d]*\.?[\d])+/g,m5=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,sle=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function jg(t){return typeof t=="string"}const Dg=t=>({test:e=>jg(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Dl=Dg("deg"),va=Dg("%"),Ut=Dg("px"),ile=Dg("vh"),ole=Dg("vw"),$2={...va,parse:t=>va.parse(t)/100,transform:t=>va.transform(t*100)},U2={...fd,transform:Math.round},p5={borderWidth:Ut,borderTopWidth:Ut,borderRightWidth:Ut,borderBottomWidth:Ut,borderLeftWidth:Ut,borderRadius:Ut,radius:Ut,borderTopLeftRadius:Ut,borderTopRightRadius:Ut,borderBottomRightRadius:Ut,borderBottomLeftRadius:Ut,width:Ut,maxWidth:Ut,height:Ut,maxHeight:Ut,size:Ut,top:Ut,right:Ut,bottom:Ut,left:Ut,padding:Ut,paddingTop:Ut,paddingRight:Ut,paddingBottom:Ut,paddingLeft:Ut,margin:Ut,marginTop:Ut,marginRight:Ut,marginBottom:Ut,marginLeft:Ut,rotate:Dl,rotateX:Dl,rotateY:Dl,rotateZ:Dl,scale:Yy,scaleX:Yy,scaleY:Yy,scaleZ:Yy,skew:Dl,skewX:Dl,skewY:Dl,distance:Ut,translateX:Ut,translateY:Ut,translateZ:Ut,x:Ut,y:Ut,z:Ut,perspective:Ut,transformPerspective:Ut,opacity:Jm,originX:$2,originY:$2,originZ:Ut,zIndex:U2,fillOpacity:Jm,strokeOpacity:Jm,numOctaves:U2};function rN(t,e,n,r){const{style:s,vars:i,transform:o,transformOrigin:l}=t;let c=!1,u=!1,d=!0;for(const h in e){const f=e[h];if(f5(h)){i[h]=f;continue}const m=p5[h],g=rle(f,m);if(hd.has(h)){if(c=!0,o[h]=g,!d)continue;f!==(m.default||0)&&(d=!1)}else h.startsWith("origin")?(u=!0,l[h]=g):s[h]=g}if(e.transform||(c||r?s.transform=tle(t.transform,n,d,r):s.transform&&(s.transform="none")),u){const{originX:h="50%",originY:f="50%",originZ:m=0}=l;s.transformOrigin=`${h} ${f} ${m}`}}const sN=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function g5(t,e,n){for(const r in e)!wi(e[r])&&!d5(r,n)&&(t[r]=e[r])}function ale({transformTemplate:t},e,n){return p.useMemo(()=>{const r=sN();return rN(r,e,{enableHardwareAcceleration:!n},t),Object.assign({},r.vars,r.style)},[e])}function lle(t,e,n){const r=t.style||{},s={};return g5(s,r,t),Object.assign(s,ale(t,e,n)),t.transformValues?t.transformValues(s):s}function cle(t,e,n){const r={},s=lle(t,e,n);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=s,r}const ule=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function aw(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||ule.has(t)}let y5=t=>!aw(t);function dle(t){t&&(y5=e=>e.startsWith("on")?!aw(e):t(e))}try{dle(require("@emotion/is-prop-valid").default)}catch{}function hle(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(y5(s)||n===!0&&aw(s)||!e&&!aw(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}function B2(t,e,n){return typeof t=="string"?t:Ut.transform(e+n*t)}function fle(t,e,n){const r=B2(e,t.x,t.width),s=B2(n,t.y,t.height);return`${r} ${s}`}const mle={offset:"stroke-dashoffset",array:"stroke-dasharray"},ple={offset:"strokeDashoffset",array:"strokeDasharray"};function gle(t,e,n=1,r=0,s=!0){t.pathLength=1;const i=s?mle:ple;t[i.offset]=Ut.transform(-r);const o=Ut.transform(e),l=Ut.transform(n);t[i.array]=`${o} ${l}`}function iN(t,{attrX:e,attrY:n,attrScale:r,originX:s,originY:i,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...u},d,h,f){if(rN(t,u,d,f),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:g,dimensions:x}=t;m.transform&&(x&&(g.transform=m.transform),delete m.transform),x&&(s!==void 0||i!==void 0||g.transform)&&(g.transformOrigin=fle(x,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(m.x=e),n!==void 0&&(m.y=n),r!==void 0&&(m.scale=r),o!==void 0&&gle(m,o,l,c,!1)}const x5=()=>({...sN(),attrs:{}}),oN=t=>typeof t=="string"&&t.toLowerCase()==="svg";function yle(t,e,n,r){const s=p.useMemo(()=>{const i=x5();return iN(i,e,{enableHardwareAcceleration:!1},oN(r),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};g5(i,t.style,t),s.style={...i,...s.style}}return s}function xle(t=!1){return(n,r,s,{latestValues:i},o)=>{const c=(nN(n)?yle:cle)(r,i,o,n),d={...hle(r,typeof n=="string",t),...c,ref:s},{children:h}=r,f=p.useMemo(()=>wi(h)?h.get():h,[h]);return p.createElement(n,{...d,children:f})}}function v5(t,{style:e,vars:n},r,s){Object.assign(t.style,e,s&&s.getProjectionStyles(r));for(const i in n)t.style.setProperty(i,n[i])}const w5=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function b5(t,e,n,r){v5(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(w5.has(s)?s:QI(s),e.attrs[s])}function aN(t,e){const{style:n}=t,r={};for(const s in n)(wi(n[s])||e.style&&wi(e.style[s])||d5(s,t))&&(r[s]=n[s]);return r}function _5(t,e){const n=aN(t,e);for(const r in t)if(wi(t[r])||wi(e[r])){const s=Rg.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[s]=t[r]}return n}function lN(t,e,n,r={},s={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),e}function Mg(t){const e=p.useRef(null);return e.current===null&&(e.current=t()),e.current}const lw=t=>Array.isArray(t),vle=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),wle=t=>lw(t)?t[t.length-1]||0:t;function Wx(t){const e=wi(t)?t.get():t;return vle(e)?e.toValue():e}function ble({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},r,s,i){const o={latestValues:_le(r,s,i,t),renderState:e()};return n&&(o.mount=l=>n(r,l,o)),o}const S5=t=>(e,n)=>{const r=p.useContext(H0),s=p.useContext(q0),i=()=>ble(t,e,r,s);return n?i():Mg(i)};function _le(t,e,n,r){const s={},i=r(t,{});for(const f in i)s[f]=Wx(i[f]);let{initial:o,animate:l}=t;const c=J0(t),u=c5(t);e&&u&&!c&&t.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let d=n?n.initial===!1:!1;d=d||o===!1;const h=d?l:o;return h&&typeof h!="boolean"&&!Y0(h)&&(Array.isArray(h)?h:[h]).forEach(m=>{const g=lN(t,m);if(!g)return;const{transitionEnd:x,transition:w,...v}=g;for(const _ in v){let C=v[_];if(Array.isArray(C)){const T=d?C.length-1:0;C=C[T]}C!==null&&(s[_]=C)}for(const _ in x)s[_]=x[_]}),s}const Ir=t=>t;class z2{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function Sle(t){let e=new z2,n=new z2,r=0,s=!1,i=!1;const o=new WeakSet,l={schedule:(c,u=!1,d=!1)=>{const h=d&&s,f=h?e:n;return u&&o.add(c),f.add(c)&&h&&s&&(r=e.order.length),c},cancel:c=>{n.remove(c),o.delete(c)},process:c=>{if(s){i=!0;return}if(s=!0,[e,n]=[n,e],n.clear(),r=e.order.length,r)for(let u=0;u<r;u++){const d=e.order[u];d(c),o.has(d)&&(l.schedule(d),t())}s=!1,i&&(i=!1,l.process(c))}};return l}const Jy=["prepare","read","update","preRender","render","postRender"],Cle=40;function Ele(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=Jy.reduce((h,f)=>(h[f]=Sle(()=>n=!0),h),{}),o=h=>i[h].process(s),l=()=>{const h=performance.now();n=!1,s.delta=r?1e3/60:Math.max(Math.min(h-s.timestamp,Cle),1),s.timestamp=h,s.isProcessing=!0,Jy.forEach(o),s.isProcessing=!1,n&&e&&(r=!1,t(l))},c=()=>{n=!0,r=!0,s.isProcessing||t(l)};return{schedule:Jy.reduce((h,f)=>{const m=i[f];return h[f]=(g,x=!1,w=!1)=>(n||c(),m.schedule(g,x,w)),h},{}),cancel:h=>Jy.forEach(f=>i[f].cancel(h)),state:s,steps:i}}const{schedule:Cn,cancel:Ho,state:hs,steps:oS}=Ele(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ir,!0),Tle={useVisualState:S5({scrapeMotionValuesFromProps:_5,createRenderState:x5,onMount:(t,e,{renderState:n,latestValues:r})=>{Cn.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),Cn.render(()=>{iN(n,r,{enableHardwareAcceleration:!1},oN(e.tagName),t.transformTemplate),b5(e,n)})}})},Ile={useVisualState:S5({scrapeMotionValuesFromProps:aN,createRenderState:sN})};function Nle(t,{forwardMotionProps:e=!1},n,r){return{...nN(t)?Tle:Ile,preloadedFeatures:n,useRender:xle(e),createVisualElement:r,Component:t}}function za(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const C5=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function Q0(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const Ple=t=>e=>C5(e)&&t(e,Q0(e));function Ya(t,e,n,r){return za(t,e,Ple(n),r)}const Ale=(t,e)=>n=>e(t(n)),ac=(...t)=>t.reduce(Ale);function E5(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const G2=E5("dragHorizontal"),W2=E5("dragVertical");function T5(t){let e=!1;if(t==="y")e=W2();else if(t==="x")e=G2();else{const n=G2(),r=W2();n&&r?e=()=>{n(),r()}:(n&&n(),r&&r())}return e}function I5(){const t=T5(!0);return t?(t(),!1):!0}class Vc{constructor(e){this.isMounted=!1,this.node=e}update(){}}function H2(t,e){const n="pointer"+(e?"enter":"leave"),r="onHover"+(e?"Start":"End"),s=(i,o)=>{if(i.pointerType==="touch"||I5())return;const l=t.getProps();t.animationState&&l.whileHover&&t.animationState.setActive("whileHover",e),l[r]&&Cn.update(()=>l[r](i,o))};return Ya(t.current,n,s,{passive:!t.getProps()[r]})}class kle extends Vc{mount(){this.unmount=ac(H2(this.node,!0),H2(this.node,!1))}unmount(){}}class Rle extends Vc{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ac(za(this.node.current,"focus",()=>this.onFocus()),za(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const N5=(t,e)=>e?t===e?!0:N5(t,e.parentElement):!1;function aS(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,Q0(n))}class jle extends Vc{constructor(){super(...arguments),this.removeStartListeners=Ir,this.removeEndListeners=Ir,this.removeAccessibleListeners=Ir,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const r=this.node.getProps(),i=Ya(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:d,globalTapTarget:h}=this.node.getProps();Cn.update(()=>{!h&&!N5(this.node.current,l.target)?d&&d(l,c):u&&u(l,c)})},{passive:!(r.onTap||r.onPointerUp)}),o=Ya(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=ac(i,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=l=>{l.key!=="Enter"||!this.checkPressEnd()||aS("up",(c,u)=>{const{onTap:d}=this.node.getProps();d&&Cn.update(()=>d(c,u))})};this.removeEndListeners(),this.removeEndListeners=za(this.node.current,"keyup",o),aS("down",(l,c)=>{this.startPress(l,c)})},n=za(this.node.current,"keydown",e),r=()=>{this.isPressing&&aS("cancel",(i,o)=>this.cancelPress(i,o))},s=za(this.node.current,"blur",r);this.removeAccessibleListeners=ac(n,s)}}startPress(e,n){this.isPressing=!0;const{onTapStart:r,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&Cn.update(()=>r(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!I5()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&Cn.update(()=>r(e,n))}mount(){const e=this.node.getProps(),n=Ya(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),r=za(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=ac(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const LE=new WeakMap,lS=new WeakMap,Dle=t=>{const e=LE.get(t.target);e&&e(t)},Mle=t=>{t.forEach(Dle)};function Lle({root:t,...e}){const n=t||document;lS.has(n)||lS.set(n,{});const r=lS.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(Mle,{root:t,...e})),r[s]}function Fle(t,e,n){const r=Lle(e);return LE.set(t,n),r.observe(t),()=>{LE.delete(t),r.unobserve(t)}}const Ole={some:0,all:1};class Vle extends Vc{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:Ole[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:h}=this.node.getProps(),f=u?d:h;f&&f(c)};return Fle(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some($le(e,n))&&this.startObserver()}unmount(){}}function $le({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const Ule={inView:{Feature:Vle},tap:{Feature:jle},focus:{Feature:Rle},hover:{Feature:kle}};function P5(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function Ble(t){const e={};return t.values.forEach((n,r)=>e[r]=n.get()),e}function zle(t){const e={};return t.values.forEach((n,r)=>e[r]=n.getVelocity()),e}function Z0(t,e,n){const r=t.getProps();return lN(r,e,n!==void 0?n:r.custom,Ble(t),zle(t))}let A5=Ir,eb=Ir;const lc=t=>t*1e3,Ja=t=>t/1e3,Gle={current:!1},k5=t=>Array.isArray(t)&&typeof t[0]=="number";function R5(t){return!!(!t||typeof t=="string"&&j5[t]||k5(t)||Array.isArray(t)&&t.every(R5))}const _m=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,j5={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:_m([0,.65,.55,1]),circOut:_m([.55,0,1,.45]),backIn:_m([.31,.01,.66,-.59]),backOut:_m([.33,1.53,.69,.99])};function D5(t){if(t)return k5(t)?_m(t):Array.isArray(t)?t.map(D5):j5[t]}function Wle(t,e,n,{delay:r=0,duration:s,repeat:i=0,repeatType:o="loop",ease:l,times:c}={}){const u={[e]:n};c&&(u.offset=c);const d=D5(l);return Array.isArray(d)&&(u.easing=d),t.animate(u,{delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function Hle(t,{repeat:e,repeatType:n="loop"}){const r=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[r]}const M5=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,qle=1e-7,Kle=12;function Yle(t,e,n,r,s){let i,o,l=0;do o=e+(n-e)/2,i=M5(o,r,s)-t,i>0?n=o:e=o;while(Math.abs(i)>qle&&++l<Kle);return o}function Lg(t,e,n,r){if(t===e&&n===r)return Ir;const s=i=>Yle(i,0,1,t,n);return i=>i===0||i===1?i:M5(s(i),e,r)}const Jle=Lg(.42,0,1,1),Xle=Lg(0,0,.58,1),L5=Lg(.42,0,.58,1),Qle=t=>Array.isArray(t)&&typeof t[0]!="number",F5=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,O5=t=>e=>1-t(1-e),cN=t=>1-Math.sin(Math.acos(t)),V5=O5(cN),Zle=F5(cN),$5=Lg(.33,1.53,.69,.99),uN=O5($5),ece=F5(uN),tce=t=>(t*=2)<1?.5*uN(t):.5*(2-Math.pow(2,-10*(t-1))),nce={linear:Ir,easeIn:Jle,easeInOut:L5,easeOut:Xle,circIn:cN,circInOut:Zle,circOut:V5,backIn:uN,backInOut:ece,backOut:$5,anticipate:tce},q2=t=>{if(Array.isArray(t)){eb(t.length===4);const[e,n,r,s]=t;return Lg(e,n,r,s)}else if(typeof t=="string")return nce[t];return t},dN=(t,e)=>n=>!!(jg(n)&&sle.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),U5=(t,e,n)=>r=>{if(!jg(r))return r;const[s,i,o,l]=r.match(X0);return{[t]:parseFloat(s),[e]:parseFloat(i),[n]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},rce=t=>bc(0,255,t),cS={...fd,transform:t=>Math.round(rce(t))},Pu={test:dN("rgb","red"),parse:U5("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+cS.transform(t)+", "+cS.transform(e)+", "+cS.transform(n)+", "+Xm(Jm.transform(r))+")"};function sce(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const FE={test:dN("#"),parse:sce,transform:Pu.transform},fh={test:dN("hsl","hue"),parse:U5("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+va.transform(Xm(e))+", "+va.transform(Xm(n))+", "+Xm(Jm.transform(r))+")"},Hs={test:t=>Pu.test(t)||FE.test(t)||fh.test(t),parse:t=>Pu.test(t)?Pu.parse(t):fh.test(t)?fh.parse(t):FE.parse(t),transform:t=>jg(t)?t:t.hasOwnProperty("red")?Pu.transform(t):fh.transform(t)},xr=(t,e,n)=>-n*t+n*e+t;function uS(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function ice({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,i=0,o=0;if(!e)s=i=o=n;else{const l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;s=uS(c,l,t+1/3),i=uS(c,l,t),o=uS(c,l,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}const dS=(t,e,n)=>{const r=t*t;return Math.sqrt(Math.max(0,n*(e*e-r)+r))},oce=[FE,Pu,fh],ace=t=>oce.find(e=>e.test(t));function K2(t){const e=ace(t);let n=e.parse(t);return e===fh&&(n=ice(n)),n}const B5=(t,e)=>{const n=K2(t),r=K2(e),s={...n};return i=>(s.red=dS(n.red,r.red,i),s.green=dS(n.green,r.green,i),s.blue=dS(n.blue,r.blue,i),s.alpha=xr(n.alpha,r.alpha,i),Pu.transform(s))};function lce(t){var e,n;return isNaN(t)&&jg(t)&&(((e=t.match(X0))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(m5))===null||n===void 0?void 0:n.length)||0)>0}const z5={regex:nle,countKey:"Vars",token:"${v}",parse:Ir},G5={regex:m5,countKey:"Colors",token:"${c}",parse:Hs.parse},W5={regex:X0,countKey:"Numbers",token:"${n}",parse:fd.parse};function hS(t,{regex:e,countKey:n,token:r,parse:s}){const i=t.tokenised.match(e);i&&(t["num"+n]=i.length,t.tokenised=t.tokenised.replace(e,r),t.values.push(...i.map(s)))}function cw(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&hS(n,z5),hS(n,G5),hS(n,W5),n}function H5(t){return cw(t).values}function q5(t){const{values:e,numColors:n,numVars:r,tokenised:s}=cw(t),i=e.length;return o=>{let l=s;for(let c=0;c<i;c++)c<r?l=l.replace(z5.token,o[c]):c<r+n?l=l.replace(G5.token,Hs.transform(o[c])):l=l.replace(W5.token,Xm(o[c]));return l}}const cce=t=>typeof t=="number"?0:t;function uce(t){const e=H5(t);return q5(t)(e.map(cce))}const _c={test:lce,parse:H5,createTransformer:q5,getAnimatableNone:uce},K5=(t,e)=>n=>`${n>0?e:t}`;function Y5(t,e){return typeof t=="number"?n=>xr(t,e,n):Hs.test(t)?B5(t,e):t.startsWith("var(")?K5(t,e):X5(t,e)}const J5=(t,e)=>{const n=[...t],r=n.length,s=t.map((i,o)=>Y5(i,e[o]));return i=>{for(let o=0;o<r;o++)n[o]=s[o](i);return n}},dce=(t,e)=>{const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=Y5(t[s],e[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}},X5=(t,e)=>{const n=_c.createTransformer(e),r=cw(t),s=cw(e);return r.numVars===s.numVars&&r.numColors===s.numColors&&r.numNumbers>=s.numNumbers?ac(J5(r.values,s.values),n):K5(t,e)},Xh=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},Y2=(t,e)=>n=>xr(t,e,n);function hce(t){return typeof t=="number"?Y2:typeof t=="string"?Hs.test(t)?B5:X5:Array.isArray(t)?J5:typeof t=="object"?dce:Y2}function fce(t,e,n){const r=[],s=n||hce(t[0]),i=t.length-1;for(let o=0;o<i;o++){let l=s(t[o],t[o+1]);if(e){const c=Array.isArray(e)?e[o]||Ir:e;l=ac(c,l)}r.push(l)}return r}function tb(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const i=t.length;if(eb(i===e.length),i===1)return()=>e[0];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=fce(e,r,s),l=o.length,c=u=>{let d=0;if(l>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const h=Xh(t[d],t[d+1],u);return o[d](h)};return n?u=>c(bc(t[0],t[i-1],u)):c}function mce(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=Xh(0,e,r);t.push(xr(n,1,s))}}function Q5(t){const e=[0];return mce(e,t.length-1),e}function pce(t,e){return t.map(n=>n*e)}function gce(t,e){return t.map(()=>e||L5).splice(0,t.length-1)}function uw({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=Qle(r)?r.map(q2):q2(r),i={done:!1,value:e[0]},o=pce(n&&n.length===e.length?n:Q5(e),t),l=tb(o,e,{ease:Array.isArray(s)?s:gce(e,s)});return{calculatedDuration:t,next:c=>(i.value=l(c),i.done=c>=t,i)}}function hN(t,e){return e?t*(1e3/e):0}const yce=5;function Z5(t,e,n){const r=Math.max(e-yce,0);return hN(n-t(r),e-r)}const fS=.001,xce=.01,J2=10,vce=.05,wce=1;function bce({duration:t=800,bounce:e=.25,velocity:n=0,mass:r=1}){let s,i;A5(t<=lc(J2));let o=1-e;o=bc(vce,wce,o),t=bc(xce,J2,Ja(t)),o<1?(s=u=>{const d=u*o,h=d*t,f=d-n,m=OE(u,o),g=Math.exp(-h);return fS-f/m*g},i=u=>{const h=u*o*t,f=h*n+n,m=Math.pow(o,2)*Math.pow(u,2)*t,g=Math.exp(-h),x=OE(Math.pow(u,2),o);return(-s(u)+fS>0?-1:1)*((f-m)*g)/x}):(s=u=>{const d=Math.exp(-u*t),h=(u-n)*t+1;return-fS+d*h},i=u=>{const d=Math.exp(-u*t),h=(n-u)*(t*t);return d*h});const l=5/t,c=Sce(s,i,l);if(t=lc(t),isNaN(c))return{stiffness:100,damping:10,duration:t};{const u=Math.pow(c,2)*r;return{stiffness:u,damping:o*2*Math.sqrt(r*u),duration:t}}}const _ce=12;function Sce(t,e,n){let r=n;for(let s=1;s<_ce;s++)r=r-t(r)/e(r);return r}function OE(t,e){return t*Math.sqrt(1-e*e)}const Cce=["duration","bounce"],Ece=["stiffness","damping","mass"];function X2(t,e){return e.some(n=>t[n]!==void 0)}function Tce(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!X2(t,Ece)&&X2(t,Cce)){const n=bce(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function e6({keyframes:t,restDelta:e,restSpeed:n,...r}){const s=t[0],i=t[t.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:f}=Tce({...r,velocity:-Ja(r.velocity||0)}),m=h||0,g=c/(2*Math.sqrt(l*u)),x=i-s,w=Ja(Math.sqrt(l/u)),v=Math.abs(x)<5;n||(n=v?.01:2),e||(e=v?.005:.5);let _;if(g<1){const C=OE(w,g);_=T=>{const R=Math.exp(-g*w*T);return i-R*((m+g*w*x)/C*Math.sin(C*T)+x*Math.cos(C*T))}}else if(g===1)_=C=>i-Math.exp(-w*C)*(x+(m+w*x)*C);else{const C=w*Math.sqrt(g*g-1);_=T=>{const R=Math.exp(-g*w*T),A=Math.min(C*T,300);return i-R*((m+g*w*x)*Math.sinh(A)+C*x*Math.cosh(A))/C}}return{calculatedDuration:f&&d||null,next:C=>{const T=_(C);if(f)o.done=C>=d;else{let R=m;C!==0&&(g<1?R=Z5(_,C,T):R=0);const A=Math.abs(R)<=n,E=Math.abs(i-T)<=e;o.done=A&&E}return o.value=o.done?i:T,o}}}function Q2({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:c,restDelta:u=.5,restSpeed:d}){const h=t[0],f={done:!1,value:h},m=I=>l!==void 0&&I<l||c!==void 0&&I>c,g=I=>l===void 0?c:c===void 0||Math.abs(l-I)<Math.abs(c-I)?l:c;let x=n*e;const w=h+x,v=o===void 0?w:o(w);v!==w&&(x=v-h);const _=I=>-x*Math.exp(-I/r),C=I=>v+_(I),T=I=>{const P=_(I),k=C(I);f.done=Math.abs(P)<=u,f.value=f.done?v:k};let R,A;const E=I=>{m(f.value)&&(R=I,A=e6({keyframes:[f.value,g(f.value)],velocity:Z5(C,I,f.value),damping:s,stiffness:i,restDelta:u,restSpeed:d}))};return E(0),{calculatedDuration:null,next:I=>{let P=!1;return!A&&R===void 0&&(P=!0,T(I),E(I)),R!==void 0&&I>R?A.next(I-R):(!P&&T(I),f)}}}const Ice=t=>{const e=({timestamp:n})=>t(n);return{start:()=>Cn.update(e,!0),stop:()=>Ho(e),now:()=>hs.isProcessing?hs.timestamp:performance.now()}},Z2=2e4;function eD(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<Z2;)e+=n,r=t.next(e);return e>=Z2?1/0:e}const Nce={decay:Q2,inertia:Q2,tween:uw,keyframes:uw,spring:e6};function dw({autoplay:t=!0,delay:e=0,driver:n=Ice,keyframes:r,type:s="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:l="loop",onPlay:c,onStop:u,onComplete:d,onUpdate:h,...f}){let m=1,g=!1,x,w;const v=()=>{w=new Promise($=>{x=$})};v();let _;const C=Nce[s]||uw;let T;C!==uw&&typeof r[0]!="number"&&(T=tb([0,100],r,{clamp:!1}),r=[0,100]);const R=C({...f,keyframes:r});let A;l==="mirror"&&(A=C({...f,keyframes:[...r].reverse(),velocity:-(f.velocity||0)}));let E="idle",I=null,P=null,k=null;R.calculatedDuration===null&&i&&(R.calculatedDuration=eD(R));const{calculatedDuration:j}=R;let D=1/0,M=1/0;j!==null&&(D=j+o,M=D*(i+1)-o);let G=0;const B=$=>{if(P===null)return;m>0&&(P=Math.min(P,$)),m<0&&(P=Math.min($-M/m,P)),I!==null?G=I:G=Math.round($-P)*m;const z=G-e*(m>=0?1:-1),F=m>=0?z<0:z>M;G=Math.max(z,0),E==="finished"&&I===null&&(G=M);let Z=G,fe=R;if(i){const Ue=Math.min(G,M)/D;let ze=Math.floor(Ue),he=Ue%1;!he&&Ue>=1&&(he=1),he===1&&ze--,ze=Math.min(ze,i+1),!!(ze%2)&&(l==="reverse"?(he=1-he,o&&(he-=o/D)):l==="mirror"&&(fe=A)),Z=bc(0,1,he)*D}const xe=F?{done:!1,value:r[0]}:fe.next(Z);T&&(xe.value=T(xe.value));let{done:ge}=xe;!F&&j!==null&&(ge=m>=0?G>=M:G<=0);const Re=I===null&&(E==="finished"||E==="running"&&ge);return h&&h(xe.value),Re&&H(),xe},W=()=>{_&&_.stop(),_=void 0},Q=()=>{E="idle",W(),x(),v(),P=k=null},H=()=>{E="finished",d&&d(),W(),x()},Y=()=>{if(g)return;_||(_=n(B));const $=_.now();c&&c(),I!==null?P=$-I:(!P||E==="finished")&&(P=$),E==="finished"&&v(),k=P,I=null,E="running",_.start()};t&&Y();const V={then($,z){return w.then($,z)},get time(){return Ja(G)},set time($){$=lc($),G=$,I!==null||!_||m===0?I=$:P=_.now()-$/m},get duration(){const $=R.calculatedDuration===null?eD(R):R.calculatedDuration;return Ja($)},get speed(){return m},set speed($){$===m||!_||(m=$,V.time=Ja(G))},get state(){return E},play:Y,pause:()=>{E="paused",I=G},stop:()=>{g=!0,E!=="idle"&&(E="idle",u&&u(),Q())},cancel:()=>{k!==null&&B(k),Q()},complete:()=>{E="finished"},sample:$=>(P=0,B($))};return V}function Pce(t){let e;return()=>(e===void 0&&(e=t()),e)}const Ace=Pce(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),kce=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Xy=10,Rce=2e4,jce=(t,e)=>e.type==="spring"||t==="backgroundColor"||!R5(e.ease);function Dce(t,e,{onUpdate:n,onComplete:r,...s}){if(!(Ace()&&kce.has(e)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let o=!1,l,c,u=!1;const d=()=>{c=new Promise(C=>{l=C})};d();let{keyframes:h,duration:f=300,ease:m,times:g}=s;if(jce(e,s)){const C=dw({...s,repeat:0,delay:0});let T={done:!1,value:h[0]};const R=[];let A=0;for(;!T.done&&A<Rce;)T=C.sample(A),R.push(T.value),A+=Xy;g=void 0,h=R,f=A-Xy,m="linear"}const x=Wle(t.owner.current,e,h,{...s,duration:f,ease:m,times:g}),w=()=>{u=!1,x.cancel()},v=()=>{u=!0,Cn.update(w),l(),d()};return x.onfinish=()=>{u||(t.set(Hle(h,s)),r&&r(),v())},{then(C,T){return c.then(C,T)},attachTimeline(C){return x.timeline=C,x.onfinish=null,Ir},get time(){return Ja(x.currentTime||0)},set time(C){x.currentTime=lc(C)},get speed(){return x.playbackRate},set speed(C){x.playbackRate=C},get duration(){return Ja(f)},play:()=>{o||(x.play(),Ho(w))},pause:()=>x.pause(),stop:()=>{if(o=!0,x.playState==="idle")return;const{currentTime:C}=x;if(C){const T=dw({...s,autoplay:!1});t.setWithVelocity(T.sample(C-Xy).value,T.sample(C).value,Xy)}v()},complete:()=>{u||x.finish()},cancel:v}}function Mce({keyframes:t,delay:e,onUpdate:n,onComplete:r}){const s=()=>(n&&n(t[t.length-1]),r&&r(),{time:0,speed:1,duration:0,play:Ir,pause:Ir,stop:Ir,then:i=>(i(),Promise.resolve()),cancel:Ir,complete:Ir});return e?dw({keyframes:[0,1],duration:0,delay:e,onComplete:s}):s()}const Lce={type:"spring",stiffness:500,damping:25,restSpeed:10},Fce=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Oce={type:"keyframes",duration:.8},Vce={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},$ce=(t,{keyframes:e})=>e.length>2?Oce:hd.has(t)?t.startsWith("scale")?Fce(e[1]):Lce:Vce,VE=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(_c.test(e)||e==="0")&&!e.startsWith("url(")),Uce=new Set(["brightness","contrast","saturate","opacity"]);function Bce(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(X0)||[];if(!r)return t;const s=n.replace(r,"");let i=Uce.has(e)?1:0;return r!==n&&(i*=100),e+"("+i+s+")"}const zce=/([a-z-]*)\(.*?\)/g,$E={..._c,getAnimatableNone:t=>{const e=t.match(zce);return e?e.map(Bce).join(" "):t}},Gce={...p5,color:Hs,backgroundColor:Hs,outlineColor:Hs,fill:Hs,stroke:Hs,borderColor:Hs,borderTopColor:Hs,borderRightColor:Hs,borderBottomColor:Hs,borderLeftColor:Hs,filter:$E,WebkitFilter:$E},fN=t=>Gce[t];function t6(t,e){let n=fN(t);return n!==$E&&(n=_c),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const n6=t=>/^0[^.\s]+$/.test(t);function Wce(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||n6(t)}function Hce(t,e,n,r){const s=VE(e,n);let i;Array.isArray(n)?i=[...n]:i=[null,n];const o=r.from!==void 0?r.from:t.get();let l;const c=[];for(let u=0;u<i.length;u++)i[u]===null&&(i[u]=u===0?o:i[u-1]),Wce(i[u])&&c.push(u),typeof i[u]=="string"&&i[u]!=="none"&&i[u]!=="0"&&(l=i[u]);if(s&&c.length&&l)for(let u=0;u<c.length;u++){const d=c[u];i[d]=t6(e,l)}return i}function qce({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}function mN(t,e){return t[e]||t.default||t}const Kce={skipAnimations:!1},pN=(t,e,n,r={})=>s=>{const i=mN(r,t)||{},o=i.delay||r.delay||0;let{elapsed:l=0}=r;l=l-lc(o);const c=Hce(e,t,n,i),u=c[0],d=c[c.length-1],h=VE(t,u),f=VE(t,d);let m={keyframes:c,velocity:e.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:g=>{e.set(g),i.onUpdate&&i.onUpdate(g)},onComplete:()=>{s(),i.onComplete&&i.onComplete()}};if(qce(i)||(m={...m,...$ce(t,m)}),m.duration&&(m.duration=lc(m.duration)),m.repeatDelay&&(m.repeatDelay=lc(m.repeatDelay)),!h||!f||Gle.current||i.type===!1||Kce.skipAnimations)return Mce(m);if(!r.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const g=Dce(e,t,m);if(g)return g}return dw(m)};function hw(t){return!!(wi(t)&&t.add)}const r6=t=>/^\-?\d*\.?\d+$/.test(t);function gN(t,e){t.indexOf(e)===-1&&t.push(e)}function yN(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class xN{constructor(){this.subscriptions=[]}add(e){return gN(this.subscriptions,e),()=>yN(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Yce=t=>!isNaN(parseFloat(t)),Qm={current:void 0};class Jce{constructor(e,n={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(r,s=!0)=>{this.prev=this.current,this.current=r;const{delta:i,timestamp:o}=hs;this.lastUpdated!==o&&(this.timeDelta=i,this.lastUpdated=o,Cn.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Cn.postRender(this.velocityCheck),this.velocityCheck=({timestamp:r})=>{r!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=Yce(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new xN);const r=this.events[e].add(n);return e==="change"?()=>{r(),Cn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=e,this.timeDelta=r}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return Qm.current&&Qm.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?hN(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Mo(t,e){return new Jce(t,e)}const s6=t=>e=>e.test(t),Xce={test:t=>t==="auto",parse:t=>t},i6=[fd,Ut,va,Dl,ole,ile,Xce],nm=t=>i6.find(s6(t)),Qce=[...i6,Hs,_c],Zce=t=>Qce.find(s6(t));function eue(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Mo(n))}function tue(t,e){const n=Z0(t,e);let{transitionEnd:r={},transition:s={},...i}=n?t.makeTargetAnimatable(n,!1):{};i={...i,...r};for(const o in i){const l=wle(i[o]);eue(t,o,l)}}function nue(t,e,n){var r,s;const i=Object.keys(e).filter(l=>!t.hasValue(l)),o=i.length;if(o)for(let l=0;l<o;l++){const c=i[l],u=e[c];let d=null;Array.isArray(u)&&(d=u[0]),d===null&&(d=(s=(r=n[c])!==null&&r!==void 0?r:t.readValue(c))!==null&&s!==void 0?s:e[c]),d!=null&&(typeof d=="string"&&(r6(d)||n6(d))?d=parseFloat(d):!Zce(d)&&_c.test(u)&&(d=t6(c,u)),t.addValue(c,Mo(d,{owner:t})),n[c]===void 0&&(n[c]=d),d!==null&&t.setBaseTarget(c,d))}}function rue(t,e){return e?(e[t]||e.default||e).from:void 0}function sue(t,e,n){const r={};for(const s in t){const i=rue(s,e);if(i!==void 0)r[s]=i;else{const o=n.getValue(s);o&&(r[s]=o.get())}}return r}function iue({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function oue(t,e){const n=t.get();if(Array.isArray(e)){for(let r=0;r<e.length;r++)if(e[r]!==n)return!0}else return n!==e}function o6(t,e,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...l}=t.makeTargetAnimatable(e);const c=t.getValue("willChange");r&&(i=r);const u=[],d=s&&t.animationState&&t.animationState.getState()[s];for(const h in l){const f=t.getValue(h),m=l[h];if(!f||m===void 0||d&&iue(d,h))continue;const g={delay:n,elapsed:0,...mN(i||{},h)};if(window.HandoffAppearAnimations){const v=t.getProps()[l5];if(v){const _=window.HandoffAppearAnimations(v,h,f,Cn);_!==null&&(g.elapsed=_,g.isHandoff=!0)}}let x=!g.isHandoff&&!oue(f,m);if(g.type==="spring"&&(f.getVelocity()||g.velocity)&&(x=!1),f.animation&&(x=!1),x)continue;f.start(pN(h,f,m,t.shouldReduceMotion&&hd.has(h)?{type:!1}:g));const w=f.animation;hw(c)&&(c.add(h),w.then(()=>c.remove(h))),u.push(w)}return o&&Promise.all(u).then(()=>{o&&tue(t,o)}),u}function UE(t,e,n={}){const r=Z0(t,e,n.custom);let{transition:s=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(o6(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return aue(t,e,u+c,d,h,n)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(n.delay)])}function aue(t,e,n=0,r=0,s=1,i){const o=[],l=(t.variantChildren.size-1)*r,c=s===1?(u=0)=>u*r:(u=0)=>l-u*r;return Array.from(t.variantChildren).sort(lue).forEach((u,d)=>{u.notify("AnimationStart",e),o.push(UE(u,e,{...i,delay:n+c(d)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(o)}function lue(t,e){return t.sortNodePosition(e)}function cue(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>UE(t,i,n));r=Promise.all(s)}else if(typeof e=="string")r=UE(t,e,n);else{const s=typeof e=="function"?Z0(t,e,n.custom):e;r=Promise.all(o6(t,s,n))}return r.then(()=>t.notify("AnimationComplete",e))}const uue=[...ZI].reverse(),due=ZI.length;function hue(t){return e=>Promise.all(e.map(({animation:n,options:r})=>cue(t,n,r)))}function fue(t){let e=hue(t);const n=pue();let r=!0;const s=(c,u)=>{const d=Z0(t,u);if(d){const{transition:h,transitionEnd:f,...m}=d;c={...c,...m,...f}}return c};function i(c){e=c(t)}function o(c,u){const d=t.getProps(),h=t.getVariantContext(!0)||{},f=[],m=new Set;let g={},x=1/0;for(let v=0;v<due;v++){const _=uue[v],C=n[_],T=d[_]!==void 0?d[_]:h[_],R=zp(T),A=_===u?C.isActive:null;A===!1&&(x=v);let E=T===h[_]&&T!==d[_]&&R;if(E&&r&&t.manuallyAnimateOnMount&&(E=!1),C.protectedKeys={...g},!C.isActive&&A===null||!T&&!C.prevProp||Y0(T)||typeof T=="boolean")continue;let P=mue(C.prevProp,T)||_===u&&C.isActive&&!E&&R||v>x&&R,k=!1;const j=Array.isArray(T)?T:[T];let D=j.reduce(s,{});A===!1&&(D={});const{prevResolvedValues:M={}}=C,G={...M,...D},B=W=>{P=!0,m.has(W)&&(k=!0,m.delete(W)),C.needsAnimating[W]=!0};for(const W in G){const Q=D[W],H=M[W];if(g.hasOwnProperty(W))continue;let Y=!1;lw(Q)&&lw(H)?Y=!P5(Q,H):Y=Q!==H,Y?Q!==void 0?B(W):m.add(W):Q!==void 0&&m.has(W)?B(W):C.protectedKeys[W]=!0}C.prevProp=T,C.prevResolvedValues=D,C.isActive&&(g={...g,...D}),r&&t.blockInitialAnimation&&(P=!1),P&&(!E||k)&&f.push(...j.map(W=>({animation:W,options:{type:_,...c}})))}if(m.size){const v={};m.forEach(_=>{const C=t.getBaseTarget(_);C!==void 0&&(v[_]=C)}),f.push({animation:v})}let w=!!f.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(w=!1),r=!1,w?e(f):Promise.resolve()}function l(c,u,d){var h;if(n[c].isActive===u)return Promise.resolve();(h=t.variantChildren)===null||h===void 0||h.forEach(m=>{var g;return(g=m.animationState)===null||g===void 0?void 0:g.setActive(c,u)}),n[c].isActive=u;const f=o(d,c);for(const m in n)n[m].protectedKeys={};return f}return{animateChanges:o,setActive:l,setAnimateFunction:i,getState:()=>n}}function mue(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!P5(e,t):!1}function ru(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function pue(){return{animate:ru(!0),whileInView:ru(),whileHover:ru(),whileTap:ru(),whileDrag:ru(),whileFocus:ru(),exit:ru()}}class gue extends Vc{constructor(e){super(e),e.animationState||(e.animationState=fue(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),Y0(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let yue=0;class xue extends Vc{constructor(){super(...arguments),this.id=yue++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e,{custom:r??this.node.getProps().custom});n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const vue={animation:{Feature:gue},exit:{Feature:xue}},tD=(t,e)=>Math.abs(t-e);function wue(t,e){const n=tD(t.x,e.x),r=tD(t.y,e.y);return Math.sqrt(n**2+r**2)}class a6{constructor(e,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=pS(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,m=wue(h.offset,{x:0,y:0})>=3;if(!f&&!m)return;const{point:g}=h,{timestamp:x}=hs;this.history.push({...g,timestamp:x});const{onStart:w,onMove:v}=this.handlers;f||(w&&w(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=mS(f,this.transformPagePoint),Cn.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:m,onSessionEnd:g,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=pS(h.type==="pointercancel"?this.lastMoveEventInfo:mS(f,this.transformPagePoint),this.history);this.startEvent&&m&&m(h,w),g&&g(h,w)},!C5(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const o=Q0(e),l=mS(o,this.transformPagePoint),{point:c}=l,{timestamp:u}=hs;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=n;d&&d(e,pS(l,this.history)),this.removeListeners=ac(Ya(this.contextWindow,"pointermove",this.handlePointerMove),Ya(this.contextWindow,"pointerup",this.handlePointerUp),Ya(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ho(this.updatePoint)}}function mS(t,e){return e?{point:e(t.point)}:t}function nD(t,e){return{x:t.x-e.x,y:t.y-e.y}}function pS({point:t},e){return{point:t,delta:nD(t,l6(e)),offset:nD(t,bue(e)),velocity:_ue(e,.1)}}function bue(t){return t[0]}function l6(t){return t[t.length-1]}function _ue(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=l6(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>lc(e)));)n--;if(!r)return{x:0,y:0};const i=Ja(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Yi(t){return t.max-t.min}function BE(t,e=0,n=.01){return Math.abs(t-e)<=n}function rD(t,e,n,r=.5){t.origin=r,t.originPoint=xr(e.min,e.max,t.origin),t.scale=Yi(n)/Yi(e),(BE(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=xr(n.min,n.max,t.origin)-t.originPoint,(BE(t.translate)||isNaN(t.translate))&&(t.translate=0)}function Zm(t,e,n,r){rD(t.x,e.x,n.x,r?r.originX:void 0),rD(t.y,e.y,n.y,r?r.originY:void 0)}function sD(t,e,n){t.min=n.min+e.min,t.max=t.min+Yi(e)}function Sue(t,e,n){sD(t.x,e.x,n.x),sD(t.y,e.y,n.y)}function iD(t,e,n){t.min=e.min-n.min,t.max=t.min+Yi(e)}function ep(t,e,n){iD(t.x,e.x,n.x),iD(t.y,e.y,n.y)}function Cue(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?xr(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?xr(n,t,r.max):Math.min(t,n)),t}function oD(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function Eue(t,{top:e,left:n,bottom:r,right:s}){return{x:oD(t.x,n,s),y:oD(t.y,e,r)}}function aD(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function Tue(t,e){return{x:aD(t.x,e.x),y:aD(t.y,e.y)}}function Iue(t,e){let n=.5;const r=Yi(t),s=Yi(e);return s>r?n=Xh(e.min,e.max-r,t.min):r>s&&(n=Xh(t.min,t.max-s,e.min)),bc(0,1,n)}function Nue(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const zE=.35;function Pue(t=zE){return t===!1?t=0:t===!0&&(t=zE),{x:lD(t,"left","right"),y:lD(t,"top","bottom")}}function lD(t,e,n){return{min:cD(t,e),max:cD(t,n)}}function cD(t,e){return typeof t=="number"?t:t[e]||0}const uD=()=>({translate:0,scale:1,origin:0,originPoint:0}),mh=()=>({x:uD(),y:uD()}),dD=()=>({min:0,max:0}),Fr=()=>({x:dD(),y:dD()});function ro(t){return[t("x"),t("y")]}function c6({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function Aue({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function kue(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function gS(t){return t===void 0||t===1}function GE({scale:t,scaleX:e,scaleY:n}){return!gS(t)||!gS(e)||!gS(n)}function lu(t){return GE(t)||u6(t)||t.z||t.rotate||t.rotateX||t.rotateY}function u6(t){return hD(t.x)||hD(t.y)}function hD(t){return t&&t!=="0%"}function fw(t,e,n){const r=t-n,s=e*r;return n+s}function fD(t,e,n,r,s){return s!==void 0&&(t=fw(t,s,r)),fw(t,n,r)+e}function WE(t,e=0,n=1,r,s){t.min=fD(t.min,e,n,r,s),t.max=fD(t.max,e,n,r,s)}function d6(t,{x:e,y:n}){WE(t.x,e.translate,e.scale,e.originPoint),WE(t.y,n.translate,n.scale,n.originPoint)}function Rue(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let i,o;for(let l=0;l<s;l++){i=n[l],o=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&ph(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,d6(t,o)),r&&lu(i.latestValues)&&ph(t,i.latestValues))}e.x=mD(e.x),e.y=mD(e.y)}function mD(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function Vl(t,e){t.min=t.min+e,t.max=t.max+e}function pD(t,e,[n,r,s]){const i=e[s]!==void 0?e[s]:.5,o=xr(t.min,t.max,i);WE(t,e[n],e[r],o,e.scale)}const jue=["x","scaleX","originX"],Due=["y","scaleY","originY"];function ph(t,e){pD(t.x,e,jue),pD(t.y,e,Due)}function h6(t,e){return c6(kue(t.getBoundingClientRect(),e))}function Mue(t,e,n){const r=h6(t,n),{scroll:s}=e;return s&&(Vl(r.x,s.offset.x),Vl(r.y,s.offset.y)),r}const f6=({current:t})=>t?t.ownerDocument.defaultView:null,Lue=new WeakMap;class Fue{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Fr(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Q0(d,"page").point)},i=(d,h)=>{const{drag:f,dragPropagation:m,onDragStart:g}=this.getProps();if(f&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=T5(f),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ro(w=>{let v=this.getAxisMotionValue(w).get()||0;if(va.test(v)){const{projection:_}=this.visualElement;if(_&&_.layout){const C=_.layout.layoutBox[w];C&&(v=Yi(C)*(parseFloat(v)/100))}}this.originPoint[w]=v}),g&&Cn.update(()=>g(d,h),!1,!0);const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(d,h)=>{const{dragPropagation:f,dragDirectionLock:m,onDirectionLock:g,onDrag:x}=this.getProps();if(!f&&!this.openGlobalLock)return;const{offset:w}=h;if(m&&this.currentDirection===null){this.currentDirection=Oue(w),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",h.point,w),this.updateAxis("y",h.point,w),this.visualElement.render(),x&&x(d,h)},l=(d,h)=>this.stop(d,h),c=()=>ro(d=>{var h;return this.getAnimationState(d)==="paused"&&((h=this.getAxisMotionValue(d).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new a6(e,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:f6(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&Cn.update(()=>i(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!Qy(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=Cue(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&hh(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=Eue(s.layoutBox,n):this.constraints=!1,this.elastic=Pue(r),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&ro(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=Nue(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!hh(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=Mue(r,s.root,this.visualElement.getTransformPagePoint());let o=Tue(s.layout.layoutBox,i);if(n){const l=n(Aue(o));this.hasMutatedConstraints=!!l,l&&(o=c6(l))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=ro(d=>{if(!Qy(d,n,this.currentDirection))return;let h=c&&c[d]||{};o&&(h={min:0,max:0});const f=s?200:1e6,m=s?40:1e7,g={type:"inertia",velocity:r?e[d]:0,bounceStiffness:f,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(d,g)});return Promise.all(u).then(l)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return r.start(pN(e,r,0,n))}stopAnimation(){ro(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ro(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){ro(n=>{const{drag:r}=this.getProps();if(!Qy(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[n];i.set(e[n]-xr(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!hh(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};ro(o=>{const l=this.getAxisMotionValue(o);if(l){const c=l.get();s[o]=Iue({min:c,max:c},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ro(o=>{if(!Qy(o,e,null))return;const l=this.getAxisMotionValue(o),{min:c,max:u}=this.constraints[o];l.set(xr(c,u,s[o]))})}addListeners(){if(!this.visualElement.current)return;Lue.set(this.visualElement,this);const e=this.visualElement.current,n=Ya(e,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),r=()=>{const{dragConstraints:c}=this.getProps();hh(c)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),r();const o=za(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(ro(d=>{const h=this.getAxisMotionValue(d);h&&(this.originPoint[d]+=c[d].translate,h.set(h.get()+c[d].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=zE,dragMomentum:l=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:l}}}function Qy(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function Oue(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class Vue extends Vc{constructor(e){super(e),this.removeGroupControls=Ir,this.removeListeners=Ir,this.controls=new Fue(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ir}unmount(){this.removeGroupControls(),this.removeListeners()}}const gD=t=>(e,n)=>{t&&Cn.update(()=>t(e,n))};class $ue extends Vc{constructor(){super(...arguments),this.removePointerDownListener=Ir}onPointerDown(e){this.session=new a6(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:f6(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:gD(e),onStart:gD(n),onMove:r,onEnd:(i,o)=>{delete this.session,s&&Cn.update(()=>s(i,o))}}}mount(){this.removePointerDownListener=Ya(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Uue(){const t=p.useContext(q0);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:r}=t,s=p.useId();return p.useEffect(()=>r(s),[]),!e&&n?[!1,()=>n&&n(s)]:[!0]}const Hx={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function yD(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const rm={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Ut.test(t))t=parseFloat(t);else return t;const n=yD(t,e.target.x),r=yD(t,e.target.y);return`${n}% ${r}%`}},Bue={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=_c.parse(t);if(s.length>5)return r;const i=_c.createTransformer(t),o=typeof s[0]!="number"?1:0,l=n.x.scale*e.x,c=n.y.scale*e.y;s[0+o]/=l,s[1+o]/=c;const u=xr(l,c,.5);return typeof s[2+o]=="number"&&(s[2+o]/=u),typeof s[3+o]=="number"&&(s[3+o]/=u),i(s)}};class zue extends ht.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;Qae(Gue),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Hx.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,o=r.projection;return o&&(o.isPresent=i,s||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||Cn.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function m6(t){const[e,n]=Uue(),r=p.useContext(tN);return ht.createElement(zue,{...t,layoutGroup:r,switchLayoutGroup:p.useContext(u5),isPresent:e,safeToRemove:n})}const Gue={borderRadius:{...rm,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:rm,borderTopRightRadius:rm,borderBottomLeftRadius:rm,borderBottomRightRadius:rm,boxShadow:Bue},p6=["TopLeft","TopRight","BottomLeft","BottomRight"],Wue=p6.length,xD=t=>typeof t=="string"?parseFloat(t):t,vD=t=>typeof t=="number"||Ut.test(t);function Hue(t,e,n,r,s,i){s?(t.opacity=xr(0,n.opacity!==void 0?n.opacity:1,que(r)),t.opacityExit=xr(e.opacity!==void 0?e.opacity:1,0,Kue(r))):i&&(t.opacity=xr(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<Wue;o++){const l=`border${p6[o]}Radius`;let c=wD(e,l),u=wD(n,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||vD(c)===vD(u)?(t[l]=Math.max(xr(xD(c),xD(u),r),0),(va.test(u)||va.test(c))&&(t[l]+="%")):t[l]=u}(e.rotate||n.rotate)&&(t.rotate=xr(e.rotate||0,n.rotate||0,r))}function wD(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const que=g6(0,.5,V5),Kue=g6(.5,.95,Ir);function g6(t,e,n){return r=>r<t?0:r>e?1:n(Xh(t,e,r))}function bD(t,e){t.min=e.min,t.max=e.max}function no(t,e){bD(t.x,e.x),bD(t.y,e.y)}function _D(t,e,n,r,s){return t-=e,t=fw(t,1/n,r),s!==void 0&&(t=fw(t,1/s,r)),t}function Yue(t,e=0,n=1,r=.5,s,i=t,o=t){if(va.test(e)&&(e=parseFloat(e),e=xr(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=xr(i.min,i.max,r);t===i&&(l-=e),t.min=_D(t.min,e,n,l,s),t.max=_D(t.max,e,n,l,s)}function SD(t,e,[n,r,s],i,o){Yue(t,e[n],e[r],e[s],e.scale,i,o)}const Jue=["x","scaleX","originX"],Xue=["y","scaleY","originY"];function CD(t,e,n,r){SD(t.x,e,Jue,n?n.x:void 0,r?r.x:void 0),SD(t.y,e,Xue,n?n.y:void 0,r?r.y:void 0)}function ED(t){return t.translate===0&&t.scale===1}function y6(t){return ED(t.x)&&ED(t.y)}function Que(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function x6(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function TD(t){return Yi(t.x)/Yi(t.y)}class Zue{constructor(){this.members=[]}add(e){gN(this.members,e),e.scheduleRender()}remove(e){if(yN(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function ID(t,e,n){let r="";const s=t.x.translate/e.x,i=t.y.translate/e.y;if((s||i)&&(r=`translate3d(${s}px, ${i}px, 0) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:c,rotateX:u,rotateY:d}=n;c&&(r+=`rotate(${c}deg) `),u&&(r+=`rotateX(${u}deg) `),d&&(r+=`rotateY(${d}deg) `)}const o=t.x.scale*e.x,l=t.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const ede=(t,e)=>t.depth-e.depth;class tde{constructor(){this.children=[],this.isDirty=!1}add(e){gN(this.children,e),this.isDirty=!0}remove(e){yN(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(ede),this.isDirty=!1,this.children.forEach(e)}}function nde(t,e){const n=performance.now(),r=({timestamp:s})=>{const i=s-n;i>=e&&(Ho(r),t(i-e))};return Cn.read(r,!0),()=>Ho(r)}function rde(t){window.MotionDebug&&window.MotionDebug.record(t)}function sde(t){return t instanceof SVGElement&&t.tagName!=="svg"}function ide(t,e,n){const r=wi(t)?t:Mo(t);return r.start(pN("",r,e,n)),r.animation}const ND=["","X","Y","Z"],ode={visibility:"hidden"},PD=1e3;let ade=0;const cu={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function v6({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(o={},l=e==null?void 0:e()){this.id=ade++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,cu.totalNodes=cu.resolvedTargetDeltas=cu.recalculatedProjection=0,this.nodes.forEach(ude),this.nodes.forEach(pde),this.nodes.forEach(gde),this.nodes.forEach(dde),rde(cu)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new tde)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new xN),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=sde(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(u||c)&&(this.isLayoutDirty=!0),t){let h;const f=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=nde(f,250),Hx.hasAnimatedSinceResize&&(Hx.hasAnimatedSinceResize=!1,this.nodes.forEach(kD))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeTargetChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||d.getDefaultTransition()||bde,{onLayoutAnimationStart:w,onLayoutAnimationComplete:v}=d.getProps(),_=!this.targetLayout||!x6(this.targetLayout,g)||m,C=!f&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||C||f&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,C);const T={...mN(x,"layout"),onPlay:w,onComplete:v};(d.shouldReduceMotion||this.options.layoutRoot)&&(T.delay=0,T.type=!1),this.startAnimation(T)}else f||kD(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ho(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(yde),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const h=this.path[d];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(AD);return}this.isUpdating||this.nodes.forEach(fde),this.isUpdating=!1,this.nodes.forEach(mde),this.nodes.forEach(lde),this.nodes.forEach(cde),this.clearAllSnapshots();const l=performance.now();hs.delta=bc(0,1e3/60,l-hs.timestamp),hs.timestamp=l,hs.isProcessing=!0,oS.update.process(hs),oS.preRender.process(hs),oS.render.process(hs),hs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(hde),this.sharedNodes.forEach(xde)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Cn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Cn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Fr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:r(this.instance),offset:n(this.instance)})}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!y6(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;o&&(l||lu(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),_de(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Fr();const l=o.measureViewportBox(),{scroll:c}=this.root;return c&&(Vl(l.x,c.offset.x),Vl(l.y,c.offset.y)),l}removeElementScroll(o){const l=Fr();no(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;if(u!==this.root&&d&&h.layoutScroll){if(d.isRoot){no(l,o);const{scroll:f}=this.root;f&&(Vl(l.x,-f.offset.x),Vl(l.y,-f.offset.y))}Vl(l.x,d.offset.x),Vl(l.y,d.offset.y)}}return l}applyTransform(o,l=!1){const c=Fr();no(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&ph(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),lu(d.latestValues)&&ph(c,d.latestValues)}return lu(this.latestValues)&&ph(c,this.latestValues),c}removeTransform(o){const l=Fr();no(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!lu(u.latestValues))continue;GE(u.latestValues)&&u.updateSnapshot();const d=Fr(),h=u.measurePageBox();no(d,h),CD(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return lu(this.latestValues)&&CD(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==hs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:f}=this.options;if(!(!this.layout||!(h||f))){if(this.resolvedRelativeTargetAt=hs.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Fr(),this.relativeTargetOrigin=Fr(),ep(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),no(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Fr(),this.targetWithTransforms=Fr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Sue(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):no(this.target,this.layout.layoutBox),d6(this.target,this.targetDelta)):no(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Fr(),this.relativeTargetOrigin=Fr(),ep(this.relativeTargetOrigin,this.target,m.target),no(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}cu.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||GE(this.parent.latestValues)||u6(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===hs.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;no(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;Rue(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:g}=l;if(!g){this.projectionTransform&&(this.projectionDelta=mh(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=mh(),this.projectionDeltaWithTransform=mh());const x=this.projectionTransform;Zm(this.projectionDelta,this.layoutCorrected,g,this.latestValues),this.projectionTransform=ID(this.projectionDelta,this.treeScale),(this.projectionTransform!==x||this.treeScale.x!==f||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),cu.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},h=mh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const f=Fr(),m=c?c.source:void 0,g=this.layout?this.layout.source:void 0,x=m!==g,w=this.getStack(),v=!w||w.members.length<=1,_=!!(x&&!v&&this.options.crossfade===!0&&!this.path.some(wde));this.animationProgress=0;let C;this.mixTargetDelta=T=>{const R=T/1e3;RD(h.x,o.x,R),RD(h.y,o.y,R),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ep(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),vde(this.relativeTarget,this.relativeTargetOrigin,f,R),C&&Que(this.relativeTarget,C)&&(this.isProjectionDirty=!1),C||(C=Fr()),no(C,this.relativeTarget)),x&&(this.animationValues=d,Hue(d,u,this.latestValues,R,_,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=R},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ho(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Cn.update(()=>{Hx.hasAnimatedSinceResize=!0,this.currentAnimation=ide(0,PD,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(PD),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=o;if(!(!l||!c||!u)){if(this!==o&&this.layout&&u&&w6(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Fr();const h=Yi(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+h;const f=Yi(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+f}no(l,c),ph(l,d),Zm(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Zue),this.sharedNodes.get(o).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const u={};for(let d=0;d<ND.length;d++){const h="rotate"+ND[d];c[h]&&(u[h]=c[h],o.setStaticValue(h,0))}o.render();for(const d in u)o.setStaticValue(d,u[d]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return ode;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=Wx(o==null?void 0:o.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=Wx(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!lu(this.latestValues)&&(x.transform=d?d({},""):"none",this.hasProjected=!1),x}const f=h.animationValues||h.latestValues;this.applyTransformsToTarget(),u.transform=ID(this.projectionDeltaWithTransform,this.treeScale,f),d&&(u.transform=d(f,u.transform));const{x:m,y:g}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,h.animationValues?u.opacity=h===this?(c=(l=f.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:u.opacity=h===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const x in ow){if(f[x]===void 0)continue;const{correct:w,applyTo:v}=ow[x],_=u.transform==="none"?f[x]:w(f[x],h);if(v){const C=v.length;for(let T=0;T<C;T++)u[v[T]]=_}else u[x]=_}return this.options.layoutId&&(u.pointerEvents=h===this?Wx(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(AD),this.root.sharedNodes.clear()}}}function lde(t){t.updateLayout()}function cde(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;i==="size"?ro(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],m=Yi(f);f.min=r[h].min,f.max=f.min+m}):w6(i,n.layoutBox,r)&&ro(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],m=Yi(r[h]);f.max=f.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+m)});const l=mh();Zm(l,r,n.layoutBox);const c=mh();o?Zm(c,t.applyTransform(s,!0),n.measuredBox):Zm(c,r,n.layoutBox);const u=!y6(l);let d=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:m}=h;if(f&&m){const g=Fr();ep(g,n.layoutBox,f.layoutBox);const x=Fr();ep(x,r,m.layoutBox),x6(g,x)||(d=!0),h.options.layoutRoot&&(t.relativeTarget=x,t.relativeTargetOrigin=g,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function ude(t){cu.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function dde(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function hde(t){t.clearSnapshot()}function AD(t){t.clearMeasurements()}function fde(t){t.isLayoutDirty=!1}function mde(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function kD(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function pde(t){t.resolveTargetDelta()}function gde(t){t.calcProjection()}function yde(t){t.resetRotation()}function xde(t){t.removeLeadSnapshot()}function RD(t,e,n){t.translate=xr(e.translate,0,n),t.scale=xr(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function jD(t,e,n,r){t.min=xr(e.min,n.min,r),t.max=xr(e.max,n.max,r)}function vde(t,e,n,r){jD(t.x,e.x,n.x,r),jD(t.y,e.y,n.y,r)}function wde(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const bde={duration:.45,ease:[.4,0,.1,1]},DD=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),MD=DD("applewebkit/")&&!DD("chrome/")?Math.round:Ir;function LD(t){t.min=MD(t.min),t.max=MD(t.max)}function _de(t){LD(t.x),LD(t.y)}function w6(t,e,n){return t==="position"||t==="preserve-aspect"&&!BE(TD(e),TD(n),.2)}const Sde=v6({attachResizeListener:(t,e)=>za(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),yS={current:void 0},b6=v6({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!yS.current){const t=new Sde({});t.mount(window),t.setOptions({layoutScroll:!0}),yS.current=t}return yS.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Cde={pan:{Feature:$ue},drag:{Feature:Vue,ProjectionNode:b6,MeasureLayout:m6}},Ede=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Tde(t){const e=Ede.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]}function HE(t,e,n=1){const[r,s]=Tde(t);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const o=i.trim();return r6(o)?parseFloat(o):o}else return ME(s)?HE(s,e,n+1):s}function Ide(t,{...e},n){const r=t.current;if(!(r instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(s=>{const i=s.get();if(!ME(i))return;const o=HE(i,r);o&&s.set(o)});for(const s in e){const i=e[s];if(!ME(i))continue;const o=HE(i,r);o&&(e[s]=o,n||(n={}),n[s]===void 0&&(n[s]=i))}return{target:e,transitionEnd:n}}const Nde=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),_6=t=>Nde.has(t),Pde=t=>Object.keys(t).some(_6),FD=t=>t===fd||t===Ut,OD=(t,e)=>parseFloat(t.split(", ")[e]),VD=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/);if(s)return OD(s[1],e);{const i=r.match(/^matrix\((.+)\)$/);return i?OD(i[1],t):0}},Ade=new Set(["x","y","z"]),kde=Rg.filter(t=>!Ade.has(t));function Rde(t){const e=[];return kde.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const Qh={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:VD(4,13),y:VD(5,14)};Qh.translateX=Qh.x;Qh.translateY=Qh.y;const jde=(t,e,n)=>{const r=e.measureViewportBox(),s=e.current,i=getComputedStyle(s),{display:o}=i,l={};o==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(u=>{l[u]=Qh[u](r,i)}),e.render();const c=e.measureViewportBox();return n.forEach(u=>{const d=e.getValue(u);d&&d.jump(l[u]),t[u]=Qh[u](c,i)}),t},Dde=(t,e,n={},r={})=>{e={...e},r={...r};const s=Object.keys(e).filter(_6);let i=[],o=!1;const l=[];if(s.forEach(c=>{const u=t.getValue(c);if(!t.hasValue(c))return;let d=n[c],h=nm(d);const f=e[c];let m;if(lw(f)){const g=f.length,x=f[0]===null?1:0;d=f[x],h=nm(d);for(let w=x;w<g&&f[w]!==null;w++)m?eb(nm(f[w])===m):m=nm(f[w])}else m=nm(f);if(h!==m)if(FD(h)&&FD(m)){const g=u.get();typeof g=="string"&&u.set(parseFloat(g)),typeof f=="string"?e[c]=parseFloat(f):Array.isArray(f)&&m===Ut&&(e[c]=f.map(parseFloat))}else h!=null&&h.transform&&(m!=null&&m.transform)&&(d===0||f===0)?d===0?u.set(m.transform(d)):e[c]=h.transform(f):(o||(i=Rde(t),o=!0),l.push(c),r[c]=r[c]!==void 0?r[c]:e[c],u.jump(f))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,u=jde(e,t,l);return i.length&&i.forEach(([d,h])=>{t.getValue(d).set(h)}),t.render(),K0&&c!==null&&window.scrollTo({top:c}),{target:u,transitionEnd:r}}else return{target:e,transitionEnd:r}};function Mde(t,e,n,r){return Pde(e)?Dde(t,e,n,r):{target:e,transitionEnd:r}}const Lde=(t,e,n,r)=>{const s=Ide(t,e,r);return e=s.target,r=s.transitionEnd,Mde(t,e,n,r)},qE={current:null},S6={current:!1};function Fde(){if(S6.current=!0,!!K0)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>qE.current=t.matches;t.addListener(e),e()}else qE.current=!1}function Ode(t,e,n){const{willChange:r}=e;for(const s in e){const i=e[s],o=n[s];if(wi(i))t.addValue(s,i),hw(r)&&r.add(s);else if(wi(o))t.addValue(s,Mo(i,{owner:t})),hw(r)&&r.remove(s);else if(o!==i)if(t.hasValue(s)){const l=t.getValue(s);!l.hasAnimated&&l.set(i)}else{const l=t.getStaticValue(s);t.addValue(s,Mo(l!==void 0?l:i,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const $D=new WeakMap,C6=Object.keys(Gp),Vde=C6.length,UD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],$de=eN.length;class Ude{constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Cn.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.isControllingVariants=J0(n),this.isVariantNode=c5(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{});for(const h in d){const f=d[h];l[h]!==void 0&&wi(f)&&(f.set(l[h],!1),hw(u)&&u.add(h))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,$D.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),S6.current||Fde(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:qE.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){$D.delete(this.current),this.projection&&this.projection.unmount(),Ho(this.notifyUpdate),Ho(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const r=hd.has(e),s=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Cn.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{s(),i()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},r,s,i){let o,l;for(let c=0;c<Vde;c++){const u=C6[c],{isEnabled:d,Feature:h,ProjectionNode:f,MeasureLayout:m}=Gp[u];f&&(o=f),d(n)&&(!this.features[u]&&h&&(this.features[u]=new h(this)),m&&(l=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:d,dragConstraints:h,layoutScroll:f,layoutRoot:m}=n;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||h&&hh(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:i,layoutScroll:f,layoutRoot:m})}return l}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Fr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<UD.length;r++){const s=UD[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i=e["on"+s];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=Ode(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const n={};for(let r=0;r<$de;r++){const s=eN[r],i=this.props[s];(zp(i)||i===!1)&&(n[s]=i)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Mo(n,{owner:this}),this.addValue(e,r)),r}readValue(e){var n;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props,s=typeof r=="string"||typeof r=="object"?(n=lN(this.props,r))===null||n===void 0?void 0:n[e]:void 0;if(r&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!wi(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new xN),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class E6 extends Ude{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...r},{transformValues:s},i){let o=sue(r,e||{},this);if(s&&(n&&(n=s(n)),r&&(r=s(r)),o&&(o=s(o))),i){nue(this,r,o);const l=Lde(this,r,o,n);n=l.transitionEnd,r=l.target}return{transition:e,transitionEnd:n,...r}}}function Bde(t){return window.getComputedStyle(t)}class zde extends E6{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,n){if(hd.has(n)){const r=fN(n);return r&&r.default||0}else{const r=Bde(e),s=(f5(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return h6(e,n)}build(e,n,r,s){rN(e,n,r,s.transformTemplate)}scrapeMotionValuesFromProps(e,n){return aN(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;wi(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,r,s){v5(e,n,r,s)}}class Gde extends E6{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(hd.has(n)){const r=fN(n);return r&&r.default||0}return n=w5.has(n)?n:QI(n),e.getAttribute(n)}measureInstanceViewportBox(){return Fr()}scrapeMotionValuesFromProps(e,n){return _5(e,n)}build(e,n,r,s){iN(e,n,r,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,r,s){b5(e,n,r,s)}mount(e){this.isSVGTag=oN(e.tagName),super.mount(e)}}const Wde=(t,e)=>nN(t)?new Gde(e,{enableHardwareAcceleration:!1}):new zde(e,{enableHardwareAcceleration:!0}),Hde={layout:{ProjectionNode:b6,MeasureLayout:m6}},qde={...vue,...Ule,...Cde,...Hde},It=Jae((t,e)=>Nle(t,e,qde,Wde));function T6(){const t=p.useRef(!1);return kg(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function Kde(){const t=T6(),[e,n]=p.useState(0),r=p.useCallback(()=>{t.current&&n(e+1)},[e]);return[p.useCallback(()=>Cn.postRender(r),[r]),e]}class Yde extends p.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Jde({children:t,isPresent:e}){const n=p.useId(),r=p.useRef(null),s=p.useRef({width:0,height:0,top:0,left:0});return p.useInsertionEffect(()=>{const{width:i,height:o,top:l,left:c}=s.current;if(e||!r.current||!i||!o)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),p.createElement(Yde,{isPresent:e,childRef:r,sizeRef:s},p.cloneElement(t,{ref:r}))}const xS=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:o})=>{const l=Mg(Xde),c=p.useId(),u=p.useMemo(()=>({id:c,initial:e,isPresent:n,custom:s,onExitComplete:d=>{l.set(d,!0);for(const h of l.values())if(!h)return;r&&r()},register:d=>(l.set(d,!1),()=>l.delete(d))}),i?void 0:[n]);return p.useMemo(()=>{l.forEach((d,h)=>l.set(h,!1))},[n]),p.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),o==="popLayout"&&(t=p.createElement(Jde,{isPresent:n},t)),p.createElement(q0.Provider,{value:u},t)};function Xde(){return new Map}function Qde(t){return p.useEffect(()=>()=>t(),[])}const uu=t=>t.key||"";function Zde(t,e){t.forEach(n=>{const r=uu(n);e.set(r,n)})}function ehe(t){const e=[];return p.Children.forEach(t,n=>{p.isValidElement(n)&&e.push(n)}),e}const Sc=({children:t,custom:e,initial:n=!0,onExitComplete:r,exitBeforeEnter:s,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const l=p.useContext(tN).forceRender||Kde()[0],c=T6(),u=ehe(t);let d=u;const h=p.useRef(new Map).current,f=p.useRef(d),m=p.useRef(new Map).current,g=p.useRef(!0);if(kg(()=>{g.current=!1,Zde(u,m),f.current=d}),Qde(()=>{g.current=!0,m.clear(),h.clear()}),g.current)return p.createElement(p.Fragment,null,d.map(_=>p.createElement(xS,{key:uu(_),isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:i,mode:o},_)));d=[...d];const x=f.current.map(uu),w=u.map(uu),v=x.length;for(let _=0;_<v;_++){const C=x[_];w.indexOf(C)===-1&&!h.has(C)&&h.set(C,void 0)}return o==="wait"&&h.size&&(d=[]),h.forEach((_,C)=>{if(w.indexOf(C)!==-1)return;const T=m.get(C);if(!T)return;const R=x.indexOf(C);let A=_;if(!A){const E=()=>{h.delete(C);const I=Array.from(m.keys()).filter(P=>!w.includes(P));if(I.forEach(P=>m.delete(P)),f.current=u.filter(P=>{const k=uu(P);return k===C||I.includes(k)}),!h.size){if(c.current===!1)return;l(),r&&r()}};A=p.createElement(xS,{key:uu(T),isPresent:!1,onExitComplete:E,custom:e,presenceAffectsLayout:i,mode:o},T),h.set(C,A)}d.splice(R,0,A)}),d=d.map(_=>{const C=_.key;return h.has(C)?_:p.createElement(xS,{key:uu(_),isPresent:!0,presenceAffectsLayout:i,mode:o},_)}),p.createElement(p.Fragment,null,h.size?d:d.map(_=>p.cloneElement(_)))};function the(t){const e=Mg(()=>Mo(t)),{isStatic:n}=p.useContext(XI);if(n){const[,r]=p.useState(t);p.useEffect(()=>e.on("change",r),[])}return e}const nhe=t=>t&&typeof t=="object"&&t.mix,rhe=t=>nhe(t)?t.mix:void 0;function she(...t){const e=!Array.isArray(t[0]),n=e?0:-1,r=t[0+n],s=t[1+n],i=t[2+n],o=t[3+n],l=tb(s,i,{mixer:rhe(i[0]),...o});return e?l(r):l}function I6(t,e){const n=the(e()),r=()=>n.set(e());return r(),kg(()=>{const s=()=>Cn.update(r,!1,!0),i=t.map(o=>o.on("change",s));return()=>{i.forEach(o=>o()),Ho(r)}}),n}function ihe(t){Qm.current=[],t();const e=I6(Qm.current,t);return Qm.current=void 0,e}function vS(t,e,n,r){if(typeof t=="function")return ihe(t);const s=typeof e=="function"?e:she(e,n,r);return Array.isArray(t)?BD(t,s):BD([t],([i])=>s(i))}function BD(t,e){const n=Mg(()=>[]);return I6(t,()=>{n.length=0;const r=t.length;for(let s=0;s<r;s++)n[s]=t[s].get();return e(n)})}function N6(t,e,n){var r;if(typeof t=="string"){let s=document;e&&(eb(!!e.current),s=e.current),n?((r=n[t])!==null&&r!==void 0||(n[t]=s.querySelectorAll(t)),t=n[t]):t=s.querySelectorAll(t)}else t instanceof Element&&(t=[t]);return Array.from(t||[])}const qx=new WeakMap;let Ml;function ohe(t,e){if(e){const{inlineSize:n,blockSize:r}=e[0];return{width:n,height:r}}else return t instanceof SVGElement&&"getBBox"in t?t.getBBox():{width:t.offsetWidth,height:t.offsetHeight}}function ahe({target:t,contentRect:e,borderBoxSize:n}){var r;(r=qx.get(t))===null||r===void 0||r.forEach(s=>{s({target:t,contentSize:e,get size(){return ohe(t,n)}})})}function lhe(t){t.forEach(ahe)}function che(){typeof ResizeObserver>"u"||(Ml=new ResizeObserver(lhe))}function uhe(t,e){Ml||che();const n=N6(t);return n.forEach(r=>{let s=qx.get(r);s||(s=new Set,qx.set(r,s)),s.add(e),Ml==null||Ml.observe(r)}),()=>{n.forEach(r=>{const s=qx.get(r);s==null||s.delete(e),s!=null&&s.size||Ml==null||Ml.unobserve(r)})}}const Kx=new Set;let tp;function dhe(){tp=()=>{const t={width:window.innerWidth,height:window.innerHeight},e={target:window,size:t,contentSize:t};Kx.forEach(n=>n(e))},window.addEventListener("resize",tp)}function hhe(t){return Kx.add(t),tp||dhe(),()=>{Kx.delete(t),!Kx.size&&tp&&(tp=void 0)}}function fhe(t,e){return typeof t=="function"?hhe(t):uhe(t,e)}const mhe=50,zD=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),phe=()=>({time:0,x:zD(),y:zD()}),ghe={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function GD(t,e,n,r){const s=n[e],{length:i,position:o}=ghe[e],l=s.current,c=n.time;s.current=t["scroll"+o],s.scrollLength=t["scroll"+i]-t["client"+i],s.offset.length=0,s.offset[0]=0,s.offset[1]=s.scrollLength,s.progress=Xh(0,s.scrollLength,s.current);const u=r-c;s.velocity=u>mhe?0:hN(s.current-l,u)}function yhe(t,e,n){GD(t,"x",e,n),GD(t,"y",e,n),e.time=n}function xhe(t,e){const n={x:0,y:0};let r=t;for(;r&&r!==e;)if(r instanceof HTMLElement)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;else if(r.tagName==="svg"){const s=r.getBoundingClientRect();r=r.parentElement;const i=r.getBoundingClientRect();n.x+=s.left-i.left,n.y+=s.top-i.top}else if(r instanceof SVGGraphicsElement){const{x:s,y:i}=r.getBBox();n.x+=s,n.y+=i;let o=null,l=r.parentNode;for(;!o;)l.tagName==="svg"&&(o=l),l=r.parentNode;r=o}else break;return n}const vhe={Enter:[[0,1],[1,1]],Exit:[[0,0],[1,0]],Any:[[1,0],[0,1]],All:[[0,0],[1,1]]},KE={start:0,center:.5,end:1};function WD(t,e,n=0){let r=0;if(KE[t]!==void 0&&(t=KE[t]),typeof t=="string"){const s=parseFloat(t);t.endsWith("px")?r=s:t.endsWith("%")?t=s/100:t.endsWith("vw")?r=s/100*document.documentElement.clientWidth:t.endsWith("vh")?r=s/100*document.documentElement.clientHeight:t=s}return typeof t=="number"&&(r=e*t),n+r}const whe=[0,0];function bhe(t,e,n,r){let s=Array.isArray(t)?t:whe,i=0,o=0;return typeof t=="number"?s=[t,t]:typeof t=="string"&&(t=t.trim(),t.includes(" ")?s=t.split(" "):s=[t,KE[t]?t:"0"]),i=WD(s[0],n,r),o=WD(s[1],e),i-o}const _he={x:0,y:0};function She(t){return"getBBox"in t&&t.tagName!=="svg"?t.getBBox():{width:t.clientWidth,height:t.clientHeight}}function Che(t,e,n){let{offset:r=vhe.All}=n;const{target:s=t,axis:i="y"}=n,o=i==="y"?"height":"width",l=s!==t?xhe(s,t):_he,c=s===t?{width:t.scrollWidth,height:t.scrollHeight}:She(s),u={width:t.clientWidth,height:t.clientHeight};e[i].offset.length=0;let d=!e[i].interpolate;const h=r.length;for(let f=0;f<h;f++){const m=bhe(r[f],u[o],c[o],l[i]);!d&&m!==e[i].interpolatorOffsets[f]&&(d=!0),e[i].offset[f]=m}d&&(e[i].interpolate=tb(e[i].offset,Q5(r)),e[i].interpolatorOffsets=[...e[i].offset]),e[i].progress=e[i].interpolate(e[i].current)}function Ehe(t,e=t,n){if(n.x.targetOffset=0,n.y.targetOffset=0,e!==t){let r=e;for(;r&&r!==t;)n.x.targetOffset+=r.offsetLeft,n.y.targetOffset+=r.offsetTop,r=r.offsetParent}n.x.targetLength=e===t?e.scrollWidth:e.clientWidth,n.y.targetLength=e===t?e.scrollHeight:e.clientHeight,n.x.containerLength=t.clientWidth,n.y.containerLength=t.clientHeight}function The(t,e,n,r={}){return{measure:()=>Ehe(t,r.target,n),update:s=>{yhe(t,n,s),(r.offset||r.target)&&Che(t,n,r)},notify:()=>e(n)}}const sm=new WeakMap,HD=new WeakMap,wS=new WeakMap,qD=t=>t===document.documentElement?window:t;function Ihe(t,{container:e=document.documentElement,...n}={}){let r=wS.get(e);r||(r=new Set,wS.set(e,r));const s=phe(),i=The(e,t,s,n);if(r.add(i),!sm.has(e)){const l=()=>{for(const f of r)f.measure()},c=()=>{for(const f of r)f.update(hs.timestamp)},u=()=>{for(const f of r)f.notify()},d=()=>{Cn.read(l,!1,!0),Cn.read(c,!1,!0),Cn.update(u,!1,!0)};sm.set(e,d);const h=qD(e);window.addEventListener("resize",d,{passive:!0}),e!==document.documentElement&&HD.set(e,fhe(e,d)),h.addEventListener("scroll",d,{passive:!0})}const o=sm.get(e);return Cn.read(o,!1,!0),()=>{var l;Ho(o);const c=wS.get(e);if(!c||(c.delete(i),c.size))return;const u=sm.get(e);sm.delete(e),u&&(qD(e).removeEventListener("scroll",u),(l=HD.get(e))===null||l===void 0||l(),window.removeEventListener("resize",u))}}function KD(t,e){A5(!!(!e||e.current))}const Nhe=()=>({scrollX:Mo(0),scrollY:Mo(0),scrollXProgress:Mo(0),scrollYProgress:Mo(0)});function Phe({container:t,target:e,layoutEffect:n=!0,...r}={}){const s=Mg(Nhe);return(n?kg:p.useEffect)(()=>(KD("target",e),KD("container",t),Ihe(({x:o,y:l})=>{s.scrollX.set(o.current),s.scrollXProgress.set(o.progress),s.scrollY.set(l.current),s.scrollYProgress.set(l.progress)},{...r,container:(t==null?void 0:t.current)||void 0,target:(e==null?void 0:e.current)||void 0})),[t,e,JSON.stringify(r.offset)]),s}const Ahe={some:0,all:1};function khe(t,e,{root:n,margin:r,amount:s="some"}={}){const i=N6(t),o=new WeakMap,l=u=>{u.forEach(d=>{const h=o.get(d.target);if(d.isIntersecting!==!!h)if(d.isIntersecting){const f=e(d);typeof f=="function"?o.set(d.target,f):c.unobserve(d.target)}else h&&(h(d),o.delete(d.target))})},c=new IntersectionObserver(l,{root:n,rootMargin:r,threshold:typeof s=="number"?s:Ahe[s]});return i.forEach(u=>c.observe(u)),()=>c.disconnect()}function Rhe(t,{root:e,margin:n,amount:r,once:s=!1}={}){const[i,o]=p.useState(!1);return p.useEffect(()=>{if(!t.current||s&&i)return;const l=()=>(o(!0),s?void 0:()=>o(!1)),c={root:e&&e.current||void 0,margin:n,amount:r};return khe(t.current,l,c)},[e,t,n,s,r]),i}function jhe(t,[e,n]){return Math.min(n,Math.max(e,t))}function Dhe(t,e){return p.useReducer((n,r)=>e[n][r]??n,t)}var vN="ScrollArea",[P6,Cje]=_i(vN),[Mhe,bo]=P6(vN),A6=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...o}=t,[l,c]=p.useState(null),[u,d]=p.useState(null),[h,f]=p.useState(null),[m,g]=p.useState(null),[x,w]=p.useState(null),[v,_]=p.useState(0),[C,T]=p.useState(0),[R,A]=p.useState(!1),[E,I]=p.useState(!1),P=yn(e,j=>c(j)),k=B0(s);return a.jsx(Mhe,{scope:n,type:r,dir:k,scrollHideDelay:i,scrollArea:l,viewport:u,onViewportChange:d,content:h,onContentChange:f,scrollbarX:m,onScrollbarXChange:g,scrollbarXEnabled:R,onScrollbarXEnabledChange:A,scrollbarY:x,onScrollbarYChange:w,scrollbarYEnabled:E,onScrollbarYEnabledChange:I,onCornerWidthChange:_,onCornerHeightChange:T,children:a.jsx(Yt.div,{dir:k,...o,ref:P,style:{position:"relative","--radix-scroll-area-corner-width":v+"px","--radix-scroll-area-corner-height":C+"px",...t.style}})})});A6.displayName=vN;var k6="ScrollAreaViewport",R6=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=t,o=bo(k6,n),l=p.useRef(null),c=yn(e,l,o.onViewportChange);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),a.jsx(Yt.div,{"data-radix-scroll-area-viewport":"",...i,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...t.style},children:a.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});R6.displayName=k6;var Aa="ScrollAreaScrollbar",wN=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=bo(Aa,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=s,l=t.orientation==="horizontal";return p.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),s.type==="hover"?a.jsx(Lhe,{...r,ref:e,forceMount:n}):s.type==="scroll"?a.jsx(Fhe,{...r,ref:e,forceMount:n}):s.type==="auto"?a.jsx(j6,{...r,ref:e,forceMount:n}):s.type==="always"?a.jsx(bN,{...r,ref:e}):null});wN.displayName=Aa;var Lhe=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=bo(Aa,t.__scopeScrollArea),[i,o]=p.useState(!1);return p.useEffect(()=>{const l=s.scrollArea;let c=0;if(l){const u=()=>{window.clearTimeout(c),o(!0)},d=()=>{c=window.setTimeout(()=>o(!1),s.scrollHideDelay)};return l.addEventListener("pointerenter",u),l.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",u),l.removeEventListener("pointerleave",d)}}},[s.scrollArea,s.scrollHideDelay]),a.jsx(ws,{present:n||i,children:a.jsx(j6,{"data-state":i?"visible":"hidden",...r,ref:e})})}),Fhe=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=bo(Aa,t.__scopeScrollArea),i=t.orientation==="horizontal",o=rb(()=>c("SCROLL_END"),100),[l,c]=Dhe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return p.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>c("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,s.scrollHideDelay,c]),p.useEffect(()=>{const u=s.viewport,d=i?"scrollLeft":"scrollTop";if(u){let h=u[d];const f=()=>{const m=u[d];h!==m&&(c("SCROLL"),o()),h=m};return u.addEventListener("scroll",f),()=>u.removeEventListener("scroll",f)}},[s.viewport,i,c,o]),a.jsx(ws,{present:n||l!=="hidden",children:a.jsx(bN,{"data-state":l==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:gt(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:gt(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),j6=p.forwardRef((t,e)=>{const n=bo(Aa,t.__scopeScrollArea),{forceMount:r,...s}=t,[i,o]=p.useState(!1),l=t.orientation==="horizontal",c=rb(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,d=n.viewport.offsetHeight<n.viewport.scrollHeight;o(l?u:d)}},10);return Zh(n.viewport,c),Zh(n.content,c),a.jsx(ws,{present:r||i,children:a.jsx(bN,{"data-state":i?"visible":"hidden",...s,ref:e})})}),bN=p.forwardRef((t,e)=>{const{orientation:n="vertical",...r}=t,s=bo(Aa,t.__scopeScrollArea),i=p.useRef(null),o=p.useRef(0),[l,c]=p.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=O6(l.viewport,l.content),d={...r,sizes:l,onSizesChange:c,hasThumb:u>0&&u<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function h(f,m){return zhe(f,o.current,l,m)}return n==="horizontal"?a.jsx(Ohe,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollLeft,m=YD(f,l,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollLeft=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollLeft=h(f,s.dir))}}):n==="vertical"?a.jsx(Vhe,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollTop,m=YD(f,l);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollTop=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollTop=h(f))}}):null}),Ohe=p.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=bo(Aa,t.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=yn(e,c,i.onScrollbarXChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(M6,{"data-orientation":"horizontal",...s,ref:u,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":nb(n)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.x),onDragScroll:d=>t.onDragScroll(d.x),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+d.deltaX;t.onWheelScroll(f),$6(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:pw(o.paddingLeft),paddingEnd:pw(o.paddingRight)}})}})}),Vhe=p.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=bo(Aa,t.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=yn(e,c,i.onScrollbarYChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(M6,{"data-orientation":"vertical",...s,ref:u,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":nb(n)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.y),onDragScroll:d=>t.onDragScroll(d.y),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollTop+d.deltaY;t.onWheelScroll(f),$6(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:pw(o.paddingTop),paddingEnd:pw(o.paddingBottom)}})}})}),[$he,D6]=P6(Aa),M6=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:d,onResize:h,...f}=t,m=bo(Aa,n),[g,x]=p.useState(null),w=yn(e,P=>x(P)),v=p.useRef(null),_=p.useRef(""),C=m.viewport,T=r.content-r.viewport,R=$r(d),A=$r(c),E=rb(h,10);function I(P){if(v.current){const k=P.clientX-v.current.left,j=P.clientY-v.current.top;u({x:k,y:j})}}return p.useEffect(()=>{const P=k=>{const j=k.target;(g==null?void 0:g.contains(j))&&R(k,T)};return document.addEventListener("wheel",P,{passive:!1}),()=>document.removeEventListener("wheel",P,{passive:!1})},[C,g,T,R]),p.useEffect(A,[r,A]),Zh(g,E),Zh(m.content,E),a.jsx($he,{scope:n,scrollbar:g,hasThumb:s,onThumbChange:$r(i),onThumbPointerUp:$r(o),onThumbPositionChange:A,onThumbPointerDown:$r(l),children:a.jsx(Yt.div,{...f,ref:w,style:{position:"absolute",...f.style},onPointerDown:gt(t.onPointerDown,P=>{P.button===0&&(P.target.setPointerCapture(P.pointerId),v.current=g.getBoundingClientRect(),_.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),I(P))}),onPointerMove:gt(t.onPointerMove,I),onPointerUp:gt(t.onPointerUp,P=>{const k=P.target;k.hasPointerCapture(P.pointerId)&&k.releasePointerCapture(P.pointerId),document.body.style.webkitUserSelect=_.current,m.viewport&&(m.viewport.style.scrollBehavior=""),v.current=null})})})}),mw="ScrollAreaThumb",L6=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=D6(mw,t.__scopeScrollArea);return a.jsx(ws,{present:n||s.hasThumb,children:a.jsx(Uhe,{ref:e,...r})})}),Uhe=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:r,...s}=t,i=bo(mw,n),o=D6(mw,n),{onThumbPositionChange:l}=o,c=yn(e,h=>o.onThumbChange(h)),u=p.useRef(void 0),d=rb(()=>{u.current&&(u.current(),u.current=void 0)},100);return p.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(d(),!u.current){const m=Ghe(h,l);u.current=m,l()}};return l(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,d,l]),a.jsx(Yt.div,{"data-state":o.hasThumb?"visible":"hidden",...s,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:gt(t.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),g=h.clientX-m.left,x=h.clientY-m.top;o.onThumbPointerDown({x:g,y:x})}),onPointerUp:gt(t.onPointerUp,o.onThumbPointerUp)})});L6.displayName=mw;var _N="ScrollAreaCorner",F6=p.forwardRef((t,e)=>{const n=bo(_N,t.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?a.jsx(Bhe,{...t,ref:e}):null});F6.displayName=_N;var Bhe=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,...r}=t,s=bo(_N,n),[i,o]=p.useState(0),[l,c]=p.useState(0),u=!!(i&&l);return Zh(s.scrollbarX,()=>{var h;const d=((h=s.scrollbarX)==null?void 0:h.offsetHeight)||0;s.onCornerHeightChange(d),c(d)}),Zh(s.scrollbarY,()=>{var h;const d=((h=s.scrollbarY)==null?void 0:h.offsetWidth)||0;s.onCornerWidthChange(d),o(d)}),u?a.jsx(Yt.div,{...r,ref:e,style:{width:i,height:l,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function pw(t){return t?parseInt(t,10):0}function O6(t,e){const n=t/e;return isNaN(n)?0:n}function nb(t){const e=O6(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-n)*e;return Math.max(r,18)}function zhe(t,e,n,r="ltr"){const s=nb(n),i=s/2,o=e||i,l=s-o,c=n.scrollbar.paddingStart+o,u=n.scrollbar.size-n.scrollbar.paddingEnd-l,d=n.content-n.viewport,h=r==="ltr"?[0,d]:[d*-1,0];return V6([c,u],h)(t)}function YD(t,e,n="ltr"){const r=nb(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-s,o=e.content-e.viewport,l=i-r,c=n==="ltr"?[0,o]:[o*-1,0],u=jhe(t,c);return V6([0,o],[0,l])(u)}function V6(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function $6(t,e){return t>0&&t<e}var Ghe=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},r=0;return function s(){const i={left:t.scrollLeft,top:t.scrollTop},o=n.left!==i.left,l=n.top!==i.top;(o||l)&&e(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function rb(t,e){const n=$r(t),r=p.useRef(0);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),p.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,e)},[n,e])}function Zh(t,e){const n=$r(e);Sa(()=>{let r=0;if(t){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(t),()=>{window.cancelAnimationFrame(r),s.unobserve(t)}}},[t,n])}var U6=A6,Whe=R6,Hhe=F6;const xs=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(U6,{ref:r,className:Ct("relative overflow-hidden",t),...n,children:[a.jsx(Whe,{className:"h-full w-full rounded-[inherit]",children:e}),a.jsx(SN,{}),a.jsx(Hhe,{})]}));xs.displayName=U6.displayName;const SN=ht.forwardRef(({className:t,orientation:e="vertical",...n},r)=>a.jsx(wN,{ref:r,orientation:e,className:Ct("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:a.jsx(L6,{className:"relative flex-1 rounded-full bg-border"})}));SN.displayName=wN.displayName;const YE="RFC3986",JE={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},qhe="RFC1738",Khe=Array.isArray,ta=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),bS=1024,Yhe=(t,e,n,r,s)=>{if(t.length===0)return t;let i=t;if(typeof t=="symbol"?i=Symbol.prototype.toString.call(t):typeof t!="string"&&(i=String(t)),n==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let o="";for(let l=0;l<i.length;l+=bS){const c=i.length>=bS?i.slice(l,l+bS):i,u=[];for(let d=0;d<c.length;++d){let h=c.charCodeAt(d);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||s===qhe&&(h===40||h===41)){u[u.length]=c.charAt(d);continue}if(h<128){u[u.length]=ta[h];continue}if(h<2048){u[u.length]=ta[192|h>>6]+ta[128|h&63];continue}if(h<55296||h>=57344){u[u.length]=ta[224|h>>12]+ta[128|h>>6&63]+ta[128|h&63];continue}d+=1,h=65536+((h&1023)<<10|c.charCodeAt(d)&1023),u[u.length]=ta[240|h>>18]+ta[128|h>>12&63]+ta[128|h>>6&63]+ta[128|h&63]}o+=u.join("")}return o};function Jhe(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function JD(t,e){if(Khe(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const Xhe=Object.prototype.hasOwnProperty,B6={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},sa=Array.isArray,Qhe=Array.prototype.push,z6=function(t,e){Qhe.apply(t,sa(e)?e:[e])},Zhe=Date.prototype.toISOString,Kr={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Yhe,encodeValuesOnly:!1,format:YE,formatter:JE[YE],indices:!1,serializeDate(t){return Zhe.call(t)},skipNulls:!1,strictNullHandling:!1};function efe(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const _S={};function G6(t,e,n,r,s,i,o,l,c,u,d,h,f,m,g,x,w,v){let _=t,C=v,T=0,R=!1;for(;(C=C.get(_S))!==void 0&&!R;){const k=C.get(t);if(T+=1,typeof k<"u"){if(k===T)throw new RangeError("Cyclic object value");R=!0}typeof C.get(_S)>"u"&&(T=0)}if(typeof u=="function"?_=u(e,_):_ instanceof Date?_=f==null?void 0:f(_):n==="comma"&&sa(_)&&(_=JD(_,function(k){return k instanceof Date?f==null?void 0:f(k):k})),_===null){if(i)return c&&!x?c(e,Kr.encoder,w,"key",m):e;_=""}if(efe(_)||Jhe(_)){if(c){const k=x?e:c(e,Kr.encoder,w,"key",m);return[(g==null?void 0:g(k))+"="+(g==null?void 0:g(c(_,Kr.encoder,w,"value",m)))]}return[(g==null?void 0:g(e))+"="+(g==null?void 0:g(String(_)))]}const A=[];if(typeof _>"u")return A;let E;if(n==="comma"&&sa(_))x&&c&&(_=JD(_,c)),E=[{value:_.length>0?_.join(",")||null:void 0}];else if(sa(u))E=u;else{const k=Object.keys(_);E=d?k.sort(d):k}const I=l?String(e).replace(/\./g,"%2E"):String(e),P=r&&sa(_)&&_.length===1?I+"[]":I;if(s&&sa(_)&&_.length===0)return P+"[]";for(let k=0;k<E.length;++k){const j=E[k],D=typeof j=="object"&&typeof j.value<"u"?j.value:_[j];if(o&&D===null)continue;const M=h&&l?j.replace(/\./g,"%2E"):j,G=sa(_)?typeof n=="function"?n(P,M):P:P+(h?"."+M:"["+M+"]");v.set(t,T);const B=new WeakMap;B.set(_S,v),z6(A,G6(D,G,n,r,s,i,o,l,n==="comma"&&x&&sa(_)?null:c,u,d,h,f,m,g,x,w,B))}return A}function tfe(t=Kr){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Kr.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=YE;if(typeof t.format<"u"){if(!Xhe.call(JE,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=JE[n];let s=Kr.filter;(typeof t.filter=="function"||sa(t.filter))&&(s=t.filter);let i;if(t.arrayFormat&&t.arrayFormat in B6?i=t.arrayFormat:"indices"in t?i=t.indices?"indices":"repeat":i=Kr.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Kr.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Kr.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Kr.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Kr.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Kr.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Kr.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Kr.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Kr.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Kr.encodeValuesOnly,filter:s,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Kr.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Kr.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Kr.strictNullHandling}}function nfe(t,e={}){let n=t;const r=tfe(e);let s,i;typeof r.filter=="function"?(i=r.filter,n=i("",n)):sa(r.filter)&&(i=r.filter,s=i);const o=[];if(typeof n!="object"||n===null)return"";const l=B6[r.arrayFormat],c=l==="comma"&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const u=new WeakMap;for(let f=0;f<s.length;++f){const m=s[f];r.skipNulls&&n[m]===null||z6(o,G6(n[m],m,l,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}const d=o.join(r.delimiter);let h=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),d.length>0?h+d:""}const Hd="4.103.0";let XD=!1,np,W6,H6,XE,q6,K6,Y6,J6,X6;function rfe(t,e={auto:!1}){if(XD)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(np)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${np}'\``);XD=e.auto,np=t.kind,W6=t.fetch,t.Request,t.Response,t.Headers,H6=t.FormData,t.Blob,XE=t.File,q6=t.ReadableStream,K6=t.getMultipartRequestOptions,Y6=t.getDefaultAgent,J6=t.fileFromPath,X6=t.isFsReadStream}class sfe{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function ife({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new sfe(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}const Q6=()=>{np||rfe(ife(),{auto:!0})};Q6();class Bt extends Error{}class vs extends Bt{constructor(e,n,r,s){super(`${vs.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=n;const i=n;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e||!s)return new sb({message:r,cause:ZE(n)});const i=n==null?void 0:n.error;return e===400?new Z6(e,i,r,s):e===401?new eB(e,i,r,s):e===403?new tB(e,i,r,s):e===404?new nB(e,i,r,s):e===409?new rB(e,i,r,s):e===422?new sB(e,i,r,s):e===429?new iB(e,i,r,s):e>=500?new oB(e,i,r,s):new vs(e,i,r,s)}}class uo extends vs{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class sb extends vs{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class CN extends sb{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Z6 extends vs{}class eB extends vs{}class tB extends vs{}class nB extends vs{}class rB extends vs{}class sB extends vs{}class iB extends vs{}class oB extends vs{}class aB extends Bt{constructor(){super("Could not parse response content as the length limit was reached")}}class lB extends Bt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var Zy=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},su=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Pi;class ib{constructor(){Pi.set(this,void 0),this.buffer=new Uint8Array,Zy(this,Pi,null,"f")}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+n.length);r.set(this.buffer),r.set(n,this.buffer.length),this.buffer=r;const s=[];let i;for(;(i=ofe(this.buffer,su(this,Pi,"f")))!=null;){if(i.carriage&&su(this,Pi,"f")==null){Zy(this,Pi,i.index,"f");continue}if(su(this,Pi,"f")!=null&&(i.index!==su(this,Pi,"f")+1||i.carriage)){s.push(this.decodeText(this.buffer.slice(0,su(this,Pi,"f")-1))),this.buffer=this.buffer.slice(su(this,Pi,"f")),Zy(this,Pi,null,"f");continue}const o=su(this,Pi,"f")!==null?i.preceding-1:i.preceding,l=this.decodeText(this.buffer.slice(0,o));s.push(l),this.buffer=this.buffer.slice(i.index),Zy(this,Pi,null,"f")}return s}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Bt(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Bt(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Bt("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}Pi=new WeakMap;ib.NEWLINE_CHARS=new Set([`
`,"\r"]);ib.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function ofe(t,e){for(let s=e??0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function afe(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}function cB(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class ua{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const o of lfe(e,n))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null||o.event.startsWith("response.")||o.event.startsWith("transcript.")){let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(l&&l.error)throw new vs(void 0,l.error,void 0,gB(e.headers));yield l}else{let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(o.event=="error")throw new vs(void 0,l.error,l.message,void 0);yield{event:o.event,data:l}}}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||n.abort()}}return new ua(s,n)}static fromReadableStream(e,n){let r=!1;async function*s(){const o=new ib,l=cB(e);for await(const c of l)for(const u of o.decode(c))yield u;for(const c of o.flush())yield c}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const l of s())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||n.abort()}}return new ua(i,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),n.push(o)}return i.shift()}});return[new ua(()=>s(e),this.controller),new ua(()=>s(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new q6({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:o}=await n.next();if(o)return s.close();const l=r.encode(JSON.stringify(i)+`
`);s.enqueue(l)}catch(i){s.error(i)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*lfe(t,e){if(!t.body)throw e.abort(),new Bt("Attempted to iterate over a response with no body");const n=new ufe,r=new ib,s=cB(t.body);for await(const i of cfe(s))for(const o of r.decode(i)){const l=n.decode(o);l&&(yield l)}for(const i of r.flush()){const o=n.decode(i);o&&(yield o)}}async function*cfe(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=afe(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class ufe{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=dfe(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function dfe(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}const uB=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",dB=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&ob(t),ob=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",hfe=t=>dB(t)||uB(t)||X6(t);async function hB(t,e,n){var s;if(t=await t,dB(t))return t;if(uB(t)){const i=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=ob(i)?[await i.arrayBuffer()]:[i];return new XE(o,e,n)}const r=await ffe(t);if(e||(e=pfe(t)??"unknown_file"),!(n!=null&&n.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(n={...n,type:i})}return new XE(r,e,n)}async function ffe(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(ob(t))e.push(await t.arrayBuffer());else if(gfe(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(n=t==null?void 0:t.constructor)==null?void 0:n.name}; props: ${mfe(t)}`);return e}function mfe(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function pfe(t){var e;return SS(t.name)||SS(t.filename)||((e=SS(t.path))==null?void 0:e.split(/[\\/]/).pop())}const SS=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},gfe=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",QD=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",Yu=async t=>{const e=await yfe(t.body);return K6(e,t)},yfe=async t=>{const e=new H6;return await Promise.all(Object.entries(t||{}).map(([n,r])=>QE(e,n,r))),e},QE=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(hfe(n)){const r=await hB(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>QE(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>QE(t,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var xfe=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},vfe=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},ex;Q6();async function fB(t){var o;const{response:e}=t;if(t.options.stream)return cc("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):ua.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type"),r=(o=n==null?void 0:n.split(";")[0])==null?void 0:o.trim();if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.endsWith("+json"))){const l=await e.json();return cc("response",e.status,e.url,e.headers,l),mB(l,e)}const i=await e.text();return cc("response",e.status,e.url,e.headers,i),i}function mB(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class ab extends Promise{constructor(e,n=fB){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new ab(this.responsePromise,async n=>mB(e(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class wfe{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=CS("maxRetries",n),this.timeout=CS("timeout",r),this.httpAgent=s,this.fetch=i??W6}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Efe(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${Pfe()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&ob(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:n,...s,body:i}}))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:n=0}={}){var x;const r={...e},{method:s,path:i,query:o,headers:l={}}=r,c=ArrayBuffer.isView(r.body)||r.__binaryRequest&&typeof r.body=="string"?r.body:QD(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,u=this.calculateContentLength(c),d=this.buildURL(i,o);"timeout"in r&&CS("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const h=r.httpAgent??this.httpAgent??Y6(d),f=r.timeout+1e3;typeof((x=h==null?void 0:h.options)==null?void 0:x.timeout)=="number"&&f>(h.options.timeout??0)&&(h.options.timeout=f),this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:r,headers:l,contentLength:u,retryCount:n});return{req:{method:s,...c&&{body:c},headers:m,...h&&{agent:h},signal:r.signal??null},url:d,timeout:r.timeout}}buildHeaders({options:e,headers:n,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const o=this.defaultHeaders(e);return nM(i,o),nM(i,n),QD(e.body)&&np!=="node"&&delete i["content-type"],nx(o,"x-stainless-retry-count")===void 0&&nx(n,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),nx(o,"x-stainless-timeout")===void 0&&nx(n,"x-stainless-timeout")===void 0&&e.timeout&&(i["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(i,n),i}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,s){return vs.generate(e,n,r,s)}request(e,n=null){return new ab(this.makeRequest(e,n))}async makeRequest(e,n){var h,f;const r=await e,s=r.maxRetries??this.maxRetries;n==null&&(n=s),await this.prepareOptions(r);const{req:i,url:o,timeout:l}=this.buildRequest(r,{retryCount:s-n});if(await this.prepareRequest(i,{url:o,options:r}),cc("request",o,r,i.headers),(h=r.signal)!=null&&h.aborted)throw new uo;const c=new AbortController,u=await this.fetchWithTimeout(o,i,l,c).catch(ZE);if(u instanceof Error){if((f=r.signal)!=null&&f.aborted)throw new uo;if(n)return this.retryRequest(r,n);throw u.name==="AbortError"?new CN:new sb({cause:u})}const d=gB(u.headers);if(!u.ok){if(n&&this.shouldRetry(u)){const _=`retrying, ${n} attempts remaining`;return cc(`response (error; ${_})`,u.status,o,d),this.retryRequest(r,n,d)}const m=await u.text().catch(_=>ZE(_).message),g=Tfe(m),x=g?void 0:m;throw cc(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,u.status,o,d,x),this.makeStatusError(u.status,g,x,d)}return{response:u,options:r,controller:c}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new bfe(this,r,e)}buildURL(e,n){const r=Nfe(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return yB(s)||(n={...s,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new Bt(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,s){const{signal:i,...o}=n||{};i&&i.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),r),c={signal:s.signal,...o};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,e,c).finally(()=>{clearTimeout(l)})}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const l=parseFloat(i);Number.isNaN(l)||(s=l)}const o=r==null?void 0:r["retry-after"];if(o&&!s){const l=parseFloat(o);Number.isNaN(l)?s=Date.parse(o)-Date.now():s=l*1e3}if(!(s&&0<=s&&s<60*1e3)){const l=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,l)}return await Fg(s),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,o=Math.min(.5*Math.pow(2,i),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Hd}`}}class pB{constructor(e,n,r,s){ex.set(this,void 0),xfe(this,ex,e,"f"),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Bt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);n.query=void 0,n.path=e.url.toString()}return await vfe(this,ex,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(ex=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class bfe extends ab{constructor(e,n,r){super(n,async s=>new r(e,s.response,await fB(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const gB=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),_fe={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},hr=t=>typeof t=="object"&&t!==null&&!yB(t)&&Object.keys(t).every(e=>xB(_fe,e)),Sfe=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hd,"X-Stainless-OS":eM(Deno.build.os),"X-Stainless-Arch":ZD(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hd,"X-Stainless-OS":eM(process.platform),"X-Stainless-Arch":ZD(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=Cfe();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Cfe(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${s}.${i}.${o}`}}}return null}const ZD=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",eM=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let tM;const Efe=()=>tM??(tM=Sfe()),Tfe=t=>{try{return JSON.parse(t)}catch{return}},Ife=/^[a-z][a-z0-9+.-]*:/i,Nfe=t=>Ife.test(t),Fg=t=>new Promise(e=>setTimeout(e,t)),CS=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Bt(`${t} must be an integer`);if(e<0)throw new Bt(`${t} must be a positive integer`);return e},ZE=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},tx=t=>{var e,n,r,s,i;if(typeof process<"u")return((n=(e=process.env)==null?void 0:e[t])==null?void 0:n.trim())??void 0;if(typeof Deno<"u")return(i=(s=(r=Deno.env)==null?void 0:r.get)==null?void 0:s.call(r,t))==null?void 0:i.trim()};function yB(t){if(!t)return!0;for(const e in t)return!1;return!0}function xB(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function nM(t,e){for(const n in e){if(!xB(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];s===null?delete t[r]:s!==void 0&&(t[r]=s)}}const rM=new Set(["authorization","api-key"]);function cc(t,...e){var n;if(typeof process<"u"&&((n=process==null?void 0:process.env)==null?void 0:n.DEBUG)==="true"){const r=e.map(s=>{if(!s)return s;if(s.headers){const o={...s,headers:{...s.headers}};for(const l in s.headers)rM.has(l.toLowerCase())&&(o.headers[l]="REDACTED");return o}let i=null;for(const o in s)rM.has(o.toLowerCase())&&(i??(i={...s}),i[o]="REDACTED");return i??s});console.log(`OpenAI:DEBUG:${t}`,...r)}}const Pfe=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),Afe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",kfe=t=>typeof(t==null?void 0:t.get)=="function",nx=(t,e)=>{var r;const n=e.toLowerCase();if(kfe(t)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,o,l)=>o+l.toUpperCase());for(const i of[e,n,e.toUpperCase(),s]){const o=t.get(i);if(o)return o}}for(const[s,i]of Object.entries(t))if(s.toLowerCase()===n)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i},Rfe=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=e.charCodeAt(s);return Array.from(new Float32Array(r.buffer))}};function ES(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class lb extends pB{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Zr extends pB{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const n=(r=e[e.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class Wt{constructor(e){this._client=e}}let vB=class extends Wt{list(e,n={},r){return hr(n)?this.list(e,{},n):this._client.getAPIList(`/chat/completions/${e}/messages`,jfe,{query:n,...r})}},cb=class extends Wt{constructor(){super(...arguments),this.messages=new vB(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(`/chat/completions/${e}`,n)}update(e,n,r){return this._client.post(`/chat/completions/${e}`,{body:n,...r})}list(e={},n){return hr(e)?this.list({},e):this._client.getAPIList("/chat/completions",ub,{query:e,...n})}del(e,n){return this._client.delete(`/chat/completions/${e}`,n)}};class ub extends Zr{}class jfe extends Zr{}cb.ChatCompletionsPage=ub;cb.Messages=vB;let db=class extends Wt{constructor(){super(...arguments),this.completions=new cb(this._client)}};db.Completions=cb;db.ChatCompletionsPage=ub;class wB extends Wt{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}class bB extends Wt{create(e,n){return this._client.post("/audio/transcriptions",Yu({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}}))}}class _B extends Wt{create(e,n){return this._client.post("/audio/translations",Yu({body:e,...n,__metadata:{model:e.model}}))}}class Og extends Wt{constructor(){super(...arguments),this.transcriptions=new bB(this._client),this.translations=new _B(this._client),this.speech=new wB(this._client)}}Og.Transcriptions=bB;Og.Translations=_B;Og.Speech=wB;class EN extends Wt{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return hr(e)?this.list({},e):this._client.getAPIList("/batches",TN,{query:e,...n})}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}}class TN extends Zr{}EN.BatchesPage=TN;var Io=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},gr=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},eT,Yx,Jx,Sm,Cm,Xx,Em,Da,Tm,gw,yw,qd,SB;class IN{constructor(){eT.add(this),this.controller=new AbortController,Yx.set(this,void 0),Jx.set(this,()=>{}),Sm.set(this,()=>{}),Cm.set(this,void 0),Xx.set(this,()=>{}),Em.set(this,()=>{}),Da.set(this,{}),Tm.set(this,!1),gw.set(this,!1),yw.set(this,!1),qd.set(this,!1),Io(this,Yx,new Promise((e,n)=>{Io(this,Jx,e,"f"),Io(this,Sm,n,"f")}),"f"),Io(this,Cm,new Promise((e,n)=>{Io(this,Xx,e,"f"),Io(this,Em,n,"f")}),"f"),gr(this,Yx,"f").catch(()=>{}),gr(this,Cm,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},gr(this,eT,"m",SB).bind(this))},0)}_connected(){this.ended||(gr(this,Jx,"f").call(this),this._emit("connect"))}get ended(){return gr(this,Tm,"f")}get errored(){return gr(this,gw,"f")}get aborted(){return gr(this,yw,"f")}abort(){this.controller.abort()}on(e,n){return(gr(this,Da,"f")[e]||(gr(this,Da,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=gr(this,Da,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(gr(this,Da,"f")[e]||(gr(this,Da,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{Io(this,qd,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){Io(this,qd,!0,"f"),await gr(this,Cm,"f")}_emit(e,...n){if(gr(this,Tm,"f"))return;e==="end"&&(Io(this,Tm,!0,"f"),gr(this,Xx,"f").call(this));const r=gr(this,Da,"f")[e];if(r&&(gr(this,Da,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!gr(this,qd,"f")&&!(r!=null&&r.length)&&Promise.reject(s),gr(this,Sm,"f").call(this,s),gr(this,Em,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!gr(this,qd,"f")&&!(r!=null&&r.length)&&Promise.reject(s),gr(this,Sm,"f").call(this,s),gr(this,Em,"f").call(this,s),this._emit("end")}}_emitFinal(){}}Yx=new WeakMap,Jx=new WeakMap,Sm=new WeakMap,Cm=new WeakMap,Xx=new WeakMap,Em=new WeakMap,Da=new WeakMap,Tm=new WeakMap,gw=new WeakMap,yw=new WeakMap,qd=new WeakMap,eT=new WeakSet,SB=function(e){if(Io(this,gw,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new uo),e instanceof uo)return Io(this,yw,!0,"f"),this._emit("abort",e);if(e instanceof Bt)return this._emit("error",e);if(e instanceof Error){const n=new Bt(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new Bt(String(e)))};var Nt=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ni=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},fs,tT,ia,Qx,Po,Au,gh,gu,xw,ji,Zx,ev,rp,Im,Nm,sM,iM,oM,aM,lM,cM,uM;class Lo extends IN{constructor(){super(...arguments),fs.add(this),tT.set(this,[]),ia.set(this,{}),Qx.set(this,{}),Po.set(this,void 0),Au.set(this,void 0),gh.set(this,void 0),gu.set(this,void 0),xw.set(this,void 0),ji.set(this,void 0),Zx.set(this,void 0),ev.set(this,void 0),rp.set(this,void 0)}[(tT=new WeakMap,ia=new WeakMap,Qx=new WeakMap,Po=new WeakMap,Au=new WeakMap,gh=new WeakMap,gu=new WeakMap,xw=new WeakMap,ji=new WeakMap,Zx=new WeakMap,ev=new WeakMap,rp=new WeakMap,fs=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new Lo;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=ua.fromReadableStream(e,this.controller);for await(const o of s)Nt(this,fs,"m",Im).call(this,o);if((i=s.controller.signal)!=null&&i.aborted)throw new uo;return this._addRun(Nt(this,fs,"m",Nm).call(this))}toReadableStream(){return new ua(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,s,i){const o=new Lo;return o._run(()=>o._runToolAssistantStream(e,n,r,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,n,r,s,i){var u;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...s,stream:!0},c=await e.submitToolOutputs(n,r,l,{...i,signal:this.controller.signal});this._connected();for await(const d of c)Nt(this,fs,"m",Im).call(this,d);if((u=c.controller.signal)!=null&&u.aborted)throw new uo;return this._addRun(Nt(this,fs,"m",Nm).call(this))}static createThreadAssistantStream(e,n,r){const s=new Lo;return s._run(()=>s._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,n,r,s){const i=new Lo;return i._run(()=>i._runAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return Nt(this,Zx,"f")}currentRun(){return Nt(this,ev,"f")}currentMessageSnapshot(){return Nt(this,Po,"f")}currentRunStepSnapshot(){return Nt(this,rp,"f")}async finalRunSteps(){return await this.done(),Object.values(Nt(this,ia,"f"))}async finalMessages(){return await this.done(),Object.values(Nt(this,Qx,"f"))}async finalRun(){if(await this.done(),!Nt(this,Au,"f"))throw Error("Final run was not received.");return Nt(this,Au,"f")}async _createThreadAssistantStream(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const c of o)Nt(this,fs,"m",Im).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new uo;return this._addRun(Nt(this,fs,"m",Nm).call(this))}async _createAssistantStream(e,n,r,s){var c;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},l=await e.create(n,o,{...s,signal:this.controller.signal});this._connected();for await(const u of l)Nt(this,fs,"m",Im).call(this,u);if((c=l.controller.signal)!=null&&c.aborted)throw new uo;return this._addRun(Nt(this,fs,"m",Nm).call(this))}static accumulateDelta(e,n){for(const[r,s]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(ES(i)&&ES(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...s);continue}for(const o of s){if(!ES(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const l=o.index;if(l==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const c=i[l];c==null?i.push(o):i[l]=this.accumulateDelta(c,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,s){return await this._createAssistantStream(n,e,r,s)}async _runToolAssistantStream(e,n,r,s,i){return await this._createToolAssistantStream(r,e,n,s,i)}}Im=function(e){if(!this.ended)switch(Ni(this,Zx,e,"f"),Nt(this,fs,"m",oM).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Nt(this,fs,"m",uM).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Nt(this,fs,"m",iM).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Nt(this,fs,"m",sM).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Nm=function(){if(this.ended)throw new Bt("stream has ended, this shouldn't happen");if(!Nt(this,Au,"f"))throw Error("Final run has not been received");return Nt(this,Au,"f")},sM=function(e){const[n,r]=Nt(this,fs,"m",lM).call(this,e,Nt(this,Po,"f"));Ni(this,Po,n,"f"),Nt(this,Qx,"f")[n.id]=n;for(const s of r){const i=n.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,o=n.content[s.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=Nt(this,gh,"f")){if(Nt(this,gu,"f"))switch(Nt(this,gu,"f").type){case"text":this._emit("textDone",Nt(this,gu,"f").text,Nt(this,Po,"f"));break;case"image_file":this._emit("imageFileDone",Nt(this,gu,"f").image_file,Nt(this,Po,"f"));break}Ni(this,gh,s.index,"f")}Ni(this,gu,n.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Nt(this,gh,"f")!==void 0){const s=e.data.content[Nt(this,gh,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,Nt(this,Po,"f"));break;case"text":this._emit("textDone",s.text,Nt(this,Po,"f"));break}}Nt(this,Po,"f")&&this._emit("messageDone",e.data),Ni(this,Po,void 0,"f")}},iM=function(e){const n=Nt(this,fs,"m",aM).call(this,e);switch(Ni(this,rp,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==Nt(this,xw,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(Nt(this,ji,"f")&&this._emit("toolCallDone",Nt(this,ji,"f")),Ni(this,xw,i.index,"f"),Ni(this,ji,n.step_details.tool_calls[i.index],"f"),Nt(this,ji,"f")&&this._emit("toolCallCreated",Nt(this,ji,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Ni(this,rp,void 0,"f"),e.data.step_details.type=="tool_calls"&&Nt(this,ji,"f")&&(this._emit("toolCallDone",Nt(this,ji,"f")),Ni(this,ji,void 0,"f")),this._emit("runStepDone",e.data,n);break}},oM=function(e){Nt(this,tT,"f").push(e),this._emit("event",e)},aM=function(e){switch(e.event){case"thread.run.step.created":return Nt(this,ia,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=Nt(this,ia,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=Lo.accumulateDelta(n,r.delta);Nt(this,ia,"f")[e.data.id]=s}return Nt(this,ia,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Nt(this,ia,"f")[e.data.id]=e.data;break}if(Nt(this,ia,"f")[e.data.id])return Nt(this,ia,"f")[e.data.id];throw new Error("No snapshot available")},lM=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in n.content){let o=n.content[i.index];n.content[i.index]=Nt(this,fs,"m",cM).call(this,i,o)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},cM=function(e,n){return Lo.accumulateDelta(n,e)},uM=function(e){switch(Ni(this,ev,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Ni(this,Au,e.data,"f"),Nt(this,ji,"f")&&(this._emit("toolCallDone",Nt(this,ji,"f")),Ni(this,ji,void 0,"f"));break}};class NN extends Wt{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/assistants/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return hr(e)?this.list({},e):this._client.getAPIList("/assistants",PN,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class PN extends Zr{}NN.AssistantsPage=PN;function dM(t){return typeof t.parse=="function"}const Ah=t=>(t==null?void 0:t.role)==="assistant",CB=t=>(t==null?void 0:t.role)==="function",EB=t=>(t==null?void 0:t.role)==="tool";function AN(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function Vg(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function Dfe(t,e){return!e||!TB(e)?{...t,choices:t.choices.map(n=>({...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:kN(t,e)}function kN(t,e){const n=t.choices.map(r=>{var s;if(r.finish_reason==="length")throw new aB;if(r.finish_reason==="content_filter")throw new lB;return{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(i=>Lfe(e,i)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?Mfe(e,r.message.content):null}}});return{...t,choices:n}}function Mfe(t,e){var n,r;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=t.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function Lfe(t,e){var r;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Vg(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function Ffe(t,e){var r;if(!t)return!1;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return Vg(n)||(n==null?void 0:n.function.strict)||!1}function TB(t){var e;return AN(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>Vg(n)||n.type==="function"&&n.function.strict===!0))??!1}function Ofe(t){for(const e of t??[]){if(e.type!=="function")throw new Bt(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new Bt(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var ai=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ns,nT,vw,rT,sT,iT,IB,oT;const hM=10;class NB extends IN{constructor(){super(...arguments),Ns.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(CB(e)||EB(e))&&e.content)this._emit("functionCallResult",e.content);else if(Ah(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Ah(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new Bt("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),ai(this,Ns,"m",nT).call(this)}async finalMessage(){return await this.done(),ai(this,Ns,"m",vw).call(this)}async finalFunctionCall(){return await this.done(),ai(this,Ns,"m",rT).call(this)}async finalFunctionCallResult(){return await this.done(),ai(this,Ns,"m",sT).call(this)}async totalUsage(){return await this.done(),ai(this,Ns,"m",iT).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=ai(this,Ns,"m",vw).call(this);n&&this._emit("finalMessage",n);const r=ai(this,Ns,"m",nT).call(this);r&&this._emit("finalContent",r);const s=ai(this,Ns,"m",rT).call(this);s&&this._emit("finalFunctionCall",s);const i=ai(this,Ns,"m",sT).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",ai(this,Ns,"m",iT).call(this))}async _createChatCompletion(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),ai(this,Ns,"m",IB).call(this,n);const i=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(kN(i,n))}async _runChatCompletion(e,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,n,r)}async _runFunctions(e,n,r){var f;const s="function",{function_call:i="auto",stream:o,...l}=n,c=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:u=hM}=r||{},d={};for(const m of n.functions)d[m.name||m.function.name]=m;const h=n.functions.map(m=>({name:m.name||m.function.name,parameters:m.parameters,description:m.description}));for(const m of n.messages)this._addMessage(m,!1);for(let m=0;m<u;++m){const x=(f=(await this._createChatCompletion(e,{...l,function_call:i,functions:h,messages:[...this.messages]},r)).choices[0])==null?void 0:f.message;if(!x)throw new Bt("missing message in ChatCompletion response");if(!x.function_call)return;const{name:w,arguments:v}=x.function_call,_=d[w];if(_){if(c&&c!==w){const A=`Invalid function_call: ${JSON.stringify(w)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,name:w,content:A});continue}}else{const A=`Invalid function_call: ${JSON.stringify(w)}. Available options are: ${h.map(E=>JSON.stringify(E.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:w,content:A});continue}let C;try{C=dM(_)?await _.parse(v):v}catch(A){this._addMessage({role:s,name:w,content:A instanceof Error?A.message:String(A)});continue}const T=await _.function(C,this),R=ai(this,Ns,"m",oT).call(this,T);if(this._addMessage({role:s,name:w,content:R}),c)return}}async _runTools(e,n,r){var m,g,x;const s="tool",{tool_choice:i="auto",stream:o,...l}=n,c=typeof i!="string"&&((m=i==null?void 0:i.function)==null?void 0:m.name),{maxChatCompletions:u=hM}=r||{},d=n.tools.map(w=>{if(Vg(w)){if(!w.$callback)throw new Bt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:w.$callback,name:w.function.name,description:w.function.description||"",parameters:w.function.parameters,parse:w.$parseRaw,strict:!0}}}return w}),h={};for(const w of d)w.type==="function"&&(h[w.function.name||w.function.function.name]=w.function);const f="tools"in n?d.map(w=>w.type==="function"?{type:"function",function:{name:w.function.name||w.function.function.name,parameters:w.function.parameters,description:w.function.description,strict:w.function.strict}}:w):void 0;for(const w of n.messages)this._addMessage(w,!1);for(let w=0;w<u;++w){const _=(g=(await this._createChatCompletion(e,{...l,tool_choice:i,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:g.message;if(!_)throw new Bt("missing message in ChatCompletion response");if(!((x=_.tool_calls)!=null&&x.length))return;for(const C of _.tool_calls){if(C.type!=="function")continue;const T=C.id,{name:R,arguments:A}=C.function,E=h[R];if(E){if(c&&c!==R){const j=`Invalid tool_call: ${JSON.stringify(R)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,tool_call_id:T,content:j});continue}}else{const j=`Invalid tool_call: ${JSON.stringify(R)}. Available options are: ${Object.keys(h).map(D=>JSON.stringify(D)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:T,content:j});continue}let I;try{I=dM(E)?await E.parse(A):A}catch(j){const D=j instanceof Error?j.message:String(j);this._addMessage({role:s,tool_call_id:T,content:D});continue}const P=await E.function(I,this),k=ai(this,Ns,"m",oT).call(this,P);if(this._addMessage({role:s,tool_call_id:T,content:k}),c)return}}}}Ns=new WeakSet,nT=function(){return ai(this,Ns,"m",vw).call(this).content??null},vw=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Ah(n)){const{function_call:r,...s}=n,i={...s,content:n.content??null,refusal:n.refusal??null};return r&&(i.function_call=r),i}}throw new Bt("stream ended without producing a ChatCompletionMessage with role=assistant")},rT=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Ah(s)&&(s!=null&&s.function_call))return s.function_call;if(Ah(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(n=s.tool_calls.at(-1))==null?void 0:n.function}},sT=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(CB(n)&&n.content!=null||EB(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},iT=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},IB=function(e){if(e.n!=null&&e.n>1)throw new Bt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},oT=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Wp extends NB{static runFunctions(e,n,r){const s=new Wp,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Wp,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}_addMessage(e,n=!0){super._addMessage(e,n),Ah(e)&&e.content&&this._emit("content",e.content)}}const PB=1,AB=2,kB=4,RB=8,jB=16,DB=32,MB=64,LB=128,FB=256,OB=LB|FB,VB=jB|DB|OB|MB,$B=PB|AB|VB,UB=kB|RB,Vfe=$B|UB,ss={STR:PB,NUM:AB,ARR:kB,OBJ:RB,NULL:jB,BOOL:DB,NAN:MB,INFINITY:LB,MINUS_INFINITY:FB,INF:OB,SPECIAL:VB,ATOM:$B,COLLECTION:UB,ALL:Vfe};class $fe extends Error{}class Ufe extends Error{}function Bfe(t,e=ss.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return zfe(t.trim(),e)}const zfe=(t,e)=>{const n=t.length;let r=0;const s=f=>{throw new $fe(`${f} at position ${r}`)},i=f=>{throw new Ufe(`${f} at position ${r}`)},o=()=>(h(),r>=n&&s("Unexpected end of input"),t[r]==='"'?l():t[r]==="{"?c():t[r]==="["?u():t.substring(r,r+4)==="null"||ss.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||ss.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||ss.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||ss.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||ss.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||ss.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):d()),l=()=>{const f=r;let m=!1;for(r++;r<n&&(t[r]!=='"'||m&&t[r-1]==="\\");)m=t[r]==="\\"?!m:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(f,++r-Number(m)))}catch(g){i(String(g))}else if(ss.STR&e)try{return JSON.parse(t.substring(f,r-Number(m))+'"')}catch{return JSON.parse(t.substring(f,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{r++,h();const f={};try{for(;t[r]!=="}";){if(h(),r>=n&&ss.OBJ&e)return f;const m=l();h(),r++;try{const g=o();Object.defineProperty(f,m,{value:g,writable:!0,enumerable:!0,configurable:!0})}catch(g){if(ss.OBJ&e)return f;throw g}h(),t[r]===","&&r++}}catch{if(ss.OBJ&e)return f;s("Expected '}' at end of object")}return r++,f},u=()=>{r++;const f=[];try{for(;t[r]!=="]";)f.push(o()),h(),t[r]===","&&r++}catch{if(ss.ARR&e)return f;s("Expected ']' at end of array")}return r++,f},d=()=>{if(r===0){t==="-"&&ss.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(m){if(ss.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}i(String(m))}}const f=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(ss.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(t.substring(f,r))}catch{t.substring(f,r)==="-"&&ss.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(f,t.lastIndexOf("e")))}catch(g){i(String(g))}}},h=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return o()},fM=t=>Bfe(t,ss.ALL^ss.NUM);var Rd=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Bn=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},qr,ja,jd,Cl,TS,rx,IS,NS,PS,sx,AS,mM;class Hp extends NB{constructor(e){super(),qr.add(this),ja.set(this,void 0),jd.set(this,void 0),Cl.set(this,void 0),Rd(this,ja,e,"f"),Rd(this,jd,[],"f")}get currentChatCompletionSnapshot(){return Bn(this,Cl,"f")}static fromReadableStream(e){const n=new Hp(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const s=new Hp(n);return s._run(()=>s._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,n,r){var o;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Bn(this,qr,"m",TS).call(this);const i=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const l of i)Bn(this,qr,"m",IS).call(this,l);if((o=i.controller.signal)!=null&&o.aborted)throw new uo;return this._addChatCompletion(Bn(this,qr,"m",sx).call(this))}async _fromReadableStream(e,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Bn(this,qr,"m",TS).call(this),this._connected();const s=ua.fromReadableStream(e,this.controller);let i;for await(const l of s)i&&i!==l.id&&this._addChatCompletion(Bn(this,qr,"m",sx).call(this)),Bn(this,qr,"m",IS).call(this,l),i=l.id;if((o=s.controller.signal)!=null&&o.aborted)throw new uo;return this._addChatCompletion(Bn(this,qr,"m",sx).call(this))}[(ja=new WeakMap,jd=new WeakMap,Cl=new WeakMap,qr=new WeakSet,TS=function(){this.ended||Rd(this,Cl,void 0,"f")},rx=function(n){let r=Bn(this,jd,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Bn(this,jd,"f")[n.index]=r,r)},IS=function(n){var s,i,o,l,c,u,d,h,f,m,g,x,w,v,_;if(this.ended)return;const r=Bn(this,qr,"m",mM).call(this,n);this._emit("chunk",n,r);for(const C of n.choices){const T=r.choices[C.index];C.delta.content!=null&&((s=T.message)==null?void 0:s.role)==="assistant"&&((i=T.message)!=null&&i.content)&&(this._emit("content",C.delta.content,T.message.content),this._emit("content.delta",{delta:C.delta.content,snapshot:T.message.content,parsed:T.message.parsed})),C.delta.refusal!=null&&((o=T.message)==null?void 0:o.role)==="assistant"&&((l=T.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:C.delta.refusal,snapshot:T.message.refusal}),((c=C.logprobs)==null?void 0:c.content)!=null&&((u=T.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(d=C.logprobs)==null?void 0:d.content,snapshot:((h=T.logprobs)==null?void 0:h.content)??[]}),((f=C.logprobs)==null?void 0:f.refusal)!=null&&((m=T.message)==null?void 0:m.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(g=C.logprobs)==null?void 0:g.refusal,snapshot:((x=T.logprobs)==null?void 0:x.refusal)??[]});const R=Bn(this,qr,"m",rx).call(this,T);T.finish_reason&&(Bn(this,qr,"m",PS).call(this,T),R.current_tool_call_index!=null&&Bn(this,qr,"m",NS).call(this,T,R.current_tool_call_index));for(const A of C.delta.tool_calls??[])R.current_tool_call_index!==A.index&&(Bn(this,qr,"m",PS).call(this,T),R.current_tool_call_index!=null&&Bn(this,qr,"m",NS).call(this,T,R.current_tool_call_index)),R.current_tool_call_index=A.index;for(const A of C.delta.tool_calls??[]){const E=(w=T.message.tool_calls)==null?void 0:w[A.index];E!=null&&E.type&&((E==null?void 0:E.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=E.function)==null?void 0:v.name,index:A.index,arguments:E.function.arguments,parsed_arguments:E.function.parsed_arguments,arguments_delta:((_=A.function)==null?void 0:_.arguments)??""}):(E==null||E.type,void 0))}}},NS=function(n,r){var o,l,c;if(Bn(this,qr,"m",rx).call(this,n).done_tool_calls.has(r))return;const i=(o=n.message.tool_calls)==null?void 0:o[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const u=(c=(l=Bn(this,ja,"f"))==null?void 0:l.tools)==null?void 0:c.find(d=>d.type==="function"&&d.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:Vg(u)?u.$parseRaw(i.function.arguments):u!=null&&u.function.strict?JSON.parse(i.function.arguments):null})}else i.type},PS=function(n){var s,i;const r=Bn(this,qr,"m",rx).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const o=Bn(this,qr,"m",AS).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(s=n.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(i=n.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},sx=function(){if(this.ended)throw new Bt("stream has ended, this shouldn't happen");const n=Bn(this,Cl,"f");if(!n)throw new Bt("request ended without sending any chunks");return Rd(this,Cl,void 0,"f"),Rd(this,jd,[],"f"),Gfe(n,Bn(this,ja,"f"))},AS=function(){var r;const n=(r=Bn(this,ja,"f"))==null?void 0:r.response_format;return AN(n)?n:null},mM=function(n){var r,s,i,o;let l=Bn(this,Cl,"f");const{choices:c,...u}=n;l?Object.assign(l,u):l=Rd(this,Cl,{...u,choices:[]},"f");for(const{delta:d,finish_reason:h,index:f,logprobs:m=null,...g}of n.choices){let x=l.choices[f];if(x||(x=l.choices[f]={finish_reason:h,index:f,message:{},logprobs:m,...g}),m)if(!x.logprobs)x.logprobs=Object.assign({},m);else{const{content:A,refusal:E,...I}=m;Object.assign(x.logprobs,I),A&&((r=x.logprobs).content??(r.content=[]),x.logprobs.content.push(...A)),E&&((s=x.logprobs).refusal??(s.refusal=[]),x.logprobs.refusal.push(...E))}if(h&&(x.finish_reason=h,Bn(this,ja,"f")&&TB(Bn(this,ja,"f")))){if(h==="length")throw new aB;if(h==="content_filter")throw new lB}if(Object.assign(x,g),!d)continue;const{content:w,refusal:v,function_call:_,role:C,tool_calls:T,...R}=d;if(Object.assign(x.message,R),v&&(x.message.refusal=(x.message.refusal||"")+v),C&&(x.message.role=C),_&&(x.message.function_call?(_.name&&(x.message.function_call.name=_.name),_.arguments&&((i=x.message.function_call).arguments??(i.arguments=""),x.message.function_call.arguments+=_.arguments)):x.message.function_call=_),w&&(x.message.content=(x.message.content||"")+w,!x.message.refusal&&Bn(this,qr,"m",AS).call(this)&&(x.message.parsed=fM(x.message.content))),T){x.message.tool_calls||(x.message.tool_calls=[]);for(const{index:A,id:E,type:I,function:P,...k}of T){const j=(o=x.message.tool_calls)[A]??(o[A]={});Object.assign(j,k),E&&(j.id=E),I&&(j.type=I),P&&(j.function??(j.function={name:P.name??"",arguments:""})),P!=null&&P.name&&(j.function.name=P.name),P!=null&&P.arguments&&(j.function.arguments+=P.arguments,Ffe(Bn(this,ja,"f"),j)&&(j.function.parsed_arguments=fM(j.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ua(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Gfe(t,e){const{id:n,choices:r,created:s,model:i,system_fingerprint:o,...l}=t,c={...l,id:n,choices:r.map(({message:u,finish_reason:d,index:h,logprobs:f,...m})=>{if(!d)throw new Bt(`missing finish_reason for choice ${h}`);const{content:g=null,function_call:x,tool_calls:w,...v}=u,_=u.role;if(!_)throw new Bt(`missing role for choice ${h}`);if(x){const{arguments:C,name:T}=x;if(C==null)throw new Bt(`missing function_call.arguments for choice ${h}`);if(!T)throw new Bt(`missing function_call.name for choice ${h}`);return{...m,message:{content:g,function_call:{arguments:C,name:T},role:_,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}return w?{...m,index:h,finish_reason:d,logprobs:f,message:{...v,role:_,content:g,refusal:u.refusal??null,tool_calls:w.map((C,T)=>{const{function:R,type:A,id:E,...I}=C,{arguments:P,name:k,...j}=R||{};if(E==null)throw new Bt(`missing choices[${h}].tool_calls[${T}].id
${ix(t)}`);if(A==null)throw new Bt(`missing choices[${h}].tool_calls[${T}].type
${ix(t)}`);if(k==null)throw new Bt(`missing choices[${h}].tool_calls[${T}].function.name
${ix(t)}`);if(P==null)throw new Bt(`missing choices[${h}].tool_calls[${T}].function.arguments
${ix(t)}`);return{...I,id:E,type:A,function:{...j,name:k,arguments:P}}})}}:{...m,message:{...v,content:g,role:_,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}),created:s,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return Dfe(c,e)}function ix(t){return JSON.stringify(t)}class kh extends Hp{static fromReadableStream(e){const n=new kh(null);return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,r){const s=new kh(null),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new kh(n),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}}let BB=class extends Wt{parse(e,n){return Ofe(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>kN(r,e))}runFunctions(e,n){return e.stream?kh.runFunctions(this._client,e,n):Wp.runFunctions(this._client,e,n)}runTools(e,n){return e.stream?kh.runTools(this._client,e,n):Wp.runTools(this._client,e,n)}stream(e,n){return Hp.createChatCompletion(this._client,e,n)}};class aT extends Wt{constructor(){super(...arguments),this.completions=new BB(this._client)}}(function(t){t.Completions=BB})(aT||(aT={}));class zB extends Wt{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class GB extends Wt{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class hb extends Wt{constructor(){super(...arguments),this.sessions=new zB(this._client),this.transcriptionSessions=new GB(this._client)}}hb.Sessions=zB;hb.TranscriptionSessions=GB;class RN extends Wt{create(e,n,r){return this._client.post(`/threads/${e}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/messages/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return hr(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,jN,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class jN extends Zr{}RN.MessagesPage=jN;class DN extends Wt{retrieve(e,n,r,s={},i){return hr(s)?this.retrieve(e,n,r,{},s):this._client.get(`/threads/${e}/runs/${n}/steps/${r}`,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,n,r={},s){return hr(r)?this.list(e,n,{},r):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,MN,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class MN extends Zr{}DN.RunStepsPage=MN;let $g=class extends Wt{constructor(){super(...arguments),this.steps=new DN(this._client)}create(e,n,r){const{include:s,...i}=n;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:i,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(e,n,r){return this._client.get(`/threads/${e}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return hr(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,LN,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}createAndStream(e,n,r){return Lo.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await Fg(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,n,r){return Lo.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,n,r,s){const i=await this.submitToolOutputs(e,n,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,n,r,s){return Lo.createToolAssistantStream(e,n,this._client.beta.threads.runs,r,s)}};class LN extends Zr{}$g.RunsPage=LN;$g.Steps=DN;$g.RunStepsPage=MN;class If extends Wt{constructor(){super(...arguments),this.runs=new $g(this._client),this.messages=new RN(this._client)}create(e={},n){return hr(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/threads/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(e,n){return Lo.createThreadAssistantStream(e,this._client.beta.threads,n)}}If.Runs=$g;If.RunsPage=LN;If.Messages=RN;If.MessagesPage=jN;class Nf extends Wt{constructor(){super(...arguments),this.realtime=new hb(this._client),this.chat=new aT(this._client),this.assistants=new NN(this._client),this.threads=new If(this._client)}}Nf.Realtime=hb;Nf.Assistants=NN;Nf.AssistantsPage=PN;Nf.Threads=If;class WB extends Wt{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}let HB=class extends Wt{retrieve(e,n,r){return this._client.get(`/containers/${e}/files/${n}/content`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}},fb=class extends Wt{constructor(){super(...arguments),this.content=new HB(this._client)}create(e,n,r){return this._client.post(`/containers/${e}/files`,Yu({body:n,...r}))}retrieve(e,n,r){return this._client.get(`/containers/${e}/files/${n}`,r)}list(e,n={},r){return hr(n)?this.list(e,{},n):this._client.getAPIList(`/containers/${e}/files`,FN,{query:n,...r})}del(e,n,r){return this._client.delete(`/containers/${e}/files/${n}`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}};class FN extends Zr{}fb.FileListResponsesPage=FN;fb.Content=HB;class Ug extends Wt{constructor(){super(...arguments),this.files=new fb(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(`/containers/${e}`,n)}list(e={},n){return hr(e)?this.list({},e):this._client.getAPIList("/containers",ON,{query:e,...n})}del(e,n){return this._client.delete(`/containers/${e}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}}class ON extends Zr{}Ug.ContainerListResponsesPage=ON;Ug.Files=fb;Ug.FileListResponsesPage=FN;class qB extends Wt{create(e,n){const r=!!e.encoding_format;let s=r?e.encoding_format:"base64";r&&cc("Request","User defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:s},...n});return r?i:(cc("response","Decoding base64 embeddings to float32 array"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(l=>{const c=l.embedding;l.embedding=Rfe(c)}),o)))}}class VN extends Wt{retrieve(e,n,r,s){return this._client.get(`/evals/${e}/runs/${n}/output_items/${r}`,s)}list(e,n,r={},s){return hr(r)?this.list(e,n,{},r):this._client.getAPIList(`/evals/${e}/runs/${n}/output_items`,$N,{query:r,...s})}}class $N extends Zr{}VN.OutputItemListResponsesPage=$N;class Bg extends Wt{constructor(){super(...arguments),this.outputItems=new VN(this._client)}create(e,n,r){return this._client.post(`/evals/${e}/runs`,{body:n,...r})}retrieve(e,n,r){return this._client.get(`/evals/${e}/runs/${n}`,r)}list(e,n={},r){return hr(n)?this.list(e,{},n):this._client.getAPIList(`/evals/${e}/runs`,UN,{query:n,...r})}del(e,n,r){return this._client.delete(`/evals/${e}/runs/${n}`,r)}cancel(e,n,r){return this._client.post(`/evals/${e}/runs/${n}`,r)}}class UN extends Zr{}Bg.RunListResponsesPage=UN;Bg.OutputItems=VN;Bg.OutputItemListResponsesPage=$N;class zg extends Wt{constructor(){super(...arguments),this.runs=new Bg(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(`/evals/${e}`,n)}update(e,n,r){return this._client.post(`/evals/${e}`,{body:n,...r})}list(e={},n){return hr(e)?this.list({},e):this._client.getAPIList("/evals",BN,{query:e,...n})}del(e,n){return this._client.delete(`/evals/${e}`,n)}}class BN extends Zr{}zg.EvalListResponsesPage=BN;zg.Runs=Bg;zg.RunListResponsesPage=UN;let zN=class extends Wt{create(e,n){return this._client.post("/files",Yu({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return hr(e)?this.list({},e):this._client.getAPIList("/files",GN,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,n)}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!s.has(o.status);)if(await Fg(n),o=await this.retrieve(e),Date.now()-i>r)throw new CN({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}};class GN extends Zr{}zN.FileObjectsPage=GN;class KB extends Wt{}let YB=class extends Wt{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class WN extends Wt{constructor(){super(...arguments),this.graders=new YB(this._client)}}WN.Graders=YB;class HN extends Wt{create(e,n,r){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,qN,{body:n,method:"post",...r})}retrieve(e,n={},r){return hr(n)?this.retrieve(e,{},n):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...r})}del(e,n,r){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${n}`,r)}}class qN extends lb{}HN.PermissionCreateResponsesPage=qN;let mb=class extends Wt{constructor(){super(...arguments),this.permissions=new HN(this._client)}};mb.Permissions=HN;mb.PermissionCreateResponsesPage=qN;class KN extends Wt{list(e,n={},r){return hr(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,YN,{query:n,...r})}}class YN extends Zr{}KN.FineTuningJobCheckpointsPage=YN;class Pf extends Wt{constructor(){super(...arguments),this.checkpoints=new KN(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return hr(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",JN,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return hr(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,XN,{query:n,...r})}pause(e,n){return this._client.post(`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(`/fine_tuning/jobs/${e}/resume`,n)}}class JN extends Zr{}class XN extends Zr{}Pf.FineTuningJobsPage=JN;Pf.FineTuningJobEventsPage=XN;Pf.Checkpoints=KN;Pf.FineTuningJobCheckpointsPage=YN;class $c extends Wt{constructor(){super(...arguments),this.methods=new KB(this._client),this.jobs=new Pf(this._client),this.checkpoints=new mb(this._client),this.alpha=new WN(this._client)}}$c.Methods=KB;$c.Jobs=Pf;$c.FineTuningJobsPage=JN;$c.FineTuningJobEventsPage=XN;$c.Checkpoints=mb;$c.Alpha=WN;class JB extends Wt{}class QN extends Wt{constructor(){super(...arguments),this.graderModels=new JB(this._client)}}QN.GraderModels=JB;class XB extends Wt{createVariation(e,n){return this._client.post("/images/variations",Yu({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",Yu({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}class ZN extends Wt{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",eP,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class eP extends lb{}ZN.ModelsPage=eP;class QB extends Wt{create(e,n){return this._client.post("/moderations",{body:e,...n})}}function Wfe(t,e){return!e||!qfe(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(r=>({...r,parsed:null}))}:n)}:ZB(t,e)}function ZB(t,e){const n=t.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:Jfe(e,s)};if(s.type==="message"){const i=s.content.map(o=>o.type==="output_text"?{...o,parsed:Hfe(e,o.text)}:o);return{...s,content:i}}return s}),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||lT(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const s of r.output)if(s.type==="message"){for(const i of s.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),r}function Hfe(t,e){var n,r,s,i;return((r=(n=t.text)==null?void 0:n.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((s=t.text)==null?void 0:s.format)?((i=t.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function qfe(t){var e;return!!AN((e=t.text)==null?void 0:e.format)}function Kfe(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function Yfe(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function Jfe(t,e){const n=Yfe(t.tools??[],e.name);return{...e,...e,parsed_arguments:Kfe(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function lT(t){const e=[];for(const n of t.output)if(n.type==="message")for(const r of n.content)r.type==="output_text"&&e.push(r.text);t.output_text=e.join("")}class ez extends Wt{list(e,n={},r){return hr(n)?this.list(e,{},n):this._client.getAPIList(`/responses/${e}/input_items`,Qfe,{query:n,...r})}}var Dd=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},El=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Md,ox,Tl,ax,pM,gM,yM,xM;class tP extends IN{constructor(e){super(),Md.add(this),ox.set(this,void 0),Tl.set(this,void 0),ax.set(this,void 0),Dd(this,ox,e,"f")}static createResponse(e,n,r){const s=new tP(n);return s._run(()=>s._createOrRetrieveResponse(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createOrRetrieveResponse(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),El(this,Md,"m",pM).call(this);let i,o=null;"response_id"in n?(i=await e.responses.retrieve(n.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),o=n.starting_after??null):i=await e.responses.create({...n,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const c of i)El(this,Md,"m",gM).call(this,c,o);if((l=i.controller.signal)!=null&&l.aborted)throw new uo;return El(this,Md,"m",yM).call(this)}[(ox=new WeakMap,Tl=new WeakMap,ax=new WeakMap,Md=new WeakSet,pM=function(){this.ended||Dd(this,Tl,void 0,"f")},gM=function(n,r){if(this.ended)return;const s=(o,l)=>{(r==null||l.sequence_number>r)&&this._emit(o,l)},i=El(this,Md,"m",xM).call(this,n);switch(s("event",n),n.type){case"response.output_text.delta":{const o=i.output[n.output_index];if(!o)throw new Bt(`missing output at index ${n.output_index}`);if(o.type==="message"){const l=o.content[n.content_index];if(!l)throw new Bt(`missing content at index ${n.content_index}`);if(l.type!=="output_text")throw new Bt(`expected content to be 'output_text', got ${l.type}`);s("response.output_text.delta",{...n,snapshot:l.text})}break}case"response.function_call_arguments.delta":{const o=i.output[n.output_index];if(!o)throw new Bt(`missing output at index ${n.output_index}`);o.type==="function_call"&&s("response.function_call_arguments.delta",{...n,snapshot:o.arguments});break}default:s(n.type,n);break}},yM=function(){if(this.ended)throw new Bt("stream has ended, this shouldn't happen");const n=El(this,Tl,"f");if(!n)throw new Bt("request ended without sending any events");Dd(this,Tl,void 0,"f");const r=Xfe(n,El(this,ox,"f"));return Dd(this,ax,r,"f"),r},xM=function(n){let r=El(this,Tl,"f");if(!r){if(n.type!=="response.created")throw new Bt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return r=Dd(this,Tl,n.response,"f"),r}switch(n.type){case"response.output_item.added":{r.output.push(n.item);break}case"response.content_part.added":{const s=r.output[n.output_index];if(!s)throw new Bt(`missing output at index ${n.output_index}`);s.type==="message"&&s.content.push(n.part);break}case"response.output_text.delta":{const s=r.output[n.output_index];if(!s)throw new Bt(`missing output at index ${n.output_index}`);if(s.type==="message"){const i=s.content[n.content_index];if(!i)throw new Bt(`missing content at index ${n.content_index}`);if(i.type!=="output_text")throw new Bt(`expected content to be 'output_text', got ${i.type}`);i.text+=n.delta}break}case"response.function_call_arguments.delta":{const s=r.output[n.output_index];if(!s)throw new Bt(`missing output at index ${n.output_index}`);s.type==="function_call"&&(s.arguments+=n.delta);break}case"response.completed":{Dd(this,Tl,n.response,"f");break}}return r},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=El(this,ax,"f");if(!e)throw new Bt("stream ended without producing a ChatCompletion");return e}}function Xfe(t,e){return Wfe(t,e)}class nP extends Wt{constructor(){super(...arguments),this.inputItems=new ez(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&lT(r),r))}retrieve(e,n={},r){return hr(n)&&r===void 0?this.retrieve(e,{},n):this._client.get(`/responses/${e}`,{query:n,...r,stream:n.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&lT(s),s))}del(e,n){return this._client.delete(`/responses/${e}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(r=>ZB(r,e))}stream(e,n){return tP.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(`/responses/${e}/cancel`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}}class Qfe extends Zr{}nP.InputItems=ez;class tz extends Wt{create(e,n,r){return this._client.post(`/uploads/${e}/parts`,Yu({body:n,...r}))}}class rP extends Wt{constructor(){super(...arguments),this.parts=new tz(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(`/uploads/${e}/complete`,{body:n,...r})}}rP.Parts=tz;const Zfe=async t=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};class pb extends Wt{create(e,n,r){return this._client.post(`/vector_stores/${e}/files`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/vector_stores/${e}/files/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return hr(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,gb,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,n,{...r,headers:s}).withResponse(),o=i.data;switch(o.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=i.response.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await Fg(l);break;case"failed":case"completed":return o}}}async upload(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,n,r){const s=await this.upload(e,n,r);return await this.poll(e,s.id,r)}content(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/files/${n}/content`,sP,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class gb extends Zr{}class sP extends lb{}pb.VectorStoreFilesPage=gb;pb.FileContentResponsesPage=sP;class nz extends Wt{create(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n);return await this.poll(e,s.id,r)}listFiles(e,n,r={},s){return hr(r)?this.listFiles(e,n,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,gb,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await Fg(l);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},s){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(s==null?void 0:s.maxConcurrency)??5,o=Math.min(i,n.length),l=this._client,c=n.values(),u=[...r];async function d(f){for(let m of f){const g=await l.files.create({file:m,purpose:"assistants"},s);u.push(g.id)}}const h=Array(o).fill(c).map(d);return await Zfe(h),await this.createAndPoll(e,{file_ids:u})}}class Uc extends Wt{constructor(){super(...arguments),this.files=new pb(this._client),this.fileBatches=new nz(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/vector_stores/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return hr(e)?this.list({},e):this._client.getAPIList("/vector_stores",iP,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}search(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/search`,oP,{body:n,method:"post",...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class iP extends Zr{}class oP extends lb{}Uc.VectorStoresPage=iP;Uc.VectorStoreSearchResponsesPage=oP;Uc.Files=pb;Uc.VectorStoreFilesPage=gb;Uc.FileContentResponsesPage=sP;Uc.FileBatches=nz;var rz;class Zt extends wfe{constructor({baseURL:e=tx("OPENAI_BASE_URL"),apiKey:n=tx("OPENAI_API_KEY"),organization:r=tx("OPENAI_ORG_ID")??null,project:s=tx("OPENAI_PROJECT_ID")??null,...i}={}){if(n===void 0)throw new Bt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:n,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&Afe())throw new Bt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new WB(this),this.chat=new db(this),this.embeddings=new qB(this),this.files=new zN(this),this.images=new XB(this),this.audio=new Og(this),this.moderations=new QB(this),this.models=new ZN(this),this.fineTuning=new $c(this),this.graders=new QN(this),this.vectorStores=new Uc(this),this.beta=new Nf(this),this.batches=new EN(this),this.uploads=new rP(this),this.responses=new nP(this),this.evals=new zg(this),this.containers=new Ug(this),this._options=o,this.apiKey=n,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return nfe(e,{arrayFormat:"brackets"})}}rz=Zt;Zt.OpenAI=rz;Zt.DEFAULT_TIMEOUT=6e5;Zt.OpenAIError=Bt;Zt.APIError=vs;Zt.APIConnectionError=sb;Zt.APIConnectionTimeoutError=CN;Zt.APIUserAbortError=uo;Zt.NotFoundError=nB;Zt.ConflictError=rB;Zt.RateLimitError=iB;Zt.BadRequestError=Z6;Zt.AuthenticationError=eB;Zt.InternalServerError=oB;Zt.PermissionDeniedError=tB;Zt.UnprocessableEntityError=sB;Zt.toFile=hB;Zt.fileFromPath=J6;Zt.Completions=WB;Zt.Chat=db;Zt.ChatCompletionsPage=ub;Zt.Embeddings=qB;Zt.Files=zN;Zt.FileObjectsPage=GN;Zt.Images=XB;Zt.Audio=Og;Zt.Moderations=QB;Zt.Models=ZN;Zt.ModelsPage=eP;Zt.FineTuning=$c;Zt.Graders=QN;Zt.VectorStores=Uc;Zt.VectorStoresPage=iP;Zt.VectorStoreSearchResponsesPage=oP;Zt.Beta=Nf;Zt.Batches=EN;Zt.BatchesPage=TN;Zt.Uploads=rP;Zt.Responses=nP;Zt.Evals=zg;Zt.EvalListResponsesPage=BN;Zt.Containers=Ug;Zt.ContainerListResponsesPage=ON;const eme=Zt,tme="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",nme=new eme({apiKey:tme,dangerouslyAllowBrowser:!0});async function sz(t,e={}){if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required for OpenAI image generation.");console.log(`[OpenAI] Generating image with prompt: "${t}"`);try{const n=await nme.images.generate({model:"gpt-image-1",prompt:t,n:e.n||1,size:e.size||"1024x1024",quality:e.quality||"auto",response_format:"b64_json"});if(console.log("[OpenAI] Image generation response:",n),n.data&&n.data.length>0&&n.data[0].b64_json)return{b64_json:n.data[0].b64_json,alt:`OpenAI generated image for: ${t.substring(0,50)}`,revised_prompt:n.data[0].revised_prompt};throw new Error("No image data found in OpenAI response.")}catch(n){throw console.error("[OpenAI] Error generating image:",n),n.response&&n.response.data&&n.response.data.error?new Error(`OpenAI API Error: ${n.response.data.error.message}`):n}}const rme=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iz=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},sme=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},oz={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,h=(i&3)<<4|l>>4;let f=(l&15)<<2|u>>6,m=u&63;c||(m=64,o||(f=64)),r.push(n[d],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(iz(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):sme(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||h==null)throw new ime;const f=i<<2|l>>4;if(r.push(f),u!==64){const m=l<<4&240|u>>2;if(r.push(m),h!==64){const g=u<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class ime extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ome=function(t){const e=iz(t);return oz.encodeByteArray(e,!0)},ww=function(t){return ome(t).replace(/\./g,"")},az=function(t){try{return oz.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lz(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ame=()=>lz().__FIREBASE_DEFAULTS__,lme=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},cme=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&az(t[1]);return e&&JSON.parse(e)},yb=()=>{try{return rme()||ame()||lme()||cme()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},cz=t=>{var e,n;return(n=(e=yb())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},aP=t=>{const e=cz(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},uz=()=>{var t;return(t=yb())===null||t===void 0?void 0:t.config},dz=t=>{var e;return(e=yb())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ume{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(t){return t.endsWith(".cloudworkstations.dev")}async function xb(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hz(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[ww(JSON.stringify(n)),ww(JSON.stringify(o)),l].join(".")}const sp={};function dme(){const t={prod:[],emulator:[]};for(const e of Object.keys(sp))sp[e]?t.emulator.push(e):t.prod.push(e);return t}function hme(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let vM=!1;function vb(t,e){if(typeof window>"u"||typeof document>"u"||!Bc(window.location.host)||sp[t]===e||sp[t]||vM)return;sp[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=dme().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function l(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,m){f.setAttribute("width","24"),f.setAttribute("id",m),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function u(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{vM=!0,o()},f}function d(f,m){f.setAttribute("id",m),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=hme(r),m=n("text"),g=document.getElementById(m)||document.createElement("span"),x=n("learnmore"),w=document.getElementById(x)||document.createElement("a"),v=n("preprendIcon"),_=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const C=f.element;l(C),d(w,x);const T=u();c(_,v),C.append(_,g,w,T),document.body.appendChild(C)}i?(g.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fme(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Qr())}function fz(){var t;const e=(t=yb())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function mme(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function pme(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function gme(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yme(){const t=Qr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function mz(){return!fz()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pz(){return!fz()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function gz(){try{return typeof indexedDB=="object"}catch{return!1}}function xme(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vme="FirebaseError";class Xo extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=vme,Object.setPrototypeOf(this,Xo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gg.prototype.create)}}class Gg{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?wme(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Xo(s,l,r)}}function wme(t,e){return t.replace(bme,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const bme=/\{\$([^}]+)}/g;function _me(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ju(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(wM(i)&&wM(o)){if(!Ju(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function wM(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Pm(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Am(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Sme(t,e){const n=new Cme(t,e);return n.subscribe.bind(n)}class Cme{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Eme(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=kS),s.error===void 0&&(s.error=kS),s.complete===void 0&&(s.complete=kS);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Eme(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function kS(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qn(t){return t&&t._delegate?t._delegate:t}class ol{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const du="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tme{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ume;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Nme(e))try{this.getOrInitializeService({instanceIdentifier:du})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=du){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=du){return this.instances.has(e)}getOptions(e=du){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Ime(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=du){return this.component?this.component.multipleInstances?e:du:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Ime(t){return t===du?void 0:t}function Nme(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pme{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Tme(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(cn||(cn={}));const Ame={debug:cn.DEBUG,verbose:cn.VERBOSE,info:cn.INFO,warn:cn.WARN,error:cn.ERROR,silent:cn.SILENT},kme=cn.INFO,Rme={[cn.DEBUG]:"log",[cn.VERBOSE]:"log",[cn.INFO]:"info",[cn.WARN]:"warn",[cn.ERROR]:"error"},jme=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Rme[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class lP{constructor(e){this.name=e,this._logLevel=kme,this._logHandler=jme,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in cn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ame[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,cn.DEBUG,...e),this._logHandler(this,cn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,cn.VERBOSE,...e),this._logHandler(this,cn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,cn.INFO,...e),this._logHandler(this,cn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,cn.WARN,...e),this._logHandler(this,cn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,cn.ERROR,...e),this._logHandler(this,cn.ERROR,...e)}}const Dme=(t,e)=>e.some(n=>t instanceof n);let bM,_M;function Mme(){return bM||(bM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Lme(){return _M||(_M=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yz=new WeakMap,cT=new WeakMap,xz=new WeakMap,RS=new WeakMap,cP=new WeakMap;function Fme(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(uc(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&yz.set(n,t)}).catch(()=>{}),cP.set(e,t),e}function Ome(t){if(cT.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});cT.set(t,e)}let uT={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return cT.get(t);if(e==="objectStoreNames")return t.objectStoreNames||xz.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return uc(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Vme(t){uT=t(uT)}function $me(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(jS(this),e,...n);return xz.set(r,e.sort?e.sort():[e]),uc(r)}:Lme().includes(t)?function(...e){return t.apply(jS(this),e),uc(yz.get(this))}:function(...e){return uc(t.apply(jS(this),e))}}function Ume(t){return typeof t=="function"?$me(t):(t instanceof IDBTransaction&&Ome(t),Dme(t,Mme())?new Proxy(t,uT):t)}function uc(t){if(t instanceof IDBRequest)return Fme(t);if(RS.has(t))return RS.get(t);const e=Ume(t);return e!==t&&(RS.set(t,e),cP.set(e,t)),e}const jS=t=>cP.get(t);function Bme(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=uc(o);return r&&o.addEventListener("upgradeneeded",c=>{r(uc(o.result),c.oldVersion,c.newVersion,uc(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const zme=["get","getKey","getAll","getAllKeys","count"],Gme=["put","add","delete","clear"],DS=new Map;function SM(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(DS.get(e))return DS.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Gme.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||zme.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return DS.set(e,i),i}Vme(t=>({...t,get:(e,n,r)=>SM(e,n)||t.get(e,n,r),has:(e,n)=>!!SM(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wme{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Hme(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Hme(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const dT="@firebase/app",CM="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const al=new lP("@firebase/app"),qme="@firebase/app-compat",Kme="@firebase/analytics-compat",Yme="@firebase/analytics",Jme="@firebase/app-check-compat",Xme="@firebase/app-check",Qme="@firebase/auth",Zme="@firebase/auth-compat",epe="@firebase/database",tpe="@firebase/data-connect",npe="@firebase/database-compat",rpe="@firebase/functions",spe="@firebase/functions-compat",ipe="@firebase/installations",ope="@firebase/installations-compat",ape="@firebase/messaging",lpe="@firebase/messaging-compat",cpe="@firebase/performance",upe="@firebase/performance-compat",dpe="@firebase/remote-config",hpe="@firebase/remote-config-compat",fpe="@firebase/storage",mpe="@firebase/storage-compat",ppe="@firebase/firestore",gpe="@firebase/ai",ype="@firebase/firestore-compat",xpe="firebase",vpe="11.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT="[DEFAULT]",wpe={[dT]:"fire-core",[qme]:"fire-core-compat",[Yme]:"fire-analytics",[Kme]:"fire-analytics-compat",[Xme]:"fire-app-check",[Jme]:"fire-app-check-compat",[Qme]:"fire-auth",[Zme]:"fire-auth-compat",[epe]:"fire-rtdb",[tpe]:"fire-data-connect",[npe]:"fire-rtdb-compat",[rpe]:"fire-fn",[spe]:"fire-fn-compat",[ipe]:"fire-iid",[ope]:"fire-iid-compat",[ape]:"fire-fcm",[lpe]:"fire-fcm-compat",[cpe]:"fire-perf",[upe]:"fire-perf-compat",[dpe]:"fire-rc",[hpe]:"fire-rc-compat",[fpe]:"fire-gcs",[mpe]:"fire-gcs-compat",[ppe]:"fire-fst",[ype]:"fire-fst-compat",[gpe]:"fire-vertex","fire-js":"fire-js",[xpe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bw=new Map,bpe=new Map,fT=new Map;function EM(t,e){try{t.container.addComponent(e)}catch(n){al.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Cc(t){const e=t.name;if(fT.has(e))return al.debug(`There were multiple attempts to register component ${e}.`),!1;fT.set(e,t);for(const n of bw.values())EM(n,t);for(const n of bpe.values())EM(n,t);return!0}function Hg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Ks(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _pe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},dc=new Gg("app","Firebase",_pe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Spe{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ol("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw dc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const md=vpe;function vz(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:hT,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw dc.create("bad-app-name",{appName:String(s)});if(n||(n=uz()),!n)throw dc.create("no-options");const i=bw.get(s);if(i){if(Ju(n,i.options)&&Ju(r,i.config))return i;throw dc.create("duplicate-app",{appName:s})}const o=new Pme(s);for(const c of fT.values())o.addComponent(c);const l=new Spe(n,r,o);return bw.set(s,l),l}function wb(t=hT){const e=bw.get(t);if(!e&&t===hT&&uz())return vz();if(!e)throw dc.create("no-app",{appName:t});return e}function mo(t,e,n){var r;let s=(r=wpe[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),al.warn(l.join(" "));return}Cc(new ol(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cpe="firebase-heartbeat-database",Epe=1,qp="firebase-heartbeat-store";let MS=null;function wz(){return MS||(MS=Bme(Cpe,Epe,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(qp)}catch(n){console.warn(n)}}}}).catch(t=>{throw dc.create("idb-open",{originalErrorMessage:t.message})})),MS}async function Tpe(t){try{const n=(await wz()).transaction(qp),r=await n.objectStore(qp).get(bz(t));return await n.done,r}catch(e){if(e instanceof Xo)al.warn(e.message);else{const n=dc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});al.warn(n.message)}}}async function TM(t,e){try{const r=(await wz()).transaction(qp,"readwrite");await r.objectStore(qp).put(e,bz(t)),await r.done}catch(n){if(n instanceof Xo)al.warn(n.message);else{const r=dc.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});al.warn(r.message)}}}function bz(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ipe=1024,Npe=30;class Ppe{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new kpe(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=IM();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>Npe){const o=Rpe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){al.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=IM(),{heartbeatsToSend:r,unsentEntries:s}=Ape(this._heartbeatsCache.heartbeats),i=ww(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return al.warn(n),""}}}function IM(){return new Date().toISOString().substring(0,10)}function Ape(t,e=Ipe){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),NM(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),NM(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class kpe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gz()?xme().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Tpe(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return TM(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return TM(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function NM(t){return ww(JSON.stringify({version:2,heartbeats:t})).length}function Rpe(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jpe(t){Cc(new ol("platform-logger",e=>new Wme(e),"PRIVATE")),Cc(new ol("heartbeat",e=>new Ppe(e),"PRIVATE")),mo(dT,CM,t),mo(dT,CM,"esm2017"),mo("fire-js","")}jpe("");var Dpe="firebase",Mpe="11.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mo(Dpe,Mpe,"app");function _z(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Lpe=_z,Sz=new Gg("auth","Firebase",_z());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _w=new lP("@firebase/auth");function Fpe(t,...e){_w.logLevel<=cn.WARN&&_w.warn(`Auth (${md}): ${t}`,...e)}function tv(t,...e){_w.logLevel<=cn.ERROR&&_w.error(`Auth (${md}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vo(t,...e){throw dP(t,...e)}function Bo(t,...e){return dP(t,...e)}function uP(t,e,n){const r=Object.assign(Object.assign({},Lpe()),{[e]:n});return new Gg("auth","Firebase",r).create(e,{appName:t.name})}function Xa(t){return uP(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ope(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&vo(t,"argument-error"),uP(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function dP(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Sz.create(t,...e)}function zt(t,e,...n){if(!t)throw dP(e,...n)}function Ga(t){const e="INTERNAL ASSERTION FAILED: "+t;throw tv(e),new Error(e)}function ll(t,e){t||Ga(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mT(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Vpe(){return PM()==="http:"||PM()==="https:"}function PM(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $pe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Vpe()||pme()||"connection"in navigator)?navigator.onLine:!0}function Upe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e,n){this.shortDelay=e,this.longDelay=n,ll(n>e,"Short delay should be less than long delay!"),this.isMobile=fme()||gme()}get(){return $pe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hP(t,e){ll(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cz{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ga("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ga("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ga("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bpe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zpe=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Gpe=new qg(3e4,6e4);function zc(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Gc(t,e,n,r,s={}){return Ez(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Wg(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return mme()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Bc(t.emulatorConfig.host)&&(u.credentials="include"),Cz.fetch()(await Tz(t,t.config.apiHost,n,l),u)})}async function Ez(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Bpe),e);try{const s=new Hpe(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw lx(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw lx(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw lx(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw lx(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw uP(t,d,u);vo(t,d)}}catch(s){if(s instanceof Xo)throw s;vo(t,"network-request-failed",{message:String(s)})}}async function Kg(t,e,n,r,s={}){const i=await Gc(t,e,n,r,s);return"mfaPendingCredential"in i&&vo(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Tz(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?hP(t.config,s):`${t.config.apiScheme}://${s}`;return zpe.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function Wpe(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Hpe{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Bo(this.auth,"network-request-failed")),Gpe.get())})}}function lx(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Bo(t,e,r);return s.customData._tokenResponse=n,s}function AM(t){return t!==void 0&&t.enterprise!==void 0}class qpe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Wpe(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Kpe(t,e){return Gc(t,"GET","/v2/recaptchaConfig",zc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ype(t,e){return Gc(t,"POST","/v1/accounts:delete",e)}async function Sw(t,e){return Gc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ip(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Jpe(t,e=!1){const n=Qn(t),r=await n.getIdToken(e),s=fP(r);zt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:ip(LS(s.auth_time)),issuedAtTime:ip(LS(s.iat)),expirationTime:ip(LS(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function LS(t){return Number(t)*1e3}function fP(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return tv("JWT malformed, contained fewer than 3 sections"),null;try{const s=az(n);return s?JSON.parse(s):(tv("Failed to decode base64 JWT payload"),null)}catch(s){return tv("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function kM(t){const e=fP(t);return zt(e,"internal-error"),zt(typeof e.exp<"u","internal-error"),zt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kp(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Xo&&Xpe(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Xpe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qpe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ip(this.lastLoginAt),this.creationTime=ip(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cw(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Kp(t,Sw(n,{idToken:r}));zt(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Iz(i.providerUserInfo):[],l=ege(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new pT(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function Zpe(t){const e=Qn(t);await Cw(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ege(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Iz(t){return t.map(e=>{var{providerId:n}=e,r=Tf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tge(t,e){const n=await Ez(t,{},async()=>{const r=Wg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await Tz(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",Cz.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function nge(t,e){return Gc(t,"POST","/v2/accounts:revokeToken",zc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){zt(e.idToken,"internal-error"),zt(typeof e.idToken<"u","internal-error"),zt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):kM(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){zt(e.length!==0,"internal-error");const n=kM(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(zt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await tge(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Rh;return r&&(zt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(zt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(zt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Rh,this.toJSON())}_performRefresh(){return Ga("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Il(t,e){zt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Fo{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Tf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Qpe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new pT(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Kp(this,this.stsTokenManager.getToken(this.auth,e));return zt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Jpe(this,e)}reload(){return Zpe(this)}_assign(e){this!==e&&(zt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Fo(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){zt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Cw(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ks(this.auth.app))return Promise.reject(Xa(this.auth));const e=await this.getIdToken();return await Kp(this,Ype(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,u,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(s=n.email)!==null&&s!==void 0?s:void 0,m=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,g=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(l=n.tenantId)!==null&&l!==void 0?l:void 0,w=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,v=(u=n.createdAt)!==null&&u!==void 0?u:void 0,_=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:C,emailVerified:T,isAnonymous:R,providerData:A,stsTokenManager:E}=n;zt(C&&E,e,"internal-error");const I=Rh.fromJSON(this.name,E);zt(typeof C=="string",e,"internal-error"),Il(h,e.name),Il(f,e.name),zt(typeof T=="boolean",e,"internal-error"),zt(typeof R=="boolean",e,"internal-error"),Il(m,e.name),Il(g,e.name),Il(x,e.name),Il(w,e.name),Il(v,e.name),Il(_,e.name);const P=new Fo({uid:C,auth:e,email:f,emailVerified:T,displayName:h,isAnonymous:R,photoURL:g,phoneNumber:m,tenantId:x,stsTokenManager:I,createdAt:v,lastLoginAt:_});return A&&Array.isArray(A)&&(P.providerData=A.map(k=>Object.assign({},k))),w&&(P._redirectEventId=w),P}static async _fromIdTokenResponse(e,n,r=!1){const s=new Rh;s.updateFromServerResponse(n);const i=new Fo({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Cw(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];zt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Iz(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Rh;l.updateFromIdToken(r);const c=new Fo({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new pT(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RM=new Map;function Wa(t){ll(t instanceof Function,"Expected a class definition");let e=RM.get(t);return e?(ll(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,RM.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nz{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Nz.type="NONE";const jM=Nz;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nv(t,e,n){return`firebase:${t}:${e}:${n}`}class jh{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=nv(this.userKey,s.apiKey,i),this.fullPersistenceKey=nv("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Sw(this.auth,{idToken:e}).catch(()=>{});return n?Fo._fromGetAccountInfoResponse(this.auth,n,e):null}return Fo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new jh(Wa(jM),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Wa(jM);const o=nv(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){let h;if(typeof d=="string"){const f=await Sw(e,{idToken:d}).catch(()=>{});if(!f)break;h=await Fo._fromGetAccountInfoResponse(e,f,d)}else h=Fo._fromJSON(e,d);u!==i&&(l=h),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new jh(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new jh(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DM(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Rz(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Pz(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Dz(e))return"Blackberry";if(Mz(e))return"Webos";if(Az(e))return"Safari";if((e.includes("chrome/")||kz(e))&&!e.includes("edge/"))return"Chrome";if(jz(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Pz(t=Qr()){return/firefox\//i.test(t)}function Az(t=Qr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function kz(t=Qr()){return/crios\//i.test(t)}function Rz(t=Qr()){return/iemobile/i.test(t)}function jz(t=Qr()){return/android/i.test(t)}function Dz(t=Qr()){return/blackberry/i.test(t)}function Mz(t=Qr()){return/webos/i.test(t)}function mP(t=Qr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function rge(t=Qr()){var e;return mP(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function sge(){return yme()&&document.documentMode===10}function Lz(t=Qr()){return mP(t)||jz(t)||Mz(t)||Dz(t)||/windows phone/i.test(t)||Rz(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fz(t,e=[]){let n;switch(t){case"Browser":n=DM(Qr());break;case"Worker":n=`${DM(Qr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${md}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ige{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oge(t,e={}){return Gc(t,"GET","/v2/passwordPolicy",zc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const age=6;class lge{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:age,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cge{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new MM(this),this.idTokenSubscription=new MM(this),this.beforeStateQueue=new ige(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Sz,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Wa(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await jh.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Sw(this,{idToken:e}),r=await Fo._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Ks(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return zt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Cw(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Upe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ks(this.app))return Promise.reject(Xa(this));const n=e?Qn(e):null;return n&&zt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&zt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ks(this.app)?Promise.reject(Xa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ks(this.app)?Promise.reject(Xa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await oge(this),n=new lge(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Gg("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await nge(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Wa(e)||this._popupRedirectResolver;zt(n,this,"argument-error"),this.redirectPersistenceManager=await jh.create(this,[Wa(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(zt(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return zt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Fz(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if(Ks(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Fpe(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Wc(t){return Qn(t)}class MM{constructor(e){this.auth=e,this.observer=null,this.addObserver=Sme(n=>this.observer=n)}get next(){return zt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bb={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uge(t){bb=t}function Oz(t){return bb.loadJS(t)}function dge(){return bb.recaptchaEnterpriseScript}function hge(){return bb.gapiScript}function fge(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class mge{constructor(){this.enterprise=new pge}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class pge{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const gge="recaptcha-enterprise",Vz="NO_RECAPTCHA";class yge{constructor(e){this.type=gge,this.auth=Wc(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{Kpe(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new qpe(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;AM(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(Vz)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new mge().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&AM(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=dge();c.length!==0&&(c+=l),Oz(c).then(()=>{s(l,i,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function im(t,e,n,r=!1,s=!1){const i=new yge(t);let o;if(s)o=Vz;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const l=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function gT(t,e,n,r,s){var i,o;if(s==="EMAIL_PASSWORD_PROVIDER")if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await im(t,e,n,n==="getOobCode");return r(t,l)}else return r(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await im(t,e,n,n==="getOobCode");return r(t,c)}else return Promise.reject(l)});else if(s==="PHONE_PROVIDER")if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){const l=await im(t,e,n);return r(t,l).catch(async c=>{var u;if(((u=t._getRecaptchaConfig())===null||u===void 0?void 0:u.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const d=await im(t,e,n,!1,!0);return r(t,d)}return Promise.reject(c)})}else{const l=await im(t,e,n,!1,!0);return r(t,l)}else return Promise.reject(s+" provider is not supported.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xge(t,e){const n=Hg(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Ju(i,e??{}))return s;vo(s,"already-initialized")}return n.initialize({options:e})}function vge(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Wa);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function wge(t,e,n){const r=Wc(t);zt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=$z(e),{host:o,port:l}=bge(e),c=l===null?"":`:${l}`,u={url:`${i}//${o}${c}/`},d=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){zt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),zt(Ju(u,r.config.emulator)&&Ju(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Bc(o)?(xb(`${i}//${o}${c}`),vb("Auth",!0)):s||_ge()}function $z(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function bge(t){const e=$z(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:LM(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:LM(o)}}}function LM(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function _ge(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ga("not implemented")}_getIdTokenResponse(e){return Ga("not implemented")}_linkToIdToken(e,n){return Ga("not implemented")}_getReauthenticationResolver(e){return Ga("not implemented")}}async function Sge(t,e){return Gc(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cge(t,e){return Kg(t,"POST","/v1/accounts:signInWithPassword",zc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ege(t,e){return Kg(t,"POST","/v1/accounts:signInWithEmailLink",zc(t,e))}async function Tge(t,e){return Kg(t,"POST","/v1/accounts:signInWithEmailLink",zc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp extends pP{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Yp(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Yp(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gT(e,n,"signInWithPassword",Cge,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Ege(e,{email:this._email,oobCode:this._password});default:vo(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gT(e,r,"signUpPassword",Sge,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Tge(e,{idToken:n,email:this._email,oobCode:this._password});default:vo(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dh(t,e){return Kg(t,"POST","/v1/accounts:signInWithIdp",zc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ige="http://localhost";class Xu extends pP{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Xu(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):vo("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Tf(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Xu(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Dh(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Dh(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Dh(e,n)}buildRequest(){const e={requestUri:Ige,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Wg(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nge(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Pge(t){const e=Pm(Am(t)).link,n=e?Pm(Am(e)).deep_link_id:null,r=Pm(Am(t)).deep_link_id;return(r?Pm(Am(r)).link:null)||r||n||e||t}class gP{constructor(e){var n,r,s,i,o,l;const c=Pm(Am(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=Nge((s=c.mode)!==null&&s!==void 0?s:null);zt(u&&d&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=d,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.lang)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=Pge(e);try{return new gP(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(){this.providerId=Af.PROVIDER_ID}static credential(e,n){return Yp._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=gP.parseLink(n);return zt(r,"argument-error"),Yp._fromEmailAndCode(e,r.code,r.tenantId)}}Af.PROVIDER_ID="password";Af.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Af.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg extends yP{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl extends Yg{constructor(){super("facebook.com")}static credential(e){return Xu._fromParams({providerId:Bl.PROVIDER_ID,signInMethod:Bl.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bl.credentialFromTaggedObject(e)}static credentialFromError(e){return Bl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bl.credential(e.oauthAccessToken)}catch{return null}}}Bl.FACEBOOK_SIGN_IN_METHOD="facebook.com";Bl.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va extends Yg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Xu._fromParams({providerId:Va.PROVIDER_ID,signInMethod:Va.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Va.credentialFromTaggedObject(e)}static credentialFromError(e){return Va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Va.credential(n,r)}catch{return null}}}Va.GOOGLE_SIGN_IN_METHOD="google.com";Va.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl extends Yg{constructor(){super("github.com")}static credential(e){return Xu._fromParams({providerId:zl.PROVIDER_ID,signInMethod:zl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zl.credentialFromTaggedObject(e)}static credentialFromError(e){return zl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zl.credential(e.oauthAccessToken)}catch{return null}}}zl.GITHUB_SIGN_IN_METHOD="github.com";zl.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl extends Yg{constructor(){super("twitter.com")}static credential(e,n){return Xu._fromParams({providerId:Gl.PROVIDER_ID,signInMethod:Gl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Gl.credentialFromTaggedObject(e)}static credentialFromError(e){return Gl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Gl.credential(n,r)}catch{return null}}}Gl.TWITTER_SIGN_IN_METHOD="twitter.com";Gl.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Age(t,e){return Kg(t,"POST","/v1/accounts:signUp",zc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Fo._fromIdTokenResponse(e,r,s),o=FM(r);return new Qu({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=FM(r);return new Qu({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function FM(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew extends Xo{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Ew.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Ew(e,n,r,s)}}function Uz(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Ew._fromErrorAndOperation(t,i,e,r):i})}async function kge(t,e,n=!1){const r=await Kp(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Qu._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rge(t,e,n=!1){const{auth:r}=t;if(Ks(r.app))return Promise.reject(Xa(r));const s="reauthenticate";try{const i=await Kp(t,Uz(r,s,e,t),n);zt(i.idToken,r,"internal-error");const o=fP(i.idToken);zt(o,r,"internal-error");const{sub:l}=o;return zt(t.uid===l,r,"user-mismatch"),Qu._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&vo(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bz(t,e,n=!1){if(Ks(t.app))return Promise.reject(Xa(t));const r="signIn",s=await Uz(t,r,e),i=await Qu._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function jge(t,e){return Bz(Wc(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zz(t){const e=Wc(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Dge(t,e,n){if(Ks(t.app))return Promise.reject(Xa(t));const r=Wc(t),o=await gT(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Age,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&zz(t),c}),l=await Qu._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function Mge(t,e,n){return Ks(t.app)?Promise.reject(Xa(t)):jge(Qn(t),Af.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&zz(t),r})}function Lge(t,e,n,r){return Qn(t).onIdTokenChanged(e,n,r)}function Fge(t,e,n){return Qn(t).beforeAuthStateChanged(e,n)}function Oge(t,e,n,r){return Qn(t).onAuthStateChanged(e,n,r)}function Vge(t){return Qn(t).signOut()}const Tw="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gz{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Tw,"1"),this.storage.removeItem(Tw),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $ge=1e3,Uge=10;class Wz extends Gz{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Lz(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);sge()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Uge):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},$ge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Wz.type="LOCAL";const Bge=Wz;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hz extends Gz{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Hz.type="SESSION";const qz=Hz;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zge(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new _b(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await zge(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}_b.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xP(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gge{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=xP("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(f.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wa(){return window}function Wge(t){wa().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kz(){return typeof wa().WorkerGlobalScope<"u"&&typeof wa().importScripts=="function"}async function Hge(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function qge(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Kge(){return Kz()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yz="firebaseLocalStorageDb",Yge=1,Iw="firebaseLocalStorage",Jz="fbase_key";class Jg{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Sb(t,e){return t.transaction([Iw],e?"readwrite":"readonly").objectStore(Iw)}function Jge(){const t=indexedDB.deleteDatabase(Yz);return new Jg(t).toPromise()}function yT(){const t=indexedDB.open(Yz,Yge);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Iw,{keyPath:Jz})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Iw)?e(r):(r.close(),await Jge(),e(await yT()))})})}async function OM(t,e,n){const r=Sb(t,!0).put({[Jz]:e,value:n});return new Jg(r).toPromise()}async function Xge(t,e){const n=Sb(t,!1).get(e),r=await new Jg(n).toPromise();return r===void 0?null:r.value}function VM(t,e){const n=Sb(t,!0).delete(e);return new Jg(n).toPromise()}const Qge=800,Zge=3;class Xz{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await yT(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Zge)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Kz()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_b._getInstance(Kge()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Hge(),!this.activeServiceWorker)return;this.sender=new Gge(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||qge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await yT();return await OM(e,Tw,"1"),await VM(e,Tw),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>OM(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Xge(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>VM(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Sb(s,!1).getAll();return new Jg(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Qge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Xz.type="LOCAL";const eye=Xz;new qg(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qz(t,e){return e?Wa(e):(zt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP extends pP{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Dh(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Dh(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Dh(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function tye(t){return Bz(t.auth,new vP(t),t.bypassAuthState)}function nye(t){const{auth:e,user:n}=t;return zt(n,e,"internal-error"),Rge(n,new vP(t),t.bypassAuthState)}async function rye(t){const{auth:e,user:n}=t;return zt(n,e,"internal-error"),kge(n,new vP(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zz{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return tye;case"linkViaPopup":case"linkViaRedirect":return rye;case"reauthViaPopup":case"reauthViaRedirect":return nye;default:vo(this.auth,"internal-error")}}resolve(e){ll(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ll(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sye=new qg(2e3,1e4);async function iye(t,e,n){if(Ks(t.app))return Promise.reject(Bo(t,"operation-not-supported-in-this-environment"));const r=Wc(t);Ope(t,e,yP);const s=Qz(r,n);return new ku(r,"signInViaPopup",e,s).executeNotNull()}class ku extends Zz{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ku.currentPopupAction&&ku.currentPopupAction.cancel(),ku.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return zt(e,this.auth,"internal-error"),e}async onExecution(){ll(this.filter.length===1,"Popup operations only handle one event");const e=xP();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Bo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Bo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ku.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Bo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,sye.get())};e()}}ku.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oye="pendingRedirect",rv=new Map;class aye extends Zz{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=rv.get(this.auth._key());if(!e){try{const r=await lye(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}rv.set(this.auth._key(),e)}return this.bypassAuthState||rv.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function lye(t,e){const n=dye(e),r=uye(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function cye(t,e){rv.set(t._key(),e)}function uye(t){return Wa(t._redirectPersistence)}function dye(t){return nv(oye,t.config.apiKey,t.name)}async function hye(t,e,n=!1){if(Ks(t.app))return Promise.reject(Xa(t));const r=Wc(t),s=Qz(r,e),o=await new aye(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fye=10*60*1e3;class mye{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!pye(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!e9(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Bo(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=fye&&this.cachedEventUids.clear(),this.cachedEventUids.has($M(e))}saveEventToCache(e){this.cachedEventUids.add($M(e)),this.lastProcessedEventTime=Date.now()}}function $M(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function e9({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function pye(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return e9(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gye(t,e={}){return Gc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yye=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xye=/^https?/;async function vye(t){if(t.config.emulator)return;const{authorizedDomains:e}=await gye(t);for(const n of e)try{if(wye(n))return}catch{}vo(t,"unauthorized-domain")}function wye(t){const e=mT(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!xye.test(n))return!1;if(yye.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bye=new qg(3e4,6e4);function UM(){const t=wa().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function _ye(t){return new Promise((e,n)=>{var r,s,i;function o(){UM(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{UM(),n(Bo(t,"network-request-failed"))},timeout:bye.get()})}if(!((s=(r=wa().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=wa().gapi)===null||i===void 0)&&i.load)o();else{const l=fge("iframefcb");return wa()[l]=()=>{gapi.load?o():n(Bo(t,"network-request-failed"))},Oz(`${hge()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw sv=null,e})}let sv=null;function Sye(t){return sv=sv||_ye(t),sv}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cye=new qg(5e3,15e3),Eye="__/auth/iframe",Tye="emulator/auth/iframe",Iye={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Nye=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Pye(t){const e=t.config;zt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?hP(e,Tye):`https://${t.config.authDomain}/${Eye}`,r={apiKey:e.apiKey,appName:t.name,v:md},s=Nye.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Wg(r).slice(1)}`}async function Aye(t){const e=await Sye(t),n=wa().gapi;return zt(n,t,"internal-error"),e.open({where:document.body,url:Pye(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Iye,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Bo(t,"network-request-failed"),l=wa().setTimeout(()=>{i(o)},Cye.get());function c(){wa().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kye={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Rye=500,jye=600,Dye="_blank",Mye="http://localhost";class BM{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Lye(t,e,n,r=Rye,s=jye){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},kye),{width:r.toString(),height:s.toString(),top:i,left:o}),u=Qr().toLowerCase();n&&(l=kz(u)?Dye:n),Pz(u)&&(e=e||Mye,c.scrollbars="yes");const d=Object.entries(c).reduce((f,[m,g])=>`${f}${m}=${g},`,"");if(rge(u)&&l!=="_self")return Fye(e||"",l),new BM(null);const h=window.open(e||"",l,d);zt(h,t,"popup-blocked");try{h.focus()}catch{}return new BM(h)}function Fye(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oye="__/auth/handler",Vye="emulator/auth/handler",$ye=encodeURIComponent("fac");async function zM(t,e,n,r,s,i){zt(t.config.authDomain,t,"auth-domain-config-required"),zt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:md,eventId:s};if(e instanceof yP){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",_me(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries(i||{}))o[d]=h}if(e instanceof Yg){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${$ye}=${encodeURIComponent(c)}`:"";return`${Uye(t)}?${Wg(l).slice(1)}${u}`}function Uye({config:t}){return t.emulator?hP(t,Vye):`https://${t.authDomain}/${Oye}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS="webStorageSupport";class Bye{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qz,this._completeRedirectFn=hye,this._overrideRedirectResult=cye}async _openPopup(e,n,r,s){var i;ll((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await zM(e,n,r,mT(),s);return Lye(e,o,xP())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await zM(e,n,r,mT(),s);return Wge(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(ll(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Aye(e),r=new mye(e);return n.register("authEvent",s=>(zt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(FS,{type:FS},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[FS];o!==void 0&&n(!!o),vo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=vye(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Lz()||Az()||mP()}}const zye=Bye;var GM="@firebase/auth",WM="1.10.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gye{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){zt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wye(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Hye(t){Cc(new ol("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;zt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Fz(t)},u=new cge(r,s,i,c);return vge(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Cc(new ol("auth-internal",e=>{const n=Wc(e.getProvider("auth").getImmediate());return(r=>new Gye(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),mo(GM,WM,Wye(t)),mo(GM,WM,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qye=5*60,Kye=dz("authIdTokenMaxAge")||qye;let HM=null;const Yye=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Kye)return;const s=n==null?void 0:n.token;HM!==s&&(HM=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Jye(t=wb()){const e=Hg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=xge(t,{popupRedirectResolver:zye,persistence:[eye,Bge,qz]}),r=dz("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=Yye(i.toString());Fge(n,o,()=>o(n.currentUser)),Lge(n,l=>o(l))}}const s=cz("auth");return s&&wge(n,`http://${s}`),n}function Xye(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}uge({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Bo("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Xye().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Hye("Browser");var qM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var hc,t9;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,I){function P(){}P.prototype=I.prototype,E.D=I.prototype,E.prototype=new P,E.prototype.constructor=E,E.C=function(k,j,D){for(var M=Array(arguments.length-2),G=2;G<arguments.length;G++)M[G-2]=arguments[G];return I.prototype[j].apply(k,M)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,I,P){P||(P=0);var k=Array(16);if(typeof I=="string")for(var j=0;16>j;++j)k[j]=I.charCodeAt(P++)|I.charCodeAt(P++)<<8|I.charCodeAt(P++)<<16|I.charCodeAt(P++)<<24;else for(j=0;16>j;++j)k[j]=I[P++]|I[P++]<<8|I[P++]<<16|I[P++]<<24;I=E.g[0],P=E.g[1],j=E.g[2];var D=E.g[3],M=I+(D^P&(j^D))+k[0]+3614090360&4294967295;I=P+(M<<7&4294967295|M>>>25),M=D+(j^I&(P^j))+k[1]+3905402710&4294967295,D=I+(M<<12&4294967295|M>>>20),M=j+(P^D&(I^P))+k[2]+606105819&4294967295,j=D+(M<<17&4294967295|M>>>15),M=P+(I^j&(D^I))+k[3]+3250441966&4294967295,P=j+(M<<22&4294967295|M>>>10),M=I+(D^P&(j^D))+k[4]+4118548399&4294967295,I=P+(M<<7&4294967295|M>>>25),M=D+(j^I&(P^j))+k[5]+1200080426&4294967295,D=I+(M<<12&4294967295|M>>>20),M=j+(P^D&(I^P))+k[6]+2821735955&4294967295,j=D+(M<<17&4294967295|M>>>15),M=P+(I^j&(D^I))+k[7]+4249261313&4294967295,P=j+(M<<22&4294967295|M>>>10),M=I+(D^P&(j^D))+k[8]+1770035416&4294967295,I=P+(M<<7&4294967295|M>>>25),M=D+(j^I&(P^j))+k[9]+2336552879&4294967295,D=I+(M<<12&4294967295|M>>>20),M=j+(P^D&(I^P))+k[10]+4294925233&4294967295,j=D+(M<<17&4294967295|M>>>15),M=P+(I^j&(D^I))+k[11]+2304563134&4294967295,P=j+(M<<22&4294967295|M>>>10),M=I+(D^P&(j^D))+k[12]+1804603682&4294967295,I=P+(M<<7&4294967295|M>>>25),M=D+(j^I&(P^j))+k[13]+4254626195&4294967295,D=I+(M<<12&4294967295|M>>>20),M=j+(P^D&(I^P))+k[14]+2792965006&4294967295,j=D+(M<<17&4294967295|M>>>15),M=P+(I^j&(D^I))+k[15]+1236535329&4294967295,P=j+(M<<22&4294967295|M>>>10),M=I+(j^D&(P^j))+k[1]+4129170786&4294967295,I=P+(M<<5&4294967295|M>>>27),M=D+(P^j&(I^P))+k[6]+3225465664&4294967295,D=I+(M<<9&4294967295|M>>>23),M=j+(I^P&(D^I))+k[11]+643717713&4294967295,j=D+(M<<14&4294967295|M>>>18),M=P+(D^I&(j^D))+k[0]+3921069994&4294967295,P=j+(M<<20&4294967295|M>>>12),M=I+(j^D&(P^j))+k[5]+3593408605&4294967295,I=P+(M<<5&4294967295|M>>>27),M=D+(P^j&(I^P))+k[10]+38016083&4294967295,D=I+(M<<9&4294967295|M>>>23),M=j+(I^P&(D^I))+k[15]+3634488961&4294967295,j=D+(M<<14&4294967295|M>>>18),M=P+(D^I&(j^D))+k[4]+3889429448&4294967295,P=j+(M<<20&4294967295|M>>>12),M=I+(j^D&(P^j))+k[9]+568446438&4294967295,I=P+(M<<5&4294967295|M>>>27),M=D+(P^j&(I^P))+k[14]+3275163606&4294967295,D=I+(M<<9&4294967295|M>>>23),M=j+(I^P&(D^I))+k[3]+4107603335&4294967295,j=D+(M<<14&4294967295|M>>>18),M=P+(D^I&(j^D))+k[8]+1163531501&4294967295,P=j+(M<<20&4294967295|M>>>12),M=I+(j^D&(P^j))+k[13]+2850285829&4294967295,I=P+(M<<5&4294967295|M>>>27),M=D+(P^j&(I^P))+k[2]+4243563512&4294967295,D=I+(M<<9&4294967295|M>>>23),M=j+(I^P&(D^I))+k[7]+1735328473&4294967295,j=D+(M<<14&4294967295|M>>>18),M=P+(D^I&(j^D))+k[12]+2368359562&4294967295,P=j+(M<<20&4294967295|M>>>12),M=I+(P^j^D)+k[5]+4294588738&4294967295,I=P+(M<<4&4294967295|M>>>28),M=D+(I^P^j)+k[8]+2272392833&4294967295,D=I+(M<<11&4294967295|M>>>21),M=j+(D^I^P)+k[11]+1839030562&4294967295,j=D+(M<<16&4294967295|M>>>16),M=P+(j^D^I)+k[14]+4259657740&4294967295,P=j+(M<<23&4294967295|M>>>9),M=I+(P^j^D)+k[1]+2763975236&4294967295,I=P+(M<<4&4294967295|M>>>28),M=D+(I^P^j)+k[4]+1272893353&4294967295,D=I+(M<<11&4294967295|M>>>21),M=j+(D^I^P)+k[7]+4139469664&4294967295,j=D+(M<<16&4294967295|M>>>16),M=P+(j^D^I)+k[10]+3200236656&4294967295,P=j+(M<<23&4294967295|M>>>9),M=I+(P^j^D)+k[13]+681279174&4294967295,I=P+(M<<4&4294967295|M>>>28),M=D+(I^P^j)+k[0]+3936430074&4294967295,D=I+(M<<11&4294967295|M>>>21),M=j+(D^I^P)+k[3]+3572445317&4294967295,j=D+(M<<16&4294967295|M>>>16),M=P+(j^D^I)+k[6]+76029189&4294967295,P=j+(M<<23&4294967295|M>>>9),M=I+(P^j^D)+k[9]+3654602809&4294967295,I=P+(M<<4&4294967295|M>>>28),M=D+(I^P^j)+k[12]+3873151461&4294967295,D=I+(M<<11&4294967295|M>>>21),M=j+(D^I^P)+k[15]+530742520&4294967295,j=D+(M<<16&4294967295|M>>>16),M=P+(j^D^I)+k[2]+3299628645&4294967295,P=j+(M<<23&4294967295|M>>>9),M=I+(j^(P|~D))+k[0]+4096336452&4294967295,I=P+(M<<6&4294967295|M>>>26),M=D+(P^(I|~j))+k[7]+1126891415&4294967295,D=I+(M<<10&4294967295|M>>>22),M=j+(I^(D|~P))+k[14]+2878612391&4294967295,j=D+(M<<15&4294967295|M>>>17),M=P+(D^(j|~I))+k[5]+4237533241&4294967295,P=j+(M<<21&4294967295|M>>>11),M=I+(j^(P|~D))+k[12]+1700485571&4294967295,I=P+(M<<6&4294967295|M>>>26),M=D+(P^(I|~j))+k[3]+2399980690&4294967295,D=I+(M<<10&4294967295|M>>>22),M=j+(I^(D|~P))+k[10]+4293915773&4294967295,j=D+(M<<15&4294967295|M>>>17),M=P+(D^(j|~I))+k[1]+2240044497&4294967295,P=j+(M<<21&4294967295|M>>>11),M=I+(j^(P|~D))+k[8]+1873313359&4294967295,I=P+(M<<6&4294967295|M>>>26),M=D+(P^(I|~j))+k[15]+4264355552&4294967295,D=I+(M<<10&4294967295|M>>>22),M=j+(I^(D|~P))+k[6]+2734768916&4294967295,j=D+(M<<15&4294967295|M>>>17),M=P+(D^(j|~I))+k[13]+1309151649&4294967295,P=j+(M<<21&4294967295|M>>>11),M=I+(j^(P|~D))+k[4]+4149444226&4294967295,I=P+(M<<6&4294967295|M>>>26),M=D+(P^(I|~j))+k[11]+3174756917&4294967295,D=I+(M<<10&4294967295|M>>>22),M=j+(I^(D|~P))+k[2]+718787259&4294967295,j=D+(M<<15&4294967295|M>>>17),M=P+(D^(j|~I))+k[9]+3951481745&4294967295,E.g[0]=E.g[0]+I&4294967295,E.g[1]=E.g[1]+(j+(M<<21&4294967295|M>>>11))&4294967295,E.g[2]=E.g[2]+j&4294967295,E.g[3]=E.g[3]+D&4294967295}r.prototype.u=function(E,I){I===void 0&&(I=E.length);for(var P=I-this.blockSize,k=this.B,j=this.h,D=0;D<I;){if(j==0)for(;D<=P;)s(this,E,D),D+=this.blockSize;if(typeof E=="string"){for(;D<I;)if(k[j++]=E.charCodeAt(D++),j==this.blockSize){s(this,k),j=0;break}}else for(;D<I;)if(k[j++]=E[D++],j==this.blockSize){s(this,k),j=0;break}}this.h=j,this.o+=I},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var I=1;I<E.length-8;++I)E[I]=0;var P=8*this.o;for(I=E.length-8;I<E.length;++I)E[I]=P&255,P/=256;for(this.u(E),E=Array(16),I=P=0;4>I;++I)for(var k=0;32>k;k+=8)E[P++]=this.g[I]>>>k&255;return E};function i(E,I){var P=l;return Object.prototype.hasOwnProperty.call(P,E)?P[E]:P[E]=I(E)}function o(E,I){this.h=I;for(var P=[],k=!0,j=E.length-1;0<=j;j--){var D=E[j]|0;k&&D==I||(P[j]=D,k=!1)}this.g=P}var l={};function c(E){return-128<=E&&128>E?i(E,function(I){return new o([I|0],0>I?-1:0)}):new o([E|0],0>E?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return h;if(0>E)return w(u(-E));for(var I=[],P=1,k=0;E>=P;k++)I[k]=E/P|0,P*=4294967296;return new o(I,0)}function d(E,I){if(E.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(E.charAt(0)=="-")return w(d(E.substring(1),I));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=u(Math.pow(I,8)),k=h,j=0;j<E.length;j+=8){var D=Math.min(8,E.length-j),M=parseInt(E.substring(j,j+D),I);8>D?(D=u(Math.pow(I,D)),k=k.j(D).add(u(M))):(k=k.j(P),k=k.add(u(M)))}return k}var h=c(0),f=c(1),m=c(16777216);t=o.prototype,t.m=function(){if(x(this))return-w(this).m();for(var E=0,I=1,P=0;P<this.g.length;P++){var k=this.i(P);E+=(0<=k?k:4294967296+k)*I,I*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(g(this))return"0";if(x(this))return"-"+w(this).toString(E);for(var I=u(Math.pow(E,6)),P=this,k="";;){var j=T(P,I).g;P=v(P,j.j(I));var D=((0<P.g.length?P.g[0]:P.h)>>>0).toString(E);if(P=j,g(P))return D+k;for(;6>D.length;)D="0"+D;k=D+k}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function g(E){if(E.h!=0)return!1;for(var I=0;I<E.g.length;I++)if(E.g[I]!=0)return!1;return!0}function x(E){return E.h==-1}t.l=function(E){return E=v(this,E),x(E)?-1:g(E)?0:1};function w(E){for(var I=E.g.length,P=[],k=0;k<I;k++)P[k]=~E.g[k];return new o(P,~E.h).add(f)}t.abs=function(){return x(this)?w(this):this},t.add=function(E){for(var I=Math.max(this.g.length,E.g.length),P=[],k=0,j=0;j<=I;j++){var D=k+(this.i(j)&65535)+(E.i(j)&65535),M=(D>>>16)+(this.i(j)>>>16)+(E.i(j)>>>16);k=M>>>16,D&=65535,M&=65535,P[j]=M<<16|D}return new o(P,P[P.length-1]&-2147483648?-1:0)};function v(E,I){return E.add(w(I))}t.j=function(E){if(g(this)||g(E))return h;if(x(this))return x(E)?w(this).j(w(E)):w(w(this).j(E));if(x(E))return w(this.j(w(E)));if(0>this.l(m)&&0>E.l(m))return u(this.m()*E.m());for(var I=this.g.length+E.g.length,P=[],k=0;k<2*I;k++)P[k]=0;for(k=0;k<this.g.length;k++)for(var j=0;j<E.g.length;j++){var D=this.i(k)>>>16,M=this.i(k)&65535,G=E.i(j)>>>16,B=E.i(j)&65535;P[2*k+2*j]+=M*B,_(P,2*k+2*j),P[2*k+2*j+1]+=D*B,_(P,2*k+2*j+1),P[2*k+2*j+1]+=M*G,_(P,2*k+2*j+1),P[2*k+2*j+2]+=D*G,_(P,2*k+2*j+2)}for(k=0;k<I;k++)P[k]=P[2*k+1]<<16|P[2*k];for(k=I;k<2*I;k++)P[k]=0;return new o(P,0)};function _(E,I){for(;(E[I]&65535)!=E[I];)E[I+1]+=E[I]>>>16,E[I]&=65535,I++}function C(E,I){this.g=E,this.h=I}function T(E,I){if(g(I))throw Error("division by zero");if(g(E))return new C(h,h);if(x(E))return I=T(w(E),I),new C(w(I.g),w(I.h));if(x(I))return I=T(E,w(I)),new C(w(I.g),I.h);if(30<E.g.length){if(x(E)||x(I))throw Error("slowDivide_ only works with positive integers.");for(var P=f,k=I;0>=k.l(E);)P=R(P),k=R(k);var j=A(P,1),D=A(k,1);for(k=A(k,2),P=A(P,2);!g(k);){var M=D.add(k);0>=M.l(E)&&(j=j.add(P),D=M),k=A(k,1),P=A(P,1)}return I=v(E,j.j(I)),new C(j,I)}for(j=h;0<=E.l(I);){for(P=Math.max(1,Math.floor(E.m()/I.m())),k=Math.ceil(Math.log(P)/Math.LN2),k=48>=k?1:Math.pow(2,k-48),D=u(P),M=D.j(I);x(M)||0<M.l(E);)P-=k,D=u(P),M=D.j(I);g(D)&&(D=f),j=j.add(D),E=v(E,M)}return new C(j,E)}t.A=function(E){return T(this,E).h},t.and=function(E){for(var I=Math.max(this.g.length,E.g.length),P=[],k=0;k<I;k++)P[k]=this.i(k)&E.i(k);return new o(P,this.h&E.h)},t.or=function(E){for(var I=Math.max(this.g.length,E.g.length),P=[],k=0;k<I;k++)P[k]=this.i(k)|E.i(k);return new o(P,this.h|E.h)},t.xor=function(E){for(var I=Math.max(this.g.length,E.g.length),P=[],k=0;k<I;k++)P[k]=this.i(k)^E.i(k);return new o(P,this.h^E.h)};function R(E){for(var I=E.g.length+1,P=[],k=0;k<I;k++)P[k]=E.i(k)<<1|E.i(k-1)>>>31;return new o(P,E.h)}function A(E,I){var P=I>>5;I%=32;for(var k=E.g.length-P,j=[],D=0;D<k;D++)j[D]=0<I?E.i(D+P)>>>I|E.i(D+P+1)<<32-I:E.i(D+P);return new o(j,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,t9=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,hc=o}).apply(typeof qM<"u"?qM:typeof self<"u"?self:typeof window<"u"?window:{});var cx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var n9,km,r9,iv,xT,s9,i9,o9;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,N,L){return y==Array.prototype||y==Object.prototype||(y[N]=L.value),y};function n(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof cx=="object"&&cx];for(var N=0;N<y.length;++N){var L=y[N];if(L&&L.Math==Math)return L}throw Error("Cannot find global object")}var r=n(this);function s(y,N){if(N)e:{var L=r;y=y.split(".");for(var U=0;U<y.length-1;U++){var pe=y[U];if(!(pe in L))break e;L=L[pe]}y=y[y.length-1],U=L[y],N=N(U),N!=U&&N!=null&&e(L,y,{configurable:!0,writable:!0,value:N})}}function i(y,N){y instanceof String&&(y+="");var L=0,U=!1,pe={next:function(){if(!U&&L<y.length){var je=L++;return{value:N(je,y[je]),done:!1}}return U=!0,{done:!0,value:void 0}}};return pe[Symbol.iterator]=function(){return pe},pe}s("Array.prototype.values",function(y){return y||function(){return i(this,function(N,L){return L})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(y){var N=typeof y;return N=N!="object"?N:y?Array.isArray(y)?"array":N:"null",N=="array"||N=="object"&&typeof y.length=="number"}function u(y){var N=typeof y;return N=="object"&&y!=null||N=="function"}function d(y,N,L){return y.call.apply(y.bind,arguments)}function h(y,N,L){if(!y)throw Error();if(2<arguments.length){var U=Array.prototype.slice.call(arguments,2);return function(){var pe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(pe,U),y.apply(N,pe)}}return function(){return y.apply(N,arguments)}}function f(y,N,L){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,f.apply(null,arguments)}function m(y,N){var L=Array.prototype.slice.call(arguments,1);return function(){var U=L.slice();return U.push.apply(U,arguments),y.apply(this,U)}}function g(y,N){function L(){}L.prototype=N.prototype,y.aa=N.prototype,y.prototype=new L,y.prototype.constructor=y,y.Qb=function(U,pe,je){for(var st=Array(arguments.length-2),Gn=2;Gn<arguments.length;Gn++)st[Gn-2]=arguments[Gn];return N.prototype[pe].apply(U,st)}}function x(y){const N=y.length;if(0<N){const L=Array(N);for(let U=0;U<N;U++)L[U]=y[U];return L}return[]}function w(y,N){for(let L=1;L<arguments.length;L++){const U=arguments[L];if(c(U)){const pe=y.length||0,je=U.length||0;y.length=pe+je;for(let st=0;st<je;st++)y[pe+st]=U[st]}else y.push(U)}}class v{constructor(N,L){this.i=N,this.j=L,this.h=0,this.g=null}get(){let N;return 0<this.h?(this.h--,N=this.g,this.g=N.next,N.next=null):N=this.i(),N}}function _(y){return/^[\s\xa0]*$/.test(y)}function C(){var y=l.navigator;return y&&(y=y.userAgent)?y:""}function T(y){return T[" "](y),y}T[" "]=function(){};var R=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function A(y,N,L){for(const U in y)N.call(L,y[U],U,y)}function E(y,N){for(const L in y)N.call(void 0,y[L],L,y)}function I(y){const N={};for(const L in y)N[L]=y[L];return N}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(y,N){let L,U;for(let pe=1;pe<arguments.length;pe++){U=arguments[pe];for(L in U)y[L]=U[L];for(let je=0;je<P.length;je++)L=P[je],Object.prototype.hasOwnProperty.call(U,L)&&(y[L]=U[L])}}function j(y){var N=1;y=y.split(":");const L=[];for(;0<N&&y.length;)L.push(y.shift()),N--;return y.length&&L.push(y.join(":")),L}function D(y){l.setTimeout(()=>{throw y},0)}function M(){var y=Y;let N=null;return y.g&&(N=y.g,y.g=y.g.next,y.g||(y.h=null),N.next=null),N}class G{constructor(){this.h=this.g=null}add(N,L){const U=B.get();U.set(N,L),this.h?this.h.next=U:this.g=U,this.h=U}}var B=new v(()=>new W,y=>y.reset());class W{constructor(){this.next=this.g=this.h=null}set(N,L){this.h=N,this.g=L,this.next=null}reset(){this.next=this.g=this.h=null}}let Q,H=!1,Y=new G,V=()=>{const y=l.Promise.resolve(void 0);Q=()=>{y.then($)}};var $=()=>{for(var y;y=M();){try{y.h.call(y.g)}catch(L){D(L)}var N=B;N.j(y),100>N.h&&(N.h++,y.next=N.g,N.g=y)}H=!1};function z(){this.s=this.s,this.C=this.C}z.prototype.s=!1,z.prototype.ma=function(){this.s||(this.s=!0,this.N())},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(y,N){this.type=y,this.g=this.target=N,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var Z=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var y=!1,N=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const L=()=>{};l.addEventListener("test",L,N),l.removeEventListener("test",L,N)}catch{}return y}();function fe(y,N){if(F.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y){var L=this.type=y.type,U=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;if(this.target=y.target||y.srcElement,this.g=N,N=y.relatedTarget){if(R){e:{try{T(N.nodeName);var pe=!0;break e}catch{}pe=!1}pe||(N=null)}}else L=="mouseover"?N=y.fromElement:L=="mouseout"&&(N=y.toElement);this.relatedTarget=N,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=typeof y.pointerType=="string"?y.pointerType:xe[y.pointerType]||"",this.state=y.state,this.i=y,y.defaultPrevented&&fe.aa.h.call(this)}}g(fe,F);var xe={2:"touch",3:"pen",4:"mouse"};fe.prototype.h=function(){fe.aa.h.call(this);var y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var ge="closure_listenable_"+(1e6*Math.random()|0),Re=0;function Ue(y,N,L,U,pe){this.listener=y,this.proxy=null,this.src=N,this.type=L,this.capture=!!U,this.ha=pe,this.key=++Re,this.da=this.fa=!1}function ze(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function he(y){this.src=y,this.g={},this.h=0}he.prototype.add=function(y,N,L,U,pe){var je=y.toString();y=this.g[je],y||(y=this.g[je]=[],this.h++);var st=Pe(y,N,U,pe);return-1<st?(N=y[st],L||(N.fa=!1)):(N=new Ue(N,this.src,je,!!U,pe),N.fa=L,y.push(N)),N};function Ce(y,N){var L=N.type;if(L in y.g){var U=y.g[L],pe=Array.prototype.indexOf.call(U,N,void 0),je;(je=0<=pe)&&Array.prototype.splice.call(U,pe,1),je&&(ze(N),y.g[L].length==0&&(delete y.g[L],y.h--))}}function Pe(y,N,L,U){for(var pe=0;pe<y.length;++pe){var je=y[pe];if(!je.da&&je.listener==N&&je.capture==!!L&&je.ha==U)return pe}return-1}var ve="closure_lm_"+(1e6*Math.random()|0),de={};function Me(y,N,L,U,pe){if(U&&U.once)return Pt(y,N,L,U,pe);if(Array.isArray(N)){for(var je=0;je<N.length;je++)Me(y,N[je],L,U,pe);return null}return L=te(L),y&&y[ge]?y.K(N,L,u(U)?!!U.capture:!!U,pe):Ge(y,N,L,!1,U,pe)}function Ge(y,N,L,U,pe,je){if(!N)throw Error("Invalid event type");var st=u(pe)?!!pe.capture:!!pe,Gn=Lt(y);if(Gn||(y[ve]=Gn=new he(y)),L=Gn.add(N,L,U,st,je),L.proxy)return L;if(U=yt(),L.proxy=U,U.src=y,U.listener=L,y.addEventListener)Z||(pe=st),pe===void 0&&(pe=!1),y.addEventListener(N.toString(),U,pe);else if(y.attachEvent)y.attachEvent(an(N.toString()),U);else if(y.addListener&&y.removeListener)y.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return L}function yt(){function y(L){return N.call(y.src,y.listener,L)}const N=dn;return y}function Pt(y,N,L,U,pe){if(Array.isArray(N)){for(var je=0;je<N.length;je++)Pt(y,N[je],L,U,pe);return null}return L=te(L),y&&y[ge]?y.L(N,L,u(U)?!!U.capture:!!U,pe):Ge(y,N,L,!0,U,pe)}function en(y,N,L,U,pe){if(Array.isArray(N))for(var je=0;je<N.length;je++)en(y,N[je],L,U,pe);else U=u(U)?!!U.capture:!!U,L=te(L),y&&y[ge]?(y=y.i,N=String(N).toString(),N in y.g&&(je=y.g[N],L=Pe(je,L,U,pe),-1<L&&(ze(je[L]),Array.prototype.splice.call(je,L,1),je.length==0&&(delete y.g[N],y.h--)))):y&&(y=Lt(y))&&(N=y.g[N.toString()],y=-1,N&&(y=Pe(N,L,U,pe)),(L=-1<y?N[y]:null)&&fn(L))}function fn(y){if(typeof y!="number"&&y&&!y.da){var N=y.src;if(N&&N[ge])Ce(N.i,y);else{var L=y.type,U=y.proxy;N.removeEventListener?N.removeEventListener(L,U,y.capture):N.detachEvent?N.detachEvent(an(L),U):N.addListener&&N.removeListener&&N.removeListener(U),(L=Lt(N))?(Ce(L,y),L.h==0&&(L.src=null,N[ve]=null)):ze(y)}}}function an(y){return y in de?de[y]:de[y]="on"+y}function dn(y,N){if(y.da)y=!0;else{N=new fe(N,this);var L=y.listener,U=y.ha||y.src;y.fa&&fn(y),y=L.call(U,N)}return y}function Lt(y){return y=y[ve],y instanceof he?y:null}var xn="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(y){return typeof y=="function"?y:(y[xn]||(y[xn]=function(N){return y.handleEvent(N)}),y[xn])}function Ee(){z.call(this),this.i=new he(this),this.M=this,this.F=null}g(Ee,z),Ee.prototype[ge]=!0,Ee.prototype.removeEventListener=function(y,N,L,U){en(this,y,N,L,U)};function ee(y,N){var L,U=y.F;if(U)for(L=[];U;U=U.F)L.push(U);if(y=y.M,U=N.type||N,typeof N=="string")N=new F(N,y);else if(N instanceof F)N.target=N.target||y;else{var pe=N;N=new F(U,y),k(N,pe)}if(pe=!0,L)for(var je=L.length-1;0<=je;je--){var st=N.g=L[je];pe=le(st,U,!0,N)&&pe}if(st=N.g=y,pe=le(st,U,!0,N)&&pe,pe=le(st,U,!1,N)&&pe,L)for(je=0;je<L.length;je++)st=N.g=L[je],pe=le(st,U,!1,N)&&pe}Ee.prototype.N=function(){if(Ee.aa.N.call(this),this.i){var y=this.i,N;for(N in y.g){for(var L=y.g[N],U=0;U<L.length;U++)ze(L[U]);delete y.g[N],y.h--}}this.F=null},Ee.prototype.K=function(y,N,L,U){return this.i.add(String(y),N,!1,L,U)},Ee.prototype.L=function(y,N,L,U){return this.i.add(String(y),N,!0,L,U)};function le(y,N,L,U){if(N=y.i.g[String(N)],!N)return!0;N=N.concat();for(var pe=!0,je=0;je<N.length;++je){var st=N[je];if(st&&!st.da&&st.capture==L){var Gn=st.listener,cs=st.ha||st.src;st.fa&&Ce(y.i,st),pe=Gn.call(cs,U)!==!1&&pe}}return pe&&!U.defaultPrevented}function K(y,N,L){if(typeof y=="function")L&&(y=f(y,L));else if(y&&typeof y.handleEvent=="function")y=f(y.handleEvent,y);else throw Error("Invalid listener argument");return 2147483647<Number(N)?-1:l.setTimeout(y,N||0)}function Ae(y){y.g=K(()=>{y.g=null,y.i&&(y.i=!1,Ae(y))},y.l);const N=y.h;y.h=null,y.m.apply(null,N)}class Ne extends z{constructor(N,L){super(),this.m=N,this.l=L,this.h=null,this.i=!1,this.g=null}j(N){this.h=arguments,this.g?this.i=!0:Ae(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Oe(y){z.call(this),this.h=y,this.g={}}g(Oe,z);var He=[];function ce(y){A(y.g,function(N,L){this.g.hasOwnProperty(L)&&fn(N)},y),y.g={}}Oe.prototype.N=function(){Oe.aa.N.call(this),ce(this)},Oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _e=l.JSON.stringify,Be=l.JSON.parse,Te=class{stringify(y){return l.JSON.stringify(y,void 0)}parse(y){return l.JSON.parse(y,void 0)}};function Et(){}Et.prototype.h=null;function wt(y){return y.h||(y.h=y.i())}function xt(){}var pt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function At(){F.call(this,"d")}g(At,F);function On(){F.call(this,"c")}g(On,F);var Tn={},mr=null;function mn(){return mr=mr||new Ee}Tn.La="serverreachability";function Ft(y){F.call(this,Tn.La,y)}g(Ft,F);function Xt(y){const N=mn();ee(N,new Ft(N))}Tn.STAT_EVENT="statevent";function or(y,N){F.call(this,Tn.STAT_EVENT,y),this.stat=N}g(or,F);function J(y){const N=mn();ee(N,new or(N,y))}Tn.Ma="timingevent";function ue(y,N){F.call(this,Tn.Ma,y),this.size=N}g(ue,F);function we(y,N){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){y()},N)}function Le(){this.g=!0}Le.prototype.xa=function(){this.g=!1};function Ze(y,N,L,U,pe,je){y.info(function(){if(y.g)if(je)for(var st="",Gn=je.split("&"),cs=0;cs<Gn.length;cs++){var wn=Gn[cs].split("=");if(1<wn.length){var Ss=wn[0];wn=wn[1];var Cs=Ss.split("_");st=2<=Cs.length&&Cs[1]=="type"?st+(Ss+"="+wn+"&"):st+(Ss+"=redacted&")}}else st=null;else st=je;return"XMLHTTP REQ ("+U+") [attempt "+pe+"]: "+N+`
`+L+`
`+st})}function X(y,N,L,U,pe,je,st){y.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+pe+"]: "+N+`
`+L+`
`+je+" "+st})}function ne(y,N,L,U){y.info(function(){return"XMLHTTP TEXT ("+N+"): "+q(y,L)+(U?" "+U:"")})}function me(y,N){y.info(function(){return"TIMEOUT: "+N})}Le.prototype.info=function(){};function q(y,N){if(!y.g)return N;if(!N)return null;try{var L=JSON.parse(N);if(L){for(y=0;y<L.length;y++)if(Array.isArray(L[y])){var U=L[y];if(!(2>U.length)){var pe=U[1];if(Array.isArray(pe)&&!(1>pe.length)){var je=pe[0];if(je!="noop"&&je!="stop"&&je!="close")for(var st=1;st<pe.length;st++)pe[st]=""}}}}return _e(L)}catch{return N}}var ie={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},be={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ie;function Ve(){}g(Ve,Et),Ve.prototype.g=function(){return new XMLHttpRequest},Ve.prototype.i=function(){return{}},Ie=new Ve;function Se(y,N,L,U){this.j=y,this.i=N,this.l=L,this.R=U||1,this.U=new Oe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ot}function ot(){this.i=null,this.g="",this.h=!1}var lt={},jt={};function vn(y,N,L){y.L=1,y.v=ke(_n(N)),y.m=L,y.P=!0,ts(y,null)}function ts(y,N){y.F=Date.now(),ri(y),y.A=_n(y.v);var L=y.A,U=y.R;Array.isArray(U)||(U=[String(U)]),Hr(L.i,"t",U),y.C=0,L=y.j.J,y.h=new ot,y.g=Nk(y.j,L?N:null,!y.m),0<y.O&&(y.M=new Ne(f(y.Y,y,y.g),y.O)),N=y.U,L=y.g,U=y.ca;var pe="readystatechange";Array.isArray(pe)||(pe&&(He[0]=pe.toString()),pe=He);for(var je=0;je<pe.length;je++){var st=Me(L,pe[je],U||N.handleEvent,!1,N.h||N);if(!st)break;N.g[st.key]=st}N=y.H?I(y.H):{},y.m?(y.u||(y.u="POST"),N["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.A,y.u,y.m,N)):(y.u="GET",y.g.ea(y.A,y.u,null,N)),Xt(),Ze(y.i,y.u,y.A,y.l,y.R,y.m)}Se.prototype.ca=function(y){y=y.target;const N=this.M;N&&Ra(y)==3?N.j():this.Y(y)},Se.prototype.Y=function(y){try{if(y==this.g)e:{const Cs=Ra(this.g);var N=this.g.Ba();const Td=this.g.Z();if(!(3>Cs)&&(Cs!=3||this.g&&(this.h.h||this.g.oa()||yk(this.g)))){this.J||Cs!=4||N==7||(N==8||0>=Td?Xt(3):Xt(2)),Us(this);var L=this.g.Z();this.X=L;t:if(Vn(this)){var U=yk(this.g);y="";var pe=U.length,je=Ra(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ns(this),Bs(this);var st="";break t}this.h.i=new l.TextDecoder}for(N=0;N<pe;N++)this.h.h=!0,y+=this.h.i.decode(U[N],{stream:!(je&&N==pe-1)});U.length=0,this.h.g+=y,this.C=0,st=this.h.g}else st=this.g.oa();if(this.o=L==200,X(this.i,this.u,this.A,this.l,this.R,Cs,L),this.o){if(this.T&&!this.K){t:{if(this.g){var Gn,cs=this.g;if((Gn=cs.g?cs.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(Gn)){var wn=Gn;break t}}wn=null}if(L=wn)ne(this.i,this.l,L,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,tn(this,L);else{this.o=!1,this.s=3,J(12),ns(this),Bs(this);break e}}if(this.P){L=!0;let Co;for(;!this.J&&this.C<st.length;)if(Co=Wr(this,st),Co==jt){Cs==4&&(this.s=4,J(14),L=!1),ne(this.i,this.l,null,"[Incomplete Response]");break}else if(Co==lt){this.s=4,J(15),ne(this.i,this.l,st,"[Invalid Chunk]"),L=!1;break}else ne(this.i,this.l,Co,null),tn(this,Co);if(Vn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Cs!=4||st.length!=0||this.h.h||(this.s=1,J(16),L=!1),this.o=this.o&&L,!L)ne(this.i,this.l,st,"[Invalid Chunked Response]"),ns(this),Bs(this);else if(0<st.length&&!this.W){this.W=!0;var Ss=this.j;Ss.g==this&&Ss.ba&&!Ss.M&&(Ss.j.info("Great, no buffering proxy detected. Bytes received: "+st.length),p_(Ss),Ss.M=!0,J(11))}}else ne(this.i,this.l,st,null),tn(this,st);Cs==4&&ns(this),this.o&&!this.J&&(Cs==4?Ck(this.j,this):(this.o=!1,ri(this)))}else jq(this.g),L==400&&0<st.indexOf("Unknown SID")?(this.s=3,J(12)):(this.s=0,J(13)),ns(this),Bs(this)}}}catch{}finally{}};function Vn(y){return y.g?y.u=="GET"&&y.L!=2&&y.j.Ca:!1}function Wr(y,N){var L=y.C,U=N.indexOf(`
`,L);return U==-1?jt:(L=Number(N.substring(L,U)),isNaN(L)?lt:(U+=1,U+L>N.length?jt:(N=N.slice(U,U+L),y.C=U+L,N)))}Se.prototype.cancel=function(){this.J=!0,ns(this)};function ri(y){y.S=Date.now()+y.I,$s(y,y.I)}function $s(y,N){if(y.B!=null)throw Error("WatchDog timer not null");y.B=we(f(y.ba,y),N)}function Us(y){y.B&&(l.clearTimeout(y.B),y.B=null)}Se.prototype.ba=function(){this.B=null;const y=Date.now();0<=y-this.S?(me(this.i,this.A),this.L!=2&&(Xt(),J(17)),ns(this),this.s=2,Bs(this)):$s(this,this.S-y)};function Bs(y){y.j.G==0||y.J||Ck(y.j,y)}function ns(y){Us(y);var N=y.M;N&&typeof N.ma=="function"&&N.ma(),y.M=null,ce(y.U),y.g&&(N=y.g,y.g=null,N.abort(),N.ma())}function tn(y,N){try{var L=y.j;if(L.G!=0&&(L.g==y||oi(L.h,y))){if(!y.K&&oi(L.h,y)&&L.G==3){try{var U=L.Da.g.parse(N)}catch{U=null}if(Array.isArray(U)&&U.length==3){var pe=U;if(pe[0]==0){e:if(!L.u){if(L.g)if(L.g.F+3e3<y.F)gy(L),my(L);else break e;m_(L),J(18)}}else L.za=pe[1],0<L.za-L.T&&37500>pe[2]&&L.F&&L.v==0&&!L.C&&(L.C=we(f(L.Za,L),6e3));if(1>=$n(L.h)&&L.ca){try{L.ca()}catch{}L.ca=void 0}}else nu(L,11)}else if((y.K||L.g==y)&&gy(L),!_(N))for(pe=L.Da.g.parse(N),N=0;N<pe.length;N++){let wn=pe[N];if(L.T=wn[0],wn=wn[1],L.G==2)if(wn[0]=="c"){L.K=wn[1],L.ia=wn[2];const Ss=wn[3];Ss!=null&&(L.la=Ss,L.j.info("VER="+L.la));const Cs=wn[4];Cs!=null&&(L.Aa=Cs,L.j.info("SVER="+L.Aa));const Td=wn[5];Td!=null&&typeof Td=="number"&&0<Td&&(U=1.5*Td,L.L=U,L.j.info("backChannelRequestTimeoutMs_="+U)),U=L;const Co=y.g;if(Co){const xy=Co.g?Co.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xy){var je=U.h;je.g||xy.indexOf("spdy")==-1&&xy.indexOf("quic")==-1&&xy.indexOf("h2")==-1||(je.j=je.l,je.g=new Set,je.h&&(_o(je,je.h),je.h=null))}if(U.D){const g_=Co.g?Co.g.getResponseHeader("X-HTTP-Session-Id"):null;g_&&(U.ya=g_,oe(U.I,U.D,g_))}}L.G=3,L.l&&L.l.ua(),L.ba&&(L.R=Date.now()-y.F,L.j.info("Handshake RTT: "+L.R+"ms")),U=L;var st=y;if(U.qa=Ik(U,U.J?U.ia:null,U.W),st.K){Qo(U.h,st);var Gn=st,cs=U.L;cs&&(Gn.I=cs),Gn.B&&(Us(Gn),ri(Gn)),U.g=st}else _k(U);0<L.i.length&&py(L)}else wn[0]!="stop"&&wn[0]!="close"||nu(L,7);else L.G==3&&(wn[0]=="stop"||wn[0]=="close"?wn[0]=="stop"?nu(L,7):f_(L):wn[0]!="noop"&&L.l&&L.l.ta(wn),L.v=0)}}Xt(4)}catch{}}var In=class{constructor(y,N){this.g=y,this.map=N}};function si(y){this.l=y||10,l.PerformanceNavigationTiming?(y=l.performance.getEntriesByType("navigation"),y=0<y.length&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ii(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function $n(y){return y.h?1:y.g?y.g.size:0}function oi(y,N){return y.h?y.h==N:y.g?y.g.has(N):!1}function _o(y,N){y.g?y.g.add(N):y.h=N}function Qo(y,N){y.h&&y.h==N?y.h=null:y.g&&y.g.has(N)&&y.g.delete(N)}si.prototype.cancel=function(){if(this.i=Qc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Qc(y){if(y.h!=null)return y.i.concat(y.h.D);if(y.g!=null&&y.g.size!==0){let N=y.i;for(const L of y.g.values())N=N.concat(L.D);return N}return x(y.i)}function Vf(y){if(y.V&&typeof y.V=="function")return y.V();if(typeof Map<"u"&&y instanceof Map||typeof Set<"u"&&y instanceof Set)return Array.from(y.values());if(typeof y=="string")return y.split("");if(c(y)){for(var N=[],L=y.length,U=0;U<L;U++)N.push(y[U]);return N}N=[],L=0;for(U in y)N[L++]=y[U];return N}function Zc(y){if(y.na&&typeof y.na=="function")return y.na();if(!y.V||typeof y.V!="function"){if(typeof Map<"u"&&y instanceof Map)return Array.from(y.keys());if(!(typeof Set<"u"&&y instanceof Set)){if(c(y)||typeof y=="string"){var N=[];y=y.length;for(var L=0;L<y;L++)N.push(L);return N}N=[],L=0;for(const U in y)N[L++]=U;return N}}}function eu(y,N){if(y.forEach&&typeof y.forEach=="function")y.forEach(N,void 0);else if(c(y)||typeof y=="string")Array.prototype.forEach.call(y,N,void 0);else for(var L=Zc(y),U=Vf(y),pe=U.length,je=0;je<pe;je++)N.call(void 0,U[je],L&&L[je],y)}var tu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Sd(y,N){if(y){y=y.split("&");for(var L=0;L<y.length;L++){var U=y[L].indexOf("="),pe=null;if(0<=U){var je=y[L].substring(0,U);pe=y[L].substring(U+1)}else je=y[L];N(je,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function _t(y){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,y instanceof _t){this.h=y.h,ae(this,y.j),this.o=y.o,this.g=y.g,se(this,y.s),this.l=y.l;var N=y.i,L=new Hn;L.i=N.i,N.g&&(L.g=new Map(N.g),L.h=N.h),re(this,L),this.m=y.m}else y&&(N=String(y).match(tu))?(this.h=!1,ae(this,N[1]||"",!0),this.o=$e(N[2]||""),this.g=$e(N[3]||"",!0),se(this,N[4]),this.l=$e(N[5]||"",!0),re(this,N[6]||"",!0),this.m=$e(N[7]||"")):(this.h=!1,this.i=new Hn(null,this.h))}_t.prototype.toString=function(){var y=[],N=this.j;N&&y.push(We(N,tt,!0),":");var L=this.g;return(L||N=="file")&&(y.push("//"),(N=this.o)&&y.push(We(N,tt,!0),"@"),y.push(encodeURIComponent(String(L)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L=this.s,L!=null&&y.push(":",String(L))),(L=this.l)&&(this.g&&L.charAt(0)!="/"&&y.push("/"),y.push(We(L,L.charAt(0)=="/"?$t:mt,!0))),(L=this.i.toString())&&y.push("?",L),(L=this.m)&&y.push("#",We(L,Rn)),y.join("")};function _n(y){return new _t(y)}function ae(y,N,L){y.j=L?$e(N,!0):N,y.j&&(y.j=y.j.replace(/:$/,""))}function se(y,N){if(N){if(N=Number(N),isNaN(N)||0>N)throw Error("Bad port number "+N);y.s=N}else y.s=null}function re(y,N,L){N instanceof Hn?(y.i=N,rs(y.i,y.h)):(L||(N=We(N,Ht)),y.i=new Hn(N,y.h))}function oe(y,N,L){y.i.set(N,L)}function ke(y){return oe(y,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),y}function $e(y,N){return y?N?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function We(y,N,L){return typeof y=="string"?(y=encodeURI(y).replace(N,nt),L&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function nt(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var tt=/[#\/\?@]/g,mt=/[#\?:]/g,$t=/[#\?]/g,Ht=/[#\?@]/g,Rn=/#/g;function Hn(y,N){this.h=this.g=null,this.i=y||null,this.j=!!N}function rt(y){y.g||(y.g=new Map,y.h=0,y.i&&Sd(y.i,function(N,L){y.add(decodeURIComponent(N.replace(/\+/g," ")),L)}))}t=Hn.prototype,t.add=function(y,N){rt(this),this.i=null,y=jr(this,y);var L=this.g.get(y);return L||this.g.set(y,L=[]),L.push(N),this.h+=1,this};function bt(y,N){rt(y),N=jr(y,N),y.g.has(N)&&(y.i=null,y.h-=y.g.get(N).length,y.g.delete(N))}function hn(y,N){return rt(y),N=jr(y,N),y.g.has(N)}t.forEach=function(y,N){rt(this),this.g.forEach(function(L,U){L.forEach(function(pe){y.call(N,pe,U,this)},this)},this)},t.na=function(){rt(this);const y=Array.from(this.g.values()),N=Array.from(this.g.keys()),L=[];for(let U=0;U<N.length;U++){const pe=y[U];for(let je=0;je<pe.length;je++)L.push(N[U])}return L},t.V=function(y){rt(this);let N=[];if(typeof y=="string")hn(this,y)&&(N=N.concat(this.g.get(jr(this,y))));else{y=Array.from(this.g.values());for(let L=0;L<y.length;L++)N=N.concat(y[L])}return N},t.set=function(y,N){return rt(this),this.i=null,y=jr(this,y),hn(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[N]),this.h+=1,this},t.get=function(y,N){return y?(y=this.V(y),0<y.length?String(y[0]):N):N};function Hr(y,N,L){bt(y,N),0<L.length&&(y.i=null,y.g.set(jr(y,N),x(L)),y.h+=L.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],N=Array.from(this.g.keys());for(var L=0;L<N.length;L++){var U=N[L];const je=encodeURIComponent(String(U)),st=this.V(U);for(U=0;U<st.length;U++){var pe=je;st[U]!==""&&(pe+="="+encodeURIComponent(String(st[U]))),y.push(pe)}}return this.i=y.join("&")};function jr(y,N){return N=String(N),y.j&&(N=N.toLowerCase()),N}function rs(y,N){N&&!y.j&&(rt(y),y.i=null,y.g.forEach(function(L,U){var pe=U.toLowerCase();U!=pe&&(bt(this,U),Hr(this,pe,L))},y)),y.j=N}function kt(y,N){const L=new Le;if(l.Image){const U=new Image;U.onload=m(pr,L,"TestLoadImage: loaded",!0,N,U),U.onerror=m(pr,L,"TestLoadImage: error",!1,N,U),U.onabort=m(pr,L,"TestLoadImage: abort",!1,N,U),U.ontimeout=m(pr,L,"TestLoadImage: timeout",!1,N,U),l.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=y}else N(!1)}function jn(y,N){const L=new Le,U=new AbortController,pe=setTimeout(()=>{U.abort(),pr(L,"TestPingServer: timeout",!1,N)},1e4);fetch(y,{signal:U.signal}).then(je=>{clearTimeout(pe),je.ok?pr(L,"TestPingServer: ok",!0,N):pr(L,"TestPingServer: server error",!1,N)}).catch(()=>{clearTimeout(pe),pr(L,"TestPingServer: error",!1,N)})}function pr(y,N,L,U,pe){try{pe&&(pe.onload=null,pe.onerror=null,pe.onabort=null,pe.ontimeout=null),U(L)}catch{}}function Ei(){this.g=new Te}function Cd(y,N,L){const U=L||"";try{eu(y,function(pe,je){let st=pe;u(pe)&&(st=_e(pe)),N.push(U+je+"="+encodeURIComponent(st))})}catch(pe){throw N.push(U+"type="+encodeURIComponent("_badmap")),pe}}function Zn(y){this.l=y.Ub||null,this.j=y.eb||!1}g(Zn,Et),Zn.prototype.g=function(){return new Un(this.l,this.j)},Zn.prototype.i=function(y){return function(){return y}}({});function Un(y,N){Ee.call(this),this.D=y,this.o=N,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(Un,Ee),t=Un.prototype,t.open=function(y,N){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=y,this.A=N,this.readyState=1,So(this)},t.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const N={headers:this.u,method:this.B,credentials:this.m,cache:void 0};y&&(N.body=y),(this.D||l).fetch(new Request(this.A,N)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,to(this)),this.readyState=0},t.Sa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,So(this)),this.g&&(this.readyState=3,So(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;qn(this)}else y.text().then(this.Ra.bind(this),this.ga.bind(this))};function qn(y){y.j.read().then(y.Pa.bind(y)).catch(y.ga.bind(y))}t.Pa=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var N=y.value?y.value:new Uint8Array(0);(N=this.v.decode(N,{stream:!y.done}))&&(this.response=this.responseText+=N)}y.done?to(this):So(this),this.readyState==3&&qn(this)}},t.Ra=function(y){this.g&&(this.response=this.responseText=y,to(this))},t.Qa=function(y){this.g&&(this.response=y,to(this))},t.ga=function(){this.g&&to(this)};function to(y){y.readyState=4,y.l=null,y.j=null,y.v=null,So(y)}t.setRequestHeader=function(y,N){this.u.append(y,N)},t.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],N=this.h.entries();for(var L=N.next();!L.done;)L=L.value,y.push(L[0]+": "+L[1]),L=N.next();return y.join(`\r
`)};function So(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Un.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Zo(y){let N="";return A(y,function(L,U){N+=U,N+=":",N+=L,N+=`\r
`}),N}function Ti(y,N,L){e:{for(U in L){var U=!1;break e}U=!0}U||(L=Zo(L),typeof y=="string"?L!=null&&encodeURIComponent(String(L)):oe(y,N,L))}function er(y){Ee.call(this),this.headers=new Map,this.o=y||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(er,Ee);var kq=/^https?$/i,Rq=["POST","PUT"];t=er.prototype,t.Ha=function(y){this.J=y},t.ea=function(y,N,L,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);N=N?N.toUpperCase():"GET",this.D=y,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ie.g(),this.v=this.o?wt(this.o):wt(Ie),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(N,String(y),!0),this.B=!1}catch(je){fk(this,je);return}if(y=L||"",L=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var pe in U)L.set(pe,U[pe]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const je of U.keys())L.set(je,U.get(je));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(L.keys()).find(je=>je.toLowerCase()=="content-type"),pe=l.FormData&&y instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Rq,N,void 0))||U||pe||L.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[je,st]of L)this.g.setRequestHeader(je,st);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{gk(this),this.u=!0,this.g.send(y),this.u=!1}catch(je){fk(this,je)}};function fk(y,N){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=N,y.m=5,mk(y),fy(y)}function mk(y){y.A||(y.A=!0,ee(y,"complete"),ee(y,"error"))}t.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=y||7,ee(this,"complete"),ee(this,"abort"),fy(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fy(this,!0)),er.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?pk(this):this.bb())},t.bb=function(){pk(this)};function pk(y){if(y.h&&typeof o<"u"&&(!y.v[1]||Ra(y)!=4||y.Z()!=2)){if(y.u&&Ra(y)==4)K(y.Ea,0,y);else if(ee(y,"readystatechange"),Ra(y)==4){y.h=!1;try{const st=y.Z();e:switch(st){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var N=!0;break e;default:N=!1}var L;if(!(L=N)){var U;if(U=st===0){var pe=String(y.D).match(tu)[1]||null;!pe&&l.self&&l.self.location&&(pe=l.self.location.protocol.slice(0,-1)),U=!kq.test(pe?pe.toLowerCase():"")}L=U}if(L)ee(y,"complete"),ee(y,"success");else{y.m=6;try{var je=2<Ra(y)?y.g.statusText:""}catch{je=""}y.l=je+" ["+y.Z()+"]",mk(y)}}finally{fy(y)}}}}function fy(y,N){if(y.g){gk(y);const L=y.g,U=y.v[0]?()=>{}:null;y.g=null,y.v=null,N||ee(y,"ready");try{L.onreadystatechange=U}catch{}}}function gk(y){y.I&&(l.clearTimeout(y.I),y.I=null)}t.isActive=function(){return!!this.g};function Ra(y){return y.g?y.g.readyState:0}t.Z=function(){try{return 2<Ra(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(y){if(this.g){var N=this.g.responseText;return y&&N.indexOf(y)==0&&(N=N.substring(y.length)),Be(N)}};function yk(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.H){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function jq(y){const N={};y=(y.g&&2<=Ra(y)&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<y.length;U++){if(_(y[U]))continue;var L=j(y[U]);const pe=L[0];if(L=L[1],typeof L!="string")continue;L=L.trim();const je=N[pe]||[];N[pe]=je,je.push(L)}E(N,function(U){return U.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function $f(y,N,L){return L&&L.internalChannelParams&&L.internalChannelParams[y]||N}function xk(y){this.Aa=0,this.i=[],this.j=new Le,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=$f("failFast",!1,y),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=$f("baseRetryDelayMs",5e3,y),this.cb=$f("retryDelaySeedMs",1e4,y),this.Wa=$f("forwardChannelMaxRetries",2,y),this.wa=$f("forwardChannelRequestTimeoutMs",2e4,y),this.pa=y&&y.xmlHttpFactory||void 0,this.Xa=y&&y.Tb||void 0,this.Ca=y&&y.useFetchStreams||!1,this.L=void 0,this.J=y&&y.supportsCrossDomainXhr||!1,this.K="",this.h=new si(y&&y.concurrentRequestLimit),this.Da=new Ei,this.P=y&&y.fastHandshake||!1,this.O=y&&y.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=y&&y.Rb||!1,y&&y.xa&&this.j.xa(),y&&y.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&y&&y.detectBufferingProxy||!1,this.ja=void 0,y&&y.longPollingTimeout&&0<y.longPollingTimeout&&(this.ja=y.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=xk.prototype,t.la=8,t.G=1,t.connect=function(y,N,L,U){J(0),this.W=y,this.H=N||{},L&&U!==void 0&&(this.H.OSID=L,this.H.OAID=U),this.F=this.X,this.I=Ik(this,null,this.W),py(this)};function f_(y){if(vk(y),y.G==3){var N=y.U++,L=_n(y.I);if(oe(L,"SID",y.K),oe(L,"RID",N),oe(L,"TYPE","terminate"),Uf(y,L),N=new Se(y,y.j,N),N.L=2,N.v=ke(_n(L)),L=!1,l.navigator&&l.navigator.sendBeacon)try{L=l.navigator.sendBeacon(N.v.toString(),"")}catch{}!L&&l.Image&&(new Image().src=N.v,L=!0),L||(N.g=Nk(N.j,null),N.g.ea(N.v)),N.F=Date.now(),ri(N)}Tk(y)}function my(y){y.g&&(p_(y),y.g.cancel(),y.g=null)}function vk(y){my(y),y.u&&(l.clearTimeout(y.u),y.u=null),gy(y),y.h.cancel(),y.s&&(typeof y.s=="number"&&l.clearTimeout(y.s),y.s=null)}function py(y){if(!ii(y.h)&&!y.s){y.s=!0;var N=y.Ga;Q||V(),H||(Q(),H=!0),Y.add(N,y),y.B=0}}function Dq(y,N){return $n(y.h)>=y.h.j-(y.s?1:0)?!1:y.s?(y.i=N.D.concat(y.i),!0):y.G==1||y.G==2||y.B>=(y.Va?0:y.Wa)?!1:(y.s=we(f(y.Ga,y,N),Ek(y,y.B)),y.B++,!0)}t.Ga=function(y){if(this.s)if(this.s=null,this.G==1){if(!y){this.U=Math.floor(1e5*Math.random()),y=this.U++;const pe=new Se(this,this.j,y);let je=this.o;if(this.S&&(je?(je=I(je),k(je,this.S)):je=this.S),this.m!==null||this.O||(pe.H=je,je=null),this.P)e:{for(var N=0,L=0;L<this.i.length;L++){t:{var U=this.i[L];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(N+=U,4096<N){N=L;break e}if(N===4096||L===this.i.length-1){N=L+1;break e}}N=1e3}else N=1e3;N=bk(this,pe,N),L=_n(this.I),oe(L,"RID",y),oe(L,"CVER",22),this.D&&oe(L,"X-HTTP-Session-Id",this.D),Uf(this,L),je&&(this.O?N="headers="+encodeURIComponent(String(Zo(je)))+"&"+N:this.m&&Ti(L,this.m,je)),_o(this.h,pe),this.Ua&&oe(L,"TYPE","init"),this.P?(oe(L,"$req",N),oe(L,"SID","null"),pe.T=!0,vn(pe,L,null)):vn(pe,L,N),this.G=2}}else this.G==3&&(y?wk(this,y):this.i.length==0||ii(this.h)||wk(this))};function wk(y,N){var L;N?L=N.l:L=y.U++;const U=_n(y.I);oe(U,"SID",y.K),oe(U,"RID",L),oe(U,"AID",y.T),Uf(y,U),y.m&&y.o&&Ti(U,y.m,y.o),L=new Se(y,y.j,L,y.B+1),y.m===null&&(L.H=y.o),N&&(y.i=N.D.concat(y.i)),N=bk(y,L,1e3),L.I=Math.round(.5*y.wa)+Math.round(.5*y.wa*Math.random()),_o(y.h,L),vn(L,U,N)}function Uf(y,N){y.H&&A(y.H,function(L,U){oe(N,U,L)}),y.l&&eu({},function(L,U){oe(N,U,L)})}function bk(y,N,L){L=Math.min(y.i.length,L);var U=y.l?f(y.l.Na,y.l,y):null;e:{var pe=y.i;let je=-1;for(;;){const st=["count="+L];je==-1?0<L?(je=pe[0].g,st.push("ofs="+je)):je=0:st.push("ofs="+je);let Gn=!0;for(let cs=0;cs<L;cs++){let wn=pe[cs].g;const Ss=pe[cs].map;if(wn-=je,0>wn)je=Math.max(0,pe[cs].g-100),Gn=!1;else try{Cd(Ss,st,"req"+wn+"_")}catch{U&&U(Ss)}}if(Gn){U=st.join("&");break e}}}return y=y.i.splice(0,L),N.D=y,U}function _k(y){if(!y.g&&!y.u){y.Y=1;var N=y.Fa;Q||V(),H||(Q(),H=!0),Y.add(N,y),y.v=0}}function m_(y){return y.g||y.u||3<=y.v?!1:(y.Y++,y.u=we(f(y.Fa,y),Ek(y,y.v)),y.v++,!0)}t.Fa=function(){if(this.u=null,Sk(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var y=2*this.R;this.j.info("BP detection timer enabled: "+y),this.A=we(f(this.ab,this),y)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,J(10),my(this),Sk(this))};function p_(y){y.A!=null&&(l.clearTimeout(y.A),y.A=null)}function Sk(y){y.g=new Se(y,y.j,"rpc",y.Y),y.m===null&&(y.g.H=y.o),y.g.O=0;var N=_n(y.qa);oe(N,"RID","rpc"),oe(N,"SID",y.K),oe(N,"AID",y.T),oe(N,"CI",y.F?"0":"1"),!y.F&&y.ja&&oe(N,"TO",y.ja),oe(N,"TYPE","xmlhttp"),Uf(y,N),y.m&&y.o&&Ti(N,y.m,y.o),y.L&&(y.g.I=y.L);var L=y.g;y=y.ia,L.L=1,L.v=ke(_n(N)),L.m=null,L.P=!0,ts(L,y)}t.Za=function(){this.C!=null&&(this.C=null,my(this),m_(this),J(19))};function gy(y){y.C!=null&&(l.clearTimeout(y.C),y.C=null)}function Ck(y,N){var L=null;if(y.g==N){gy(y),p_(y),y.g=null;var U=2}else if(oi(y.h,N))L=N.D,Qo(y.h,N),U=1;else return;if(y.G!=0){if(N.o)if(U==1){L=N.m?N.m.length:0,N=Date.now()-N.F;var pe=y.B;U=mn(),ee(U,new ue(U,L)),py(y)}else _k(y);else if(pe=N.s,pe==3||pe==0&&0<N.X||!(U==1&&Dq(y,N)||U==2&&m_(y)))switch(L&&0<L.length&&(N=y.h,N.i=N.i.concat(L)),pe){case 1:nu(y,5);break;case 4:nu(y,10);break;case 3:nu(y,6);break;default:nu(y,2)}}}function Ek(y,N){let L=y.Ta+Math.floor(Math.random()*y.cb);return y.isActive()||(L*=2),L*N}function nu(y,N){if(y.j.info("Error code "+N),N==2){var L=f(y.fb,y),U=y.Xa;const pe=!U;U=new _t(U||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ae(U,"https"),ke(U),pe?kt(U.toString(),L):jn(U.toString(),L)}else J(2);y.G=0,y.l&&y.l.sa(N),Tk(y),vk(y)}t.fb=function(y){y?(this.j.info("Successfully pinged google.com"),J(2)):(this.j.info("Failed to ping google.com"),J(1))};function Tk(y){if(y.G=0,y.ka=[],y.l){const N=Qc(y.h);(N.length!=0||y.i.length!=0)&&(w(y.ka,N),w(y.ka,y.i),y.h.i.length=0,x(y.i),y.i.length=0),y.l.ra()}}function Ik(y,N,L){var U=L instanceof _t?_n(L):new _t(L);if(U.g!="")N&&(U.g=N+"."+U.g),se(U,U.s);else{var pe=l.location;U=pe.protocol,N=N?N+"."+pe.hostname:pe.hostname,pe=+pe.port;var je=new _t(null);U&&ae(je,U),N&&(je.g=N),pe&&se(je,pe),L&&(je.l=L),U=je}return L=y.D,N=y.ya,L&&N&&oe(U,L,N),oe(U,"VER",y.la),Uf(y,U),U}function Nk(y,N,L){if(N&&!y.J)throw Error("Can't create secondary domain capable XhrIo object.");return N=y.Ca&&!y.pa?new er(new Zn({eb:L})):new er(y.pa),N.Ha(y.J),N}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pk(){}t=Pk.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function yy(){}yy.prototype.g=function(y,N){return new Ii(y,N)};function Ii(y,N){Ee.call(this),this.g=new xk(N),this.l=y,this.h=N&&N.messageUrlParams||null,y=N&&N.messageHeaders||null,N&&N.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=N&&N.initMessageHeaders||null,N&&N.messageContentType&&(y?y["X-WebChannel-Content-Type"]=N.messageContentType:y={"X-WebChannel-Content-Type":N.messageContentType}),N&&N.va&&(y?y["X-WebChannel-Client-Profile"]=N.va:y={"X-WebChannel-Client-Profile":N.va}),this.g.S=y,(y=N&&N.Sb)&&!_(y)&&(this.g.m=y),this.v=N&&N.supportsCrossDomainXhr||!1,this.u=N&&N.sendRawJson||!1,(N=N&&N.httpSessionIdParam)&&!_(N)&&(this.g.D=N,y=this.h,y!==null&&N in y&&(y=this.h,N in y&&delete y[N])),this.j=new Ed(this)}g(Ii,Ee),Ii.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ii.prototype.close=function(){f_(this.g)},Ii.prototype.o=function(y){var N=this.g;if(typeof y=="string"){var L={};L.__data__=y,y=L}else this.u&&(L={},L.__data__=_e(y),y=L);N.i.push(new In(N.Ya++,y)),N.G==3&&py(N)},Ii.prototype.N=function(){this.g.l=null,delete this.j,f_(this.g),delete this.g,Ii.aa.N.call(this)};function Ak(y){At.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var N=y.__sm__;if(N){e:{for(const L in N){y=L;break e}y=void 0}(this.i=y)&&(y=this.i,N=N!==null&&y in N?N[y]:void 0),this.data=N}else this.data=y}g(Ak,At);function kk(){On.call(this),this.status=1}g(kk,On);function Ed(y){this.g=y}g(Ed,Pk),Ed.prototype.ua=function(){ee(this.g,"a")},Ed.prototype.ta=function(y){ee(this.g,new Ak(y))},Ed.prototype.sa=function(y){ee(this.g,new kk)},Ed.prototype.ra=function(){ee(this.g,"b")},yy.prototype.createWebChannel=yy.prototype.g,Ii.prototype.send=Ii.prototype.o,Ii.prototype.open=Ii.prototype.m,Ii.prototype.close=Ii.prototype.close,o9=function(){return new yy},i9=function(){return mn()},s9=Tn,xT={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ie.NO_ERROR=0,ie.TIMEOUT=8,ie.HTTP_ERROR=6,iv=ie,be.COMPLETE="complete",r9=be,xt.EventType=pt,pt.OPEN="a",pt.CLOSE="b",pt.ERROR="c",pt.MESSAGE="d",Ee.prototype.listen=Ee.prototype.K,km=xt,er.prototype.listenOnce=er.prototype.L,er.prototype.getLastError=er.prototype.Ka,er.prototype.getLastErrorCode=er.prototype.Ba,er.prototype.getStatus=er.prototype.Z,er.prototype.getResponseJson=er.prototype.Oa,er.prototype.getResponseText=er.prototype.oa,er.prototype.send=er.prototype.ea,er.prototype.setWithCredentials=er.prototype.Ha,n9=er}).apply(typeof cx<"u"?cx:typeof self<"u"?self:typeof window<"u"?window:{});const KM="@firebase/firestore",YM="4.7.16";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ms.UNAUTHENTICATED=new ms(null),ms.GOOGLE_CREDENTIALS=new ms("google-credentials-uid"),ms.FIRST_PARTY=new ms("first-party-uid"),ms.MOCK_USER=new ms("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kf="11.8.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zu=new lP("@firebase/firestore");function Kd(){return Zu.logLevel}function Xe(t,...e){if(Zu.logLevel<=cn.DEBUG){const n=e.map(wP);Zu.debug(`Firestore (${kf}): ${t}`,...n)}}function Ys(t,...e){if(Zu.logLevel<=cn.ERROR){const n=e.map(wP);Zu.error(`Firestore (${kf}): ${t}`,...n)}}function ed(t,...e){if(Zu.logLevel<=cn.WARN){const n=e.map(wP);Zu.warn(`Firestore (${kf}): ${t}`,...n)}}function wP(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,a9(t,r,n)}function a9(t,e,n){let r=`FIRESTORE (${kf}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ys(r),new Error(r)}function Tt(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||a9(e,s,r)}function Jt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class at extends Xo{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Qye{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ms.UNAUTHENTICATED))}shutdown(){}}class Zye{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class exe{constructor(e){this.t=e,this.currentUser=ms.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Tt(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new ba;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ba,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ba)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Tt(typeof r.accessToken=="string",31837,{l:r}),new l9(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Tt(e===null||typeof e=="string",2055,{h:e}),new ms(e)}}class txe{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=ms.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class nxe{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new txe(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(ms.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class JM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rxe{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ks(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Tt(this.o===void 0,3512);const r=i=>{i.error!=null&&Xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Xe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new JM(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Tt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new JM(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sxe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c9(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u9{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=sxe(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Gt(t,e){return t<e?-1:t>e?1:0}function vT(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return Gt(r,s);{const i=c9(),o=ixe(i.encode(XM(t,n)),i.encode(XM(e,n)));return o!==0?o:Gt(r,s)}}n+=r>65535?2:1}return Gt(t.length,e.length)}function XM(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function ixe(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return Gt(t[n],e[n]);return Gt(t.length,e.length)}function ef(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function d9(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QM=-62135596800,ZM=1e6;class br{static now(){return br.fromMillis(Date.now())}static fromDate(e){return br.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*ZM);return new br(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new at(Fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new at(Fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<QM)throw new at(Fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new at(Fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ZM}_compareTo(e){return this.seconds===e.seconds?Gt(this.nanoseconds,e.nanoseconds):Gt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-QM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{static fromTimestamp(e){return new Rt(e)}static min(){return new Rt(new br(0,0))}static max(){return new Rt(new br(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4="__name__";class oa{constructor(e,n,r){n===void 0?n=0:n>e.length&&St(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&St(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return oa.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof oa?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=oa.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Gt(e.length,n.length)}static compareSegments(e,n){const r=oa.isNumericId(e),s=oa.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?oa.extractNumericId(e).compare(oa.extractNumericId(n)):vT(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return hc.fromString(e.substring(4,e.length-2))}}class An extends oa{construct(e,n,r){return new An(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new at(Fe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new An(n)}static emptyPath(){return new An([])}}const oxe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vr extends oa{construct(e,n,r){return new vr(e,n,r)}static isValidIdentifier(e){return oxe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===e4}static keyField(){return new vr([e4])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new at(Fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new at(Fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new at(Fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new at(Fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new vr(n)}static emptyPath(){return new vr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e){this.path=e}static fromPath(e){return new dt(An.fromString(e))}static fromName(e){return new dt(An.fromString(e).popFirst(5))}static empty(){return new dt(An.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&An.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return An.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new dt(new An(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jp=-1;class Nw{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function wT(t){return t.fields.find(e=>e.kind===2)}function hu(t){return t.fields.filter(e=>e.kind!==2)}Nw.UNKNOWN_ID=-1;class ov{constructor(e,n){this.fieldPath=e,this.kind=n}}class Xp{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Xp(0,Ji.min())}}function axe(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Rt.fromTimestamp(r===1e9?new br(n+1,0):new br(n,r));return new Ji(s,dt.empty(),e)}function h9(t){return new Ji(t.readTime,t.key,Jp)}class Ji{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ji(Rt.min(),dt.empty(),Jp)}static max(){return new Ji(Rt.max(),dt.empty(),Jp)}}function bP(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=dt.comparator(t.documentKey,e.documentKey),n!==0?n:Gt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f9="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class m9{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pd(t){if(t.code!==Fe.FAILED_PRECONDITION||t.message!==f9)throw t;Xe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&St(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ye((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ye?n:ye.resolve(n)}catch(n){return ye.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ye.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ye.reject(n)}static resolve(e){return new ye((n,r)=>{n(e)})}static reject(e){return new ye((n,r)=>{r(e)})}static waitFor(e){return new ye((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=ye.resolve(!1);for(const r of e)n=n.next(s=>s?ye.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new ye((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new ye((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Li="SimpleDb";class Cb{static open(e,n,r,s){try{return new Cb(n,e.transaction(s,r))}catch(i){throw new op(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new ba,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new op(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=_P(r.target.error);this.S.reject(new op(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Xe(Li,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new cxe(n)}}class fc{static delete(e){return Xe(Li,"Removing database:",e),yu(lz().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!gz())return!1;if(fc.F())return!0;const e=Qr(),n=fc.M(e),r=0<n&&n<10,s=p9(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.B=r,this.L=null,fc.M(Qr())===12.2&&Ys("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(Xe(Li,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new op(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new at(Fe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new at(Fe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new op(e,o))},s.onupgradeneeded=i=>{Xe(Li,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;if(this.L!==null&&this.L!==i.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${i.oldVersion}, event.newVersion=${i.newVersion}, db.version=${o.version}`);this.B.q(o,s.transaction,i.oldVersion,this.version).next(()=>{Xe(Li,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",n=>{const r=n.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=n=>this.$(n)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const l=Cb.open(this.db,e,i?"readonly":"readwrite",r),c=s(l).next(u=>(l.v(),u)).catch(u=>(l.abort(u),ye.reject(u))).toPromise();return c.catch(()=>{}),await l.D,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(Xe(Li,"Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function p9(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class lxe{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return yu(this.K.delete())}}class op extends at{constructor(e,n){super(Fe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Hc(t){return t.name==="IndexedDbTransactionError"}class cxe{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Xe(Li,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(Xe(Li,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),yu(r)}add(e){return Xe(Li,"ADD",this.store.name,e,e),yu(this.store.add(e))}get(e){return yu(this.store.get(e)).next(n=>(n===void 0&&(n=null),Xe(Li,"GET",this.store.name,e,n),n))}delete(e){return Xe(Li,"DELETE",this.store.name,e),yu(this.store.delete(e))}count(){return Xe(Li,"COUNT",this.store.name),yu(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new ye((o,l)=>{i.onerror=c=>{l(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.Y(i,(l,c)=>{o.push(c)}).next(()=>o)}}Z(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new ye((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}X(e,n){Xe(Li,"DELETE ALL",this.store.name);const r=this.options(e,n);r.ee=!1;const s=this.cursor(r);return this.Y(s,(i,o,l)=>l.delete())}te(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.Y(s,n)}ne(e){const n=this.cursor({});return new ye((r,s)=>{n.onerror=i=>{const o=_P(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():r()}):r()}})}Y(e,n){const r=[];return new ye((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const c=new lxe(l),u=n(l.primaryKey,l.value,c);if(u instanceof ye){const d=u.catch(h=>(c.done(),ye.reject(h)));r.push(d)}c.isDone?s():c.j===null?l.continue():l.continue(c.j)}}).next(()=>ye.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function yu(t){return new ye((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=_P(r.target.error);n(s)}})}let t4=!1;function _P(t){const e=fc.M(Qr());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new at("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return t4||(t4=!0,setTimeout(()=>{throw r},0)),r}}return t}const ap="IndexBackfiller";class uxe{constructor(e,n){this.asyncQueue=e,this.re=n,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){Xe(ap,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.re.se();Xe(ap,`Documents written: ${n}`)}catch(n){Hc(n)?Xe(ap,"Ignoring IndexedDB error during index backfill: ",n):await pd(n)}await this.ie(6e4)})}}class dxe{constructor(e,n){this.localStore=e,this.persistence=n}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.oe(n,e))}oe(e,n){const r=new Set;let s=n,i=!0;return ye.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Xe(ap,`Processing collection: ${o}`),this._e(e,o,s).next(l=>{s-=l,r.add(o)});i=!1})).next(()=>n-s)}_e(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ae(s,i)).next(l=>(Xe(ap,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,n,l))).next(()=>o.size)}))}ae(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=h9(i);bP(o,r)>0&&(r=o)}),new Ji(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>n.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}ho.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fu=-1;function Eb(t){return t==null}function Qp(t){return t===0&&1/t==-1/0}function hxe(t){return typeof t=="number"&&Number.isInteger(t)&&!Qp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pw="";function Ms(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=n4(e)),e=fxe(t.get(n),e);return n4(e)}function fxe(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Pw:n+="";break;default:n+=i}}return n}function n4(t){return t+Pw+""}function da(t){const e=t.length;if(Tt(e>=2,64408,{path:t}),e===2)return Tt(t.charAt(0)===Pw&&t.charAt(1)==="",56145,{path:t}),An.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(Pw,i);switch((o<0||o>n)&&St(50515,{path:t}),t.charAt(o+1)){case"":const l=t.substring(i,o);let c;s.length===0?c=l:(s+=l,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:St(61167,{path:t})}i=o+2}return new An(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fu="remoteDocuments",Xg="owner",Ld="owner",Zp="mutationQueues",mxe="userId",Ro="mutations",r4="batchId",Ru="userMutationsIndex",s4=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function av(t,e){return[t,Ms(e)]}function g9(t,e,n){return[t,Ms(e),n]}const pxe={},tf="documentMutations",Aw="remoteDocumentsV14",gxe=["prefixPath","collectionGroup","readTime","documentId"],lv="documentKeyIndex",yxe=["prefixPath","collectionGroup","documentId"],y9="collectionGroupIndex",xxe=["collectionGroup","readTime","prefixPath","documentId"],eg="remoteDocumentGlobal",bT="remoteDocumentGlobalKey",nf="targets",x9="queryTargetsIndex",vxe=["canonicalId","targetId"],rf="targetDocuments",wxe=["targetId","path"],SP="documentTargetsIndex",bxe=["path","targetId"],kw="targetGlobalKey",Ou="targetGlobal",tg="collectionParents",_xe=["collectionId","parent"],sf="clientMetadata",Sxe="clientId",Tb="bundles",Cxe="bundleId",Ib="namedQueries",Exe="name",CP="indexConfiguration",Txe="indexId",_T="collectionGroupIndex",Ixe="collectionGroup",lp="indexState",Nxe=["indexId","uid"],v9="sequenceNumberIndex",Pxe=["uid","sequenceNumber"],cp="indexEntries",Axe=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],w9="documentKeyIndex",kxe=["indexId","uid","orderedDocumentKey"],Nb="documentOverlays",Rxe=["userId","collectionPath","documentId"],ST="collectionPathOverlayIndex",jxe=["userId","collectionPath","largestBatchId"],b9="collectionGroupOverlayIndex",Dxe=["userId","collectionGroup","largestBatchId"],EP="globals",Mxe="name",_9=[Zp,Ro,tf,fu,nf,Xg,Ou,rf,sf,eg,tg,Tb,Ib],Lxe=[..._9,Nb],S9=[Zp,Ro,tf,Aw,nf,Xg,Ou,rf,sf,eg,tg,Tb,Ib,Nb],C9=S9,TP=[...C9,CP,lp,cp],Fxe=TP,E9=[...TP,EP],Oxe=E9;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT extends m9{constructor(e,n){super(),this.he=e,this.currentSequenceNumber=n}}function es(t,e){const n=Jt(t);return fc.N(n.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i4(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function qc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function T9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e,n){this.comparator=e,this.root=n||ps.EMPTY}insert(e,n){return new fr(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ps.BLACK,null,null))}remove(e){return new fr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ps.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ux(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ux(this.root,e,this.comparator,!1)}getReverseIterator(){return new ux(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ux(this.root,e,this.comparator,!0)}}class ux{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ps{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ps.RED,this.left=s??ps.EMPTY,this.right=i??ps.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ps(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ps.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ps.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ps.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ps.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw St(43730,{key:this.key,value:this.value});if(this.right.isRed())throw St(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw St(27949);return e+(this.isRed()?0:1)}}ps.EMPTY=null,ps.RED=!0,ps.BLACK=!1;ps.EMPTY=new class{constructor(){this.size=0}get key(){throw St(57766)}get value(){throw St(16141)}get color(){throw St(16727)}get left(){throw St(29726)}get right(){throw St(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new ps(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.comparator=e,this.data=new fr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new o4(this.data.getIterator())}getIteratorFrom(e){return new o4(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Fn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Fn(this.comparator);return n.data=e,n}}class o4{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Fd(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e){this.fields=e,e.sort(vr.comparator)}static empty(){return new fi([])}unionWith(e){let n=new Fn(vr.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new fi(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ef(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I9 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new I9("Invalid base64 string: "+i):i}}(e);return new Gr(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Gr(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Gt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Gr.EMPTY_BYTE_STRING=new Gr("");const Vxe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function cl(t){if(Tt(!!t,39018),typeof t=="string"){let e=0;const n=Vxe.exec(t);if(Tt(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:cr(t.seconds),nanos:cr(t.nanos)}}function cr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ul(t){return typeof t=="string"?Gr.fromBase64String(t):Gr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N9="server_timestamp",P9="__type__",A9="__previous_value__",k9="__local_write_time__";function IP(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[P9])===null||n===void 0?void 0:n.stringValue)===N9}function Pb(t){const e=t.mapValue.fields[A9];return IP(e)?Pb(e):e}function ng(t){const e=cl(t.mapValue.fields[k9].timestampValue);return new br(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $xe{constructor(e,n,r,s,i,o,l,c,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=d}}const Rw="(default)";class td{constructor(e,n){this.projectId=e,this.database=n||Rw}static empty(){return new td("","")}get isDefaultDatabase(){return this.database===Rw}isEqual(e){return e instanceof td&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NP="__type__",R9="__max__",Jl={mapValue:{fields:{__type__:{stringValue:R9}}}},PP="__vector__",of="value",cv={nullValue:"NULL_VALUE"};function Ec(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?IP(t)?4:j9(t)?9007199254740991:Ab(t)?10:11:St(28295,{value:t})}function Ea(t,e){if(t===e)return!0;const n=Ec(t);if(n!==Ec(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ng(t).isEqual(ng(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=cl(s.timestampValue),l=cl(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ul(s.bytesValue).isEqual(ul(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return cr(s.geoPointValue.latitude)===cr(i.geoPointValue.latitude)&&cr(s.geoPointValue.longitude)===cr(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return cr(s.integerValue)===cr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=cr(s.doubleValue),l=cr(i.doubleValue);return o===l?Qp(o)===Qp(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return ef(t.arrayValue.values||[],e.arrayValue.values||[],Ea);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(i4(o)!==i4(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Ea(o[c],l[c])))return!1;return!0}(t,e);default:return St(52216,{left:t})}}function rg(t,e){return(t.values||[]).find(n=>Ea(n,e))!==void 0}function Tc(t,e){if(t===e)return 0;const n=Ec(t),r=Ec(e);if(n!==r)return Gt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Gt(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=cr(i.integerValue||i.doubleValue),c=cr(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return a4(t.timestampValue,e.timestampValue);case 4:return a4(ng(t),ng(e));case 5:return vT(t.stringValue,e.stringValue);case 6:return function(i,o){const l=ul(i),c=ul(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Gt(l[u],c[u]);if(d!==0)return d}return Gt(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Gt(cr(i.latitude),cr(o.latitude));return l!==0?l:Gt(cr(i.longitude),cr(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return l4(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const h=i.fields||{},f=o.fields||{},m=(l=h[of])===null||l===void 0?void 0:l.arrayValue,g=(c=f[of])===null||c===void 0?void 0:c.arrayValue,x=Gt(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((d=g==null?void 0:g.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:l4(m,g)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Jl.mapValue&&o===Jl.mapValue)return 0;if(i===Jl.mapValue)return 1;if(o===Jl.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){const f=vT(c[h],d[h]);if(f!==0)return f;const m=Tc(l[c[h]],u[d[h]]);if(m!==0)return m}return Gt(c.length,d.length)}(t.mapValue,e.mapValue);default:throw St(23264,{Pe:n})}}function a4(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Gt(t,e);const n=cl(t),r=cl(e),s=Gt(n.seconds,r.seconds);return s!==0?s:Gt(n.nanos,r.nanos)}function l4(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Tc(n[s],r[s]);if(i)return i}return Gt(n.length,r.length)}function af(t){return ET(t)}function ET(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=cl(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ul(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return dt.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=ET(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${ET(n.fields[o])}`;return s+"}"}(t.mapValue):St(61005,{value:t})}function uv(t){switch(Ec(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Pb(t);return e?16+uv(e):16;case 5:return 2*t.stringValue.length;case 6:return ul(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+uv(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return qc(r.fields,(i,o)=>{s+=i.length+uv(o)}),s}(t.mapValue);default:throw St(13486,{value:t})}}function sg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function TT(t){return!!t&&"integerValue"in t}function ig(t){return!!t&&"arrayValue"in t}function c4(t){return!!t&&"nullValue"in t}function u4(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function dv(t){return!!t&&"mapValue"in t}function Ab(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[NP])===null||n===void 0?void 0:n.stringValue)===PP}function up(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return qc(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=up(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=up(t.arrayValue.values[n]);return e}return Object.assign({},t)}function j9(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===R9}const D9={mapValue:{fields:{[NP]:{stringValue:PP},[of]:{arrayValue:{}}}}};function Uxe(t){return"nullValue"in t?cv:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?sg(td.empty(),dt.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Ab(t)?D9:{mapValue:{}}:St(35942,{value:t})}function Bxe(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?sg(td.empty(),dt.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?D9:"mapValue"in t?Ab(t)?{mapValue:{}}:Jl:St(61959,{value:t})}function d4(t,e){const n=Tc(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function h4(t,e){const n=Tc(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e){this.value=e}static empty(){return new Ds({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!dv(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=up(n)}setAll(e){let n=vr.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=up(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());dv(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ea(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];dv(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){qc(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Ds(up(this.value))}}function M9(t){const e=[];return qc(t.fields,(n,r)=>{const s=new vr([n]);if(dv(r)){const i=M9(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new fi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tr(e,0,Rt.min(),Rt.min(),Rt.min(),Ds.empty(),0)}static newFoundDocument(e,n,r,s){return new Tr(e,1,n,Rt.min(),r,s,0)}static newNoDocument(e,n){return new Tr(e,2,n,Rt.min(),Rt.min(),Ds.empty(),0)}static newUnknownDocument(e,n){return new Tr(e,3,n,Rt.min(),Rt.min(),Ds.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Rt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ds.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ds.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Rt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e,n){this.position=e,this.inclusive=n}}function f4(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=dt.comparator(dt.fromName(o.referenceValue),n.key):r=Tc(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function m4(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ea(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e,n="asc"){this.field=e,this.dir=n}}function zxe(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L9{}class un extends L9{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Gxe(e,n,r):n==="array-contains"?new qxe(e,r):n==="in"?new B9(e,r):n==="not-in"?new Kxe(e,r):n==="array-contains-any"?new Yxe(e,r):new un(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Wxe(e,r):new Hxe(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Tc(n,this.value)):n!==null&&Ec(this.value)===Ec(n)&&this.matchesComparison(Tc(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return St(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Mn extends L9{constructor(e,n){super(),this.filters=e,this.op=n,this.Te=null}static create(e,n){return new Mn(e,n)}matches(e){return cf(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function cf(t){return t.op==="and"}function IT(t){return t.op==="or"}function AP(t){return F9(t)&&cf(t)}function F9(t){for(const e of t.filters)if(e instanceof Mn)return!1;return!0}function NT(t){if(t instanceof un)return t.field.canonicalString()+t.op.toString()+af(t.value);if(AP(t))return t.filters.map(e=>NT(e)).join(",");{const e=t.filters.map(n=>NT(n)).join(",");return`${t.op}(${e})`}}function O9(t,e){return t instanceof un?function(r,s){return s instanceof un&&r.op===s.op&&r.field.isEqual(s.field)&&Ea(r.value,s.value)}(t,e):t instanceof Mn?function(r,s){return s instanceof Mn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&O9(o,s.filters[l]),!0):!1}(t,e):void St(19439)}function V9(t,e){const n=t.filters.concat(e);return Mn.create(n,t.op)}function $9(t){return t instanceof un?function(n){return`${n.field.canonicalString()} ${n.op} ${af(n.value)}`}(t):t instanceof Mn?function(n){return n.op.toString()+" {"+n.getFilters().map($9).join(" ,")+"}"}(t):"Filter"}class Gxe extends un{constructor(e,n,r){super(e,n,r),this.key=dt.fromName(r.referenceValue)}matches(e){const n=dt.comparator(e.key,this.key);return this.matchesComparison(n)}}class Wxe extends un{constructor(e,n){super(e,"in",n),this.keys=U9("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Hxe extends un{constructor(e,n){super(e,"not-in",n),this.keys=U9("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function U9(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>dt.fromName(r.referenceValue))}class qxe extends un{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return ig(n)&&rg(n.arrayValue,this.value)}}class B9 extends un{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&rg(this.value.arrayValue,n)}}class Kxe extends un{constructor(e,n){super(e,"not-in",n)}matches(e){if(rg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!rg(this.value.arrayValue,n)}}class Yxe extends un{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!ig(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>rg(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jxe{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Ie=null}}function PT(t,e=null,n=[],r=[],s=null,i=null,o=null){return new Jxe(t,e,n,r,s,i,o)}function nd(t){const e=Jt(t);if(e.Ie===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>NT(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Eb(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>af(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>af(r)).join(",")),e.Ie=n}return e.Ie}function Qg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!zxe(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!O9(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!m4(t.startAt,e.startAt)&&m4(t.endAt,e.endAt)}function Dw(t){return dt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Mw(t,e){return t.filters.filter(n=>n instanceof un&&n.field.isEqual(e))}function p4(t,e,n){let r=cv,s=!0;for(const i of Mw(t,e)){let o=cv,l=!0;switch(i.op){case"<":case"<=":o=Uxe(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=cv}d4({value:r,inclusive:s},{value:o,inclusive:l})<0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];d4({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function g4(t,e,n){let r=Jl,s=!0;for(const i of Mw(t,e)){let o=Jl,l=!0;switch(i.op){case">=":case">":o=Bxe(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=Jl}h4({value:r,inclusive:s},{value:o,inclusive:l})>0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];h4({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function Xxe(t,e,n,r,s,i,o,l){return new Zg(t,e,n,r,s,i,o,l)}function ey(t){return new Zg(t)}function y4(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function z9(t){return t.collectionGroup!==null}function dp(t){const e=Jt(t);if(e.Ee===null){e.Ee=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ee.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Fn(vr.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ee.push(new jw(i,r))}),n.has(vr.keyField().canonicalString())||e.Ee.push(new jw(vr.keyField(),r))}return e.Ee}function po(t){const e=Jt(t);return e.de||(e.de=Qxe(e,dp(t))),e.de}function Qxe(t,e){if(t.limitType==="F")return PT(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new jw(s.field,i)});const n=t.endAt?new lf(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new lf(t.startAt.position,t.startAt.inclusive):null;return PT(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function AT(t,e){const n=t.filters.concat([e]);return new Zg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Lw(t,e,n){return new Zg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function kb(t,e){return Qg(po(t),po(e))&&t.limitType===e.limitType}function G9(t){return`${nd(po(t))}|lt:${t.limitType}`}function Yd(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>$9(s)).join(", ")}]`),Eb(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>af(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>af(s)).join(",")),`Target(${r})`}(po(t))}; limitType=${t.limitType})`}function ty(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):dt.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of dp(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=f4(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,dp(r),s)||r.endAt&&!function(o,l,c){const u=f4(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,dp(r),s))}(t,e)}function Zxe(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function W9(t){return(e,n)=>{let r=!1;for(const s of dp(t)){const i=eve(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function eve(t,e,n){const r=t.field.isKeyField()?dt.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Tc(c,u):St(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return St(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){qc(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return T9(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tve=new fr(dt.comparator);function Bi(){return tve}const H9=new fr(dt.comparator);function Rm(...t){let e=H9;for(const n of t)e=e.insert(n.key,n);return e}function q9(t){let e=H9;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ha(){return hp()}function K9(){return hp()}function hp(){return new wl(t=>t.toString(),(t,e)=>t.isEqual(e))}const nve=new fr(dt.comparator),rve=new Fn(dt.comparator);function rn(...t){let e=rve;for(const n of t)e=e.add(n);return e}const sve=new Fn(Gt);function ive(){return sve}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kP(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qp(e)?"-0":e}}function Y9(t){return{integerValue:""+t}}function ove(t,e){return hxe(e)?Y9(e):kP(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{constructor(){this._=void 0}}function ave(t,e,n){return t instanceof og?function(s,i){const o={fields:{[P9]:{stringValue:N9},[k9]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&IP(i)&&(i=Pb(i)),i&&(o.fields[A9]=i),{mapValue:o}}(n,e):t instanceof uf?X9(t,e):t instanceof df?Q9(t,e):function(s,i){const o=J9(s,i),l=x4(o)+x4(s.Re);return TT(o)&&TT(s.Re)?Y9(l):kP(s.serializer,l)}(t,e)}function lve(t,e,n){return t instanceof uf?X9(t,e):t instanceof df?Q9(t,e):n}function J9(t,e){return t instanceof ag?function(r){return TT(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class og extends Rb{}class uf extends Rb{constructor(e){super(),this.elements=e}}function X9(t,e){const n=Z9(e);for(const r of t.elements)n.some(s=>Ea(s,r))||n.push(r);return{arrayValue:{values:n}}}class df extends Rb{constructor(e){super(),this.elements=e}}function Q9(t,e){let n=Z9(e);for(const r of t.elements)n=n.filter(s=>!Ea(s,r));return{arrayValue:{values:n}}}class ag extends Rb{constructor(e,n){super(),this.serializer=e,this.Re=n}}function x4(t){return cr(t.integerValue||t.doubleValue)}function Z9(t){return ig(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cve{constructor(e,n){this.field=e,this.transform=n}}function uve(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof uf&&s instanceof uf||r instanceof df&&s instanceof df?ef(r.elements,s.elements,Ea):r instanceof ag&&s instanceof ag?Ea(r.Re,s.Re):r instanceof og&&s instanceof og}(t.transform,e.transform)}class dve{constructor(e,n){this.version=e,this.transformResults=n}}class Js{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Js}static exists(e){return new Js(void 0,e)}static updateTime(e){return new Js(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function hv(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class jb{}function e8(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Db(t.key,Js.none()):new Rf(t.key,t.data,Js.none());{const n=t.data,r=Ds.empty();let s=new Fn(vr.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new bl(t.key,r,new fi(s.toArray()),Js.none())}}function hve(t,e,n){t instanceof Rf?function(s,i,o){const l=s.value.clone(),c=w4(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof bl?function(s,i,o){if(!hv(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=w4(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(t8(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function fp(t,e,n,r){return t instanceof Rf?function(i,o,l,c){if(!hv(i.precondition,o))return l;const u=i.value.clone(),d=b4(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof bl?function(i,o,l,c){if(!hv(i.precondition,o))return l;const u=b4(i.fieldTransforms,c,o),d=o.data;return d.setAll(t8(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,o,l){return hv(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function fve(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=J9(r.transform,s||null);i!=null&&(n===null&&(n=Ds.empty()),n.set(r.field,i))}return n||null}function v4(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ef(r,s,(i,o)=>uve(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Rf extends jb{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class bl extends jb{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function t8(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function w4(t,e,n){const r=new Map;Tt(t.length===n.length,32656,{Ve:n.length,me:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,lve(o,l,n[s]))}return r}function b4(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,ave(i,o,e))}return r}class Db extends jb{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class n8 extends jb{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&hve(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=fp(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=fp(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=K9();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=e8(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(Rt.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),rn())}isEqual(e){return this.batchId===e.batchId&&ef(this.mutations,e.mutations,(n,r)=>v4(n,r))&&ef(this.baseMutations,e.baseMutations,(n,r)=>v4(n,r))}}class jP{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Tt(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let s=function(){return nve}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new jP(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mve{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lr,pn;function pve(t){switch(t){case Fe.OK:return St(64938);case Fe.CANCELLED:case Fe.UNKNOWN:case Fe.DEADLINE_EXCEEDED:case Fe.RESOURCE_EXHAUSTED:case Fe.INTERNAL:case Fe.UNAVAILABLE:case Fe.UNAUTHENTICATED:return!1;case Fe.INVALID_ARGUMENT:case Fe.NOT_FOUND:case Fe.ALREADY_EXISTS:case Fe.PERMISSION_DENIED:case Fe.FAILED_PRECONDITION:case Fe.ABORTED:case Fe.OUT_OF_RANGE:case Fe.UNIMPLEMENTED:case Fe.DATA_LOSS:return!0;default:return St(15467,{code:t})}}function r8(t){if(t===void 0)return Ys("GRPC error has no .code"),Fe.UNKNOWN;switch(t){case Lr.OK:return Fe.OK;case Lr.CANCELLED:return Fe.CANCELLED;case Lr.UNKNOWN:return Fe.UNKNOWN;case Lr.DEADLINE_EXCEEDED:return Fe.DEADLINE_EXCEEDED;case Lr.RESOURCE_EXHAUSTED:return Fe.RESOURCE_EXHAUSTED;case Lr.INTERNAL:return Fe.INTERNAL;case Lr.UNAVAILABLE:return Fe.UNAVAILABLE;case Lr.UNAUTHENTICATED:return Fe.UNAUTHENTICATED;case Lr.INVALID_ARGUMENT:return Fe.INVALID_ARGUMENT;case Lr.NOT_FOUND:return Fe.NOT_FOUND;case Lr.ALREADY_EXISTS:return Fe.ALREADY_EXISTS;case Lr.PERMISSION_DENIED:return Fe.PERMISSION_DENIED;case Lr.FAILED_PRECONDITION:return Fe.FAILED_PRECONDITION;case Lr.ABORTED:return Fe.ABORTED;case Lr.OUT_OF_RANGE:return Fe.OUT_OF_RANGE;case Lr.UNIMPLEMENTED:return Fe.UNIMPLEMENTED;case Lr.DATA_LOSS:return Fe.DATA_LOSS;default:return St(39323,{code:t})}}(pn=Lr||(Lr={}))[pn.OK=0]="OK",pn[pn.CANCELLED=1]="CANCELLED",pn[pn.UNKNOWN=2]="UNKNOWN",pn[pn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pn[pn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pn[pn.NOT_FOUND=5]="NOT_FOUND",pn[pn.ALREADY_EXISTS=6]="ALREADY_EXISTS",pn[pn.PERMISSION_DENIED=7]="PERMISSION_DENIED",pn[pn.UNAUTHENTICATED=16]="UNAUTHENTICATED",pn[pn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pn[pn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pn[pn.ABORTED=10]="ABORTED",pn[pn.OUT_OF_RANGE=11]="OUT_OF_RANGE",pn[pn.UNIMPLEMENTED=12]="UNIMPLEMENTED",pn[pn.INTERNAL=13]="INTERNAL",pn[pn.UNAVAILABLE=14]="UNAVAILABLE",pn[pn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gve=new hc([4294967295,4294967295],0);function _4(t){const e=c9().encode(t),n=new t9;return n.update(e),new Uint8Array(n.digest())}function S4(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new hc([n,r],0),new hc([s,i],0)]}class MP{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new jm(`Invalid padding: ${n}`);if(r<0)throw new jm(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new jm(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new jm(`Invalid padding when bitmap length is 0: ${n}`);this.pe=8*e.length-n,this.ye=hc.fromNumber(this.pe)}we(e,n,r){let s=e.add(n.multiply(hc.fromNumber(r)));return s.compare(gve)===1&&(s=new hc([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}Se(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const n=_4(e),[r,s]=S4(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);if(!this.Se(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new MP(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.pe===0)return;const n=_4(e),[r,s]=S4(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class jm extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,ny.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Mb(Rt.min(),s,new fr(Gt),Bi(),rn())}}class ny{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ny(r,n,rn(),rn(),rn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e,n,r,s){this.De=e,this.removedTargetIds=n,this.key=r,this.ve=s}}class s8{constructor(e,n){this.targetId=e,this.Ce=n}}class i8{constructor(e,n,r=Gr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class C4{constructor(){this.Fe=0,this.Me=E4(),this.xe=Gr.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=rn(),n=rn(),r=rn();return this.Me.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:St(38017,{changeType:i})}}),new ny(this.xe,this.Oe,e,n,r)}Qe(){this.Ne=!1,this.Me=E4()}$e(e,n){this.Ne=!0,this.Me=this.Me.insert(e,n)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Tt(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class yve{constructor(e){this.ze=e,this.je=new Map,this.He=Bi(),this.Je=dx(),this.Ye=dx(),this.Ze=new fr(Gt)}Xe(e){for(const n of e.De)e.ve&&e.ve.isFoundDocument()?this.et(n,e.ve):this.tt(n,e.key,e.ve);for(const n of e.removedTargetIds)this.tt(n,e.key,e.ve)}nt(e){this.forEachTarget(e,n=>{const r=this.rt(n);switch(e.state){case 0:this.it(n)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(n);break;case 3:this.it(n)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(n)&&(this.st(n),r.ke(e.resumeToken));break;default:St(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.je.forEach((r,s)=>{this.it(s)&&n(s)})}ot(e){const n=e.targetId,r=e.Ce.count,s=this._t(n);if(s){const i=s.target;if(Dw(i))if(r===0){const o=new dt(i.path);this.tt(n,o,Tr.newNoDocument(o,Rt.min()))}else Tt(r===1,20013,{expectedCount:r});else{const o=this.ut(n);if(o!==r){const l=this.ct(e),c=l?this.lt(l,e,o):1;if(c!==0){this.st(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,u)}}}}}ct(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=ul(r).toUint8Array()}catch(c){if(c instanceof I9)return ed("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new MP(o,s,i)}catch(c){return ed(c instanceof jm?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.pe===0?null:l}lt(e,n,r){return n.Ce.count===r-this.Tt(e,n.targetId)?0:2}Tt(e,n){const r=this.ze.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.ze.Pt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.tt(n,i,null),s++)}),s}It(e){const n=new Map;this.je.forEach((i,o)=>{const l=this._t(o);if(l){if(i.current&&Dw(l.target)){const c=new dt(l.target.path);this.Et(c).has(o)||this.dt(o,c)||this.tt(o,c,Tr.newNoDocument(c,e))}i.Le&&(n.set(o,i.qe()),i.Qe())}});let r=rn();this.Ye.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this._t(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.He.forEach((i,o)=>o.setReadTime(e));const s=new Mb(e,n,this.Ze,this.He,r);return this.He=Bi(),this.Je=dx(),this.Ye=dx(),this.Ze=new fr(Gt),s}et(e,n){if(!this.it(e))return;const r=this.dt(e,n.key)?2:0;this.rt(e).$e(n.key,r),this.He=this.He.insert(n.key,n),this.Je=this.Je.insert(n.key,this.Et(n.key).add(e)),this.Ye=this.Ye.insert(n.key,this.At(n.key).add(e))}tt(e,n,r){if(!this.it(e))return;const s=this.rt(e);this.dt(e,n)?s.$e(n,1):s.Ue(n),this.Ye=this.Ye.insert(n,this.At(n).delete(e)),this.Ye=this.Ye.insert(n,this.At(n).add(e)),r&&(this.He=this.He.insert(n,r))}removeTarget(e){this.je.delete(e)}ut(e){const n=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let n=this.je.get(e);return n||(n=new C4,this.je.set(e,n)),n}At(e){let n=this.Ye.get(e);return n||(n=new Fn(Gt),this.Ye=this.Ye.insert(e,n)),n}Et(e){let n=this.Je.get(e);return n||(n=new Fn(Gt),this.Je=this.Je.insert(e,n)),n}it(e){const n=this._t(e)!==null;return n||Xe("WatchChangeAggregator","Detected inactive target",e),n}_t(e){const n=this.je.get(e);return n&&n.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new C4),this.ze.getRemoteKeysForTarget(e).forEach(n=>{this.tt(e,n,null)})}dt(e,n){return this.ze.getRemoteKeysForTarget(e).has(n)}}function dx(){return new fr(dt.comparator)}function E4(){return new fr(dt.comparator)}const xve=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),vve=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),wve=(()=>({and:"AND",or:"OR"}))();class bve{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function kT(t,e){return t.useProto3Json||Eb(e)?e:{value:e}}function hf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function o8(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function _ve(t,e){return hf(t,e.toTimestamp())}function Qs(t){return Tt(!!t,49232),Rt.fromTimestamp(function(n){const r=cl(n);return new br(r.seconds,r.nanos)}(t))}function LP(t,e){return RT(t,e).canonicalString()}function RT(t,e){const n=function(s){return new An(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function a8(t){const e=An.fromString(t);return Tt(g8(e),10190,{key:e.toString()}),e}function Fw(t,e){return LP(t.databaseId,e.path)}function Vu(t,e){const n=a8(e);if(n.get(1)!==t.databaseId.projectId)throw new at(Fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new at(Fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new dt(u8(n))}function l8(t,e){return LP(t.databaseId,e)}function c8(t){const e=a8(t);return e.length===4?An.emptyPath():u8(e)}function jT(t){return new An(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function u8(t){return Tt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function T4(t,e,n){return{name:Fw(t,e),fields:n.value.mapValue.fields}}function Sve(t,e,n){const r=Vu(t,e.name),s=Qs(e.updateTime),i=e.createTime?Qs(e.createTime):Rt.min(),o=new Ds({mapValue:{fields:e.fields}}),l=Tr.newFoundDocument(r,s,i,o);return n&&l.setHasCommittedMutations(),n?l.setHasCommittedMutations():l}function Cve(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:St(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Tt(d===void 0||typeof d=="string",58123),Gr.fromBase64String(d||"")):(Tt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Gr.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?Fe.UNKNOWN:r8(u.code);return new at(d,u.message||"")}(o);n=new i8(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Vu(t,r.document.name),i=Qs(r.document.updateTime),o=r.document.createTime?Qs(r.document.createTime):Rt.min(),l=new Ds({mapValue:{fields:r.document.fields}}),c=Tr.newFoundDocument(s,i,o,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new fv(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Vu(t,r.document),i=r.readTime?Qs(r.readTime):Rt.min(),o=Tr.newNoDocument(s,i),l=r.removedTargetIds||[];n=new fv([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Vu(t,r.document),i=r.removedTargetIds||[];n=new fv([],i,s,null)}else{if(!("filter"in e))return St(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new mve(s,i),l=r.targetId;n=new s8(l,o)}}return n}function Ow(t,e){let n;if(e instanceof Rf)n={update:T4(t,e.key,e.value)};else if(e instanceof Db)n={delete:Fw(t,e.key)};else if(e instanceof bl)n={update:T4(t,e.key,e.data),updateMask:Ave(e.fieldMask)};else{if(!(e instanceof n8))return St(16599,{ft:e.type});n={verify:Fw(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof og)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof uf)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof df)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ag)return{fieldPath:o.field.canonicalString(),increment:l.Re};throw St(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:_ve(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:St(27497)}(t,e.precondition)),n}function DT(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Js.updateTime(Qs(i.updateTime)):i.exists!==void 0?Js.exists(i.exists):Js.none()}(e.currentDocument):Js.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,l){let c=null;if("setToServerValue"in l)Tt(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),c=new og;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new uf(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new df(d)}else"increment"in l?c=new ag(o,l.increment):St(16584,{proto:l});const u=vr.fromServerFormat(l.fieldPath);return new cve(u,c)}(t,s)):[];if(e.update){e.update.name;const s=Vu(t,e.update.name),i=new Ds({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new fi(u.map(d=>vr.fromServerFormat(d)))}(e.updateMask);return new bl(s,i,o,n,r)}return new Rf(s,i,n,r)}if(e.delete){const s=Vu(t,e.delete);return new Db(s,n)}if(e.verify){const s=Vu(t,e.verify);return new n8(s,n)}return St(1463,{proto:e})}function Eve(t,e){return t&&t.length>0?(Tt(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Qs(s.updateTime):Qs(i);return o.isEqual(Rt.min())&&(o=Qs(i)),new dve(o,s.transformResults||[])}(n,e))):[]}function d8(t,e){return{documents:[l8(t,e.path)]}}function h8(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=l8(t,s);const i=function(u){if(u.length!==0)return p8(Mn.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(f){return{field:Jd(f.field),direction:Ive(f.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=kT(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{gt:n,parent:s}}function f8(t){let e=c8(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Tt(r===1,65062);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(h){const f=m8(h);return f instanceof Mn&&AP(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(g){return new jw(Xd(g.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(f))}(n.orderBy));let l=null;n.limit&&(l=function(h){let f;return f=typeof h=="object"?h.value:h,Eb(f)?null:f}(n.limit));let c=null;n.startAt&&(c=function(h){const f=!!h.before,m=h.values||[];return new lf(m,f)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const f=!h.before,m=h.values||[];return new lf(m,f)}(n.endAt)),Xxe(e,s,o,i,l,"F",c,u)}function Tve(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return St(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function m8(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Xd(n.unaryFilter.field);return un.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Xd(n.unaryFilter.field);return un.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Xd(n.unaryFilter.field);return un.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Xd(n.unaryFilter.field);return un.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return St(61313);default:return St(60726)}}(t):t.fieldFilter!==void 0?function(n){return un.create(Xd(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return St(58110);default:return St(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Mn.create(n.compositeFilter.filters.map(r=>m8(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return St(1026)}}(n.compositeFilter.op))}(t):St(30097,{filter:t})}function Ive(t){return xve[t]}function Nve(t){return vve[t]}function Pve(t){return wve[t]}function Jd(t){return{fieldPath:t.canonicalString()}}function Xd(t){return vr.fromServerFormat(t.fieldPath)}function p8(t){return t instanceof un?function(n){if(n.op==="=="){if(u4(n.value))return{unaryFilter:{field:Jd(n.field),op:"IS_NAN"}};if(c4(n.value))return{unaryFilter:{field:Jd(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(u4(n.value))return{unaryFilter:{field:Jd(n.field),op:"IS_NOT_NAN"}};if(c4(n.value))return{unaryFilter:{field:Jd(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jd(n.field),op:Nve(n.op),value:n.value}}}(t):t instanceof Mn?function(n){const r=n.getFilters().map(s=>p8(s));return r.length===1?r[0]:{compositeFilter:{op:Pve(n.op),filters:r}}}(t):St(54877,{filter:t})}function Ave(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function g8(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,n,r,s,i=Rt.min(),o=Rt.min(),l=Gr.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Ha(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ha(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y8{constructor(e){this.wt=e}}function kve(t,e){let n;if(e.document)n=Sve(t.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=dt.fromSegments(e.noDocument.path),s=sd(e.noDocument.readTime);n=Tr.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return St(56709);{const r=dt.fromSegments(e.unknownDocument.path),s=sd(e.unknownDocument.version);n=Tr.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new br(s[0],s[1]);return Rt.fromTimestamp(i)}(e.readTime)),n}function I4(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Vw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Fw(i,o.key),fields:o.data.value.mapValue.fields,updateTime:hf(i,o.version.toTimestamp()),createTime:hf(i,o.createTime.toTimestamp())}}(t.wt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:rd(e.version)};else{if(!e.isUnknownDocument())return St(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:rd(e.version)}}return r}function Vw(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function rd(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function sd(t){const e=new br(t.seconds,t.nanoseconds);return Rt.fromTimestamp(e)}function xu(t,e){const n=(e.baseMutations||[]).map(i=>DT(t.wt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>DT(t.wt,i)),s=br.fromMillis(e.localWriteTimeMs);return new RP(e.batchId,s,n,r)}function Dm(t){const e=sd(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?sd(t.lastLimboFreeSnapshotVersion):Rt.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return Tt(o===1,1966,{count:o}),po(ey(c8(i.documents[0])))}(t.query):function(i){return po(f8(i))}(t.query),new Ha(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Gr.fromBase64String(t.resumeToken))}function x8(t,e){const n=rd(e.snapshotVersion),r=rd(e.lastLimboFreeSnapshotVersion);let s;s=Dw(e.target)?d8(t.wt,e.target):h8(t.wt,e.target).gt;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:nd(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function v8(t){const e=f8({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Lw(e,e.limit,"L"):e}function OS(t,e){return new DP(e.largestBatchId,DT(t.wt,e.overlayMutation))}function N4(t,e){const n=e.path.lastSegment();return[t,Ms(e.path.popLast()),n]}function P4(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:rd(r.readTime),documentKey:Ms(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rve{getBundleMetadata(e,n){return A4(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:sd(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return A4(e).put(function(s){return{bundleId:s.id,createTime:rd(Qs(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return k4(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:v8(i.bundledQuery),readTime:sd(i.readTime)}}(r)})}saveNamedQuery(e,n){return k4(e).put(function(s){return{name:s.name,readTime:rd(Qs(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function A4(t){return es(t,Tb)}function k4(t){return es(t,Ib)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(e,n){this.serializer=e,this.userId=n}static St(e,n){const r=n.uid||"";return new Lb(e,r)}getOverlay(e,n){return om(e).get(N4(this.userId,n)).next(r=>r?OS(this.serializer,r):null)}getOverlays(e,n){const r=ha();return ye.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const l=new DP(n,o);s.push(this.bt(e,l))}),ye.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Ms(o.getCollectionPath())));const i=[];return s.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(om(e).X(ST,l))}),ye.waitFor(i)}getOverlaysForCollection(e,n,r){const s=ha(),i=Ms(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return om(e).J(ST,o).next(l=>{for(const c of l){const u=OS(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=ha();let o;const l=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return om(e).te({index:b9,range:l},(c,u,d)=>{const h=OS(this.serializer,u);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>i)}bt(e,n){return om(e).put(function(s,i,o){const[l,c,u]=N4(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ow(s.wt,o.mutation)}}(this.serializer,this.userId,n))}}function om(t){return es(t,Nb)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jve{Dt(e){return es(e,EP)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Gr.fromUint8Array(r):Gr.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Dt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(){}vt(e,n){this.Ct(e,n),n.Ft()}Ct(e,n){if("nullValue"in e)this.Mt(n,5);else if("booleanValue"in e)this.Mt(n,10),n.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(n,15),n.xt(cr(e.integerValue));else if("doubleValue"in e){const r=cr(e.doubleValue);isNaN(r)?this.Mt(n,13):(this.Mt(n,15),Qp(r)?n.xt(0):n.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(n,20),typeof r=="string"&&(r=cl(r)),n.Ot(`${r.seconds||""}`),n.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,n),this.Bt(n);else if("bytesValue"in e)this.Mt(n,30),n.Lt(ul(e.bytesValue)),this.Bt(n);else if("referenceValue"in e)this.kt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Mt(n,45),n.xt(r.latitude||0),n.xt(r.longitude||0)}else"mapValue"in e?j9(e)?this.Mt(n,Number.MAX_SAFE_INTEGER):Ab(e)?this.qt(e.mapValue,n):(this.Qt(e.mapValue,n),this.Bt(n)):"arrayValue"in e?(this.$t(e.arrayValue,n),this.Bt(n)):St(19022,{Ut:e})}Nt(e,n){this.Mt(n,25),this.Kt(e,n)}Kt(e,n){n.Ot(e)}Qt(e,n){const r=e.fields||{};this.Mt(n,55);for(const s of Object.keys(r))this.Nt(s,n),this.Ct(r[s],n)}qt(e,n){var r,s;const i=e.fields||{};this.Mt(n,53);const o=of,l=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Mt(n,15),n.xt(cr(l)),this.Nt(o,n),this.Ct(i[o],n)}$t(e,n){const r=e.values||[];this.Mt(n,50);for(const s of r)this.Ct(s,n)}kt(e,n){this.Mt(n,37),dt.fromName(e).path.forEach(r=>{this.Mt(n,60),this.Kt(r,n)})}Mt(e,n){e.xt(n)}Bt(e){e.xt(2)}}vu.Wt=new vu;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od=255;function Dve(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function R4(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=Dve(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class Mve{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.zt(r.value),r=n.next();this.jt()}Ht(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Yt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{const s=n.codePointAt(0);this.zt(240|s>>>18),this.zt(128|63&s>>>12),this.zt(128|63&s>>>6),this.zt(128|63&s)}}this.jt()}Xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Yt()}en(e){const n=this.tn(e),r=R4(n);this.nn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}rn(e){const n=this.tn(e),r=R4(n);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}sn(){this._n(Od),this._n(255)}an(){this.un(Od),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}zt(e){const n=255&e;n===0?(this._n(0),this._n(255)):n===Od?(this._n(Od),this._n(0)):this._n(n)}Jt(e){const n=255&e;n===0?(this.un(0),this.un(255)):n===Od?(this.un(Od),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class Lve{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class Fve{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class am{constructor(){this.ln=new Mve,this.hn=new Lve(this.ln),this.Pn=new Fve(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e,n,r,s){this.In=e,this.En=n,this.dn=r,this.An=s}Rn(){const e=this.An.length,n=e===0||this.An[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.An,0),n!==e?r.set([0],this.An.length):++r[r.length-1],new wu(this.In,this.En,this.dn,r)}Vn(e,n,r){return{indexId:this.In,uid:e,arrayValue:mv(this.dn),directionalValue:mv(this.An),orderedDocumentKey:mv(n),documentKey:r.path.toArray()}}mn(e,n,r){const s=this.Vn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Nl(t,e){let n=t.In-e.In;return n!==0?n:(n=j4(t.dn,e.dn),n!==0?n:(n=j4(t.An,e.An),n!==0?n:dt.comparator(t.En,e.En)))}function j4(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function mv(t){return pz()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function D4(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class M4{constructor(e){this.fn=new Fn((n,r)=>vr.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const n of e.filters){const r=n;r.isInequality()?this.fn=this.fn.add(r):this.pn.push(r)}}get yn(){return this.fn.size>1}wn(e){if(Tt(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const n=wT(e);if(n!==void 0&&!this.Sn(n))return!1;const r=hu(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.Sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.fn.size>0){const l=this.fn.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=r[i];if(!this.bn(l,c)||!this.Dn(this.gn[o++],c))return!1}++i}for(;i<r.length;++i){const l=r[i];if(o>=this.gn.length||!this.Dn(this.gn[o++],l))return!1}return!0}vn(){if(this.yn)return null;let e=new Fn(vr.comparator);const n=[];for(const r of this.pn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new ov(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new ov(r.field,0))}for(const r of this.gn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new ov(r.field,r.dir==="asc"?0:1)));return new Nw(Nw.UNKNOWN_ID,this.collectionId,n,Xp.empty())}Sn(e){for(const n of this.pn)if(this.bn(n,e))return!0;return!1}bn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}Dn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w8(t){var e,n;if(Tt(t instanceof un||t instanceof Mn,20012),t instanceof un){if(t instanceof B9){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>un.create(t.field,"==",i)))||[];return Mn.create(s,"or")}return t}const r=t.filters.map(s=>w8(s));return Mn.create(r,t.op)}function Ove(t){if(t.getFilters().length===0)return[];const e=FT(w8(t));return Tt(b8(e),7391),MT(e)||LT(e)?[e]:e.getFilters()}function MT(t){return t instanceof un}function LT(t){return t instanceof Mn&&AP(t)}function b8(t){return MT(t)||LT(t)||function(n){if(n instanceof Mn&&IT(n)){for(const r of n.getFilters())if(!MT(r)&&!LT(r))return!1;return!0}return!1}(t)}function FT(t){if(Tt(t instanceof un||t instanceof Mn,34018),t instanceof un)return t;if(t.filters.length===1)return FT(t.filters[0]);const e=t.filters.map(r=>FT(r));let n=Mn.create(e,t.op);return n=$w(n),b8(n)?n:(Tt(n instanceof Mn,64498),Tt(cf(n),40251),Tt(n.filters.length>1,57927),n.filters.reduce((r,s)=>FP(r,s)))}function FP(t,e){let n;return Tt(t instanceof un||t instanceof Mn,38388),Tt(e instanceof un||e instanceof Mn,25473),n=t instanceof un?e instanceof un?function(s,i){return Mn.create([s,i],"and")}(t,e):L4(t,e):e instanceof un?L4(e,t):function(s,i){if(Tt(s.filters.length>0&&i.filters.length>0,48005),cf(s)&&cf(i))return V9(s,i.getFilters());const o=IT(s)?s:i,l=IT(s)?i:s,c=o.filters.map(u=>FP(u,l));return Mn.create(c,"or")}(t,e),$w(n)}function L4(t,e){if(cf(e))return V9(e,t.getFilters());{const n=e.filters.map(r=>FP(t,r));return Mn.create(n,"or")}}function $w(t){if(Tt(t instanceof un||t instanceof Mn,11850),t instanceof un)return t;const e=t.getFilters();if(e.length===1)return $w(e[0]);if(F9(t))return t;const n=e.map(s=>$w(s)),r=[];return n.forEach(s=>{s instanceof un?r.push(s):s instanceof Mn&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Mn.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vve{constructor(){this.Cn=new OP}addToCollectionParentIndex(e,n){return this.Cn.add(n),ye.resolve()}getCollectionParents(e,n){return ye.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ye.resolve()}deleteFieldIndex(e,n){return ye.resolve()}deleteAllFieldIndexes(e){return ye.resolve()}createTargetIndexes(e,n){return ye.resolve()}getDocumentsMatchingTarget(e,n){return ye.resolve(null)}getIndexType(e,n){return ye.resolve(0)}getFieldIndexes(e,n){return ye.resolve([])}getNextCollectionGroupToUpdate(e){return ye.resolve(null)}getMinOffset(e,n){return ye.resolve(Ji.min())}getMinOffsetFromCollectionGroup(e,n){return ye.resolve(Ji.min())}updateCollectionGroup(e,n,r){return ye.resolve()}updateIndexEntries(e,n){return ye.resolve()}}class OP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Fn(An.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Fn(An.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F4="IndexedDbIndexManager",hx=new Uint8Array(0);class $ve{constructor(e,n){this.databaseId=n,this.Fn=new OP,this.Mn=new wl(r=>nd(r),(r,s)=>Qg(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Fn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.Fn.add(n)});const i={collectionId:r,parent:Ms(s)};return O4(e).put(i)}return ye.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[d9(n),""],!1,!0);return O4(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(da(o.parent))}return r})}addFieldIndex(e,n){const r=lm(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=$d(e);return i.next(l=>{o.put(P4(l,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=lm(e),s=$d(e),i=Vd(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=lm(e),r=Vd(e),s=$d(e);return n.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,n){return ye.forEach(this.xn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new M4(r).vn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Vd(e);let s=!0;const i=new Map;return ye.forEach(this.xn(n),o=>this.On(e,o).next(l=>{s&&(s=!!l),i.set(o,l)})).next(()=>{if(s){let o=rn();const l=[];return ye.forEach(i,(c,u)=>{Xe(F4,`Using index ${function(C){return`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map(T=>`${T.fieldPath}:${T.kind}`).join(",")}`}(c)} to execute ${nd(n)}`);const d=function(C,T){const R=wT(T);if(R===void 0)return null;for(const A of Mw(C,R.fieldPath))switch(A.op){case"array-contains-any":return A.value.arrayValue.values||[];case"array-contains":return[A.value]}return null}(u,c),h=function(C,T){const R=new Map;for(const A of hu(T))for(const E of Mw(C,A.fieldPath))switch(E.op){case"==":case"in":R.set(A.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return R.set(A.fieldPath.canonicalString(),E.value),Array.from(R.values())}return null}(u,c),f=function(C,T){const R=[];let A=!0;for(const E of hu(T)){const I=E.kind===0?p4(C,E.fieldPath,C.startAt):g4(C,E.fieldPath,C.startAt);R.push(I.value),A&&(A=I.inclusive)}return new lf(R,A)}(u,c),m=function(C,T){const R=[];let A=!0;for(const E of hu(T)){const I=E.kind===0?g4(C,E.fieldPath,C.endAt):p4(C,E.fieldPath,C.endAt);R.push(I.value),A&&(A=I.inclusive)}return new lf(R,A)}(u,c),g=this.Nn(c,u,f),x=this.Nn(c,u,m),w=this.Bn(c,u,h),v=this.Ln(c.indexId,d,g,f.inclusive,x,m.inclusive,w);return ye.forEach(v,_=>r.Z(_,n.limit).next(C=>{C.forEach(T=>{const R=dt.fromSegments(T.documentKey);o.has(R)||(o=o.add(R),l.push(R))})}))}).next(()=>l)}return ye.resolve(null)})}xn(e){let n=this.Mn.get(e);return n||(e.filters.length===0?n=[e]:n=Ove(Mn.create(e.filters,"and")).map(r=>PT(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,n),n)}Ln(e,n,r,s,i,o,l){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),u=c/(n!=null?n.length:1),d=[];for(let h=0;h<c;++h){const f=n?this.kn(n[h/u]):hx,m=this.qn(e,f,r[h%u],s),g=this.Qn(e,f,i[h%u],o),x=l.map(w=>this.qn(e,f,w,!0));d.push(...this.createRange(m,g,x))}return d}qn(e,n,r,s){const i=new wu(e,dt.empty(),n,r);return s?i:i.Rn()}Qn(e,n,r,s){const i=new wu(e,dt.empty(),n,r);return s?i.Rn():i}On(e,n){const r=new M4(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const l of i)r.wn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,n){let r=2;const s=this.xn(n);return ye.forEach(s,i=>this.On(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new Fn(vr.comparator),d=!1;for(const h of c.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?d=!0:u=u.add(f.field));for(const h of c.orderBy)h.field.isKeyField()||(u=u.add(h.field));return u.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}$n(e,n){const r=new am;for(const s of hu(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Tn(s.kind);vu.Wt.vt(i,o)}return r.cn()}kn(e){const n=new am;return vu.Wt.vt(e,n.Tn(0)),n.cn()}Un(e,n){const r=new am;return vu.Wt.vt(sg(this.databaseId,n),r.Tn(function(i){const o=hu(i);return o.length===0?0:o[o.length-1].kind}(e))),r.cn()}Bn(e,n,r){if(r===null)return[];let s=[];s.push(new am);let i=0;for(const o of hu(e)){const l=r[i++];for(const c of s)if(this.Kn(n,o.fieldPath)&&ig(l))s=this.Wn(s,o,l);else{const u=c.Tn(o.kind);vu.Wt.vt(l,u)}}return this.Gn(s)}Nn(e,n,r){return this.Bn(e,n,r.position)}Gn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].cn();return n}Wn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const l of s){const c=new am;c.seed(l.cn()),vu.Wt.vt(o,c.Tn(n.kind)),i.push(c)}return i}Kn(e,n){return!!e.filters.find(r=>r instanceof un&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=lm(e),s=$d(e);return(n?r.J(_T,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return ye.forEach(i,l=>s.get([l.indexId,this.uid]).next(c=>{o.push(function(d,h){const f=h?new Xp(h.sequenceNumber,new Ji(sd(h.readTime),new dt(da(h.documentKey)),h.largestBatchId)):Xp.empty(),m=d.fields.map(([g,x])=>new ov(vr.fromServerFormat(g),x));return new Nw(d.indexId,d.collectionGroup,m,f)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Gt(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=lm(e),i=$d(e);return this.zn(e).next(o=>s.J(_T,IDBKeyRange.bound(n,n)).next(l=>ye.forEach(l,c=>i.put(P4(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return ye.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?ye.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(r.set(s.collectionGroup,l),ye.forEach(l,c=>this.jn(e,s,c).next(u=>{const d=this.Hn(i,c);return u.isEqual(d)?ye.resolve():this.Jn(e,i,c,u,d)}))))})}Yn(e,n,r,s){return Vd(e).put(s.Vn(this.uid,this.Un(r,n.key),n.key))}Zn(e,n,r,s){return Vd(e).delete(s.mn(this.uid,this.Un(r,n.key),n.key))}jn(e,n,r){const s=Vd(e);let i=new Fn(Nl);return s.te({index:w9,range:IDBKeyRange.only([r.indexId,this.uid,mv(this.Un(r,n))])},(o,l)=>{i=i.add(new wu(r.indexId,n,D4(l.arrayValue),D4(l.directionalValue)))}).next(()=>i)}Hn(e,n){let r=new Fn(Nl);const s=this.$n(n,e);if(s==null)return r;const i=wT(n);if(i!=null){const o=e.data.field(i.fieldPath);if(ig(o))for(const l of o.arrayValue.values||[])r=r.add(new wu(n.indexId,e.key,this.kn(l),s))}else r=r.add(new wu(n.indexId,e.key,hx,s));return r}Jn(e,n,r,s,i){Xe(F4,"Updating index entries for document '%s'",n.key);const o=[];return function(c,u,d,h,f){const m=c.getIterator(),g=u.getIterator();let x=Fd(m),w=Fd(g);for(;x||w;){let v=!1,_=!1;if(x&&w){const C=d(x,w);C<0?_=!0:C>0&&(v=!0)}else x!=null?_=!0:v=!0;v?(h(w),w=Fd(g)):_?(f(x),x=Fd(m)):(x=Fd(m),w=Fd(g))}}(s,i,Nl,l=>{o.push(this.Yn(e,n,r,l))},l=>{o.push(this.Zn(e,n,r,l))}),ye.waitFor(o)}zn(e){let n=1;return $d(e).te({index:v9,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,l)=>Nl(o,l)).filter((o,l,c)=>!l||Nl(o,c[l-1])!==0);const s=[];s.push(e);for(const o of r){const l=Nl(o,e),c=Nl(o,n);if(l===0)s[0]=e.Rn();else if(l>0&&c<0)s.push(o),s.push(o.Rn());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Xn(s[o],s[o+1]))return[];const l=s[o].mn(this.uid,hx,dt.empty()),c=s[o+1].mn(this.uid,hx,dt.empty());i.push(IDBKeyRange.bound(l,c))}return i}Xn(e,n){return Nl(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(V4)}getMinOffset(e,n){return ye.mapArray(this.xn(n),r=>this.On(e,r).next(s=>s||St(44426))).next(V4)}}function O4(t){return es(t,tg)}function Vd(t){return es(t,cp)}function lm(t){return es(t,CP)}function $d(t){return es(t,lp)}function V4(t){Tt(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;bP(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Ji(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $4={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_8=41943040;class ks{static withCacheSize(e){return new ks(e,ks.DEFAULT_COLLECTION_PERCENTILE,ks.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S8(t,e,n){const r=t.store(Ro),s=t.store(tf),i=[],o=IDBKeyRange.only(n.batchId);let l=0;const c=r.te({range:o},(d,h,f)=>(l++,f.delete()));i.push(c.next(()=>{Tt(l===1,47070,{batchId:n.batchId})}));const u=[];for(const d of n.mutations){const h=g9(e,d.key.path,n.batchId);i.push(s.delete(h)),u.push(d.key)}return ye.waitFor(i).next(()=>u)}function Uw(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw St(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ks.DEFAULT_COLLECTION_PERCENTILE=10,ks.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ks.DEFAULT=new ks(_8,ks.DEFAULT_COLLECTION_PERCENTILE,ks.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ks.DISABLED=new ks(-1,0,0);class Fb{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.er={}}static St(e,n,r,s){Tt(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Fb(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pl(e).te({index:Ru,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Qd(e),o=Pl(e);return o.add({}).next(l=>{Tt(typeof l=="number",49019);const c=new RP(l,n,r,s),u=function(m,g,x){const w=x.baseMutations.map(_=>Ow(m.wt,_)),v=x.mutations.map(_=>Ow(m.wt,_));return{userId:g,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:w,mutations:v}}(this.serializer,this.userId,c),d=[];let h=new Fn((f,m)=>Gt(f.canonicalString(),m.canonicalString()));for(const f of s){const m=g9(this.userId,f.key.path,l);h=h.add(f.key.path.popLast()),d.push(o.put(u)),d.push(i.put(m,pxe))}return h.forEach(f=>{d.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.er[l]=c.keys()}),ye.waitFor(d).next(()=>c)})}lookupMutationBatch(e,n){return Pl(e).get(n).next(r=>r?(Tt(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),xu(this.serializer,r)):null)}tr(e,n){return this.er[n]?ye.resolve(this.er[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.er[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Pl(e).te({index:Ru,range:s},(o,l,c)=>{l.userId===this.userId&&(Tt(l.batchId>=r,47524,{nr:r}),i=xu(this.serializer,l)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Fu;return Pl(e).te({index:Ru,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Fu],[this.userId,Number.POSITIVE_INFINITY]);return Pl(e).J(Ru,n).next(r=>r.map(s=>xu(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=av(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Qd(e).te({range:s},(o,l,c)=>{const[u,d,h]=o,f=da(d);if(u===this.userId&&n.path.isEqual(f))return Pl(e).get(h).next(m=>{if(!m)throw St(61480,{rr:o,batchId:h});Tt(m.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:m.userId,batchId:h}),i.push(xu(this.serializer,m))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Fn(Gt);const s=[];return n.forEach(i=>{const o=av(this.userId,i.path),l=IDBKeyRange.lowerBound(o),c=Qd(e).te({range:l},(u,d,h)=>{const[f,m,g]=u,x=da(m);f===this.userId&&i.path.isEqual(x)?r=r.add(g):h.done()});s.push(c)}),ye.waitFor(s).next(()=>this.ir(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=av(this.userId,r),o=IDBKeyRange.lowerBound(i);let l=new Fn(Gt);return Qd(e).te({range:o},(c,u,d)=>{const[h,f,m]=c,g=da(f);h===this.userId&&r.isPrefixOf(g)?g.length===s&&(l=l.add(m)):d.done()}).next(()=>this.ir(e,l))}ir(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Pl(e).get(i).next(o=>{if(o===null)throw St(35274,{batchId:i});Tt(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(xu(this.serializer,o))}))}),ye.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return S8(e.he,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.sr(n.batchId)}),ye.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return ye.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Qd(e).te({range:r},(i,o,l)=>{if(i[0]===this.userId){const c=da(i[1]);s.push(c)}else l.done()}).next(()=>{Tt(s.length===0,56720,{_r:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return C8(e,this.userId,n)}ar(e){return E8(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Fu,lastStreamToken:""})}}function C8(t,e,n){const r=av(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Qd(t).te({range:i,ee:!0},(l,c,u)=>{const[d,h,f]=l;d===e&&h===s&&(o=!0),u.done()}).next(()=>o)}function Pl(t){return es(t,Ro)}function Qd(t){return es(t,tf)}function E8(t){return es(t,Zp)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new id(0)}static lr(){return new id(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uve{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.hr(e).next(n=>{const r=new id(n.highestTargetId);return n.highestTargetId=r.next(),this.Pr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(n=>Rt.fromTimestamp(new br(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.hr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Pr(e,s)))}addTargetData(e,n){return this.Tr(e,n).next(()=>this.hr(e).next(r=>(r.targetCount+=1,this.Ir(n,r),this.Pr(e,r))))}updateTargetData(e,n){return this.Tr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ud(e).delete(n.targetId)).next(()=>this.hr(e)).next(r=>(Tt(r.targetCount>0,8065),r.targetCount-=1,this.Pr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Ud(e).te((o,l)=>{const c=Dm(l);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>ye.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Ud(e).te((r,s)=>{const i=Dm(s);n(i)})}hr(e){return U4(e).get(kw).next(n=>(Tt(n!==null,2888),n))}Pr(e,n){return U4(e).put(kw,n)}Tr(e,n){return Ud(e).put(x8(this.serializer,n))}Ir(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.hr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=nd(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Ud(e).te({range:s,index:x9},(o,l,c)=>{const u=Dm(l);Qg(n,u.target)&&(i=u,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Wl(e);return n.forEach(o=>{const l=Ms(o.path);s.push(i.put({targetId:r,path:l})),s.push(this.referenceDelegate.addReference(e,r,o))}),ye.waitFor(s)}removeMatchingKeys(e,n,r){const s=Wl(e);return ye.forEach(n,i=>{const o=Ms(i.path);return ye.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Wl(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Wl(e);let i=rn();return s.te({range:r,ee:!0},(o,l,c)=>{const u=da(o[1]),d=new dt(u);i=i.add(d)}).next(()=>i)}containsKey(e,n){const r=Ms(n.path),s=IDBKeyRange.bound([r],[d9(r)],!1,!0);let i=0;return Wl(e).te({index:SP,ee:!0,range:s},([o,l],c,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}Rt(e,n){return Ud(e).get(n).next(r=>r?Dm(r):null)}}function Ud(t){return es(t,nf)}function U4(t){return es(t,Ou)}function Wl(t){return es(t,rf)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4="LruGarbageCollector",Bve=1048576;function z4([t,e],[n,r]){const s=Gt(t,n);return s===0?Gt(e,r):s}class zve{constructor(e){this.Er=e,this.buffer=new Fn(z4),this.dr=0}Ar(){return++this.dr}Rr(e){const n=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();z4(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class T8{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Xe(B4,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Hc(n)?Xe(B4,"Ignoring IndexedDB error during garbage collection: ",n):await pd(n)}await this.mr(3e5)})}}class Gve{constructor(e,n){this.gr=e,this.params=n}calculateTargetCount(e,n){return this.gr.pr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return ye.resolve(ho.le);const r=new zve(n);return this.gr.forEachTarget(e,s=>r.Rr(s.sequenceNumber)).next(()=>this.gr.yr(e,s=>r.Rr(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.gr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.gr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Xe("LruGarbageCollector","Garbage collection skipped; disabled"),ye.resolve($4)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Xe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$4):this.wr(e,n))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,n){let r,s,i,o,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Xe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,l=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),Kd()<=cn.DEBUG&&Xe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),ye.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function I8(t,e){return new Gve(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wve{constructor(e,n){this.db=e,this.garbageCollector=I8(this,n)}pr(e){const n=this.Sr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Sr(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}yr(e,n){return this.br(e,(r,s)=>n(s))}addReference(e,n,r){return fx(e,r)}removeReference(e,n,r){return fx(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return fx(e,n)}Dr(e,n){return function(s,i){let o=!1;return E8(s).ne(l=>C8(s,l,i).next(c=>(c&&(o=!0),ye.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.br(e,(o,l)=>{if(l<=n){const c=this.Dr(e,o).next(u=>{if(!u)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Rt.min()),Wl(e).delete(function(h){return[0,Ms(h.path)]}(o))))});s.push(c)}}).next(()=>ye.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return fx(e,n)}br(e,n){const r=Wl(e);let s,i=ho.le;return r.te({index:SP},([o,l],{path:c,sequenceNumber:u})=>{o===0?(i!==ho.le&&n(new dt(da(s)),i),i=u,s=c):i=ho.le}).next(()=>{i!==ho.le&&n(new dt(da(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function fx(t,e){return Wl(t).put(function(r,s){return{targetId:0,path:Ms(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N8{constructor(){this.changes=new wl(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Tr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ye.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hve{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return iu(e).put(r)}removeEntry(e,n,r){return iu(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Vw(o),l[l.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.vr(e,r)))}getEntry(e,n){let r=Tr.newInvalidDocument(n);return iu(e).te({index:lv,range:IDBKeyRange.only(cm(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}Fr(e,n){let r={size:0,document:Tr.newInvalidDocument(n)};return iu(e).te({index:lv,range:IDBKeyRange.only(cm(n))},(s,i)=>{r={document:this.Cr(n,i),size:Uw(i)}}).next(()=>r)}getEntries(e,n){let r=Bi();return this.Mr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Or(e,n){let r=Bi(),s=new fr(dt.comparator);return this.Mr(e,n,(i,o)=>{const l=this.Cr(i,o);r=r.insert(i,l),s=s.insert(i,Uw(o))}).next(()=>({documents:r,Nr:s}))}Mr(e,n,r){if(n.isEmpty())return ye.resolve();let s=new Fn(H4);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(cm(s.first()),cm(s.last())),o=s.getIterator();let l=o.getNext();return iu(e).te({index:lv,range:i},(c,u,d)=>{const h=dt.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&H4(l,h)<0;)r(l,null),l=o.getNext();l&&l.isEqual(h)&&(r(l,u),l=o.hasNext()?o.getNext():null),l?d.H(cm(l)):d.done()}).next(()=>{for(;l;)r(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,l=[o.popLast().toArray(),o.lastSegment(),Vw(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return iu(e).J(IDBKeyRange.bound(l,c,!0)).next(u=>{i==null||i.incrementDocumentReadCount(u.length);let d=Bi();for(const h of u){const f=this.Cr(dt.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(ty(n,f)||s.has(f.key))&&(d=d.insert(f.key,f))}return d})}getAllFromCollectionGroup(e,n,r,s){let i=Bi();const o=W4(n,r),l=W4(n,Ji.max());return iu(e).te({index:y9,range:IDBKeyRange.bound(o,l,!0)},(c,u,d)=>{const h=this.Cr(dt.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(h.key,h),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new qve(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return G4(e).get(bT).next(n=>(Tt(!!n,20021),n))}vr(e,n){return G4(e).put(bT,n)}Cr(e,n){if(n){const r=kve(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Rt.min())))return r}return Tr.newInvalidDocument(e)}}function P8(t){return new Hve(t)}class qve extends N8{constructor(e,n){super(),this.Br=e,this.trackRemovals=n,this.Lr=new wl(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Fn((i,o)=>Gt(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.Lr.get(i);if(n.push(this.Br.removeEntry(e,i,l.readTime)),o.isValidDocument()){const c=I4(this.Br.serializer,o);s=s.add(i.path.popLast());const u=Uw(c);r+=u-l.size,n.push(this.Br.addEntry(e,i,c))}else if(r-=l.size,this.trackRemovals){const c=I4(this.Br.serializer,o.convertToNoDocument(Rt.min()));n.push(this.Br.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.Br.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Br.updateMetadata(e,r)),ye.waitFor(n)}getFromCache(e,n){return this.Br.Fr(e,n).next(r=>(this.Lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Br.Or(e,n).next(({documents:r,Nr:s})=>(s.forEach((i,o)=>{this.Lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function G4(t){return es(t,eg)}function iu(t){return es(t,Aw)}function cm(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function W4(t,e){const n=e.documentKey.path.toArray();return[t,Vw(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function H4(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=Gt(n[i],r[i]),s)return s;return s=Gt(n.length,r.length),s||(s=Gt(n[n.length-2],r[r.length-2]),s||Gt(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kve{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A8{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&fp(r.mutation,s,fi.empty(),br.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,rn()).next(()=>r))}getLocalViewOfDocuments(e,n,r=rn()){const s=ha();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Rm();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ha();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,rn()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Bi();const o=hp(),l=function(){return hp()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof bl)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),fp(d.mutation,u,d.mutation.getFieldMask(),br.now())):o.set(u.key,fi.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var h;return l.set(u,new Kve(d,(h=o.get(u))!==null&&h!==void 0?h:null))}),l))}recalculateAndSaveOverlays(e,n){const r=hp();let s=new fr((o,l)=>o-l),i=rn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||fi.empty();d=l.applyToLocalView(u,d),r.set(c,d);const h=(s.get(l.batchId)||rn()).add(c);s=s.insert(l.batchId,h)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,h=K9();d.forEach(f=>{if(!i.has(f)){const m=e8(n.get(f),r.get(f));m!==null&&h.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return ye.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return dt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):z9(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):ye.resolve(ha());let l=Jp,c=i;return o.next(u=>ye.forEach(u,(d,h)=>(l<h.largestBatchId&&(l=h.largestBatchId),i.get(d)?ye.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{c=c.insert(d,f)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,rn())).next(d=>({batchId:l,changes:q9(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new dt(n)).next(r=>{let s=Rm();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Rm();return this.indexManager.getCollectionParents(e,i).next(l=>ye.forEach(l,c=>{const u=function(h,f){return new Zg(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Tr.newInvalidDocument(d)))});let l=Rm();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&fp(d.mutation,u,fi.empty(),br.now()),ty(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yve{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,n){return ye.resolve(this.kr.get(n))}saveBundleMetadata(e,n){return this.kr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Qs(s.createTime)}}(n)),ye.resolve()}getNamedQuery(e,n){return ye.resolve(this.qr.get(n))}saveNamedQuery(e,n){return this.qr.set(n.name,function(s){return{name:s.name,query:v8(s.bundledQuery),readTime:Qs(s.readTime)}}(n)),ye.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jve{constructor(){this.overlays=new fr(dt.comparator),this.Qr=new Map}getOverlay(e,n){return ye.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ha();return ye.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.bt(e,n,i)}),ye.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Qr.delete(r)),ye.resolve()}getOverlaysForCollection(e,n,r){const s=ha(),i=n.length+1,o=new dt(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return ye.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new fr((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=ha(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=ha(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return ye.resolve(l)}bt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Qr.get(s.largestBatchId).delete(r.key);this.Qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new DP(n,r));let i=this.Qr.get(n);i===void 0&&(i=rn(),this.Qr.set(n,i)),this.Qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xve{constructor(){this.sessionToken=Gr.EMPTY_BYTE_STRING}getSessionToken(e){return ye.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ye.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(){this.$r=new Fn(is.Ur),this.Kr=new Fn(is.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,n){const r=new is(e,n);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.zr(new is(e,n))}jr(e,n){e.forEach(r=>this.removeReference(r,n))}Hr(e){const n=new dt(new An([])),r=new is(n,e),s=new is(n,e+1),i=[];return this.Kr.forEachInRange([r,s],o=>{this.zr(o),i.push(o.key)}),i}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const n=new dt(new An([])),r=new is(n,e),s=new is(n,e+1);let i=rn();return this.Kr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new is(e,0),r=this.$r.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class is{constructor(e,n){this.key=e,this.Zr=n}static Ur(e,n){return dt.comparator(e.key,n.key)||Gt(e.Zr,n.Zr)}static Wr(e,n){return Gt(e.Zr,n.Zr)||dt.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qve{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.nr=1,this.Xr=new Fn(is.Ur)}checkEmpty(e){return ye.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new RP(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Xr=this.Xr.add(new is(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ye.resolve(o)}lookupMutationBatch(e,n){return ye.resolve(this.ei(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ti(r),i=s<0?0:s;return ye.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(this.mutationQueue.length===0?Fu:this.nr-1)}getAllMutationBatches(e){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new is(n,0),s=new is(n,Number.POSITIVE_INFINITY),i=[];return this.Xr.forEachInRange([r,s],o=>{const l=this.ei(o.Zr);i.push(l)}),ye.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Fn(Gt);return n.forEach(s=>{const i=new is(s,0),o=new is(s,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([i,o],l=>{r=r.add(l.Zr)})}),ye.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;dt.isDocumentKey(i)||(i=i.child(""));const o=new is(new dt(i),0);let l=new Fn(Gt);return this.Xr.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.Zr)),!0)},o),ye.resolve(this.ni(l))}ni(e){const n=[];return e.forEach(r=>{const s=this.ei(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Tt(this.ri(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return ye.forEach(n.mutations,s=>{const i=new is(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,n){const r=new is(n,0),s=this.Xr.firstAfterOrEqual(r);return ye.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ye.resolve()}ri(e,n){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const n=this.ti(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zve{constructor(e){this.ii=e,this.docs=function(){return new fr(dt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ii(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ye.resolve(r?r.document.mutableCopy():Tr.newInvalidDocument(n))}getEntries(e,n){let r=Bi();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Tr.newInvalidDocument(s))}),ye.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Bi();const o=n.path,l=new dt(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||bP(h9(d),r)<=0||(s.has(d.key)||ty(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return ye.resolve(i)}getAllFromCollectionGroup(e,n,r,s){St(9500)}si(e,n){return ye.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new ewe(this)}getSize(e){return ye.resolve(this.size)}}class ewe extends N8{constructor(e){super(),this.Br=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Br.addEntry(e,s)):this.Br.removeEntry(r)}),ye.waitFor(n)}getFromCache(e,n){return this.Br.getEntry(e,n)}getAllFromCache(e,n){return this.Br.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class twe{constructor(e){this.persistence=e,this.oi=new wl(n=>nd(n),Qg),this.lastRemoteSnapshotVersion=Rt.min(),this.highestTargetId=0,this._i=0,this.ai=new VP,this.targetCount=0,this.ui=id.cr()}forEachTarget(e,n){return this.oi.forEach((r,s)=>n(s)),ye.resolve()}getLastRemoteSnapshotVersion(e){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ye.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this._i&&(this._i=n),ye.resolve()}Tr(e){this.oi.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ui=new id(n),this.highestTargetId=n),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,n){return this.Tr(n),this.targetCount+=1,ye.resolve()}updateTargetData(e,n){return this.Tr(n),ye.resolve()}removeTargetData(e,n){return this.oi.delete(n.target),this.ai.Hr(n.targetId),this.targetCount-=1,ye.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.oi.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.oi.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),ye.waitFor(i).next(()=>s)}getTargetCount(e){return ye.resolve(this.targetCount)}getTargetData(e,n){const r=this.oi.get(n)||null;return ye.resolve(r)}addMatchingKeys(e,n,r){return this.ai.Gr(n,r),ye.resolve()}removeMatchingKeys(e,n,r){this.ai.jr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),ye.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.ai.Hr(n),ye.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ai.Yr(n);return ye.resolve(r)}containsKey(e,n){return ye.resolve(this.ai.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(e,n){this.ci={},this.overlays={},this.li=new ho(0),this.hi=!1,this.hi=!0,this.Pi=new Xve,this.referenceDelegate=e(this),this.Ti=new twe(this),this.indexManager=new Vve,this.remoteDocumentCache=function(s){return new Zve(s)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new y8(n),this.Ei=new Yve(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Jve,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ci[e.toKey()];return r||(r=new Qve(n,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,n,r){Xe("MemoryPersistence","Starting transaction:",e);const s=new nwe(this.li.next());return this.referenceDelegate.di(),r(s).next(i=>this.referenceDelegate.Ai(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ri(e,n){return ye.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,n)))}}class nwe extends m9{constructor(e){super(),this.currentSequenceNumber=e}}class Ob{constructor(e){this.persistence=e,this.Vi=new VP,this.mi=null}static fi(e){return new Ob(e)}get gi(){if(this.mi)return this.mi;throw St(60996)}addReference(e,n,r){return this.Vi.addReference(r,n),this.gi.delete(r.toString()),ye.resolve()}removeReference(e,n,r){return this.Vi.removeReference(r,n),this.gi.add(r.toString()),ye.resolve()}markPotentiallyOrphaned(e,n){return this.gi.add(n.toString()),ye.resolve()}removeTarget(e,n){this.Vi.Hr(n.targetId).forEach(s=>this.gi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.gi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}di(){this.mi=new Set}Ai(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.gi,r=>{const s=dt.fromPath(r);return this.pi(e,s).next(i=>{i||n.removeEntry(s,Rt.min())})}).next(()=>(this.mi=null,n.apply(e)))}updateLimboDocument(e,n){return this.pi(e,n).next(r=>{r?this.gi.delete(n.toString()):this.gi.add(n.toString())})}Ii(e){return 0}pi(e,n){return ye.or([()=>ye.resolve(this.Vi.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ri(e,n)])}}class Bw{constructor(e,n){this.persistence=e,this.yi=new wl(r=>Ms(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=I8(this,n)}static fi(e,n){return new Bw(e,n)}di(){}Ai(e){return ye.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}pr(e){const n=this.Sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Sr(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}yr(e,n){return ye.forEach(this.yi,(r,s)=>this.Dr(e,r,s).next(i=>i?ye.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.si(e,o=>this.Dr(e,o,n).next(l=>{l||(r++,i.removeEntry(o,Rt.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.yi.set(n,e.currentSequenceNumber),ye.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),ye.resolve()}removeReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),ye.resolve()}updateLimboDocument(e,n){return this.yi.set(n,e.currentSequenceNumber),ye.resolve()}Ii(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=uv(e.data.value)),n}Dr(e,n,r){return ye.or([()=>this.persistence.Ri(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.yi.get(n);return ye.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rwe{constructor(e){this.serializer=e}q(e,n,r,s){const i=new Cb("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore(Xg)}(e),function(c){c.createObjectStore(Zp,{keyPath:mxe}),c.createObjectStore(Ro,{keyPath:r4,autoIncrement:!0}).createIndex(Ru,s4,{unique:!0}),c.createObjectStore(tf)}(e),q4(e),function(c){c.createObjectStore(fu)}(e));let o=ye.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore(rf),c.deleteObjectStore(nf),c.deleteObjectStore(Ou)}(e),q4(e)),o=o.next(()=>function(c){const u=c.store(Ou),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Rt.min().toTimestamp(),targetCount:0};return u.put(kw,d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store(Ro).J().next(h=>{c.deleteObjectStore(Ro),c.createObjectStore(Ro,{keyPath:r4,autoIncrement:!0}).createIndex(Ru,s4,{unique:!0});const f=u.store(Ro),m=h.map(g=>f.put(g));return ye.waitFor(m)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore(sf,{keyPath:Sxe})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.wi(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore(eg)}(e),this.Si(i)))),r<7&&s>=7&&(o=o.next(()=>this.bi(i))),r<8&&s>=8&&(o=o.next(()=>this.Di(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Ci(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(Tb,{keyPath:Cxe})})(e),function(c){c.createObjectStore(Ib,{keyPath:Exe})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore(Nb,{keyPath:Rxe});u.createIndex(ST,jxe,{unique:!1}),u.createIndex(b9,Dxe,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore(Aw,{keyPath:gxe});u.createIndex(lv,yxe),u.createIndex(y9,xxe)}(e)).next(()=>this.Fi(e,i)).next(()=>e.deleteObjectStore(fu))),r<14&&s>=14&&(o=o.next(()=>this.Mi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore(CP,{keyPath:Txe,autoIncrement:!0}).createIndex(_T,Ixe,{unique:!1}),c.createObjectStore(lp,{keyPath:Nxe}).createIndex(v9,Pxe,{unique:!1}),c.createObjectStore(cp,{keyPath:Axe}).createIndex(w9,kxe,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(lp).clear()}).next(()=>{n.objectStore(cp).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(EP,{keyPath:Mxe})})(e)})),r<18&&s>=18&&pz()&&(o=o.next(()=>{n.objectStore(lp).clear()}).next(()=>{n.objectStore(cp).clear()})),o}Si(e){let n=0;return e.store(fu).te((r,s)=>{n+=Uw(s)}).next(()=>{const r={byteSize:n};return e.store(eg).put(bT,r)})}wi(e){const n=e.store(Zp),r=e.store(Ro);return n.J().next(s=>ye.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,Fu],[i.userId,i.lastAcknowledgedBatchId]);return r.J(Ru,o).next(l=>ye.forEach(l,c=>{Tt(c.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const u=xu(this.serializer,c);return S8(e,i.userId,u).next(()=>{})}))}))}bi(e){const n=e.store(rf),r=e.store(fu);return e.store(Ou).get(kw).next(s=>{const i=[];return r.te((o,l)=>{const c=new An(o),u=function(h){return[0,Ms(h)]}(c);i.push(n.get(u).next(d=>d?ye.resolve():(h=>n.put({targetId:0,path:Ms(h),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>ye.waitFor(i))})}Di(e,n){e.createObjectStore(tg,{keyPath:_xe});const r=n.store(tg),s=new OP,i=o=>{if(s.add(o)){const l=o.lastSegment(),c=o.popLast();return r.put({collectionId:l,parent:Ms(c)})}};return n.store(fu).te({ee:!0},(o,l)=>{const c=new An(o);return i(c.popLast())}).next(()=>n.store(tf).te({ee:!0},([o,l,c],u)=>{const d=da(l);return i(d.popLast())}))}Ci(e){const n=e.store(nf);return n.te((r,s)=>{const i=Dm(s),o=x8(this.serializer,i);return n.put(o)})}Fi(e,n){const r=n.store(fu),s=[];return r.te((i,o)=>{const l=n.store(Aw),c=function(h){return h.document?new dt(An.fromString(h.document.name).popFirst(5)):h.noDocument?dt.fromSegments(h.noDocument.path):h.unknownDocument?dt.fromSegments(h.unknownDocument.path):St(36783)}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(l.put(u))}).next(()=>ye.waitFor(s))}Mi(e,n){const r=n.store(Ro),s=P8(this.serializer),i=new $P(Ob.fi,this.serializer.wt);return r.J().next(o=>{const l=new Map;return o.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:rn();xu(this.serializer,c).keys().forEach(h=>d=d.add(h)),l.set(c.userId,d)}),ye.forEach(l,(c,u)=>{const d=new ms(u),h=Lb.St(this.serializer,d),f=i.getIndexManager(d),m=Fb.St(d,this.serializer,f,i.referenceDelegate);return new A8(s,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new CT(n,ho.le),c).next()})})}}function q4(t){t.createObjectStore(rf,{keyPath:wxe}).createIndex(SP,bxe,{unique:!0}),t.createObjectStore(nf,{keyPath:"targetId"}).createIndex(x9,vxe,{unique:!0}),t.createObjectStore(Ou)}const Al="IndexedDbPersistence",VS=18e5,$S=5e3,US="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",swe="main";class UP{constructor(e,n,r,s,i,o,l,c,u,d,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.xi=i,this.window=o,this.document=l,this.Oi=u,this.Ni=d,this.Bi=h,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=f=>Promise.resolve(),!UP.C())throw new at(Fe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Wve(this,s),this.Ui=n+swe,this.serializer=new y8(c),this.Ki=new fc(this.Ui,this.Bi,new rwe(this.serializer)),this.Pi=new jve,this.Ti=new Uve(this.referenceDelegate,this.serializer),this.remoteDocumentCache=P8(this.serializer),this.Ei=new Rve,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,d===!1&&Ys(Al,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new at(Fe.FAILED_PRECONDITION,US);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new ho(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>mx(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(n=>{n||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(n=>this.isPrimary&&!n?this.Xi(e).next(()=>!1):!!n&&this.es(e).next(()=>!0))).catch(e=>{if(Hc(e))return Xe(Al,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Xe(Al,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return um(e).get(Ld).next(n=>ye.resolve(this.ts(n)))}ns(e){return mx(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,VS)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=es(n,sf);return r.J().next(s=>{const i=this._s(s,VS),o=s.filter(l=>i.indexOf(l)===-1);return ye.forEach(o,l=>r.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Wi)for(const n of e)this.Wi.removeItem(this.us(n.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?ye.resolve(!0):um(e).get(Ld).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,$S)&&!this.cs(n.ownerId)){if(this.ts(n)&&this.networkEnabled)return!0;if(!this.ts(n)){if(!n.allowTabSynchronization)throw new at(Fe.FAILED_PRECONDITION,US);return!1}}return!(!this.networkEnabled||!this.inForeground)||mx(e).J().next(r=>this._s(r,$S).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&Xe(Al,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[Xg,sf],e=>{const n=new CT(e,ho.le);return this.Xi(n).next(()=>this.ns(n))}),this.Ki.close(),this.Ts()}_s(e,n){return e.filter(r=>this.ss(r.updateTimeMs,n)&&!this.cs(r.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>mx(e).J().next(n=>this._s(n,VS).map(r=>r.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,n){return Fb.St(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new $ve(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return Lb.St(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,n,r){Xe(Al,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===18?Oxe:c===17?E9:c===16?Fxe:c===15?TP:c===14?C9:c===13?S9:c===12?Lxe:c===11?_9:void St(60245)}(this.Bi);let o;return this.Ki.runTransaction(e,s,i,l=>(o=new CT(l,this.li?this.li.next():ho.le),n==="readwrite-primary"?this.Yi(o).next(c=>!!c||this.Zi(o)).next(c=>{if(!c)throw Ys(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new at(Fe.FAILED_PRECONDITION,f9);return r(o)}).next(c=>this.es(o).next(()=>c)):this.Es(o).next(()=>r(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Es(e){return um(e).get(Ld).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,$S)&&!this.cs(n.ownerId)&&!this.ts(n)&&!(this.Ni||this.allowTabSynchronization&&n.allowTabSynchronization))throw new at(Fe.FAILED_PRECONDITION,US)})}es(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return um(e).put(Ld,n)}static C(){return fc.C()}Xi(e){const n=um(e);return n.get(Ld).next(r=>this.ts(r)?(Xe(Al,"Releasing primary lease."),n.delete(Ld)):ye.resolve())}ss(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Ys(`Detected an update time that is in the future: ${e} > ${r}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const n=/(?:Version|Mobile)\/1[456]/;mz()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var n;try{const r=((n=this.Wi)===null||n===void 0?void 0:n.getItem(this.us(e)))!==null;return Xe(Al,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ys(Al,"Failed to get zombied client id.",r),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){Ys("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function um(t){return es(t,Xg)}function mx(t){return es(t,sf)}function iwe(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.ds=r,this.As=s}static Rs(e,n){let r=rn(),s=rn();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new BP(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class owe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k8{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return mz()?8:p9(Qr())>0?6:4}()}initialize(e,n){this.ys=e,this.indexManager=n,this.Vs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ws(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Ss(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new owe;return this.bs(e,n,o).next(l=>{if(i.result=l,this.fs)return this.Ds(e,n,o,l.size)})}).next(()=>i.result)}Ds(e,n,r,s){return r.documentReadCount<this.gs?(Kd()<=cn.DEBUG&&Xe("QueryEngine","SDK will not create cache indexes for query:",Yd(n),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),ye.resolve()):(Kd()<=cn.DEBUG&&Xe("QueryEngine","Query:",Yd(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ps*s?(Kd()<=cn.DEBUG&&Xe("QueryEngine","The SDK decides to create cache indexes for query:",Yd(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,po(n))):ye.resolve())}ws(e,n){if(y4(n))return ye.resolve(null);let r=po(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Lw(n,null,"F"),r=po(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=rn(...i);return this.ys.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.vs(n,l);return this.Cs(n,u,o,c.readTime)?this.ws(e,Lw(n,null,"F")):this.Fs(e,u,n,c)}))})))}Ss(e,n,r,s){return y4(n)||s.isEqual(Rt.min())?ye.resolve(null):this.ys.getDocuments(e,r).next(i=>{const o=this.vs(n,i);return this.Cs(n,o,r,s)?ye.resolve(null):(Kd()<=cn.DEBUG&&Xe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Yd(n)),this.Fs(e,o,n,axe(s,Jp)).next(l=>l))})}vs(e,n){let r=new Fn(W9(e));return n.forEach((s,i)=>{ty(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}bs(e,n,r){return Kd()<=cn.DEBUG&&Xe("QueryEngine","Using full collection scan to execute query:",Yd(n)),this.ys.getDocumentsMatchingQuery(e,n,Ji.min(),r)}Fs(e,n,r,s){return this.ys.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zP="LocalStore",awe=3e8;class lwe{constructor(e,n,r,s){this.persistence=e,this.Ms=n,this.serializer=s,this.xs=new fr(Gt),this.Os=new wl(i=>nd(i),Qg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new A8(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.xs))}}function R8(t,e,n,r){return new lwe(t,e,n,r)}async function j8(t,e){const n=Jt(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=rn();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({ks:u,removedBatchIds:o,addedBatchIds:l}))})})}function cwe(t,e){const n=Jt(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Bs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const h=u.batch,f=h.keys();let m=ye.resolve();return f.forEach(g=>{m=m.next(()=>d.getEntry(c,g)).next(x=>{const w=u.docVersions.get(g);Tt(w!==null,48541),x.version.compareTo(w)<0&&(h.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),d.addEntry(x)))})}),m.next(()=>l.mutationQueue.removeMutationBatch(c,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=rn();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function D8(t){const e=Jt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ti.getLastRemoteSnapshotVersion(n))}function uwe(t,e){const n=Jt(t),r=e.snapshotVersion;let s=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Bs.newChangeBuffer({trackRemovals:!0});s=n.xs;const l=[];e.targetChanges.forEach((d,h)=>{const f=s.get(h);if(!f)return;l.push(n.Ti.removeMatchingKeys(i,d.removedDocuments,h).next(()=>n.Ti.addMatchingKeys(i,d.addedDocuments,h)));let m=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(Gr.EMPTY_BYTE_STRING,Rt.min()).withLastLimboFreeSnapshotVersion(Rt.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),s=s.insert(h,m),function(x,w,v){return x.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=awe?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(f,m,d)&&l.push(n.Ti.updateTargetData(i,m))});let c=Bi(),u=rn();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(dwe(i,o,e.documentUpdates).next(d=>{c=d.qs,u=d.Qs})),!r.isEqual(Rt.min())){const d=n.Ti.getLastRemoteSnapshotVersion(i).next(h=>n.Ti.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return ye.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.xs=s,i))}function dwe(t,e,n){let r=rn(),s=rn();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Bi();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(Rt.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Xe(zP,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{qs:o,Qs:s}})}function hwe(t,e){const n=Jt(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Fu),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function fwe(t,e){const n=Jt(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ti.getTargetData(r,e).next(i=>i?(s=i,ye.resolve(s)):n.Ti.allocateTargetId(r).next(o=>(s=new Ha(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ti.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.xs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.xs=n.xs.insert(r.targetId,r),n.Os.set(e,r.targetId)),r})}async function OT(t,e,n){const r=Jt(t),s=r.xs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Hc(o))throw o;Xe(zP,`Failed to update sequence numbers for target ${e}: ${o}`)}r.xs=r.xs.remove(e),r.Os.delete(s.target)}function K4(t,e,n){const r=Jt(t);let s=Rt.min(),i=rn();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const h=Jt(c),f=h.Os.get(d);return f!==void 0?ye.resolve(h.xs.get(f)):h.Ti.getTargetData(u,d)}(r,o,po(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.Ms.getDocumentsMatchingQuery(o,e,n?s:Rt.min(),n?i:rn())).next(l=>(mwe(r,Zxe(e),l),{documents:l,$s:i})))}function mwe(t,e,n){let r=t.Ns.get(e)||Rt.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ns.set(e,r)}class Y4{constructor(){this.activeTargetIds=ive()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class M8{constructor(){this.xo=new Y4,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,n,r){this.Oo[e]=n}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new Y4,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pwe{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J4="ConnectivityMonitor";class X4{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Xe(J4,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Xe(J4,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let px=null;function VT(){return px===null?px=function(){return 268435456+Math.round(2147483648*Math.random())}():px++,"0x"+px.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS="RestConnection",gwe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ywe{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ko=n+"://"+e.host,this.Wo=`projects/${r}/databases/${s}`,this.Go=this.databaseId.database===Rw?`project_id=${r}`:`project_id=${r}&database_id=${s}`}zo(e,n,r,s,i){const o=VT(),l=this.jo(e,n.toUriEncodedString());Xe(BS,`Sending RPC '${e}' ${o}:`,l,r);const c={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(c,s,i);const{host:u}=new URL(l),d=Bc(u);return this.Jo(e,l,c,r,d).then(h=>(Xe(BS,`Received RPC '${e}' ${o}: `,h),h),h=>{throw ed(BS,`RPC '${e}' ${o} failed with error: `,h,"url: ",l,"request:",r),h})}Yo(e,n,r,s,i,o){return this.zo(e,n,r,s,i)}Ho(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+kf}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}jo(e,n){const r=gwe[e];return`${this.Ko}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xwe{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is="WebChannelConnection";class vwe extends ywe{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=VT();return new Promise((l,c)=>{const u=new n9;u.setWithCredentials(!0),u.listenOnce(r9.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case iv.NO_ERROR:const h=u.getResponseJson();Xe(Is,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),l(h);break;case iv.TIMEOUT:Xe(Is,`RPC '${e}' ${o} timed out`),c(new at(Fe.DEADLINE_EXCEEDED,"Request time out"));break;case iv.HTTP_ERROR:const f=u.getStatus();if(Xe(Is,`RPC '${e}' ${o} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const x=function(v){const _=v.toLowerCase().replace(/_/g,"-");return Object.values(Fe).indexOf(_)>=0?_:Fe.UNKNOWN}(g.status);c(new at(x,g.message))}else c(new at(Fe.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new at(Fe.UNAVAILABLE,"Connection failed."));break;default:St(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Xe(Is,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);Xe(Is,`RPC '${e}' ${o} sending request:`,s),u.send(n,"POST",d,r,15)})}T_(e,n,r){const s=VT(),i=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=o9(),l=i9(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Ho(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");Xe(Is,`Creating RPC '${e}' stream ${s}: ${d}`,c);const h=o.createWebChannel(d,c);let f=!1,m=!1;const g=new xwe({Zo:w=>{m?Xe(Is,`Not sending because RPC '${e}' stream ${s} is closed:`,w):(f||(Xe(Is,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),Xe(Is,`RPC '${e}' stream ${s} sending:`,w),h.send(w))},Xo:()=>h.close()}),x=(w,v,_)=>{w.listen(v,C=>{try{_(C)}catch(T){setTimeout(()=>{throw T},0)}})};return x(h,km.EventType.OPEN,()=>{m||(Xe(Is,`RPC '${e}' stream ${s} transport opened.`),g.__())}),x(h,km.EventType.CLOSE,()=>{m||(m=!0,Xe(Is,`RPC '${e}' stream ${s} transport closed`),g.u_())}),x(h,km.EventType.ERROR,w=>{m||(m=!0,ed(Is,`RPC '${e}' stream ${s} transport errored. Name:`,w.name,"Message:",w.message),g.u_(new at(Fe.UNAVAILABLE,"The operation could not be completed")))}),x(h,km.EventType.MESSAGE,w=>{var v;if(!m){const _=w.data[0];Tt(!!_,16349);const C=_,T=(C==null?void 0:C.error)||((v=C[0])===null||v===void 0?void 0:v.error);if(T){Xe(Is,`RPC '${e}' stream ${s} received error:`,T);const R=T.status;let A=function(P){const k=Lr[P];if(k!==void 0)return r8(k)}(R),E=T.message;A===void 0&&(A=Fe.INTERNAL,E="Unknown error status: "+R+" with message "+T.message),m=!0,g.u_(new at(A,E)),h.close()}else Xe(Is,`RPC '${e}' stream ${s} received:`,_),g.c_(_)}}),x(l,s9.STAT_EVENT,w=>{w.stat===xT.PROXY?Xe(Is,`RPC '${e}' stream ${s} detected buffering proxy`):w.stat===xT.NOPROXY&&Xe(Is,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.a_()},0),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wwe(){return typeof window<"u"?window:null}function pv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vb(t){return new bve(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L8{constructor(e,n,r=1e3,s=1.5,i=6e4){this.xi=e,this.timerId=n,this.I_=r,this.E_=s,this.d_=i,this.A_=0,this.R_=null,this.V_=Date.now(),this.reset()}reset(){this.A_=0}m_(){this.A_=this.d_}f_(e){this.cancel();const n=Math.floor(this.A_+this.g_()),r=Math.max(0,Date.now()-this.V_),s=Math.max(0,n-r);s>0&&Xe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.A_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.R_=this.xi.enqueueAfterDelay(this.timerId,s,()=>(this.V_=Date.now(),e())),this.A_*=this.E_,this.A_<this.I_&&(this.A_=this.I_),this.A_>this.d_&&(this.A_=this.d_)}p_(){this.R_!==null&&(this.R_.skipDelay(),this.R_=null)}cancel(){this.R_!==null&&(this.R_.cancel(),this.R_=null)}g_(){return(Math.random()-.5)*this.A_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q4="PersistentStream";class F8{constructor(e,n,r,s,i,o,l,c){this.xi=e,this.y_=r,this.w_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.S_=0,this.b_=null,this.D_=null,this.stream=null,this.v_=0,this.C_=new L8(e,n)}F_(){return this.state===1||this.state===5||this.M_()}M_(){return this.state===2||this.state===3}start(){this.v_=0,this.state!==4?this.auth():this.x_()}async stop(){this.F_()&&await this.close(0)}O_(){this.state=0,this.C_.reset()}N_(){this.M_()&&this.b_===null&&(this.b_=this.xi.enqueueAfterDelay(this.y_,6e4,()=>this.B_()))}L_(e){this.k_(),this.stream.send(e)}async B_(){if(this.M_())return this.close(0)}k_(){this.b_&&(this.b_.cancel(),this.b_=null)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}async close(e,n){this.k_(),this.q_(),this.C_.cancel(),this.S_++,e!==4?this.C_.reset():n&&n.code===Fe.RESOURCE_EXHAUSTED?(Ys(n.toString()),Ys("Using maximum backoff delay to prevent overloading the backend."),this.C_.m_()):n&&n.code===Fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Q_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(n)}Q_(){}auth(){this.state=1;const e=this.U_(this.S_),n=this.S_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.S_===n&&this.K_(r,s)},r=>{e(()=>{const s=new at(Fe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.W_(s)})})}K_(e,n){const r=this.U_(this.S_);this.stream=this.G_(e,n),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.D_=this.xi.enqueueAfterDelay(this.w_,1e4,()=>(this.M_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(s=>{r(()=>this.W_(s))}),this.stream.onMessage(s=>{r(()=>++this.v_==1?this.z_(s):this.onNext(s))})}x_(){this.state=5,this.C_.f_(async()=>{this.state=0,this.start()})}W_(e){return Xe(Q4,`close with error: ${e}`),this.stream=null,this.close(4,e)}U_(e){return n=>{this.xi.enqueueAndForget(()=>this.S_===e?n():(Xe(Q4,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class bwe extends F8{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}G_(e,n){return this.connection.T_("Listen",e,n)}z_(e){return this.onNext(e)}onNext(e){this.C_.reset();const n=Cve(this.serializer,e),r=function(i){if(!("targetChange"in i))return Rt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Rt.min():o.readTime?Qs(o.readTime):Rt.min()}(e);return this.listener.j_(n,r)}H_(e){const n={};n.database=jT(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=Dw(c)?{documents:d8(i,c)}:{query:h8(i,c).gt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=o8(i,o.resumeToken);const u=kT(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(Rt.min())>0){l.readTime=hf(i,o.snapshotVersion.toTimestamp());const u=kT(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=Tve(this.serializer,e);r&&(n.labels=r),this.L_(n)}J_(e){const n={};n.database=jT(this.serializer),n.removeTarget=e,this.L_(n)}}class _we extends F8{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Y_(){return this.v_>0}start(){this.lastStreamToken=void 0,super.start()}Q_(){this.Y_&&this.Z_([])}G_(e,n){return this.connection.T_("Write",e,n)}z_(e){return Tt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Tt(!e.writeResults||e.writeResults.length===0,55816),this.listener.X_()}onNext(e){Tt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.C_.reset();const n=Eve(e.writeResults,e.commitTime),r=Qs(e.commitTime);return this.listener.ea(r,n)}ta(){const e={};e.database=jT(this.serializer),this.L_(e)}Z_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Ow(this.serializer,r))};this.L_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Swe{}class Cwe extends Swe{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.na=!1}ra(){if(this.na)throw new at(Fe.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,n,r,s){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.zo(e,RT(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new at(Fe.UNKNOWN,i.toString())})}Yo(e,n,r,s,i){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Yo(e,RT(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new at(Fe.UNKNOWN,o.toString())})}terminate(){this.na=!0,this.connection.terminate()}}class Ewe{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.ia=0,this.sa=null,this.oa=!0}_a(){this.ia===0&&(this.aa("Unknown"),this.sa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.sa=null,this.ua("Backend didn't respond within 10 seconds."),this.aa("Offline"),Promise.resolve())))}ca(e){this.state==="Online"?this.aa("Unknown"):(this.ia++,this.ia>=1&&(this.la(),this.ua(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.aa("Offline")))}set(e){this.la(),this.ia=0,e==="Online"&&(this.oa=!1),this.aa(e)}aa(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ua(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.oa?(Ys(n),this.oa=!1):Xe("OnlineStateTracker",n)}la(){this.sa!==null&&(this.sa.cancel(),this.sa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const od="RemoteStore";class Twe{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.ha=[],this.Pa=new Map,this.Ta=new Set,this.Ia=[],this.Ea=i,this.Ea.No(o=>{r.enqueueAndForget(async()=>{gd(this)&&(Xe(od,"Restarting streams for network reachability change."),await async function(c){const u=Jt(c);u.Ta.add(4),await ry(u),u.da.set("Unknown"),u.Ta.delete(4),await $b(u)}(this))})}),this.da=new Ewe(r,s)}}async function $b(t){if(gd(t))for(const e of t.Ia)await e(!0)}async function ry(t){for(const e of t.Ia)await e(!1)}function O8(t,e){const n=Jt(t);n.Pa.has(e.targetId)||(n.Pa.set(e.targetId,e),qP(n)?HP(n):jf(n).M_()&&WP(n,e))}function GP(t,e){const n=Jt(t),r=jf(n);n.Pa.delete(e),r.M_()&&V8(n,e),n.Pa.size===0&&(r.M_()?r.N_():gd(n)&&n.da.set("Unknown"))}function WP(t,e){if(t.Aa.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Rt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}jf(t).H_(e)}function V8(t,e){t.Aa.Ke(e),jf(t).J_(e)}function HP(t){t.Aa=new yve({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Pa.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),jf(t).start(),t.da._a()}function qP(t){return gd(t)&&!jf(t).F_()&&t.Pa.size>0}function gd(t){return Jt(t).Ta.size===0}function $8(t){t.Aa=void 0}async function Iwe(t){t.da.set("Online")}async function Nwe(t){t.Pa.forEach((e,n)=>{WP(t,e)})}async function Pwe(t,e){$8(t),qP(t)?(t.da.ca(e),HP(t)):t.da.set("Unknown")}async function Awe(t,e,n){if(t.da.set("Online"),e instanceof i8&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Pa.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Pa.delete(l),s.Aa.removeTarget(l))}(t,e)}catch(r){Xe(od,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await zw(t,r)}else if(e instanceof fv?t.Aa.Xe(e):e instanceof s8?t.Aa.ot(e):t.Aa.nt(e),!n.isEqual(Rt.min()))try{const r=await D8(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Aa.It(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.Pa.get(u);d&&i.Pa.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.Pa.get(c);if(!d)return;i.Pa.set(c,d.withResumeToken(Gr.EMPTY_BYTE_STRING,d.snapshotVersion)),V8(i,c);const h=new Ha(d.target,c,u,d.sequenceNumber);WP(i,h)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Xe(od,"Failed to raise snapshot:",r),await zw(t,r)}}async function zw(t,e,n){if(!Hc(e))throw e;t.Ta.add(1),await ry(t),t.da.set("Offline"),n||(n=()=>D8(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Xe(od,"Retrying IndexedDB access"),await n(),t.Ta.delete(1),await $b(t)})}function U8(t,e){return e().catch(n=>zw(t,n,e))}async function sy(t){const e=Jt(t),n=Ic(e);let r=e.ha.length>0?e.ha[e.ha.length-1].batchId:Fu;for(;kwe(e);)try{const s=await hwe(e.localStore,r);if(s===null){e.ha.length===0&&n.N_();break}r=s.batchId,Rwe(e,s)}catch(s){await zw(e,s)}B8(e)&&z8(e)}function kwe(t){return gd(t)&&t.ha.length<10}function Rwe(t,e){t.ha.push(e);const n=Ic(t);n.M_()&&n.Y_&&n.Z_(e.mutations)}function B8(t){return gd(t)&&!Ic(t).F_()&&t.ha.length>0}function z8(t){Ic(t).start()}async function jwe(t){Ic(t).ta()}async function Dwe(t){const e=Ic(t);for(const n of t.ha)e.Z_(n.mutations)}async function Mwe(t,e,n){const r=t.ha.shift(),s=jP.from(r,e,n);await U8(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await sy(t)}async function Lwe(t,e){e&&Ic(t).Y_&&await async function(r,s){if(function(o){return pve(o)&&o!==Fe.ABORTED}(s.code)){const i=r.ha.shift();Ic(r).O_(),await U8(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await sy(r)}}(t,e),B8(t)&&z8(t)}async function Z4(t,e){const n=Jt(t);n.asyncQueue.verifyOperationInProgress(),Xe(od,"RemoteStore received new credentials");const r=gd(n);n.Ta.add(3),await ry(n),r&&n.da.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ta.delete(3),await $b(n)}async function Fwe(t,e){const n=Jt(t);e?(n.Ta.delete(2),await $b(n)):e||(n.Ta.add(2),await ry(n),n.da.set("Unknown"))}function jf(t){return t.Ra||(t.Ra=function(n,r,s){const i=Jt(n);return i.ra(),new bwe(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:Iwe.bind(null,t),n_:Nwe.bind(null,t),i_:Pwe.bind(null,t),j_:Awe.bind(null,t)}),t.Ia.push(async e=>{e?(t.Ra.O_(),qP(t)?HP(t):t.da.set("Unknown")):(await t.Ra.stop(),$8(t))})),t.Ra}function Ic(t){return t.Va||(t.Va=function(n,r,s){const i=Jt(n);return i.ra(),new _we(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:jwe.bind(null,t),i_:Lwe.bind(null,t),X_:Dwe.bind(null,t),ea:Mwe.bind(null,t)}),t.Ia.push(async e=>{e?(t.Va.O_(),await sy(t)):(await t.Va.stop(),t.ha.length>0&&(Xe(od,`Stopping write stream with ${t.ha.length} pending writes`),t.ha=[]))})),t.Va}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ba,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new KP(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new at(Fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function YP(t,e){if(Ys("AsyncQueue",`${e}: ${t}`),Hc(t))return new at(Fe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{static emptySet(e){return new Mh(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||dt.comparator(n.key,r.key):(n,r)=>dt.comparator(n.key,r.key),this.keyedMap=Rm(),this.sortedSet=new fr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Mh)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Mh;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(){this.ma=new fr(dt.comparator)}track(e){const n=e.doc.key,r=this.ma.get(n);r?e.type!==0&&r.type===3?this.ma=this.ma.insert(n,e):e.type===3&&r.type!==1?this.ma=this.ma.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ma=this.ma.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ma=this.ma.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ma=this.ma.remove(n):e.type===1&&r.type===2?this.ma=this.ma.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ma=this.ma.insert(n,{type:2,doc:e.doc}):St(63341,{Vt:e,fa:r}):this.ma=this.ma.insert(n,e)}ga(){const e=[];return this.ma.inorderTraversal((n,r)=>{e.push(r)}),e}}class ff{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new ff(e,n,Mh.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&kb(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Owe{constructor(){this.pa=void 0,this.ya=[]}wa(){return this.ya.some(e=>e.Sa())}}class Vwe{constructor(){this.queries=tL(),this.onlineState="Unknown",this.ba=new Set}terminate(){(function(n,r){const s=Jt(n),i=s.queries;s.queries=tL(),i.forEach((o,l)=>{for(const c of l.ya)c.onError(r)})})(this,new at(Fe.ABORTED,"Firestore shutting down"))}}function tL(){return new wl(t=>G9(t),kb)}async function JP(t,e){const n=Jt(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.wa()&&e.Sa()&&(r=2):(i=new Owe,r=e.Sa()?0:1);try{switch(r){case 0:i.pa=await n.onListen(s,!0);break;case 1:i.pa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=YP(o,`Initialization of query '${Yd(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.ya.push(e),e.Da(n.onlineState),i.pa&&e.va(i.pa)&&QP(n)}async function XP(t,e){const n=Jt(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ya.indexOf(e);o>=0&&(i.ya.splice(o,1),i.ya.length===0?s=e.Sa()?0:1:!i.wa()&&e.Sa()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function $we(t,e){const n=Jt(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.ya)l.va(s)&&(r=!0);o.pa=s}}r&&QP(n)}function Uwe(t,e,n){const r=Jt(t),s=r.queries.get(e);if(s)for(const i of s.ya)i.onError(n);r.queries.delete(e)}function QP(t){t.ba.forEach(e=>{e.next()})}var $T,nL;(nL=$T||($T={})).Ca="default",nL.Cache="cache";class ZP{constructor(e,n,r){this.query=e,this.Fa=n,this.Ma=!1,this.xa=null,this.onlineState="Unknown",this.options=r||{}}va(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ff(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Ma?this.Oa(e)&&(this.Fa.next(e),n=!0):this.Na(e,this.onlineState)&&(this.Ba(e),n=!0),this.xa=e,n}onError(e){this.Fa.error(e)}Da(e){this.onlineState=e;let n=!1;return this.xa&&!this.Ma&&this.Na(this.xa,e)&&(this.Ba(this.xa),n=!0),n}Na(e,n){if(!e.fromCache||!this.Sa())return!0;const r=n!=="Offline";return(!this.options.La||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Oa(e){if(e.docChanges.length>0)return!0;const n=this.xa&&this.xa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Ba(e){e=ff.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Ma=!0,this.Fa.next(e)}Sa(){return this.options.source!==$T.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G8{constructor(e){this.key=e}}class W8{constructor(e){this.key=e}}class Bwe{constructor(e,n){this.query=e,this.Ga=n,this.za=null,this.hasCachedResults=!1,this.current=!1,this.ja=rn(),this.mutatedKeys=rn(),this.Ha=W9(e),this.Ja=new Mh(this.Ha)}get Ya(){return this.Ga}Za(e,n){const r=n?n.Xa:new eL,s=n?n.Ja:this.Ja;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,h)=>{const f=s.get(d),m=ty(this.query,h)?h:null,g=!!f&&this.mutatedKeys.has(f.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;f&&m?f.data.isEqual(m.data)?g!==x&&(r.track({type:3,doc:m}),w=!0):this.eu(f,m)||(r.track({type:2,doc:m}),w=!0,(c&&this.Ha(m,c)>0||u&&this.Ha(m,u)<0)&&(l=!0)):!f&&m?(r.track({type:0,doc:m}),w=!0):f&&!m&&(r.track({type:1,doc:f}),w=!0,(c||u)&&(l=!0)),w&&(m?(o=o.add(m),i=x?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ja:o,Xa:r,Cs:l,mutatedKeys:i}}eu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ja;this.Ja=e.Ja,this.mutatedKeys=e.mutatedKeys;const o=e.Xa.ga();o.sort((d,h)=>function(m,g){const x=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return St(20277,{Vt:w})}};return x(m)-x(g)}(d.type,h.type)||this.Ha(d.doc,h.doc)),this.tu(r),s=s!=null&&s;const l=n&&!s?this.nu():[],c=this.ja.size===0&&this.current&&!s?1:0,u=c!==this.za;return this.za=c,o.length!==0||u?{snapshot:new ff(this.query,e.Ja,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),ru:l}:{ru:l}}Da(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ja:this.Ja,Xa:new eL,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ru:[]}}iu(e){return!this.Ga.has(e)&&!!this.Ja.has(e)&&!this.Ja.get(e).hasLocalMutations}tu(e){e&&(e.addedDocuments.forEach(n=>this.Ga=this.Ga.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ga=this.Ga.delete(n)),this.current=e.current)}nu(){if(!this.current)return[];const e=this.ja;this.ja=rn(),this.Ja.forEach(r=>{this.iu(r.key)&&(this.ja=this.ja.add(r.key))});const n=[];return e.forEach(r=>{this.ja.has(r)||n.push(new W8(r))}),this.ja.forEach(r=>{e.has(r)||n.push(new G8(r))}),n}su(e){this.Ga=e.$s,this.ja=rn();const n=this.Za(e.documents);return this.applyChanges(n,!0)}ou(){return ff.fromInitialDocuments(this.query,this.Ja,this.mutatedKeys,this.za===0,this.hasCachedResults)}}const eA="SyncEngine";class zwe{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Gwe{constructor(e){this.key=e,this._u=!1}}class Wwe{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.au={},this.uu=new wl(l=>G9(l),kb),this.cu=new Map,this.lu=new Set,this.hu=new fr(dt.comparator),this.Pu=new Map,this.Tu=new VP,this.Iu={},this.Eu=new Map,this.du=id.lr(),this.onlineState="Unknown",this.Au=void 0}get isPrimaryClient(){return this.Au===!0}}async function Hwe(t,e,n=!0){const r=X8(t);let s;const i=r.uu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.ou()):s=await H8(r,e,n,!0),s}async function qwe(t,e){const n=X8(t);await H8(n,e,!0,!1)}async function H8(t,e,n,r){const s=await fwe(t.localStore,po(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await Kwe(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&O8(t.remoteStore,s),l}async function Kwe(t,e,n,r,s){t.Ru=(h,f,m)=>async function(x,w,v,_){let C=w.view.Za(v);C.Cs&&(C=await K4(x.localStore,w.query,!1).then(({documents:E})=>w.view.Za(E,C)));const T=_&&_.targetChanges.get(w.targetId),R=_&&_.targetMismatches.get(w.targetId)!=null,A=w.view.applyChanges(C,x.isPrimaryClient,T,R);return sL(x,w.targetId,A.ru),A.snapshot}(t,h,f,m);const i=await K4(t.localStore,e,!0),o=new Bwe(e,i.$s),l=o.Za(i.documents),c=ny.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);sL(t,n,u.ru);const d=new zwe(e,n,o);return t.uu.set(e,d),t.cu.has(n)?t.cu.get(n).push(e):t.cu.set(n,[e]),u.snapshot}async function Ywe(t,e,n){const r=Jt(t),s=r.uu.get(e),i=r.cu.get(s.targetId);if(i.length>1)return r.cu.set(s.targetId,i.filter(o=>!kb(o,e))),void r.uu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await OT(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&GP(r.remoteStore,s.targetId),UT(r,s.targetId)}).catch(pd)):(UT(r,s.targetId),await OT(r.localStore,s.targetId,!0))}async function Jwe(t,e){const n=Jt(t),r=n.uu.get(e),s=n.cu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),GP(n.remoteStore,r.targetId))}async function Xwe(t,e,n){const r=Q8(t);try{const s=await function(o,l){const c=Jt(o),u=br.now(),d=l.reduce((m,g)=>m.add(g.key),rn());let h,f;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=Bi(),x=rn();return c.Bs.getEntries(m,d).next(w=>{g=w,g.forEach((v,_)=>{_.isValidDocument()||(x=x.add(v))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,g)).next(w=>{h=w;const v=[];for(const _ of l){const C=fve(_,h.get(_.key).overlayedDocument);C!=null&&v.push(new bl(_.key,C,M9(C.value.mapValue),Js.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,v,l)}).next(w=>{f=w;const v=w.applyToLocalDocumentSet(h,x);return c.documentOverlayCache.saveOverlays(m,w.batchId,v)})}).then(()=>({batchId:f.batchId,changes:q9(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Iu[o.currentUser.toKey()];u||(u=new fr(Gt)),u=u.insert(l,c),o.Iu[o.currentUser.toKey()]=u}(r,s.batchId,n),await iy(r,s.changes),await sy(r.remoteStore)}catch(s){const i=YP(s,"Failed to persist write");n.reject(i)}}async function q8(t,e){const n=Jt(t);try{const r=await uwe(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Pu.get(i);o&&(Tt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o._u=!0:s.modifiedDocuments.size>0?Tt(o._u,14607):s.removedDocuments.size>0&&(Tt(o._u,42227),o._u=!1))}),await iy(n,r,e)}catch(r){await pd(r)}}function rL(t,e,n){const r=Jt(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.uu.forEach((i,o)=>{const l=o.view.Da(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=Jt(o);c.onlineState=l;let u=!1;c.queries.forEach((d,h)=>{for(const f of h.ya)f.Da(l)&&(u=!0)}),u&&QP(c)}(r.eventManager,e),s.length&&r.au.j_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Qwe(t,e,n){const r=Jt(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Pu.get(e),i=s&&s.key;if(i){let o=new fr(dt.comparator);o=o.insert(i,Tr.newNoDocument(i,Rt.min()));const l=rn().add(i),c=new Mb(Rt.min(),new Map,new fr(Gt),o,l);await q8(r,c),r.hu=r.hu.remove(i),r.Pu.delete(e),tA(r)}else await OT(r.localStore,e,!1).then(()=>UT(r,e,n)).catch(pd)}async function Zwe(t,e){const n=Jt(t),r=e.batch.batchId;try{const s=await cwe(n.localStore,e);Y8(n,r,null),K8(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await iy(n,s)}catch(s){await pd(s)}}async function e0e(t,e,n){const r=Jt(t);try{const s=await function(o,l){const c=Jt(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(h=>(Tt(h!==null,37113),d=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);Y8(r,e,n),K8(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await iy(r,s)}catch(s){await pd(s)}}function K8(t,e){(t.Eu.get(e)||[]).forEach(n=>{n.resolve()}),t.Eu.delete(e)}function Y8(t,e,n){const r=Jt(t);let s=r.Iu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Iu[r.currentUser.toKey()]=s}}function UT(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.cu.get(e))t.uu.delete(r),n&&t.au.Vu(r,n);t.cu.delete(e),t.isPrimaryClient&&t.Tu.Hr(e).forEach(r=>{t.Tu.containsKey(r)||J8(t,r)})}function J8(t,e){t.lu.delete(e.path.canonicalString());const n=t.hu.get(e);n!==null&&(GP(t.remoteStore,n),t.hu=t.hu.remove(e),t.Pu.delete(n),tA(t))}function sL(t,e,n){for(const r of n)r instanceof G8?(t.Tu.addReference(r.key,e),t0e(t,r)):r instanceof W8?(Xe(eA,"Document no longer in limbo: "+r.key),t.Tu.removeReference(r.key,e),t.Tu.containsKey(r.key)||J8(t,r.key)):St(19791,{mu:r})}function t0e(t,e){const n=e.key,r=n.path.canonicalString();t.hu.get(n)||t.lu.has(r)||(Xe(eA,"New document in limbo: "+n),t.lu.add(r),tA(t))}function tA(t){for(;t.lu.size>0&&t.hu.size<t.maxConcurrentLimboResolutions;){const e=t.lu.values().next().value;t.lu.delete(e);const n=new dt(An.fromString(e)),r=t.du.next();t.Pu.set(r,new Gwe(n)),t.hu=t.hu.insert(n,r),O8(t.remoteStore,new Ha(po(ey(n.path)),r,"TargetPurposeLimboResolution",ho.le))}}async function iy(t,e,n){const r=Jt(t),s=[],i=[],o=[];r.uu.isEmpty()||(r.uu.forEach((l,c)=>{o.push(r.Ru(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const h=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){s.push(u);const h=BP.Rs(c.targetId,u);i.push(h)}}))}),await Promise.all(o),r.au.j_(s),await async function(c,u){const d=Jt(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ye.forEach(u,f=>ye.forEach(f.ds,m=>d.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>ye.forEach(f.As,m=>d.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!Hc(h))throw h;Xe(zP,"Failed to update sequence numbers: "+h)}for(const h of u){const f=h.targetId;if(!h.fromCache){const m=d.xs.get(f),g=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(g);d.xs=d.xs.insert(f,x)}}}(r.localStore,i))}async function n0e(t,e){const n=Jt(t);if(!n.currentUser.isEqual(e)){Xe(eA,"User change. New user:",e.toKey());const r=await j8(n.localStore,e);n.currentUser=e,function(i,o){i.Eu.forEach(l=>{l.forEach(c=>{c.reject(new at(Fe.CANCELLED,o))})}),i.Eu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await iy(n,r.ks)}}function r0e(t,e){const n=Jt(t),r=n.Pu.get(e);if(r&&r._u)return rn().add(r.key);{let s=rn();const i=n.cu.get(e);if(!i)return s;for(const o of i){const l=n.uu.get(o);s=s.unionWith(l.view.Ya)}return s}}function X8(t){const e=Jt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=q8.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=r0e.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Qwe.bind(null,e),e.au.j_=$we.bind(null,e.eventManager),e.au.Vu=Uwe.bind(null,e.eventManager),e}function Q8(t){const e=Jt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Zwe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=e0e.bind(null,e),e}class lg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vb(e.databaseInfo.databaseId),this.sharedClientState=this.pu(e),this.persistence=this.yu(e),await this.persistence.start(),this.localStore=this.wu(e),this.gcScheduler=this.Su(e,this.localStore),this.indexBackfillerScheduler=this.bu(e,this.localStore)}Su(e,n){return null}bu(e,n){return null}wu(e){return R8(this.persistence,new k8,e.initialUser,this.serializer)}yu(e){return new $P(Ob.fi,this.serializer)}pu(e){return new M8}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}lg.provider={build:()=>new lg};class s0e extends lg{constructor(e){super(),this.cacheSizeBytes=e}Su(e,n){Tt(this.persistence.referenceDelegate instanceof Bw,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new T8(r,e.asyncQueue,n)}yu(e){const n=this.cacheSizeBytes!==void 0?ks.withCacheSize(this.cacheSizeBytes):ks.DEFAULT;return new $P(r=>Bw.fi(r,n),this.serializer)}}class i0e extends lg{constructor(e,n,r){super(),this.Du=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Du.initialize(this,e),await Q8(this.Du.syncEngine),await sy(this.Du.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}wu(e){return R8(this.persistence,new k8,e.initialUser,this.serializer)}Su(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new T8(r,e.asyncQueue,n)}bu(e,n){const r=new dxe(n,this.persistence);return new uxe(e.asyncQueue,r)}yu(e){const n=iwe(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?ks.withCacheSize(this.cacheSizeBytes):ks.DEFAULT;return new UP(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,wwe(),pv(),this.serializer,this.sharedClientState,!!this.forceOwnership)}pu(e){return new M8}}class Gw{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>rL(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=n0e.bind(null,this.syncEngine),await Fwe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Vwe}()}createDatastore(e){const n=Vb(e.databaseInfo.databaseId),r=function(i){return new vwe(i)}(e.databaseInfo);return function(i,o,l,c){return new Cwe(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new Twe(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>rL(this.syncEngine,n,0),function(){return X4.C()?new X4:new pwe}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,d){const h=new Wwe(s,i,o,l,c,u);return d&&(h.Au=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Jt(s);Xe(od,"RemoteStore shutting down."),i.Ta.add(5),await ry(i),i.Ea.shutdown(),i.da.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Gw.provider={build:()=>new Gw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.vu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.vu(this.observer.error,e):Ys("Uncaught Error in snapshot listener:",e.toString()))}Cu(){this.muted=!0}vu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc="FirestoreClient";class o0e{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=ms.UNAUTHENTICATED,this.clientId=u9.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Xe(Nc,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Xe(Nc,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ba;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=YP(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function zS(t,e){t.asyncQueue.verifyOperationInProgress(),Xe(Nc,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await j8(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function iL(t,e){t.asyncQueue.verifyOperationInProgress();const n=await a0e(t);Xe(Nc,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Z4(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Z4(e.remoteStore,s)),t._onlineComponents=e}async function a0e(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Xe(Nc,"Using user provided OfflineComponentProvider");try{await zS(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===Fe.FAILED_PRECONDITION||s.code===Fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;ed("Error using user provided cache. Falling back to memory cache: "+n),await zS(t,new lg)}}else Xe(Nc,"Using default OfflineComponentProvider"),await zS(t,new s0e(void 0));return t._offlineComponents}async function Z8(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Xe(Nc,"Using user provided OnlineComponentProvider"),await iL(t,t._uninitializedComponentsProvider._online)):(Xe(Nc,"Using default OnlineComponentProvider"),await iL(t,new Gw))),t._onlineComponents}function l0e(t){return Z8(t).then(e=>e.syncEngine)}async function Ww(t){const e=await Z8(t),n=e.eventManager;return n.onListen=Hwe.bind(null,e.syncEngine),n.onUnlisten=Ywe.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=qwe.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Jwe.bind(null,e.syncEngine),n}function c0e(t,e,n={}){const r=new ba;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new nA({next:f=>{d.Cu(),o.enqueueAndForget(()=>XP(i,h));const m=f.docs.has(l);!m&&f.fromCache?u.reject(new at(Fe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&c&&c.source==="server"?u.reject(new at(Fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new ZP(ey(l.path),d,{includeMetadataChanges:!0,La:!0});return JP(i,h)}(await Ww(t),t.asyncQueue,e,n,r)),r.promise}function u0e(t,e,n={}){const r=new ba;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new nA({next:f=>{d.Cu(),o.enqueueAndForget(()=>XP(i,h)),f.fromCache&&c.source==="server"?u.reject(new at(Fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new ZP(l,d,{includeMetadataChanges:!0,La:!0});return JP(i,h)}(await Ww(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eG(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tG(t,e,n){if(!n)throw new at(Fe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function d0e(t,e,n,r){if(e===!0&&r===!0)throw new at(Fe.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function aL(t){if(!dt.isDocumentKey(t))throw new at(Fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function lL(t){if(dt.isDocumentKey(t))throw new at(Fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ub(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":St(12329,{type:typeof t})}function xi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new at(Fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ub(t);throw new at(Fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function h0e(t,e){if(e<=0)throw new at(Fe.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nG="firestore.googleapis.com",cL=!0;class uL{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new at(Fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=nG,this.ssl=cL}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:cL;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=_8;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Bve)throw new at(Fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}d0e("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=eG((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new at(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new at(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new at(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Bb{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new uL({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new at(Fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new at(Fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new uL(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Qye;switch(r.type){case"firstParty":return new nxe(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new at(Fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=oL.get(n);r&&(Xe("ComponentProvider","Removing Datastore"),oL.delete(n),r.terminate())}(this),Promise.resolve()}}function f0e(t,e,n,r={}){var s;t=xi(t,Bb);const i=Bc(e),o=t._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),c=`${e}:${n}`;i&&(xb(`https://${c}`),vb("Firestore",!0)),o.host!==nG&&o.host!==c&&ed("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},o),{host:c,ssl:i,emulatorOptions:r});if(!Ju(u,l)&&(t._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=ms.MOCK_USER;else{d=hz(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new at(Fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new ms(f)}t._authCredentials=new Zye(new l9(d,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Kc(this.firestore,e,this._query)}}class Ls{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ls(this.firestore,e,this._key)}}class mc extends Kc{constructor(e,n,r){super(e,n,ey(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ls(this.firestore,null,new dt(e))}withConverter(e){return new mc(this.firestore,e,this._path)}}function Ai(t,e,...n){if(t=Qn(t),tG("collection","path",e),t instanceof Bb){const r=An.fromString(e,...n);return lL(r),new mc(t,null,r)}{if(!(t instanceof Ls||t instanceof mc))throw new at(Fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(An.fromString(e,...n));return lL(r),new mc(t.firestore,null,r)}}function Ps(t,e,...n){if(t=Qn(t),arguments.length===1&&(e=u9.newId()),tG("doc","path",e),t instanceof Bb){const r=An.fromString(e,...n);return aL(r),new Ls(t,null,new dt(r))}{if(!(t instanceof Ls||t instanceof mc))throw new at(Fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(An.fromString(e,...n));return aL(r),new Ls(t.firestore,t instanceof mc?t.converter:null,new dt(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL="AsyncQueue";class hL{constructor(e=Promise.resolve()){this.zu=[],this.ju=!1,this.Hu=[],this.Ju=null,this.Yu=!1,this.Zu=!1,this.Xu=[],this.C_=new L8(this,"async_queue_retry"),this.ec=()=>{const r=pv();r&&Xe(dL,"Visibility state changed to "+r.visibilityState),this.C_.p_()},this.tc=e;const n=pv();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.ec)}get isShuttingDown(){return this.ju}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nc(),this.rc(e)}enterRestrictedMode(e){if(!this.ju){this.ju=!0,this.Zu=e||!1;const n=pv();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.ec)}}enqueue(e){if(this.nc(),this.ju)return new Promise(()=>{});const n=new ba;return this.rc(()=>this.ju&&this.Zu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.zu.push(e),this.sc()))}async sc(){if(this.zu.length!==0){try{await this.zu[0](),this.zu.shift(),this.C_.reset()}catch(e){if(!Hc(e))throw e;Xe(dL,"Operation failed with retryable error: "+e)}this.zu.length>0&&this.C_.f_(()=>this.sc())}}rc(e){const n=this.tc.then(()=>(this.Yu=!0,e().catch(r=>{throw this.Ju=r,this.Yu=!1,Ys("INTERNAL UNHANDLED ERROR: ",fL(r)),r}).then(r=>(this.Yu=!1,r))));return this.tc=n,n}enqueueAfterDelay(e,n,r){this.nc(),this.Xu.indexOf(e)>-1&&(n=0);const s=KP.createAndSchedule(this,e,n,r,i=>this.oc(i));return this.Hu.push(s),s}nc(){this.Ju&&St(47125,{_c:fL(this.Ju)})}verifyOperationInProgress(){}async ac(){let e;do e=this.tc,await e;while(e!==this.tc)}uc(e){for(const n of this.Hu)if(n.timerId===e)return!0;return!1}cc(e){return this.ac().then(()=>{this.Hu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Hu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.ac()})}lc(e){this.Xu.push(e)}oc(e){const n=this.Hu.indexOf(e);this.Hu.splice(n,1)}}function fL(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mL(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m0e=-1;class dl extends Bb{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new hL,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new hL(e),this._firestoreClient=void 0,await e}}}function p0e(t,e){const n=typeof t=="object"?t:wb(),r=typeof t=="string"?t:e||Rw,s=Hg(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=aP("firestore");i&&f0e(s,...i)}return s}function zb(t){if(t._terminated)throw new at(Fe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||rG(t),t._firestoreClient}function rG(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new $xe(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,eG(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new o0e(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function g0e(t,e){ed("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return y0e(t,Gw.provider,{build:r=>new i0e(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function y0e(t,e,n){if((t=xi(t,dl))._firestoreClient||t._terminated)throw new at(Fe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new at(Fe.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},rG(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new mf(Gr.fromBase64String(e))}catch(n){throw new at(Fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new mf(Gr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new at(Fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new at(Fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new at(Fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Gt(this._lat,e._lat)||Gt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0e=/^__.*__$/;class v0e{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new bl(e,this.data,this.fieldMask,n,this.fieldTransforms):new Rf(e,this.data,n,this.fieldTransforms)}}class sG{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new bl(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function iG(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw St(40011,{hc:t})}}class oA{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Pc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get hc(){return this.settings.hc}Tc(e){return new oA(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ic(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tc({path:r,Ec:!1});return s.dc(e),s}Ac(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tc({path:r,Ec:!1});return s.Pc(),s}Rc(e){return this.Tc({path:void 0,Ec:!0})}Vc(e){return Hw(e,this.settings.methodName,this.settings.mc||!1,this.path,this.settings.fc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pc(){if(this.path)for(let e=0;e<this.path.length;e++)this.dc(this.path.get(e))}dc(e){if(e.length===0)throw this.Vc("Document fields must not be empty");if(iG(this.hc)&&x0e.test(e))throw this.Vc('Document fields cannot begin and end with "__"')}}class w0e{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Vb(e)}gc(e,n,r,s=!1){return new oA({hc:e,methodName:n,fc:r,path:vr.emptyPath(),Ec:!1,mc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function aA(t){const e=t._freezeSettings(),n=Vb(t._databaseId);return new w0e(t._databaseId,!!e.ignoreUndefinedProperties,n)}function b0e(t,e,n,r,s,i={}){const o=t.gc(i.merge||i.mergeFields?2:0,e,n,s);lA("Data must be an object, but it was:",o,r);const l=oG(r,o);let c,u;if(i.merge)c=new fi(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const f=BT(e,h,n);if(!o.contains(f))throw new at(Fe.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);lG(d,f)||d.push(f)}c=new fi(d),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new v0e(new Ds(l),c,u)}class Wb extends rA{_toFieldTransform(e){if(e.hc!==2)throw e.hc===1?e.Vc(`${this._methodName}() can only appear at the top level of your update data`):e.Vc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Wb}}function _0e(t,e,n,r){const s=t.gc(1,e,n);lA("Data must be an object, but it was:",s,r);const i=[],o=Ds.empty();qc(r,(c,u)=>{const d=cA(e,c,n);u=Qn(u);const h=s.Ac(d);if(u instanceof Wb)i.push(d);else{const f=oy(u,h);f!=null&&(i.push(d),o.set(d,f))}});const l=new fi(i);return new sG(o,l,s.fieldTransforms)}function S0e(t,e,n,r,s,i){const o=t.gc(1,e,n),l=[BT(e,r,n)],c=[s];if(i.length%2!=0)throw new at(Fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)l.push(BT(e,i[f])),c.push(i[f+1]);const u=[],d=Ds.empty();for(let f=l.length-1;f>=0;--f)if(!lG(u,l[f])){const m=l[f];let g=c[f];g=Qn(g);const x=o.Ac(m);if(g instanceof Wb)u.push(m);else{const w=oy(g,x);w!=null&&(u.push(m),d.set(m,w))}}const h=new fi(u);return new sG(d,h,o.fieldTransforms)}function C0e(t,e,n,r=!1){return oy(n,t.gc(r?4:3,e))}function oy(t,e){if(aG(t=Qn(t)))return lA("Unsupported field value:",e,t),oG(t,e);if(t instanceof rA)return function(r,s){if(!iG(s.hc))throw s.Vc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Vc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Ec&&e.hc!==4)throw e.Vc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=oy(l,s.Rc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Qn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return ove(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=br.fromDate(r);return{timestampValue:hf(s.serializer,i)}}if(r instanceof br){const i=new br(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:hf(s.serializer,i)}}if(r instanceof sA)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof mf)return{bytesValue:o8(s.serializer,r._byteString)};if(r instanceof Ls){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Vc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:LP(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof iA)return function(o,l){return{mapValue:{fields:{[NP]:{stringValue:PP},[of]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Vc("VectorValues must only contain numeric values.");return kP(l.serializer,u)})}}}}}}(r,s);throw s.Vc(`Unsupported field value: ${Ub(r)}`)}(t,e)}function oG(t,e){const n={};return T9(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qc(t,(r,s)=>{const i=oy(s,e.Ic(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function aG(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof br||t instanceof sA||t instanceof mf||t instanceof Ls||t instanceof rA||t instanceof iA)}function lA(t,e,n){if(!aG(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Ub(n);throw r==="an object"?e.Vc(t+" a custom object"):e.Vc(t+" "+r)}}function BT(t,e,n){if((e=Qn(e))instanceof Gb)return e._internalPath;if(typeof e=="string")return cA(t,e);throw Hw("Field path arguments must be of type string or ",t,!1,void 0,n)}const E0e=new RegExp("[~\\*/\\[\\]]");function cA(t,e,n){if(e.search(E0e)>=0)throw Hw(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Gb(...e.split("."))._internalPath}catch{throw Hw(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Hw(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new at(Fe.INVALID_ARGUMENT,l+t+c)}function lG(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cG{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ls(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new T0e(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(uA("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class T0e extends cG{data(){return super.data()}}function uA(t,e){return typeof e=="string"?cA(t,e):e instanceof Gb?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uG(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new at(Fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dA{}class dG extends dA{}function zT(t,e,...n){let r=[];e instanceof dA&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof hA).length,l=i.filter(c=>c instanceof Hb).length;if(o>1||o>0&&l>0)throw new at(Fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Hb extends dG{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Hb(e,n,r)}_apply(e){const n=this._parse(e);return hG(e._query,n),new Kc(e.firestore,e.converter,AT(e._query,n))}_parse(e){const n=aA(e.firestore);return function(i,o,l,c,u,d,h){let f;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new at(Fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){gL(h,d);const g=[];for(const x of h)g.push(pL(c,i,x));f={arrayValue:{values:g}}}else f=pL(c,i,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||gL(h,d),f=C0e(l,o,h,d==="in"||d==="not-in");return un.create(u,d,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function GT(t,e,n){const r=e,s=uA("where",t);return Hb._create(s,r,n)}class hA extends dA{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new hA(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Mn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)hG(o,c),o=AT(o,c)}(e._query,n),new Kc(e.firestore,e.converter,AT(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class fA extends dG{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new fA(e,n,r)}_apply(e){return new Kc(e.firestore,e.converter,Lw(e._query,this._limit,this._limitType))}}function I0e(t){return h0e("limit",t),fA._create("limit",t,"F")}function pL(t,e,n){if(typeof(n=Qn(n))=="string"){if(n==="")throw new at(Fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!z9(e)&&n.indexOf("/")!==-1)throw new at(Fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(An.fromString(n));if(!dt.isDocumentKey(r))throw new at(Fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return sg(t,new dt(r))}if(n instanceof Ls)return sg(t,n._key);throw new at(Fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ub(n)}.`)}function gL(t,e){if(!Array.isArray(t)||t.length===0)throw new at(Fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function hG(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new at(Fe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new at(Fe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class N0e{convertValue(e,n="none"){switch(Ec(e)){case 0:return null;case 1:return e.booleanValue;case 2:return cr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ul(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw St(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return qc(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[of].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>cr(o.doubleValue));return new iA(i)}convertGeoPoint(e){return new sA(cr(e.latitude),cr(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Pb(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ng(e));default:return null}}convertTimestamp(e){const n=cl(e);return new br(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=An.fromString(e);Tt(g8(r),9688,{name:e});const s=new td(r.get(1),r.get(3)),i=new dt(r.popFirst(5));return s.isEqual(n)||Ys(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0e(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fG extends cG{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new gv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(uA("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class gv extends fG{data(e={}){return super.data(e)}}class mG{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Mm(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new gv(this._firestore,this._userDataWriter,r.key,r,new Mm(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new at(Fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new gv(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Mm(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new gv(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Mm(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:A0e(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function A0e(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return St(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k0e(t){t=xi(t,Ls);const e=xi(t.firestore,dl);return c0e(zb(e),t._key).then(n=>pG(e,t,n))}class mA extends N0e{constructor(e){super(),this.firestore=e}convertBytes(e){return new mf(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ls(this.firestore,null,n)}}function ki(t){t=xi(t,Kc);const e=xi(t.firestore,dl),n=zb(e),r=new mA(e);return uG(t._query),u0e(n,t._query).then(s=>new mG(e,r,t,s))}function mp(t,e,n){t=xi(t,Ls);const r=xi(t.firestore,dl),s=P0e(t.converter,e,n);return pA(r,[b0e(aA(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Js.none())])}function dm(t,e,n,...r){t=xi(t,Ls);const s=xi(t.firestore,dl),i=aA(s);let o;return o=typeof(e=Qn(e))=="string"||e instanceof Gb?S0e(i,"updateDoc",t._key,e,n,r):_0e(i,"updateDoc",t._key,e),pA(s,[o.toMutation(t._key,Js.exists(!0))])}function GS(t){return pA(xi(t.firestore,dl),[new Db(t._key,Js.none())])}function R0e(t,...e){var n,r,s;t=Qn(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||mL(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(mL(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let c,u,d;if(t instanceof Ls)u=xi(t.firestore,dl),d=ey(t._key.path),c={next:h=>{e[o]&&e[o](pG(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=xi(t,Kc);u=xi(h.firestore,dl),d=h._query;const f=new mA(u);c={next:m=>{e[o]&&e[o](new mG(u,f,h,m))},error:e[o+1],complete:e[o+2]},uG(t._query)}return function(f,m,g,x){const w=new nA(x),v=new ZP(m,w,g);return f.asyncQueue.enqueueAndForget(async()=>JP(await Ww(f),v)),()=>{w.Cu(),f.asyncQueue.enqueueAndForget(async()=>XP(await Ww(f),v))}}(zb(u),d,l,c)}function pA(t,e){return function(r,s){const i=new ba;return r.asyncQueue.enqueueAndForget(async()=>Xwe(await l0e(r),s,i)),i.promise}(zb(t),e)}function pG(t,e,n){const r=n.docs.get(e._key),s=new mA(t);return new fG(t,s,e._key,r,new Mm(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){kf=s})(md),Cc(new ol("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new dl(new exe(r.getProvider("auth-internal")),new rxe(o,r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new at(Fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new td(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),mo(KM,YM,e),mo(KM,YM,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gG="firebasestorage.googleapis.com",yG="storageBucket",j0e=2*60*1e3,D0e=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr extends Xo{constructor(e,n,r=0){super(WS(e),`Firebase Storage: ${n} (${WS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Rr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return WS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var kr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(kr||(kr={}));function WS(t){return"storage/"+t}function gA(){const t="An unknown error occurred, please check the error payload for server response.";return new Rr(kr.UNKNOWN,t)}function M0e(t){return new Rr(kr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function L0e(t){return new Rr(kr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function F0e(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Rr(kr.UNAUTHENTICATED,t)}function O0e(){return new Rr(kr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function V0e(t){return new Rr(kr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function $0e(){return new Rr(kr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function U0e(){return new Rr(kr.CANCELED,"User canceled the upload/download.")}function B0e(t){return new Rr(kr.INVALID_URL,"Invalid URL '"+t+"'.")}function z0e(t){return new Rr(kr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function G0e(){return new Rr(kr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+yG+"' property when initializing the app?")}function W0e(){return new Rr(kr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function H0e(){return new Rr(kr.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function q0e(t){return new Rr(kr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function WT(t){return new Rr(kr.INVALID_ARGUMENT,t)}function xG(){return new Rr(kr.APP_DELETED,"The Firebase app was deleted.")}function K0e(t){return new Rr(kr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function pp(t,e){return new Rr(kr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function hm(t){throw new Rr(kr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=zi.makeFromUrl(e,n)}catch{return new zi(e,"")}if(r.path==="")return r;throw z0e(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(T){T.path.charAt(T.path.length-1)==="/"&&(T.path_=T.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function u(T){T.path_=decodeURIComponent(T.path)}const d="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${d}/b/${s}/o${f}`,"i"),g={bucket:1,path:3},x=n===gG?"(?:storage.googleapis.com|storage.cloud.google.com)":n,w="([^?#]*)",v=new RegExp(`^https?://${x}/${s}/${w}`,"i"),C=[{regex:l,indices:c,postModify:i},{regex:m,indices:g,postModify:u},{regex:v,indices:{bucket:1,path:2},postModify:u}];for(let T=0;T<C.length;T++){const R=C[T],A=R.regex.exec(e);if(A){const E=A[R.indices.bucket];let I=A[R.indices.path];I||(I=""),r=new zi(E,I),R.postModify(r);break}}if(r==null)throw B0e(e);return r}}class Y0e{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J0e(t,e,n){let r=1,s=null,i=null,o=!1,l=0;function c(){return l===2}let u=!1;function d(...w){u||(u=!0,e.apply(null,w))}function h(w){s=setTimeout(()=>{s=null,t(m,c())},w)}function f(){i&&clearTimeout(i)}function m(w,...v){if(u){f();return}if(w){f(),d.call(null,w,...v);return}if(c()||o){f(),d.call(null,w,...v);return}r<64&&(r*=2);let C;l===1?(l=2,C=0):C=(r+Math.random())*1e3,h(C)}let g=!1;function x(w){g||(g=!0,f(),!u&&(s!==null?(w||(l=2),clearTimeout(s),h(0)):w||(l=1)))}return h(0),i=setTimeout(()=>{o=!0,x(!0)},n),x}function X0e(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q0e(t){return t!==void 0}function Z0e(t){return typeof t=="object"&&!Array.isArray(t)}function yA(t){return typeof t=="string"||t instanceof String}function yL(t){return xA()&&t instanceof Blob}function xA(){return typeof Blob<"u"}function xL(t,e,n,r){if(r<e)throw WT(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw WT(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vA(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function vG(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var $u;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})($u||($u={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ebe(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tbe{constructor(e,n,r,s,i,o,l,c,u,d,h,f=!0,m=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,x)=>{this.resolve_=g,this.reject_=x,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new gx(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===$u.NO_ERROR,c=i.getStatus();if(!l||ebe(c,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===$u.ABORT;r(!1,new gx(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new gx(u,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());Q0e(c)?i(c):i()}catch(c){o(c)}else if(l!==null){const c=gA();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(s.canceled){const c=this.appDelete_?xG():U0e();o(c)}else{const c=$0e();o(c)}};this.canceled_?n(!1,new gx(!1,null,!0)):this.backoffId_=J0e(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&X0e(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class gx{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function nbe(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function rbe(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function sbe(t,e){e&&(t["X-Firebase-GMPID"]=e)}function ibe(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function obe(t,e,n,r,s,i,o=!0,l=!1){const c=vG(t.urlParams),u=t.url+c,d=Object.assign({},t.headers);return sbe(d,e),nbe(d,n),rbe(d,i),ibe(d,r),new tbe(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function abe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function lbe(...t){const e=abe();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(xA())return new Blob(t);throw new Rr(kr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function cbe(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ube(t){if(typeof atob>"u")throw q0e("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class HS{constructor(e,n){this.data=e,this.contentType=n||null}}function dbe(t,e){switch(t){case fa.RAW:return new HS(wG(e));case fa.BASE64:case fa.BASE64URL:return new HS(bG(t,e));case fa.DATA_URL:return new HS(fbe(e),mbe(e))}throw gA()}function wG(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function hbe(t){let e;try{e=decodeURIComponent(t)}catch{throw pp(fa.DATA_URL,"Malformed data URL.")}return wG(e)}function bG(t,e){switch(t){case fa.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw pp(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case fa.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw pp(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=ube(e)}catch(s){throw s.message.includes("polyfill")?s:pp(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class _G{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw pp(fa.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=pbe(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function fbe(t){const e=new _G(t);return e.base64?bG(fa.BASE64,e.rest):hbe(e.rest)}function mbe(t){return new _G(t).contentType}function pbe(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,n){let r=0,s="";yL(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(yL(this.data_)){const r=this.data_,s=cbe(r,e,n);return s===null?null:new Hl(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Hl(r,!0)}}static getBlob(...e){if(xA()){const n=e.map(r=>r instanceof Hl?r.data_:r);return new Hl(lbe.apply(null,n))}else{const n=e.map(o=>yA(o)?dbe(fa.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new Hl(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SG(t){let e;try{e=JSON.parse(t)}catch{return null}return Z0e(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gbe(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function ybe(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function CG(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xbe(t,e){return e}class zs{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||xbe}}let yx=null;function vbe(t){return!yA(t)||t.length<2?t:CG(t)}function EG(){if(yx)return yx;const t=[];t.push(new zs("bucket")),t.push(new zs("generation")),t.push(new zs("metageneration")),t.push(new zs("name","fullPath",!0));function e(i,o){return vbe(o)}const n=new zs("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new zs("size");return s.xform=r,t.push(s),t.push(new zs("timeCreated")),t.push(new zs("updated")),t.push(new zs("md5Hash",null,!0)),t.push(new zs("cacheControl",null,!0)),t.push(new zs("contentDisposition",null,!0)),t.push(new zs("contentEncoding",null,!0)),t.push(new zs("contentLanguage",null,!0)),t.push(new zs("contentType",null,!0)),t.push(new zs("metadata","customMetadata",!0)),yx=t,yx}function wbe(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new zi(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function bbe(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return wbe(r,t),r}function TG(t,e,n){const r=SG(e);return r===null?null:bbe(t,r,n)}function _be(t,e,n,r){const s=SG(e);if(s===null||!yA(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,h=t.fullPath,f="/b/"+o(d)+"/o/"+o(h),m=vA(f,n,r),g=vG({alt:"media",token:u});return m+g})[0]}function Sbe(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class IG{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NG(t){if(!t)throw gA()}function Cbe(t,e){function n(r,s){const i=TG(t,s,e);return NG(i!==null),i}return n}function Ebe(t,e){function n(r,s){const i=TG(t,s,e);return NG(i!==null),_be(i,s,t.host,t._protocol)}return n}function PG(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=O0e():s=F0e():n.getStatus()===402?s=L0e(t.bucket):n.getStatus()===403?s=V0e(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function Tbe(t){const e=PG(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=M0e(t.path)),i.serverResponse=s.serverResponse,i}return n}function Ibe(t,e,n){const r=e.fullServerUrl(),s=vA(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new IG(s,i,Ebe(t,n),o);return l.errorHandler=Tbe(e),l}function Nbe(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Pbe(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=Nbe(null,e)),r}function Abe(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let C="";for(let T=0;T<2;T++)C=C+Math.random().toString().slice(2);return C}const c=l();o["Content-Type"]="multipart/related; boundary="+c;const u=Pbe(e,r,s),d=Sbe(u,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,f=`\r
--`+c+"--",m=Hl.getBlob(h,r,f);if(m===null)throw W0e();const g={name:u.fullPath},x=vA(i,t.host,t._protocol),w="POST",v=t.maxUploadRetryTime,_=new IG(x,w,Cbe(t,n),v);return _.urlParams=g,_.headers=o,_.body=m.uploadData(),_.errorHandler=PG(e),_}class kbe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=$u.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=$u.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=$u.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw hm("cannot .send() more than once");if(Bc(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw hm("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw hm("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw hm("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw hm("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Rbe extends kbe{initXhr(){this.xhr_.responseType="text"}}function AG(){return new Rbe}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e,n){this._service=e,n instanceof zi?this._location=n:this._location=zi.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ad(e,n)}get root(){const e=new zi(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return CG(this._location.path)}get storage(){return this._service}get parent(){const e=gbe(this._location.path);if(e===null)return null;const n=new zi(this._location.bucket,e);return new ad(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw K0e(e)}}function jbe(t,e,n){t._throwIfRoot("uploadBytes");const r=Abe(t.storage,t._location,EG(),new Hl(e,!0),n);return t.storage.makeRequestWithTokens(r,AG).then(s=>({metadata:s,ref:t}))}function Dbe(t){t._throwIfRoot("getDownloadURL");const e=Ibe(t.storage,t._location,EG());return t.storage.makeRequestWithTokens(e,AG).then(n=>{if(n===null)throw H0e();return n})}function Mbe(t,e){const n=ybe(t._location.path,e),r=new zi(t._location.bucket,n);return new ad(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lbe(t){return/^[A-Za-z]+:\/\//.test(t)}function Fbe(t,e){return new ad(t,e)}function kG(t,e){if(t instanceof wA){const n=t;if(n._bucket==null)throw G0e();const r=new ad(n,n._bucket);return e!=null?kG(r,e):r}else return e!==void 0?Mbe(t,e):t}function Obe(t,e){if(e&&Lbe(e)){if(t instanceof wA)return Fbe(t,e);throw WT("To use ref(service, url), the first argument must be a Storage instance.")}else return kG(t,e)}function vL(t,e){const n=e==null?void 0:e[yG];return n==null?null:zi.makeFromBucketSpec(n,t)}function Vbe(t,e,n,r={}){t.host=`${e}:${n}`;const s=Bc(e);s&&(xb(`https://${t.host}`),vb("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:hz(i,t.app.options.projectId))}class wA{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=gG,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=j0e,this._maxUploadRetryTime=D0e,this._requests=new Set,s!=null?this._bucket=zi.makeFromBucketSpec(s,this._host):this._bucket=vL(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=zi.makeFromBucketSpec(this._url,e):this._bucket=vL(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){xL("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){xL("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Ks(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ad(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new Y0e(xG());{const o=obe(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const wL="@firebase/storage",bL="0.13.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RG="storage";function yh(t,e,n){return t=Qn(t),jbe(t,e,n)}function xh(t){return t=Qn(t),Dbe(t)}function vh(t,e){return t=Qn(t),Obe(t,e)}function $be(t=wb(),e){t=Qn(t);const r=Hg(t,RG).getImmediate({identifier:e}),s=aP("storage");return s&&Ube(r,...s),r}function Ube(t,e,n,r={}){Vbe(t,e,n,r)}function Bbe(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new wA(n,r,s,e,md)}function zbe(){Cc(new ol(RG,Bbe,"PUBLIC").setMultipleInstances(!0)),mo(wL,bL,""),mo(wL,bL,"esm2017")}zbe();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gbe="type.googleapis.com/google.protobuf.Int64Value",Wbe="type.googleapis.com/google.protobuf.UInt64Value";function jG(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function qw(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>qw(e));if(typeof t=="function"||typeof t=="object")return jG(t,e=>qw(e));throw new Error("Data cannot be encoded in JSON: "+t)}function pf(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case Gbe:case Wbe:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>pf(e)):typeof t=="function"||typeof t=="object"?jG(t,e=>pf(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bA="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class mi extends Xo{constructor(e,n,r){super(`${bA}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,mi.prototype)}}function Hbe(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Kw(t,e){let n=Hbe(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!_L[o])return new mi("internal","internal");n=_L[o],r=o}const l=i.message;typeof l=="string"&&(r=l),s=i.details,s!==void 0&&(s=pf(s))}}catch{}return n==="ok"?null:new mi(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qbe{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Ks(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HT="us-central1",Kbe=/^data: (.*?)(?:\n|$)/;function Ybe(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new mi("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class Jbe{constructor(e,n,r,s,i=HT,o=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new qbe(e,n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=HT}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function Xbe(t,e,n){const r=Bc(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(xb(t.emulatorOrigin),vb("Functions",!0))}function Qbe(t,e,n){const r=s=>e_e(t,e,s,n||{});return r.stream=(s,i)=>n_e(t,e,s,i),r}async function Zbe(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}async function DG(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function e_e(t,e,n,r){const s=t._url(e);return t_e(t,s,n,r)}async function t_e(t,e,n,r){n=qw(n);const s={data:n},i=await DG(t,r),o=r.timeout||7e4,l=Ybe(o),c=await Promise.race([Zbe(e,s,i,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!c)throw new mi("cancelled","Firebase Functions instance was deleted.");const u=Kw(c.status,c.json);if(u)throw u;if(!c.json)throw new mi("internal","Response is not valid JSON object.");let d=c.json.data;if(typeof d>"u"&&(d=c.json.result),typeof d>"u")throw new mi("internal","Response is missing data field.");return{data:pf(d)}}function n_e(t,e,n,r){const s=t._url(e);return r_e(t,s,n,r||{})}async function r_e(t,e,n,r){var s;n=qw(n);const i={data:n},o=await DG(t,r);o["Content-Type"]="application/json",o.Accept="text/event-stream";let l;try{l=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(i),headers:o,signal:r==null?void 0:r.signal})}catch(m){if(m instanceof Error&&m.name==="AbortError"){const x=new mi("cancelled","Request was cancelled.");return{data:Promise.reject(x),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(x)}}}}}}const g=Kw(0,null);return{data:Promise.reject(g),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(g)}}}}}}let c,u;const d=new Promise((m,g)=>{c=m,u=g});(s=r==null?void 0:r.signal)===null||s===void 0||s.addEventListener("abort",()=>{const m=new mi("cancelled","Request was cancelled.");u(m)});const h=l.body.getReader(),f=s_e(h,c,u,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const m=f.getReader();return{async next(){const{value:g,done:x}=await m.read();return{value:g,done:x}},async return(){return await m.cancel(),{done:!0,value:void 0}}}}},data:d}}function s_e(t,e,n,r){const s=(o,l)=>{const c=o.match(Kbe);if(!c)return;const u=c[1];try{const d=JSON.parse(u);if("result"in d){e(pf(d.result));return}if("message"in d){l.enqueue(pf(d.message));return}if("error"in d){const h=Kw(0,d);l.error(h),n(h);return}}catch(d){if(d instanceof mi){l.error(d),n(d);return}}},i=new TextDecoder;return new ReadableStream({start(o){let l="";return c();async function c(){if(r!=null&&r.aborted){const u=new mi("cancelled","Request was cancelled");return o.error(u),n(u),Promise.resolve()}try{const{value:u,done:d}=await t.read();if(d){l.trim()&&s(l.trim(),o),o.close();return}if(r!=null&&r.aborted){const f=new mi("cancelled","Request was cancelled");o.error(f),n(f),await t.cancel();return}l+=i.decode(u,{stream:!0});const h=l.split(`
`);l=h.pop()||"";for(const f of h)f.trim()&&s(f.trim(),o);return c()}catch(u){const d=u instanceof mi?u:Kw(0,null);o.error(d),n(d)}}},cancel(){return t.cancel()}})}const SL="@firebase/functions",CL="0.12.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_e="auth-internal",o_e="app-check-internal",a_e="messaging-internal";function l_e(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(i_e),o=n.getProvider(a_e),l=n.getProvider(o_e);return new Jbe(s,i,o,l,r)};Cc(new ol(bA,e,"PUBLIC").setMultipleInstances(!0)),mo(SL,CL,t),mo(SL,CL,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(t=wb(),e=HT){const r=Hg(Qn(t),bA).getImmediate({identifier:e}),s=aP("functions");return s&&c_e(r,...s),r}function c_e(t,e,n){Xbe(Qn(t),e,n)}function Qa(t,e,n){return Qbe(Qn(t),e,n)}l_e();function pc(t){return t?t.toLowerCase().replace(/\s+/g,"-"):""}const u_e={apiKey:"AIzaSyAI8iWuP1P20OZDIGsUNX6BluSCF40A7AU",authDomain:"freshfront-c3181.firebaseapp.com",projectId:"freshfront-c3181",storageBucket:"freshfront-c3181.firebasestorage.app",messagingSenderId:"925329325314",appId:"1:925329325314:web:67f69c02b9ff7580e6561b"},qb=vz(u_e),gp=Jye(qb),MG=p0e(qb),wh=$be(qb),Lh=Yw(qb);try{g0e(MG,{cacheSizeBytes:m0e}).then(()=>{console.log("Firestore offline persistence enabled.")}).catch(t=>{t.code=="failed-precondition"?console.warn("Firestore offline persistence failed: Multiple tabs open or other precondition failed.",t):t.code=="unimplemented"?console.warn("Firestore offline persistence failed: Browser does not support required features.",t):console.error("Firestore offline persistence failed with error: ",t)})}catch(t){console.error("Error enabling Firestore offline persistence: ",t)}const Nn=MG;async function qT(t){if(!t||typeof t!="string"||t.trim()==="")return!1;const e=t.trim().toLowerCase();try{const n=Ai(Nn,"stores"),r=zT(n,GT("name_lowercase","==",e),I0e(1));return!(await ki(r)).empty}catch(n){throw console.error("Error checking store name availability in Firestore:",n),new Error("Failed to check store name availability due to a database error.")}}const LG=p.createContext(),d_e=({children:t})=>{const[e,n]=p.useState(null),[r,s]=p.useState(null),[i,o]=p.useState(null),[l,c]=p.useState(!0),[u,d]=p.useState(null);p.useEffect(()=>{let g=()=>{};const x=Oge(gp,async w=>{if(c(!0),n(w),s(w),g(),w){const v=Ps(Nn,"profiles",w.uid);g=R0e(v,_=>{if(_.exists()){const C=_.data();o(C),d((C==null?void 0:C.role)||"store_owner"),console.log("AuthContext: Profile updated from snapshot:",C)}else console.warn("AuthContext: No profile found for user:",w.uid),o(null),d("store_owner");c(!1)},_=>{console.error("AuthContext: Error listening to profile:",_.message),o(null),d(null),c(!1)})}else o(null),d(null),c(!1)});return()=>{x(),g()}},[]);const m={user:e,session:r,profile:i,isAuthenticated:!!r&&!!e,userRole:u,loadingRole:l,logout:async()=>{try{await Vge(gp),console.log("User signed out successfully.")}catch(g){console.error("Error signing out: ",g)}},subscriptionStatus:"inactive"};return a.jsx(LG.Provider,{value:m,children:t})},eo=()=>{const t=p.useContext(LG);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},so=[{name:"Canvas",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Canvas.jpeg?alt=media&token=bfcade71-3242-4fc1-a623-1779f4b4773c",category:"Wall Art"},{name:"Hat",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Hat.jpeg?alt=media&token=e71e8dd0-2fc8-49ba-be13-98fd3909db3c",category:"Apparel"},{name:"Black hoodie",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Hoodie.jpeg?alt=media&token=90fee73f-96f5-4372-9f15-44e44403adca",category:"Apparel"},{name:"Mug",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Mug.png?alt=media&token=ff8dd2df-7dad-4ef7-8fa8-7867a6770dba",category:"Drinkware"},{name:"Notebook",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Notebook.jpeg?alt=media&token=807b6222-96ad-4179-a11a-16406c4b4509",category:"Stationery"},{name:"Pillow",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Pillow.webp?alt=media&token=50f5c317-8c39-4c48-b55c-d1da9216fa2e",category:"Home Decor"},{name:"Shirt",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Shirt.webp?alt=media&token=7c5f9b2f-6161-4a01-b9eb-1ae7813f3d6c",category:"Apparel"},{name:"Totebag",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Totebag.jpeg?alt=media&token=2d4dad9f-53d8-45b5-afce-5cef1a8e9f1c",category:"Accessories"},{name:"Travel mug",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Travelmug.jpeg?alt=media&token=312cd2d7-add0-4180-8872-355ec15ed00e",category:"Drinkware"},{name:"Blanket",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Bl.webp?alt=media&token=882cefc9-c725-40e7-a225-69f91d3ea2f6",category:"Home Decor"}],Jw=[{value:"fashion",label:"Fashion & Apparel"},{value:"electronics",label:"Electronics & Gadgets"},{value:"food",label:"Food & Beverage"},{value:"jewelry",label:"Jewelry & Accessories"},{value:"homedecor",label:"Home Decor & Furnishings"},{value:"beauty",label:"Beauty & Personal Care"},{value:"books",label:"Books & Media"},{value:"sports",label:"Sports & Outdoors"},{value:"toys",label:"Toys & Games"},{value:"art_collectibles",label:"Art & Collectibles"},{value:"general",label:"General Merchandise"}],_A=["fashion","quotes","personalized","print on demand","home decor","digital services","art/design","jewelry","collectibles","courses","books","garden","electronics","games","sports","productivity","toys","automotive","tools","marketing","content creation","ui/ux design","web/app development"],cg=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{const c=s.toDataURL("image/png").split(",")[1];e({base64ImageData:c,mimeType:"image/png"})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed, possibly due to CORS or tainted canvas."))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),h_e=t=>new Promise((e,n)=>{if(!t||!(t instanceof File))return n(new Error("Invalid file object provided."));const r=new FileReader;r.onload=()=>{const s=r.result;try{const i=s.split(",");if(i.length<2)throw new Error("Invalid data URL structure from FileReader.");const o=i[1];e({base64ImageData:o,mimeType:t.type})}catch(i){console.error("Error parsing data URL from FileReader:",s,i),n(new Error(`Invalid data URL format from FileReader: ${i.message}`))}},r.onerror=s=>{console.error("FileReader error:",s),n(new Error("Failed to read the file."))},r.readAsDataURL(t)}),f_e="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s";async function m_e(t){const e=new En({apiKey:f_e}),n={type:Ke.ARRAY,items:{type:Ke.STRING},description:"An array of relevant tags for the store."},r=`
    Given the following store data, please select the most relevant tags from the provided list.
    You can select multiple tags if they are relevant. If no tags are relevant, return an empty array.

    Store Name: ${t.name}
    Store Description: ${t.description}
    Store Niche: ${t.niche}

    Products:
    ${t.products.map(s=>`- ${s.name}: ${s.description}`).join(`
`)}

    Available Tags:
    ${_A.join(", ")}

    Return a JSON array of the selected tags.
  `;try{const s=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:r}]}],config:{responseMimeType:"application/json",responseSchema:n}}),i=s.text;if(typeof i!="string"||i.trim()==="")throw console.error("Model did not return a text response for tags. Response:",JSON.stringify(s)),new Error("Model response for tags was empty or not a string.");try{const o=JSON.parse(i);return Array.isArray(o)&&o.every(l=>typeof l=="string")?{tags:o}:(console.error("Parsed tags are not an array of strings:",o),{error:"AI response was not in the expected format (array of strings).",rawResponse:i})}catch(o){return console.error("Failed to parse JSON response for tags:",i,"ParseError:",o),{error:"Failed to parse tags from AI.",rawResponse:i}}}catch(s){return console.error("Error generating tags:",s),{error:`Error generating tags: ${s.message}`}}}const p_e="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s",g_e=[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE}],y_e=t=>{if(!t)return null;const e=t.split(",");if(e.length<2)return null;const n=e[0].match(/:(.*?);/);if(!n||n.length<2)return null;const r=n[1],s=atob(e[1]);let i=s.length;const o=new Uint8Array(i);for(;i--;)o[i]=s.charCodeAt(i);return new Blob([o],{type:r})};async function FG(t,e,n=null,r="image/png",s=[],i=(u,d)=>console.log(`ProductGen Progress: ${u}%, Message: ${d||""}`),o=0,l=5,c=""){if(!t||!e)throw new Error("Product type and store name are required to generate a product.");const u=new En({apiKey:p_e});let d=`You are an expert product creator for e-commerce stores.
Generate a product for a store named "${e}" that sells ${t}.
The overall theme and request for the store is: "${c}". Use this full prompt to ensure the product aligns well with the user's vision.

The product should include:
1. A catchy title.
2. A brief description (15-25 words).
3. A realistic price (e.g., 29.99, 45.00).
4. Relevant product options/variants (e.g., for a shirt: Size [S, M, L, XL], Color [White, Black, Blue]; for a shoe: Size [8, 9, 10], Color [Red, Grey]). Generate 1 to 2 variant types, each with 2 to 5 option values. If no variants are typically applicable for the product type, return an empty array for "variants".
5. A visually appealing product image.

Return the text details (title, description, price, variants) as a single JSON object in the text part of your response.
Your entire text response MUST be ONLY a valid JSON object. Do not include any other words, phrases, or conversational text before or after the JSON object.
The JSON object should strictly follow this format:
{
  "title": "Example Product Title",
  "description": "This is a fantastic example product, perfect for your needs and desires.",
  "price": "19.99",
  "variants": [
    { "name": "Size", "values": ["S", "M", "L", "XL"] },
    { "name": "Color", "values": ["White", "Black", "Blue"] }
  ]
}
Or, if no variants apply:
{
  "title": "Example Product Title",
  "description": "This is a fantastic example product, perfect for your needs and desires.",
  "price": "19.99",
  "variants": []
}


Generate an image for this product in the image part of your response.`,h=d;if(s&&s.length>0&&(h+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),n){let _=d;s&&s.length>0&&(_+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),n&&(_+=`

A logo image is also provided. Subtly incorporate this logo onto the product, its packaging, or in the scene if appropriate. For example, it could be a small brand mark on the item or a logo in the background if it's a lifestyle shot. Ensure the product remains the main focus.`),console.log(n?`[geminiProductGeneration Function] Generating product with logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`:`[geminiProductGeneration Function] Generating product without logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`)}else{let _=d;s&&s.length>0&&(_+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),console.log(`[geminiProductGeneration Function] Generating product without logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`)}let f=null,m=null,g="",x=0;const w=3;let v=[];for(;x<w;){x++,console.log(`[geminiProductGeneration Function] Attempt ${x} to generate content...`);const _=o+(x-1)/w*(l*.2);i(_,`Generating product (attempt ${x}/${w})...`);let C=d;s&&s.length>0&&(C+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),v.length>0&&(C+=`

ADDITIONALLY IMPORTANT: Avoid re-generating the following titles which were duplicates in previous attempts of THIS request: "${v.join('", "')}". Ensure the new title is truly novel and not similar to these.`),n&&(C+=`

A logo image is also provided. Subtly incorporate this logo onto the product, its packaging, or in the scene if appropriate. For example, it could be a small brand mark on the item or a logo in the background if it's a lifestyle shot. Ensure the product remains the main focus.`);const T=[{text:C}];if(n&&T.push({inlineData:{data:n,mimeType:r}}),x===1){const R=[...s,...v];console.log(`[geminiProductGeneration Function] Generating product for type: ${t}, store: ${e}. Initial exclusions (if any): ${R.join(", ")||"None"}. Logo: ${n?"Yes":"No"}`)}try{const R=await u.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:T,safetySettings:g_e,config:{responseModalities:[bn.TEXT,bn.IMAGE]}});f=null,m=null;let A="";if(R.candidates&&R.candidates.length>0&&R.candidates[0].content&&R.candidates[0].content.parts)for(const E of R.candidates[0].content.parts)if(E.text){A+=E.text;try{const I=E.text.trim();let P=null;const k=I.match(/```json\s*([\s\S]*?)\s*```/);if(k&&k[1])P=k[1],console.log(`[geminiProductGeneration Function] Attempt ${x}: Found JSON in markdown block.`);else{const j=I.indexOf("{"),D=I.lastIndexOf("}");j!==-1&&D>j&&(P=I.substring(j,D+1),console.log(`[geminiProductGeneration Function] Attempt ${x}: Extracted potential JSON between first '{' and last '}'.`))}P?(f=JSON.parse(P),console.log(`[geminiProductGeneration Function] Attempt ${x}: Successfully parsed JSON.`)):E.text&&(E.text.includes("{")||E.text.includes("}"))?console.warn(`[geminiProductGeneration Function] Attempt ${x}: Text part contained braces but simple extraction failed. Text:`,E.text):E.text&&console.warn(`[geminiProductGeneration Function] Attempt ${x}: No JSON structure (markdown or simple braces) found in text part:`,E.text)}catch(I){console.warn(`[geminiProductGeneration Function] Attempt ${x}: Error parsing JSON. Attempted to parse: "${typeof jsonStringToParse=="string"?jsonStringToParse:"[jsonStringToParse was not a string or was null]"}". Original text from part:`,E.text,"Error:",I.message),f=null}}else E.inlineData&&E.inlineData.data&&(m=E.inlineData.data,console.log(`[geminiProductGeneration Function] Attempt ${x}: Image data found.`));if(g+=(g?`
---
Attempt `+x+`:
`:"Attempt "+x+`:
`)+A,f&&f.title){const E=f.title.toLowerCase();i(o+l*.8,`Validating product details for "${f.title}"...`);const I=s.some(k=>k.toLowerCase()===E),P=v.some(k=>k.toLowerCase()===E);if(I||P)console.warn(`[geminiProductGeneration Function] Attempt ${x}: Generated title "${f.title}" is a duplicate. Adding to exclusion list for next attempt.`),v.push(f.title),f=null;else if(!f.price||typeof f.price!="string"&&typeof f.price!="number"||String(f.price).trim()==="")console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" is unique, but price is missing or invalid. Price:`,f.price),f=null;else if(!f.variants||!Array.isArray(f.variants))console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" is unique and price is valid, but variants are missing or not an array. Variants:`,f.variants),f=null;else for(const k of f.variants)if(!k.name||typeof k.name!="string"||!Array.isArray(k.values)||!k.values.every(j=>typeof j=="string")){console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" has malformed variant entry. Variant:`,k),f=null;break}}if(f&&f.title&&(f.price||f.price===0)&&f.variants&&m){console.log(`[geminiProductGeneration Function] Successfully generated complete and unique product data (including variants) on attempt ${x}.`);break}else m||console.warn(`[geminiProductGeneration Function] Attempt ${x} missing image data.`),f?(f.title||console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing title.`),!f.price&&f.price!==0&&console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing price.`),f.variants||console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing variants or variants malformed.`)):console.warn(`[geminiProductGeneration Function] Attempt ${x} missing text details (or title was duplicate/price missing/variants malformed).`)}catch(R){console.error(`[geminiProductGeneration Function] Error during attempt ${x}:`,R.message,R.stack),g+=(g?`
---
`:"")+`Attempt ${x} Error: ${R.message}`}x>=w&&(!f||!m)&&console.error(`[geminiProductGeneration Function] Exhausted ${w} attempts. Product generation failed.`)}if(!f||!m){let _=`Failed to generate complete and unique product data after ${w} attempts. `;throw f||(_+="Text details (or unique title) missing. "),m||(_+="Image data missing. "),console.error(_,"Accumulated raw text responses:",g),new Error(_+`Last raw text (if any): ${g}`)}if(typeof f.title!="string"||typeof f.description!="string"||typeof f.price!="string"&&typeof f.price!="number"||!Array.isArray(f.variants)||!f.variants.every(_=>typeof _.name=="string"&&Array.isArray(_.values)&&_.values.every(C=>typeof C=="string")))throw console.error("[geminiProductGeneration Function] Parsed product details are not in the expected format:",f),new Error("AI response for product details was not in the expected format (title, description, price, variants).");if(f.price=String(f.price),console.log("[geminiProductGeneration Function] Successfully generated product details (including variants) and image data."),m){const _=`data:image/png;base64,${m}`,C=y_e(_);if(C){const T=Dt(),A=`product_images_generated/${`${e.replace(/\s+/g,"_").toLowerCase()}_${f.title.replace(/\s+/g,"_").toLowerCase().substring(0,20)}_${T}.png`}`,E=vh(wh,A);try{i(o+l*.9,`Uploading image for "${f.title}"...`),await yh(E,C);const I=await xh(E);return console.log(`[geminiProductGeneration Function] Image uploaded to Firebase Storage: ${I}`),i(o+l,`Product "${f.title}" generated successfully.`),{...f,images:[I]}}catch(I){throw console.error("[geminiProductGeneration Function] Error uploading image to Firebase Storage:",I),new Error(`Failed to upload generated image to Firebase Storage: ${I.message}`)}}else throw console.error("[geminiProductGeneration Function] Failed to convert base64 image data to Blob."),new Error("Failed to process generated image data for upload.")}else return i(o+l,`Product "${f.title}" generated (no image).`),{...f,images:[]}}const x_e="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s",EL=new En({apiKey:x_e});async function OG(t,e,n,r=[],s=(l,c)=>console.log(`CollectionGen Progress: ${l}%, Message: ${c||""}`),i=0,o=5){const l=()=>null,c=n&&n.length>0?n.map(h=>`- ${h.name}: ${h.description||"No description."}`).filter(Boolean).join(`
`):"various items",u=r.length>0?`Do NOT use any of the following names: ${r.join(", ")}.`:"",d=`
    You are an AI assistant for an e-commerce store named "${e}" that sells "${t}".
    Based on the following products (name and description): 
${c}
Suggest a compelling and UNIQUE collection name and a short, engaging description (max 2 sentences) for a new collection.
    The collection should group related products or highlight a specific theme.
    ${u}
    Provide the output in a JSON format like this:
    {
      "name": "Collection Name",
      "description": "Collection Description",
      "product_names": ["Product Name 1", "Product Name 2"]
    }
    Ensure the collection name is concise, unique from the provided list (if any), and the description is appealing.
    The "product_names" array should contain a selection of 2 to 4 relevant product names from the provided product list that fit well within this new collection.
  `;s(i+o*.1,"Generating collection details...");try{const h=await EL.models.generateContent({model:"gemini-2.0-flash",contents:[{text:d}],config:{responseModalities:[bn.TEXT]}});let f="";if(h&&h.candidates&&h.candidates.length>0&&h.candidates[0].content&&h.candidates[0].content.parts&&h.candidates[0].content.parts.length>0)for(const _ of h.candidates[0].content.parts)_.text&&(f+=_.text);if(!f)return console.error("Gemini text generation did not return any text content. Full response:",h),console.warn("Returning fallback collection due to no text from AI."),l();let m;try{const _=f.match(/```json\n([\s\S]*?)\n```/);if(_&&_[1])m=JSON.parse(_[1]);else try{m=JSON.parse(f)}catch{console.warn("Failed to parse Gemini response as JSON directly, trying to extract from text:",f);const T=f.indexOf("{"),R=f.lastIndexOf("}");if(T!==-1&&R!==-1&&R>T){const A=f.substring(T,R+1);try{m=JSON.parse(A)}catch(E){throw console.error("Final attempt to parse extracted JSON failed:",A,E),E}}else throw new Error("No valid JSON structure found in response.")}}catch(_){return console.error("Failed to parse Gemini response as JSON:",f,_),console.warn("Returning fallback collection due to JSON parsing error."),l()}if(!m||!m.name||!m.description||!Array.isArray(m.product_names)||m.product_names.length===0)return console.error("AI did not return valid collection data (name, description, or non-empty product_names array):",m),console.warn("Returning fallback collection due to invalid/incomplete AI data."),s(i+o*.5,"Failed to get valid collection details."),l();s(i+o*.5,`Collection details "${m.name}" received.`);const g=_=>{if(typeof _!="string")return"";let C=_.toLowerCase();return C=C.replace(/\b(a|an|the)\b/g,""),C.endsWith("s")&&C.length>3&&(C=C.slice(0,-1)),C=C.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),C},x=[];m.product_names&&n&&m.product_names.forEach(_=>{const C=g(_);if(!C){console.warn(`AI product name "${_}" normalized to an empty string. Skipping.`);return}let T=null;T=n.find(R=>g(R.name)===C),T||(T=n.find(R=>{const A=g(R.name);return A.includes(C)||C.includes(A)})),T&&T.name?(x.push(T.name),console.log(`Matched AI product "${_}" (normalized: "${C}") to existing product "${T.name}" (using name as ID)`)):console.warn(`Product name "${_}" (normalized: "${C}") from AI response not found in provided product list or missing name after normalization and fallback search.`)});const w=`A vibrant and appealing e-commerce collection image for "${m.name}", described as "${m.description}", suitable for a store selling ${t}.`;let v=null;s(i+o*.6,`Generating image for collection "${m.name}"...`);try{const _=[{text:w}],C=await EL.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:_,config:{responseModalities:[bn.TEXT,bn.IMAGE]}});if(C&&C.candidates&&C.candidates.length>0&&C.candidates[0].content&&C.candidates[0].content.parts&&C.candidates[0].content.parts.length>0){for(const T of C.candidates[0].content.parts)if(T.inlineData&&T.inlineData.data){v=T.inlineData.data;break}}v?s(void 0,`Image generated for collection "${m.name}".`):(console.warn(`Gemini image generation did not return image data for collection: "${m.name}". Full Response:`,C),s(void 0,`Image generation failed for collection "${m.name}".`))}catch(_){console.error(`Error generating image for collection "${m.name}" with Gemini:`,_),s(void 0,`Error generating image for collection "${m.name}".`)}return s(i+o,`Collection "${m.name}" processing complete.`),{name:m.name,description:m.description,imageData:v,product_ids:x}}catch(h){return console.error("Error generating collection with Gemini:",h),console.warn("Returning fallback collection due to an unexpected error in generation process."),s(i+o,"Collection generation failed (unexpected error)."),l()}}const v_e="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s",VG=async t=>{var i,o;if(!t||t.length===0)return{error:"No images provided for analysis."};const e=new En({apiKey:v_e}),n=t.map(l=>{if(!l.base64||!l.mimeType)throw console.error("Image object is missing base64 or mimeType:",l.name),new Error(`Image ${l.name} is missing data for AI processing.`);return{inlineData:{data:l.base64.startsWith("data:")?l.base64.split(",")[1]:l.base64,mimeType:l.mimeType}}}),r=`
    Analyze the following product images (${t.map(l=>l.name).join(", ")}). 
    Based on these images, provide the following details for setting up an e-commerce store.
    Please format your response as a single, valid JSON object with the exact keys specified below.

    1.  "productType": A concise category or niche for these products (e.g., "Handcrafted Leather Goods", "Vintage Streetwear", "Artisanal Coffee Beans").
    2.  "storeNameSuggestions": An array of 3-5 creative and relevant store name suggestions.
    3.  "logoDescription": A brief description of a suitable logo concept (e.g., "A minimalist line art of a coffee bean with earthy tones").
    4.  "products": An array of objects, one for each uploaded image. For each product, analyze its specific image content to generate the following:
        *   "originalImageName": The filename of the original image (use the names provided in this prompt, e.g., "${((i=t[0])==null?void 0:i.name)||"example_image.jpg"}").
        *   "name": A catchy and descriptive product name directly inspired by the visual details in THIS specific image.
        *   "price": A suggested retail price for THIS specific product, considering its appearance and likely category (e.g., "29.99"). Ensure this is a string representing a number.
        *   "description": A compelling product description (2-3 sentences) highlighting key visual features and benefits of THIS specific product shown in its image.
    5.  "collections": An array of 3 distinct collection suggestions, each with:
        *   "name": Collection name (e.g., "New Arrivals", "Essentials", "Gifts Under $50").
        *   "description": A brief description for the collection.
    6.  "storePrompt": A short paragraph describing the overall style, feel, and target audience for a store selling these products. This will be used as a base for further AI generation of store content.

    Example for a single product in the "products" array:
    {
      "originalImageName": "${((o=t[0])==null?void 0:o.name)||"example_image.jpg"}",
      "name": "Rustic Leather Wallet",
      "price": "45.00",
      "description": "Hand-stitched full-grain leather wallet with a timeless design. Perfect for everyday carry, offering both style and durability."
    }
  `,s={type:Ke.OBJECT,properties:{productType:{type:Ke.STRING},storeNameSuggestions:{type:Ke.ARRAY,items:{type:Ke.STRING}},logoDescription:{type:Ke.STRING},products:{type:Ke.ARRAY,items:{type:Ke.OBJECT,properties:{originalImageName:{type:Ke.STRING},name:{type:Ke.STRING},price:{type:Ke.STRING},description:{type:Ke.STRING}},required:["originalImageName","name","price","description"]}},collections:{type:Ke.ARRAY,items:{type:Ke.OBJECT,properties:{name:{type:Ke.STRING},description:{type:Ke.STRING}},required:["name","description"]}},storePrompt:{type:Ke.STRING}},required:["productType","storeNameSuggestions","logoDescription","products","collections","storePrompt"]};try{console.log("[geminiImageUnderstanding] Sending prompt to Gemini with images:",t.map(h=>h.name));const l=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:r},...n]}],config:{responseMimeType:"application/json",responseSchema:s}});if(console.log("[geminiImageUnderstanding] Full API call response object:",JSON.stringify(l,null,2)),!l||typeof l.text!="string"){let h="Invalid or missing response from API.";return l&&l.promptFeedback&&l.promptFeedback.blockReason?(h=`Request blocked: ${l.promptFeedback.blockReason}. ${l.promptFeedback.blockReasonMessage||""}`,console.error(`[geminiImageUnderstanding] Request blocked. Reason: ${l.promptFeedback.blockReason}, Message: ${l.promptFeedback.blockReasonMessage}`)):l&&l.candidates&&l.candidates.length>0&&l.candidates[0].finishReason!=="STOP"&&l.candidates[0].finishReason!=="MODEL_SPECIFIED_STOP"?(h=`Generation stopped for reason: ${l.candidates[0].finishReason}.`,console.error(`[geminiImageUnderstanding] Generation stopped. Reason: ${l.candidates[0].finishReason}`)):console.error("[geminiImageUnderstanding] API response is invalid or text property is missing/not a string. Full response:",l),{error:`AI analysis failed: ${h}`}}const c=l.text;if(c.trim()==="")return console.error("[geminiImageUnderstanding] Model did not return a text response (empty string). Full API Response:",JSON.stringify(l)),{error:"AI analysis failed: Model response was empty or not text."};let u;try{u=JSON.parse(c)}catch(h){return console.error("[geminiImageUnderstanding] Failed to parse Gemini JSON response:",c,"ParseError:",h),{error:"AI analysis failed: Could not understand the response from Gemini (invalid JSON)."}}if(!u.productType||!Array.isArray(u.storeNameSuggestions)||!Array.isArray(u.products)||!Array.isArray(u.collections)||!u.storePrompt)return console.error("[geminiImageUnderstanding] Gemini response missing required fields or incorrect types:",u),{error:"AI analysis failed: The response from Gemini was incomplete or malformed."};const d=u.products.map(h=>{let f=[],m="Untitled Product (AI)",g="0.00",x="No description provided by AI.",w=null;if(h&&typeof h=="object")if(m=h.name||m,g=h.price||g,x=h.description||x,w=h.originalImageName||null,typeof h.originalImageName=="string"){const v=t.find(_=>_&&_.name===h.originalImageName);v&&typeof v.base64=="string"?f=[v.base64]:console.warn(`[geminiImageUnderstanding] Original image or its base64 not found for product with AI-provided originalImageName: "${h.originalImageName}". AI Product Name: "${h.name}"`)}else console.warn("[geminiImageUnderstanding] Product item from AI is missing 'originalImageName' string or is invalid:",h);else console.warn("[geminiImageUnderstanding] Invalid product item received from AI (not an object):",h);return{...h&&typeof h=="object"?h:{},name:m,price:g,description:x,originalImageName:w,images:f}});return{productType:u.productType,storeNameSuggestions:u.storeNameSuggestions,logoDescription:u.logoDescription,products:d,collections:u.collections,storePrompt:u.storePrompt,error:null}}catch(l){return console.error("[geminiImageUnderstanding] Error calling Gemini API or processing response:",l),{error:`AI analysis API call failed: ${l.message}`}}},$G=new En({apiKey:"AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s"}),w_e=async t=>{if(!t)throw new Error("URL is required for analysis.");try{const e=$G.getGenerativeModel({model:"gemini-1.5-flash-preview-0514",tools:[{urlContext:{}}]}),n=`
      Analyze the content of the provided URL and extract the following information:
      1.  **Primary Topic/Theme:** What is the main subject of the page? (e.g., "E-commerce site for handmade leather goods", "Blog about minimalist interior design").
      2.  **Brand/Store Name:** Identify the name of the brand or store.
      3.  **Key Products/Services:** List the main products or services offered.
      4.  **Target Audience:** Describe the likely target audience.
      5.  **Visual Style/Aesthetics:** Describe the visual design, color palette, and overall aesthetic of the website.
      6.  **Key Marketing Phrases/Slogans:** Extract any prominent marketing messages or slogans.

      URL: ${t}
    `;return(await(await e.generateContent({contents:[{role:"user",parts:[{text:n}]}]})).response).text()}catch(e){throw console.error(`Error analyzing URL ${t}:`,e),new Error(`Failed to analyze content for URL: ${t}.`)}},b_e=async t=>{if(!t||t.length===0)return"";try{const e=await Promise.all(t.map(o=>w_e(o)));if(e.length===1)return e[0];const n=$G.getGenerativeModel({model:"gemini-1.5-flash-preview-0514"}),r=`
      You have been provided with analyses from multiple URLs. Synthesize this information into a single, coherent summary. 
      Identify common themes, brand identity, product categories, and target audience. 
      If there are conflicting details, note them. The goal is to create a unified creative brief that can be used to generate a new online store.

      Analyses:
      ${e.join(`

---

`)}
    `;return(await(await n.generateContent({contents:[{role:"user",parts:[{text:r}]}]})).response).text()}catch(e){throw console.error("Error synthesizing URL analyses:",e),new Error("Failed to synthesize analyses from multiple URLs.")}},__e="2025-04",Kb=async(t,e,n,r={})=>{var l,c;if(!t||t==="your-shop-name.myshopify.com"||!e||e==="YOUR_SHOPIFY_STOREFRONT_ACCESS_TOKEN")throw new Error("Shopify domain or access token is not configured or is using placeholder values.");let s=t.trim().replace(/^(https?:\/\/)/,"").replace(/\/$/,"");s.includes(".")?!s.endsWith(".myshopify.com")&&s.includes("."):s=`${s}.myshopify.com`,s.includes(".")||(s=`${s}.myshopify.com`);let i=t.trim().replace(/^(https?:\/\/)/,"").replace(/\/$/,"");i.includes(".")||(i=`${i}.myshopify.com`);const o=`https://${i}/api/${__e}/graphql.json`;try{const u=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":e},body:JSON.stringify({query:n,variables:r})});if(!u.ok){let h;try{h=await u.json()}catch{}const f=((c=(l=h==null?void 0:h.errors)==null?void 0:l[0])==null?void 0:c.message)||`Shopify API request failed: ${u.status} ${u.statusText}`;throw console.error("Shopify API Error:",h||u.statusText),new Error(f)}const d=await u.json();if(d.errors)throw console.error("Shopify GraphQL Errors:",d.errors),new Error(d.errors.map(h=>h.message).join(", "));return d.data}catch(u){throw console.error("Error fetching from Shopify Storefront API:",u),u}},S_e=`
  query GetShopMetadata {
    shop {
      name
      description 
      primaryDomain {
        host
        url
      }
      brand {
        logo {
          image { # Reverted to use image field
            url
            altText
          }
        }
        squareLogo { # Added, assuming similar structure
          image {
            url
            altText # Assuming altText is available, can be removed if not
          }
        }
        coverImage {
          image { # Reverted to use image field
            url
            altText
          }
        }
        slogan
        shortDescription # Added
        colors {
          primary {
            background
            foreground
          }
          secondary {
            background
            foreground
          }
        }
      }
    }
  }
`,C_e=`
  query GetProducts($first: Int = 10, $cursor: String) {
    products(first: $first, after: $cursor) {
      edges {
        node {
          id
          title
          description # Changed from descriptionHtml
          handle
          tags
          images(first: 5) { # Changed from first: 1
            edges {
              node {
                url
                altText
              }
            }
          }
          variants(first: 5) { # Changed from first: 1
            edges {
              node {
                id # Added for variants
                title # Added for variants
                availableForSale # Added
                sku # Added from debug guide example
                price: priceV2 { # Changed from priceRange.minVariantPrice to priceV2, aliased to price
                    amount
                    currencyCode
                }
                image {
                   url
                   altText
                }
              }
            }
          }
        }
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
`,E_e=`
  query GetCollections($first: Int = 10, $cursor: String) {
    collections(first: $first, after: $cursor) {
      edges {
        node {
          id
          title
          description
          handle
          products(first: 5) { # Example: fetch first 5 products in each collection
            edges {
              node {
                id
                title
              }
            }
          }
        }
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
`,T_e=`
  query GetLocalizationInfo @inContext(country: "US") { # Defaulting to US, can be parameterized
    localization {
      availableCountries {
        isoCode
        name
        currency {
          isoCode
          name
          symbol
        }
      }
      availableLanguages {
        isoCode
        name
        endonymName
      }
    }
  }
`,gf=()=>["#3B82F6","#8B5CF6","#EC4899","#10B981","#F59E0B","#EF4444","#6366F1","#14B8A6","#F97316"][Math.floor(Math.random()*9)],SA=()=>["Inter","Roboto","Poppins","Montserrat","Open Sans"][Math.floor(Math.random()*5)],CA=()=>["grid","list"][Math.floor(Math.random()*2)],I_e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>{e({base64:r.result,mimeType:t.type,name:t.name})},r.onerror=s=>n(s)}),N_e=async(t,e,n,r,{fetchPexelsImages:s=lo,generateId:i=Dt}={})=>{const o=[],l={fashion:{min:20,max:200},electronics:{min:50,max:1300},food:{min:5,max:50},jewelry:{min:100,max:1e3},general:{min:10,max:300}},c=l[t]||l.general,u={fashion:["Classic Tee","Urban Jeans","Silk Scarf","Leather Boots","Summer Dress","Knit Sweater"],electronics:["HD Webcam","Noise-Cancelling Buds","Smart Display","Gaming Pad","Portable Drive","VR Headset"],food:["Artisan Bread","Gourmet Cheese","Organic Berries","Craft Coffee","Spiced Nuts","Dark Chocolate Bar"],jewelry:["Pearl Necklace","Sapphire Ring","Gold Hoops","Charm Bracelet","Silver Cufflinks","Diamond Studs"],general:["Utility Tool","Desk Organizer","Travel Mug","Yoga Mat","Scented Candle","Board Game"]},h=[...u[t]||u.general].sort(()=>.5-Math.random()).slice(0,e),f=h.map(g=>`${t} ${g} product shot`),m=await s(f.join(";"),e,"square");for(let g=0;g<e;g++){const x=h[g],w=m[g];let v;if(w&&w.src&&w.src.medium&&r)try{console.log(`[generateAIProductsData] Overlaying logo on Pexels image: ${w.src.medium}`),v=await overlayLogoOnProductImage(w.src.medium,r)}catch(_){console.error(`[generateAIProductsData] Failed to overlay logo on ${w.src.medium}, using original.`,_),v=w.src.medium}else w&&w.src&&w.src.medium?v=w.src.medium:v=`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(x)}`;o.push({id:`product-ai-${i()}`,name:x,price:parseFloat((Math.random()*(c.max-c.min)+c.min).toFixed(2)),description:Dse(t,x),rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,image:{id:w&&w.id||i(),src:{medium:v},alt:w&&w.alt||`Product image for ${x}`},storeName:n})}return o},P_e=async(t,{fetchPexelsImages:e=lo,generateId:n=Dt}={})=>{var T,R,A,E,I,P,k,j,D,M,G,B,W;const r=`store-wizard-${n()}`,{productType:s,storeName:i,logoUrl:o,products:l,prompt:c}=t;let u=[];(l.source==="ai"||l.source==="printOnDemand"||l.source==="manual")&&(u=l.items.map(Q=>({id:Q.id||`product-wizard-${n()}`,name:Q.name,price:parseFloat(Q.price)||0,description:Q.description||"",images:Q.images&&Q.images.length>0?Q.images:[`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(Q.name||"Product")}`],image:{id:n(),src:{medium:Q.images&&Q.images.length>0?Q.images[0]:`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(Q.name||"Product")}`},alt:Q.name||"Product Image"},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,isPrintOnDemand:Q.isPrintOnDemand||!1,podDetails:Q.podDetails||null,variants:Q.variants||[]})));const d=3,h=await e(`${s} ${i} hero slideshow ${c}`,d,"landscape"),f=h.length>0?h[0]:{src:{large:"https://via.placeholder.com/1200x800.png?text=Hero+Image"},alt:"Placeholder Hero Image"},m=await Oa(`${s} ${i} store ambiance ${c}`,1,"landscape"),g=await SI(s,i,c),x=await Oa(g.featuresVideoQuery,1,"landscape");g.featuresVideoUrl=((T=x[0])==null?void 0:T.url)||null;const w=await e(`${i} ${s} abstract background`,1,"landscape"),v=((A=(R=w[0])==null?void 0:R.src)==null?void 0:A.large)||((I=(E=w[0])==null?void 0:E.src)==null?void 0:I.original)||"",_="v1";let C={...g,heroSlideshowImages:h.map(Q=>({src:Q.src.large,alt:Q.alt||i+" hero image"})),...((P=t.content)==null?void 0:P.hero)&&{heroTitle:t.content.hero.heroTitle||g.heroTitle,heroDescription:t.content.hero.heroDescription||g.heroDescription},...((k=t.content)==null?void 0:k.storeWay)&&{storeWay:t.content.storeWay},imageRightSection:null,videoLeftSection:null};if(t.template_version==="sharp"){u.slice(0,3).map(V=>V.name).join(", ");const Q={name:i,niche:s,description:c||`A ${s} store called ${i}`},H=await c3(Q);if(H&&!H.error){const V=H.title||`${i} craftsmanship`,$=await e(V,1,"landscape");C.imageRightSection={...H,imageUrl:((D=(j=$[0])==null?void 0:j.src)==null?void 0:D.large)||"https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}}const Y=await u3(Q);if(Y&&!Y.error){const V=Y.title||`${i} product action`,$=await Oa(V,1,"landscape");C.videoLeftSection={...Y,videoUrl:((M=$[0])==null?void 0:M.url)||null,videoPosterUrl:((G=$[0])==null?void 0:G.image)||null}}}return{id:r,name:i,template_version:_,type:s,niche:s,description:C.heroDescription||g.heroDescription,prompt:c||`A ${s} store called ${i}`,products:u,collections:t.collections.items.map(Q=>({id:Q.id||`collection-wizard-${n()}`,name:Q.name,description:Q.description,imageUrl:Q.imageUrl,product_ids:Q.product_ids||[]})),hero_image:f,content:C,hero_video_url:((B=m[0])==null?void 0:B.url)||null,hero_video_poster_url:((W=m[0])==null?void 0:W.image)||null,logo_url:t.logoUrlDark||t.logoUrlLight||`https://via.placeholder.com/100x100.png?text=${i.substring(0,1)}`,logo_url_light:t.logoUrlLight||null,logo_url_dark:t.logoUrlDark||null,theme:{primaryColor:gf(),secondaryColor:gf(),fontFamily:SA(),layout:CA()},data_source:"wizard",card_background_url:v}},qS=async(t,{storeNameOverride:e=null,nicheDetails:n=null,isPrintOnDemand:r=!1,isDropshipping:s=!1,contextFiles:i=[],contextURLs:o=[],generateProducts:l=!0,fetchPexelsImages:c=lo,generateId:u=Dt}={},d=(h,f)=>{console.log(`Progress: ${h}%, Message: ${f||"(no message)"}`)})=>{var Ce,Pe,ve,de,Me,Ge,yt,Pt,en,fn,an,dn,Lt,xn;const h=(te,Ee)=>{typeof te=="number"&&!isNaN(te)?d(te,Ee):Ee&&d(void 0,Ee)};h(0,"Initializing store generation...");const f=`store-ai-${u()}`;let m=t,g=null,x=null;if(o&&o.length>0&&o.some(te=>te.trim()!=="")){h(2,"Analyzing context URLs...");try{const te=await b_e(o.filter(Ee=>Ee.trim()!==""));te?(m=`${t}

--- AI URL Analysis Context ---
${te}`,h(5,"URL analysis complete.")):h(5,"URL analysis did not return content.")}catch(te){console.error("[generateStoreFromPromptData] Error during URL analysis:",te),h(5,"URL analysis failed, continuing with prompt.")}}const w=i.filter(te=>te.type.startsWith("image/"));if(w.length>0){h(5,"Analyzing context images...");try{const te=w.map(I_e),Ee=await Promise.all(te);g=await VG(Ee),g&&!g.error?(console.log("[generateStoreFromPromptData] Image analysis successful:",g),h(10,"Image analysis complete."),m+=`

--- AI Image Analysis Context ---
${g.storePrompt}`,x=g.productType):(console.warn("[generateStoreFromPromptData] Image analysis failed or returned an error:",g==null?void 0:g.error),h(10,"Image analysis failed, continuing with prompt."))}catch(te){console.error("[generateStoreFromPromptData] Error during image analysis preparation:",te),h(10,"Image analysis failed, continuing with prompt.")}}const v=i.filter(te=>!te.type.startsWith("image/"));v.length>0&&(m+=`

--- Additional Context Files ---
`+v.map(te=>te.name).join(`
`));const _=m.toLowerCase().split(" ");let C="general";x?C=x:n&&n.name?C=n.name.toLowerCase().replace(/ /g,"-")||"general":_.some(te=>["clothing","fashion","apparel","wear"].includes(te))?C="fashion":_.some(te=>["tech","electronics","gadget","digital"].includes(te))?C="electronics":_.some(te=>["food","grocery","meal","organic"].includes(te))?C="food":_.some(te=>["jewelry","accessory","watch","luxury"].includes(te))&&(C="jewelry");let T=e,R=null;if(!T&&g&&g.storeNameSuggestions&&g.storeNameSuggestions.length>0&&(T=g.storeNameSuggestions[0],console.log(`[generateStoreFromPromptData] Using store name from image analysis: "${T}"`)),!T)try{R=await Ise(t),R&&(T=R,console.log(`[generateStoreFromPromptData] Extracted store name via Gemini Function Calling: "${T}" (Raw response: "${R}")`))}catch(te){console.error("[generateStoreFromPromptData] Error during Gemini function call for name extraction:",te)}if(!T)try{console.log(`[generateStoreFromPromptData] No name from override or function call. Attempting AI name suggestion using prompt: "${t}"`),h(void 0,"Suggesting store names...");const te=await bI(t);if(te&&te.suggestions&&te.suggestions.length>0)T=te.suggestions[0],console.log(`[generateStoreFromPromptData] AI generated store name: ${T}`);else{console.warn("[generateStoreFromPromptData] AI name generation yielded no suggestions. Falling back to heuristic.");const Ee=t.split(" ").filter(ee=>ee.charAt(0)===ee.charAt(0).toUpperCase()&&ee.length>2);Ee.length>0&&(T=Ee[0])}}catch(te){console.error("[generateStoreFromPromptData] Error during AI store name generation:",te);const Ee=t.split(" ").filter(ee=>ee.charAt(0)===ee.charAt(0).toUpperCase()&&ee.length>2);Ee.length>0&&(T=Ee[0])}T||(T=`${C.charAt(0).toUpperCase()+C.slice(1)} Emporium ${u().substring(0,4)}`,console.log(`[generateStoreFromPromptData] Using final fallback store name: ${T}`)),T&&T.length>50&&(T=T.substring(0,50));let A=null,E=null,I=null,P=`https://via.placeholder.com/100x100.png?text=${T.substring(0,1)}`;try{console.log(`[generateStoreFromPromptData] Generating logo for: ${T}`),h(10,`Generating logo for ${T}...`);const te=(g==null?void 0:g.logoDescription)||m,Ee=await Pg(te,h);if(Ee){E=Ee.logoUrlLight,I=Ee.logoUrlDark,I?P=I:E&&(P=E);const ee=E||I;if(ee&&ee.startsWith("data:image/")){const le=ee.split(",");le.length===2&&(A=le[1])}console.log(`[generateStoreFromPromptData] Logos generated for ${T}. Light: ${!!E}, Dark: ${!!I}`),d(20,`${T} logo generated.`)}else console.warn(`[generateStoreFromPromptData] Logo generation did not return expected result for ${T}.`),h(20,`Logo generation issue for ${T}.`)}catch(te){console.error(`[generateStoreFromPromptData] Error generating logo for ${T}:`,te),h(20,`Error generating logo for ${T}.`)}h(25,`Generating ${C} products...`);const k=[],j=[],D=25,M=45;if(l)if(g&&g.products&&g.products.length>0)console.log("[generateStoreFromPromptData] Using products from image analysis."),h(25,"Populating products from image analysis..."),g.products.forEach(te=>{k.push({id:`product-img-analysis-${u()}`,name:te.name,price:parseFloat(te.price)||0,description:te.description,images:te.images,image:{id:u(),src:{medium:te.images[0]},alt:te.name},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,variants:[]}),j.push(te.name.toLowerCase().trim())}),h(D+M,`${k.length} products populated from analysis.`);else{let ee=0;for(console.log(`[generateStoreFromPromptData] Attempting to generate 6 unique products for ${T} (type: ${C}).`);k.length<6&&ee<12;){ee++;const le=D+Math.floor(k.length/6*M);h(le,`Generating product ${k.length+1}/6...`);try{console.log(`[generateStoreFromPromptData] Generating product attempt ${ee} (aiming for ${k.length+1}/6 unique products)... Excluding titles: ${j.join(", ")}`);const K=await FG(C,T,A,"image/png",j,h,le,M/6,m);if(K&&K.images&&K.images.length>0&&K.title&&K.title.trim()!==""&&typeof K.price=="string"&&typeof K.description=="string"){const Ae=K.title.toLowerCase().trim();if(j.includes(Ae))console.warn(`[generateStoreFromPromptData] Duplicate product title generated and skipped: "${K.title}". Attempt ${ee}/12.`);else{let Ne=K.variants||[];if(C==="fashion"){const Oe=Ne.some(ce=>ce.name.toLowerCase()==="size"),He=Ne.some(ce=>ce.name.toLowerCase()==="color");Oe||Ne.push({name:"Size",values:["S","M","L","XL"]}),He||Ne.push({name:"Color",values:["White","Black","Blue","Red"]})}k.push({id:`product-gemini-${u()}`,name:K.title,price:parseFloat(K.price)||0,description:K.description,images:K.images,image:{id:u(),src:{medium:K.images[0]},alt:K.title},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,variants:Ne}),j.push(Ae),console.log(`[generateStoreFromPromptData] Product "${K.title}" generated successfully and is unique. (${k.length}/6)`),h(D+Math.floor(k.length/6*M),`Product "${K.title}" generated.`)}}else console.warn(`[generateStoreFromPromptData] Failed to generate complete data (or image) for product attempt ${ee}. Data:`,K)}catch(K){console.error(`[generateStoreFromPromptData] Error during product generation attempt ${ee}:`,K)}}h(D+M,`${k.length} products generated.`),k.length<6&&console.warn(`[generateStoreFromPromptData] Could only generate ${k.length} unique products after 12 total attempts.`),k.length===0&&6>0&&console.warn("[generateStoreFromPromptData] No products were generated successfully. The store will be created with an empty product list.")}const G=3,B=await c(`${C} ${T} hero slideshow ${t}`,G,"landscape"),W=B.length>0?B[0]:{src:{large:"https://via.placeholder.com/1200x800.png?text=Hero+Image"},alt:"Placeholder Hero Image"},H=(await d3({name:T,niche:C,description:m})).query||`${C} ${T} store ambiance ${t}`,Y=await Oa(H,1,"landscape"),V=await Oa(`${T} ${C} product showcase`,1,"landscape");await Oa(`${T} ${C} craftsmanship process`,1,"landscape");const $={name:T,niche:C,description:m},z=await a3($),F=await l3($),Z=await _I($),fe=await SI(C,T,m),xe=await c(`${T} ${C} store background`,1,"landscape"),ge=((Pe=(Ce=xe[0])==null?void 0:Ce.src)==null?void 0:Pe.large)||((de=(ve=xe[0])==null?void 0:ve.src)==null?void 0:de.original)||"";let Re="fresh";if(n&&n.templates&&n.templates.length>0){const te=n.templates.some(Ee=>Ee.toLowerCase()==="sharp");if(C==="technology"&&te)Re="sharp";else{const Ee=n.templates[0].toLowerCase();["classic","modern","v1"].includes(Ee)?Re="v1":Ee==="premium"?Re="premium":Ee==="sharp"?Re="sharp":Ee==="sleek"&&(Re="sleek")}}else t.toLowerCase().includes("modern")?Re="v1":t.toLowerCase().includes("premium")?Re="premium":t.toLowerCase().includes("sharp")?Re="sharp":t.toLowerCase().includes("sleek")&&(Re="sleek");Re==="modern"&&(Re="v1");let Ue={url:null,poster:null};if(Re==="v2"){const te=await Oa(`${T} ${C} customer experience why choose us`,1,"landscape");Ue.url=((Me=te[0])==null?void 0:Me.url)||null,Ue.poster=((Ge=te[0])==null?void 0:Ge.image)||null}const ze=[];h(95,"Loading storefront...");let he={id:f,name:T,template_version:Re,type:C,niche:C,description:z&&!z.error?z.heroDescription:fe.heroDescription,prompt:m,products:k,collections:ze,hero_image:W,hero_video_url:((yt=Y[0])==null?void 0:yt.url)||null,hero_video_poster_url:((Pt=Y[0])==null?void 0:Pt.image)||null,logo_url:P,logo_url_light:E,logo_url_dark:I,theme:{primaryColor:(n==null?void 0:n.primaryColor)||(await m2($)).primaryColor||gf(),secondaryColor:(n==null?void 0:n.secondaryColor)||(await m2($)).secondaryColor||gf(),fontFamily:SA(),layout:CA()},content:{...fe,...z&&!z.error&&{heroTitle:z.heroTitle||fe.heroTitle,heroDescription:z.heroDescription||fe.heroDescription},...F&&!F.error&&{storeWay:F},...Z&&!Z.error&&{storeFeatures:Z},heroSlideshowImages:B.map(te=>({src:te.src.large,alt:te.alt||T+" hero image"})),imageRightSection:null,videoLeftSection:null},data_source:"ai",card_background_url:ge};if(Re==="sharp"){k.slice(0,3).map(ee=>ee.name).join(", ");const te=await c3($);if(te&&!te.error){const ee=te.title||`${T} craftsmanship`,le=await c(ee,1,"landscape");he.content.imageRightSection={...te,imageUrl:((fn=(en=le[0])==null?void 0:en.src)==null?void 0:fn.large)||"https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}}const Ee=await u3($);if(Ee&&!Ee.error){const ee=Ee.title||`${T} product action`,le=await Oa(ee,1,"landscape");he.content.videoLeftSection={...Ee,videoUrl:((an=le[0])==null?void 0:an.url)||null,videoPosterUrl:((dn=le[0])==null?void 0:dn.image)||null}}he.content.heroFollowUpVideoUrl=((Lt=V[0])==null?void 0:Lt.url)||null,he.content.heroFollowUpVideoPosterUrl=((xn=V[0])==null?void 0:xn.image)||null}else Re==="fresh"&&(he.content.featuresVideoUrl=Ue.url,he.content.featuresVideoPosterUrl=Ue.poster);return Re!=="sharp"&&(he.content.heroFollowUpVideoUrl=null,he.content.heroFollowUpVideoPosterUrl=null),Re!=="fresh"&&(he.content.featuresVideoUrl=null,he.content.featuresVideoPosterUrl=null),he},KS=async(t,e,n,r,s,i,o,l,c)=>{var d,h;const u=[];if(n.length>0){const f=r||s?3:2,m=[],g=f*2;let x=0;for(i(o,"Generating collections for products..."),console.log(`[generateCollectionsForProducts] Attempting to generate ${f} collections for ${e}.`);u.length<f&&x<g;){x++;const w=o+Math.floor((u.length+1)/f*l);i(w,`Generating collection ${u.length+1}/${f} (Attempt ${x})...`);try{const v=await OG(t,e,n,m,i,w,l/f);if(v&&!v.error&&v.name){let _="";if(v.imageData)_=`data:image/png;base64,${v.imageData}`;else{const C=`${v.name} ${t} collection banner`;_=((h=(d=(await lo(C,1,"landscape"))[0])==null?void 0:d.src)==null?void 0:h.large)||`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(v.name||"Collection")}`}u.push({id:`collection-gemini-${c()}`,name:v.name,description:v.description,imageUrl:_,product_ids:v.product_ids||[]}),m.push(v.name),i(w,`Collection "${v.name}" generated.`)}else console.warn(v===null?`[generateCollectionsForProducts] Collection generation returned null (fallback prevented), attempt ${x}.`:`[generateCollectionsForProducts] Failed to generate complete data for collection attempt ${x}. Error: ${v==null?void 0:v.error}`)}catch(v){console.error(`[generateCollectionsForProducts] Error during collection generation attempt ${x}:`,v)}}i(o+l,`${u.length} collections generated.`)}else console.warn(`[generateCollectionsForProducts] Skipping collection generation as no products were provided for ${e}.`),i(o+l,"Skipped collection generation (no products).");return u},A_e=async(t,e)=>(await Kb(t,e,S_e)).shop,k_e=async(t,e,n=10,r=null)=>(await Kb(t,e,E_e,{first:n,cursor:r})).collections,R_e=async(t,e,n=10,r=null)=>(await Kb(t,e,C_e,{first:n,cursor:r})).products,j_e=async(t,e,n="US",r="EN")=>(await Kb(t,e,T_e,{})).localization,D_e=async(t,e,n,{generateId:r=Dt}={},s=null)=>{var h,f,m,g,x,w,v,_,C,T,R;console.log("Mapping BigCommerce Data:",{bcStoreSettings:t,bcProducts:e,domain:n,generatedLogoDataUrl:s});const i=e.map(A=>{var E,I,P,k,j,D,M;return{id:((E=A.entityId)==null?void 0:E.toString())||`bc-product-${r()}`,name:A.name||"Unnamed Product",description:A.description||`Product: ${A.name||"Unnamed Product"}`,price:parseFloat(((P=(I=A.prices)==null?void 0:I.price)==null?void 0:P.value)||0),currencyCode:((j=(k=A.prices)==null?void 0:k.price)==null?void 0:j.currencyCode)||"USD",image:{id:`bc-img-${r()}`,src:{medium:((D=A.defaultImage)==null?void 0:D.url)||`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(A.name||"Product")}`},alt:((M=A.defaultImage)==null?void 0:M.altText)||A.name||"Product Image"},sku:A.sku||"",rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*100)+10}}),o=s||((f=(h=t.logo)==null?void 0:h.image)==null?void 0:f.url)||`https://via.placeholder.com/100x100.png?text=${(t.storeName||"S").substring(0,1)}`,l=await SI("general",t.storeName||"My BigCommerce Store",t.description),c=await Oa(l.featuresVideoQuery,1,"landscape");l.featuresVideoUrl=((m=c[0])==null?void 0:m.url)||null;const u=await lo(`${t.storeName||"store"} background`,1,"landscape"),d=((x=(g=u[0])==null?void 0:g.src)==null?void 0:x.large)||((v=(w=u[0])==null?void 0:w.src)==null?void 0:v.original)||"";return{id:`store-bc-${(t.storeHash||n).replace(/[\.\/\:]/g,"-")}-${r()}`,name:t.storeName||"My BigCommerce Store",type:"bigcommerce-imported",description:t.description||`Store imported from ${n}`||l.heroDescription,products:i,hero_image:{id:r(),src:{large:((C=(_=t.logo)==null?void 0:_.image)==null?void 0:C.url)||`https://via.placeholder.com/1200x800.png?text=${encodeURIComponent(t.storeName||"Store")}`},alt:((R=(T=t.logo)==null?void 0:T.image)==null?void 0:R.altText)||t.storeName||"Store Hero"},logo_url:o,theme:{primaryColor:gf(),secondaryColor:gf(),fontFamily:SA(),layout:CA()},content:{...l,heroTitle:`Welcome to ${t.storeName||"Our Store"}`,heroDescription:t.description||l.heroDescription},data_source:"bigcommerce",card_background_url:d}};async function M_e(t,e){const n=`
    query StoreSettings {
      site {
        settings {
          storeName
          storeHash
          status
          logo {
            title
            image {
              url(width: 500)
              altText
            }
          }
        }
      }
    }
  `;if(typeof t!="string"||!t.trim()){const i=new TypeError("Invalid or empty storeDomain provided to fetchStoreSettings.");throw console.error(i.message,{storeDomain:t}),i}if(typeof e!="string"||!e.trim()){const i=new TypeError("Invalid or empty token provided to fetchStoreSettings.");throw console.error(i.message,{tokenProvided:typeof e=="string"&&e.length>0?"Yes":"No"}),i}const r=`https://${t}/graphql`,s={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:n})};console.log(`[fetchStoreSettings] Attempting to fetch: ${r}`,{domain:t,tokenProvided:!!e,queryLength:n.length});try{let i;try{i=await fetch(r,s)}catch(l){console.error(`[fetchStoreSettings] Initial fetch to ${r} failed:`,l);let c=`Initial fetch to ${r} failed.`;throw l.name==="TypeError"?c+=` This is often due to a CORS misconfiguration (check 'allowed_cors_origins' for your BigCommerce Storefront API token), a DNS issue, or the server not being reachable. Please check the browser's Network DevTools for more specific error messages. Original error: ${l.message}`:c+=` Error: ${l.message||"Unknown network error"}`,new Error(c)}if(console.log(`[fetchStoreSettings] Response from ${r} - Status: ${i.status}, Complexity: ${i.headers.get("X-Bc-GraphQL-Complexity")}`),!i.ok){let l=`Could not retrieve error body (status: ${i.status}).`;try{l=await i.text()}catch(c){console.warn("Failed to read error response body:",c)}throw new Error(`HTTP error ${i.status} for ${r}: ${l}`)}let o;try{o=await i.json()}catch(l){let c="Could not retrieve raw response text after JSON parse failure.";try{c=await(await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:n})})).text()}catch(u){console.warn("Failed to re-fetch for raw text:",u)}throw console.error("Failed to parse JSON response from BigCommerce.",l,{graphqlUrl:r,rawTextPreview:c.substring(0,500)}),new Error(`Failed to parse JSON response from ${r}. Preview: ${c.substring(0,200)}...`)}if(o.errors)throw console.error("BigCommerce GraphQL errors (fetchStoreSettings):",o.errors,{graphqlUrl:r}),new Error(`GraphQL error: ${o.errors.map(l=>l.message).join(", ")}`);if(!o.data||!o.data.site||!o.data.site.settings)throw console.error("Invalid data structure in BigCommerce response (fetchStoreSettings):",o.data,{graphqlUrl:r}),new Error("Invalid data structure received from BigCommerce API for store settings.");return o.data.site.settings}catch(i){throw i.message.startsWith("Invalid or empty storeDomain")||i.message.startsWith("Invalid or empty token")||i.message.startsWith("HTTP error")||i.message.startsWith("GraphQL error")||i.message.startsWith("Failed to parse JSON")||i.message.startsWith("Network error")||console.error(`[fetchStoreSettings] Unexpected error for ${r}:`,i.name,i.message,i.stack,i),i}}async function TL(t,e){var l,c;let n=[],r=null,s=!0;if(typeof t!="string"||!t.trim()){const u=new TypeError("Invalid or empty storeDomain provided to fetchAllProducts.");throw console.error(u.message,{storeDomain:t}),u}if(typeof e!="string"||!e.trim()){const u=new TypeError("Invalid or empty token provided to fetchAllProducts.");throw console.error(u.message,{tokenProvided:typeof e=="string"&&e.length>0?"Yes":"No"}),u}const i=`https://${t}/graphql`,o=`
    query ProductsPage($first: Int!, $after: String) {
      site {
        products(first: $first, after: $after) {
          pageInfo {
            hasNextPage
            endCursor
          }
          edges {
            node {
              entityId
              name
              sku
              defaultImage {
                url(width: 800)
                altText
              }
              prices {
                price { value currencyCode }
                retailPrice { value currencyCode }
              }
            }
          }
        }
      }
    }
  `;console.log(`[fetchAllProducts] Starting to fetch products from: ${i}`,{domain:t,tokenProvided:!!e});try{let u=1;for(;s;){const d={first:50,after:r},h={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:o,variables:d})};let f;try{f=await fetch(i,h)}catch(x){console.error(`[fetchAllProducts] Initial fetch (Page ${u}) to ${i} failed:`,x);let w=`Initial fetch (Page ${u}) to ${i} failed.`;throw x.name==="TypeError"?w+=` This is often due to a CORS misconfiguration (check 'allowed_cors_origins' for your BigCommerce Storefront API token), a DNS issue, or the server not being reachable. Please check the browser's Network DevTools for more specific error messages. Original error: ${x.message}`:w+=` Error: ${x.message||"Unknown network error"}`,new Error(w)}if(console.log(`[fetchAllProducts] Response (Page ${u}) from ${i} - Status: ${f.status}, Complexity: ${f.headers.get("X-Bc-GraphQL-Complexity")}`),u++,!f.ok){let x=`Could not retrieve error body (status: ${f.status}).`;try{x=await f.text()}catch(w){console.warn("[fetchAllProducts] Failed to read error response body:",w)}throw new Error(`HTTP error ${f.status} for ${i} (products): ${x}`)}let m;try{m=await f.json()}catch(x){let w="Could not retrieve raw response text after JSON parse failure (fetchAllProducts).";try{w=await(await fetch(i,h)).text()}catch{}throw console.error("[fetchAllProducts] Failed to parse JSON response from BigCommerce.",x,{graphqlUrl:i,rawTextPreview:w.substring(0,500)}),new Error(`Failed to parse JSON response from ${i} (products). Preview: ${w.substring(0,200)}...`)}if(m.errors)throw console.error("[fetchAllProducts] BigCommerce GraphQL errors:",m.errors,{graphqlUrl:i}),new Error(`GraphQL error (products): ${m.errors.map(x=>x.message).join(", ")}`);const g=(c=(l=m.data)==null?void 0:l.site)==null?void 0:c.products;if(!g||!g.edges||!g.pageInfo)throw console.error("[fetchAllProducts] Invalid data structure in BigCommerce response:",m.data,{graphqlUrl:i}),new Error("Invalid data structure received from BigCommerce API for products.");g.edges.forEach(x=>n.push(x.node)),s=g.pageInfo.hasNextPage,r=g.pageInfo.endCursor}return n}catch(u){throw u.message.startsWith("Invalid or empty storeDomain")||u.message.startsWith("Invalid or empty token")||u.message.startsWith("HTTP error")||u.message.startsWith("GraphQL error")||u.message.startsWith("Failed to parse JSON")||u.message.startsWith("Network error")||console.error(`[fetchAllProducts] Unexpected error for ${i}:`,u.name,u.message,u.stack,u),u}}const Je=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:Ct("rounded-xl border bg-card text-card-foreground shadow-sm",t),...e}));Je.displayName="Card";const ct=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:Ct("flex flex-col space-y-1.5 p-6",t),...e}));ct.displayName="CardHeader";const ut=ht.forwardRef(({className:t,...e},n)=>a.jsx("h3",{ref:n,className:Ct("text-2xl font-semibold leading-none tracking-tight",t),...e}));ut.displayName="CardTitle";const Qt=ht.forwardRef(({className:t,...e},n)=>a.jsx("p",{ref:n,className:Ct("text-sm text-muted-foreground",t),...e}));Qt.displayName="CardDescription";const it=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:Ct("p-6 pt-0",t),...e}));it.displayName="CardContent";const yd=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:Ct("flex items-center p-6 pt-0",t),...e}));yd.displayName="CardFooter";const L_e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),F_e=({isOpen:t,onClose:e,products:n,onFinalize:r})=>{const[s,i]=p.useState([]),[o,l]=p.useState(!1),[c,u]=p.useState({}),[d,h]=p.useState({}),[f,m]=p.useState(null),[g,x]=p.useState(!1),{toast:w}=bs(),{generatePodCollectionFromDesign:v,addPendingPodCollectionData:_,isGeneratingPodCollection:C,currentStore:T,isGenerating:R}=zn();p.useEffect(()=>{n&&i(n.map($=>{var F,Z,fe;let z=[];if(Array.isArray($.images)?z=[...$.images]:(Z=(F=$.image)==null?void 0:F.src)!=null&&Z.medium&&(z=[$.image.src.medium]),$.isPrintOnDemand&&((fe=$.podDetails)!=null&&fe.originalDesignImageUrl)){const xe=z.findIndex(ge=>ge!==$.podDetails.originalDesignImageUrl);if(xe>0){const ge=z.splice(xe,1)[0];z.unshift(ge)}}return{...$,images:z,variants:Array.isArray($.variants)?$.variants.map(xe=>({...xe,values:Array.isArray(xe.values)?[...xe.values]:[]})):[]}}))},[n]);const A=($,z,F)=>{i(Z=>{const fe=[...Z];return fe[$]={...fe[$],[z]:F},fe})},E=async($,z)=>{if(z)try{const F=await L_e(z);i(Z=>{const fe=[...Z],xe=Array.isArray(fe[$].images)?fe[$].images:[];return fe[$].images=[...xe,F],fe})}catch(F){console.error("Error converting file to base64:",F),w({title:"Image Upload Error",description:"Could not process image.",variant:"destructive"})}},I=($,z)=>{i(F=>{const Z=[...F];return Z[$].images=Z[$].images.filter((fe,xe)=>xe!==z),Z})},P=async $=>{w({title:"Image Generation",description:"AI Image generation for this product is not yet implemented in this modal."}),console.log("Attempting to generate image for product at index:",$,s[$].name)},k=async $=>{const z=s[$];if(!z||!z.name){w({title:"Missing Product Info",description:"Product name is required to generate visuals.",variant:"destructive"});return}const F=z.images&&z.images.length>0?z.images[0]:null;if(!F){w({title:"Missing Base Image",description:"At least one image is required to generate more visuals.",variant:"destructive"});return}u(Z=>({...Z,[$]:!0}));try{const{base64ImageData:Z,mimeType:fe}=await cg(F),xe=z.name;let ge=[];try{const Ue=await W0(Z,fe,xe);Ue&&Ue.length>0&&ge.push(...Ue.slice(0,2)),w({title:"Angles Generated",description:`${Math.min(2,(Ue==null?void 0:Ue.length)||0)} angle images generated.`,variant:"success"})}catch(Ue){console.error("Error generating angles:",Ue),w({title:"Angle Generation Failed",description:Ue.message,variant:"destructive"})}const Re=[`Place this product, "${xe}", in a realistic home setting where it might be used or displayed. Focus on a natural context.`,`Show this product, "${xe}", in an outdoor lifestyle setting, highlighting its use case or appeal.`];for(const Ue of Re)try{const ze=await Wo(Z,fe,Ue);ze&&ze.editedImageData&&ge.push(`data:${ze.newMimeType};base64,${ze.editedImageData}`)}catch(ze){console.error(`Error generating context image with prompt "${Ue}":`,ze),w({title:"Context Image Failed",description:`Failed for: ${Ue.substring(0,30)}...`,variant:"destructive"})}w({title:"Context Images Attempted",description:`Attempted to generate ${Re.length} context images.`,variant:"success"}),ge.length>0?i(Ue=>{const ze=[...Ue],he=ze[$],Ce=Array.isArray(he.images)?he.images:[],Pe=new Set(Ce),ve=ge.filter(de=>!Pe.has(de));return ve.length>0?(he.images=[...Ce,...ve],w({title:"Visuals Added",description:`${ve.length} new images added.`,variant:"success"})):w({title:"Visuals Generated",description:"Generated images were already present.",variant:"default"}),ze}):w({title:"No New Visuals",description:"Could not generate additional visuals.",variant:"default"})}catch(Z){console.error("Error in handleGenerateMoreVisuals:",Z),w({title:"Visual Generation Error",description:Z.message,variant:"destructive"})}finally{u(Z=>({...Z,[$]:!1}))}},j=($,z,F)=>{i(Z=>{const fe=[...Z],xe={...fe[$]};return xe.variants=[...xe.variants||[]],xe.variants[z]={...xe.variants[z],name:F},fe[$]=xe,fe})},D=($,z,F,Z)=>{i(fe=>{const xe=[...fe],ge={...xe[$]};ge.variants=[...ge.variants||[]];const Re={...ge.variants[z]};return Re.values=[...Re.values||[]],Re.values[F]=Z,ge.variants[z]=Re,xe[$]=ge,xe})},M=($,z)=>{i(F=>{const Z=[...F],fe={...Z[$]};fe.variants=[...fe.variants||[]];const xe={...fe.variants[z]};return xe.values=[...xe.values||[],""],fe.variants[z]=xe,Z[$]=fe,Z})},G=($,z,F)=>{i(Z=>{const fe=[...Z],xe={...fe[$]};xe.variants=[...xe.variants||[]];const ge={...xe.variants[z]};return ge.values=(ge.values||[]).filter((Re,Ue)=>Ue!==F),xe.variants[z]=ge,fe[$]=xe,fe})},B=$=>{i(z=>{const F=[...z],Z={...F[$]};return Z.variants=[...Z.variants||[],{name:"",values:[""]}],F[$]=Z,F})},W=($,z)=>{i(F=>{const Z=[...F],fe={...Z[$]};return fe.variants=(fe.variants||[]).filter((xe,ge)=>ge!==z),Z[$]=fe,Z})},Q=()=>{if(!s.every(z=>z.name&&z.name.trim()!==""&&(z.price||z.price===0)&&String(z.price).trim()!=="")){w({title:"Missing Information",description:"Please ensure all products have a name and a valid price.",variant:"destructive"});return}r(s)},H=$=>{m($),x(!0)},Y=async $=>{var ge;const z=s[$];if(!z||!((ge=z.podDetails)!=null&&ge.originalDesignImageUrl)){w({title:"Error",description:"Product details or original design image missing for POD collection.",variant:"destructive"});return}const F=z.podDetails.originalDesignImageUrl,Z=z.podDetails.designPrompt||`Design based on ${z.name}`,fe=z.podDetails.baseProductName||z.name,xe=await v(F,Z,fe);xe&&xe.newProducts&&xe.newCollection?_({newProducts:xe.newProducts,newCollection:xe.newCollection}):console.error("POD Collection generation in modal failed or returned no data.")},V=async $=>{const z=s[$];if(!z||!z.name){w({title:"Missing Product Name",description:"Product name is required to generate a description.",variant:"destructive"});return}h(F=>({...F,[$]:!0}));try{const F={name:T==null?void 0:T.name,niche:T==null?void 0:T.niche,targetAudience:T==null?void 0:T.targetAudience,style:T==null?void 0:T.style},Z=await Nse(z,F);if(Z.description)A($,"description",Z.description),w({title:"Description Generated",description:"The product description has been updated.",variant:"success"});else throw new Error(Z.error||"Failed to generate description.")}catch(F){console.error("Error generating product description:",F),w({title:"Description Generation Failed",description:F.message,variant:"destructive"})}finally{h(F=>({...F,[$]:!1}))}};return t?a.jsxs(a.Fragment,{children:[a.jsx(Xr,{open:t,onOpenChange:$=>!$&&e(),children:a.jsxs(Ur,{className:"max-w-3xl",children:[a.jsxs(Br,{children:[a.jsx(zr,{children:"Finalize Your Products"}),a.jsx(Zi,{children:"Review and edit the AI-generated products before creating your store."})]}),a.jsx(xs,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"space-y-6 pr-4",children:s.map(($,z)=>{var F;return a.jsxs(Je,{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:`productName-${z}`,children:"Product Name"}),a.jsx(Ye,{id:`productName-${z}`,value:$.name,onChange:Z=>A(z,"name",Z.target.value),placeholder:"Product Name"})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:`productPrice-${z}`,children:"Price (USD)"}),a.jsx(Ye,{id:`productPrice-${z}`,type:"number",value:$.price,onChange:Z=>A(z,"price",Z.target.value),placeholder:"0.00"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(De,{htmlFor:`productDescription-${z}`,children:"Description"}),a.jsx(Pn,{id:`productDescription-${z}`,value:$.description,onChange:Z=>A(z,"description",Z.target.value),placeholder:"Product Description",rows:3}),$.isDropshipping&&a.jsxs(O,{type:"button",variant:"outline",size:"sm",className:"absolute bottom-2 right-2 text-xs h-7",onClick:()=>V(z),disabled:d[z]||!$.name,children:[d[z]?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate"]})]}),a.jsxs("div",{className:"space-y-2 mb-[3px]",children:[a.jsx(De,{children:"Product Images"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:($.images||[]).map((Z,fe)=>a.jsxs("div",{className:"relative group w-24 h-24 cursor-pointer",onClick:()=>H(Z),children:[a.jsx("img",{src:Z,alt:`Product ${z+1} image ${fe+1}`,className:"w-full h-full object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>I(z,fe),children:a.jsx(Wn,{className:"h-3 w-3"})})]},fe))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`productImageUpload-${z}`).click(),children:[a.jsx(Uo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsx(Ye,{id:`productImageUpload-${z}`,type:"file",accept:"image/*",className:"hidden",onChange:Z=>E(z,Z.target.files[0])}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>P(z),disabled:o||!$.name,children:[o?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Image"]}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>k(z),disabled:c[z]||!$.name||!$.images||$.images.length===0,children:[c[z]?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"More Angles/Context"]})]}),$.isPrintOnDemand&&((F=$.podDetails)==null?void 0:F.originalDesignImageUrl)&&a.jsxs(O,{type:"button",variant:"outline",size:"sm",className:"mt-2 w-full",onClick:()=>Y(z),disabled:c[z]||C,children:[C&&c[z]!==!0?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx($ie,{className:"mr-2 h-4 w-4"}),"Create Full POD Collection"]})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),($.variants||[]).map((Z,fe)=>a.jsxs(Je,{className:"p-2 space-y-2 bg-muted/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(De,{htmlFor:`variantName-${z}-${fe}`,className:"text-xs",children:"Option Name"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>W(z,fe),className:"h-6 w-6",children:a.jsx(Wn,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(Ye,{id:`variantName-${z}-${fe}`,value:Z.name||"",onChange:xe=>j(z,fe,xe.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(De,{className:"text-xs",children:"Option Values (comma-separated or add one by one)"}),(Z.values||[]).map((xe,ge)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ye,{value:xe||"",onChange:Re=>D(z,fe,ge,Re.target.value),placeholder:"e.g., Red",className:"text-sm h-8"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>G(z,fe,ge),className:"h-6 w-6",children:a.jsx(Wn,{className:"h-3 w-3 text-destructive"})})]},ge)),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>M(z,fe),className:"text-xs h-7",children:[a.jsx(Vi,{className:"mr-1 h-3 w-3"})," Add Value"]})]},fe)),a.jsxs(O,{variant:"outline",onClick:()=>B(z),className:"w-full text-sm h-8",children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]},$.id||z)})})}),a.jsxs(Ar,{children:[a.jsx(il,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",onClick:e,disabled:R,children:"Cancel"})}),a.jsxs(O,{type:"button",onClick:Q,disabled:R,children:[R?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Finalize and Create Store"]})]})]})}),g&&f&&a.jsx(Xr,{open:g,onOpenChange:x,children:a.jsxs(Ur,{className:"max-w-xl max-h-[80vh]",children:[a.jsx(Br,{children:a.jsx(zr,{children:"Enlarged Image"})}),a.jsx("div",{className:"flex justify-center items-center p-4 max-h-[70vh]",children:a.jsx("img",{src:f,alt:"Enlarged product",className:"max-w-full max-h-full object-contain"})})]})})]}):null};function kn(){return kn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},kn.apply(null,arguments)}function IL(t,[e,n]){return Math.min(n,Math.max(e,t))}function as(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function EA(t,e=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];function u(h){const{scope:f,children:m,...g}=h,x=(f==null?void 0:f[t][c])||l,w=p.useMemo(()=>g,Object.values(g));return p.createElement(x.Provider,{value:w},m)}function d(h,f){const m=(f==null?void 0:f[t][c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,d]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return p.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,O_e(s,...e)]}function O_e(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function V_e(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function UG(...t){return e=>t.forEach(n=>V_e(n,e))}function Os(...t){return p.useCallback(UG(...t),t)}const ug=p.forwardRef((t,e)=>{const{children:n,...r}=t,s=p.Children.toArray(n),i=s.find(U_e);if(i){const o=i.props.children,l=s.map(c=>c===i?p.Children.count(o)>1?p.Children.only(null):p.isValidElement(o)?o.props.children:null:c);return p.createElement(KT,kn({},r,{ref:e}),p.isValidElement(o)?p.cloneElement(o,void 0,l):null)}return p.createElement(KT,kn({},r,{ref:e}),n)});ug.displayName="Slot";const KT=p.forwardRef((t,e)=>{const{children:n,...r}=t;return p.isValidElement(n)?p.cloneElement(n,{...B_e(r,n.props),ref:e?UG(e,n.ref):n.ref}):p.Children.count(n)>1?p.Children.only(null):null});KT.displayName="SlotClone";const $_e=({children:t})=>p.createElement(p.Fragment,null,t);function U_e(t){return p.isValidElement(t)&&t.type===$_e}function B_e(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{i(...l),s(...l)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function z_e(t){const e=t+"CollectionProvider",[n,r]=EA(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=m=>{const{scope:g,children:x}=m,w=ht.useRef(null),v=ht.useRef(new Map).current;return ht.createElement(s,{scope:g,itemMap:v,collectionRef:w},x)},l=t+"CollectionSlot",c=ht.forwardRef((m,g)=>{const{scope:x,children:w}=m,v=i(l,x),_=Os(g,v.collectionRef);return ht.createElement(ug,{ref:_},w)}),u=t+"CollectionItemSlot",d="data-radix-collection-item",h=ht.forwardRef((m,g)=>{const{scope:x,children:w,...v}=m,_=ht.useRef(null),C=Os(g,_),T=i(u,x);return ht.useEffect(()=>(T.itemMap.set(_,{ref:_,...v}),()=>void T.itemMap.delete(_))),ht.createElement(ug,{[d]:"",ref:C},w)});function f(m){const g=i(t+"CollectionConsumer",m);return ht.useCallback(()=>{const w=g.collectionRef.current;if(!w)return[];const v=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((T,R)=>v.indexOf(T.ref.current)-v.indexOf(R.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:o,Slot:c,ItemSlot:h},f,r]}const G_e=p.createContext(void 0);function W_e(t){const e=p.useContext(G_e);return t||e||"ltr"}const H_e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],_s=H_e.reduce((t,e)=>{const n=p.forwardRef((r,s)=>{const{asChild:i,...o}=r,l=i?ug:e;return p.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),p.createElement(l,kn({},o,{ref:s}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function q_e(t,e){t&&gl.flushSync(()=>t.dispatchEvent(e))}function hl(t){const e=p.useRef(t);return p.useEffect(()=>{e.current=t}),p.useMemo(()=>(...n)=>{var r;return(r=e.current)===null||r===void 0?void 0:r.call(e,...n)},[])}function K_e(t,e=globalThis==null?void 0:globalThis.document){const n=hl(t);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r),()=>e.removeEventListener("keydown",r)},[n,e])}const YT="dismissableLayer.update",Y_e="dismissableLayer.pointerDownOutside",J_e="dismissableLayer.focusOutside";let NL;const X_e=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Q_e=p.forwardRef((t,e)=>{var n;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:l,onDismiss:c,...u}=t,d=p.useContext(X_e),[h,f]=p.useState(null),m=(n=h==null?void 0:h.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,g]=p.useState({}),x=Os(e,I=>f(I)),w=Array.from(d.layers),[v]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),_=w.indexOf(v),C=h?w.indexOf(h):-1,T=d.layersWithOutsidePointerEventsDisabled.size>0,R=C>=_,A=Z_e(I=>{const P=I.target,k=[...d.branches].some(j=>j.contains(P));!R||k||(i==null||i(I),l==null||l(I),I.defaultPrevented||c==null||c())},m),E=eSe(I=>{const P=I.target;[...d.branches].some(j=>j.contains(P))||(o==null||o(I),l==null||l(I),I.defaultPrevented||c==null||c())},m);return K_e(I=>{C===d.layers.size-1&&(s==null||s(I),!I.defaultPrevented&&c&&(I.preventDefault(),c()))},m),p.useEffect(()=>{if(h)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(NL=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(h)),d.layers.add(h),PL(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=NL)}},[h,m,r,d]),p.useEffect(()=>()=>{h&&(d.layers.delete(h),d.layersWithOutsidePointerEventsDisabled.delete(h),PL())},[h,d]),p.useEffect(()=>{const I=()=>g({});return document.addEventListener(YT,I),()=>document.removeEventListener(YT,I)},[]),p.createElement(_s.div,kn({},u,{ref:x,style:{pointerEvents:T?R?"auto":"none":void 0,...t.style},onFocusCapture:as(t.onFocusCapture,E.onFocusCapture),onBlurCapture:as(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:as(t.onPointerDownCapture,A.onPointerDownCapture)}))});function Z_e(t,e=globalThis==null?void 0:globalThis.document){const n=hl(t),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let u=function(){BG(Y_e,n,c,{discrete:!0})};const c={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=u,e.addEventListener("click",s.current,{once:!0})):u()}r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function eSe(t,e=globalThis==null?void 0:globalThis.document){const n=hl(t),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&BG(J_e,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function PL(){const t=new CustomEvent(YT);document.dispatchEvent(t)}function BG(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?q_e(s,i):s.dispatchEvent(i)}let YS=0;function tSe(){p.useEffect(()=>{var t,e;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=n[0])!==null&&t!==void 0?t:AL()),document.body.insertAdjacentElement("beforeend",(e=n[1])!==null&&e!==void 0?e:AL()),YS++,()=>{YS===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),YS--}},[])}function AL(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}const JS="focusScope.autoFocusOnMount",XS="focusScope.autoFocusOnUnmount",kL={bubbles:!1,cancelable:!0},nSe=p.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[l,c]=p.useState(null),u=hl(s),d=hl(i),h=p.useRef(null),f=Os(e,x=>c(x)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let x=function(C){if(m.paused||!l)return;const T=C.target;l.contains(T)?h.current=T:Ll(h.current,{select:!0})},w=function(C){if(m.paused||!l)return;const T=C.relatedTarget;T!==null&&(l.contains(T)||Ll(h.current,{select:!0}))},v=function(C){const T=document.activeElement;for(const R of C)R.removedNodes.length>0&&(l!=null&&l.contains(T)||Ll(l))};document.addEventListener("focusin",x),document.addEventListener("focusout",w);const _=new MutationObserver(v);return l&&_.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",w),_.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){jL.add(m);const x=document.activeElement;if(!l.contains(x)){const v=new CustomEvent(JS,kL);l.addEventListener(JS,u),l.dispatchEvent(v),v.defaultPrevented||(rSe(lSe(zG(l)),{select:!0}),document.activeElement===x&&Ll(l))}return()=>{l.removeEventListener(JS,u),setTimeout(()=>{const v=new CustomEvent(XS,kL);l.addEventListener(XS,d),l.dispatchEvent(v),v.defaultPrevented||Ll(x??document.body,{select:!0}),l.removeEventListener(XS,d),jL.remove(m)},0)}}},[l,u,d,m]);const g=p.useCallback(x=>{if(!n&&!r||m.paused)return;const w=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,v=document.activeElement;if(w&&v){const _=x.currentTarget,[C,T]=sSe(_);C&&T?!x.shiftKey&&v===T?(x.preventDefault(),n&&Ll(C,{select:!0})):x.shiftKey&&v===C&&(x.preventDefault(),n&&Ll(T,{select:!0})):v===_&&x.preventDefault()}},[n,r,m.paused]);return p.createElement(_s.div,kn({tabIndex:-1},o,{ref:f,onKeyDown:g}))});function rSe(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Ll(r,{select:e}),document.activeElement!==n)return}function sSe(t){const e=zG(t),n=RL(e,t),r=RL(e.reverse(),t);return[n,r]}function zG(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function RL(t,e){for(const n of t)if(!iSe(n,{upTo:e}))return n}function iSe(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function oSe(t){return t instanceof HTMLInputElement&&"select"in t}function Ll(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&oSe(t)&&e&&t.select()}}const jL=aSe();function aSe(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=DL(t,e),t.unshift(e)},remove(e){var n;t=DL(t,e),(n=t[0])===null||n===void 0||n.resume()}}}function DL(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function lSe(t){return t.filter(e=>e.tagName!=="A")}const wo=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},cSe=l0["useId".toString()]||(()=>{});let uSe=0;function GG(t){const[e,n]=p.useState(cSe());return wo(()=>{t||n(r=>r??String(uSe++))},[t]),t||(e?`radix-${e}`:"")}const dSe=["top","right","bottom","left"],Pc=Math.min,Fi=Math.max,Xw=Math.round,xx=Math.floor,_a=t=>({x:t,y:t}),hSe={left:"right",right:"left",bottom:"top",top:"bottom"},fSe={start:"end",end:"start"};function JT(t,e,n){return Fi(t,Pc(e,n))}function fl(t,e){return typeof t=="function"?t(e):t}function ml(t){return t.split("-")[0]}function Df(t){return t.split("-")[1]}function TA(t){return t==="x"?"y":"x"}function IA(t){return t==="y"?"height":"width"}function ma(t){return["top","bottom"].includes(ml(t))?"y":"x"}function NA(t){return TA(ma(t))}function mSe(t,e,n){n===void 0&&(n=!1);const r=Df(t),s=NA(t),i=IA(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Qw(o)),[o,Qw(o)]}function pSe(t){const e=Qw(t);return[XT(t),e,XT(e)]}function XT(t){return t.replace(/start|end/g,e=>fSe[e])}function gSe(t,e,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?s:r:e?r:s;case"left":case"right":return e?i:o;default:return[]}}function ySe(t,e,n,r){const s=Df(t);let i=gSe(ml(t),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(XT)))),i}function Qw(t){return t.replace(/left|right|bottom|top/g,e=>hSe[e])}function xSe(t){return{top:0,right:0,bottom:0,left:0,...t}}function WG(t){return typeof t!="number"?xSe(t):{top:t,right:t,bottom:t,left:t}}function Zw(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function ML(t,e,n){let{reference:r,floating:s}=t;const i=ma(e),o=NA(e),l=IA(o),c=ml(e),u=i==="y",d=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,f=r[l]/2-s[l]/2;let m;switch(c){case"top":m={x:d,y:r.y-s.height};break;case"bottom":m={x:d,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:h};break;case"left":m={x:r.x-s.width,y:h};break;default:m={x:r.x,y:r.y}}switch(Df(e)){case"start":m[o]-=f*(n&&u?-1:1);break;case"end":m[o]+=f*(n&&u?-1:1);break}return m}const vSe=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:d,y:h}=ML(u,r,c),f=r,m={},g=0;for(let x=0;x<l.length;x++){const{name:w,fn:v}=l[x],{x:_,y:C,data:T,reset:R}=await v({x:d,y:h,initialPlacement:r,placement:f,strategy:s,middlewareData:m,rects:u,platform:o,elements:{reference:t,floating:e}});d=_??d,h=C??h,m={...m,[w]:{...m[w],...T}},R&&g<=50&&(g++,typeof R=="object"&&(R.placement&&(f=R.placement),R.rects&&(u=R.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):R.rects),{x:d,y:h}=ML(u,f,c)),x=-1)}return{x:d,y:h,placement:f,strategy:s,middlewareData:m}};async function dg(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:l,strategy:c}=t,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:m=0}=fl(e,t),g=WG(m),w=l[f?h==="floating"?"reference":"floating":h],v=Zw(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(w)))==null||n?w:w.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),_=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,C=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),T=await(i.isElement==null?void 0:i.isElement(C))?await(i.getScale==null?void 0:i.getScale(C))||{x:1,y:1}:{x:1,y:1},R=Zw(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:_,offsetParent:C,strategy:c}):_);return{top:(v.top-R.top+g.top)/T.y,bottom:(R.bottom-v.bottom+g.bottom)/T.y,left:(v.left-R.left+g.left)/T.x,right:(R.right-v.right+g.right)/T.x}}const wSe=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:o,elements:l,middlewareData:c}=e,{element:u,padding:d=0}=fl(t,e)||{};if(u==null)return{};const h=WG(d),f={x:n,y:r},m=NA(s),g=IA(m),x=await o.getDimensions(u),w=m==="y",v=w?"top":"left",_=w?"bottom":"right",C=w?"clientHeight":"clientWidth",T=i.reference[g]+i.reference[m]-f[m]-i.floating[g],R=f[m]-i.reference[m],A=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let E=A?A[C]:0;(!E||!await(o.isElement==null?void 0:o.isElement(A)))&&(E=l.floating[C]||i.floating[g]);const I=T/2-R/2,P=E/2-x[g]/2-1,k=Pc(h[v],P),j=Pc(h[_],P),D=k,M=E-x[g]-j,G=E/2-x[g]/2+I,B=JT(D,G,M),W=!c.arrow&&Df(s)!=null&&G!==B&&i.reference[g]/2-(G<D?k:j)-x[g]/2<0,Q=W?G<D?G-D:G-M:0;return{[m]:f[m]+Q,data:{[m]:B,centerOffset:G-B-Q,...W&&{alignmentOffset:Q}},reset:W}}}),bSe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:x=!0,...w}=fl(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const v=ml(s),_=ma(l),C=ml(l)===l,T=await(c.isRTL==null?void 0:c.isRTL(u.floating)),R=f||(C||!x?[Qw(l)]:pSe(l)),A=g!=="none";!f&&A&&R.push(...ySe(l,x,g,T));const E=[l,...R],I=await dg(e,w),P=[];let k=((r=i.flip)==null?void 0:r.overflows)||[];if(d&&P.push(I[v]),h){const G=mSe(s,o,T);P.push(I[G[0]],I[G[1]])}if(k=[...k,{placement:s,overflows:P}],!P.every(G=>G<=0)){var j,D;const G=(((j=i.flip)==null?void 0:j.index)||0)+1,B=E[G];if(B&&(!(h==="alignment"?_!==ma(B):!1)||k.every(H=>H.overflows[0]>0&&ma(H.placement)===_)))return{data:{index:G,overflows:k},reset:{placement:B}};let W=(D=k.filter(Q=>Q.overflows[0]<=0).sort((Q,H)=>Q.overflows[1]-H.overflows[1])[0])==null?void 0:D.placement;if(!W)switch(m){case"bestFit":{var M;const Q=(M=k.filter(H=>{if(A){const Y=ma(H.placement);return Y===_||Y==="y"}return!0}).map(H=>[H.placement,H.overflows.filter(Y=>Y>0).reduce((Y,V)=>Y+V,0)]).sort((H,Y)=>H[1]-Y[1])[0])==null?void 0:M[0];Q&&(W=Q);break}case"initialPlacement":W=l;break}if(s!==W)return{reset:{placement:W}}}return{}}}};function LL(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function FL(t){return dSe.some(e=>t[e]>=0)}const _Se=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=fl(t,e);switch(r){case"referenceHidden":{const i=await dg(e,{...s,elementContext:"reference"}),o=LL(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:FL(o)}}}case"escaped":{const i=await dg(e,{...s,altBoundary:!0}),o=LL(i,n.floating);return{data:{escapedOffsets:o,escaped:FL(o)}}}default:return{}}}}};async function SSe(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=ml(n),l=Df(n),c=ma(n)==="y",u=["left","top"].includes(o)?-1:1,d=i&&c?-1:1,h=fl(e,t);let{mainAxis:f,crossAxis:m,alignmentAxis:g}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof g=="number"&&(m=l==="end"?g*-1:g),c?{x:m*d,y:f*u}:{x:f*u,y:m*d}}const CSe=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:o,middlewareData:l}=e,c=await SSe(e,t);return o===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:o}}}}},ESe=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:w=>{let{x:v,y:_}=w;return{x:v,y:_}}},...c}=fl(t,e),u={x:n,y:r},d=await dg(e,c),h=ma(ml(s)),f=TA(h);let m=u[f],g=u[h];if(i){const w=f==="y"?"top":"left",v=f==="y"?"bottom":"right",_=m+d[w],C=m-d[v];m=JT(_,m,C)}if(o){const w=h==="y"?"top":"left",v=h==="y"?"bottom":"right",_=g+d[w],C=g-d[v];g=JT(_,g,C)}const x=l.fn({...e,[f]:m,[h]:g});return{...x,data:{x:x.x-n,y:x.y-r,enabled:{[f]:i,[h]:o}}}}}},TSe=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=fl(t,e),d={x:n,y:r},h=ma(s),f=TA(h);let m=d[f],g=d[h];const x=fl(l,e),w=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(c){const C=f==="y"?"height":"width",T=i.reference[f]-i.floating[C]+w.mainAxis,R=i.reference[f]+i.reference[C]-w.mainAxis;m<T?m=T:m>R&&(m=R)}if(u){var v,_;const C=f==="y"?"width":"height",T=["top","left"].includes(ml(s)),R=i.reference[h]-i.floating[C]+(T&&((v=o.offset)==null?void 0:v[h])||0)+(T?0:w.crossAxis),A=i.reference[h]+i.reference[C]+(T?0:((_=o.offset)==null?void 0:_[h])||0)-(T?w.crossAxis:0);g<R?g=R:g>A&&(g=A)}return{[f]:m,[h]:g}}}},ISe=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:s,rects:i,platform:o,elements:l}=e,{apply:c=()=>{},...u}=fl(t,e),d=await dg(e,u),h=ml(s),f=Df(s),m=ma(s)==="y",{width:g,height:x}=i.floating;let w,v;h==="top"||h==="bottom"?(w=h,v=f===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(v=h,w=f==="end"?"top":"bottom");const _=x-d.top-d.bottom,C=g-d.left-d.right,T=Pc(x-d[w],_),R=Pc(g-d[v],C),A=!e.middlewareData.shift;let E=T,I=R;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(I=C),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(E=_),A&&!f){const k=Fi(d.left,0),j=Fi(d.right,0),D=Fi(d.top,0),M=Fi(d.bottom,0);m?I=g-2*(k!==0||j!==0?k+j:Fi(d.left,d.right)):E=x-2*(D!==0||M!==0?D+M:Fi(d.top,d.bottom))}await c({...e,availableWidth:I,availableHeight:E});const P=await o.getDimensions(l.floating);return g!==P.width||x!==P.height?{reset:{rects:!0}}:{}}}};function Yb(){return typeof window<"u"}function Mf(t){return HG(t)?(t.nodeName||"").toLowerCase():"#document"}function Hi(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function ka(t){var e;return(e=(HG(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function HG(t){return Yb()?t instanceof Node||t instanceof Hi(t).Node:!1}function qo(t){return Yb()?t instanceof Element||t instanceof Hi(t).Element:!1}function Ta(t){return Yb()?t instanceof HTMLElement||t instanceof Hi(t).HTMLElement:!1}function OL(t){return!Yb()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Hi(t).ShadowRoot}function ay(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=Ko(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(s)}function NSe(t){return["table","td","th"].includes(Mf(t))}function Jb(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function PA(t){const e=AA(),n=qo(t)?Ko(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function PSe(t){let e=Ac(t);for(;Ta(e)&&!yf(e);){if(PA(e))return e;if(Jb(e))return null;e=Ac(e)}return null}function AA(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function yf(t){return["html","body","#document"].includes(Mf(t))}function Ko(t){return Hi(t).getComputedStyle(t)}function Xb(t){return qo(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Ac(t){if(Mf(t)==="html")return t;const e=t.assignedSlot||t.parentNode||OL(t)&&t.host||ka(t);return OL(e)?e.host:e}function qG(t){const e=Ac(t);return yf(e)?t.ownerDocument?t.ownerDocument.body:t.body:Ta(e)&&ay(e)?e:qG(e)}function hg(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=qG(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),o=Hi(s);if(i){const l=QT(o);return e.concat(o,o.visualViewport||[],ay(s)?s:[],l&&n?hg(l):[])}return e.concat(s,hg(s,[],n))}function QT(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function KG(t){const e=Ko(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=Ta(t),i=s?t.offsetWidth:n,o=s?t.offsetHeight:r,l=Xw(n)!==i||Xw(r)!==o;return l&&(n=i,r=o),{width:n,height:r,$:l}}function kA(t){return qo(t)?t:t.contextElement}function Fh(t){const e=kA(t);if(!Ta(e))return _a(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=KG(e);let o=(i?Xw(n.width):n.width)/r,l=(i?Xw(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const ASe=_a(0);function YG(t){const e=Hi(t);return!AA()||!e.visualViewport?ASe:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function kSe(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Hi(t)?!1:e}function ld(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=kA(t);let o=_a(1);e&&(r?qo(r)&&(o=Fh(r)):o=Fh(t));const l=kSe(i,n,r)?YG(i):_a(0);let c=(s.left+l.x)/o.x,u=(s.top+l.y)/o.y,d=s.width/o.x,h=s.height/o.y;if(i){const f=Hi(i),m=r&&qo(r)?Hi(r):r;let g=f,x=QT(g);for(;x&&r&&m!==g;){const w=Fh(x),v=x.getBoundingClientRect(),_=Ko(x),C=v.left+(x.clientLeft+parseFloat(_.paddingLeft))*w.x,T=v.top+(x.clientTop+parseFloat(_.paddingTop))*w.y;c*=w.x,u*=w.y,d*=w.x,h*=w.y,c+=C,u+=T,g=Hi(x),x=QT(g)}}return Zw({width:d,height:h,x:c,y:u})}function RA(t,e){const n=Xb(t).scrollLeft;return e?e.left+n:ld(ka(t)).left+n}function JG(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=r.left+e.scrollLeft-(n?0:RA(t,r)),i=r.top+e.scrollTop;return{x:s,y:i}}function RSe(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",o=ka(r),l=e?Jb(e.floating):!1;if(r===o||l&&i)return n;let c={scrollLeft:0,scrollTop:0},u=_a(1);const d=_a(0),h=Ta(r);if((h||!h&&!i)&&((Mf(r)!=="body"||ay(o))&&(c=Xb(r)),Ta(r))){const m=ld(r);u=Fh(r),d.x=m.x+r.clientLeft,d.y=m.y+r.clientTop}const f=o&&!h&&!i?JG(o,c,!0):_a(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-c.scrollLeft*u.x+d.x+f.x,y:n.y*u.y-c.scrollTop*u.y+d.y+f.y}}function jSe(t){return Array.from(t.getClientRects())}function DSe(t){const e=ka(t),n=Xb(t),r=t.ownerDocument.body,s=Fi(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=Fi(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+RA(t);const l=-n.scrollTop;return Ko(r).direction==="rtl"&&(o+=Fi(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:l}}function MSe(t,e){const n=Hi(t),r=ka(t),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,l=0,c=0;if(s){i=s.width,o=s.height;const u=AA();(!u||u&&e==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:i,height:o,x:l,y:c}}function LSe(t,e){const n=ld(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=Ta(t)?Fh(t):_a(1),o=t.clientWidth*i.x,l=t.clientHeight*i.y,c=s*i.x,u=r*i.y;return{width:o,height:l,x:c,y:u}}function VL(t,e,n){let r;if(e==="viewport")r=MSe(t,n);else if(e==="document")r=DSe(ka(t));else if(qo(e))r=LSe(e,n);else{const s=YG(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Zw(r)}function XG(t,e){const n=Ac(t);return n===e||!qo(n)||yf(n)?!1:Ko(n).position==="fixed"||XG(n,e)}function FSe(t,e){const n=e.get(t);if(n)return n;let r=hg(t,[],!1).filter(l=>qo(l)&&Mf(l)!=="body"),s=null;const i=Ko(t).position==="fixed";let o=i?Ac(t):t;for(;qo(o)&&!yf(o);){const l=Ko(o),c=PA(o);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||ay(o)&&!c&&XG(t,o))?r=r.filter(d=>d!==o):s=l,o=Ac(o)}return e.set(t,r),r}function OSe(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?Jb(e)?[]:FSe(e,this._c):[].concat(n),r],l=o[0],c=o.reduce((u,d)=>{const h=VL(e,d,s);return u.top=Fi(h.top,u.top),u.right=Pc(h.right,u.right),u.bottom=Pc(h.bottom,u.bottom),u.left=Fi(h.left,u.left),u},VL(e,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function VSe(t){const{width:e,height:n}=KG(t);return{width:e,height:n}}function $Se(t,e,n){const r=Ta(e),s=ka(e),i=n==="fixed",o=ld(t,!0,i,e);let l={scrollLeft:0,scrollTop:0};const c=_a(0);function u(){c.x=RA(s)}if(r||!r&&!i)if((Mf(e)!=="body"||ay(s))&&(l=Xb(e)),r){const m=ld(e,!0,i,e);c.x=m.x+e.clientLeft,c.y=m.y+e.clientTop}else s&&u();i&&!r&&s&&u();const d=s&&!r&&!i?JG(s,l):_a(0),h=o.left+l.scrollLeft-c.x-d.x,f=o.top+l.scrollTop-c.y-d.y;return{x:h,y:f,width:o.width,height:o.height}}function QS(t){return Ko(t).position==="static"}function $L(t,e){if(!Ta(t)||Ko(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return ka(t)===n&&(n=n.ownerDocument.body),n}function QG(t,e){const n=Hi(t);if(Jb(t))return n;if(!Ta(t)){let s=Ac(t);for(;s&&!yf(s);){if(qo(s)&&!QS(s))return s;s=Ac(s)}return n}let r=$L(t,e);for(;r&&NSe(r)&&QS(r);)r=$L(r,e);return r&&yf(r)&&QS(r)&&!PA(r)?n:r||PSe(t)||n}const USe=async function(t){const e=this.getOffsetParent||QG,n=this.getDimensions,r=await n(t.floating);return{reference:$Se(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function BSe(t){return Ko(t).direction==="rtl"}const zSe={convertOffsetParentRelativeRectToViewportRelativeRect:RSe,getDocumentElement:ka,getClippingRect:OSe,getOffsetParent:QG,getElementRects:USe,getClientRects:jSe,getDimensions:VSe,getScale:Fh,isElement:qo,isRTL:BSe};function ZG(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function GSe(t,e){let n=null,r;const s=ka(t);function i(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const u=t.getBoundingClientRect(),{left:d,top:h,width:f,height:m}=u;if(l||e(),!f||!m)return;const g=xx(h),x=xx(s.clientWidth-(d+f)),w=xx(s.clientHeight-(h+m)),v=xx(d),C={rootMargin:-g+"px "+-x+"px "+-w+"px "+-v+"px",threshold:Fi(0,Pc(1,c))||1};let T=!0;function R(A){const E=A[0].intersectionRatio;if(E!==c){if(!T)return o();E?o(!1,E):r=setTimeout(()=>{o(!1,1e-7)},1e3)}E===1&&!ZG(u,t.getBoundingClientRect())&&o(),T=!1}try{n=new IntersectionObserver(R,{...C,root:s.ownerDocument})}catch{n=new IntersectionObserver(R,C)}n.observe(t)}return o(!0),i}function e7(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,u=kA(t),d=s||i?[...u?hg(u):[],...hg(e)]:[];d.forEach(v=>{s&&v.addEventListener("scroll",n,{passive:!0}),i&&v.addEventListener("resize",n)});const h=u&&l?GSe(u,n):null;let f=-1,m=null;o&&(m=new ResizeObserver(v=>{let[_]=v;_&&_.target===u&&m&&(m.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var C;(C=m)==null||C.observe(e)})),n()}),u&&!c&&m.observe(u),m.observe(e));let g,x=c?ld(t):null;c&&w();function w(){const v=ld(t);x&&!ZG(x,v)&&n(),x=v,g=requestAnimationFrame(w)}return n(),()=>{var v;d.forEach(_=>{s&&_.removeEventListener("scroll",n),i&&_.removeEventListener("resize",n)}),h==null||h(),(v=m)==null||v.disconnect(),m=null,c&&cancelAnimationFrame(g)}}const WSe=CSe,HSe=ESe,qSe=bSe,KSe=ISe,YSe=_Se,UL=wSe,JSe=TSe,XSe=(t,e,n)=>{const r=new Map,s={platform:zSe,...n},i={...s.platform,_c:r};return vSe(t,e,{...s,platform:i})};var QSe=typeof document<"u",ZSe=function(){},yv=QSe?p.useLayoutEffect:ZSe;function e0(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!e0(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!e0(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function t7(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function BL(t,e){const n=t7(t);return Math.round(e*n)/n}function ZS(t){const e=p.useRef(t);return yv(()=>{e.current=t}),e}function n7(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=t,[d,h]=p.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,m]=p.useState(r);e0(f,r)||m(r);const[g,x]=p.useState(null),[w,v]=p.useState(null),_=p.useCallback(H=>{H!==A.current&&(A.current=H,x(H))},[]),C=p.useCallback(H=>{H!==E.current&&(E.current=H,v(H))},[]),T=i||g,R=o||w,A=p.useRef(null),E=p.useRef(null),I=p.useRef(d),P=c!=null,k=ZS(c),j=ZS(s),D=ZS(u),M=p.useCallback(()=>{if(!A.current||!E.current)return;const H={placement:e,strategy:n,middleware:f};j.current&&(H.platform=j.current),XSe(A.current,E.current,H).then(Y=>{const V={...Y,isPositioned:D.current!==!1};G.current&&!e0(I.current,V)&&(I.current=V,gl.flushSync(()=>{h(V)}))})},[f,e,n,j,D]);yv(()=>{u===!1&&I.current.isPositioned&&(I.current.isPositioned=!1,h(H=>({...H,isPositioned:!1})))},[u]);const G=p.useRef(!1);yv(()=>(G.current=!0,()=>{G.current=!1}),[]),yv(()=>{if(T&&(A.current=T),R&&(E.current=R),T&&R){if(k.current)return k.current(T,R,M);M()}},[T,R,M,k,P]);const B=p.useMemo(()=>({reference:A,floating:E,setReference:_,setFloating:C}),[_,C]),W=p.useMemo(()=>({reference:T,floating:R}),[T,R]),Q=p.useMemo(()=>{const H={position:n,left:0,top:0};if(!W.floating)return H;const Y=BL(W.floating,d.x),V=BL(W.floating,d.y);return l?{...H,transform:"translate("+Y+"px, "+V+"px)",...t7(W.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:Y,top:V}},[n,l,W.floating,d.x,d.y]);return p.useMemo(()=>({...d,update:M,refs:B,elements:W,floatingStyles:Q}),[d,M,B,W,Q])}const eCe=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?UL({element:r.current,padding:s}).fn(n):{}:r?UL({element:r,padding:s}).fn(n):{}}}},r7=(t,e)=>({...WSe(t),options:[t,e]}),s7=(t,e)=>({...HSe(t),options:[t,e]}),i7=(t,e)=>({...JSe(t),options:[t,e]}),o7=(t,e)=>({...qSe(t),options:[t,e]}),a7=(t,e)=>({...KSe(t),options:[t,e]}),l7=(t,e)=>({...YSe(t),options:[t,e]}),c7=(t,e)=>({...eCe(t),options:[t,e]});function tCe(t){const[e,n]=p.useState(void 0);return wo(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}const u7="Popper",[d7,h7]=EA(u7),[nCe,f7]=d7(u7),rCe=t=>{const{__scopePopper:e,children:n}=t,[r,s]=p.useState(null);return p.createElement(nCe,{scope:e,anchor:r,onAnchorChange:s},n)},sCe="PopperAnchor",iCe=p.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=f7(sCe,n),o=p.useRef(null),l=Os(e,o);return p.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:p.createElement(_s.div,kn({},s,{ref:l}))}),m7="PopperContent",[oCe,$je]=d7(m7),aCe=p.forwardRef((t,e)=>{var n,r,s,i,o,l,c,u;const{__scopePopper:d,side:h="bottom",sideOffset:f=0,align:m="center",alignOffset:g=0,arrowPadding:x=0,collisionBoundary:w=[],collisionPadding:v=0,sticky:_="partial",hideWhenDetached:C=!1,avoidCollisions:T=!0,onPlaced:R,...A}=t,E=f7(m7,d),[I,P]=p.useState(null),k=Os(e,ve=>P(ve)),[j,D]=p.useState(null),M=tCe(j),G=(n=M==null?void 0:M.width)!==null&&n!==void 0?n:0,B=(r=M==null?void 0:M.height)!==null&&r!==void 0?r:0,W=h+(m!=="center"?"-"+m:""),Q=typeof v=="number"?v:{top:0,right:0,bottom:0,left:0,...v},H=Array.isArray(w)?w:[w],Y=H.length>0,V={padding:Q,boundary:H.filter(lCe),altBoundary:Y},{refs:$,floatingStyles:z,placement:F,isPositioned:Z,middlewareData:fe}=n7({strategy:"fixed",placement:W,whileElementsMounted:e7,elements:{reference:E.anchor},middleware:[r7({mainAxis:f+B,alignmentAxis:g}),T&&s7({mainAxis:!0,crossAxis:!1,limiter:_==="partial"?i7():void 0,...V}),T&&o7({...V}),a7({...V,apply:({elements:ve,rects:de,availableWidth:Me,availableHeight:Ge})=>{const{width:yt,height:Pt}=de.reference,en=ve.floating.style;en.setProperty("--radix-popper-available-width",`${Me}px`),en.setProperty("--radix-popper-available-height",`${Ge}px`),en.setProperty("--radix-popper-anchor-width",`${yt}px`),en.setProperty("--radix-popper-anchor-height",`${Pt}px`)}}),j&&c7({element:j,padding:x}),cCe({arrowWidth:G,arrowHeight:B}),C&&l7({strategy:"referenceHidden"})]}),[xe,ge]=p7(F),Re=hl(R);wo(()=>{Z&&(Re==null||Re())},[Z,Re]);const Ue=(s=fe.arrow)===null||s===void 0?void 0:s.x,ze=(i=fe.arrow)===null||i===void 0?void 0:i.y,he=((o=fe.arrow)===null||o===void 0?void 0:o.centerOffset)!==0,[Ce,Pe]=p.useState();return wo(()=>{I&&Pe(window.getComputedStyle(I).zIndex)},[I]),p.createElement("div",{ref:$.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:Z?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ce,"--radix-popper-transform-origin":[(l=fe.transformOrigin)===null||l===void 0?void 0:l.x,(c=fe.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:t.dir},p.createElement(oCe,{scope:d,placedSide:xe,onArrowChange:D,arrowX:Ue,arrowY:ze,shouldHideArrow:he},p.createElement(_s.div,kn({"data-side":xe,"data-align":ge},A,{ref:k,style:{...A.style,animation:Z?void 0:"none",opacity:(u=fe.hide)!==null&&u!==void 0&&u.referenceHidden?0:void 0}}))))});function lCe(t){return t!==null}const cCe=t=>({name:"transformOrigin",options:t,fn(e){var n,r,s,i,o;const{placement:l,rects:c,middlewareData:u}=e,h=((n=u.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,f=h?0:t.arrowWidth,m=h?0:t.arrowHeight,[g,x]=p7(l),w={start:"0%",center:"50%",end:"100%"}[x],v=((r=(s=u.arrow)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:0)+f/2,_=((i=(o=u.arrow)===null||o===void 0?void 0:o.y)!==null&&i!==void 0?i:0)+m/2;let C="",T="";return g==="bottom"?(C=h?w:`${v}px`,T=`${-m}px`):g==="top"?(C=h?w:`${v}px`,T=`${c.floating.height+m}px`):g==="right"?(C=`${-m}px`,T=h?w:`${_}px`):g==="left"&&(C=`${c.floating.width+m}px`,T=h?w:`${_}px`),{data:{x:C,y:T}}}});function p7(t){const[e,n="center"]=t.split("-");return[e,n]}const uCe=rCe,dCe=iCe,hCe=aCe,fCe=p.forwardRef((t,e)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...s}=t;return r?mI.createPortal(p.createElement(_s.div,kn({},s,{ref:e})),r):null});function zL({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=mCe({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,l=hl(n),c=p.useCallback(u=>{if(i){const h=typeof u=="function"?u(t):u;h!==t&&l(h)}else s(u)},[i,t,s,l]);return[o,c]}function mCe({defaultProp:t,onChange:e}){const n=p.useState(t),[r]=n,s=p.useRef(r),i=hl(e);return p.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}function pCe(t){const e=p.useRef({value:t,previous:t});return p.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}const gCe=p.forwardRef((t,e)=>p.createElement(_s.span,kn({},t,{ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}})));var g7=nU(),eC=function(){},Qb=p.forwardRef(function(t,e){var n=p.useRef(null),r=p.useState({onScrollCapture:eC,onWheelCapture:eC,onTouchMoveCapture:eC}),s=r[0],i=r[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,m=t.noIsolation,g=t.inert,x=t.allowPinchZoom,w=t.as,v=w===void 0?"div":w,_=Tf(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),C=f,T=tU([n,e]),R=js(js({},_),s);return p.createElement(p.Fragment,null,d&&p.createElement(C,{sideCar:g7,removeScrollBar:u,shards:h,noIsolation:m,inert:g,setCallbacks:i,allowPinchZoom:!!x,lockRef:n}),o?p.cloneElement(p.Children.only(l),js(js({},R),{ref:T})):p.createElement(v,js({},R,{className:c,ref:T}),l))});Qb.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Qb.classNames={fullWidth:Ym,zeroRight:Km};var ZT=!1;if(typeof window<"u")try{var vx=Object.defineProperty({},"passive",{get:function(){return ZT=!0,!0}});window.addEventListener("test",vx,vx),window.removeEventListener("test",vx,vx)}catch{ZT=!1}var Bd=ZT?{passive:!1}:!1,yCe=function(t){return t.tagName==="TEXTAREA"},y7=function(t,e){var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!yCe(t)&&n[e]==="visible")},xCe=function(t){return y7(t,"overflowY")},vCe=function(t){return y7(t,"overflowX")},GL=function(t,e){var n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=x7(t,n);if(r){var s=v7(t,n),i=s[1],o=s[2];if(i>o)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},wCe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},bCe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},x7=function(t,e){return t==="v"?xCe(e):vCe(e)},v7=function(t,e){return t==="v"?wCe(e):bCe(e)},_Ce=function(t,e){return t==="h"&&e==="rtl"?-1:1},SCe=function(t,e,n,r,s){var i=_Ce(t,window.getComputedStyle(e).direction),o=i*r,l=n.target,c=e.contains(l),u=!1,d=o>0,h=0,f=0;do{var m=v7(t,l),g=m[0],x=m[1],w=m[2],v=x-w-i*g;(g||v)&&x7(t,l)&&(h+=v,f+=g),l=l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&(s&&h===0||!s&&o>h)||!d&&(s&&f===0||!s&&-o>f))&&(u=!0),u},wx=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},WL=function(t){return[t.deltaX,t.deltaY]},HL=function(t){return t&&"current"in t?t.current:t},CCe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},ECe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},TCe=0,zd=[];function ICe(t){var e=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(TCe++)[0],i=p.useState(function(){return FI()})[0],o=p.useRef(t);p.useEffect(function(){o.current=t},[t]),p.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var x=eU([t.lockRef.current],(t.shards||[]).map(HL),!0).filter(Boolean);return x.forEach(function(w){return w.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),x.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=p.useCallback(function(x,w){if("touches"in x&&x.touches.length===2)return!o.current.allowPinchZoom;var v=wx(x),_=n.current,C="deltaX"in x?x.deltaX:_[0]-v[0],T="deltaY"in x?x.deltaY:_[1]-v[1],R,A=x.target,E=Math.abs(C)>Math.abs(T)?"h":"v";if("touches"in x&&E==="h"&&A.type==="range")return!1;var I=GL(E,A);if(!I)return!0;if(I?R=E:(R=E==="v"?"h":"v",I=GL(E,A)),!I)return!1;if(!r.current&&"changedTouches"in x&&(C||T)&&(r.current=R),!R)return!0;var P=r.current||R;return SCe(P,w,x,P==="h"?C:T,!0)},[]),c=p.useCallback(function(x){var w=x;if(!(!zd.length||zd[zd.length-1]!==i)){var v="deltaY"in w?WL(w):wx(w),_=e.current.filter(function(R){return R.name===w.type&&R.target===w.target&&CCe(R.delta,v)})[0];if(_&&_.should){w.cancelable&&w.preventDefault();return}if(!_){var C=(o.current.shards||[]).map(HL).filter(Boolean).filter(function(R){return R.contains(w.target)}),T=C.length>0?l(w,C[0]):!o.current.noIsolation;T&&w.cancelable&&w.preventDefault()}}},[]),u=p.useCallback(function(x,w,v,_){var C={name:x,delta:w,target:v,should:_};e.current.push(C),setTimeout(function(){e.current=e.current.filter(function(T){return T!==C})},1)},[]),d=p.useCallback(function(x){n.current=wx(x),r.current=void 0},[]),h=p.useCallback(function(x){u(x.type,WL(x),x.target,l(x,t.lockRef.current))},[]),f=p.useCallback(function(x){u(x.type,wx(x),x.target,l(x,t.lockRef.current))},[]);p.useEffect(function(){return zd.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Bd),document.addEventListener("touchmove",c,Bd),document.addEventListener("touchstart",d,Bd),function(){zd=zd.filter(function(x){return x!==i}),document.removeEventListener("wheel",c,Bd),document.removeEventListener("touchmove",c,Bd),document.removeEventListener("touchstart",d,Bd)}},[]);var m=t.removeScrollBar,g=t.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:ECe(s)}):null,m?p.createElement(oU,{gapMode:"margin"}):null)}const NCe=sU(g7,ICe);var w7=p.forwardRef(function(t,e){return p.createElement(Qb,js({},t,{ref:e,sideCar:NCe}))});w7.classNames=Qb.classNames;const PCe=w7,ACe=[" ","Enter","ArrowUp","ArrowDown"],kCe=[" ","Enter"],Zb="Select",[e_,t_,RCe]=z_e(Zb),[Lf,Uje]=EA(Zb,[RCe,h7]),jA=h7(),[jCe,xd]=Lf(Zb),[DCe,MCe]=Lf(Zb),LCe=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:s,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:u,name:d,autoComplete:h,disabled:f,required:m}=t,g=jA(e),[x,w]=p.useState(null),[v,_]=p.useState(null),[C,T]=p.useState(!1),R=W_e(u),[A=!1,E]=zL({prop:r,defaultProp:s,onChange:i}),[I,P]=zL({prop:o,defaultProp:l,onChange:c}),k=p.useRef(null),j=x?!!x.closest("form"):!0,[D,M]=p.useState(new Set),G=Array.from(D).map(B=>B.props.value).join(";");return p.createElement(uCe,g,p.createElement(jCe,{required:m,scope:e,trigger:x,onTriggerChange:w,valueNode:v,onValueNodeChange:_,valueNodeHasChildren:C,onValueNodeHasChildrenChange:T,contentId:GG(),value:I,onValueChange:P,open:A,onOpenChange:E,dir:R,triggerPointerDownPosRef:k,disabled:f},p.createElement(e_.Provider,{scope:e},p.createElement(DCe,{scope:t.__scopeSelect,onNativeOptionAdd:p.useCallback(B=>{M(W=>new Set(W).add(B))},[]),onNativeOptionRemove:p.useCallback(B=>{M(W=>{const Q=new Set(W);return Q.delete(B),Q})},[])},n)),j?p.createElement(C7,{key:G,"aria-hidden":!0,required:m,tabIndex:-1,name:d,autoComplete:h,value:I,onChange:B=>P(B.target.value),disabled:f},I===void 0?p.createElement("option",{value:""}):null,Array.from(D)):null))},FCe="SelectTrigger",OCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...s}=t,i=jA(n),o=xd(FCe,n),l=o.disabled||r,c=Os(e,o.onTriggerChange),u=t_(n),[d,h,f]=E7(g=>{const x=u().filter(_=>!_.disabled),w=x.find(_=>_.value===o.value),v=T7(x,g,w);v!==void 0&&o.onValueChange(v.value)}),m=()=>{l||(o.onOpenChange(!0),f())};return p.createElement(dCe,kn({asChild:!0},i),p.createElement(_s.button,kn({type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":o.value===void 0?"":void 0},s,{ref:c,onClick:as(s.onClick,g=>{g.currentTarget.focus()}),onPointerDown:as(s.onPointerDown,g=>{const x=g.target;x.hasPointerCapture(g.pointerId)&&x.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&(m(),o.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)},g.preventDefault())}),onKeyDown:as(s.onKeyDown,g=>{const x=d.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&h(g.key),!(x&&g.key===" ")&&ACe.includes(g.key)&&(m(),g.preventDefault())})})))}),VCe="SelectValue",$Ce=p.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:o,...l}=t,c=xd(VCe,n),{onValueNodeHasChildrenChange:u}=c,d=i!==void 0,h=Os(e,c.onValueNodeChange);return wo(()=>{u(d)},[u,d]),p.createElement(_s.span,kn({},l,{ref:h,style:{pointerEvents:"none"}}),c.value===void 0&&o!==void 0?o:i)}),UCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...s}=t;return p.createElement(_s.span,kn({"aria-hidden":!0},s,{ref:e}),r||"▼")}),BCe=t=>p.createElement(fCe,kn({asChild:!0},t)),xf="SelectContent",zCe=p.forwardRef((t,e)=>{const n=xd(xf,t.__scopeSelect),[r,s]=p.useState();if(wo(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?gl.createPortal(p.createElement(b7,{scope:t.__scopeSelect},p.createElement(e_.Slot,{scope:t.__scopeSelect},p.createElement("div",null,t.children))),i):null}return p.createElement(GCe,kn({},t,{ref:e}))}),La=10,[b7,vd]=Lf(xf),GCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:x,avoidCollisions:w,...v}=t,_=xd(xf,n),[C,T]=p.useState(null),[R,A]=p.useState(null),E=Os(e,ge=>T(ge)),[I,P]=p.useState(null),[k,j]=p.useState(null),D=t_(n),[M,G]=p.useState(!1),B=p.useRef(!1);p.useEffect(()=>{if(C)return V0(C)},[C]),tSe();const W=p.useCallback(ge=>{const[Re,...Ue]=D().map(Ce=>Ce.ref.current),[ze]=Ue.slice(-1),he=document.activeElement;for(const Ce of ge)if(Ce===he||(Ce==null||Ce.scrollIntoView({block:"nearest"}),Ce===Re&&R&&(R.scrollTop=0),Ce===ze&&R&&(R.scrollTop=R.scrollHeight),Ce==null||Ce.focus(),document.activeElement!==he))return},[D,R]),Q=p.useCallback(()=>W([I,C]),[W,I,C]);p.useEffect(()=>{M&&Q()},[M,Q]);const{onOpenChange:H,triggerPointerDownPosRef:Y}=_;p.useEffect(()=>{if(C){let ge={x:0,y:0};const Re=ze=>{var he,Ce,Pe,ve;ge={x:Math.abs(Math.round(ze.pageX)-((he=(Ce=Y.current)===null||Ce===void 0?void 0:Ce.x)!==null&&he!==void 0?he:0)),y:Math.abs(Math.round(ze.pageY)-((Pe=(ve=Y.current)===null||ve===void 0?void 0:ve.y)!==null&&Pe!==void 0?Pe:0))}},Ue=ze=>{ge.x<=10&&ge.y<=10?ze.preventDefault():C.contains(ze.target)||H(!1),document.removeEventListener("pointermove",Re),Y.current=null};return Y.current!==null&&(document.addEventListener("pointermove",Re),document.addEventListener("pointerup",Ue,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Re),document.removeEventListener("pointerup",Ue,{capture:!0})}}},[C,H,Y]),p.useEffect(()=>{const ge=()=>H(!1);return window.addEventListener("blur",ge),window.addEventListener("resize",ge),()=>{window.removeEventListener("blur",ge),window.removeEventListener("resize",ge)}},[H]);const[V,$]=E7(ge=>{const Re=D().filter(he=>!he.disabled),Ue=Re.find(he=>he.ref.current===document.activeElement),ze=T7(Re,ge,Ue);ze&&setTimeout(()=>ze.ref.current.focus())}),z=p.useCallback((ge,Re,Ue)=>{const ze=!B.current&&!Ue;(_.value!==void 0&&_.value===Re||ze)&&(P(ge),ze&&(B.current=!0))},[_.value]),F=p.useCallback(()=>C==null?void 0:C.focus(),[C]),Z=p.useCallback((ge,Re,Ue)=>{const ze=!B.current&&!Ue;(_.value!==void 0&&_.value===Re||ze)&&j(ge)},[_.value]),fe=r==="popper"?qL:WCe,xe=fe===qL?{side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:x,avoidCollisions:w}:{};return p.createElement(b7,{scope:n,content:C,viewport:R,onViewportChange:A,itemRefCallback:z,selectedItem:I,onItemLeave:F,itemTextRefCallback:Z,focusSelectedItem:Q,selectedItemText:k,position:r,isPositioned:M,searchRef:V},p.createElement(PCe,{as:ug,allowPinchZoom:!0},p.createElement(nSe,{asChild:!0,trapped:_.open,onMountAutoFocus:ge=>{ge.preventDefault()},onUnmountAutoFocus:as(s,ge=>{var Re;(Re=_.trigger)===null||Re===void 0||Re.focus({preventScroll:!0}),ge.preventDefault()})},p.createElement(Q_e,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:ge=>ge.preventDefault(),onDismiss:()=>_.onOpenChange(!1)},p.createElement(fe,kn({role:"listbox",id:_.contentId,"data-state":_.open?"open":"closed",dir:_.dir,onContextMenu:ge=>ge.preventDefault()},v,xe,{onPlaced:()=>G(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:as(v.onKeyDown,ge=>{const Re=ge.ctrlKey||ge.altKey||ge.metaKey;if(ge.key==="Tab"&&ge.preventDefault(),!Re&&ge.key.length===1&&$(ge.key),["ArrowUp","ArrowDown","Home","End"].includes(ge.key)){let ze=D().filter(he=>!he.disabled).map(he=>he.ref.current);if(["ArrowUp","End"].includes(ge.key)&&(ze=ze.slice().reverse()),["ArrowUp","ArrowDown"].includes(ge.key)){const he=ge.target,Ce=ze.indexOf(he);ze=ze.slice(Ce+1)}setTimeout(()=>W(ze)),ge.preventDefault()}})}))))))}),WCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...s}=t,i=xd(xf,n),o=vd(xf,n),[l,c]=p.useState(null),[u,d]=p.useState(null),h=Os(e,E=>d(E)),f=t_(n),m=p.useRef(!1),g=p.useRef(!0),{viewport:x,selectedItem:w,selectedItemText:v,focusSelectedItem:_}=o,C=p.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&u&&x&&w&&v){const E=i.trigger.getBoundingClientRect(),I=u.getBoundingClientRect(),P=i.valueNode.getBoundingClientRect(),k=v.getBoundingClientRect();if(i.dir!=="rtl"){const he=k.left-I.left,Ce=P.left-he,Pe=E.left-Ce,ve=E.width+Pe,de=Math.max(ve,I.width),Me=window.innerWidth-La,Ge=IL(Ce,[La,Me-de]);l.style.minWidth=ve+"px",l.style.left=Ge+"px"}else{const he=I.right-k.right,Ce=window.innerWidth-P.right-he,Pe=window.innerWidth-E.right-Ce,ve=E.width+Pe,de=Math.max(ve,I.width),Me=window.innerWidth-La,Ge=IL(Ce,[La,Me-de]);l.style.minWidth=ve+"px",l.style.right=Ge+"px"}const j=f(),D=window.innerHeight-La*2,M=x.scrollHeight,G=window.getComputedStyle(u),B=parseInt(G.borderTopWidth,10),W=parseInt(G.paddingTop,10),Q=parseInt(G.borderBottomWidth,10),H=parseInt(G.paddingBottom,10),Y=B+W+M+H+Q,V=Math.min(w.offsetHeight*5,Y),$=window.getComputedStyle(x),z=parseInt($.paddingTop,10),F=parseInt($.paddingBottom,10),Z=E.top+E.height/2-La,fe=D-Z,xe=w.offsetHeight/2,ge=w.offsetTop+xe,Re=B+W+ge,Ue=Y-Re;if(Re<=Z){const he=w===j[j.length-1].ref.current;l.style.bottom="0px";const Ce=u.clientHeight-x.offsetTop-x.offsetHeight,Pe=Math.max(fe,xe+(he?F:0)+Ce+Q),ve=Re+Pe;l.style.height=ve+"px"}else{const he=w===j[0].ref.current;l.style.top="0px";const Pe=Math.max(Z,B+x.offsetTop+(he?z:0)+xe)+Ue;l.style.height=Pe+"px",x.scrollTop=Re-Z+x.offsetTop}l.style.margin=`${La}px 0`,l.style.minHeight=V+"px",l.style.maxHeight=D+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[f,i.trigger,i.valueNode,l,u,x,w,v,i.dir,r]);wo(()=>C(),[C]);const[T,R]=p.useState();wo(()=>{u&&R(window.getComputedStyle(u).zIndex)},[u]);const A=p.useCallback(E=>{E&&g.current===!0&&(C(),_==null||_(),g.current=!1)},[C,_]);return p.createElement(HCe,{scope:n,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:A},p.createElement("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:T}},p.createElement(_s.div,kn({},s,{ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}}))))}),qL=p.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=La,...i}=t,o=jA(n);return p.createElement(hCe,kn({},o,i,{ref:e,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[HCe,DA]=Lf(xf,{}),KL="SelectViewport",qCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=vd(KL,n),i=DA(KL,n),o=Os(e,s.onViewportChange),l=p.useRef(0);return p.createElement(p.Fragment,null,p.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),p.createElement(e_.Slot,{scope:n},p.createElement(_s.div,kn({"data-radix-select-viewport":"",role:"presentation"},r,{ref:o,style:{position:"relative",flex:1,overflow:"auto",...r.style},onScroll:as(r.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=i;if(h!=null&&h.current&&d){const f=Math.abs(l.current-u.scrollTop);if(f>0){const m=window.innerHeight-La*2,g=parseFloat(d.style.minHeight),x=parseFloat(d.style.height),w=Math.max(g,x);if(w<m){const v=w+f,_=Math.min(m,v),C=v-_;d.style.height=_+"px",d.style.bottom==="0px"&&(u.scrollTop=C>0?C:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})}))))}),KCe="SelectGroup",[Bje,YCe]=Lf(KCe),JCe="SelectLabel",XCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=YCe(JCe,n);return p.createElement(_s.div,kn({id:s.id},r,{ref:e}))}),e1="SelectItem",[QCe,_7]=Lf(e1),ZCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...o}=t,l=xd(e1,n),c=vd(e1,n),u=l.value===r,[d,h]=p.useState(i??""),[f,m]=p.useState(!1),g=Os(e,v=>{var _;return(_=c.itemRefCallback)===null||_===void 0?void 0:_.call(c,v,r,s)}),x=GG(),w=()=>{s||(l.onValueChange(r),l.onOpenChange(!1))};return p.createElement(QCe,{scope:n,value:r,disabled:s,textId:x,isSelected:u,onItemTextChange:p.useCallback(v=>{h(_=>{var C;return _||((C=v==null?void 0:v.textContent)!==null&&C!==void 0?C:"").trim()})},[])},p.createElement(e_.ItemSlot,{scope:n,value:r,disabled:s,textValue:d},p.createElement(_s.div,kn({role:"option","aria-labelledby":x,"data-highlighted":f?"":void 0,"aria-selected":u&&f,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1},o,{ref:g,onFocus:as(o.onFocus,()=>m(!0)),onBlur:as(o.onBlur,()=>m(!1)),onPointerUp:as(o.onPointerUp,w),onPointerMove:as(o.onPointerMove,v=>{if(s){var _;(_=c.onItemLeave)===null||_===void 0||_.call(c)}else v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:as(o.onPointerLeave,v=>{if(v.currentTarget===document.activeElement){var _;(_=c.onItemLeave)===null||_===void 0||_.call(c)}}),onKeyDown:as(o.onKeyDown,v=>{var _;((_=c.searchRef)===null||_===void 0?void 0:_.current)!==""&&v.key===" "||(kCe.includes(v.key)&&w(),v.key===" "&&v.preventDefault())})}))))}),bx="SelectItemText",eEe=p.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,...i}=t,o=xd(bx,n),l=vd(bx,n),c=_7(bx,n),u=MCe(bx,n),[d,h]=p.useState(null),f=Os(e,v=>h(v),c.onItemTextChange,v=>{var _;return(_=l.itemTextRefCallback)===null||_===void 0?void 0:_.call(l,v,c.value,c.disabled)}),m=d==null?void 0:d.textContent,g=p.useMemo(()=>p.createElement("option",{key:c.value,value:c.value,disabled:c.disabled},m),[c.disabled,c.value,m]),{onNativeOptionAdd:x,onNativeOptionRemove:w}=u;return wo(()=>(x(g),()=>w(g)),[x,w,g]),p.createElement(p.Fragment,null,p.createElement(_s.span,kn({id:c.textId},i,{ref:f})),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?gl.createPortal(i.children,o.valueNode):null)}),tEe="SelectItemIndicator",nEe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return _7(tEe,n).isSelected?p.createElement(_s.span,kn({"aria-hidden":!0},r,{ref:e})):null}),YL="SelectScrollUpButton",rEe=p.forwardRef((t,e)=>{const n=vd(YL,t.__scopeSelect),r=DA(YL,t.__scopeSelect),[s,i]=p.useState(!1),o=Os(e,r.onScrollButtonChange);return wo(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=l.scrollTop>0;i(u)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),s?p.createElement(S7,kn({},t,{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}})):null}),JL="SelectScrollDownButton",sEe=p.forwardRef((t,e)=>{const n=vd(JL,t.__scopeSelect),r=DA(JL,t.__scopeSelect),[s,i]=p.useState(!1),o=Os(e,r.onScrollButtonChange);return wo(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=l.scrollHeight-l.clientHeight,d=Math.ceil(l.scrollTop)<u;i(d)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),s?p.createElement(S7,kn({},t,{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}})):null}),S7=p.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=t,i=vd("SelectScrollButton",n),o=p.useRef(null),l=t_(n),c=p.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),wo(()=>{var u;const d=l().find(h=>h.ref.current===document.activeElement);d==null||(u=d.ref.current)===null||u===void 0||u.scrollIntoView({block:"nearest"})},[l]),p.createElement(_s.div,kn({"aria-hidden":!0},s,{ref:e,style:{flexShrink:0,...s.style},onPointerDown:as(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:as(s.onPointerMove,()=>{var u;(u=i.onItemLeave)===null||u===void 0||u.call(i),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:as(s.onPointerLeave,()=>{c()})}))}),iEe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return p.createElement(_s.div,kn({"aria-hidden":!0},r,{ref:e}))}),C7=p.forwardRef((t,e)=>{const{value:n,...r}=t,s=p.useRef(null),i=Os(e,s),o=pCe(n);return p.useEffect(()=>{const l=s.current,c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==n&&d){const h=new Event("change",{bubbles:!0});d.call(l,n),l.dispatchEvent(h)}},[o,n]),p.createElement(gCe,{asChild:!0},p.createElement("select",kn({},r,{ref:i,defaultValue:n})))});C7.displayName="BubbleSelect";function E7(t){const e=hl(t),n=p.useRef(""),r=p.useRef(0),s=p.useCallback(o=>{const l=n.current+o;e(l),function c(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(l)},[e]),i=p.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function T7(t,e,n){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=oEe(t,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function oEe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}const aEe=LCe,I7=OCe,lEe=$Ce,cEe=UCe,uEe=BCe,N7=zCe,dEe=qCe,P7=XCe,A7=ZCe,hEe=eEe,fEe=nEe,k7=rEe,R7=sEe,j7=iEe,gc=aEe,yc=lEe,Za=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(I7,{ref:r,className:Ct("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,a.jsx(cEe,{asChild:!0,children:a.jsx(Iu,{className:"h-4 w-4 opacity-50"})})]}));Za.displayName=I7.displayName;const D7=ht.forwardRef(({className:t,...e},n)=>a.jsx(k7,{ref:n,className:Ct("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(L3,{className:"h-4 w-4"})}));D7.displayName=k7.displayName;const M7=ht.forwardRef(({className:t,...e},n)=>a.jsx(R7,{ref:n,className:Ct("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(Iu,{className:"h-4 w-4"})}));M7.displayName=R7.displayName;const el=ht.forwardRef(({className:t,children:e,position:n="popper",...r},s)=>a.jsx(uEe,{children:a.jsxs(N7,{ref:s,className:Ct("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[a.jsx(D7,{}),a.jsx(dEe,{className:Ct("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),a.jsx(M7,{})]})}));el.displayName=N7.displayName;const mEe=ht.forwardRef(({className:t,...e},n)=>a.jsx(P7,{ref:n,className:Ct("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));mEe.displayName=P7.displayName;const rr=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(A7,{ref:r,className:Ct("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(fEe,{children:a.jsx(Ig,{className:"h-4 w-4"})})}),a.jsx(hEe,{children:e})]}));rr.displayName=A7.displayName;const pEe=ht.forwardRef(({className:t,...e},n)=>a.jsx(j7,{ref:n,className:Ct("-mx-1 my-1 h-px bg-muted",t),...e}));pEe.displayName=j7.displayName;const gEe=({isOpen:t,onClose:e,designs:n,onContinue:r})=>{const[s,i]=p.useState([]),[o,l]=p.useState({}),[c,u]=p.useState(""),[d,h]=p.useState(null),{toast:f}=bs();p.useEffect(()=>{n&&i(n)},[n]);const m=(_,C)=>{const T=so.find(R=>R.name===C);T&&i(R=>{const A=[...R];return A[_].podProductInfo=T,A[_].name=T.name,A})},g=_=>{const C=s[_],T={...C,id:Dt()};i(R=>[...R,T]),f({title:"Design Duplicated",description:`A copy of ${C.name} has been added.`})},x=_=>{const C=s[_];i(T=>T.filter((R,A)=>A!==_)),f({title:"Design Removed",description:`${C.name} has been removed.`,variant:"destructive"})},w=async _=>{if(!c){f({title:"Prompt Required",description:"Please enter a prompt to edit the image.",variant:"destructive"});return}l({[_]:{edit:!0}});const C=s[_];try{const{base64ImageData:T,mimeType:R}=await cg(C.images[0]),A=await Wo(T,R,c);if(A&&A.editedImageData){const E=[...s],I=`data:${A.newMimeType};base64,${A.editedImageData}`;E[_].images[0]=I,i(E),f({title:"Design Edited",description:"The design has been updated.",variant:"success"})}else throw new Error("Failed to get edited image data.")}catch(T){console.error("Error editing design:",T),f({title:"Edit Failed",description:T.message,variant:"destructive"})}finally{l({}),h(null),u("")}},v=async _=>{if(!c){f({title:"Prompt Required",description:"Please enter a prompt to replace the image.",variant:"destructive"});return}l({[_]:{replace:!0}});try{const C=await Ag({prompt:c});if(C&&C.imageData){const T=[...s],R=`data:${C.imageMimeType};base64,${C.imageData}`;T[_].images[0]=R,i(T),f({title:"Design Replaced",description:"A new design has been generated.",variant:"success"})}else throw new Error("Failed to get new image data.")}catch(C){console.error("Error replacing design:",C),f({title:"Replace Failed",description:C.message,variant:"destructive"})}finally{l({}),h(null),u("")}};return t?a.jsx(Xr,{open:t,onOpenChange:_=>!_&&e(),children:a.jsxs(Ur,{className:"max-w-4xl",children:[a.jsxs(Br,{children:[a.jsx(zr,{children:"Review and Edit Your Designs"}),a.jsx(Zi,{children:"Modify the generated designs before we create your logo and products."})]}),a.jsx(xs,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pr-4",children:s.map((_,C)=>{var T,R,A,E;return a.jsxs(Je,{className:"p-4 space-y-3 flex flex-col",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:_.images[0],alt:`Design for ${_.name}`,className:"w-full h-48 object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6",onClick:()=>x(C),children:a.jsx(Wn,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow space-y-2",children:[a.jsx("h4",{className:"font-semibold",children:_.name}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:`product-type-${C}`,className:"text-sm font-medium",children:"Product Type"}),a.jsxs(gc,{value:_.podProductInfo.name,onValueChange:I=>m(C,I),children:[a.jsx(Za,{children:a.jsx(yc,{placeholder:"Select product type"})}),a.jsx(el,{children:so.map(I=>a.jsx(rr,{value:I.name,children:I.name},I.name))})]})]})]}),d===C?a.jsxs("div",{className:"space-y-2 mt-auto",children:[a.jsx(Pn,{placeholder:"Enter prompt to edit or replace...",value:c,onChange:I=>u(I.target.value)}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{onClick:()=>w(C),disabled:(T=o[C])==null?void 0:T.edit,children:[(R=o[C])!=null&&R.edit?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(ew,{className:"mr-2 h-4 w-4"}),"Apply Edit"]}),a.jsxs(O,{onClick:()=>v(C),disabled:(A=o[C])==null?void 0:A.replace,children:[(E=o[C])!=null&&E.replace?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(G3,{className:"mr-2 h-4 w-4"}),"Replace"]}),a.jsx(O,{variant:"ghost",onClick:()=>h(null),children:"Cancel"})]})]}):a.jsxs(O,{onClick:()=>{h(C),u("")},className:"w-full",children:[a.jsx(Er,{className:"mr-2 h-4 w-4"})," Edit or Replace"]}),a.jsxs(O,{onClick:()=>g(C),variant:"outline",className:"w-full mt-2",children:[a.jsx(RI,{className:"mr-2 h-4 w-4"})," Duplicate"]})]},_.id||C)})})}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel Generation"}),a.jsx(O,{type:"button",onClick:()=>r(s),children:"Continue with These Designs"})]})]})}):null},ar="/placeholder-image.png",L7=p.createContext(null),zn=()=>{const t=p.useContext(L7);if(!t)throw new Error("useStore must be used within a StoreProvider");return t},XL="ecommerce-cart",yEe=({children:t})=>{const[e,n]=p.useState([]),[r,s]=p.useState(null),[i,o]=p.useState(!1),[l,c]=p.useState(0),[u,d]=p.useState(""),[h,f]=p.useState(!1),[m,g]=p.useState([]),[x,w]=p.useState("published"),{toast:v}=bs(),_=bi(),{user:C,session:T,profile:R}=eo(),A=ae=>{ae==="published"||ae==="edit"?w(ae):(console.warn(`Invalid view mode: ${ae}. Defaulting to 'published'.`),w("published"))},[E,I]=p.useState(0),[P,k]=p.useState(""),[j,D]=p.useState(""),[M,G]=p.useState(null),[B,W]=p.useState({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[Q,H]=p.useState({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[Y,V]=p.useState(null),[$,z]=p.useState(!1),[F,Z]=p.useState(null),[fe,xe]=p.useState(null),[ge,Re]=p.useState(!1),[Ue,ze]=p.useState(null),[he,Ce]=p.useState(null),[Pe,ve]=p.useState(!1),[de,Me]=p.useState(!1),[Ge,yt]=p.useState(!1),[Pt,en]=p.useState([]),[fn,an]=p.useState(null),[dn,Lt]=p.useState(!1),[xn,te]=p.useState(!1),[Ee,ee]=p.useState([]),[le,K]=p.useState(null),[Ae,Ne]=p.useState(!1),Oe=p.useCallback(({newProducts:ae,newCollection:se})=>{en(re=>[...re,...ae]),an(re=>({...re,collections:[...(re==null?void 0:re.collections)||[],se]})),v({title:"POD Items Added",description:`${ae.length} products and 1 collection are ready for finalization.`,variant:"success"})},[en,an,v]),[He,ce]=p.useState(0),[_e,Be]=p.useState(""),[Te,Et]=p.useState(""),[wt,xt]=p.useState(null),[pt,At]=p.useState({items:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[On,Tn]=p.useState(!1),[mr,mn]=p.useState(null),Ft=async(ae,se)=>{if(!ae||!se)return console.error("Missing base64 string or path for Firebase Storage upload."),null;const re=ae.split(",")[1];if(!re)return console.error("Invalid base64 string provided for upload."),null;const oe=vh(wh,se),ke={contentType:"image/png"};try{const $e=atob(re),We=new Array($e.length);for(let $t=0;$t<$e.length;$t++)We[$t]=$e.charCodeAt($t);const nt=new Uint8Array(We),tt=await yh(oe,nt,ke),mt=await xh(tt.ref);return console.log(`Uploaded ${se} to Firebase Storage. URL: ${mt}`),mt}catch($e){throw console.error(`Error uploading ${se} to Firebase Storage:`,$e),$e}},Xt=p.useCallback(ae=>ae?ae.map(se=>{const re={...se};if(re.logo_url&&re.logo_url.startsWith("data:image/")&&re.logo_url.length>2048&&(re.logo_url=`${re.logo_url.substring(0,30)}...[truncated]`),re.hero_image&&re.hero_image.src){const oe={...re.hero_image.src};oe.large&&oe.large.startsWith("data:image/")&&oe.large.length>2048&&(oe.large=`${oe.large.substring(0,30)}...[truncated]`),oe.medium&&oe.medium.startsWith("data:image/")&&oe.medium.length>2048&&(oe.medium=`${oe.medium.substring(0,30)}...[truncated]`),re.hero_image={...re.hero_image,src:oe}}return re.products&&Array.isArray(re.products)&&(re.products=re.products.map(oe=>{const ke={...oe};if(ke.image&&ke.image.src){const $e={...ke.image.src};$e.medium&&$e.medium.startsWith("data:image/")&&$e.medium.length>2048&&($e.medium=`${$e.medium.substring(0,30)}...[truncated]`),$e.large&&$e.large.startsWith("data:image/")&&$e.large.length>2048&&($e.large=`${$e.large.substring(0,30)}...[truncated]`),ke.image={...ke.image,src:$e}}return ke})),re.collections&&Array.isArray(re.collections)&&(re.collections=re.collections.map(oe=>{const{products:ke,...$e}=oe;return $e})),re}):[],[]),or=p.useCallback(async()=>{f(!0),console.log("[StoreContext] loadStores called for all public stores.");let ae=[],se=[];const re=localStorage.getItem("ecommerce-stores");if(re)try{ae=JSON.parse(re),console.log(`[StoreContext] Loaded ${ae.length} stores from localStorage.`)}catch(ke){console.error("[StoreContext] Failed to parse localStorage stores:",ke),v({title:"Local Cache Error",description:"Failed to load stores from local cache.",variant:"warning"}),ae=[]}n(ae),console.log("[StoreContext] Fetching all public stores from Firestore.");try{const ke=Ai(Nn,"stores"),$e=await ki(ke);if($e.empty)console.log("[StoreContext] No public stores found in Firestore.");else{console.log(`[StoreContext] Fetched ${$e.size} stores from Firestore. Processing details...`);const We=$e.docs.map(tt=>({id:tt.id,...tt.data()}));se=await Promise.all(We.map(async tt=>{var mt,$t;try{const Ht=Ai(Nn,"stores",tt.id,"products"),rt=(await ki(Ht)).docs.map(kt=>({id:kt.id,...kt.data()})).map(kt=>{let jn={src:{large:"",medium:""}};return kt.images&&Array.isArray(kt.images)&&kt.images.length>0&&(jn.src.large=kt.images[0],jn.src.medium=kt.images[0]),{...kt,price:kt.priceAmount,image:jn,variants:kt.variants||[]}}),bt={...tt,createdAt:(($t=(mt=tt.created_at)==null?void 0:mt.toDate())==null?void 0:$t.toISOString())||new Date().toISOString()};let hn=[];const Hr=Ai(Nn,"stores",tt.id,"collections"),rs=(await ki(Hr)).docs.map(kt=>({id:kt.id,...kt.data()}));return rs&&rs.length>0&&(hn=await Promise.all(rs.map(async kt=>{let jn=[];return kt.product_ids&&kt.product_ids.length>0&&(jn=rt.filter(pr=>kt.product_ids.includes(pr.id))),{...kt,image:{src:kt.image_url||""},products:jn}}))),{...bt,products:rt,collections:hn}}catch(Ht){return console.error(`[StoreContext] Critical error processing details for store ${tt.id}:`,Ht),{...tt,products:[],collections:[]}}})),console.log(`[StoreContext] Finished processing details for ${se.length} cloud stores.`)}}catch(ke){console.error("[StoreContext] Overall critical error in fetching cloud stores:",ke),v({title:"Cloud Loading Error",description:"A critical error occurred while fetching cloud store data.",variant:"destructive"})}const oe=[...ae];se.forEach(ke=>{const $e=oe.findIndex(We=>We.id===ke.id);$e>-1?oe[$e]=ke:oe.push(ke)}),oe.sort((ke,$e)=>new Date($e.createdAt||$e.created_at)-new Date(ke.createdAt||ke.created_at)),n(oe);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Xt(oe))),console.log("[StoreContext] Updated localStorage with merged stores.")}catch(ke){console.error("[StoreContext] Failed to save merged stores to localStorage:",ke),v({title:"Local Cache Update Failed",description:"Could not update the local cache after cloud sync.",variant:"warning",duration:7e3})}f(!1),console.log(`[StoreContext] loadStores finished. isLoadingStores: false. Final stores count: ${e.length}`)},[v,Nn,Xt]),J=p.useCallback(async(ae,se)=>{var ke,$e;const re=e.find(We=>We.id===ae);if(!re){console.warn(`[StoreContext] updateStore: Store with ID ${ae} not found in current state.`),v({title:"Update Failed",description:"Store not found for update.",variant:"destructive"});return}const oe={...re,...se};if(console.log(`[StoreContext] updateStore: updatedLocalStore for store ${ae} - Products: ${((ke=oe.products)==null?void 0:ke.length)||0}, Collections: ${(($e=oe.collections)==null?void 0:$e.length)||0}`),n(We=>{const nt=We.map(tt=>tt.id===ae?oe:tt);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Xt(nt))),console.log(`[StoreContext] updateStore: Saved ${nt.length} stores to localStorage.`)}catch(tt){console.error("Failed to save stores to localStorage during update:",tt),v({title:"Local Cache Update Failed",description:"Could not update the local cache for the store.",variant:"warning",duration:7e3})}return nt}),r&&r.id===ae&&(s(oe),console.log(`[StoreContext] updateStore: currentStore updated for store ${ae}.`)),v({title:"Store Updated (Locally)",description:"Changes saved locally."}),C){f(!0);try{const{settings:We,products:nt,collections:tt,user_id:mt,...$t}=se,Ht=Ps(Nn,"stores",ae);await dm(Ht,$t),console.log(`Store ${ae} synced to Firestore asynchronously.`)}catch(We){console.error("Unexpected error during async Firestore updateStore:",We),v({title:"Cloud Sync Error",description:"An unexpected error occurred during cloud sync.",variant:"destructive"})}finally{f(!1)}}},[e,C,v,r,s,n,f,Xt]),ue=async(ae,se,re,oe,ke)=>{if(!oe){ke({title:"Authentication Required",description:"You must be logged in to update collections.",variant:"destructive"});return}n($e=>{const We=$e.map(nt=>{if(nt.id===ae){const tt=nt.collections.map(mt=>mt.id===se?{...mt,products:re}:mt);return{...nt,collections:tt}}return nt});return localStorage.setItem("ecommerce-stores",JSON.stringify(Xt(We))),We}),r&&r.id===ae&&s($e=>{const We=$e.collections.map(nt=>nt.id===se?{...nt,products:re}:nt);return{...$e,collections:We}});try{const $e=Ps(Nn,"stores",ae,"collections",se),We=re.map(nt=>nt.id);await dm($e,{product_ids:We}),ke({title:"Collection Updated",description:"Your collection has been successfully updated."})}catch($e){console.error("Error updating collection in Firestore:",$e),ke({title:"Error",description:"Failed to update the collection in the cloud.",variant:"destructive"})}},we=p.useCallback(async(ae,se)=>{if(!r||!r.id){v({title:"Error",description:"No current store selected to update.",variant:"destructive"});return}if(typeof ae!="string"||ae.trim()===""){v({title:"Error",description:"Invalid identifier for text content.",variant:"destructive"});return}const re=r.id,oe=typeof r.content=="object"&&r.content!==null?r.content:{};let ke=JSON.parse(JSON.stringify(oe));const $e=ae.split(".");let We=ke;for(let nt=0;nt<$e.length-1;nt++){const tt=$e[nt];(!We[tt]||typeof We[tt]!="object")&&(We[tt]={}),We=We[tt]}We[$e[$e.length-1]]=se,await J(re,{content:ke})},[r,J,v]);p.useEffect(()=>{localStorage.setItem(XL,JSON.stringify(m))},[m]),p.useEffect(()=>{const ae=localStorage.getItem(XL);if(ae)try{g(JSON.parse(ae))}catch(se){console.error("Failed to parse stored cart:",se)}},[]);const Le=async ae=>{let se={...ae};try{const rt=se.type||se.name||"business",bt=await lo(rt,1);bt.length>0&&(se.card_background_url=bt[0].src.large)}catch(rt){console.error("Failed to fetch background image from Pexels:",rt),se.card_background_url=ar}const re=se.name||`Store-${Dt().substring(0,6)}`;se.name||(se.name=re);const oe=await Ze(re);if(!oe.available){const rt=oe.error===!0?`Failed to verify store name "${re}". Please try again.`:`The store name "${re}" or a similar URL is already in use. Please choose a different name.`;throw v({title:"Store Name Unavailable",description:rt,variant:"destructive"}),new Error(rt)}se.urlSlug=oe.slug,se.template_version||(se.template_version="v1");const ke=await m_e(se);if(ke.tags&&ke.tags.length>0)se.tags=ke.tags;else{const rt=se.niche||"",bt=_A.filter(hn=>rt.toLowerCase().includes(hn.toLowerCase()));bt.length===0&&bt.push("general"),se.tags=bt}se.niche=se.tags[0];const $e=se.id||Dt();let We={...se,id:$e,createdAt:new Date().toISOString()},nt=We.products||[];const tt=new Map;let mt=[];if(nt=nt.map(rt=>({...rt,id:rt.id||Dt()})),nt.forEach(rt=>{tt.set(rt.name,rt.id)}),C&&C.uid){We.merchant_id=C.uid;try{const{id:rt,settings:bt,products:hn,collections:Hr,user_id:jr,...rs}=We,kt=Ps(Nn,"stores",rt);let jn=rs.logo_url;if(jn&&jn.startsWith("data:image/"))try{const Zn=`store_logos/${rt}/logo_${Dt()}.png`;jn=await Ft(jn,Zn)}catch(Zn){console.error("Error uploading store logo to Firebase Storage:",Zn),v({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),jn=ar}else jn||(jn=ar);let pr=rs.logo_url_light;if(pr&&pr.startsWith("data:image/"))try{const Zn=`store_logos/${rt}/logo_light_${Dt()}.png`;pr=await Ft(pr,Zn)}catch(Zn){console.error("Error uploading store logo to Firebase Storage:",Zn),v({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),pr=ar}let Ei=rs.logo_url_dark;if(Ei&&Ei.startsWith("data:image/"))try{const Zn=`store_logos/${rt}/logo_dark_${Dt()}.png`;Ei=await Ft(Ei,Zn)}catch(Zn){console.error("Error uploading store logo to Firebase Storage:",Zn),v({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),Ei=ar}const Cd={...rs,merchant_id:C.uid,created_at:new Date,logo_url:jn||ar,logo_url_light:pr,logo_url_dark:Ei,urlSlug:We.urlSlug,name_lowercase:We.name.toLowerCase(),card_background_url:We.card_background_url,tags:We.tags};if(await mp(kt,Cd),console.log(`Store ${rt} saved to Firestore asynchronously.`),We.products&&We.products.length>0){const Zn=[];for(const Un of We.products){let qn=[];if(Un.images&&Array.isArray(Un.images))for(const Zo of Un.images)if(Zo.startsWith("data:image/"))try{const Ti=`store_products/${rt}/${Un.id||Dt()}/${Dt()}.png`,er=await Ft(Zo,Ti);er?qn.push(er):qn.push(ar)}catch(Ti){console.error(`Error uploading product image for ${Un.name}:`,Ti),v({title:"Product Image Upload Failed",description:`Could not upload image for ${Un.name}.`,variant:"warning"}),qn.push(ar)}else Zo?qn.push(Zo):qn.push(ar);qn.length===0&&qn.push(ar);const to={store_id:rt,name:Un.name||`Product ${Dt().substring(0,8)}`,description:Un.description||"No description available.",images:qn,priceAmount:Number(Un.price)>=0?Number(Un.price):0,currency:"usd",inventory:10,variants:Un.variants||[],created_at:new Date},So=Ps(Nn,"stores",rt,"products",Un.id||Dt());Zn.push(mp(So,to)),tt.set(Un.name,So.id)}await Promise.all(Zn)}if(We.collections&&We.collections.length>0){const Zn=[];for(const Un of We.collections){let qn=Un.imageUrl;if(qn&&qn.startsWith("data:image/"))try{const Ti=`store_collections/${rt}/${Un.id||Dt()}/${Dt()}.png`;qn=await Ft(qn,Ti)}catch(Ti){console.error("Error uploading collection image to Firebase Storage:",Ti),v({title:"Collection Image Upload Failed",description:"Could not upload collection image.",variant:"warning"}),qn=ar}else qn||(qn=ar);const to=(Un.product_ids||[]).map(Ti=>tt.get(Ti)).filter(Boolean),So={store_id:rt,name:Un.name,description:Un.description,image_url:qn||ar,product_ids:to,created_at:new Date},Zo=Ps(Nn,"stores",rt,"collections",Un.id||Dt());Zn.push(mp(Zo,So)),mt.push({id:Zo.id,...So})}await Promise.all(Zn)}}catch(rt){console.error("Overall async Firestore store creation error. Code:",rt.code,"Message:",rt.message,"Full Error:",rt),setTimeout(()=>{v({title:"Cloud Sync Error",description:`Firestore error (${rt.code||"Unknown Code"}): ${rt.message}`,variant:"destructive"})},0)}}else C&&!C.uid&&(console.error("Firestore save skipped: User object is present but user.uid is undefined."),setTimeout(()=>{v({title:"User UID Missing",description:"Cannot save to cloud: User UID is missing. Please try logging out and back in.",variant:"destructive"})},0));let $t=[];const Ht=We.collections||[],Rn=nt.map(rt=>{const bt=Array.isArray(rt.images)&&rt.images.length>0?rt.images[0]:ar;return{...rt,image:{src:{medium:bt,large:bt}}}});Ht.length>0&&($t=Ht.map(rt=>{let bt={};if(C&&mt&&mt.length>0){const jr=mt.find(rs=>rs.name===rt.name);jr&&(bt=jr)}let hn=[];rt.product_ids&&rt.product_ids.length>0&&rt.product_ids.forEach(jr=>{const rs=tt.get(jr);let kt=null;rs?(kt=Rn.find(jn=>jn.id===rs),kt||jr!==rs&&(kt=Rn.find(jn=>jn.id===jr))):kt=Rn.find(jn=>jn.id===jr),kt&&hn.push(kt)});const Hr=(bt==null?void 0:bt.image_url)||rt.imageUrl||"";return{...rt,...bt,image:{src:Hr},products:hn}}));const Hn={...We,products:Rn,collections:$t};return n(rt=>{const bt=[Hn,...rt.filter(hn=>hn.id!==Hn.id)];try{localStorage.setItem("ecommerce-stores",JSON.stringify(Xt(bt)))}catch(hn){console.error("Failed to save stores to localStorage during store creation:",hn),v({title:"Local Cache Update Failed",description:"Could not update the local cache after creating the store.",variant:"warning",duration:7e3})}return bt}),s(Hn),Hn},Ze=async ae=>{if(!ae||typeof ae!="string"||ae.trim()==="")return{available:!0,slug:"",error:"Name cannot be empty."};const se=pc(ae.trim());if(!se)return{available:!0,slug:"",error:"Invalid name for URL generation."};try{const re=Ai(Nn,"stores"),oe=zT(re,GT("urlSlug","==",se));return{available:(await ki(oe)).empty,slug:se}}catch(re){return console.error("Error checking store name availability:",re),v({title:"Name Check Failed",description:"Could not verify store name uniqueness.",variant:"destructive"}),{available:!1,slug:se,error:!0}}},X=async ae=>{var se,re;o(!0),c(0),d("Initializing wizard-based store generation...");try{const oe=await P_e(ae,{fetchPexelsImages:lo,generateId:Dt}),ke=await Le(oe);return c(100),d("Store generation complete!"),ke}catch(oe){return console.error("Error generating store from wizard:",oe),!((se=oe.message)!=null&&se.includes("already in use"))&&!((re=oe.message)!=null&&re.includes("Failed to verify store name"))&&v({title:"Wizard Generation Failed",description:oe.message||"Failed to generate store.",variant:"destructive"}),c(0),d("Generation failed."),null}finally{o(!1)}},ne=async(ae,se=null,re=null,oe=[],ke=!1,$e=!1,We=[],nt=[])=>{o(!0),c(0),d("Initializing generation...");try{if(ke){d("Generating initial designs...");const mt=[so.find(Ht=>Ht.name==="Canvas"),so.find(Ht=>Ht.name==="Hat"),so.find(Ht=>Ht.name==="Black hoodie"),so.find(Ht=>Ht.name==="Mug"),so.find(Ht=>Ht.name==="Notebook"),so.find(Ht=>Ht.name==="Pillow")].filter(Boolean);let $t=[];if(mt.length>0){const Ht=mt.slice(0,6);let Rn=null;if(We&&We.length>0){const Hn=We.find(rt=>rt.file.type.startsWith("image/"));if(Hn)try{const{base64ImageData:rt,mimeType:bt}=await h_e(Hn.file);Rn={base64Data:rt,mimeType:bt},d("Processing reference image...")}catch(rt){console.error("Error processing reference image:",rt),v({title:"Image Error",description:"Could not process the uploaded reference image.",variant:"destructive"})}}for(const[Hn,rt]of Ht.entries()){c(Hn/Ht.length*100),d(`Generating design for ${rt.name}...`);const bt=await Ag({prompt:ae,referenceImage:Rn});if(bt&&bt.imageData){const hn=`data:${bt.imageMimeType};base64,${bt.imageData}`;$t.push({id:Dt(),name:rt.name,images:[hn],podProductInfo:rt})}}}K({prompt:ae,storeNameOverride:se,productTypeOverride:re}),ee($t),te(!0),o(!1);return}let tt;if(nt.length>0){const mt=(Rn,Hn)=>{c(Rn),Hn&&d(Hn)};tt=await qS(ae,{storeNameOverride:se,productTypeOverride:re,fetchPexelsImages:lo,generateId:Dt,isPrintOnDemand:!1,isDropshipping:!0,contextFiles:We,contextURLs:[],generateProducts:!1},mt);const $t=nt.map(Rn=>({id:String(Rn.item.itemId),name:Rn.item.title,description:Rn.item.title,price:parseFloat(Rn.item.sku.def.promotionPrice)||0,images:[Rn.item.image],isDropshipping:!0,inventory:10}));tt.products=$t;const Ht=await KS(tt.type,tt.name,$t,!1,!0,mt,70,20,Dt);tt.collections=Ht}else{const mt=($t,Ht)=>{c($t),Ht&&d(Ht)};if(tt=await qS(ae,{storeNameOverride:se,productTypeOverride:re,fetchPexelsImages:lo,generateId:Dt,isPrintOnDemand:!1,contextFiles:We,contextURLs:[]},mt),tt.products.length>0){const $t=await KS(tt.type,tt.name,tt.products,ke,$e,mt,70,20,Dt);tt.collections=$t}}en(tt.products||[]),an(tt),o(!1),yt(!0),d("Products generated. Please review and finalize."),c(90)}catch(tt){console.error("Error generating store from prompt:",tt),v({title:"Generation Failed",description:tt.message||"Failed to generate store.",variant:"destructive"}),c(0),d("Generation failed."),o(!1)}},me=async ae=>{te(!1),o(!0),c(0),d("Re-visualizing designs on products...");const{prompt:se,storeNameOverride:re,productTypeOverride:oe}=le;let ke=[];try{for(const[tt,mt]of ae.entries()){const $t=tt/ae.length*50;c($t);const Ht=mt.podProductInfo,Rn=mt.images[0],{base64ImageData:Hn,mimeType:rt}=await cg(Rn);d(`Visualizing design on ${Ht.name}...`);const bt=await Bp(Hn,rt,Ht.imageUrl,se,Ht.name);if(bt&&bt.visualizedImageData&&bt.productDetails){const hn=`data:${bt.visualizedImageMimeType};base64,${bt.visualizedImageData}`;ke.push({id:Dt(),name:bt.productDetails.title||`${Ht.name} with design`,description:bt.productDetails.description||`A unique ${Ht.name}.`,price:bt.productDetails.price||"29.99",images:[Rn,hn],variants:bt.productDetails.variants||[],isPrintOnDemand:!0,inventory:10,podDetails:{originalDesignImageUrl:Rn,designPrompt:se,baseProductName:Ht.name,baseProductImageUrl:Ht.imageUrl},category:Ht.category||"Print on Demand"})}}const $e=(tt,mt)=>{c(50+tt/2),mt&&d(mt)};let We=await qS(se,{storeNameOverride:re,productTypeOverride:oe,fetchPexelsImages:lo,generateId:Dt,isPrintOnDemand:!0},$e);const nt=[...ke,...We.products||[]];if(We.products=nt,We.products.length>0){const tt=await KS(We.type,We.name,We.products,!0,!1,$e,80,10,Dt);We.collections=tt}en(nt),an(We),o(!1),yt(!0),d("Products generated. Please review and finalize."),c(90)}catch($e){console.error("Error continuing store generation:",$e),v({title:"Generation Failed",description:$e.message||"Failed to continue store generation.",variant:"destructive"}),c(0),d("Generation failed."),o(!1)}},q=async(ae,se,re,oe=null)=>{if(!ae)return v({title:"Error",description:"Missing design image for POD collection generation.",variant:"destructive"}),null;if(oe===null)console.log("Generating POD collection data for pre-finalization stage.");else{if(!oe)return v({title:"Error",description:"Store ID is invalid for updating POD collection.",variant:"destructive"}),null;console.log(`Generating POD collection for existing store: ${oe}`)}Lt(!0),v({title:"Generating POD Collection",description:"Applying design to all mockups..."});let ke=[],$e=`Collection from ${re} Design`;try{const{base64ImageData:We,mimeType:nt}=await cg(ae);for(const mt of so){if(mt.name===re){console.log(`Skipping visualization for base product: ${re}`);continue}console.log(`Visualizing design on mockup: ${mt.name}`);const $t=await Bp(We,nt,mt.imageUrl,se||`Product based on ${re} design`,mt.name);if($t&&$t.visualizedImageData&&$t.productDetails){const Ht=`data:${$t.visualizedImageMimeType};base64,${$t.visualizedImageData}`;ke.push({id:Dt(),name:$t.productDetails.title,price:parseFloat($t.productDetails.price),description:$t.productDetails.description,images:[Ht],isPrintOnDemand:!0,inventory:10,podDetails:{originalDesignImageUrl:ae,designPrompt:se,baseProductName:mt.name,baseProductImageUrl:mt.imageUrl},variants:$t.productDetails.variants||[]})}else console.warn(`Failed to visualize design on ${mt.name} for collection. Error: ${$t==null?void 0:$t.error}`)}if(ke.length===0)return v({title:"Collection Generation Incomplete",description:"Could not create any new products for the collection.",variant:"warning"}),null;const tt={id:Dt(),name:$e,description:`A collection of products featuring the design from ${re}. Original design prompt: ${se||"N/A"}`,imageUrl:ke[0].images[0]||ar,product_ids:ke.map(mt=>mt.id)};if(oe||(tt.products=[...ke]),oe){const mt=e.find(Rn=>Rn.id===oe);if(!mt)throw new Error("Store not found to add the new collection.");const $t=[...mt.products||[],...ke],Ht=[...mt.collections||[],tt];return await J(oe,{products:$t,collections:Ht}),v({title:"POD Collection Created",description:`Collection "${$e}" with ${ke.length} products added to store.`,variant:"success"}),{success:!0}}else return v({title:"POD Items Generated",description:`${ke.length} products and 1 collection ready.`,variant:"info"}),{newProducts:ke,newCollection:tt}}catch(We){return console.error("Error generating POD collection from design:",We),v({title:"POD Collection Error",description:We.message,variant:"destructive"}),null}finally{Lt(!1)}},ie=p.useCallback(()=>{I(0),k(""),D(""),G(null),W({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),H({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),V(null),z(!1),Z(null),xe(null),Re(!1),ze(null)},[]),be=p.useCallback(async(ae,se)=>{k(ae),D(se),z(!0),Z(null),G(null);try{v({title:"Connecting to Shopify...",description:"Fetching store information."});const re=await A_e(ae,se);if(!re)throw new Error("Failed to fetch Shopify store metadata. The store might not exist or the token might be invalid.");return G(re),I(2),!0}catch(re){return console.error("Error starting Shopify import wizard (fetching metadata):",re),Z(re.message||"Failed to connect to Shopify and fetch store information."),v({title:"Connection Failed",description:re.message||"Could not fetch store information.",variant:"destructive"}),!1}finally{z(!1)}},[v,k,D,z,Z,G,I]),Ie=p.useCallback(()=>{ce(0),Be(""),Et(""),xt(null),At({items:[],pageInfo:{hasNextPage:!1,endCursor:null}}),Tn(!1),mn(null)},[]),Ve=p.useCallback(async(ae,se)=>{const re=ae||_e,oe=se||Te;if(!re||!oe){mn("Domain or token missing for fetching BigCommerce settings.");return}z(!0),mn(null);try{const ke=await M_e(re,oe);xt(ke)}catch(ke){console.error("Error fetching BigCommerce settings for wizard:",ke),mn(ke.message||"Failed to fetch store settings."),v({title:"BigCommerce Settings Fetch Failed",description:ke.message,variant:"destructive"})}finally{z(!1)}},[_e,Te,v,mn,xt,z]),Se=p.useCallback(async(ae,se)=>{Be(ae),Et(se),ce(2),await Ve(ae,se)},[Be,Et,ce,Ve]),ot=p.useCallback(async(ae=10)=>{if(!_e||!Te){mn("Domain or token missing for fetching BigCommerce products.");return}Tn(!0),mn(null);try{const se=`
      query ProductsPreview($first: Int!) {
        site {
          products(first: $first) {
            edges {
              node {
                entityId name sku defaultImage { url(width: 200) altText }
                prices { price { value currencyCode } }
              }
            }
          }
        }
      }
    `,re={first:ae},ke=await(await fetch(`https://${_e}/graphql`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Te}`},body:JSON.stringify({query:se,variables:re})})).json();if(ke.errors)throw new Error(ke.errors.map($e=>$e.message).join(", "));At({items:ke.data.site.products.edges.map($e=>$e.node),pageInfo:{hasNextPage:!1,endCursor:null}})}catch(se){console.error("Error fetching BigCommerce products for wizard:",se),mn(se.message||"Failed to fetch products."),v({title:"BigCommerce Product Fetch Failed",description:se.message,variant:"destructive"})}finally{Tn(!1)}},[_e,Te,v,mn,At,Tn]),lt=p.useCallback(async()=>{if(!wt||!_e||!Te)return v({title:"Import Error",description:"Missing BigCommerce data to finalize import.",variant:"destructive"}),!1;o(!0),mn(null);try{const ae=await TL(_e,Te),se=D_e(wt,ae,_e,{generateId:Dt},null);return await Le(se)?(Ie(),!0):!1}catch(ae){return console.error("Error finalizing BigCommerce import from wizard:",ae),mn(ae.message||"Failed to finalize BigCommerce import."),v({title:"BigCommerce Import Failed",description:ae.message,variant:"destructive"}),!1}finally{o(!1)}},[wt,_e,Te,Le,Ie,v,o,mn,TL]),jt=p.useCallback(async(ae=10,se=null)=>{if(!P||!j){Z("Domain or token missing for fetching products.");return}z(!0),Z(null);try{const re=await R_e(P,j,ae,se);W(oe=>({edges:se?[...oe.edges,...re.edges]:re.edges,pageInfo:re.pageInfo}))}catch(re){console.error("Error fetching Shopify products for wizard:",re),Z(re.message||"Failed to fetch products."),v({title:"Product Fetch Failed",description:re.message,variant:"destructive"})}finally{z(!1)}},[P,j,v,Z,W,z]),vn=p.useCallback(async(ae=10,se=null)=>{if(!P||!j){Z("Domain or token missing for fetching collections.");return}z(!0),Z(null);try{const re=await k_e(P,j,ae,se);H(oe=>({edges:se?[...oe.edges,...re.edges]:re.edges,pageInfo:re.pageInfo}))}catch(re){console.error("Error fetching Shopify collections for wizard:",re),Z(re.message||"Failed to fetch collections."),v({title:"Collection Fetch Failed",description:re.message,variant:"destructive"})}finally{z(!1)}},[P,j,v,Z,H,z]),ts=p.useCallback(async(ae="US",se="EN")=>{if(!P||!j){Z("Domain or token missing for fetching localization.");return}z(!0),Z(null);try{const re=await j_e(P,j,ae,se);V(re)}catch(re){console.error("Error fetching Shopify localization for wizard:",re),Z(re.message||"Failed to fetch localization info."),v({title:"Localization Info Fetch Failed",description:re.message,variant:"default"})}finally{z(!1)}},[P,j,v,Z,V,z]),Vn=p.useCallback(async()=>{if(console.log("[StoreContext] Attempting to generate Shopify store logo..."),!M||!M.name){console.warn("[StoreContext] Cannot generate logo: Shopify preview metadata or store name is missing.",M),ze("Store name is not available to generate a logo."),v({title:"Logo Generation Error",description:"Store name missing. Ensure Shopify store details were fetched correctly.",variant:"destructive"});return}const ae=M.name;console.log(`[StoreContext] Generating logo for store name: "${ae}"`),Re(!0),ze(null),xe(null);try{console.log("[StoreContext] Calling generateLogoWithGemini...");const{imageData:se,textResponse:re}=await Pg(ae);if(console.log("[StoreContext] generateLogoWithGemini response:",{imageData:se?"imageData received (see next log)":"no imageData",textResponse:re}),se)console.log("[StoreContext] imageData (first 50 chars):",se.substring(0,50)),xe(`data:image/png;base64,${se}`),v({title:"Logo Generated!",description:"A new logo has been generated successfully."}),console.log("[StoreContext] Logo generated and state updated.");else throw console.error("[StoreContext] generateLogoWithGemini returned no imageData. Text response:",re),new Error(re||"Gemini did not return image data.")}catch(se){console.error("[StoreContext] Error during Shopify store logo generation:",se.message,se.stack),ze(se.message||"Failed to generate logo."),v({title:"Logo Generation Failed",description:`Error: ${se.message}`,variant:"destructive"})}finally{Re(!1),console.log("[StoreContext] Finished logo generation attempt.")}},[M,v,ze,Re,xe]),Wr=p.useCallback(async()=>{var ae,se,re,oe,ke,$e,We,nt,tt,mt,$t,Ht,Rn,Hn;if(!M||!P||!j)return v({title:"Import Error",description:"Missing essential Shopify data to finalize import.",variant:"destructive"}),!1;o(!0),Z(null);try{const rt=B.edges.map(kt=>kt.node),bt=Q.edges.map(kt=>kt.node);let hn=`Create a store named '${M.name}'.`;M.description&&(hn+=` The store's description is: "${M.description}".`),(ae=M.brand)!=null&&ae.slogan&&(hn+=` Slogan: "${M.brand.slogan}".`),rt.length>0&&(hn+=` It sells products like ${rt.slice(0,3).map(kt=>kt.title).join(", ")}.`),bt.length>0&&(hn+=` Key collections include ${bt.slice(0,2).map(kt=>kt.title).join(", ")}.`),(oe=(re=(se=M.brand)==null?void 0:se.colors)==null?void 0:re.primary)!=null&&oe.background&&(hn+=` The primary brand color is ${M.brand.colors.primary.background}.`),(We=($e=(ke=M.brand)==null?void 0:ke.colors)==null?void 0:$e.secondary)!=null&&We.background&&(hn+=` The secondary brand color is ${M.brand.colors.secondary.background}.`);const Hr=rt.map(kt=>{var jn,pr,Ei,Cd,Zn,Un;return{name:kt.title,price:((Cd=(Ei=(pr=(jn=kt.variants)==null?void 0:jn.edges[0])==null?void 0:pr.node)==null?void 0:Ei.price)==null?void 0:Cd.amount)||"0",description:kt.descriptionHtml?kt.descriptionHtml.replace(/<[^>]*>?/gm,""):kt.description||"",images:((Zn=kt.images)==null?void 0:Zn.edges.map(qn=>qn.node.url))||[],inventory:10,variants:((Un=kt.variants)==null?void 0:Un.edges.map(qn=>{var to;return{id:qn.node.id,title:qn.node.title,price:((to=qn.node.price)==null?void 0:to.amount)||"0"}}))||[]}}),jr=bt.map(kt=>{var jn,pr;return{name:kt.title,description:kt.descriptionHtml?kt.descriptionHtml.replace(/<[^>]*>?/gm,""):kt.description||"",imageUrl:((jn=kt.image)==null?void 0:jn.url)||"",product_ids:((pr=kt.products)==null?void 0:pr.edges.map(Ei=>Ei.node.id))||[]}}),rs={name:M.name,prompt:hn,logoUrl:fe||((mt=(tt=(nt=M==null?void 0:M.brand)==null?void 0:nt.logo)==null?void 0:tt.image)==null?void 0:mt.url)||((Rn=(Ht=($t=M==null?void 0:M.brand)==null?void 0:$t.squareLogo)==null?void 0:Ht.image)==null?void 0:Rn.url),products:Hr,collections:jr,brandColors:(Hn=M.brand)==null?void 0:Hn.colors};return Ce(rs),ve(!0),ie(),I(4),Me(!0),v({title:"Import Successful",description:"Store data imported. Proceed to configure and generate your store.",duration:5e3}),!0}catch(rt){return console.error("Error preparing data for StoreGenerator from Shopify import:",rt),Z(rt.message||"Failed to process Shopify data for generator."),v({title:"Import Processing Failed",description:rt.message||"Could not prepare imported data.",variant:"destructive"}),!1}finally{o(!1)}},[M,P,j,B,Q,fe,Le,ie,I,Me,Ce,ve,v,o,Z]),ri=p.useCallback(()=>{Ce(null),ve(!1)},[]),$s=p.useCallback(ae=>{const se=e.find(re=>re.id===ae);return se?{...se}:null},[e]),Us=p.useCallback(ae=>{const se=e.find(re=>pc(re.name)===ae);return se?{...se}:null},[e]),Bs=async ae=>{console.log(`[StoreContext] getStoreBySlug called for slug: ${ae}`);try{const se=Ai(Nn,"stores"),re=zT(se,GT("urlSlug","==",ae)),oe=await ki(re);if(oe.empty)return console.log(`[StoreContext] No store found with slug: ${ae}`),null;const ke=oe.docs[0],$e={id:ke.id,...ke.data()};console.log(`[StoreContext] Found store with slug ${ae}. Fetching details...`);const We=Ai(Nn,"stores",$e.id,"products"),mt=(await ki(We)).docs.map(bt=>({id:bt.id,...bt.data()})).map(bt=>{var hn,Hr;return{...bt,price:bt.priceAmount,image:{src:{large:((hn=bt.images)==null?void 0:hn[0])||"",medium:((Hr=bt.images)==null?void 0:Hr[0])||""}},variants:bt.variants||[]}}),$t=Ai(Nn,"stores",$e.id,"collections"),Rn=(await ki($t)).docs.map(bt=>({id:bt.id,...bt.data()})),Hn=await Promise.all(Rn.map(async bt=>{const hn=mt.filter(Hr=>{var jr;return(jr=bt.product_ids)==null?void 0:jr.includes(Hr.id)});return{...bt,image:{src:bt.image_url||""},products:hn}})),rt={...$e,products:mt,collections:Hn};return n(bt=>{const hn=bt.findIndex(Hr=>Hr.id===rt.id);if(hn>-1){const Hr=[...bt];return Hr[hn]=rt,Hr}return[...bt,rt]}),rt}catch(se){return console.error(`[StoreContext] Error fetching store by slug ${ae}:`,se),v({title:"Error Fetching Store",description:"Could not retrieve store data from the server.",variant:"destructive"}),null}},ns=p.useCallback((ae,se)=>{const re=$s(ae),oe=re==null?void 0:re.products.find(ke=>ke.id===se);return oe?{...oe}:null},[$s]),tn=async ae=>{if(!ae)return 0;try{const se=Ai(Nn,"stores",ae,"orders"),re=await ki(se);let oe=0;return re.forEach(ke=>{const $e=ke.data();$e.total&&typeof $e.total=="number"&&(oe+=$e.total)}),oe}catch(se){return console.error(`Error fetching revenue for store ${ae}:`,se),0}},In=async ae=>{if(!ae)return 0;try{const se=Ai(Nn,"stores",ae,"orders"),re=await ki(se),oe=new Set;return re.forEach(ke=>{const $e=ke.data();$e.userId&&oe.add($e.userId)}),oe.size}catch(se){return console.error(`Error fetching customers for store ${ae}:`,se),0}},si=async ae=>{if(!ae)return 0;try{const oe=(await Ps(Nn,"stores",ae).get()).data(),ke=(oe==null?void 0:oe.views)||0,$e=Ai(Nn,"stores",ae,"orders"),nt=(await ki($e)).size;return ke===0?0:nt/ke*100}catch(se){return console.error(`Error fetching conversion rate for store ${ae}:`,se),0}},ii=async ae=>{if(!ae)return 0;try{const oe=(await Ps(Nn,"stores",ae).get()).data(),ke=(oe==null?void 0:oe.views)||0;return Math.floor(ke/35)}catch(se){return console.error(`Error fetching social score for store ${ae}:`,se),0}},$n=async(ae,se)=>{if(!C){v({title:"Authentication Required",description:"Please log in to set a pass key.",variant:"destructive"});return}f(!0);try{const re=Ps(Nn,"stores",ae);await dm(re,{pass_key:se}),n(oe=>{const ke=oe.map($e=>$e.id===ae?{...$e,pass_key:se}:$e);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Xt(ke)))}catch($e){console.error("Failed to save stores to localStorage after pass key update:",$e),v({title:"Local Cache Update Failed",description:"Could not update the local cache after pass key update.",variant:"warning",duration:7e3})}return ke}),r&&r.id===ae&&s(oe=>oe?{...oe,pass_key:se}:null),v({title:"Store Pass Key Set",description:"The pass key for the store has been updated."})}catch(re){console.error("Unexpected error in updateStorePassKey:",re),v({title:"Pass Key Update Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{f(!1)}},oi=async(ae,se)=>{if(!C){v({title:"Authentication Required",description:"Please log in to assign a manager.",variant:"destructive"});return}if(!ae||!se){v({title:"Missing Information",description:"Store ID and Manager Email are required.",variant:"destructive"});return}f(!0);try{console.warn("Assign Store Manager functionality needs to be migrated to a Firebase Cloud Function or direct Firestore logic."),v({title:"Manager Assignment (Placeholder)",description:"Functionality needs Firebase Cloud Function implementation.",variant:"info"}),v({title:"Store Manager Assigned",description:`Manager ${se} assigned to store.`})}catch(re){console.error("Unexpected error in assignStoreManager:",re),v({title:"Manager Assignment Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{f(!1)}},_o=async(ae,se,re)=>{if(!C){v({title:"Authentication Required",description:"Please log in to update product images.",variant:"destructive"});return}const oe=e.find(We=>We.id===ae);if(!oe){console.warn(`[StoreContext] updateProductImage: Store with ID ${ae} not found.`),v({title:"Update Failed",description:"Store not found for updating product image.",variant:"destructive"});return}let ke=re.src.large;if(ke&&ke.startsWith("data:image/"))try{const We=`store_products/${ae}/${se}/image_${Dt()}.png`,nt=await Ft(ke,We);nt?ke=nt:(ke=ke.startsWith("data:image/")?ar:ke,v({title:"Image Upload Failed",description:"Could not upload new product image. Using placeholder or existing.",variant:"warning"}))}catch(We){console.error(`Error uploading new product image for ${se}:`,We),v({title:"Image Upload Failed",description:"Could not upload new product image.",variant:"destructive"}),ke=ar}else ke||(ke=ar);const $e=oe.products.map(We=>We.id===se?{...We,image:{...We.image,src:{large:ke,medium:ke}},images:We.images?[...We.images.filter(nt=>nt!==We.image.src.large),ke]:[ke]}:We);try{const We=Ps(Nn,"stores",ae,"products",se);await dm(We,{images:$e.find(nt=>nt.id===se).images,image:{src:{large:ke,medium:ke}}}),v({title:"Product Image Updated",description:"The product image has been changed."})}catch(We){console.error("Error updating product image in Firestore:",We),v({title:"Cloud Sync Failed",description:`Failed to save product image to cloud: ${We.message}`,variant:"destructive"});return}n(We=>{const nt=We.map(tt=>tt.id===ae?{...tt,products:$e}:tt);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Xt(nt)))}catch(tt){console.error("Failed to save stores to localStorage during product image update:",tt),v({title:"Local Cache Update Failed",description:"Could not update the local cache for product image.",variant:"warning",duration:7e3})}return nt}),r&&r.id===ae&&s(We=>We?{...We,products:$e}:null)},Qo=async ae=>{if(!C){v({title:"Authentication Required",description:"Please log in to delete a store.",variant:"destructive"});return}const se=[...e];n(re=>{const oe=re.filter(ke=>ke.id!==ae);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Xt(oe)))}catch(ke){console.error("Failed to save stores to localStorage during optimistic delete:",ke),v({title:"Local Cache Update Issue",description:"Could not update the local cache during store deletion. Cloud operation will proceed.",variant:"warning",duration:7e3})}return oe}),r&&r.id===ae&&s(null);try{const re=Ai(Nn,"stores",ae,"products"),oe=await ki(re),ke=[];for(const mt of oe.docs)ke.push(GS(Ps(Nn,"stores",ae,"products",mt.id)));await Promise.all(ke),console.log(`Deleted ${oe.size} products for store ${ae}.`);const $e=Ai(Nn,"stores",ae,"collections"),We=await ki($e),nt=[];for(const mt of We.docs)nt.push(GS(Ps(Nn,"stores",ae,"collections",mt.id)));await Promise.all(nt),console.log(`Deleted ${We.size} collections for store ${ae}.`);const tt=Ps(Nn,"stores",ae);await GS(tt),console.log(`Store ${ae} deleted from Firestore.`),v({title:"Store Deleted",description:"Your store has been deleted."})}catch(re){console.error("Error deleting store from Firestore:",re),v({title:"Deletion Failed",description:re.message,variant:"destructive"}),n(se);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Xt(se)))}catch(oe){console.error("Failed to save stores to localStorage during delete rollback:",oe),v({title:"Local Cache Revert Failed",description:"Could not revert local cache changes after a failed deletion.",variant:"error",duration:8e3})}se.find(oe=>oe.id===ae)&&s(se.find(oe=>oe.id===ae)||null);return}},Qc=async(ae,se,re)=>{if(!C){v({title:"Authentication Required",description:"Please log in to update product images.",variant:"destructive"});return}const oe=e.find(nt=>nt.id===ae);if(!oe){console.warn(`[StoreContext] updateProductImagesArray: Store with ID ${ae} not found.`),v({title:"Update Failed",description:"Store not found for updating product images.",variant:"destructive"});return}let ke=!1,$e=[];for(const nt of re)if(typeof nt=="string"&&nt.startsWith("data:image/"))try{const tt=`store_products/${ae}/${se}/gallery_${Dt()}.png`,mt=await Ft(nt,tt);mt?$e.push(mt):$e.push(ar)}catch(tt){console.error(`Error uploading gallery image for product ${se}:`,tt),v({title:"Image Upload Failed",description:"Could not upload one or more product gallery images.",variant:"destructive"}),$e.push(ar)}else typeof nt=="string"&&nt?$e.push(nt):(console.warn(`[StoreContext] updateProductImagesArray: Invalid or empty image in newImagesArray for product ${se}`,nt),$e.push(ar));$e.length===0&&re.length>0&&$e.push(ar);const We=oe.products.map(nt=>{var tt,mt;if(nt.id===se){ke=!0;const $t=$e.length>0?$e[0]:((mt=(tt=nt.image)==null?void 0:tt.src)==null?void 0:mt.medium)||ar;return{...nt,images:$e.length>0?$e:[ar],image:{...nt.image||{id:Dt(),alt:nt.name||"Product Image"},src:{medium:$t,large:$t}}}}return nt});if(!ke){console.warn(`[StoreContext] updateProductImagesArray: Product with ID ${se} not found in store ${ae}.`),v({title:"Update Failed",description:"Product not found for updating images.",variant:"destructive"});return}try{const nt=Ps(Nn,"stores",ae,"products",se),tt=We.find(mt=>mt.id===se);if(tt)await dm(nt,{images:tt.images,image:tt.image}),v({title:"Product Images Updated",description:"The product's image gallery has been updated."});else throw new Error("Updated product data not found for Firestore update.")}catch(nt){console.error("Error updating product images array in Firestore:",nt),v({title:"Cloud Sync Failed",description:`Failed to save product images to cloud: ${nt.message}`,variant:"destructive"});return}n(nt=>{const tt=nt.map(mt=>mt.id===ae?{...mt,products:We}:mt);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Xt(tt)))}catch(mt){console.error("Failed to save stores to localStorage during product images array update:",mt),v({title:"Local Cache Update Failed",description:"Could not update the local cache for product images array.",variant:"warning",duration:7e3})}return tt}),r&&r.id===ae&&s(nt=>nt?{...nt,products:We}:null)},Vf=(ae,se)=>{g(re=>re.find(ke=>ke.id===ae.id&&ke.storeId===se)?re.map(ke=>ke.id===ae.id&&ke.storeId===se?{...ke,quantity:ke.quantity+1}:ke):[...re,{...ae,quantity:1,storeId:se}]),v({title:"Added to Cart",description:`${ae.name} has been added to your cart.`})},Zc=(ae,se)=>{g(re=>re.filter(oe=>!(oe.id===ae&&oe.storeId===se))),v({title:"Removed from Cart",description:"Item removed from your cart.",variant:"destructive"})},eu=(ae,se,re)=>{if(re<1){Zc(ae,se);return}g(oe=>oe.map(ke=>ke.id===ae&&ke.storeId===se?{...ke,quantity:re}:ke))},tu=()=>{g([]),v({title:"Cart Cleared",description:"Your shopping cart is now empty."})},Sd=p.useCallback((ae,se)=>{const re=e.find($e=>$e.id===ae);if(!re)return console.warn(`[getUpdatesForVersion] Store with ID ${ae} not found.`),{template_version:se};let oe={template_version:se};const ke=re.theme||{};return re.template_version,se==="v1"?["Montserrat","PremiumMain","SharpFont","FreshFont","SleekFont"].includes(ke.fontFamily)||!ke.fontFamily?oe.theme={...ke,fontFamily:"Inter"}:oe.theme={...ke}:se==="premium"&&(oe.theme={...ke,fontFamily:"PremiumMain"}),oe},[e]),_n={stores:e,currentStore:r,isGenerating:i,isLoadingStores:h,cart:m,user:C,progress:l,statusMessage:u,loadStores:or,generateStore:ne,updateStoreTextContent:we,checkStoreNameAvailability:Ze,getStoreById:$s,getStoreByName:Us,getStoreBySlug:Bs,updateStore:J,deleteStore:Qo,setCurrentStore:s,updateStorePassKey:$n,assignStoreManager:oi,updateStoreTemplateVersion:async(ae,se)=>{if(!ae||!se){v({title:"Error",description:"Store ID and new template version are required.",variant:"destructive"});return}const re=Sd(ae,se);await J(ae,re);let oe=se;se==="v1"?oe="Modern":se==="premium"?oe="Premium":se==="sharp"?oe="Sharp":se==="fresh"?oe="Fresh":se==="sleek"?oe="Sleek":oe=se.charAt(0).toUpperCase()+se.slice(1),v({title:"Template Updated",description:`Store template is now ${oe}.`})},getProductById:ns,updateProductImage:_o,generateStoreFromWizard:X,getStoreRevenue:tn,getStoreCustomers:In,getStoreConversionRate:si,getStoreSocialScore:ii,addToCart:Vf,removeFromCart:Zc,updateQuantity:eu,clearCart:tu,generateAIProducts:N_e,updateProductImagesArray:Qc,generatePodCollectionFromDesign:q,addPendingPodCollectionData:Oe,isGeneratingPodCollection:dn,viewMode:x,setViewMode:A,shopifyWizardStep:E,setShopifyWizardStep:I,shopifyDomain:P,setShopifyDomain:k,shopifyToken:j,setShopifyToken:D,shopifyPreviewMetadata:M,shopifyPreviewProducts:B,shopifyPreviewCollections:Q,shopifyLocalization:Y,isFetchingShopifyPreviewData:$,shopifyImportError:F,generatedLogoImage:fe,isGeneratingLogo:ge,logoGenerationError:Ue,shopifyWizardShouldShowGenerator:de,setShopifyWizardShouldShowGenerator:Me,startShopifyImportWizard:be,fetchShopifyWizardProducts:jt,importedStoreDataForGenerator:he,isImportDataReadyForGenerator:Pe,clearImportedStoreDataForGenerator:ri,fetchShopifyWizardCollections:vn,fetchShopifyWizardLocalization:ts,generateShopifyStoreLogo:Vn,finalizeShopifyImportFromWizard:Wr,resetShopifyWizardState:ie,updateShopifyPreviewMetadata:ae=>{G(ae)},updateShopifyPreviewProduct:ae=>{W(se=>{const re=se.edges.map(oe=>oe.node.id===ae.id?{...oe,node:ae}:oe);return{...se,edges:re}})},updateShopifyPreviewCollection:ae=>{H(se=>{const re=se.edges.map(oe=>oe.node.id===ae.id?{...oe,node:ae}:oe);return{...se,edges:re}})},updateStoreCollections:(ae,se,re)=>ue(ae,se,re,C,v),isAuthModalOpen:Ae,openAuthModal:()=>Ne(!0),closeAuthModal:()=>Ne(!1),bigCommerceWizardStep:He,setBigCommerceWizardStep:ce,bigCommerceStoreDomain:_e,bigCommerceApiToken:Te,bigCommercePreviewSettings:wt,bigCommercePreviewProducts:pt,isFetchingBigCommercePreviewData:On,bigCommerceImportError:mr,startBigCommerceImportWizard:Se,fetchBigCommerceWizardSettings:Ve,fetchBigCommerceWizardProducts:ot,finalizeBigCommerceImportFromWizard:lt,resetBigCommerceWizardState:Ie,closeDesignEditModal:()=>{te(!1),ee([]),K(null),o(!1),c(0),d("")},continueGenerationWithDesigns:me,openProductFinalizationModal:(ae,se)=>{en(ae),an(se),yt(!0)},closeProductFinalizationModal:()=>{yt(!1),en([]),an(null),o(!1),c(0),d("")},handleFinalizeProducts:async ae=>{if(!fn){v({title:"Error",description:"Store data for finalization is missing.",variant:"destructive"}),yt(!1),o(!1);return}o(!0),d("Finalizing store creation..."),c(95);const se={...fn,products:ae};try{const re=await Le(se);if(re)c(100),d("Store generation complete!"),v({title:"Store Created!",description:`Store "${re.name}" has been created.`}),_(`/${re.urlSlug||pc(re.name)}`);else throw new Error("Store creation returned no result after finalization.")}catch(re){console.error("Error during final store creation after product finalization:",re),v({title:"Finalization Failed",description:re.message||"Failed to create store after finalization.",variant:"destructive"}),c(0),d("Finalization failed.")}finally{yt(!1),en([]),an(null),o(!1)}}};return a.jsxs(L7.Provider,{value:_n,children:[t,a.jsx(gEe,{isOpen:xn,onClose:_n.closeDesignEditModal,designs:Ee,onContinue:me}),a.jsx(F_e,{isOpen:Ge,onClose:_n.closeProductFinalizationModal,products:Pt,onFinalize:_n.handleFinalizeProducts})]})},fm=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),xEe=({product:t,storeId:e,onContentCreated:n})=>{var ee,le;const{toast:r}=bs(),{storeName:s}=N0(),i=xl(),o=(ee=i.state)==null?void 0:ee.product,l=(le=i.state)==null?void 0:le.storeData,c=t||o,{getStoreById:u,getStoreByName:d}=zn(),[h,f]=p.useState("text-to-image"),[m,g]=p.useState(""),[x,w]=p.useState(""),[v,_]=p.useState(!1),[C,T]=p.useState(!1),[R,A]=p.useState(null),[E,I]=p.useState([]),[P,k]=p.useState(!1),[j,D]=p.useState(""),[M,G]=p.useState(null),[B,W]=p.useState(!1),[Q,H]=p.useState(null),[Y,V]=p.useState([]),[$,z]=p.useState(""),[F,Z]=p.useState(!1),[fe,xe]=p.useState(null),[ge,Re]=p.useState(!1),[Ue,ze]=p.useState([]),[he,Ce]=p.useState(!1),[Pe,ve]=p.useState(!1),[de,Me]=p.useState(null),Ge=async()=>{var K,Ae;if(!(!de||!de.url))try{const Ne=document.createElement("a");let Oe="download";if(de.url.startsWith("data:")){const He=de.url.match(/:(.*?);/),_e=(He?He[1]:"application/octet-stream").split("/")[1]||"bin";Oe=`${((K=de.caption)==null?void 0:K.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${_e}`,Ne.href=de.url}else{const ce=await(await fetch(de.url)).blob();Ne.href=URL.createObjectURL(ce);const _e=de.url.substring(de.url.lastIndexOf("/")+1).split("?")[0],Be=_e.includes(".")?_e.substring(_e.lastIndexOf(".")+1):"",Te=de.type==="video"?"mp4":"png";Oe=_e||`${((Ae=de.caption)==null?void 0:Ae.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${Be||Te}`}Ne.download=Oe,document.body.appendChild(Ne),Ne.click(),document.body.removeChild(Ne),de.url.startsWith("data:")||URL.revokeObjectURL(Ne.href),r({title:"Download Started",description:`Downloading ${Oe}`})}catch(Ne){console.error("Error downloading media:",Ne),r({title:"Download Failed",description:Ne.message,variant:"destructive"})}};p.useEffect(()=>{let K=l;if(K||(s?K=d(s):e?K=u(e):c&&c.store_id&&(K=u(c.store_id))),K&&K.products){Ce(!0);const Ae=K.products.map(Ne=>{var Oe,He,ce;return{id:Ne.id,name:Ne.name,image:{src:{medium:((He=(Oe=Ne.image)==null?void 0:Oe.src)==null?void 0:He.medium)||`https://via.placeholder.com/100x100.png?text=${encodeURIComponent(((ce=Ne.name)==null?void 0:ce.substring(0,10))||"P")}`}}}});ze(Ae),Ce(!1)}else console.warn("[ContentCreationPage] No current store products found. Falling back to sample product catalog."),ze([{id:"sample_prod_1",name:"Sample Product Alpha",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Alpha"}}},{id:"sample_prod_2",name:"Sample Product Beta",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Beta"}}},{id:"sample_prod_3",name:"Sample Product Gamma",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Gamma"}}}]),Ce(!1);c&&c.name&&(g(`A captivating image of ${c.name}`),(async()=>{k(!0);try{const Ne={name:c.name,description:c.description||"",niche:(K==null?void 0:K.type)||c.niche||"",storeName:(K==null?void 0:K.name)||c.storeName||""},Oe=await Tse(Ne);Oe.suggestions&&Oe.suggestions.length>0?I(Oe.suggestions):Oe.error&&console.warn("Could not fetch prompt suggestions:",Oe.error)}catch(Ne){console.error("Error fetching prompt suggestions:",Ne)}finally{k(!1)}})())},[c,l,s,e,u,d]);const yt=async()=>{if(!m.trim()){r({title:"Error",description:"Please enter a prompt for image generation",variant:"destructive"});return}_(!0),A(null),z("");try{const K=await j0(m);let Ae=K.alt?[K.alt]:[`Image for: ${m.substring(0,30)}`];if(K.url)try{const{base64ImageData:Ne,mimeType:Oe}=await fm(K.url);Ae=await ca(Ne,Oe,`Image of ${m}`)}catch(Ne){console.error("Error generating caption for Gemini image:",Ne),Ae=[`Failed to generate caption for: ${m.substring(0,30)}`]}A({url:K.url,captions:Ae,sourceApi:"gemini"}),Ae&&Ae.length>0&&z(Ae[0])}catch(K){console.error("Error generating image with Gemini:",K),r({title:"Image Generation Failed",description:K.message,variant:"destructive"})}finally{_(!1)}},Pt=async()=>{if(!x.trim()){r({title:"Error",description:"Please enter a prompt for OpenAI image generation",variant:"destructive"});return}T(!0),A(null),z("");try{const K=await sz(x),Ae=`data:image/png;base64,${K.b64_json}`;let Ne=K.alt?[K.alt]:[`OpenAI image for: ${x.substring(0,30)}`];try{const{base64ImageData:Oe,mimeType:He}=await fm(Ae);Ne=await ca(Oe,He,`OpenAI-generated image of ${x}`)}catch(Oe){console.error("Error generating caption for OpenAI image:",Oe),Ne=[`Failed to generate caption for: ${x.substring(0,30)}`]}A({url:Ae,captions:Ne,sourceApi:"openai"}),Ne&&Ne.length>0&&z(Ne[0]),r({title:"Image Generated (OpenAI)",description:"Image successfully generated using OpenAI."})}catch(K){console.error("Error generating image with OpenAI:",K),r({title:"OpenAI Image Generation Failed",description:K.message,variant:"destructive"})}finally{T(!1)}},en=async(K,Ae)=>{if(!K||!K.url){r({title:"Error",description:"No image selected to edit with Gemini.",variant:"destructive"});return}if(!Ae.trim()){r({title:"Error",description:"Please enter an edit prompt for Gemini.",variant:"destructive"});return}W(!0),H(null),z("");try{const{base64ImageData:Ne,mimeType:Oe}=await fm(K.url),He=await Wo(Ne,Oe,Ae);if(He&&He.editedImageData){const ce=`data:${He.newMimeType};base64,${He.editedImageData}`;let _e=He.editTextResponse?[He.editTextResponse]:[`Edited with Gemini: ${K.caption||K.id}`];try{_e=await ca(He.editedImageData,He.newMimeType,`Edited image based on: ${Ae}`)}catch(Be){console.error("Error generating caption for Gemini edited image:",Be)}H({url:ce,captions:_e,sourceApi:"gemini"}),_e&&_e.length>0&&z(_e[0]),r({title:"Image Edited (Gemini)",description:"Image successfully edited with Gemini."})}else throw new Error("Gemini image edit did not return image data.")}catch(Ne){console.error("Error editing image with Gemini:",Ne),r({title:"Gemini Edit Failed",description:Ne.message,variant:"destructive"})}finally{W(!1)}},fn=async K=>{const Ae=K.target.files[0];if(Ae){Re(!0),xe(null),z("");try{const Ne=new FileReader;Ne.onload=async Oe=>{const He=Oe.target.result,ce=Ae.type.startsWith("video/")?"video":"image";let _e=[Ae.name];if(ce==="image")try{const{base64ImageData:Be,mimeType:Te}=await fm(He);_e=await ca(Be,Te,"Uploaded image caption")}catch(Be){console.error("Error generating caption for uploaded image:",Be)}else _e=[`Uploaded video: ${Ae.name}`];xe({url:He,captions:_e,type:ce}),_e&&_e.length>0&&z(_e[0]),Re(!1)},Ne.onerror=()=>{r({title:"Upload Failed",description:"Failed to read the selected file",variant:"destructive"}),Re(!1)},Ne.readAsDataURL(Ae)}catch(Ne){console.error("Error processing uploaded file:",Ne),r({title:"Upload Failed",description:Ne.message,variant:"destructive"}),Re(!1)}}},an=(K,Ae,Ne="image")=>{if(!K){r({title:"Cannot Add",description:"Item URL is missing.",variant:"destructive"});return}const Oe={id:Dt(),type:Ne,url:K,caption:Ae||`Item ${Y.length+1}`,isVideo:Ne==="video"};V(He=>[...He,Oe]),r({title:"Added to Timeline",description:`${Ne==="video"?"Video":"Image"} added to your content timeline.`}),A(null),H(null),xe(null),G(null),z("")},dn=(K,Ae)=>{const Ne=[...Y],Oe=Ne[K],He=K+Ae;He<0||He>=Ne.length||(Ne.splice(K,1),Ne.splice(He,0,Oe),V(Ne))},Lt=K=>{V(Ae=>Ae.filter(Ne=>Ne.id!==K)),r({title:"Removed from Timeline",description:"Item removed."})},xn=async(K,Ae)=>{if(K.isVideo){r({title:"Already a Video",description:"This item is already a video."});return}Z(!0);try{const{base64ImageData:Ne,mimeType:Oe}=await fm(K.url),He=K.caption||`Create a short video from this image: ${c?c.name:"product showcase"}`,ce=await JI(He,Ne,Oe),_e=[...Y];_e[Ae]={...K,url:ce,isVideo:!0,type:"video",caption:K.caption+" (Veo Video)"},V(_e),r({title:"Veo Video Generated",description:"Image converted to video using Veo."})}catch(Ne){console.error("Error converting to Veo video:",Ne),r({title:"Veo Conversion Failed",description:Ne.message,variant:"destructive"})}finally{Z(!1)}},te=K=>{const Ae=Y.find(Oe=>Oe.id===K);if(!Ae)return;const Ne=prompt("Edit caption:",Ae.caption);Ne!==null&&Ne.trim()!==Ae.caption&&(V(Oe=>Oe.map(He=>He.id===K?{...He,caption:Ne.trim()}:He)),r({title:"Caption Updated"}))},Ee=K=>{if(K.image&&K.image.src&&K.image.src.medium){const Ae=`Product: ${K.name}`;an(K.image.src.medium,Ae,"image")}else r({title:"No Image",description:`Product ${K.name} has no image.`,variant:"destructive"});ve(!1)};return a.jsxs("div",{className:"container mx-auto p-4 md:p-6 lg:p-8 space-y-8 bg-background",children:[" ",a.jsxs("header",{className:"relative text-center pb-4",children:[a.jsx(sr,{to:"/",className:"absolute left-0 top-0",children:a.jsxs(O,{variant:"outline",size:"icon",children:[a.jsx(Go,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Back to Home"})]})}),a.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight",children:"AI Content Creation Studio"}),a.jsx("p",{className:"text-muted-foreground mt-2 text-lg",children:"Generate images, edit them, create videos, and build your content sequence."})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 xl:gap-8",children:[a.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[a.jsxs(Si,{value:h,onValueChange:f,className:"w-full",children:[a.jsxs(ti,{className:"grid w-full grid-cols-3",children:[a.jsxs(Ot,{value:"text-to-image",children:[a.jsx(xa,{className:"mr-1 h-4 w-4 inline-block"}),"Gen Image"]}),a.jsxs(Ot,{value:"image-edit",children:[a.jsx(tw,{className:"mr-1 h-4 w-4 inline-block"}),"Edit Image"]}),a.jsxs(Ot,{value:"upload",children:[a.jsx(H3,{className:"mr-1 h-4 w-4 inline-block"}),"Upload"]})]}),a.jsxs(Vt,{value:"text-to-image",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(De,{htmlFor:"text-prompt-model1",className:"text-lg font-semibold",children:"Text-to-Image (Quick)"}),a.jsx(Pn,{id:"text-prompt-model1",placeholder:"e.g., 'A futuristic cityscape at sunset'",value:m,onChange:K=>g(K.target.value),rows:3,className:"mt-2",disabled:v||C}),P&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Loading prompt suggestions..."}),E.length>0&&!P&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx(De,{className:"text-xs text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:E.map((K,Ae)=>a.jsx(O,{variant:"outline",size:"xs",onClick:()=>g(K),className:"text-xs",children:K.length>40?K.substring(0,37)+"...":K},Ae))})]}),a.jsxs(O,{onClick:yt,disabled:v||C||!m.trim(),className:"w-full mt-3",children:[v?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Generate with Quick"]}),a.jsx(Ui,{className:"my-4"}),a.jsx(De,{htmlFor:"text-prompt-model2",className:"text-lg font-semibold",children:"Text-to-Image (Quality)"}),a.jsx(Pn,{id:"text-prompt-model2",placeholder:"e.g., 'A photorealistic cat astronaut'",value:x,onChange:K=>w(K.target.value),rows:3,className:"mt-2",disabled:v||C}),a.jsxs(O,{onClick:Pt,disabled:v||C||!x.trim(),className:"w-full mt-3",children:[C?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(V3,{className:"mr-2 h-4 w-4"}),"Generate with Quality"]}),R&&R.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:R.url,alt:`Generated by ${R.sourceApi==="gemini"?"Quick":R.sourceApi==="openai"?"Quality":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",R.sourceApi==="gemini"?"Quick":R.sourceApi==="openai"?"Quality":"AI"]}),a.jsx(De,{className:"text-sm font-medium",children:"Choose a caption:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(R.captions||[]).map((K,Ae)=>a.jsx(O,{variant:$===K?"default":"outline",size:"sm",onClick:()=>z(K),className:"text-xs",children:K},Ae))}),a.jsxs(O,{onClick:()=>an(R.url,$),size:"sm",className:"w-full mt-2",disabled:!$,children:[a.jsx(Nu,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]}),a.jsxs(Vt,{value:"image-edit",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(De,{className:"text-lg font-semibold",children:"Image Editing"}),!M&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select an image from the timeline to enable editing."}),M&&a.jsxs("div",{className:"mt-2 space-y-3",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Editing: ",a.jsx("span",{className:"text-primary truncate",children:M.caption})]}),a.jsx("img",{src:M.url,alt:"Selected for editing",className:"w-full rounded-md object-contain max-h-48 border"}),a.jsx(De,{htmlFor:"edit-prompt-model1",children:"Edit with Quick"}),a.jsx(Pn,{id:"edit-prompt-model1",placeholder:"Describe edits (e.g., 'change background to a beach')",value:j,onChange:K=>D(K.target.value),rows:2,disabled:B}),a.jsxs(O,{onClick:()=>en(M,j),disabled:B||!j.trim(),className:"w-full",children:[B?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Edit with Quick"]})]}),Q&&Q.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:Q.url,alt:`Edited by ${Q.sourceApi==="gemini"?"Quick":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",Q.sourceApi==="gemini"?"Quick":"AI"]}),a.jsx(De,{className:"text-sm font-medium",children:"Choose a caption for the edited image:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(Q.captions||[]).map((K,Ae)=>a.jsx(O,{variant:$===K?"default":"outline",size:"sm",onClick:()=>z(K),className:"text-xs",children:K},Ae))}),a.jsxs(O,{onClick:()=>an(Q.url,$),size:"sm",className:"w-full mt-2",disabled:!$,children:[a.jsx(Nu,{className:"mr-2 h-4 w-4"})," Add Edited to Timeline"]})]})]}),a.jsxs(Vt,{value:"upload",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(De,{htmlFor:"file-upload",className:"text-lg font-semibold",children:"Upload Image or Video"}),a.jsx(Ye,{id:"file-upload",type:"file",accept:"image/*,video/*",onChange:fn,className:"mt-2",disabled:ge}),ge&&a.jsxs("div",{className:"mt-2 flex items-center text-sm text-muted-foreground",children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"})," Processing..."]}),fe&&fe.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[fe.type==="image"?a.jsx("img",{src:fe.url,alt:"Uploaded content",className:"w-full rounded-md object-contain max-h-96"}):a.jsx("video",{src:fe.url,controls:!0,className:"w-full rounded-md max-h-96",children:"Your browser does not support the video tag."}),a.jsx(De,{className:"text-sm font-medium",children:"Choose a caption for the uploaded content:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(fe.captions||[]).map((K,Ae)=>a.jsx(O,{variant:$===K?"default":"outline",size:"sm",onClick:()=>z(K),className:"text-xs",children:K},Ae))}),a.jsxs(O,{onClick:()=>an(fe.url,$,fe.type),size:"sm",className:"w-full mt-2",disabled:!$,children:[a.jsx(Nu,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Product Catalog"}),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>ve(!Pe),children:[Pe?"Hide":"Show"," Products ",a.jsx(Die,{className:"ml-2 h-4 w-4"})]})]}),Pe&&a.jsx(xs,{className:"mt-2 h-48 border rounded-md p-2",children:a.jsx("div",{className:"space-y-2",children:Ue.map(K=>{var Ae,Ne;return a.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md hover:bg-muted cursor-pointer",onClick:()=>Ee(K),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:(Ne=(Ae=K.image)==null?void 0:Ae.src)==null?void 0:Ne.medium,alt:K.name,className:"w-10 h-10 object-cover rounded"}),a.jsx("span",{className:"text-sm",children:K.name})]}),a.jsx(O,{size:"xs",variant:"ghost",children:a.jsx(Nu,{className:"h-4 w-4"})})]},K.id)})})})]})]}),a.jsx("div",{className:"lg:col-span-2 space-y-6",children:a.jsxs("div",{className:"p-4 md:p-6 border rounded-lg bg-card shadow min-h-[400px]",children:[a.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Content Timeline"}),a.jsx(xs,{className:"h-[calc(100vh-350px)] min-h-[300px] pr-3",children:Y.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[a.jsx(F3,{className:"h-12 w-12 mb-3"}),a.jsx("p",{children:"Your timeline is empty."}),a.jsx("p",{className:"text-sm",children:"Generate or upload content to get started."})]}):a.jsx(Sc,{children:Y.map((K,Ae)=>a.jsxs(It.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-50},transition:{type:"spring",stiffness:300,damping:30},className:"mb-3 p-3 border rounded-md flex items-start gap-3 hover:shadow-md transition-shadow bg-background cursor-pointer",onClick:()=>Me(K),children:[a.jsxs("div",{className:"w-24 h-24 flex-shrink-0 relative rounded overflow-hidden group bg-muted",children:[K.isVideo?a.jsx("video",{src:K.url,className:"w-full h-full object-cover",controls:!1,muted:!0,loop:!0,onMouseOver:Ne=>Ne.target.play(),onMouseOut:Ne=>Ne.target.pause()}):a.jsx("img",{src:K.url,alt:K.caption,className:"w-full h-full object-cover"}),!K.isVideo&&a.jsx(O,{size:"icon",variant:"secondary",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Ne=>{Ne.stopPropagation(),xn(K,Ae)},disabled:F,title:"Convert to Veo Video",children:F?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(DI,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"outline",className:"absolute bottom-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Ne=>{Ne.stopPropagation(),G(K),f("image-edit")},disabled:K.isVideo,title:"Edit this image",children:a.jsx(tw,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:`text-xs font-semibold px-1.5 py-0.5 rounded-sm ${K.isVideo?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:[K.isVideo?"Video":"Image"," ",Ae+1]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(O,{size:"icon",variant:"ghost",onClick:Ne=>{Ne.stopPropagation(),dn(Ae,-1)},disabled:Ae===0,className:"h-7 w-7",children:a.jsx(B3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ne=>{Ne.stopPropagation(),dn(Ae,1)},disabled:Ae===Y.length-1,className:"h-7 w-7",children:a.jsx(U3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ne=>{Ne.stopPropagation(),te(K.id)},className:"h-7 w-7",children:a.jsx(z3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ne=>{Ne.stopPropagation(),Lt(K.id)},className:"h-7 w-7 text-destructive",children:a.jsx(Wn,{className:"h-4 w-4"})})]})]}),a.jsx("p",{className:"text-sm mt-1 text-muted-foreground line-clamp-3",title:K.caption,children:K.caption})]})]},K.id))})}),Y.length>0&&a.jsx(Ui,{className:"my-4"}),de&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Media Viewer"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(O,{variant:"outline",size:"sm",onClick:Ge,children:[a.jsx(jI,{className:"mr-2 h-4 w-4"}),"Download"]}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>Me(null),children:a.jsx(Ki,{className:"h-5 w-5"})})]})]}),de.type==="image"||!de.isVideo?a.jsx("img",{src:de.url,alt:de.caption||"Viewing media",className:"w-full max-h-[60vh] rounded-md object-contain border"}):a.jsx("video",{src:de.url,controls:!0,className:"w-full max-h-[60vh] rounded-md border bg-black",children:"Your browser does not support the video tag."}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:de.caption})]})]})})]})]})};function F7(t){const e=p.useRef({value:t,previous:t});return p.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}function MA(t){const[e,n]=p.useState(void 0);return Sa(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var n_="Switch",[vEe,zje]=_i(n_),[wEe,bEe]=vEe(n_),O7=p.forwardRef((t,e)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:u,form:d,...h}=t,[f,m]=p.useState(null),g=yn(e,C=>m(C)),x=p.useRef(!1),w=f?d||!!f.closest("form"):!0,[v,_]=Oc({prop:s,defaultProp:i??!1,onChange:u,caller:n_});return a.jsxs(wEe,{scope:n,checked:v,disabled:l,children:[a.jsx(Yt.button,{type:"button",role:"switch","aria-checked":v,"aria-required":o,"data-state":B7(v),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:g,onClick:gt(t.onClick,C=>{_(T=>!T),w&&(x.current=C.isPropagationStopped(),x.current||C.stopPropagation())})}),w&&a.jsx(U7,{control:f,bubbles:!x.current,name:r,value:c,checked:v,required:o,disabled:l,form:d,style:{transform:"translateX(-100%)"}})]})});O7.displayName=n_;var V7="SwitchThumb",$7=p.forwardRef((t,e)=>{const{__scopeSwitch:n,...r}=t,s=bEe(V7,n);return a.jsx(Yt.span,{"data-state":B7(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:e})});$7.displayName=V7;var _Ee="SwitchBubbleInput",U7=p.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:r=!0,...s},i)=>{const o=p.useRef(null),l=yn(o,i),c=F7(n),u=MA(e);return p.useEffect(()=>{const d=o.current;if(!d)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(c!==n&&m){const g=new Event("click",{bubbles:r});m.call(d,n),d.dispatchEvent(g)}},[c,n,r]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:l,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});U7.displayName=_Ee;function B7(t){return t?"checked":"unchecked"}var z7=O7,SEe=$7;const Oo=ht.forwardRef(({className:t,...e},n)=>a.jsx(z7,{className:Ct("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...e,ref:n,children:a.jsx(SEe,{className:Ct("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Oo.displayName=z7.displayName;var CEe="Arrow",G7=p.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return a.jsx(Yt.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});G7.displayName=CEe;var EEe=G7,LA="Popper",[W7,r_]=_i(LA),[TEe,H7]=W7(LA),q7=t=>{const{__scopePopper:e,children:n}=t,[r,s]=p.useState(null);return a.jsx(TEe,{scope:e,anchor:r,onAnchorChange:s,children:n})};q7.displayName=LA;var K7="PopperAnchor",Y7=p.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=H7(K7,n),o=p.useRef(null),l=yn(e,o);return p.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:a.jsx(Yt.div,{...s,ref:l})});Y7.displayName=K7;var FA="PopperContent",[IEe,NEe]=W7(FA),J7=p.forwardRef((t,e)=>{var ge,Re,Ue,ze,he,Ce;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:m="optimized",onPlaced:g,...x}=t,w=H7(FA,n),[v,_]=p.useState(null),C=yn(e,Pe=>_(Pe)),[T,R]=p.useState(null),A=MA(T),E=(A==null?void 0:A.width)??0,I=(A==null?void 0:A.height)??0,P=r+(i!=="center"?"-"+i:""),k=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},j=Array.isArray(u)?u:[u],D=j.length>0,M={padding:k,boundary:j.filter(AEe),altBoundary:D},{refs:G,floatingStyles:B,placement:W,isPositioned:Q,middlewareData:H}=n7({strategy:"fixed",placement:P,whileElementsMounted:(...Pe)=>e7(...Pe,{animationFrame:m==="always"}),elements:{reference:w.anchor},middleware:[r7({mainAxis:s+I,alignmentAxis:o}),c&&s7({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?i7():void 0,...M}),c&&o7({...M}),a7({...M,apply:({elements:Pe,rects:ve,availableWidth:de,availableHeight:Me})=>{const{width:Ge,height:yt}=ve.reference,Pt=Pe.floating.style;Pt.setProperty("--radix-popper-available-width",`${de}px`),Pt.setProperty("--radix-popper-available-height",`${Me}px`),Pt.setProperty("--radix-popper-anchor-width",`${Ge}px`),Pt.setProperty("--radix-popper-anchor-height",`${yt}px`)}}),T&&c7({element:T,padding:l}),kEe({arrowWidth:E,arrowHeight:I}),f&&l7({strategy:"referenceHidden",...M})]}),[Y,V]=Z7(W),$=$r(g);Sa(()=>{Q&&($==null||$())},[Q,$]);const z=(ge=H.arrow)==null?void 0:ge.x,F=(Re=H.arrow)==null?void 0:Re.y,Z=((Ue=H.arrow)==null?void 0:Ue.centerOffset)!==0,[fe,xe]=p.useState();return Sa(()=>{v&&xe(window.getComputedStyle(v).zIndex)},[v]),a.jsx("div",{ref:G.setFloating,"data-radix-popper-content-wrapper":"",style:{...B,transform:Q?B.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:fe,"--radix-popper-transform-origin":[(ze=H.transformOrigin)==null?void 0:ze.x,(he=H.transformOrigin)==null?void 0:he.y].join(" "),...((Ce=H.hide)==null?void 0:Ce.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:a.jsx(IEe,{scope:n,placedSide:Y,onArrowChange:R,arrowX:z,arrowY:F,shouldHideArrow:Z,children:a.jsx(Yt.div,{"data-side":Y,"data-align":V,...x,ref:C,style:{...x.style,animation:Q?void 0:"none"}})})})});J7.displayName=FA;var X7="PopperArrow",PEe={top:"bottom",right:"left",bottom:"top",left:"right"},Q7=p.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=NEe(X7,r),o=PEe[i.placedSide];return a.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:a.jsx(EEe,{...s,ref:n,style:{...s.style,display:"block"}})})});Q7.displayName=X7;function AEe(t){return t!==null}var kEe=t=>({name:"transformOrigin",options:t,fn(e){var w,v,_;const{placement:n,rects:r,middlewareData:s}=e,o=((w=s.arrow)==null?void 0:w.centerOffset)!==0,l=o?0:t.arrowWidth,c=o?0:t.arrowHeight,[u,d]=Z7(n),h={start:"0%",center:"50%",end:"100%"}[d],f=(((v=s.arrow)==null?void 0:v.x)??0)+l/2,m=(((_=s.arrow)==null?void 0:_.y)??0)+c/2;let g="",x="";return u==="bottom"?(g=o?h:`${f}px`,x=`${-c}px`):u==="top"?(g=o?h:`${f}px`,x=`${r.floating.height+c}px`):u==="right"?(g=`${-c}px`,x=o?h:`${m}px`):u==="left"&&(g=`${r.floating.width+c}px`,x=o?h:`${m}px`),{data:{x:g,y:x}}}});function Z7(t){const[e,n="center"]=t.split("-");return[e,n]}var eW=q7,OA=Y7,tW=J7,nW=Q7,t1=["Enter"," "],REe=["ArrowDown","PageUp","Home"],rW=["ArrowUp","PageDown","End"],jEe=[...REe,...rW],DEe={ltr:[...t1,"ArrowRight"],rtl:[...t1,"ArrowLeft"]},MEe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ly="Menu",[fg,LEe,FEe]=CI(ly),[wd,sW]=_i(ly,[FEe,r_,z0]),s_=r_(),iW=z0(),[OEe,bd]=wd(ly),[VEe,cy]=wd(ly),oW=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:s,onOpenChange:i,modal:o=!0}=t,l=s_(e),[c,u]=p.useState(null),d=p.useRef(!1),h=$r(i),f=B0(s);return p.useEffect(()=>{const m=()=>{d.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>d.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),a.jsx(eW,{...l,children:a.jsx(OEe,{scope:e,open:n,onOpenChange:h,content:c,onContentChange:u,children:a.jsx(VEe,{scope:e,onClose:p.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:f,modal:o,children:r})})})};oW.displayName=ly;var $Ee="MenuAnchor",VA=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=s_(n);return a.jsx(OA,{...s,...r,ref:e})});VA.displayName=$Ee;var $A="MenuPortal",[UEe,aW]=wd($A,{forceMount:void 0}),lW=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:s}=t,i=bd($A,e);return a.jsx(UEe,{scope:e,forceMount:n,children:a.jsx(ws,{present:n||i.open,children:a.jsx(Cg,{asChild:!0,container:s,children:r})})})};lW.displayName=$A;var go="MenuContent",[BEe,UA]=wd(go),cW=p.forwardRef((t,e)=>{const n=aW(go,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=bd(go,t.__scopeMenu),o=cy(go,t.__scopeMenu);return a.jsx(fg.Provider,{scope:t.__scopeMenu,children:a.jsx(ws,{present:r||i.open,children:a.jsx(fg.Slot,{scope:t.__scopeMenu,children:o.modal?a.jsx(zEe,{...s,ref:e}):a.jsx(GEe,{...s,ref:e})})})})}),zEe=p.forwardRef((t,e)=>{const n=bd(go,t.__scopeMenu),r=p.useRef(null),s=yn(e,r);return p.useEffect(()=>{const i=r.current;if(i)return V0(i)},[]),a.jsx(BA,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:gt(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),GEe=p.forwardRef((t,e)=>{const n=bd(go,t.__scopeMenu);return a.jsx(BA,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),WEe=qu("MenuContent.ScrollLock"),BA=p.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,disableOutsideScroll:g,...x}=t,w=bd(go,n),v=cy(go,n),_=s_(n),C=iW(n),T=LEe(n),[R,A]=p.useState(null),E=p.useRef(null),I=yn(e,E,w.onContentChange),P=p.useRef(0),k=p.useRef(""),j=p.useRef(0),D=p.useRef(null),M=p.useRef("right"),G=p.useRef(0),B=g?OI:p.Fragment,W=g?{as:WEe,allowPinchZoom:!0}:void 0,Q=Y=>{var ge,Re;const V=k.current+Y,$=T().filter(Ue=>!Ue.disabled),z=document.activeElement,F=(ge=$.find(Ue=>Ue.ref.current===z))==null?void 0:ge.textValue,Z=$.map(Ue=>Ue.textValue),fe=rTe(Z,V,F),xe=(Re=$.find(Ue=>Ue.textValue===fe))==null?void 0:Re.ref.current;(function Ue(ze){k.current=ze,window.clearTimeout(P.current),ze!==""&&(P.current=window.setTimeout(()=>Ue(""),1e3))})(V),xe&&setTimeout(()=>xe.focus())};p.useEffect(()=>()=>window.clearTimeout(P.current),[]),LI();const H=p.useCallback(Y=>{var $,z;return M.current===(($=D.current)==null?void 0:$.side)&&iTe(Y,(z=D.current)==null?void 0:z.area)},[]);return a.jsx(BEe,{scope:n,searchRef:k,onItemEnter:p.useCallback(Y=>{H(Y)&&Y.preventDefault()},[H]),onItemLeave:p.useCallback(Y=>{var V;H(Y)||((V=E.current)==null||V.focus(),A(null))},[H]),onTriggerLeave:p.useCallback(Y=>{H(Y)&&Y.preventDefault()},[H]),pointerGraceTimerRef:j,onPointerGraceIntentChange:p.useCallback(Y=>{D.current=Y},[]),children:a.jsx(B,{...W,children:a.jsx(F0,{asChild:!0,trapped:s,onMountAutoFocus:gt(i,Y=>{var V;Y.preventDefault(),(V=E.current)==null||V.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:a.jsx(Sg,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,children:a.jsx(OU,{asChild:!0,...C,dir:v.dir,orientation:"vertical",loop:r,currentTabStopId:R,onCurrentTabStopIdChange:A,onEntryFocus:gt(c,Y=>{v.isUsingKeyboardRef.current||Y.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(tW,{role:"menu","aria-orientation":"vertical","data-state":EW(w.open),"data-radix-menu-content":"",dir:v.dir,..._,...x,ref:I,style:{outline:"none",...x.style},onKeyDown:gt(x.onKeyDown,Y=>{const $=Y.target.closest("[data-radix-menu-content]")===Y.currentTarget,z=Y.ctrlKey||Y.altKey||Y.metaKey,F=Y.key.length===1;$&&(Y.key==="Tab"&&Y.preventDefault(),!z&&F&&Q(Y.key));const Z=E.current;if(Y.target!==Z||!jEe.includes(Y.key))return;Y.preventDefault();const xe=T().filter(ge=>!ge.disabled).map(ge=>ge.ref.current);rW.includes(Y.key)&&xe.reverse(),tTe(xe)}),onBlur:gt(t.onBlur,Y=>{Y.currentTarget.contains(Y.target)||(window.clearTimeout(P.current),k.current="")}),onPointerMove:gt(t.onPointerMove,mg(Y=>{const V=Y.target,$=G.current!==Y.clientX;if(Y.currentTarget.contains(V)&&$){const z=Y.clientX>G.current?"right":"left";M.current=z,G.current=Y.clientX}}))})})})})})})});cW.displayName=go;var HEe="MenuGroup",zA=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Yt.div,{role:"group",...r,ref:e})});zA.displayName=HEe;var qEe="MenuLabel",uW=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Yt.div,{...r,ref:e})});uW.displayName=qEe;var t0="MenuItem",QL="menu.itemSelect",i_=p.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...s}=t,i=p.useRef(null),o=cy(t0,t.__scopeMenu),l=UA(t0,t.__scopeMenu),c=yn(e,i),u=p.useRef(!1),d=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent(QL,{bubbles:!0,cancelable:!0});h.addEventListener(QL,m=>r==null?void 0:r(m),{once:!0}),EI(h,f),f.defaultPrevented?u.current=!1:o.onClose()}};return a.jsx(dW,{...s,ref:c,disabled:n,onClick:gt(t.onClick,d),onPointerDown:h=>{var f;(f=t.onPointerDown)==null||f.call(t,h),u.current=!0},onPointerUp:gt(t.onPointerUp,h=>{var f;u.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:gt(t.onKeyDown,h=>{const f=l.searchRef.current!=="";n||f&&h.key===" "||t1.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});i_.displayName=t0;var dW=p.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=t,o=UA(t0,n),l=iW(n),c=p.useRef(null),u=yn(e,c),[d,h]=p.useState(!1),[f,m]=p.useState("");return p.useEffect(()=>{const g=c.current;g&&m((g.textContent??"").trim())},[i.children]),a.jsx(fg.ItemSlot,{scope:n,disabled:r,textValue:s??f,children:a.jsx(VU,{asChild:!0,...l,focusable:!r,children:a.jsx(Yt.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:u,onPointerMove:gt(t.onPointerMove,mg(g=>{r?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:gt(t.onPointerLeave,mg(g=>o.onItemLeave(g))),onFocus:gt(t.onFocus,()=>h(!0)),onBlur:gt(t.onBlur,()=>h(!1))})})})}),KEe="MenuCheckboxItem",hW=p.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...s}=t;return a.jsx(yW,{scope:t.__scopeMenu,checked:n,children:a.jsx(i_,{role:"menuitemcheckbox","aria-checked":n0(n)?"mixed":n,...s,ref:e,"data-state":WA(n),onSelect:gt(s.onSelect,()=>r==null?void 0:r(n0(n)?!0:!n),{checkForDefaultPrevented:!1})})})});hW.displayName=KEe;var fW="MenuRadioGroup",[YEe,JEe]=wd(fW,{value:void 0,onValueChange:()=>{}}),mW=p.forwardRef((t,e)=>{const{value:n,onValueChange:r,...s}=t,i=$r(r);return a.jsx(YEe,{scope:t.__scopeMenu,value:n,onValueChange:i,children:a.jsx(zA,{...s,ref:e})})});mW.displayName=fW;var pW="MenuRadioItem",gW=p.forwardRef((t,e)=>{const{value:n,...r}=t,s=JEe(pW,t.__scopeMenu),i=n===s.value;return a.jsx(yW,{scope:t.__scopeMenu,checked:i,children:a.jsx(i_,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":WA(i),onSelect:gt(r.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,n)},{checkForDefaultPrevented:!1})})})});gW.displayName=pW;var GA="MenuItemIndicator",[yW,XEe]=wd(GA,{checked:!1}),xW=p.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...s}=t,i=XEe(GA,n);return a.jsx(ws,{present:r||n0(i.checked)||i.checked===!0,children:a.jsx(Yt.span,{...s,ref:e,"data-state":WA(i.checked)})})});xW.displayName=GA;var QEe="MenuSeparator",vW=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Yt.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});vW.displayName=QEe;var ZEe="MenuArrow",wW=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=s_(n);return a.jsx(nW,{...s,...r,ref:e})});wW.displayName=ZEe;var eTe="MenuSub",[Gje,bW]=wd(eTe),Lm="MenuSubTrigger",_W=p.forwardRef((t,e)=>{const n=bd(Lm,t.__scopeMenu),r=cy(Lm,t.__scopeMenu),s=bW(Lm,t.__scopeMenu),i=UA(Lm,t.__scopeMenu),o=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,u={__scopeMenu:t.__scopeMenu},d=p.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return p.useEffect(()=>d,[d]),p.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),a.jsx(VA,{asChild:!0,...u,children:a.jsx(dW,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":EW(n.open),...t,ref:D0(e,s.onTriggerChange),onClick:h=>{var f;(f=t.onClick)==null||f.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:gt(t.onPointerMove,mg(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:gt(t.onPointerLeave,mg(h=>{var m,g;d();const f=(m=n.content)==null?void 0:m.getBoundingClientRect();if(f){const x=(g=n.content)==null?void 0:g.dataset.side,w=x==="right",v=w?-5:5,_=f[w?"left":"right"],C=f[w?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+v,y:h.clientY},{x:_,y:f.top},{x:C,y:f.top},{x:C,y:f.bottom},{x:_,y:f.bottom}],side:x}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:gt(t.onKeyDown,h=>{var m;const f=i.searchRef.current!=="";t.disabled||f&&h.key===" "||DEe[r.dir].includes(h.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),h.preventDefault())})})})});_W.displayName=Lm;var SW="MenuSubContent",CW=p.forwardRef((t,e)=>{const n=aW(go,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=bd(go,t.__scopeMenu),o=cy(go,t.__scopeMenu),l=bW(SW,t.__scopeMenu),c=p.useRef(null),u=yn(e,c);return a.jsx(fg.Provider,{scope:t.__scopeMenu,children:a.jsx(ws,{present:r||i.open,children:a.jsx(fg.Slot,{scope:t.__scopeMenu,children:a.jsx(BA,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;o.isUsingKeyboardRef.current&&((h=c.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:gt(t.onFocusOutside,d=>{d.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:gt(t.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:gt(t.onKeyDown,d=>{var m;const h=d.currentTarget.contains(d.target),f=MEe[o.dir].includes(d.key);h&&f&&(i.onOpenChange(!1),(m=l.trigger)==null||m.focus(),d.preventDefault())})})})})})});CW.displayName=SW;function EW(t){return t?"open":"closed"}function n0(t){return t==="indeterminate"}function WA(t){return n0(t)?"indeterminate":t?"checked":"unchecked"}function tTe(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function nTe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function rTe(t,e,n){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=nTe(t,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function sTe(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const l=e[i],c=e[o],u=l.x,d=l.y,h=c.x,f=c.y;d>r!=f>r&&n<(h-u)*(r-d)/(f-d)+u&&(s=!s)}return s}function iTe(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return sTe(n,e)}function mg(t){return e=>e.pointerType==="mouse"?t(e):void 0}var oTe=oW,aTe=VA,lTe=lW,cTe=cW,uTe=zA,dTe=uW,hTe=i_,fTe=hW,mTe=mW,pTe=gW,gTe=xW,yTe=vW,xTe=wW,vTe=_W,wTe=CW,o_="DropdownMenu",[bTe,Wje]=_i(o_,[sW]),ni=sW(),[_Te,TW]=bTe(o_),IW=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:o,modal:l=!0}=t,c=ni(e),u=p.useRef(null),[d,h]=Oc({prop:s,defaultProp:i??!1,onChange:o,caller:o_});return a.jsx(_Te,{scope:e,triggerId:oc(),triggerRef:u,contentId:oc(),open:d,onOpenChange:h,onOpenToggle:p.useCallback(()=>h(f=>!f),[h]),modal:l,children:a.jsx(oTe,{...c,open:d,onOpenChange:h,dir:r,modal:l,children:n})})};IW.displayName=o_;var NW="DropdownMenuTrigger",PW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=t,i=TW(NW,n),o=ni(n);return a.jsx(aTe,{asChild:!0,...o,children:a.jsx(Yt.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:D0(e,i.triggerRef),onPointerDown:gt(t.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:gt(t.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});PW.displayName=NW;var STe="DropdownMenuPortal",AW=t=>{const{__scopeDropdownMenu:e,...n}=t,r=ni(e);return a.jsx(lTe,{...r,...n})};AW.displayName=STe;var kW="DropdownMenuContent",RW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=TW(kW,n),i=ni(n),o=p.useRef(!1);return a.jsx(cTe,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:e,onCloseAutoFocus:gt(t.onCloseAutoFocus,l=>{var c;o.current||(c=s.triggerRef.current)==null||c.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:gt(t.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,d=c.button===2||u;(!s.modal||d)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});RW.displayName=kW;var CTe="DropdownMenuGroup",ETe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(uTe,{...s,...r,ref:e})});ETe.displayName=CTe;var TTe="DropdownMenuLabel",jW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(dTe,{...s,...r,ref:e})});jW.displayName=TTe;var ITe="DropdownMenuItem",DW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(hTe,{...s,...r,ref:e})});DW.displayName=ITe;var NTe="DropdownMenuCheckboxItem",MW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(fTe,{...s,...r,ref:e})});MW.displayName=NTe;var PTe="DropdownMenuRadioGroup",ATe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(mTe,{...s,...r,ref:e})});ATe.displayName=PTe;var kTe="DropdownMenuRadioItem",LW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(pTe,{...s,...r,ref:e})});LW.displayName=kTe;var RTe="DropdownMenuItemIndicator",FW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(gTe,{...s,...r,ref:e})});FW.displayName=RTe;var jTe="DropdownMenuSeparator",OW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(yTe,{...s,...r,ref:e})});OW.displayName=jTe;var DTe="DropdownMenuArrow",MTe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(xTe,{...s,...r,ref:e})});MTe.displayName=DTe;var LTe="DropdownMenuSubTrigger",VW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(vTe,{...s,...r,ref:e})});VW.displayName=LTe;var FTe="DropdownMenuSubContent",$W=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(wTe,{...s,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});$W.displayName=FTe;var OTe=IW,VTe=PW,$Te=AW,UW=RW,BW=jW,zW=DW,GW=MW,WW=LW,HW=FW,qW=OW,KW=VW,YW=$W;const _x=OTe,Sx=VTe,UTe=p.forwardRef(({className:t,inset:e,children:n,...r},s)=>a.jsxs(KW,{ref:s,className:Ct("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...r,children:[n,a.jsx(jie,{className:"ml-auto"})]}));UTe.displayName=KW.displayName;const BTe=p.forwardRef(({className:t,...e},n)=>a.jsx(YW,{ref:n,className:Ct("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...e}));BTe.displayName=YW.displayName;const Fm=p.forwardRef(({className:t,sideOffset:e=4,...n},r)=>a.jsx($Te,{children:a.jsx(UW,{ref:r,sideOffset:e,className:Ct("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n})}));Fm.displayName=UW.displayName;const Gs=p.forwardRef(({className:t,inset:e,...n},r)=>a.jsx(zW,{ref:r,className:Ct("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",e&&"pl-8",t),...n}));Gs.displayName=zW.displayName;const zTe=p.forwardRef(({className:t,children:e,checked:n,...r},s)=>a.jsxs(GW,{ref:s,className:Ct("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(HW,{children:a.jsx(Ig,{className:"h-4 w-4"})})}),e]}));zTe.displayName=GW.displayName;const GTe=p.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(WW,{ref:r,className:Ct("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(HW,{children:a.jsx(Mie,{className:"h-2 w-2 fill-current"})})}),e]}));GTe.displayName=WW.displayName;const n1=p.forwardRef(({className:t,inset:e,...n},r)=>a.jsx(BW,{ref:r,className:Ct("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));n1.displayName=BW.displayName;const r1=p.forwardRef(({className:t,...e},n)=>a.jsx(qW,{ref:n,className:Ct("-mx-1 my-1 h-px bg-muted",t),...e}));r1.displayName=qW.displayName;const ZL=()=>{const{user:t}=eo(),[e,n]=p.useState(!1),[r,s]=p.useState(null),i=async()=>{if(!t){s("You must be logged in to create a business account.");return}n(!0),s(null);try{const c=(await Qa(Lh,"createConnectAccount")({email:t.email})).data;if(c&&c.accountLinkUrl)window.location.href=c.accountLinkUrl;else throw new Error("Failed to retrieve the Stripe onboarding URL.")}catch(o){console.error("Stripe Connect onboarding error:",o),s(o.message||"An unexpected error occurred."),n(!1)}};return a.jsxs("button",{onClick:i,disabled:e,className:"w-full flex items-center",children:[a.jsx(Jh,{className:"mr-2 h-4 w-4"}),e?"Processing...":"Create Business Account",r&&a.jsx("p",{className:"text-xs text-destructive ml-2",children:r})]})},eF=()=>{const{profile:t}=eo(),[e,n]=p.useState(!1),[r,s]=p.useState(null);if(!(t!=null&&t.stripe_account_id)||!(t!=null&&t.stripe_charges_enabled))return null;const i=async()=>{n(!0),s(null);try{const c=(await Qa(Lh,"createLoginLink")({stripeAccountId:t.stripe_account_id})).data;if(c&&c.loginLinkUrl)window.location.href=c.loginLinkUrl;else throw new Error("Failed to retrieve the Stripe dashboard link.")}catch(o){console.error("Stripe dashboard link error:",o),s(o.message||"An unexpected error occurred."),n(!1)}};return a.jsxs("button",{onClick:i,disabled:e,className:"w-full flex items-center",children:[a.jsx(Jh,{className:"mr-2 h-4 w-4"}),e?"Loading...":"Dashboard",r&&a.jsx("p",{className:"text-xs text-destructive ml-2",children:r})]})},HA=()=>{const{isAuthenticated:t,user:e,logout:n,session:r,subscriptionStatus:s,loadingProfile:i,profile:o}=eo(),l=bi(),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),[g,x]=p.useState(!1),[w,v]=p.useState(!1),[_,C]=p.useState(!1),T=s==="active",R=(o==null?void 0:o.stripe_account_id)&&(o==null?void 0:o.stripe_account_details_submitted);p.useEffect(()=>{const j=localStorage.getItem("theme"),D=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;j==="dark"||!j&&D?(document.documentElement.classList.add("dark"),v(!0)):(document.documentElement.classList.remove("dark"),v(!1))},[]);const A=()=>{w?(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")),v(!w)},E=async()=>{try{await n(),l("/auth")}catch(j){console.error("Error logging out:",j)}},I=async()=>{if(!e){h("Authentication required. Please log in again.");return}u(!0),h(null);try{const M=(await Qa(Lh,"stripeCreatePortalSession")()).data;if(M&&M.url)window.location.href=M.url;else throw new Error(M.error||"Failed to create portal session URL.")}catch(j){console.error("Portal session error:",j),h(j.message||"An unexpected error occurred.")}finally{u(!1)}},P=async()=>{if(!e){h("Authentication required.");return}x(!0);try{const M=(await Qa(Lh,"createConnectAccount")({email:e.email})).data;if(M&&M.accountLinkUrl)window.location.href=M.accountLinkUrl;else throw new Error("Failed to retrieve the Stripe onboarding URL.")}catch(j){console.error("Stripe Connect onboarding error:",j),h(j.message||"An unexpected error occurred.")}finally{x(!1)}},k=async()=>{if(!e){h("Authentication required.");return}m(!0);try{const M=(await Qa(Lh,"createSubscriptionCheckout")({priceId:"price_1RPDinDktew9heHOLkkL3ZDv"})).data;if(M&&M.url)window.location.href=M.url;else throw new Error("Failed to retrieve the Stripe checkout URL.")}catch(j){console.error("Stripe subscription error:",j),h(j.message||"An unexpected error occurred.")}finally{m(!1)}};return a.jsxs(a.Fragment,{children:[!i&&t&&!(o!=null&&o.stripe_account_id&&(o!=null&&o.stripe_account_details_submitted))&&a.jsx("div",{className:"bg-foreground text-background py-2 px-4 text-center text-sm dark:bg-blue-700 dark:text-white",children:a.jsxs("button",{onClick:P,disabled:g,className:"relative hover:underline focus:outline-none",children:[g?"Processing...":"Create Your Business",a.jsx(Yie,{className:"absolute bottom-[-10px] right-[-13px] h-4 w-4 text-white"})]})}),a.jsxs(It.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full py-4 px-6 flex justify-between items-center sticky top-0 z-50 bg-background/80 backdrop-blur-md border-b",children:[a.jsxs(sr,{to:"/",className:"flex items-center gap-2",children:[a.jsx("img",{src:w?"https://static.wixstatic.com/media/bd2e29_20f2a8a94b7e492a9d76e0b8b14e623b~mv2.png":"https://static.wixstatic.com/media/bd2e29_695f70787cc24db4891e63da7e7529b3~mv2.png",alt:"FreshFront Logo",className:"h-10 sm:h-[60px] w-auto transition-all"}),a.jsx("span",{className:"font-bold text-lg sm:text-xl transition-all",children:"FreshFront"})]}),a.jsxs("nav",{className:"hidden md:flex items-center gap-3",children:[!T&&a.jsx(O,{onClick:k,disabled:f,children:f?"Processing...":"Subscribe to Pro"}),a.jsxs(_x,{children:[a.jsx(Sx,{asChild:!0,children:a.jsxs(O,{variant:"ghost",size:"sm",children:["Create ",a.jsx(Iu,{className:"ml-1 h-4 w-4"})]})}),a.jsxs(Fm,{align:"end",children:[a.jsx(Gs,{asChild:!0,children:a.jsx(sr,{to:"/designer",children:"Designer"})}),a.jsx(Gs,{asChild:!0,children:a.jsx("a",{href:"https://www.musicmigo.com",target:"_blank",rel:"noopener noreferrer",children:"Music"})}),a.jsx(Gs,{asChild:!0,children:a.jsx(sr,{to:"/podcast",children:"Podcast"})}),a.jsx(Gs,{asChild:!0,children:a.jsx(sr,{to:"/video",children:"Video"})})]})]}),t&&!i&&a.jsx(a.Fragment,{children:a.jsxs(_x,{children:[a.jsx(Sx,{asChild:!0,children:a.jsxs(O,{variant:"outline",size:"sm",className:"rounded-full px-3 py-1.5 text-sm font-medium",children:[a.jsx(Rie,{className:"mr-2 h-4 w-4"})," Business ",a.jsx(Iu,{className:"ml-1 h-4 w-4"})]})}),a.jsxs(Fm,{align:"end",children:[a.jsx(n1,{children:"Stripe Connect"}),a.jsx(r1,{}),R?a.jsx(Gs,{children:a.jsx(eF,{})}):a.jsx(Gs,{children:a.jsx(ZL,{})}),T&&a.jsxs(Gs,{onClick:I,disabled:c,children:[a.jsx(Nh,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Billing"]}),d&&a.jsx(Gs,{disabled:!0,children:a.jsx("p",{className:"text-xs text-destructive",children:d})})]})]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Oo,{id:"theme-switcher-desktop",checked:w,onCheckedChange:A,"aria-label":"Toggle dark mode"}),w?a.jsx(PE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(kE,{className:"h-5 w-5 text-muted-foreground"})]}),t?a.jsxs(_x,{children:[a.jsx(Sx,{asChild:!0,children:a.jsxs(O,{variant:"ghost",className:"flex items-center gap-2",children:[(e==null?void 0:e.photoURL)&&a.jsx("img",{src:e.photoURL,alt:"User avatar",className:"h-6 w-6 rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground hidden lg:inline",children:e==null?void 0:e.email}),a.jsx(Iu,{className:"h-4 w-4"})]})}),a.jsxs(Fm,{align:"end",children:[a.jsx(n1,{children:"My Account"}),a.jsx(r1,{}),T&&a.jsxs(Gs,{onClick:I,disabled:c,children:[a.jsx(Nh,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Billing"]}),a.jsxs(Gs,{onClick:E,children:[a.jsx(S2,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(sr,{to:"/auth",children:a.jsx(O,{variant:"ghost",size:"sm",children:"Log In"})}),a.jsx(sr,{to:"/auth",children:a.jsx(O,{size:"sm",children:"Sign Up"})})]})]}),a.jsx("div",{className:"md:hidden",children:a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>C(!_),children:_?a.jsx(Ki,{className:"h-6 w-6"}):a.jsx($3,{className:"h-6 w-6"})})})]}),a.jsx(Sc,{children:_&&a.jsx(It.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"md:hidden fixed inset-x-0 top-[117px] z-40 bg-background/95 backdrop-blur-sm p-6 border-b shadow-lg",children:a.jsxs("nav",{className:"flex flex-col gap-4",children:[a.jsxs(_x,{children:[a.jsx(Sx,{asChild:!0,children:a.jsxs(O,{variant:"ghost",className:"w-full justify-start px-3 py-2 text-base",children:["Create ",a.jsx(Iu,{className:"ml-auto h-4 w-4"})]})}),a.jsxs(Fm,{align:"end",children:[a.jsx(Gs,{asChild:!0,children:a.jsx(sr,{to:"/designer",children:"Designer"})}),a.jsx(Gs,{asChild:!0,children:a.jsx("a",{href:"https://www.musicmigo.com",target:"_blank",rel:"noopener noreferrer",children:"Music"})}),a.jsx(Gs,{asChild:!0,children:a.jsx(sr,{to:"/podcast",children:"Podcast"})}),a.jsx(Gs,{asChild:!0,children:a.jsx(sr,{to:"/video",children:"Video"})})]})]}),t&&!i&&a.jsxs(a.Fragment,{children:[R?a.jsx(eF,{}):a.jsx(ZL,{}),T&&a.jsxs(O,{variant:"outline",onClick:I,disabled:c,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(Nh,{className:"mr-2 h-4 w-4"})," ",c?"Loading...":"Manage Billing"]}),d&&a.jsx("p",{className:"text-xs text-destructive px-3 py-1",children:d})]}),a.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[a.jsx("span",{className:"text-base",children:"Dark Mode"}),a.jsx(Oo,{id:"theme-switcher-mobile",checked:w,onCheckedChange:A,"aria-label":"Toggle dark mode"})]}),t?a.jsxs(a.Fragment,{children:[(e==null?void 0:e.photoURL)&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",children:[a.jsx("img",{src:e.photoURL,alt:"User avatar",className:"h-8 w-8 rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:e==null?void 0:e.email})]}),a.jsxs(O,{variant:"outline",onClick:E,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(S2,{className:"mr-2 h-4 w-4"})," Logout"]})]}):a.jsxs(a.Fragment,{children:[a.jsx(sr,{to:"/auth",className:"w-full",children:a.jsx(O,{variant:"ghost",className:"w-full justify-start px-3 py-2 text-base",children:"Log In"})}),a.jsx(sr,{to:"/auth",className:"w-full",children:a.jsx(O,{className:"w-full justify-start px-3 py-2 text-base",children:"Sign Up"})})]})]})})})]})},WTe=({rating:t})=>{const n=Math.round(t);return a.jsx("div",{className:"flex items-center",children:[...Array(5)].map((r,s)=>a.jsx(MI,{className:`h-4 w-4 ${s<n?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},s))})},HTe=({isOpen:t,onClose:e,onAddProducts:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState(!1),[l,c]=p.useState([]),[u,d]=p.useState([]);p.useState({});const h=async()=>{if(r.trim()){o(!0),c([]);try{const x=await(await fetch(`https://us-central1-freshfront-c3181.cloudfunctions.net/aliexpressProxy?q=${encodeURIComponent(r)}`)).json();x.result&&x.result.resultList?c(x.result.resultList):(console.warn("Unexpected API response structure:",x),c([]))}catch(g){console.error("Error fetching from AliExpress API:",g),c([])}finally{o(!1)}}},f=g=>{const x=u.some(w=>w.item.itemId===g.item.itemId);d(x?w=>w.filter(v=>v.item.itemId!==g.item.itemId):w=>[...w,g])},m=()=>{n(u),e()};return a.jsx(Xr,{open:t,onOpenChange:e,children:a.jsxs(Ur,{className:"max-w-4xl h-[80vh] flex flex-col",children:[a.jsx(Br,{children:a.jsx(zr,{children:"Search AliExpress Products"})}),a.jsxs("div",{className:"flex gap-2 p-4 border-b",children:[a.jsx(Ye,{placeholder:"Search for products...",value:r,onChange:g=>s(g.target.value),onKeyPress:g=>g.key==="Enter"&&h(),className:"flex-grow"}),a.jsx(O,{onClick:h,disabled:i,children:i?a.jsx(ft,{className:"animate-spin"}):a.jsx(ic,{})})]}),a.jsxs("div",{className:"flex-grow overflow-y-auto p-4",children:[i&&a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(ft,{className:"animate-spin h-8 w-8"})}),!i&&l.length===0&&a.jsx("div",{className:"text-center text-gray-500",children:"No products found."}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:l.map(g=>a.jsxs("div",{className:`border rounded-lg p-2 cursor-pointer ${u.some(x=>x.item.itemId===g.item.itemId)?"border-blue-500 ring-2 ring-blue-500":""}`,onClick:()=>f(g),children:[a.jsx("img",{src:g.item.image,alt:g.item.title,className:"w-full h-40 object-cover rounded-md mb-2"}),a.jsx("h3",{className:"text-sm font-semibold truncate",children:g.item.title}),a.jsxs("p",{className:"text-lg font-bold text-blue-600",children:["$",g.item.sku.def.promotionPrice]}),g.item.averageStarRate&&a.jsx(WTe,{rating:g.item.averageStarRate}),a.jsx(O,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:x=>{x.stopPropagation(),window.open(`https:${g.item.itemUrl}`,"_blank")},children:"Visit"})]},g.item.itemId))})]}),a.jsxs(Ar,{className:"p-4 border-t",children:[a.jsx(O,{variant:"outline",onClick:e,children:"Cancel"}),a.jsxs(O,{onClick:m,disabled:u.length===0,children:["Add ",u.length," Products to Store"]})]})]})})};var qA="Progress",KA=100,[qTe,Hje]=_i(qA),[KTe,YTe]=qTe(qA),JW=p.forwardRef((t,e)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=JTe,...o}=t;(s||s===0)&&!tF(s)&&console.error(XTe(`${s}`,"Progress"));const l=tF(s)?s:KA;r!==null&&!nF(r,l)&&console.error(QTe(`${r}`,"Progress"));const c=nF(r,l)?r:null,u=r0(c)?i(c,l):void 0;return a.jsx(KTe,{scope:n,value:c,max:l,children:a.jsx(Yt.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":r0(c)?c:void 0,"aria-valuetext":u,role:"progressbar","data-state":ZW(c,l),"data-value":c??void 0,"data-max":l,...o,ref:e})})});JW.displayName=qA;var XW="ProgressIndicator",QW=p.forwardRef((t,e)=>{const{__scopeProgress:n,...r}=t,s=YTe(XW,n);return a.jsx(Yt.div,{"data-state":ZW(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:e})});QW.displayName=XW;function JTe(t,e){return`${Math.round(t/e*100)}%`}function ZW(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function r0(t){return typeof t=="number"}function tF(t){return r0(t)&&!isNaN(t)&&t>0}function nF(t,e){return r0(t)&&!isNaN(t)&&t<=e&&t>=0}function XTe(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${KA}\`.`}function QTe(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${KA} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var eH=JW,ZTe=QW;const $a=p.forwardRef(({className:t,value:e,...n},r)=>a.jsx(eH,{ref:r,className:Ct("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:a.jsx(ZTe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));$a.displayName=eH.displayName;const e1e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),t1e=({isOpen:t,onClose:e,product:n,onSave:r,storeId:s,theme:i})=>{const[o,l]=p.useState(null),[c,u]=p.useState(!1),[d,h]=p.useState(!1),[f,m]=p.useState(null),[g,x]=p.useState(!1),{toast:w}=bs();p.useEffect(()=>{if(n){const B=n.item&&n.item.itemId;l(B?{...n,id:n.item.itemId,name:n.item.title,description:n.item.title,price:n.item.sku.def.promotionPrice*1.5,cost:n.item.sku.def.promotionPrice,shipping:0,images:[n.item.image],variants:[],inventory_count:0}:{...n,name:n.name||n.product_title,description:n.description||n.product_description||"",price:n.price||n.target_sale_price*1.5,cost:n.cost||n.target_sale_price,shipping:n.shipping||n.shipping_cost||0,images:n.images||[n.product_main_image_url],variants:n.variants||[],inventory_count:n.inventory_count||0})}},[n]);const v=(B,W)=>{l(Q=>({...Q,[B]:W}))},_=async B=>{if(B)try{const W=await e1e(B);l(Q=>{const H=Array.isArray(Q.images)?Q.images:[];return{...Q,images:[...H,W]}})}catch(W){console.error("Error converting file to base64:",W),w({title:"Image Upload Error",description:"Could not process image.",variant:"destructive"})}},C=B=>{l(W=>({...W,images:W.images.filter((Q,H)=>H!==B)}))},T=async()=>{if(!o||!o.name){w({title:"Missing Product Info",description:"Product name is required to generate visuals.",variant:"destructive"});return}const B=o.images&&o.images.length>0?o.images[0]:null;if(!B){w({title:"Missing Base Image",description:"At least one image is required to generate more visuals.",variant:"destructive"});return}h(!0);try{const{base64ImageData:W,mimeType:Q}=await cg(B),H=o.name;let Y=[];try{const $=await W0(W,Q,H);$&&$.length>0&&Y.push(...$.slice(0,2)),w({title:"Angles Generated",description:`${Math.min(2,($==null?void 0:$.length)||0)} angle images generated.`,variant:"success"})}catch($){console.error("Error generating angles:",$),w({title:"Angle Generation Failed",description:$.message,variant:"destructive"})}const V=[`Place this product, "${H}", in a realistic home setting where it might be used or displayed. Focus on a natural context.`,`Show this product, "${H}", in an outdoor lifestyle setting, highlighting its use case or appeal.`];for(const $ of V)try{const z=await Wo(W,Q,$);z&&z.editedImageData&&Y.push(`data:${z.newMimeType};base64,${z.editedImageData}`)}catch(z){console.error(`Error generating context image with prompt "${$}":`,z),w({title:"Context Image Failed",description:`Failed for: ${$.substring(0,30)}...`,variant:"destructive"})}w({title:"Context Images Attempted",description:`Attempted to generate ${V.length} context images.`,variant:"success"}),Y.length>0?l($=>{const z=Array.isArray($.images)?$.images:[],F=new Set(z),Z=Y.filter(fe=>!F.has(fe));return Z.length>0?{...$,images:[...z,...Z]}:(w({title:"Visuals Generated",description:"Generated images were already present.",variant:"default"}),$)}):w({title:"No New Visuals",description:"Could not generate additional visuals.",variant:"default"})}catch(W){console.error("Error in handleGenerateMoreVisuals:",W),w({title:"Visual Generation Error",description:W.message,variant:"destructive"})}finally{h(!1)}},R=(B,W)=>{l(Q=>{const H=[...Q.variants||[]];return H[B]={...H[B],name:W},{...Q,variants:H}})},A=(B,W,Q)=>{l(H=>{const Y=[...H.variants||[]],V={...Y[B]};return V.values=[...V.values||[]],V.values[W]=Q,Y[B]=V,{...H,variants:Y}})},E=B=>{l(W=>{const Q=[...W.variants||[]],H={...Q[B]};return H.values=[...H.values||[],""],Q[B]=H,{...W,variants:Q}})},I=(B,W)=>{l(Q=>{const H=[...Q.variants||[]],Y={...H[B]};return Y.values=(Y.values||[]).filter((V,$)=>$!==W),H[B]=Y,{...Q,variants:H}})},P=()=>{l(B=>({...B,variants:[...B.variants||[],{name:"",values:[""]}]}))},k=B=>{l(W=>({...W,variants:(W.variants||[]).filter((Q,H)=>H!==B)}))},j=async()=>{if(u(!0),!o.name||o.name.trim()===""||o.price===void 0||String(o.price).trim()===""){w({title:"Missing Information",description:"Please ensure the product has a name and a valid price.",variant:"destructive"}),u(!1);return}try{const B={...o,product_title:o.name,product_description:o.description,sale_price:o.price,target_sale_price:o.cost,shipping_cost:o.shipping,product_main_image_url:o.images[0]};await r(B,n.id),e()}catch{w({title:"Save Error",description:"Could not save product changes.",variant:"destructive"})}finally{u(!1)}},D=B=>{m(B),x(!0)};if(!t||!o)return null;const M=o.price-o.cost-o.shipping,G=o.price>0?M/o.price*100:0;return a.jsxs(a.Fragment,{children:[a.jsx(Xr,{open:t,onOpenChange:B=>!B&&e(),children:a.jsxs(Ur,{className:"max-w-2xl",children:[a.jsxs(Br,{children:[a.jsxs(zr,{children:["Edit Product: ",n.item?n.item.title:n.product_title]}),a.jsx(Zi,{children:"Make changes to the product details below."})]}),a.jsx(xs,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"space-y-4 pr-4",children:a.jsxs(Je,{className:"p-4 space-y-3",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"productName-edit",children:"Product Name"}),a.jsx(Ye,{id:"productName-edit",value:o.name,onChange:B=>v("name",B.target.value),placeholder:"Product Name"})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"productDescription-edit",children:"Description"}),a.jsx(Pn,{id:"productDescription-edit",value:o.description,onChange:B=>v("description",B.target.value),placeholder:"Product Description",rows:3})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs(De,{htmlFor:"productPrice-edit",children:["Price (",o.currencyCode||"USD",")"]}),a.jsx(Ye,{id:"productPrice-edit",type:"number",value:o.price,onChange:B=>v("price",parseFloat(B.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),a.jsx($a,{value:100,className:"h-2"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(De,{htmlFor:"productCost-edit",children:"Cost"}),a.jsx(Ye,{id:"productCost-edit",type:"number",value:o.cost,onChange:B=>v("cost",parseFloat(B.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),a.jsx($a,{value:o.price>0?o.cost/o.price*100:0,className:"h-2 [&>div]:bg-red-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(De,{htmlFor:"productShipping-edit",children:"Shipping"}),a.jsx(Ye,{id:"productShipping-edit",type:"number",value:o.shipping,onChange:B=>v("shipping",parseFloat(B.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),a.jsx($a,{value:o.price>0?o.shipping/o.price*100:0,className:"h-2 [&>div]:bg-orange-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(De,{children:"Profit"}),a.jsx(Ye,{value:M.toFixed(2),disabled:!0,className:"w-24 text-right"})]}),a.jsx($a,{value:G,className:"h-2 [&>div]:bg-green-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(De,{children:"Profit Margin"}),a.jsx(Ye,{value:`${G.toFixed(2)}%`,disabled:!0,className:"w-24 text-right"})]}),a.jsx($a,{value:G,className:"h-2 [&>div]:bg-green-500"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{children:"Product Images"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(o.images||[]).map((B,W)=>a.jsxs("div",{className:"relative group w-24 h-24 cursor-pointer",onClick:()=>D(B),children:[a.jsx("img",{src:B,alt:`Product image ${W+1}`,className:"w-full h-full object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Q=>{Q.stopPropagation(),C(W)},children:a.jsx(Wn,{className:"h-3 w-3"})})]},W))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById("productImageUpload-edit").click(),children:[a.jsx(Uo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsx(Ye,{id:"productImageUpload-edit",type:"file",accept:"image/*",className:"hidden",onChange:B=>_(B.target.files[0])}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:T,disabled:c||d||!o.name||!o.images||o.images.length===0,children:[d?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"More Angles/Context (AI)"]})]})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(o.variants||[]).map((B,W)=>a.jsxs(Je,{className:"p-2 space-y-2 bg-muted/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(De,{htmlFor:`variantName-edit-${W}`,className:"text-xs",children:"Option Name"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>k(W),className:"h-6 w-6",children:a.jsx(Wn,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(Ye,{id:`variantName-edit-${W}`,value:B.name||"",onChange:Q=>R(W,Q.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(De,{className:"text-xs",children:"Option Values"}),(B.values||[]).map((Q,H)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ye,{value:Q||"",onChange:Y=>A(W,H,Y.target.value),placeholder:"e.g., Red",className:"text-sm h-8"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>I(W,H),className:"h-6 w-6",children:a.jsx(Wn,{className:"h-3 w-3 text-destructive"})})]},H)),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>E(W),className:"text-xs h-7",children:[a.jsx(Vi,{className:"mr-1 h-3 w-3"})," Add Value"]})]},W)),a.jsxs(O,{variant:"outline",onClick:P,className:"w-full text-sm h-8",children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]}),a.jsxs("div",{className:"pt-3 border-t mt-3",children:[a.jsx(De,{htmlFor:"productInventory-edit",children:"Inventory Count"}),a.jsx(Ye,{id:"productInventory-edit",type:"number",value:o.inventory_count||"",onChange:B=>v("inventory_count",parseInt(B.target.value)||0),placeholder:"0"})]})]})})}),a.jsxs(Ar,{children:[a.jsx(il,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel"})}),a.jsxs(O,{type:"button",onClick:j,disabled:c,children:[c?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Save Changes"]})]})]})}),g&&f&&a.jsx(Xr,{open:g,onOpenChange:x,children:a.jsxs(Ur,{className:"max-w-xl max-h-[80vh]",children:[a.jsxs(Br,{children:[a.jsx(zr,{children:"Enlarged Image"}),a.jsx(il,{asChild:!0,children:a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-4 right-4",onClick:()=>x(!1),children:a.jsx(Vi,{className:"h-4 w-4 rotate-45"})})})]}),a.jsx("div",{className:"flex justify-center items-center p-4",children:a.jsx("img",{src:f,alt:"Enlarged product",className:"max-w-full max-h-[70vh] object-contain"})})]})})]})},rF=["Create a custom name jewelry store called 'Elegance' with diamond rings and gold necklaces, featuring a dark, sophisticated theme.","Build a website for my digital marketing, content creation and web development services, using modern glassmorphism and minimalist styles.","Design an organic food market 'GreenHarvest' with fresh produce and healthy snacks, emphasizing natural textures and earthy tones.","Make a trendy fashion boutique 'Urban Threads' with summer dresses and casual wear, aiming for a bright, minimalist aesthetic."],tC={"Healthy Food":{keywords:["healthy food","organic food","greenharvest","fresh produce","natural food","health store"],primaryColor:"green",secondaryColor:"orange",templates:["Classic","Fresh","Sleek"]},"Fast Food":{keywords:["fast food","burgers","fries","pizza","takeaway","quick serve"],primaryColor:"red",secondaryColor:"orange",templates:["Premium","Modern","Classic","Fresh","Sleek"]},Technology:{keywords:["tech","gadget","electronics","software","computer","phone","futuretech"],primaryColor:"blue",secondaryColor:"purple",templates:["Classic","Fresh","Sleek","Sharp","Premium","Modern"]},"General Store":{keywords:["general store","variety store","convenience store","department store"],primaryColor:"navy",secondaryColor:"grey",templates:["Classic","Fresh","Sleek","Premium","Modern"]},"Female Fashion/Beauty":{keywords:["female fashion","beauty","cosmetics","makeup","women's clothing","boutique","urban threads"],primaryColor:"peach",secondaryColor:"purple",templates:["Classic","Fresh","Sleek"]},Jewelry:{keywords:["jewelry","rings","necklaces","earrings","diamonds","gold","elegance"],primaryColor:"grey",secondaryColor:"darkpurple",templates:["Classic","Fresh","Sleek","Premium","Modern"]},Fashion:{keywords:["fashion","clothing","apparel","style","wear"],primaryColor:"navyblue",secondaryColor:"mediumred",templates:["Classic","Fresh","Sleek","Premium","Modern"]},Furniture:{keywords:["furniture","home decor","sofa","table","chair","furnishings"],primaryColor:"brown",secondaryColor:"darkgrey",templates:["Classic","Fresh","Sleek"]},Default:{keywords:[],primaryColor:"blue",secondaryColor:"gray",templates:["Fresh","Classic","Sleek","Modern"]}},n1e=t=>{const e=t.toLowerCase();for(const n in tC){if(n==="Default")continue;const r=tC[n];if(r.keywords.some(s=>e.includes(s.toLowerCase())))return{...r,name:n}}return{...tC.Default,name:"General Store"}},r1e=({generatedImage:t})=>{const[e,n]=p.useState(""),[r,s]=p.useState(""),[i,o]=p.useState(null),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[h,f]=p.useState(!1),[m,g]=p.useState([]),[x,w]=p.useState(null),[v,_]=p.useState(!1),[C,T]=p.useState([]),R=p.useRef(null),{generateStore:A,isGenerating:E,importedStoreDataForGenerator:I,isImportDataReadyForGenerator:P,clearImportedStoreDataForGenerator:k,stores:j,openAuthModal:D}=zn(),{isAuthenticated:M}=eo(),[G,B]=p.useState(!1),[W,Q]=p.useState(null),[H,Y]=p.useState([]),[V,$]=p.useState(!1),[z,F]=p.useState(null),Z=Mse(e,500);p.useEffect(()=>{if(t){const de=atob(t.split(",")[1]),Me=t.split(",")[0].split(":")[1].split(";")[0],Ge=new ArrayBuffer(de.length),yt=new Uint8Array(Ge);for(let fn=0;fn<de.length;fn++)yt[fn]=de.charCodeAt(fn);const Pt=new Blob([Ge],{type:Me}),en=new File([Pt],"design.png",{type:Me});T([{file:en,previewUrl:t}])}},[t]),p.useEffect(()=>{(async()=>{if(!Z.trim()||V)return;$(!0),F(null),Y([]);const Me=await bI(Z);Me.suggestions?Y(Me.suggestions):F(Me.error||"Failed to get suggestions."),$(!1)})()},[Z]),p.useEffect(()=>()=>{C.forEach(de=>{de.previewUrl&&URL.revokeObjectURL(de.previewUrl)})},[C]),p.useEffect(()=>{P&&I&&(n(I.name||""),s(I.prompt||""),I.name&&ge(I.name),k())},[P,I,k]);const fe=de=>{n(de.target.value),Q(null),Y([]),F(null)},xe=de=>{n(de),Y([]),Q(null),setTimeout(()=>ge(de),0)},ge=p.useCallback(async de=>{const Me=de||e;if(!Me.trim())return Q({status:"error",message:"Store name cannot be empty."}),!1;B(!0),Q(null);try{return await qT(Me.trim())?(Q({status:"claimed",message:"Not available"}),!1):(Q({status:"available",message:"Available"}),!0)}catch(Ge){return console.error("Store name availability check failed in StoreGenerator:",Ge),Q({status:"error",message:Ge.message||"Failed to check name. Please try again."}),!1}finally{B(!1)}},[e]),Re=de=>{o(de);const Me=rF[de],Ge=Me.match(/(?:store called|store named|market|boutique) '([^']+)'/i),yt=Ge&&Ge[1]?Ge[1]:"";n(yt),s(Me),Q(null),yt&&setTimeout(()=>ge(yt),0)},Ue=async de=>{if(de.preventDefault(),!M&&j.length>=1){D();return}let Me=!1;if(W&&W.status==="available"?Me=!0:e.trim()?Me=await ge(e):Q({status:"error",message:"Store name cannot be empty."}),!Me)return;if(!r.trim()){alert("Please provide a description for your store.");return}if(E||G)return;const Ge=n1e(r);try{await A(r,e,Ge,[],l,u,C,m)}catch(yt){console.error("Error calling generateStore from StoreGenerator:",yt),alert(`An error occurred during the store generation step: ${yt.message}`)}},ze=de=>{const Ge=Array.from(de.target.files).map(yt=>({file:yt,previewUrl:yt.type.startsWith("image/")?URL.createObjectURL(yt):null}));T(yt=>[...yt,...Ge])},he=de=>{const Me=C[de];Me.previewUrl&&URL.revokeObjectURL(Me.previewUrl),T(Ge=>Ge.filter((yt,Pt)=>Pt!==de))},Ce=de=>{g(de)},Pe=de=>{w(de),_(!0)},ve=(de,Me)=>{g(m.map(Ge=>Ge.item.itemId===Me?de:Ge)),_(!1)};return a.jsxs(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full",children:[a.jsxs("form",{onSubmit:Ue,children:[a.jsxs("div",{className:"mb-[13px]",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"storeName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 ml-[6px]",children:"Store Name"}),a.jsxs("div",{className:"relative flex items-center",children:[a.jsx(Ye,{id:"storeName",type:"text",placeholder:"ex. Future Furniture",className:Ct("text-base flex-grow",(W==null?void 0:W.status)==="claimed"&&"border-red-500 focus:border-red-500 dark:border-red-500 dark:focus:border-red-500",(W==null?void 0:W.status)==="error"&&"border-yellow-500 focus:border-yellow-500 dark:border-yellow-500 dark:focus:border-yellow-500",(W==null?void 0:W.status)==="available"&&"border-green-500 focus:border-green-500 dark:border-green-500 dark:focus:border-green-500","pr-24"),value:e,onChange:fe,disabled:E||G}),a.jsxs(O,{type:"button",variant:"ghost",size:"sm",onClick:()=>ge(),disabled:!e.trim()||G,className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 px-2 z-10",children:[G?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(ya,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-1 hidden sm:inline",children:"Check"})]})]}),a.jsxs("div",{className:"mt-1",children:[" ",G&&e.trim()&&a.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[a.jsx(ft,{className:"h-4 w-4 animate-spin mr-2"})," Checking..."]}),W&&e.trim()&&!G&&a.jsxs("p",{className:`text-sm font-medium flex items-center ${W.status==="available"?"text-green-600":W.status==="claimed"?"text-red-600":W.status==="error"?"text-yellow-600":"text-muted-foreground"}`,children:[W.status==="available"&&a.jsx(ya,{className:"h-4 w-4 mr-1"}),W.status==="claimed"&&a.jsx(K_,{className:"h-4 w-4 mr-1"}),W.status==="error"&&a.jsx(K_,{className:"h-4 w-4 mr-1"}),W.message]})]}),(V||H.length>0||z)&&a.jsxs("div",{className:"mt-[7px] mb-[13px]",children:[V&&a.jsxs("div",{className:"flex items-center space-x-2 animate-pulse h-8",children:[a.jsx("div",{className:"h-8 w-28 bg-gray-200 dark:bg-gray-700 rounded-md"}),a.jsx("div",{className:"h-8 w-32 bg-gray-200 dark:bg-gray-700 rounded-md"}),a.jsx("div",{className:"h-8 w-24 bg-gray-200 dark:bg-gray-700 rounded-md"})]}),!V&&H.length>0&&a.jsxs(It.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-wrap gap-2",children:[a.jsx("span",{className:"text-sm text-muted-foreground mr-2 self-center",children:"Suggestions:"}),H.map((de,Me)=>a.jsx(O,{type:"button",variant:"outline",size:"sm",onClick:()=>xe(de),className:"bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 dark:border-gray-600 saturate-0",children:de},Me))]}),z&&a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(K_,{className:"h-4 w-4 mr-1"})," ",z]})]})]}),a.jsxs("div",{className:"pt-0 mt-[14px] mb-[13px]",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("label",{htmlFor:"storePrompt",className:"text-sm font-medium text-gray-700 dark:text-gray-300 ml-[6px]",children:"Prompt"}),a.jsxs("div",{className:"flex items-center",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"printOnDemandCheckbox",checked:l,onChange:de=>{c(de.target.checked),de.target.checked&&d(!1)},className:Ct("appearance-none h-4 w-4 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-1 dark:focus:ring-offset-gray-900 cursor-pointer",!l&&"border border-gray-400 dark:border-gray-500","focus:ring-orange-500",l&&"bg-orange-500 border-transparent animate-radiate-orange")}),a.jsx("label",{htmlFor:"printOnDemandCheckbox",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Print on Demand"})]}),a.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[a.jsx("input",{type:"checkbox",id:"dropshippingCheckbox",checked:u,onChange:de=>{d(de.target.checked),de.target.checked&&(c(!1),f(!0))},className:Ct("appearance-none h-4 w-4 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-1 dark:focus:ring-offset-gray-900 cursor-pointer",!u&&"border border-gray-400 dark:border-gray-500","focus:ring-blue-500",u&&"bg-blue-500 border-transparent animate-radiate-blue")}),a.jsx("label",{htmlFor:"dropshippingCheckbox",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Dropshipping"})]})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Pn,{id:"storePrompt",placeholder:"ex. 'A modern furniture store specializing in sustainable and innovative designs for the contemporary home. Focus on minimalist aesthetics and smart functionality.'",className:"min-h-[120px] text-base resize-none w-full pr-12",value:r,onChange:de=>s(de.target.value),disabled:E}),a.jsxs("div",{className:"absolute bottom-2 right-2 flex items-center",children:[a.jsx("div",{className:"flex items-center gap-2 mr-2",children:C.map((de,Me)=>a.jsxs("div",{className:"relative group",children:[de.previewUrl?a.jsx("img",{src:de.previewUrl,alt:"Preview",className:"h-8 w-8 rounded-md object-cover"}):a.jsx("div",{className:"h-8 w-8 rounded-md bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:a.jsx(Sr,{className:"h-5 w-5 text-gray-500"})}),a.jsx(O,{variant:"ghost",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 rounded-full bg-red-500 text-white opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>he(Me),children:a.jsx(Ki,{className:"h-3 w-3"})})]},Me))}),a.jsx(O,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",onClick:()=>R.current.click(),disabled:E,children:a.jsx(Jie,{className:"h-5 w-5"})})]}),a.jsx("input",{type:"file",ref:R,multiple:!0,onChange:ze,className:"hidden",accept:"application/pdf,image/*"})]})]}),m.length>0&&a.jsxs("div",{className:"mt-4",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Selected Dropshipping Products"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:m.map(de=>a.jsxs("div",{className:"border rounded-lg p-2 cursor-pointer",onClick:()=>Pe(de),children:[a.jsx("img",{src:de.item.image,alt:de.item.title,className:"w-full h-24 object-cover rounded-md mb-2"}),a.jsx("p",{className:"text-sm truncate",children:de.item.title})]},de.item.itemId))})]})]}),a.jsx(O,{type:"submit",disabled:!e.trim()||!r.trim()||E||G||W&&W.status!=="available",className:"w-full bg-gradient-to-r from-green-600 to-cyan-600 hover:from-green-700 hover:to-cyan-700 text-white mt-6",size:"lg",children:E?a.jsxs(a.Fragment,{children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Store..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ca,{className:"mr-2 h-4 w-4"}),"Generate Store"]})}),a.jsxs("div",{className:"space-y-2 mt-6",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Or try one of these examples for inspiration:"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:rF.map((de,Me)=>a.jsx(O,{type:"button",variant:"outline",className:Ct("h-auto py-2 px-3 justify-start text-left text-sm font-normal",i===Me?"bg-[#c9ccd1] text-black hover:bg-[#c9ccd1] dark:bg-[#242424] dark:text-gray-300 dark:hover:bg-[#242424]":"hover:bg-accent hover:text-accent-foreground"),onClick:()=>Re(Me),disabled:E,children:de},Me))})]})]}),a.jsx(HTe,{isOpen:h,onClose:()=>f(!1),onAddProducts:Ce}),x&&a.jsx(t1e,{isOpen:v,onClose:()=>_(!1),product:x,onSave:ve})]})};var s1e="AlertDialog",[i1e,qje]=_i(s1e,[fU]),Yc=fU(),o1e="AlertDialogTrigger",a1e=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Yc(n);return a.jsx(gae,{...s,...r,ref:e})});a1e.displayName=o1e;var l1e="AlertDialogPortal",tH=t=>{const{__scopeAlertDialog:e,...n}=t,r=Yc(e);return a.jsx(PU,{...r,...n})};tH.displayName=l1e;var c1e="AlertDialogOverlay",nH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Yc(n);return a.jsx(BI,{...s,...r,ref:e})});nH.displayName=c1e;var Oh="AlertDialogContent",[u1e,d1e]=i1e(Oh),h1e=$se("AlertDialogContent"),rH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,children:r,...s}=t,i=Yc(n),o=p.useRef(null),l=yn(e,o),c=p.useRef(null);return a.jsx(dae,{contentName:Oh,titleName:sH,docsSlug:"alert-dialog",children:a.jsx(u1e,{scope:n,cancelRef:c,children:a.jsxs(zI,{role:"alertdialog",...i,...s,ref:l,onOpenAutoFocus:gt(s.onOpenAutoFocus,u=>{var d;u.preventDefault(),(d=c.current)==null||d.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[a.jsx(h1e,{children:r}),a.jsx(m1e,{contentRef:o})]})})})});rH.displayName=Oh;var sH="AlertDialogTitle",iH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Yc(n);return a.jsx(GI,{...s,...r,ref:e})});iH.displayName=sH;var oH="AlertDialogDescription",aH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Yc(n);return a.jsx(WI,{...s,...r,ref:e})});aH.displayName=oH;var f1e="AlertDialogAction",lH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Yc(n);return a.jsx(U0,{...s,...r,ref:e})});lH.displayName=f1e;var cH="AlertDialogCancel",uH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,{cancelRef:s}=d1e(cH,n),i=Yc(n),o=yn(e,s);return a.jsx(U0,{...i,...r,ref:o})});uH.displayName=cH;var m1e=({contentRef:t})=>{const e=`\`${Oh}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Oh}\` by passing a \`${oH}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Oh}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{var r;document.getElementById((r=t.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(e)},[e,t]),null},p1e=tH,dH=nH,hH=rH,fH=lH,mH=uH,pH=iH,gH=aH;const g1e=p1e,yH=ht.forwardRef(({className:t,...e},n)=>a.jsx(dH,{className:Ct("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:n}));yH.displayName=dH.displayName;const y1e=ht.forwardRef(({className:t,...e},n)=>a.jsxs(g1e,{children:[a.jsx(yH,{}),a.jsx(hH,{ref:n,className:Ct("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e})]}));y1e.displayName=hH.displayName;const x1e=ht.forwardRef(({className:t,...e},n)=>a.jsx(pH,{ref:n,className:Ct("text-lg font-semibold",t),...e}));x1e.displayName=pH.displayName;const v1e=ht.forwardRef(({className:t,...e},n)=>a.jsx(gH,{ref:n,className:Ct("text-sm text-muted-foreground",t),...e}));v1e.displayName=gH.displayName;const w1e=ht.forwardRef(({className:t,...e},n)=>a.jsx(fH,{ref:n,className:Ct(HI(),t),...e}));w1e.displayName=fH.displayName;const b1e=ht.forwardRef(({className:t,...e},n)=>a.jsx(mH,{ref:n,className:Ct(HI({variant:"outline"}),"mt-2 sm:mt-0",t),...e}));b1e.displayName=mH.displayName;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var s1=function(t,e){return s1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},s1(t,e)};function _1e(t,e){s1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var S1e=100,C1e=100,sF=50,i1=50,o1=50;function iF(t){var e=t.className,n=t.counterClockwise,r=t.dashRatio,s=t.pathRadius,i=t.strokeWidth,o=t.style;return p.createElement("path",{className:e,style:Object.assign({},o,T1e({pathRadius:s,dashRatio:r,counterClockwise:n})),d:E1e({pathRadius:s,counterClockwise:n}),strokeWidth:i,fillOpacity:0})}function E1e(t){var e=t.pathRadius,n=t.counterClockwise,r=e,s=n?1:0;return`
      M `+i1+","+o1+`
      m 0,-`+r+`
      a `+r+","+r+" "+s+" 1 1 0,"+2*r+`
      a `+r+","+r+" "+s+" 1 1 0,-"+2*r+`
    `}function T1e(t){var e=t.counterClockwise,n=t.dashRatio,r=t.pathRadius,s=Math.PI*2*r,i=(1-n)*s;return{strokeDasharray:s+"px "+s+"px",strokeDashoffset:(e?-i:i)+"px"}}var I1e=function(t){_1e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getBackgroundPadding=function(){return this.props.background?this.props.backgroundPadding:0},e.prototype.getPathRadius=function(){return sF-this.props.strokeWidth/2-this.getBackgroundPadding()},e.prototype.getPathRatio=function(){var n=this.props,r=n.value,s=n.minValue,i=n.maxValue,o=Math.min(Math.max(r,s),i);return(o-s)/(i-s)},e.prototype.render=function(){var n=this.props,r=n.circleRatio,s=n.className,i=n.classes,o=n.counterClockwise,l=n.styles,c=n.strokeWidth,u=n.text,d=this.getPathRadius(),h=this.getPathRatio();return p.createElement("svg",{className:i.root+" "+s,style:l.root,viewBox:"0 0 "+S1e+" "+C1e,"data-test-id":"CircularProgressbar"},this.props.background?p.createElement("circle",{className:i.background,style:l.background,cx:i1,cy:o1,r:sF}):null,p.createElement(iF,{className:i.trail,counterClockwise:o,dashRatio:r,pathRadius:d,strokeWidth:c,style:l.trail}),p.createElement(iF,{className:i.path,counterClockwise:o,dashRatio:h*r,pathRadius:d,strokeWidth:c,style:l.path}),u?p.createElement("text",{className:i.text,style:l.text,x:i1,y:o1},u):null)},e.defaultProps={background:!1,backgroundPadding:0,circleRatio:1,classes:{root:"CircularProgressbar",trail:"CircularProgressbar-trail",path:"CircularProgressbar-path",text:"CircularProgressbar-text",background:"CircularProgressbar-background"},counterClockwise:!1,className:"",maxValue:100,minValue:0,strokeWidth:8,styles:{root:{},trail:{},path:{},text:{},background:{}},text:""},e}(p.Component);function N1e(t){var e=t.rotation,n=t.strokeLinecap,r=t.textColor,s=t.textSize,i=t.pathColor,o=t.pathTransition,l=t.pathTransitionDuration,c=t.trailColor,u=t.backgroundColor,d=e==null?void 0:"rotate("+e+"turn)",h=e==null?void 0:"center center";return{root:{},path:Cx({stroke:i,strokeLinecap:n,transform:d,transformOrigin:h,transition:o,transitionDuration:l==null?void 0:l+"s"}),trail:Cx({stroke:c,strokeLinecap:n,transform:d,transformOrigin:h}),text:Cx({fill:r,fontSize:s}),background:Cx({fill:u})}}function Cx(t){return Object.keys(t).forEach(function(e){t[e]==null&&delete t[e]}),t}const P1e=({store:t})=>{var E,I,P,k,j;const e=bi(),{deleteStore:n,updateStoreTemplateVersion:r,getStoreRevenue:s,getStoreCustomers:i,getStoreConversionRate:o,getStoreSocialScore:l}=zn(),{user:c}=eo(),[u,d]=p.useState(null),[h,f]=p.useState(0),[m,g]=p.useState(0),[x,w]=p.useState(0),v=t.merchant_id===(c==null?void 0:c.uid),_=v&&((E=t.theme)!=null&&E.primaryColor)?{boxShadow:`0 0 10px 2px ${t.theme.primaryColor}A0`}:{};p.useEffect(()=>{v&&(s(t.id).then(d),i(t.id).then(g),o(t.id).then(w),l(t.id).then(f))},[v,t.id,s,i,o,l]);let C=null;if(t.products&&t.products.length>0){const D=t.products[0];C=((P=(I=D.image)==null?void 0:I.src)==null?void 0:P.medium)||((k=D.image)==null?void 0:k.url)||(Array.isArray(D.images)&&D.images.length>0?D.images[0]:null)}const T=C||t.card_background_url,R=D=>{if(!D)return"N/A";try{const M=new Date(D);return isNaN(M.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(M)}catch(M){return console.error("Error formatting date:",D,M),"Error Date"}},A=D=>{switch(D){case"fashion":return a.jsx(soe,{className:"h-5 w-5 text-pink-500"});case"electronics":return a.jsx(Gy,{className:"h-5 w-5 text-blue-500"});case"food":return a.jsx(Gy,{className:"h-5 w-5 text-green-500"});case"jewelry":return a.jsx(Gy,{className:"h-5 w-5 text-amber-500"});default:return a.jsx(Gy,{className:"h-5 w-5 text-gray-500"})}};return a.jsx("div",{className:"cursor-pointer",onClick:()=>{t&&t.name?e(`/${pc(t.name)}`):console.error("Store name is missing, cannot navigate to preview.")},children:a.jsxs(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"store-preview relative bg-cover bg-center rounded-[15px] overflow-hidden",style:{...T?{backgroundImage:`url(${T})`}:{backgroundColor:"#374151"},..._},children:[a.jsx("div",{className:"absolute inset-0",style:{backgroundColor:(j=t.theme)!=null&&j.primaryColor?`${t.theme.primaryColor}4D`:"transparent"}}),a.jsxs(Je,{className:"h-full overflow-hidden border-2 border-white/20 hover:border-primary/50 transition-all duration-300 bg-black/30 backdrop-blur-sm text-white rounded-[15px]",children:[" ",a.jsxs("div",{className:"relative z-10 p-1 rounded-[15px]",children:[" ",a.jsxs(ct,{className:"pb-2",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[t.logo_url?a.jsx("div",{className:"h-12 w-12 overflow-hidden rounded-sm",children:a.jsx("img",{src:t.logo_url,alt:`${t.name} logo`,className:"w-full h-full object-cover"})}):A(t.niche),a.jsx(ut,{className:"text-xl text-white drop-shadow-md",children:t.name})]}),a.jsx("span",{className:"px-2 py-1 bg-white/10 text-white text-xs rounded-full backdrop-blur-xs",children:t.niche?t.niche.charAt(0).toUpperCase()+t.niche.slice(1):"General"})]}),a.jsx(Qt,{className:"line-clamp-2 mt-1 text-white drop-shadow-sm",children:t.description})]}),a.jsxs(it,{className:"pb-2",children:[a.jsxs("div",{className:"flex items-center text-sm text-white drop-shadow-sm gap-1 mb-3",children:[a.jsx(kI,{className:"h-3.5 w-3.5 mr-1 text-white"}),"Created on ",R(t.created_at||t.createdAt)]}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:t&&t.products&&Array.isArray(t.products)&&t.products.length>0?t.products.slice(0,4).map(D=>{var G,B,W;const M=((B=(G=D.image)==null?void 0:G.src)==null?void 0:B.medium)||((W=D.image)==null?void 0:W.url)||(Array.isArray(D.images)&&D.images.length>0?D.images[0]:null);return a.jsxs("div",{className:"bg-white/10 p-2 rounded-md text-xs flex items-center gap-2 backdrop-blur-xs cursor-pointer",onClick:Q=>{Q.stopPropagation(),e(`/${pc(t.name)}/product/${encodeURIComponent(D.id)}`)},children:[M&&a.jsx("img",{src:M,alt:D.name,className:"w-8 h-8 object-cover rounded-sm"}),a.jsxs("div",{className:"flex flex-col overflow-hidden",children:[a.jsx("span",{className:"font-medium truncate text-white",children:D.name||"Unnamed Product"}),a.jsx("span",{className:"text-white",children:typeof D.price=="number"?`$${D.price.toFixed(2)}`:"Price N/A"})]})]},D.id)}):a.jsx("p",{className:"text-xs text-white col-span-2",children:t&&t.products&&t.products.length===0?"No products yet.":"Product data unavailable."})}),v&&u!==null&&a.jsxs("div",{className:"mt-4 text-left",children:[a.jsxs("p",{className:"text-lg font-semibold text-white",children:["Total Revenue: $",u.toFixed(2)]}),a.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[a.jsx("div",{style:{width:50,height:50},children:a.jsx(I1e,{value:h,text:`${h}%`,styles:N1e({textColor:"white",pathColor:"white",trailColor:"rgba(255, 255, 255, 0.2)"})})}),a.jsx("div",{children:a.jsx("p",{className:"text-sm font-semibold text-white",children:"Social Score"})})]}),a.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"text-sm text-white",children:["Customers: ",m]}),a.jsxs("p",{className:"text-sm text-white",children:["Conversion Rate: ",x.toFixed(2),"%"]})]}),a.jsx(O,{variant:"outline",size:"sm",className:"bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:()=>{t&&t.name?e(`/${pc(t.name)}`):console.error("Store name is missing, cannot navigate to preview.")},children:"Preview"})]})]})]}),a.jsx(yd,{className:"flex flex-col items-start gap-2 pt-2"})]})]})]})})},oF=["255, 99, 132","54, 162, 235","255, 206, 86","75, 192, 192","153, 102, 255","255, 159, 64","255, 99, 132","54, 162, 235","255, 206, 86","75, 192, 192","153, 102, 255","255, 159, 64","255, 99, 132","54, 162, 235","255, 206, 86","75, 192, 192","153, 102, 255","255, 159, 64","255, 99, 132","54, 162, 235","255, 206, 86","75, 192, 192","153, 102, 255"],A1e=()=>{const{stores:t,loadStores:e,isLoadingStores:n}=zn(),{user:r}=eo(),[s,i]=p.useState(""),[o,l]=p.useState([]);p.useEffect(()=>{r&&r.uid&&e(r.uid)},[r]);const c=p.useMemo(()=>{let h=[...t].sort((f,m)=>{const g=f.merchant_id===(r==null?void 0:r.uid),x=m.merchant_id===(r==null?void 0:r.uid);return g&&!x?-1:!g&&x?1:0});return o.length>0&&(h=h.filter(f=>o.includes(f.niche))),s&&(h=h.filter(f=>f.name.toLowerCase().includes(s.toLowerCase()))),h},[t,s,r,o]),u=d=>{l(h=>h.includes(d)?h.filter(f=>f!==d):[...h,d])};return a.jsxs(It.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},className:"w-full max-w-6xl mx-auto mt-8",children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Browse"})}),a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"relative",children:[a.jsx(ic,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),a.jsx(Ye,{type:"search",placeholder:"Search by store name...",className:"w-full pl-10 py-2 text-base",value:s,onChange:d=>i(d.target.value)})]})}),a.jsxs(xs,{className:"w-full whitespace-nowrap rounded-md border mb-4",children:[a.jsx("div",{className:"flex w-max space-x-2 p-2",children:_A.map((d,h)=>{const f=o.includes(d),m=f?{"--glow-color":oF[h%oF.length]}:{};return a.jsx(O,{variant:f?"solid":"outline",onClick:()=>u(d),className:`capitalize ${f?"pulse-glow-animation":""}`,style:m,children:d},d)})}),a.jsx(SN,{orientation:"horizontal"})]}),n&&c.length===0&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading your stores..."})}),!n&&t.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx("h3",{className:"text-xl font-semibold",children:"No stores found"}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"Get started by generating a new one!"})]}),!n&&t.length>0&&c.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx("h3",{className:"text-xl font-semibold",children:"No stores match your search"}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"Try a different search term or clear the search to see all your stores."})]}),c.length>0&&a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:c.map(d=>a.jsx(P1e,{store:d},d.id))})]})},k1e=({open:t,onOpenChange:e,onSuccessfulConnect:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState(""),{startShopifyImportWizard:l,isFetchingShopifyPreviewData:c,shopifyImportError:u,setShopifyWizardStep:d}=zn(),h=async f=>{if(f.preventDefault(),!r||!i){alert("Please enter both Shopify domain and access token.");return}await l(r,i)&&n&&n()};return a.jsx(Xr,{open:t,onOpenChange:f=>{e(f)},children:a.jsxs(Ur,{className:"sm:max-w-[425px] sm:rounded-xl",children:[" ",a.jsxs(Br,{children:[a.jsx(zr,{children:"Connect to Shopify"}),a.jsxs(Zi,{className:"text-slate-500 dark:text-slate-400",children:[" ","Enter your Shopify store domain and Storefront Access Token to begin importing."]})]}),a.jsxs("form",{onSubmit:h,className:"grid gap-4 py-4",children:[u&&a.jsx("div",{className:"col-span-4 p-2 text-sm text-red-600 bg-red-100 border border-red-300 rounded",children:u}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(De,{htmlFor:"domain",className:"text-right",children:"Domain"}),a.jsx(Ye,{id:"domain",value:r,onChange:f=>s(f.target.value),placeholder:jse,className:"col-span-3",disabled:c})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(De,{htmlFor:"token",className:"text-right",children:"Token"}),a.jsx(Ye,{id:"token",type:"password",value:i,onChange:f=>o(f.target.value),placeholder:"Storefront Access Token",className:"col-span-3",disabled:c})]}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",disabled:c,onClick:()=>e(!1),children:"Cancel"}),a.jsx(O,{type:"submit",disabled:c||!r||!i,children:c?a.jsxs(a.Fragment,{children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Connecting..."]}):"Connect & Fetch Info"})]})]})]})})},R1e=({open:t,onOpenChange:e,onSuccessfulConnect:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState("");p.useState(!1),p.useState(null),p.useState("");const{startBigCommerceImportWizard:l,bigCommerceImportError:c,isFetchingBigCommercePreviewData:u}=zn(),d=async h=>{if(h.preventDefault(),!r||!i){alert("Both Store Domain and API Token are required.");return}await l(r,i),n&&n({storeDomain:r,apiToken:i})};return t?a.jsx("div",{className:"w-full",children:a.jsxs("form",{onSubmit:d,children:[a.jsxs(it,{className:"space-y-4 pt-6",children:[" ",a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"bc-store-domain",children:"Store Domain"}),a.jsx(Ye,{id:"bc-store-domain",type:"text",placeholder:"e.g., mystore.mybigcommerce.com",value:r,onChange:h=>s(h.target.value.trim()),disabled:u})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"bc-api-token",children:"Storefront API Token"}),a.jsx(Ye,{id:"bc-api-token",type:"password",placeholder:"Enter your Storefront API Token",value:i,onChange:h=>o(h.target.value.trim()),disabled:u})]}),c&&a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(rw,{className:"mr-2 h-4 w-4"})," ",c]})]}),a.jsx(yd,{className:"flex flex-col space-y-2",children:a.jsxs(O,{type:"submit",className:"w-full",disabled:u,children:[u?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(ya,{className:"mr-2 h-4 w-4"}),u?"Connecting...":"Connect to BigCommerce"]})})]})}):null},j1e="modulepreload",D1e=function(t){return"/"+t},aF={},Mt=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=D1e(i),i in aF)return;aF[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const h=s[d];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":j1e,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},M1e="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s",L1e=[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE}],F1e=["Shirt","Mug","Hat","Totebag","Poster"];async function O1e(t,e){var l;if(!t)return console.warn("[geminiPromptAnalysis] User store prompt is empty. Defaulting to standard strategy."),{strategy:"standard",theme:"General",requestedProductTypes:[],isPod:!1,podConfidence:0,suggestedPodProducts:[]};const r=new En({apiKey:M1e}).getGenerativeModel({model:"gemini-1.5-flash-latest",safetySettings:L1e}),s=so.map(c=>c.name).join(", "),i=((l=Jw.find(c=>c.value===e))==null?void 0:l.label)||e||"General",o=`
    Analyze the following user prompt for an e-commerce store and the store's product niche.
    User Prompt: "${t}"
    Product Niche: "${i}"
    Available Print-on-Demand (POD) base product types: ${s}.

    Your goal is to determine the best product generation strategy.

    Consider these scenarios:
    1.  If the prompt explicitly mentions "print on demand", "POD", "custom designs on products", "merch", or implies selling items like t-shirts, mugs, posters with custom graphics, or a store themed around a concept (e.g., "Spiderman store", "cat lovers store") where designs are applied to standard products.
    2.  If the prompt requests specific products that are typically print-on-demand (e.g., "I want to sell t-shirts and hoodies with my art", "custom phone cases").
    3.  If the prompt describes a theme (e.g., "a store for coffee lovers", "a store about space exploration") but doesn't specify products, AND the niche is NOT typically print-on-demand (e.g., food, high-end jewelry, complex electronics, furniture). In this case, a POD strategy might be appropriate to offer themed merchandise.
    4.  If the prompt requests products that are clearly NOT print-on-demand (e.g., "gourmet chocolates", "handmade silver necklaces", "custom-built drones", "artisanal wooden tables"), or if the niche itself strongly indicates non-POD products (e.g., "Restaurant", "Tech Repair Service").
    5.  If the prompt is very generic or doesn't give enough information to lean towards POD.

    Based on your analysis, return a JSON object with the following structure:
    {
      "isPod": boolean, // True if the store is likely print-on-demand focused or should use POD products.
      "podConfidence": number, // Confidence score (0.0 to 1.0) for isPod.
      "theme": "string", // A concise theme extracted from the prompt (e.g., "Vintage Cars", "Abstract Art", "Funny Quotes", "Spiderman"). If no clear theme, use "General".
      "requestedProductTypes": ["string"], // Array of specific product names mentioned in the prompt that match or are very similar to the available POD base product types. (e.g., ["Shirt", "Mug"]). Empty if none.
      "suggestedPodProducts": ["string"], // If isPod is true and requestedProductTypes is empty, suggest 3-5 relevant POD base product types from the available list based on the theme/niche. (e.g., ["Shirt", "Mug", "Poster"]). Empty otherwise.
      "generationStrategy": "string" // One of: "standard", "pod_theme_visualization", "pod_specific_products", "error"
    }

    Strategy decision logic:
    -   If "isPod" is true AND "requestedProductTypes" has items: "generationStrategy" should be "pod_specific_products".
    -   If "isPod" is true AND "requestedProductTypes" is empty (implying a themed POD store but no specific products mentioned by user): "generationStrategy" should be "pod_theme_visualization". Use "suggestedPodProducts" for this.
    -   If "isPod" is false: "generationStrategy" should be "standard".
    -   If the niche is something like food, complex tech, high-end jewelry, furniture, and the prompt doesn't strongly push for POD merch, lean towards "standard" even if a theme is mentioned. For example, a "Spiderman themed restaurant" is still "standard" for food products. A "Spiderman store" (general merch) is "pod_theme_visualization".

    Example 1 (Specific POD products):
    User Prompt: "I want to create a store selling t-shirts and coffee mugs with cool dog designs."
    Product Niche: "Fashion & Apparel"
    Expected Output: { "isPod": true, "podConfidence": 0.9, "theme": "Cool Dog Designs", "requestedProductTypes": ["Shirt", "Mug"], "suggestedPodProducts": [], "generationStrategy": "pod_specific_products" }

    Example 2 (Themed POD store, no specific products):
    User Prompt: "A store for fans of classic horror movies, with iconic imagery."
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": true, "podConfidence": 0.8, "theme": "Classic Horror Movies", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug", "Canvas"], "generationStrategy": "pod_theme_visualization" }

    Example 3 (Standard store, non-POD niche):
    User Prompt: "Selling delicious artisanal cookies and pastries."
    Product Niche: "Food & Beverage"
    Expected Output: { "isPod": false, "podConfidence": 0.1, "theme": "Artisanal Cookies and Pastries", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 4 (Themed store, but niche is non-POD, so standard products for niche, POD for merch):
    User Prompt: "A high-tech gadget store with a cyberpunk theme."
    Product Niche: "Electronics & Gadgets"
    Expected Output: { "isPod": false, "podConfidence": 0.3, "theme": "Cyberpunk", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }
    (Note: The task description implies if niche is non-POD but theme is present, we *should* call POD flow. Let's adjust this example's expectation for the AI)
    Revised Example 4 (Themed store, niche non-POD, but POD for merch is desired):
    User Prompt: "A high-tech gadget store with a cyberpunk theme. I want some cool merch too."
    Product Niche: "Electronics & Gadgets"
    Expected Output: { "isPod": true, "podConfidence": 0.7, "theme": "Cyberpunk", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug"], "generationStrategy": "pod_theme_visualization" }


    Example 5 (Unique products, not POD):
    User Prompt: "I craft unique, handmade wooden sculptures."
    Product Niche: "Art & Collectibles"
    Expected Output: { "isPod": false, "podConfidence": 0.05, "theme": "Handmade Wooden Sculptures", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 6 (Generic prompt, default to standard):
    User Prompt: "My new online shop"
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": false, "podConfidence": 0.2, "theme": "General", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 7 (Store theme implies POD, niche is general):
    User Prompt: "A store for all things Spiderman!"
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": true, "podConfidence": 0.9, "theme": "Spiderman", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug", "Hat", "Canvas"], "generationStrategy": "pod_theme_visualization" }

    Ensure the "theme" is concise. If "requestedProductTypes" are found, "suggestedPodProducts" should usually be empty. If "isPod" is true and "requestedProductTypes" is empty, "suggestedPodProducts" MUST be populated with 3-5 relevant items from the available POD list.
    The entire response MUST be a single JSON object.
  `;try{const d=(await r.generateContent(o)).response.text();let h;const f=d.match(/```json\s*([\s\S]*?)\s*```/);if(f&&f[1])h=JSON.parse(f[1]);else{const m=d.indexOf("{"),g=d.lastIndexOf("}");if(m!==-1&&g>m)h=JSON.parse(d.substring(m,g+1));else throw new Error("No JSON object found in response.")}return h.isPod&&(!h.requestedProductTypes||h.requestedProductTypes.length===0)&&(!h.suggestedPodProducts||h.suggestedPodProducts.length===0)&&(h.suggestedPodProducts=F1e.slice(0,Math.floor(Math.random()*3)+3),console.warn(`[geminiPromptAnalysis] POD strategy indicated but no specific or suggested POD products returned by AI. Defaulting suggestions: ${h.suggestedPodProducts.join(", ")}`)),h.strategy||(h.isPod&&h.requestedProductTypes&&h.requestedProductTypes.length>0?h.strategy="pod_specific_products":h.isPod?h.strategy="pod_theme_visualization":h.strategy="standard"),console.log("[geminiPromptAnalysis] Analysis result:",h),h}catch(c){return console.error("[geminiPromptAnalysis] Error analyzing store prompt:",c),{error:c.message,strategy:"error",theme:"General",requestedProductTypes:[],isPod:!1,podConfidence:0,suggestedPodProducts:[]}}}const V1e=AI("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function pg({className:t,variant:e,...n}){return a.jsx("div",{className:Ct(V1e({variant:e}),t),...n})}var a_="Checkbox",[$1e,Kje]=_i(a_),[U1e,YA]=$1e(a_);function B1e(t){const{__scopeCheckbox:e,checked:n,children:r,defaultChecked:s,disabled:i,form:o,name:l,onCheckedChange:c,required:u,value:d="on",internal_do_not_use_render:h}=t,[f,m]=Oc({prop:n,defaultProp:s??!1,onChange:c,caller:a_}),[g,x]=p.useState(null),[w,v]=p.useState(null),_=p.useRef(!1),C=g?!!o||!!g.closest("form"):!0,T={checked:f,disabled:i,setChecked:m,control:g,setControl:x,name:l,form:o,value:d,hasConsumerStoppedPropagationRef:_,required:u,defaultChecked:xc(s)?!1:s,isFormControl:C,bubbleInput:w,setBubbleInput:v};return a.jsx(U1e,{scope:e,...T,children:z1e(h)?h(T):r})}var xH="CheckboxTrigger",vH=p.forwardRef(({__scopeCheckbox:t,onKeyDown:e,onClick:n,...r},s)=>{const{control:i,value:o,disabled:l,checked:c,required:u,setControl:d,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:m,bubbleInput:g}=YA(xH,t),x=yn(s,d),w=p.useRef(c);return p.useEffect(()=>{const v=i==null?void 0:i.form;if(v){const _=()=>h(w.current);return v.addEventListener("reset",_),()=>v.removeEventListener("reset",_)}},[i,h]),a.jsx(Yt.button,{type:"button",role:"checkbox","aria-checked":xc(c)?"mixed":c,"aria-required":u,"data-state":CH(c),"data-disabled":l?"":void 0,disabled:l,value:o,...r,ref:x,onKeyDown:gt(e,v=>{v.key==="Enter"&&v.preventDefault()}),onClick:gt(n,v=>{h(_=>xc(_)?!0:!_),g&&m&&(f.current=v.isPropagationStopped(),f.current||v.stopPropagation())})})});vH.displayName=xH;var JA=p.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c,onCheckedChange:u,form:d,...h}=t;return a.jsx(B1e,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:l,required:o,onCheckedChange:u,name:r,form:d,value:c,internal_do_not_use_render:({isFormControl:f})=>a.jsxs(a.Fragment,{children:[a.jsx(vH,{...h,ref:e,__scopeCheckbox:n}),f&&a.jsx(SH,{__scopeCheckbox:n})]})})});JA.displayName=a_;var wH="CheckboxIndicator",bH=p.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...s}=t,i=YA(wH,n);return a.jsx(ws,{present:r||xc(i.checked)||i.checked===!0,children:a.jsx(Yt.span,{"data-state":CH(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...t.style}})})});bH.displayName=wH;var _H="CheckboxBubbleInput",SH=p.forwardRef(({__scopeCheckbox:t,...e},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:o,required:l,disabled:c,name:u,value:d,form:h,bubbleInput:f,setBubbleInput:m}=YA(_H,t),g=yn(n,m),x=F7(i),w=MA(r);p.useEffect(()=>{const _=f;if(!_)return;const C=window.HTMLInputElement.prototype,R=Object.getOwnPropertyDescriptor(C,"checked").set,A=!s.current;if(x!==i&&R){const E=new Event("click",{bubbles:A});_.indeterminate=xc(i),R.call(_,xc(i)?!1:i),_.dispatchEvent(E)}},[f,x,i,s]);const v=p.useRef(xc(i)?!1:i);return a.jsx(Yt.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??v.current,required:l,disabled:c,name:u,value:d,form:h,...e,tabIndex:-1,ref:g,style:{...e.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});SH.displayName=_H;function z1e(t){return typeof t=="function"}function xc(t){return t==="indeterminate"}function CH(t){return xc(t)?"indeterminate":t?"checked":"unchecked"}const EH=p.forwardRef(({className:t,...e},n)=>a.jsx(JA,{ref:n,className:Ct("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:a.jsx(bH,{className:Ct("flex items-center justify-center text-current"),children:a.jsx(Ig,{className:"h-4 w-4"})})}));EH.displayName=JA.displayName;const G1e=({isOpen:t,onClose:e,collection:n,allProducts:r,onSave:s})=>{const[i,o]=p.useState([]);p.useEffect(()=>{n&&n.product_ids?o(n.product_ids):o([])},[n]);const l=u=>{o(d=>d.includes(u)?d.filter(h=>h!==u):[...d,u])},c=()=>{s(n.id||n.name,i),e()};return n?a.jsx(Xr,{open:t,onOpenChange:e,children:a.jsxs(Ur,{className:"sm:max-w-lg",children:[a.jsxs(Br,{children:[a.jsxs(zr,{children:['Manage Products in "',n.name,'"']}),a.jsx(Zi,{children:"Select the products that should appear in this collection."})]}),a.jsx(xs,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"py-4 space-y-3",children:r&&r.length>0?r.map(u=>a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md hover:bg-muted/50 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[u.images&&u.images.length>0?a.jsx("img",{src:u.images[0],alt:u.name||"Product image",className:"w-16 h-16 object-cover rounded-md border"}):a.jsx("div",{className:"w-16 h-16 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:u.name||"Untitled Product"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:u.price?`$${parseFloat(u.price).toFixed(2)}`:"Price not available"})]})]}),a.jsx(EH,{checked:i.includes(u.id),onCheckedChange:()=>l(u.id),id:`product-${u.id}`})]},u.id)):a.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No products available to add to this collection."})})}),a.jsxs(Ar,{className:"sm:justify-between",children:[a.jsx(il,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",children:"Cancel"})}),a.jsx(O,{type:"button",onClick:c,children:"Save Changes"})]})]})}):null},W1e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),H1e=({isOpen:t,onClose:e,product:n,onSave:r,onGenerateMainImage:s,onGenerateMoreAngles:i,productIndexInWizard:o,isGeneratingProductImage:l,isGeneratingAngles:c})=>{const[u,d]=p.useState(null),{toast:h}=bs();p.useEffect(()=>{if(n){const P=n.variants?n.variants.map(D=>({...D,values:Array.isArray(D.values)?[...D.values]:typeof D.values=="string"?D.values.split(",").map(M=>M.trim()).filter(M=>M):[]})):[],k=Array.isArray(n.images)?[...n.images]:[],j={...n,variants:P,images:k};k.length===0&&n.imageUrl&&(j.images=[n.imageUrl]),d(j)}else d(null)},[n,t]);const f=P=>{const{name:k,value:j,type:D}=P.target;d(M=>({...M,[k]:D==="number"?parseFloat(j)||0:j}))},m=P=>{d(k=>({...k,images:P}))},g=async P=>{if(P.target.files&&P.target.files.length>0){const j=Array.from(P.target.files).map(D=>W1e(D));try{const D=await Promise.all(j);m([...u.images||[],...D])}catch{h({title:"Image Upload Error",description:"Could not process some images.",variant:"destructive"})}}},x=P=>{m((u.images||[]).filter((k,j)=>j!==P))},w=async()=>{s&&o!==null&&u&&await s(o,u)},v=async()=>{i&&o!==null&&u&&u.images&&u.images.length>0?await i(o,u):h({title:"Cannot Generate Angles",description:"A main image is required first.",variant:"warning"})},_=(P,k,j)=>{d(D=>{const M=[...D.variants||[]];return M[P]={...M[P],[k]:j},{...D,variants:M}})},C=(P,k,j)=>{d(D=>{const M=[...D.variants||[]],G=[...M[P].values];return G[k]=j,M[P]={...M[P],values:G},{...D,variants:M}})},T=P=>{d(k=>{const j=[...k.variants||[]],D=[...j[P].values,""];return j[P]={...j[P],values:D},{...k,variants:j}})},R=(P,k)=>{d(j=>{const D=[...j.variants||[]],M=D[P].values.filter((G,B)=>B!==k);return D[P]={...D[P],values:M},M.length===0&&h({title:"Info",description:`Variant option "${D[P].name}" has no values.`,variant:"default"}),{...j,variants:D}})},A=()=>{d(P=>({...P,variants:[...P.variants||[],{name:"",values:[""]}]}))},E=P=>{d(k=>({...k,variants:(k.variants||[]).filter((j,D)=>D!==P)}))},I=()=>{if(!u.name||u.name.trim()===""){h({title:"Validation Error",description:"Product name cannot be empty.",variant:"destructive"});return}if(u.price===void 0||u.price===null||isNaN(parseFloat(u.price))||parseFloat(u.price)<0){h({title:"Validation Error",description:"Product price must be a valid non-negative number.",variant:"destructive"});return}const P=u.variants?u.variants.map(k=>({...k,name:k.name.trim(),values:k.values.map(j=>j.trim()).filter(j=>j!=="")})).filter(k=>k.name!==""&&k.values.length>0):[];r({...u,variants:P}),e()};return!t||!u?null:a.jsx(Xr,{open:t,onOpenChange:P=>{P||e()},children:a.jsxs(Ur,{className:"sm:max-w-2xl",children:[a.jsxs(Br,{children:[a.jsx(zr,{children:"Edit AI Generated Product"}),a.jsx(Zi,{children:"Modify the details of the generated product below."})]}),a.jsx(xs,{className:"max-h-[70vh] p-1 pr-3",children:a.jsxs("div",{className:"space-y-4 py-4 pr-2",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"name",children:"Product Name"}),a.jsx(Ye,{id:"name",name:"name",value:u.name||"",onChange:f})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"price",children:"Price (USD)"}),a.jsx(Ye,{id:"price",name:"price",type:"number",value:u.price||0,onChange:f})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"description",children:"Description"}),a.jsx(Pn,{id:"description",name:"description",value:u.description||"",onChange:f,rows:4})]}),a.jsxs("div",{className:"space-y-2 border p-3 rounded-md",children:[a.jsx(De,{className:"text-md font-semibold",children:"Product Images"}),u.images&&u.images.length>0?a.jsx("div",{className:"overflow-x-auto py-2",children:a.jsx("div",{className:"flex flex-row gap-2 mb-2 min-w-max",children:u.images.map((P,k)=>a.jsxs("div",{className:"relative group flex-shrink-0",children:[a.jsx("img",{src:P,alt:`Product image ${k+1}`,className:"w-24 h-24 object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>x(k),children:a.jsx(Wn,{className:"h-3.5 w-3.5"})})]},`${P}-${k}`))})}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No images yet."}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>document.getElementById("editAiProductImageUpload").click(),children:[a.jsx(Uo,{className:"mr-2 h-4 w-4"})," Upload Images"]}),a.jsx(Ye,{id:"editAiProductImageUpload",type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:g}),a.jsxs(O,{variant:"outline",size:"sm",onClick:w,disabled:l||!u.name,children:[l?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),u.images&&u.images.length>0?"Regenerate Main":"Generate Main"]}),u.images&&u.images.length>0&&a.jsxs(O,{variant:"outline",size:"sm",onClick:v,disabled:c,children:[c?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"More Angles"]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-md font-semibold",children:"Variants"}),(u.variants||[]).map((P,k)=>a.jsxs(Je,{className:"p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(De,{htmlFor:`variantName-${k}`,children:"Option Name"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>E(k),className:"h-7 w-7",children:a.jsx(Wn,{className:"h-4 w-4 text-destructive"})})]}),a.jsx(Ye,{id:`variantName-${k}`,value:P.name||"",onChange:j=>_(k,"name",j.target.value),placeholder:"e.g., Color, Size"}),a.jsx(De,{children:"Option Values"}),P.values.map((j,D)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ye,{value:j||"",onChange:M=>C(k,D,M.target.value),placeholder:"e.g., Red, Large"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>R(k,D),className:"h-7 w-7",children:a.jsx(Wn,{className:"h-4 w-4 text-destructive"})})]},D)),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>T(k),children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"})," Add Value"]})]},k)),a.jsxs(O,{variant:"outline",onClick:A,className:"w-full",children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]})}),a.jsxs(Ar,{children:[a.jsx(il,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel"})}),a.jsx(O,{type:"button",onClick:I,children:"Save Changes"})]})]})})},Gd=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),lF=(t,e)=>{const{formData:n,setFormData:r,handleInputChange:s,handleProductTypeChange:i,handleProductSourceChange:o,handleProductCountChange:l,handleManualProductChange:c,addManualProduct:u,removeManualProduct:d,suggestStoreName:h,generateLogo:f,generateAiProducts:m,generateAiCollections:g,handleGenerateManualProductImage:x,handleGenerateMoreAngles:w,isProcessing:v,isGeneratingProductImageForIndex:_,productImageGenerationError:C,isGeneratingAnglesForIndex:T,angleGenerationError:R,storeNameSuggestions:A,handleSuggestionClick:E,suggestionError:I,handleInitialImportMethodChange:P,handleProductPhotoUpload:k,uploadedProductPhotos:j,removeUploadedProductPhoto:D,isProcessingPhotos:M,handleGenerateCollectionImage:G,isGeneratingCollectionImageForIndex:B,collectionImageGenerationError:W,isCheckingStoreName:Q,storeNameAvailability:H,handleManualStoreNameCheck:Y}=e,[V,$]=p.useState(""),[z,F]=p.useState(""),[Z,fe]=p.useState(null),[xe,ge]=p.useState(null),[Re,Ue]=p.useState(""),[ze,he]=p.useState(""),[Ce,Pe]=p.useState([]),[ve,de]=p.useState([]);p.useState(null);const[Me,Ge]=p.useState([]),[yt,Pt]=p.useState(!1),[en,fn]=p.useState(!1),[an,dn]=p.useState(""),{toast:Lt}=bs(),[xn,te]=p.useState(!1),[Ee,ee]=p.useState(null),[le,K]=p.useState(null),Ae=(X,ne,me)=>{r(q=>{const ie=[...q.products.items],be={...ie[X]};return be.variants=[...be.variants||[]],be.variants[ne]={...be.variants[ne],name:me},ie[X]=be,{...q,products:{...q.products,items:ie}}})},Ne=(X,ne,me,q)=>{r(ie=>{const be=[...ie.products.items],Ie={...be[X]};Ie.variants=[...Ie.variants||[]];const Ve={...Ie.variants[ne]};return Ve.values=[...Ve.values||[]],Ve.values[me]=q,Ie.variants[ne]=Ve,be[X]=Ie,{...ie,products:{...ie.products,items:be}}})},Oe=(X,ne)=>{r(me=>{const q=[...me.products.items],ie={...q[X]};ie.variants=[...ie.variants||[]];const be={...ie.variants[ne]};return be.values=[...be.values||[],""],ie.variants[ne]=be,q[X]=ie,{...me,products:{...me.products,items:q}}})},He=(X,ne,me)=>{r(q=>{const ie=[...q.products.items],be={...ie[X]};be.variants=[...be.variants||[]];const Ie={...be.variants[ne]};return Ie.values=(Ie.values||[]).filter((Ve,Se)=>Se!==me),be.variants[ne]=Ie,Ie.values.length===0&&Lt({title:"Info",description:`Variant option "${Ie.name}" has no values. Consider removing the option or adding values.`,variant:"default"}),ie[X]=be,{...q,products:{...q.products,items:ie}}})},ce=X=>{r(ne=>{const me=[...ne.products.items],q={...me[X]};return q.variants=[...q.variants||[],{name:"",values:[""]}],me[X]=q,{...ne,products:{...ne.products,items:me}}})},_e=(X,ne)=>{r(me=>{const q=[...me.products.items],ie={...q[X]};return ie.variants=(ie.variants||[]).filter((be,Ie)=>Ie!==ne),q[X]=ie,{...me,products:{...me.products,items:q}}})},Be=async X=>{const ne=X.target.files[0];if(ne){dn(""),fe(ne);try{const me=await Gd(ne);F(me),$(""),Lt({title:"Image Uploaded",description:"Your image is ready for visualization."})}catch(me){console.error("Error converting uploaded file to base64:",me),dn("Failed to load uploaded image. Please try again."),Lt({variant:"destructive",title:"Upload Failed",description:"Could not process the uploaded image."}),F(""),fe(null)}}},Te=()=>{F(""),fe(null),$(""),dn("");const X=document.getElementById("podImageUpload");X&&(X.value="")},Et=async X=>{const ne=X.target.files[0];if(ne){dn(""),ge(ne);try{const me=await Gd(ne);Ue(me),Lt({title:"Reference Image Added",description:"This image will be used with your prompt for generation."})}catch(me){console.error("Error converting reference file to base64:",me),dn("Failed to load reference image. Please try again."),Lt({variant:"destructive",title:"Reference Image Load Failed",description:"Could not process the reference image."}),Ue(""),ge(null)}}},wt=()=>{Ue(""),ge(null),dn("");const X=document.getElementById("podReferenceImageUpload");X&&(X.value="")},xt=async()=>{if(!V){Lt({title:"Missing Prompt",description:"Please enter a prompt for image generation.",variant:"destructive"});return}if(Z){Lt({title:"Image Already Uploaded",description:"An image has already been uploaded. Clear it if you want to generate a new one.",variant:"warning"});return}Pt(!0),dn(""),F("");let X={prompt:V};if(xe&&Re){const[ne,me]=Re.split(","),q=ne.match(/:(.*?);/)[1];X.referenceImage={base64Data:me,mimeType:q,fileName:xe.name},console.log("Attempting to generate POD image preview with prompt and reference image:",V,xe.name)}else console.log("Attempting to generate POD image preview for prompt:",V);try{const ne=await Ag(X);if(ne.imageData&&ne.imageMimeType){const me=`data:${ne.imageMimeType};base64,${ne.imageData}`;F(me),console.log("POD Image preview generated successfully.")}else throw new Error(ne.textResponse||"Image data not returned from API.")}catch(ne){console.error("Error generating POD image preview:",ne);const me=ne.message||"Failed to generate image preview.";dn(me),Lt({variant:"destructive",title:"Image Generation Failed",description:me})}finally{Pt(!1)}},pt=X=>{const ne=X.target.value;he(ne),Pe(ne?so.filter(me=>me.name.toLowerCase().includes(ne.toLowerCase())):[])},At=X=>{de(ne=>ne.some(q=>q.name===X.name)?ne.filter(q=>q.name!==X.name):[...ne,X])},On=async()=>{if(!z||ve.length===0){Lt({title:"Missing Selections",description:"Please provide an image (generate or upload) and select at least one product type to visualize.",variant:"destructive"});return}let X;if(Z&&Z.name?X=`Uploaded: ${Z.name}`:V?X=V:X="Custom design",!Z&&!V){Lt({title:"Missing Prompt",description:"If not uploading an image, please enter a prompt to generate an image first.",variant:"destructive"});return}fn(!0),dn(""),Ge([]);const[ne,me]=z.split(","),q=ne.match(/:(.*?);/)[1];let ie=!0;const be=[];for(const Ie of ve)try{console.log("Attempting to visualize POD product:",Ie.name);const Ve=await Bp(me,q,Ie.imageUrl,X,Ie.name);if(Ve.visualizedImageData&&Ve.productDetails){const Se=`data:${Ve.visualizedImageMimeType};base64,${Ve.visualizedImageData}`;be.push({title:Ve.productDetails.title,price:parseFloat(Ve.productDetails.price).toFixed(2),description:Ve.productDetails.description,finalImageUrl:Se,baseProductName:Ie.name,generatedImagePrompt:X,baseProductImageUrl:Ie.imageUrl,sourceImageUsedForVisualization:z,tempId:`${Ie.name}-${Date.now()}`}),console.log("POD Product visualized successfully:",Ie.name)}else ie=!1,console.error("Visualization failed for product:",Ie.name,Ve),dn(Se=>Se+`Visualization failed for ${Ie.name}. `)}catch(Ve){ie=!1,console.error("Error visualizing POD product:",Ie.name,Ve);const Se=Ve.message||`Failed to visualize ${Ie.name}.`;dn(ot=>ot+Se+" ")}Ge(be),ie?be.length>0&&Lt({title:"Visualization Complete",description:`${be.length} product(s) visualized. You can now add them to your store.`}):Lt({variant:"destructive",title:"Some Visualizations Failed",description:"Check errors below. Some products may not have visualized correctly."}),fn(!1)},Tn=X=>{if(!X)return;const ne={name:X.title,price:X.price,description:X.description,imageUrl:X.finalImageUrl,isPrintOnDemand:!0,podDetails:{...X}};delete ne.podDetails.tempId,r(me=>({...me,products:{...me.products,items:[...me.products.items,ne]}})),Ge(me=>me.filter(q=>q.tempId!==X.tempId)),Me.length===1&&Me[0].tempId===X.tempId&&(de([]),he("")),Lt({title:"Product Added",description:`"${ne.name}" added to your store's products.`})},mr=X=>{r(ne=>({...ne,products:{...ne.products,items:ne.products.items.filter((me,q)=>q!==X)}})),Lt({title:"Product Removed",description:"The Print on Demand product has been removed from your list.",variant:"destructive"})},[mn,Ft]=p.useState(!1),[Xt,or]=p.useState(null),J=(X,ne,me)=>{r(q=>{const ie=[...q.collections.items];return ie[X][ne]=me,{...q,collections:{...q.collections,items:ie}}})},ue=()=>{r(X=>({...X,collections:{...X.collections,items:[...X.collections.items,{name:"",description:"",imageUrl:""}]}}))},we=X=>{r(ne=>{const me=ne.collections.items.filter((q,ie)=>ie!==X);return{...ne,collections:{...ne.collections,items:me}}})},Le=X=>{or(X),Ft(!0)},Ze=(X,ne)=>{r(me=>{const q=me.collections.items.map(ie=>ie.id&&ie.id===X||ie.name===X?{...ie,product_ids:ne}:ie);return{...me,collections:{...me.collections,items:q}}}),Ft(!1),or(null)};switch(t){case 1:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"initialImportMethod",className:"text-lg font-semibold",children:"How would you like to start?"}),a.jsxs(gc,{onValueChange:P,value:n.initialImportMethod||"productType",children:[a.jsx(Za,{id:"initialImportMethod",className:"mt-2",children:a.jsx(yc,{placeholder:"Choose starting method..."})}),a.jsxs(el,{children:[a.jsx(rr,{value:"productType",children:"Describe Product Type"}),a.jsx(rr,{value:"photos",children:"Start from Product Photos"})]})]})]}),n.initialImportMethod==="productType"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(De,{htmlFor:"productType",className:"text-md font-medium",children:"What kind of products will your store sell?"}),a.jsx(Ye,{id:"productType",name:"productType",value:n.productType,onChange:X=>i(X.target.value),placeholder:"e.g., Fashion, Electronics, Home Decor",list:"productTypeSuggestions"}),a.jsx("datalist",{id:"productTypeSuggestions",children:Jw.map(X=>a.jsx("option",{value:X.label},X.value))}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This helps us tailor product suggestions and store design. Type to see suggestions."})]}),n.initialImportMethod==="photos"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(De,{htmlFor:"productPhotosUpload",className:"text-md font-medium",children:"Upload Product Photos"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload multiple photos of your products. We'll use AI to understand them and pre-fill store details."}),a.jsx(Ye,{id:"productPhotosUpload",type:"file",multiple:!0,accept:"image/*",onChange:k,className:`block w-full text-sm text-slate-500
                  file:mr-4 file:py-2 file:px-4
                  file:rounded-full file:border-0
                  file:text-sm file:font-semibold
                  file:bg-primary/10 file:text-primary
                  hover:file:bg-primary/20`,disabled:M}),M&&a.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing uploaded photos..."]}),j&&j.length>0&&a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Uploaded Photos (",j.length,"):"]}),a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3",children:j.map((X,ne)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:X.previewUrl||X,alt:`Uploaded product ${ne+1}`,className:"w-full aspect-square object-cover rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:()=>D(ne),disabled:M,children:a.jsx(Wn,{className:"h-3.5 w-3.5"})})]},ne))})]})]})]},"step1");case 2:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-4 w-full",children:[a.jsx(De,{htmlFor:"storeName",className:"text-lg font-semibold",children:"What's your store name?"}),a.jsxs("div",{className:"relative flex items-center gap-2",children:[a.jsx(Ye,{id:"storeName",name:"storeName",value:n.storeName,onChange:s,placeholder:"e.g., 'The Cozy Corner Bookstore'",className:"flex-grow pr-20"}),a.jsxs(O,{type:"button",variant:"ghost",size:"sm",onClick:Y,disabled:!n.storeName||Q,className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 px-2 z-10",children:[Q?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(ya,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-1 hidden sm:inline",children:"Check"})]})]}),a.jsxs(O,{type:"button",variant:"outline",onClick:h,disabled:v||Q||!n.productType,className:"w-full mt-2 sm:w-auto sm:mt-0",children:[v&&!Q?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(Er,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2",children:"Suggest Names"})]}),a.jsxs("div",{className:"h-5 mt-1",children:[" ",Q&&n.storeName&&a.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[a.jsx(ft,{className:"h-4 w-4 animate-spin mr-2"})," Checking..."]}),H&&n.storeName&&!Q&&a.jsxs("p",{className:`text-sm font-medium ${H.status==="available"?"text-green-600":H.status==="claimed"?"text-red-600":H.status==="error"?"text-yellow-600":"text-muted-foreground"}`,children:[H.message==="Available"?a.jsx(ya,{className:"inline h-4 w-4 mr-1"}):"",H.message]})]}),!n.storeName&&!Q&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:'Choose a catchy name or let us suggest one. Click "Check" to verify availability.'}),I&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:I}),A&&A.length>0&&a.jsxs("div",{className:"mt-3 space-y-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:A.map((X,ne)=>a.jsx(O,{variant:"outline",size:"sm",onClick:()=>E(X),className:"bg-primary-foreground dark:bg-neutral-800 hover:bg-primary/10 dark:hover:bg-neutral-700",children:X},ne))})]})]},"step2");case 3:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(De,{className:"text-lg font-semibold",children:"Design a logo for your store"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center p-4 border rounded-md",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(De,{className:"text-sm mb-2",children:"For Light Backgrounds"}),n.logoUrlDark?a.jsx("img",{src:n.logoUrlDark,alt:"Logo for light backgrounds",className:"w-48 h-48 object-contain rounded-md border bg-white"}):a.jsx("div",{className:"w-48 h-48 bg-gray-100 rounded-md flex items-center justify-center text-muted-foreground",children:"Light Bg Preview"})]}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(De,{className:"text-sm mb-2",children:"For Dark Backgrounds"}),n.logoUrlLight?a.jsx("img",{src:n.logoUrlLight,alt:"Logo for dark backgrounds",className:"w-48 h-48 object-contain rounded-md border bg-gray-800"}):a.jsx("div",{className:"w-48 h-48 bg-gray-700 rounded-md flex items-center justify-center text-gray-400",children:"Dark Bg Preview"})]})]}),a.jsxs(O,{type:"button",onClick:f,disabled:v||!n.storeName,className:"w-full",children:[v?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ca,{className:"mr-2 h-4 w-4"}),"Generate Logo with AI (Light & Dark Versions)"]}),a.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"AI will generate a logo, remove its background, and attempt to create light/dark mode versions."}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(De,{className:"text-sm",children:"Manually set logos (optional):"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"logoUrlDarkUpload",className:"text-xs",children:"Logo for Light Background (e.g., black logo)"}),a.jsx(Ye,{id:"logoUrlDarkUpload",type:"file",accept:"image/*",className:"mt-1 text-xs",onChange:async X=>{if(X.target.files&&X.target.files[0]){const ne=X.target.files[0];try{const me=await Gd(ne);r(q=>({...q,logoUrlDark:me}))}catch(me){console.error("Error converting file for logoUrlDark:",me)}}}})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"logoUrlLightUpload",className:"text-xs",children:"Logo for Dark Background (e.g., white logo)"}),a.jsx(Ye,{id:"logoUrlLightUpload",type:"file",accept:"image/*",className:"mt-1 text-xs",onChange:async X=>{if(X.target.files&&X.target.files[0]){const ne=X.target.files[0];try{const me=await Gd(ne);r(q=>({...q,logoUrlLight:me}))}catch(me){console.error("Error converting file for logoUrlLight:",me)}}}})]})]})]}),(n.logoUrlLight||n.logoUrlDark)&&a.jsxs(O,{variant:"destructive",size:"sm",onClick:()=>r(X=>({...X,logoUrlLight:"",logoUrlDark:""})),className:"mt-4 w-full",children:[a.jsx(Wn,{className:"mr-2 h-4 w-4"})," Remove All Logos"]})]},"step3");case 4:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(De,{className:"text-lg font-semibold",children:"How do you want to add products?"}),a.jsxs(gc,{onValueChange:o,value:n.products.source,children:[a.jsx(Za,{children:a.jsx(yc,{placeholder:"Choose product source..."})}),a.jsxs(el,{children:[a.jsx(rr,{value:"ai",children:"Generate with AI"}),a.jsx(rr,{value:"manual",children:"Add Manually"}),a.jsx(rr,{value:"printOnDemand",children:"Print on Demand"}),a.jsx(rr,{value:"csv",disabled:!0,children:"Upload CSV (Coming Soon)"})]})]}),n.products.source==="ai"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"productCount",children:"Number of AI Products to Generate"}),a.jsx(Ye,{id:"productCount",type:"number",min:"1",max:"5",value:n.products.count,onChange:l})]}),a.jsxs(O,{type:"button",onClick:m,disabled:v||!n.productType||!n.storeName,className:"w-full",children:[v?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Products with AI"]}),I&&n.products.source==="ai"&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:I}),n.products.items.length>0&&a.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2 mt-4",children:[" ",a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Generated Products:"}),n.products.items.map((X,ne)=>a.jsxs(Je,{className:"p-4 flex gap-4 items-start relative",children:[X.images&&X.images.length>0?a.jsx("img",{src:X.images[0],alt:X.name,className:"w-24 h-24 object-cover rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-md",children:X.name||"Untitled Product"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["$",X.price||"0.00"]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:X.description||"No description."}),X.variants&&X.variants.length>0&&a.jsx("div",{className:"mt-1.5",children:X.variants.map((me,q)=>a.jsxs("div",{className:"text-xs",children:[a.jsxs("span",{className:"font-medium text-muted-foreground",children:[me.name,": "]}),a.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:Array.isArray(me.values)?me.values.join(", "):me.values})]},q))})]}),a.jsx(O,{variant:"outline",size:"icon",className:"absolute top-2 right-2 h-8 w-8",onClick:()=>{ee({...X}),K(ne),te(!0)},children:a.jsx(Zv,{className:"h-4 w-4"})})]},ne))]})]}),xn&&le!==null&&n.products.items[le]&&a.jsx(H1e,{isOpen:xn,onClose:()=>{te(!1),K(null)},product:n.products.items[le],onSave:X=>{r(ne=>{const me=[...ne.products.items];return le!==null&&me[le]&&(me[le]=X),{...ne,products:{...ne.products,items:me}}}),te(!1),ee(null),K(null),Lt({title:"Product Updated",description:`"${X.name}" has been updated.`})},onGenerateMainImage:x,onGenerateMoreAngles:w,productIndexInWizard:le,isGeneratingProductImage:_===le,isGeneratingAngles:T===le}),n.products.source==="manual"&&a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[" ",n.products.items.map((X,ne)=>a.jsxs(Je,{className:"p-4 space-y-3 relative",children:[a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7",onClick:()=>d(ne),disabled:n.products.items.length<=1,children:a.jsx(Wn,{className:"h-4 w-4 text-destructive"})}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:`productName-${ne}`,children:"Product Name"}),a.jsx(Ye,{id:`productName-${ne}`,value:X.name,onChange:me=>c(ne,"name",me.target.value),placeholder:"e.g., 'Handmade Coffee Mug'"})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:`productPrice-${ne}`,children:"Price (USD)"}),a.jsx(Ye,{id:`productPrice-${ne}`,type:"number",value:X.price,onChange:me=>c(ne,"price",me.target.value),placeholder:"e.g., '24.99'"})]})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:`productDescription-${ne}`,children:"Short Description (Optional)"}),a.jsx(Pn,{id:`productDescription-${ne}`,value:X.description,onChange:me=>c(ne,"description",me.target.value),placeholder:"e.g., 'Beautifully crafted ceramic mug, perfect for your morning coffee.'",rows:2})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 border rounded-md",children:[X.images&&X.images.length>0?a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:X.images.map((me,q)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:me,alt:`${X.name||"Product"} image ${q+1}`,className:"w-20 h-20 object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{const ie=X.images.filter((be,Ie)=>Ie!==q);c(ne,"images",ie)},children:a.jsx(Wn,{className:"h-3 w-3"})})]},q))}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground mb-2",children:"No Images"}),a.jsx(De,{htmlFor:`productImageUpload-${ne}`,className:"text-sm sr-only",children:"Upload Product Images"}),a.jsx(Ye,{id:`productImageUpload-${ne}`,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:async me=>{if(me.target.files&&me.target.files.length>0){const ie=Array.from(me.target.files).map(be=>Gd(be));try{const be=await Promise.all(ie),Ie=[...X.images||[],...be];c(ne,"images",Ie)}catch(be){console.error("Error converting files to base64:",be),Lt({title:"Image Upload Error",description:"Could not process some images.",variant:"destructive"})}}}}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`productImageUpload-${ne}`).click(),children:[a.jsx(Uo,{className:"mr-2 h-4 w-4"})," Upload Images"]}),X.images&&X.images.length>0&&a.jsxs(O,{variant:"destructive",size:"sm",onClick:()=>c(ne,"images",[]),children:[a.jsx(Wn,{className:"mr-2 h-4 w-4"})," Remove All"]}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>x(ne),disabled:_===ne||!X.name,children:[_===ne?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Main Image"]}),X.images&&X.images.length>0&&a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>w(ne),disabled:T===ne,children:[T===ne?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate More Angles"]})]}),C&&_===ne&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:C}),R&&T===ne&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:R})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(X.variants||[]).map((me,q)=>a.jsxs(Je,{className:"p-2 space-y-2 bg-muted/50",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(De,{htmlFor:`manualVariantName-${ne}-${q}`,className:"text-xs",children:"Option Name"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>_e(ne,q),className:"h-6 w-6",children:a.jsx(Wn,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(Ye,{id:`manualVariantName-${ne}-${q}`,value:me.name||"",onChange:ie=>Ae(ne,q,ie.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(De,{className:"text-xs",children:"Option Values"}),(me.values||[]).map((ie,be)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ye,{value:ie||"",onChange:Ie=>Ne(ne,q,be,Ie.target.value),placeholder:"e.g., Red, Large",className:"text-sm h-8"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>He(ne,q,be),className:"h-6 w-6",children:a.jsx(Wn,{className:"h-3 w-3 text-destructive"})})]},be)),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>Oe(ne,q),className:"text-xs h-7",children:[a.jsx(Vi,{className:"mr-1 h-3 w-3"})," Add Value"]})]},q)),a.jsxs(O,{variant:"outline",onClick:()=>ce(ne),className:"w-full text-sm h-8",children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]},ne)),a.jsxs(O,{type:"button",variant:"outline",onClick:()=>{u()},className:"w-full",children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"})," Add Another Product"]})]}),n.products.source==="printOnDemand"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-md font-semibold",children:"Configure Print on Demand Product"}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"podImagePrompt",children:"Image Generation Prompt"}),a.jsx(Pn,{id:"podImagePrompt",placeholder:"e.g., A majestic wolf howling at a vibrant aurora borealis",value:V,onChange:X=>$(X.target.value),rows:2}),a.jsxs(O,{type:"button",onClick:xt,disabled:v||yt||!V||!!Z,className:"mt-2",variant:"outline",children:[yt?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Image"]}),a.jsxs(O,{type:"button",variant:"outline",className:"mt-2 ml-2",onClick:()=>document.getElementById("podReferenceImageUpload").click(),disabled:v||yt||!!Z,children:[a.jsx(Uo,{className:"mr-2 h-4 w-4"})," Add Ref. Image"]}),a.jsx(Ye,{id:"podReferenceImageUpload",type:"file",accept:"image/*",className:"hidden",onChange:Et})]}),Re&&a.jsxs("div",{className:"mt-2 flex flex-col items-start text-sm",children:[a.jsx(De,{className:"mb-1",children:"Reference Image:"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:Re,alt:"Reference preview",className:"w-16 h-16 object-contain rounded-md border bg-muted"}),a.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[150px]",children:xe==null?void 0:xe.name}),a.jsx(O,{type:"button",variant:"ghost",size:"icon",onClick:wt,className:"h-7 w-7",children:a.jsx(Wn,{className:"h-4 w-4 text-destructive"})})]})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t",children:[a.jsx(De,{htmlFor:"podImageUpload",children:"Or Upload Final Image for Product"}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(Ye,{id:"podImageUpload",type:"file",accept:"image/*",onChange:Be,className:"flex-grow",disabled:yt}),z&&Z&&a.jsx(O,{type:"button",variant:"ghost",size:"icon",onClick:Te,className:"h-9 w-9",children:a.jsx(Wn,{className:"h-4 w-4 text-destructive"})})]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"If you upload an image, it will be used instead of the generated one."})]}),an&&a.jsxs("div",{className:"mt-2 p-2 bg-destructive/10 border border-destructive/50 rounded-md text-destructive text-sm flex items-center gap-2",children:[a.jsx(Tg,{className:"h-5 w-5"}),a.jsx("p",{children:an})]}),z&&a.jsxs("div",{className:"mt-2 flex flex-col items-center",children:[a.jsx(De,{className:"mb-1",children:"Image Preview:"}),a.jsx("img",{src:z,alt:"Generated preview",className:"w-40 h-40 object-contain rounded-md border bg-muted"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(De,{htmlFor:"podProductSearch",children:"Search Print on Demand Products"}),a.jsx(Ye,{id:"podProductSearch",placeholder:"e.g., T-shirt, Mug",value:ze,onChange:pt,disabled:!z}),Ce.length>0&&a.jsx(Je,{className:"absolute z-10 w-full mt-1 max-h-48 overflow-y-auto border bg-background shadow-lg",children:Ce.map(X=>{const ne=ve.some(me=>me.name===X.name);return a.jsxs("div",{className:`p-2 hover:bg-muted cursor-pointer flex items-center gap-2 ${ne?"bg-primary/10":""}`,onClick:()=>At(X),children:[a.jsx("img",{src:X.imageUrl,alt:X.name,className:"w-8 h-8 object-contain rounded-sm"}),a.jsx("span",{children:X.name}),ne&&a.jsx(ya,{className:"h-4 w-4 text-primary ml-auto"})]},X.name)})})]}),ve.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsx(De,{className:"text-sm mb-1 block",children:"Selected Product Types:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ve.map(X=>a.jsxs(pg,{variant:"secondary",className:"flex items-center gap-1.5 pr-1",children:[X.name,a.jsx(O,{variant:"ghost",size:"icon",className:"h-5 w-5 hover:bg-destructive/20",onClick:()=>At(X),children:a.jsx(Ki,{className:"h-3 w-3 text-destructive"})})]},X.name))})]}),a.jsxs(O,{type:"button",onClick:On,disabled:v||en||!z||ve.length===0,className:"w-full mt-2",children:[en?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ca,{className:"mr-2 h-4 w-4"}),`Visualize Design on ${ve.length} Product(s)`]}),Me.length>0&&a.jsxs("div",{className:"mt-4 space-y-3",children:[a.jsx("h4",{className:"font-semibold text-md",children:"Visualized Products:"}),Me.map(X=>a.jsxs(Je,{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"flex gap-4 items-start",children:[a.jsx("img",{src:X.finalImageUrl,alt:X.title,className:"w-24 h-24 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("p",{className:"font-semibold",children:X.title}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Base: ",X.baseProductName]}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Price: $",X.price]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-3",children:X.description})]})]}),a.jsxs(O,{type:"button",onClick:()=>Tn(X),className:"w-full bg-green-600 hover:bg-green-700",disabled:v,children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"}),"Add This Product to Store"]})]},X.tempId))]}),n.products.items.filter(X=>X.isPrintOnDemand).length>0&&a.jsxs("div",{className:"mt-6 space-y-3",children:[a.jsx("p",{className:"text-md font-semibold",children:"Added Print on Demand Products:"}),a.jsxs("div",{className:"max-h-96 overflow-y-auto pr-2 space-y-3",children:[" ",n.products.items.map((X,ne)=>X.isPrintOnDemand?a.jsxs(Je,{className:"p-3 flex gap-3 items-start relative",children:[a.jsx("img",{src:X.imageUrl,alt:X.name,className:"w-20 h-20 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-sm",children:X.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",X.price]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:X.description})]}),a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-6 w-6",onClick:()=>mr(ne),children:a.jsx(Wn,{className:"h-4 w-4 text-destructive"})})]},`pod-item-${ne}`):null)]})]})]})]},"step4");case 5:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(De,{className:"text-lg font-semibold",children:"How do you want to add collections?"}),a.jsxs(gc,{onValueChange:X=>r(ne=>({...ne,collections:{...ne.collections,source:X}})),value:n.collections.source,children:[a.jsx(Za,{children:a.jsx(yc,{placeholder:"Choose collection source..."})}),a.jsxs(el,{children:[a.jsx(rr,{value:"ai",children:"Generate with AI"}),a.jsx(rr,{value:"manual",children:"Add Manually"})]})]}),I&&n.collections.source==="ai"&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:I}),W&&n.collections.source==="manual"&&B===null&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:W}),n.collections.source==="ai"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"collectionCount",children:"Number of AI Collections to Generate"}),a.jsx(Ye,{id:"collectionCount",type:"number",min:"1",max:"5",value:n.collections.count,onChange:X=>r(ne=>({...ne,collections:{...ne.collections,count:parseInt(X.target.value)||1}}))})]}),a.jsxs(O,{type:"button",onClick:g,disabled:v||!n.productType||!n.storeName||n.products.items.length===0,className:"w-full",children:[v?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Collections with AI"]}),n.collections.items.length>0&&a.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2 mt-4",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Generated Collections:"}),n.collections.items.map((X,ne)=>a.jsxs(Je,{className:"p-4 flex gap-4 items-start",children:[X.imageUrl?a.jsx("img",{src:X.imageUrl,alt:X.name,className:"w-24 h-24 object-cover rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-md",children:X.name||"Untitled Collection"}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:X.description||"No description."})]}),a.jsx("div",{className:"flex flex-col gap-1",children:a.jsx(O,{variant:"outline",size:"sm",className:"text-xs h-auto py-1 mt-2",onClick:()=>Le(X),children:"Manage Products"})})]},ne))]}),Xt&&a.jsx(G1e,{isOpen:mn,onClose:()=>{Ft(!1),or(null)},collection:Xt,allProducts:n.products.items,onSave:Ze})]}),n.collections.source==="manual"&&a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Your Collections:"}),n.collections.items.map((X,ne)=>a.jsxs(Je,{className:"p-4 space-y-3 relative",children:[a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7",onClick:()=>we(ne),disabled:n.collections.items.length<=1&&!X.name&&!X.description&&!X.imageUrl,children:a.jsx(Wn,{className:"h-4 w-4 text-destructive"})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.jsxs("div",{children:[a.jsx(De,{htmlFor:`collectionName-${ne}`,children:"Collection Name"}),a.jsx(Ye,{id:`collectionName-${ne}`,value:X.name,onChange:me=>J(ne,"name",me.target.value),placeholder:"e.g., 'Summer Collection'"})]})}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:`collectionDescription-${ne}`,children:"Short Description (Optional)"}),a.jsx(Pn,{id:`collectionDescription-${ne}`,value:X.description,onChange:me=>J(ne,"description",me.target.value),placeholder:"e.g., 'A curated selection of products perfect for the summer season.'",rows:2})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 border rounded-md",children:[X.imageUrl?a.jsx("img",{src:X.imageUrl,alt:X.name||"Collection image",className:"w-24 h-24 object-contain rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsx(De,{htmlFor:`collectionImageUpload-${ne}`,className:"text-sm sr-only",children:"Upload Collection Image"}),a.jsx(Ye,{id:`collectionImageUpload-${ne}`,type:"file",accept:"image/*",className:"hidden",onChange:async me=>{if(me.target.files&&me.target.files[0]){const q=me.target.files[0];try{const ie=await Gd(q);J(ne,"imageUrl",ie)}catch(ie){console.error("Error converting file to base64:",ie)}}}}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`collectionImageUpload-${ne}`).click(),children:[a.jsx(Uo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>G(ne),disabled:B===ne||!X.name,children:[B===ne?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate"]}),X.imageUrl&&a.jsxs(O,{variant:"destructive",size:"sm",onClick:()=>J(ne,"imageUrl",""),children:[a.jsx(Wn,{className:"mr-1 h-3 w-3"})," Remove Img"]})]})]}),W&&B===ne&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:W})]},ne)),a.jsxs(O,{type:"button",variant:"outline",onClick:ue,className:"w-full",children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"})," Add Another Collection"]})]})]},"step5");case 6:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-4 w-full",children:[a.jsx(De,{htmlFor:"prompt",className:"text-lg font-semibold",children:"Describe your store's overall style and feel"}),a.jsx(Pn,{id:"prompt",name:"prompt",value:n.prompt,onChange:s,placeholder:"e.g., 'A minimalist and modern design with a focus on high-quality product imagery. Use a cool color palette.' OR 'A vibrant and playful store with bold colors and fun animations.'",className:"min-h-[100px]"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This will influence the theme, layout, and imagery. Your store name, logo, and products are already included. You can also pick from the examples below."}),a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsx(De,{className:"text-md font-semibold",children:"AI Prompt Examples:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"elegance",displayName:"Elegance",storeName:"Elegant Finds",promptText:"A sophisticated and elegant store experience, focusing on timeless design and high-quality craftsmanship. The aesthetic is refined, with a clean layout and luxurious feel, using a palette of soft neutrals, gold accents, and rich textures."},{key:"futuretech",displayName:"FutureTech",storeName:"Nexus Innovations",promptText:"A cutting-edge, futuristic store specializing in the latest technology and gadgets. The design is sleek, minimalist, and dark-themed with neon blue or cyan accents, interactive elements, and a high-tech vibe."},{key:"greenharvest",displayName:"GreenHarvest",storeName:"Evergreen Market",promptText:"An eco-friendly and organic store focusing on sustainable and natural products. The design should feel earthy, warm, and inviting, using natural materials, green and brown tones, and imagery of nature."},{key:"urbanthreads",displayName:"UrbanThreads",storeName:"Metro Threads Co.",promptText:"A trendy, urban streetwear store with a gritty yet stylish aesthetic. Think industrial-chic, graffiti art influences, bold typography, and a dynamic, energetic feel. Muted colors with pops of vibrant color."}].map(X=>a.jsx(O,{variant:"outline",size:"sm",onClick:()=>{e.setFormData(ne=>({...ne,storeName:X.storeName,prompt:X.promptText}))},className:"bg-primary-foreground dark:bg-neutral-800 hover:bg-primary/10 dark:hover:bg-neutral-700",children:X.displayName},X.key))})]})]},"step6");default:return null}},cF=(t,e,n)=>!!(t===1&&(e.initialImportMethod==="productType"&&!e.productType||e.initialImportMethod==="photos"&&(!n||n.length===0))||t===2&&!e.storeName||t===4&&(e.products.source==="manual"&&e.products.items.some(r=>!r.name||!r.price)||e.products.source==="ai"&&e.products.items.length===0&&e.products.count>0)||t===5&&(e.collections.source==="ai"&&e.collections.items.length===0&&e.collections.count>0||e.collections.source==="manual"&&e.collections.items.some(r=>!r.name))||t===6&&!e.prompt),TH=({isEmbedded:t=!1,onGenerationComplete:e,initialDataFromImport:n=null})=>{const r=bi(),[s,i]=p.useState(1),[o,l]=p.useState([]),[c,u]=p.useState({initialImportMethod:"productType",productType:"",storeName:"",logoUrlLight:"",logoUrlDark:"",products:{source:"ai",count:3,items:[]},collections:{source:"ai",count:3,items:[]},prompt:""}),[d,h]=p.useState([]),[f,m]=p.useState(!1),[g,x]=p.useState(!1),[w,v]=p.useState(null),[_,C]=p.useState(null),[T,R]=p.useState(null),[A,E]=p.useState(null),[I,P]=p.useState(null),[k,j]=p.useState(null),[D,M]=p.useState(null),[G,B]=p.useState(!1),[W,Q]=p.useState(null),{generateStoreFromWizard:H,isGenerating:Y,checkStoreNameAvailability:V,importedStoreDataForGenerator:$,isImportDataReadyForGenerator:z,clearImportedStoreDataForGenerator:F}=zn();p.useEffect(()=>{t&&z&&$?(console.log("StoreWizard (Embedded) consuming imported data:",$),u(ee=>({...ee,storeName:$.name||ee.storeName,prompt:$.prompt||ee.prompt,logoUrlLight:$.logoUrl||ee.logoUrlLight,logoUrlDark:$.logoUrl||ee.logoUrlDark,products:$.products&&$.products.length>0?{source:"manual",count:$.products.length,items:$.products.map(le=>({name:le.name||"",price:le.price||"",description:le.description||"",images:le.images||[],variants:le.variants||[]}))}:ee.products,collections:$.collections&&$.collections.length>0?{source:"manual",count:$.collections.length,items:$.collections.map(le=>({name:le.name||"",description:le.description||"",imageUrl:le.imageUrl||"",product_ids:le.product_ids||[]}))}:ee.collections})),$.name&&Z($.name),F()):n&&(u(ee=>({...ee,storeName:n.name||ee.storeName,prompt:n.prompt||ee.prompt,logoUrlLight:n.logoUrl||ee.logoUrlLight,logoUrlDark:n.logoUrl||ee.logoUrlDark,products:n.products&&n.products.length>0?{source:"manual",count:n.products.length,items:n.products.map(le=>({name:le.name||"",price:le.price||"",description:le.description||"",images:le.images||[],variants:le.variants||[]}))}:ee.products,collections:n.collections&&n.collections.length>0?{source:"manual",count:n.collections.length,items:n.collections.map(le=>({name:le.name||"",description:le.description||"",imageUrl:le.imageUrl||"",product_ids:le.product_ids||[]}))}:ee.collections})),n.name&&Z(n.name))},[t,z,$,F,n]);const Z=async ee=>{if(!(ee||c.storeName)){Q({status:"error",message:"Please enter a store name to check."});return}B(!0),Q(null),v(null);try{const K=await qT(c.storeName);Q(K?{status:"claimed",message:"Not available"}:{status:"available",message:"Available"})}catch(K){console.error("Store name availability check failed:",K),Q({status:"error",message:K.message||"Could not check store name. Please try again."})}finally{B(!1)}};p.useEffect(()=>{if(c.storeName&&w){const ee=w.toLowerCase();ee.includes("store name")&&(ee.includes("empty")||ee.includes("required"))&&v(null)}if(c.storeName&&s===2){const ee=setTimeout(async()=>{B(!0),Q(null),v(null);try{const le=await qT(c.storeName);Q(le?{status:"claimed",message:"This store name is already taken."}:{status:"available",message:"Store name is available!"})}catch(le){console.error("Store name availability check failed:",le),Q({status:"error",message:le.message||"Could not check store name. Please try again."})}finally{B(!1)}},750);return()=>{clearTimeout(ee)}}else!c.storeName&&s===2&&Q(null)},[c.storeName,s,w]);const fe=ee=>{u(le=>({...le,initialImportMethod:ee,productType:ee==="photos"?"":le.productType})),ee==="productType"&&h([])},xe=ee=>new Promise((le,K)=>{const Ae=new FileReader;Ae.onload=()=>le(Ae.result),Ae.onerror=K,Ae.readAsDataURL(ee)}),ge=async ee=>{const le=Array.from(ee.target.files);if(le.length===0)return;const K=10;if(d.length+le.length>K){v(`You can upload a maximum of ${K} photos.`);return}v(null);const Ae=le.map(async Oe=>{try{const He=await xe(Oe);return{file:Oe,previewUrl:URL.createObjectURL(Oe),base64:He,name:Oe.name,type:Oe.type}}catch(He){return console.error("Error processing file:",Oe.name,He),null}}),Ne=(await Promise.all(Ae)).filter(Boolean);if(h(Oe=>{const He=[...Oe,...Ne];return Oe.forEach(ce=>{ce.previewUrl&&ce.previewUrl.startsWith("blob:")}),He}),c.initialImportMethod==="photos"&&Ne.length>0){m(!0),v(null);try{const Oe=d.concat(Ne).map(ce=>({base64:ce.base64,mimeType:ce.type,name:ce.name})),He=await VG(Oe);He.error?v(He.error):(u(ce=>({...ce,productType:He.productType||ce.productType,storeName:He.storeNameSuggestions&&He.storeNameSuggestions.length>0?He.storeNameSuggestions[0]:ce.storeName,products:{source:"manual",count:He.products.length,items:He.products.map(_e=>({name:_e.name||"",price:_e.price||"",description:_e.description||"",images:_e.images||[],variants:[],isFromPhotoAI:!0}))},collections:{source:"manual",count:He.collections.length,items:He.collections.map(_e=>({name:_e.name||"",description:_e.description||"",imageUrl:"",product_ids:[],isFromPhotoAI:!0}))},prompt:He.storePrompt||ce.prompt})),He.storeNameSuggestions&&He.storeNameSuggestions.length>0&&l(He.storeNameSuggestions),He.logoDescription&&console.log("AI Logo Description:",He.logoDescription))}catch(Oe){console.error("Error processing photos with AI:",Oe),v(`Failed to process images with AI: ${Oe.message}`)}finally{m(!1)}}},Re=ee=>{h(le=>{const K=le[ee];return K&&K.previewUrl&&K.previewUrl.startsWith("blob:")&&URL.revokeObjectURL(K.previewUrl),le.filter((Ae,Ne)=>Ne!==ee)})},Ue=ee=>{const{name:le,value:K}=ee.target;u(Ae=>({...Ae,[le]:K}))},ze=ee=>{u(le=>({...le,productType:ee}))},he=ee=>{u(le=>({...le,products:{...le.products,source:ee}}))},Ce=ee=>{u(le=>({...le,products:{...le.products,count:parseInt(ee.target.value)||1}}))},Pe=(ee,le,K)=>{const Ae=[...c.products.items];Ae[ee][le]=K,u(Ne=>({...Ne,products:{...Ne.products,items:Ae}}))},ve=()=>{u(ee=>({...ee,products:{...ee.products,items:[...ee.products.items,{name:"",price:"",description:"",images:[]}]}}))},de=ee=>{const le=c.products.items.filter((K,Ae)=>Ae!==ee);u(K=>({...K,products:{...K.products,items:le}}))},Me=async()=>{var ee;if(!c.productType){v("Please select a product type first.");return}x(!0),l([]),v(null);try{const le=((ee=Jw.find(Ae=>Ae.value===c.productType))==null?void 0:ee.label)||c.productType,K=await bI(le);K.error?(console.error("Failed to suggest store names:",K.error),v(K.error),l([])):K.suggestions&&K.suggestions.length>0?l(K.suggestions):(v("No suggestions received, or response was empty."),l([]))}catch(le){console.error("Error in suggestStoreNameHandler:",le),v(`An unexpected error occurred: ${le.message}`),l([])}x(!1)},Ge=ee=>{u(le=>({...le,storeName:ee})),l([])},yt=async()=>{if(!c.storeName){console.warn("Store name is required to generate a logo."),v("Please ensure a store name is set before generating a logo.");return}x(!0),v(null);try{const ee=await Pg(c.storeName);ee&&(ee.logoUrlLight||ee.logoUrlDark)?(u(le=>({...le,logoUrlLight:ee.logoUrlLight||"",logoUrlDark:ee.logoUrlDark||""})),console.log("Logos generated and URLs set:",ee),ee.textResponse&&console.log("Gemini text response for logo generation:",ee.textResponse)):(console.error("Failed to generate logos: No image data received for either version."),v("Failed to generate logo. The AI did not return sufficient image data."))}catch(ee){console.error("Failed to generate logos:",ee),v(`Logo generation failed: ${ee.message}`)}x(!1)},Pt=async()=>{if(!c.productType||!c.storeName){v("Please provide a product type and store name before generating AI products.");return}x(!0),v(null);let ee=[];try{const le=await O1e(c.prompt,c.productType);if(console.log("Prompt Analysis Result:",le),le.error||le.strategy==="error"){v(le.error||"Failed to analyze store prompt for product strategy."),x(!1);return}let K=null,Ae="image/png";const Ne=c.logoUrlLight||c.logoUrlDark;if(Ne&&Ne.startsWith("data:")){const Oe=Ne.split(",");if(Oe.length===2){K=Oe[1];const He=Oe[0].match(/:(.*?);/);He&&He[1]&&(Ae=He[1])}}if(le.strategy==="standard"){console.log("Strategy: Standard Product Generation");for(let Oe=0;Oe<c.products.count;Oe++){console.log(`Generating AI product ${Oe+1} of ${c.products.count}...`);const He=await FG(c.productType,c.storeName,K,Ae,ee.map(ce=>ce.name),void 0,void 0,void 0,c.prompt);He&&He.images&&He.images.length>0?ee.push({name:He.title,description:He.description,price:He.price,images:He.images,variants:He.variants||[]}):console.warn(`Failed to generate full data for standard product ${Oe+1}. Skipping.`)}}else if(le.strategy==="pod_theme_visualization"||le.strategy==="pod_specific_products"){console.log(`Strategy: Print on Demand - ${le.strategy}`);const Oe=le.theme&&le.theme!=="General"?`Design for print-on-demand products for a store themed '${le.theme}'. Store name: ${c.storeName}. User prompt: ${c.prompt}`:`Versatile design for print-on-demand products based on store prompt: "${c.prompt}". Store name: ${c.storeName}.`,He=6;let ce=[];for(let Te=0;Te<He;Te++){const Et=`${Oe} (Design variation ${Te+1} of ${He}, ensure it's distinct from previous designs for this store if any were made).`;console.log(`Generating POD design ${Te+1}/${He}...`);const wt=await Ag({prompt:Et});wt&&wt.imageData?ce.push({base64:wt.imageData,mimeType:wt.imageMimeType||"image/png",prompt:Et}):console.warn(`Failed to generate POD design ${Te+1}.`)}if(ce.length===0){v("Failed to generate any base designs for POD products."),x(!1);return}let _e=[...so],Be=[];for(let Te=0;Te<Math.min(ce.length,_e.length);Te++){const Et=Math.floor(Math.random()*_e.length);Be.push(_e.splice(Et,1)[0])}if(Be.length===0){v("No POD mockup products available for visualization."),x(!1);return}for(let Te=0;Te<Math.min(ce.length,Be.length);Te++){const Et=ce[Te],wt=Be[Te];console.log(`Visualizing design ${Te+1} on ${wt.name}...`);const xt=await Bp(Et.base64,Et.mimeType,wt.imageUrl,le.theme||c.prompt,wt.name);if(xt&&xt.visualizedImageData&&xt.productDetails){const pt=`data:${Et.mimeType};base64,${Et.base64}`,At=`data:${xt.visualizedImageMimeType};base64,${xt.visualizedImageData}`;ee.push({name:xt.productDetails.title,price:parseFloat(xt.productDetails.price).toFixed(2),description:xt.productDetails.description,images:[pt,At],isPrintOnDemand:!0,podDetails:{originalDesignImageUrl:pt,designPrompt:Et.prompt,baseProductName:wt.name,baseProductImageUrl:wt.imageUrl},variants:xt.productDetails.variants||[]})}else console.warn(`Failed to visualize design ${Te+1} on ${wt.name}. Skipping.`)}}u(Oe=>({...Oe,products:{...Oe.products,items:ee}})),ee.length===0&&c.products.count>0&&v("AI failed to generate any products with the selected strategy. Please try again or adjust settings.")}catch(le){console.error("Error generating AI products:",le),v(`Failed to generate AI products: ${le.message}`)}x(!1)},en=async()=>{if(!c.productType||!c.storeName||c.products.items.length===0){v("Please ensure product type, store name, and at least one product are set before generating AI collections.");return}x(!0),v(null);const ee=[],le=c.collections.items.map(K=>K.name);try{for(let K=0;K<c.collections.count;K++){console.log(`Generating AI collection ${K+1} of ${c.collections.count}...`);const Ae=await OG(c.productType,c.storeName,c.products.items,le);if(Ae&&!Ae.error&&Ae.name&&Ae.description&&Ae.product_ids){let Ne=`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(Ae.name||"Collection")}`;Ae.imageData&&(Ne=`data:image/png;base64,${Ae.imageData}`),ee.push({name:Ae.name,description:Ae.description,imageUrl:Ne,product_ids:Ae.product_ids}),Ae.name&&le.push(Ae.name)}else console.warn(`Failed to generate full data for collection ${K+1}. Skipping.`)}u(K=>({...K,collections:{...K.collections,items:ee}})),ee.length===0&&c.collections.count>0&&v("AI failed to generate any collections. Please try again or adjust settings.")}catch(K){console.error("Error generating AI collections:",K),v(`Failed to generate AI collections: ${K.message}`)}x(!1)},fn=async ee=>{const le=c.products.items[ee];if(!le||!le.name){R("Product name is required to generate an image.");return}C(ee),R(null);try{const K=await s5(le.name,le.description);if(K&&K.imageData){const Ae=`data:image/png;base64,${K.imageData}`,Ne=[...c.products.items];Ne[ee].images=[Ae],u(Oe=>({...Oe,products:{...Oe.products,items:Ne}}))}else throw new Error(K.textResponse||"Failed to generate product image data.")}catch(K){console.error(`Error generating image for product ${ee}:`,K),R(K.message)}finally{C(null)}},an=async ee=>{const le=c.products.items[ee];if(!le||!le.images||le.images.length===0){P("At least one image must be uploaded or generated first to create more angles.");return}const K=le.images[0];E(ee),P(null);try{const{generateDifferentAnglesFromImage:Ae}=await Mt(()=>Promise.resolve().then(()=>Vae),void 0),Ne=K.split(",");if(Ne.length!==2)throw new Error("Invalid base image URL format for angle generation.");const Oe=Ne[0],He=Ne[1],ce=Oe.match(/:(.*?);/);if(!ce||!ce[1])throw new Error("Could not determine mime type from base image URL.");const _e=ce[1],Be=await Ae(He,_e,le.name||"Product"),Te=[...c.products.items],Et=Te[ee].images||[];Te[ee].images=[...Et,...Be.filter(wt=>!Et.includes(wt))],u(wt=>({...wt,products:{...wt.products,items:Te}}))}catch(Ae){console.error(`Error generating more angles for product ${ee}:`,Ae),P(Ae.message||"Failed to generate additional angles.")}finally{E(null)}},dn=async ee=>{const le=c.collections.items[ee];if(!le||!le.name){M("Collection name is required to generate an image.");return}j(ee),M(null),v(null);try{const K=await i5(le.name,le.description);if(K&&K.imageData&&K.imageMimeType){const Ae=`data:${K.imageMimeType};base64,${K.imageData}`,Ne=[...c.collections.items];Ne[ee].imageUrl=Ae,u(Oe=>({...Oe,collections:{...Oe.collections,items:Ne}}))}else throw new Error(K.textResponse||"Failed to generate collection image data.")}catch(K){console.error(`Error generating image for collection ${ee} ("${le.name}"):`,K),M(K.message||"Unknown error during collection image generation.");const Ae=[...c.collections.items];Ae[ee].imageUrl="",u(Ne=>({...Ne,collections:{...Ne.collections,items:Ae}}))}finally{j(null)}},Lt=()=>i(ee=>ee+1),xn=()=>i(ee=>ee-1),te=async()=>{x(!0),v(null);try{const ee={name:c.storeName,niche:c.productType,description:c.prompt},le=await a3(ee);le.error&&console.warn("Failed to generate hero content:",le.error);const K=await l3(ee);K.error&&console.warn("Failed to generate store way content:",K.error);const Ae=await _I(ee);Ae.error&&console.warn("Failed to generate store features content:",Ae.error);const Ne={...c,content:{...c.content||{},hero:le&&!le.error?le:void 0,storeWay:K&&!K.error?K:void 0,storeFeatures:Ae&&!Ae.error?Ae:void 0}},Oe=await H(Ne);if(Oe){if(t&&e)e(Oe);else if(!t){const He=`/${Oe.urlSlug||pc(Oe.name)}`;r(He)}}}catch(ee){console.error("Error during final store generation steps or navigation:",ee),v(`An error occurred during final store setup: ${ee.message}`)}finally{x(!1)}},Ee={formData:c,setFormData:u,handleInputChange:Ue,handleProductTypeChange:ze,handleProductSourceChange:he,handleProductCountChange:Ce,handleManualProductChange:Pe,addManualProduct:ve,removeManualProduct:de,suggestStoreName:Me,generateLogo:yt,generateAiProducts:Pt,generateAiCollections:en,handleGenerateManualProductImage:fn,handleGenerateMoreAngles:an,isProcessing:g,isGeneratingProductImageForIndex:_,productImageGenerationError:T,isGeneratingAnglesForIndex:A,angleGenerationError:I,productTypeOptions:Jw,storeNameSuggestions:o,handleSuggestionClick:Ge,suggestionError:w,handleInitialImportMethodChange:fe,handleProductPhotoUpload:ge,uploadedProductPhotos:d,removeUploadedProductPhoto:Re,isProcessingPhotos:f,handleGenerateCollectionImage:dn,isGeneratingCollectionImageForIndex:k,collectionImageGenerationError:D,isCheckingStoreName:G,storeNameAvailability:W,handleManualStoreNameCheck:Z};return t?a.jsxs("div",{className:"w-full p-2",children:[" ",a.jsx(Sc,{mode:"wait",children:lF(s,Ee)}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsxs(O,{variant:"outline",onClick:xn,disabled:s===1||Y||f,children:[a.jsx(Go,{className:"mr-2 h-4 w-4"})," Previous"]}),s<6?a.jsxs(O,{onClick:Lt,disabled:cF(s,c,d)||Y||f,children:["Next ",a.jsx(Mu,{className:"ml-2 h-4 w-4"})]}):a.jsxs(O,{onClick:te,disabled:g||Y||f||!c.prompt,className:"bg-primary hover:bg-primary/90",children:[g||Y?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ca,{className:"mr-2 h-4 w-4"}),"Generate Store"]})]})]}):a.jsxs("div",{className:"w-full max-w-2xl mx-auto",children:[" ",a.jsxs(ct,{children:[a.jsx(ut,{className:"text-2xl font-bold",children:"Store Creation Wizard"}),a.jsxs(Qt,{children:["Step ",s," of 6: Let's build your online store together!"]}),a.jsx("div",{className:"w-full bg-green-200 dark:bg-green-800 rounded-full h-2.5 mt-2",children:a.jsx(It.div,{className:"bg-green-600 dark:bg-green-500 h-2.5 rounded-full",initial:{width:"0%"},animate:{width:`${s/6*100}%`},transition:{duration:.5,ease:"easeInOut"}})})]}),a.jsx(it,{className:"min-h-[250px] flex items-center",children:a.jsx(Sc,{mode:"wait",children:lF(s,Ee)})}),a.jsxs(yd,{className:"flex justify-between",children:[a.jsxs(O,{variant:"outline",onClick:xn,disabled:s===1||Y||f,children:[a.jsx(Go,{className:"mr-2 h-4 w-4"})," Previous"]}),s<6?a.jsxs(O,{onClick:Lt,disabled:cF(s,c,d)||Y||f,children:["Next ",a.jsx(Mu,{className:"ml-2 h-4 w-4"})]}):a.jsxs(O,{onClick:te,disabled:g||Y||f||!c.prompt,children:[g||Y?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ca,{className:"mr-2 h-4 w-4"}),"Generate Store"]})]})]})},q1e=({isOpen:t,onClose:e,product:n,onSave:r})=>{const[s,i]=p.useState(null);if(p.useEffect(()=>{var d,h,f,m,g,x,w;if(n){const v=(h=(d=n.variants)==null?void 0:d.edges[0])==null?void 0:h.node;i({...n,name:n.title||"",price:((f=v==null?void 0:v.price)==null?void 0:f.amount)||0,currencyCode:((m=v==null?void 0:v.price)==null?void 0:m.currencyCode)||"USD",imageUrl:((w=(x=(g=n.images)==null?void 0:g.edges[0])==null?void 0:x.node)==null?void 0:w.url)||""})}else i(null)},[n]),!t||!s)return null;const o=d=>{const{name:h,value:f}=d.target;i(m=>({...m,[h]:f}))},l=d=>{const{value:h}=d.target;i(f=>({...f,price:parseFloat(h)||0}))},c=d=>{const{value:h}=d.target;i(f=>({...f,imageUrl:h}))},u=()=>{var h,f,m,g;const d={...s,title:s.name,images:{edges:[{node:{url:s.imageUrl,altText:s.name}}]},variants:{...s.variants,edges:[{node:{...((f=(h=s.variants)==null?void 0:h.edges[0])==null?void 0:f.node)||{},price:{amount:s.price,currencyCode:s.currencyCode}}},...((g=(m=s.variants)==null?void 0:m.edges)==null?void 0:g.slice(1))||[]]}};r(d),e()};return a.jsx(Xr,{open:t,onOpenChange:e,children:a.jsxs(Ur,{className:"sm:max-w-lg",children:[a.jsxs(Br,{children:[a.jsxs(zr,{children:["Edit Product: ",n.title]}),a.jsx(Zi,{children:"Make changes to the product details below."})]}),a.jsx(xs,{className:"max-h-[60vh] p-1",children:a.jsxs("div",{className:"grid gap-4 py-4 pr-3",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(De,{htmlFor:"name",className:"text-right",children:"Name"}),a.jsx(Ye,{id:"name",name:"name",value:s.name,onChange:o,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(De,{htmlFor:"description",className:"text-right",children:"Description"}),a.jsx(Pn,{id:"description",name:"description",value:s.description,onChange:o,className:"col-span-3",rows:4})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(De,{htmlFor:"price",className:"text-right",children:"Price"}),a.jsx(Ye,{id:"price",name:"price",type:"number",value:s.price,onChange:l,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(De,{htmlFor:"imageUrl",className:"text-right",children:"Image URL"}),a.jsx(Ye,{id:"imageUrl",name:"imageUrl",value:s.imageUrl,onChange:c,className:"col-span-3"})]})]})}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel"}),a.jsx(O,{type:"button",onClick:u,children:"Save Changes"})]})]})})},K1e=({isOpen:t,onClose:e,collection:n,onSave:r})=>{const[s,i]=p.useState(null);if(p.useEffect(()=>{i(n?{...n,name:n.title||""}:null)},[n]),!t||!s)return null;const o=c=>{const{name:u,value:d}=c.target;i(h=>({...h,[u]:d}))},l=()=>{const c={...s,title:s.name};r(c),e()};return a.jsx(Xr,{open:t,onOpenChange:e,children:a.jsxs(Ur,{className:"sm:max-w-lg",children:[a.jsxs(Br,{children:[a.jsxs(zr,{children:["Edit Collection: ",n.title]}),a.jsx(Zi,{children:"Make changes to the collection details below."})]}),a.jsx(xs,{className:"max-h-[60vh] p-1",children:a.jsxs("div",{className:"grid gap-4 py-4 pr-3",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(De,{htmlFor:"name",className:"text-right",children:"Name"}),a.jsx(Ye,{id:"name",name:"name",value:s.name,onChange:o,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(De,{htmlFor:"description",className:"text-right",children:"Description"}),a.jsx(Pn,{id:"description",name:"description",value:s.description||"",onChange:o,className:"col-span-3",rows:4})]})]})}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel"}),a.jsx(O,{type:"button",onClick:l,children:"Save Changes"})]})]})})},Y1e=()=>{var x,w,v,_,C,T,R,A,E,I,P,k,j,D,M;const{shopifyPreviewMetadata:t,isFetchingShopifyPreviewData:e,shopifyImportError:n,updateShopifyPreviewMetadata:r}=zn(),[s,i]=p.useState(((v=(w=(x=t==null?void 0:t.brand)==null?void 0:x.colors)==null?void 0:w.primary)==null?void 0:v.background)||"#000000"),[o,l]=p.useState(((T=(C=(_=t==null?void 0:t.brand)==null?void 0:_.colors)==null?void 0:C.secondary)==null?void 0:T.background)||"#ffffff");ht.useEffect(()=>{var G,B,W;(G=t==null?void 0:t.brand)!=null&&G.colors&&(i(((B=t.brand.colors.primary)==null?void 0:B.background)||"#000000"),l(((W=t.brand.colors.secondary)==null?void 0:W.background)||"#ffffff"))},[t]);const c=G=>{var W,Q,H;const B=G.target.value;i(B),r&&r({...t,brand:{...t.brand,colors:{...(W=t.brand)==null?void 0:W.colors,primary:{...(H=(Q=t.brand)==null?void 0:Q.colors)==null?void 0:H.primary,background:B}}}})},u=G=>{var W,Q,H;const B=G.target.value;l(B),r&&r({...t,brand:{...t.brand,colors:{...(W=t.brand)==null?void 0:W.colors,secondary:{...(H=(Q=t.brand)==null?void 0:Q.colors)==null?void 0:H.secondary,background:B}}}})};if(e&&!t)return a.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Fetching store information..."})]});if(n&&!t)return a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-destructive",children:[a.jsx(Tg,{className:"h-12 w-12 mb-4"}),a.jsx("p",{className:"font-semibold",children:"Error Fetching Store Info"}),a.jsx("p",{className:"text-sm text-center",children:n})]});if(!t)return a.jsx("div",{className:"text-center text-muted-foreground",children:"No store metadata to display."});const{name:d,description:h,primaryDomain:f,brand:m}=t,g=((A=(R=m==null?void 0:m.logo)==null?void 0:R.image)==null?void 0:A.url)||((I=(E=m==null?void 0:m.squareLogo)==null?void 0:E.image)==null?void 0:I.url);return a.jsxs("div",{className:"w-full p-4",children:[a.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Store Preview"}),a.jsxs(Je,{className:"mb-4",children:[a.jsx(ct,{children:a.jsxs("div",{className:"flex items-center space-x-4",children:[g?a.jsx("img",{src:g,alt:`${d} logo`,className:"h-16 w-16 object-contain rounded border"}):a.jsx("div",{className:"h-16 w-16 bg-muted rounded border flex items-center justify-center text-muted-foreground",children:a.jsx(NE,{size:32})}),a.jsxs("div",{children:[a.jsx(ut,{children:d||"N/A"}),(f==null?void 0:f.host)&&a.jsx(Qt,{children:f.host})]})]})}),a.jsxs(it,{children:[a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[a.jsx("strong",{children:"Slogan:"})," ",(m==null?void 0:m.slogan)||"N/A"]}),a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[a.jsx("strong",{children:"Description:"})," ",h||(m==null?void 0:m.shortDescription)||"N/A"]}),((P=m==null?void 0:m.coverImage)==null?void 0:P.url)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-sm font-medium mb-1",children:"Cover Image:"}),a.jsx("img",{src:m.coverImage.url,alt:"Store cover",className:"rounded max-h-40 w-auto mx-auto border"})]})]})]}),(m==null?void 0:m.colors)&&a.jsxs(Je,{className:"mt-4",children:[a.jsx(ct,{children:a.jsx(ut,{className:"text-lg",children:"Brand Colors"})}),a.jsxs(it,{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"primaryColorPicker",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Primary Color"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"color",id:"primaryColorPicker",value:s,onChange:c,className:"h-10 w-10 rounded border cursor-pointer"}),a.jsx("div",{className:"w-12 h-10 rounded border",style:{backgroundColor:s},title:`Primary Background: ${s}`}),a.jsx("span",{className:"text-sm",children:s})]}),((j=(k=m==null?void 0:m.colors)==null?void 0:k.primary)==null?void 0:j.foreground)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-xs text-muted-foreground",children:"Text/Icon Color (from Shopify):"}),a.jsx("div",{className:"w-full h-6 rounded border mt-1",style:{backgroundColor:m.colors.primary.foreground},title:`Primary Foreground: ${m.colors.primary.foreground}`})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"secondaryColorPicker",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Secondary Color"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"color",id:"secondaryColorPicker",value:o,onChange:u,className:"h-10 w-10 rounded border cursor-pointer"}),a.jsx("div",{className:"w-12 h-10 rounded border",style:{backgroundColor:o},title:`Secondary Background: ${o}`}),a.jsx("span",{className:"text-sm",children:o})]}),((M=(D=m==null?void 0:m.colors)==null?void 0:D.secondary)==null?void 0:M.foreground)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-xs text-muted-foreground",children:"Text/Icon Color (from Shopify):"}),a.jsx("div",{className:"w-full h-6 rounded border mt-1",style:{backgroundColor:m.colors.secondary.foreground},title:`Secondary Foreground: ${m.colors.secondary.foreground}`})]})]})]})]})]})},J1e=()=>{var B,W,Q,H,Y,V;const{shopifyPreviewProducts:t,shopifyPreviewCollections:e,fetchShopifyWizardProducts:n,fetchShopifyWizardCollections:r,isFetchingShopifyPreviewData:s,shopifyImportError:i,shopifyPreviewMetadata:o,generatedLogoImage:l,isGeneratingLogo:c,logoGenerationError:u,generateShopifyStoreLogo:d,updateShopifyPreviewProduct:h,updateShopifyPreviewCollection:f}=zn(),[m,g]=p.useState(!1),[x,w]=p.useState(null),[v,_]=p.useState(!1),[C,T]=p.useState(null),R=$=>{w($),g(!0)},A=()=>{g(!1),w(null)},E=$=>{h($)},I=$=>{T($),_(!0)},P=()=>{_(!1),T(null)},k=$=>{f($)},j=()=>{t.pageInfo.hasNextPage&&n(10,t.pageInfo.endCursor)},D=()=>{e.pageInfo.hasNextPage&&r(10,e.pageInfo.endCursor)},M=(o==null?void 0:o.name)||"Your Store",G=((Q=(W=(B=o==null?void 0:o.brand)==null?void 0:B.logo)==null?void 0:W.image)==null?void 0:Q.url)||((V=(Y=(H=o==null?void 0:o.brand)==null?void 0:H.squareLogo)==null?void 0:Y.image)==null?void 0:V.url);return a.jsxs("div",{className:"w-full p-4 space-y-6",children:[a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Generate Store Logo"}),a.jsxs(Qt,{children:['Optionally, generate a new logo for "',M,'" using AI. The generated logo will be used for your new store if you proceed.']})]}),a.jsxs(it,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Current Shopify Logo (if any):"}),G?a.jsx("img",{src:G,alt:`${M} current logo`,className:"h-48 w-auto object-contain"}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No logo found in Shopify data."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Generated Logo Preview:"}),c&&a.jsxs("div",{className:"h-48 w-full flex items-center justify-center",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary"})," "]}),!c&&l&&a.jsx("div",{className:"h-48 w-auto flex items-center justify-center",children:a.jsx("img",{src:l,alt:`${M} AI generated logo`,className:"h-full w-auto object-contain"})}),!c&&!l&&a.jsxs("div",{className:"h-48 w-full flex items-center justify-center text-muted-foreground",children:[a.jsx(NE,{className:"h-12 w-12 mr-2"})," ",a.jsx("span",{children:"Logo will appear here"})]})]})]}),a.jsxs(O,{onClick:d,disabled:c||!(o!=null&&o.name),className:"w-full md:w-auto",children:[c?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate New Logo with AI"]}),u&&a.jsxs("p",{className:"text-sm text-destructive text-center mt-2",children:[a.jsx(Tg,{className:"inline h-4 w-4 mr-1"}),u]}),!(o!=null&&o.name)&&a.jsx("p",{className:"text-sm text-amber-600 text-center mt-2",children:"Store name from Shopify is required to generate a logo."})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Products (",t.edges.length," loaded)"]}),i&&i.includes("products")&&a.jsx("p",{className:"text-destructive text-sm mb-2",children:i}),a.jsxs(xs,{className:"h-60 border rounded p-2",children:[t.edges.length===0&&!s&&a.jsx("p",{className:"text-muted-foreground text-sm p-2",children:"No products loaded yet or none found."}),t.edges.map(({node:$})=>{var z,F,Z,fe,xe,ge,Re,Ue,ze;return a.jsx("div",{className:"p-3 border-b last:border-b-0",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[((Z=(F=(z=$.images)==null?void 0:z.edges[0])==null?void 0:F.node)==null?void 0:Z.url)&&a.jsx("img",{src:$.images.edges[0].node.url,alt:$.title,className:"h-16 w-16 rounded object-cover border"}),!((ge=(xe=(fe=$.images)==null?void 0:fe.edges[0])==null?void 0:xe.node)!=null&&ge.url)&&a.jsx("div",{className:"h-16 w-16 bg-muted rounded border flex items-center justify-center text-muted-foreground",children:a.jsx(NE,{size:24})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm",children:$.title}),((ze=(Ue=(Re=$.variants)==null?void 0:Re.edges[0])==null?void 0:Ue.node)==null?void 0:ze.price)&&a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Price: ",$.variants.edges[0].node.price.amount," ",$.variants.edges[0].node.price.currencyCode]}),$.description&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1 truncate",title:$.description,children:["Desc: ",$.description.substring(0,50),$.description.length>50?"...":""]}),$.tags&&$.tags.length>0&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Tags: ",$.tags.join(", ")]})]}),a.jsx(O,{variant:"ghost",size:"sm",onClick:()=>R($),className:"ml-auto",children:a.jsx(Zv,{className:"h-4 w-4"})})]})},$.id)}),s&&t.pageInfo.hasNextPage&&a.jsx("div",{className:"flex justify-center py-2",children:a.jsx(ft,{className:"h-5 w-5 animate-spin"})})]}),t.pageInfo.hasNextPage&&a.jsx(O,{onClick:j,disabled:s,className:"mt-2 w-full",children:s?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):"Load More Products"}),!t.pageInfo.hasNextPage&&t.edges.length>0&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"All products loaded."})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Collections (",e.edges.length," loaded)"]}),i&&i.includes("collections")&&a.jsx("p",{className:"text-destructive text-sm mb-2",children:i}),a.jsxs(xs,{className:"h-60 border rounded p-2",children:[e.edges.length===0&&!s&&a.jsx("p",{className:"text-muted-foreground text-sm p-2",children:"No collections loaded yet or none found."}),e.edges.map(({node:$})=>a.jsxs("div",{className:"p-2 border-b text-sm flex justify-between items-center",children:[a.jsx("span",{children:$.title}),a.jsx(O,{variant:"ghost",size:"sm",onClick:()=>I($),children:a.jsx(Zv,{className:"h-4 w-4"})})]},$.id)),s&&e.pageInfo.hasNextPage&&a.jsx("div",{className:"flex justify-center py-2",children:a.jsx(ft,{className:"h-5 w-5 animate-spin"})})]}),e.pageInfo.hasNextPage&&a.jsx(O,{onClick:D,disabled:s,className:"mt-2 w-full",children:s?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):"Load More Collections"}),!e.pageInfo.hasNextPage&&e.edges.length>0&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"All collections loaded."})]})]}),x&&a.jsx(q1e,{isOpen:m,onClose:A,product:x,onSave:E}),C&&a.jsx(K1e,{isOpen:v,onClose:P,collection:C,onSave:k})]})},X1e=()=>{var r,s;const{bigCommercePreviewSettings:t,isFetchingBigCommercePreviewData:e,bigCommerceImportError:n}=zn();return e&&!t?a.jsxs("div",{className:"flex items-center justify-center p-8",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin"})," ",a.jsx("span",{className:"ml-2",children:"Fetching store settings..."})]}):n&&!t?a.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error: ",n]}):t?a.jsxs(Je,{className:"w-full",children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Store Settings Preview (BigCommerce)"}),a.jsx(Qt,{children:"Review your BigCommerce store's basic information."})]}),a.jsxs(it,{className:"space-y-2",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Store Name:"})," ",t.storeName||"N/A"]}),((s=(r=t.logo)==null?void 0:r.image)==null?void 0:s.url)&&a.jsxs("div",{children:[a.jsx("strong",{children:"Logo:"}),a.jsx("img",{src:t.logo.image.url,alt:t.logo.image.altText||"Store Logo",className:"mt-2 max-w-xs max-h-24 object-contain border rounded"})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Store Hash:"})," ",t.storeHash||"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Status:"})," ",t.status||"N/A"]})]})]}):a.jsx("div",{className:"text-center p-4",children:"Connect to BigCommerce to see store settings, or settings are being fetched."})},Q1e=()=>{const{bigCommercePreviewProducts:t,fetchBigCommerceWizardProducts:e,isFetchingBigCommercePreviewData:n,bigCommerceImportError:r}=zn(),s=(t==null?void 0:t.items)||[];return n&&s.length===0?a.jsxs("div",{className:"flex items-center justify-center p-8",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin"})," ",a.jsx("span",{className:"ml-2",children:"Fetching products..."})]}):r&&s.length===0?a.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error fetching products: ",r]}):s.length===0?a.jsxs("div",{className:"text-center p-4",children:[a.jsx("p",{className:"mb-4",children:"No products loaded yet for BigCommerce."}),a.jsxs(O,{onClick:()=>e(10),disabled:n,children:[n?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Load Products Preview"]})]}):a.jsxs(Je,{className:"w-full",children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Products Preview (BigCommerce)"}),a.jsx(Qt,{children:"A sample of products from your BigCommerce store."})]}),a.jsxs(it,{children:[a.jsx("ul",{className:"space-y-2 max-h-96 overflow-y-auto",children:s.slice(0,10).map(i=>{var o,l,c,u,d;return a.jsxs("li",{className:"p-2 border rounded text-sm flex justify-between items-center",children:[a.jsxs("div",{children:[i.name," - ",(l=(o=i.prices)==null?void 0:o.price)==null?void 0:l.value," ",(u=(c=i.prices)==null?void 0:c.price)==null?void 0:u.currencyCode]}),((d=i.defaultImage)==null?void 0:d.url)&&a.jsx("img",{src:i.defaultImage.url,alt:i.defaultImage.altText||i.name,className:"w-12 h-12 object-cover rounded ml-2"})]},i.entityId)})}),s.length>10&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Showing 10 of ",s.length," products fetched for preview."]})]})]})},Z1e=({isOpen:t,onClose:e,initialImportSource:n="shopify"})=>{const r=bi(),[s,i]=p.useState(n),{shopifyWizardStep:o,setShopifyWizardStep:l,resetShopifyWizardState:c,shopifyPreviewMetadata:u,shopifyPreviewProducts:d,shopifyPreviewCollections:h,isFetchingShopifyPreviewData:f,shopifyImportError:m,fetchShopifyWizardProducts:g,fetchShopifyWizardCollections:x,finalizeShopifyImportFromWizard:w,shopifyWizardShouldShowGenerator:v,setShopifyWizardShouldShowGenerator:_,bigCommerceWizardStep:C,setBigCommerceWizardStep:T,resetBigCommerceWizardState:R,bigCommercePreviewSettings:A,bigCommercePreviewProducts:E,isFetchingBigCommercePreviewData:I,bigCommerceImportError:P,fetchBigCommerceWizardProducts:k,finalizeBigCommerceImportFromWizard:j,isGenerating:D,generateStoreFromWizard:M}=zn(),G={shopify:{wizardStep:o,setWizardStep:l,resetWizardState:c,previewMetadata:u,previewProducts:d,previewCollections:h,isFetchingPreviewData:f,importError:m,fetchWizardProducts:g,fetchWizardCollections:x,finalizeImportFromWizard:w,ConnectFormComponent:k1e,MetadataPreviewComponent:Y1e,ItemsPreviewComponent:J1e,wizardShouldShowGenerator:v,setWizardShouldShowGenerator:_,totalSteps:5},bigcommerce:{wizardStep:C,setWizardStep:T,resetWizardState:R,previewMetadata:A,previewProducts:E,isFetchingPreviewData:I,importError:P,fetchWizardProducts:k,finalizeImportFromWizard:j,ConnectFormComponent:R1e,MetadataPreviewComponent:X1e,ItemsPreviewComponent:Q1e,totalSteps:4}},B=G[s],{wizardStep:W,setWizardStep:Q,resetWizardState:H,previewMetadata:Y,previewProducts:V,previewCollections:$,isFetchingPreviewData:z,importError:F,fetchWizardProducts:Z,fetchWizardCollections:fe,finalizeImportFromWizard:xe,ConnectFormComponent:ge,MetadataPreviewComponent:Re,ItemsPreviewComponent:Ue,totalSteps:ze,wizardShouldShowGenerator:he,setWizardShouldShowGenerator:Ce}=B;if(p.useEffect(()=>{i(n),n==="shopify"&&G.bigcommerce.resetWizardState&&G.bigcommerce.resetWizardState(),n==="bigcommerce"&&G.shopify.resetWizardState&&G.shopify.resetWizardState()},[n,G.bigcommerce,G.shopify]),p.useEffect(()=>{t&&W===0&&Q(1),!t&&W!==0&&H()},[t,W,Q,H]),!t||W===0)return null;const Pe=async()=>{W<ze&&(s==="shopify"?W===2?((!V||V.edges.length===0)&&await Z(10),(!$||$.edges.length===0)&&await fe(10),Q(3)):W===3&&await xe():s==="bigcommerce"&&(W===1||(W===2?((!V||V.items.length===0)&&await Z(10),Q(3)):W===3&&await Me())))},ve=()=>{W>1&&Q(W-1)},de=()=>{H(),Ce&&Ce(!1),e&&e()},Me=async()=>{await xe()&&e&&e()},Ge=()=>{switch(W){case 1:return a.jsx(ge,{open:W===1,onOpenChange:Pt=>{Pt||de()},onSuccessfulConnect:Pt=>{s==="shopify"&&startShopifyImportWizard(Pt.domain,Pt.token)}});case 2:return a.jsx(Re,{});case 3:return a.jsx(Ue,{});case 4:return s==="shopify"&&he?a.jsx(TH,{isEmbedded:!0,onGenerationComplete:Pt=>{if(Pt&&(Pt.urlSlug||Pt.name)){const en=`/${Pt.urlSlug||pc(Pt.name)}`;r(en)}e&&e(),Ce&&Ce(!1)}}):a.jsx("div",{children:"Loading generator..."});default:return W===ze&&D?a.jsxs("div",{className:"flex flex-col items-center justify-center p-8",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin mb-4"})," ",a.jsx("p",{children:"Processing..."})]}):a.jsxs("div",{children:["Invalid Wizard Step or processing... (",W,")"]})}};if(W===1&&s==="shopify")return Ge();const yt=s==="shopify"?"Import from Shopify":s==="bigcommerce"?"Import from BigCommerce":"Import Store Data";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs(Je,{className:"w-full max-w-2xl mx-auto shadow-xl",children:[a.jsxs(ct,{children:[a.jsx(ut,{className:"text-2xl font-bold",children:W===1&&s==="bigcommerce"?"Connect to BigCommerce":yt}),a.jsx(Qt,{children:W===1&&s==="bigcommerce"?"Enter your store domain and API token.":W===4&&s==="shopify"?"Configure and generate your new store.":`Step ${W} of ${ze-1}`}),a.jsx("div",{className:"w-full bg-muted rounded-full h-2.5 mt-2",children:a.jsx(It.div,{className:"bg-primary h-2.5 rounded-full",initial:{width:"0%"},animate:{width:`${W/ze*100}%`},transition:{duration:.5,ease:"easeInOut"}})})]}),a.jsx(it,{className:"min-h-[250px] max-h-[60vh] overflow-y-auto flex items-center justify-center",children:Ge()}),a.jsxs(yd,{className:"flex justify-between",children:[W>1&&W!==4&&a.jsxs(O,{variant:"outline",onClick:de,disabled:D||z,children:[a.jsx(rw,{className:"mr-2 h-4 w-4"})," Cancel"]}),W===4&&s==="shopify"&&a.jsxs(O,{variant:"outline",onClick:de,disabled:D||z,children:[a.jsx(rw,{className:"mr-2 h-4 w-4"})," Cancel Import"]}),a.jsxs("div",{children:[W>1&&W<ze-1&&a.jsxs(O,{variant:"outline",onClick:ve,disabled:D||z,className:"mr-2",children:[a.jsx(Go,{className:"mr-2 h-4 w-4"})," Previous"]}),W===1&&s==="bigcommerce"&&a.jsxs(O,{onClick:Pe,disabled:D||z,children:["Next ",a.jsx(Mu,{className:"ml-2 h-4 w-4"})]}),W===2&&a.jsxs(O,{onClick:Pe,disabled:D||z,children:["Next ",a.jsx(Mu,{className:"ml-2 h-4 w-4"})]}),W===3&&a.jsxs(O,{onClick:Pe,disabled:D||z,children:[D?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Mu,{className:"ml-2 h-4 w-4"}),"Configure Store"]}),W===ze&&D&&a.jsxs(O,{disabled:!0,children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]})]})]})]})})},eIe=({onSelectSource:t,onClose:e})=>a.jsxs(Je,{className:"w-full max-w-md mx-auto relative",children:[" ",a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 text-muted-foreground hover:text-foreground",onClick:e,children:a.jsx(Ki,{className:"h-5 w-5"})}),a.jsxs(ct,{children:[a.jsx(ut,{children:"Import Store Data"}),a.jsxs(Qt,{className:"text-slate-500 dark:text-slate-400",children:[" ","Select your e-commerce platform to begin importing your store and product data."]})]}),a.jsx(it,{children:a.jsxs(Si,{defaultValue:"shopify",className:"w-full",children:[a.jsxs(ti,{className:"grid w-full grid-cols-2",children:[a.jsx(Ot,{value:"shopify",children:"Shopify"}),a.jsx(Ot,{value:"bigcommerce",children:"BigCommerce"})]}),a.jsxs(Vt,{value:"shopify",className:"mt-4",children:[a.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:[" ","Connect to your Shopify store to import your shop details, products, and collections."]}),a.jsx(O,{className:"w-full",onClick:()=>t("shopify"),children:"Connect Shopify"})]}),a.jsxs(Vt,{value:"bigcommerce",className:"mt-4",children:[a.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:[" ","Connect to your BigCommerce store to import your store settings and product catalog."]}),a.jsx(O,{className:"w-full",onClick:()=>t("bigcommerce"),children:"Connect BigCommerce"})]})]})}),a.jsx(yd,{children:a.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[" ","You will be guided through a few steps to connect and confirm the data to be imported."]})})]}),tIe=({onClose:t})=>a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-8 max-w-sm w-full text-center",children:[a.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800 dark:hover:text-gray-200",children:a.jsx(Ki,{size:24})}),a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create Unlimited Stores"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Sign up or log in to create more stores and unlock all features."}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx(sr,{to:"/auth",children:a.jsx(O,{size:"lg",className:"w-full",children:"Sign Up"})}),a.jsx(sr,{to:"/auth",children:a.jsx(O,{variant:"outline",size:"lg",className:"w-full",children:"Log In"})})]})]})}),nIe=()=>{var v;const t=xl(),[e,n]=p.useState(!1),[r,s]=p.useState(!1),[i,o]=p.useState(null),[l,c]=p.useState("ai-prompt"),[u,d]=p.useState(!1),{isAuthModalOpen:h,closeAuthModal:f}=zn(),m=()=>{n(!0)},g=()=>{n(!1)},x=_=>{o(_),n(!1),s(!0)},w=()=>{s(!1),o(null)};return p.useEffect(()=>{let _,C;return _=setInterval(()=>{d(!0),C=setTimeout(()=>{d(!1)},2500)},5e3),()=>{clearInterval(_),clearTimeout(C)}},[]),a.jsxs("div",{className:"min-h-screen flex flex-col bg-[#ededed] dark:bg-[#131314]",children:[" ",a.jsx(HA,{}),a.jsxs(It.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"flex-1 container mx-auto px-4 py-8",children:[a.jsxs(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-10",children:[a.jsx("h1",{className:`text-4xl md:text-5xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-gray-600 to-gray-200 dark:from-gray-500 dark:to-gray-300 ${u?"animate-shimmer bg-200%":"bg-auto"}`,children:"Start Fresh"}),a.jsxs("p",{className:"text-lg font-inter text-muted-foreground max-w-3xl mx-auto",children:["You can create a store 3 ways: ",a.jsx("br",{})," Prompt, Steps or Import."]})]}),a.jsxs(Si,{value:l,onValueChange:c,className:"w-full max-w-3xl mx-auto mb-12",children:[a.jsxs(ti,{className:"grid w-full grid-cols-2 md:grid-cols-3 mb-6",children:[a.jsxs(Ot,{value:"ai-prompt",children:[a.jsx("span",{className:"hidden sm:inline",children:"AI Prompt"}),a.jsx("span",{className:"sm:hidden",children:"AI Prompt"})]}),a.jsxs(Ot,{value:"wizard",children:[a.jsx("span",{className:"hidden sm:inline",children:"Step-by-Step"}),a.jsx("span",{className:"sm:hidden",children:"Steps"})]}),a.jsx(Ot,{value:"store-import",className:"hidden md:inline-flex",onClick:m,children:"Import Store"})]}),a.jsx(Vt,{value:"ai-prompt",children:a.jsx(r1e,{generatedImage:(v=t.state)==null?void 0:v.generatedImage})}),a.jsx(Vt,{value:"wizard",children:a.jsx(TH,{})}),a.jsxs(Vt,{value:"store-import",className:"text-center py-8",children:[" ",a.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Import data from Shopify or BigCommerce."})," ",a.jsxs(O,{onClick:m,variant:"default",size:"lg",children:[a.jsx(b2,{className:"mr-2 h-5 w-5"}),"Select Import Source"]})]})]}),a.jsxs("div",{className:"mb-8 flex justify-center md:hidden",children:[" ",a.jsxs(O,{onClick:m,variant:"outline",size:"lg",className:"w-full max-w-xs",children:[a.jsx(b2,{className:"mr-2 h-5 w-5"}),"Import Store Data"]})]}),a.jsx(A1e,{})]}),a.jsx("footer",{className:"mt-auto py-6 text-center text-sm text-muted-foreground",children:a.jsxs("p",{children:["© ",new Date().getFullYear()," FreshFront. All rights reserved."]})}),e&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx(eIe,{onSelectSource:x,onClose:g})}),i&&a.jsx(Z1e,{isOpen:r,onClose:w,initialImportSource:i}),h&&a.jsx(tIe,{onClose:f})]})};var l_="Popover",[IH,Yje]=_i(l_,[r_]),uy=r_(),[rIe,Jc]=IH(l_),NH=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!1}=t,l=uy(e),c=p.useRef(null),[u,d]=p.useState(!1),[h,f]=Oc({prop:r,defaultProp:s??!1,onChange:i,caller:l_});return a.jsx(eW,{...l,children:a.jsx(rIe,{scope:e,contentId:oc(),triggerRef:c,open:h,onOpenChange:f,onOpenToggle:p.useCallback(()=>f(m=>!m),[f]),hasCustomAnchor:u,onCustomAnchorAdd:p.useCallback(()=>d(!0),[]),onCustomAnchorRemove:p.useCallback(()=>d(!1),[]),modal:o,children:n})})};NH.displayName=l_;var PH="PopoverAnchor",sIe=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Jc(PH,n),i=uy(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=s;return p.useEffect(()=>(o(),()=>l()),[o,l]),a.jsx(OA,{...i,...r,ref:e})});sIe.displayName=PH;var AH="PopoverTrigger",kH=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Jc(AH,n),i=uy(n),o=yn(e,s.triggerRef),l=a.jsx(Yt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":LH(s.open),...r,ref:o,onClick:gt(t.onClick,s.onOpenToggle)});return s.hasCustomAnchor?l:a.jsx(OA,{asChild:!0,...i,children:l})});kH.displayName=AH;var XA="PopoverPortal",[iIe,oIe]=IH(XA,{forceMount:void 0}),RH=t=>{const{__scopePopover:e,forceMount:n,children:r,container:s}=t,i=Jc(XA,e);return a.jsx(iIe,{scope:e,forceMount:n,children:a.jsx(ws,{present:n||i.open,children:a.jsx(Cg,{asChild:!0,container:s,children:r})})})};RH.displayName=XA;var vf="PopoverContent",jH=p.forwardRef((t,e)=>{const n=oIe(vf,t.__scopePopover),{forceMount:r=n.forceMount,...s}=t,i=Jc(vf,t.__scopePopover);return a.jsx(ws,{present:r||i.open,children:i.modal?a.jsx(lIe,{...s,ref:e}):a.jsx(cIe,{...s,ref:e})})});jH.displayName=vf;var aIe=qu("PopoverContent.RemoveScroll"),lIe=p.forwardRef((t,e)=>{const n=Jc(vf,t.__scopePopover),r=p.useRef(null),s=yn(e,r),i=p.useRef(!1);return p.useEffect(()=>{const o=r.current;if(o)return V0(o)},[]),a.jsx(OI,{as:aIe,allowPinchZoom:!0,children:a.jsx(DH,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gt(t.onCloseAutoFocus,o=>{var l;o.preventDefault(),i.current||(l=n.triggerRef.current)==null||l.focus()}),onPointerDownOutside:gt(t.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:gt(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),cIe=p.forwardRef((t,e)=>{const n=Jc(vf,t.__scopePopover),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(DH,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),DH=p.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:d,...h}=t,f=Jc(vf,n),m=uy(n);return LI(),a.jsx(F0,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(Sg,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:d,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>f.onOpenChange(!1),children:a.jsx(tW,{"data-state":LH(f.open),role:"dialog",id:f.contentId,...m,...h,ref:e,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),MH="PopoverClose",uIe=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Jc(MH,n);return a.jsx(Yt.button,{type:"button",...r,ref:e,onClick:gt(t.onClick,()=>s.onOpenChange(!1))})});uIe.displayName=MH;var dIe="PopoverArrow",hIe=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=uy(n);return a.jsx(nW,{...s,...r,ref:e})});hIe.displayName=dIe;function LH(t){return t?"open":"closed"}var fIe=NH,mIe=kH,pIe=RH,FH=jH;const uF=fIe,dF=mIe,a1=p.forwardRef(({className:t,align:e="center",sideOffset:n=4,...r},s)=>a.jsx(pIe,{children:a.jsx(FH,{ref:s,align:e,sideOffset:n,className:Ct("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));a1.displayName=FH.displayName;const gIe=({store:t,onEdit:e,currentTemplate:n,onTemplateChange:r,availableTemplates:s=[]})=>{const i=bi(),{toast:o}=bs(),{viewMode:l,setViewMode:c,currentStore:u,updateStore:d,updateStoreTemplateVersion:h,user:f}=zn(),m=async()=>{if(!f||!f.email){o({title:"Authentication Error",description:"You must be logged in with a valid email to onboard with Stripe.",variant:"destructive"});return}o({title:"Redirecting to Stripe...",description:"Please wait while we connect you to Stripe for onboarding."});try{const R=Yw(),E=await Qa(R,"stripeCreateConnectAccount")({email:f.email}),{accountLinkUrl:I}=E.data;if(I)window.location.href=I;else throw new Error("Account link URL not returned from function.")}catch(R){console.error("Error creating Stripe Connect account link:",R),o({title:"Error",description:"Could not initiate Stripe onboarding. Please try again.",variant:"destructive"})}},g=async()=>{if(!(!u||!u.stripe_account_id)){o({title:"Generating Dashboard Link...",description:"Please wait while we connect you to Stripe."});try{const R=Yw(),E=await Qa(R,"stripeCreateLoginLink")({stripeAccountId:u.stripe_account_id}),{loginLinkUrl:I}=E.data;if(I)window.open(I,"_blank");else throw new Error("Login link URL not returned from function.")}catch(R){console.error("Error creating Stripe login link:",R),o({title:"Error",description:"Could not create a link to the Stripe dashboard. Please try again.",variant:"destructive"})}}},x=()=>{t&&t.name?(navigator.clipboard.writeText(`${window.location.origin}/${t.name}`),o({title:"Link Copied",description:"Store link has been copied to clipboard."})):o({title:"Error",description:"Could not copy link: Store name not available.",variant:"destructive"})},w=()=>{const R=l==="edit"?"published":"edit";c(R),o({title:`Switched to ${R==="published"?"Consumer View":"Admin View"}`,description:`Store is now in ${R==="published"?"consumer":"admin editing"} mode.`})},v=R=>{r&&r(R)},_=async R=>{let A=R;if(R==="classic"&&(A="v1"),t&&t.id&&A&&A!==t.template_version)try{await h(t.id,A),o({title:"Template Saved",description:`Store template successfully changed to ${R}.`,className:"bg-green-500 text-white"})}catch(E){console.error("Failed to save template:",E),o({title:"Save Failed",description:"Could not save the template change. Please try again.",variant:"destructive"})}else A===t.template_version&&o({title:"No Change",description:`Store is already using the ${R} template.`})},C=()=>{l!=="edit"&&c("edit"),e()},T=async()=>{if(t&&t.id)try{await d(t.id,{published_at:new Date().toISOString(),status:"published"}),o({title:"Store Published!",description:`${t.name} is now live.`,className:"bg-green-500 text-white"})}catch(R){console.error("Failed to publish store:",R),o({title:"Publish Failed",description:"Could not publish the store. Please try again.",variant:"destructive"})}};return l==="published"?a.jsx("button",{onClick:()=>c("edit"),className:"fixed bottom-4 left-4 p-2 z-50 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:"Open Admin Controls","aria-label":"Open Admin Controls",children:a.jsx(Nh,{className:"h-6 w-6 text-gray-500 opacity-50 hover:opacity-75 dark:text-gray-400"})}):a.jsx(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"fixed bottom-0 left-0 right-0 bg-background/80 backdrop-blur-md border-t z-50 py-3",children:a.jsxs("div",{className:"container mx-auto px-4 flex items-center justify-between overflow-x-auto",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O,{variant:"outline",size:"icon",className:"aspect-square",onClick:()=>i("/"),title:"Back",children:a.jsx(Go,{className:"h-4 w-4"})}),a.jsxs("div",{className:"hidden sm:flex items-center gap-1",children:[a.jsxs(gc,{value:n||"",onValueChange:v,children:[a.jsxs(Za,{className:"w-[180px] h-9 text-sm",children:[a.jsx(Qv,{className:"mr-2 h-4 w-4"}),a.jsx(yc,{placeholder:"Switch Template"})]}),a.jsx(el,{children:s.map(R=>a.jsx(rr,{value:R,children:R.charAt(0).toUpperCase()+R.slice(1)},R))})]}),n&&n!==(t==null?void 0:t.template_version)&&a.jsx(O,{variant:"outline",size:"icon",className:"h-9 w-9 border-green-500 text-green-500 hover:bg-green-50 hover:text-green-600",onClick:()=>_(n),title:`Save ${n.charAt(0).toUpperCase()+n.slice(1)} Template`,children:a.jsx(Ig,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"sm:hidden",children:a.jsxs(uF,{children:[a.jsx(dF,{asChild:!0,children:a.jsx(O,{variant:"outline",size:"icon",children:a.jsx(Qv,{className:"h-4 w-4"})})}),a.jsx(a1,{className:"w-48",children:a.jsx("div",{className:"grid gap-2",children:s.map(R=>a.jsx(O,{variant:n===R?"solid":"ghost",onClick:()=>v(R),className:"w-full justify-start",children:R.charAt(0).toUpperCase()+R.slice(1)},R))})})]})}),a.jsx(O,{variant:"outline",size:"icon",onClick:x,title:"Copy Link",children:a.jsx(RI,{className:"h-4 w-4"})}),u&&u.stripe_account_id?a.jsxs(O,{variant:"outline",size:"sm",onClick:g,children:[a.jsx("span",{className:"hidden sm:inline",children:"Dashboard"}),a.jsx(Jh,{className:"sm:ml-2 h-4 w-4"})]}):a.jsxs(uF,{children:[a.jsx(dF,{asChild:!0,children:a.jsxs(O,{variant:"outline",size:"sm",children:[a.jsx("span",{className:"hidden sm:inline",children:"Dashboard"}),a.jsx(Jh,{className:"sm:ml-2 h-4 w-4"})]})}),a.jsx(a1,{className:"w-80",children:a.jsxs("div",{className:"grid gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"font-medium leading-none",children:"No active business account"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect with Stripe to manage your payments and payouts."})]}),a.jsxs(O,{onClick:m,children:["Onboard with ",a.jsx("img",{src:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Stripelogo.PNG?alt=media&token=7b989f42-b2c9-4a3c-a7e1-9ed280b6a9ea",alt:"Stripe",className:"inline-block h-4 ml-2"})]})]})})]}),a.jsx(O,{asChild:!0,size:"sm",variant:"outline",disabled:!u||!u.name,children:a.jsxs(sr,{to:u&&u.name?`/${u.name}/content-creation`:"#",state:{storeData:u},children:[a.jsx(Er,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Create"})]})}),a.jsxs(O,{size:"sm",onClick:C,children:[a.jsx(ew,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),a.jsxs(O,{size:"sm",onClick:w,variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-50 hover:text-green-700",children:[a.jsx(Lie,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Customer"})]}),a.jsxs(O,{size:"sm",onClick:T,className:"bg-green-500 hover:bg-green-600 text-white hidden sm:flex",children:[a.jsx(Uo,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Publish"})]})]})]})})},yIe=({store:t,open:e,onOpenChange:n})=>{var h;bi();const{updateStore:r,isLoadingStores:s}=zn(),[i,o]=p.useState({name:t.name,description:t.description,type:t.type,theme:{primaryColor:t.theme.primaryColor,secondaryColor:t.theme.secondaryColor,fontFamily:t.theme.fontFamily,layout:t.theme.layout},settings:{showThemeToggle:((h=t.settings)==null?void 0:h.showThemeToggle)??!0}}),l=f=>{const{name:m,value:g}=f.target;o(x=>({...x,[m]:g}))},c=(f,m)=>{o(g=>({...g,theme:{...g.theme,[f]:m}}))},u=(f,m)=>{o(g=>({...g,settings:{...g.settings,[f]:m}}))},d=f=>{f.preventDefault();const m={name:i.name,description:i.description,type:i.type,theme:i.theme,settings:i.settings};r(t.id,m),n(!1)};return a.jsx(Xr,{open:e,onOpenChange:n,children:a.jsxs(Ur,{className:"sm:max-w-[600px] max-h-[85vh] overflow-y-auto",children:[a.jsxs(Br,{children:[a.jsx(zr,{children:"Edit Store"}),a.jsx(Zi,{children:"Customize your store's details and appearance."})]}),a.jsxs("form",{onSubmit:d,className:"space-y-6 py-4",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"name",children:"Store Name"}),a.jsx(Ye,{id:"name",name:"name",value:i.name,onChange:l,required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"description",children:"Description"}),a.jsx(Pn,{id:"description",name:"description",value:i.description,onChange:l,rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"type",children:"Store Type"}),a.jsxs(gc,{value:i.type,onValueChange:f=>o(m=>({...m,type:f})),children:[a.jsx(Za,{id:"type",children:a.jsx(yc,{placeholder:"Select store type"})}),a.jsxs(el,{children:[a.jsx(rr,{value:"fashion",children:"Fashion"}),a.jsx(rr,{value:"electronics",children:"Electronics"}),a.jsx(rr,{value:"food",children:"Food"}),a.jsx(rr,{value:"jewelry",children:"Jewelry"}),a.jsx(rr,{value:"general",children:"General"})]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-sm font-medium",children:"Theme Settings"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"primaryColor",children:"Primary Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{id:"primaryColor",name:"primaryColor",type:"color",value:i.theme.primaryColor,onChange:f=>c("primaryColor",f.target.value),className:"w-12 h-10 p-1"}),a.jsx(Ye,{value:i.theme.primaryColor,onChange:f=>c("primaryColor",f.target.value),className:"flex-1"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"secondaryColor",children:"Secondary Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{id:"secondaryColor",name:"secondaryColor",type:"color",value:i.theme.secondaryColor,onChange:f=>c("secondaryColor",f.target.value),className:"w-12 h-10 p-1"}),a.jsx(Ye,{value:i.theme.secondaryColor,onChange:f=>c("secondaryColor",f.target.value),className:"flex-1"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"fontFamily",children:"Font Family"}),a.jsxs(gc,{value:i.theme.fontFamily,onValueChange:f=>c("fontFamily",f),children:[a.jsx(Za,{id:"fontFamily",children:a.jsx(yc,{placeholder:"Select font"})}),a.jsxs(el,{children:[a.jsx(rr,{value:"Inter",children:"Inter"}),a.jsx(rr,{value:"Roboto",children:"Roboto"}),a.jsx(rr,{value:"Poppins",children:"Poppins"}),a.jsx(rr,{value:"Montserrat",children:"Montserrat"}),a.jsx(rr,{value:"Open Sans",children:"Open Sans"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"layout",children:"Layout Style"}),a.jsxs(gc,{value:i.theme.layout,onValueChange:f=>c("layout",f),children:[a.jsx(Za,{id:"layout",children:a.jsx(yc,{placeholder:"Select layout"})}),a.jsxs(el,{children:[a.jsx(rr,{value:"grid",children:"Grid"}),a.jsx(rr,{value:"list",children:"List"}),a.jsx(rr,{value:"masonry",children:"Masonry"}),a.jsx(rr,{value:"carousel",children:"Carousel"})]})]})]}),a.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[a.jsx(De,{htmlFor:"showThemeToggle",className:"flex items-center",children:"Show Light/Dark Mode Toggle in Store Header"}),a.jsx(Oo,{id:"showThemeToggle",checked:i.settings.showThemeToggle,onCheckedChange:f=>u("showThemeToggle",f),disabled:s}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Allows customers to switch between light and dark themes on your store page."})]})]})]})]}),a.jsx(Ar,{children:a.jsx(O,{type:"submit",disabled:s,children:"Save Changes"})})]})]})})};function xIe(t,e){const n=e||{};return(t[t.length-1]===""?[...t,""]:t).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const vIe=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,wIe=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,bIe={};function hF(t,e){return((e||bIe).jsx?wIe:vIe).test(t)}const _Ie=/[ \t\n\f\r]/g;function SIe(t){return typeof t=="object"?t.type==="text"?fF(t.value):!1:fF(t)}function fF(t){return t.replace(_Ie,"")===""}class dy{constructor(e,n,r){this.normal=n,this.property=e,r&&(this.space=r)}}dy.prototype.normal={};dy.prototype.property={};dy.prototype.space=void 0;function OH(t,e){const n={},r={};for(const s of t)Object.assign(n,s.property),Object.assign(r,s.normal);return new dy(n,r,e)}function l1(t){return t.toLowerCase()}class Ci{constructor(e,n){this.attribute=n,this.property=e}}Ci.prototype.attribute="";Ci.prototype.booleanish=!1;Ci.prototype.boolean=!1;Ci.prototype.commaOrSpaceSeparated=!1;Ci.prototype.commaSeparated=!1;Ci.prototype.defined=!1;Ci.prototype.mustUseProperty=!1;Ci.prototype.number=!1;Ci.prototype.overloadedBoolean=!1;Ci.prototype.property="";Ci.prototype.spaceSeparated=!1;Ci.prototype.space=void 0;let CIe=0;const nn=_d(),Or=_d(),c1=_d(),et=_d(),Kn=_d(),Vh=_d(),Ri=_d();function _d(){return 2**++CIe}const u1=Object.freeze(Object.defineProperty({__proto__:null,boolean:nn,booleanish:Or,commaOrSpaceSeparated:Ri,commaSeparated:Vh,number:et,overloadedBoolean:c1,spaceSeparated:Kn},Symbol.toStringTag,{value:"Module"})),nC=Object.keys(u1);class QA extends Ci{constructor(e,n,r,s){let i=-1;if(super(e,n),mF(this,"space",s),typeof r=="number")for(;++i<nC.length;){const o=nC[i];mF(this,nC[i],(r&u1[o])===u1[o])}}}QA.prototype.defined=!0;function mF(t,e,n){n&&(t[e]=n)}function Ff(t){const e={},n={};for(const[r,s]of Object.entries(t.properties)){const i=new QA(r,t.transform(t.attributes||{},r),s,t.space);t.mustUseProperty&&t.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),e[r]=i,n[l1(r)]=r,n[l1(i.attribute)]=r}return new dy(e,n,t.space)}const VH=Ff({properties:{ariaActiveDescendant:null,ariaAtomic:Or,ariaAutoComplete:null,ariaBusy:Or,ariaChecked:Or,ariaColCount:et,ariaColIndex:et,ariaColSpan:et,ariaControls:Kn,ariaCurrent:null,ariaDescribedBy:Kn,ariaDetails:null,ariaDisabled:Or,ariaDropEffect:Kn,ariaErrorMessage:null,ariaExpanded:Or,ariaFlowTo:Kn,ariaGrabbed:Or,ariaHasPopup:null,ariaHidden:Or,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Kn,ariaLevel:et,ariaLive:null,ariaModal:Or,ariaMultiLine:Or,ariaMultiSelectable:Or,ariaOrientation:null,ariaOwns:Kn,ariaPlaceholder:null,ariaPosInSet:et,ariaPressed:Or,ariaReadOnly:Or,ariaRelevant:null,ariaRequired:Or,ariaRoleDescription:Kn,ariaRowCount:et,ariaRowIndex:et,ariaRowSpan:et,ariaSelected:Or,ariaSetSize:et,ariaSort:null,ariaValueMax:et,ariaValueMin:et,ariaValueNow:et,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function $H(t,e){return e in t?t[e]:e}function UH(t,e){return $H(t,e.toLowerCase())}const EIe=Ff({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Vh,acceptCharset:Kn,accessKey:Kn,action:null,allow:null,allowFullScreen:nn,allowPaymentRequest:nn,allowUserMedia:nn,alt:null,as:null,async:nn,autoCapitalize:null,autoComplete:Kn,autoFocus:nn,autoPlay:nn,blocking:Kn,capture:null,charSet:null,checked:nn,cite:null,className:Kn,cols:et,colSpan:null,content:null,contentEditable:Or,controls:nn,controlsList:Kn,coords:et|Vh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:nn,defer:nn,dir:null,dirName:null,disabled:nn,download:c1,draggable:Or,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:nn,formTarget:null,headers:Kn,height:et,hidden:c1,high:et,href:null,hrefLang:null,htmlFor:Kn,httpEquiv:Kn,id:null,imageSizes:null,imageSrcSet:null,inert:nn,inputMode:null,integrity:null,is:null,isMap:nn,itemId:null,itemProp:Kn,itemRef:Kn,itemScope:nn,itemType:Kn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:nn,low:et,manifest:null,max:null,maxLength:et,media:null,method:null,min:null,minLength:et,multiple:nn,muted:nn,name:null,nonce:null,noModule:nn,noValidate:nn,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:nn,optimum:et,pattern:null,ping:Kn,placeholder:null,playsInline:nn,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:nn,referrerPolicy:null,rel:Kn,required:nn,reversed:nn,rows:et,rowSpan:et,sandbox:Kn,scope:null,scoped:nn,seamless:nn,selected:nn,shadowRootClonable:nn,shadowRootDelegatesFocus:nn,shadowRootMode:null,shape:null,size:et,sizes:null,slot:null,span:et,spellCheck:Or,src:null,srcDoc:null,srcLang:null,srcSet:null,start:et,step:null,style:null,tabIndex:et,target:null,title:null,translate:null,type:null,typeMustMatch:nn,useMap:null,value:Or,width:et,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Kn,axis:null,background:null,bgColor:null,border:et,borderColor:null,bottomMargin:et,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:nn,declare:nn,event:null,face:null,frame:null,frameBorder:null,hSpace:et,leftMargin:et,link:null,longDesc:null,lowSrc:null,marginHeight:et,marginWidth:et,noResize:nn,noHref:nn,noShade:nn,noWrap:nn,object:null,profile:null,prompt:null,rev:null,rightMargin:et,rules:null,scheme:null,scrolling:Or,standby:null,summary:null,text:null,topMargin:et,valueType:null,version:null,vAlign:null,vLink:null,vSpace:et,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:nn,disableRemotePlayback:nn,prefix:null,property:null,results:et,security:null,unselectable:null},space:"html",transform:UH}),TIe=Ff({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ri,accentHeight:et,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:et,amplitude:et,arabicForm:null,ascent:et,attributeName:null,attributeType:null,azimuth:et,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:et,by:null,calcMode:null,capHeight:et,className:Kn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:et,diffuseConstant:et,direction:null,display:null,dur:null,divisor:et,dominantBaseline:null,download:nn,dx:null,dy:null,edgeMode:null,editable:null,elevation:et,enableBackground:null,end:null,event:null,exponent:et,externalResourcesRequired:null,fill:null,fillOpacity:et,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Vh,g2:Vh,glyphName:Vh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:et,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:et,horizOriginX:et,horizOriginY:et,id:null,ideographic:et,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:et,k:et,k1:et,k2:et,k3:et,k4:et,kernelMatrix:Ri,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:et,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:et,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:et,overlineThickness:et,paintOrder:null,panose1:null,path:null,pathLength:et,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Kn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:et,pointsAtY:et,pointsAtZ:et,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ri,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ri,rev:Ri,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ri,requiredFeatures:Ri,requiredFonts:Ri,requiredFormats:Ri,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:et,specularExponent:et,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:et,strikethroughThickness:et,string:null,stroke:null,strokeDashArray:Ri,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:et,strokeOpacity:et,strokeWidth:null,style:null,surfaceScale:et,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ri,tabIndex:et,tableValues:null,target:null,targetX:et,targetY:et,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ri,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:et,underlineThickness:et,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:et,values:null,vAlphabetic:et,vMathematical:et,vectorEffect:null,vHanging:et,vIdeographic:et,version:null,vertAdvY:et,vertOriginX:et,vertOriginY:et,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:et,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:$H}),BH=Ff({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),zH=Ff({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:UH}),GH=Ff({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),IIe={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},NIe=/[A-Z]/g,pF=/-[a-z]/g,PIe=/^data[-\w.:]+$/i;function AIe(t,e){const n=l1(e);let r=e,s=Ci;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&PIe.test(e)){if(e.charAt(4)==="-"){const i=e.slice(5).replace(pF,RIe);r="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=e.slice(4);if(!pF.test(i)){let o=i.replace(NIe,kIe);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}s=QA}return new s(r,e)}function kIe(t){return"-"+t.toLowerCase()}function RIe(t){return t.charAt(1).toUpperCase()}const jIe=OH([VH,EIe,BH,zH,GH],"html"),ZA=OH([VH,TIe,BH,zH,GH],"svg");function DIe(t){return t.join(" ").trim()}var ek={},gF=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,MIe=/\n/g,LIe=/^\s*/,FIe=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,OIe=/^:\s*/,VIe=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,$Ie=/^[;\s]*/,UIe=/^\s+|\s+$/g,BIe=`
`,yF="/",xF="*",bu="",zIe="comment",GIe="declaration",WIe=function(t,e){if(typeof t!="string")throw new TypeError("First argument must be a string");if(!t)return[];e=e||{};var n=1,r=1;function s(g){var x=g.match(MIe);x&&(n+=x.length);var w=g.lastIndexOf(BIe);r=~w?g.length-w:r+g.length}function i(){var g={line:n,column:r};return function(x){return x.position=new o(g),u(),x}}function o(g){this.start=g,this.end={line:n,column:r},this.source=e.source}o.prototype.content=t;function l(g){var x=new Error(e.source+":"+n+":"+r+": "+g);if(x.reason=g,x.filename=e.source,x.line=n,x.column=r,x.source=t,!e.silent)throw x}function c(g){var x=g.exec(t);if(x){var w=x[0];return s(w),t=t.slice(w.length),x}}function u(){c(LIe)}function d(g){var x;for(g=g||[];x=h();)x!==!1&&g.push(x);return g}function h(){var g=i();if(!(yF!=t.charAt(0)||xF!=t.charAt(1))){for(var x=2;bu!=t.charAt(x)&&(xF!=t.charAt(x)||yF!=t.charAt(x+1));)++x;if(x+=2,bu===t.charAt(x-1))return l("End of comment missing");var w=t.slice(2,x-2);return r+=2,s(w),t=t.slice(x),r+=2,g({type:zIe,comment:w})}}function f(){var g=i(),x=c(FIe);if(x){if(h(),!c(OIe))return l("property missing ':'");var w=c(VIe),v=g({type:GIe,property:vF(x[0].replace(gF,bu)),value:w?vF(w[0].replace(gF,bu)):bu});return c($Ie),v}}function m(){var g=[];d(g);for(var x;x=f();)x!==!1&&(g.push(x),d(g));return g}return u(),m()};function vF(t){return t?t.replace(UIe,bu):bu}var HIe=bv&&bv.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ek,"__esModule",{value:!0});ek.default=KIe;var qIe=HIe(WIe);function KIe(t,e){var n=null;if(!t||typeof t!="string")return n;var r=(0,qIe.default)(t),s=typeof e=="function";return r.forEach(function(i){if(i.type==="declaration"){var o=i.property,l=i.value;s?e(o,l,i):l&&(n=n||{},n[o]=l)}}),n}var c_={};Object.defineProperty(c_,"__esModule",{value:!0});c_.camelCase=void 0;var YIe=/^--[a-zA-Z0-9_-]+$/,JIe=/-([a-z])/g,XIe=/^[^-]+$/,QIe=/^-(webkit|moz|ms|o|khtml)-/,ZIe=/^-(ms)-/,eNe=function(t){return!t||XIe.test(t)||YIe.test(t)},tNe=function(t,e){return e.toUpperCase()},wF=function(t,e){return"".concat(e,"-")},nNe=function(t,e){return e===void 0&&(e={}),eNe(t)?t:(t=t.toLowerCase(),e.reactCompat?t=t.replace(ZIe,wF):t=t.replace(QIe,wF),t.replace(JIe,tNe))};c_.camelCase=nNe;var rNe=bv&&bv.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},sNe=rNe(ek),iNe=c_;function d1(t,e){var n={};return!t||typeof t!="string"||(0,sNe.default)(t,function(r,s){r&&s&&(n[(0,iNe.camelCase)(r,e)]=s)}),n}d1.default=d1;var oNe=d1;const aNe=o0(oNe),WH=HH("end"),tk=HH("start");function HH(t){return e;function e(n){const r=n&&n.position&&n.position[t]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function lNe(t){const e=tk(t),n=WH(t);if(e&&n)return{start:e,end:n}}function yp(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?bF(t.position):"start"in t||"end"in t?bF(t):"line"in t||"column"in t?h1(t):""}function h1(t){return _F(t&&t.line)+":"+_F(t&&t.column)}function bF(t){return h1(t&&t.start)+"-"+h1(t&&t.end)}function _F(t){return t&&typeof t=="number"?t:1}class Vs extends Error{constructor(e,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let s="",i={},o=!1;if(n&&("line"in n&&"column"in n?i={place:n}:"start"in n&&"end"in n?i={place:n}:"type"in n?i={ancestors:[n],place:n.position}:i={...n}),typeof e=="string"?s=e:!i.cause&&e&&(o=!0,s=e.message,i.cause=e),!i.ruleId&&!i.source&&typeof r=="string"){const c=r.indexOf(":");c===-1?i.ruleId=r:(i.source=r.slice(0,c),i.ruleId=r.slice(c+1))}if(!i.place&&i.ancestors&&i.ancestors){const c=i.ancestors[i.ancestors.length-1];c&&(i.place=c.position)}const l=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=l?l.line:void 0,this.name=yp(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=o&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}Vs.prototype.file="";Vs.prototype.name="";Vs.prototype.reason="";Vs.prototype.message="";Vs.prototype.stack="";Vs.prototype.column=void 0;Vs.prototype.line=void 0;Vs.prototype.ancestors=void 0;Vs.prototype.cause=void 0;Vs.prototype.fatal=void 0;Vs.prototype.place=void 0;Vs.prototype.ruleId=void 0;Vs.prototype.source=void 0;const nk={}.hasOwnProperty,cNe=new Map,uNe=/[A-Z]/g,dNe=new Set(["table","tbody","thead","tfoot","tr"]),hNe=new Set(["td","th"]),qH="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function fNe(t,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=bNe(n,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=wNe(n,e.jsx,e.jsxs)}const s={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?ZA:jIe,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},i=KH(s,t,void 0);return i&&typeof i!="string"?i:s.create(t,s.Fragment,{children:i||void 0},void 0)}function KH(t,e,n){if(e.type==="element")return mNe(t,e,n);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return pNe(t,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return yNe(t,e,n);if(e.type==="mdxjsEsm")return gNe(t,e);if(e.type==="root")return xNe(t,e,n);if(e.type==="text")return vNe(t,e)}function mNe(t,e,n){const r=t.schema;let s=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(s=ZA,t.schema=s),t.ancestors.push(e);const i=JH(t,e.tagName,!1),o=_Ne(t,e);let l=sk(t,e);return dNe.has(e.tagName)&&(l=l.filter(function(c){return typeof c=="string"?!SIe(c):!0})),YH(t,o,i,e),rk(o,l),t.ancestors.pop(),t.schema=r,t.create(e,i,o,n)}function pNe(t,e){if(e.data&&e.data.estree&&t.evaluater){const r=e.data.estree.body[0];return r.type,t.evaluater.evaluateExpression(r.expression)}gg(t,e.position)}function gNe(t,e){if(e.data&&e.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(e.data.estree);gg(t,e.position)}function yNe(t,e,n){const r=t.schema;let s=r;e.name==="svg"&&r.space==="html"&&(s=ZA,t.schema=s),t.ancestors.push(e);const i=e.name===null?t.Fragment:JH(t,e.name,!0),o=SNe(t,e),l=sk(t,e);return YH(t,o,i,e),rk(o,l),t.ancestors.pop(),t.schema=r,t.create(e,i,o,n)}function xNe(t,e,n){const r={};return rk(r,sk(t,e)),t.create(e,t.Fragment,r,n)}function vNe(t,e){return e.value}function YH(t,e,n,r){typeof n!="string"&&n!==t.Fragment&&t.passNode&&(e.node=r)}function rk(t,e){if(e.length>0){const n=e.length>1?e:e[0];n&&(t.children=n)}}function wNe(t,e,n){return r;function r(s,i,o,l){const u=Array.isArray(o.children)?n:e;return l?u(i,o,l):u(i,o)}}function bNe(t,e){return n;function n(r,s,i,o){const l=Array.isArray(i.children),c=tk(r);return e(s,i,o,l,{columnNumber:c?c.column-1:void 0,fileName:t,lineNumber:c?c.line:void 0},void 0)}}function _Ne(t,e){const n={};let r,s;for(s in e.properties)if(s!=="children"&&nk.call(e.properties,s)){const i=CNe(t,s,e.properties[s]);if(i){const[o,l]=i;t.tableCellAlignToStyle&&o==="align"&&typeof l=="string"&&hNe.has(e.tagName)?r=l:n[o]=l}}if(r){const i=n.style||(n.style={});i[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function SNe(t,e){const n={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&t.evaluater){const i=r.data.estree.body[0];i.type;const o=i.expression;o.type;const l=o.properties[0];l.type,Object.assign(n,t.evaluater.evaluateExpression(l.argument))}else gg(t,e.position);else{const s=r.name;let i;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&t.evaluater){const l=r.value.data.estree.body[0];l.type,i=t.evaluater.evaluateExpression(l.expression)}else gg(t,e.position);else i=r.value===null?!0:r.value;n[s]=i}return n}function sk(t,e){const n=[];let r=-1;const s=t.passKeys?new Map:cNe;for(;++r<e.children.length;){const i=e.children[r];let o;if(t.passKeys){const c=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(c){const u=s.get(c)||0;o=c+"-"+u,s.set(c,u+1)}}const l=KH(t,i,o);l!==void 0&&n.push(l)}return n}function CNe(t,e,n){const r=AIe(t.schema,e);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?xIe(n):DIe(n)),r.property==="style"){let s=typeof n=="object"?n:ENe(t,String(n));return t.stylePropertyNameCase==="css"&&(s=TNe(s)),["style",s]}return[t.elementAttributeNameCase==="react"&&r.space?IIe[r.property]||r.property:r.attribute,n]}}function ENe(t,e){try{return aNe(e,{reactCompat:!0})}catch(n){if(t.ignoreInvalidStyle)return{};const r=n,s=new Vs("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw s.file=t.filePath||void 0,s.url=qH+"#cannot-parse-style-attribute",s}}function JH(t,e,n){let r;if(!n)r={type:"Literal",value:e};else if(e.includes(".")){const s=e.split(".");let i=-1,o;for(;++i<s.length;){const l=hF(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};o=o?{type:"MemberExpression",object:o,property:l,computed:!!(i&&l.type==="Literal"),optional:!1}:l}r=o}else r=hF(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const s=r.value;return nk.call(t.components,s)?t.components[s]:s}if(t.evaluater)return t.evaluater.evaluateExpression(r);gg(t)}function gg(t,e){const n=new Vs("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=t.filePath||void 0,n.url=qH+"#cannot-handle-mdx-estrees-without-createevaluater",n}function TNe(t){const e={};let n;for(n in t)nk.call(t,n)&&(e[INe(n)]=t[n]);return e}function INe(t){let e=t.replace(uNe,NNe);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function NNe(t){return"-"+t.toLowerCase()}const rC={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},PNe={};function ANe(t,e){const n=e||PNe,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,s=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return XH(t,r,s)}function XH(t,e,n){if(kNe(t)){if("value"in t)return t.type==="html"&&!n?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return SF(t.children,e,n)}return Array.isArray(t)?SF(t,e,n):""}function SF(t,e,n){const r=[];let s=-1;for(;++s<t.length;)r[s]=XH(t[s],e,n);return r.join("")}function kNe(t){return!!(t&&typeof t=="object")}const CF=document.createElement("i");function ik(t){const e="&"+t+";";CF.innerHTML=e;const n=CF.textContent;return n.charCodeAt(n.length-1)===59&&t!=="semi"||n===e?!1:n}function Ia(t,e,n,r){const s=t.length;let i=0,o;if(e<0?e=-e>s?0:s+e:e=e>s?s:e,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(e,n),t.splice(...o);else for(n&&t.splice(e,n);i<r.length;)o=r.slice(i,i+1e4),o.unshift(e,0),t.splice(...o),i+=1e4,e+=1e4}function ao(t,e){return t.length>0?(Ia(t,t.length,0,e),t):e}const EF={}.hasOwnProperty;function RNe(t){const e={};let n=-1;for(;++n<t.length;)jNe(e,t[n]);return e}function jNe(t,e){let n;for(n in e){const s=(EF.call(t,n)?t[n]:void 0)||(t[n]={}),i=e[n];let o;if(i)for(o in i){EF.call(s,o)||(s[o]=[]);const l=i[o];DNe(s[o],Array.isArray(l)?l:l?[l]:[])}}}function DNe(t,e){let n=-1;const r=[];for(;++n<e.length;)(e[n].add==="after"?t:r).push(e[n]);Ia(t,0,0,r)}function QH(t,e){const n=Number.parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"�":String.fromCodePoint(n)}function $h(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const la=Xc(/[A-Za-z]/),Gi=Xc(/[\dA-Za-z]/),MNe=Xc(/[#-'*+\--9=?A-Z^-~]/);function f1(t){return t!==null&&(t<32||t===127)}const m1=Xc(/\d/),LNe=Xc(/[\dA-Fa-f]/),FNe=Xc(/[!-/:-@[-`{-~]/);function Kt(t){return t!==null&&t<-2}function vi(t){return t!==null&&(t<0||t===32)}function Sn(t){return t===-2||t===-1||t===32}const ONe=Xc(/\p{P}|\p{S}/u),VNe=Xc(/\s/);function Xc(t){return e;function e(n){return n!==null&&n>-1&&t.test(String.fromCharCode(n))}}function Of(t){const e=[];let n=-1,r=0,s=0;for(;++n<t.length;){const i=t.charCodeAt(n);let o="";if(i===37&&Gi(t.charCodeAt(n+1))&&Gi(t.charCodeAt(n+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(o=String.fromCharCode(i));else if(i>55295&&i<57344){const l=t.charCodeAt(n+1);i<56320&&l>56319&&l<57344?(o=String.fromCharCode(i,l),s=1):o="�"}else o=String.fromCharCode(i);o&&(e.push(t.slice(r,n),encodeURIComponent(o)),r=n+s+1,o=""),s&&(n+=s,s=0)}return e.join("")+t.slice(r)}function Xn(t,e,n,r){const s=r?r-1:Number.POSITIVE_INFINITY;let i=0;return o;function o(c){return Sn(c)?(t.enter(n),l(c)):e(c)}function l(c){return Sn(c)&&i++<s?(t.consume(c),l):(t.exit(n),e(c))}}const $Ne={tokenize:UNe};function UNe(t){const e=t.attempt(this.parser.constructs.contentInitial,r,s);let n;return e;function r(l){if(l===null){t.consume(l);return}return t.enter("lineEnding"),t.consume(l),t.exit("lineEnding"),Xn(t,e,"linePrefix")}function s(l){return t.enter("paragraph"),i(l)}function i(l){const c=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=c),n=c,o(l)}function o(l){if(l===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(l);return}return Kt(l)?(t.consume(l),t.exit("chunkText"),i):(t.consume(l),o)}}const BNe={tokenize:zNe},TF={tokenize:GNe};function zNe(t){const e=this,n=[];let r=0,s,i,o;return l;function l(C){if(r<n.length){const T=n[r];return e.containerState=T[1],t.attempt(T[0].continuation,c,u)(C)}return u(C)}function c(C){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,s&&_();const T=e.events.length;let R=T,A;for(;R--;)if(e.events[R][0]==="exit"&&e.events[R][1].type==="chunkFlow"){A=e.events[R][1].end;break}v(r);let E=T;for(;E<e.events.length;)e.events[E][1].end={...A},E++;return Ia(e.events,R+1,0,e.events.slice(T)),e.events.length=E,u(C)}return l(C)}function u(C){if(r===n.length){if(!s)return f(C);if(s.currentConstruct&&s.currentConstruct.concrete)return g(C);e.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(TF,d,h)(C)}function d(C){return s&&_(),v(r),f(C)}function h(C){return e.parser.lazy[e.now().line]=r!==n.length,o=e.now().offset,g(C)}function f(C){return e.containerState={},t.attempt(TF,m,g)(C)}function m(C){return r++,n.push([e.currentConstruct,e.containerState]),f(C)}function g(C){if(C===null){s&&_(),v(0),t.consume(C);return}return s=s||e.parser.flow(e.now()),t.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),x(C)}function x(C){if(C===null){w(t.exit("chunkFlow"),!0),v(0),t.consume(C);return}return Kt(C)?(t.consume(C),w(t.exit("chunkFlow")),r=0,e.interrupt=void 0,l):(t.consume(C),x)}function w(C,T){const R=e.sliceStream(C);if(T&&R.push(null),C.previous=i,i&&(i.next=C),i=C,s.defineSkip(C.start),s.write(R),e.parser.lazy[C.start.line]){let A=s.events.length;for(;A--;)if(s.events[A][1].start.offset<o&&(!s.events[A][1].end||s.events[A][1].end.offset>o))return;const E=e.events.length;let I=E,P,k;for(;I--;)if(e.events[I][0]==="exit"&&e.events[I][1].type==="chunkFlow"){if(P){k=e.events[I][1].end;break}P=!0}for(v(r),A=E;A<e.events.length;)e.events[A][1].end={...k},A++;Ia(e.events,I+1,0,e.events.slice(E)),e.events.length=A}}function v(C){let T=n.length;for(;T-- >C;){const R=n[T];e.containerState=R[1],R[0].exit.call(e,t)}n.length=C}function _(){s.write([null]),i=void 0,s=void 0,e.containerState._closeFlow=void 0}}function GNe(t,e,n){return Xn(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function IF(t){if(t===null||vi(t)||VNe(t))return 1;if(ONe(t))return 2}function ok(t,e,n){const r=[];let s=-1;for(;++s<t.length;){const i=t[s].resolveAll;i&&!r.includes(i)&&(e=i(e,n),r.push(i))}return e}const p1={name:"attention",resolveAll:WNe,tokenize:HNe};function WNe(t,e){let n=-1,r,s,i,o,l,c,u,d;for(;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(r=n;r--;)if(t[r][0]==="exit"&&t[r][1].type==="attentionSequence"&&t[r][1]._open&&e.sliceSerialize(t[r][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[r][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[r][1].end.offset-t[r][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;c=t[r][1].end.offset-t[r][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1;const h={...t[r][1].end},f={...t[n][1].start};NF(h,-c),NF(f,c),o={type:c>1?"strongSequence":"emphasisSequence",start:h,end:{...t[r][1].end}},l={type:c>1?"strongSequence":"emphasisSequence",start:{...t[n][1].start},end:f},i={type:c>1?"strongText":"emphasisText",start:{...t[r][1].end},end:{...t[n][1].start}},s={type:c>1?"strong":"emphasis",start:{...o.start},end:{...l.end}},t[r][1].end={...o.start},t[n][1].start={...l.end},u=[],t[r][1].end.offset-t[r][1].start.offset&&(u=ao(u,[["enter",t[r][1],e],["exit",t[r][1],e]])),u=ao(u,[["enter",s,e],["enter",o,e],["exit",o,e],["enter",i,e]]),u=ao(u,ok(e.parser.constructs.insideSpan.null,t.slice(r+1,n),e)),u=ao(u,[["exit",i,e],["enter",l,e],["exit",l,e],["exit",s,e]]),t[n][1].end.offset-t[n][1].start.offset?(d=2,u=ao(u,[["enter",t[n][1],e],["exit",t[n][1],e]])):d=0,Ia(t,r-1,n-r+3,u),n=r+u.length-d-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function HNe(t,e){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,s=IF(r);let i;return o;function o(c){return i=c,t.enter("attentionSequence"),l(c)}function l(c){if(c===i)return t.consume(c),l;const u=t.exit("attentionSequence"),d=IF(c),h=!d||d===2&&s||n.includes(c),f=!s||s===2&&d||n.includes(r);return u._open=!!(i===42?h:h&&(s||!f)),u._close=!!(i===42?f:f&&(d||!h)),e(c)}}function NF(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const qNe={name:"autolink",tokenize:KNe};function KNe(t,e,n){let r=0;return s;function s(m){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),i}function i(m){return la(m)?(t.consume(m),o):m===64?n(m):u(m)}function o(m){return m===43||m===45||m===46||Gi(m)?(r=1,l(m)):u(m)}function l(m){return m===58?(t.consume(m),r=0,c):(m===43||m===45||m===46||Gi(m))&&r++<32?(t.consume(m),l):(r=0,u(m))}function c(m){return m===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):m===null||m===32||m===60||f1(m)?n(m):(t.consume(m),c)}function u(m){return m===64?(t.consume(m),d):MNe(m)?(t.consume(m),u):n(m)}function d(m){return Gi(m)?h(m):n(m)}function h(m){return m===46?(t.consume(m),r=0,d):m===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):f(m)}function f(m){if((m===45||Gi(m))&&r++<63){const g=m===45?f:h;return t.consume(m),g}return n(m)}}const u_={partial:!0,tokenize:YNe};function YNe(t,e,n){return r;function r(i){return Sn(i)?Xn(t,s,"linePrefix")(i):s(i)}function s(i){return i===null||Kt(i)?e(i):n(i)}}const ZH={continuation:{tokenize:XNe},exit:QNe,name:"blockQuote",tokenize:JNe};function JNe(t,e,n){const r=this;return s;function s(o){if(o===62){const l=r.containerState;return l.open||(t.enter("blockQuote",{_container:!0}),l.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(o),t.exit("blockQuoteMarker"),i}return n(o)}function i(o){return Sn(o)?(t.enter("blockQuotePrefixWhitespace"),t.consume(o),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(o))}}function XNe(t,e,n){const r=this;return s;function s(o){return Sn(o)?Xn(t,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):i(o)}function i(o){return t.attempt(ZH,e,n)(o)}}function QNe(t){t.exit("blockQuote")}const eq={name:"characterEscape",tokenize:ZNe};function ZNe(t,e,n){return r;function r(i){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(i),t.exit("escapeMarker"),s}function s(i){return FNe(i)?(t.enter("characterEscapeValue"),t.consume(i),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(i)}}const tq={name:"characterReference",tokenize:ePe};function ePe(t,e,n){const r=this;let s=0,i,o;return l;function l(h){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),c}function c(h){return h===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(h),t.exit("characterReferenceMarkerNumeric"),u):(t.enter("characterReferenceValue"),i=31,o=Gi,d(h))}function u(h){return h===88||h===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(h),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),i=6,o=LNe,d):(t.enter("characterReferenceValue"),i=7,o=m1,d(h))}function d(h){if(h===59&&s){const f=t.exit("characterReferenceValue");return o===Gi&&!ik(r.sliceSerialize(f))?n(h):(t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return o(h)&&s++<i?(t.consume(h),d):n(h)}}const PF={partial:!0,tokenize:nPe},AF={concrete:!0,name:"codeFenced",tokenize:tPe};function tPe(t,e,n){const r=this,s={partial:!0,tokenize:R};let i=0,o=0,l;return c;function c(A){return u(A)}function u(A){const E=r.events[r.events.length-1];return i=E&&E[1].type==="linePrefix"?E[2].sliceSerialize(E[1],!0).length:0,l=A,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),d(A)}function d(A){return A===l?(o++,t.consume(A),d):o<3?n(A):(t.exit("codeFencedFenceSequence"),Sn(A)?Xn(t,h,"whitespace")(A):h(A))}function h(A){return A===null||Kt(A)?(t.exit("codeFencedFence"),r.interrupt?e(A):t.check(PF,x,T)(A)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),f(A))}function f(A){return A===null||Kt(A)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),h(A)):Sn(A)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),Xn(t,m,"whitespace")(A)):A===96&&A===l?n(A):(t.consume(A),f)}function m(A){return A===null||Kt(A)?h(A):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),g(A))}function g(A){return A===null||Kt(A)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),h(A)):A===96&&A===l?n(A):(t.consume(A),g)}function x(A){return t.attempt(s,T,w)(A)}function w(A){return t.enter("lineEnding"),t.consume(A),t.exit("lineEnding"),v}function v(A){return i>0&&Sn(A)?Xn(t,_,"linePrefix",i+1)(A):_(A)}function _(A){return A===null||Kt(A)?t.check(PF,x,T)(A):(t.enter("codeFlowValue"),C(A))}function C(A){return A===null||Kt(A)?(t.exit("codeFlowValue"),_(A)):(t.consume(A),C)}function T(A){return t.exit("codeFenced"),e(A)}function R(A,E,I){let P=0;return k;function k(B){return A.enter("lineEnding"),A.consume(B),A.exit("lineEnding"),j}function j(B){return A.enter("codeFencedFence"),Sn(B)?Xn(A,D,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(B):D(B)}function D(B){return B===l?(A.enter("codeFencedFenceSequence"),M(B)):I(B)}function M(B){return B===l?(P++,A.consume(B),M):P>=o?(A.exit("codeFencedFenceSequence"),Sn(B)?Xn(A,G,"whitespace")(B):G(B)):I(B)}function G(B){return B===null||Kt(B)?(A.exit("codeFencedFence"),E(B)):I(B)}}}function nPe(t,e,n){const r=this;return s;function s(o){return o===null?n(o):(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i)}function i(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}const sC={name:"codeIndented",tokenize:sPe},rPe={partial:!0,tokenize:iPe};function sPe(t,e,n){const r=this;return s;function s(u){return t.enter("codeIndented"),Xn(t,i,"linePrefix",4+1)(u)}function i(u){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?o(u):n(u)}function o(u){return u===null?c(u):Kt(u)?t.attempt(rPe,o,c)(u):(t.enter("codeFlowValue"),l(u))}function l(u){return u===null||Kt(u)?(t.exit("codeFlowValue"),o(u)):(t.consume(u),l)}function c(u){return t.exit("codeIndented"),e(u)}}function iPe(t,e,n){const r=this;return s;function s(o){return r.parser.lazy[r.now().line]?n(o):Kt(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),s):Xn(t,i,"linePrefix",4+1)(o)}function i(o){const l=r.events[r.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(o):Kt(o)?s(o):n(o)}}const oPe={name:"codeText",previous:lPe,resolve:aPe,tokenize:cPe};function aPe(t){let e=t.length-4,n=3,r,s;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(r=n;++r<e;)if(t[r][1].type==="codeTextData"){t[n][1].type="codeTextPadding",t[e][1].type="codeTextPadding",n+=2,e-=2;break}}for(r=n-1,e++;++r<=e;)s===void 0?r!==e&&t[r][1].type!=="lineEnding"&&(s=r):(r===e||t[r][1].type==="lineEnding")&&(t[s][1].type="codeTextData",r!==s+2&&(t[s][1].end=t[r-1][1].end,t.splice(s+2,r-s-2),e-=r-s-2,r=s+2),s=void 0);return t}function lPe(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function cPe(t,e,n){let r=0,s,i;return o;function o(h){return t.enter("codeText"),t.enter("codeTextSequence"),l(h)}function l(h){return h===96?(t.consume(h),r++,l):(t.exit("codeTextSequence"),c(h))}function c(h){return h===null?n(h):h===32?(t.enter("space"),t.consume(h),t.exit("space"),c):h===96?(i=t.enter("codeTextSequence"),s=0,d(h)):Kt(h)?(t.enter("lineEnding"),t.consume(h),t.exit("lineEnding"),c):(t.enter("codeTextData"),u(h))}function u(h){return h===null||h===32||h===96||Kt(h)?(t.exit("codeTextData"),c(h)):(t.consume(h),u)}function d(h){return h===96?(t.consume(h),s++,d):s===r?(t.exit("codeTextSequence"),t.exit("codeText"),e(h)):(i.type="codeTextData",u(h))}}class uPe{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,n,r){const s=n||0;this.setCursor(Math.trunc(e));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return r&&mm(this.left,r),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),mm(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),mm(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const n=this.left.splice(e,Number.POSITIVE_INFINITY);mm(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);mm(this.left,n.reverse())}}}function mm(t,e){let n=0;if(e.length<1e4)t.push(...e);else for(;n<e.length;)t.push(...e.slice(n,n+1e4)),n+=1e4}function nq(t){const e={};let n=-1,r,s,i,o,l,c,u;const d=new uPe(t);for(;++n<d.length;){for(;n in e;)n=e[n];if(r=d.get(n),n&&r[1].type==="chunkFlow"&&d.get(n-1)[1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,i=0,i<c.length&&c[i][1].type==="lineEndingBlank"&&(i+=2),i<c.length&&c[i][1].type==="content"))for(;++i<c.length&&c[i][1].type!=="content";)c[i][1].type==="chunkText"&&(c[i][1]._isInFirstContentOfListItem=!0,i++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,dPe(d,n)),n=e[n],u=!0);else if(r[1]._container){for(i=n,s=void 0;i--;)if(o=d.get(i),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),o[1].type="lineEnding",s=i);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;s&&(r[1].end={...d.get(s)[1].start},l=d.slice(s,n),l.unshift(r),d.splice(s,n-s+1,l))}}return Ia(t,0,Number.POSITIVE_INFINITY,d.slice(0)),!u}function dPe(t,e){const n=t.get(e)[1],r=t.get(e)[2];let s=e-1;const i=[];let o=n._tokenizer;o||(o=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const l=o.events,c=[],u={};let d,h,f=-1,m=n,g=0,x=0;const w=[x];for(;m;){for(;t.get(++s)[1]!==m;);i.push(s),m._tokenizer||(d=r.sliceStream(m),m.next||d.push(null),h&&o.defineSkip(m.start),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(d),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),h=m,m=m.next}for(m=n;++f<l.length;)l[f][0]==="exit"&&l[f-1][0]==="enter"&&l[f][1].type===l[f-1][1].type&&l[f][1].start.line!==l[f][1].end.line&&(x=f+1,w.push(x),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(o.events=[],m?(m._tokenizer=void 0,m.previous=void 0):w.pop(),f=w.length;f--;){const v=l.slice(w[f],w[f+1]),_=i.pop();c.push([_,_+v.length-1]),t.splice(_,2,v)}for(c.reverse(),f=-1;++f<c.length;)u[g+c[f][0]]=g+c[f][1],g+=c[f][1]-c[f][0]-1;return u}const hPe={resolve:mPe,tokenize:pPe},fPe={partial:!0,tokenize:gPe};function mPe(t){return nq(t),t}function pPe(t,e){let n;return r;function r(l){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),s(l)}function s(l){return l===null?i(l):Kt(l)?t.check(fPe,o,i)(l):(t.consume(l),s)}function i(l){return t.exit("chunkContent"),t.exit("content"),e(l)}function o(l){return t.consume(l),t.exit("chunkContent"),n.next=t.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,s}}function gPe(t,e,n){const r=this;return s;function s(o){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),Xn(t,i,"linePrefix")}function i(o){if(o===null||Kt(o))return n(o);const l=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(o):t.interrupt(r.parser.constructs.flow,n,e)(o)}}function rq(t,e,n,r,s,i,o,l,c){const u=c||Number.POSITIVE_INFINITY;let d=0;return h;function h(v){return v===60?(t.enter(r),t.enter(s),t.enter(i),t.consume(v),t.exit(i),f):v===null||v===32||v===41||f1(v)?n(v):(t.enter(r),t.enter(o),t.enter(l),t.enter("chunkString",{contentType:"string"}),x(v))}function f(v){return v===62?(t.enter(i),t.consume(v),t.exit(i),t.exit(s),t.exit(r),e):(t.enter(l),t.enter("chunkString",{contentType:"string"}),m(v))}function m(v){return v===62?(t.exit("chunkString"),t.exit(l),f(v)):v===null||v===60||Kt(v)?n(v):(t.consume(v),v===92?g:m)}function g(v){return v===60||v===62||v===92?(t.consume(v),m):m(v)}function x(v){return!d&&(v===null||v===41||vi(v))?(t.exit("chunkString"),t.exit(l),t.exit(o),t.exit(r),e(v)):d<u&&v===40?(t.consume(v),d++,x):v===41?(t.consume(v),d--,x):v===null||v===32||v===40||f1(v)?n(v):(t.consume(v),v===92?w:x)}function w(v){return v===40||v===41||v===92?(t.consume(v),x):x(v)}}function sq(t,e,n,r,s,i){const o=this;let l=0,c;return u;function u(m){return t.enter(r),t.enter(s),t.consume(m),t.exit(s),t.enter(i),d}function d(m){return l>999||m===null||m===91||m===93&&!c||m===94&&!l&&"_hiddenFootnoteSupport"in o.parser.constructs?n(m):m===93?(t.exit(i),t.enter(s),t.consume(m),t.exit(s),t.exit(r),e):Kt(m)?(t.enter("lineEnding"),t.consume(m),t.exit("lineEnding"),d):(t.enter("chunkString",{contentType:"string"}),h(m))}function h(m){return m===null||m===91||m===93||Kt(m)||l++>999?(t.exit("chunkString"),d(m)):(t.consume(m),c||(c=!Sn(m)),m===92?f:h)}function f(m){return m===91||m===92||m===93?(t.consume(m),l++,h):h(m)}}function iq(t,e,n,r,s,i){let o;return l;function l(f){return f===34||f===39||f===40?(t.enter(r),t.enter(s),t.consume(f),t.exit(s),o=f===40?41:f,c):n(f)}function c(f){return f===o?(t.enter(s),t.consume(f),t.exit(s),t.exit(r),e):(t.enter(i),u(f))}function u(f){return f===o?(t.exit(i),c(o)):f===null?n(f):Kt(f)?(t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),Xn(t,u,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===o||f===null||Kt(f)?(t.exit("chunkString"),u(f)):(t.consume(f),f===92?h:d)}function h(f){return f===o||f===92?(t.consume(f),d):d(f)}}function xp(t,e){let n;return r;function r(s){return Kt(s)?(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),n=!0,r):Sn(s)?Xn(t,r,n?"linePrefix":"lineSuffix")(s):e(s)}}const yPe={name:"definition",tokenize:vPe},xPe={partial:!0,tokenize:wPe};function vPe(t,e,n){const r=this;let s;return i;function i(m){return t.enter("definition"),o(m)}function o(m){return sq.call(r,t,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(m)}function l(m){return s=$h(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),m===58?(t.enter("definitionMarker"),t.consume(m),t.exit("definitionMarker"),c):n(m)}function c(m){return vi(m)?xp(t,u)(m):u(m)}function u(m){return rq(t,d,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(m)}function d(m){return t.attempt(xPe,h,h)(m)}function h(m){return Sn(m)?Xn(t,f,"whitespace")(m):f(m)}function f(m){return m===null||Kt(m)?(t.exit("definition"),r.parser.defined.push(s),e(m)):n(m)}}function wPe(t,e,n){return r;function r(l){return vi(l)?xp(t,s)(l):n(l)}function s(l){return iq(t,i,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function i(l){return Sn(l)?Xn(t,o,"whitespace")(l):o(l)}function o(l){return l===null||Kt(l)?e(l):n(l)}}const bPe={name:"hardBreakEscape",tokenize:_Pe};function _Pe(t,e,n){return r;function r(i){return t.enter("hardBreakEscape"),t.consume(i),s}function s(i){return Kt(i)?(t.exit("hardBreakEscape"),e(i)):n(i)}}const SPe={name:"headingAtx",resolve:CPe,tokenize:EPe};function CPe(t,e){let n=t.length-2,r=3,s,i;return t[r][1].type==="whitespace"&&(r+=2),n-2>r&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&t[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(s={type:"atxHeadingText",start:t[r][1].start,end:t[n][1].end},i={type:"chunkText",start:t[r][1].start,end:t[n][1].end,contentType:"text"},Ia(t,r,n-r+1,[["enter",s,e],["enter",i,e],["exit",i,e],["exit",s,e]])),t}function EPe(t,e,n){let r=0;return s;function s(d){return t.enter("atxHeading"),i(d)}function i(d){return t.enter("atxHeadingSequence"),o(d)}function o(d){return d===35&&r++<6?(t.consume(d),o):d===null||vi(d)?(t.exit("atxHeadingSequence"),l(d)):n(d)}function l(d){return d===35?(t.enter("atxHeadingSequence"),c(d)):d===null||Kt(d)?(t.exit("atxHeading"),e(d)):Sn(d)?Xn(t,l,"whitespace")(d):(t.enter("atxHeadingText"),u(d))}function c(d){return d===35?(t.consume(d),c):(t.exit("atxHeadingSequence"),l(d))}function u(d){return d===null||d===35||vi(d)?(t.exit("atxHeadingText"),l(d)):(t.consume(d),u)}}const TPe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],kF=["pre","script","style","textarea"],IPe={concrete:!0,name:"htmlFlow",resolveTo:APe,tokenize:kPe},NPe={partial:!0,tokenize:jPe},PPe={partial:!0,tokenize:RPe};function APe(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function kPe(t,e,n){const r=this;let s,i,o,l,c;return u;function u(F){return d(F)}function d(F){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(F),h}function h(F){return F===33?(t.consume(F),f):F===47?(t.consume(F),i=!0,x):F===63?(t.consume(F),s=3,r.interrupt?e:V):la(F)?(t.consume(F),o=String.fromCharCode(F),w):n(F)}function f(F){return F===45?(t.consume(F),s=2,m):F===91?(t.consume(F),s=5,l=0,g):la(F)?(t.consume(F),s=4,r.interrupt?e:V):n(F)}function m(F){return F===45?(t.consume(F),r.interrupt?e:V):n(F)}function g(F){const Z="CDATA[";return F===Z.charCodeAt(l++)?(t.consume(F),l===Z.length?r.interrupt?e:D:g):n(F)}function x(F){return la(F)?(t.consume(F),o=String.fromCharCode(F),w):n(F)}function w(F){if(F===null||F===47||F===62||vi(F)){const Z=F===47,fe=o.toLowerCase();return!Z&&!i&&kF.includes(fe)?(s=1,r.interrupt?e(F):D(F)):TPe.includes(o.toLowerCase())?(s=6,Z?(t.consume(F),v):r.interrupt?e(F):D(F)):(s=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(F):i?_(F):C(F))}return F===45||Gi(F)?(t.consume(F),o+=String.fromCharCode(F),w):n(F)}function v(F){return F===62?(t.consume(F),r.interrupt?e:D):n(F)}function _(F){return Sn(F)?(t.consume(F),_):k(F)}function C(F){return F===47?(t.consume(F),k):F===58||F===95||la(F)?(t.consume(F),T):Sn(F)?(t.consume(F),C):k(F)}function T(F){return F===45||F===46||F===58||F===95||Gi(F)?(t.consume(F),T):R(F)}function R(F){return F===61?(t.consume(F),A):Sn(F)?(t.consume(F),R):C(F)}function A(F){return F===null||F===60||F===61||F===62||F===96?n(F):F===34||F===39?(t.consume(F),c=F,E):Sn(F)?(t.consume(F),A):I(F)}function E(F){return F===c?(t.consume(F),c=null,P):F===null||Kt(F)?n(F):(t.consume(F),E)}function I(F){return F===null||F===34||F===39||F===47||F===60||F===61||F===62||F===96||vi(F)?R(F):(t.consume(F),I)}function P(F){return F===47||F===62||Sn(F)?C(F):n(F)}function k(F){return F===62?(t.consume(F),j):n(F)}function j(F){return F===null||Kt(F)?D(F):Sn(F)?(t.consume(F),j):n(F)}function D(F){return F===45&&s===2?(t.consume(F),W):F===60&&s===1?(t.consume(F),Q):F===62&&s===4?(t.consume(F),$):F===63&&s===3?(t.consume(F),V):F===93&&s===5?(t.consume(F),Y):Kt(F)&&(s===6||s===7)?(t.exit("htmlFlowData"),t.check(NPe,z,M)(F)):F===null||Kt(F)?(t.exit("htmlFlowData"),M(F)):(t.consume(F),D)}function M(F){return t.check(PPe,G,z)(F)}function G(F){return t.enter("lineEnding"),t.consume(F),t.exit("lineEnding"),B}function B(F){return F===null||Kt(F)?M(F):(t.enter("htmlFlowData"),D(F))}function W(F){return F===45?(t.consume(F),V):D(F)}function Q(F){return F===47?(t.consume(F),o="",H):D(F)}function H(F){if(F===62){const Z=o.toLowerCase();return kF.includes(Z)?(t.consume(F),$):D(F)}return la(F)&&o.length<8?(t.consume(F),o+=String.fromCharCode(F),H):D(F)}function Y(F){return F===93?(t.consume(F),V):D(F)}function V(F){return F===62?(t.consume(F),$):F===45&&s===2?(t.consume(F),V):D(F)}function $(F){return F===null||Kt(F)?(t.exit("htmlFlowData"),z(F)):(t.consume(F),$)}function z(F){return t.exit("htmlFlow"),e(F)}}function RPe(t,e,n){const r=this;return s;function s(o){return Kt(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i):n(o)}function i(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}function jPe(t,e,n){return r;function r(s){return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),t.attempt(u_,e,n)}}const DPe={name:"htmlText",tokenize:MPe};function MPe(t,e,n){const r=this;let s,i,o;return l;function l(V){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(V),c}function c(V){return V===33?(t.consume(V),u):V===47?(t.consume(V),R):V===63?(t.consume(V),C):la(V)?(t.consume(V),I):n(V)}function u(V){return V===45?(t.consume(V),d):V===91?(t.consume(V),i=0,g):la(V)?(t.consume(V),_):n(V)}function d(V){return V===45?(t.consume(V),m):n(V)}function h(V){return V===null?n(V):V===45?(t.consume(V),f):Kt(V)?(o=h,Q(V)):(t.consume(V),h)}function f(V){return V===45?(t.consume(V),m):h(V)}function m(V){return V===62?W(V):V===45?f(V):h(V)}function g(V){const $="CDATA[";return V===$.charCodeAt(i++)?(t.consume(V),i===$.length?x:g):n(V)}function x(V){return V===null?n(V):V===93?(t.consume(V),w):Kt(V)?(o=x,Q(V)):(t.consume(V),x)}function w(V){return V===93?(t.consume(V),v):x(V)}function v(V){return V===62?W(V):V===93?(t.consume(V),v):x(V)}function _(V){return V===null||V===62?W(V):Kt(V)?(o=_,Q(V)):(t.consume(V),_)}function C(V){return V===null?n(V):V===63?(t.consume(V),T):Kt(V)?(o=C,Q(V)):(t.consume(V),C)}function T(V){return V===62?W(V):C(V)}function R(V){return la(V)?(t.consume(V),A):n(V)}function A(V){return V===45||Gi(V)?(t.consume(V),A):E(V)}function E(V){return Kt(V)?(o=E,Q(V)):Sn(V)?(t.consume(V),E):W(V)}function I(V){return V===45||Gi(V)?(t.consume(V),I):V===47||V===62||vi(V)?P(V):n(V)}function P(V){return V===47?(t.consume(V),W):V===58||V===95||la(V)?(t.consume(V),k):Kt(V)?(o=P,Q(V)):Sn(V)?(t.consume(V),P):W(V)}function k(V){return V===45||V===46||V===58||V===95||Gi(V)?(t.consume(V),k):j(V)}function j(V){return V===61?(t.consume(V),D):Kt(V)?(o=j,Q(V)):Sn(V)?(t.consume(V),j):P(V)}function D(V){return V===null||V===60||V===61||V===62||V===96?n(V):V===34||V===39?(t.consume(V),s=V,M):Kt(V)?(o=D,Q(V)):Sn(V)?(t.consume(V),D):(t.consume(V),G)}function M(V){return V===s?(t.consume(V),s=void 0,B):V===null?n(V):Kt(V)?(o=M,Q(V)):(t.consume(V),M)}function G(V){return V===null||V===34||V===39||V===60||V===61||V===96?n(V):V===47||V===62||vi(V)?P(V):(t.consume(V),G)}function B(V){return V===47||V===62||vi(V)?P(V):n(V)}function W(V){return V===62?(t.consume(V),t.exit("htmlTextData"),t.exit("htmlText"),e):n(V)}function Q(V){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(V),t.exit("lineEnding"),H}function H(V){return Sn(V)?Xn(t,Y,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(V):Y(V)}function Y(V){return t.enter("htmlTextData"),o(V)}}const ak={name:"labelEnd",resolveAll:VPe,resolveTo:$Pe,tokenize:UPe},LPe={tokenize:BPe},FPe={tokenize:zPe},OPe={tokenize:GPe};function VPe(t){let e=-1;const n=[];for(;++e<t.length;){const r=t[e][1];if(n.push(t[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const s=r.type==="labelImage"?4:2;r.type="data",e+=s}}return t.length!==n.length&&Ia(t,0,t.length,n),t}function $Pe(t,e){let n=t.length,r=0,s,i,o,l;for(;n--;)if(s=t[n][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;t[n][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(o){if(t[n][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=n,s.type!=="labelLink")){r=2;break}}else s.type==="labelEnd"&&(o=n);const c={type:t[i][1].type==="labelLink"?"link":"image",start:{...t[i][1].start},end:{...t[t.length-1][1].end}},u={type:"label",start:{...t[i][1].start},end:{...t[o][1].end}},d={type:"labelText",start:{...t[i+r+2][1].end},end:{...t[o-2][1].start}};return l=[["enter",c,e],["enter",u,e]],l=ao(l,t.slice(i+1,i+r+3)),l=ao(l,[["enter",d,e]]),l=ao(l,ok(e.parser.constructs.insideSpan.null,t.slice(i+r+4,o-3),e)),l=ao(l,[["exit",d,e],t[o-2],t[o-1],["exit",u,e]]),l=ao(l,t.slice(o+1)),l=ao(l,[["exit",c,e]]),Ia(t,i,t.length,l),t}function UPe(t,e,n){const r=this;let s=r.events.length,i,o;for(;s--;)if((r.events[s][1].type==="labelImage"||r.events[s][1].type==="labelLink")&&!r.events[s][1]._balanced){i=r.events[s][1];break}return l;function l(f){return i?i._inactive?h(f):(o=r.parser.defined.includes($h(r.sliceSerialize({start:i.end,end:r.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(f),t.exit("labelMarker"),t.exit("labelEnd"),c):n(f)}function c(f){return f===40?t.attempt(LPe,d,o?d:h)(f):f===91?t.attempt(FPe,d,o?u:h)(f):o?d(f):h(f)}function u(f){return t.attempt(OPe,d,h)(f)}function d(f){return e(f)}function h(f){return i._balanced=!0,n(f)}}function BPe(t,e,n){return r;function r(h){return t.enter("resource"),t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),s}function s(h){return vi(h)?xp(t,i)(h):i(h)}function i(h){return h===41?d(h):rq(t,o,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function o(h){return vi(h)?xp(t,c)(h):d(h)}function l(h){return n(h)}function c(h){return h===34||h===39||h===40?iq(t,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):d(h)}function u(h){return vi(h)?xp(t,d)(h):d(h)}function d(h){return h===41?(t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),t.exit("resource"),e):n(h)}}function zPe(t,e,n){const r=this;return s;function s(l){return sq.call(r,t,i,o,"reference","referenceMarker","referenceString")(l)}function i(l){return r.parser.defined.includes($h(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(l):n(l)}function o(l){return n(l)}}function GPe(t,e,n){return r;function r(i){return t.enter("reference"),t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),s}function s(i){return i===93?(t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),t.exit("reference"),e):n(i)}}const WPe={name:"labelStartImage",resolveAll:ak.resolveAll,tokenize:HPe};function HPe(t,e,n){const r=this;return s;function s(l){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(l),t.exit("labelImageMarker"),i}function i(l){return l===91?(t.enter("labelMarker"),t.consume(l),t.exit("labelMarker"),t.exit("labelImage"),o):n(l)}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(l):e(l)}}const qPe={name:"labelStartLink",resolveAll:ak.resolveAll,tokenize:KPe};function KPe(t,e,n){const r=this;return s;function s(o){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(o),t.exit("labelMarker"),t.exit("labelLink"),i}function i(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):e(o)}}const iC={name:"lineEnding",tokenize:YPe};function YPe(t,e){return n;function n(r){return t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),Xn(t,e,"linePrefix")}}const xv={name:"thematicBreak",tokenize:JPe};function JPe(t,e,n){let r=0,s;return i;function i(u){return t.enter("thematicBreak"),o(u)}function o(u){return s=u,l(u)}function l(u){return u===s?(t.enter("thematicBreakSequence"),c(u)):r>=3&&(u===null||Kt(u))?(t.exit("thematicBreak"),e(u)):n(u)}function c(u){return u===s?(t.consume(u),r++,c):(t.exit("thematicBreakSequence"),Sn(u)?Xn(t,l,"whitespace")(u):l(u))}}const li={continuation:{tokenize:eAe},exit:nAe,name:"list",tokenize:ZPe},XPe={partial:!0,tokenize:rAe},QPe={partial:!0,tokenize:tAe};function ZPe(t,e,n){const r=this,s=r.events[r.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,o=0;return l;function l(m){const g=r.containerState.type||(m===42||m===43||m===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!r.containerState.marker||m===r.containerState.marker:m1(m)){if(r.containerState.type||(r.containerState.type=g,t.enter(g,{_container:!0})),g==="listUnordered")return t.enter("listItemPrefix"),m===42||m===45?t.check(xv,n,u)(m):u(m);if(!r.interrupt||m===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),c(m)}return n(m)}function c(m){return m1(m)&&++o<10?(t.consume(m),c):(!r.interrupt||o<2)&&(r.containerState.marker?m===r.containerState.marker:m===41||m===46)?(t.exit("listItemValue"),u(m)):n(m)}function u(m){return t.enter("listItemMarker"),t.consume(m),t.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||m,t.check(u_,r.interrupt?n:d,t.attempt(XPe,f,h))}function d(m){return r.containerState.initialBlankLine=!0,i++,f(m)}function h(m){return Sn(m)?(t.enter("listItemPrefixWhitespace"),t.consume(m),t.exit("listItemPrefixWhitespace"),f):n(m)}function f(m){return r.containerState.size=i+r.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(m)}}function eAe(t,e,n){const r=this;return r.containerState._closeFlow=void 0,t.check(u_,s,i);function s(l){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Xn(t,e,"listItemIndent",r.containerState.size+1)(l)}function i(l){return r.containerState.furtherBlankLines||!Sn(l)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(l)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,t.attempt(QPe,e,o)(l))}function o(l){return r.containerState._closeFlow=!0,r.interrupt=void 0,Xn(t,t.attempt(li,e,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function tAe(t,e,n){const r=this;return Xn(t,s,"listItemIndent",r.containerState.size+1);function s(i){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?e(i):n(i)}}function nAe(t){t.exit(this.containerState.type)}function rAe(t,e,n){const r=this;return Xn(t,s,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4+1);function s(i){const o=r.events[r.events.length-1];return!Sn(i)&&o&&o[1].type==="listItemPrefixWhitespace"?e(i):n(i)}}const RF={name:"setextUnderline",resolveTo:sAe,tokenize:iAe};function sAe(t,e){let n=t.length,r,s,i;for(;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){r=n;break}t[n][1].type==="paragraph"&&(s=n)}else t[n][1].type==="content"&&t.splice(n,1),!i&&t[n][1].type==="definition"&&(i=n);const o={type:"setextHeading",start:{...t[r][1].start},end:{...t[t.length-1][1].end}};return t[s][1].type="setextHeadingText",i?(t.splice(s,0,["enter",o,e]),t.splice(i+1,0,["exit",t[r][1],e]),t[r][1].end={...t[i][1].end}):t[r][1]=o,t.push(["exit",o,e]),t}function iAe(t,e,n){const r=this;let s;return i;function i(u){let d=r.events.length,h;for(;d--;)if(r.events[d][1].type!=="lineEnding"&&r.events[d][1].type!=="linePrefix"&&r.events[d][1].type!=="content"){h=r.events[d][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||h)?(t.enter("setextHeadingLine"),s=u,o(u)):n(u)}function o(u){return t.enter("setextHeadingLineSequence"),l(u)}function l(u){return u===s?(t.consume(u),l):(t.exit("setextHeadingLineSequence"),Sn(u)?Xn(t,c,"lineSuffix")(u):c(u))}function c(u){return u===null||Kt(u)?(t.exit("setextHeadingLine"),e(u)):n(u)}}const oAe={tokenize:aAe};function aAe(t){const e=this,n=t.attempt(u_,r,t.attempt(this.parser.constructs.flowInitial,s,Xn(t,t.attempt(this.parser.constructs.flow,s,t.attempt(hPe,s)),"linePrefix")));return n;function r(i){if(i===null){t.consume(i);return}return t.enter("lineEndingBlank"),t.consume(i),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function s(i){if(i===null){t.consume(i);return}return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),e.currentConstruct=void 0,n}}const lAe={resolveAll:aq()},cAe=oq("string"),uAe=oq("text");function oq(t){return{resolveAll:aq(t==="text"?dAe:void 0),tokenize:e};function e(n){const r=this,s=this.parser.constructs[t],i=n.attempt(s,o,l);return o;function o(d){return u(d)?i(d):l(d)}function l(d){if(d===null){n.consume(d);return}return n.enter("data"),n.consume(d),c}function c(d){return u(d)?(n.exit("data"),i(d)):(n.consume(d),c)}function u(d){if(d===null)return!0;const h=s[d];let f=-1;if(h)for(;++f<h.length;){const m=h[f];if(!m.previous||m.previous.call(r,r.previous))return!0}return!1}}}function aq(t){return e;function e(n,r){let s=-1,i;for(;++s<=n.length;)i===void 0?n[s]&&n[s][1].type==="data"&&(i=s,s++):(!n[s]||n[s][1].type!=="data")&&(s!==i+2&&(n[i][1].end=n[s-1][1].end,n.splice(i+2,s-i-2),s=i+2),i=void 0);return t?t(n,r):n}}function dAe(t,e){let n=0;for(;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){const r=t[n-1][1],s=e.sliceStream(r);let i=s.length,o=-1,l=0,c;for(;i--;){const u=s[i];if(typeof u=="string"){for(o=u.length;u.charCodeAt(o-1)===32;)l++,o--;if(o)break;o=-1}else if(u===-2)c=!0,l++;else if(u!==-1){i++;break}}if(e._contentTypeTextTrailing&&n===t.length&&(l=0),l){const u={type:n===t.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?o:r.start._bufferIndex+o,_index:r.start._index+i,line:r.end.line,column:r.end.column-l,offset:r.end.offset-l},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(t.splice(n,0,["enter",u,e],["exit",u,e]),n+=2)}n++}return t}const hAe={42:li,43:li,45:li,48:li,49:li,50:li,51:li,52:li,53:li,54:li,55:li,56:li,57:li,62:ZH},fAe={91:yPe},mAe={[-2]:sC,[-1]:sC,32:sC},pAe={35:SPe,42:xv,45:[RF,xv],60:IPe,61:RF,95:xv,96:AF,126:AF},gAe={38:tq,92:eq},yAe={[-5]:iC,[-4]:iC,[-3]:iC,33:WPe,38:tq,42:p1,60:[qNe,DPe],91:qPe,92:[bPe,eq],93:ak,95:p1,96:oPe},xAe={null:[p1,lAe]},vAe={null:[42,95]},wAe={null:[]},bAe=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:vAe,contentInitial:fAe,disable:wAe,document:hAe,flow:pAe,flowInitial:mAe,insideSpan:xAe,string:gAe,text:yAe},Symbol.toStringTag,{value:"Module"}));function _Ae(t,e,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const s={},i=[];let o=[],l=[];const c={attempt:E(R),check:E(A),consume:_,enter:C,exit:T,interrupt:E(A,{interrupt:!0})},u={code:null,containerState:{},defineSkip:x,events:[],now:g,parser:t,previous:null,sliceSerialize:f,sliceStream:m,write:h};let d=e.tokenize.call(u,c);return e.resolveAll&&i.push(e),u;function h(j){return o=ao(o,j),w(),o[o.length-1]!==null?[]:(I(e,0),u.events=ok(i,u.events,u),u.events)}function f(j,D){return CAe(m(j),D)}function m(j){return SAe(o,j)}function g(){const{_bufferIndex:j,_index:D,line:M,column:G,offset:B}=r;return{_bufferIndex:j,_index:D,line:M,column:G,offset:B}}function x(j){s[j.line]=j.column,k()}function w(){let j;for(;r._index<o.length;){const D=o[r._index];if(typeof D=="string")for(j=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===j&&r._bufferIndex<D.length;)v(D.charCodeAt(r._bufferIndex));else v(D)}}function v(j){d=d(j)}function _(j){Kt(j)?(r.line++,r.column=1,r.offset+=j===-3?2:1,k()):j!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=j}function C(j,D){const M=D||{};return M.type=j,M.start=g(),u.events.push(["enter",M,u]),l.push(M),M}function T(j){const D=l.pop();return D.end=g(),u.events.push(["exit",D,u]),D}function R(j,D){I(j,D.from)}function A(j,D){D.restore()}function E(j,D){return M;function M(G,B,W){let Q,H,Y,V;return Array.isArray(G)?z(G):"tokenize"in G?z([G]):$(G);function $(xe){return ge;function ge(Re){const Ue=Re!==null&&xe[Re],ze=Re!==null&&xe.null,he=[...Array.isArray(Ue)?Ue:Ue?[Ue]:[],...Array.isArray(ze)?ze:ze?[ze]:[]];return z(he)(Re)}}function z(xe){return Q=xe,H=0,xe.length===0?W:F(xe[H])}function F(xe){return ge;function ge(Re){return V=P(),Y=xe,xe.partial||(u.currentConstruct=xe),xe.name&&u.parser.constructs.disable.null.includes(xe.name)?fe():xe.tokenize.call(D?Object.assign(Object.create(u),D):u,c,Z,fe)(Re)}}function Z(xe){return j(Y,V),B}function fe(xe){return V.restore(),++H<Q.length?F(Q[H]):W}}}function I(j,D){j.resolveAll&&!i.includes(j)&&i.push(j),j.resolve&&Ia(u.events,D,u.events.length-D,j.resolve(u.events.slice(D),u)),j.resolveTo&&(u.events=j.resolveTo(u.events,u))}function P(){const j=g(),D=u.previous,M=u.currentConstruct,G=u.events.length,B=Array.from(l);return{from:G,restore:W};function W(){r=j,u.previous=D,u.currentConstruct=M,u.events.length=G,l=B,k()}}function k(){r.line in s&&r.column<2&&(r.column=s[r.line],r.offset+=s[r.line]-1)}}function SAe(t,e){const n=e.start._index,r=e.start._bufferIndex,s=e.end._index,i=e.end._bufferIndex;let o;if(n===s)o=[t[n].slice(r,i)];else{if(o=t.slice(n,s),r>-1){const l=o[0];typeof l=="string"?o[0]=l.slice(r):o.shift()}i>0&&o.push(t[s].slice(0,i))}return o}function CAe(t,e){let n=-1;const r=[];let s;for(;++n<t.length;){const i=t[n];let o;if(typeof i=="string")o=i;else switch(i){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=e?" ":"	";break}case-1:{if(!e&&s)continue;o=" ";break}default:o=String.fromCharCode(i)}s=i===-2,r.push(o)}return r.join("")}function EAe(t){const r={constructs:RNe([bAe,...(t||{}).extensions||[]]),content:s($Ne),defined:[],document:s(BNe),flow:s(oAe),lazy:{},string:s(cAe),text:s(uAe)};return r;function s(i){return o;function o(l){return _Ae(r,i,l)}}}function TAe(t){for(;!nq(t););return t}const jF=/[\0\t\n\r]/g;function IAe(){let t=1,e="",n=!0,r;return s;function s(i,o,l){const c=[];let u,d,h,f,m;for(i=e+(typeof i=="string"?i.toString():new TextDecoder(o||void 0).decode(i)),h=0,e="",n&&(i.charCodeAt(0)===65279&&h++,n=void 0);h<i.length;){if(jF.lastIndex=h,u=jF.exec(i),f=u&&u.index!==void 0?u.index:i.length,m=i.charCodeAt(f),!u){e=i.slice(h);break}if(m===10&&h===f&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),h<f&&(c.push(i.slice(h,f)),t+=f-h),m){case 0:{c.push(65533),t++;break}case 9:{for(d=Math.ceil(t/4)*4,c.push(-2);t++<d;)c.push(-1);break}case 10:{c.push(-4),t=1;break}default:r=!0,t=1}h=f+1}return l&&(r&&c.push(-5),e&&c.push(e),c.push(null)),c}}const NAe=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function PAe(t){return t.replace(NAe,AAe)}function AAe(t,e,n){if(e)return e;if(n.charCodeAt(0)===35){const s=n.charCodeAt(1),i=s===120||s===88;return QH(n.slice(i?2:1),i?16:10)}return ik(n)||t}const lq={}.hasOwnProperty;function kAe(t,e,n){return typeof e!="string"&&(n=e,e=void 0),RAe(n)(TAe(EAe(n).document().write(IAe()(t,e,!0))))}function RAe(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(Pt),autolinkProtocol:P,autolinkEmail:P,atxHeading:i(de),blockQuote:i(ze),characterEscape:P,characterReference:P,codeFenced:i(he),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:i(he,o),codeText:i(Ce,o),codeTextData:P,data:P,codeFlowValue:P,definition:i(Pe),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:i(ve),hardBreakEscape:i(Me),hardBreakTrailing:i(Me),htmlFlow:i(Ge,o),htmlFlowData:P,htmlText:i(Ge,o),htmlTextData:P,image:i(yt),label:o,link:i(Pt),listItem:i(fn),listItemValue:f,listOrdered:i(en,h),listUnordered:i(en),paragraph:i(an),reference:F,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:i(de),strong:i(dn),thematicBreak:i(xn)},exit:{atxHeading:c(),atxHeadingSequence:R,autolink:c(),autolinkEmail:Ue,autolinkProtocol:Re,blockQuote:c(),characterEscapeValue:k,characterReferenceMarkerHexadecimal:fe,characterReferenceMarkerNumeric:fe,characterReferenceValue:xe,characterReference:ge,codeFenced:c(w),codeFencedFence:x,codeFencedFenceInfo:m,codeFencedFenceMeta:g,codeFlowValue:k,codeIndented:c(v),codeText:c(B),codeTextData:k,data:k,definition:c(),definitionDestinationString:T,definitionLabelString:_,definitionTitleString:C,emphasis:c(),hardBreakEscape:c(D),hardBreakTrailing:c(D),htmlFlow:c(M),htmlFlowData:k,htmlText:c(G),htmlTextData:k,image:c(Q),label:Y,labelText:H,lineEnding:j,link:c(W),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:Z,resourceDestinationString:V,resourceTitleString:$,resource:z,setextHeading:c(I),setextHeadingLineSequence:E,setextHeadingText:A,strong:c(),thematicBreak:c()}};cq(e,(t||{}).mdastExtensions||[]);const n={};return r;function r(te){let Ee={type:"root",children:[]};const ee={stack:[Ee],tokenStack:[],config:e,enter:l,exit:u,buffer:o,resume:d,data:n},le=[];let K=-1;for(;++K<te.length;)if(te[K][1].type==="listOrdered"||te[K][1].type==="listUnordered")if(te[K][0]==="enter")le.push(K);else{const Ae=le.pop();K=s(te,Ae,K)}for(K=-1;++K<te.length;){const Ae=e[te[K][0]];lq.call(Ae,te[K][1].type)&&Ae[te[K][1].type].call(Object.assign({sliceSerialize:te[K][2].sliceSerialize},ee),te[K][1])}if(ee.tokenStack.length>0){const Ae=ee.tokenStack[ee.tokenStack.length-1];(Ae[1]||DF).call(ee,void 0,Ae[0])}for(Ee.position={start:kl(te.length>0?te[0][1].start:{line:1,column:1,offset:0}),end:kl(te.length>0?te[te.length-2][1].end:{line:1,column:1,offset:0})},K=-1;++K<e.transforms.length;)Ee=e.transforms[K](Ee)||Ee;return Ee}function s(te,Ee,ee){let le=Ee-1,K=-1,Ae=!1,Ne,Oe,He,ce;for(;++le<=ee;){const _e=te[le];switch(_e[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{_e[0]==="enter"?K++:K--,ce=void 0;break}case"lineEndingBlank":{_e[0]==="enter"&&(Ne&&!ce&&!K&&!He&&(He=le),ce=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:ce=void 0}if(!K&&_e[0]==="enter"&&_e[1].type==="listItemPrefix"||K===-1&&_e[0]==="exit"&&(_e[1].type==="listUnordered"||_e[1].type==="listOrdered")){if(Ne){let Be=le;for(Oe=void 0;Be--;){const Te=te[Be];if(Te[1].type==="lineEnding"||Te[1].type==="lineEndingBlank"){if(Te[0]==="exit")continue;Oe&&(te[Oe][1].type="lineEndingBlank",Ae=!0),Te[1].type="lineEnding",Oe=Be}else if(!(Te[1].type==="linePrefix"||Te[1].type==="blockQuotePrefix"||Te[1].type==="blockQuotePrefixWhitespace"||Te[1].type==="blockQuoteMarker"||Te[1].type==="listItemIndent"))break}He&&(!Oe||He<Oe)&&(Ne._spread=!0),Ne.end=Object.assign({},Oe?te[Oe][1].start:_e[1].end),te.splice(Oe||le,0,["exit",Ne,_e[2]]),le++,ee++}if(_e[1].type==="listItemPrefix"){const Be={type:"listItem",_spread:!1,start:Object.assign({},_e[1].start),end:void 0};Ne=Be,te.splice(le,0,["enter",Be,_e[2]]),le++,ee++,He=void 0,ce=!0}}}return te[Ee][1]._spread=Ae,ee}function i(te,Ee){return ee;function ee(le){l.call(this,te(le),le),Ee&&Ee.call(this,le)}}function o(){this.stack.push({type:"fragment",children:[]})}function l(te,Ee,ee){this.stack[this.stack.length-1].children.push(te),this.stack.push(te),this.tokenStack.push([Ee,ee||void 0]),te.position={start:kl(Ee.start),end:void 0}}function c(te){return Ee;function Ee(ee){te&&te.call(this,ee),u.call(this,ee)}}function u(te,Ee){const ee=this.stack.pop(),le=this.tokenStack.pop();if(le)le[0].type!==te.type&&(Ee?Ee.call(this,te,le[0]):(le[1]||DF).call(this,te,le[0]));else throw new Error("Cannot close `"+te.type+"` ("+yp({start:te.start,end:te.end})+"): it’s not open");ee.position.end=kl(te.end)}function d(){return ANe(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function f(te){if(this.data.expectingFirstListItemValue){const Ee=this.stack[this.stack.length-2];Ee.start=Number.parseInt(this.sliceSerialize(te),10),this.data.expectingFirstListItemValue=void 0}}function m(){const te=this.resume(),Ee=this.stack[this.stack.length-1];Ee.lang=te}function g(){const te=this.resume(),Ee=this.stack[this.stack.length-1];Ee.meta=te}function x(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function w(){const te=this.resume(),Ee=this.stack[this.stack.length-1];Ee.value=te.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function v(){const te=this.resume(),Ee=this.stack[this.stack.length-1];Ee.value=te.replace(/(\r?\n|\r)$/g,"")}function _(te){const Ee=this.resume(),ee=this.stack[this.stack.length-1];ee.label=Ee,ee.identifier=$h(this.sliceSerialize(te)).toLowerCase()}function C(){const te=this.resume(),Ee=this.stack[this.stack.length-1];Ee.title=te}function T(){const te=this.resume(),Ee=this.stack[this.stack.length-1];Ee.url=te}function R(te){const Ee=this.stack[this.stack.length-1];if(!Ee.depth){const ee=this.sliceSerialize(te).length;Ee.depth=ee}}function A(){this.data.setextHeadingSlurpLineEnding=!0}function E(te){const Ee=this.stack[this.stack.length-1];Ee.depth=this.sliceSerialize(te).codePointAt(0)===61?1:2}function I(){this.data.setextHeadingSlurpLineEnding=void 0}function P(te){const ee=this.stack[this.stack.length-1].children;let le=ee[ee.length-1];(!le||le.type!=="text")&&(le=Lt(),le.position={start:kl(te.start),end:void 0},ee.push(le)),this.stack.push(le)}function k(te){const Ee=this.stack.pop();Ee.value+=this.sliceSerialize(te),Ee.position.end=kl(te.end)}function j(te){const Ee=this.stack[this.stack.length-1];if(this.data.atHardBreak){const ee=Ee.children[Ee.children.length-1];ee.position.end=kl(te.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(Ee.type)&&(P.call(this,te),k.call(this,te))}function D(){this.data.atHardBreak=!0}function M(){const te=this.resume(),Ee=this.stack[this.stack.length-1];Ee.value=te}function G(){const te=this.resume(),Ee=this.stack[this.stack.length-1];Ee.value=te}function B(){const te=this.resume(),Ee=this.stack[this.stack.length-1];Ee.value=te}function W(){const te=this.stack[this.stack.length-1];if(this.data.inReference){const Ee=this.data.referenceType||"shortcut";te.type+="Reference",te.referenceType=Ee,delete te.url,delete te.title}else delete te.identifier,delete te.label;this.data.referenceType=void 0}function Q(){const te=this.stack[this.stack.length-1];if(this.data.inReference){const Ee=this.data.referenceType||"shortcut";te.type+="Reference",te.referenceType=Ee,delete te.url,delete te.title}else delete te.identifier,delete te.label;this.data.referenceType=void 0}function H(te){const Ee=this.sliceSerialize(te),ee=this.stack[this.stack.length-2];ee.label=PAe(Ee),ee.identifier=$h(Ee).toLowerCase()}function Y(){const te=this.stack[this.stack.length-1],Ee=this.resume(),ee=this.stack[this.stack.length-1];if(this.data.inReference=!0,ee.type==="link"){const le=te.children;ee.children=le}else ee.alt=Ee}function V(){const te=this.resume(),Ee=this.stack[this.stack.length-1];Ee.url=te}function $(){const te=this.resume(),Ee=this.stack[this.stack.length-1];Ee.title=te}function z(){this.data.inReference=void 0}function F(){this.data.referenceType="collapsed"}function Z(te){const Ee=this.resume(),ee=this.stack[this.stack.length-1];ee.label=Ee,ee.identifier=$h(this.sliceSerialize(te)).toLowerCase(),this.data.referenceType="full"}function fe(te){this.data.characterReferenceType=te.type}function xe(te){const Ee=this.sliceSerialize(te),ee=this.data.characterReferenceType;let le;ee?(le=QH(Ee,ee==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):le=ik(Ee);const K=this.stack[this.stack.length-1];K.value+=le}function ge(te){const Ee=this.stack.pop();Ee.position.end=kl(te.end)}function Re(te){k.call(this,te);const Ee=this.stack[this.stack.length-1];Ee.url=this.sliceSerialize(te)}function Ue(te){k.call(this,te);const Ee=this.stack[this.stack.length-1];Ee.url="mailto:"+this.sliceSerialize(te)}function ze(){return{type:"blockquote",children:[]}}function he(){return{type:"code",lang:null,meta:null,value:""}}function Ce(){return{type:"inlineCode",value:""}}function Pe(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function ve(){return{type:"emphasis",children:[]}}function de(){return{type:"heading",depth:0,children:[]}}function Me(){return{type:"break"}}function Ge(){return{type:"html",value:""}}function yt(){return{type:"image",title:null,url:"",alt:null}}function Pt(){return{type:"link",title:null,url:"",children:[]}}function en(te){return{type:"list",ordered:te.type==="listOrdered",start:null,spread:te._spread,children:[]}}function fn(te){return{type:"listItem",spread:te._spread,checked:null,children:[]}}function an(){return{type:"paragraph",children:[]}}function dn(){return{type:"strong",children:[]}}function Lt(){return{type:"text",value:""}}function xn(){return{type:"thematicBreak"}}}function kl(t){return{line:t.line,column:t.column,offset:t.offset}}function cq(t,e){let n=-1;for(;++n<e.length;){const r=e[n];Array.isArray(r)?cq(t,r):jAe(t,r)}}function jAe(t,e){let n;for(n in e)if(lq.call(e,n))switch(n){case"canContainEols":{const r=e[n];r&&t[n].push(...r);break}case"transforms":{const r=e[n];r&&t[n].push(...r);break}case"enter":case"exit":{const r=e[n];r&&Object.assign(t[n],r);break}}}function DF(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+yp({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+yp({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+yp({start:e.start,end:e.end})+") is still open")}function DAe(t){const e=this;e.parser=n;function n(r){return kAe(r,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function MAe(t,e){const n={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(e),!0)};return t.patch(e,n),t.applyData(e,n)}function LAe(t,e){const n={type:"element",tagName:"br",properties:{},children:[]};return t.patch(e,n),[t.applyData(e,n),{type:"text",value:`
`}]}function FAe(t,e){const n=e.value?e.value+`
`:"",r={};e.lang&&(r.className=["language-"+e.lang]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return e.meta&&(s.data={meta:e.meta}),t.patch(e,s),s=t.applyData(e,s),s={type:"element",tagName:"pre",properties:{},children:[s]},t.patch(e,s),s}function OAe(t,e){const n={type:"element",tagName:"del",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function VAe(t,e){const n={type:"element",tagName:"em",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function $Ae(t,e){const n=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),s=Of(r.toLowerCase()),i=t.footnoteOrder.indexOf(r);let o,l=t.footnoteCounts.get(r);l===void 0?(l=0,t.footnoteOrder.push(r),o=t.footnoteOrder.length):o=i+1,l+=1,t.footnoteCounts.set(r,l);const c={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+s,id:n+"fnref-"+s+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};t.patch(e,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return t.patch(e,u),t.applyData(e,u)}function UAe(t,e){const n={type:"element",tagName:"h"+e.depth,properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function BAe(t,e){if(t.options.allowDangerousHtml){const n={type:"raw",value:e.value};return t.patch(e,n),t.applyData(e,n)}}function uq(t,e){const n=e.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const s=t.all(e),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const o=s[s.length-1];return o&&o.type==="text"?o.value+=r:s.push({type:"text",value:r}),s}function zAe(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return uq(t,e);const s={src:Of(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"img",properties:s,children:[]};return t.patch(e,i),t.applyData(e,i)}function GAe(t,e){const n={src:Of(e.url)};e.alt!==null&&e.alt!==void 0&&(n.alt=e.alt),e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"img",properties:n,children:[]};return t.patch(e,r),t.applyData(e,r)}function WAe(t,e){const n={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};t.patch(e,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return t.patch(e,r),t.applyData(e,r)}function HAe(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return uq(t,e);const s={href:Of(r.url||"")};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"a",properties:s,children:t.all(e)};return t.patch(e,i),t.applyData(e,i)}function qAe(t,e){const n={href:Of(e.url)};e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"a",properties:n,children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function KAe(t,e,n){const r=t.all(e),s=n?YAe(n):dq(e),i={},o=[];if(typeof e.checked=="boolean"){const d=r[0];let h;d&&d.type==="element"&&d.tagName==="p"?h=d:(h={type:"element",tagName:"p",properties:{},children:[]},r.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let l=-1;for(;++l<r.length;){const d=r[l];(s||l!==0||d.type!=="element"||d.tagName!=="p")&&o.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?o.push(...d.children):o.push(d)}const c=r[r.length-1];c&&(s||c.type!=="element"||c.tagName!=="p")&&o.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:i,children:o};return t.patch(e,u),t.applyData(e,u)}function YAe(t){let e=!1;if(t.type==="list"){e=t.spread||!1;const n=t.children;let r=-1;for(;!e&&++r<n.length;)e=dq(n[r])}return e}function dq(t){const e=t.spread;return e??t.children.length>1}function JAe(t,e){const n={},r=t.all(e);let s=-1;for(typeof e.start=="number"&&e.start!==1&&(n.start=e.start);++s<r.length;){const o=r[s];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const i={type:"element",tagName:e.ordered?"ol":"ul",properties:n,children:t.wrap(r,!0)};return t.patch(e,i),t.applyData(e,i)}function XAe(t,e){const n={type:"element",tagName:"p",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function QAe(t,e){const n={type:"root",children:t.wrap(t.all(e))};return t.patch(e,n),t.applyData(e,n)}function ZAe(t,e){const n={type:"element",tagName:"strong",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function eke(t,e){const n=t.all(e),r=n.shift(),s=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:t.wrap([r],!0)};t.patch(e.children[0],o),s.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:t.wrap(n,!0)},l=tk(e.children[1]),c=WH(e.children[e.children.length-1]);l&&c&&(o.position={start:l,end:c}),s.push(o)}const i={type:"element",tagName:"table",properties:{},children:t.wrap(s,!0)};return t.patch(e,i),t.applyData(e,i)}function tke(t,e,n){const r=n?n.children:void 0,i=(r?r.indexOf(e):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,l=o?o.length:e.children.length;let c=-1;const u=[];for(;++c<l;){const h=e.children[c],f={},m=o?o[c]:void 0;m&&(f.align=m);let g={type:"element",tagName:i,properties:f,children:[]};h&&(g.children=t.all(h),t.patch(h,g),g=t.applyData(h,g)),u.push(g)}const d={type:"element",tagName:"tr",properties:{},children:t.wrap(u,!0)};return t.patch(e,d),t.applyData(e,d)}function nke(t,e){const n={type:"element",tagName:"td",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}const MF=9,LF=32;function rke(t){const e=String(t),n=/\r?\n|\r/g;let r=n.exec(e),s=0;const i=[];for(;r;)i.push(FF(e.slice(s,r.index),s>0,!0),r[0]),s=r.index+r[0].length,r=n.exec(e);return i.push(FF(e.slice(s),s>0,!1)),i.join("")}function FF(t,e,n){let r=0,s=t.length;if(e){let i=t.codePointAt(r);for(;i===MF||i===LF;)r++,i=t.codePointAt(r)}if(n){let i=t.codePointAt(s-1);for(;i===MF||i===LF;)s--,i=t.codePointAt(s-1)}return s>r?t.slice(r,s):""}function ske(t,e){const n={type:"text",value:rke(String(e.value))};return t.patch(e,n),t.applyData(e,n)}function ike(t,e){const n={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(e,n),t.applyData(e,n)}const oke={blockquote:MAe,break:LAe,code:FAe,delete:OAe,emphasis:VAe,footnoteReference:$Ae,heading:UAe,html:BAe,imageReference:zAe,image:GAe,inlineCode:WAe,linkReference:HAe,link:qAe,listItem:KAe,list:JAe,paragraph:XAe,root:QAe,strong:ZAe,table:eke,tableCell:nke,tableRow:tke,text:ske,thematicBreak:ike,toml:Ex,yaml:Ex,definition:Ex,footnoteDefinition:Ex};function Ex(){}const hq=-1,d_=0,vp=1,s0=2,lk=3,ck=4,uk=5,dk=6,fq=7,mq=8,OF=typeof self=="object"?self:globalThis,ake=(t,e)=>{const n=(s,i)=>(t.set(i,s),s),r=s=>{if(t.has(s))return t.get(s);const[i,o]=e[s];switch(i){case d_:case hq:return n(o,s);case vp:{const l=n([],s);for(const c of o)l.push(r(c));return l}case s0:{const l=n({},s);for(const[c,u]of o)l[r(c)]=r(u);return l}case lk:return n(new Date(o),s);case ck:{const{source:l,flags:c}=o;return n(new RegExp(l,c),s)}case uk:{const l=n(new Map,s);for(const[c,u]of o)l.set(r(c),r(u));return l}case dk:{const l=n(new Set,s);for(const c of o)l.add(r(c));return l}case fq:{const{name:l,message:c}=o;return n(new OF[l](c),s)}case mq:return n(BigInt(o),s);case"BigInt":return n(Object(BigInt(o)),s);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:l}=new Uint8Array(o);return n(new DataView(l),o)}}return n(new OF[i](o),s)};return r},VF=t=>ake(new Map,t)(0),Wd="",{toString:lke}={},{keys:cke}=Object,pm=t=>{const e=typeof t;if(e!=="object"||!t)return[d_,e];const n=lke.call(t).slice(8,-1);switch(n){case"Array":return[vp,Wd];case"Object":return[s0,Wd];case"Date":return[lk,Wd];case"RegExp":return[ck,Wd];case"Map":return[uk,Wd];case"Set":return[dk,Wd];case"DataView":return[vp,n]}return n.includes("Array")?[vp,n]:n.includes("Error")?[fq,n]:[s0,n]},Tx=([t,e])=>t===d_&&(e==="function"||e==="symbol"),uke=(t,e,n,r)=>{const s=(o,l)=>{const c=r.push(o)-1;return n.set(l,c),c},i=o=>{if(n.has(o))return n.get(o);let[l,c]=pm(o);switch(l){case d_:{let d=o;switch(c){case"bigint":l=mq,d=o.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+c);d=null;break;case"undefined":return s([hq],o)}return s([l,d],o)}case vp:{if(c){let f=o;return c==="DataView"?f=new Uint8Array(o.buffer):c==="ArrayBuffer"&&(f=new Uint8Array(o)),s([c,[...f]],o)}const d=[],h=s([l,d],o);for(const f of o)d.push(i(f));return h}case s0:{if(c)switch(c){case"BigInt":return s([c,o.toString()],o);case"Boolean":case"Number":case"String":return s([c,o.valueOf()],o)}if(e&&"toJSON"in o)return i(o.toJSON());const d=[],h=s([l,d],o);for(const f of cke(o))(t||!Tx(pm(o[f])))&&d.push([i(f),i(o[f])]);return h}case lk:return s([l,o.toISOString()],o);case ck:{const{source:d,flags:h}=o;return s([l,{source:d,flags:h}],o)}case uk:{const d=[],h=s([l,d],o);for(const[f,m]of o)(t||!(Tx(pm(f))||Tx(pm(m))))&&d.push([i(f),i(m)]);return h}case dk:{const d=[],h=s([l,d],o);for(const f of o)(t||!Tx(pm(f)))&&d.push(i(f));return h}}const{message:u}=o;return s([l,{name:c,message:u}],o)};return i},$F=(t,{json:e,lossy:n}={})=>{const r=[];return uke(!(e||n),!!e,new Map,r)(t),r},i0=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?VF($F(t,e)):structuredClone(t):(t,e)=>VF($F(t,e));function dke(t,e){const n=[{type:"text",value:"↩"}];return e>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),n}function hke(t,e){return"Back to reference "+(t+1)+(e>1?"-"+e:"")}function fke(t){const e=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",n=t.options.footnoteBackContent||dke,r=t.options.footnoteBackLabel||hke,s=t.options.footnoteLabel||"Footnotes",i=t.options.footnoteLabelTagName||"h2",o=t.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<t.footnoteOrder.length;){const u=t.footnoteById.get(t.footnoteOrder[c]);if(!u)continue;const d=t.all(u),h=String(u.identifier).toUpperCase(),f=Of(h.toLowerCase());let m=0;const g=[],x=t.footnoteCounts.get(h);for(;x!==void 0&&++m<=x;){g.length>0&&g.push({type:"text",value:" "});let _=typeof n=="string"?n:n(c,m);typeof _=="string"&&(_={type:"text",value:_}),g.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+f+(m>1?"-"+m:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(c,m),className:["data-footnote-backref"]},children:Array.isArray(_)?_:[_]})}const w=d[d.length-1];if(w&&w.type==="element"&&w.tagName==="p"){const _=w.children[w.children.length-1];_&&_.type==="text"?_.value+=" ":w.children.push({type:"text",value:" "}),w.children.push(...g)}else d.push(...g);const v={type:"element",tagName:"li",properties:{id:e+"fn-"+f},children:t.wrap(d,!0)};t.patch(u,v),l.push(v)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...i0(o),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(l,!0)},{type:"text",value:`
`}]}}const pq=function(t){if(t==null)return yke;if(typeof t=="function")return h_(t);if(typeof t=="object")return Array.isArray(t)?mke(t):pke(t);if(typeof t=="string")return gke(t);throw new Error("Expected function, string, or object as test")};function mke(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=pq(t[n]);return h_(r);function r(...s){let i=-1;for(;++i<e.length;)if(e[i].apply(this,s))return!0;return!1}}function pke(t){const e=t;return h_(n);function n(r){const s=r;let i;for(i in t)if(s[i]!==e[i])return!1;return!0}}function gke(t){return h_(e);function e(n){return n&&n.type===t}}function h_(t){return e;function e(n,r,s){return!!(xke(n)&&t.call(this,n,typeof r=="number"?r:void 0,s||void 0))}}function yke(){return!0}function xke(t){return t!==null&&typeof t=="object"&&"type"in t}const gq=[],vke=!0,UF=!1,wke="skip";function bke(t,e,n,r){let s;typeof e=="function"&&typeof n!="function"?(r=n,n=e):s=e;const i=pq(s),o=r?-1:1;l(t,void 0,[])();function l(c,u,d){const h=c&&typeof c=="object"?c:{};if(typeof h.type=="string"){const m=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(c.type+(m?"<"+m+">":""))+")"})}return f;function f(){let m=gq,g,x,w;if((!e||i(c,u,d[d.length-1]||void 0))&&(m=_ke(n(c,d)),m[0]===UF))return m;if("children"in c&&c.children){const v=c;if(v.children&&m[0]!==wke)for(x=(r?v.children.length:-1)+o,w=d.concat(v);x>-1&&x<v.children.length;){const _=v.children[x];if(g=l(_,x,w)(),g[0]===UF)return g;x=typeof g[1]=="number"?g[1]:x+o}}return m}}}function _ke(t){return Array.isArray(t)?t:typeof t=="number"?[vke,t]:t==null?gq:[t]}function yq(t,e,n,r){let s,i,o;typeof e=="function"&&typeof n!="function"?(i=void 0,o=e,s=n):(i=e,o=n,s=r),bke(t,i,l,s);function l(c,u){const d=u[u.length-1],h=d?d.children.indexOf(c):void 0;return o(c,h,d)}}const g1={}.hasOwnProperty,Ske={};function Cke(t,e){const n=e||Ske,r=new Map,s=new Map,i=new Map,o={...oke,...n.handlers},l={all:u,applyData:Tke,definitionById:r,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:o,one:c,options:n,patch:Eke,wrap:Nke};return yq(t,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const h=d.type==="definition"?r:s,f=String(d.identifier).toUpperCase();h.has(f)||h.set(f,d)}}),l;function c(d,h){const f=d.type,m=l.handlers[f];if(g1.call(l.handlers,f)&&m)return m(l,d,h);if(l.options.passThrough&&l.options.passThrough.includes(f)){if("children"in d){const{children:x,...w}=d,v=i0(w);return v.children=l.all(d),v}return i0(d)}return(l.options.unknownHandler||Ike)(l,d,h)}function u(d){const h=[];if("children"in d){const f=d.children;let m=-1;for(;++m<f.length;){const g=l.one(f[m],d);if(g){if(m&&f[m-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=BF(g.value)),!Array.isArray(g)&&g.type==="element")){const x=g.children[0];x&&x.type==="text"&&(x.value=BF(x.value))}Array.isArray(g)?h.push(...g):h.push(g)}}}return h}}function Eke(t,e){t.position&&(e.position=lNe(t))}function Tke(t,e){let n=e;if(t&&t.data){const r=t.data.hName,s=t.data.hChildren,i=t.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const o="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:o}}n.type==="element"&&i&&Object.assign(n.properties,i0(i)),"children"in n&&n.children&&s!==null&&s!==void 0&&(n.children=s)}return n}function Ike(t,e){const n=e.data||{},r="value"in e&&!(g1.call(n,"hProperties")||g1.call(n,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function Nke(t,e){const n=[];let r=-1;for(e&&n.push({type:"text",value:`
`});++r<t.length;)r&&n.push({type:"text",value:`
`}),n.push(t[r]);return e&&t.length>0&&n.push({type:"text",value:`
`}),n}function BF(t){let e=0,n=t.charCodeAt(e);for(;n===9||n===32;)e++,n=t.charCodeAt(e);return t.slice(e)}function zF(t,e){const n=Cke(t,e),r=n.one(t,void 0),s=fke(n),i=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function Pke(t,e){return t&&"run"in t?async function(n,r){const s=zF(n,{file:r,...e});await t.run(s,r)}:function(n,r){return zF(n,{file:r,...t||e})}}function GF(t){if(t)throw t}var vv=Object.prototype.hasOwnProperty,xq=Object.prototype.toString,WF=Object.defineProperty,HF=Object.getOwnPropertyDescriptor,qF=function(e){return typeof Array.isArray=="function"?Array.isArray(e):xq.call(e)==="[object Array]"},KF=function(e){if(!e||xq.call(e)!=="[object Object]")return!1;var n=vv.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&vv.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;var s;for(s in e);return typeof s>"u"||vv.call(e,s)},YF=function(e,n){WF&&n.name==="__proto__"?WF(e,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):e[n.name]=n.newValue},JF=function(e,n){if(n==="__proto__")if(vv.call(e,n)){if(HF)return HF(e,n).value}else return;return e[n]},Ake=function t(){var e,n,r,s,i,o,l=arguments[0],c=1,u=arguments.length,d=!1;for(typeof l=="boolean"&&(d=l,l=arguments[1]||{},c=2),(l==null||typeof l!="object"&&typeof l!="function")&&(l={});c<u;++c)if(e=arguments[c],e!=null)for(n in e)r=JF(l,n),s=JF(e,n),l!==s&&(d&&s&&(KF(s)||(i=qF(s)))?(i?(i=!1,o=r&&qF(r)?r:[]):o=r&&KF(r)?r:{},YF(l,{name:n,newValue:t(d,o,s)})):typeof s<"u"&&YF(l,{name:n,newValue:s}));return l};const oC=o0(Ake);function y1(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function kke(){const t=[],e={run:n,use:r};return e;function n(...s){let i=-1;const o=s.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);l(null,...s);function l(c,...u){const d=t[++i];let h=-1;if(c){o(c);return}for(;++h<s.length;)(u[h]===null||u[h]===void 0)&&(u[h]=s[h]);s=u,d?Rke(d,l)(...u):o(null,...u)}}function r(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return t.push(s),e}}function Rke(t,e){let n;return r;function r(...o){const l=t.length>o.length;let c;l&&o.push(s);try{c=t.apply(this,o)}catch(u){const d=u;if(l&&n)throw d;return s(d)}l||(c&&c.then&&typeof c.then=="function"?c.then(i,s):c instanceof Error?s(c):i(c))}function s(o,...l){n||(n=!0,e(o,...l))}function i(o){s(null,o)}}const ra={basename:jke,dirname:Dke,extname:Mke,join:Lke,sep:"/"};function jke(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');hy(t);let n=0,r=-1,s=t.length,i;if(e===void 0||e.length===0||e.length>t.length){for(;s--;)if(t.codePointAt(s)===47){if(i){n=s+1;break}}else r<0&&(i=!0,r=s+1);return r<0?"":t.slice(n,r)}if(e===t)return"";let o=-1,l=e.length-1;for(;s--;)if(t.codePointAt(s)===47){if(i){n=s+1;break}}else o<0&&(i=!0,o=s+1),l>-1&&(t.codePointAt(s)===e.codePointAt(l--)?l<0&&(r=s):(l=-1,r=o));return n===r?r=o:r<0&&(r=t.length),t.slice(n,r)}function Dke(t){if(hy(t),t.length===0)return".";let e=-1,n=t.length,r;for(;--n;)if(t.codePointAt(n)===47){if(r){e=n;break}}else r||(r=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function Mke(t){hy(t);let e=t.length,n=-1,r=0,s=-1,i=0,o;for(;e--;){const l=t.codePointAt(e);if(l===47){if(o){r=e+1;break}continue}n<0&&(o=!0,n=e+1),l===46?s<0?s=e:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||n<0||i===0||i===1&&s===n-1&&s===r+1?"":t.slice(s,n)}function Lke(...t){let e=-1,n;for(;++e<t.length;)hy(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":Fke(n)}function Fke(t){hy(t);const e=t.codePointAt(0)===47;let n=Oke(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.codePointAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function Oke(t,e){let n="",r=0,s=-1,i=0,o=-1,l,c;for(;++o<=t.length;){if(o<t.length)l=t.codePointAt(o);else{if(l===47)break;l=47}if(l===47){if(!(s===o-1||i===1))if(s!==o-1&&i===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(c=n.lastIndexOf("/"),c!==n.length-1){c<0?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}}else if(n.length>0){n="",r=0,s=o,i=0;continue}}e&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+t.slice(s+1,o):n=t.slice(s+1,o),r=o-s-1;s=o,i=0}else l===46&&i>-1?i++:i=-1}return n}function hy(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const Vke={cwd:$ke};function $ke(){return"/"}function x1(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function Uke(t){if(typeof t=="string")t=new URL(t);else if(!x1(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return Bke(t)}function Bke(t){if(t.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.codePointAt(n)===37&&e.codePointAt(n+1)===50){const r=e.codePointAt(n+2);if(r===70||r===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(e)}const aC=["history","path","basename","stem","extname","dirname"];class vq{constructor(e){let n;e?x1(e)?n={path:e}:typeof e=="string"||zke(e)?n={value:e}:n=e:n={},this.cwd="cwd"in n?"":Vke.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<aC.length;){const i=aC[r];i in n&&n[i]!==void 0&&n[i]!==null&&(this[i]=i==="history"?[...n[i]]:n[i])}let s;for(s in n)aC.includes(s)||(this[s]=n[s])}get basename(){return typeof this.path=="string"?ra.basename(this.path):void 0}set basename(e){cC(e,"basename"),lC(e,"basename"),this.path=ra.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?ra.dirname(this.path):void 0}set dirname(e){XF(this.basename,"dirname"),this.path=ra.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?ra.extname(this.path):void 0}set extname(e){if(lC(e,"extname"),XF(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=ra.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){x1(e)&&(e=Uke(e)),cC(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?ra.basename(this.path,this.extname):void 0}set stem(e){cC(e,"stem"),lC(e,"stem"),this.path=ra.join(this.dirname||"",e+(this.extname||""))}fail(e,n,r){const s=this.message(e,n,r);throw s.fatal=!0,s}info(e,n,r){const s=this.message(e,n,r);return s.fatal=void 0,s}message(e,n,r){const s=new Vs(e,n,r);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function lC(t,e){if(t&&t.includes(ra.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+ra.sep+"`")}function cC(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function XF(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function zke(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const Gke=function(t){const r=this.constructor.prototype,s=r[t],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,r),i},Wke={}.hasOwnProperty;class hk extends Gke{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=kke()}copy(){const e=new hk;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];e.use(...r)}return e.data(oC(!0,{},this.namespace)),e}data(e,n){return typeof e=="string"?arguments.length===2?(hC("data",this.frozen),this.namespace[e]=n,this):Wke.call(this.namespace,e)&&this.namespace[e]||void 0:e?(hC("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const s=n.call(e,...r);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const n=Ix(e),r=this.parser||this.Parser;return uC("parse",r),r(String(n),n)}process(e,n){const r=this;return this.freeze(),uC("process",this.parser||this.Parser),dC("process",this.compiler||this.Compiler),n?s(void 0,n):new Promise(s);function s(i,o){const l=Ix(e),c=r.parse(l);r.run(c,l,function(d,h,f){if(d||!h||!f)return u(d);const m=h,g=r.stringify(m,f);Kke(g)?f.value=g:f.result=g,u(d,f)});function u(d,h){d||!h?o(d):i?i(h):n(void 0,h)}}}processSync(e){let n=!1,r;return this.freeze(),uC("processSync",this.parser||this.Parser),dC("processSync",this.compiler||this.Compiler),this.process(e,s),ZF("processSync","process",n),r;function s(i,o){n=!0,GF(i),r=o}}run(e,n,r){QF(e),this.freeze();const s=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?i(void 0,r):new Promise(i);function i(o,l){const c=Ix(n);s.run(e,c,u);function u(d,h,f){const m=h||e;d?l(d):o?o(m):r(void 0,m,f)}}}runSync(e,n){let r=!1,s;return this.run(e,n,i),ZF("runSync","run",r),s;function i(o,l){GF(o),s=l,r=!0}}stringify(e,n){this.freeze();const r=Ix(n),s=this.compiler||this.Compiler;return dC("stringify",s),QF(e),s(e,r)}use(e,...n){const r=this.attachers,s=this.namespace;if(hC("use",this.frozen),e!=null)if(typeof e=="function")c(e,n);else if(typeof e=="object")Array.isArray(e)?l(e):o(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function i(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[d,...h]=u;c(d,h)}else o(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function o(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(u.plugins),u.settings&&(s.settings=oC(!0,s.settings,u.settings))}function l(u){let d=-1;if(u!=null)if(Array.isArray(u))for(;++d<u.length;){const h=u[d];i(h)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,d){let h=-1,f=-1;for(;++h<r.length;)if(r[h][0]===u){f=h;break}if(f===-1)r.push([u,...d]);else if(d.length>0){let[m,...g]=d;const x=r[f][1];y1(x)&&y1(m)&&(m=oC(!0,x,m)),r[f]=[u,m,...g]}}}}const Hke=new hk().freeze();function uC(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function dC(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function hC(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function QF(t){if(!y1(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function ZF(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function Ix(t){return qke(t)?t:new vq(t)}function qke(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function Kke(t){return typeof t=="string"||Yke(t)}function Yke(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const Jke="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",eO=[],tO={allowDangerousHtml:!0},Xke=/^(https?|ircs?|mailto|xmpp)$/i,Qke=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Zke(t){const e=eRe(t),n=tRe(t);return nRe(e.runSync(e.parse(n),n),t)}function eRe(t){const e=t.rehypePlugins||eO,n=t.remarkPlugins||eO,r=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...tO}:tO;return Hke().use(DAe).use(n).use(Pke,r).use(e)}function tRe(t){const e=t.children||"",n=new vq;return typeof e=="string"&&(n.value=e),n}function nRe(t,e){const n=e.allowedElements,r=e.allowElement,s=e.components,i=e.disallowedElements,o=e.skipHtml,l=e.unwrapDisallowed,c=e.urlTransform||rRe;for(const d of Qke)Object.hasOwn(e,d.from)&&(""+d.from+(d.to?"use `"+d.to+"` instead":"remove it")+Jke+d.id,void 0);return yq(t,u),fNe(t,{Fragment:a.Fragment,components:s,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function u(d,h,f){if(d.type==="raw"&&f&&typeof h=="number")return o?f.children.splice(h,1):f.children[h]={type:"text",value:d.value},h;if(d.type==="element"){let m;for(m in rC)if(Object.hasOwn(rC,m)&&Object.hasOwn(d.properties,m)){const g=d.properties[m],x=rC[m];(x===null||x.includes(d.tagName))&&(d.properties[m]=c(String(g||""),m,d))}}if(d.type==="element"){let m=n?!n.includes(d.tagName):i?i.includes(d.tagName):!1;if(!m&&r&&typeof h=="number"&&(m=!r(d,h,f)),m&&f&&typeof h=="number")return l&&d.children?f.children.splice(h,1,...d.children):f.children.splice(h,1),h}}}function rRe(t){const e=t.indexOf(":"),n=t.indexOf("?"),r=t.indexOf("#"),s=t.indexOf("/");return e===-1||s!==-1&&e>s||n!==-1&&e>n||r!==-1&&e>r||Xke.test(t.slice(0,e))?t:""}const sRe=({productData:t,onViewDetails:e,onAddToCart:n,onBuyNow:r,onVisualize:s})=>{if(!t)return null;const{name:i,description:o,price:l,imageUrl:c,id:u}=t;return a.jsxs(Je,{className:"mb-2 w-full max-w-xs sm:max-w-sm overflow-hidden shadow-md border border-border",children:[c&&a.jsx("div",{className:"w-full h-32 sm:h-40 overflow-hidden bg-muted",children:a.jsx("img",{src:c,alt:i||"Product image",className:"w-full h-full object-contain"})}),a.jsx(ct,{className:"p-3",children:i&&a.jsx(ut,{className:"text-sm sm:text-base font-semibold leading-tight line-clamp-2",children:i})}),a.jsxs(it,{className:"p-3 pt-0 text-xs sm:text-sm",children:[o&&a.jsx(Qt,{className:"mb-2 line-clamp-2 sm:line-clamp-3 text-muted-foreground",children:o}),l&&a.jsx("p",{className:"font-semibold text-sm sm:text-base",children:typeof l=="number"?`$${l.toFixed(2)}`:l}),a.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row sm:space-x-2 space-y-2 sm:space-y-0",children:[e&&a.jsx(O,{size:"sm",variant:"outline",className:"flex-1 text-xs sm:text-sm",onClick:()=>e(u,i),children:"View"}),n&&a.jsx(O,{size:"sm",variant:"secondary",className:"flex-1 text-xs sm:text-sm",onClick:()=>n(u,i),children:"Add to Cart"}),r&&a.jsx(O,{size:"sm",variant:"default",className:"flex-1 text-xs sm:text-sm",onClick:()=>r(u,i),children:"Buy Now"})]}),s&&a.jsxs(O,{size:"sm",variant:"outline",className:"w-full mt-2 text-xs sm:text-sm",onClick:()=>s(u,i),children:[a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Visualize with Image"]})]})]})},iRe="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s",oRe=new En({apiKey:iRe}),aRe="gemini-2.0-flash-preview-image-generation";async function fC(t,e){if(!t)throw new Error("Image source is undefined or null.");let n,r=e;if(typeof t=="string"&&(t.startsWith("http://")||t.startsWith("https://"))){console.log(`Fetching image from URL: ${t}`);const i=await fetch(t);if(!i.ok)throw new Error(`Failed to fetch image from ${t}: ${i.statusText}`);const o=await i.blob();r=o.type||r||"image/jpeg",n=await new Promise((l,c)=>{const u=new FileReader;u.onloadend=()=>{typeof u.result=="string"?l(u.result.split(",")[1]):c(new Error("FileReader did not return a string for URL image."))},u.onerror=d=>c(new Error(`FileReader failed for URL image: ${d}`)),u.readAsDataURL(o)})}else if(typeof t=="string"&&t.startsWith("data:")){console.log("Processing Data URL image.");try{const i=t.split(",");if(i.length<2)throw new Error("Invalid data URL structure.");const o=i[0];n=i[1];const l=o.match(/:(.*?);/);if(!l||!l[1])throw new Error("Could not parse MIME type from data URL.");r=l[1]}catch(i){throw console.error("Error parsing data URL:",t,i),new Error(`Invalid data URL format: ${i.message}`)}}else if(typeof File<"u"&&t instanceof File)console.log(`Processing File object: ${t.name}`),r=t.type,n=await new Promise((i,o)=>{const l=new FileReader;l.onloadend=()=>{typeof l.result=="string"?i(l.result.split(",")[1]):o(new Error("FileReader did not return a string for File object."))},l.onerror=c=>o(new Error(`FileReader failed for File object: ${c}`)),l.readAsDataURL(t)});else if(typeof t=="string"){console.warn(`Received string imageSource that is not a URL or Data URL: "${t}". This path is intended for Node.js file paths.`);try{console.log(`Attempting to read image from local path (Node.js context): ${t}`),n=(await(await Mt(()=>import("./__vite-browser-external-b25bb000.js"),[])).readFile(t)).toString("base64");const c=(await Mt(()=>import("./__vite-browser-external-b25bb000.js"),[])).extname(t).toLowerCase();if(!r)if(c===".png")r="image/png";else if(c===".jpg"||c===".jpeg")r="image/jpeg";else if(c===".webp")r="image/webp";else if(c===".gif")r="image/gif";else throw new Error(`Unsupported image extension or MIME type not provided for path: ${t}`)}catch(i){throw console.error("Failed to process string as Node.js file path (this is expected in browser):",i),new Error("Unsupported string imageSource in browser. Must be URL or Data URL, or provide a File object.")}}else throw new Error("Unsupported image source type. Provide a URL, Data URL, or File object.");if(!n)throw new Error("Could not obtain base64 image data.");r||(r="image/jpeg",console.warn("MIME type could not be determined, defaulting to image/jpeg."));const s=["image/png","image/jpeg","image/webp","image/heic","image/heif"];return s.includes(r)||console.warn(`MIME type ${r} may not be optimally supported. Supported types are: ${s.join(", ")}.`),{inlineData:{data:n,mimeType:r}}}async function wq({mainProduct:t,referenceSceneSource:e,additionalProducts:n=[],customInstructions:r=""}){var o,l,c,u,d,h,f,m;if(!t||!t.name||!t.imageSource)throw new Error("Main product with name and imageSource is required.");if(!e)throw new Error("Reference scene imageSource is required.");const s=[];let i=`Visually integrate the product named "${t.name}" into a scene inspired by the provided reference scene image.
The main product is described as: "${t.description||"Not specified"}".
The reference scene image sets the style, lighting, and overall environment.
Make the main product the primary focus, well-lit, and naturally fitting the scene's perspective.
`;n.length>0&&(i+=`
Also, incorporate the following additional products naturally into the scene:
`,n.forEach((g,x)=>{i+=`- Product ${x+1}: "${g.name}" (Description: "${g.description||"Not specified"}")
`})),r.trim()!==""&&(i+=`
Specific User Instructions: "${r.trim()}"
`),i+=`
Please generate a high-quality, photorealistic image based on these instructions and the provided images. Also provide a brief text commentary about the generated image or any challenges encountered.`,s.push({text:i});try{s.push(await fC(e)),s.push(await fC(t.imageSource));for(const g of n)if(g.imageSource)try{s.push(await fC(g.imageSource))}catch(x){console.warn(`Could not process image for additional product "${g.name}": ${x.message}. Skipping this image.`)}}catch(g){throw new Error(`Failed to process one or more input images: ${g.message}`)}console.log("Constructed prompt parts. Total parts:",s.length);try{const g=await oRe.models.generateContent({model:aRe,contents:[{role:"user",parts:s}],generationConfig:{temperature:.6,candidateCount:1},safetySettings:[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE}],config:{responseModalities:[bn.TEXT,bn.IMAGE]}}),x=g;if(!x)throw console.error("Full API result from Gemini was undefined:",g),new Error("Invalid or empty response from Gemini API.");let w=null,v="No specific commentary from the model.";console.log("Full API response from Gemini:",JSON.stringify(x,null,2)),(o=x.promptFeedback)!=null&&o.blockReason&&(v=`Image generation may have been blocked. Reason: ${x.promptFeedback.blockReason}.`,console.warn(v));const _=(l=x.candidates)==null?void 0:l[0];if(_){if(_.finishReason&&_.finishReason!=="STOP"&&_.finishReason!=="MAX_TOKENS"){const C=`Generation stopped. Reason: ${_.finishReason}.`;v=v==="No specific commentary from the model."?C:`${v}. ${C}`,console.warn(C)}if(((u=(c=_.content)==null?void 0:c.parts)==null?void 0:u.length)>0)for(const C of _.content.parts)C.text?v=v==="No specific commentary from the model."||!v.includes(C.text)?v==="No specific commentary from the model."?C.text:v+" "+C.text:v:(h=(d=C.inlineData)==null?void 0:d.mimeType)!=null&&h.startsWith("image/")&&(w=`data:${C.inlineData.mimeType};base64,${C.inlineData.data}`,console.log(`Image generated successfully. MIME type: ${C.inlineData.mimeType}`))}else(f=x.promptFeedback)!=null&&f.blockReason||(v=v==="No specific commentary from the model."?"No candidates returned by the model.":`${v}. Also, no candidates were returned.`);return!w&&v==="No specific commentary from the model."&&(v="Image generation failed, and no specific reason or commentary was provided."),{imageUrl:w,commentary:v,promptUsed:i}}catch(g){console.error("Error during Gemini API call or response processing:",g);let x=g.message;throw(m=g.response)!=null&&m.message?x=g.response.message:g.response&&(x=JSON.stringify(g.response)),new Error(`Product visualization failed: ${x}`)}}const bq=()=>{var He;const t=bi(),{currentStore:e,addToCart:n,getProductById:r,updateQuantity:s,viewMode:i}=zn(),{userRole:o}=eo(),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[h,f]=p.useState('You are a friendly and helpful AI assistant for an e-commerce store. Be concise and helpful. Always format your responses using Markdown. If a user asks you to find a product, your primary action should be to use the `find_and_open_product` function. **Only after the `find_and_open_product` function successfully returns product details (indicated by `product_found: true` in the function\'s result) should you then say something like "Here is the product I found for you:".** At that point, a product card will also be displayed by the UI. Following your acknowledgment, you MUST ask a relevant follow-up question, such as "Would you like to see more details, add it to your cart, or keep browsing?". If the function call indicates the product was not found (`product_found: false`), you should inform the user you could not find the product and offer to search again or help with something else. Do not repeat raw product data (like image URLs or full product objects) in your text response, as the card already displays this information.'),[m,g]=p.useState(""),[x,w]=p.useState([]),[v,_]=p.useState(null),[C,T]=p.useState(null),[R,A]=p.useState(!1),[E,I]=p.useState(null),P=p.useRef(null),k=p.useRef([]),j=p.useRef(null),D=p.useRef(null),[M,G]=p.useState(null),[B,W]=p.useState(!1),Q=p.useRef(!1),H={name:"find_and_open_product",description:"Finds a product based on a query (name, keywords, or ID) and returns its details for display. It does NOT navigate. After displaying, ask if the user wants to navigate or add to cart.",parameters:{type:Ke.OBJECT,properties:{product_query:{type:Ke.STRING,description:"The name, keywords, or ID of the product to find."}},required:["product_query"]}},Y={name:"navigate_to_product_detail_page",description:"Navigates the user to the detailed page for a specific product, given its ID.",parameters:{type:Ke.OBJECT,properties:{product_id:{type:Ke.STRING,description:"The unique ID of the product."},product_name:{type:Ke.STRING,description:"The name of the product (for confirmation)."}},required:["product_id"]}},V={name:"add_to_cart",description:"Adds a specified product to the user's shopping cart.",parameters:{type:Ke.OBJECT,properties:{product_id:{type:Ke.STRING,description:"The unique ID of the product to add."},product_name:{type:Ke.STRING,description:"The name of the product (for confirmation)."},quantity:{type:Ke.NUMBER,description:"The quantity to add. Defaults to 1 if not specified."}},required:["product_id"]}},$={name:"initiate_purchase",description:"Initiates the purchase process for a specified product, potentially by adding to cart and navigating to checkout or directly to a payment page.",parameters:{type:Ke.OBJECT,properties:{product_id:{type:Ke.STRING,description:"The unique ID of the product to purchase."},product_name:{type:Ke.STRING,description:"The name of the product (for confirmation)."}},required:["product_id"]}},z={name:"navigate_home",description:`Navigates the user to the application's home page (typically the root path "/").`,parameters:{type:Ke.OBJECT,properties:{}}},F={name:"navigate_to_content_creation_page",description:"Navigates the user to the content creation page.",parameters:{type:Ke.OBJECT,properties:{}}},Z={name:"navigate_to_store_dashboard",description:"Navigates the user to the store dashboard page.",parameters:{type:Ke.OBJECT,properties:{}}},fe={name:"navigate_to_route",description:'Navigates the user to a specified route within the application. Use for requests like "go to a specific page". This is a generic navigation tool.',parameters:{type:Ke.OBJECT,properties:{route:{type:Ke.STRING,description:'The path to navigate to (e.g., "/", "/content-creation", "/dashboard").'}},required:["route"]}},xe={name:"toggle_theme_mode",description:"Toggles the application's visual theme between light and dark mode.",parameters:{type:Ke.OBJECT,properties:{}}},ge={name:"open_import_store_dialog",description:"Opens the dialog or interface for importing a store from another platform.",parameters:{type:Ke.OBJECT,properties:{}}},Re={name:"go_to_cart",description:"Navigates the user to their shopping cart page.",parameters:{type:Ke.OBJECT,properties:{}}},Ue=[H,Y,V,$,fe,xe,ge,Re,z,F,Z],ze=()=>{var ce;(ce=j.current)==null||ce.scrollIntoView({behavior:"smooth"})};p.useEffect(ze,[x]);const he=()=>c(!l),Ce=()=>d(!u),Pe=()=>{d(!1)},ve=(ce=null)=>{const _e=typeof ce=="string"?ce:m;if(_e.trim()==="")return;const Be=`user-text-${Date.now()}`;w(Te=>[...Te,{id:Be,role:"user",text:_e}]),typeof ce!="string"&&g(""),v==="gemini"&&C?de(_e):console.error("Error: Gemini chat not active. Cannot send message.")},de=async ce=>{if(!C){console.error("Gemini chat not initialized.");return}try{const _e=await C.sendMessageStream({message:[{text:ce}]}),Be=`assistant-gemini-${Date.now()}`;w(wt=>[...wt,{id:Be,role:"assistant",text:"",functionCallData:null}]);let Te="",Et=null;for await(const wt of _e){let xt=null;wt.functionCalls&&wt.functionCalls.length>0?xt=wt.functionCalls[0]:wt.functionCall&&(xt=wt.functionCall),xt&&(Et=xt);const pt=wt.text;pt&&(Te+=pt,w(At=>At.map(On=>On.id===Be?{...On,text:Te}:On)))}Et?(w(wt=>wt.map(xt=>{if(xt.id===Be){let pt=`(Function call: ${Et.name})`;Et.name==="find_and_open_product"&&(pt="Searching for product…");const At=Te.trim()===""?pt:`${Te}
${pt}`;return{...xt,text:At,functionCallData:Et}}return xt})),await Lt(Et,Be)):Te.trim()!==""||w(wt=>wt.map(xt=>xt.id===Be?{...xt,text:"(Assistant responded without text)"}:xt))}catch(_e){console.error("Error sending/receiving Gemini message:",_e)}},Me=ce=>{const _e=ce.route;if(_e)try{return t(_e),{success:!0,detail:`Successfully navigated to ${_e}`}}catch(Be){return console.error("Navigation error:",Be),{success:!1,detail:`Failed to navigate: ${Be.message}`}}return{success:!1,detail:"Route not provided in arguments."}},Ge=ce=>({success:!0,detail:"Theme toggled (placeholder action)."}),yt=ce=>({success:!0,detail:"Import store dialog would be shown (placeholder action)."}),Pt=ce=>{try{return t("/cart"),{success:!0,detail:"Navigated to cart page."}}catch(_e){return console.error("Navigation to cart error:",_e),{success:!1,detail:`Failed to navigate to cart: ${_e.message}`}}},en=ce=>{var Et,wt,xt,pt,At,On,Tn,mr,mn;const _e=(Et=ce.product_query)==null?void 0:Et.toLowerCase().trim();if(!_e)return{success:!0,product_found:!1,detail:"Product query not provided."};if(!e||!e.products||e.products.length===0)return{success:!0,product_found:!1,detail:"No products available in the current store to search."};const Be=e.products;let Te=null;if(Te=Be.find(Ft=>{var Xt;return((Xt=Ft.name)==null?void 0:Xt.toLowerCase())===_e}),!Te){const Ft=_e.split(/\s+/).filter(Xt=>Xt.length>1);if(Ft.length>0){let Xt=Be.map(or=>{var Le,Ze;const J=((Le=or.name)==null?void 0:Le.toLowerCase())||"",ue=((Ze=or.description)==null?void 0:Ze.toLowerCase())||"";let we=0;return Ft.forEach(X=>{J.includes(X)&&(we+=2),ue.includes(X)&&(we+=1)}),J.includes(_e)&&(we+=5),ue.includes(_e)&&(we+=2),{product:or,score:we}});Xt=Xt.filter(or=>or.score>0).sort((or,J)=>J.score-or.score),Xt.length>0&&(Te=Xt[0].product)}}if(Te||/^[a-zA-Z0-9-_]+$/.test(_e)&&!_e.includes(" ")&&(Te=Be.find(Ft=>{var Xt;return((Xt=Ft.id)==null?void 0:Xt.toString())===_e})),Te){let Ft=null;return(xt=(wt=Te.image)==null?void 0:wt.src)!=null&&xt.large&&typeof Te.image.src.large=="string"?Ft=Te.image.src.large:(At=(pt=Te.image)==null?void 0:pt.src)!=null&&At.medium&&typeof Te.image.src.medium=="string"?Ft=Te.image.src.medium:(Tn=(On=Te.image)==null?void 0:On.src)!=null&&Tn.small&&typeof Te.image.src.small=="string"?Ft=Te.image.src.small:Te.image_url&&typeof Te.image_url=="string"?Ft=Te.image_url:Te.imageUrl&&typeof Te.imageUrl=="string"?Ft=Te.imageUrl:Te.image&&typeof Te.image=="string"?Ft=Te.image:Te.images&&Array.isArray(Te.images)&&Te.images.length>0&&((mr=Te.images[0])!=null&&mr.src)&&typeof Te.images[0].src=="string"?Ft=Te.images[0].src:(mn=Te.featuredImage)!=null&&mn.url&&typeof Te.featuredImage.url=="string"&&(Ft=Te.featuredImage.url),Ft&&typeof Ft=="string"&&Ft.trim()!==""?Ft=Ft.trim():Ft=null,{success:!0,product_found:!0,product_data:{id:Te.id,name:Te.name,description:Te.description||"No description available.",price:Te.price||"Price not available.",imageUrl:Ft},detail:`Found product: ${Te.name}`}}else return{success:!0,product_found:!1,detail:`Could not find a matching or relevant product for query: "${ce.product_query}"`}},fn=ce=>ce.product_id&&e&&e.id?(t(`/store/${e.id}/product/${ce.product_id}`),{success:!0,detail:`Navigated to product page for ID ${ce.product_id} in store ${e.id}`}):!e||!e.id?{success:!1,detail:"Current store information is not available for navigation."}:{success:!1,detail:"Product ID not provided for navigation."},an=ce=>{if(!e||!e.id)return{success:!1,detail:"Current store not available for cart operation."};if(!ce.product_id)return{success:!1,detail:"Product ID not provided to add to cart."};const _e=r(e.id,ce.product_id);if(_e){const Be=ce.quantity||1;return n(_e,e.id),Be>1&&s(ce.product_id,e.id,Be),{success:!0,detail:`${ce.product_name||_e.name||"Product"} added/updated in cart with quantity ${Be}.`}}else return{success:!1,detail:`Product with ID ${ce.product_id} not found.`}},dn=ce=>{const{product_id:_e,product_name:Be}=ce;if(!e||!e.id)return console.error("Buy Now: Current store not available."),{success:!1,detail:"Current store information is not available to initiate purchase."};if(!_e)return console.error("Buy Now: Product ID not provided."),{success:!1,detail:"Product ID not provided."};const Te=r(e.id,_e);if(!Te)return console.error(`Buy Now: Product with ID ${_e} not found.`),{success:!1,detail:`Product with ID ${_e} not found.`};try{return n(Te,e.id),t("/checkout",{state:{action:"buyNow",productToAddId:Te.id,storeId:e.id}}),{success:!0,detail:`Added ${Te.name||"product"} to cart and navigated to checkout.`}}catch(Et){return console.error("Error during Buy Now (add to cart & navigate) process:",Et),{success:!1,detail:Et.message||"Could not process Buy Now action."}}},Lt=async(ce,_e)=>{let Be,Te=!1;switch(ce.name){case"navigate_to_route":Be=Me(ce.args),Te=Be.success;break;case"toggle_theme_mode":Be=Ge(ce.args),Te=Be.success;break;case"open_import_store_dialog":Be=yt(ce.args),Te=Be.success;break;case"go_to_cart":Be=Pt(ce.args),Te=Be.success;break;case"navigate_home":Be=Me({route:"/"}),Te=Be.success;break;case"navigate_to_content_creation_page":Be=Me({route:"/content-creation"}),Te=Be.success;break;case"navigate_to_store_dashboard":Be=Me({route:"/dashboard"}),Te=Be.success;break;case"find_and_open_product":Be=en(ce.args),Te=Be.success;break;case"navigate_to_product_detail_page":Be=fn(ce.args),Te=Be.success;break;case"add_to_cart":Be=an(ce.args),Te=Be.success;break;case"initiate_purchase":Be=dn(ce.args),Te=Be.success;break;default:Be={success:!1,detail:`Error: Unknown function ${ce.name}`}}if(!Te){console.error(`Function ${ce.name} execution failed: ${Be.detail}`),w(wt=>wt.map(xt=>xt.id===_e?{...xt,text:(xt.text.replace(/\(Function call: .*\)/,"").trim()+`
(Function ${ce.name} failed)`).trim(),functionCallData:null}:xt));return}const Et={message:[{functionResponse:{name:ce.name,response:{result:Be}}}]};try{const wt=await C.sendMessageStream(Et);let xt="";w(pt=>pt.map(At=>At.id===_e?{...At,text:"",functionCallData:null,productCardData:null}:At));for await(const pt of wt){if(pt.functionCalls||pt.functionCall){console.error("Model attempted another function call immediately after a function response.");break}const At=pt.text;At&&(xt+=At,w(On=>On.map(Tn=>{if(Tn.id===_e){const mr={...Tn,text:xt};return ce.name==="find_and_open_product"&&Be.success&&Be.product_found&&(mr.productCardData=Be.product_data),mr}return Tn})))}ce.name==="find_and_open_product"&&Be.success&&Be.product_found&&w(pt=>pt.map(At=>At.id===_e?{...At,productCardData:Be.product_data}:At)),xt.trim()===""&&(ce.name==="find_and_open_product"&&Be.product_found?w(pt=>pt.map(At=>At.id===_e&&At.text.trim()===""?{...At,text:"Here is the product information:"}:At)):w(pt=>pt.map(At=>At.id===_e&&At.text.trim()===""?{...At,text:"(Function processed)"}:At)))}catch(wt){console.error("Error sending function response or getting final response from Gemini:",wt),w(xt=>xt.map(pt=>pt.id===_e?{...pt,text:(pt.text+`
(Error processing function result)`).trim(),functionCallData:null}:pt))}},xn=async()=>{if(C||B)return;W(!0);const ce="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s";try{const _e=new En({apiKey:ce}),Te=x.filter(xt=>xt.role==="user"||xt.role==="assistant").map(xt=>({role:xt.role==="assistant"?"model":"user",parts:[{text:xt.text||""}]})).filter(xt=>xt.parts.every(pt=>typeof pt.text=="string"&&pt.text.trim()!=="")),Et={tools:[{functionDeclarations:Ue}],systemInstruction:h},wt=_e.chats.create({model:"gemini-2.0-flash",history:Te,config:Et,generationConfig:{}});if(!wt)throw new Error("genAI.chats.create() returned a null or undefined chat instance.");T(wt),_("gemini"),Q.current=!1}catch(_e){console.error("Error initializing Gemini chat:",_e),T(null),_(null)}finally{W(!1)}},te=()=>{T(null),W(!1),_(null),Q.current=!1};p.useEffect(()=>(l?!C&&!B&&xn():te(),()=>te()),[l]),p.useEffect(()=>{v==="gemini"?Q.current?h&&!B&&C&&(T(null),Q.current=!1,xn()):Q.current=!0:Q.current=!1},[h,v,B,C]);const Ee=(ce,_e)=>{fn({product_id:ce})},ee=(ce,_e)=>{if(!e||!e.id){console.error("Cannot add to cart: current store not available.");return}const Be=r(e.id,ce);Be?n(Be,e.id):console.error(`Product with ID ${ce} not found, cannot add to cart.`)},le=async(ce,_e)=>{const Be=await dn({product_id:ce,product_name:_e});Be.success||console.error("Buy Now failed:",Be.detail)},K=(ce,_e)=>{var Be;G({id:ce,name:_e}),(Be=D.current)==null||Be.click()},Ae=ce=>{var Be,Te,Et,wt,xt,pt,At,On;if(!ce)return null;let _e=null;return(Te=(Be=ce.image)==null?void 0:Be.src)!=null&&Te.large&&typeof ce.image.src.large=="string"?_e=ce.image.src.large:(wt=(Et=ce.image)==null?void 0:Et.src)!=null&&wt.medium&&typeof ce.image.src.medium=="string"?_e=ce.image.src.medium:(pt=(xt=ce.image)==null?void 0:xt.src)!=null&&pt.small&&typeof ce.image.src.small=="string"?_e=ce.image.src.small:ce.image_url&&typeof ce.image_url=="string"?_e=ce.image_url:ce.imageUrl&&typeof ce.imageUrl=="string"?_e=ce.imageUrl:ce.image&&typeof ce.image=="string"?_e=ce.image:ce.images&&Array.isArray(ce.images)&&ce.images.length>0&&((At=ce.images[0])!=null&&At.src)?_e=ce.images[0].src:(On=ce.featuredImage)!=null&&On.url&&(_e=ce.featuredImage.url),_e&&typeof _e=="string"&&_e.trim()!==""?_e.trim():null},Ne=async ce=>{var Be;const _e=(Be=ce.target.files)==null?void 0:Be[0];if(!_e||!M){G(null),D.current&&(D.current.value="");return}w(Te=>[...Te,{id:`system-visualizing-${Date.now()}`,role:"system",text:`Visualizing ${M.name} with your uploaded image. This may take a moment...`}]);try{console.log("[ChatViz] Getting product details for ID:",M.id);const Te=r(e.id,M.id);if(!Te)throw console.error("[ChatViz] Product not found for ID:",M.id),new Error("Product details not found for visualization.");console.log("[ChatViz] Product found:",Te.name);const Et=Ae(Te);if(!Et)throw console.error("[ChatViz] Product actual image URL is missing or invalid for product:",Te.name,"Raw product data:",Te),new Error("Product does not have a valid existing image to use for visualization context.");console.log("[ChatViz] Actual Product imageUrl to use:",Et);const wt={name:Te.name,description:Te.description,imageSource:Et},xt=`Visualize the product "${Te.name}" in a new scene inspired by the provided reference image. Focus on a creative and appealing composition.`;console.log("[ChatViz] Calling generateProductVisualization...");const pt=await wq({mainProduct:wt,referenceSceneSource:_e,additionalProducts:[],customInstructions:xt});if(console.log("[ChatViz] generateProductVisualization result:",pt),pt&&pt.imageUrl)w(At=>[...At,{id:`assistant-viz-${Date.now()}`,role:"assistant",text:pt.commentary||`Here's a new visualization for ${Te.name}:`,imageDataUrl:pt.imageUrl}]);else throw console.error("[ChatViz] generateProductVisualization did not return an imageUrl. Commentary:",pt==null?void 0:pt.commentary),new Error((pt==null?void 0:pt.commentary)||"Visualization did not return an image.")}catch(Te){console.error("Error during visualization in chat:",Te.name,Te.message,Te.stack),w(Et=>[...Et,{id:`error-viz-${Date.now()}`,role:"system",text:`Sorry, I couldn't visualize the product. Error: ${Te.name} - ${Te.message}`}])}finally{G(null),D.current&&(D.current.value="")}},Oe=async()=>{if(R)P.current&&P.current.state==="recording"&&P.current.stop(),A(!1);else try{const ce=await navigator.mediaDevices.getUserMedia({audio:!0});P.current=new MediaRecorder(ce),k.current=[],P.current.ondataavailable=_e=>{k.current.push(_e.data)},P.current.onstop=async()=>{const _e=new Blob(k.current,{type:"audio/webm"});k.current=[],console.log("Audio recorded:",_e),w(Be=>[...Be,{id:`user-audio-${Date.now()}`,role:"user",text:"[User sent audio]"}]),setTimeout(()=>{const Be=`assistant-audio-${Date.now()}`;w(Te=>[...Te,{id:Be,role:"assistant",text:"[Assistant audio response]"}])},2e3)},P.current.start(),A(!0),w(_e=>[..._e,{id:`system-rec-${Date.now()}`,role:"system",text:"Recording started..."}])}catch(ce){console.error("Error accessing microphone:",ce),w(_e=>[..._e,{id:`error-mic-${Date.now()}`,role:"system",text:"Error: Could not access microphone."}])}};return p.useEffect(()=>()=>{E&&E.context.state!=="closed"&&E.context.close(),P.current&&P.current.stream&&P.current.stream.getTracks().forEach(ce=>ce.stop())},[E]),a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"file",ref:D,style:{display:"none"},accept:"image/*",onChange:Ne}),!l&&a.jsx(O,{onClick:he,className:"fixed bottom-[96px] right-0 py-4 pl-4 pr-1.5 shadow-lg z-50 rounded-tl-[20px] rounded-bl-[20px] rounded-tr-none rounded-br-none",size:"icon","aria-label":"Open Chatbot",style:{backgroundColor:((He=e==null?void 0:e.theme)==null?void 0:He.primaryColor)||"#007bff"},children:a.jsx(qie,{size:20})}),l&&a.jsxs(Je,{className:"fixed bottom-[96px] right-4 w-full max-w-md h-[70vh] max-h-[600px] shadow-xl z-[1000] flex flex-col bg-background border rounded-lg",children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between p-3 border-b",children:[a.jsx(ut,{className:"text-md font-semibold",children:"AI Assistant"}),a.jsxs("div",{className:"flex items-center gap-1",children:[(o==="admin"||i==="edit")&&a.jsx(O,{variant:"ghost",size:"icon",onClick:Ce,title:"Set Knowledge Base",children:a.jsx(noe,{size:18})}),a.jsx(O,{variant:"ghost",size:"icon",onClick:he,title:"Close Chat",children:a.jsx(Ki,{size:18})})]})]}),u&&a.jsxs("div",{className:"p-3 border-b bg-muted/40",children:[a.jsx("label",{htmlFor:"knowledgeBaseInput",className:"text-xs font-medium mb-1 block text-muted-foreground",children:"Knowledge Base (Instructions for Gemini)"}),a.jsx(Pn,{id:"knowledgeBaseInput",placeholder:"Enter instructions for the assistant...",value:h,onChange:ce=>f(ce.target.value),className:"h-28 text-xs mb-2 rounded-md"}),a.jsx(O,{onClick:Pe,size:"sm",className:"w-full",disabled:B||!C,children:"Save & Apply Instructions"})]}),a.jsxs(it,{className:"flex-grow p-3 overflow-y-auto space-y-3",children:[x.map(ce=>(ce.role==="user"||ce.role==="assistant")&&a.jsx("div",{className:`flex flex-col ${ce.role==="user"?"items-end":"items-start"}`,children:a.jsx("div",{className:`max-w-[80%] p-2.5 rounded-lg text-sm ${ce.role==="user"?"bg-primary text-primary-foreground rounded-br-none":"bg-muted rounded-bl-none"}`,children:ce.role==="assistant"?a.jsxs(a.Fragment,{children:[ce.productCardData&&a.jsx(sRe,{productData:ce.productCardData,onViewDetails:Ee,onAddToCart:ee,onBuyNow:le,onVisualize:ce.productCardData.imageUrl&&typeof ce.productCardData.imageUrl=="string"&&ce.productCardData.imageUrl.trim()!==""?K:null}),ce.imageDataUrl&&a.jsx("img",{src:ce.imageDataUrl,alt:"Generated visualization",className:"max-w-full h-auto rounded-md my-2"}),ce.text&&a.jsx("div",{className:`prose prose-sm max-w-none dark:prose-invert ${ce.productCardData||ce.imageDataUrl?"mt-2":""}`,children:a.jsx(Zke,{children:ce.text})}),!ce.productCardData&&!ce.text&&!ce.imageDataUrl&&a.jsx("p",{className:"whitespace-pre-wrap",children:"(Assistant message)"})]}):a.jsx("p",{className:"whitespace-pre-wrap",children:ce.text})})},ce.id)),a.jsx("div",{ref:j})]}),a.jsx(yd,{className:"p-3 border-t",children:a.jsxs("div",{className:"flex w-full items-center gap-2",children:[a.jsx(O,{onClick:Oe,size:"icon",variant:R?"destructive":"outline",title:R?"Stop Recording":"Start Recording",disabled:!v||B,className:"p-2",children:R?a.jsx(ioe,{size:18}):a.jsx(Kie,{size:18})}),a.jsx(Pn,{placeholder:R?"Recording audio...":"Type a message or use microphone...",value:m,onChange:ce=>g(ce.target.value),onKeyPress:ce=>{ce.key==="Enter"&&!ce.shiftKey&&(ce.preventDefault(),ve())},className:"flex-grow resize-none text-sm p-2 rounded-md min-h-[40px] max-h-[100px]",rows:1,disabled:!v||B||R}),a.jsx(O,{onClick:()=>ve(),size:"icon",title:"Send Message",disabled:!m.trim()||!v||B||R,children:a.jsx(toe,{size:18})})]})})]})]})};function lRe({title:t,titleId:e,...n},r){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?p.createElement("title",{id:e},t):null,p.createElement("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"}))}const cRe=p.forwardRef(lRe),uRe=cRe;function dRe({title:t,titleId:e,...n},r){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?p.createElement("title",{id:e},t):null,p.createElement("path",{d:"M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z"}))}const hRe=p.forwardRef(dRe),fRe=hRe,Yn=({initialText:t,onSave:e,isAdmin:n,placeholder:r="Enter text...",as:s="span",className:i="",textClassName:o="",inputClassName:l="",useTextarea:c=!1})=>{const[u,d]=p.useState(!1),[h,f]=p.useState(t),m=p.useRef(null);p.useEffect(()=>{f(t)},[t]),p.useEffect(()=>{u&&m.current&&(m.current.focus(),m.current.select(),c&&(m.current.style.height="auto",m.current.style.height=`${m.current.scrollHeight}px`))},[u,c]);const g=()=>{e&&e(h),d(!1)},x=_=>{f(_.target.value),c&&m.current&&(m.current.style.height="auto",m.current.style.height=`${m.current.scrollHeight}px`)},w=_=>{_.key==="Enter"&&!c?g():_.key==="Escape"&&(f(t),d(!1))},v=s;return n?a.jsx(v,{className:`inline-text-edit-container relative group ${i} ${u?"w-full":""}`,children:u?a.jsxs("div",{className:"flex items-start space-x-1 w-full",children:[" ",c?a.jsx("textarea",{ref:m,value:h,onChange:x,onKeyDown:w,onBlur:g,className:`p-0 m-0 border-none focus:ring-0 focus:outline-none resize-none overflow-hidden bg-transparent text-inherit font-inherit w-full ${o} ${l}`,placeholder:r,rows:1}):a.jsx("input",{ref:m,type:"text",value:h,onChange:x,onKeyDown:w,onBlur:g,className:`p-0 m-0 border-none focus:ring-0 focus:outline-none bg-transparent text-inherit font-inherit w-full ${o} ${l}`,placeholder:r}),a.jsx("button",{onClick:g,className:"p-1 text-green-500 hover:text-green-700 flex-shrink-0",title:"Save",children:a.jsx(uRe,{className:"h-5 w-5"})})]}):a.jsxs("div",{className:`flex items-center space-x-1 cursor-pointer w-full ${o}`,onClick:()=>d(!0),role:"button",tabIndex:0,onKeyDown:_=>{_.key==="Enter"&&d(!0)},children:[a.jsx("span",{className:"flex-grow",children:h||r}),a.jsx(fRe,{className:"h-4 w-4 text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"})]})}):a.jsx(v,{className:o,children:h||r})},mRe=({store:t,isPublishedView:e=!1})=>{var f;const{updateStore:n}=zn(),r=(t==null?void 0:t.name)||"Our Store",s=t==null?void 0:t.id,i=!e,o={title:`The ${r} Way`,subtitle:"Discover the core values that make us unique.",items:[{emoji:"✨",icon:Er,title:"Quality First",description:"We prioritize premium materials and craftsmanship in every product."},{emoji:"🌿",icon:Bie,title:"Sustainable Practices",description:"Committed to eco-friendly sourcing and ethical production."},{emoji:"⚡️",icon:q3,title:"Innovative Design",description:"Blending timeless styles with modern, cutting-edge aesthetics."},{emoji:"💖",icon:O3,title:"Customer Love",description:"Our customers are at the heart of everything we do."}]},l=((f=t==null?void 0:t.content)==null?void 0:f.storeWay)||o,c=l.items&&l.items.length>0?l.items:o.items,u=async(m,g,x=null)=>{if(!s)return;let w={title:l.title,subtitle:l.subtitle,items:[...c].map(v=>({...v}))};x!==null&&w.items[x]?m==="itemTitle"?w.items[x].title=g:m==="itemDescription"?w.items[x].description=g:m==="itemEmoji"&&(w.items[x].emoji=g):m==="title"?w.title=g:m==="subtitle"&&(w.subtitle=g);try{await n(s,{content:{...t.content,storeWay:w}})}catch(v){console.error(`Failed to update store way content for ${m}:`,v)}},d=({item:m})=>{const g=m.icon||W3;return a.jsx(g,{className:"w-8 h-8 mb-4 text-[var(--theme-primary)]"})},h=(t==null?void 0:t.template_version)||"classic";return a.jsx("section",{className:"py-16 md:py-24 bg-background",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12 md:mb-16",children:[a.jsx("div",{className:`inline-flex items-center justify-center bg-[var(--theme-primary-10)] p-3 mb-4 ${h!=="sleek"?"rounded-full":""}`,children:a.jsx(Qv,{className:"h-8 w-8 text-[var(--theme-primary)]"})}),a.jsx(Yn,{initialText:l.title,onSave:m=>u("title",m),isAdmin:i,placeholder:"Section Title",as:"h2",textClassName:"text-4xl md:text-5xl font-bold tracking-tight text-foreground"}),a.jsx(Yn,{initialText:l.subtitle,onSave:m=>u("subtitle",m),isAdmin:i,placeholder:"Section Subtitle",as:"p",textClassName:"text-lg text-muted-foreground max-w-xl mx-auto mt-3"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:c.map((m,g)=>a.jsxs(It.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.4,delay:g*.1+.2},className:`bg-card p-6 shadow-lg text-center border border-border/50 hover:shadow-2xl transition-shadow ${h!=="sleek"?"rounded-xl":""}`,children:[a.jsxs("div",{className:"flex justify-center items-center mb-4",children:[i?a.jsx(Yn,{initialText:m.emoji,onSave:x=>u("itemEmoji",x,g),isAdmin:i,placeholder:"✨",textClassName:"text-4xl"}):a.jsx("span",{className:"text-4xl",children:m.emoji}),!m.emoji&&a.jsx(d,{item:m})]}),a.jsx("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:a.jsx(Yn,{initialText:m.title,onSave:x=>u("itemTitle",x,g),isAdmin:i,placeholder:"Item Title"})}),a.jsx("p",{className:"text-muted-foreground text-sm",children:a.jsx(Yn,{initialText:m.description,onSave:x=>u("itemDescription",x,g),isAdmin:i,placeholder:"Item Description",useTextarea:!0})})]},g))})]})})},_q="CEVWpXluVU77FgaVriTzqBCoN4FD3f0VL2Y8bXNPynNfqUg2DoUgPt8t",pRe="https://api.pexels.com/videos",gRe="https://api.pexels.com/v1";async function Sq(t,e=15){if(!t||!t.trim())return{error:"Search query cannot be empty."};const n=t.split(" ")[0],r=`${pRe}/search?query=${encodeURIComponent(n)}&per_page=${e}`;try{const s=await fetch(r,{headers:{Authorization:_q}});if(!s.ok){const d=await s.json().catch(()=>({message:s.statusText}));return console.error("Pexels API error:",s.status,d),{error:`Pexels API error: ${d.message||s.statusText}`}}const i=await s.json();if(!i.videos||i.videos.length===0)return{videos:[],totalResults:0};const o=Math.floor(Math.random()*i.videos.length),l=i.videos[o],c=l.video_files.find(d=>d.file_type==="video/mp4"&&(d.quality==="hd"||d.quality==="sd"))||l.video_files.find(d=>d.file_type==="video/mp4");return{video:{id:l.id,width:l.width,height:l.height,duration:l.duration,imageUrl:l.image,videoUrl:c?c.link:l.video_files[0]?l.video_files[0].link:null,photographer:l.user.name,pexelsUrl:l.url},totalResults:i.total_results}}catch(s){return console.error("Error fetching from Pexels API:",s),{error:`Network error or other issue fetching Pexels videos: ${s.message}`}}}async function yRe(t,e=9){if(!t||!t.trim())return{error:"Search query cannot be empty."};const n=`${gRe}/search?query=${encodeURIComponent(t)}&per_page=${e}`;try{const r=await fetch(n,{headers:{Authorization:_q}});if(!r.ok){const o=await r.json().catch(()=>({message:r.statusText}));return console.error("Pexels API error:",r.status,o),{error:`Pexels API error: ${o.message||r.statusText}`}}const s=await r.json();return{photos:s.photos.map(o=>({id:o.id,width:o.width,height:o.height,src:o.src.medium,alt:o.alt,photographer:o.photographer,pexelsUrl:o.url})),totalResults:s.total_results,page:s.page,perPage:s.per_page}}catch(r){return console.error("Error fetching from Pexels API:",r),{error:`Network error or other issue fetching Pexels photos: ${r.message}`}}}const xRe=({open:t,onOpenChange:e,storeId:n,currentVideoUrl:r,onVideoReplaced:s})=>{const[i,o]=p.useState("ai"),[l,c]=p.useState(""),[u,d]=p.useState(!1),[h,f]=p.useState(null),[m,g]=p.useState(""),[x,w]=p.useState(null),[v,_]=p.useState(!1),[C,T]=p.useState(null),[R,A]=p.useState(null),[E,I]=p.useState(null),[P,k]=p.useState(!1);p.useEffect(()=>{t&&(c(""),d(!1),f(null),g(""),w(null),_(!1),T(null),A(null),I(null),k(!1))},[t]);const j=async()=>{if(!l.trim()){f("Please enter a prompt for the video.");return}d(!0),f(null);try{console.log(`Generating video for store ${n} with prompt: "${l}"`);const W=await $ae(l);s&&s(W),e(!1),c("")}catch(W){console.error("Error generating video with AI:",W),f(W.message||"Failed to generate video. Please try again.")}finally{d(!1)}},D=async()=>{if(!m.trim()){T("Please enter a search query for Pexels.");return}_(!0),T(null),w(null);try{const W=await Sq(m);W.error?T(W.error):W.video?w(W.video):T("No video found for your query.")}catch(W){console.error("Error searching Pexels videos:",W),T(W.message||"Failed to search Pexels. Please try again.")}finally{_(!1)}},M=W=>{s&&W?(s(W),e(!1)):T("Invalid video URL selected or replacement handler missing.")},G=W=>{const Q=W.target.files[0];if(Q){if(Q.size>50*1024*1024){I("File is too large. Please select a video under 50MB."),A(null);return}if(!Q.type.startsWith("video/")){I("Invalid file type. Please select a video file."),A(null);return}A(Q),I(null)}},B=()=>{if(R&&s){k(!0),I(null);const W=new FileReader;W.onloadend=()=>{s(W.result),e(!1),A(null),k(!1)},W.onerror=()=>{I("Failed to read video file for upload."),k(!1)},W.readAsDataURL(R)}else I("No video file selected or replacement handler missing.")};return a.jsx(Xr,{open:t,onOpenChange:e,children:a.jsxs(Ur,{className:"w-[90vw] sm:max-w-[672px]",children:[a.jsxs(Br,{className:"text-left",children:[a.jsx(zr,{children:"Replace Hero Video"}),a.jsxs(Zi,{className:"text-left",children:["Current video: ",a.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline truncate block max-w-full",children:r||"No video set"})]})]}),a.jsxs(Si,{value:i,onValueChange:o,className:"w-full",children:[a.jsxs(ti,{className:"grid w-full grid-cols-3",children:[" ",a.jsx(Ot,{value:"ai",children:"AI Generation (Veo)"}),a.jsx(Ot,{value:"pexels",children:"Search Pexels"}),a.jsx(Ot,{value:"upload",children:"Upload Video"})," "]}),a.jsxs(Vt,{value:"ai",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"aiPrompt",className:"text-left block mb-1",children:"AI Video Prompt"}),a.jsx(Ye,{id:"aiPrompt",value:l,onChange:W=>c(W.target.value),placeholder:"e.g., A futuristic cityscape at sunset",disabled:u})]}),h&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:h}),a.jsxs(Ar,{className:"justify-start pt-4",children:[a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:u,children:"Cancel"}),a.jsx(O,{onClick:j,disabled:u||!l.trim(),children:u?"Generating...":"Generate Video"})]})]}),a.jsxs(Vt,{value:"pexels",className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{id:"pexelsQuery",value:m,onChange:W=>g(W.target.value),placeholder:"e.g., Nature, Business, Technology",disabled:v,className:"flex-grow"}),a.jsx(O,{onClick:D,disabled:v||!m.trim(),children:v?"Searching...":"Search"})]}),C&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:C}),v&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Loading Pexels video..."}),!v&&x&&a.jsx("div",{className:"flex justify-center",children:a.jsxs("div",{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border hover:border-primary w-full max-w-md",onClick:()=>M(x.videoUrl),children:[a.jsx("img",{src:x.imageUrl,alt:`Pexels video by ${x.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),a.jsx("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:a.jsx("p",{className:"text-white text-lg font-semibold text-center p-2 bg-black/50 rounded",children:"Use This Video"})})]})}),a.jsx(Ar,{className:"justify-start pt-4",children:a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:v,children:"Cancel"})})]}),a.jsxs(Vt,{value:"upload",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"video-upload-input",className:"text-left block mb-1",children:"Select Video File"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(Ye,{id:"video-upload-input",type:"file",accept:"video/*",onChange:G,className:"flex-grow",disabled:P})}),R&&a.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected: ",R.name," (",(R.size/1024/1024).toFixed(2)," MB)"]}),E&&a.jsx("p",{className:"text-sm text-red-500 text-center mt-2",children:E})]}),a.jsxs(Ar,{className:"justify-start pt-4",children:[a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:P,children:"Cancel"}),a.jsx(O,{onClick:B,disabled:P||!R,children:P?"Uploading...":"Confirm Upload"})]})]})]})]})})},vRe=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),wRe=({isOpen:t,onOpenChange:e,currentImageUrl:n,onImageSelected:r,imageSearchContext:s="image",modalTitle:i="Change Image",storeName:o="your store"})=>{const{toast:l}=bs(),[c,u]=p.useState("search"),[d,h]=p.useState(s),[f,m]=p.useState([]),[g,x]=p.useState(!1),[w,v]=p.useState(`A visually appealing ${s} for ${o}`),_=async()=>{if(d.trim()){x(!0),m([]);try{const A=await lo(d,9,"landscape");m(A.map(E=>({id:E.id.toString(),src:{medium:E.src.large,large:E.src.large},alt:E.alt||d,photographer:E.photographer})))}catch(A){l({title:"Pexels Search Failed",description:A.message,variant:"destructive"})}x(!1)}},C=async()=>{if(w.trim()){x(!0),m([]);try{const A=await j0(w);if(A&&A.url)m([{id:Dt(),src:{medium:A.url,large:A.url},alt:A.alt||w,photographer:"Generated by AI"}]),l({title:"AI Image Generated",description:"Select the image below or generate more."});else throw new Error("AI did not return an image URL.")}catch(A){l({title:"AI Image Generation Failed",description:A.message,variant:"destructive"})}x(!1)}},T=async A=>{const E=A.target.files[0];if(E){x(!0);try{const I=await vRe(E);r(I),l({title:"Image Uploaded",description:"Your image has been selected."}),e(!1)}catch{l({title:"Upload Failed",description:"Could not process the uploaded file.",variant:"destructive"})}x(!1)}},R=A=>{r(A),e(!1)};return p.useEffect(()=>{t&&(h(s||"abstract background"),v(`A visually appealing ${s||"image"} for ${o||"a store"}`),m([]),u("search"))},[t,s,o]),a.jsx(Xr,{open:t,onOpenChange:e,children:a.jsxs(Ur,{className:"sm:max-w-2xl md:max-w-3xl lg:max-w-4xl",children:[a.jsx(Br,{children:a.jsx(zr,{children:i})}),a.jsxs("div",{className:"py-4",children:[a.jsxs(Si,{value:c,onValueChange:u,className:"w-full",children:[a.jsxs(ti,{className:"grid w-full grid-cols-3",children:[a.jsx(Ot,{value:"search",children:"Search Pexels"}),a.jsx(Ot,{value:"ai",children:"Generate with AI"}),a.jsx(Ot,{value:"upload",children:"Upload"})]}),a.jsx(Vt,{value:"search",className:"mt-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{placeholder:"Search for images on Pexels...",value:d,onChange:A=>h(A.target.value),onKeyPress:A=>A.key==="Enter"&&_()}),a.jsxs(O,{onClick:_,disabled:g||!d.trim(),children:[g?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(ic,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Search"})]})]})}),a.jsx(Vt,{value:"ai",className:"mt-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{placeholder:"Describe the image you want AI to generate...",value:w,onChange:A=>v(A.target.value),onKeyPress:A=>A.key==="Enter"&&C()}),a.jsxs(O,{onClick:C,disabled:g||!w.trim(),children:[g?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(Ca,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Generate"})]})]})}),a.jsxs(Vt,{value:"upload",className:"mt-4",children:[a.jsx(De,{htmlFor:"image-upload-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Upload your own image:"}),a.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-md",children:a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsx(Uo,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsxs("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:[a.jsxs("label",{htmlFor:"image-upload-input-file",className:"relative cursor-pointer bg-white dark:bg-gray-800 rounded-md font-medium text-primary hover:text-primary-focus focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary-ring",children:[a.jsx("span",{children:"Upload a file"}),a.jsx(Ye,{id:"image-upload-input-file",name:"image-upload-input-file",type:"file",className:"sr-only",accept:"image/*",onChange:T})]}),a.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF up to 10MB"})]})})]})]}),g&&f.length===0&&a.jsxs("div",{className:"text-center py-10",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin mx-auto text-primary"}),a.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Fetching images..."})]}),f.length>0&&a.jsx(ScrollArea,{className:"mt-4 max-h-[50vh]",children:a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 p-1",children:f.map(A=>a.jsxs(It.div,{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border-2 border-transparent hover:border-primary transition-all",onClick:()=>R(A.src.large||A.src.medium),whileHover:{scale:1.03},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[a.jsx("img",{src:A.src.medium,alt:A.alt||"Search result",className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(bRe,{className:"h-10 w-10 text-white"})}),a.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] p-1 truncate text-center",children:A.photographer||A.alt||"Untitled"})]},A.id))})})]}),a.jsx(Ar,{children:a.jsx(il,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",children:"Cancel"})})})]})})},bRe=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),_Re=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");e({base64ImageData:i,mimeType:o[1]})}catch(r){n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o=s.toDataURL("image/png"),l="image/png";(!o||o.length<100)&&(o=s.toDataURL("image/jpeg"),l="image/jpeg");const c=o.split(",");e({base64ImageData:c[1],mimeType:l})}catch(o){n(new Error("Canvas toDataURL failed: "+o.message))}},r.onerror=()=>n(new Error("Failed to load image from URL for conversion.")),r.src=t}}),SRe=({isOpen:t,onOpenChange:e,currentImageUrl:n,onImageEdited:r,imageContext:s="image",modalTitle:i="Edit Image with AI"})=>{const{toast:o}=bs(),[l,c]=p.useState(""),[u,d]=p.useState(!1),[h,f]=p.useState("");p.useEffect(()=>{t&&n&&(f(n),c(""))},[t,n]);const m=async()=>{if(!l.trim()||!h){o({title:"Missing data",description:"Image or edit prompt is missing.",variant:"destructive"});return}d(!0);try{const{base64ImageData:g,mimeType:x}=await _Re(h),w=await Wo(g,x,l);if(w&&w.editedImageData&&w.newMimeType){const v=`data:${w.newMimeType};base64,${w.editedImageData}`;r(v),o({title:"Image Edited",description:"Image updated with AI edit."}),e(!1)}else throw new Error((w==null?void 0:w.textResponse)||"AI did not return an edited image.")}catch(g){console.error("Error editing image:",g),o({title:"Image Edit Failed",description:g.message,variant:"destructive"})}d(!1)};return a.jsx(Xr,{open:t,onOpenChange:e,children:a.jsxs(Ur,{className:"sm:max-w-md",children:[a.jsx(Br,{children:a.jsx(zr,{children:i})}),a.jsxs("div",{className:"space-y-4 py-4",children:[h&&a.jsxs("div",{className:"flex flex-col items-center space-y-2 mb-4",children:[a.jsx("img",{src:h,alt:`Current ${s} to edit`,className:"max-h-48 w-auto object-contain rounded border"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Editing: Current ",s]})]}),a.jsx(De,{htmlFor:"editPrompt",className:"text-left",children:"Edit Instruction:"}),a.jsx(Pn,{id:"editPrompt",placeholder:`e.g., 'make the background blue', 'add sparkles to the ${s}'`,value:l,onChange:g=>c(g.target.value),rows:3,className:"resize-none"})]}),a.jsxs(Ar,{children:[a.jsx(il,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",disabled:u,children:"Cancel"})}),a.jsxs(O,{onClick:m,disabled:u||!l.trim(),children:[u?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ca,{className:"mr-2 h-4 w-4"}),"Apply Edit"]})]})]})})},Cq=({store:t,isPublishedView:e=!1})=>{var F,Z,fe,xe,ge,Re,Ue,ze,he,Ce,Pe;const{updateStore:n,updateStoreTextContent:r}=zn(),[s,i]=p.useState(0),[o,l]=p.useState(null),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(!1),[g,x]=p.useState(!1),[w,v]=p.useState(null),_=p.useRef(null),C={Shield:roe,Truck:nw,CreditCard:Do,Headphones:_2,Star:MI,Zap:q3,GlobeIcon:Lu,AwardIcon:Aie,UsersIcon:L0,HeartIcon:O3,CheckCircle:ya,Sparkles:Er,ArrowRight:Mu,Play:DI,Pause:Xie,Package:Oi},T=Rhe(_,{once:!0,margin:"-100px"}),{scrollYProgress:R}=Phe({target:_,offset:["start end","end start"]}),A=vS(R,[0,1],[100,-100]),E=vS(R,[0,.2,.8,1],[0,1,1,0]),I=vS(R,[0,.2,.8,1],[.9,1,1,.9]),P=((F=t==null?void 0:t.theme)==null?void 0:F.primaryColor)||"#6366F1",k=t==null?void 0:t.id,j=!e,D={title:"An Exceptional Experience",subtitle:"We're committed to providing you with the best shopping experience through our premium services and customer-first approach.",items:[{emoji:"",iconName:"Zap",title:"Smart Solutions",description:"Innovative products designed for modern living and efficiency.",color:"#007AFF",stats:"Future Ready",image:"https://images.pexels.com/photos/373543/pexels-photo-373543.jpeg?auto=compress&cs=tinysrgb&w=600&q=80",videoUrl:""},{emoji:"🚚",icon:nw,title:"Fast Delivery",description:"Free shipping worldwide with express delivery options available.",color:"#3B82F6",stats:"2-3 Days",image:"https://images.unsplash.com/photo-1566576912321-d58ddd7a6088?w=600&q=80"},{emoji:"💳",icon:Do,title:"Easy Returns",description:"30-day hassle-free returns with full refund guarantee.",color:"#8B5CF6",stats:"30 Days",image:"https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=600&q=80"},{emoji:"🎧",icon:_2,title:"24/7 Support",description:"Round-the-clock customer support via chat, email, and phone.",color:"#F59E0B",stats:"Always On",image:"https://images.unsplash.com/photo-1553484771-371a605b060b?w=600&q=80"}],secondaryItems:[{iconName:"GlobeIcon",title:"Global Reach",description:"Serving customers in 50+ countries"},{iconName:"AwardIcon",title:"Premium Quality",description:"Certified products with quality guarantee"},{iconName:"UsersIcon",title:"Community Driven",description:"Join 100K+ satisfied customers"},{iconName:"HeartIcon",title:"Eco-Conscious",description:"Sustainable packaging and practices"}],statsItems:[{iconName:"UsersIcon",number:"50K+",label:"Happy Customers"},{iconName:"ZapIcon",number:"99.9%",label:"Uptime"},{iconName:"HeadphonesIcon",number:"24/7",label:"Support"},{iconName:"StarIcon",number:"4.9★",label:"Rating"}]},M=(Z=t==null?void 0:t.content)!=null&&Z.storeFeatures?{...D,...t.content.storeFeatures,items:t.content.storeFeatures.items&&t.content.storeFeatures.items.length>0?t.content.storeFeatures.items:D.items,secondaryItems:t.content.storeFeatures.secondaryItems&&t.content.storeFeatures.secondaryItems.length>0?t.content.storeFeatures.secondaryItems:D.secondaryItems,statsItems:t.content.storeFeatures.statsItems&&t.content.storeFeatures.statsItems.length>0?t.content.storeFeatures.statsItems:D.statsItems}:D,G=M.items&&M.items.length>0?M.items:D.items;p.useEffect(()=>{const ve=async()=>{const de=G[s];if(de&&!de.videoUrl){const Me=de.title||de.description||"modern abstract motion";try{console.log(`[Modern StoreFeatures] Fetching Pexels video for active feature "${Me}"`);const Ge=await Sq(Me);Ge&&Ge.video?(l(Ge.video.videoUrl),u(Ge.video.imageUrl)):(console.warn(`No Pexels video found for query: "${Me}". Clearing previous Pexels video.`),l(null),u(null))}catch(Ge){console.error(`Failed to fetch Pexels video for query "${Me}":`,Ge),l(null),u(null)}}else de&&de.videoUrl&&(l(null),u(null))};G&&G.length>0&&s<G.length&&ve()},[s,G]);const B=async(ve,de)=>{!k||!j||console.log(`[ModernStoreFeatures] handleSaveText called with field: ${ve}, value: ${de}. This might be redundant if InlineTextEdit is used.`)},W=ve=>{v(ve),m(!0)},Q=async ve=>{if(k==null||w==null||!ve)return;const de=JSON.parse(JSON.stringify(M));if(de.items&&de.items[w])de.items[w].image=ve,de.items[w].videoUrl="";else{console.error("Cannot update feature image: active feature item not found."),m(!1);return}try{await n(k,{content:{...t.content,storeFeatures:de}})}catch(Me){console.error("Failed to update store with new feature image URL:",Me)}m(!1),v(null)},H=()=>h(!0),Y=async ve=>{if(!k||!j||s===null||!G[s])return;const de=JSON.parse(JSON.stringify(M));if(de.items&&de.items[s])de.items[s].videoUrl=ve,de.items[s].image="",l(null),u(null);else{console.error("Cannot update video URL: active feature item not found."),h(!1);return}try{await n(k,{content:{...t.content,storeFeatures:de}})}catch(Me){console.error("Failed to update store with new feature video URL:",Me)}h(!1)},V={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},$={hidden:{opacity:0,y:30},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.25,.46,.45,.94]}}},z={hidden:{opacity:0,x:-50},visible:{opacity:1,x:0,transition:{duration:.8,ease:[.25,.46,.45,.94]}}};return a.jsxs("section",{ref:_,className:"relative py-20 gradient-bg overflow-hidden",id:`features-${k}`,children:[a.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[a.jsx(It.div,{className:"absolute top-20 left-20 w-96 h-96 bg-primary/5 blur-3xl rounded-full",style:{backgroundColor:`${P}10`,y:A}}),a.jsx(It.div,{className:"absolute bottom-20 right-20 w-80 h-80 bg-secondary/5 blur-3xl rounded-full",style:{y:A}}),a.jsx(It.div,{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-accent/5 blur-3xl rounded-full",animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},transition:{duration:8,repeat:1/0}})]}),a.jsxs(It.div,{className:"container mx-auto px-6 relative z-10",style:{opacity:E,scale:I},children:[a.jsxs(It.div,{variants:V,initial:"hidden",animate:T?"visible":"hidden",className:"text-center mb-20",children:[a.jsxs(It.div,{variants:$,className:"inline-flex items-center gap-2 px-4 py-2 bg-white/10 dark:bg-black/10 backdrop-blur-md border border-white/20 dark:border-white/10 rounded-full text-sm font-medium mb-6",style:{color:P,borderColor:`${P}30`},children:[a.jsx(Er,{className:"w-4 h-4"}),a.jsx("span",{children:"Why Choose Us"})]}),a.jsx(It.h2,{variants:$,className:"text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 dark:text-white mb-6 tracking-tight",children:a.jsx(Yn,{initialText:M.title,onSave:ve=>B("title",ve),isAdmin:j,placeholder:"Section Title",as:"span",textClassName:"bg-gradient-to-r from-gray-900 via-primary to-gray-900 dark:from-white dark:via-primary dark:to-white bg-clip-text text-transparent",style:{backgroundImage:`linear-gradient(90deg, currentColor, ${P}, currentColor)`}})}),a.jsx(It.p,{variants:$,className:"text-xl text-muted-foreground max-w-3xl mx-auto leading-relaxed",children:a.jsx(Yn,{initialText:M.subtitle,onSave:ve=>B("subtitle",ve),isAdmin:j,placeholder:"Section Subtitle",as:"span"})})]}),a.jsxs(It.div,{variants:V,initial:"hidden",animate:T?"visible":"hidden",className:"grid lg:grid-cols-2 gap-16 mb-20",children:[a.jsx(It.div,{variants:z,className:"space-y-6",children:G.map((ve,de)=>{const Me=ve.icon||Oi,Ge=s===de;return a.jsx(It.div,{className:`p-6 rounded-3xl border transition-all duration-500 cursor-pointer ${Ge?"bg-white/20 dark:bg-black/20 border-white/30 dark:border-white/20 shadow-float-lg":"bg-white/10 dark:bg-black/10 border-white/20 dark:border-white/10 hover:bg-white/15 dark:hover:bg-black/15"}`,onClick:()=>i(de),whileHover:{scale:1.02,y:-5},whileTap:{scale:.98},initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{delay:de*.1},children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center shadow-lg text-3xl",style:{backgroundColor:ve.color||P+"30"},children:ve.emoji||a.jsx(Me,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a.jsx(Yn,{initialText:ve.title,onSave:yt=>B("itemTitle",yt),isAdmin:j,placeholder:"Feature Title"})}),ve.stats&&a.jsx(pg,{variant:"secondary",className:"text-xs font-medium",style:{backgroundColor:`${ve.color||P}20`,color:ve.color||P},children:ve.stats})]}),a.jsx("p",{className:"text-muted-foreground leading-relaxed",children:a.jsx(Yn,{initialText:ve.description,onSave:yt=>B("itemDescription",yt),isAdmin:j,placeholder:"Feature Description",useTextarea:!0})}),Ge&&a.jsx(It.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t border-white/20 dark:border-white/10",children:a.jsxs(O,{variant:"outline",size:"sm",className:"group",style:{borderColor:ve.color||P,color:ve.color||P},children:["Learn More",a.jsx(Mu,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})})]})]})},ve.title+de)})}),G[s]&&a.jsxs(It.div,{variants:$,className:"relative aspect-square lg:aspect-[4/3] rounded-3xl overflow-hidden shadow-float-lg group",children:[!e&&G[s]&&a.jsx("div",{className:"absolute top-3 left-3 z-20 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(fe=G[s])!=null&&fe.videoUrl||o?a.jsxs(O,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:H,title:"Replace Feature Video",children:[a.jsx(C2,{className:"h-4 w-4 mr-1"})," Replace Video"]}):a.jsxs(a.Fragment,{children:[a.jsxs(O,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:()=>W(s),title:"Change Feature Image",children:[a.jsx(C2,{className:"h-4 w-4 mr-1"})," Change Image"]}),a.jsxs(O,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:()=>{v(s),x(!0)},title:"Edit Feature Image with AI",children:[a.jsx(Ca,{className:"h-4 w-4 mr-1"})," Edit with AI"]})]})}),(xe=G[s])!=null&&xe.videoUrl?a.jsx("video",{src:G[s].videoUrl,poster:G[s].image||c||"",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"},`feat-video-${s}`):o?a.jsx("video",{src:o,poster:c||((ge=G[s])==null?void 0:ge.image)||"",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"},`current-pexels-video-${s}`):(Re=G[s])!=null&&Re.image?a.jsx(It.img,{src:G[s].image,alt:G[s].title||"Modern feature image",className:"absolute inset-0 w-full h-full object-cover",initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},transition:{duration:.8}},`feat-img-${s}`):a.jsx(It.img,{src:"https://images.pexels.com/photos/1571460/pexels-photo-1571460.jpeg?auto=compress&cs=tinysrgb&w=600",alt:"Default modern feature background",className:"absolute inset-0 w-full h-full object-cover",initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},transition:{duration:.8}},`fallback-img-${s}`),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent"}),a.jsx(It.div,{className:"absolute bottom-6 left-6 right-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:a.jsxs("div",{className:"bg-white/10 dark:bg-black/10 backdrop-blur-md border border-white/20 dark:border-white/10 rounded-2xl p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl",style:{backgroundColor:G[s].color||P+"30"},children:G[s].emoji||ht.createElement(G[s].icon||Oi,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-bold text-white",children:G[s].title}),G[s].stats&&a.jsx("p",{className:"text-sm text-gray-200",children:G[s].stats})]})]}),a.jsx("p",{className:"text-gray-200 text-sm leading-relaxed",children:G[s].description})]})},`overlay-${s}`),a.jsx(It.div,{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/20 dark:bg-black/20 backdrop-blur-md rounded-2xl flex items-center justify-center border border-white/30 dark:border-white/20 z-10",animate:{y:[-8,8,-8],rotate:[0,10,0]},transition:{duration:6,repeat:1/0},children:a.jsx(ya,{className:"w-12 h-12 text-green-400"})})]})]}),a.jsx(It.div,{variants:V,initial:"hidden",animate:T?"visible":"hidden",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16",children:(M.secondaryItems||[]).map((ve,de)=>{const Me=C[ve.iconName]||Oi;return a.jsxs(It.div,{variants:$,className:"text-center p-6 bg-white/10 dark:bg-black/10 backdrop-blur-md rounded-3xl border border-white/20 dark:border-white/10 hover:bg-white/15 dark:hover:bg-black/15 transition-all duration-300",whileHover:{scale:1.05,y:-5},children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center shadow-lg",style:{backgroundColor:P},children:a.jsx(Me,{className:"w-8 h-8 text-white"})}),a.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:a.jsx(Yn,{initialText:ve.title,onSave:Ge=>B(`secondaryItemTitle.${de}`,Ge),isAdmin:j,placeholder:"Feature Title"})}),a.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:a.jsx(Yn,{initialText:ve.description,onSave:Ge=>B(`secondaryItemDescription.${de}`,Ge),isAdmin:j,placeholder:"Feature Description",useTextarea:!0})})]},ve.title+de)})}),a.jsx(It.div,{variants:V,initial:"hidden",animate:T?"visible":"hidden",className:"grid grid-cols-2 md:grid-cols-4 gap-8 p-8 bg-white/10 dark:bg-black/10 backdrop-blur-md rounded-3xl border border-white/20 dark:border-white/10",children:(M.statsItems||[]).map((ve,de)=>{const Me=C[ve.iconName]||Oi;return a.jsxs(It.div,{variants:$,className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-xl flex items-center justify-center",style:{backgroundColor:`${P}20`},children:a.jsx(Me,{className:"w-6 h-6",style:{color:P}})}),a.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-1",children:a.jsx(Yn,{initialText:ve.number,onSave:Ge=>B("statsItemNumber",Ge),isAdmin:j,placeholder:"Stat Number"})}),a.jsx("div",{className:"text-sm text-muted-foreground",children:a.jsx(Yn,{initialText:ve.label,onSave:Ge=>B("statsItemLabel",Ge),isAdmin:j,placeholder:"Stat Label"})})]},ve.label+de)})})]}),!e&&k&&a.jsx(xRe,{open:d,onOpenChange:h,storeId:k,currentVideoUrl:((Ue=G[s])==null?void 0:Ue.videoUrl)||o,onVideoReplaced:Y}),!e&&k&&w!==null&&G[w]&&a.jsx(wRe,{isOpen:f,onOpenChange:m,currentImageUrl:(ze=G[w])==null?void 0:ze.image,onImageSelected:ve=>Q(ve),imageSearchContext:`feature image for ${((he=G[w])==null?void 0:he.title)||"section"}`,modalTitle:"Change Feature Image",storeName:t.name}),!e&&k&&w!==null&&G[w]&&a.jsx(SRe,{isOpen:g,onOpenChange:x,currentImageUrl:(Ce=G[w])==null?void 0:Ce.image,onImageEdited:ve=>Q(ve),imageContext:`feature image for "${((Pe=G[w])==null?void 0:Pe.title)||"section"}"`,modalTitle:"Edit Feature Image with AI"})]})},CRe=Object.freeze(Object.defineProperty({__proto__:null,default:Cq},Symbol.toStringTag,{value:"Module"})),ERe=()=>{var ae,se;console.log("[StorePreview] Component mounted.");const{storeName:t,productHandle:e}=N0();console.log("[StorePreview] storeName from params:",t);const{getStoreByName:n,getStoreBySlug:r,getStoreById:s,currentStore:i,setCurrentStore:o,updateStore:l,viewMode:c,isLoadingStores:u,user:d}=zn(),{toast:h}=bs(),[f,m]=p.useState(null),[g,x]=p.useState(!1),[w,v]=p.useState(null);p.useEffect(()=>{f&&v(f.template_version)},[f]);const[_,C]=p.useState(null),[T,R]=p.useState(null),[A,E]=p.useState(null),[I,P]=p.useState(null),[k,j]=p.useState(null),[D,M]=p.useState(null),[G,B]=p.useState(null),[W,Q]=p.useState(null),[H,Y]=p.useState(null),[V,$]=p.useState(null),[z,F]=p.useState(null),[Z,fe]=p.useState(null),[xe,ge]=p.useState(null),[Re,Ue]=p.useState(null),[ze,he]=p.useState(null),[Ce,Pe]=p.useState(null),[ve,de]=p.useState(null),[Me,Ge]=p.useState(null),[yt,Pt]=p.useState(null),[en,fn]=p.useState(null),[an,dn]=p.useState(null),[Lt,xn]=p.useState(null),[te,Ee]=p.useState(null),[ee,le]=p.useState(null),[K,Ae]=p.useState(null),[Ne,Oe]=p.useState(null),[He,ce]=p.useState(null),[_e,Be]=p.useState(null),[Te,Et]=p.useState(null),[wt,xt]=p.useState(null),[pt,At]=p.useState(null),[On,Tn]=p.useState(null),[mr,mn]=p.useState(null),[Ft,Xt]=p.useState(null),[or,J]=p.useState(null),[ue,we]=p.useState(null),[Le,Ze]=p.useState(null),[X,ne]=p.useState(null),[me,q]=p.useState(null),[ie,be]=p.useState(null),[Ie,Ve]=p.useState(null),[Se,ot]=p.useState(null),[lt,jt]=p.useState(null),[vn,ts]=p.useState(null),[Vn,Wr]=p.useState(null),[ri,$s]=p.useState(null),[Us,Bs]=p.useState(null),[ns,tn]=p.useState(null),[In,si]=p.useState(null),[ii,$n]=p.useState(null),[oi,_o]=p.useState(!1),[Qo,Qc]=p.useState(""),[Vf,Zc]=p.useState(!1),[eu,tu]=p.useState(!1);p.useEffect(()=>{(async()=>{if(!t||g)return;x(!0);let oe=null;i&&i.urlSlug===t?oe=i:(oe=n(t),oe||(oe=await r(t))),oe?(m(oe),(!i||i.id!==oe.id)&&o(oe)):u||(h({title:"Store Not Found",description:`Could not find store with slug: ${t}`,variant:"destructive"}),m(null)),x(!1)})()},[t,u,g,i,n,r,o,h]),p.useEffect(()=>{const re=w||(f==null?void 0:f.template_version),oe=document.documentElement;f&&f.theme?(f.theme.primaryColor?oe.style.setProperty("--theme-primary-color",f.theme.primaryColor):oe.style.removeProperty("--theme-primary-color"),f.theme.secondaryColor?oe.style.setProperty("--theme-secondary-color",f.theme.secondaryColor):oe.style.removeProperty("--theme-secondary-color"),re==="premium"?(oe.style.setProperty("--premium-gradient-start-color",f.theme.primaryColor||"#667eea"),oe.style.setProperty("--premium-gradient-end-color",f.theme.secondaryColor||"#764ba2")):(oe.style.removeProperty("--premium-gradient-start-color"),oe.style.removeProperty("--premium-gradient-end-color"))):(oe.style.removeProperty("--theme-primary-color"),oe.style.removeProperty("--theme-secondary-color"),oe.style.removeProperty("--premium-gradient-start-color"),oe.style.removeProperty("--premium-gradient-end-color"));let ke=!1;return re==="sharp"&&(oe.classList.contains("dark")||(oe.classList.add("dark"),ke=!0)),()=>{ke&&re!=="sharp"&&oe.classList.contains("dark")}},[f==null?void 0:f.theme,f==null?void 0:f.template_version,w]),p.useEffect(()=>{if(f){const re=w||f.template_version||"classic";console.log(`[StorePreview] Loading components for template: ${re}`),jt(null),ts(null),Wr(null),$s(null),Bs(null),tn(null),si(null),$n(null),C(null),R(null),E(null),P(null),j(null),M(null),B(null),Q(null),Y(null),$(null),F(null),fe(null),ge(null),Ue(null),he(null),Pe(null),de(null),Ge(null),Pt(null),fn(null),dn(null),xn(null),Ee(null),le(null),Ae(null),Oe(null),ce(null),Be(null),Et(null),xt(null),At(null),Tn(null),mn(null),Xt(null),J(null),we(null),Ze(null),ne(null),q(null),be(null),Ve(null),ot(null),Ve(()=>mRe),ot(()=>Cq),re==="classic"?(jt(()=>p.lazy(()=>Mt(()=>Promise.resolve().then(()=>IRe),void 0))),ts(()=>p.lazy(()=>Mt(()=>import("./StoreHero-73060083.js"),[]))),Wr(()=>p.lazy(()=>Mt(()=>import("./StoreCollections-9a597b1c.js"),["assets/StoreCollections-9a597b1c.js","assets/CollectionProductsDialog-f2de33b0.js"]))),$s(()=>p.lazy(()=>Mt(()=>import("./ProductGrid-a0d38af4.js"),["assets/ProductGrid-a0d38af4.js","assets/list-6efefddd.js","assets/filter-c1749b41.js"]))),Bs(()=>p.lazy(()=>Mt(()=>import("./StoreFeatures-b805ee52.js"),["assets/StoreFeatures-b805ee52.js","assets/shield-check-10817d36.js","assets/message-square-9b38807c.js"]))),tn(()=>p.lazy(()=>Mt(()=>import("./StoreTestimonials-6e5085a7.js"),["assets/StoreTestimonials-6e5085a7.js","assets/user-circle-aeb56252.js"]))),si(()=>p.lazy(()=>Mt(()=>import("./StoreNewsletter-e115b249.js"),[]))),$n(()=>p.lazy(()=>Mt(()=>Promise.resolve().then(()=>NRe),void 0)))):re==="modern"?(C(()=>p.lazy(()=>Mt(()=>import("./StoreHeader-99cc673a.js"),["assets/StoreHeader-99cc673a.js","assets/minus-4e687d0f.js"]))),R(()=>p.lazy(()=>Mt(()=>import("./StoreHero-f77f45eb.js"),[]))),E(()=>p.lazy(()=>Mt(()=>Promise.resolve().then(()=>CRe),void 0))),P(()=>p.lazy(()=>Mt(()=>import("./StoreCollections-3f5b8af4.js"),[]))),j(()=>p.lazy(()=>Mt(()=>import("./ProductGrid-2f70e7c9.js"),["assets/ProductGrid-2f70e7c9.js","assets/minus-4e687d0f.js","assets/crown-75b0785e.js","assets/list-6efefddd.js"]))),M(()=>p.lazy(()=>Mt(()=>import("./Footer-8cda9402.js"),[])))):re==="premium"?(B(()=>p.lazy(()=>Mt(()=>import("./Header-9cd06a33.js"),[]))),Q(()=>p.lazy(()=>Mt(()=>import("./Hero-6d68cc40.js"),[]))),Y(()=>p.lazy(()=>Mt(()=>import("./FeaturedProducts-e3fc4eb1.js"),["assets/FeaturedProducts-e3fc4eb1.js","assets/minus-4e687d0f.js","assets/crown-75b0785e.js","assets/list-6efefddd.js","assets/filter-c1749b41.js"]))),$(()=>p.lazy(()=>Mt(()=>import("./CategoryShowcase-ab60e12a.js"),["assets/CategoryShowcase-ab60e12a.js","assets/CollectionProductsDialog-f2de33b0.js"]))),F(()=>p.lazy(()=>Mt(()=>import("./SocialProof-9ea82194.js"),[]))),fe(()=>p.lazy(()=>Mt(()=>import("./Newsletter-f6019b72.js"),[]))),ge(()=>p.lazy(()=>Mt(()=>import("./Footer-b129d9e7.js"),[])))):re==="sharp"?(Ue(()=>p.lazy(()=>Mt(()=>import("./StoreHeader-caadd306.js"),[]))),he(()=>p.lazy(()=>Mt(()=>import("./StoreHero-be789324.js"),["assets/StoreHero-be789324.js","assets/ReplaceVideoModal-cb727f37.js"]))),Pe(()=>p.lazy(()=>Mt(()=>import("./StoreFeatures-458cd85f.js"),[]))),de(()=>p.lazy(()=>Mt(()=>import("./ProductGrid-4d75ec18.js"),["assets/ProductGrid-4d75ec18.js","assets/list-6efefddd.js"]))),Ge(()=>p.lazy(()=>Mt(()=>import("./Testimonials-f1db8dc4.js"),["assets/Testimonials-f1db8dc4.js","assets/message-square-9b38807c.js","assets/user-circle-aeb56252.js"]))),Pt(()=>p.lazy(()=>Mt(()=>import("./ImageRightSection-194805af.js"),[]))),fn(()=>p.lazy(()=>Mt(()=>import("./VideoLeftSection-62b565b2.js"),["assets/VideoLeftSection-62b565b2.js","assets/ReplaceVideoModal-cb727f37.js"]))),dn(()=>p.lazy(()=>Mt(()=>import("./HeroFollowUpVideo-0f61d235.js"),["assets/HeroFollowUpVideo-0f61d235.js","assets/ReplaceVideoModal-cb727f37.js"]))),xn(()=>p.lazy(()=>Mt(()=>import("./Newsletter-6954f67d.js"),[]))),Ee(()=>p.lazy(()=>Mt(()=>import("./Footer-f71a847d.js"),[])))):re==="fresh"?(le(()=>p.lazy(()=>Mt(()=>import("./StoreHeader-fc8818f0.js"),[]))),Ae(()=>p.lazy(()=>Mt(()=>import("./StoreHero-1e9730f4.js"),[]))),Oe(()=>p.lazy(()=>Mt(()=>import("./StoreFeatures-78d05dad.js"),[]))),ce(()=>p.lazy(()=>Mt(()=>import("./ProductGrid-cd95542f.js"),["assets/ProductGrid-cd95542f.js","assets/list-6efefddd.js"]))),Be(()=>p.lazy(()=>Mt(()=>import("./StoreCollections-577f5135.js"),["assets/StoreCollections-577f5135.js","assets/CollectionProductsDialog-f2de33b0.js"]))),Et(()=>p.lazy(()=>Mt(()=>import("./Testimonials-77971fe2.js"),["assets/Testimonials-77971fe2.js","assets/user-circle-aeb56252.js"]))),xt(()=>p.lazy(()=>Mt(()=>import("./Newsletter-a79aa436.js"),[]))),At(()=>p.lazy(()=>Mt(()=>import("./Footer-6056e658.js"),["assets/Footer-6056e658.js","assets/shield-check-10817d36.js"])))):re==="sleek"&&(Tn(()=>p.lazy(()=>Mt(()=>import("./StoreHeader-95f69a04.js"),[]))),mn(()=>p.lazy(()=>Mt(()=>import("./StoreHero-5120cd50.js"),[]))),Xt(()=>p.lazy(()=>Mt(()=>import("./ProductGrid-082832d2.js"),["assets/ProductGrid-082832d2.js","assets/list-6efefddd.js","assets/filter-c1749b41.js"]))),J(()=>p.lazy(()=>Mt(()=>import("./StoreFeatures-9d773232.js"),[]))),we(()=>p.lazy(()=>Mt(()=>import("./Testimonials-48cc041e.js"),["assets/Testimonials-48cc041e.js","assets/user-circle-aeb56252.js"]))),Ze(()=>p.lazy(()=>Mt(()=>import("./Newsletter-07a455fe.js"),[]))),ne(()=>p.lazy(()=>Mt(()=>import("./Footer-dc21f37e.js"),[]))),q(()=>p.lazy(()=>Mt(()=>import("./StoreCollections-b3a9ba31.js"),[]))),be(()=>p.lazy(()=>Mt(()=>import("./StoreWaySection-d57c7b31.js"),[]))))}},[f==null?void 0:f.id,w]);const Sd=()=>{if(!f||!f.pass_key){Zc(!0);return}tu(!0),setTimeout(()=>{Qo===f.pass_key?(Zc(!0),h({title:"Access Granted",description:"Welcome to the store!"})):(h({title:"Access Denied",description:"Incorrect pass key.",variant:"destructive"}),Qc("")),tu(!1)},500)};if(u)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading store..."})]})});if(!f)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("p",{className:"text-xl text-destructive",children:"Store not found."})});if(!Vf&&f.pass_key)return a.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 p-4",children:a.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-2xl w-full max-w-md text-center",children:[a.jsx(Gie,{className:"h-16 w-16 text-primary mx-auto mb-6"}),a.jsx("h2",{className:"text-3xl font-bold text-card-foreground mb-3",children:"Protected Store"}),a.jsx("p",{className:"text-muted-foreground mb-8",children:"This store requires a pass key to view its content."}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx(Ye,{type:"password",placeholder:"Enter Pass Key",value:Qo,onChange:re=>Qc(re.target.value),className:"h-12 text-lg text-center bg-input border-border focus:ring-primary focus:border-primary",onKeyPress:re=>re.key==="Enter"&&Sd()}),a.jsx(O,{onClick:Sd,disabled:eu||!Qo.trim(),className:"h-12 text-lg w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:eu?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-current"}):a.jsxs(a.Fragment,{children:[a.jsx(aoe,{className:"mr-2 h-5 w-5"})," Access Store"]})})]})]})});const _t=c==="published";let _n=w;if(_n||(_n=(f==null?void 0:f.template_version)==="v1"||!(f!=null&&f.template_version)?"classic":f.template_version),console.log(`[StorePreview] Determined templateVersionToRender: ${_n}. (previewTemplateVersion: ${w}, store.template_version: ${f==null?void 0:f.template_version})`),console.log(`[StorePreview] Rendering template: ${_n}. Store products: ${((ae=f==null?void 0:f.products)==null?void 0:ae.length)||0}, collections: ${((se=f==null?void 0:f.collections)==null?void 0:se.length)||0}`),_n==="classic"){if(!lt||!vn||!Vn||!ri||!Us||!ns||!In||!ii)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Classic Template Components..."})]})})}else if(_n==="modern"){if(!_||!T||!A||!I||!k||!D)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Modern Template Components..."})]})})}else if(_n==="premium"){if(!G||!W||!H||!V||!z||!Z||!xe)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Premium Template Components..."})]})})}else if(_n==="sharp"){if(!Re||!ze||!an||!Ce||!ve||!Me||!yt||!en||!Lt||!te)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Sharp Template Components..."})]})})}else if(_n==="sleek"){if(!On||!mr||!Ft||!me||!or||!ue||!Le||!X)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Sleek Template Components..."})]})})}else if(_n==="fresh"&&(!ee||!K||!Ne||!He||!_e||!wt||!pt))return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Fresh Template Components..."})]})});return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx(p.Suspense,{fallback:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading Store Content..."}),children:_n==="classic"?a.jsxs(ht.Fragment,{children:[lt&&a.jsx(lt,{store:f,isPublishedView:_t}),vn&&a.jsx(vn,{store:f,isPublishedView:_t}),ri&&a.jsx(ri,{store:f,isPublishedView:_t}),Vn&&a.jsx(Vn,{store:f,isPublishedView:_t}),Se&&a.jsx(Se,{store:f,isPublishedView:_t}),Ie&&a.jsx(Ie,{store:f,isPublishedView:_t}),ns&&a.jsx(ns,{store:f,isPublishedView:_t}),In&&a.jsx(In,{store:f,isPublishedView:_t}),ii&&a.jsx(ii,{store:f,isPublishedView:_t})]},"classic"):_n==="modern"?a.jsx(ht.Fragment,{children:a.jsxs("div",{className:"min-h-screen flex flex-col",children:[a.jsxs("main",{className:"flex-1",children:[_&&a.jsx(_,{store:f,isPublishedView:_t}),T&&a.jsx(T,{store:f,isPublishedView:_t}),A?a.jsx(A,{store:f,isPublishedView:_t}):Se&&a.jsx(Se,{store:f,isPublishedView:_t}),k&&a.jsx(k,{store:f,products:(f==null?void 0:f.products)||[],isPublishedView:_t}),I&&a.jsx(I,{store:f,isPublishedView:_t}),Ie&&a.jsx(Ie,{store:f,isPublishedView:_t})]}),a.jsx("footer",{className:"mt-auto",children:D&&a.jsx(D,{store:f,isPublishedView:_t})})]})},"modern"):_n==="premium"?a.jsxs(ht.Fragment,{children:[G&&a.jsx(G,{store:f,isPublishedView:_t}),W&&a.jsx(W,{store:f,isPublishedView:_t}),H&&a.jsx(H,{store:f,isPublishedView:_t}),V&&a.jsx(V,{store:f,isPublishedView:_t}),Se&&a.jsx(Se,{store:f,isPublishedView:_t}),Ie&&a.jsx(Ie,{store:f,isPublishedView:_t}),z&&a.jsx(z,{store:f,isPublishedView:_t}),Z&&a.jsx(Z,{store:f,isPublishedView:_t}),xe&&a.jsx(xe,{store:f,isPublishedView:_t})]},"premium"):_n==="sharp"?a.jsxs(ht.Fragment,{children:[Re&&a.jsx(Re,{store:f,isPublishedView:_t}),ze&&a.jsx(ze,{store:f,isPublishedView:_t}),an&&a.jsx(an,{store:f}),ve&&a.jsx(ve,{store:f,isPublishedView:_t}),Ce?a.jsx(Ce,{store:f,isPublishedView:_t}):Se&&a.jsx(Se,{store:f,isPublishedView:_t}),Ie&&a.jsx(Ie,{store:f,isPublishedView:_t}),yt&&a.jsx(yt,{store:f,isPublishedView:_t}),en&&a.jsx(en,{store:f,isPublishedView:_t}),Me&&a.jsx(Me,{store:f,isPublishedView:_t}),Lt&&a.jsx(Lt,{store:f}),te&&a.jsx(te,{store:f})]},"sharp"):_n==="fresh"?a.jsxs(ht.Fragment,{children:[ee&&a.jsx(ee,{store:f,isPublishedView:_t}),K&&a.jsx(K,{store:f,isPublishedView:_t}),He&&a.jsx(He,{store:f,isPublishedView:_t})," ",_e&&a.jsx(_e,{store:f,isPublishedView:_t})," ",Ne?a.jsx(Ne,{store:f,isPublishedView:_t}):Se&&a.jsx(Se,{store:f,isPublishedView:_t}),Te&&a.jsx(Te,{store:f,isPublishedView:_t}),Ie&&a.jsx(Ie,{store:f,isPublishedView:_t}),wt&&a.jsx(wt,{store:f}),pt&&a.jsx(pt,{store:f})]},"fresh"):_n==="sleek"?a.jsxs(ht.Fragment,{children:[On&&a.jsx(On,{store:f,isPublishedView:_t}),mr&&a.jsx(mr,{store:f,isPublishedView:_t}),Ft&&a.jsx(Ft,{store:f,isPublishedView:_t}),me&&a.jsx(me,{store:f,isPublishedView:_t}),or?a.jsx(or,{store:f,isPublishedView:_t}):Se&&a.jsx(Se,{store:f,isPublishedView:_t}),ie?a.jsx(ie,{store:f,isPublishedView:_t}):Ie&&a.jsx(Ie,{store:f,isPublishedView:_t}),ue&&a.jsx(ue,{store:f,isPublishedView:_t}),Le&&a.jsx(Le,{store:f,isPublishedView:_t}),X&&a.jsx(X,{store:f,isPublishedView:_t})]},"sleek"):null}),d&&f&&d.uid===f.merchant_id&&a.jsx(gIe,{store:f,onEdit:()=>_o(!0),currentTemplate:w,onTemplateChange:v,availableTemplates:["classic","modern","premium","sharp","fresh","sleek"]}),!_t&&f&&a.jsx(yIe,{store:f,open:oi,onOpenChange:_o,onStoreUpdate:re=>{m(oe=>({...oe,...re})),re.template_version&&re.template_version!==w&&v(re.template_version),(f&&f.id===re.id||i&&i.id===re.id)&&l(re.id,re)}}),a.jsx(bq,{storeId:f==null?void 0:f.id})," "]})},TRe=({open:t,onOpenChange:e,storeId:n,storeName:r,currentLogoUrlLight:s,currentLogoUrlDark:i,onLogoReplaced:o})=>{const[l,c]=p.useState("ai"),[u,d]=p.useState(r||""),[h,f]=p.useState(!1),[m,g]=p.useState(null),[x,w]=p.useState({light:null,dark:null}),[v,_]=p.useState(""),[C,T]=p.useState([]),[R,A]=p.useState(!1),[E,I]=p.useState(null),[P,k]=p.useState(null),[j,D]=p.useState(null),[M,G]=p.useState(!1),[B,W]=p.useState(null);p.useEffect(()=>{t&&(d(r||""),f(!1),g(null),w({light:null,dark:null}),_(""),T([]),A(!1),I(null),k(null),D(null),G(!1),W(null))},[t,r]);const Q=async()=>{if(!r){g("Store name is required to generate a logo with AI.");return}f(!0),g(null),w({light:null,dark:null});try{console.log(`Generating light/dark logos for store ${r}`);const F=await Pg(r);F&&(F.logoUrlLight||F.logoUrlDark)?w({light:F.logoUrlLight,dark:F.logoUrlDark}):g(F.textResponse||"AI did not return sufficient image data for logos.")}catch(F){console.error("Error generating logos with AI:",F),g(F.message||"Failed to generate logos. Please try again.")}finally{f(!1)}},H=async()=>{if(!v.trim()){I("Please enter a search query for Pexels.");return}A(!0),I(null),T([]);try{const F=await yRe(v);F.error?(I(F.error),T([])):(T(F.photos||[]),(F.photos||[]).length===0&&I("No images found for your query."))}catch(F){console.error("Error searching Pexels images:",F),I(F.message||"Failed to search Pexels. Please try again.")}finally{A(!1)}},Y=F=>{o&&F?(o({logoUrlLight:F,logoUrlDark:F}),e(!1)):I("Invalid image URL selected or replacement handler missing.")},V=F=>{const Z=F.target.files[0];if(Z){if(Z.size>10*1024*1024){D("File is too large. Please select an image under 10MB."),k(null),W(null);return}if(!Z.type.startsWith("image/")){D("Invalid file type. Please select an image file (e.g., PNG, JPG, GIF)."),k(null),W(null);return}k(Z),D(null);const fe=new FileReader;fe.onloadend=()=>{W(fe.result)},fe.readAsDataURL(Z)}},$=()=>{if(P&&o){G(!0),D(null);const F=new FileReader;F.onloadend=()=>{const Z=F.result;o({logoUrlLight:Z,logoUrlDark:Z}),e(!1),k(null),W(null),G(!1)},F.onerror=()=>{D("Failed to read image file for upload."),G(!1)},F.readAsDataURL(P)}else D("No image file selected or replacement handler missing.")},z=()=>{x.light||x.dark?(o({logoUrlLight:x.light,logoUrlDark:x.dark}),e(!1)):g("No AI generated logos available to confirm.")};return a.jsx(Xr,{open:t,onOpenChange:e,children:a.jsxs(Ur,{className:"sm:max-w-[728px]",children:[" ",a.jsxs(Br,{className:"text-left",children:[a.jsx(zr,{children:"Change Store Logo"}),a.jsxs(Zi,{className:"text-left space-y-2",children:[a.jsx("p",{children:"Current Logos:"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx(De,{className:"text-xs text-muted-foreground",children:"For Dark Backgrounds (Light Logo)"}),s?a.jsx("img",{src:s,alt:"Current light logo",className:"h-20 w-auto mx-auto max-w-full object-contain my-1 border rounded bg-gray-700 p-1"}):a.jsx("div",{className:"h-20 flex items-center justify-center text-xs text-muted-foreground bg-gray-200 dark:bg-gray-700 rounded my-1",children:"Not set"})]}),a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx(De,{className:"text-xs text-muted-foreground",children:"For Light Backgrounds (Dark Logo)"}),i?a.jsx("img",{src:i,alt:"Current dark logo",className:"h-20 w-auto mx-auto max-w-full object-contain my-1 border rounded bg-white p-1"}):a.jsx("div",{className:"h-20 flex items-center justify-center text-xs text-muted-foreground bg-gray-200 dark:bg-gray-700 rounded my-1",children:"Not set"})]})]})]})]}),a.jsxs(Si,{value:l,onValueChange:c,className:"w-full",children:[a.jsxs(ti,{className:"grid w-full grid-cols-3",children:[a.jsx(Ot,{value:"ai",children:"Generate with AI"}),a.jsx(Ot,{value:"pexels",children:"Search Pexels"}),a.jsx(Ot,{value:"upload",children:"Upload Image"})]}),a.jsxs(Vt,{value:"ai",className:"space-y-4 py-4",children:[a.jsxs("p",{className:"text-sm text-muted-foreground",children:["AI will generate a logo based on your store name: ",a.jsx("strong",{children:r}),"."]}),m&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:m}),h&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Generating logos..."}),(x.light||x.dark)&&!h&&a.jsxs("div",{className:"flex flex-col items-center gap-4 mt-3",children:[a.jsx("p",{className:"text-sm font-medium",children:"Generated Previews:"}),a.jsxs("div",{className:"flex gap-4",children:[x.dark&&a.jsxs("div",{className:"text-center",children:[a.jsx(De,{className:"text-xs text-muted-foreground",children:"For Light BG"}),a.jsx("img",{src:x.dark,alt:"AI Generated Dark Logo",className:"h-24 w-24 object-contain border rounded-md bg-white p-1"})]}),x.light&&a.jsxs("div",{className:"text-center",children:[a.jsx(De,{className:"text-xs text-muted-foreground",children:"For Dark BG"}),a.jsx("img",{src:x.light,alt:"AI Generated Light Logo",className:"h-24 w-24 object-contain border rounded-md bg-gray-700 p-1"})]})]})]}),a.jsxs(Ar,{className:"justify-start pt-4",children:[a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:h,children:"Cancel"}),a.jsxs(O,{onClick:Q,disabled:h||!r,children:[a.jsx(Qv,{className:"mr-2 h-4 w-4"}),h?"Generating...":x.light||x.dark?"Regenerate Logos":"Generate Logos"]}),(x.light||x.dark)&&a.jsx(O,{onClick:z,disabled:h,children:"Use These Logos"})]})]}),a.jsxs(Vt,{value:"pexels",className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{id:"pexelsQuery",value:v,onChange:F=>_(F.target.value),placeholder:"e.g., Abstract, Minimal, Tech",disabled:R,className:"flex-grow"}),a.jsx(O,{onClick:H,disabled:R||!v.trim(),children:R?"Searching...":"Search Images"})]}),E&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:E}),R&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Loading Pexels images..."}),!R&&C.length>0&&a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-3 max-h-[300px] overflow-y-auto pr-2",children:C.map(F=>a.jsxs("div",{className:"relative aspect-square rounded-md overflow-hidden cursor-pointer group border hover:border-primary",onClick:()=>Y(F.src.large2x||F.src.large||F.src.original),children:[a.jsx("img",{src:F.src.medium,alt:F.alt||`Pexels image by ${F.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),a.jsx("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:a.jsx("p",{className:"text-white text-xs text-center p-1 bg-black/50 rounded",children:"Use Image"})})]},F.id))}),a.jsx(Ar,{className:"justify-start pt-4",children:a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:R,children:"Cancel"})})]}),a.jsxs(Vt,{value:"upload",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"image-upload-input",className:"text-left block mb-1",children:"Select Image File"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(Ye,{id:"image-upload-input",type:"file",accept:"image/*",onChange:V,className:"flex-grow",disabled:M})}),B&&a.jsxs("div",{className:"mt-3 flex flex-col items-center",children:[a.jsx("p",{className:"text-sm font-medium mb-1",children:"Preview:"}),a.jsx("img",{src:B,alt:"Upload preview",className:"h-32 w-32 object-contain border rounded-md"})]}),P&&!B&&a.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected: ",P.name," (",(P.size/1024/1024).toFixed(2)," MB)"]}),j&&a.jsx("p",{className:"text-sm text-red-500 text-center mt-2",children:j})]}),a.jsxs(Ar,{className:"justify-start pt-4",children:[a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:M,children:"Cancel"}),a.jsx(O,{onClick:$,disabled:M||!P,children:M?"Uploading...":"Confirm Upload"})]})]})]})]})})},Eq=({store:t,isPublishedView:e=!1,productName:n})=>{const{name:r,theme:s,logo_url_light:i,logo_url_dark:o,id:l,settings:c,content:u,template_version:d}=t,{cart:h,removeFromCart:f,updateQuantity:m,updateStore:g,updateStoreTemplateVersion:x}=zn(),[w,v]=p.useState(!1),[_,C]=p.useState(!1),[T,R]=p.useState(!1),A=!e,[E,I]=p.useState(!1),P=bi(),k=h.filter(F=>F.storeId===l),j=k.reduce((F,Z)=>F+Z.quantity,0),D=k.reduce((F,Z)=>F+Z.price*Z.quantity,0);p.useEffect(()=>{const F=localStorage.getItem("theme"),Z=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;I(!!(F==="dark"||!F&&Z))},[]);const M=async(F,Z,fe=null)=>{if(l)try{if(F==="storeName")await g(l,{name:Z});else if(F==="navLink"&&fe!==null){const ge=((u==null?void 0:u.navLinks)||V.map(Re=>({label:Re.label,href:Re.href}))).map((Re,Ue)=>Ue===fe?{...Re,label:Z}:Re);await g(l,{content:{...u,navLinks:ge}})}await G()}catch(xe){console.error(`Failed to update store ${F} or refresh template:`,xe)}},G=async()=>{const F=d||"v1";console.log(`Performing template refresh. Current version: ${F}`),F==="v1"?(await x(l,"v2"),await x(l,"v1"),console.log("Template refreshed: v1 -> v2 -> v1")):F==="v2"&&(await x(l,"v1"),await x(l,"v2"),console.log("Template refreshed: v2 -> v1 -> v2"))},B=()=>{R(!0),console.log("Open change image dialog (placeholder)")},W=async F=>{if(l&&F)try{await g(l,{logo_url_light:F.logoUrlLight||t.logo_url_light,logo_url_dark:F.logoUrlDark||t.logo_url_dark}),console.log("Store logos updated successfully.")}catch(Z){console.error("Failed to update store logos:",Z)}},Q=()=>{const F=!E;I(F),F?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},H=`/store/${l}`,Y=[{href:H,label:"Home"},{href:`#products-${l}`,label:"Products"},{href:`#features-${l}`,label:"Features"},{href:`#contact-${l}`,label:"Contact"}],V=u!=null&&u.navLinks&&u.navLinks.length===Y.length?u.navLinks.map((F,Z)=>({...Y[Z],label:F.label||Y[Z].label})):Y,$=(F,Z)=>{if(F.preventDefault(),v(!1),Z.startsWith("/store/"))P(Z);else{const fe=Z.substring(1),xe=document.getElementById(fe);xe?xe.scrollIntoView({behavior:"smooth"}):P(H)}},z=()=>{C(!1),P("/checkout",{state:{cart:k,storeName:r,storeId:l}})};return a.jsxs(a.Fragment,{children:[a.jsx(It.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"sticky top-0 z-40 w-full bg-background/90 backdrop-blur-md border-b",style:{borderColor:`${s.primaryColor}30`},children:a.jsxs("div",{className:"container mx-auto px-4 py-3 flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center gap-2",children:n?a.jsx("h1",{className:"font-bold text-xl tracking-tight",style:{color:s.primaryColor},children:n}):a.jsxs(a.Fragment,{children:[a.jsx(sr,{to:H,className:"group",children:(E?i:o)?a.jsx("img",{src:E?i:o,alt:`${r} logo`,className:"h-16 w-16 object-contain group-hover:scale-105 transition-transform duration-200"}):i||o?a.jsx("img",{src:i||o,alt:`${r} logo (fallback)`,className:"h-16 w-16 object-contain group-hover:scale-105 transition-transform duration-200"}):null}),A&&(i||o)&&a.jsx(O,{variant:"outline",size:"icon",onClick:B,className:"h-8 w-8 p-0 -ml-2 relative z-10 bg-background hover:bg-muted",children:a.jsx(ew,{className:"h-4 w-4"})}),a.jsx(sr,{to:H,className:"group ml-2",children:a.jsx("span",{className:"font-bold text-xl tracking-tight group-hover:text-primary transition-colors",style:{color:s.primaryColor},children:a.jsx(Yn,{initialText:r,onSave:F=>M("storeName",F),isAdmin:A,placeholder:"Store Name"})})})]})}),!n&&a.jsx("nav",{className:"hidden md:flex items-center gap-x-6",children:V.map((F,Z)=>a.jsx("a",{href:F.href,onClick:fe=>$(fe,F.href),className:"text-sm font-medium text-muted-foreground hover:text-primary transition-colors",style:{"--hover-color":s.primaryColor},children:a.jsx(Yn,{initialText:F.label,onSave:fe=>M("navLink",fe,Z),isAdmin:A,placeholder:`Link ${Z+1}`})},F.label+Z))}),a.jsxs("div",{className:"flex items-center gap-2",children:[((c==null?void 0:c.showThemeToggle)??!0)&&a.jsxs("div",{className:"hidden md:flex items-center gap-2 mr-2",children:[a.jsx(Oo,{id:`store-theme-switcher-${l}`,checked:E,onCheckedChange:Q,"aria-label":"Toggle dark mode"}),E?a.jsx(PE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(kE,{className:"h-5 w-5 text-muted-foreground"})]}),a.jsx(O,{variant:"ghost",size:"icon",className:"hidden md:flex text-muted-foreground hover:text-primary",style:{"--hover-color":s.primaryColor},children:a.jsx(ic,{className:"h-5 w-5"})}),a.jsxs(O,{variant:"outline",className:"relative",onClick:()=>C(!0),style:{borderColor:s.primaryColor,color:s.primaryColor},children:[a.jsx(Up,{className:"h-5 w-5"}),j>0&&a.jsx(pg,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center text-xs",style:{backgroundColor:s.secondaryColor||"red"},children:j}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Cart"})]}),!n&&a.jsx(O,{variant:"ghost",size:"icon",className:"md:hidden text-muted-foreground hover:text-primary",onClick:()=>v(!0),style:{"--hover-color":s.primaryColor},children:a.jsx($3,{className:"h-6 w-6"})})]})]})}),a.jsx(Sc,{children:w&&a.jsxs(It.div,{initial:{opacity:0,x:"100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"100%"},transition:{type:"spring",stiffness:300,damping:30},className:"fixed inset-0 z-50 bg-background p-6 md:hidden",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sr,{to:H,className:"group",onClick:()=>v(!1),children:(E?i:o)?a.jsx("img",{src:E?i:o,alt:`${r} logo`,className:"h-16 w-16 object-contain"}):i||o?a.jsx("img",{src:i||o,alt:`${r} logo (fallback)`,className:"h-16 w-16 object-contain"}):null}),A&&(i||o)&&a.jsx(O,{variant:"outline",size:"icon",onClick:()=>{B(),v(!1)},className:"h-8 w-8 p-0 -ml-2 relative z-10 bg-background hover:bg-muted",children:a.jsx(ew,{className:"h-4 w-4"})}),a.jsx(sr,{to:H,className:"group ml-2",onClick:()=>v(!1),children:a.jsx("span",{className:"font-bold text-xl",style:{color:s.primaryColor},children:a.jsx(Yn,{initialText:r,onSave:F=>M("storeName",F),isAdmin:A,placeholder:"Store Name"})})})]})," ",a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>v(!1),children:a.jsx(Ki,{className:"h-6 w-6"})})]}),a.jsxs("nav",{className:"flex flex-col gap-y-4",children:[V.map((F,Z)=>a.jsx("a",{href:F.href,onClick:fe=>$(fe,F.href),className:"text-lg font-medium text-foreground hover:text-primary transition-colors",style:{"--hover-color":s.primaryColor},children:a.jsx(Yn,{initialText:F.label,onSave:fe=>M("navLink",fe,Z),isAdmin:A,placeholder:`Link ${Z+1}`})},F.label+Z)),((c==null?void 0:c.showThemeToggle)??!0)&&a.jsxs("div",{className:"flex items-center gap-2 mt-4 pt-4 border-t border-border",children:[a.jsx(Oo,{id:`mobile-store-theme-switcher-${l}`,checked:E,onCheckedChange:Q,"aria-label":"Toggle dark mode"}),E?a.jsx(PE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(kE,{className:"h-5 w-5 text-muted-foreground"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:E?"Dark Mode":"Light Mode"})]})]})]})}),a.jsx(Sc,{children:_&&a.jsx(bh.Root,{open:_,onOpenChange:C,children:a.jsxs(bh.Portal,{children:[a.jsx(bh.Overlay,{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm"}),a.jsxs(bh.Content,{className:"fixed z-50 inset-y-0 right-0 h-full w-full max-w-md bg-background border-l shadow-xl flex flex-col",as:It.div,initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30},children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Your Cart"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>C(!1),children:a.jsx(Ki,{className:"h-5 w-5"})})]}),k.length===0?a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 text-center",children:[a.jsx(Up,{className:"h-16 w-16 text-muted-foreground mb-4"}),a.jsx("p",{className:"text-lg font-medium",children:"Your cart is empty"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Looks like you haven't added anything yet."}),a.jsx(O,{onClick:()=>C(!1),className:"mt-6",style:{backgroundColor:s.primaryColor},children:"Continue Shopping"})]}):a.jsxs(a.Fragment,{children:[a.jsx(xs,{className:"flex-1 p-6",children:a.jsx("div",{className:"space-y-4",children:k.map(F=>{var Z,fe,xe,ge;return a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("img",{src:((fe=(Z=F.image)==null?void 0:Z.src)==null?void 0:fe.tiny)||((ge=(xe=F.image)==null?void 0:xe.src)==null?void 0:ge.medium)||`https://via.placeholder.com/80x80.png?text=${F.name.substring(0,1)}`,alt:F.name,className:"w-20 h-20 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-medium text-sm line-clamp-1",children:F.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Price: $",F.price.toFixed(2)]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(O,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>m(F.id,l,F.quantity-1),children:a.jsx("span",{className:"text-lg leading-none",children:"-"})}),a.jsx("span",{className:"text-sm w-4 text-center",children:F.quantity}),a.jsx(O,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>m(F.id,l,F.quantity+1),children:a.jsx("span",{className:"text-lg leading-none",children:"+"})})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-semibold text-sm",children:["$",(F.price*F.quantity).toFixed(2)]}),a.jsx(O,{variant:"ghost",size:"icon",className:"h-7 w-7 mt-1 text-muted-foreground hover:text-destructive",onClick:()=>f(F.id,l),children:a.jsx(Wn,{className:"h-4 w-4"})})]})]},F.id)})})}),a.jsx(Ui,{}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex justify-between font-medium",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:["$",D.toFixed(2)]})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Shipping and taxes calculated at checkout."}),a.jsx(O,{className:"w-full",size:"lg",style:{backgroundColor:s.primaryColor},onClick:z,children:"Proceed to Checkout"})]})]})]})]})})}),A&&a.jsx(TRe,{open:T,onOpenChange:R,storeId:l,storeName:r,currentLogoUrl:o,currentLogoUrlLight:i,currentLogoUrlDark:o,onLogoReplaced:W})]})},bh={Root:({children:t,...e})=>a.jsx("div",{...e,children:t}),Portal:({children:t})=>a.jsx(a.Fragment,{children:t}),Overlay:ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:Ct("fixed inset-0 z-50",t),...e})),Content:ht.forwardRef(({className:t,children:e,...n},r)=>a.jsx("div",{ref:r,className:Ct("fixed z-50",t),...n,children:e}))};bh.Overlay.displayName="DialogPrimitive.Overlay";bh.Content.displayName="DialogPrimitive.Content";const IRe=Object.freeze(Object.defineProperty({__proto__:null,default:Eq},Symbol.toStringTag,{value:"Module"})),Tq=({store:t,isPublishedView:e=!1})=>{const{name:n,theme:r,id:s,content:i}=t,{updateStore:o}=zn(),l=!e,c=new Date().getFullYear(),u=[{icon:Fie,href:"#",label:"Facebook"},{icon:Gx,href:"#",label:"Instagram"},{icon:ooe,href:"#",label:"Twitter"},{icon:zie,href:"#",label:"LinkedIn"},{icon:loe,href:"#",label:"YouTube"}],h=[{href:`/store/${s}`,label:"Home"},{href:`#products-${s}`,label:"Products"},{href:"#",label:"About Us"},{href:"#",label:"Contact"},{href:"#",label:"FAQ"},{href:"#",label:"Privacy Policy"},{href:"#",label:"Terms of Service"},{href:"#",label:"Shipping Info"},{href:"#",label:"Returns"}],f=i!=null&&i.footerNavLinks&&Array.isArray(i.footerNavLinks)&&i.footerNavLinks.length>0?i.footerNavLinks.map((A,E)=>{var I,P;return{href:A.href||((I=h[E])==null?void 0:I.href)||"#",label:A.label||((P=h[E])==null?void 0:P.label)||`Link ${E+1}`}}):h,m=()=>{window.scrollTo({top:0,behavior:"smooth"})},g=async(A,E,I=null)=>{if(s)try{if(A.startsWith("content.footerNavLinks")){const P=f.map((k,j)=>j===I?{...k,label:E}:k);await o(s,{content:{...i,footerNavLinks:P}})}else{const P=A.split(".");P.length===2&&P[0]==="content"?await o(s,{content:{...i,[P[1]]:E}}):console.warn("Unsupported identifier for footer text save:",A)}}catch(P){console.error(`Failed to update store footer text for ${A}:`,P)}},x=(i==null?void 0:i.footerStoreInfo)||`Your favorite destination for ${t.type||"quality products"}. We are committed to bringing you the best experience with premium quality and exceptional service.`,w=(i==null?void 0:i.footerQuickLinksTitle)||"Quick Links",v=(i==null?void 0:i.footerCustomerServiceTitle)||"Customer Service",_=(i==null?void 0:i.footerContactUsTitle)||"Contact Us",C=(i==null?void 0:i.footerAddress)||"123 Store Street, Cityville, ST 12345",T=(i==null?void 0:i.footerPhoneNumber)||"(123) 456-7890",R=(i==null?void 0:i.footerCopyrightSuffix)||"All Rights Reserved. Powered by FreshFront.";return a.jsxs("footer",{className:"bg-muted dark:bg-slate-900 text-muted-foreground relative overflow-hidden",id:`contact-${s}`,children:[a.jsx(It.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},viewport:{once:!0},className:"pt-16 pb-8",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-xl font-bold text-foreground font-poppins",style:{color:r.primaryColor},children:n}),a.jsx("div",{className:"text-sm",children:a.jsx(Yn,{initialText:x,onSave:A=>g("content.footerStoreInfo",A),isAdmin:l,placeholder:"Store information paragraph",useTextarea:!0,textClassName:"text-sm"})}),a.jsx("div",{className:"flex space-x-3 pt-2",children:u.map(A=>a.jsx("a",{href:A.href,"aria-label":A.label,className:"p-2 rounded-full bg-background/50 hover:bg-primary/10 hover:scale-110 transition-all duration-300",style:{"--hover-bg-color":`${r.primaryColor}1A`,"--hover-text-color":r.primaryColor},children:a.jsx(A.icon,{className:"h-5 w-5"})},A.label))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(Yn,{initialText:w,onSave:A=>g("content.footerQuickLinksTitle",A),isAdmin:l,placeholder:"Quick Links Title",textClassName:"font-bold text-foreground"})}),a.jsx("ul",{className:"space-y-2",children:f.slice(0,5).map((A,E)=>a.jsx("li",{children:a.jsx("a",{href:A.href,className:"text-sm hover:text-primary transition-colors hover:translate-x-1 inline-block hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:a.jsx(Yn,{initialText:A.label,onSave:I=>g("content.footerNavLinks",I,E),isAdmin:l,placeholder:`Link ${E+1}`,textClassName:"text-sm"})})},A.label+E))})]}),a.jsxs(It.div,{variants:{hidden:{opacity:0,x:-30},visible:{opacity:1,x:0,transition:{duration:.5,ease:"easeOut",delay:.2}}},children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(Yn,{initialText:v,onSave:A=>g("content.footerCustomerServiceTitle",A),isAdmin:l,placeholder:"Customer Service Title",textClassName:"font-bold text-foreground"})}),a.jsx("ul",{className:"space-y-2",children:f.slice(5).map((A,E)=>a.jsx("li",{children:a.jsx("a",{href:A.href,className:"text-sm hover:text-primary transition-colors hover:translate-x-1 inline-block hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:a.jsx(Yn,{initialText:A.label,onSave:I=>g("content.footerNavLinks",I,E+5),isAdmin:l,placeholder:`Link ${E+6}`,textClassName:"text-sm"})})},A.label+E+5))})]}),a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(Yn,{initialText:_,onSave:A=>g("content.footerContactUsTitle",A),isAdmin:l,placeholder:"Contact Us Title",textClassName:"font-bold text-foreground"})}),a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(Wie,{className:"h-5 w-5 mt-0.5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsx(Yn,{initialText:C,onSave:A=>g("content.footerAddress",A),isAdmin:l,placeholder:"Store Address",useTextarea:!0,textClassName:"text-sm"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(dh,{className:"h-5 w-5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsxs("a",{href:`mailto:info@${n.toLowerCase().replace(/\s+/g,"")}.com`,className:"hover:text-primary hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:["info@",n.toLowerCase().replace(/\s+/g,""),".com"]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Qie,{className:"h-5 w-5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsx(Yn,{initialText:T,onSave:A=>g("content.footerPhoneNumber",A),isAdmin:l,placeholder:"Store Phone Number",textClassName:"text-sm hover:text-primary hover:underline decoration-primary/30 underline-offset-4"})]})]})]}),a.jsxs("div",{className:"border-t border-border/50 pt-6 flex flex-col md:flex-row justify-between items-center text-sm",children:[a.jsxs("p",{children:["© ",c," ",n,". ",a.jsx(Yn,{initialText:R,onSave:A=>g("content.footerCopyrightSuffix",A),isAdmin:l,placeholder:"Copyright suffix",textClassName:"text-sm",as:"span"})]}),a.jsx("div",{className:"flex items-center mt-4 md:mt-0",children:a.jsx(O,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-primary/10 transition-all duration-300",onClick:m,style:{"--hover-bg-color":`${r.primaryColor}1A`},children:a.jsx(Pie,{className:"h-5 w-5",style:{color:r.primaryColor}})})})]})]})}),a.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary/5 rounded-full translate-x-1/2 -translate-y-1/2 blur-3xl"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-secondary/5 rounded-full -translate-x-1/3 translate-y-1/3 blur-3xl"})]})},NRe=Object.freeze(Object.defineProperty({__proto__:null,default:Tq},Symbol.toStringTag,{value:"Module"})),PRe=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),ARe=({open:t,onOpenChange:e,product:n,onVideoGenerated:r})=>{var T,R,A,E;const[s,i]=p.useState(""),[o,l]=p.useState(null),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(!1),[g,x]=p.useState(null),{toast:w}=bs(),v=((R=(T=n==null?void 0:n.image)==null?void 0:T.src)==null?void 0:R.large)||((E=(A=n==null?void 0:n.image)==null?void 0:A.src)==null?void 0:E.medium);p.useEffect(()=>{t&&v&&(x(null),i(""),l(null),u(null),PRe(v).then(I=>{l(I.base64ImageData),u(I.mimeType)}).catch(I=>{console.error("Error loading product image data:",I),x(`Failed to load product image: ${I.message}`),w({title:"Error",description:`Failed to load product image: ${I.message}`,variant:"destructive"})}))},[t,v,w]);const _=async()=>{if(!o||!c){w({title:"Error",description:"Product image data is not available to suggest a prompt.",variant:"destructive"});return}h(!0),x(null);try{const I=await ca(o,c);i(I)}catch(I){console.error("Error generating prompt suggestion:",I),x(`Failed to suggest prompt: ${I.message}`),w({title:"Suggestion Failed",description:`Could not suggest a prompt: ${I.message}`,variant:"destructive"})}finally{h(!1)}},C=async()=>{if(!s.trim()){x("Please enter a prompt for the video.");return}if(!o||!c){x("Product image data is not available.");return}m(!0),x(null);try{const I=await JI(s,o,c);r&&r(I),e(!1)}catch(I){console.error("Error generating product video:",I),x(I.message||"Failed to generate video. Please try again."),w({title:"Video Generation Failed",description:I.message,variant:"destructive"})}finally{m(!1)}};return n?a.jsx(Xr,{open:t,onOpenChange:e,children:a.jsxs(Ur,{className:"sm:max-w-lg",children:[a.jsxs(Br,{children:[a.jsx(zr,{children:"Generate Product Video"}),a.jsxs(Zi,{children:['Create a short video for "',n.name,'" using its image and a prompt.']})]}),a.jsxs("div",{className:"grid gap-4 py-4",children:[v&&a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx("img",{src:v,alt:n.name,className:"w-32 h-32 object-contain rounded border"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Using this image as the base."})]}),a.jsxs("div",{className:"grid w-full gap-1.5",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(De,{htmlFor:"video-prompt",children:"Video Prompt"}),a.jsxs(O,{variant:"outline",size:"sm",onClick:_,disabled:d||f||!o,children:[d?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Suggest"]})]}),a.jsx(Pn,{id:"video-prompt",value:s,onChange:I=>i(I.target.value),placeholder:"e.g., A dynamic shot of the product with vibrant background...",rows:4,disabled:d||f}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"AI will use the product image and this prompt to create a video."})]}),g&&a.jsx("p",{className:"text-sm text-red-500 col-span-4 text-center",children:g})]}),a.jsxs(Ar,{children:[a.jsx(il,{asChild:!0,children:a.jsx(O,{variant:"outline",disabled:f,children:"Cancel"})}),a.jsxs(O,{onClick:C,disabled:d||f||!s.trim()||!o,children:[f?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Generate Video"]})]})]})}):null},nO="msy_4wQeZBKbKsyGKmfCOGWk0Ux9F7zGIByWSgwC",rO="https://api.meshy.ai/openapi/v1",kRe=({open:t,onOpenChange:e,product:n,storeId:r,onModelGenerated:s})=>{const{toast:i}=bs(),[o,l]=p.useState([]),[c,u]=p.useState(null),[d,h]=p.useState(0),[f,m]=p.useState(""),[g,x]=p.useState(""),[w,v]=p.useState(!1),[_,C]=p.useState(null),T=p.useCallback(()=>{var k,j,D,M,G,B,W;return n?(j=(k=n.image)==null?void 0:k.src)!=null&&j.large||(M=(D=n.image)==null?void 0:D.src)!=null&&M.medium?[{name:"Main Product Image",url:n.image.src.large||n.image.src.medium}]:((B=(G=n.images)==null?void 0:G.edges)==null?void 0:B.length)>0&&((W=n.images.edges[0].node)!=null&&W.url)?n.images.edges.map((Q,H)=>({name:`Product Image ${H+1}`,url:Q.node.url})).slice(0,4):[]:[]},[n]);p.useEffect(()=>{t&&n?(l(T().slice(0,1)),u(null),h(0),m(""),x(""),v(!1),_&&(clearInterval(_),C(null))):!t&&_&&(clearInterval(_),C(null))},[t,n,T,_]);const R=k=>{const j=Array.from(k.target.files);if(j.length===0)return;const D=[];let M=o.length;j.forEach(G=>{if(M>=4){i({title:"Limit Reached",description:"You can select up to 4 images.",variant:"warning"});return}const B=new FileReader;B.onload=W=>{D.push({name:G.name,url:W.target.result,file:G}),D.length===Math.min(j.length,4-o.length)&&l(Q=>[...Q,...D].slice(0,4))},B.readAsDataURL(G),M++})},A=k=>{l(j=>j.filter((D,M)=>M!==k))},E=async()=>{if(o.length===0){i({title:"No Image Selected",description:"Please select at least one image.",variant:"destructive"});return}v(!0),x(""),m("PENDING"),h(5);const k=o.length>1?"/multi-image-to-3d":"/image-to-3d",j=o.length>1?{image_urls:o.map(D=>D.url)}:{image_url:o[0].url};j.enable_pbr=!0,j.should_texture=!0,o.length===1&&(n!=null&&n.name);try{const D=await fetch(`${rO}${k}`,{method:"POST",headers:{Authorization:`Bearer ${nO}`,"Content-Type":"application/json"},body:JSON.stringify(j)}),M=await D.json();if(!D.ok)throw new Error(M.detail||M.message||`API Error: ${D.status}`);if(M.result){u(M.result),m("IN_PROGRESS"),h(10);const G=setInterval(()=>I(M.result,k),5e3);C(G)}else throw new Error("Task ID not found in response.")}catch(D){console.error("Error creating Meshy task:",D),x(`Error creating task: ${D.message}`),m("FAILED"),v(!1)}},I=async(k,j)=>{var D,M;try{const G=await fetch(`${rO}${j}/${k}`,{headers:{Authorization:`Bearer ${nO}`}}),B=await G.json();if(!G.ok){if(G.status===404&&d<30){h(W=>Math.min(W+5,30));return}throw new Error(B.detail||B.message||`API Error: ${G.status}`)}if(h(B.progress||d),m(B.status),B.status==="SUCCEEDED")if(_&&clearInterval(_),C(null),v(!1),(D=B.model_urls)!=null&&D.glb)s(B.model_urls.glb),i({title:"3D Model Generated!",description:"The model has been successfully created."}),e(!1);else throw new Error("GLB model URL not found in successful response.");else B.status==="FAILED"?(_&&clearInterval(_),C(null),x(((M=B.task_error)==null?void 0:M.message)||"Generation failed for an unknown reason."),v(!1)):(B.status==="PENDING"||B.status==="IN_PROGRESS")&&B.progress===100&&B.status==="IN_PROGRESS"&&h(99)}catch(G){console.error("Error polling Meshy task status:",G),x(`Error polling status: ${G.message}`),_&&clearInterval(_),C(null),m("FAILED"),v(!1)}},P=()=>{_&&(clearInterval(_),C(null)),e(!1)};return a.jsx(Xr,{open:t,onOpenChange:P,children:a.jsxs(Ur,{className:"sm:max-w-lg",children:[a.jsx(Br,{children:a.jsxs(zr,{children:["Generate 3D Model for ",(n==null?void 0:n.name)||(n==null?void 0:n.title)||"Product"]})}),a.jsxs("div",{className:"py-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"image-upload",children:"Product Images (select 1-4)"}),a.jsxs("div",{className:"mt-2 grid grid-cols-2 sm:grid-cols-4 gap-2 mb-2",children:[o.map((k,j)=>a.jsxs("div",{className:"relative group aspect-square border rounded-md overflow-hidden",children:[a.jsx("img",{src:k.url,alt:k.name,className:"w-full h-full object-cover"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 opacity-50 group-hover:opacity-100",onClick:()=>A(j),disabled:w||f==="IN_PROGRESS",children:a.jsx(Wn,{size:14})})]},j)),o.length<4&&a.jsxs(De,{htmlFor:"image-upload-input",className:"aspect-square border-2 border-dashed rounded-md flex flex-col items-center justify-center cursor-pointer hover:border-primary transition-colors text-muted-foreground",children:[a.jsx(Uo,{size:24,className:"mb-1"}),a.jsx("span",{className:"text-xs",children:"Add Image"})]})]}),a.jsx(Ye,{id:"image-upload-input",type:"file",multiple:!0,accept:"image/png, image/jpeg, image/jpg",onChange:R,className:"hidden",disabled:w||f==="IN_PROGRESS"||o.length>=4}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Default is main product image. You can add up to 4 images (PNG, JPG). More images can improve quality."})]}),f&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs(De,{children:["Status: ",f]}),f==="SUCCEEDED"&&a.jsx(ya,{className:"h-5 w-5 text-green-500"}),f==="FAILED"&&a.jsx(rw,{className:"h-5 w-5 text-red-500"}),(f==="PENDING"||f==="IN_PROGRESS")&&a.jsx(ft,{className:"h-5 w-5 animate-spin"})]}),a.jsx($a,{value:d,className:"w-full"}),g&&a.jsx("p",{className:"text-sm text-red-500",children:g})]})]}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",onClick:P,disabled:w&&f==="IN_PROGRESS",children:"Cancel"}),a.jsxs(O,{type:"button",onClick:E,disabled:w||o.length===0||f==="IN_PROGRESS"||f==="SUCCEEDED",children:[w&&(f==="PENDING"||f==="IN_PROGRESS")?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,f==="IN_PROGRESS"?"Generating...":"Generate 3D Model"]})]})]})})},RRe=({modelUrl:t,thumbnailUrl:e,productName:n="Product",className:r="",height:s="400px",showControls:i=!0,autoRotate:o=!1,cameraControls:l=!0,ar:c=!0})=>{const u=p.useRef(null);p.useEffect(()=>{if(!window.customElements.get("model-viewer")){const m=document.createElement("script");m.type="module",m.src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js",document.head.appendChild(m)}},[]);const d=()=>{u.current&&(u.current.resetTurntableRotation(),u.current.jumpCameraToGoal())},h=()=>{u.current&&u.current.requestFullscreen&&u.current.requestFullscreen()},f=()=>{if(t){const m=document.createElement("a");m.href=t,m.download=`${n.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_3d_model.glb`,document.body.appendChild(m),m.click(),document.body.removeChild(m)}};return t?a.jsx(Je,{className:r,children:a.jsxs(it,{className:"p-0 relative",children:[a.jsxs("model-viewer",{ref:u,src:t,poster:e,alt:`3D model of ${n}`,style:{width:"100%",height:s,backgroundColor:"#f8f9fa"},"camera-controls":l,"auto-rotate":o,ar:c,"ar-modes":"webxr scene-viewer quick-look","environment-image":"neutral","shadow-intensity":"1",exposure:"1","tone-mapping":"neutral",loading:"eager",children:[a.jsx("div",{slot:"progress-bar",className:"absolute inset-0 flex items-center justify-center bg-background/80",children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading 3D model..."})]})}),a.jsx("div",{slot:"error",className:"absolute inset-0 flex items-center justify-center bg-background",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-destructive mb-2",children:"Failed to load 3D model"}),a.jsx(O,{variant:"outline",size:"sm",onClick:()=>window.location.reload(),children:"Retry"})]})})]}),i&&a.jsxs("div",{className:"absolute top-2 right-2 flex flex-col space-y-1",children:[a.jsx(O,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:d,title:"Reset camera",children:a.jsx(eoe,{className:"h-4 w-4"})}),a.jsx(O,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:h,title:"Fullscreen",children:a.jsx(Hie,{className:"h-4 w-4"})}),a.jsx(O,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:f,title:"Download model",children:a.jsx(jI,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"absolute bottom-2 right-2"})]})}):a.jsx(Je,{className:r,children:a.jsx(it,{className:"flex items-center justify-center p-6",style:{height:s},children:a.jsx("p",{className:"text-muted-foreground",children:"No 3D model available"})})})},jRe=({product:t,storeId:e,isPublishedView:n=!1})=>{const{toast:r}=bs(),{getStoreById:s}=zn(),[i,o]=p.useState(null),[l,c]=p.useState(null),[u,d]=p.useState(""),[h,f]=p.useState([]),[m,g]=p.useState([]),[x,w]=p.useState(null),[v,_]=p.useState(!1),[C,T]=p.useState(""),[R,A]=p.useState("#FFFFFF"),[E,I]=p.useState({}),[P,k]=p.useState(""),[j,D]=p.useState(""),[M,G]=p.useState(!1),[B,W]=p.useState(!1);p.useEffect(()=>{if(e){const $=s(e);o($),$&&t&&f($.products.filter(z=>{var F,Z;return z.id!==t.id&&((Z=(F=z.image)==null?void 0:F.src)==null?void 0:Z.medium)}))}},[e,t,s]);const Q=$=>{const z=$.target.files[0];if(z){z.size>5*1024*1024&&r({title:"File too large",description:"Reference image should ideally be under 5MB.",variant:"destructive"}),c(z);const F=new FileReader;F.onloadend=()=>d(F.result),F.readAsDataURL(z),w(null),k(""),D("")}},H=()=>{c(null),d(""),w(null),k(""),D("")},Y=$=>{g(z=>z.find(F=>F.id===$.id)?z.filter(F=>F.id!==$.id):[...z,$]),w(null),k(""),D("")},V=async()=>{var F,Z,fe,xe;if(!t||!l){r({title:"Missing inputs",description:"Main product and a reference image are required.",variant:"destructive"});return}_(!0),w(null),k(""),D("Generating visualization, please wait...");let $=C;R&&R!=="#FFFFFF"&&($=`${$} The main product's color should be ${R}.`.trim());const z=Object.entries(E);if(z.length>0){const ge=z.map(([Re,Ue])=>`${Re}: ${Ue}`).join(", ");$=`${$} Apply these product attributes: ${ge}.`.trim()}try{const ge={name:t.name,description:t.description,imageSource:((Z=(F=t.image)==null?void 0:F.src)==null?void 0:Z.large)||((xe=(fe=t.image)==null?void 0:fe.src)==null?void 0:xe.medium)},Re=m.map(ze=>{var he,Ce,Pe,ve;return{name:ze.name,description:ze.description,imageSource:((Ce=(he=ze.image)==null?void 0:he.src)==null?void 0:Ce.large)||((ve=(Pe=ze.image)==null?void 0:Pe.src)==null?void 0:ve.medium)}}),Ue=await wq({mainProduct:ge,referenceSceneSource:l,additionalProducts:Re,customInstructions:$});k(Ue.promptUsed||"Prompt details not available."),D(Ue.commentary||"Processing complete."),Ue&&Ue.imageUrl?(w(Ue.imageUrl),r({title:"Visualization Generated!",description:Ue.commentary||"Image created."})):r({title:"Visualization Issue",description:Ue.commentary||"No image generated by AI.",variant:"default",duration:7e3})}catch(ge){console.error("Error in ProductVisualizer calling generateProductVisualization:",ge);const Re=ge.message||"An unknown error occurred during visualization.";D(`Error: ${Re}`),r({title:"Visualization Failed",description:Re,variant:"destructive",duration:1e4})}finally{_(!1)}};return!t||!i?a.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"Initializing Product Visualizer..."}):a.jsxs("div",{className:"my-8 border rounded-lg shadow-sm bg-card",children:[a.jsxs("div",{className:"p-4 md:p-6 cursor-pointer flex justify-between items-center",onClick:()=>W(!B),role:"button",tabIndex:0,onKeyDown:$=>($.key==="Enter"||$.key===" ")&&W(!B),"aria-expanded":B,"aria-controls":"product-visualizer-content-area",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl md:text-2xl font-semibold",children:"Product Visualizer"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["See how ",a.jsx("span",{className:"font-medium text-primary",children:t.name})," looks in different settings."]})]}),a.jsx(O,{variant:"ghost",size:"icon","aria-label":B?"Collapse visualizer":"Expand visualizer",children:B?a.jsx(L3,{className:"h-6 w-6"}):a.jsx(Iu,{className:"h-6 w-6"})})]}),B&&a.jsxs("div",{id:"product-visualizer-content-area",className:"p-4 md:p-6 border-t",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[a.jsxs("div",{className:"space-y-4 md:space-y-6",children:[a.jsxs("div",{children:[a.jsx(De,{htmlFor:"visualizer-reference-image-upload",className:"text-md font-medium block mb-1",children:"1. Upload Reference Scene"}),a.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"E.g., a room, a model. (Max ~5MB recommended)"}),u?a.jsxs("div",{className:"relative group aspect-video rounded-md border overflow-hidden bg-muted/20",children:[a.jsx("img",{src:u,alt:"Reference scene preview",className:"w-full h-full object-contain"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute top-2 right-2 opacity-50 group-hover:opacity-100 transition-opacity",onClick:H,"aria-label":"Remove reference image",children:a.jsx(Ki,{className:"h-4 w-4"})})]}):a.jsxs("label",{htmlFor:"visualizer-reference-image-input",className:"mt-1 flex flex-col justify-center items-center w-full h-40 md:h-48 px-6 py-5 border-2 border-dashed rounded-md cursor-pointer hover:border-primary transition-colors",children:[a.jsx(Uo,{className:"mx-auto h-8 md:h-10 w-8 md:w-10 text-muted-foreground mb-2"}),a.jsx("span",{className:"font-semibold text-primary text-sm",children:"Click to upload image"}),a.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG, GIF, WEBP"}),a.jsx(Ye,{id:"visualizer-reference-image-input",type:"file",className:"sr-only",accept:"image/*",onChange:Q})]})]}),h.length>0&&a.jsxs("div",{children:[a.jsx(De,{className:"text-md font-medium block mb-1",children:"2. Add Other Products (Optional)"}),a.jsx(xs,{className:"h-32 md:h-40 border rounded-md p-2",children:a.jsx("div",{className:"space-y-1.5",children:h.map($=>a.jsxs("div",{className:`flex items-center justify-between p-2 rounded-md cursor-pointer transition-all text-sm ${m.some(z=>z.id===$.id)?"bg-primary/10 ring-1 ring-primary":"hover:bg-muted/50"}`,onClick:()=>Y($),role:"checkbox","aria-checked":m.some(z=>z.id===$.id),tabIndex:0,onKeyDown:z=>(z.key==="Enter"||z.key===" ")&&Y($),children:[a.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[a.jsx("img",{src:$.image.src.medium,alt:$.name,className:"w-8 h-8 object-cover rounded flex-shrink-0"}),a.jsx("span",{className:"truncate",title:$.name,children:$.name})]}),m.some(z=>z.id===$.id)&&a.jsx(ya,{className:"h-4 w-4 text-primary flex-shrink-0"})]},$.id))})})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"visualizer-product-color",className:"text-md font-medium block mb-1",children:"3. Main Product Color (Optional)"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ye,{type:"color",id:"visualizer-product-color",value:R,onChange:$=>A($.target.value),className:"w-12 h-10 p-1"}),a.jsx(Ye,{type:"text",value:R,onChange:$=>A($.target.value),placeholder:"#FFFFFF",className:"flex-grow h-10 text-sm"})]})]}),t.variants&&t.variants.length>0&&a.jsxs("div",{children:[a.jsx(De,{className:"text-md font-medium block mb-1",children:"3. Main Product Variants (Optional)"}),a.jsx("div",{className:"space-y-2",children:t.variants.map($=>!$.name||!$.values||$.values.length===0?null:a.jsxs("div",{children:[a.jsx(De,{htmlFor:`visualizer-variant-${$.name}`,className:"text-sm text-muted-foreground",children:$.name}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:$.values.map(z=>a.jsx(O,{variant:E[$.name]===z?"default":"outline",size:"xs",onClick:()=>I(F=>({...F,[$.name]:z})),className:"text-xs px-2 py-1 h-auto",children:z},z))})]},$.name))})]}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"visualizer-custom-prompt",className:"text-md font-medium block mb-1",children:t.variants&&t.variants.length>0?"5. Additional Custom Instructions (Optional)":"4. Custom Instructions (Optional)"}),a.jsx(Pn,{id:"visualizer-custom-prompt",placeholder:"e.g., 'place the sofa by the window', 'make it a sunny day'",value:C,onChange:$=>T($.target.value),rows:2,className:"resize-none text-sm"})]}),a.jsxs(O,{onClick:V,disabled:v||!l,className:"w-full py-2.5 text-sm md:text-base",size:"lg",children:[v?a.jsx(ft,{className:"mr-2 h-5 w-5 animate-spin"}):a.jsx(Ca,{className:"mr-2 h-5 w-5"}),"Generate Visualization"]})]}),a.jsx("div",{className:"flex flex-col items-center justify-center border rounded-md p-2 md:p-4 bg-muted/30 min-h-[250px] md:min-h-[300px] lg:min-h-full relative",children:v?a.jsxs("div",{className:"text-center",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary mb-3"}),a.jsx("p",{className:"text-muted-foreground font-medium",children:j||"Generating your scene..."})]}):x?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:x,alt:"Generated Product Visualization",className:"max-w-full max-h-[calc(100%-40px)] object-contain rounded-md"}),j&&!j.toLowerCase().includes("error")&&a.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center max-w-xs mx-auto",children:j}),a.jsxs(O,{variant:"ghost",size:"sm",onClick:()=>G(!M),className:"absolute bottom-1 right-1 text-muted-foreground hover:text-primary h-auto p-1","aria-label":"Toggle prompt information",children:[a.jsx(Vie,{className:"h-4 w-4 mr-1"})," ",a.jsx("span",{className:"text-xs",children:"Info"})]})]}):a.jsxs("div",{className:"text-center text-muted-foreground p-4",children:[j&&a.jsx("p",{className:`text-sm mb-2 ${j.toLowerCase().includes("error")||j.toLowerCase().includes("failed")?"text-destructive":""}`,children:j}),a.jsx(Ca,{className:"h-12 w-12 mx-auto mb-3"}),a.jsx("p",{className:"font-medium",children:"Your product visualization will appear here."}),!x&&a.jsx("p",{className:"text-xs mt-1",children:'Upload a reference scene and click "Generate".'})]})})]}),M&&P&&!n&&a.jsxs("div",{className:"mt-4 p-3 border rounded-md bg-muted/50",children:[a.jsx(De,{className:"text-xs font-semibold text-muted-foreground",children:"Technical Prompt Sent to AI:"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1 whitespace-pre-wrap",children:P})]}),a.jsx(Ui,{className:"mt-6 md:mt-8 mb-0"})]})]})};var Iq=p.forwardRef(({transition:t,...e},n)=>{let r={position:"absolute",top:0,left:0,width:"100%",height:"100%",transition:t?`clip-path ${t}`:void 0,userSelect:"none",willChange:"clip-path, transition",KhtmlUserSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none"};return a.jsx("div",{...e,style:r,"data-rcs":"clip-item",ref:n})});Iq.displayName="ContainerClip";var Nq=p.forwardRef(({children:t,disabled:e,portrait:n,position:r,transition:s},i)=>{let o={position:"absolute",top:0,width:n?"100%":void 0,height:n?void 0:"100%",background:"none",border:0,padding:0,pointerEvents:"all",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",outline:0,transform:n?"translate3d(0, -50% ,0)":"translate3d(-50%, 0, 0)",transition:s?`${n?"top":"left"} ${s}`:void 0};return a.jsx("button",{ref:i,"aria-label":"Drag to move or focus and use arrow keys","aria-orientation":n?"vertical":"horizontal","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":r,"data-rcs":"handle-container",disabled:e,role:"slider",style:o,children:t})});Nq.displayName="ThisHandleContainer";var sO=({flip:t})=>a.jsx("div",{className:"__rcs-handle-arrow",style:{width:0,height:0,borderTop:"8px solid transparent",borderRight:"10px solid",borderBottom:"8px solid transparent",transform:t?"rotate(180deg)":void 0}}),DRe=({className:t="__rcs-handle-root",disabled:e,buttonStyle:n,linesStyle:r,portrait:s,style:i,...o})=>{let l={display:"flex",flexDirection:s?"row":"column",placeItems:"center",height:"100%",cursor:e?"not-allowed":s?"ns-resize":"ew-resize",pointerEvents:"none",color:"#fff",...i},c={flexGrow:1,height:s?2:"100%",width:s?"100%":2,backgroundColor:"currentColor",pointerEvents:"auto",boxShadow:"0 0 4px rgba(0,0,0,.5)",...r},u={display:"grid",gridAutoFlow:"column",gap:8,placeContent:"center",flexShrink:0,width:56,height:56,borderRadius:"50%",borderStyle:"solid",borderWidth:2,pointerEvents:"auto",backdropFilter:"blur(7px)",WebkitBackdropFilter:"blur(7px)",backgroundColor:"rgba(0, 0, 0, 0.125)",boxShadow:"0 0 4px rgba(0,0,0,.35)",transform:s?"rotate(90deg)":void 0,...n};return a.jsxs("div",{...o,className:t,style:l,children:[a.jsx("div",{className:"__rcs-handle-line",style:c}),a.jsxs("div",{className:"__rcs-handle-button",style:u,children:[a.jsx(sO,{}),a.jsx(sO,{flip:!0})]}),a.jsx("div",{className:"__rcs-handle-line",style:c})]})},Pq=(t=>(t.ARROW_LEFT="ArrowLeft",t.ARROW_RIGHT="ArrowRight",t.ARROW_UP="ArrowUp",t.ARROW_DOWN="ArrowDown",t))(Pq||{}),MRe=({boxSizing:t="border-box",objectFit:e="cover",objectPosition:n="center center",...r}={})=>({display:"block",width:"100%",height:"100%",maxWidth:"100%",boxSizing:t,objectFit:e,objectPosition:n,...r}),LRe=t=>{let e=p.useRef(t);return p.useEffect(()=>{e.current=t}),e.current},mC=(t,e,n,r)=>{let s=p.useRef();p.useEffect(()=>{s.current=e},[e]),p.useEffect(()=>{if(!(n&&n.addEventListener))return;let i=o=>s.current&&s.current(o);return n.addEventListener(t,i,r),()=>{n.removeEventListener(t,i,r)}},[t,n,r])},FRe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect,ORe=(t,e)=>{let n=p.useRef(),r=p.useCallback(()=>{t.current&&n.current&&n.current.observe(t.current)},[t]);FRe(()=>(n.current=new ResizeObserver(([s])=>e(s.contentRect)),r(),()=>{n.current&&n.current.disconnect()}),[e,r])},Nx={capture:!1,passive:!0},pC={capture:!0,passive:!1},VRe=t=>{t.preventDefault(),t.currentTarget.focus()},Aq=p.forwardRef(({boundsPadding:t=0,browsingContext:e=globalThis,changePositionOnHover:n=!1,disabled:r=!1,handle:s,itemOne:i,itemTwo:o,keyboardIncrement:l="5%",onlyHandleDraggable:c=!1,onPositionChange:u,portrait:d=!1,position:h=50,style:f,transition:m,...g},x)=>{let w=p.useRef(null),v=p.useRef(null),_=p.useRef(null),C=p.useRef(h),[T,R]=p.useState(!1),[A,E]=p.useState(!0),I=p.useRef(!1),[P,k]=p.useState(),j=LRe(h),D=p.useCallback(function({x:$,y:z,isOffset:F}){let Z=w.current,fe=_.current,xe=v.current,{width:ge,height:Re,left:Ue,top:ze}=Z.getBoundingClientRect();if(ge===0||Re===0)return;let he=d?F?z-ze-e.scrollY:z:F?$-Ue-e.scrollX:$,Ce=Math.min(Math.max(he/(d?Re:ge)*100,0),100),Pe=d?Re/(Z.offsetHeight||1):ge/(Z.offsetWidth||1),ve=t*Pe/(d?Re:ge)*100,de=Math.min(Math.max(Ce,ve*Pe),100-ve*Pe);C.current=Ce,fe.setAttribute("aria-valuenow",`${Math.round(C.current)}`),fe.style.top=d?`${de}%`:"0",fe.style.left=d?"0":`${de}%`,xe.style.clipPath=d?`inset(${de}% 0 0 0)`:`inset(0 0 0 ${de}%)`,u&&u(C.current)},[t,u,d,e]);p.useEffect(()=>{let{width:$,height:z}=w.current.getBoundingClientRect(),F=h===j?C.current:h;D({x:$/100*F,y:z/100*F})},[t,h,d,j,D]);let M=p.useCallback($=>{$.preventDefault(),!(r||$.button!==0)&&(D({isOffset:!0,x:$.pageX,y:$.pageY}),R(!0),E(!0))},[r,D]),G=p.useCallback(function($){D({isOffset:!0,x:$.pageX,y:$.pageY}),E(!1)},[D]),B=p.useCallback(()=>{R(!1),E(!0)},[]),W=p.useCallback(({width:$,height:z})=>{let{width:F,height:Z}=w.current.getBoundingClientRect();D({x:$/100*C.current*F/$,y:z/100*C.current*Z/z})},[D]),Q=p.useCallback($=>{if(!Object.values(Pq).includes($.key))return;$.preventDefault(),E(!0);let{top:z,left:F}=_.current.getBoundingClientRect(),{width:Z,height:fe}=w.current.getBoundingClientRect(),xe=typeof l=="string"?parseFloat(l):l/Z*100,ge=d?$.key==="ArrowLeft"||$.key==="ArrowDown":$.key==="ArrowRight"||$.key==="ArrowUp",Re=Math.min(Math.max(ge?C.current+xe:C.current-xe,0),100);D({x:d?F:Z*Re/100,y:d?fe*Re/100:z})},[l,d,D]);p.useEffect(()=>{k(c?_.current:w.current)},[c]),p.useEffect(()=>{let $=w.current,z=()=>{T||B()};return n&&($.addEventListener("pointermove",G,Nx),$.addEventListener("pointerleave",z,Nx)),()=>{$.removeEventListener("pointermove",G),$.removeEventListener("pointerleave",z)}},[n,G,B,T]),p.useEffect(()=>(T&&!I.current&&(e.addEventListener("pointermove",G,Nx),e.addEventListener("pointerup",B,Nx),I.current=!0),()=>{I.current&&(e.removeEventListener("pointermove",G),e.removeEventListener("pointerup",B),I.current=!1)}),[G,B,T,e]),p.useImperativeHandle(x,()=>({rootContainer:w.current,handleContainer:_.current,setPosition($){let{width:z,height:F}=w.current.getBoundingClientRect();D({x:z/100*$,y:F/100*$})}}),[D]),ORe(w,W),mC("keydown",Q,_.current,pC),mC("click",VRe,_.current,pC),mC("pointerdown",M,P,pC);let H=s||a.jsx(DRe,{disabled:r,portrait:d}),Y=A?m:void 0,V={position:"relative",display:"flex",overflow:"hidden",cursor:T?d?"ns-resize":"ew-resize":void 0,touchAction:"none",userSelect:"none",KhtmlUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",...f};return a.jsxs("div",{...g,ref:w,style:V,"data-rcs":"root",children:[i,a.jsx(Iq,{ref:v,transition:Y,children:o}),a.jsx(Nq,{disabled:r,portrait:d,position:Math.round(C.current),ref:_,transition:Y,children:H})]})});Aq.displayName="ReactCompareSlider";var v1=p.forwardRef(({style:t,...e},n)=>{let r=MRe(t);return a.jsx("img",{ref:n,...e,style:r,"data-rcs":"image"})});v1.displayName="ReactCompareSliderImage";const $Re=()=>{var J,ue,we,Le,Ze,X,ne,me;const t=N0(),e=t.storeName,n=decodeURIComponent(t.productId),{getStoreByName:r,getProductById:s,updateProductImage:i,updateStore:o,isLoadingStores:l,viewMode:c,updateProductImagesArray:u}=zn(),d=c==="published",{toast:h}=bs(),f=bi(),m=Yw(),[g,x]=p.useState(null),[w,v]=p.useState(null),[_,C]=p.useState(1),[T,R]=p.useState({}),[A,E]=p.useState(null),[I,P]=p.useState(!1),[k,j]=p.useState(""),[D,M]=p.useState([]),[G,B]=p.useState(!1),[W,Q]=p.useState(!1),[H,Y]=p.useState(null),[V,$]=p.useState(""),[z,F]=p.useState(!1),[Z,fe]=p.useState(!1),[xe,ge]=p.useState(""),[Re,Ue]=p.useState(!1),[ze,he]=p.useState(""),[Ce,Pe]=p.useState(""),[ve,de]=p.useState(""),[Me,Ge]=p.useState([]),[yt,Pt]=p.useState(!1),[en,fn]=p.useState(null),[an,dn]=p.useState(""),[Lt,xn]=p.useState(""),[te,Ee]=p.useState(!1),[ee,le]=p.useState(!1),K=q=>{let ie=q.split(","),be=ie[0].match(/:(.*?);/)[1],Ie=atob(ie[1]),Ve=Ie.length,Se=new Uint8Array(Ve);for(;Ve--;)Se[Ve]=Ie.charCodeAt(Ve);return new Blob([Se],{type:be})},Ae=async()=>{if(!ve||!w||!g){h({title:"Missing data",description:"Cannot generate angles without an active image, product, or store context.",variant:"destructive"});return}Ee(!0);try{const{base64ImageData:q,mimeType:ie}=await Oe(ve),be=await W0(q,ie,w.name||"Product");if(be&&be.length>0){const Ie=[];for(const lt of be)if(lt.startsWith("data:")){const jt=K(lt),vn=`angle-${Date.now()}-${Math.random().toString(36).substring(2,15)}.png`,ts=`products/${g.id}/${w.id}/angles/${vn}`,Vn=vh(wh,ts);await yh(Vn,jt);const Wr=await xh(Vn);Ie.push(Wr)}else Ie.push(lt);const Ve=Ie.map((lt,jt)=>({id:`angle-${w.id}-${Me.length+jt}-${Dt()}`,src:{medium:lt,large:lt},alt:`${w.name} - Angle ${Me.length+jt+1}`})),Se=[...Me,...Ve];Ge(Se);const ot=Se.map(lt=>lt.src.large||lt.src.medium);await u(g.id,w.id,ot),h({title:"Angles Generated & Stored",description:`${Ie.length} new angle images added to gallery and storage.`})}else h({title:"No Angles Generated",description:"The AI did not return any new angle images.",variant:"default"})}catch(q){console.error("Error generating or storing angles on detail page:",q),h({title:"Angle Generation/Storage Failed",description:q.message,variant:"destructive"})}Ee(!1)},Ne=async q=>{var Ie,Ve;if(!g||!w)return;const ie=Me.filter(Se=>Se.id!==q);if(ie.length===0){const Se=`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(w.name||"Product")}`;Ge([{id:`placeholder-${w.id}`,src:{medium:Se,large:Se},alt:w.name||"Product image"}]),de(Se)}else Ge(ie),(ve===((Ie=Me.find(Se=>Se.id===q))==null?void 0:Ie.src.large)||ve===((Ve=Me.find(Se=>Se.id===q))==null?void 0:Ve.src.medium))&&de(ie[0].src.large||ie[0].src.medium);const be=ie.map(Se=>Se.src.large||Se.src.medium).filter(Se=>!Se.includes("via.placeholder.com"));await u(g.id,w.id,be),h({title:"Image Deleted",description:"Image removed from gallery.",variant:"destructive"})},Oe=p.useCallback(q=>new Promise((ie,be)=>{if(!q)return be(new Error("Image source is undefined or null."));if(q.startsWith("data:"))try{const Ie=q.split(",");if(Ie.length<2)throw new Error("Invalid data URL structure.");const Ve=Ie[0],Se=Ie[1],ot=Ve.match(/:(.*?);/);if(!ot||!ot[1])throw new Error("Could not parse MIME type from data URL.");const lt=ot[1];ie({base64ImageData:Se,mimeType:lt})}catch(Ie){console.error("Error parsing data URL:",q,Ie),be(new Error(`Invalid data URL format: ${Ie.message}`))}else{const Ie=new Image;Ie.crossOrigin="Anonymous",Ie.onload=()=>{const Ve=document.createElement("canvas");Ve.width=Ie.naturalWidth,Ve.height=Ie.naturalHeight,Ve.getContext("2d").drawImage(Ie,0,0);try{const jt=Ve.toDataURL("image/png").split(",")[1];ie({base64ImageData:jt,mimeType:"image/png"})}catch(ot){console.error("Canvas toDataURL failed:",ot),be(new Error("Canvas toDataURL failed, possibly due to CORS or tainted canvas. "+ot.message))}},Ie.onerror=Ve=>{console.error("Failed to load image from URL for conversion:",q,Ve),be(new Error("Failed to load image from URL for conversion."))},Ie.src=q}}),[]);p.useCallback(async()=>{if(!V.trim()||!ve||!w||!g){h({title:"Missing data",description:"Active image, edit prompt, product, or store context is missing.",variant:"destructive"});return}F(!0);try{const{base64ImageData:q,mimeType:ie}=await Oe(ve),be=await Wo(q,ie,V);if(be&&be.editedImageData&&be.newMimeType){const Ie=`data:${be.newMimeType};base64,${be.editedImageData}`,Ve=K(Ie),Se=`edited-${Date.now()}.png`,ot=`products/${g.id}/${w.id}/images/${Se}`,lt=vh(wh,ot);await yh(lt,Ve);const jt=await xh(lt),vn={id:Dt(),src:{medium:jt,large:jt},alt:`${w.name} (edited: ${V.substring(0,20)}...)`,photographer:"Edited with Gemini AI via Firebase Storage"};await i(g.id,n,vn);const ts=Me.map(Vn=>Vn.src.medium===ve||Vn.src.large===ve?vn:Vn);Me.some(Vn=>Vn.src.medium===ve||Vn.src.large===ve)||ts.push(vn),Ge(ts),de(jt),h({title:"Image Edited & Stored",description:"Product image updated and saved to storage."}),Q(!1),$("")}else throw new Error("AI did not return valid edited image data.")}catch(q){console.error("Error editing image or uploading to storage:",q),h({title:"Image Edit Failed",description:q.message,variant:"destructive"})}F(!1)},[ve,V,w,g,n,i,Me,h,Oe,K]),p.useEffect(()=>{var ie,be,Ie,Ve;if(l)return;const q=r(e);if(q){x(q);const Se=s(q.id,n);if(Se){v(Se),j(Se.name),ge(Se.video_url||""),he(Se.model_3d_url||""),Pe(Se.model_3d_thumbnail_url||"");let ot=[];Se.images&&Array.isArray(Se.images)&&Se.images.length>0?ot=Se.images.map((jt,vn)=>({id:`gallery-img-${Se.id}-${vn}-${Dt()}`,src:{medium:jt,large:jt},alt:`${Se.name||"Product"} image ${vn+1}`})):Se.image&&Se.image.src?ot=[{id:Se.image.id||`gallery-img-${Se.id}-0-${Dt()}`,src:Se.image.src,alt:Se.image.alt||`${Se.name||"Product"} image`}]:ot=[{id:`placeholder-${Se.id||Dt()}`,src:{medium:`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(Se.name||"Product")}`,large:`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(Se.name||"Product")}`},alt:Se.name||"Product image"}],Se.video_url&&ot.push({id:`video-${Se.id}-${Dt()}`,src:{medium:Se.video_url,large:Se.video_url},alt:`${Se.name} video`,type:"video"}),Ge(ot),de(((be=(ie=ot[0])==null?void 0:ie.src)==null?void 0:be.large)||((Ve=(Ie=ot[0])==null?void 0:Ie.src)==null?void 0:Ve.medium)||"");let lt=[];if(Se.options&&Array.isArray(Se.options)?lt=Se.options:Se.variants&&Array.isArray(Se.variants)&&Se.variants.length>0&&Se.variants[0].name&&Se.variants[0].values&&(lt=Se.variants),lt.length>0){const jt={};lt.forEach(vn=>{vn.values&&vn.values.length>0&&(jt[vn.name]=vn.values[0])}),R(jt)}}else h({title:"Product not found",description:`Product ID ${n} not found in store ${q.name}.`,variant:"destructive"}),f(`/${e}`)}else h({title:"Store not found",description:`Could not find store: ${e}`,variant:"destructive"}),f("/")},[e,n,r,s,f,h,l]),p.useEffect(()=>{var q,ie,be,Ie,Ve;if(w&&Object.keys(T).length>0){if(((ie=(q=w.variants)==null?void 0:q.edges)==null?void 0:ie.length)>0){const Se=(be=w.variants.edges.find(ot=>!ot.node||!ot.node.selectedOptions?!1:ot.node.selectedOptions.every(lt=>T[lt.name]===lt.value)))==null?void 0:be.node;if(Se){E(Se);return}}}else w&&((Ve=(Ie=w.variants)==null?void 0:Ie.edges)==null?void 0:Ve.length)>0&&Object.keys(T).length},[w,T]);const He=q=>{const ie=parseInt(q.target.value);ie>0&&C(ie)},ce=async()=>{if(!g||!w||!At||Tn===void 0||!mr){h({title:"Error",description:"Product or store data is incomplete for checkout.",variant:"destructive"});return}if(!g.merchant_id){console.error("Store merchant_id is missing.",g),h({title:"Error",description:"Store owner information is missing.",variant:"destructive"});return}le(!0);try{const q=Me.map(Ve=>Ve.src.large||Ve.src.medium).filter(Ve=>Ve&&!Ve.includes("via.placeholder.com")&&!Ve.startsWith("data:")).slice(0,8),Ie=(await Qa(m,"createProductCheckoutSession")({productName:w.name,productDescription:w.description,productImage:At,amount:Tn*100,currency:mr.toLowerCase(),storeOwnerId:g.merchant_id})).data;if(Ie&&Ie.url)window.location.href=Ie.url;else throw new Error("Failed to create checkout session.")}catch(q){console.error("Error creating Stripe Payment Link or redirecting:",q),h({title:"Checkout Setup Failed",description:q.message||"Could not prepare for checkout.",variant:"destructive"})}finally{le(!1)}},_e=async()=>{if(k.trim()){B(!0);try{const q=await lo(k,5,"square");M(q)}catch(q){h({title:"Image search failed",description:q.message,variant:"destructive"})}B(!1)}},Be=async()=>{if(!k.trim()||!g||!w){h({title:"Missing context",description:"Store or product context is missing for image generation.",variant:"destructive"});return}B(!0);try{const q=`Product image for: ${k}, ${(w==null?void 0:w.type)||(g==null?void 0:g.type)||"item"}`,ie=await j0(q);if(!ie||!ie.url||!ie.url.startsWith("data:"))throw new Error("AI did not return a valid base64 image data URL.");const be=`gemini-${Date.now()}.png`,Ie=`products/${g.id}/${w.id}/images/${be}`,Ve=vh(wh,Ie),ot=await(await fetch(ie.url)).blob();await yh(Ve,ot);const lt=await xh(Ve),jt={id:Date.now().toString(),src:{medium:lt,large:lt},alt:ie.alt||k,photographer:"Gemini AI via Firebase Storage"};M(vn=>[jt,...vn.slice(0,4)]),h({title:"Image Generated & Stored",description:"Gemini AI generated an image, and it has been uploaded to storage."})}catch(q){console.error("Gemini image generation or storage upload failed:",q),h({title:"Gemini Process Failed",description:q.message,variant:"destructive"})}B(!1)},Te=q=>{const ie=q.target.files[0];if(ie&&g&&w){B(!0);const be=`uploaded-${Date.now()}-${ie.name}`,Ie=`products/${g.id}/${w.id}/images/${be}`,Ve=vh(wh,Ie);yh(Ve,ie).then(()=>xh(Ve)).then(Se=>{const ot={id:Dt(),src:{medium:Se,large:Se},alt:ie.name,photographer:"Uploaded by user via Firebase Storage"};M(lt=>[ot,...lt.slice(0,4)]),h({title:"Image Uploaded & Stored",description:`${ie.name} uploaded. Select it from the results to use.`})}).catch(Se=>{console.error("Error uploading image to Firebase Storage:",Se),h({title:"Storage Upload Failed",description:Se.message,variant:"destructive"})}).finally(()=>{B(!1)})}else ie&&(h({title:"Missing context",description:"Store or product context is missing for image upload.",variant:"destructive"}),B(!1))},Et=async q=>{if(!g||!w)return;const ie={id:`video-${w.id}-${Dt()}`,src:{medium:q,large:q},alt:`${w.name} video`,type:"video"},be=[...Me,ie];Ge(be);const Ie=be.filter(Se=>Se.type!=="video").map(Se=>Se.src.large||Se.src.medium),Ve=g.products.map(Se=>Se.id===n?{...Se,video_url:q,images:Ie}:Se);try{g&&g.id?(await o(g.id,{products:Ve}),ge(q),h({title:"Product Video Generated",description:"The video has been added to the product gallery."})):h({title:"Error",description:"Store ID not available for video update.",variant:"destructive"})}catch(Se){console.error("Failed to update store with product video:",Se),h({title:"Update Failed",description:"Could not save the product video.",variant:"destructive"})}},wt=async q=>{if(!g||!w)return;const ie=g.products.map(be=>be.id===n?{...be,model_3d_url:q,model_3d_thumbnail_url:q}:be);try{g&&g.id?(await o(g.id,{products:ie}),he(q),Pe(q),h({title:"3D Model Generated",description:"The 3D model has been added to the product."})):h({title:"Error",description:"Store ID not available for 3D model update.",variant:"destructive"})}catch(be){console.error("Failed to update store with 3D model:",be),h({title:"Update Failed",description:"Could not save the 3D model.",variant:"destructive"})}},xt=q=>{if(g&&g.id&&w&&q&&q.src&&(q.src.medium||q.src.large)){const ie=q.src.large||q.src.medium;if(ie.startsWith("https://firebasestorage.googleapis.com")||ie.startsWith("http://localhost:")||ie.startsWith("https://images.pexels.com")){const be={id:q.id||Dt(),src:{medium:ie,large:ie},alt:q.alt||w.name,photographer:q.photographer||"User"};if(i(g.id,n,be),!Me.find(Ve=>Ve.src.medium===ie||Ve.src.large===ie)){const Ve={...be,id:be.id||Dt()};Ge(Se=>{const ot=Se.filter(lt=>!lt.src.medium.includes("via.placeholder.com"));return[Ve,...ot.filter(lt=>lt.src.medium!==ie)]})}de(ie),h({title:"Image Selected",description:"Product image updated."})}else h({title:"Invalid Image URL",description:"Selected image does not have a valid storage or Pexels URL.",variant:"destructive"})}else h({title:"Error",description:"Cannot select image. Store, product, or image data missing.",variant:"destructive"});P(!1),M([])};if(l||!g||!w)return a.jsxs("div",{className:"min-h-screen flex items-center justify-center",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary"}),a.jsx("p",{className:"ml-4 text-muted-foreground",children:"Loading product details..."})]});const pt=Me.find(q=>q.src.large===ve||q.src.medium===ve),At=ve||((ue=(J=w.image)==null?void 0:J.src)==null?void 0:ue.large)||((Le=(we=w.image)==null?void 0:we.src)==null?void 0:Le.medium)||`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(w.name)}`,On=(pt==null?void 0:pt.alt)||((Ze=w.image)==null?void 0:Ze.alt)||w.name,Tn=((X=A==null?void 0:A.price)==null?void 0:X.amount)!==void 0?parseFloat(A.price.amount):w.price,mr=((ne=A==null?void 0:A.price)==null?void 0:ne.currencyCode)||w.currencyCode||"USD",mn=10,Ft=((me=g==null?void 0:g.theme)==null?void 0:me.primaryColor)||"#000000";let Xt=[];w&&(w.options&&Array.isArray(w.options)?Xt=w.options.map(q=>({...q,name:q.name,values:q.values})):w.variants&&Array.isArray(w.variants)&&w.variants.length>0&&w.variants[0].name&&w.variants[0].values&&(Xt=w.variants.map(q=>({...q,name:q.name,values:q.values}))));const or=async()=>{if(!w||!ve||Object.keys(T).length===0){h({title:"Cannot Visualize",description:"Product data, main image, or selected variants missing.",variant:"destructive"});return}Pt(!0),fn(null),xn(ve);try{const{base64ImageData:q,mimeType:ie}=await Oe(ve);let be=[];for(const ot in T)be.push(`${ot}: ${T[ot]}`);const Ie=be.join(", "),Ve=`Visualize the product "${w.name}" with the following attributes: ${Ie}. Apply these changes to the provided image.`,Se=await Wo(q,ie,Ve);if(Se&&Se.editedImageData&&Se.newMimeType&&typeof Se.newMimeType=="string"&&Se.newMimeType.includes("/")){const ot=`data:${Se.newMimeType};base64,${Se.editedImageData}`,lt={id:`visualized-${Dt()}`,src:{medium:ot,large:ot},alt:`${w.name} visualized with ${Ie}`,photographer:"Variant Visualization by Gemini AI"};Ge(jt=>[lt,...jt]),dn(lt.src.medium||lt.src.large),h({title:"Variant Visualized",description:"Comparison slider generated below."})}else{let ot="AI image generation failed: ";throw Se?Se.editedImageData?Se.newMimeType?ot+=`Invalid MIME type from AI ('${Se.newMimeType}').`:ot+="Missing MIME type from AI.":ot+="Missing image data from AI.":ot+="No result from AI.",new Error(ot)}}catch(q){console.error("Error visualizing variant:",q),fn(q.message),h({title:"Visualization Failed",description:q.message,variant:"destructive"})}Pt(!1)};return a.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[a.jsx(Eq,{store:g,isPublishedView:d,productName:w.name}),a.jsxs(It.main,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"container mx-auto px-4 py-8 md:py-12 flex-grow",children:[a.jsxs(O,{variant:"outline",onClick:()=>f(`/${e}`),className:"mb-6",children:[a.jsx(Go,{className:"mr-2 h-4 w-4"})," Back to Store"]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12",children:[a.jsxs(It.div,{initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},className:"flex flex-col items-center",children:[a.jsxs("div",{className:"relative group w-full",children:[ve&&Me.find(q=>(q.src.large===ve||q.src.medium===ve)&&q.type==="video")?a.jsx("video",{src:ve,controls:!0,autoPlay:!0,loop:!0,playsInline:!0,className:"w-full h-auto aspect-square object-cover rounded-xl shadow-lg border",children:"Your browser does not support the video tag."},ve):a.jsx("img",{src:At,alt:On,className:"w-full h-auto aspect-square object-cover rounded-xl shadow-lg border"},ve),!d&&a.jsxs(a.Fragment,{children:[a.jsxs(O,{variant:"secondary",onClick:()=>P(!0),className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(G3,{className:"mr-2 h-4 w-4"})," Change Image"]}),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>{Y(w),Q(!0)},className:"absolute top-16 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(Zv,{className:"mr-2 h-4 w-4"})," Edit Product"]}),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>fe(!0),className:"absolute top-28 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(E2,{className:"mr-2 h-4 w-4"})," Gen Video"]}),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>Ue(!0),className:"absolute top-40 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(kie,{className:"mr-2 h-4 w-4"})," Gen 3D"]})]})]}),Me.length>0&&a.jsxs(It.div,{className:"mt-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2,duration:.5},children:[a.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 gap-2",children:Me.map((q,ie)=>{var be,Ie;return a.jsxs(It.div,{className:"relative group",whileHover:{scale:1.05},children:[a.jsx("div",{className:`aspect-square rounded-md overflow-hidden cursor-pointer border-2 transition-all hover:opacity-80
                                    ${q.src.large===ve||q.src.medium===ve?"border-primary shadow-sm":"border-transparent"}`,onClick:()=>de(q.src.large||q.src.medium),children:q.type==="video"?a.jsxs("div",{className:"relative w-full h-full",children:[a.jsx("video",{src:q.src.medium||q.src.large,className:"w-full h-full object-cover",poster:((Ie=(be=w.image)==null?void 0:be.src)==null?void 0:Ie.medium)||`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(w.name)}`}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50",children:a.jsx(E2,{className:"h-8 w-8 text-white"})})]}):a.jsx("img",{src:q.src.medium||q.src.large,alt:q.alt||`Product image ${ie+1}`,className:"w-full h-full object-cover"})}),!d&&Me.length>1&&!q.src.medium.includes("via.placeholder.com")&&a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:Ve=>{Ve.stopPropagation(),Ne(q.id)},"aria-label":"Delete image",children:a.jsx(Wn,{className:"h-3 w-3"})})]},q.id||`gallery-${ie}`)})}),!d&&ve&&!ve.includes("via.placeholder.com")&&a.jsxs(O,{variant:"outline",size:"sm",className:"mt-3 w-full",onClick:Ae,disabled:te,children:[te?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Uie,{className:"mr-2 h-4 w-4"}),"Generate More Angles from Active Image"]})]})]}),a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"space-y-6",children:[a.jsx("h1",{className:"text-3xl lg:text-4xl font-bold tracking-tight text-foreground",children:w.name}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"flex items-center",children:[...Array(5)].map((q,ie)=>a.jsx(MI,{className:`h-5 w-5 ${ie<Math.floor(w.rating)?"text-amber-400 fill-amber-400":"text-muted-foreground/30"}`},ie))}),a.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",w.rating," reviews)"]}),a.jsx(Ui,{orientation:"vertical",className:"h-5"}),a.jsx(pg,{variant:"outline",style:{borderColor:g.theme.primaryColor,color:g.theme.primaryColor},children:"In Stock"})]}),a.jsxs("p",{className:"text-2xl lg:text-3xl font-semibold",style:{color:g.theme.primaryColor},children:[mr," ",Tn.toFixed(2)]}),Xt.length>0&&a.jsxs("div",{className:"space-y-4 pt-4",children:[Xt.map(q=>a.jsxs("div",{children:[a.jsxs(De,{className:"text-sm font-medium text-foreground",children:[q.name,":",a.jsx("span",{className:"text-muted-foreground font-normal ml-1",children:T[q.name]||""})]}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:q.values.map(ie=>a.jsx(O,{variant:T[q.name]===ie?"default":"outline",size:"sm",onClick:()=>{R(be=>({...be,[q.name]:ie}))},style:T[q.name]===ie?{backgroundColor:Ft,color:"white",borderColor:Ft}:{borderColor:g.theme.secondaryColor||"#cccccc",color:g.theme.secondaryColor||"#333333"},children:ie},ie))})]},q.name)),Xt.length>0&&Object.keys(T).length>0&&a.jsxs("div",{className:"mt-4 w-full",children:[an&&Lt&&a.jsx("div",{className:"mb-3 flex justify-center",children:a.jsx(Aq,{itemOne:a.jsx(v1,{src:Lt,alt:"Original Image"}),itemTwo:a.jsx(v1,{src:an,alt:"Visualized Variant"}),className:"w-full max-w-md h-auto aspect-square rounded-md border shadow-md"})}),a.jsxs(O,{onClick:or,disabled:yt,className:"w-full",variant:"outline",children:[yt?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Visualize Variant"]}),en&&a.jsx("p",{className:"text-red-500 text-xs mt-2",children:en})]})]}),a.jsx("div",{className:"prose prose-sm sm:prose dark:prose-invert max-w-none text-muted-foreground pt-4",children:a.jsx("p",{children:w.description})}),w.tags&&w.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:w.tags.map(q=>a.jsx(pg,{variant:"secondary",children:q},q))}),a.jsx(Ui,{className:"my-6"}),a.jsxs("div",{className:"flex items-end gap-4 pt-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(De,{htmlFor:"quantity",className:"text-sm",children:"Quantity"}),a.jsx(Ye,{id:"quantity",type:"number",value:_,onChange:He,min:"1",max:mn,className:"w-20 h-10 text-center",disabled:mn===0})]}),a.jsxs(O,{size:"lg",onClick:ce,className:"flex-1 h-10",style:{backgroundColor:Ft,color:"white"},disabled:mn===0,children:[a.jsx(Up,{className:"mr-2 h-5 w-5"}),ee?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,ee?"Processing...":"Proceed to Checkout"]})]})]})]}),ze&&a.jsxs(It.div,{className:"mt-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 text-foreground",children:"3D Model"}),a.jsx(RRe,{modelUrl:ze,thumbnailUrl:Ce,productName:w.name,height:"500px",className:"w-full"})]}),w&&g&&g.id&&a.jsx(It.div,{className:"mt-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.5},children:a.jsx(jRe,{product:w,storeId:g.id,isPublishedView:d})})]}),a.jsx(Tq,{store:g,isPublishedView:d}),!d&&a.jsxs(a.Fragment,{children:[a.jsx(Xr,{open:I,onOpenChange:P,children:a.jsxs(Ur,{className:"sm:max-w-2xl",children:[a.jsx(Br,{children:a.jsx(zr,{children:"Change Product Image"})}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{placeholder:"Search Pexels or describe for AI...",value:k,onChange:q=>j(q.target.value)}),a.jsxs(O,{onClick:_e,disabled:G||!k.trim(),children:[G&&D.length===0?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(Oie,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Pexels"})]}),a.jsxs(O,{onClick:Be,variant:"outline",disabled:G||!k.trim(),children:[G&&D.length>0?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(xa,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Gemini"})]}),a.jsxs(O,{variant:"outline",onClick:()=>{var q;return(q=document.getElementById("upload-image-input"))==null?void 0:q.click()},disabled:G,children:[a.jsx(Uo,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Upload"})]}),a.jsx(Ye,{type:"file",id:"upload-image-input",className:"hidden",accept:"image/*",onChange:Te})]}),G&&D.length===0&&a.jsx("p",{className:"text-center text-sm text-muted-foreground",children:"Searching for images or processing upload..."}),D.length>0&&a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-80 overflow-y-auto",children:D.map(q=>a.jsxs(It.div,{className:"relative aspect-square rounded-md overflow-hidden cursor-pointer group border-2 border-transparent hover:border-primary transition-all",onClick:()=>xt(q),whileHover:{scale:1.05},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},children:[a.jsx("img",{src:q.src.medium,alt:q.alt||"Search result",className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(URe,{className:"h-8 w-8 text-white"})}),a.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/70 text-white text-xs p-1 truncate",children:q.photographer||q.alt})]},q.id))})]}),a.jsx(Ar,{children:a.jsx(il,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",children:"Cancel"})})})]})}),H&&a.jsx(ProductEditModal,{isOpen:W,onClose:()=>Q(!1),product:H,onSave:async q=>{if(!g||!w)return;const ie=g.products.map(be=>be.id===q.id?{...be,...q}:be);await o(g.id,{products:ie}),v(q),h({title:"Product Updated",description:"Your product has been successfully updated."})},storeId:g.id}),w&&a.jsx(ARe,{open:Z,onOpenChange:fe,product:w,onVideoGenerated:Et}),w&&a.jsx(kRe,{open:Re,onOpenChange:Ue,product:w,onModelGenerated:wt,storeId:g==null?void 0:g.id})]})]})},URe=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),BRe=()=>{const{cart:t,currentStore:e}=zn(),{user:n}=eo(),[r,s]=p.useState(!1),[i,o]=p.useState(null),l=()=>t.reduce((u,d)=>u+d.price*d.quantity,0),c=async()=>{if(!n){o("You must be logged in to purchase.");return}s(!0),o(null);try{const u=t[0];if(!u)throw new Error("Your cart is empty.");const f=(await Qa(Lh,"createProductCheckoutSession")({productName:u.name,productDescription:u.description,productImage:u.imageUrl,amount:u.price*100,currency:"usd",storeOwnerId:e.merchantId})).data;if(f&&f.url)window.location.href=f.url;else throw new Error("Failed to create checkout session.")}catch(u){console.error("Checkout error:",u),o(u.message||"An unexpected error occurred."),s(!1)}};return a.jsxs(a.Fragment,{children:[a.jsx(HA,{}),a.jsxs("div",{className:"container mx-auto p-4",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Checkout"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold mb-2",children:"Order Summary"}),t.map(u=>a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:u.name}),a.jsxs("p",{children:["Quantity: ",u.quantity]})]}),a.jsxs("p",{children:["$",(u.price*u.quantity).toFixed(2)]})]},u.id)),a.jsx("hr",{className:"my-2"}),a.jsxs("div",{className:"flex justify-between font-bold",children:[a.jsx("p",{children:"Total"}),a.jsxs("p",{children:["$",l().toFixed(2)]})]})]}),a.jsxs("div",{children:[a.jsx("button",{onClick:c,disabled:r||t.length===0,className:"w-full bg-blue-500 text-white py-2 rounded disabled:bg-gray-400",children:r?"Processing...":"Purchase"}),i&&a.jsx("p",{className:"text-red-500 mt-2",children:i})]})]})]})]})},zRe="https://static.wixstatic.com/media/bd2e29_20f2a8a94b7e492a9d76e0b8b14e623b~mv2.png",GRe="https://static.wixstatic.com/media/bd2e29_c6677c7824044124b64fe765d0e9b88d~mv2.png";function WRe(){const[t,e]=p.useState(!0),[n,r]=p.useState(""),[s,i]=p.useState(!1),o=p.useRef(),l=p.useRef(),c=bi();p.useEffect(()=>{const h=localStorage.getItem("theme"),f=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;h==="dark"||!h&&f?(document.documentElement.classList.add("dark"),i(!0)):(document.documentElement.classList.remove("dark"),i(!1))},[]);const u=async h=>{r("");const f=o.current.value,m=l.current.value;if(!f||!m){r("Please enter both email and password.");return}try{let g;h==="login"?g=await Mge(gp,f,m):(g=await Dge(gp,f,m),await mp(Ps(Nn,"profiles",g.user.uid),{id:g.user.uid,email:g.user.email,role:"store_owner",created_at:new Date})),c("/")}catch(g){console.error("Authentication error (Email/Password):",g.message),r(g.message)}},d=async()=>{r("");const h=new Va;try{const m=(await iye(gp,h)).user,g=Ps(Nn,"profiles",m.uid);(await k0e(g)).exists()||await mp(g,{id:m.uid,email:m.email,displayName:m.displayName,photoURL:m.photoURL,role:"store_owner",created_at:new Date}),c("/")}catch(f){console.error("Google Sign-In error:",f.message),f.code==="auth/popup-closed-by-user"?r("Google Sign-In was cancelled. Please try again."):f.code==="auth/account-exists-with-different-credential"?r("An account already exists with the same email address but different sign-in credentials. Try signing in with your original method."):r(`Google Sign-In failed: ${f.message}`)}};return a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-cover bg-center bg-no-repeat p-4",style:{backgroundImage:`url(${GRe})`},children:a.jsxs("div",{className:`w-full max-w-md p-8 md:p-10 space-y-6
                   bg-white/10 dark:bg-black/30 backdrop-blur-lg
                   shadow-2xl rounded-xl border border-white/20 dark:border-black/20`,children:[a.jsx("div",{className:"flex justify-center mb-6",children:a.jsx("img",{src:zRe,alt:"FreshFront Logo",className:"h-12 w-auto"})}),a.jsx("h2",{className:"text-center text-3xl font-extrabold text-white mb-6",children:t?"Sign In":"Sign Up"}),n&&a.jsx("p",{className:"text-red-500 text-center",children:n}),a.jsxs("form",{onSubmit:h=>{h.preventDefault(),u(t?"login":"signup")},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-white mb-1",children:"Email"}),a.jsx("input",{type:"email",id:"email",ref:o,required:!0,className:"w-full p-3 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"you@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-white mb-1",children:"Password"}),a.jsx("input",{type:"password",id:"password",ref:l,required:!0,className:"w-full p-3 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"••••••••"})]}),a.jsx("button",{type:"submit",className:"w-full bg-black text-white py-3 rounded-md font-semibold hover:bg-gray-800 transition-colors",children:t?"Sign In":"Sign Up"})]}),a.jsxs("div",{className:"relative my-6",children:[a.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:a.jsx("div",{className:"w-full border-t border-white/30"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-2 bg-white/10 dark:bg-black/30 text-white rounded-md",children:"Or continue with"})})]}),a.jsx("div",{children:a.jsxs("button",{type:"button",onClick:d,className:"w-full flex items-center justify-center gap-2 bg-white/90 dark:bg-white/10 text-black dark:text-white py-3 rounded-md font-semibold hover:bg-white dark:hover:bg-white/20 transition-colors border border-white/20",children:[a.jsx("svg",{className:"w-5 h-5","aria-hidden":"true",focusable:"false",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 18",children:a.jsxs("g",{fill:"none","fill-rule":"evenodd",children:[a.jsx("path",{d:"M17.64 9.2045c0-.6381-.0573-1.2518-.1636-1.8409H9v3.4818h4.8436c-.2086 1.125-.8427 2.0782-1.7777 2.7218v2.2582h2.9082c1.7018-1.5668 2.6836-3.8741 2.6836-6.621Z",fill:"#4285F4"}),a.jsx("path",{d:"M9 18c2.43 0 4.4673-.8055 5.9564-2.1818l-2.9082-2.2582c-.8055.5436-1.8368.8618-2.9945.8618-2.3127 0-4.2609-1.5668-4.9582-3.6709H1.0718v2.3318C2.5564 16.1632 5.5218 18 9 18Z",fill:"#34A853"}),a.jsx("path",{d:"M4.0418 10.7318c-.1164-.3464-.18-.7173-.18-1.0909 0-.3736.0636-.7445.18-1.0909V6.2182H1.0718C.3859 7.5614 0 9.0182 0 10.6409s.3859 3.0795 1.0718 4.4227l2.97-2.3318Z",fill:"#FBBC05"}),a.jsx("path",{d:"M9 3.5818c1.3218 0 2.5077.4559 3.4405 1.3468l2.5818-2.5818C13.4632.9918 11.43 0 9 0 5.5218 0 2.5564 1.8368 1.0718 4.5727l2.97 2.3318C4.7391 4.9855 6.6873 3.5818 9 3.5818Z",fill:"#EA4335"})]})}),t?"Sign in with Google":"Sign up with Google"]})}),a.jsxs("p",{className:"text-center text-sm text-white pt-4",children:[t?"Don't have an account?":"Already have an account?"," ",a.jsx("button",{onClick:()=>e(!t),className:"text-white hover:underline font-medium",children:t?"Sign Up":"Sign In"})]})]})})}const HRe=()=>{const{isAuthenticated:t,user:e}=eo();return a.jsxs(a.Fragment,{children:[a.jsx(HA,{}),a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Our Plan"}),a.jsx("p",{children:"Get full access to all store creation and management features."}),a.jsxs("div",{style:{border:"1px solid #ccc",padding:"20px",margin:"20px auto",maxWidth:"400px",borderRadius:"8px"},children:[a.jsx("h2",{children:"Store Creator Plan"}),a.jsx("p",{style:{fontSize:"2em",fontWeight:"bold",margin:"10px 0"},children:"$24.99 / month"}),a.jsxs("ul",{children:[a.jsx("li",{children:"Full access to publishing"}),a.jsx("li",{children:"Accept payments for your store"}),a.jsx("li",{children:"Unlimited products"}),a.jsx("li",{children:"And more!"})]}),t?null:a.jsxs("p",{children:["Please ",a.jsx(sr,{to:"/auth",children:"log in or sign up"})," to subscribe."]})]})]})]})};function qRe(){return new URLSearchParams(xl().search)}const KRe=()=>{const e=qRe().get("session_id");p.useState(null);const[n,r]=p.useState(!0),[s,i]=p.useState(null);return p.useEffect(()=>{if(!e){i("No session ID found. Your order might still be processing."),r(!1);return}r(!1)},[e]),n?a.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"Loading order details..."}):s?a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Order Status"}),a.jsx("p",{style:{color:"red"},children:s}),a.jsx(sr,{to:"/",children:"Go to Homepage"})]}):a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Thank You for Your Order!"}),a.jsx("p",{children:"Your payment was successful and your order is being processed."}),a.jsxs("p",{children:["Order (Session ID): ",e]}),a.jsx("p",{children:"You will receive an email confirmation shortly."}),a.jsx(sr,{to:"/",children:"Continue Shopping"})]})},YRe=()=>{const{isGenerating:t,progress:e,statusMessage:n}=zn();return a.jsx(Sc,{children:t&&a.jsx(It.div,{initial:{y:"-100%",opacity:0},animate:{y:"20px",opacity:1},exit:{y:"-100%",opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"fixed top-0 left-0 right-0 flex justify-center z-[9999] p-4",children:a.jsxs(Je,{className:"shadow-2xl rounded-xl overflow-hidden w-full max-w-md",children:[" ",a.jsxs(it,{className:"p-6 space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Store Generation"}),a.jsxs("p",{className:"text-sm font-semibold text-blue-600 dark:text-blue-400",children:[Math.floor(e),"%"]})]}),a.jsx($a,{value:e,className:"w-full h-2 [&>div]:bg-blue-600"}),a.jsx("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 pt-1 min-h-[1.2em]",children:n||"Processing..."})]})]})})})},JRe=()=>a.jsxs(yEe,{children:[a.jsx(YRe,{})," ",a.jsxs("main",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-900 dark:to-slate-900",children:[a.jsx(wX,{})," ",a.jsx(poe,{}),a.jsx(bq,{})," ",a.jsx(QX,{})]})]});const XRe=({children:t,activeTab:e,setActiveTab:n,storeId:r,storeName:s})=>{const[i,o]=p.useState(""),[l,c]=p.useState([]),u=[{id:"orders",label:"Orders",icon:a.jsx(Up,{className:"h-5 w-5"})},{id:"products",label:"Products",icon:a.jsx(Oi,{className:"h-5 w-5"})},{id:"customers",label:"Customers",icon:a.jsx(L0,{className:"h-5 w-5"})},{id:"payments",label:"Payments",icon:a.jsx(Do,{className:"h-5 w-5"})},{id:"analytics",label:"Analytics",icon:a.jsx(Xv,{className:"h-5 w-5"})},{id:"marketing",label:"Marketing",icon:a.jsx(dh,{className:"h-5 w-5"})},{id:"shipping",label:"Shipping",icon:a.jsx(nw,{className:"h-5 w-5"})},{id:"settings",label:"Settings",icon:a.jsx(Nh,{className:"h-5 w-5"})}],d=u.map(m=>({id:m.id,label:m.label,tab:m.id})),h=m=>{const g=m.target.value;if(o(g),g.trim()===""){c([]);return}const x=g.toLowerCase(),w=[];d.forEach(v=>{v.label.toLowerCase().includes(x)&&w.push({id:`${v.id}-main`,label:v.label,tab:v.tab}),v.subItems&&v.subItems.forEach(_=>{_.label.toLowerCase().includes(x)&&w.push({id:_.id,label:`${v.label} > ${_.label}`,tab:v.tab})})}),c(w)},f=m=>{n(m.tab),o(""),c([])};return a.jsxs("div",{className:"flex h-screen bg-muted/40",children:[" ",a.jsxs("div",{className:"w-64 bg-card border-r border-border flex flex-col",children:[" ",a.jsxs("div",{className:"p-4 border-b flex items-center gap-2",children:[" ",s&&a.jsx(O,{asChild:!0,variant:"outline",size:"icon",className:"flex-shrink-0",children:a.jsxs(sr,{to:`/${s}`,children:[" ",a.jsx(Go,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Back to Store"})]})}),a.jsxs("div",{className:"relative flex-grow",children:[" ",a.jsx(ic,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),a.jsx(Ye,{type:"text",placeholder:"Search dashboard...",className:"pl-9 w-full",value:i,onChange:h}),l.length>0&&a.jsxs(Je,{className:"absolute mt-1 w-full z-50 max-h-64 overflow-y-auto shadow-lg",children:[" ",a.jsxs("div",{className:"p-1",children:[" ",l.map(m=>a.jsx("button",{className:"w-full text-left px-3 py-1.5 hover:bg-accent rounded-md text-sm",onClick:()=>f(m),children:m.label},m.id))]})]})]})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:[" ",u.map(m=>a.jsxs(O,{variant:e===m.id?"secondary":"ghost",className:"w-full justify-start text-left h-10 px-3",onClick:()=>n(m.id),children:[a.jsx("span",{className:"mr-3",children:m.icon})," ",m.label]},m.id))]}),a.jsx("div",{className:"p-4 border-t",children:a.jsx(O,{variant:"ghost",className:"w-full justify-start text-left",children:"Help & Support"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[" ",t]})]})},iO=()=>{const[t,e]=p.useState("all"),n=[{id:"ORD-1234",customer:"John Doe",date:"2023-05-15",total:"$129.99",status:"Fulfilled"},{id:"ORD-1235",customer:"Jane Smith",date:"2023-05-14",total:"$89.50",status:"Processing"},{id:"ORD-1236",customer:"Robert Johnson",date:"2023-05-13",total:"$210.75",status:"Pending"}],r=[{id:"CART-567",customer:"Emily Davis",date:"2023-05-15",items:3,total:"$78.45",timeSpent:"12m 30s"},{id:"CART-568",customer:"Michael Brown",date:"2023-05-14",items:2,total:"$45.99",timeSpent:"5m 15s"}],s=[{id:"RET-890",orderId:"ORD-1230",customer:"Sarah Wilson",date:"2023-05-10",amount:"$65.00",reason:"Wrong size"},{id:"RET-891",orderId:"ORD-1228",customer:"David Miller",date:"2023-05-09",amount:"$120.50",reason:"Damaged item"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Orders"}),a.jsxs(Si,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-4 mb-6",children:[a.jsxs(Ot,{value:"all",children:[a.jsx(Up,{className:"mr-2 h-4 w-4"}),"All Orders"]}),a.jsxs(Ot,{value:"abandoned",children:[a.jsx(Tg,{className:"mr-2 h-4 w-4"}),"Abandoned Checkouts"]}),a.jsxs(Ot,{value:"returns",children:[a.jsx(AE,{className:"mr-2 h-4 w-4"}),"Returns & Refunds"]}),a.jsxs(Ot,{value:"fulfillment",children:[a.jsx(Oi,{className:"mr-2 h-4 w-4"}),"Order Fulfillment"]})]}),a.jsx(Vt,{value:"all",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"All Orders"}),a.jsx(Qt,{children:"View and manage all customer orders"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="Fulfilled"?"bg-green-100 text-green-800":i.status==="Processing"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:i.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View"})})]},i.id))})]})})})]})}),a.jsx(Vt,{value:"abandoned",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Abandoned Checkouts"}),a.jsx(Qt,{children:"View details of abandoned shopping carts"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Cart ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Items"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Time Spent"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.items}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:i.timeSpent}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View Details"})})]},i.id))})]})})})]})}),a.jsx(Vt,{value:"returns",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Returns & Refunds"}),a.jsx(Qt,{children:"Manage customer returns and process refunds"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Return ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.orderId}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.amount}),a.jsx("td",{className:"py-3 px-4",children:i.reason}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(O,{variant:"outline",size:"sm",children:"Process"})]})]},i.id))})]})})})]})}),a.jsx(Vt,{value:"fulfillment",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Order Fulfillment"}),a.jsx(Qt,{children:"Manage and fulfill pending orders"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Fraud Risk"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer Score"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="Fulfilled"?"bg-green-100 text-green-800":i.status==="Processing"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:i.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Low"})}),a.jsxs("td",{className:"py-3 px-4",children:[Math.floor(Math.random()*100),"/100"]}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(O,{variant:"default",size:"sm",disabled:i.status==="Fulfilled",children:"Fulfill"})]})]},i.id))})]})})})]})})]})]})},QRe=()=>{const[t,e]=p.useState("all"),n=[{id:"PRD-1234",name:"Premium T-Shirt",category:"Apparel",price:"$29.99",inventory:45,status:"Active"},{id:"PRD-1235",name:"Wireless Headphones",category:"Electronics",price:"$89.50",inventory:12,status:"Active"},{id:"PRD-1236",name:"Leather Wallet",category:"Accessories",price:"$49.99",inventory:0,status:"Out of Stock"}],r=[{id:"COL-567",name:"Summer Collection",products:12,type:"Manual",status:"Active"},{id:"COL-568",name:"Holiday Specials",products:8,type:"AI Generated",status:"Draft"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Products"}),a.jsxs(Si,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-3 mb-6",children:[a.jsxs(Ot,{value:"all",children:[a.jsx(Oi,{className:"mr-2 h-4 w-4"}),"All Products"]}),a.jsxs(Ot,{value:"inventory",children:[a.jsx(qm,{className:"mr-2 h-4 w-4"}),"Inventory"]}),a.jsxs(Ot,{value:"collections",children:[a.jsx(Y_,{className:"mr-2 h-4 w-4"}),"Collections"]})]}),a.jsx(Vt,{value:"all",children:a.jsxs(Je,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"All Products"}),a.jsx(Qt,{children:"Manage your product catalog"})]}),a.jsxs(O,{children:[a.jsx(Oi,{className:"mr-2 h-4 w-4"}),"Add Product"]})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"mb-4 flex items-center",children:[a.jsx(Ye,{placeholder:"Search products...",className:"max-w-sm mr-2"}),a.jsx(O,{variant:"outline",children:"Search"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Category"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Price"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Inventory"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.category}),a.jsx("td",{className:"py-3 px-4",children:s.price}),a.jsx("td",{className:"py-3 px-4",children:s.inventory}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(O,{variant:"outline",size:"sm",children:"Delete"})]})]},s.id))})]})})]})]})}),a.jsx(Vt,{value:"inventory",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Inventory Management"}),a.jsx(Qt,{children:"Track and update product inventory levels"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Current Stock"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Low Stock Alert"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.inventory}),a.jsx("td",{className:"py-3 px-4",children:"10"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.inventory>10?"bg-green-100 text-green-800":s.inventory>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.inventory>10?"In Stock":s.inventory>0?"Low Stock":"Out of Stock"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Update Stock"})})]},s.id))})]})})})]})}),a.jsx(Vt,{value:"collections",children:a.jsxs(Je,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Collections"}),a.jsx(Qt,{children:"Organize products into collections"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(Y_,{className:"mr-2 h-4 w-4"}),"Create Manual Collection"]}),a.jsxs(O,{children:[a.jsx(Y_,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Collection Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Products"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.products}),a.jsx("td",{className:"py-3 px-4",children:s.type}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(O,{variant:"outline",size:"sm",children:"Delete"})]})]},s.id))})]})})})]})})]})]})},ZRe=()=>{const t=[{id:"CUS-1234",name:"John Doe",email:"john.doe@example.com",orders:5,totalSpent:"$345.75",lastOrder:"2023-05-10",segment:"Loyal"},{id:"CUS-1235",name:"Jane Smith",email:"jane.smith@example.com",orders:2,totalSpent:"$129.50",lastOrder:"2023-04-22",segment:"New"},{id:"CUS-1236",name:"Robert Johnson",email:"robert.j@example.com",orders:8,totalSpent:"$780.25",lastOrder:"2023-05-15",segment:"VIP"}],e=[{id:"SEG-1",name:"New Customers",count:124,description:"Customers with 1-2 orders"},{id:"SEG-2",name:"Loyal Customers",count:86,description:"Customers with 3-7 orders"},{id:"SEG-3",name:"VIP Customers",count:32,description:"Customers with 8+ orders"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Customers"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:e.map(n=>a.jsxs(Je,{children:[a.jsxs(ct,{className:"pb-2",children:[a.jsx(ut,{className:"text-lg",children:n.name}),a.jsx(Qt,{children:n.description})]}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:n.count}),a.jsx(O,{variant:"link",className:"p-0",children:"View customers"})]})]},n.id))}),a.jsxs(Je,{className:"mb-6",children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Customer Insights"}),a.jsx(Qt,{children:"AI-generated insights about your customer base"})]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Zie,{className:"mr-2 h-4 w-4"}),"Generate New Insights"]})]}),a.jsx(it,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Demographics"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-card rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Demographics chart placeholder"})}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Your customer base is primarily 25-34 years old (45%), followed by 35-44 years old (30%). The gender distribution is 55% female and 45% male."})]}),a.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Geographic Distribution"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-card rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Geographic map placeholder"})}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Most of your customers are from California (25%), New York (18%), and Texas (12%). International customers make up 15% of your customer base."})]})]})})]}),a.jsxs(Je,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"All Customers"}),a.jsx(Qt,{children:"View and manage your customer database"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(qm,{className:"mr-2 h-4 w-4"}),"Add Tags"]}),a.jsxs(O,{children:[a.jsx(L0,{className:"mr-2 h-4 w-4"}),"Create Segment"]})]})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"mb-4 flex items-center",children:[a.jsx(Ye,{placeholder:"Search customers...",className:"max-w-sm mr-2"}),a.jsx(O,{variant:"outline",children:"Search"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Email"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Orders"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total Spent"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Last Order"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Segment"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:t.map(n=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:n.id}),a.jsx("td",{className:"py-3 px-4",children:n.name}),a.jsx("td",{className:"py-3 px-4",children:n.email}),a.jsx("td",{className:"py-3 px-4",children:n.orders}),a.jsx("td",{className:"py-3 px-4",children:n.totalSpent}),a.jsx("td",{className:"py-3 px-4",children:n.lastOrder}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${n.segment==="VIP"?"bg-purple-100 text-purple-800":n.segment==="Loyal"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:n.segment})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View Profile"})})]},n.id))})]})})]})]})]})},eje=()=>{const[t,e]=p.useState("transactions"),{session:n,user:r}=eo(),[s,i]=p.useState(!1),[o,l]=p.useState(null),c=async()=>{if(!(n!=null&&n.access_token)||!r){l("Authentication token not found. Please log in again.");return}i(!0),l(null);try{const f=await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/create-stripe-connect-account",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n.access_token}`},body:JSON.stringify({record:{id:r.id,email:r.email}})}),m=await f.json();if(!f.ok){const g=m.error||m.data&&m.data.error||"Failed to create Stripe Connect account link.";throw new Error(g)}if(m.account_link_url)window.location.href=m.account_link_url;else if(m.url)window.location.href=m.url;else throw new Error("No URL returned from Stripe Connect account creation.")}catch(f){console.error("Stripe Connect account creation error:",f),l(f.message)}finally{i(!1)}},u=[{id:"TRX-1234",orderId:"ORD-1234",customer:"John Doe",date:"2023-05-15",amount:"$129.99",status:"Completed",method:"Credit Card"},{id:"TRX-1235",orderId:"ORD-1235",customer:"Jane Smith",date:"2023-05-14",amount:"$89.50",status:"Completed",method:"PayPal"},{id:"TRX-1236",orderId:"ORD-1236",customer:"Robert Johnson",date:"2023-05-13",amount:"$210.75",status:"Pending",method:"Credit Card"}],d=[{id:"PAY-567",date:"2023-05-15",amount:"$1,245.75",status:"Completed",destination:"Bank Account (****1234)"},{id:"PAY-568",date:"2023-05-01",amount:"$980.50",status:"Completed",destination:"Bank Account (****1234)"},{id:"PAY-569",scheduledDate:"2023-06-01",estimatedAmount:"$1,500.00",status:"Scheduled",destination:"Bank Account (****1234)"}],h=[{id:"DSP-890",transactionId:"TRX-1230",customer:"Sarah Wilson",date:"2023-05-10",amount:"$65.00",reason:"Item not received",status:"Under Review"},{id:"DSP-891",transactionId:"TRX-1228",customer:"David Miller",date:"2023-05-09",amount:"$120.50",reason:"Unauthorized charge",status:"Lost"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Payments & Payouts"}),a.jsxs(Si,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-4 mb-6",children:[" ",a.jsxs(Ot,{value:"overview",children:[" ",a.jsx(Jh,{className:"mr-2 h-4 w-4"}),"Connect Account"]}),a.jsxs(Ot,{value:"transactions",children:[a.jsx(Do,{className:"mr-2 h-4 w-4"}),"Transactions"]}),a.jsxs(Ot,{value:"payouts",children:[a.jsx(kI,{className:"mr-2 h-4 w-4"}),"Payout Schedule"]}),a.jsxs(Ot,{value:"disputes",children:[a.jsx(Tg,{className:"mr-2 h-4 w-4"}),"Disputes & Chargebacks"]})]}),a.jsxs(Vt,{value:"overview",children:[" ",a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Connect Stripe Account"}),a.jsx(Qt,{children:"Connect your Stripe account to start accepting payments and manage payouts."})]}),a.jsxs(it,{children:[a.jsxs(O,{onClick:c,disabled:s,children:[a.jsx(Jh,{className:"mr-2 h-4 w-4"}),s?"Connecting...":"Connect with Stripe"]}),o&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:o})]})]})]}),a.jsx(Vt,{value:"transactions",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"All Transactions"}),a.jsx(Qt,{children:"View all payment transactions"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Transaction ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Method"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:u.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.orderId}),a.jsx("td",{className:"py-3 px-4",children:f.customer}),a.jsx("td",{className:"py-3 px-4",children:f.date}),a.jsx("td",{className:"py-3 px-4",children:f.amount}),a.jsx("td",{className:"py-3 px-4",children:f.method}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View Details"})})]},f.id))})]})})})]})}),a.jsx(Vt,{value:"payouts",children:a.jsxs(Je,{className:"mb-6",children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Payout Schedule"}),a.jsx(Qt,{children:"Manage your payout schedule and instant transfers"})]}),a.jsxs(O,{children:[a.jsx(Do,{className:"mr-2 h-4 w-4"}),"Instant Transfer"]})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Current Balance"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$1,845.75"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Available for payout"})]})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Next Payout"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$1,500.00"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Scheduled for June 1, 2023"})]})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Payout Schedule"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-xl font-medium",children:"Monthly"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Every 1st of the month"}),a.jsx(O,{variant:"link",className:"p-0 mt-2",children:"Change schedule"})]})]})]}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Payout History"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Payout ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Destination"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:d.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.date||f.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:f.amount||f.estimatedAmount}),a.jsx("td",{className:"py-3 px-4",children:f.destination}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Completed"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View Details"})})]},f.id))})]})]})]})]})}),a.jsx(Vt,{value:"disputes",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Disputes & Chargebacks"}),a.jsx(Qt,{children:"Manage payment disputes and chargebacks"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Dispute ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Transaction ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"AI Analysis"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:h.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.transactionId}),a.jsx("td",{className:"py-3 px-4",children:f.customer}),a.jsx("td",{className:"py-3 px-4",children:f.date}),a.jsx("td",{className:"py-3 px-4",children:f.amount}),a.jsx("td",{className:"py-3 px-4",children:f.reason}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Under Review"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:f.status==="Under Review"?a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"High chance of winning"}):a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"Insufficient evidence"})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),f.status==="Under Review"&&a.jsx(O,{variant:"default",size:"sm",children:"Respond"})]})]},f.id))})]})})})]})})]})]})},tje=()=>{const[t,e]=p.useState("sales");return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Analytics & Reports"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Total Sales"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$12,845.75"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(tm,{className:"h-4 w-4 mr-1"})," +15% from last month"]})]})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Orders"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"156"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(tm,{className:"h-4 w-4 mr-1"})," +8% from last month"]})]})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Conversion Rate"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"3.2%"}),a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(tm,{className:"h-4 w-4 mr-1"})," -0.5% from last month"]})]})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Avg. Order Value"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$82.34"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(tm,{className:"h-4 w-4 mr-1"})," +5% from last month"]})]})]})]}),a.jsxs(Si,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(Ot,{value:"sales",children:[a.jsx(Xv,{className:"mr-2 h-4 w-4"}),"Sales Reports"]}),a.jsxs(Ot,{value:"traffic",children:[a.jsx(tm,{className:"mr-2 h-4 w-4"}),"Traffic & Conversion"]}),a.jsxs(Ot,{value:"customers",children:[a.jsx(L0,{className:"mr-2 h-4 w-4"}),"Customer Insights"]}),a.jsxs(Ot,{value:"marketing",children:[a.jsx(W3,{className:"mr-2 h-4 w-4"}),"Marketing Attribution"]}),a.jsxs(Ot,{value:"products",children:[a.jsx(Oi,{className:"mr-2 h-4 w-4"}),"Product Performance"]})]}),a.jsx(Vt,{value:"sales",children:a.jsxs(Je,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Sales Overview"}),a.jsx(Qt,{children:"Comprehensive sales data with AI summarization"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(O,{variant:"outline",children:"Export"}),a.jsx(O,{variant:"outline",children:"Print"})]})]}),a.jsxs(it,{children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"h-80 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Sales chart placeholder"})})}),a.jsxs(Je,{className:"bg-muted/30",children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"AI Sales Summary"})}),a.jsxs(it,{children:[a.jsxs("p",{className:"text-sm",children:[a.jsx("strong",{children:"Key Insights:"}),' Your sales have increased by 15% compared to last month, with the highest growth in the "Electronics" category (+24%). Weekend sales are particularly strong, accounting for 45% of your weekly revenue. The average order value has increased by 5%, indicating customers are purchasing higher-value items.']}),a.jsxs("p",{className:"text-sm mt-2",children:[a.jsx("strong",{children:"Recommendations:"}),' Consider running promotions on weekdays to boost sales during slower periods. The "Apparel" category has seen a slight decline (-3%) and may benefit from new product additions or targeted marketing.']})]})]})]})]})}),a.jsx(Vt,{value:"traffic",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Traffic & Conversion Analysis"}),a.jsx(Qt,{children:"Website traffic sources and conversion rates"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Traffic Sources"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Traffic sources chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Conversion Funnel"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Conversion funnel chart placeholder"})})]})]}),a.jsxs(Je,{className:"bg-muted/30",children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"AI Conversion Recommendations"})}),a.jsxs(it,{children:[a.jsx("p",{className:"text-sm",children:"Your current conversion rate of 3.2% is below the industry average of 4.5% for e-commerce stores in your category. The biggest drop-off occurs at the checkout page (45% abandonment rate)."}),a.jsx("p",{className:"text-sm mt-2",children:a.jsx("strong",{children:"Recommendations:"})}),a.jsxs("ul",{className:"text-sm list-disc pl-5 mt-1",children:[a.jsx("li",{children:"Simplify your checkout process by reducing the number of form fields"}),a.jsx("li",{children:"Add trust badges and security indicators near payment information"}),a.jsx("li",{children:"Implement exit-intent popups with discount offers to reduce cart abandonment"}),a.jsx("li",{children:"Optimize product page load times (currently averaging 3.2s, aim for under 2s)"})]})]})]})]})]})}),a.jsx(Vt,{value:"customers",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Customer Insights"}),a.jsx(Qt,{children:"Detailed analysis of customer behavior and demographics"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Customer Demographics"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Demographics chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Purchase Frequency"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Purchase frequency chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Customer Lifetime Value"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"CLV chart placeholder"})})]})]}),a.jsxs(Je,{className:"bg-muted/30",children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Customer Personas"})}),a.jsx(it,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Tech-Savvy Millennials"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"25-34 years old, urban areas, high income"}),a.jsx("p",{className:"text-sm mt-2",children:"Prefer electronics and premium products, shop primarily on mobile devices"})]}),a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Budget-Conscious Families"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"35-44 years old, suburban areas, middle income"}),a.jsx("p",{className:"text-sm mt-2",children:"Focus on value, frequently use discount codes, buy in bulk"})]}),a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Luxury Shoppers"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"45-60 years old, various locations, high income"}),a.jsx("p",{className:"text-sm mt-2",children:"Purchase high-end products, less price sensitive, value quality and service"})]})]})})]})]})]})}),a.jsx(Vt,{value:"marketing",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Marketing Attribution"}),a.jsx(Qt,{children:"Track the effectiveness of your marketing channels"})]}),a.jsxs(it,{children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"h-80 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Marketing attribution chart placeholder"})})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Channel"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Sessions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conversions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conv. Rate"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"ROAS"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Organic Search"}),a.jsx("td",{className:"py-3 px-4",children:"2,456"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:"4.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$7,845.00"}),a.jsx("td",{className:"py-3 px-4",children:"N/A"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Paid Search"}),a.jsx("td",{className:"py-3 px-4",children:"1,245"}),a.jsx("td",{className:"py-3 px-4",children:"62"}),a.jsx("td",{className:"py-3 px-4",children:"5.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$4,980.00"}),a.jsx("td",{className:"py-3 px-4",children:"3.2x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Social Media"}),a.jsx("td",{className:"py-3 px-4",children:"3,120"}),a.jsx("td",{className:"py-3 px-4",children:"78"}),a.jsx("td",{className:"py-3 px-4",children:"2.5%"}),a.jsx("td",{className:"py-3 px-4",children:"$5,460.00"}),a.jsx("td",{className:"py-3 px-4",children:"2.8x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Email Marketing"}),a.jsx("td",{className:"py-3 px-4",children:"980"}),a.jsx("td",{className:"py-3 px-4",children:"49"}),a.jsx("td",{className:"py-3 px-4",children:"5.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$3,920.00"}),a.jsx("td",{className:"py-3 px-4",children:"4.5x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Direct"}),a.jsx("td",{className:"py-3 px-4",children:"1,560"}),a.jsx("td",{className:"py-3 px-4",children:"47"}),a.jsx("td",{className:"py-3 px-4",children:"3.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$3,760.00"}),a.jsx("td",{className:"py-3 px-4",children:"N/A"})]})]})]})})]})]})}),a.jsx(Vt,{value:"products",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Product Performance"}),a.jsx(Qt,{children:"Detailed analysis of product sales and performance"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Top Selling Products"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Top products chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Product Category Performance"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Category performance chart placeholder"})})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Category"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Units Sold"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Profit Margin"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Return Rate"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Rating"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Premium T-Shirt"}),a.jsx("td",{className:"py-3 px-4",children:"Apparel"}),a.jsx("td",{className:"py-3 px-4",children:"245"}),a.jsx("td",{className:"py-3 px-4",children:"$7,345.55"}),a.jsx("td",{className:"py-3 px-4",children:"45%"}),a.jsx("td",{className:"py-3 px-4",children:"2.1%"}),a.jsx("td",{className:"py-3 px-4",children:"4.8/5"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Wireless Headphones"}),a.jsx("td",{className:"py-3 px-4",children:"Electronics"}),a.jsx("td",{className:"py-3 px-4",children:"124"}),a.jsx("td",{className:"py-3 px-4",children:"$11,098.00"}),a.jsx("td",{className:"py-3 px-4",children:"32%"}),a.jsx("td",{className:"py-3 px-4",children:"3.5%"}),a.jsx("td",{className:"py-3 px-4",children:"4.6/5"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Leather Wallet"}),a.jsx("td",{className:"py-3 px-4",children:"Accessories"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:"$4,899.02"}),a.jsx("td",{className:"py-3 px-4",children:"55%"}),a.jsx("td",{className:"py-3 px-4",children:"1.2%"}),a.jsx("td",{className:"py-3 px-4",children:"4.9/5"})]})]})]})})]})]})})]})]})},nje=()=>{const[t,e]=p.useState("email"),n=[{id:"EM-1234",name:"Summer Sale Announcement",status:"Sent",sentDate:"2023-05-15",opens:1245,clicks:356,conversions:28,revenue:"$2,450"},{id:"EM-1235",name:"New Product Launch",status:"Draft",lastEdited:"2023-05-14"},{id:"EM-1236",name:"Customer Feedback Request",status:"Scheduled",scheduledDate:"2023-05-20"},{id:"EM-1237",name:"Abandoned Cart Recovery",status:"Sent",sentDate:"2023-05-12",opens:876,clicks:234,conversions:15,revenue:"$1,280"}],r=[{id:"SM-567",platform:"Instagram",content:"Summer collection now available!",status:"Published",publishDate:"2023-05-15",engagement:245,likes:189,comments:32},{id:"SM-568",platform:"Facebook",content:"Limited time offer: 20% off all accessories",status:"Scheduled",scheduledDate:"2023-05-18"},{id:"SM-569",platform:"Twitter",content:"Flash sale today only! Use code FLASH25",status:"Published",publishDate:"2023-05-14",engagement:178,likes:45,comments:12},{id:"SM-570",platform:"TikTok",content:"Behind the scenes of our latest photoshoot",status:"Draft",lastEdited:"2023-05-16"}],s=[{id:"BLG-890",title:"10 Summer Fashion Trends",status:"Published",publishDate:"2023-05-10",views:1245,comments:23,shares:56},{id:"BLG-891",title:"How to Choose the Perfect Headphones",status:"Draft",lastEdited:"2023-05-14"},{id:"BLG-892",title:"Sustainable Fashion: Our Commitment",status:"Published",publishDate:"2023-05-05",views:980,comments:18,shares:42},{id:"BLG-893",title:"Gift Guide: Father's Day Edition",status:"Scheduled",scheduledDate:"2023-05-25"}],i=[{id:"PROMO-123",name:"Summer Sale",type:"Discount",value:"20% off",status:"Active",startDate:"2023-05-01",endDate:"2023-05-31",usageCount:245},{id:"PROMO-124",name:"Free Shipping",type:"Free Shipping",value:"Orders over $50",status:"Active",startDate:"2023-05-01",endDate:"2023-06-30",usageCount:189},{id:"PROMO-125",name:"WELCOME10",type:"Discount",value:"10% off first order",status:"Active",startDate:"2023-01-01",endDate:"2023-12-31",usageCount:567},{id:"PROMO-126",name:"Holiday Bundle",type:"Bundle",value:"Buy 2 Get 1 Free",status:"Draft",startDate:"2023-11-15",endDate:"2023-12-25"}];return a.jsxs("div",{className:"bg-background",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Marketing"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(O,{variant:"outline",size:"sm",children:[a.jsx(kI,{className:"h-4 w-4 mr-2"}),"Content Calendar"]}),a.jsxs(O,{size:"sm",children:[a.jsx(Vi,{className:"h-4 w-4 mr-2"}),"Create Campaign"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Email Performance"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"24.5%"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Average open rate"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+2.3% from last month"})]})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Social Engagement"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"1,245"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Total interactions"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+15% from last month"})]})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Blog Traffic"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"3,890"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Monthly page views"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+8% from last month"})]})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Promo Conversions"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"12.8%"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Conversion rate"}),a.jsx("p",{className:"text-sm text-red-600 mt-2",children:"-1.2% from last month"})]})]})]}),a.jsxs(Si,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(Ot,{value:"email",children:[a.jsx(dh,{className:"mr-2 h-4 w-4"}),"Email Campaigns"]}),a.jsxs(Ot,{value:"social",children:[a.jsx(Gx,{className:"mr-2 h-4 w-4"}),"Social Media"]}),a.jsxs(Ot,{value:"seo",children:[a.jsx(ic,{className:"mr-2 h-4 w-4"}),"SEO Tools"]}),a.jsxs(Ot,{value:"blog",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Blog"]}),a.jsxs(Ot,{value:"promotions",children:[a.jsx(qm,{className:"mr-2 h-4 w-4"}),"Promotions"]})]}),a.jsx(Vt,{value:"email",children:a.jsxs(Je,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Email Campaigns"}),a.jsx(Qt,{children:"Create and manage email marketing campaigns"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(dh,{className:"mr-2 h-4 w-4"}),"Import Template"]}),a.jsxs(O,{children:[a.jsx(dh,{className:"mr-2 h-4 w-4"}),"Create Campaign"]})]})]}),a.jsxs(it,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Campaign Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Opens"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Clicks"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conversions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Sent"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.sentDate||o.lastEdited||o.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:o.opens||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.clicks||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.conversions||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.revenue||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),o.status!=="Sent"&&a.jsx(O,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Email Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate professional marketing emails with AI, including copy and layout suggestions."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(dh,{className:"mr-2 h-4 w-4"}),"Generate New Email"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Xv,{className:"mr-2 h-4 w-4"}),"A/B Test Generator"]})]})]})]})]})}),a.jsx(Vt,{value:"social",children:a.jsxs(Je,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Social Media Campaigns"}),a.jsx(Qt,{children:"Create and schedule social media content"})]}),a.jsxs(O,{children:[a.jsx(Gx,{className:"mr-2 h-4 w-4"}),"Create Post"]})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Content Calendar"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Content calendar placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Platform Performance"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Performance chart placeholder"})})]})]}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Recent Posts"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Platform"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Content"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Engagement"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Likes"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Comments"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.platform}),a.jsx("td",{className:"py-3 px-4",children:o.content}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Published"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.publishDate||o.scheduledDate||o.lastEdited}),a.jsx("td",{className:"py-3 px-4",children:o.engagement||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.likes||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.comments||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),o.status!=="Published"&&a.jsx(O,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Content Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Transform product images into engaging social media content with AI."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(Gx,{className:"mr-2 h-4 w-4"}),"Generate Social Media Images"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Caption Ideas"]})]})]})]})]})}),a.jsx(Vt,{value:"seo",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"SEO Tools"}),a.jsx(Qt,{children:"Optimize your store for search engines"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Keyword Research"})}),a.jsxs(it,{children:[a.jsxs("div",{className:"mb-4 flex gap-2",children:[a.jsx(Ye,{placeholder:"Enter a keyword to research...",className:"flex-1"}),a.jsxs(O,{children:[a.jsx(ic,{className:"mr-2 h-4 w-4"}),"Analyze"]})]}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Recent searches: wireless headphones, premium t-shirts, leather wallet"})]})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"SEO Performance"})}),a.jsx(it,{children:a.jsx("div",{className:"h-40 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"SEO performance chart placeholder"})})})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Top Keywords"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Keyword"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Search Volume"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Difficulty"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Current Ranking"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Traffic"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"wireless headphones"}),a.jsx("td",{className:"py-3 px-4",children:"12,400"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800",children:"Medium"})}),a.jsx("td",{className:"py-3 px-4",children:"#8"}),a.jsx("td",{className:"py-3 px-4",children:"245"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Optimize"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"premium t-shirts"}),a.jsx("td",{className:"py-3 px-4",children:"5,800"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Low"})}),a.jsx("td",{className:"py-3 px-4",children:"#3"}),a.jsx("td",{className:"py-3 px-4",children:"320"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Optimize"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"leather wallet men"}),a.jsx("td",{className:"py-3 px-4",children:"8,200"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"High"})}),a.jsx("td",{className:"py-3 px-4",children:"#15"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Optimize"})})]})]})]})})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Content Optimizer"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate SEO-optimized content for your product pages and blog posts."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate SEO Content"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(ic,{className:"mr-2 h-4 w-4"}),"Analyze Page SEO"]})]})]})]})]})}),a.jsx(Vt,{value:"blog",children:a.jsxs(Je,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Blog"}),a.jsx(Qt,{children:"Create and manage blog content"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Import Article"]}),a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Create New Post"]})]})]}),a.jsxs(it,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Title"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Views"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Comments"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Shares"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.title}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Published"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.publishDate||o.lastEdited||o.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:o.views||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.comments||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.shares||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(O,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Blog Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate engaging blog content with AI based on your products and target audience."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Blog Post"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Topic Ideas"]})]})]})]})]})}),a.jsx(Vt,{value:"promotions",children:a.jsxs(Je,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Promotions"}),a.jsx(Qt,{children:"Create and manage promotional campaigns"})]}),a.jsxs(O,{children:[a.jsx(qm,{className:"mr-2 h-4 w-4"}),"Create Promotion"]})]}),a.jsxs(it,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Value"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Start Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"End Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Usage"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:i.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.name}),a.jsx("td",{className:"py-3 px-4",children:o.type}),a.jsx("td",{className:"py-3 px-4",children:o.value}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.startDate}),a.jsx("td",{className:"py-3 px-4",children:o.endDate}),a.jsx("td",{className:"py-3 px-4",children:o.usageCount||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(O,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Promotion Optimizer"}),a.jsx("p",{className:"text-sm mb-4",children:"Get AI recommendations for optimal discount levels and promotion timing based on your sales data."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(qm,{className:"mr-2 h-4 w-4"}),"Generate Promotion Strategy"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Xv,{className:"mr-2 h-4 w-4"}),"Analyze Past Promotions"]})]})]})]})]})})]})]})},rje=()=>{const[t,e]=p.useState("rates"),n=[{id:"ZONE-1",name:"Domestic",countries:["United States"],methods:[{name:"Standard",price:"$5.99",deliveryTime:"3-5 business days"},{name:"Express",price:"$12.99",deliveryTime:"1-2 business days"}]},{id:"ZONE-2",name:"Canada & Mexico",countries:["Canada","Mexico"],methods:[{name:"Standard",price:"$9.99",deliveryTime:"5-7 business days"},{name:"Express",price:"$19.99",deliveryTime:"2-3 business days"}]},{id:"ZONE-3",name:"International",countries:["Rest of World"],methods:[{name:"Standard",price:"$14.99",deliveryTime:"7-14 business days"},{name:"Express",price:"$29.99",deliveryTime:"3-5 business days"}]}],r=[{id:"SUP-1",name:"GlobalDropship Inc.",products:245,avgShippingTime:"4-7 days",status:"Connected"},{id:"SUP-2",name:"FastShip Solutions",products:189,avgShippingTime:"3-5 days",status:"Pending"},{id:"SUP-3",name:"EcoPackaging Co.",products:78,avgShippingTime:"5-8 days",status:"Connected"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Shipping & Delivery"}),a.jsxs(Si,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-3 mb-6",children:[a.jsxs(Ot,{value:"rates",children:[a.jsx(nw,{className:"mr-2 h-4 w-4"}),"Shipping Rates"]}),a.jsxs(Ot,{value:"dropshipping",children:[a.jsx(Lu,{className:"mr-2 h-4 w-4"}),"Dropshipping"]}),a.jsxs(Ot,{value:"policy",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Shipping Policy"]})]}),a.jsx(Vt,{value:"rates",children:a.jsxs(Je,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Shipping Zones & Rates"}),a.jsx(Qt,{children:"Configure shipping rates by zone and package type"})]}),a.jsxs(O,{children:[a.jsx(Lu,{className:"mr-2 h-4 w-4"}),"Add Shipping Zone"]})]}),a.jsxs(it,{children:[n.map(s=>a.jsxs(Je,{className:"mb-6",children:[a.jsxs(ct,{className:"pb-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(ut,{className:"text-lg",children:s.name}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(O,{variant:"outline",size:"sm",children:"Edit"}),a.jsx(O,{variant:"outline",size:"sm",children:"Delete"})]})]}),a.jsxs(Qt,{children:["Countries: ",s.countries.join(", ")]})]}),a.jsxs(it,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Method"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Price"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Delivery Time"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.methods.map((i,o)=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.name}),a.jsx("td",{className:"py-3 px-4",children:i.price}),a.jsx("td",{className:"py-3 px-4",children:i.deliveryTime}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(O,{variant:"outline",size:"sm",children:"Delete"})]})]},o))})]})}),a.jsxs(O,{variant:"outline",size:"sm",className:"mt-4",children:[a.jsx(Oi,{className:"mr-2 h-4 w-4"}),"Add Shipping Method"]})]})]},s.id)),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Package Types"}),a.jsx("p",{className:"text-sm mb-4",children:"Define standard package types to calculate shipping rates accurately."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Small Package"}),a.jsx(O,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 1 lb, 9" x 6" x 2"'})]}),a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Medium Package"}),a.jsx(O,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 5 lbs, 12" x 9" x 4"'})]}),a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Large Package"}),a.jsx(O,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 10 lbs, 18" x 12" x 6"'})]})]}),a.jsxs(O,{variant:"outline",size:"sm",children:[a.jsx(Oi,{className:"mr-2 h-4 w-4"}),"Add Package Type"]})]})]})]})}),a.jsx(Vt,{value:"dropshipping",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Dropshipping Integration"}),a.jsx(Qt,{children:"Connect with dropshipping suppliers and manage fulfillment"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Fulfillment Mode"})}),a.jsxs(it,{children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(O,{variant:"outline",className:"flex-1",children:"Self-Fulfillment"}),a.jsx(O,{variant:"default",className:"flex-1",children:"Dropshipping"}),a.jsx(O,{variant:"outline",className:"flex-1",children:"Hybrid"})]}),a.jsxs("p",{className:"text-sm text-muted-foreground mt-4",children:["Current mode: ",a.jsx("strong",{children:"Dropshipping"}),". Products will be shipped directly from suppliers to customers."]})]})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Connect Supplier"})}),a.jsxs(it,{children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{placeholder:"Enter supplier API key or ID",className:"flex-1"}),a.jsxs(O,{children:[a.jsx(Lu,{className:"mr-2 h-4 w-4"}),"Connect"]})]}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"We support direct integration with AliExpress, Spocket, Oberlo, and more."})]})]})]}),a.jsx("h3",{className:"font-medium mb-3",children:"Connected Suppliers"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Supplier"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Products"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Avg. Shipping Time"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.products}),a.jsx("td",{className:"py-3 px-4",children:s.avgShippingTime}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Connected"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View Products"}),a.jsx(O,{variant:"outline",size:"sm",children:"Disconnect"})]})]},s.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Automatic Order Routing"}),a.jsx("p",{className:"text-sm mb-4",children:"Configure how orders are routed to different suppliers based on product, location, or other criteria."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(AE,{className:"mr-2 h-4 w-4"}),"Configure Routing Rules"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Oi,{className:"mr-2 h-4 w-4"}),"View Order Queue"]})]})]})]})]})}),a.jsx(Vt,{value:"policy",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Shipping Policy & Returns"}),a.jsx(Qt,{children:"Configure your shipping policy and return management settings"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Shipping Policy"}),a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Shipping Policy"}),a.jsx("p",{children:"We ship to all 50 US states and select international destinations. Orders are typically processed within 1-2 business days."}),a.jsx("h5",{children:"Domestic Shipping"}),a.jsxs("p",{children:["Standard shipping (3-5 business days): $5.99",a.jsx("br",{}),"Express shipping (1-2 business days): $12.99"]}),a.jsx("h5",{children:"International Shipping"}),a.jsxs("p",{children:["Standard shipping (7-14 business days): $14.99",a.jsx("br",{}),"Express shipping (3-5 business days): $29.99"]}),a.jsx("p",{children:"Free shipping on all domestic orders over $50. Shipping times may vary during peak seasons and holidays."})]})}),a.jsxs(O,{className:"mt-4",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Shipping Policy"]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Return Policy"}),a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Return Policy"}),a.jsx("p",{children:"We offer a 30-day return policy for most items. To be eligible for a return, your item must be unused and in the same condition that you received it."}),a.jsx("h5",{children:"Return Process"}),a.jsxs("p",{children:["1. Contact our customer service team",a.jsx("br",{}),"2. Receive a Return Merchandise Authorization (RMA) number",a.jsx("br",{}),"3. Ship the item back with the RMA number clearly marked",a.jsx("br",{}),"4. Once received, we will process your refund within 5-7 business days"]}),a.jsx("h5",{children:"Exceptions"}),a.jsxs("p",{children:["Certain items cannot be returned, including:",a.jsx("br",{}),"- Personalized or custom-made products",a.jsx("br",{}),"- Digital downloads",a.jsx("br",{}),"- Gift cards"]})]})}),a.jsxs(O,{className:"mt-4",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Return Policy"]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Return Management"}),a.jsx("p",{className:"text-sm mb-4",children:"Configure how returns are processed and managed."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Return Window"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ye,{type:"number",defaultValue:"30",className:"w-20"}),a.jsx("span",{className:"text-sm",children:"days after delivery"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Restocking Fee"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ye,{type:"number",defaultValue:"10",className:"w-20"}),a.jsx("span",{className:"text-sm",children:"% of item price"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Return Labels"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O,{variant:"outline",size:"sm",children:"Customer Pays"}),a.jsx(O,{variant:"default",size:"sm",children:"Store Provides"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Refund Method"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O,{variant:"default",size:"sm",children:"Original Payment"}),a.jsx(O,{variant:"outline",size:"sm",children:"Store Credit"})]})]})]}),a.jsxs(O,{className:"mt-4",children:[a.jsx(AE,{className:"mr-2 h-4 w-4"}),"Save Return Settings"]})]})]})]})})]})]})},sje=({store:t})=>{var v,_,C,T;const[e,n]=p.useState("store"),{user:r,session:s,subscriptionStatus:i}=eo(),{updateStore:o,isLoadingStores:l}=zn(),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),g=i==="active",x=async()=>{if(!(s!=null&&s.access_token)){h("Authentication token not found. Please log in again.");return}u(!0),h(null);try{const R=await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/create-portal-session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`}}),A=await R.json();if(!R.ok)throw new Error(A.error||"Failed to create portal session.");window.location.href=A.url}catch(R){console.error("Portal session error:",R),h(R.message)}finally{u(!1)}},w=()=>{var A;const R=((A=r==null?void 0:r.store)==null?void 0:A.subdomain)||"your-store";navigator.clipboard.writeText(`${R}.storegen.app`),m(!0),setTimeout(()=>m(!1),2e3)};return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Settings"}),a.jsxs(Si,{value:e,onValueChange:n,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(Ot,{value:"store",children:[a.jsx(Nh,{className:"mr-2 h-4 w-4"}),"Store Details"]}),a.jsxs(Ot,{value:"billing",children:[a.jsx(Do,{className:"mr-2 h-4 w-4"}),"Billing"]}),a.jsxs(Ot,{value:"domain",children:[a.jsx(Lu,{className:"mr-2 h-4 w-4"}),"Domain Management"]}),a.jsxs(Ot,{value:"legal",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Legal Pages"]}),a.jsxs(Ot,{value:"footer",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Footer Editor"]})]}),a.jsx(Vt,{value:"store",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Store Details"}),a.jsx(Qt,{children:"Update your store information and preferences"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"store-name",children:"Store Name"}),a.jsx(Ye,{id:"store-name",placeholder:"Your Store Name",defaultValue:"My Awesome Store"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"store-email",children:"Store Email"}),a.jsx(Ye,{id:"store-email",type:"email",placeholder:"contact@yourstore.com",defaultValue:(r==null?void 0:r.email)||""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"store-phone",children:"Store Phone"}),a.jsx(Ye,{id:"store-phone",placeholder:"+1 (555) 123-4567",defaultValue:"+1 (555) 123-4567"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"store-address",children:"Store Address"}),a.jsx(Pn,{id:"store-address",placeholder:"123 Main St, City, State, ZIP",defaultValue:"123 Main St\\nNew York, NY 10001\\nUnited States",rows:3})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"store-currency",children:"Currency"}),a.jsxs("select",{id:"store-currency",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",defaultValue:"USD",children:[a.jsx("option",{value:"USD",children:"USD ($)"}),a.jsx("option",{value:"EUR",children:"EUR (€)"}),a.jsx("option",{value:"GBP",children:"GBP (£)"}),a.jsx("option",{value:"CAD",children:"CAD ($)"}),a.jsx("option",{value:"AUD",children:"AUD ($)"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"store-timezone",children:"Timezone"}),a.jsxs("select",{id:"store-timezone",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",defaultValue:"America/New_York",children:[a.jsx("option",{value:"America/New_York",children:"Eastern Time (ET)"}),a.jsx("option",{value:"America/Chicago",children:"Central Time (CT)"}),a.jsx("option",{value:"America/Denver",children:"Mountain Time (MT)"}),a.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PT)"}),a.jsx("option",{value:"Europe/London",children:"London (GMT)"})]})]})]})]})]}),a.jsxs("div",{className:"mt-6 space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"store-description",children:"Store Description"}),a.jsx(Pn,{id:"store-description",placeholder:"Tell customers about your store...",defaultValue:"Welcome to My Awesome Store! We offer high-quality products at competitive prices. Our mission is to provide exceptional customer service and a seamless shopping experience.",rows:4})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Oo,{id:"enable-reviews",defaultChecked:!0}),a.jsx(De,{htmlFor:"enable-reviews",children:"Enable customer reviews"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Oo,{id:"enable-inventory",defaultChecked:!0}),a.jsx(De,{htmlFor:"enable-inventory",children:"Show inventory warnings on product pages"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Oo,{id:"enable-tax",defaultChecked:!0}),a.jsx(De,{htmlFor:"enable-tax",children:"Enable automatic tax calculation"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Oo,{id:"enable-store-theme-toggle",checked:((v=t==null?void 0:t.settings)==null?void 0:v.showThemeToggle)??!0,onCheckedChange:R=>{t&&o&&o(t.id,{settings:{...t.settings,showThemeToggle:R}})},disabled:l||!t}),a.jsx(De,{htmlFor:"enable-store-theme-toggle",children:"Show theme (light/dark) toggle in store header"})]})]}),a.jsxs(O,{className:"mt-6",disabled:l||!t,children:[a.jsx(J_,{className:"mr-2 h-4 w-4"}),"Save Store Details"]})]})]})}),a.jsx(Vt,{value:"billing",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Billing Information"}),a.jsx(Qt,{children:"Manage your subscription and payment methods"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Current Plan"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-xl font-medium",children:g?"Store Creator Plan":"Free Plan"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g?"$29.99/month, billed monthly":"Limited features"}),a.jsxs("div",{className:"mt-4",children:[g?a.jsxs(O,{onClick:x,disabled:c,children:[a.jsx(Do,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Subscription"]}):a.jsxs(O,{onClick:x,disabled:c,children:[" ",a.jsx(Do,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Upgrade to Pro"]}),d&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:d})]})]})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Payment Methods"})}),a.jsx(it,{children:g?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"bg-blue-100 p-2 rounded-md mr-3",children:a.jsx(Do,{className:"h-5 w-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Visa ending in 4242"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Expires 12/2025"})]})]}),a.jsx(O,{variant:"outline",size:"sm",onClick:x,disabled:c,children:"Edit"})]}),a.jsxs(O,{variant:"outline",onClick:x,disabled:c,children:[a.jsx(Do,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Add Payment Method"]})]}):a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsxs("p",{className:"text-muted-foreground",children:["No payment methods available.",a.jsx("br",{}),"Upgrade to add payment methods."]})})})]})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Billing History"})}),a.jsx(it,{children:g?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Description"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Invoice"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"May 1, 2023"}),a.jsx("td",{className:"py-3 px-4",children:"Store Creator Plan"}),a.jsx("td",{className:"py-3 px-4",children:"$29.99"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Paid"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Download"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Apr 1, 2023"}),a.jsx("td",{className:"py-3 px-4",children:"Store Creator Plan"}),a.jsx("td",{className:"py-3 px-4",children:"$29.99"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Paid"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Download"})})]})]})]})}):a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsxs("p",{className:"text-muted-foreground",children:["No billing history available.",a.jsx("br",{}),"Upgrade to view billing history."]})})})]})]})]})}),a.jsx(Vt,{value:"domain",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Domain Management"}),a.jsx(Qt,{children:"Configure your store's domain and URL settings"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Subdomain"})}),a.jsxs(it,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ye,{defaultValue:((_=r==null?void 0:r.store)==null?void 0:_.subdomain)||"your-store",className:"flex-grow"}),a.jsx("span",{className:"text-muted-foreground",children:".storegen.app"})]}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsxs(O,{children:[a.jsx(J_,{className:"mr-2 h-4 w-4"}),"Save Subdomain"]}),a.jsx(O,{variant:"outline",onClick:w,children:f?a.jsxs(a.Fragment,{children:[a.jsx(Ig,{className:"mr-2 h-4 w-4"})," Copied"]}):a.jsxs(a.Fragment,{children:[a.jsx(RI,{className:"mr-2 h-4 w-4"})," Copy URL"]})})]})]})]}),a.jsxs(Je,{children:[a.jsxs(ct,{className:"pb-2",children:[a.jsx(ut,{className:"text-lg",children:"Custom Domain"}),!g&&a.jsx(Qt,{children:a.jsx("span",{className:"text-yellow-600",children:"Available on paid plans only"})})]}),a.jsx(it,{children:g?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ye,{placeholder:"yourdomain.com",className:"flex-grow"}),a.jsxs(O,{children:[a.jsx(Lu,{className:"mr-2 h-4 w-4"}),"Connect"]})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your domain name without http:// or www."})]}):a.jsxs("div",{className:"flex flex-col items-center justify-center h-32 space-y-4",children:[a.jsx("p",{className:"text-muted-foreground text-center",children:"Custom domains are available on paid plans only."}),a.jsxs(O,{onClick:x,disabled:c,children:[a.jsx(Do,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Upgrade to Pro"]})]})})]})]}),g&&a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"DNS Configuration"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm",children:"To connect your custom domain, add these DNS records in your domain provider's dashboard:"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Value"}),a.jsx("th",{className:"text-left py-3 px-4",children:"TTL"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"CNAME"}),a.jsx("td",{className:"py-3 px-4",children:"@"}),a.jsxs("td",{className:"py-3 px-4",children:[((C=r==null?void 0:r.store)==null?void 0:C.subdomain)||"your-store",".storegen.app"]}),a.jsx("td",{className:"py-3 px-4",children:"3600"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"CNAME"}),a.jsx("td",{className:"py-3 px-4",children:"www"}),a.jsxs("td",{className:"py-3 px-4",children:[((T=r==null?void 0:r.store)==null?void 0:T.subdomain)||"your-store",".storegen.app"]}),a.jsx("td",{className:"py-3 px-4",children:"3600"})]})]})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"View DNS Guide"]}),a.jsxs(O,{children:[a.jsx(Lu,{className:"mr-2 h-4 w-4"}),"Verify DNS"]})]})]})})]})]})]})}),a.jsx(Vt,{value:"legal",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Legal Pages"}),a.jsx(Qt,{children:"Configure your store's legal documents and policies"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Privacy Policy"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Privacy Policy"}),a.jsx("p",{children:"This Privacy Policy describes how your personal information is collected, used, and shared when you visit or make a purchase from our store."}),a.jsx("h5",{children:"Personal Information We Collect"}),a.jsx("p",{children:"When you visit the Site, we automatically collect certain information about your device, including information about your web browser, IP address, time zone, and some of the cookies that are installed on your device."}),a.jsx("p",{children:"Additionally, as you browse the Site, we collect information about the individual web pages or products that you view, what websites or search terms referred you to the Site, and information about how you interact with the Site."}),a.jsx("h5",{children:"How We Use Your Personal Information"}),a.jsx("p",{children:"We use the information that we collect generally to fulfill any orders placed through the Site (including processing your payment information, arranging for shipping, and providing you with invoices and/or order confirmations)."})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Privacy Policy"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Terms of Service"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Terms of Service"}),a.jsx("p",{children:"These Terms of Service govern your use of our website and the products and services provided by us."}),a.jsx("h5",{children:"Overview"}),a.jsx("p",{children:"By accessing our website, you agree to these Terms of Service. If you do not agree with any part of these terms, you may not access the website or use our services."}),a.jsx("h5",{children:"Products and Services"}),a.jsx("p",{children:"All products and services displayed on our website are subject to availability. We reserve the right to discontinue any product or service at any time."}),a.jsx("h5",{children:"Accuracy of Information"}),a.jsx("p",{children:"We make every effort to ensure that the information on our website is accurate and up-to-date. However, we do not warrant that product descriptions or other content is accurate, complete, reliable, current, or error-free."})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Terms of Service"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Refund Policy"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Refund Policy"}),a.jsx("p",{children:"We offer a 30-day return policy for most items. To be eligible for a return, your item must be unused and in the same condition that you received it."}),a.jsx("h5",{children:"Return Process"}),a.jsxs("p",{children:["1. Contact our customer service team",a.jsx("br",{}),"2. Receive a Return Merchandise Authorization (RMA) number",a.jsx("br",{}),"3. Ship the item back with the RMA number clearly marked",a.jsx("br",{}),"4. Once received, we will process your refund within 5-7 business days"]}),a.jsx("h5",{children:"Exceptions"}),a.jsxs("p",{children:["Certain items cannot be returned, including:",a.jsx("br",{}),"- Personalized or custom-made products",a.jsx("br",{}),"- Digital downloads",a.jsx("br",{}),"- Gift cards"]})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Refund Policy"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Cookie Policy"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Cookie Policy"}),a.jsx("p",{children:"This Cookie Policy explains how we use cookies and similar technologies to recognize you when you visit our website."}),a.jsx("h5",{children:"What are cookies?"}),a.jsx("p",{children:"Cookies are small data files that are placed on your computer or mobile device when you visit a website. Cookies are widely used by website owners in order to make their websites work, or to work more efficiently, as well as to provide reporting information."}),a.jsx("h5",{children:"How we use cookies"}),a.jsx("p",{children:'We use cookies for several reasons. Some cookies are required for technical reasons in order for our website to operate, and we refer to these as "essential" or "strictly necessary" cookies. Other cookies enable us to track and target the interests of our users to enhance the experience on our website.'})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Cookie Policy"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]})]})]})]})}),a.jsx(Vt,{value:"footer",children:a.jsxs(Je,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Footer Editor"}),a.jsx(Qt,{children:"Customize your store's footer information"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Contact Information"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"footer-email",children:"Email"}),a.jsx(Ye,{id:"footer-email",type:"email",placeholder:"contact@yourstore.com",defaultValue:(r==null?void 0:r.email)||""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"footer-phone",children:"Phone"}),a.jsx(Ye,{id:"footer-phone",placeholder:"+1 (555) 123-4567",defaultValue:"+1 (555) 123-4567"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"footer-address",children:"Address"}),a.jsx(Pn,{id:"footer-address",placeholder:"123 Main St, City, State, ZIP",defaultValue:"123 Main St\\nNew York, NY 10001\\nUnited States",rows:3})]})]})})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Business Hours"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"footer-hours",children:"Hours of Operation"}),a.jsx(Pn,{id:"footer-hours",placeholder:"Monday-Friday: 9am-5pm",defaultValue:"Monday-Friday: 9am-5pm\\nSaturday: 10am-4pm\\nSunday: Closed",rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"footer-support",children:"Customer Support Hours"}),a.jsx(Pn,{id:"footer-support",placeholder:"Monday-Friday: 9am-5pm",defaultValue:"Monday-Friday: 9am-6pm\\nSaturday: 10am-2pm\\nSunday: Closed",rows:3})]})]})})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Social Media"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"footer-facebook",children:"Facebook"}),a.jsx(Ye,{id:"footer-facebook",placeholder:"https://facebook.com/yourstore",defaultValue:"https://facebook.com/yourstore"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"footer-instagram",children:"Instagram"}),a.jsx(Ye,{id:"footer-instagram",placeholder:"https://instagram.com/yourstore",defaultValue:"https://instagram.com/yourstore"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"footer-twitter",children:"Twitter"}),a.jsx(Ye,{id:"footer-twitter",placeholder:"https://twitter.com/yourstore",defaultValue:"https://twitter.com/yourstore"})]})]})})]})]}),a.jsxs(Je,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"About Us"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"footer-about",children:"About Us Text"}),a.jsx(Pn,{id:"footer-about",placeholder:"Tell customers about your business...",defaultValue:"My Awesome Store was founded in 2023 with a mission to provide high-quality products at competitive prices. We are committed to exceptional customer service and a seamless shopping experience.",rows:4})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(De,{htmlFor:"footer-copyright",children:"Copyright Text"}),a.jsx(Ye,{id:"footer-copyright",placeholder:"© 2023 Your Store. All rights reserved.",defaultValue:`© ${new Date().getFullYear()} My Awesome Store. All rights reserved.`})]})]})})]}),a.jsx("div",{className:"mt-6",children:a.jsxs(O,{children:[a.jsx(J_,{className:"mr-2 h-4 w-4"}),"Save Footer Settings"]})})]})]})})]})]})},ije=()=>{const{storeName:t}=N0(),e=xl(),{getStoreById:n,getStoreByName:r,setCurrentStore:s,isLoadingStores:i}=zn(),o=new URLSearchParams(e.search),l=o.get("tab")||"orders",[c,u]=p.useState(l),[d,h]=p.useState(null);p.useEffect(()=>{if(!i&&t){const m=r(t);m?(h(m),s(m)):console.error(`Store with name ${t} not found.`)}},[t,r,s,i]),p.useEffect(()=>{const m=o.get("tab");m&&m!==c&&u(m)},[e.search]);const f=()=>{switch(c){case"orders":return a.jsx(iO,{store:d});case"products":return a.jsx(QRe,{store:d});case"customers":return a.jsx(ZRe,{store:d});case"payments":return a.jsx(eje,{store:d});case"analytics":return a.jsx(tje,{store:d});case"marketing":return a.jsx(nje,{store:d});case"shipping":return a.jsx(rje,{store:d});case"settings":return a.jsx(sje,{store:d});default:return a.jsx(iO,{store:d})}};return i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading dashboard..."})]})}):!d&&!i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Store Not Found"}),a.jsxs("p",{className:"text-muted-foreground",children:["Could not load dashboard for store: ",t]})]})}):a.jsx(XRe,{activeTab:c,setActiveTab:u,storeId:d==null?void 0:d.id,storeName:d==null?void 0:d.name,children:f()})},oje=[{id:"ref1",name:"Modern Minimalist",imageUrl:"https://via.placeholder.com/150/f8f9fa/000000?text=Modern"},{id:"ref2",name:"Vintage Charm",imageUrl:"https://via.placeholder.com/150/e9ecef/000000?text=Vintage"},{id:"ref3",name:"Abstract Art",imageUrl:"https://via.placeholder.com/150/dee2e6/000000?text=Abstract"},{id:"ref4",name:"Nature Inspired",imageUrl:"https://via.placeholder.com/150/ced4da/000000?text=Nature"}],aje=()=>{const[t,e]=p.useState(""),[n,r]=p.useState(null),[s,i]=p.useState(null),[o,l]=p.useState(null),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),[g,x]=p.useState([]),[w,v]=p.useState(""),_=bi(),C=A=>{const E=A.target.files[0];if(E){const I=new FileReader;I.onloadend=()=>{r(I.result),l(I.result)},I.readAsDataURL(E)}},T=A=>{const E=Array.from(A.target.files);if(E.length+g.length>3){h("You can upload a maximum of 3 ingredient images.");return}E.forEach(I=>{const P=new FileReader;P.onloadend=()=>{x(k=>[...k,P.result])},P.readAsDataURL(I)})},R=async()=>{u(!0),h(null),l(null);try{let A;const E=n?n.split(",")[1]:null,I=g.map(P=>({mimeType:"image/png",data:P.split(",")[1]}));if(f&&E)A=await DE(t,E,"image/png",I);else{const P=s?`${t} in the style of ${s.name}`:t;A=await o5(P,I)}A.imageData?l(`data:image/png;base64,${A.imageData}`):h(A.text||"Failed to generate image. No image data returned.")}catch(A){console.error("Error generating image:",A),h(A.message||"An unexpected error occurred.")}finally{u(!1)}};return a.jsxs("div",{className:"flex flex-col md:flex-row h-screen bg-background text-foreground",children:[a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-4 left-4 z-10 md:hidden",onClick:()=>window.history.back(),children:a.jsx(Go,{})}),a.jsxs("main",{className:"flex-1 flex items-center justify-center p-0 md:p-6 relative bg-background md:order-2",style:{paddingTop:"60px"},children:[o&&a.jsx("div",{className:"absolute top-0 left-0 right-0 bg-primary text-primary-foreground p-2 text-center md:hidden",children:a.jsxs(O,{className:"bg-transparent hover:bg-primary/90",children:[a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Create Store with Design"]})}),a.jsxs("div",{className:"w-full md:max-w-2xl aspect-square flex items-center justify-center relative",children:[c&&a.jsx("p",{children:"Loading..."}),d&&a.jsx("p",{className:"text-red-500",children:d}),o&&a.jsx("img",{src:o,alt:"Generated result",className:"max-w-full max-h-full object-contain"}),!c&&!d&&!o&&a.jsx("div",{className:"text-center text-muted-foreground",children:a.jsx("p",{children:"Your design will appear here."})}),o&&a.jsx("div",{className:"absolute top-4 right-4 hidden md:block",children:a.jsxs(O,{className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>_("/",{state:{generatedImage:o}}),children:[a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Create Store with Design"]})}),o&&a.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex items-center gap-2",children:[a.jsx(Ye,{type:"text",value:w,onChange:A=>v(A.target.value),placeholder:"Describe your edit...",className:"bg-background/80 backdrop-blur-sm"}),a.jsx(O,{onClick:async()=>{if(w){u(!0),h(null);try{const A=o.split(",")[1],E=await DE(w,A,"image/png");E.imageData?l(`data:image/png;base64,${E.imageData}`):h(E.text||"Failed to edit image.")}catch(A){h(A.message)}finally{u(!1),v("")}}},disabled:c,className:"bg-secondary hover:bg-secondary/90 text-secondary-foreground",children:"Edit"})]})]})]}),a.jsxs("aside",{className:"w-full md:w-1/3 md:max-w-sm p-6 bg-card shadow-md relative md:order-1",children:[a.jsx(xs,{className:"h-full",children:a.jsxs("div",{className:"space-y-6 pb-20",children:[a.jsxs("div",{className:"hidden md:flex items-center justify-between",children:[a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>window.history.back(),children:a.jsx(Go,{})}),a.jsx("h1",{className:"text-2xl font-bold",children:"Designer"}),a.jsx("img",{src:"https://static.wixstatic.com/media/bd2e29_695f70787cc24db4891e63da7e7529b3~mv2.png",alt:"Logo",className:"h-8 dark:hidden"}),a.jsx("img",{src:"https://static.wixstatic.com/media/bd2e29_20f2a8a94b7e492a9d76e0b8b14e623b~mv2.png",alt:"Logo Dark",className:"h-8 hidden dark:block"})]}),a.jsx("div",{className:"md:hidden text-center"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Oo,{id:"use-own-image",checked:f,onCheckedChange:m}),a.jsx(De,{htmlFor:"use-own-image",children:"Use your own image"})]}),f&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Upload Your Image"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Upload an image to edit."}),a.jsx(Ye,{id:"image-upload",type:"file",accept:"image/*",onChange:C,className:"mt-2"}),n&&a.jsxs("div",{className:"mt-4",children:[a.jsx("img",{src:n,alt:"Uploaded preview",className:"w-full rounded-lg shadow-sm"}),a.jsx(O,{variant:"link",size:"sm",onClick:()=>r(null),className:"mt-1 px-0",children:"Remove"})]})]}),a.jsx(Ui,{}),a.jsxs("div",{children:[a.jsx(De,{htmlFor:"prompt",className:"text-lg font-semibold",children:"Prompt"}),a.jsx(Ye,{id:"prompt",type:"text",value:t,onChange:A=>e(A.target.value),placeholder:"e.g., a futuristic cityscape",className:"mt-2"})]}),a.jsx(Ui,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Ingredients"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Add up to 3 images to include in the generation."}),a.jsx(Ye,{id:"ingredient-upload",type:"file",accept:"image/*",multiple:!0,onChange:T,className:"mt-2"}),a.jsx("div",{className:"grid grid-cols-3 gap-2 mt-4",children:g.map((A,E)=>a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:A,alt:`Ingredient ${E+1}`,className:"w-full rounded-lg shadow-sm"}),a.jsx(O,{variant:"destructive",size:"sm",className:"absolute top-1 right-1 h-6 w-6 p-0",onClick:()=>x(I=>I.filter((P,k)=>k!==E)),children:"X"})]},E))})]}),a.jsx(Ui,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Reference Styles"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Optionally select a style to influence the generation."}),a.jsx("div",{className:"grid grid-cols-2 gap-4",children:oje.map(A=>a.jsxs("div",{className:`cursor-pointer border-2 rounded-lg overflow-hidden ${(s==null?void 0:s.id)===A.id?"border-primary":"border-transparent"}`,onClick:()=>i((s==null?void 0:s.id)===A.id?null:A),children:[a.jsx("img",{src:A.imageUrl,alt:A.name,className:"w-full h-24 object-cover"}),a.jsx("p",{className:"text-center text-sm p-1 bg-muted",children:A.name})]},A.id))})]}),a.jsx(Ui,{})]})}),a.jsx("div",{className:"absolute bottom-6 left-6 right-6",children:a.jsx(O,{onClick:R,disabled:c||!t,className:"w-full",children:c?"Generating...":"Generate Image"})})]})]})},lje=()=>a.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[a.jsx("h1",{className:"text-4xl font-bold",children:"Music Page"}),a.jsx("p",{className:"text-lg text-gray-600",children:"This page is under construction."})]}),cje=()=>{const[t,e]=p.useState(""),[n,r]=p.useState(""),[s,i]=p.useState(!1),[o,l]=p.useState([]),[c,u]=p.useState(0),d=async()=>{if(!t.trim())return;i(!0),r(""),l([]),u(0);const h=new En({apiKey:"AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s"});try{l(R=>[...R,"Generating transcript..."]),u(25);const m=(await h.models.generateContent({model:"gemini-2.0-flash",contents:`Generate a short podcast transcript with two speakers, Joe and Jane, discussing ${t}.`})).text;l(R=>[...R,"Transcript generated."]),u(50),l(R=>[...R,"Generating audio..."]),u(75);const x=(await h.models.generateContent({model:"gemini-2.5-flash-preview-tts",contents:m,config:{responseModalities:["AUDIO"],speechConfig:{multiSpeakerVoiceConfig:{speakerVoiceConfigs:[{speaker:"Joe",voiceConfig:{prebuiltVoiceConfig:{voiceName:"Kore"}}},{speaker:"Jane",voiceConfig:{prebuiltVoiceConfig:{voiceName:"Puck"}}}]}}}})).candidates[0].content.parts[0].inline_data.data,w=atob(x),v=new Array(w.length);for(let R=0;R<w.length;R++)v[R]=w.charCodeAt(R);const _=new Uint8Array(v),C=new Blob([_],{type:"audio/wav"}),T=URL.createObjectURL(C);r(T),l(R=>[...R,"Audio generated."]),u(100)}catch(f){console.error("Error generating podcast:",f),l(m=>[...m,"Error generating podcast."])}finally{i(!1)}};return a.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-neutral-100 dark:bg-neutral-900 relative text-neutral-900 dark:text-neutral-100",children:[a.jsx(sr,{to:"/",className:"absolute top-4 left-4",children:a.jsx(O,{variant:"ghost",size:"icon",children:a.jsx(Go,{})})}),!n&&!s&&a.jsxs("div",{className:"w-full max-w-md p-8 space-y-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-center",children:"Create a Podcast"}),a.jsx("div",{className:"space-y-2",children:a.jsx(Ye,{type:"text",placeholder:"Enter a topic, ex. 2025 print on demand trends...",value:t,onChange:h=>e(h.target.value),className:"w-full bg-neutral-200/50 dark:bg-neutral-800/50 rounded-[18px] border-neutral-300 dark:border-neutral-700"})}),a.jsx(O,{onClick:d,className:"w-full bg-blue-600 hover:bg-blue-700",children:"Create"})]}),s&&a.jsxs("div",{className:"w-full max-w-md p-8 space-y-6",children:[a.jsx($a,{value:c,className:"w-full"}),a.jsx("div",{className:"text-center",children:o.map((h,f)=>a.jsx("p",{children:h},f))})]}),n&&!s&&a.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-white dark:bg-neutral-800 rounded-lg shadow-md",children:[a.jsx("h1",{className:"text-3xl font-bold text-center",children:"Your Podcast"}),a.jsx("audio",{controls:!0,src:n,className:"w-full"}),a.jsx(O,{onClick:()=>r(""),className:"w-full bg-blue-600 hover:bg-blue-700",children:"Go Back"})]})]})},gm=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),uje=()=>{const{toast:t}=bs(),[e,n]=p.useState("text-to-image"),[r,s]=p.useState(""),[i,o]=p.useState(""),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[h,f]=p.useState(null),[m,g]=p.useState([]),[x,w]=p.useState(!1),[v,_]=p.useState(""),[C,T]=p.useState(null),[R,A]=p.useState(!1),[E,I]=p.useState(null),[P,k]=p.useState([]),[j,D]=p.useState(""),[M,G]=p.useState(!1),[B,W]=p.useState(null),[Q,H]=p.useState(!1),[Y,V]=p.useState(null),$=async()=>{var he,Ce;if(!(!Y||!Y.url))try{const Pe=document.createElement("a");let ve="download";if(Y.url.startsWith("data:")){const de=Y.url.match(/:(.*?);/),Ge=(de?de[1]:"application/octet-stream").split("/")[1]||"bin";ve=`${((he=Y.caption)==null?void 0:he.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${Ge}`,Pe.href=Y.url}else{const Me=await(await fetch(Y.url)).blob();Pe.href=URL.createObjectURL(Me);const Ge=Y.url.substring(Y.url.lastIndexOf("/")+1).split("?")[0],yt=Ge.includes(".")?Ge.substring(Ge.lastIndexOf(".")+1):"",Pt=Y.type==="video"?"mp4":"png";ve=Ge||`${((Ce=Y.caption)==null?void 0:Ce.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${yt||Pt}`}Pe.download=ve,document.body.appendChild(Pe),Pe.click(),document.body.removeChild(Pe),Y.url.startsWith("data:")||URL.revokeObjectURL(Pe.href),t({title:"Download Started",description:`Downloading ${ve}`})}catch(Pe){console.error("Error downloading media:",Pe),t({title:"Download Failed",description:Pe.message,variant:"destructive"})}},z=async()=>{if(!r.trim()){t({title:"Error",description:"Please enter a prompt for image generation",variant:"destructive"});return}c(!0),f(null),D("");try{const he=await j0(r);let Ce=he.alt?[he.alt]:[`Image for: ${r.substring(0,30)}`];if(he.url)try{const{base64ImageData:Pe,mimeType:ve}=await gm(he.url);Ce=await ca(Pe,ve,`Image of ${r}`)}catch(Pe){console.error("Error generating caption for Gemini image:",Pe),Ce=[`Failed to generate caption for: ${r.substring(0,30)}`]}f({url:he.url,captions:Ce,sourceApi:"gemini"}),Ce&&Ce.length>0&&D(Ce[0])}catch(he){console.error("Error generating image with Gemini:",he),t({title:"Image Generation Failed",description:he.message,variant:"destructive"})}finally{c(!1)}},F=async()=>{if(!i.trim()){t({title:"Error",description:"Please enter a prompt for OpenAI image generation",variant:"destructive"});return}d(!0),f(null),D("");try{const he=await sz(i),Ce=`data:image/png;base64,${he.b64_json}`;let Pe=he.alt?[he.alt]:[`OpenAI image for: ${i.substring(0,30)}`];try{const{base64ImageData:ve,mimeType:de}=await gm(Ce);Pe=await ca(ve,de,`OpenAI-generated image of ${i}`)}catch(ve){console.error("Error generating caption for OpenAI image:",ve),Pe=[`Failed to generate caption for: ${i.substring(0,30)}`]}f({url:Ce,captions:Pe,sourceApi:"openai"}),Pe&&Pe.length>0&&D(Pe[0]),t({title:"Image Generated (OpenAI)",description:"Image successfully generated using OpenAI."})}catch(he){console.error("Error generating image with OpenAI:",he),t({title:"OpenAI Image Generation Failed",description:he.message,variant:"destructive"})}finally{d(!1)}},Z=async(he,Ce)=>{if(!he||!he.url){t({title:"Error",description:"No image selected to edit with Gemini.",variant:"destructive"});return}if(!Ce.trim()){t({title:"Error",description:"Please enter an edit prompt for Gemini.",variant:"destructive"});return}A(!0),I(null),D("");try{const{base64ImageData:Pe,mimeType:ve}=await gm(he.url),de=await Wo(Pe,ve,Ce);if(de&&de.editedImageData){const Me=`data:${de.newMimeType};base64,${de.editedImageData}`;let Ge=de.editTextResponse?[de.editTextResponse]:[`Edited with Gemini: ${he.caption||he.id}`];try{Ge=await ca(de.editedImageData,de.newMimeType,`Edited image based on: ${Ce}`)}catch(yt){console.error("Error generating caption for Gemini edited image:",yt)}I({url:Me,captions:Ge,sourceApi:"gemini"}),Ge&&Ge.length>0&&D(Ge[0]),t({title:"Image Edited (Gemini)",description:"Image successfully edited with Gemini."})}else throw new Error("Gemini image edit did not return image data.")}catch(Pe){console.error("Error editing image with Gemini:",Pe),t({title:"Gemini Edit Failed",description:Pe.message,variant:"destructive"})}finally{A(!1)}},fe=async he=>{const Ce=he.target.files[0];if(Ce){H(!0),W(null),D("");try{const Pe=new FileReader;Pe.onload=async ve=>{const de=ve.target.result,Me=Ce.type.startsWith("video/")?"video":"image";let Ge=[Ce.name];if(Me==="image")try{const{base64ImageData:yt,mimeType:Pt}=await gm(de);Ge=await ca(yt,Pt,"Uploaded image caption")}catch(yt){console.error("Error generating caption for uploaded image:",yt)}else Ge=[`Uploaded video: ${Ce.name}`];W({url:de,captions:Ge,type:Me}),Ge&&Ge.length>0&&D(Ge[0]),H(!1)},Pe.onerror=()=>{t({title:"Upload Failed",description:"Failed to read the selected file",variant:"destructive"}),H(!1)},Pe.readAsDataURL(Ce)}catch(Pe){console.error("Error processing uploaded file:",Pe),t({title:"Upload Failed",description:Pe.message,variant:"destructive"}),H(!1)}}},xe=(he,Ce,Pe="image")=>{if(!he){t({title:"Cannot Add",description:"Item URL is missing.",variant:"destructive"});return}const ve={id:Dt(),type:Pe,url:he,caption:Ce||`Item ${P.length+1}`,isVideo:Pe==="video"};k(de=>[...de,ve]),t({title:"Added to Timeline",description:`${Pe==="video"?"Video":"Image"} added to your content timeline.`}),f(null),I(null),W(null),T(null),D("")},ge=(he,Ce)=>{const Pe=[...P],ve=Pe[he],de=he+Ce;de<0||de>=Pe.length||(Pe.splice(he,1),Pe.splice(de,0,ve),k(Pe))},Re=he=>{k(Ce=>Ce.filter(Pe=>Pe.id!==he)),t({title:"Removed from Timeline",description:"Item removed."})},Ue=async(he,Ce)=>{if(he.isVideo){t({title:"Already a Video",description:"This item is already a video."});return}G(!0);try{const{base64ImageData:Pe,mimeType:ve}=await gm(he.url),de=he.caption||"Create a short video from this image",Me=await JI(de,Pe,ve),Ge=[...P];Ge[Ce]={...he,url:Me,isVideo:!0,type:"video",caption:he.caption+" (Veo Video)"},k(Ge),t({title:"Veo Video Generated",description:"Image converted to video using Veo."})}catch(Pe){console.error("Error converting to Veo video:",Pe),t({title:"Veo Conversion Failed",description:Pe.message,variant:"destructive"})}finally{G(!1)}},ze=he=>{const Ce=P.find(ve=>ve.id===he);if(!Ce)return;const Pe=prompt("Edit caption:",Ce.caption);Pe!==null&&Pe.trim()!==Ce.caption&&(k(ve=>ve.map(de=>de.id===he?{...de,caption:Pe.trim()}:de)),t({title:"Caption Updated"}))};return a.jsxs("div",{className:"container mx-auto p-4 md:p-6 lg:p-8 space-y-8 bg-background",children:[a.jsxs("header",{className:"relative text-center pb-4",children:[a.jsx(sr,{to:"/",className:"absolute left-0 top-0",children:a.jsxs(O,{variant:"outline",size:"icon",children:[a.jsx(Go,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Back to Home"})]})}),a.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight",children:"AI Content Creation Studio"}),a.jsx("p",{className:"text-muted-foreground mt-2 text-lg",children:"Generate images, edit them, create videos, and build your content sequence."})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 xl:gap-8",children:[a.jsx("div",{className:"lg:col-span-1 space-y-6",children:a.jsxs(Si,{value:e,onValueChange:n,className:"w-full",children:[a.jsxs(ti,{className:"grid w-full grid-cols-3",children:[a.jsxs(Ot,{value:"text-to-image",children:[a.jsx(xa,{className:"mr-1 h-4 w-4 inline-block"}),"Gen Image"]}),a.jsxs(Ot,{value:"image-edit",children:[a.jsx(tw,{className:"mr-1 h-4 w-4 inline-block"}),"Edit Image"]}),a.jsxs(Ot,{value:"upload",children:[a.jsx(H3,{className:"mr-1 h-4 w-4 inline-block"}),"Upload"]})]}),a.jsxs(Vt,{value:"text-to-image",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(De,{htmlFor:"text-prompt-model1",className:"text-lg font-semibold",children:"Text-to-Image (Quick)"}),a.jsx(Pn,{id:"text-prompt-model1",placeholder:"e.g., 'A futuristic cityscape at sunset'",value:r,onChange:he=>s(he.target.value),rows:3,className:"mt-2",disabled:l||u}),x&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Loading prompt suggestions..."}),m.length>0&&!x&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx(De,{className:"text-xs text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:m.map((he,Ce)=>a.jsx(O,{variant:"outline",size:"xs",onClick:()=>s(he),className:"text-xs",children:he.length>40?he.substring(0,37)+"...":he},Ce))})]}),a.jsxs(O,{onClick:z,disabled:l||u||!r.trim(),className:"w-full mt-3",children:[l?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Generate with Quick"]}),a.jsx(Ui,{className:"my-4"}),a.jsx(De,{htmlFor:"text-prompt-model2",className:"text-lg font-semibold",children:"Text-to-Image (Quality)"}),a.jsx(Pn,{id:"text-prompt-model2",placeholder:"e.g., 'A photorealistic cat astronaut'",value:i,onChange:he=>o(he.target.value),rows:3,className:"mt-2",disabled:l||u}),a.jsxs(O,{onClick:F,disabled:l||u||!i.trim(),className:"w-full mt-3",children:[u?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(V3,{className:"mr-2 h-4 w-4"}),"Generate with Quality"]}),h&&h.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:h.url,alt:`Generated by ${h.sourceApi==="gemini"?"Quick":h.sourceApi==="openai"?"Quality":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",h.sourceApi==="gemini"?"Quick":h.sourceApi==="openai"?"Quality":"AI"]}),a.jsx(De,{className:"text-sm font-medium",children:"Choose a caption:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(h.captions||[]).map((he,Ce)=>a.jsx(O,{variant:j===he?"default":"outline",size:"sm",onClick:()=>D(he),className:"text-xs",children:he},Ce))}),a.jsxs(O,{onClick:()=>xe(h.url,j),size:"sm",className:"w-full mt-2",disabled:!j,children:[a.jsx(Nu,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]}),a.jsxs(Vt,{value:"image-edit",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(De,{className:"text-lg font-semibold",children:"Image Editing"}),!C&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select an image from the timeline to enable editing."}),C&&a.jsxs("div",{className:"mt-2 space-y-3",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Editing: ",a.jsx("span",{className:"text-primary truncate",children:C.caption})]}),a.jsx("img",{src:C.url,alt:"Selected for editing",className:"w-full rounded-md object-contain max-h-48 border"}),a.jsx(De,{htmlFor:"edit-prompt-model1",children:"Edit with Quick"}),a.jsx(Pn,{id:"edit-prompt-model1",placeholder:"Describe edits (e.g., 'change background to a beach')",value:v,onChange:he=>_(he.target.value),rows:2,disabled:R}),a.jsxs(O,{onClick:()=>Z(C,v),disabled:R||!v.trim(),className:"w-full",children:[R?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Edit with Quick"]})]}),E&&E.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:E.url,alt:`Edited by ${E.sourceApi==="gemini"?"Quick":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",E.sourceApi==="gemini"?"Quick":"AI"]}),a.jsx(De,{className:"text-sm font-medium",children:"Choose a caption for the edited image:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(E.captions||[]).map((he,Ce)=>a.jsx(O,{variant:j===he?"default":"outline",size:"sm",onClick:()=>D(he),className:"text-xs",children:he},Ce))}),a.jsxs(O,{onClick:()=>xe(E.url,j),size:"sm",className:"w-full mt-2",disabled:!j,children:[a.jsx(Nu,{className:"mr-2 h-4 w-4"})," Add Edited to Timeline"]})]})]}),a.jsxs(Vt,{value:"upload",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(De,{htmlFor:"file-upload",className:"text-lg font-semibold",children:"Upload Image or Video"}),a.jsx(Ye,{id:"file-upload",type:"file",accept:"image/*,video/*",onChange:fe,className:"mt-2",disabled:Q}),Q&&a.jsxs("div",{className:"mt-2 flex items-center text-sm text-muted-foreground",children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"})," Processing..."]}),B&&B.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[B.type==="image"?a.jsx("img",{src:B.url,alt:"Uploaded content",className:"w-full rounded-md object-contain max-h-96"}):a.jsx("video",{src:B.url,controls:!0,className:"w-full rounded-md max-h-96",children:"Your browser does not support the video tag."}),a.jsx(De,{className:"text-sm font-medium",children:"Choose a caption for the uploaded content:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(B.captions||[]).map((he,Ce)=>a.jsx(O,{variant:j===he?"default":"outline",size:"sm",onClick:()=>D(he),className:"text-xs",children:he},Ce))}),a.jsxs(O,{onClick:()=>xe(B.url,j,B.type),size:"sm",className:"w-full mt-2",disabled:!j,children:[a.jsx(Nu,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]})]})}),a.jsx("div",{className:"lg:col-span-2 space-y-6",children:a.jsxs("div",{className:"p-4 md:p-6 border rounded-lg bg-card shadow min-h-[400px]",children:[a.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Content Timeline"}),a.jsx(xs,{className:"h-[calc(100vh-350px)] min-h-[300px] pr-3",children:P.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[a.jsx(F3,{className:"h-12 w-12 mb-3"}),a.jsx("p",{children:"Your timeline is empty."}),a.jsx("p",{className:"text-sm",children:"Generate or upload content to get started."})]}):a.jsx(Sc,{children:P.map((he,Ce)=>a.jsxs(It.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-50},transition:{type:"spring",stiffness:300,damping:30},className:"mb-3 p-3 border rounded-md flex items-start gap-3 hover:shadow-md transition-shadow bg-background cursor-pointer",onClick:()=>V(he),children:[a.jsxs("div",{className:"w-24 h-24 flex-shrink-0 relative rounded overflow-hidden group bg-muted",children:[he.isVideo?a.jsx("video",{src:he.url,className:"w-full h-full object-cover",controls:!1,muted:!0,loop:!0,onMouseOver:Pe=>Pe.target.play(),onMouseOut:Pe=>Pe.target.pause()}):a.jsx("img",{src:he.url,alt:he.caption,className:"w-full h-full object-cover"}),!he.isVideo&&a.jsx(O,{size:"icon",variant:"secondary",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Pe=>{Pe.stopPropagation(),Ue(he,Ce)},disabled:M,title:"Convert to Veo Video",children:M?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(DI,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"outline",className:"absolute bottom-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Pe=>{Pe.stopPropagation(),T(he),n("image-edit")},disabled:he.isVideo,title:"Edit this image",children:a.jsx(tw,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:`text-xs font-semibold px-1.5 py-0.5 rounded-sm ${he.isVideo?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:[he.isVideo?"Video":"Image"," ",Ce+1]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(O,{size:"icon",variant:"ghost",onClick:Pe=>{Pe.stopPropagation(),ge(Ce,-1)},disabled:Ce===0,className:"h-7 w-7",children:a.jsx(B3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Pe=>{Pe.stopPropagation(),ge(Ce,1)},disabled:Ce===P.length-1,className:"h-7 w-7",children:a.jsx(U3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Pe=>{Pe.stopPropagation(),ze(he.id)},className:"h-7 w-7",children:a.jsx(z3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Pe=>{Pe.stopPropagation(),Re(he.id)},className:"h-7 w-7 text-destructive",children:a.jsx(Wn,{className:"h-4 w-4"})})]})]}),a.jsx("p",{className:"text-sm mt-1 text-muted-foreground line-clamp-3",title:he.caption,children:he.caption})]})]},he.id))})}),P.length>0&&a.jsx(Ui,{className:"my-4"}),Y&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Media Viewer"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(O,{variant:"outline",size:"sm",onClick:$,children:[a.jsx(jI,{className:"mr-2 h-4 w-4"}),"Download"]}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>V(null),children:a.jsx(Ki,{className:"h-5 w-5"})})]})]}),Y.type==="image"||!Y.isVideo?a.jsx("img",{src:Y.url,alt:Y.caption||"Viewing media",className:"w-full max-h-[60vh] rounded-md object-contain border"}):a.jsx("video",{src:Y.url,controls:!0,className:"w-full max-h-[60vh] rounded-md border bg-black",children:"Your browser does not support the video tag."}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:Y.caption})]})]})})]})]})},dje=()=>a.jsx(nIe,{}),hje=()=>{const{isAuthenticated:t,loadingProfile:e}=eo();return e?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("p",{className:"text-xl",children:"Loading..."})}):t?a.jsx(M$,{to:"/",replace:!0}):a.jsx(WRe,{})},fje=[{element:a.jsxs(d_e,{children:[a.jsx(JRe,{})," "]}),children:[{index:!0,element:a.jsx(dje,{})},{path:"auth",element:a.jsx(hje,{})},{path:"pricing",element:a.jsx(HRe,{})},{path:"designer",element:a.jsx(aje,{})},{path:"music",element:a.jsx(lje,{})},{path:"podcast",element:a.jsx(cje,{})},{path:"video",element:a.jsx(uje,{})},{path:":storeName",element:a.jsx(ERe,{})},{path:":storeName/product/:productId",element:a.jsx($Re,{})},{path:"checkout",element:a.jsx(BRe,{})},{path:"order-confirmation",element:a.jsx(KRe,{})},{path:":storeName/content-creation",element:a.jsx(xEe,{})},{path:":storeName/dashboard",element:a.jsx(ije,{})},{path:"*",element:a.jsx(M$,{to:"/",replace:!0})}]}],mje=!0,pje=!0,gje=NX(fje,{future:{v7_startTransition:mje,v7_relativeSplatPath:pje}}),wv=document.getElementById("root");wv._reactRoot||(wv._reactRoot=gC.createRoot(wv));const oO=wv._reactRoot;try{oO.render(a.jsx(ht.StrictMode,{children:a.jsx(FX,{router:gje})}))}catch(t){console.error("Application initialization failed:",t);let e="Application failed to load. Please check the console for details.";t.message.includes("VITE_")&&t.message.includes("is not set")&&(e=`Configuration Error: ${t.message}. Please ensure all required environment variables are correctly set in your .env file and the application is rebuilt if necessary.`),oO.render(a.jsx(ht.StrictMode,{children:a.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",fontFamily:"sans-serif"},children:[a.jsx("h1",{children:"Application Load Error"}),a.jsx("p",{children:e}),a.jsxs("p",{children:["Please check your ",a.jsx("code",{children:".env"})," file and ensure all necessary environment variables are configured."]})]})}))}export{pg as $,Sc as A,O as B,Je as C,Wn as D,Lie as E,PE as F,Y_ as G,O3 as H,Yn as I,kE as J,$3 as K,sr as L,dh as M,Lu as N,XI as O,C2 as P,the as Q,ht as R,Er as S,tm as T,wi as U,dw as V,hs as W,Ki as X,Ja as Y,q3 as Z,kg as _,Phe as a,soe as a0,DI as a1,L0 as a2,ya as a3,Hie as a4,Qie as a5,Wie as a6,Pie as a7,Fie as a8,ooe as a9,wRe as aA,SRe as aB,Ig as aC,toe as aD,gl as aE,il as aF,F3 as aG,Uo as aH,Pn as aI,$a as aJ,ft as aK,Vi as aL,cg as aM,W0 as aN,Wo as aO,$ie as aP,Qv as aQ,Bie as aR,Gx as aa,loe as ab,zie as ac,roe as ad,_2 as ae,bi as af,Oo as ag,xs as ah,Xr as ai,Ur as aj,Br as ak,zr as al,Zi as am,Si as an,ti as ao,Ot as ap,Vt as aq,De as ar,Ar as as,$ae as at,Sq as au,W3 as av,Rhe as aw,Oi as ax,Xie as ay,Ca as az,vS as b,MI as c,Mu as d,xRe as e,Oa as f,it as g,yd as h,Up as i,a as j,ew as k,t1e as l,It as m,ic as n,pc as o,qe as p,nw as q,p as r,Do as s,Aie as t,zn as u,yRe as v,Ct as w,bs as x,Ye as y,Nu as z};
