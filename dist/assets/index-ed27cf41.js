function SF(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Zx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Lw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var EF={exports:{}},Fw={},CF={exports:{}},un={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yp=Symbol.for("react.element"),aq=Symbol.for("react.portal"),lq=Symbol.for("react.fragment"),cq=Symbol.for("react.strict_mode"),uq=Symbol.for("react.profiler"),dq=Symbol.for("react.provider"),hq=Symbol.for("react.context"),fq=Symbol.for("react.forward_ref"),mq=Symbol.for("react.suspense"),pq=Symbol.for("react.memo"),gq=Symbol.for("react.lazy"),QA=Symbol.iterator;function yq(t){return t===null||typeof t!="object"?null:(t=QA&&t[QA]||t["@@iterator"],typeof t=="function"?t:null)}var TF={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},IF=Object.assign,NF={};function Qh(t,e,n){this.props=t,this.context=e,this.refs=NF,this.updater=n||TF}Qh.prototype.isReactComponent={};Qh.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Qh.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function PF(){}PF.prototype=Qh.prototype;function VT(t,e,n){this.props=t,this.context=e,this.refs=NF,this.updater=n||TF}var UT=VT.prototype=new PF;UT.constructor=VT;IF(UT,Qh.prototype);UT.isPureReactComponent=!0;var ZA=Array.isArray,AF=Object.prototype.hasOwnProperty,BT={current:null},kF={key:!0,ref:!0,__self:!0,__source:!0};function RF(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)AF.call(e,r)&&!kF.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Yp,type:t,key:i,ref:o,props:s,_owner:BT.current}}function xq(t,e){return{$$typeof:Yp,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function zT(t){return typeof t=="object"&&t!==null&&t.$$typeof===Yp}function vq(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ek=/\/+/g;function qb(t,e){return typeof t=="object"&&t!==null&&t.key!=null?vq(""+t.key):e.toString(36)}function ax(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Yp:case aq:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+qb(o,0):r,ZA(s)?(n="",t!=null&&(n=t.replace(ek,"$&/")+"/"),ax(s,e,n,"",function(u){return u})):s!=null&&(zT(s)&&(s=xq(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(ek,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",ZA(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+qb(i,l);o+=ax(i,e,n,c,s)}else if(c=yq(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+qb(i,l++),o+=ax(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Jg(t,e,n){if(t==null)return t;var r=[],s=0;return ax(t,r,"","",function(i){return e.call(n,i,s++)}),r}function wq(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ws={current:null},lx={transition:null},bq={ReactCurrentDispatcher:Ws,ReactCurrentBatchConfig:lx,ReactCurrentOwner:BT};function jF(){throw Error("act(...) is not supported in production builds of React.")}un.Children={map:Jg,forEach:function(t,e,n){Jg(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Jg(t,function(){e++}),e},toArray:function(t){return Jg(t,function(e){return e})||[]},only:function(t){if(!zT(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};un.Component=Qh;un.Fragment=lq;un.Profiler=uq;un.PureComponent=VT;un.StrictMode=cq;un.Suspense=mq;un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bq;un.act=jF;un.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=IF({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=BT.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)AF.call(e,c)&&!kF.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Yp,type:t.type,key:s,ref:i,props:r,_owner:o}};un.createContext=function(t){return t={$$typeof:hq,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:dq,_context:t},t.Consumer=t};un.createElement=RF;un.createFactory=function(t){var e=RF.bind(null,t);return e.type=t,e};un.createRef=function(){return{current:null}};un.forwardRef=function(t){return{$$typeof:fq,render:t}};un.isValidElement=zT;un.lazy=function(t){return{$$typeof:gq,_payload:{_status:-1,_result:t},_init:wq}};un.memo=function(t,e){return{$$typeof:pq,type:t,compare:e===void 0?null:e}};un.startTransition=function(t){var e=lx.transition;lx.transition={};try{t()}finally{lx.transition=e}};un.unstable_act=jF;un.useCallback=function(t,e){return Ws.current.useCallback(t,e)};un.useContext=function(t){return Ws.current.useContext(t)};un.useDebugValue=function(){};un.useDeferredValue=function(t){return Ws.current.useDeferredValue(t)};un.useEffect=function(t,e){return Ws.current.useEffect(t,e)};un.useId=function(){return Ws.current.useId()};un.useImperativeHandle=function(t,e,n){return Ws.current.useImperativeHandle(t,e,n)};un.useInsertionEffect=function(t,e){return Ws.current.useInsertionEffect(t,e)};un.useLayoutEffect=function(t,e){return Ws.current.useLayoutEffect(t,e)};un.useMemo=function(t,e){return Ws.current.useMemo(t,e)};un.useReducer=function(t,e,n){return Ws.current.useReducer(t,e,n)};un.useRef=function(t){return Ws.current.useRef(t)};un.useState=function(t){return Ws.current.useState(t)};un.useSyncExternalStore=function(t,e,n){return Ws.current.useSyncExternalStore(t,e,n)};un.useTransition=function(){return Ws.current.useTransition()};un.version="18.3.1";CF.exports=un;var p=CF.exports;const ht=Lw(p),Ow=SF({__proto__:null,default:ht},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _q=p,Sq=Symbol.for("react.element"),Eq=Symbol.for("react.fragment"),Cq=Object.prototype.hasOwnProperty,Tq=_q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Iq={key:!0,ref:!0,__self:!0,__source:!0};function DF(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Cq.call(e,r)&&!Iq.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Sq,type:t,key:i,ref:o,props:s,_owner:Tq.current}}Fw.Fragment=Eq;Fw.jsx=DF;Fw.jsxs=DF;EF.exports=Fw;var a=EF.exports,GS={},MF={exports:{}},Di={},LF={exports:{}},FF={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,J){var O=$.length;$.push(J);e:for(;0<O;){var V=O-1>>>1,G=$[V];if(0<s(G,J))$[V]=J,$[O]=G,O=V;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var J=$[0],O=$.pop();if(O!==J){$[0]=O;e:for(var V=0,G=$.length,F=G>>>1;V<F;){var ue=2*(V+1)-1,Ee=$[ue],Se=ue+1,we=$[Se];if(0>s(Ee,O))Se<G&&0>s(we,Ee)?($[V]=we,$[Se]=O,V=Se):($[V]=Ee,$[ue]=O,V=ue);else if(Se<G&&0>s(we,O))$[V]=we,$[Se]=O,V=Se;else break e}}return J}function s($,J){var O=$.sortIndex-J.sortIndex;return O!==0?O:$.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,g=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S($){for(var J=n(u);J!==null;){if(J.callback===null)r(u);else if(J.startTime<=$)r(u),J.sortIndex=J.expirationTime,e(c,J);else break;J=n(u)}}function I($){if(x=!1,S($),!g)if(n(c)!==null)g=!0,q(D);else{var J=n(u);J!==null&&H(I,J.startTime-$)}}function D($,J){g=!1,x&&(x=!1,v(T),T=-1),m=!0;var O=f;try{for(S(J),h=n(c);h!==null&&(!(h.expirationTime>J)||$&&!R());){var V=h.callback;if(typeof V=="function"){h.callback=null,f=h.priorityLevel;var G=V(h.expirationTime<=J);J=t.unstable_now(),typeof G=="function"?h.callback=G:h===n(c)&&r(c),S(J)}else r(c);h=n(c)}if(h!==null)var F=!0;else{var ue=n(u);ue!==null&&H(I,ue.startTime-J),F=!1}return F}finally{h=null,f=O,m=!1}}var k=!1,C=null,T=-1,P=5,A=-1;function R(){return!(t.unstable_now()-A<P)}function M(){if(C!==null){var $=t.unstable_now();A=$;var J=!0;try{J=C(!0,$)}finally{J?j():(k=!1,C=null)}}else k=!1}var j;if(typeof b=="function")j=function(){b(M)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,W=z.port2;z.port1.onmessage=M,j=function(){W.postMessage(null)}}else j=function(){E(M,0)};function q($){C=$,k||(k=!0,j())}function H($,J){T=E(function(){$(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,q(D))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function($){switch(f){case 1:case 2:case 3:var J=3;break;default:J=f}var O=f;f=J;try{return $()}finally{f=O}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,J){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var O=f;f=$;try{return J()}finally{f=O}},t.unstable_scheduleCallback=function($,J,O){var V=t.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?V+O:V):O=V,$){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=O+G,$={id:d++,callback:J,priorityLevel:$,startTime:O,expirationTime:G,sortIndex:-1},O>V?($.sortIndex=O,e(u,$),n(c)===null&&$===n(u)&&(x?(v(T),T=-1):x=!0,H(I,O-V))):($.sortIndex=G,e(c,$),g||m||(g=!0,q(D))),$},t.unstable_shouldYield=R,t.unstable_wrapCallback=function($){var J=f;return function(){var O=f;f=J;try{return $.apply(this,arguments)}finally{f=O}}}})(FF);LF.exports=FF;var Nq=LF.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pq=p,ki=Nq;function He(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var OF=new Set,Zm={};function $u(t,e){bh(t,e),bh(t+"Capture",e)}function bh(t,e){for(Zm[t]=e,t=0;t<e.length;t++)OF.add(e[t])}var Na=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),WS=Object.prototype.hasOwnProperty,Aq=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,tk={},nk={};function kq(t){return WS.call(nk,t)?!0:WS.call(tk,t)?!1:Aq.test(t)?nk[t]=!0:(tk[t]=!0,!1)}function Rq(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function jq(t,e,n,r){if(e===null||typeof e>"u"||Rq(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Hs(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var as={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){as[t]=new Hs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];as[e]=new Hs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){as[t]=new Hs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){as[t]=new Hs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){as[t]=new Hs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){as[t]=new Hs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){as[t]=new Hs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){as[t]=new Hs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){as[t]=new Hs(t,5,!1,t.toLowerCase(),null,!1,!1)});var GT=/[\-:]([a-z])/g;function WT(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(GT,WT);as[e]=new Hs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(GT,WT);as[e]=new Hs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(GT,WT);as[e]=new Hs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){as[t]=new Hs(t,1,!1,t.toLowerCase(),null,!1,!1)});as.xlinkHref=new Hs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){as[t]=new Hs(t,1,!1,t.toLowerCase(),null,!0,!0)});function HT(t,e,n,r){var s=as.hasOwnProperty(e)?as[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(jq(e,n,s,r)&&(n=null),r||s===null?kq(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ga=Pq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xg=Symbol.for("react.element"),kd=Symbol.for("react.portal"),Rd=Symbol.for("react.fragment"),qT=Symbol.for("react.strict_mode"),HS=Symbol.for("react.profiler"),$F=Symbol.for("react.provider"),VF=Symbol.for("react.context"),KT=Symbol.for("react.forward_ref"),qS=Symbol.for("react.suspense"),KS=Symbol.for("react.suspense_list"),YT=Symbol.for("react.memo"),ml=Symbol.for("react.lazy"),UF=Symbol.for("react.offscreen"),rk=Symbol.iterator;function _f(t){return t===null||typeof t!="object"?null:(t=rk&&t[rk]||t["@@iterator"],typeof t=="function"?t:null)}var ur=Object.assign,Kb;function Xf(t){if(Kb===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Kb=e&&e[1]||""}return`
`+Kb+t}var Yb=!1;function Jb(t,e){if(!t||Yb)return"";Yb=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Yb=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xf(t):""}function Dq(t){switch(t.tag){case 5:return Xf(t.type);case 16:return Xf("Lazy");case 13:return Xf("Suspense");case 19:return Xf("SuspenseList");case 0:case 2:case 15:return t=Jb(t.type,!1),t;case 11:return t=Jb(t.type.render,!1),t;case 1:return t=Jb(t.type,!0),t;default:return""}}function YS(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Rd:return"Fragment";case kd:return"Portal";case HS:return"Profiler";case qT:return"StrictMode";case qS:return"Suspense";case KS:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case VF:return(t.displayName||"Context")+".Consumer";case $F:return(t._context.displayName||"Context")+".Provider";case KT:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case YT:return e=t.displayName||null,e!==null?e:YS(t.type)||"Memo";case ml:e=t._payload,t=t._init;try{return YS(t(e))}catch{}}return null}function Mq(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return YS(e);case 8:return e===qT?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Yl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function BF(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Lq(t){var e=BF(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Qg(t){t._valueTracker||(t._valueTracker=Lq(t))}function zF(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=BF(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ev(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function JS(t,e){var n=e.checked;return ur({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function sk(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Yl(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function GF(t,e){e=e.checked,e!=null&&HT(t,"checked",e,!1)}function XS(t,e){GF(t,e);var n=Yl(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?QS(t,e.type,n):e.hasOwnProperty("defaultValue")&&QS(t,e.type,Yl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ik(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function QS(t,e,n){(e!=="number"||ev(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Qf=Array.isArray;function nh(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Yl(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function ZS(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(He(91));return ur({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ok(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(He(92));if(Qf(n)){if(1<n.length)throw Error(He(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Yl(n)}}function WF(t,e){var n=Yl(e.value),r=Yl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function ak(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function HF(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function eE(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?HF(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Zg,qF=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Zg=Zg||document.createElement("div"),Zg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Zg.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ep(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ym={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Fq=["Webkit","ms","Moz","O"];Object.keys(ym).forEach(function(t){Fq.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ym[e]=ym[t]})});function KF(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ym.hasOwnProperty(t)&&ym[t]?(""+e).trim():e+"px"}function YF(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=KF(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Oq=ur({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tE(t,e){if(e){if(Oq[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(He(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(He(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(He(61))}if(e.style!=null&&typeof e.style!="object")throw Error(He(62))}}function nE(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rE=null;function JT(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var sE=null,rh=null,sh=null;function lk(t){if(t=Qp(t)){if(typeof sE!="function")throw Error(He(280));var e=t.stateNode;e&&(e=zw(e),sE(t.stateNode,t.type,e))}}function JF(t){rh?sh?sh.push(t):sh=[t]:rh=t}function XF(){if(rh){var t=rh,e=sh;if(sh=rh=null,lk(t),e)for(t=0;t<e.length;t++)lk(e[t])}}function QF(t,e){return t(e)}function ZF(){}var Xb=!1;function eO(t,e,n){if(Xb)return t(e,n);Xb=!0;try{return QF(t,e,n)}finally{Xb=!1,(rh!==null||sh!==null)&&(ZF(),XF())}}function tp(t,e){var n=t.stateNode;if(n===null)return null;var r=zw(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(He(231,e,typeof n));return n}var iE=!1;if(Na)try{var Sf={};Object.defineProperty(Sf,"passive",{get:function(){iE=!0}}),window.addEventListener("test",Sf,Sf),window.removeEventListener("test",Sf,Sf)}catch{iE=!1}function $q(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var xm=!1,tv=null,nv=!1,oE=null,Vq={onError:function(t){xm=!0,tv=t}};function Uq(t,e,n,r,s,i,o,l,c){xm=!1,tv=null,$q.apply(Vq,arguments)}function Bq(t,e,n,r,s,i,o,l,c){if(Uq.apply(this,arguments),xm){if(xm){var u=tv;xm=!1,tv=null}else throw Error(He(198));nv||(nv=!0,oE=u)}}function Vu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function tO(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ck(t){if(Vu(t)!==t)throw Error(He(188))}function zq(t){var e=t.alternate;if(!e){if(e=Vu(t),e===null)throw Error(He(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return ck(s),t;if(i===r)return ck(s),e;i=i.sibling}throw Error(He(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(He(189))}}if(n.alternate!==r)throw Error(He(190))}if(n.tag!==3)throw Error(He(188));return n.stateNode.current===n?t:e}function nO(t){return t=zq(t),t!==null?rO(t):null}function rO(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=rO(t);if(e!==null)return e;t=t.sibling}return null}var sO=ki.unstable_scheduleCallback,uk=ki.unstable_cancelCallback,Gq=ki.unstable_shouldYield,Wq=ki.unstable_requestPaint,Ir=ki.unstable_now,Hq=ki.unstable_getCurrentPriorityLevel,XT=ki.unstable_ImmediatePriority,iO=ki.unstable_UserBlockingPriority,rv=ki.unstable_NormalPriority,qq=ki.unstable_LowPriority,oO=ki.unstable_IdlePriority,$w=null,qo=null;function Kq(t){if(qo&&typeof qo.onCommitFiberRoot=="function")try{qo.onCommitFiberRoot($w,t,void 0,(t.current.flags&128)===128)}catch{}}var wo=Math.clz32?Math.clz32:Xq,Yq=Math.log,Jq=Math.LN2;function Xq(t){return t>>>=0,t===0?32:31-(Yq(t)/Jq|0)|0}var ey=64,ty=4194304;function Zf(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function sv(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Zf(l):(i&=o,i!==0&&(r=Zf(i)))}else o=n&~s,o!==0?r=Zf(o):i!==0&&(r=Zf(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-wo(e),s=1<<n,r|=t[n],e&=~s;return r}function Qq(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zq(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-wo(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=Qq(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function aE(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function aO(){var t=ey;return ey<<=1,!(ey&4194240)&&(ey=64),t}function Qb(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Jp(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-wo(e),t[e]=n}function eK(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-wo(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function QT(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-wo(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var kn=0;function lO(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var cO,ZT,uO,dO,hO,lE=!1,ny=[],Nl=null,Pl=null,Al=null,np=new Map,rp=new Map,yl=[],tK="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dk(t,e){switch(t){case"focusin":case"focusout":Nl=null;break;case"dragenter":case"dragleave":Pl=null;break;case"mouseover":case"mouseout":Al=null;break;case"pointerover":case"pointerout":np.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":rp.delete(e.pointerId)}}function Ef(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Qp(e),e!==null&&ZT(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function nK(t,e,n,r,s){switch(e){case"focusin":return Nl=Ef(Nl,t,e,n,r,s),!0;case"dragenter":return Pl=Ef(Pl,t,e,n,r,s),!0;case"mouseover":return Al=Ef(Al,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return np.set(i,Ef(np.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,rp.set(i,Ef(rp.get(i)||null,t,e,n,r,s)),!0}return!1}function fO(t){var e=Xc(t.target);if(e!==null){var n=Vu(e);if(n!==null){if(e=n.tag,e===13){if(e=tO(n),e!==null){t.blockedOn=e,hO(t.priority,function(){uO(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function cx(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=cE(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);rE=r,n.target.dispatchEvent(r),rE=null}else return e=Qp(n),e!==null&&ZT(e),t.blockedOn=n,!1;e.shift()}return!0}function hk(t,e,n){cx(t)&&n.delete(e)}function rK(){lE=!1,Nl!==null&&cx(Nl)&&(Nl=null),Pl!==null&&cx(Pl)&&(Pl=null),Al!==null&&cx(Al)&&(Al=null),np.forEach(hk),rp.forEach(hk)}function Cf(t,e){t.blockedOn===e&&(t.blockedOn=null,lE||(lE=!0,ki.unstable_scheduleCallback(ki.unstable_NormalPriority,rK)))}function sp(t){function e(s){return Cf(s,t)}if(0<ny.length){Cf(ny[0],t);for(var n=1;n<ny.length;n++){var r=ny[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Nl!==null&&Cf(Nl,t),Pl!==null&&Cf(Pl,t),Al!==null&&Cf(Al,t),np.forEach(e),rp.forEach(e),n=0;n<yl.length;n++)r=yl[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<yl.length&&(n=yl[0],n.blockedOn===null);)fO(n),n.blockedOn===null&&yl.shift()}var ih=Ga.ReactCurrentBatchConfig,iv=!0;function sK(t,e,n,r){var s=kn,i=ih.transition;ih.transition=null;try{kn=1,e1(t,e,n,r)}finally{kn=s,ih.transition=i}}function iK(t,e,n,r){var s=kn,i=ih.transition;ih.transition=null;try{kn=4,e1(t,e,n,r)}finally{kn=s,ih.transition=i}}function e1(t,e,n,r){if(iv){var s=cE(t,e,n,r);if(s===null)l_(t,e,r,ov,n),dk(t,r);else if(nK(s,t,e,n,r))r.stopPropagation();else if(dk(t,r),e&4&&-1<tK.indexOf(t)){for(;s!==null;){var i=Qp(s);if(i!==null&&cO(i),i=cE(t,e,n,r),i===null&&l_(t,e,r,ov,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else l_(t,e,r,null,n)}}var ov=null;function cE(t,e,n,r){if(ov=null,t=JT(r),t=Xc(t),t!==null)if(e=Vu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=tO(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ov=t,null}function mO(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hq()){case XT:return 1;case iO:return 4;case rv:case qq:return 16;case oO:return 536870912;default:return 16}default:return 16}}var El=null,t1=null,ux=null;function pO(){if(ux)return ux;var t,e=t1,n=e.length,r,s="value"in El?El.value:El.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return ux=s.slice(t,1<r?1-r:void 0)}function dx(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ry(){return!0}function fk(){return!1}function Mi(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ry:fk,this.isPropagationStopped=fk,this}return ur(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ry)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ry)},persist:function(){},isPersistent:ry}),e}var Zh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},n1=Mi(Zh),Xp=ur({},Zh,{view:0,detail:0}),oK=Mi(Xp),Zb,e_,Tf,Vw=ur({},Xp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:r1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Tf&&(Tf&&t.type==="mousemove"?(Zb=t.screenX-Tf.screenX,e_=t.screenY-Tf.screenY):e_=Zb=0,Tf=t),Zb)},movementY:function(t){return"movementY"in t?t.movementY:e_}}),mk=Mi(Vw),aK=ur({},Vw,{dataTransfer:0}),lK=Mi(aK),cK=ur({},Xp,{relatedTarget:0}),t_=Mi(cK),uK=ur({},Zh,{animationName:0,elapsedTime:0,pseudoElement:0}),dK=Mi(uK),hK=ur({},Zh,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),fK=Mi(hK),mK=ur({},Zh,{data:0}),pk=Mi(mK),pK={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gK={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yK={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xK(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=yK[t])?!!e[t]:!1}function r1(){return xK}var vK=ur({},Xp,{key:function(t){if(t.key){var e=pK[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=dx(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?gK[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:r1,charCode:function(t){return t.type==="keypress"?dx(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?dx(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),wK=Mi(vK),bK=ur({},Vw,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gk=Mi(bK),_K=ur({},Xp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:r1}),SK=Mi(_K),EK=ur({},Zh,{propertyName:0,elapsedTime:0,pseudoElement:0}),CK=Mi(EK),TK=ur({},Vw,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),IK=Mi(TK),NK=[9,13,27,32],s1=Na&&"CompositionEvent"in window,vm=null;Na&&"documentMode"in document&&(vm=document.documentMode);var PK=Na&&"TextEvent"in window&&!vm,gO=Na&&(!s1||vm&&8<vm&&11>=vm),yk=String.fromCharCode(32),xk=!1;function yO(t,e){switch(t){case"keyup":return NK.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xO(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var jd=!1;function AK(t,e){switch(t){case"compositionend":return xO(e);case"keypress":return e.which!==32?null:(xk=!0,yk);case"textInput":return t=e.data,t===yk&&xk?null:t;default:return null}}function kK(t,e){if(jd)return t==="compositionend"||!s1&&yO(t,e)?(t=pO(),ux=t1=El=null,jd=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return gO&&e.locale!=="ko"?null:e.data;default:return null}}var RK={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!RK[t.type]:e==="textarea"}function vO(t,e,n,r){JF(r),e=av(e,"onChange"),0<e.length&&(n=new n1("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var wm=null,ip=null;function jK(t){AO(t,0)}function Uw(t){var e=Ld(t);if(zF(e))return t}function DK(t,e){if(t==="change")return e}var wO=!1;if(Na){var n_;if(Na){var r_="oninput"in document;if(!r_){var wk=document.createElement("div");wk.setAttribute("oninput","return;"),r_=typeof wk.oninput=="function"}n_=r_}else n_=!1;wO=n_&&(!document.documentMode||9<document.documentMode)}function bk(){wm&&(wm.detachEvent("onpropertychange",bO),ip=wm=null)}function bO(t){if(t.propertyName==="value"&&Uw(ip)){var e=[];vO(e,ip,t,JT(t)),eO(jK,e)}}function MK(t,e,n){t==="focusin"?(bk(),wm=e,ip=n,wm.attachEvent("onpropertychange",bO)):t==="focusout"&&bk()}function LK(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Uw(ip)}function FK(t,e){if(t==="click")return Uw(e)}function OK(t,e){if(t==="input"||t==="change")return Uw(e)}function $K(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var So=typeof Object.is=="function"?Object.is:$K;function op(t,e){if(So(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!WS.call(e,s)||!So(t[s],e[s]))return!1}return!0}function _k(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Sk(t,e){var n=_k(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_k(n)}}function _O(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?_O(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function SO(){for(var t=window,e=ev();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ev(t.document)}return e}function i1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function VK(t){var e=SO(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&_O(n.ownerDocument.documentElement,n)){if(r!==null&&i1(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Sk(n,i);var o=Sk(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var UK=Na&&"documentMode"in document&&11>=document.documentMode,Dd=null,uE=null,bm=null,dE=!1;function Ek(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;dE||Dd==null||Dd!==ev(r)||(r=Dd,"selectionStart"in r&&i1(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),bm&&op(bm,r)||(bm=r,r=av(uE,"onSelect"),0<r.length&&(e=new n1("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Dd)))}function sy(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Md={animationend:sy("Animation","AnimationEnd"),animationiteration:sy("Animation","AnimationIteration"),animationstart:sy("Animation","AnimationStart"),transitionend:sy("Transition","TransitionEnd")},s_={},EO={};Na&&(EO=document.createElement("div").style,"AnimationEvent"in window||(delete Md.animationend.animation,delete Md.animationiteration.animation,delete Md.animationstart.animation),"TransitionEvent"in window||delete Md.transitionend.transition);function Bw(t){if(s_[t])return s_[t];if(!Md[t])return t;var e=Md[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in EO)return s_[t]=e[n];return t}var CO=Bw("animationend"),TO=Bw("animationiteration"),IO=Bw("animationstart"),NO=Bw("transitionend"),PO=new Map,Ck="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function lc(t,e){PO.set(t,e),$u(e,[t])}for(var i_=0;i_<Ck.length;i_++){var o_=Ck[i_],BK=o_.toLowerCase(),zK=o_[0].toUpperCase()+o_.slice(1);lc(BK,"on"+zK)}lc(CO,"onAnimationEnd");lc(TO,"onAnimationIteration");lc(IO,"onAnimationStart");lc("dblclick","onDoubleClick");lc("focusin","onFocus");lc("focusout","onBlur");lc(NO,"onTransitionEnd");bh("onMouseEnter",["mouseout","mouseover"]);bh("onMouseLeave",["mouseout","mouseover"]);bh("onPointerEnter",["pointerout","pointerover"]);bh("onPointerLeave",["pointerout","pointerover"]);$u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$u("onBeforeInput",["compositionend","keypress","textInput","paste"]);$u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var em="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GK=new Set("cancel close invalid load scroll toggle".split(" ").concat(em));function Tk(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Bq(r,e,void 0,t),t.currentTarget=null}function AO(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;Tk(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;Tk(s,l,u),i=c}}}if(nv)throw t=oE,nv=!1,oE=null,t}function Hn(t,e){var n=e[gE];n===void 0&&(n=e[gE]=new Set);var r=t+"__bubble";n.has(r)||(kO(e,t,2,!1),n.add(r))}function a_(t,e,n){var r=0;e&&(r|=4),kO(n,t,r,e)}var iy="_reactListening"+Math.random().toString(36).slice(2);function ap(t){if(!t[iy]){t[iy]=!0,OF.forEach(function(n){n!=="selectionchange"&&(GK.has(n)||a_(n,!1,t),a_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[iy]||(e[iy]=!0,a_("selectionchange",!1,e))}}function kO(t,e,n,r){switch(mO(e)){case 1:var s=sK;break;case 4:s=iK;break;default:s=e1}n=s.bind(null,e,n,t),s=void 0,!iE||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function l_(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Xc(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}eO(function(){var u=i,d=JT(n),h=[];e:{var f=PO.get(t);if(f!==void 0){var m=n1,g=t;switch(t){case"keypress":if(dx(n)===0)break e;case"keydown":case"keyup":m=wK;break;case"focusin":g="focus",m=t_;break;case"focusout":g="blur",m=t_;break;case"beforeblur":case"afterblur":m=t_;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=mk;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=lK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=SK;break;case CO:case TO:case IO:m=dK;break;case NO:m=CK;break;case"scroll":m=oK;break;case"wheel":m=IK;break;case"copy":case"cut":case"paste":m=fK;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=gk}var x=(e&4)!==0,E=!x&&t==="scroll",v=x?f!==null?f+"Capture":null:f;x=[];for(var b=u,S;b!==null;){S=b;var I=S.stateNode;if(S.tag===5&&I!==null&&(S=I,v!==null&&(I=tp(b,v),I!=null&&x.push(lp(b,I,S)))),E)break;b=b.return}0<x.length&&(f=new m(f,g,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==rE&&(g=n.relatedTarget||n.fromElement)&&(Xc(g)||g[Pa]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(g=n.relatedTarget||n.toElement,m=u,g=g?Xc(g):null,g!==null&&(E=Vu(g),g!==E||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(x=mk,I="onMouseLeave",v="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(x=gk,I="onPointerLeave",v="onPointerEnter",b="pointer"),E=m==null?f:Ld(m),S=g==null?f:Ld(g),f=new x(I,b+"leave",m,n,d),f.target=E,f.relatedTarget=S,I=null,Xc(d)===u&&(x=new x(v,b+"enter",g,n,d),x.target=S,x.relatedTarget=E,I=x),E=I,m&&g)t:{for(x=m,v=g,b=0,S=x;S;S=sd(S))b++;for(S=0,I=v;I;I=sd(I))S++;for(;0<b-S;)x=sd(x),b--;for(;0<S-b;)v=sd(v),S--;for(;b--;){if(x===v||v!==null&&x===v.alternate)break t;x=sd(x),v=sd(v)}x=null}else x=null;m!==null&&Ik(h,f,m,x,!1),g!==null&&E!==null&&Ik(h,E,g,x,!0)}}e:{if(f=u?Ld(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var D=DK;else if(vk(f))if(wO)D=OK;else{D=LK;var k=MK}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(D=FK);if(D&&(D=D(t,u))){vO(h,D,n,d);break e}k&&k(t,f,u),t==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&QS(f,"number",f.value)}switch(k=u?Ld(u):window,t){case"focusin":(vk(k)||k.contentEditable==="true")&&(Dd=k,uE=u,bm=null);break;case"focusout":bm=uE=Dd=null;break;case"mousedown":dE=!0;break;case"contextmenu":case"mouseup":case"dragend":dE=!1,Ek(h,n,d);break;case"selectionchange":if(UK)break;case"keydown":case"keyup":Ek(h,n,d)}var C;if(s1)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else jd?yO(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(gO&&n.locale!=="ko"&&(jd||T!=="onCompositionStart"?T==="onCompositionEnd"&&jd&&(C=pO()):(El=d,t1="value"in El?El.value:El.textContent,jd=!0)),k=av(u,T),0<k.length&&(T=new pk(T,t,null,n,d),h.push({event:T,listeners:k}),C?T.data=C:(C=xO(n),C!==null&&(T.data=C)))),(C=PK?AK(t,n):kK(t,n))&&(u=av(u,"onBeforeInput"),0<u.length&&(d=new pk("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=C))}AO(h,e)})}function lp(t,e,n){return{instance:t,listener:e,currentTarget:n}}function av(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=tp(t,n),i!=null&&r.unshift(lp(t,i,s)),i=tp(t,e),i!=null&&r.push(lp(t,i,s))),t=t.return}return r}function sd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ik(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=tp(n,i),c!=null&&o.unshift(lp(n,c,l))):s||(c=tp(n,i),c!=null&&o.push(lp(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var WK=/\r\n?/g,HK=/\u0000|\uFFFD/g;function Nk(t){return(typeof t=="string"?t:""+t).replace(WK,`
`).replace(HK,"")}function oy(t,e,n){if(e=Nk(e),Nk(t)!==e&&n)throw Error(He(425))}function lv(){}var hE=null,fE=null;function mE(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var pE=typeof setTimeout=="function"?setTimeout:void 0,qK=typeof clearTimeout=="function"?clearTimeout:void 0,Pk=typeof Promise=="function"?Promise:void 0,KK=typeof queueMicrotask=="function"?queueMicrotask:typeof Pk<"u"?function(t){return Pk.resolve(null).then(t).catch(YK)}:pE;function YK(t){setTimeout(function(){throw t})}function c_(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),sp(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);sp(e)}function kl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Ak(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ef=Math.random().toString(36).slice(2),$o="__reactFiber$"+ef,cp="__reactProps$"+ef,Pa="__reactContainer$"+ef,gE="__reactEvents$"+ef,JK="__reactListeners$"+ef,XK="__reactHandles$"+ef;function Xc(t){var e=t[$o];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Pa]||n[$o]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Ak(t);t!==null;){if(n=t[$o])return n;t=Ak(t)}return e}t=n,n=t.parentNode}return null}function Qp(t){return t=t[$o]||t[Pa],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ld(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(He(33))}function zw(t){return t[cp]||null}var yE=[],Fd=-1;function cc(t){return{current:t}}function qn(t){0>Fd||(t.current=yE[Fd],yE[Fd]=null,Fd--)}function Un(t,e){Fd++,yE[Fd]=t.current,t.current=e}var Jl={},Ns=cc(Jl),ii=cc(!1),yu=Jl;function _h(t,e){var n=t.type.contextTypes;if(!n)return Jl;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function oi(t){return t=t.childContextTypes,t!=null}function cv(){qn(ii),qn(Ns)}function kk(t,e,n){if(Ns.current!==Jl)throw Error(He(168));Un(Ns,e),Un(ii,n)}function RO(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(He(108,Mq(t)||"Unknown",s));return ur({},n,r)}function uv(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Jl,yu=Ns.current,Un(Ns,t),Un(ii,ii.current),!0}function Rk(t,e,n){var r=t.stateNode;if(!r)throw Error(He(169));n?(t=RO(t,e,yu),r.__reactInternalMemoizedMergedChildContext=t,qn(ii),qn(Ns),Un(Ns,t)):qn(ii),Un(ii,n)}var pa=null,Gw=!1,u_=!1;function jO(t){pa===null?pa=[t]:pa.push(t)}function QK(t){Gw=!0,jO(t)}function uc(){if(!u_&&pa!==null){u_=!0;var t=0,e=kn;try{var n=pa;for(kn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}pa=null,Gw=!1}catch(s){throw pa!==null&&(pa=pa.slice(t+1)),sO(XT,uc),s}finally{kn=e,u_=!1}}return null}var Od=[],$d=0,dv=null,hv=0,Vi=[],Ui=0,xu=null,ya=1,xa="";function Rc(t,e){Od[$d++]=hv,Od[$d++]=dv,dv=t,hv=e}function DO(t,e,n){Vi[Ui++]=ya,Vi[Ui++]=xa,Vi[Ui++]=xu,xu=t;var r=ya;t=xa;var s=32-wo(r)-1;r&=~(1<<s),n+=1;var i=32-wo(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ya=1<<32-wo(e)+s|n<<s|r,xa=i+t}else ya=1<<i|n<<s|r,xa=t}function o1(t){t.return!==null&&(Rc(t,1),DO(t,1,0))}function a1(t){for(;t===dv;)dv=Od[--$d],Od[$d]=null,hv=Od[--$d],Od[$d]=null;for(;t===xu;)xu=Vi[--Ui],Vi[Ui]=null,xa=Vi[--Ui],Vi[Ui]=null,ya=Vi[--Ui],Vi[Ui]=null}var Pi=null,Ci=null,Zn=!1,po=null;function MO(t,e){var n=Gi(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function jk(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Pi=t,Ci=kl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Pi=t,Ci=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=xu!==null?{id:ya,overflow:xa}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Gi(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Pi=t,Ci=null,!0):!1;default:return!1}}function xE(t){return(t.mode&1)!==0&&(t.flags&128)===0}function vE(t){if(Zn){var e=Ci;if(e){var n=e;if(!jk(t,e)){if(xE(t))throw Error(He(418));e=kl(n.nextSibling);var r=Pi;e&&jk(t,e)?MO(r,n):(t.flags=t.flags&-4097|2,Zn=!1,Pi=t)}}else{if(xE(t))throw Error(He(418));t.flags=t.flags&-4097|2,Zn=!1,Pi=t}}}function Dk(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Pi=t}function ay(t){if(t!==Pi)return!1;if(!Zn)return Dk(t),Zn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!mE(t.type,t.memoizedProps)),e&&(e=Ci)){if(xE(t))throw LO(),Error(He(418));for(;e;)MO(t,e),e=kl(e.nextSibling)}if(Dk(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(He(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ci=kl(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ci=null}}else Ci=Pi?kl(t.stateNode.nextSibling):null;return!0}function LO(){for(var t=Ci;t;)t=kl(t.nextSibling)}function Sh(){Ci=Pi=null,Zn=!1}function l1(t){po===null?po=[t]:po.push(t)}var ZK=Ga.ReactCurrentBatchConfig;function If(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(He(309));var r=n.stateNode}if(!r)throw Error(He(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(He(284));if(!n._owner)throw Error(He(290,t))}return t}function ly(t,e){throw t=Object.prototype.toString.call(e),Error(He(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Mk(t){var e=t._init;return e(t._payload)}function FO(t){function e(v,b){if(t){var S=v.deletions;S===null?(v.deletions=[b],v.flags|=16):S.push(b)}}function n(v,b){if(!t)return null;for(;b!==null;)e(v,b),b=b.sibling;return null}function r(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function s(v,b){return v=Ml(v,b),v.index=0,v.sibling=null,v}function i(v,b,S){return v.index=S,t?(S=v.alternate,S!==null?(S=S.index,S<b?(v.flags|=2,b):S):(v.flags|=2,b)):(v.flags|=1048576,b)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,b,S,I){return b===null||b.tag!==6?(b=y_(S,v.mode,I),b.return=v,b):(b=s(b,S),b.return=v,b)}function c(v,b,S,I){var D=S.type;return D===Rd?d(v,b,S.props.children,I,S.key):b!==null&&(b.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===ml&&Mk(D)===b.type)?(I=s(b,S.props),I.ref=If(v,b,S),I.return=v,I):(I=xx(S.type,S.key,S.props,null,v.mode,I),I.ref=If(v,b,S),I.return=v,I)}function u(v,b,S,I){return b===null||b.tag!==4||b.stateNode.containerInfo!==S.containerInfo||b.stateNode.implementation!==S.implementation?(b=x_(S,v.mode,I),b.return=v,b):(b=s(b,S.children||[]),b.return=v,b)}function d(v,b,S,I,D){return b===null||b.tag!==7?(b=au(S,v.mode,I,D),b.return=v,b):(b=s(b,S),b.return=v,b)}function h(v,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return b=y_(""+b,v.mode,S),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Xg:return S=xx(b.type,b.key,b.props,null,v.mode,S),S.ref=If(v,null,b),S.return=v,S;case kd:return b=x_(b,v.mode,S),b.return=v,b;case ml:var I=b._init;return h(v,I(b._payload),S)}if(Qf(b)||_f(b))return b=au(b,v.mode,S,null),b.return=v,b;ly(v,b)}return null}function f(v,b,S,I){var D=b!==null?b.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return D!==null?null:l(v,b,""+S,I);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Xg:return S.key===D?c(v,b,S,I):null;case kd:return S.key===D?u(v,b,S,I):null;case ml:return D=S._init,f(v,b,D(S._payload),I)}if(Qf(S)||_f(S))return D!==null?null:d(v,b,S,I,null);ly(v,S)}return null}function m(v,b,S,I,D){if(typeof I=="string"&&I!==""||typeof I=="number")return v=v.get(S)||null,l(b,v,""+I,D);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Xg:return v=v.get(I.key===null?S:I.key)||null,c(b,v,I,D);case kd:return v=v.get(I.key===null?S:I.key)||null,u(b,v,I,D);case ml:var k=I._init;return m(v,b,S,k(I._payload),D)}if(Qf(I)||_f(I))return v=v.get(S)||null,d(b,v,I,D,null);ly(b,I)}return null}function g(v,b,S,I){for(var D=null,k=null,C=b,T=b=0,P=null;C!==null&&T<S.length;T++){C.index>T?(P=C,C=null):P=C.sibling;var A=f(v,C,S[T],I);if(A===null){C===null&&(C=P);break}t&&C&&A.alternate===null&&e(v,C),b=i(A,b,T),k===null?D=A:k.sibling=A,k=A,C=P}if(T===S.length)return n(v,C),Zn&&Rc(v,T),D;if(C===null){for(;T<S.length;T++)C=h(v,S[T],I),C!==null&&(b=i(C,b,T),k===null?D=C:k.sibling=C,k=C);return Zn&&Rc(v,T),D}for(C=r(v,C);T<S.length;T++)P=m(C,v,T,S[T],I),P!==null&&(t&&P.alternate!==null&&C.delete(P.key===null?T:P.key),b=i(P,b,T),k===null?D=P:k.sibling=P,k=P);return t&&C.forEach(function(R){return e(v,R)}),Zn&&Rc(v,T),D}function x(v,b,S,I){var D=_f(S);if(typeof D!="function")throw Error(He(150));if(S=D.call(S),S==null)throw Error(He(151));for(var k=D=null,C=b,T=b=0,P=null,A=S.next();C!==null&&!A.done;T++,A=S.next()){C.index>T?(P=C,C=null):P=C.sibling;var R=f(v,C,A.value,I);if(R===null){C===null&&(C=P);break}t&&C&&R.alternate===null&&e(v,C),b=i(R,b,T),k===null?D=R:k.sibling=R,k=R,C=P}if(A.done)return n(v,C),Zn&&Rc(v,T),D;if(C===null){for(;!A.done;T++,A=S.next())A=h(v,A.value,I),A!==null&&(b=i(A,b,T),k===null?D=A:k.sibling=A,k=A);return Zn&&Rc(v,T),D}for(C=r(v,C);!A.done;T++,A=S.next())A=m(C,v,T,A.value,I),A!==null&&(t&&A.alternate!==null&&C.delete(A.key===null?T:A.key),b=i(A,b,T),k===null?D=A:k.sibling=A,k=A);return t&&C.forEach(function(M){return e(v,M)}),Zn&&Rc(v,T),D}function E(v,b,S,I){if(typeof S=="object"&&S!==null&&S.type===Rd&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Xg:e:{for(var D=S.key,k=b;k!==null;){if(k.key===D){if(D=S.type,D===Rd){if(k.tag===7){n(v,k.sibling),b=s(k,S.props.children),b.return=v,v=b;break e}}else if(k.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===ml&&Mk(D)===k.type){n(v,k.sibling),b=s(k,S.props),b.ref=If(v,k,S),b.return=v,v=b;break e}n(v,k);break}else e(v,k);k=k.sibling}S.type===Rd?(b=au(S.props.children,v.mode,I,S.key),b.return=v,v=b):(I=xx(S.type,S.key,S.props,null,v.mode,I),I.ref=If(v,b,S),I.return=v,v=I)}return o(v);case kd:e:{for(k=S.key;b!==null;){if(b.key===k)if(b.tag===4&&b.stateNode.containerInfo===S.containerInfo&&b.stateNode.implementation===S.implementation){n(v,b.sibling),b=s(b,S.children||[]),b.return=v,v=b;break e}else{n(v,b);break}else e(v,b);b=b.sibling}b=x_(S,v.mode,I),b.return=v,v=b}return o(v);case ml:return k=S._init,E(v,b,k(S._payload),I)}if(Qf(S))return g(v,b,S,I);if(_f(S))return x(v,b,S,I);ly(v,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,b!==null&&b.tag===6?(n(v,b.sibling),b=s(b,S),b.return=v,v=b):(n(v,b),b=y_(S,v.mode,I),b.return=v,v=b),o(v)):n(v,b)}return E}var Eh=FO(!0),OO=FO(!1),fv=cc(null),mv=null,Vd=null,c1=null;function u1(){c1=Vd=mv=null}function d1(t){var e=fv.current;qn(fv),t._currentValue=e}function wE(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function oh(t,e){mv=t,c1=Vd=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ti=!0),t.firstContext=null)}function Xi(t){var e=t._currentValue;if(c1!==t)if(t={context:t,memoizedValue:e,next:null},Vd===null){if(mv===null)throw Error(He(308));Vd=t,mv.dependencies={lanes:0,firstContext:t}}else Vd=Vd.next=t;return e}var Qc=null;function h1(t){Qc===null?Qc=[t]:Qc.push(t)}function $O(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,h1(e)):(n.next=s.next,s.next=n),e.interleaved=n,Aa(t,r)}function Aa(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var pl=!1;function f1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function VO(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Sa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Rl(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,vn&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Aa(t,n)}return s=r.interleaved,s===null?(e.next=e,h1(r)):(e.next=s.next,s.next=e),r.interleaved=e,Aa(t,n)}function hx(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,QT(t,n)}}function Lk(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function pv(t,e,n,r){var s=t.updateQueue;pl=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,m=l.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=t,x=l;switch(f=e,m=n,x.tag){case 1:if(g=x.payload,typeof g=="function"){h=g.call(m,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,f=typeof g=="function"?g.call(m,h,f):g,f==null)break e;h=ur({},h,f);break e;case 2:pl=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(1);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);wu|=o,t.lanes=o,t.memoizedState=h}}function Fk(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(He(191,s));s.call(r)}}}var Zp={},Ko=cc(Zp),up=cc(Zp),dp=cc(Zp);function Zc(t){if(t===Zp)throw Error(He(174));return t}function m1(t,e){switch(Un(dp,e),Un(up,t),Un(Ko,Zp),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:eE(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=eE(e,t)}qn(Ko),Un(Ko,e)}function Ch(){qn(Ko),qn(up),qn(dp)}function UO(t){Zc(dp.current);var e=Zc(Ko.current),n=eE(e,t.type);e!==n&&(Un(up,t),Un(Ko,n))}function p1(t){up.current===t&&(qn(Ko),qn(up))}var ir=cc(0);function gv(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var d_=[];function g1(){for(var t=0;t<d_.length;t++)d_[t]._workInProgressVersionPrimary=null;d_.length=0}var fx=Ga.ReactCurrentDispatcher,h_=Ga.ReactCurrentBatchConfig,vu=0,lr=null,Fr=null,Hr=null,yv=!1,_m=!1,hp=0,eY=0;function ys(){throw Error(He(321))}function y1(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!So(t[n],e[n]))return!1;return!0}function x1(t,e,n,r,s,i){if(vu=i,lr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,fx.current=t===null||t.memoizedState===null?sY:iY,t=n(r,s),_m){i=0;do{if(_m=!1,hp=0,25<=i)throw Error(He(301));i+=1,Hr=Fr=null,e.updateQueue=null,fx.current=oY,t=n(r,s)}while(_m)}if(fx.current=xv,e=Fr!==null&&Fr.next!==null,vu=0,Hr=Fr=lr=null,yv=!1,e)throw Error(He(300));return t}function v1(){var t=hp!==0;return hp=0,t}function jo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hr===null?lr.memoizedState=Hr=t:Hr=Hr.next=t,Hr}function Qi(){if(Fr===null){var t=lr.alternate;t=t!==null?t.memoizedState:null}else t=Fr.next;var e=Hr===null?lr.memoizedState:Hr.next;if(e!==null)Hr=e,Fr=t;else{if(t===null)throw Error(He(310));Fr=t,t={memoizedState:Fr.memoizedState,baseState:Fr.baseState,baseQueue:Fr.baseQueue,queue:Fr.queue,next:null},Hr===null?lr.memoizedState=Hr=t:Hr=Hr.next=t}return Hr}function fp(t,e){return typeof e=="function"?e(t):e}function f_(t){var e=Qi(),n=e.queue;if(n===null)throw Error(He(311));n.lastRenderedReducer=t;var r=Fr,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((vu&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,lr.lanes|=d,wu|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,So(r,e.memoizedState)||(ti=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,lr.lanes|=i,wu|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function m_(t){var e=Qi(),n=e.queue;if(n===null)throw Error(He(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);So(i,e.memoizedState)||(ti=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function BO(){}function zO(t,e){var n=lr,r=Qi(),s=e(),i=!So(r.memoizedState,s);if(i&&(r.memoizedState=s,ti=!0),r=r.queue,w1(HO.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Hr!==null&&Hr.memoizedState.tag&1){if(n.flags|=2048,mp(9,WO.bind(null,n,r,s,e),void 0,null),Kr===null)throw Error(He(349));vu&30||GO(n,e,s)}return s}function GO(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=lr.updateQueue,e===null?(e={lastEffect:null,stores:null},lr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function WO(t,e,n,r){e.value=n,e.getSnapshot=r,qO(e)&&KO(t)}function HO(t,e,n){return n(function(){qO(e)&&KO(t)})}function qO(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!So(t,n)}catch{return!0}}function KO(t){var e=Aa(t,1);e!==null&&bo(e,t,1,-1)}function Ok(t){var e=jo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fp,lastRenderedState:t},e.queue=t,t=t.dispatch=rY.bind(null,lr,t),[e.memoizedState,t]}function mp(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=lr.updateQueue,e===null?(e={lastEffect:null,stores:null},lr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function YO(){return Qi().memoizedState}function mx(t,e,n,r){var s=jo();lr.flags|=t,s.memoizedState=mp(1|e,n,void 0,r===void 0?null:r)}function Ww(t,e,n,r){var s=Qi();r=r===void 0?null:r;var i=void 0;if(Fr!==null){var o=Fr.memoizedState;if(i=o.destroy,r!==null&&y1(r,o.deps)){s.memoizedState=mp(e,n,i,r);return}}lr.flags|=t,s.memoizedState=mp(1|e,n,i,r)}function $k(t,e){return mx(8390656,8,t,e)}function w1(t,e){return Ww(2048,8,t,e)}function JO(t,e){return Ww(4,2,t,e)}function XO(t,e){return Ww(4,4,t,e)}function QO(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function ZO(t,e,n){return n=n!=null?n.concat([t]):null,Ww(4,4,QO.bind(null,e,t),n)}function b1(){}function e$(t,e){var n=Qi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&y1(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function t$(t,e){var n=Qi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&y1(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function n$(t,e,n){return vu&21?(So(n,e)||(n=aO(),lr.lanes|=n,wu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ti=!0),t.memoizedState=n)}function tY(t,e){var n=kn;kn=n!==0&&4>n?n:4,t(!0);var r=h_.transition;h_.transition={};try{t(!1),e()}finally{kn=n,h_.transition=r}}function r$(){return Qi().memoizedState}function nY(t,e,n){var r=Dl(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},s$(t))i$(e,n);else if(n=$O(t,e,n,r),n!==null){var s=zs();bo(n,t,r,s),o$(n,e,r)}}function rY(t,e,n){var r=Dl(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(s$(t))i$(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,So(l,o)){var c=e.interleaved;c===null?(s.next=s,h1(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=$O(t,e,s,r),n!==null&&(s=zs(),bo(n,t,r,s),o$(n,e,r))}}function s$(t){var e=t.alternate;return t===lr||e!==null&&e===lr}function i$(t,e){_m=yv=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function o$(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,QT(t,n)}}var xv={readContext:Xi,useCallback:ys,useContext:ys,useEffect:ys,useImperativeHandle:ys,useInsertionEffect:ys,useLayoutEffect:ys,useMemo:ys,useReducer:ys,useRef:ys,useState:ys,useDebugValue:ys,useDeferredValue:ys,useTransition:ys,useMutableSource:ys,useSyncExternalStore:ys,useId:ys,unstable_isNewReconciler:!1},sY={readContext:Xi,useCallback:function(t,e){return jo().memoizedState=[t,e===void 0?null:e],t},useContext:Xi,useEffect:$k,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,mx(4194308,4,QO.bind(null,e,t),n)},useLayoutEffect:function(t,e){return mx(4194308,4,t,e)},useInsertionEffect:function(t,e){return mx(4,2,t,e)},useMemo:function(t,e){var n=jo();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=jo();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=nY.bind(null,lr,t),[r.memoizedState,t]},useRef:function(t){var e=jo();return t={current:t},e.memoizedState=t},useState:Ok,useDebugValue:b1,useDeferredValue:function(t){return jo().memoizedState=t},useTransition:function(){var t=Ok(!1),e=t[0];return t=tY.bind(null,t[1]),jo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=lr,s=jo();if(Zn){if(n===void 0)throw Error(He(407));n=n()}else{if(n=e(),Kr===null)throw Error(He(349));vu&30||GO(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,$k(HO.bind(null,r,i,t),[t]),r.flags|=2048,mp(9,WO.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=jo(),e=Kr.identifierPrefix;if(Zn){var n=xa,r=ya;n=(r&~(1<<32-wo(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=hp++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=eY++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},iY={readContext:Xi,useCallback:e$,useContext:Xi,useEffect:w1,useImperativeHandle:ZO,useInsertionEffect:JO,useLayoutEffect:XO,useMemo:t$,useReducer:f_,useRef:YO,useState:function(){return f_(fp)},useDebugValue:b1,useDeferredValue:function(t){var e=Qi();return n$(e,Fr.memoizedState,t)},useTransition:function(){var t=f_(fp)[0],e=Qi().memoizedState;return[t,e]},useMutableSource:BO,useSyncExternalStore:zO,useId:r$,unstable_isNewReconciler:!1},oY={readContext:Xi,useCallback:e$,useContext:Xi,useEffect:w1,useImperativeHandle:ZO,useInsertionEffect:JO,useLayoutEffect:XO,useMemo:t$,useReducer:m_,useRef:YO,useState:function(){return m_(fp)},useDebugValue:b1,useDeferredValue:function(t){var e=Qi();return Fr===null?e.memoizedState=t:n$(e,Fr.memoizedState,t)},useTransition:function(){var t=m_(fp)[0],e=Qi().memoizedState;return[t,e]},useMutableSource:BO,useSyncExternalStore:zO,useId:r$,unstable_isNewReconciler:!1};function co(t,e){if(t&&t.defaultProps){e=ur({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function bE(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ur({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Hw={isMounted:function(t){return(t=t._reactInternals)?Vu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=zs(),s=Dl(t),i=Sa(r,s);i.payload=e,n!=null&&(i.callback=n),e=Rl(t,i,s),e!==null&&(bo(e,t,s,r),hx(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=zs(),s=Dl(t),i=Sa(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Rl(t,i,s),e!==null&&(bo(e,t,s,r),hx(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=zs(),r=Dl(t),s=Sa(n,r);s.tag=2,e!=null&&(s.callback=e),e=Rl(t,s,r),e!==null&&(bo(e,t,r,n),hx(e,t,r))}};function Vk(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!op(n,r)||!op(s,i):!0}function a$(t,e,n){var r=!1,s=Jl,i=e.contextType;return typeof i=="object"&&i!==null?i=Xi(i):(s=oi(e)?yu:Ns.current,r=e.contextTypes,i=(r=r!=null)?_h(t,s):Jl),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Hw,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Uk(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Hw.enqueueReplaceState(e,e.state,null)}function _E(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},f1(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Xi(i):(i=oi(e)?yu:Ns.current,s.context=_h(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(bE(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Hw.enqueueReplaceState(s,s.state,null),pv(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Th(t,e){try{var n="",r=e;do n+=Dq(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function p_(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function SE(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var aY=typeof WeakMap=="function"?WeakMap:Map;function l$(t,e,n){n=Sa(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){wv||(wv=!0,jE=r),SE(t,e)},n}function c$(t,e,n){n=Sa(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){SE(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){SE(t,e),typeof r!="function"&&(jl===null?jl=new Set([this]):jl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Bk(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new aY;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=bY.bind(null,t,e,n),e.then(t,t))}function zk(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Gk(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Sa(-1,1),e.tag=2,Rl(n,e,1))),n.lanes|=1),t)}var lY=Ga.ReactCurrentOwner,ti=!1;function Os(t,e,n,r){e.child=t===null?OO(e,null,n,r):Eh(e,t.child,n,r)}function Wk(t,e,n,r,s){n=n.render;var i=e.ref;return oh(e,s),r=x1(t,e,n,r,i,s),n=v1(),t!==null&&!ti?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ka(t,e,s)):(Zn&&n&&o1(e),e.flags|=1,Os(t,e,r,s),e.child)}function Hk(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!P1(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,u$(t,e,i,r,s)):(t=xx(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:op,n(o,r)&&t.ref===e.ref)return ka(t,e,s)}return e.flags|=1,t=Ml(i,r),t.ref=e.ref,t.return=e,e.child=t}function u$(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(op(i,r)&&t.ref===e.ref)if(ti=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(ti=!0);else return e.lanes=t.lanes,ka(t,e,s)}return EE(t,e,n,r,s)}function d$(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Un(Bd,wi),wi|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Un(Bd,wi),wi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Un(Bd,wi),wi|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Un(Bd,wi),wi|=r;return Os(t,e,s,n),e.child}function h$(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function EE(t,e,n,r,s){var i=oi(n)?yu:Ns.current;return i=_h(e,i),oh(e,s),n=x1(t,e,n,r,i,s),r=v1(),t!==null&&!ti?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ka(t,e,s)):(Zn&&r&&o1(e),e.flags|=1,Os(t,e,n,s),e.child)}function qk(t,e,n,r,s){if(oi(n)){var i=!0;uv(e)}else i=!1;if(oh(e,s),e.stateNode===null)px(t,e),a$(e,n,r),_E(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Xi(u):(u=oi(n)?yu:Ns.current,u=_h(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&Uk(e,o,r,u),pl=!1;var f=e.memoizedState;o.state=f,pv(e,r,o,s),c=e.memoizedState,l!==r||f!==c||ii.current||pl?(typeof d=="function"&&(bE(e,n,d,r),c=e.memoizedState),(l=pl||Vk(e,n,l,r,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,VO(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:co(e.type,l),o.props=u,h=e.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Xi(c):(c=oi(n)?yu:Ns.current,c=_h(e,c));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&Uk(e,o,r,c),pl=!1,f=e.memoizedState,o.state=f,pv(e,r,o,s);var g=e.memoizedState;l!==h||f!==g||ii.current||pl?(typeof m=="function"&&(bE(e,n,m,r),g=e.memoizedState),(u=pl||Vk(e,n,u,r,f,g,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return CE(t,e,n,r,i,s)}function CE(t,e,n,r,s,i){h$(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Rk(e,n,!1),ka(t,e,i);r=e.stateNode,lY.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Eh(e,t.child,null,i),e.child=Eh(e,null,l,i)):Os(t,e,l,i),e.memoizedState=r.state,s&&Rk(e,n,!0),e.child}function f$(t){var e=t.stateNode;e.pendingContext?kk(t,e.pendingContext,e.pendingContext!==e.context):e.context&&kk(t,e.context,!1),m1(t,e.containerInfo)}function Kk(t,e,n,r,s){return Sh(),l1(s),e.flags|=256,Os(t,e,n,r),e.child}var TE={dehydrated:null,treeContext:null,retryLane:0};function IE(t){return{baseLanes:t,cachePool:null,transitions:null}}function m$(t,e,n){var r=e.pendingProps,s=ir.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Un(ir,s&1),t===null)return vE(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Yw(o,r,0,null),t=au(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=IE(n),e.memoizedState=TE,t):_1(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return cY(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Ml(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Ml(l,i):(i=au(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?IE(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=TE,r}return i=t.child,t=i.sibling,r=Ml(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function _1(t,e){return e=Yw({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function cy(t,e,n,r){return r!==null&&l1(r),Eh(e,t.child,null,n),t=_1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function cY(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=p_(Error(He(422))),cy(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Yw({mode:"visible",children:r.children},s,0,null),i=au(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Eh(e,t.child,null,o),e.child.memoizedState=IE(o),e.memoizedState=TE,i);if(!(e.mode&1))return cy(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(He(419)),r=p_(i,r,void 0),cy(t,e,o,r)}if(l=(o&t.childLanes)!==0,ti||l){if(r=Kr,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Aa(t,s),bo(r,t,s,-1))}return N1(),r=p_(Error(He(421))),cy(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=_Y.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ci=kl(s.nextSibling),Pi=e,Zn=!0,po=null,t!==null&&(Vi[Ui++]=ya,Vi[Ui++]=xa,Vi[Ui++]=xu,ya=t.id,xa=t.overflow,xu=e),e=_1(e,r.children),e.flags|=4096,e)}function Yk(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),wE(t.return,e,n)}function g_(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function p$(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Os(t,e,r.children,n),r=ir.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Yk(t,n,e);else if(t.tag===19)Yk(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Un(ir,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&gv(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),g_(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&gv(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}g_(e,!0,n,null,i);break;case"together":g_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function px(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ka(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),wu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(He(153));if(e.child!==null){for(t=e.child,n=Ml(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ml(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function uY(t,e,n){switch(e.tag){case 3:f$(e),Sh();break;case 5:UO(e);break;case 1:oi(e.type)&&uv(e);break;case 4:m1(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Un(fv,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Un(ir,ir.current&1),e.flags|=128,null):n&e.child.childLanes?m$(t,e,n):(Un(ir,ir.current&1),t=ka(t,e,n),t!==null?t.sibling:null);Un(ir,ir.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return p$(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Un(ir,ir.current),r)break;return null;case 22:case 23:return e.lanes=0,d$(t,e,n)}return ka(t,e,n)}var g$,NE,y$,x$;g$=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};NE=function(){};y$=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Zc(Ko.current);var i=null;switch(n){case"input":s=JS(t,s),r=JS(t,r),i=[];break;case"select":s=ur({},s,{value:void 0}),r=ur({},r,{value:void 0}),i=[];break;case"textarea":s=ZS(t,s),r=ZS(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=lv)}tE(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Zm.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Zm.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Hn("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};x$=function(t,e,n,r){n!==r&&(e.flags|=4)};function Nf(t,e){if(!Zn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function xs(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function dY(t,e,n){var r=e.pendingProps;switch(a1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xs(e),null;case 1:return oi(e.type)&&cv(),xs(e),null;case 3:return r=e.stateNode,Ch(),qn(ii),qn(Ns),g1(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ay(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,po!==null&&(LE(po),po=null))),NE(t,e),xs(e),null;case 5:p1(e);var s=Zc(dp.current);if(n=e.type,t!==null&&e.stateNode!=null)y$(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(He(166));return xs(e),null}if(t=Zc(Ko.current),ay(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[$o]=e,r[cp]=i,t=(e.mode&1)!==0,n){case"dialog":Hn("cancel",r),Hn("close",r);break;case"iframe":case"object":case"embed":Hn("load",r);break;case"video":case"audio":for(s=0;s<em.length;s++)Hn(em[s],r);break;case"source":Hn("error",r);break;case"img":case"image":case"link":Hn("error",r),Hn("load",r);break;case"details":Hn("toggle",r);break;case"input":sk(r,i),Hn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Hn("invalid",r);break;case"textarea":ok(r,i),Hn("invalid",r)}tE(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&oy(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&oy(r.textContent,l,t),s=["children",""+l]):Zm.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Hn("scroll",r)}switch(n){case"input":Qg(r),ik(r,i,!0);break;case"textarea":Qg(r),ak(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=lv)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=HF(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[$o]=e,t[cp]=r,g$(t,e,!1,!1),e.stateNode=t;e:{switch(o=nE(n,r),n){case"dialog":Hn("cancel",t),Hn("close",t),s=r;break;case"iframe":case"object":case"embed":Hn("load",t),s=r;break;case"video":case"audio":for(s=0;s<em.length;s++)Hn(em[s],t);s=r;break;case"source":Hn("error",t),s=r;break;case"img":case"image":case"link":Hn("error",t),Hn("load",t),s=r;break;case"details":Hn("toggle",t),s=r;break;case"input":sk(t,r),s=JS(t,r),Hn("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=ur({},r,{value:void 0}),Hn("invalid",t);break;case"textarea":ok(t,r),s=ZS(t,r),Hn("invalid",t);break;default:s=r}tE(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?YF(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&qF(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ep(t,c):typeof c=="number"&&ep(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Zm.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Hn("scroll",t):c!=null&&HT(t,i,c,o))}switch(n){case"input":Qg(t),ik(t,r,!1);break;case"textarea":Qg(t),ak(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Yl(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?nh(t,!!r.multiple,i,!1):r.defaultValue!=null&&nh(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=lv)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return xs(e),null;case 6:if(t&&e.stateNode!=null)x$(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(He(166));if(n=Zc(dp.current),Zc(Ko.current),ay(e)){if(r=e.stateNode,n=e.memoizedProps,r[$o]=e,(i=r.nodeValue!==n)&&(t=Pi,t!==null))switch(t.tag){case 3:oy(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&oy(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[$o]=e,e.stateNode=r}return xs(e),null;case 13:if(qn(ir),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Zn&&Ci!==null&&e.mode&1&&!(e.flags&128))LO(),Sh(),e.flags|=98560,i=!1;else if(i=ay(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(He(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(He(317));i[$o]=e}else Sh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;xs(e),i=!1}else po!==null&&(LE(po),po=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ir.current&1?Or===0&&(Or=3):N1())),e.updateQueue!==null&&(e.flags|=4),xs(e),null);case 4:return Ch(),NE(t,e),t===null&&ap(e.stateNode.containerInfo),xs(e),null;case 10:return d1(e.type._context),xs(e),null;case 17:return oi(e.type)&&cv(),xs(e),null;case 19:if(qn(ir),i=e.memoizedState,i===null)return xs(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Nf(i,!1);else{if(Or!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=gv(t),o!==null){for(e.flags|=128,Nf(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Un(ir,ir.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ir()>Ih&&(e.flags|=128,r=!0,Nf(i,!1),e.lanes=4194304)}else{if(!r)if(t=gv(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Nf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Zn)return xs(e),null}else 2*Ir()-i.renderingStartTime>Ih&&n!==1073741824&&(e.flags|=128,r=!0,Nf(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ir(),e.sibling=null,n=ir.current,Un(ir,r?n&1|2:n&1),e):(xs(e),null);case 22:case 23:return I1(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?wi&1073741824&&(xs(e),e.subtreeFlags&6&&(e.flags|=8192)):xs(e),null;case 24:return null;case 25:return null}throw Error(He(156,e.tag))}function hY(t,e){switch(a1(e),e.tag){case 1:return oi(e.type)&&cv(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ch(),qn(ii),qn(Ns),g1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return p1(e),null;case 13:if(qn(ir),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(He(340));Sh()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return qn(ir),null;case 4:return Ch(),null;case 10:return d1(e.type._context),null;case 22:case 23:return I1(),null;case 24:return null;default:return null}}var uy=!1,Ss=!1,fY=typeof WeakSet=="function"?WeakSet:Set,vt=null;function Ud(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){pr(t,e,r)}else n.current=null}function PE(t,e,n){try{n()}catch(r){pr(t,e,r)}}var Jk=!1;function mY(t,e){if(hE=iv,t=SO(),i1(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++u===s&&(l=o),f===i&&++d===r&&(c=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(fE={focusedElem:t,selectionRange:n},iv=!1,vt=e;vt!==null;)if(e=vt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,vt=t;else for(;vt!==null;){e=vt;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,E=g.memoizedState,v=e.stateNode,b=v.getSnapshotBeforeUpdate(e.elementType===e.type?x:co(e.type,x),E);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(He(163))}}catch(I){pr(e,e.return,I)}if(t=e.sibling,t!==null){t.return=e.return,vt=t;break}vt=e.return}return g=Jk,Jk=!1,g}function Sm(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&PE(e,n,i)}s=s.next}while(s!==r)}}function qw(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function AE(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function v$(t){var e=t.alternate;e!==null&&(t.alternate=null,v$(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$o],delete e[cp],delete e[gE],delete e[JK],delete e[XK])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function w$(t){return t.tag===5||t.tag===3||t.tag===4}function Xk(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||w$(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function kE(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=lv));else if(r!==4&&(t=t.child,t!==null))for(kE(t,e,n),t=t.sibling;t!==null;)kE(t,e,n),t=t.sibling}function RE(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(RE(t,e,n),t=t.sibling;t!==null;)RE(t,e,n),t=t.sibling}var es=null,ho=!1;function Za(t,e,n){for(n=n.child;n!==null;)b$(t,e,n),n=n.sibling}function b$(t,e,n){if(qo&&typeof qo.onCommitFiberUnmount=="function")try{qo.onCommitFiberUnmount($w,n)}catch{}switch(n.tag){case 5:Ss||Ud(n,e);case 6:var r=es,s=ho;es=null,Za(t,e,n),es=r,ho=s,es!==null&&(ho?(t=es,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):es.removeChild(n.stateNode));break;case 18:es!==null&&(ho?(t=es,n=n.stateNode,t.nodeType===8?c_(t.parentNode,n):t.nodeType===1&&c_(t,n),sp(t)):c_(es,n.stateNode));break;case 4:r=es,s=ho,es=n.stateNode.containerInfo,ho=!0,Za(t,e,n),es=r,ho=s;break;case 0:case 11:case 14:case 15:if(!Ss&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&PE(n,e,o),s=s.next}while(s!==r)}Za(t,e,n);break;case 1:if(!Ss&&(Ud(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){pr(n,e,l)}Za(t,e,n);break;case 21:Za(t,e,n);break;case 22:n.mode&1?(Ss=(r=Ss)||n.memoizedState!==null,Za(t,e,n),Ss=r):Za(t,e,n);break;default:Za(t,e,n)}}function Qk(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new fY),e.forEach(function(r){var s=SY.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function oo(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:es=l.stateNode,ho=!1;break e;case 3:es=l.stateNode.containerInfo,ho=!0;break e;case 4:es=l.stateNode.containerInfo,ho=!0;break e}l=l.return}if(es===null)throw Error(He(160));b$(i,o,s),es=null,ho=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){pr(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)_$(e,t),e=e.sibling}function _$(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(oo(e,t),ko(t),r&4){try{Sm(3,t,t.return),qw(3,t)}catch(x){pr(t,t.return,x)}try{Sm(5,t,t.return)}catch(x){pr(t,t.return,x)}}break;case 1:oo(e,t),ko(t),r&512&&n!==null&&Ud(n,n.return);break;case 5:if(oo(e,t),ko(t),r&512&&n!==null&&Ud(n,n.return),t.flags&32){var s=t.stateNode;try{ep(s,"")}catch(x){pr(t,t.return,x)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&GF(s,i),nE(l,o);var u=nE(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?YF(s,h):d==="dangerouslySetInnerHTML"?qF(s,h):d==="children"?ep(s,h):HT(s,d,h,u)}switch(l){case"input":XS(s,i);break;case"textarea":WF(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?nh(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?nh(s,!!i.multiple,i.defaultValue,!0):nh(s,!!i.multiple,i.multiple?[]:"",!1))}s[cp]=i}catch(x){pr(t,t.return,x)}}break;case 6:if(oo(e,t),ko(t),r&4){if(t.stateNode===null)throw Error(He(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(x){pr(t,t.return,x)}}break;case 3:if(oo(e,t),ko(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{sp(e.containerInfo)}catch(x){pr(t,t.return,x)}break;case 4:oo(e,t),ko(t);break;case 13:oo(e,t),ko(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(C1=Ir())),r&4&&Qk(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Ss=(u=Ss)||d,oo(e,t),Ss=u):oo(e,t),ko(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(vt=t,d=t.child;d!==null;){for(h=vt=d;vt!==null;){switch(f=vt,m=f.child,f.tag){case 0:case 11:case 14:case 15:Sm(4,f,f.return);break;case 1:Ud(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(x){pr(r,n,x)}}break;case 5:Ud(f,f.return);break;case 22:if(f.memoizedState!==null){eR(h);continue}}m!==null?(m.return=f,vt=m):eR(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=KF("display",o))}catch(x){pr(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){pr(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:oo(e,t),ko(t),r&4&&Qk(t);break;case 21:break;default:oo(e,t),ko(t)}}function ko(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(w$(n)){var r=n;break e}n=n.return}throw Error(He(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ep(s,""),r.flags&=-33);var i=Xk(t);RE(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Xk(t);kE(t,l,o);break;default:throw Error(He(161))}}catch(c){pr(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function pY(t,e,n){vt=t,S$(t)}function S$(t,e,n){for(var r=(t.mode&1)!==0;vt!==null;){var s=vt,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||uy;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Ss;l=uy;var u=Ss;if(uy=o,(Ss=c)&&!u)for(vt=s;vt!==null;)o=vt,c=o.child,o.tag===22&&o.memoizedState!==null?tR(s):c!==null?(c.return=o,vt=c):tR(s);for(;i!==null;)vt=i,S$(i),i=i.sibling;vt=s,uy=l,Ss=u}Zk(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,vt=i):Zk(t)}}function Zk(t){for(;vt!==null;){var e=vt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ss||qw(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ss)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:co(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Fk(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Fk(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&sp(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(He(163))}Ss||e.flags&512&&AE(e)}catch(f){pr(e,e.return,f)}}if(e===t){vt=null;break}if(n=e.sibling,n!==null){n.return=e.return,vt=n;break}vt=e.return}}function eR(t){for(;vt!==null;){var e=vt;if(e===t){vt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,vt=n;break}vt=e.return}}function tR(t){for(;vt!==null;){var e=vt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{qw(4,e)}catch(c){pr(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){pr(e,s,c)}}var i=e.return;try{AE(e)}catch(c){pr(e,i,c)}break;case 5:var o=e.return;try{AE(e)}catch(c){pr(e,o,c)}}}catch(c){pr(e,e.return,c)}if(e===t){vt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,vt=l;break}vt=e.return}}var gY=Math.ceil,vv=Ga.ReactCurrentDispatcher,S1=Ga.ReactCurrentOwner,qi=Ga.ReactCurrentBatchConfig,vn=0,Kr=null,kr=null,os=0,wi=0,Bd=cc(0),Or=0,pp=null,wu=0,Kw=0,E1=0,Em=null,ei=null,C1=0,Ih=1/0,fa=null,wv=!1,jE=null,jl=null,dy=!1,Cl=null,bv=0,Cm=0,DE=null,gx=-1,yx=0;function zs(){return vn&6?Ir():gx!==-1?gx:gx=Ir()}function Dl(t){return t.mode&1?vn&2&&os!==0?os&-os:ZK.transition!==null?(yx===0&&(yx=aO()),yx):(t=kn,t!==0||(t=window.event,t=t===void 0?16:mO(t.type)),t):1}function bo(t,e,n,r){if(50<Cm)throw Cm=0,DE=null,Error(He(185));Jp(t,n,r),(!(vn&2)||t!==Kr)&&(t===Kr&&(!(vn&2)&&(Kw|=n),Or===4&&xl(t,os)),ai(t,r),n===1&&vn===0&&!(e.mode&1)&&(Ih=Ir()+500,Gw&&uc()))}function ai(t,e){var n=t.callbackNode;Zq(t,e);var r=sv(t,t===Kr?os:0);if(r===0)n!==null&&uk(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&uk(n),e===1)t.tag===0?QK(nR.bind(null,t)):jO(nR.bind(null,t)),KK(function(){!(vn&6)&&uc()}),n=null;else{switch(lO(r)){case 1:n=XT;break;case 4:n=iO;break;case 16:n=rv;break;case 536870912:n=oO;break;default:n=rv}n=k$(n,E$.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function E$(t,e){if(gx=-1,yx=0,vn&6)throw Error(He(327));var n=t.callbackNode;if(ah()&&t.callbackNode!==n)return null;var r=sv(t,t===Kr?os:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=_v(t,r);else{e=r;var s=vn;vn|=2;var i=T$();(Kr!==t||os!==e)&&(fa=null,Ih=Ir()+500,ou(t,e));do try{vY();break}catch(l){C$(t,l)}while(1);u1(),vv.current=i,vn=s,kr!==null?e=0:(Kr=null,os=0,e=Or)}if(e!==0){if(e===2&&(s=aE(t),s!==0&&(r=s,e=ME(t,s))),e===1)throw n=pp,ou(t,0),xl(t,r),ai(t,Ir()),n;if(e===6)xl(t,r);else{if(s=t.current.alternate,!(r&30)&&!yY(s)&&(e=_v(t,r),e===2&&(i=aE(t),i!==0&&(r=i,e=ME(t,i))),e===1))throw n=pp,ou(t,0),xl(t,r),ai(t,Ir()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(He(345));case 2:jc(t,ei,fa);break;case 3:if(xl(t,r),(r&130023424)===r&&(e=C1+500-Ir(),10<e)){if(sv(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){zs(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=pE(jc.bind(null,t,ei,fa),e);break}jc(t,ei,fa);break;case 4:if(xl(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-wo(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ir()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*gY(r/1960))-r,10<r){t.timeoutHandle=pE(jc.bind(null,t,ei,fa),r);break}jc(t,ei,fa);break;case 5:jc(t,ei,fa);break;default:throw Error(He(329))}}}return ai(t,Ir()),t.callbackNode===n?E$.bind(null,t):null}function ME(t,e){var n=Em;return t.current.memoizedState.isDehydrated&&(ou(t,e).flags|=256),t=_v(t,e),t!==2&&(e=ei,ei=n,e!==null&&LE(e)),t}function LE(t){ei===null?ei=t:ei.push.apply(ei,t)}function yY(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!So(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function xl(t,e){for(e&=~E1,e&=~Kw,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-wo(e),r=1<<n;t[n]=-1,e&=~r}}function nR(t){if(vn&6)throw Error(He(327));ah();var e=sv(t,0);if(!(e&1))return ai(t,Ir()),null;var n=_v(t,e);if(t.tag!==0&&n===2){var r=aE(t);r!==0&&(e=r,n=ME(t,r))}if(n===1)throw n=pp,ou(t,0),xl(t,e),ai(t,Ir()),n;if(n===6)throw Error(He(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,jc(t,ei,fa),ai(t,Ir()),null}function T1(t,e){var n=vn;vn|=1;try{return t(e)}finally{vn=n,vn===0&&(Ih=Ir()+500,Gw&&uc())}}function bu(t){Cl!==null&&Cl.tag===0&&!(vn&6)&&ah();var e=vn;vn|=1;var n=qi.transition,r=kn;try{if(qi.transition=null,kn=1,t)return t()}finally{kn=r,qi.transition=n,vn=e,!(vn&6)&&uc()}}function I1(){wi=Bd.current,qn(Bd)}function ou(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,qK(n)),kr!==null)for(n=kr.return;n!==null;){var r=n;switch(a1(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&cv();break;case 3:Ch(),qn(ii),qn(Ns),g1();break;case 5:p1(r);break;case 4:Ch();break;case 13:qn(ir);break;case 19:qn(ir);break;case 10:d1(r.type._context);break;case 22:case 23:I1()}n=n.return}if(Kr=t,kr=t=Ml(t.current,null),os=wi=e,Or=0,pp=null,E1=Kw=wu=0,ei=Em=null,Qc!==null){for(e=0;e<Qc.length;e++)if(n=Qc[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Qc=null}return t}function C$(t,e){do{var n=kr;try{if(u1(),fx.current=xv,yv){for(var r=lr.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}yv=!1}if(vu=0,Hr=Fr=lr=null,_m=!1,hp=0,S1.current=null,n===null||n.return===null){Or=1,pp=e,kr=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=os,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=zk(o);if(m!==null){m.flags&=-257,Gk(m,o,l,i,e),m.mode&1&&Bk(i,u,e),e=m,c=u;var g=e.updateQueue;if(g===null){var x=new Set;x.add(c),e.updateQueue=x}else g.add(c);break e}else{if(!(e&1)){Bk(i,u,e),N1();break e}c=Error(He(426))}}else if(Zn&&l.mode&1){var E=zk(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),Gk(E,o,l,i,e),l1(Th(c,l));break e}}i=c=Th(c,l),Or!==4&&(Or=2),Em===null?Em=[i]:Em.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=l$(i,c,e);Lk(i,v);break e;case 1:l=c;var b=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(jl===null||!jl.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var I=c$(i,l,e);Lk(i,I);break e}}i=i.return}while(i!==null)}N$(n)}catch(D){e=D,kr===n&&n!==null&&(kr=n=n.return);continue}break}while(1)}function T$(){var t=vv.current;return vv.current=xv,t===null?xv:t}function N1(){(Or===0||Or===3||Or===2)&&(Or=4),Kr===null||!(wu&268435455)&&!(Kw&268435455)||xl(Kr,os)}function _v(t,e){var n=vn;vn|=2;var r=T$();(Kr!==t||os!==e)&&(fa=null,ou(t,e));do try{xY();break}catch(s){C$(t,s)}while(1);if(u1(),vn=n,vv.current=r,kr!==null)throw Error(He(261));return Kr=null,os=0,Or}function xY(){for(;kr!==null;)I$(kr)}function vY(){for(;kr!==null&&!Gq();)I$(kr)}function I$(t){var e=A$(t.alternate,t,wi);t.memoizedProps=t.pendingProps,e===null?N$(t):kr=e,S1.current=null}function N$(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=hY(n,e),n!==null){n.flags&=32767,kr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Or=6,kr=null;return}}else if(n=dY(n,e,wi),n!==null){kr=n;return}if(e=e.sibling,e!==null){kr=e;return}kr=e=t}while(e!==null);Or===0&&(Or=5)}function jc(t,e,n){var r=kn,s=qi.transition;try{qi.transition=null,kn=1,wY(t,e,n,r)}finally{qi.transition=s,kn=r}return null}function wY(t,e,n,r){do ah();while(Cl!==null);if(vn&6)throw Error(He(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(He(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(eK(t,i),t===Kr&&(kr=Kr=null,os=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||dy||(dy=!0,k$(rv,function(){return ah(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=qi.transition,qi.transition=null;var o=kn;kn=1;var l=vn;vn|=4,S1.current=null,mY(t,n),_$(n,t),VK(fE),iv=!!hE,fE=hE=null,t.current=n,pY(n),Wq(),vn=l,kn=o,qi.transition=i}else t.current=n;if(dy&&(dy=!1,Cl=t,bv=s),i=t.pendingLanes,i===0&&(jl=null),Kq(n.stateNode),ai(t,Ir()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(wv)throw wv=!1,t=jE,jE=null,t;return bv&1&&t.tag!==0&&ah(),i=t.pendingLanes,i&1?t===DE?Cm++:(Cm=0,DE=t):Cm=0,uc(),null}function ah(){if(Cl!==null){var t=lO(bv),e=qi.transition,n=kn;try{if(qi.transition=null,kn=16>t?16:t,Cl===null)var r=!1;else{if(t=Cl,Cl=null,bv=0,vn&6)throw Error(He(331));var s=vn;for(vn|=4,vt=t.current;vt!==null;){var i=vt,o=i.child;if(vt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(vt=u;vt!==null;){var d=vt;switch(d.tag){case 0:case 11:case 15:Sm(8,d,i)}var h=d.child;if(h!==null)h.return=d,vt=h;else for(;vt!==null;){d=vt;var f=d.sibling,m=d.return;if(v$(d),d===u){vt=null;break}if(f!==null){f.return=m,vt=f;break}vt=m}}}var g=i.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var E=x.sibling;x.sibling=null,x=E}while(x!==null)}}vt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,vt=o;else e:for(;vt!==null;){if(i=vt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Sm(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,vt=v;break e}vt=i.return}}var b=t.current;for(vt=b;vt!==null;){o=vt;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,vt=S;else e:for(o=b;vt!==null;){if(l=vt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:qw(9,l)}}catch(D){pr(l,l.return,D)}if(l===o){vt=null;break e}var I=l.sibling;if(I!==null){I.return=l.return,vt=I;break e}vt=l.return}}if(vn=s,uc(),qo&&typeof qo.onPostCommitFiberRoot=="function")try{qo.onPostCommitFiberRoot($w,t)}catch{}r=!0}return r}finally{kn=n,qi.transition=e}}return!1}function rR(t,e,n){e=Th(n,e),e=l$(t,e,1),t=Rl(t,e,1),e=zs(),t!==null&&(Jp(t,1,e),ai(t,e))}function pr(t,e,n){if(t.tag===3)rR(t,t,n);else for(;e!==null;){if(e.tag===3){rR(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(jl===null||!jl.has(r))){t=Th(n,t),t=c$(e,t,1),e=Rl(e,t,1),t=zs(),e!==null&&(Jp(e,1,t),ai(e,t));break}}e=e.return}}function bY(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=zs(),t.pingedLanes|=t.suspendedLanes&n,Kr===t&&(os&n)===n&&(Or===4||Or===3&&(os&130023424)===os&&500>Ir()-C1?ou(t,0):E1|=n),ai(t,e)}function P$(t,e){e===0&&(t.mode&1?(e=ty,ty<<=1,!(ty&130023424)&&(ty=4194304)):e=1);var n=zs();t=Aa(t,e),t!==null&&(Jp(t,e,n),ai(t,n))}function _Y(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),P$(t,n)}function SY(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(He(314))}r!==null&&r.delete(e),P$(t,n)}var A$;A$=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ii.current)ti=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ti=!1,uY(t,e,n);ti=!!(t.flags&131072)}else ti=!1,Zn&&e.flags&1048576&&DO(e,hv,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;px(t,e),t=e.pendingProps;var s=_h(e,Ns.current);oh(e,n),s=x1(null,e,r,t,s,n);var i=v1();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,oi(r)?(i=!0,uv(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,f1(e),s.updater=Hw,e.stateNode=s,s._reactInternals=e,_E(e,r,t,n),e=CE(null,e,r,!0,i,n)):(e.tag=0,Zn&&i&&o1(e),Os(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(px(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=CY(r),t=co(r,t),s){case 0:e=EE(null,e,r,t,n);break e;case 1:e=qk(null,e,r,t,n);break e;case 11:e=Wk(null,e,r,t,n);break e;case 14:e=Hk(null,e,r,co(r.type,t),n);break e}throw Error(He(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:co(r,s),EE(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:co(r,s),qk(t,e,r,s,n);case 3:e:{if(f$(e),t===null)throw Error(He(387));r=e.pendingProps,i=e.memoizedState,s=i.element,VO(t,e),pv(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Th(Error(He(423)),e),e=Kk(t,e,r,n,s);break e}else if(r!==s){s=Th(Error(He(424)),e),e=Kk(t,e,r,n,s);break e}else for(Ci=kl(e.stateNode.containerInfo.firstChild),Pi=e,Zn=!0,po=null,n=OO(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Sh(),r===s){e=ka(t,e,n);break e}Os(t,e,r,n)}e=e.child}return e;case 5:return UO(e),t===null&&vE(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,mE(r,s)?o=null:i!==null&&mE(r,i)&&(e.flags|=32),h$(t,e),Os(t,e,o,n),e.child;case 6:return t===null&&vE(e),null;case 13:return m$(t,e,n);case 4:return m1(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Eh(e,null,r,n):Os(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:co(r,s),Wk(t,e,r,s,n);case 7:return Os(t,e,e.pendingProps,n),e.child;case 8:return Os(t,e,e.pendingProps.children,n),e.child;case 12:return Os(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Un(fv,r._currentValue),r._currentValue=o,i!==null)if(So(i.value,o)){if(i.children===s.children&&!ii.current){e=ka(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Sa(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),wE(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(He(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),wE(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Os(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,oh(e,n),s=Xi(s),r=r(s),e.flags|=1,Os(t,e,r,n),e.child;case 14:return r=e.type,s=co(r,e.pendingProps),s=co(r.type,s),Hk(t,e,r,s,n);case 15:return u$(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:co(r,s),px(t,e),e.tag=1,oi(r)?(t=!0,uv(e)):t=!1,oh(e,n),a$(e,r,s),_E(e,r,s,n),CE(null,e,r,!0,t,n);case 19:return p$(t,e,n);case 22:return d$(t,e,n)}throw Error(He(156,e.tag))};function k$(t,e){return sO(t,e)}function EY(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gi(t,e,n,r){return new EY(t,e,n,r)}function P1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function CY(t){if(typeof t=="function")return P1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===KT)return 11;if(t===YT)return 14}return 2}function Ml(t,e){var n=t.alternate;return n===null?(n=Gi(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function xx(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")P1(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Rd:return au(n.children,s,i,e);case qT:o=8,s|=8;break;case HS:return t=Gi(12,n,e,s|2),t.elementType=HS,t.lanes=i,t;case qS:return t=Gi(13,n,e,s),t.elementType=qS,t.lanes=i,t;case KS:return t=Gi(19,n,e,s),t.elementType=KS,t.lanes=i,t;case UF:return Yw(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $F:o=10;break e;case VF:o=9;break e;case KT:o=11;break e;case YT:o=14;break e;case ml:o=16,r=null;break e}throw Error(He(130,t==null?t:typeof t,""))}return e=Gi(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function au(t,e,n,r){return t=Gi(7,t,r,e),t.lanes=n,t}function Yw(t,e,n,r){return t=Gi(22,t,r,e),t.elementType=UF,t.lanes=n,t.stateNode={isHidden:!1},t}function y_(t,e,n){return t=Gi(6,t,null,e),t.lanes=n,t}function x_(t,e,n){return e=Gi(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function TY(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qb(0),this.expirationTimes=Qb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qb(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function A1(t,e,n,r,s,i,o,l,c){return t=new TY(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Gi(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},f1(i),t}function IY(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:kd,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function R$(t){if(!t)return Jl;t=t._reactInternals;e:{if(Vu(t)!==t||t.tag!==1)throw Error(He(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(oi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(He(171))}if(t.tag===1){var n=t.type;if(oi(n))return RO(t,n,e)}return e}function j$(t,e,n,r,s,i,o,l,c){return t=A1(n,r,!0,t,s,i,o,l,c),t.context=R$(null),n=t.current,r=zs(),s=Dl(n),i=Sa(r,s),i.callback=e??null,Rl(n,i,s),t.current.lanes=s,Jp(t,s,r),ai(t,r),t}function Jw(t,e,n,r){var s=e.current,i=zs(),o=Dl(s);return n=R$(n),e.context===null?e.context=n:e.pendingContext=n,e=Sa(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Rl(s,e,o),t!==null&&(bo(t,s,o,i),hx(t,s,o)),o}function Sv(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function sR(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function k1(t,e){sR(t,e),(t=t.alternate)&&sR(t,e)}function NY(){return null}var D$=typeof reportError=="function"?reportError:function(t){console.error(t)};function R1(t){this._internalRoot=t}Xw.prototype.render=R1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(He(409));Jw(t,e,null,null)};Xw.prototype.unmount=R1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;bu(function(){Jw(null,t,null,null)}),e[Pa]=null}};function Xw(t){this._internalRoot=t}Xw.prototype.unstable_scheduleHydration=function(t){if(t){var e=dO();t={blockedOn:null,target:t,priority:e};for(var n=0;n<yl.length&&e!==0&&e<yl[n].priority;n++);yl.splice(n,0,t),n===0&&fO(t)}};function j1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Qw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function iR(){}function PY(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Sv(o);i.call(u)}}var o=j$(e,r,t,0,null,!1,!1,"",iR);return t._reactRootContainer=o,t[Pa]=o.current,ap(t.nodeType===8?t.parentNode:t),bu(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Sv(c);l.call(u)}}var c=A1(t,0,!1,null,null,!1,!1,"",iR);return t._reactRootContainer=c,t[Pa]=c.current,ap(t.nodeType===8?t.parentNode:t),bu(function(){Jw(e,c,n,r)}),c}function Zw(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Sv(o);l.call(c)}}Jw(e,o,t,s)}else o=PY(n,e,t,s,r);return Sv(o)}cO=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Zf(e.pendingLanes);n!==0&&(QT(e,n|1),ai(e,Ir()),!(vn&6)&&(Ih=Ir()+500,uc()))}break;case 13:bu(function(){var r=Aa(t,1);if(r!==null){var s=zs();bo(r,t,1,s)}}),k1(t,1)}};ZT=function(t){if(t.tag===13){var e=Aa(t,134217728);if(e!==null){var n=zs();bo(e,t,134217728,n)}k1(t,134217728)}};uO=function(t){if(t.tag===13){var e=Dl(t),n=Aa(t,e);if(n!==null){var r=zs();bo(n,t,e,r)}k1(t,e)}};dO=function(){return kn};hO=function(t,e){var n=kn;try{return kn=t,e()}finally{kn=n}};sE=function(t,e,n){switch(e){case"input":if(XS(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=zw(r);if(!s)throw Error(He(90));zF(r),XS(r,s)}}}break;case"textarea":WF(t,n);break;case"select":e=n.value,e!=null&&nh(t,!!n.multiple,e,!1)}};QF=T1;ZF=bu;var AY={usingClientEntryPoint:!1,Events:[Qp,Ld,zw,JF,XF,T1]},Pf={findFiberByHostInstance:Xc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kY={bundleType:Pf.bundleType,version:Pf.version,rendererPackageName:Pf.rendererPackageName,rendererConfig:Pf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ga.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=nO(t),t===null?null:t.stateNode},findFiberByHostInstance:Pf.findFiberByHostInstance||NY,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hy.isDisabled&&hy.supportsFiber)try{$w=hy.inject(kY),qo=hy}catch{}}Di.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AY;Di.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!j1(e))throw Error(He(200));return IY(t,e,null,n)};Di.createRoot=function(t,e){if(!j1(t))throw Error(He(299));var n=!1,r="",s=D$;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=A1(t,1,!1,null,null,n,!1,r,s),t[Pa]=e.current,ap(t.nodeType===8?t.parentNode:t),new R1(e)};Di.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(He(188)):(t=Object.keys(t).join(","),Error(He(268,t)));return t=nO(e),t=t===null?null:t.stateNode,t};Di.flushSync=function(t){return bu(t)};Di.hydrate=function(t,e,n){if(!Qw(e))throw Error(He(200));return Zw(null,t,e,!0,n)};Di.hydrateRoot=function(t,e,n){if(!j1(t))throw Error(He(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=D$;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=j$(e,null,t,1,n??null,s,!1,i,o),t[Pa]=e.current,ap(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Xw(e)};Di.render=function(t,e,n){if(!Qw(e))throw Error(He(200));return Zw(null,t,e,!1,n)};Di.unmountComponentAtNode=function(t){if(!Qw(t))throw Error(He(40));return t._reactRootContainer?(bu(function(){Zw(null,null,t,!1,function(){t._reactRootContainer=null,t[Pa]=null})}),!0):!1};Di.unstable_batchedUpdates=T1;Di.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Qw(n))throw Error(He(200));if(t==null||t._reactInternals===void 0)throw Error(He(38));return Zw(t,e,n,!1,r)};Di.version="18.3.1-next-f1338f8080-20240426";function M$(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(M$)}catch(t){console.error(t)}}M$(),MF.exports=Di;var Wa=MF.exports;const D1=Lw(Wa),RY=SF({__proto__:null,default:D1},[Wa]);var oR=Wa;GS.createRoot=oR.createRoot,GS.hydrateRoot=oR.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xn(){return Xn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Xn.apply(this,arguments)}var Cr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Cr||(Cr={}));const aR="popstate";function jY(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return gp("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:_u(s)}return MY(e,n,null,t)}function cn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Nh(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function DY(){return Math.random().toString(36).substr(2,8)}function lR(t,e){return{usr:t.state,key:t.key,idx:e}}function gp(t,e,n,r){return n===void 0&&(n=null),Xn({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ha(e):e,{state:n,key:e&&e.key||r||DY()})}function _u(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ha(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function MY(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=Cr.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(Xn({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){l=Cr.Pop;let E=d(),v=E==null?null:E-u;u=E,c&&c({action:l,location:x.location,delta:v})}function f(E,v){l=Cr.Push;let b=gp(x.location,E,v);n&&n(b,E),u=d()+1;let S=lR(b,u),I=x.createHref(b);try{o.pushState(S,"",I)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;s.location.assign(I)}i&&c&&c({action:l,location:x.location,delta:1})}function m(E,v){l=Cr.Replace;let b=gp(x.location,E,v);n&&n(b,E),u=d();let S=lR(b,u),I=x.createHref(b);o.replaceState(S,"",I),i&&c&&c({action:l,location:x.location,delta:0})}function g(E){let v=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof E=="string"?E:_u(E);return b=b.replace(/ $/,"%20"),cn(v,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,v)}let x={get action(){return l},get location(){return t(s,o)},listen(E){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(aR,h),c=E,()=>{s.removeEventListener(aR,h),c=null}},createHref(E){return e(s,E)},createURL:g,encodeLocation(E){let v=g(E);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:m,go(E){return o.go(E)}};return x}var Pn;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Pn||(Pn={}));const LY=new Set(["lazy","caseSensitive","path","id","index","children"]);function FY(t){return t.index===!0}function Ev(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,i)=>{let o=[...n,String(i)],l=typeof s.id=="string"?s.id:o.join("-");if(cn(s.index!==!0||!s.children,"Cannot specify children on an index route"),cn(!r[l],'Found a route id collision on id "'+l+`".  Route id's must be globally unique within Data Router usages`),FY(s)){let c=Xn({},s,e(s),{id:l});return r[l]=c,c}else{let c=Xn({},s,e(s),{id:l,children:void 0});return r[l]=c,s.children&&(c.children=Ev(s.children,e,o,r)),c}})}function Bc(t,e,n){return n===void 0&&(n="/"),vx(t,e,n,!1)}function vx(t,e,n,r){let s=typeof e=="string"?Ha(e):e,i=tf(s.pathname||"/",n);if(i==null)return null;let o=L$(t);$Y(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=JY(i);l=KY(o[c],u,r)}return l}function OY(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function L$(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(cn(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Ea([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(cn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),L$(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:HY(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of F$(i.path))s(i,o,c)}),e}function F$(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=F$(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function $Y(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:qY(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const VY=/^:[\w-]+$/,UY=3,BY=2,zY=1,GY=10,WY=-2,cR=t=>t==="*";function HY(t,e){let n=t.split("/"),r=n.length;return n.some(cR)&&(r+=WY),e&&(r+=BY),n.filter(s=>!cR(s)).reduce((s,i)=>s+(VY.test(i)?UY:i===""?zY:GY),r)}function qY(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function KY(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=uR({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h&&u&&n&&!r[r.length-1].route.index&&(h=uR({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:Ea([i,h.pathname]),pathnameBase:ZY(Ea([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=Ea([i,h.pathnameBase]))}return o}function uR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=YY(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,h)=>{let{paramName:f,isOptional:m}=d;if(f==="*"){let x=l[h]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const g=l[h];return m&&!g?u[f]=void 0:u[f]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function YY(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Nh(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function JY(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Nh(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function tf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function XY(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Ha(t):t;return{pathname:n?n.startsWith("/")?n:QY(n,e):e,search:eJ(r),hash:tJ(s)}}function QY(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function v_(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function O$(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function e0(t,e){let n=O$(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function t0(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Ha(t):(s=Xn({},t),cn(!s.pathname||!s.pathname.includes("?"),v_("?","pathname","search",s)),cn(!s.pathname||!s.pathname.includes("#"),v_("#","pathname","hash",s)),cn(!s.search||!s.search.includes("#"),v_("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let h=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}l=h>=0?e[h]:"/"}let c=XY(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Ea=t=>t.join("/").replace(/\/\/+/g,"/"),ZY=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),eJ=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,tJ=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Cv{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function yp(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const $$=["post","put","patch","delete"],nJ=new Set($$),rJ=["get",...$$],sJ=new Set(rJ),iJ=new Set([301,302,303,307,308]),oJ=new Set([307,308]),w_={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},aJ={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Af={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},M1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,lJ=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),V$="remix-router-transitions";function cJ(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;cn(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let K=t.detectErrorBoundary;s=te=>({hasErrorBoundary:K(te)})}else s=lJ;let i={},o=Ev(t.routes,s,void 0,i),l,c=t.basename||"/",u=t.dataStrategy||fJ,d=t.patchRoutesOnNavigation,h=Xn({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,m=new Set,g=null,x=null,E=null,v=t.hydrationData!=null,b=Bc(o,t.history.location,c),S=!1,I=null;if(b==null&&!d){let K=Zs(404,{pathname:t.history.location.pathname}),{matches:te,route:ce}=bR(o);b=te,I={[ce.id]:K}}b&&!t.hydrationData&&Gn(b,o,t.history.location.pathname).active&&(b=null);let D;if(b)if(b.some(K=>K.route.lazy))D=!1;else if(!b.some(K=>K.route.loader))D=!0;else if(h.v7_partialHydration){let K=t.hydrationData?t.hydrationData.loaderData:null,te=t.hydrationData?t.hydrationData.errors:null;if(te){let ce=b.findIndex(ke=>te[ke.route.id]!==void 0);D=b.slice(0,ce+1).every(ke=>!OE(ke.route,K,te))}else D=b.every(ce=>!OE(ce.route,K,te))}else D=t.hydrationData!=null;else if(D=!1,b=[],h.v7_partialHydration){let K=Gn(null,o,t.history.location.pathname);K.active&&K.matches&&(S=!0,b=K.matches)}let k,C={historyAction:t.history.action,location:t.history.location,matches:b,initialized:D,navigation:w_,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||I,fetchers:new Map,blockers:new Map},T=Cr.Pop,P=!1,A,R=!1,M=new Map,j=null,z=!1,W=!1,q=[],H=new Set,$=new Map,J=0,O=-1,V=new Map,G=new Set,F=new Map,ue=new Map,Ee=new Set,Se=new Map,we=new Map,Fe;function Ze(){if(f=t.history.listen(K=>{let{action:te,location:ce,delta:ke}=K;if(Fe){Fe(),Fe=void 0;return}Nh(we.size===0||ke!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Ve=wt({currentLocation:C.location,nextLocation:ce,historyAction:te});if(Ve&&ke!=null){let Y=new Promise(Z=>{Fe=Z});t.history.go(ke*-1),gt(Ve,{state:"blocked",location:ce,proceed(){gt(Ve,{state:"proceeding",proceed:void 0,reset:void 0,location:ce}),Y.then(()=>t.history.go(ke))},reset(){let Z=new Map(C.blockers);Z.set(Ve,Af),qe({blockers:Z})}});return}return pt(te,ce)}),n){IJ(e,M);let K=()=>NJ(e,M);e.addEventListener("pagehide",K),j=()=>e.removeEventListener("pagehide",K)}return C.initialized||pt(Cr.Pop,C.location,{initialHydration:!0}),k}function ze(){f&&f(),j&&j(),m.clear(),A&&A.abort(),C.fetchers.forEach((K,te)=>me(te)),C.blockers.forEach((K,te)=>ve(te))}function nt(K){return m.add(K),()=>m.delete(K)}function qe(K,te){te===void 0&&(te={}),C=Xn({},C,K);let ce=[],ke=[];h.v7_fetcherPersist&&C.fetchers.forEach((Ve,Y)=>{Ve.state==="idle"&&(Ee.has(Y)?ke.push(Y):ce.push(Y))}),Ee.forEach(Ve=>{!C.fetchers.has(Ve)&&!$.has(Ve)&&ke.push(Ve)}),[...m].forEach(Ve=>Ve(C,{deletedFetchers:ke,viewTransitionOpts:te.viewTransitionOpts,flushSync:te.flushSync===!0})),h.v7_fetcherPersist?(ce.forEach(Ve=>C.fetchers.delete(Ve)),ke.forEach(Ve=>me(Ve))):ke.forEach(Ve=>Ee.delete(Ve))}function yt(K,te,ce){var ke,Ve;let{flushSync:Y}=ce===void 0?{}:ce,Z=C.actionData!=null&&C.navigation.formMethod!=null&&fo(C.navigation.formMethod)&&C.navigation.state==="loading"&&((ke=K.state)==null?void 0:ke._isRedirect)!==!0,oe;te.actionData?Object.keys(te.actionData).length>0?oe=te.actionData:oe=null:Z?oe=C.actionData:oe=null;let be=te.loaderData?vR(C.loaderData,te.loaderData,te.matches||[],te.errors):C.loaderData,Ce=C.blockers;Ce.size>0&&(Ce=new Map(Ce),Ce.forEach((Re,et)=>Ce.set(et,Af)));let Q=P===!0||C.navigation.formMethod!=null&&fo(C.navigation.formMethod)&&((Ve=K.state)==null?void 0:Ve._isRedirect)!==!0;l&&(o=l,l=void 0),z||T===Cr.Pop||(T===Cr.Push?t.history.push(K,K.state):T===Cr.Replace&&t.history.replace(K,K.state));let fe;if(T===Cr.Pop){let Re=M.get(C.location.pathname);Re&&Re.has(K.pathname)?fe={currentLocation:C.location,nextLocation:K}:M.has(K.pathname)&&(fe={currentLocation:K,nextLocation:C.location})}else if(R){let Re=M.get(C.location.pathname);Re?Re.add(K.pathname):(Re=new Set([K.pathname]),M.set(C.location.pathname,Re)),fe={currentLocation:C.location,nextLocation:K}}qe(Xn({},te,{actionData:oe,loaderData:be,historyAction:T,location:K,initialized:!0,navigation:w_,revalidation:"idle",restoreScrollPosition:_r(K,te.matches||C.matches),preventScrollReset:Q,blockers:Ce}),{viewTransitionOpts:fe,flushSync:Y===!0}),T=Cr.Pop,P=!1,R=!1,z=!1,W=!1,q=[]}async function Le(K,te){if(typeof K=="number"){t.history.go(K);return}let ce=FE(C.location,C.matches,c,h.v7_prependBasename,K,h.v7_relativeSplatPath,te==null?void 0:te.fromRouteId,te==null?void 0:te.relative),{path:ke,submission:Ve,error:Y}=dR(h.v7_normalizeFormMethod,!1,ce,te),Z=C.location,oe=gp(C.location,ke,te&&te.state);oe=Xn({},oe,t.history.encodeLocation(oe));let be=te&&te.replace!=null?te.replace:void 0,Ce=Cr.Push;be===!0?Ce=Cr.Replace:be===!1||Ve!=null&&fo(Ve.formMethod)&&Ve.formAction===C.location.pathname+C.location.search&&(Ce=Cr.Replace);let Q=te&&"preventScrollReset"in te?te.preventScrollReset===!0:void 0,fe=(te&&te.flushSync)===!0,Re=wt({currentLocation:Z,nextLocation:oe,historyAction:Ce});if(Re){gt(Re,{state:"blocked",location:oe,proceed(){gt(Re,{state:"proceeding",proceed:void 0,reset:void 0,location:oe}),Le(K,te)},reset(){let et=new Map(C.blockers);et.set(Re,Af),qe({blockers:et})}});return}return await pt(Ce,oe,{submission:Ve,pendingError:Y,preventScrollReset:Q,replace:te&&te.replace,enableViewTransition:te&&te.viewTransition,flushSync:fe})}function Ae(){if(Ie(),qe({revalidation:"loading"}),C.navigation.state!=="submitting"){if(C.navigation.state==="idle"){pt(C.historyAction,C.location,{startUninterruptedRevalidation:!0});return}pt(T||C.historyAction,C.navigation.location,{overrideNavigation:C.navigation,enableViewTransition:R===!0})}}async function pt(K,te,ce){A&&A.abort(),A=null,T=K,z=(ce&&ce.startUninterruptedRevalidation)===!0,on(C.location,C.matches),P=(ce&&ce.preventScrollReset)===!0,R=(ce&&ce.enableViewTransition)===!0;let ke=l||o,Ve=ce&&ce.overrideNavigation,Y=ce!=null&&ce.initialHydration&&C.matches&&C.matches.length>0&&!S?C.matches:Bc(ke,te,c),Z=(ce&&ce.flushSync)===!0;if(Y&&C.initialized&&!W&&vJ(C.location,te)&&!(ce&&ce.submission&&fo(ce.submission.formMethod))){yt(te,{matches:Y},{flushSync:Z});return}let oe=Gn(Y,ke,te.pathname);if(oe.active&&oe.matches&&(Y=oe.matches),!Y){let{error:it,notFoundMatches:Te,route:ft}=dt(te.pathname);yt(te,{matches:Te,loaderData:{},errors:{[ft.id]:it}},{flushSync:Z});return}A=new AbortController;let be=id(t.history,te,A.signal,ce&&ce.submission),Ce;if(ce&&ce.pendingError)Ce=[zc(Y).route.id,{type:Pn.error,error:ce.pendingError}];else if(ce&&ce.submission&&fo(ce.submission.formMethod)){let it=await mt(be,te,ce.submission,Y,oe.active,{replace:ce.replace,flushSync:Z});if(it.shortCircuited)return;if(it.pendingActionResult){let[Te,ft]=it.pendingActionResult;if(bi(ft)&&yp(ft.error)&&ft.error.status===404){A=null,yt(te,{matches:it.matches,loaderData:{},errors:{[Te]:ft.error}});return}}Y=it.matches||Y,Ce=it.pendingActionResult,Ve=b_(te,ce.submission),Z=!1,oe.active=!1,be=id(t.history,be.url,be.signal)}let{shortCircuited:Q,matches:fe,loaderData:Re,errors:et}=await Ht(be,te,Y,oe.active,Ve,ce&&ce.submission,ce&&ce.fetcherSubmission,ce&&ce.replace,ce&&ce.initialHydration===!0,Z,Ce);Q||(A=null,yt(te,Xn({matches:fe||Y},wR(Ce),{loaderData:Re,errors:et})))}async function mt(K,te,ce,ke,Ve,Y){Y===void 0&&(Y={}),Ie();let Z=CJ(te,ce);if(qe({navigation:Z},{flushSync:Y.flushSync===!0}),Ve){let Ce=await Jt(ke,te.pathname,K.signal);if(Ce.type==="aborted")return{shortCircuited:!0};if(Ce.type==="error"){let Q=zc(Ce.partialMatches).route.id;return{matches:Ce.partialMatches,pendingActionResult:[Q,{type:Pn.error,error:Ce.error}]}}else if(Ce.matches)ke=Ce.matches;else{let{notFoundMatches:Q,error:fe,route:Re}=dt(te.pathname);return{matches:Q,pendingActionResult:[Re.id,{type:Pn.error,error:fe}]}}}let oe,be=tm(ke,te);if(!be.route.action&&!be.route.lazy)oe={type:Pn.error,error:Zs(405,{method:K.method,pathname:te.pathname,routeId:be.route.id})};else if(oe=(await ct("action",C,K,[be],ke,null))[be.route.id],K.signal.aborted)return{shortCircuited:!0};if(eu(oe)){let Ce;return Y&&Y.replace!=null?Ce=Y.replace:Ce=gR(oe.response.headers.get("Location"),new URL(K.url),c)===C.location.pathname+C.location.search,await Be(K,oe,!0,{submission:ce,replace:Ce}),{shortCircuited:!0}}if(Tl(oe))throw Zs(400,{type:"defer-action"});if(bi(oe)){let Ce=zc(ke,be.route.id);return(Y&&Y.replace)!==!0&&(T=Cr.Push),{matches:ke,pendingActionResult:[Ce.route.id,oe]}}return{matches:ke,pendingActionResult:[be.route.id,oe]}}async function Ht(K,te,ce,ke,Ve,Y,Z,oe,be,Ce,Q){let fe=Ve||b_(te,Y),Re=Y||Z||SR(fe),et=!z&&(!h.v7_partialHydration||!be);if(ke){if(et){let se=Ft(Q);qe(Xn({navigation:fe},se!==void 0?{actionData:se}:{}),{flushSync:Ce})}let Xt=await Jt(ce,te.pathname,K.signal);if(Xt.type==="aborted")return{shortCircuited:!0};if(Xt.type==="error"){let se=zc(Xt.partialMatches).route.id;return{matches:Xt.partialMatches,loaderData:{},errors:{[se]:Xt.error}}}else if(Xt.matches)ce=Xt.matches;else{let{error:se,notFoundMatches:de,route:ae}=dt(te.pathname);return{matches:de,loaderData:{},errors:{[ae.id]:se}}}}let it=l||o,[Te,ft]=fR(t.history,C,ce,Re,te,h.v7_partialHydration&&be===!0,h.v7_skipActionErrorRevalidation,W,q,H,Ee,F,G,it,c,Q);if(xt(Xt=>!(ce&&ce.some(se=>se.route.id===Xt))||Te&&Te.some(se=>se.route.id===Xt)),O=++J,Te.length===0&&ft.length===0){let Xt=re();return yt(te,Xn({matches:ce,loaderData:{},errors:Q&&bi(Q[1])?{[Q[0]]:Q[1].error}:null},wR(Q),Xt?{fetchers:new Map(C.fetchers)}:{}),{flushSync:Ce}),{shortCircuited:!0}}if(et){let Xt={};if(!ke){Xt.navigation=fe;let se=Ft(Q);se!==void 0&&(Xt.actionData=se)}ft.length>0&&(Xt.fetchers=nn(ft)),qe(Xt,{flushSync:Ce})}ft.forEach(Xt=>{De(Xt.key),Xt.controller&&$.set(Xt.key,Xt.controller)});let Ct=()=>ft.forEach(Xt=>De(Xt.key));A&&A.signal.addEventListener("abort",Ct);let{loaderResults:mn,fetcherResults:xn}=await he(C,ce,Te,ft,K);if(K.signal.aborted)return{shortCircuited:!0};A&&A.signal.removeEventListener("abort",Ct),ft.forEach(Xt=>$.delete(Xt.key));let nr=fy(mn);if(nr)return await Be(K,nr.result,!0,{replace:oe}),{shortCircuited:!0};if(nr=fy(xn),nr)return G.add(nr.key),await Be(K,nr.result,!0,{replace:oe}),{shortCircuited:!0};let{loaderData:Kn,errors:hs}=xR(C,ce,mn,Q,ft,xn,Se);Se.forEach((Xt,se)=>{Xt.subscribe(de=>{(de||Xt.done)&&Se.delete(se)})}),h.v7_partialHydration&&be&&C.errors&&(hs=Xn({},C.errors,hs));let fs=re(),Js=pe(O),ms=fs||Js||ft.length>0;return Xn({matches:ce,loaderData:Kn,errors:hs},ms?{fetchers:new Map(C.fetchers)}:{})}function Ft(K){if(K&&!bi(K[1]))return{[K[0]]:K[1].data};if(C.actionData)return Object.keys(C.actionData).length===0?null:C.actionData}function nn(K){return K.forEach(te=>{let ce=C.fetchers.get(te.key),ke=kf(void 0,ce?ce.data:void 0);C.fetchers.set(te.key,ke)}),new Map(C.fetchers)}function Tn(K,te,ce,ke){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");De(K);let Ve=(ke&&ke.flushSync)===!0,Y=l||o,Z=FE(C.location,C.matches,c,h.v7_prependBasename,ce,h.v7_relativeSplatPath,te,ke==null?void 0:ke.relative),oe=Bc(Y,Z,c),be=Gn(oe,Y,Z);if(be.active&&be.matches&&(oe=be.matches),!oe){ne(K,te,Zs(404,{pathname:Z}),{flushSync:Ve});return}let{path:Ce,submission:Q,error:fe}=dR(h.v7_normalizeFormMethod,!0,Z,ke);if(fe){ne(K,te,fe,{flushSync:Ve});return}let Re=tm(oe,Ce),et=(ke&&ke.preventScrollReset)===!0;if(Q&&fo(Q.formMethod)){gn(K,te,Ce,Re,oe,be.active,Ve,et,Q);return}F.set(K,{routeId:te,path:Ce}),Qe(K,te,Ce,Re,oe,be.active,Ve,et,Q)}async function gn(K,te,ce,ke,Ve,Y,Z,oe,be){Ie(),F.delete(K);function Ce(ge){if(!ge.route.action&&!ge.route.lazy){let Ne=Zs(405,{method:be.formMethod,pathname:ce,routeId:te});return ne(K,te,Ne,{flushSync:Z}),!0}return!1}if(!Y&&Ce(ke))return;let Q=C.fetchers.get(K);ee(K,TJ(be,Q),{flushSync:Z});let fe=new AbortController,Re=id(t.history,ce,fe.signal,be);if(Y){let ge=await Jt(Ve,new URL(Re.url).pathname,Re.signal,K);if(ge.type==="aborted")return;if(ge.type==="error"){ne(K,te,ge.error,{flushSync:Z});return}else if(ge.matches){if(Ve=ge.matches,ke=tm(Ve,ce),Ce(ke))return}else{ne(K,te,Zs(404,{pathname:ce}),{flushSync:Z});return}}$.set(K,fe);let et=J,Te=(await ct("action",C,Re,[ke],Ve,K))[ke.route.id];if(Re.signal.aborted){$.get(K)===fe&&$.delete(K);return}if(h.v7_fetcherPersist&&Ee.has(K)){if(eu(Te)||bi(Te)){ee(K,cl(void 0));return}}else{if(eu(Te))if($.delete(K),O>et){ee(K,cl(void 0));return}else return G.add(K),ee(K,kf(be)),Be(Re,Te,!1,{fetcherSubmission:be,preventScrollReset:oe});if(bi(Te)){ne(K,te,Te.error);return}}if(Tl(Te))throw Zs(400,{type:"defer-action"});let ft=C.navigation.location||C.location,Ct=id(t.history,ft,fe.signal),mn=l||o,xn=C.navigation.state!=="idle"?Bc(mn,C.navigation.location,c):C.matches;cn(xn,"Didn't find any matches after fetcher action");let nr=++J;V.set(K,nr);let Kn=kf(be,Te.data);C.fetchers.set(K,Kn);let[hs,fs]=fR(t.history,C,xn,be,ft,!1,h.v7_skipActionErrorRevalidation,W,q,H,Ee,F,G,mn,c,[ke.route.id,Te]);fs.filter(ge=>ge.key!==K).forEach(ge=>{let Ne=ge.key,$e=C.fetchers.get(Ne),_e=kf(void 0,$e?$e.data:void 0);C.fetchers.set(Ne,_e),De(Ne),ge.controller&&$.set(Ne,ge.controller)}),qe({fetchers:new Map(C.fetchers)});let Js=()=>fs.forEach(ge=>De(ge.key));fe.signal.addEventListener("abort",Js);let{loaderResults:ms,fetcherResults:Xt}=await he(C,xn,hs,fs,Ct);if(fe.signal.aborted)return;fe.signal.removeEventListener("abort",Js),V.delete(K),$.delete(K),fs.forEach(ge=>$.delete(ge.key));let se=fy(ms);if(se)return Be(Ct,se.result,!1,{preventScrollReset:oe});if(se=fy(Xt),se)return G.add(se.key),Be(Ct,se.result,!1,{preventScrollReset:oe});let{loaderData:de,errors:ae}=xR(C,xn,ms,void 0,fs,Xt,Se);if(C.fetchers.has(K)){let ge=cl(Te.data);C.fetchers.set(K,ge)}pe(nr),C.navigation.state==="loading"&&nr>O?(cn(T,"Expected pending action"),A&&A.abort(),yt(C.navigation.location,{matches:xn,loaderData:de,errors:ae,fetchers:new Map(C.fetchers)})):(qe({errors:ae,loaderData:vR(C.loaderData,de,xn,ae),fetchers:new Map(C.fetchers)}),W=!1)}async function Qe(K,te,ce,ke,Ve,Y,Z,oe,be){let Ce=C.fetchers.get(K);ee(K,kf(be,Ce?Ce.data:void 0),{flushSync:Z});let Q=new AbortController,fe=id(t.history,ce,Q.signal);if(Y){let Te=await Jt(Ve,new URL(fe.url).pathname,fe.signal,K);if(Te.type==="aborted")return;if(Te.type==="error"){ne(K,te,Te.error,{flushSync:Z});return}else if(Te.matches)Ve=Te.matches,ke=tm(Ve,ce);else{ne(K,te,Zs(404,{pathname:ce}),{flushSync:Z});return}}$.set(K,Q);let Re=J,it=(await ct("loader",C,fe,[ke],Ve,K))[ke.route.id];if(Tl(it)&&(it=await L1(it,fe.signal,!0)||it),$.get(K)===Q&&$.delete(K),!fe.signal.aborted){if(Ee.has(K)){ee(K,cl(void 0));return}if(eu(it))if(O>Re){ee(K,cl(void 0));return}else{G.add(K),await Be(fe,it,!1,{preventScrollReset:oe});return}if(bi(it)){ne(K,te,it.error);return}cn(!Tl(it),"Unhandled fetcher deferred data"),ee(K,cl(it.data))}}async function Be(K,te,ce,ke){let{submission:Ve,fetcherSubmission:Y,preventScrollReset:Z,replace:oe}=ke===void 0?{}:ke;te.response.headers.has("X-Remix-Revalidate")&&(W=!0);let be=te.response.headers.get("Location");cn(be,"Expected a Location header on the redirect Response"),be=gR(be,new URL(K.url),c);let Ce=gp(C.location,be,{_isRedirect:!0});if(n){let Te=!1;if(te.response.headers.has("X-Remix-Reload-Document"))Te=!0;else if(M1.test(be)){const ft=t.history.createURL(be);Te=ft.origin!==e.location.origin||tf(ft.pathname,c)==null}if(Te){oe?e.location.replace(be):e.location.assign(be);return}}A=null;let Q=oe===!0||te.response.headers.has("X-Remix-Replace")?Cr.Replace:Cr.Push,{formMethod:fe,formAction:Re,formEncType:et}=C.navigation;!Ve&&!Y&&fe&&Re&&et&&(Ve=SR(C.navigation));let it=Ve||Y;if(oJ.has(te.response.status)&&it&&fo(it.formMethod))await pt(Q,Ce,{submission:Xn({},it,{formAction:be}),preventScrollReset:Z||P,enableViewTransition:ce?R:void 0});else{let Te=b_(Ce,Ve);await pt(Q,Ce,{overrideNavigation:Te,fetcherSubmission:Y,preventScrollReset:Z||P,enableViewTransition:ce?R:void 0})}}async function ct(K,te,ce,ke,Ve,Y){let Z,oe={};try{Z=await mJ(u,K,te,ce,ke,Ve,Y,i,s)}catch(be){return ke.forEach(Ce=>{oe[Ce.route.id]={type:Pn.error,error:be}}),oe}for(let[be,Ce]of Object.entries(Z))if(wJ(Ce)){let Q=Ce.result;oe[be]={type:Pn.redirect,response:yJ(Q,ce,be,Ve,c,h.v7_relativeSplatPath)}}else oe[be]=await gJ(Ce);return oe}async function he(K,te,ce,ke,Ve){let Y=K.matches,Z=ct("loader",K,Ve,ce,te,null),oe=Promise.all(ke.map(async Q=>{if(Q.matches&&Q.match&&Q.controller){let Re=(await ct("loader",K,id(t.history,Q.path,Q.controller.signal),[Q.match],Q.matches,Q.key))[Q.match.route.id];return{[Q.key]:Re}}else return Promise.resolve({[Q.key]:{type:Pn.error,error:Zs(404,{pathname:Q.path})}})})),be=await Z,Ce=(await oe).reduce((Q,fe)=>Object.assign(Q,fe),{});return await Promise.all([SJ(te,be,Ve.signal,Y,K.loaderData),EJ(te,Ce,ke)]),{loaderResults:be,fetcherResults:Ce}}function Ie(){W=!0,q.push(...xt()),F.forEach((K,te)=>{$.has(te)&&H.add(te),De(te)})}function ee(K,te,ce){ce===void 0&&(ce={}),C.fetchers.set(K,te),qe({fetchers:new Map(C.fetchers)},{flushSync:(ce&&ce.flushSync)===!0})}function ne(K,te,ce,ke){ke===void 0&&(ke={});let Ve=zc(C.matches,te);me(K),qe({errors:{[Ve.route.id]:ce},fetchers:new Map(C.fetchers)},{flushSync:(ke&&ke.flushSync)===!0})}function X(K){return ue.set(K,(ue.get(K)||0)+1),Ee.has(K)&&Ee.delete(K),C.fetchers.get(K)||aJ}function me(K){let te=C.fetchers.get(K);$.has(K)&&!(te&&te.state==="loading"&&V.has(K))&&De(K),F.delete(K),V.delete(K),G.delete(K),h.v7_fetcherPersist&&Ee.delete(K),H.delete(K),C.fetchers.delete(K)}function ye(K){let te=(ue.get(K)||0)-1;te<=0?(ue.delete(K),Ee.add(K),h.v7_fetcherPersist||me(K)):ue.set(K,te),qe({fetchers:new Map(C.fetchers)})}function De(K){let te=$.get(K);te&&(te.abort(),$.delete(K))}function Oe(K){for(let te of K){let ce=X(te),ke=cl(ce.data);C.fetchers.set(te,ke)}}function re(){let K=[],te=!1;for(let ce of G){let ke=C.fetchers.get(ce);cn(ke,"Expected fetcher: "+ce),ke.state==="loading"&&(G.delete(ce),K.push(ce),te=!0)}return Oe(K),te}function pe(K){let te=[];for(let[ce,ke]of V)if(ke<K){let Ve=C.fetchers.get(ce);cn(Ve,"Expected fetcher: "+ce),Ve.state==="loading"&&(De(ce),V.delete(ce),te.push(ce))}return Oe(te),te.length>0}function Me(K,te){let ce=C.blockers.get(K)||Af;return we.get(K)!==te&&we.set(K,te),ce}function ve(K){C.blockers.delete(K),we.delete(K)}function gt(K,te){let ce=C.blockers.get(K)||Af;cn(ce.state==="unblocked"&&te.state==="blocked"||ce.state==="blocked"&&te.state==="blocked"||ce.state==="blocked"&&te.state==="proceeding"||ce.state==="blocked"&&te.state==="unblocked"||ce.state==="proceeding"&&te.state==="unblocked","Invalid blocker state transition: "+ce.state+" -> "+te.state);let ke=new Map(C.blockers);ke.set(K,te),qe({blockers:ke})}function wt(K){let{currentLocation:te,nextLocation:ce,historyAction:ke}=K;if(we.size===0)return;we.size>1&&Nh(!1,"A router only supports one blocker at a time");let Ve=Array.from(we.entries()),[Y,Z]=Ve[Ve.length-1],oe=C.blockers.get(Y);if(!(oe&&oe.state==="proceeding")&&Z({currentLocation:te,nextLocation:ce,historyAction:ke}))return Y}function dt(K){let te=Zs(404,{pathname:K}),ce=l||o,{matches:ke,route:Ve}=bR(ce);return xt(),{notFoundMatches:ke,route:Ve,error:te}}function xt(K){let te=[];return Se.forEach((ce,ke)=>{(!K||K(ke))&&(ce.cancel(),te.push(ke),Se.delete(ke))}),te}function At(K,te,ce){if(g=K,E=te,x=ce||null,!v&&C.navigation===w_){v=!0;let ke=_r(C.location,C.matches);ke!=null&&qe({restoreScrollPosition:ke})}return()=>{g=null,E=null,x=null}}function Nn(K,te){return x&&x(K,te.map(ke=>OY(ke,C.loaderData)))||K.key}function on(K,te){if(g&&E){let ce=Nn(K,te);g[ce]=E()}}function _r(K,te){if(g){let ce=Nn(K,te),ke=g[ce];if(typeof ke=="number")return ke}return null}function Gn(K,te,ce){if(d)if(K){if(Object.keys(K[0].params).length>0)return{active:!0,matches:vx(te,ce,c,!0)}}else return{active:!0,matches:vx(te,ce,c,!0)||[]};return{active:!1,matches:null}}async function Jt(K,te,ce,ke){if(!d)return{type:"success",matches:K};let Ve=K;for(;;){let Y=l==null,Z=l||o,oe=i;try{await d({signal:ce,path:te,matches:Ve,fetcherKey:ke,patch:(Q,fe)=>{ce.aborted||pR(Q,fe,Z,oe,s)}})}catch(Q){return{type:"error",error:Q,partialMatches:Ve}}finally{Y&&!ce.aborted&&(o=[...o])}if(ce.aborted)return{type:"aborted"};let be=Bc(Z,te,c);if(be)return{type:"success",matches:be};let Ce=vx(Z,te,c,!0);if(!Ce||Ve.length===Ce.length&&Ve.every((Q,fe)=>Q.route.id===Ce[fe].route.id))return{type:"success",matches:null};Ve=Ce}}function an(K){i={},l=Ev(K,s,void 0,i)}function Mn(K,te){let ce=l==null;pR(K,te,l||o,i,s),ce&&(o=[...o],qe({}))}return k={get basename(){return c},get future(){return h},get state(){return C},get routes(){return o},get window(){return e},initialize:Ze,subscribe:nt,enableScrollRestoration:At,navigate:Le,fetch:Tn,revalidate:Ae,createHref:K=>t.history.createHref(K),encodeLocation:K=>t.history.encodeLocation(K),getFetcher:X,deleteFetcher:ye,dispose:ze,getBlocker:Me,deleteBlocker:ve,patchRoutes:Mn,_internalFetchControllers:$,_internalActiveDeferreds:Se,_internalSetRoutes:an},k}function uJ(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function FE(t,e,n,r,s,i,o,l){let c,u;if(o){c=[];for(let h of e)if(c.push(h),h.route.id===o){u=h;break}}else c=e,u=e[e.length-1];let d=t0(s||".",e0(c,i),tf(t.pathname,n)||t.pathname,l==="path");if(s==null&&(d.search=t.search,d.hash=t.hash),(s==null||s===""||s===".")&&u){let h=F1(d.search);if(u.route.index&&!h)d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index";else if(!u.route.index&&h){let f=new URLSearchParams(d.search),m=f.getAll("index");f.delete("index"),m.filter(x=>x).forEach(x=>f.append("index",x));let g=f.toString();d.search=g?"?"+g:""}}return r&&n!=="/"&&(d.pathname=d.pathname==="/"?n:Ea([n,d.pathname])),_u(d)}function dR(t,e,n,r){if(!r||!uJ(r))return{path:n};if(r.formMethod&&!_J(r.formMethod))return{path:n,error:Zs(405,{method:r.formMethod})};let s=()=>({path:n,error:Zs(400,{type:"invalid-body"})}),i=r.formMethod||"get",o=t?i.toUpperCase():i.toLowerCase(),l=z$(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!fo(o))return s();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((m,g)=>{let[x,E]=g;return""+m+x+"="+E+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!fo(o))return s();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return s()}}}cn(typeof FormData=="function","FormData is not available in this environment");let c,u;if(r.formData)c=$E(r.formData),u=r.formData;else if(r.body instanceof FormData)c=$E(r.body),u=r.body;else if(r.body instanceof URLSearchParams)c=r.body,u=yR(c);else if(r.body==null)c=new URLSearchParams,u=new FormData;else try{c=new URLSearchParams(r.body),u=yR(c)}catch{return s()}let d={formMethod:o,formAction:l,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(fo(d.formMethod))return{path:n,submission:d};let h=Ha(n);return e&&h.search&&F1(h.search)&&c.append("index",""),h.search="?"+c,{path:_u(h),submission:d}}function hR(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(s=>s.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function fR(t,e,n,r,s,i,o,l,c,u,d,h,f,m,g,x){let E=x?bi(x[1])?x[1].error:x[1].data:void 0,v=t.createURL(e.location),b=t.createURL(s),S=n;i&&e.errors?S=hR(n,Object.keys(e.errors)[0],!0):x&&bi(x[1])&&(S=hR(n,x[0]));let I=x?x[1].statusCode:void 0,D=o&&I&&I>=400,k=S.filter((T,P)=>{let{route:A}=T;if(A.lazy)return!0;if(A.loader==null)return!1;if(i)return OE(A,e.loaderData,e.errors);if(dJ(e.loaderData,e.matches[P],T)||c.some(j=>j===T.route.id))return!0;let R=e.matches[P],M=T;return mR(T,Xn({currentUrl:v,currentParams:R.params,nextUrl:b,nextParams:M.params},r,{actionResult:E,actionStatus:I,defaultShouldRevalidate:D?!1:l||v.pathname+v.search===b.pathname+b.search||v.search!==b.search||U$(R,M)}))}),C=[];return h.forEach((T,P)=>{if(i||!n.some(z=>z.route.id===T.routeId)||d.has(P))return;let A=Bc(m,T.path,g);if(!A){C.push({key:P,routeId:T.routeId,path:T.path,matches:null,match:null,controller:null});return}let R=e.fetchers.get(P),M=tm(A,T.path),j=!1;f.has(P)?j=!1:u.has(P)?(u.delete(P),j=!0):R&&R.state!=="idle"&&R.data===void 0?j=l:j=mR(M,Xn({currentUrl:v,currentParams:e.matches[e.matches.length-1].params,nextUrl:b,nextParams:n[n.length-1].params},r,{actionResult:E,actionStatus:I,defaultShouldRevalidate:D?!1:l})),j&&C.push({key:P,routeId:T.routeId,path:T.path,matches:A,match:M,controller:new AbortController})}),[k,C]}function OE(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,s=n!=null&&n[t.id]!==void 0;return!r&&s?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!s}function dJ(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function U$(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function mR(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function pR(t,e,n,r,s){var i;let o;if(t){let u=r[t];cn(u,"No route found to patch children into: routeId = "+t),u.children||(u.children=[]),o=u.children}else o=n;let l=e.filter(u=>!o.some(d=>B$(u,d))),c=Ev(l,s,[t||"_","patch",String(((i=o)==null?void 0:i.length)||"0")],r);o.push(...c)}function B$(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var s;return(s=e.children)==null?void 0:s.some(i=>B$(n,i))}):!1}async function hJ(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];cn(s,"No route found in manifest");let i={};for(let o in r){let c=s[o]!==void 0&&o!=="hasErrorBoundary";Nh(!c,'Route "'+s.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!c&&!LY.has(o)&&(i[o]=r[o])}Object.assign(s,i),Object.assign(s,Xn({},e(s),{lazy:void 0}))}async function fJ(t){let{matches:e}=t,n=e.filter(s=>s.shouldLoad);return(await Promise.all(n.map(s=>s.resolve()))).reduce((s,i,o)=>Object.assign(s,{[n[o].route.id]:i}),{})}async function mJ(t,e,n,r,s,i,o,l,c,u){let d=i.map(m=>m.route.lazy?hJ(m.route,c,l):void 0),h=i.map((m,g)=>{let x=d[g],E=s.some(b=>b.route.id===m.route.id);return Xn({},m,{shouldLoad:E,resolve:async b=>(b&&r.method==="GET"&&(m.route.lazy||m.route.loader)&&(E=!0),E?pJ(e,r,m,x,b,u):Promise.resolve({type:Pn.data,result:void 0}))})}),f=await t({matches:h,request:r,params:i[0].params,fetcherKey:o,context:u});try{await Promise.all(d)}catch{}return f}async function pJ(t,e,n,r,s,i){let o,l,c=u=>{let d,h=new Promise((g,x)=>d=x);l=()=>d(),e.signal.addEventListener("abort",l);let f=g=>typeof u!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):u({request:e,params:n.params,context:i},...g!==void 0?[g]:[]),m=(async()=>{try{return{type:"data",result:await(s?s(x=>f(x)):f())}}catch(g){return{type:"error",result:g}}})();return Promise.race([m,h])};try{let u=n.route[t];if(r)if(u){let d,[h]=await Promise.all([c(u).catch(f=>{d=f}),r]);if(d!==void 0)throw d;o=h}else if(await r,u=n.route[t],u)o=await c(u);else if(t==="action"){let d=new URL(e.url),h=d.pathname+d.search;throw Zs(405,{method:e.method,pathname:h,routeId:n.route.id})}else return{type:Pn.data,result:void 0};else if(u)o=await c(u);else{let d=new URL(e.url),h=d.pathname+d.search;throw Zs(404,{pathname:h})}cn(o.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(u){return{type:Pn.error,result:u}}finally{l&&e.signal.removeEventListener("abort",l)}return o}async function gJ(t){let{result:e,type:n}=t;if(G$(e)){let h;try{let f=e.headers.get("Content-Type");f&&/\bapplication\/json\b/.test(f)?e.body==null?h=null:h=await e.json():h=await e.text()}catch(f){return{type:Pn.error,error:f}}return n===Pn.error?{type:Pn.error,error:new Cv(e.status,e.statusText,h),statusCode:e.status,headers:e.headers}:{type:Pn.data,data:h,statusCode:e.status,headers:e.headers}}if(n===Pn.error){if(_R(e)){var r,s;if(e.data instanceof Error){var i,o;return{type:Pn.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}}return{type:Pn.error,error:new Cv(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:yp(e)?e.status:void 0,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:Pn.error,error:e,statusCode:yp(e)?e.status:void 0}}if(bJ(e)){var l,c;return{type:Pn.deferred,deferredData:e,statusCode:(l=e.init)==null?void 0:l.status,headers:((c=e.init)==null?void 0:c.headers)&&new Headers(e.init.headers)}}if(_R(e)){var u,d;return{type:Pn.data,data:e.data,statusCode:(u=e.init)==null?void 0:u.status,headers:(d=e.init)!=null&&d.headers?new Headers(e.init.headers):void 0}}return{type:Pn.data,data:e}}function yJ(t,e,n,r,s,i){let o=t.headers.get("Location");if(cn(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!M1.test(o)){let l=r.slice(0,r.findIndex(c=>c.route.id===n)+1);o=FE(new URL(e.url),l,s,!0,o,i),t.headers.set("Location",o)}return t}function gR(t,e,n){if(M1.test(t)){let r=t,s=r.startsWith("//")?new URL(e.protocol+r):new URL(r),i=tf(s.pathname,n)!=null;if(s.origin===e.origin&&i)return s.pathname+s.search+s.hash}return t}function id(t,e,n,r){let s=t.createURL(z$(e)).toString(),i={signal:n};if(r&&fo(r.formMethod)){let{formMethod:o,formEncType:l}=r;i.method=o.toUpperCase(),l==="application/json"?(i.headers=new Headers({"Content-Type":l}),i.body=JSON.stringify(r.json)):l==="text/plain"?i.body=r.text:l==="application/x-www-form-urlencoded"&&r.formData?i.body=$E(r.formData):i.body=r.formData}return new Request(s,i)}function $E(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function yR(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function xJ(t,e,n,r,s){let i={},o=null,l,c=!1,u={},d=n&&bi(n[1])?n[1].error:void 0;return t.forEach(h=>{if(!(h.route.id in e))return;let f=h.route.id,m=e[f];if(cn(!eu(m),"Cannot handle redirect results in processLoaderData"),bi(m)){let g=m.error;if(d!==void 0&&(g=d,d=void 0),o=o||{},s)o[f]=g;else{let x=zc(t,f);o[x.route.id]==null&&(o[x.route.id]=g)}i[f]=void 0,c||(c=!0,l=yp(m.error)?m.error.status:500),m.headers&&(u[f]=m.headers)}else Tl(m)?(r.set(f,m.deferredData),i[f]=m.deferredData.data,m.statusCode!=null&&m.statusCode!==200&&!c&&(l=m.statusCode),m.headers&&(u[f]=m.headers)):(i[f]=m.data,m.statusCode&&m.statusCode!==200&&!c&&(l=m.statusCode),m.headers&&(u[f]=m.headers))}),d!==void 0&&n&&(o={[n[0]]:d},i[n[0]]=void 0),{loaderData:i,errors:o,statusCode:l||200,loaderHeaders:u}}function xR(t,e,n,r,s,i,o){let{loaderData:l,errors:c}=xJ(e,n,r,o,!1);return s.forEach(u=>{let{key:d,match:h,controller:f}=u,m=i[d];if(cn(m,"Did not find corresponding fetcher result"),!(f&&f.signal.aborted))if(bi(m)){let g=zc(t.matches,h==null?void 0:h.route.id);c&&c[g.route.id]||(c=Xn({},c,{[g.route.id]:m.error})),t.fetchers.delete(d)}else if(eu(m))cn(!1,"Unhandled fetcher revalidation redirect");else if(Tl(m))cn(!1,"Unhandled fetcher deferred data");else{let g=cl(m.data);t.fetchers.set(d,g)}}),{loaderData:l,errors:c}}function vR(t,e,n,r){let s=Xn({},e);for(let i of n){let o=i.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(s[o]=e[o]):t[o]!==void 0&&i.route.loader&&(s[o]=t[o]),r&&r.hasOwnProperty(o))break}return s}function wR(t){return t?bi(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function zc(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function bR(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Zs(t,e){let{pathname:n,routeId:r,method:s,type:i,message:o}=e===void 0?{}:e,l="Unknown Server Error",c="Unknown @remix-run/router error";return t===400?(l="Bad Request",s&&n&&r?c="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?c="defer() is not supported in actions":i==="invalid-body"&&(c="Unable to encode submission body")):t===403?(l="Forbidden",c='Route "'+r+'" does not match URL "'+n+'"'):t===404?(l="Not Found",c='No route matches URL "'+n+'"'):t===405&&(l="Method Not Allowed",s&&n&&r?c="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(c='Invalid request method "'+s.toUpperCase()+'"')),new Cv(t||500,l,new Error(c),!0)}function fy(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,s]=e[n];if(eu(s))return{key:r,result:s}}}function z$(t){let e=typeof t=="string"?Ha(t):t;return _u(Xn({},e,{hash:""}))}function vJ(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function wJ(t){return G$(t.result)&&iJ.has(t.result.status)}function Tl(t){return t.type===Pn.deferred}function bi(t){return t.type===Pn.error}function eu(t){return(t&&t.type)===Pn.redirect}function _R(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function bJ(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function G$(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function _J(t){return sJ.has(t.toLowerCase())}function fo(t){return nJ.has(t.toLowerCase())}async function SJ(t,e,n,r,s){let i=Object.entries(e);for(let o=0;o<i.length;o++){let[l,c]=i[o],u=t.find(f=>(f==null?void 0:f.route.id)===l);if(!u)continue;let d=r.find(f=>f.route.id===u.route.id),h=d!=null&&!U$(d,u)&&(s&&s[u.route.id])!==void 0;Tl(c)&&h&&await L1(c,n,!1).then(f=>{f&&(e[l]=f)})}}async function EJ(t,e,n){for(let r=0;r<n.length;r++){let{key:s,routeId:i,controller:o}=n[r],l=e[s];t.find(u=>(u==null?void 0:u.route.id)===i)&&Tl(l)&&(cn(o,"Expected an AbortController for revalidating fetcher deferred result"),await L1(l,o.signal,!0).then(u=>{u&&(e[s]=u)}))}}async function L1(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Pn.data,data:t.deferredData.unwrappedData}}catch(s){return{type:Pn.error,error:s}}return{type:Pn.data,data:t.deferredData.data}}}function F1(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function tm(t,e){let n=typeof e=="string"?Ha(e).search:e.search;if(t[t.length-1].route.index&&F1(n||""))return t[t.length-1];let r=O$(t);return r[r.length-1]}function SR(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:i,json:o}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function b_(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function CJ(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function kf(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function TJ(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function cl(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function IJ(t,e){try{let n=t.sessionStorage.getItem(V$);if(n){let r=JSON.parse(n);for(let[s,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function NJ(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(V$,JSON.stringify(n))}catch(r){Nh(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xp(){return xp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xp.apply(this,arguments)}const n0=p.createContext(null),W$=p.createContext(null),dc=p.createContext(null),r0=p.createContext(null),aa=p.createContext({outlet:null,matches:[],isDataRoute:!1}),H$=p.createContext(null);function PJ(t,e){let{relative:n}=e===void 0?{}:e;nf()||cn(!1);let{basename:r,navigator:s}=p.useContext(dc),{hash:i,pathname:o,search:l}=K$(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Ea([r,o])),s.createHref({pathname:c,search:l,hash:i})}function nf(){return p.useContext(r0)!=null}function qa(){return nf()||cn(!1),p.useContext(r0).location}function q$(t){p.useContext(dc).static||p.useLayoutEffect(t)}function di(){let{isDataRoute:t}=p.useContext(aa);return t?zJ():AJ()}function AJ(){nf()||cn(!1);let t=p.useContext(n0),{basename:e,future:n,navigator:r}=p.useContext(dc),{matches:s}=p.useContext(aa),{pathname:i}=qa(),o=JSON.stringify(e0(s,n.v7_relativeSplatPath)),l=p.useRef(!1);return q$(()=>{l.current=!0}),p.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let h=t0(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ea([e,h.pathname])),(d.replace?r.replace:r.push)(h,d.state,d)},[e,r,o,i,t])}const kJ=p.createContext(null);function RJ(t){let e=p.useContext(aa).outlet;return e&&p.createElement(kJ.Provider,{value:t},e)}function s0(){let{matches:t}=p.useContext(aa),e=t[t.length-1];return e?e.params:{}}function K$(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=p.useContext(dc),{matches:s}=p.useContext(aa),{pathname:i}=qa(),o=JSON.stringify(e0(s,r.v7_relativeSplatPath));return p.useMemo(()=>t0(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function jJ(t,e,n,r){nf()||cn(!1);let{navigator:s}=p.useContext(dc),{matches:i}=p.useContext(aa),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=qa(),d;if(e){var h;let E=typeof e=="string"?Ha(e):e;c==="/"||(h=E.pathname)!=null&&h.startsWith(c)||cn(!1),d=E}else d=u;let f=d.pathname||"/",m=f;if(c!=="/"){let E=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(E.length).join("/")}let g=Bc(t,{pathname:m}),x=OJ(g&&g.map(E=>Object.assign({},E,{params:Object.assign({},l,E.params),pathname:Ea([c,s.encodeLocation?s.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?c:Ea([c,s.encodeLocation?s.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),i,n,r);return e&&x?p.createElement(r0.Provider,{value:{location:xp({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Cr.Pop}},x):x}function DJ(){let t=BJ(),e=yp(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},e),n?p.createElement("pre",{style:s},n):null,i)}const MJ=p.createElement(DJ,null);class LJ extends p.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?p.createElement(aa.Provider,{value:this.props.routeContext},p.createElement(H$.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function FJ(t){let{routeContext:e,match:n,children:r}=t,s=p.useContext(n0);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),p.createElement(aa.Provider,{value:e},r)}function OJ(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let d=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||cn(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:m}=n,g=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||g){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,f)=>{let m,g=!1,x=null,E=null;n&&(m=l&&h.route.id?l[h.route.id]:void 0,x=h.route.errorElement||MJ,c&&(u<0&&f===0?(GJ("route-fallback",!1),g=!0,E=null):u===f&&(g=!0,E=h.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,f+1)),b=()=>{let S;return m?S=x:g?S=E:h.route.Component?S=p.createElement(h.route.Component,null):h.route.element?S=h.route.element:S=d,p.createElement(FJ,{match:h,routeContext:{outlet:d,matches:v,isDataRoute:n!=null},children:S})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?p.createElement(LJ,{location:n.location,revalidation:n.revalidation,component:x,error:m,children:b(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):b()},null)}var Y$=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Y$||{}),Tv=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Tv||{});function $J(t){let e=p.useContext(n0);return e||cn(!1),e}function VJ(t){let e=p.useContext(W$);return e||cn(!1),e}function UJ(t){let e=p.useContext(aa);return e||cn(!1),e}function J$(t){let e=UJ(),n=e.matches[e.matches.length-1];return n.route.id||cn(!1),n.route.id}function BJ(){var t;let e=p.useContext(H$),n=VJ(Tv.UseRouteError),r=J$(Tv.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function zJ(){let{router:t}=$J(Y$.UseNavigateStable),e=J$(Tv.UseNavigateStable),n=p.useRef(!1);return q$(()=>{n.current=!0}),p.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,xp({fromRouteId:e},i)))},[t,e])}const ER={};function GJ(t,e,n){!e&&!ER[t]&&(ER[t]=!0)}function WJ(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function O1(t){let{to:e,replace:n,state:r,relative:s}=t;nf()||cn(!1);let{future:i,static:o}=p.useContext(dc),{matches:l}=p.useContext(aa),{pathname:c}=qa(),u=di(),d=t0(e,e0(l,i.v7_relativeSplatPath),c,s==="path"),h=JSON.stringify(d);return p.useEffect(()=>u(JSON.parse(h),{replace:n,state:r,relative:s}),[u,h,s,n,r]),null}function HJ(t){return RJ(t.context)}function qJ(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Cr.Pop,navigator:i,static:o=!1,future:l}=t;nf()&&cn(!1);let c=e.replace(/^\/*/,"/"),u=p.useMemo(()=>({basename:c,navigator:i,static:o,future:xp({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=Ha(r));let{pathname:d="/",search:h="",hash:f="",state:m=null,key:g="default"}=r,x=p.useMemo(()=>{let E=tf(d,c);return E==null?null:{location:{pathname:E,search:h,hash:f,state:m,key:g},navigationType:s}},[c,d,h,f,m,g,s]);return x==null?null:p.createElement(dc.Provider,{value:u},p.createElement(r0.Provider,{children:n,value:x}))}new Promise(()=>{});function KJ(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:p.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:p.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:p.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vp(){return vp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vp.apply(this,arguments)}function YJ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function JJ(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function XJ(t,e){return t.button===0&&(!e||e==="_self")&&!JJ(t)}const QJ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],ZJ="6";try{window.__reactRouterVersion=ZJ}catch{}function eX(t,e){return cJ({basename:e==null?void 0:e.basename,future:vp({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:jY({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||tX(),routes:t,mapRouteProperties:KJ,dataStrategy:e==null?void 0:e.dataStrategy,patchRoutesOnNavigation:e==null?void 0:e.patchRoutesOnNavigation,window:e==null?void 0:e.window}).initialize()}function tX(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=vp({},e,{errors:nX(e.errors)})),e}function nX(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new Cv(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let o=new i(s.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let i=new Error(s.message);i.stack="",n[r]=i}}else n[r]=s;return n}const rX=p.createContext({isTransitioning:!1}),sX=p.createContext(new Map),iX="startTransition",CR=Ow[iX],oX="flushSync",TR=RY[oX];function aX(t){CR?CR(t):t()}function Rf(t){TR?TR(t):t()}let lX=class{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}};function cX(t){let{fallbackElement:e,router:n,future:r}=t,[s,i]=p.useState(n.state),[o,l]=p.useState(),[c,u]=p.useState({isTransitioning:!1}),[d,h]=p.useState(),[f,m]=p.useState(),[g,x]=p.useState(),E=p.useRef(new Map),{v7_startTransition:v}=r||{},b=p.useCallback(T=>{v?aX(T):T()},[v]),S=p.useCallback((T,P)=>{let{deletedFetchers:A,flushSync:R,viewTransitionOpts:M}=P;T.fetchers.forEach((z,W)=>{z.data!==void 0&&E.current.set(W,z.data)}),A.forEach(z=>E.current.delete(z));let j=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!M||j){R?Rf(()=>i(T)):b(()=>i(T));return}if(R){Rf(()=>{f&&(d&&d.resolve(),f.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:M.currentLocation,nextLocation:M.nextLocation})});let z=n.window.document.startViewTransition(()=>{Rf(()=>i(T))});z.finished.finally(()=>{Rf(()=>{h(void 0),m(void 0),l(void 0),u({isTransitioning:!1})})}),Rf(()=>m(z));return}f?(d&&d.resolve(),f.skipTransition(),x({state:T,currentLocation:M.currentLocation,nextLocation:M.nextLocation})):(l(T),u({isTransitioning:!0,flushSync:!1,currentLocation:M.currentLocation,nextLocation:M.nextLocation}))},[n.window,f,d,E,b]);p.useLayoutEffect(()=>n.subscribe(S),[n,S]),p.useEffect(()=>{c.isTransitioning&&!c.flushSync&&h(new lX)},[c]),p.useEffect(()=>{if(d&&o&&n.window){let T=o,P=d.promise,A=n.window.document.startViewTransition(async()=>{b(()=>i(T)),await P});A.finished.finally(()=>{h(void 0),m(void 0),l(void 0),u({isTransitioning:!1})}),m(A)}},[b,o,d,n.window]),p.useEffect(()=>{d&&o&&s.location.key===o.location.key&&d.resolve()},[d,f,s.location,o]),p.useEffect(()=>{!c.isTransitioning&&g&&(l(g.state),u({isTransitioning:!0,flushSync:!1,currentLocation:g.currentLocation,nextLocation:g.nextLocation}),x(void 0))},[c.isTransitioning,g]),p.useEffect(()=>{},[]);let I=p.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:T=>n.navigate(T),push:(T,P,A)=>n.navigate(T,{state:P,preventScrollReset:A==null?void 0:A.preventScrollReset}),replace:(T,P,A)=>n.navigate(T,{replace:!0,state:P,preventScrollReset:A==null?void 0:A.preventScrollReset})}),[n]),D=n.basename||"/",k=p.useMemo(()=>({router:n,navigator:I,static:!1,basename:D}),[n,I,D]),C=p.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return p.useEffect(()=>WJ(r,n.future),[r,n.future]),p.createElement(p.Fragment,null,p.createElement(n0.Provider,{value:k},p.createElement(W$.Provider,{value:s},p.createElement(sX.Provider,{value:E.current},p.createElement(rX.Provider,{value:c},p.createElement(qJ,{basename:D,location:s.location,navigationType:s.historyAction,navigator:I,future:C},s.initialized||n.future.v7_partialHydration?p.createElement(uX,{routes:n.routes,future:n.future,state:s}):e))))),null)}const uX=p.memo(dX);function dX(t){let{routes:e,future:n,state:r}=t;return jJ(e,void 0,r,n)}const hX=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",fX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Us=p.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h}=e,f=YJ(e,QJ),{basename:m}=p.useContext(dc),g,x=!1;if(typeof u=="string"&&fX.test(u)&&(g=u,hX))try{let S=new URL(window.location.href),I=u.startsWith("//")?new URL(S.protocol+u):new URL(u),D=tf(I.pathname,m);I.origin===S.origin&&D!=null?u=D+I.search+I.hash:x=!0}catch{}let E=PJ(u,{relative:s}),v=mX(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:h});function b(S){r&&r(S),S.defaultPrevented||v(S)}return p.createElement("a",vp({},f,{href:g||E,onClick:x||i?r:b,ref:n,target:c}))});var IR;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(IR||(IR={}));var NR;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(NR||(NR={}));function mX(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=di(),u=qa(),d=K$(t,{relative:o});return p.useCallback(h=>{if(XJ(h,n)){h.preventDefault();let f=r!==void 0?r:_u(u)===_u(d);c(t,{replace:f,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[u,c,d,r,s,n,t,i,o,l])}function X$(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=X$(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Q$(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=X$(t))&&(r&&(r+=" "),r+=e);return r}function pX(){for(var t=0,e,n,r="";t<arguments.length;)(e=arguments[t++])&&(n=Z$(e))&&(r&&(r+=" "),r+=n);return r}function Z$(t){if(typeof t=="string")return t;for(var e,n="",r=0;r<t.length;r++)t[r]&&(e=Z$(t[r]))&&(n&&(n+=" "),n+=e);return n}var $1="-";function gX(t){var e=xX(t),n=t.conflictingClassGroups,r=t.conflictingClassGroupModifiers,s=r===void 0?{}:r;function i(l){var c=l.split($1);return c[0]===""&&c.length!==1&&c.shift(),eV(c,e)||yX(l)}function o(l,c){var u=n[l]||[];return c&&s[l]?[].concat(u,s[l]):u}return{getClassGroupId:i,getConflictingClassGroupIds:o}}function eV(t,e){var o;if(t.length===0)return e.classGroupId;var n=t[0],r=e.nextPart.get(n),s=r?eV(t.slice(1),r):void 0;if(s)return s;if(e.validators.length!==0){var i=t.join($1);return(o=e.validators.find(function(l){var c=l.validator;return c(i)}))==null?void 0:o.classGroupId}}var PR=/^\[(.+)\]$/;function yX(t){if(PR.test(t)){var e=PR.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}function xX(t){var e=t.theme,n=t.prefix,r={nextPart:new Map,validators:[]},s=wX(Object.entries(t.classGroups),n);return s.forEach(function(i){var o=i[0],l=i[1];VE(l,r,o,e)}),r}function VE(t,e,n,r){t.forEach(function(s){if(typeof s=="string"){var i=s===""?e:AR(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(vX(s)){VE(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(function(o){var l=o[0],c=o[1];VE(c,AR(e,l),n,r)})})}function AR(t,e){var n=t;return e.split($1).forEach(function(r){n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n}function vX(t){return t.isThemeGetter}function wX(t,e){return e?t.map(function(n){var r=n[0],s=n[1],i=s.map(function(o){return typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(l){var c=l[0],u=l[1];return[e+c,u]})):o});return[r,i]}):t}function bX(t){if(t<1)return{get:function(){},set:function(){}};var e=0,n=new Map,r=new Map;function s(i,o){n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)}return{get:function(o){var l=n.get(o);if(l!==void 0)return l;if((l=r.get(o))!==void 0)return s(o,l),l},set:function(o,l){n.has(o)?n.set(o,l):s(o,l)}}}var tV="!";function _X(t){var e=t.separator||":",n=e.length===1,r=e[0],s=e.length;return function(o){for(var l=[],c=0,u=0,d,h=0;h<o.length;h++){var f=o[h];if(c===0){if(f===r&&(n||o.slice(h,h+s)===e)){l.push(o.slice(u,h)),u=h+s;continue}if(f==="/"){d=h;continue}}f==="["?c++:f==="]"&&c--}var m=l.length===0?o:o.substring(u),g=m.startsWith(tV),x=g?m.substring(1):m,E=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:g,baseClassName:x,maybePostfixModifierPosition:E}}}function SX(t){if(t.length<=1)return t;var e=[],n=[];return t.forEach(function(r){var s=r[0]==="[";s?(e.push.apply(e,n.sort().concat([r])),n=[]):n.push(r)}),e.push.apply(e,n.sort()),e}function EX(t){return{cache:bX(t.cacheSize),splitModifiers:_X(t),...gX(t)}}var CX=/\s+/;function TX(t,e){var n=e.splitModifiers,r=e.getClassGroupId,s=e.getConflictingClassGroupIds,i=new Set;return t.trim().split(CX).map(function(o){var l=n(o),c=l.modifiers,u=l.hasImportantModifier,d=l.baseClassName,h=l.maybePostfixModifierPosition,f=r(h?d.substring(0,h):d),m=!!h;if(!f){if(!h)return{isTailwindClass:!1,originalClassName:o};if(f=r(d),!f)return{isTailwindClass:!1,originalClassName:o};m=!1}var g=SX(c).join(":"),x=u?g+tV:g;return{isTailwindClass:!0,modifierId:x,classGroupId:f,originalClassName:o,hasPostfixModifier:m}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var l=o.modifierId,c=o.classGroupId,u=o.hasPostfixModifier,d=l+c;return i.has(d)?!1:(i.add(d),s(c,u).forEach(function(h){return i.add(l+h)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function IX(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,s,i,o=l;function l(u){var d=e[0],h=e.slice(1),f=h.reduce(function(m,g){return g(m)},d());return r=EX(f),s=r.cache.get,i=r.cache.set,o=c,c(u)}function c(u){var d=s(u);if(d)return d;var h=TX(u,r);return i(u,h),h}return function(){return o(pX.apply(null,arguments))}}function Wn(t){var e=function(r){return r[t]||[]};return e.isThemeGetter=!0,e}var nV=/^\[(?:([a-z-]+):)?(.+)\]$/i,NX=/^\d+\/\d+$/,PX=new Set(["px","full","screen"]),AX=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,kX=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,RX=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function ao(t){return tu(t)||PX.has(t)||NX.test(t)||UE(t)}function UE(t){return Uu(t,"length",OX)}function jX(t){return Uu(t,"size",rV)}function DX(t){return Uu(t,"position",rV)}function MX(t){return Uu(t,"url",$X)}function my(t){return Uu(t,"number",tu)}function tu(t){return!Number.isNaN(Number(t))}function LX(t){return t.endsWith("%")&&tu(t.slice(0,-1))}function jf(t){return kR(t)||Uu(t,"number",kR)}function dn(t){return nV.test(t)}function Df(){return!0}function el(t){return AX.test(t)}function FX(t){return Uu(t,"",VX)}function Uu(t,e,n){var r=nV.exec(t);return r?r[1]?r[1]===e:n(r[2]):!1}function OX(t){return kX.test(t)}function rV(){return!1}function $X(t){return t.startsWith("url(")}function kR(t){return Number.isInteger(Number(t))}function VX(t){return RX.test(t)}function UX(){var t=Wn("colors"),e=Wn("spacing"),n=Wn("blur"),r=Wn("brightness"),s=Wn("borderColor"),i=Wn("borderRadius"),o=Wn("borderSpacing"),l=Wn("borderWidth"),c=Wn("contrast"),u=Wn("grayscale"),d=Wn("hueRotate"),h=Wn("invert"),f=Wn("gap"),m=Wn("gradientColorStops"),g=Wn("gradientColorStopPositions"),x=Wn("inset"),E=Wn("margin"),v=Wn("opacity"),b=Wn("padding"),S=Wn("saturate"),I=Wn("scale"),D=Wn("sepia"),k=Wn("skew"),C=Wn("space"),T=Wn("translate"),P=function(){return["auto","contain","none"]},A=function(){return["auto","hidden","clip","visible","scroll"]},R=function(){return["auto",dn,e]},M=function(){return[dn,e]},j=function(){return["",ao]},z=function(){return["auto",tu,dn]},W=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},q=function(){return["solid","dashed","dotted","double","none"]},H=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},$=function(){return["start","end","center","between","around","evenly","stretch"]},J=function(){return["","0",dn]},O=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},V=function(){return[tu,my]},G=function(){return[tu,dn]};return{cacheSize:500,theme:{colors:[Df],spacing:[ao],blur:["none","",el,dn],brightness:V(),borderColor:[t],borderRadius:["none","","full",el,dn],borderSpacing:M(),borderWidth:j(),contrast:V(),grayscale:J(),hueRotate:G(),invert:J(),gap:M(),gradientColorStops:[t],gradientColorStopPositions:[LX,UE],inset:R(),margin:R(),opacity:V(),padding:M(),saturate:V(),scale:V(),sepia:J(),skew:G(),space:M(),translate:M()},classGroups:{aspect:[{aspect:["auto","square","video",dn]}],container:["container"],columns:[{columns:[el]}],"break-after":[{"break-after":O()}],"break-before":[{"break-before":O()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(W(),[dn])}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",jf]}],basis:[{basis:R()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",dn]}],grow:[{grow:J()}],shrink:[{shrink:J()}],order:[{order:["first","last","none",jf]}],"grid-cols":[{"grid-cols":[Df]}],"col-start-end":[{col:["auto",{span:["full",jf]},dn]}],"col-start":[{"col-start":z()}],"col-end":[{"col-end":z()}],"grid-rows":[{"grid-rows":[Df]}],"row-start-end":[{row:["auto",{span:[jf]},dn]}],"row-start":[{"row-start":z()}],"row-end":[{"row-end":z()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",dn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",dn]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal"].concat($())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat($(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat($(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[E]}],mx:[{mx:[E]}],my:[{my:[E]}],ms:[{ms:[E]}],me:[{me:[E]}],mt:[{mt:[E]}],mr:[{mr:[E]}],mb:[{mb:[E]}],ml:[{ml:[E]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",dn,e]}],"min-w":[{"min-w":["min","max","fit",dn,ao]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[el]},el,dn]}],h:[{h:[dn,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",dn,ao]}],"max-h":[{"max-h":[dn,e,"min","max","fit"]}],"font-size":[{text:["base",el,UE]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",my]}],"font-family":[{font:[Df]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",dn]}],"line-clamp":[{"line-clamp":["none",tu,my]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",dn,ao]}],"list-image":[{"list-image":["none",dn]}],"list-style-type":[{list:["none","disc","decimal",dn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(q(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",ao]}],"underline-offset":[{"underline-offset":["auto",dn,ao]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:M()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",dn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",dn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(W(),[DX])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",jX]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},MX]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[].concat(q(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:q()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(q())}],"outline-offset":[{"outline-offset":[dn,ao]}],"outline-w":[{outline:[ao]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:j()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[ao]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",el,FX]}],"shadow-color":[{shadow:[Df]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":H()}],"bg-blend":[{"bg-blend":H()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",el,dn]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[S]}],sepia:[{sepia:[D]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[D]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",dn]}],duration:[{duration:G()}],ease:[{ease:["linear","in","out","in-out",dn]}],delay:[{delay:G()}],animate:[{animate:["none","spin","ping","pulse","bounce",dn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[I]}],"scale-x":[{"scale-x":[I]}],"scale-y":[{"scale-y":[I]}],rotate:[{rotate:[jf,dn]}],"translate-x":[{"translate-x":[T]}],"translate-y":[{"translate-y":[T]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",dn]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",dn]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":M()}],"scroll-mx":[{"scroll-mx":M()}],"scroll-my":[{"scroll-my":M()}],"scroll-ms":[{"scroll-ms":M()}],"scroll-me":[{"scroll-me":M()}],"scroll-mt":[{"scroll-mt":M()}],"scroll-mr":[{"scroll-mr":M()}],"scroll-mb":[{"scroll-mb":M()}],"scroll-ml":[{"scroll-ml":M()}],"scroll-p":[{"scroll-p":M()}],"scroll-px":[{"scroll-px":M()}],"scroll-py":[{"scroll-py":M()}],"scroll-ps":[{"scroll-ps":M()}],"scroll-pe":[{"scroll-pe":M()}],"scroll-pt":[{"scroll-pt":M()}],"scroll-pr":[{"scroll-pr":M()}],"scroll-pb":[{"scroll-pb":M()}],"scroll-pl":[{"scroll-pl":M()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",dn]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[ao,my]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var BX=IX(UX);let py;const zX=new Uint8Array(16);function GX(){if(!py&&(py=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!py))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return py(zX)}const Zr=[];for(let t=0;t<256;++t)Zr.push((t+256).toString(16).slice(1));function WX(t,e=0){return Zr[t[e+0]]+Zr[t[e+1]]+Zr[t[e+2]]+Zr[t[e+3]]+"-"+Zr[t[e+4]]+Zr[t[e+5]]+"-"+Zr[t[e+6]]+Zr[t[e+7]]+"-"+Zr[t[e+8]]+Zr[t[e+9]]+"-"+Zr[t[e+10]]+Zr[t[e+11]]+Zr[t[e+12]]+Zr[t[e+13]]+Zr[t[e+14]]+Zr[t[e+15]]}const HX=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),RR={randomUUID:HX};function qX(t,e,n){if(RR.randomUUID&&!e&&!t)return RR.randomUUID();t=t||{};const r=t.random||(t.rng||GX)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=r[s];return e}return WX(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let KX,YX;function JX(){return{geminiUrl:KX,vertexUrl:YX}}function XX(t,e,n){var r,s,i;if(!(!((r=t.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=JX();return t.vertexai?(s=o.vertexUrl)!==null&&s!==void 0?s:e:(i=o.geminiUrl)!==null&&i!==void 0?i:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eg{}function Bt(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const i=e[s];return i!=null?String(i):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function _(t,e,n){for(let i=0;i<e.length-1;i++){const o=e[i];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in t))if(Array.isArray(n))t[l]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[l])){const c=t[l];if(Array.isArray(n))for(let u=0;u<c.length;u++){const d=c[u];_(d,e.slice(i+1),n[u])}else for(const u of c)_(u,e.slice(i+1),n)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in t||(t[l]=[{}]);const c=t[l];_(c[0],e.slice(i+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],s=t[r];if(s!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===s)return;if(typeof s=="object"&&typeof n=="object"&&s!==null&&n!==null)Object.assign(s,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else t[r]=n}function w(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in t){const i=t[s];return Array.isArray(i)?i.map(o=>w(o,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function er(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function sV(t,e){const n=er(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function iV(t,e){return Array.isArray(e)?e.map(n=>Iv(t,n)):[Iv(t,e)]}function Iv(t,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function QX(t,e){const n=Iv(t,e);if(n.mimeType&&n.mimeType.startsWith("image/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function ZX(t,e){const n=Iv(t,e);if(n.mimeType&&n.mimeType.startsWith("audio/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function jR(t,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function oV(t,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(n=>jR(t,n)):[jR(t,e)]}function BE(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function DR(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function MR(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function ni(t,e){if(e==null)throw new Error("ContentUnion is required");return BE(e)?e:{role:"user",parts:oV(t,e)}}function aV(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=ni(t,n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=ni(t,e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>ni(t,n)):[ni(t,e)]}function hc(t,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(DR(e)||MR(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ni(t,e)]}const n=[],r=[],s=BE(e[0]);for(const i of e){const o=BE(i);if(o!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)n.push(i);else{if(DR(i)||MR(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(i)}}return s||n.push({role:"user",parts:oV(t,r)}),n}function lV(t,e){return e}function cV(t,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function i0(t,e){return e}function o0(t,e){if(!Array.isArray(e))throw new Error("tool is required and must be an array of Tools");return e}function eQ(t,e,n,r=1){const s=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:s?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:s?`${n}/${e}`:e}function fc(t,e){if(typeof e!="string")throw new Error("name must be a string");return eQ(t,e,"cachedContents")}function uV(t,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function mc(t,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function tQ(t){return t!=null&&typeof t=="object"&&"name"in t}function nQ(t){return t!=null&&typeof t=="object"&&"video"in t}function rQ(t){return t!=null&&typeof t=="object"&&"uri"in t}function dV(t,e){var n;let r;if(tQ(e)&&(r=e.name),!(rQ(e)&&(r=e.uri,r===void 0))&&!(nQ(e)&&(r=(n=e.video)===null||n===void 0?void 0:n.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const i=r.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${r}`);r=i[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function hV(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function fV(t,e){for(const n of["models","tunedModels","publisherModels"])if(sQ(e,n))return e[n];return[]}function sQ(t,e){return t!==null&&typeof t=="object"&&e in t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iQ(t,e){const n={};if(w(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=w(e,["data"]);r!=null&&_(n,["data"],r);const s=w(e,["mimeType"]);return s!=null&&_(n,["mimeType"],s),n}function oQ(t,e){const n={};if(w(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=w(e,["thought"]);r!=null&&_(n,["thought"],r);const s=w(e,["inlineData"]);s!=null&&_(n,["inlineData"],iQ(t,s));const i=w(e,["codeExecutionResult"]);i!=null&&_(n,["codeExecutionResult"],i);const o=w(e,["executableCode"]);o!=null&&_(n,["executableCode"],o);const l=w(e,["fileData"]);l!=null&&_(n,["fileData"],l);const c=w(e,["functionCall"]);c!=null&&_(n,["functionCall"],c);const u=w(e,["functionResponse"]);u!=null&&_(n,["functionResponse"],u);const d=w(e,["text"]);return d!=null&&_(n,["text"],d),n}function LR(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>oQ(t,o))),_(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&_(n,["role"],s),n}function aQ(){return{}}function lQ(t,e){const n={},r=w(e,["mode"]);r!=null&&_(n,["mode"],r);const s=w(e,["dynamicThreshold"]);return s!=null&&_(n,["dynamicThreshold"],s),n}function cQ(t,e){const n={},r=w(e,["dynamicRetrievalConfig"]);return r!=null&&_(n,["dynamicRetrievalConfig"],lQ(t,r)),n}function uQ(t,e){const n={};if(w(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");w(e,["googleSearch"])!=null&&_(n,["googleSearch"],aQ());const s=w(e,["googleSearchRetrieval"]);if(s!=null&&_(n,["googleSearchRetrieval"],cQ(t,s)),w(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(w(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=w(e,["codeExecution"]);i!=null&&_(n,["codeExecution"],i);const o=w(e,["functionDeclarations"]);return o!=null&&_(n,["functionDeclarations"],o),n}function dQ(t,e){const n={},r=w(e,["mode"]);r!=null&&_(n,["mode"],r);const s=w(e,["allowedFunctionNames"]);return s!=null&&_(n,["allowedFunctionNames"],s),n}function hQ(t,e){const n={},r=w(e,["functionCallingConfig"]);if(r!=null&&_(n,["functionCallingConfig"],dQ(t,r)),w(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}function fQ(t,e,n){const r={},s=w(e,["ttl"]);n!==void 0&&s!=null&&_(n,["ttl"],s);const i=w(e,["expireTime"]);n!==void 0&&i!=null&&_(n,["expireTime"],i);const o=w(e,["displayName"]);n!==void 0&&o!=null&&_(n,["displayName"],o);const l=w(e,["contents"]);if(n!==void 0&&l!=null){let h=hc(t,l);Array.isArray(h)&&(h=h.map(f=>LR(t,f))),_(n,["contents"],h)}const c=w(e,["systemInstruction"]);n!==void 0&&c!=null&&_(n,["systemInstruction"],LR(t,ni(t,c)));const u=w(e,["tools"]);if(n!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(f=>uQ(t,f))),_(n,["tools"],h)}const d=w(e,["toolConfig"]);return n!==void 0&&d!=null&&_(n,["toolConfig"],hQ(t,d)),r}function mQ(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["model"],sV(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],fQ(t,s,n)),n}function pQ(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["_url","name"],fc(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function gQ(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["_url","name"],fc(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function yQ(t,e,n){const r={},s=w(e,["ttl"]);n!==void 0&&s!=null&&_(n,["ttl"],s);const i=w(e,["expireTime"]);return n!==void 0&&i!=null&&_(n,["expireTime"],i),r}function xQ(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["_url","name"],fc(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],yQ(t,s,n)),n}function vQ(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&_(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);return n!==void 0&&i!=null&&_(n,["_query","pageToken"],i),r}function wQ(t,e){const n={},r=w(e,["config"]);return r!=null&&_(n,["config"],vQ(t,r,n)),n}function bQ(t,e){const n={},r=w(e,["displayName"]);r!=null&&_(n,["displayName"],r);const s=w(e,["data"]);s!=null&&_(n,["data"],s);const i=w(e,["mimeType"]);return i!=null&&_(n,["mimeType"],i),n}function _Q(t,e){const n={},r=w(e,["videoMetadata"]);r!=null&&_(n,["videoMetadata"],r);const s=w(e,["thought"]);s!=null&&_(n,["thought"],s);const i=w(e,["inlineData"]);i!=null&&_(n,["inlineData"],bQ(t,i));const o=w(e,["codeExecutionResult"]);o!=null&&_(n,["codeExecutionResult"],o);const l=w(e,["executableCode"]);l!=null&&_(n,["executableCode"],l);const c=w(e,["fileData"]);c!=null&&_(n,["fileData"],c);const u=w(e,["functionCall"]);u!=null&&_(n,["functionCall"],u);const d=w(e,["functionResponse"]);d!=null&&_(n,["functionResponse"],d);const h=w(e,["text"]);return h!=null&&_(n,["text"],h),n}function FR(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>_Q(t,o))),_(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&_(n,["role"],s),n}function SQ(){return{}}function EQ(t,e){const n={},r=w(e,["mode"]);r!=null&&_(n,["mode"],r);const s=w(e,["dynamicThreshold"]);return s!=null&&_(n,["dynamicThreshold"],s),n}function CQ(t,e){const n={},r=w(e,["dynamicRetrievalConfig"]);return r!=null&&_(n,["dynamicRetrievalConfig"],EQ(t,r)),n}function TQ(){return{}}function IQ(t,e){const n={},r=w(e,["apiKeyString"]);return r!=null&&_(n,["apiKeyString"],r),n}function NQ(t,e){const n={},r=w(e,["apiKeyConfig"]);r!=null&&_(n,["apiKeyConfig"],IQ(t,r));const s=w(e,["authType"]);s!=null&&_(n,["authType"],s);const i=w(e,["googleServiceAccountConfig"]);i!=null&&_(n,["googleServiceAccountConfig"],i);const o=w(e,["httpBasicAuthConfig"]);o!=null&&_(n,["httpBasicAuthConfig"],o);const l=w(e,["oauthConfig"]);l!=null&&_(n,["oauthConfig"],l);const c=w(e,["oidcConfig"]);return c!=null&&_(n,["oidcConfig"],c),n}function PQ(t,e){const n={},r=w(e,["authConfig"]);return r!=null&&_(n,["authConfig"],NQ(t,r)),n}function AQ(t,e){const n={},r=w(e,["retrieval"]);r!=null&&_(n,["retrieval"],r),w(e,["googleSearch"])!=null&&_(n,["googleSearch"],SQ());const i=w(e,["googleSearchRetrieval"]);i!=null&&_(n,["googleSearchRetrieval"],CQ(t,i)),w(e,["enterpriseWebSearch"])!=null&&_(n,["enterpriseWebSearch"],TQ());const l=w(e,["googleMaps"]);l!=null&&_(n,["googleMaps"],PQ(t,l));const c=w(e,["codeExecution"]);c!=null&&_(n,["codeExecution"],c);const u=w(e,["functionDeclarations"]);return u!=null&&_(n,["functionDeclarations"],u),n}function kQ(t,e){const n={},r=w(e,["mode"]);r!=null&&_(n,["mode"],r);const s=w(e,["allowedFunctionNames"]);return s!=null&&_(n,["allowedFunctionNames"],s),n}function RQ(t,e){const n={},r=w(e,["latitude"]);r!=null&&_(n,["latitude"],r);const s=w(e,["longitude"]);return s!=null&&_(n,["longitude"],s),n}function jQ(t,e){const n={},r=w(e,["latLng"]);return r!=null&&_(n,["latLng"],RQ(t,r)),n}function DQ(t,e){const n={},r=w(e,["functionCallingConfig"]);r!=null&&_(n,["functionCallingConfig"],kQ(t,r));const s=w(e,["retrievalConfig"]);return s!=null&&_(n,["retrievalConfig"],jQ(t,s)),n}function MQ(t,e,n){const r={},s=w(e,["ttl"]);n!==void 0&&s!=null&&_(n,["ttl"],s);const i=w(e,["expireTime"]);n!==void 0&&i!=null&&_(n,["expireTime"],i);const o=w(e,["displayName"]);n!==void 0&&o!=null&&_(n,["displayName"],o);const l=w(e,["contents"]);if(n!==void 0&&l!=null){let h=hc(t,l);Array.isArray(h)&&(h=h.map(f=>FR(t,f))),_(n,["contents"],h)}const c=w(e,["systemInstruction"]);n!==void 0&&c!=null&&_(n,["systemInstruction"],FR(t,ni(t,c)));const u=w(e,["tools"]);if(n!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(f=>AQ(t,f))),_(n,["tools"],h)}const d=w(e,["toolConfig"]);return n!==void 0&&d!=null&&_(n,["toolConfig"],DQ(t,d)),r}function LQ(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["model"],sV(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],MQ(t,s,n)),n}function FQ(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["_url","name"],fc(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function OQ(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["_url","name"],fc(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function $Q(t,e,n){const r={},s=w(e,["ttl"]);n!==void 0&&s!=null&&_(n,["ttl"],s);const i=w(e,["expireTime"]);return n!==void 0&&i!=null&&_(n,["expireTime"],i),r}function VQ(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["_url","name"],fc(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],$Q(t,s,n)),n}function UQ(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&_(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);return n!==void 0&&i!=null&&_(n,["_query","pageToken"],i),r}function BQ(t,e){const n={},r=w(e,["config"]);return r!=null&&_(n,["config"],UQ(t,r,n)),n}function wx(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["name"],r);const s=w(e,["displayName"]);s!=null&&_(n,["displayName"],s);const i=w(e,["model"]);i!=null&&_(n,["model"],i);const o=w(e,["createTime"]);o!=null&&_(n,["createTime"],o);const l=w(e,["updateTime"]);l!=null&&_(n,["updateTime"],l);const c=w(e,["expireTime"]);c!=null&&_(n,["expireTime"],c);const u=w(e,["usageMetadata"]);return u!=null&&_(n,["usageMetadata"],u),n}function zQ(){return{}}function GQ(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&_(n,["nextPageToken"],r);const s=w(e,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>wx(t,o))),_(n,["cachedContents"],i)}return n}function bx(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["name"],r);const s=w(e,["displayName"]);s!=null&&_(n,["displayName"],s);const i=w(e,["model"]);i!=null&&_(n,["model"],i);const o=w(e,["createTime"]);o!=null&&_(n,["createTime"],o);const l=w(e,["updateTime"]);l!=null&&_(n,["updateTime"],l);const c=w(e,["expireTime"]);c!=null&&_(n,["expireTime"],c);const u=w(e,["usageMetadata"]);return u!=null&&_(n,["usageMetadata"],u),n}function WQ(){return{}}function HQ(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&_(n,["nextPageToken"],r);const s=w(e,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>bx(t,o))),_(n,["cachedContents"],i)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ph;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Ph||(Ph={}));class a0{constructor(e,n,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,s)}init(e,n,r){var s,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(i=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var OR;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(OR||(OR={}));var $R;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})($R||($R={}));var xr;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(xr||(xr={}));var VR;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(VR||(VR={}));var vr;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(vr||(vr={}));var UR;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(UR||(UR={}));var BR;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(BR||(BR={}));var Xe;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT"})(Xe||(Xe={}));var zR;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY"})(zR||(zR={}));var GR;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(GR||(GR={}));var WR;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(WR||(WR={}));var HR;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(HR||(HR={}));var qR;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(qR||(qR={}));var Dn;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Dn||(Dn={}));var KR;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(KR||(KR={}));var zE;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(zE||(zE={}));var YR;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(YR||(YR={}));var JR;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(JR||(JR={}));var XR;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(XR||(XR={}));var QR;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(QR||(QR={}));var ZR;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(ZR||(ZR={}));var ej;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(ej||(ej={}));var tj;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})(tj||(tj={}));var nj;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(nj||(nj={}));var rj;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(rj||(rj={}));var sj;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(sj||(sj={}));var ij;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(ij||(ij={}));var oj;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(oj||(oj={}));var aj;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(aj||(aj={}));var lj;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(lj||(lj={}));var cj;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(cj||(cj={}));var uj;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(uj||(uj={}));var dj;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(dj||(dj={}));var hj;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(hj||(hj={}));class gy{get text(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",d=!1;const h=[];for(const f of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[m,g]of Object.entries(f))m!=="text"&&m!=="thought"&&(g!==null||g!==void 0)&&h.push(m);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;d=!0,u+=f.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?u:void 0}get data(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const d=[];for(const h of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[f,m]of Object.entries(h))f!=="inlineData"&&(m!==null||m!==void 0)&&d.push(f);h.inlineData&&typeof h.inlineData.data=="string"&&(u+=atob(h.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,s,i,o,l,c,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,s,i,o,l,c,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.output}}class fj{}class mj{}class qQ{}class KQ{}class pj{}class gj{}class yj{}class YQ{}class xj{}class vj{}class wj{}class JQ{}class GE{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class XQ{}class QQ{}class ZQ{get text(){var e,n,r;let s="",i=!1;const o=[];for(const l of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,u]of Object.entries(l))c!=="text"&&c!=="thought"&&u!==null&&o.push(c);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;i=!0,s+=l.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?s:void 0}get data(){var e,n,r;let s="";const i=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(o))l!=="inlineData"&&c!==null&&i.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eZ extends eg{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new a0(Ph.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=LQ(this.apiClient,e);return l=Bt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>bx(this.apiClient,d))}else{const u=mQ(this.apiClient,e);return l=Bt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>wx(this.apiClient,d))}}async get(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=FQ(this.apiClient,e);return l=Bt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>bx(this.apiClient,d))}else{const u=pQ(this.apiClient,e);return l=Bt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>wx(this.apiClient,d))}}async delete(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=OQ(this.apiClient,e);return l=Bt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(()=>{const d=WQ(),h=new vj;return Object.assign(h,d),h})}else{const u=gQ(this.apiClient,e);return l=Bt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=zQ(),h=new vj;return Object.assign(h,d),h})}}async update(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=VQ(this.apiClient,e);return l=Bt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>bx(this.apiClient,d))}else{const u=xQ(this.apiClient,e);return l=Bt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>wx(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=BQ(this.apiClient,e);return l=Bt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=HQ(this.apiClient,d),f=new wj;return Object.assign(f,h),f})}else{const u=wQ(this.apiClient,e);return l=Bt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=GQ(this.apiClient,d),f=new wj;return Object.assign(f,h),f})}}}function bj(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function bs(t){return this instanceof bs?(this.v=t,this):new bs(t)}function Nv(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(g){return Promise.resolve(g).then(m,h)}}function l(m,g){r[m]&&(s[m]=function(x){return new Promise(function(E,v){i.push([m,x,E,v])>1||c(m,x)})},g&&(s[m]=g(s[m])))}function c(m,g){try{u(r[m](g))}catch(x){f(i[0][3],x)}}function u(m){m.value instanceof bs?Promise.resolve(m.value.v).then(d,h):f(i[0][2],m)}function d(m){c("next",m)}function h(m){c("throw",m)}function f(m,g){m(g),i.shift(),i.length&&c(i[0][0],i[0][1])}}function WE(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof bj=="function"?bj(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(l,c){o=t[i](o),s(l,c,o.done,o.value)})}}function s(i,o,l,c){Promise.resolve(c).then(function(u){i({value:u,done:l})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tZ(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:mV(n)}function mV(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||e.text!==void 0&&e.text==="")return!1;return!0}function nZ(t){if(t.length!==0){if(t[0].role!=="user")throw new Error("History must start with a user turn.");for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function rZ(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0,s=t[0];for(;r<n;)if(t[r].role==="user")s=t[r],r++;else{const i=[];let o=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),o&&!mV(t[r])&&(o=!1),r++;o&&(e.push(s),e.push(...i))}return e}class sZ{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new iZ(this.apiClient,this.modelsModule,e.model,e.config,e.history)}}let iZ=class{constructor(e,n,r,s={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=s,this.history=i,this.sendPromise=Promise.resolve(),nZ(i)}async sendMessage(e){var n;await this.sendPromise;const r=ni(this.apiClient,e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,o;const c=(o=(i=(await s).candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content,u=c?[c]:[];this.recordHistory(r,u)})(),await this.sendPromise,s}async sendMessageStream(e){var n;await this.sendPromise;const r=ni(this.apiClient,e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const i=await s;return this.processStreamResponse(i,r)}getHistory(e=!1){return e?rZ(this.history):this.history}processStreamResponse(e,n){var r,s;return Nv(this,arguments,function*(){var o,l,c,u;const d=[];try{for(var h=!0,f=WE(e),m;m=yield bs(f.next()),o=m.done,!o;h=!0){u=m.value,h=!1;const g=u;if(tZ(g)){const x=(s=(r=g.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content;x!==void 0&&d.push(x)}yield yield bs(g)}}catch(g){l={error:g}}finally{try{!h&&!o&&(c=f.return)&&(yield bs(c.call(f)))}finally{if(l)throw l.error}}this.recordHistory(n,d)})}recordHistory(e,n){let r=[];n.length>0&&n.every(s=>s.role==="model")?r=n:r.push({role:"model",parts:[]}),this.history.push(e),this.history.push(...r)}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oZ(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&_(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);return n!==void 0&&i!=null&&_(n,["_query","pageToken"],i),r}function aZ(t,e){const n={},r=w(e,["config"]);return r!=null&&_(n,["config"],oZ(t,r,n)),n}function lZ(t,e){const n={},r=w(e,["details"]);r!=null&&_(n,["details"],r);const s=w(e,["message"]);s!=null&&_(n,["message"],s);const i=w(e,["code"]);return i!=null&&_(n,["code"],i),n}function cZ(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["name"],r);const s=w(e,["displayName"]);s!=null&&_(n,["displayName"],s);const i=w(e,["mimeType"]);i!=null&&_(n,["mimeType"],i);const o=w(e,["sizeBytes"]);o!=null&&_(n,["sizeBytes"],o);const l=w(e,["createTime"]);l!=null&&_(n,["createTime"],l);const c=w(e,["expirationTime"]);c!=null&&_(n,["expirationTime"],c);const u=w(e,["updateTime"]);u!=null&&_(n,["updateTime"],u);const d=w(e,["sha256Hash"]);d!=null&&_(n,["sha256Hash"],d);const h=w(e,["uri"]);h!=null&&_(n,["uri"],h);const f=w(e,["downloadUri"]);f!=null&&_(n,["downloadUri"],f);const m=w(e,["state"]);m!=null&&_(n,["state"],m);const g=w(e,["source"]);g!=null&&_(n,["source"],g);const x=w(e,["videoMetadata"]);x!=null&&_(n,["videoMetadata"],x);const E=w(e,["error"]);return E!=null&&_(n,["error"],lZ(t,E)),n}function uZ(t,e){const n={},r=w(e,["file"]);r!=null&&_(n,["file"],cZ(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function dZ(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["_url","file"],dV(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function hZ(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["_url","file"],dV(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function fZ(t,e){const n={},r=w(e,["details"]);r!=null&&_(n,["details"],r);const s=w(e,["message"]);s!=null&&_(n,["message"],s);const i=w(e,["code"]);return i!=null&&_(n,["code"],i),n}function HE(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["name"],r);const s=w(e,["displayName"]);s!=null&&_(n,["displayName"],s);const i=w(e,["mimeType"]);i!=null&&_(n,["mimeType"],i);const o=w(e,["sizeBytes"]);o!=null&&_(n,["sizeBytes"],o);const l=w(e,["createTime"]);l!=null&&_(n,["createTime"],l);const c=w(e,["expirationTime"]);c!=null&&_(n,["expirationTime"],c);const u=w(e,["updateTime"]);u!=null&&_(n,["updateTime"],u);const d=w(e,["sha256Hash"]);d!=null&&_(n,["sha256Hash"],d);const h=w(e,["uri"]);h!=null&&_(n,["uri"],h);const f=w(e,["downloadUri"]);f!=null&&_(n,["downloadUri"],f);const m=w(e,["state"]);m!=null&&_(n,["state"],m);const g=w(e,["source"]);g!=null&&_(n,["source"],g);const x=w(e,["videoMetadata"]);x!=null&&_(n,["videoMetadata"],x);const E=w(e,["error"]);return E!=null&&_(n,["error"],fZ(t,E)),n}function mZ(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&_(n,["nextPageToken"],r);const s=w(e,["files"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>HE(t,o))),_(n,["files"],i)}return n}function pZ(){return{}}function gZ(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let yZ=class extends eg{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new a0(Ph.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>HE(this.apiClient,n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=aZ(this.apiClient,e);return i=Bt("files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=mZ(this.apiClient,c),d=new JQ;return Object.assign(d,u),d})}}async createInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=uZ(this.apiClient,e);return i=Bt("upload/v1beta/files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=pZ(),u=new XQ;return Object.assign(u,c),u})}}async get(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=dZ(this.apiClient,e);return i=Bt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>HE(this.apiClient,c))}}async delete(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=hZ(this.apiClient,e);return i=Bt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=gZ(),u=new QQ;return Object.assign(u,c),u})}}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xZ(t,e){const n={};if(w(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=w(e,["data"]);r!=null&&_(n,["data"],r);const s=w(e,["mimeType"]);return s!=null&&_(n,["mimeType"],s),n}function vZ(t,e){const n={},r=w(e,["displayName"]);r!=null&&_(n,["displayName"],r);const s=w(e,["data"]);s!=null&&_(n,["data"],s);const i=w(e,["mimeType"]);return i!=null&&_(n,["mimeType"],i),n}function wZ(t,e){const n={};if(w(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=w(e,["thought"]);r!=null&&_(n,["thought"],r);const s=w(e,["inlineData"]);s!=null&&_(n,["inlineData"],xZ(t,s));const i=w(e,["codeExecutionResult"]);i!=null&&_(n,["codeExecutionResult"],i);const o=w(e,["executableCode"]);o!=null&&_(n,["executableCode"],o);const l=w(e,["fileData"]);l!=null&&_(n,["fileData"],l);const c=w(e,["functionCall"]);c!=null&&_(n,["functionCall"],c);const u=w(e,["functionResponse"]);u!=null&&_(n,["functionResponse"],u);const d=w(e,["text"]);return d!=null&&_(n,["text"],d),n}function bZ(t,e){const n={},r=w(e,["videoMetadata"]);r!=null&&_(n,["videoMetadata"],r);const s=w(e,["thought"]);s!=null&&_(n,["thought"],s);const i=w(e,["inlineData"]);i!=null&&_(n,["inlineData"],vZ(t,i));const o=w(e,["codeExecutionResult"]);o!=null&&_(n,["codeExecutionResult"],o);const l=w(e,["executableCode"]);l!=null&&_(n,["executableCode"],l);const c=w(e,["fileData"]);c!=null&&_(n,["fileData"],c);const u=w(e,["functionCall"]);u!=null&&_(n,["functionCall"],u);const d=w(e,["functionResponse"]);d!=null&&_(n,["functionResponse"],d);const h=w(e,["text"]);return h!=null&&_(n,["text"],h),n}function _Z(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>wZ(t,o))),_(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&_(n,["role"],s),n}function SZ(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>bZ(t,o))),_(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&_(n,["role"],s),n}function EZ(){return{}}function CZ(){return{}}function TZ(t,e){const n={},r=w(e,["mode"]);r!=null&&_(n,["mode"],r);const s=w(e,["dynamicThreshold"]);return s!=null&&_(n,["dynamicThreshold"],s),n}function IZ(t,e){const n={},r=w(e,["mode"]);r!=null&&_(n,["mode"],r);const s=w(e,["dynamicThreshold"]);return s!=null&&_(n,["dynamicThreshold"],s),n}function NZ(t,e){const n={},r=w(e,["dynamicRetrievalConfig"]);return r!=null&&_(n,["dynamicRetrievalConfig"],TZ(t,r)),n}function PZ(t,e){const n={},r=w(e,["dynamicRetrievalConfig"]);return r!=null&&_(n,["dynamicRetrievalConfig"],IZ(t,r)),n}function AZ(){return{}}function kZ(t,e){const n={},r=w(e,["apiKeyString"]);return r!=null&&_(n,["apiKeyString"],r),n}function RZ(t,e){const n={},r=w(e,["apiKeyConfig"]);r!=null&&_(n,["apiKeyConfig"],kZ(t,r));const s=w(e,["authType"]);s!=null&&_(n,["authType"],s);const i=w(e,["googleServiceAccountConfig"]);i!=null&&_(n,["googleServiceAccountConfig"],i);const o=w(e,["httpBasicAuthConfig"]);o!=null&&_(n,["httpBasicAuthConfig"],o);const l=w(e,["oauthConfig"]);l!=null&&_(n,["oauthConfig"],l);const c=w(e,["oidcConfig"]);return c!=null&&_(n,["oidcConfig"],c),n}function jZ(t,e){const n={},r=w(e,["authConfig"]);return r!=null&&_(n,["authConfig"],RZ(t,r)),n}function DZ(t,e){const n={};if(w(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");w(e,["googleSearch"])!=null&&_(n,["googleSearch"],EZ());const s=w(e,["googleSearchRetrieval"]);if(s!=null&&_(n,["googleSearchRetrieval"],NZ(t,s)),w(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(w(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=w(e,["codeExecution"]);i!=null&&_(n,["codeExecution"],i);const o=w(e,["functionDeclarations"]);return o!=null&&_(n,["functionDeclarations"],o),n}function MZ(t,e){const n={},r=w(e,["retrieval"]);r!=null&&_(n,["retrieval"],r),w(e,["googleSearch"])!=null&&_(n,["googleSearch"],CZ());const i=w(e,["googleSearchRetrieval"]);i!=null&&_(n,["googleSearchRetrieval"],PZ(t,i)),w(e,["enterpriseWebSearch"])!=null&&_(n,["enterpriseWebSearch"],AZ());const l=w(e,["googleMaps"]);l!=null&&_(n,["googleMaps"],jZ(t,l));const c=w(e,["codeExecution"]);c!=null&&_(n,["codeExecution"],c);const u=w(e,["functionDeclarations"]);return u!=null&&_(n,["functionDeclarations"],u),n}function LZ(t,e){const n={},r=w(e,["handle"]);if(r!=null&&_(n,["handle"],r),w(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return n}function FZ(t,e){const n={},r=w(e,["handle"]);r!=null&&_(n,["handle"],r);const s=w(e,["transparent"]);return s!=null&&_(n,["transparent"],s),n}function _j(){return{}}function Sj(){return{}}function OZ(t,e){const n={},r=w(e,["disabled"]);r!=null&&_(n,["disabled"],r);const s=w(e,["startOfSpeechSensitivity"]);s!=null&&_(n,["startOfSpeechSensitivity"],s);const i=w(e,["endOfSpeechSensitivity"]);i!=null&&_(n,["endOfSpeechSensitivity"],i);const o=w(e,["prefixPaddingMs"]);o!=null&&_(n,["prefixPaddingMs"],o);const l=w(e,["silenceDurationMs"]);return l!=null&&_(n,["silenceDurationMs"],l),n}function $Z(t,e){const n={},r=w(e,["disabled"]);r!=null&&_(n,["disabled"],r);const s=w(e,["startOfSpeechSensitivity"]);s!=null&&_(n,["startOfSpeechSensitivity"],s);const i=w(e,["endOfSpeechSensitivity"]);i!=null&&_(n,["endOfSpeechSensitivity"],i);const o=w(e,["prefixPaddingMs"]);o!=null&&_(n,["prefixPaddingMs"],o);const l=w(e,["silenceDurationMs"]);return l!=null&&_(n,["silenceDurationMs"],l),n}function VZ(t,e){const n={},r=w(e,["automaticActivityDetection"]);r!=null&&_(n,["automaticActivityDetection"],OZ(t,r));const s=w(e,["activityHandling"]);s!=null&&_(n,["activityHandling"],s);const i=w(e,["turnCoverage"]);return i!=null&&_(n,["turnCoverage"],i),n}function UZ(t,e){const n={},r=w(e,["automaticActivityDetection"]);r!=null&&_(n,["automaticActivityDetection"],$Z(t,r));const s=w(e,["activityHandling"]);s!=null&&_(n,["activityHandling"],s);const i=w(e,["turnCoverage"]);return i!=null&&_(n,["turnCoverage"],i),n}function BZ(t,e){const n={},r=w(e,["targetTokens"]);return r!=null&&_(n,["targetTokens"],r),n}function zZ(t,e){const n={},r=w(e,["targetTokens"]);return r!=null&&_(n,["targetTokens"],r),n}function GZ(t,e){const n={},r=w(e,["triggerTokens"]);r!=null&&_(n,["triggerTokens"],r);const s=w(e,["slidingWindow"]);return s!=null&&_(n,["slidingWindow"],BZ(t,s)),n}function WZ(t,e){const n={},r=w(e,["triggerTokens"]);r!=null&&_(n,["triggerTokens"],r);const s=w(e,["slidingWindow"]);return s!=null&&_(n,["slidingWindow"],zZ(t,s)),n}function HZ(t,e,n){const r={},s=w(e,["generationConfig"]);n!==void 0&&s!=null&&_(n,["setup","generationConfig"],s);const i=w(e,["responseModalities"]);n!==void 0&&i!=null&&_(n,["setup","generationConfig","responseModalities"],i);const o=w(e,["temperature"]);n!==void 0&&o!=null&&_(n,["setup","generationConfig","temperature"],o);const l=w(e,["topP"]);n!==void 0&&l!=null&&_(n,["setup","generationConfig","topP"],l);const c=w(e,["topK"]);n!==void 0&&c!=null&&_(n,["setup","generationConfig","topK"],c);const u=w(e,["maxOutputTokens"]);n!==void 0&&u!=null&&_(n,["setup","generationConfig","maxOutputTokens"],u);const d=w(e,["mediaResolution"]);n!==void 0&&d!=null&&_(n,["setup","generationConfig","mediaResolution"],d);const h=w(e,["seed"]);n!==void 0&&h!=null&&_(n,["setup","generationConfig","seed"],h);const f=w(e,["speechConfig"]);n!==void 0&&f!=null&&_(n,["setup","generationConfig","speechConfig"],f);const m=w(e,["systemInstruction"]);n!==void 0&&m!=null&&_(n,["setup","systemInstruction"],_Z(t,ni(t,m)));const g=w(e,["tools"]);if(n!==void 0&&g!=null){let I=o0(t,g);Array.isArray(I)&&(I=I.map(D=>DZ(t,i0(t,D)))),_(n,["setup","tools"],I)}const x=w(e,["sessionResumption"]);n!==void 0&&x!=null&&_(n,["setup","sessionResumption"],LZ(t,x));const E=w(e,["inputAudioTranscription"]);n!==void 0&&E!=null&&_(n,["setup","inputAudioTranscription"],_j());const v=w(e,["outputAudioTranscription"]);n!==void 0&&v!=null&&_(n,["setup","outputAudioTranscription"],_j());const b=w(e,["realtimeInputConfig"]);n!==void 0&&b!=null&&_(n,["setup","realtimeInputConfig"],VZ(t,b));const S=w(e,["contextWindowCompression"]);return n!==void 0&&S!=null&&_(n,["setup","contextWindowCompression"],GZ(t,S)),r}function qZ(t,e,n){const r={},s=w(e,["generationConfig"]);n!==void 0&&s!=null&&_(n,["setup","generationConfig"],s);const i=w(e,["responseModalities"]);n!==void 0&&i!=null&&_(n,["setup","generationConfig","responseModalities"],i);const o=w(e,["temperature"]);n!==void 0&&o!=null&&_(n,["setup","generationConfig","temperature"],o);const l=w(e,["topP"]);n!==void 0&&l!=null&&_(n,["setup","generationConfig","topP"],l);const c=w(e,["topK"]);n!==void 0&&c!=null&&_(n,["setup","generationConfig","topK"],c);const u=w(e,["maxOutputTokens"]);n!==void 0&&u!=null&&_(n,["setup","generationConfig","maxOutputTokens"],u);const d=w(e,["mediaResolution"]);n!==void 0&&d!=null&&_(n,["setup","generationConfig","mediaResolution"],d);const h=w(e,["seed"]);n!==void 0&&h!=null&&_(n,["setup","generationConfig","seed"],h);const f=w(e,["speechConfig"]);n!==void 0&&f!=null&&_(n,["setup","generationConfig","speechConfig"],f);const m=w(e,["systemInstruction"]);n!==void 0&&m!=null&&_(n,["setup","systemInstruction"],SZ(t,ni(t,m)));const g=w(e,["tools"]);if(n!==void 0&&g!=null){let I=o0(t,g);Array.isArray(I)&&(I=I.map(D=>MZ(t,i0(t,D)))),_(n,["setup","tools"],I)}const x=w(e,["sessionResumption"]);n!==void 0&&x!=null&&_(n,["setup","sessionResumption"],FZ(t,x));const E=w(e,["inputAudioTranscription"]);n!==void 0&&E!=null&&_(n,["setup","inputAudioTranscription"],Sj());const v=w(e,["outputAudioTranscription"]);n!==void 0&&v!=null&&_(n,["setup","outputAudioTranscription"],Sj());const b=w(e,["realtimeInputConfig"]);n!==void 0&&b!=null&&_(n,["setup","realtimeInputConfig"],UZ(t,b));const S=w(e,["contextWindowCompression"]);return n!==void 0&&S!=null&&_(n,["setup","contextWindowCompression"],WZ(t,S)),r}function KZ(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["setup","model"],er(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],HZ(t,s,n)),n}function YZ(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["setup","model"],er(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],qZ(t,s,n)),n}function JZ(){return{}}function XZ(){return{}}function QZ(){return{}}function ZZ(){return{}}function eee(t,e){const n={},r=w(e,["media"]);r!=null&&_(n,["mediaChunks"],iV(t,r));const s=w(e,["audio"]);s!=null&&_(n,["audio"],ZX(t,s));const i=w(e,["audioStreamEnd"]);i!=null&&_(n,["audioStreamEnd"],i);const o=w(e,["video"]);o!=null&&_(n,["video"],QX(t,o));const l=w(e,["text"]);return l!=null&&_(n,["text"],l),w(e,["activityStart"])!=null&&_(n,["activityStart"],JZ()),w(e,["activityEnd"])!=null&&_(n,["activityEnd"],QZ()),n}function tee(t,e){const n={},r=w(e,["media"]);if(r!=null&&_(n,["mediaChunks"],iV(t,r)),w(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const s=w(e,["audioStreamEnd"]);if(s!=null&&_(n,["audioStreamEnd"],s),w(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(w(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return w(e,["activityStart"])!=null&&_(n,["activityStart"],XZ()),w(e,["activityEnd"])!=null&&_(n,["activityEnd"],ZZ()),n}function nee(){return{}}function ree(){return{}}function see(t,e){const n={},r=w(e,["data"]);r!=null&&_(n,["data"],r);const s=w(e,["mimeType"]);return s!=null&&_(n,["mimeType"],s),n}function iee(t,e){const n={},r=w(e,["displayName"]);r!=null&&_(n,["displayName"],r);const s=w(e,["data"]);s!=null&&_(n,["data"],s);const i=w(e,["mimeType"]);return i!=null&&_(n,["mimeType"],i),n}function oee(t,e){const n={},r=w(e,["thought"]);r!=null&&_(n,["thought"],r);const s=w(e,["inlineData"]);s!=null&&_(n,["inlineData"],see(t,s));const i=w(e,["codeExecutionResult"]);i!=null&&_(n,["codeExecutionResult"],i);const o=w(e,["executableCode"]);o!=null&&_(n,["executableCode"],o);const l=w(e,["fileData"]);l!=null&&_(n,["fileData"],l);const c=w(e,["functionCall"]);c!=null&&_(n,["functionCall"],c);const u=w(e,["functionResponse"]);u!=null&&_(n,["functionResponse"],u);const d=w(e,["text"]);return d!=null&&_(n,["text"],d),n}function aee(t,e){const n={},r=w(e,["videoMetadata"]);r!=null&&_(n,["videoMetadata"],r);const s=w(e,["thought"]);s!=null&&_(n,["thought"],s);const i=w(e,["inlineData"]);i!=null&&_(n,["inlineData"],iee(t,i));const o=w(e,["codeExecutionResult"]);o!=null&&_(n,["codeExecutionResult"],o);const l=w(e,["executableCode"]);l!=null&&_(n,["executableCode"],l);const c=w(e,["fileData"]);c!=null&&_(n,["fileData"],c);const u=w(e,["functionCall"]);u!=null&&_(n,["functionCall"],u);const d=w(e,["functionResponse"]);d!=null&&_(n,["functionResponse"],d);const h=w(e,["text"]);return h!=null&&_(n,["text"],h),n}function lee(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>oee(t,o))),_(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&_(n,["role"],s),n}function cee(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>aee(t,o))),_(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&_(n,["role"],s),n}function Ej(t,e){const n={},r=w(e,["text"]);r!=null&&_(n,["text"],r);const s=w(e,["finished"]);return s!=null&&_(n,["finished"],s),n}function Cj(t,e){const n={},r=w(e,["text"]);r!=null&&_(n,["text"],r);const s=w(e,["finished"]);return s!=null&&_(n,["finished"],s),n}function uee(t,e){const n={},r=w(e,["modelTurn"]);r!=null&&_(n,["modelTurn"],lee(t,r));const s=w(e,["turnComplete"]);s!=null&&_(n,["turnComplete"],s);const i=w(e,["interrupted"]);i!=null&&_(n,["interrupted"],i);const o=w(e,["groundingMetadata"]);o!=null&&_(n,["groundingMetadata"],o);const l=w(e,["generationComplete"]);l!=null&&_(n,["generationComplete"],l);const c=w(e,["inputTranscription"]);c!=null&&_(n,["inputTranscription"],Ej(t,c));const u=w(e,["outputTranscription"]);return u!=null&&_(n,["outputTranscription"],Ej(t,u)),n}function dee(t,e){const n={},r=w(e,["modelTurn"]);r!=null&&_(n,["modelTurn"],cee(t,r));const s=w(e,["turnComplete"]);s!=null&&_(n,["turnComplete"],s);const i=w(e,["interrupted"]);i!=null&&_(n,["interrupted"],i);const o=w(e,["groundingMetadata"]);o!=null&&_(n,["groundingMetadata"],o);const l=w(e,["generationComplete"]);l!=null&&_(n,["generationComplete"],l);const c=w(e,["inputTranscription"]);c!=null&&_(n,["inputTranscription"],Cj(t,c));const u=w(e,["outputTranscription"]);return u!=null&&_(n,["outputTranscription"],Cj(t,u)),n}function hee(t,e){const n={},r=w(e,["id"]);r!=null&&_(n,["id"],r);const s=w(e,["args"]);s!=null&&_(n,["args"],s);const i=w(e,["name"]);return i!=null&&_(n,["name"],i),n}function fee(t,e){const n={},r=w(e,["args"]);r!=null&&_(n,["args"],r);const s=w(e,["name"]);return s!=null&&_(n,["name"],s),n}function mee(t,e){const n={},r=w(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>hee(t,i))),_(n,["functionCalls"],s)}return n}function pee(t,e){const n={},r=w(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>fee(t,i))),_(n,["functionCalls"],s)}return n}function gee(t,e){const n={},r=w(e,["ids"]);return r!=null&&_(n,["ids"],r),n}function yee(t,e){const n={},r=w(e,["ids"]);return r!=null&&_(n,["ids"],r),n}function yy(t,e){const n={},r=w(e,["modality"]);r!=null&&_(n,["modality"],r);const s=w(e,["tokenCount"]);return s!=null&&_(n,["tokenCount"],s),n}function xy(t,e){const n={},r=w(e,["modality"]);r!=null&&_(n,["modality"],r);const s=w(e,["tokenCount"]);return s!=null&&_(n,["tokenCount"],s),n}function xee(t,e){const n={},r=w(e,["promptTokenCount"]);r!=null&&_(n,["promptTokenCount"],r);const s=w(e,["cachedContentTokenCount"]);s!=null&&_(n,["cachedContentTokenCount"],s);const i=w(e,["responseTokenCount"]);i!=null&&_(n,["responseTokenCount"],i);const o=w(e,["toolUsePromptTokenCount"]);o!=null&&_(n,["toolUsePromptTokenCount"],o);const l=w(e,["thoughtsTokenCount"]);l!=null&&_(n,["thoughtsTokenCount"],l);const c=w(e,["totalTokenCount"]);c!=null&&_(n,["totalTokenCount"],c);const u=w(e,["promptTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(g=>yy(t,g))),_(n,["promptTokensDetails"],m)}const d=w(e,["cacheTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(g=>yy(t,g))),_(n,["cacheTokensDetails"],m)}const h=w(e,["responseTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>yy(t,g))),_(n,["responseTokensDetails"],m)}const f=w(e,["toolUsePromptTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>yy(t,g))),_(n,["toolUsePromptTokensDetails"],m)}return n}function vee(t,e){const n={},r=w(e,["promptTokenCount"]);r!=null&&_(n,["promptTokenCount"],r);const s=w(e,["cachedContentTokenCount"]);s!=null&&_(n,["cachedContentTokenCount"],s);const i=w(e,["candidatesTokenCount"]);i!=null&&_(n,["responseTokenCount"],i);const o=w(e,["toolUsePromptTokenCount"]);o!=null&&_(n,["toolUsePromptTokenCount"],o);const l=w(e,["thoughtsTokenCount"]);l!=null&&_(n,["thoughtsTokenCount"],l);const c=w(e,["totalTokenCount"]);c!=null&&_(n,["totalTokenCount"],c);const u=w(e,["promptTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(x=>xy(t,x))),_(n,["promptTokensDetails"],g)}const d=w(e,["cacheTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(x=>xy(t,x))),_(n,["cacheTokensDetails"],g)}const h=w(e,["candidatesTokensDetails"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(x=>xy(t,x))),_(n,["responseTokensDetails"],g)}const f=w(e,["toolUsePromptTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(x=>xy(t,x))),_(n,["toolUsePromptTokensDetails"],g)}const m=w(e,["trafficType"]);return m!=null&&_(n,["trafficType"],m),n}function wee(t,e){const n={},r=w(e,["timeLeft"]);return r!=null&&_(n,["timeLeft"],r),n}function bee(t,e){const n={},r=w(e,["timeLeft"]);return r!=null&&_(n,["timeLeft"],r),n}function _ee(t,e){const n={},r=w(e,["newHandle"]);r!=null&&_(n,["newHandle"],r);const s=w(e,["resumable"]);s!=null&&_(n,["resumable"],s);const i=w(e,["lastConsumedClientMessageIndex"]);return i!=null&&_(n,["lastConsumedClientMessageIndex"],i),n}function See(t,e){const n={},r=w(e,["newHandle"]);r!=null&&_(n,["newHandle"],r);const s=w(e,["resumable"]);s!=null&&_(n,["resumable"],s);const i=w(e,["lastConsumedClientMessageIndex"]);return i!=null&&_(n,["lastConsumedClientMessageIndex"],i),n}function Eee(t,e){const n={};w(e,["setupComplete"])!=null&&_(n,["setupComplete"],nee());const s=w(e,["serverContent"]);s!=null&&_(n,["serverContent"],uee(t,s));const i=w(e,["toolCall"]);i!=null&&_(n,["toolCall"],mee(t,i));const o=w(e,["toolCallCancellation"]);o!=null&&_(n,["toolCallCancellation"],gee(t,o));const l=w(e,["usageMetadata"]);l!=null&&_(n,["usageMetadata"],xee(t,l));const c=w(e,["goAway"]);c!=null&&_(n,["goAway"],wee(t,c));const u=w(e,["sessionResumptionUpdate"]);return u!=null&&_(n,["sessionResumptionUpdate"],_ee(t,u)),n}function Cee(t,e){const n={};w(e,["setupComplete"])!=null&&_(n,["setupComplete"],ree());const s=w(e,["serverContent"]);s!=null&&_(n,["serverContent"],dee(t,s));const i=w(e,["toolCall"]);i!=null&&_(n,["toolCall"],pee(t,i));const o=w(e,["toolCallCancellation"]);o!=null&&_(n,["toolCallCancellation"],yee(t,o));const l=w(e,["usageMetadata"]);l!=null&&_(n,["usageMetadata"],vee(t,l));const c=w(e,["goAway"]);c!=null&&_(n,["goAway"],bee(t,c));const u=w(e,["sessionResumptionUpdate"]);return u!=null&&_(n,["sessionResumptionUpdate"],See(t,u)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Tee(t,e){const n={};if(w(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=w(e,["data"]);r!=null&&_(n,["data"],r);const s=w(e,["mimeType"]);return s!=null&&_(n,["mimeType"],s),n}function Iee(t,e){const n={};if(w(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=w(e,["thought"]);r!=null&&_(n,["thought"],r);const s=w(e,["inlineData"]);s!=null&&_(n,["inlineData"],Tee(t,s));const i=w(e,["codeExecutionResult"]);i!=null&&_(n,["codeExecutionResult"],i);const o=w(e,["executableCode"]);o!=null&&_(n,["executableCode"],o);const l=w(e,["fileData"]);l!=null&&_(n,["fileData"],l);const c=w(e,["functionCall"]);c!=null&&_(n,["functionCall"],c);const u=w(e,["functionResponse"]);u!=null&&_(n,["functionResponse"],u);const d=w(e,["text"]);return d!=null&&_(n,["text"],d),n}function l0(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Iee(t,o))),_(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&_(n,["role"],s),n}function Nee(t,e){const n={};if(w(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=w(e,["category"]);r!=null&&_(n,["category"],r);const s=w(e,["threshold"]);return s!=null&&_(n,["threshold"],s),n}function Pee(){return{}}function Aee(t,e){const n={},r=w(e,["mode"]);r!=null&&_(n,["mode"],r);const s=w(e,["dynamicThreshold"]);return s!=null&&_(n,["dynamicThreshold"],s),n}function kee(t,e){const n={},r=w(e,["dynamicRetrievalConfig"]);return r!=null&&_(n,["dynamicRetrievalConfig"],Aee(t,r)),n}function Ree(t,e){const n={};if(w(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");w(e,["googleSearch"])!=null&&_(n,["googleSearch"],Pee());const s=w(e,["googleSearchRetrieval"]);if(s!=null&&_(n,["googleSearchRetrieval"],kee(t,s)),w(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(w(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=w(e,["codeExecution"]);i!=null&&_(n,["codeExecution"],i);const o=w(e,["functionDeclarations"]);return o!=null&&_(n,["functionDeclarations"],o),n}function jee(t,e){const n={},r=w(e,["mode"]);r!=null&&_(n,["mode"],r);const s=w(e,["allowedFunctionNames"]);return s!=null&&_(n,["allowedFunctionNames"],s),n}function Dee(t,e){const n={},r=w(e,["functionCallingConfig"]);if(r!=null&&_(n,["functionCallingConfig"],jee(t,r)),w(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}function Mee(t,e){const n={},r=w(e,["voiceName"]);return r!=null&&_(n,["voiceName"],r),n}function Lee(t,e){const n={},r=w(e,["prebuiltVoiceConfig"]);return r!=null&&_(n,["prebuiltVoiceConfig"],Mee(t,r)),n}function Fee(t,e){const n={},r=w(e,["voiceConfig"]);r!=null&&_(n,["voiceConfig"],Lee(t,r));const s=w(e,["languageCode"]);return s!=null&&_(n,["languageCode"],s),n}function Oee(t,e){const n={},r=w(e,["includeThoughts"]);r!=null&&_(n,["includeThoughts"],r);const s=w(e,["thinkingBudget"]);return s!=null&&_(n,["thinkingBudget"],s),n}function $ee(t,e,n){const r={},s=w(e,["systemInstruction"]);n!==void 0&&s!=null&&_(n,["systemInstruction"],l0(t,ni(t,s)));const i=w(e,["temperature"]);i!=null&&_(r,["temperature"],i);const o=w(e,["topP"]);o!=null&&_(r,["topP"],o);const l=w(e,["topK"]);l!=null&&_(r,["topK"],l);const c=w(e,["candidateCount"]);c!=null&&_(r,["candidateCount"],c);const u=w(e,["maxOutputTokens"]);u!=null&&_(r,["maxOutputTokens"],u);const d=w(e,["stopSequences"]);d!=null&&_(r,["stopSequences"],d);const h=w(e,["responseLogprobs"]);h!=null&&_(r,["responseLogprobs"],h);const f=w(e,["logprobs"]);f!=null&&_(r,["logprobs"],f);const m=w(e,["presencePenalty"]);m!=null&&_(r,["presencePenalty"],m);const g=w(e,["frequencyPenalty"]);g!=null&&_(r,["frequencyPenalty"],g);const x=w(e,["seed"]);x!=null&&_(r,["seed"],x);const E=w(e,["responseMimeType"]);E!=null&&_(r,["responseMimeType"],E);const v=w(e,["responseSchema"]);if(v!=null&&_(r,["responseSchema"],lV(t,v)),w(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(w(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=w(e,["safetySettings"]);if(n!==void 0&&b!=null){let A=b;Array.isArray(A)&&(A=A.map(R=>Nee(t,R))),_(n,["safetySettings"],A)}const S=w(e,["tools"]);if(n!==void 0&&S!=null){let A=o0(t,S);Array.isArray(A)&&(A=A.map(R=>Ree(t,i0(t,R)))),_(n,["tools"],A)}const I=w(e,["toolConfig"]);if(n!==void 0&&I!=null&&_(n,["toolConfig"],Dee(t,I)),w(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const D=w(e,["cachedContent"]);n!==void 0&&D!=null&&_(n,["cachedContent"],fc(t,D));const k=w(e,["responseModalities"]);k!=null&&_(r,["responseModalities"],k);const C=w(e,["mediaResolution"]);C!=null&&_(r,["mediaResolution"],C);const T=w(e,["speechConfig"]);if(T!=null&&_(r,["speechConfig"],Fee(t,cV(t,T))),w(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=w(e,["thinkingConfig"]);return P!=null&&_(r,["thinkingConfig"],Oee(t,P)),r}function Tj(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["contents"]);if(s!=null){let o=hc(t,s);Array.isArray(o)&&(o=o.map(l=>l0(t,l))),_(n,["contents"],o)}const i=w(e,["config"]);return i!=null&&_(n,["generationConfig"],$ee(t,i,n)),n}function Vee(t,e,n){const r={},s=w(e,["taskType"]);n!==void 0&&s!=null&&_(n,["requests[]","taskType"],s);const i=w(e,["title"]);n!==void 0&&i!=null&&_(n,["requests[]","title"],i);const o=w(e,["outputDimensionality"]);if(n!==void 0&&o!=null&&_(n,["requests[]","outputDimensionality"],o),w(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(w(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function Uee(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["contents"]);s!=null&&_(n,["requests[]","content"],aV(t,s));const i=w(e,["config"]);i!=null&&_(n,["config"],Vee(t,i,n));const o=w(e,["model"]);return o!==void 0&&_(n,["requests[]","model"],er(t,o)),n}function Bee(t,e,n){const r={};if(w(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(w(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=w(e,["numberOfImages"]);n!==void 0&&s!=null&&_(n,["parameters","sampleCount"],s);const i=w(e,["aspectRatio"]);n!==void 0&&i!=null&&_(n,["parameters","aspectRatio"],i);const o=w(e,["guidanceScale"]);if(n!==void 0&&o!=null&&_(n,["parameters","guidanceScale"],o),w(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=w(e,["safetyFilterLevel"]);n!==void 0&&l!=null&&_(n,["parameters","safetySetting"],l);const c=w(e,["personGeneration"]);n!==void 0&&c!=null&&_(n,["parameters","personGeneration"],c);const u=w(e,["includeSafetyAttributes"]);n!==void 0&&u!=null&&_(n,["parameters","includeSafetyAttributes"],u);const d=w(e,["includeRaiReason"]);n!==void 0&&d!=null&&_(n,["parameters","includeRaiReason"],d);const h=w(e,["language"]);n!==void 0&&h!=null&&_(n,["parameters","language"],h);const f=w(e,["outputMimeType"]);n!==void 0&&f!=null&&_(n,["parameters","outputOptions","mimeType"],f);const m=w(e,["outputCompressionQuality"]);if(n!==void 0&&m!=null&&_(n,["parameters","outputOptions","compressionQuality"],m),w(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(w(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function zee(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["prompt"]);s!=null&&_(n,["instances[0]","prompt"],s);const i=w(e,["config"]);return i!=null&&_(n,["config"],Bee(t,i,n)),n}function Gee(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","name"],er(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function Wee(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&_(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);n!==void 0&&i!=null&&_(n,["_query","pageToken"],i);const o=w(e,["filter"]);n!==void 0&&o!=null&&_(n,["_query","filter"],o);const l=w(e,["queryBase"]);return n!==void 0&&l!=null&&_(n,["_url","models_url"],hV(t,l)),r}function Hee(t,e){const n={},r=w(e,["config"]);return r!=null&&_(n,["config"],Wee(t,r,n)),n}function qee(t,e,n){const r={},s=w(e,["displayName"]);n!==void 0&&s!=null&&_(n,["displayName"],s);const i=w(e,["description"]);n!==void 0&&i!=null&&_(n,["description"],i);const o=w(e,["defaultCheckpointId"]);return n!==void 0&&o!=null&&_(n,["defaultCheckpointId"],o),r}function Kee(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","name"],er(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],qee(t,s,n)),n}function Yee(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","name"],er(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function Jee(t,e){const n={};if(w(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(w(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(w(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return n}function Xee(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["contents"]);if(s!=null){let o=hc(t,s);Array.isArray(o)&&(o=o.map(l=>l0(t,l))),_(n,["contents"],o)}const i=w(e,["config"]);return i!=null&&_(n,["config"],Jee(t,i)),n}function Qee(t,e){const n={};if(w(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=w(e,["imageBytes"]);r!=null&&_(n,["bytesBase64Encoded"],mc(t,r));const s=w(e,["mimeType"]);return s!=null&&_(n,["mimeType"],s),n}function Zee(t,e,n){const r={},s=w(e,["numberOfVideos"]);if(n!==void 0&&s!=null&&_(n,["parameters","sampleCount"],s),w(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(w(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=w(e,["durationSeconds"]);if(n!==void 0&&i!=null&&_(n,["parameters","durationSeconds"],i),w(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=w(e,["aspectRatio"]);if(n!==void 0&&o!=null&&_(n,["parameters","aspectRatio"],o),w(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=w(e,["personGeneration"]);if(n!==void 0&&l!=null&&_(n,["parameters","personGeneration"],l),w(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=w(e,["negativePrompt"]);if(n!==void 0&&c!=null&&_(n,["parameters","negativePrompt"],c),w(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function ete(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["prompt"]);s!=null&&_(n,["instances[0]","prompt"],s);const i=w(e,["image"]);i!=null&&_(n,["instances[0]","image"],Qee(t,i));const o=w(e,["config"]);return o!=null&&_(n,["config"],Zee(t,o,n)),n}function tte(t,e){const n={},r=w(e,["displayName"]);r!=null&&_(n,["displayName"],r);const s=w(e,["data"]);s!=null&&_(n,["data"],s);const i=w(e,["mimeType"]);return i!=null&&_(n,["mimeType"],i),n}function nte(t,e){const n={},r=w(e,["videoMetadata"]);r!=null&&_(n,["videoMetadata"],r);const s=w(e,["thought"]);s!=null&&_(n,["thought"],s);const i=w(e,["inlineData"]);i!=null&&_(n,["inlineData"],tte(t,i));const o=w(e,["codeExecutionResult"]);o!=null&&_(n,["codeExecutionResult"],o);const l=w(e,["executableCode"]);l!=null&&_(n,["executableCode"],l);const c=w(e,["fileData"]);c!=null&&_(n,["fileData"],c);const u=w(e,["functionCall"]);u!=null&&_(n,["functionCall"],u);const d=w(e,["functionResponse"]);d!=null&&_(n,["functionResponse"],d);const h=w(e,["text"]);return h!=null&&_(n,["text"],h),n}function rf(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>nte(t,o))),_(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&_(n,["role"],s),n}function rte(t,e){const n={},r=w(e,["featureSelectionPreference"]);return r!=null&&_(n,["featureSelectionPreference"],r),n}function ste(t,e){const n={},r=w(e,["method"]);r!=null&&_(n,["method"],r);const s=w(e,["category"]);s!=null&&_(n,["category"],s);const i=w(e,["threshold"]);return i!=null&&_(n,["threshold"],i),n}function ite(){return{}}function ote(t,e){const n={},r=w(e,["mode"]);r!=null&&_(n,["mode"],r);const s=w(e,["dynamicThreshold"]);return s!=null&&_(n,["dynamicThreshold"],s),n}function ate(t,e){const n={},r=w(e,["dynamicRetrievalConfig"]);return r!=null&&_(n,["dynamicRetrievalConfig"],ote(t,r)),n}function lte(){return{}}function cte(t,e){const n={},r=w(e,["apiKeyString"]);return r!=null&&_(n,["apiKeyString"],r),n}function ute(t,e){const n={},r=w(e,["apiKeyConfig"]);r!=null&&_(n,["apiKeyConfig"],cte(t,r));const s=w(e,["authType"]);s!=null&&_(n,["authType"],s);const i=w(e,["googleServiceAccountConfig"]);i!=null&&_(n,["googleServiceAccountConfig"],i);const o=w(e,["httpBasicAuthConfig"]);o!=null&&_(n,["httpBasicAuthConfig"],o);const l=w(e,["oauthConfig"]);l!=null&&_(n,["oauthConfig"],l);const c=w(e,["oidcConfig"]);return c!=null&&_(n,["oidcConfig"],c),n}function dte(t,e){const n={},r=w(e,["authConfig"]);return r!=null&&_(n,["authConfig"],ute(t,r)),n}function pV(t,e){const n={},r=w(e,["retrieval"]);r!=null&&_(n,["retrieval"],r),w(e,["googleSearch"])!=null&&_(n,["googleSearch"],ite());const i=w(e,["googleSearchRetrieval"]);i!=null&&_(n,["googleSearchRetrieval"],ate(t,i)),w(e,["enterpriseWebSearch"])!=null&&_(n,["enterpriseWebSearch"],lte());const l=w(e,["googleMaps"]);l!=null&&_(n,["googleMaps"],dte(t,l));const c=w(e,["codeExecution"]);c!=null&&_(n,["codeExecution"],c);const u=w(e,["functionDeclarations"]);return u!=null&&_(n,["functionDeclarations"],u),n}function hte(t,e){const n={},r=w(e,["mode"]);r!=null&&_(n,["mode"],r);const s=w(e,["allowedFunctionNames"]);return s!=null&&_(n,["allowedFunctionNames"],s),n}function fte(t,e){const n={},r=w(e,["latitude"]);r!=null&&_(n,["latitude"],r);const s=w(e,["longitude"]);return s!=null&&_(n,["longitude"],s),n}function mte(t,e){const n={},r=w(e,["latLng"]);return r!=null&&_(n,["latLng"],fte(t,r)),n}function pte(t,e){const n={},r=w(e,["functionCallingConfig"]);r!=null&&_(n,["functionCallingConfig"],hte(t,r));const s=w(e,["retrievalConfig"]);return s!=null&&_(n,["retrievalConfig"],mte(t,s)),n}function gte(t,e){const n={},r=w(e,["voiceName"]);return r!=null&&_(n,["voiceName"],r),n}function yte(t,e){const n={},r=w(e,["prebuiltVoiceConfig"]);return r!=null&&_(n,["prebuiltVoiceConfig"],gte(t,r)),n}function xte(t,e){const n={},r=w(e,["voiceConfig"]);r!=null&&_(n,["voiceConfig"],yte(t,r));const s=w(e,["languageCode"]);return s!=null&&_(n,["languageCode"],s),n}function vte(t,e){const n={},r=w(e,["includeThoughts"]);r!=null&&_(n,["includeThoughts"],r);const s=w(e,["thinkingBudget"]);return s!=null&&_(n,["thinkingBudget"],s),n}function wte(t,e,n){const r={},s=w(e,["systemInstruction"]);n!==void 0&&s!=null&&_(n,["systemInstruction"],rf(t,ni(t,s)));const i=w(e,["temperature"]);i!=null&&_(r,["temperature"],i);const o=w(e,["topP"]);o!=null&&_(r,["topP"],o);const l=w(e,["topK"]);l!=null&&_(r,["topK"],l);const c=w(e,["candidateCount"]);c!=null&&_(r,["candidateCount"],c);const u=w(e,["maxOutputTokens"]);u!=null&&_(r,["maxOutputTokens"],u);const d=w(e,["stopSequences"]);d!=null&&_(r,["stopSequences"],d);const h=w(e,["responseLogprobs"]);h!=null&&_(r,["responseLogprobs"],h);const f=w(e,["logprobs"]);f!=null&&_(r,["logprobs"],f);const m=w(e,["presencePenalty"]);m!=null&&_(r,["presencePenalty"],m);const g=w(e,["frequencyPenalty"]);g!=null&&_(r,["frequencyPenalty"],g);const x=w(e,["seed"]);x!=null&&_(r,["seed"],x);const E=w(e,["responseMimeType"]);E!=null&&_(r,["responseMimeType"],E);const v=w(e,["responseSchema"]);v!=null&&_(r,["responseSchema"],lV(t,v));const b=w(e,["routingConfig"]);b!=null&&_(r,["routingConfig"],b);const S=w(e,["modelSelectionConfig"]);S!=null&&_(r,["modelConfig"],rte(t,S));const I=w(e,["safetySettings"]);if(n!==void 0&&I!=null){let z=I;Array.isArray(z)&&(z=z.map(W=>ste(t,W))),_(n,["safetySettings"],z)}const D=w(e,["tools"]);if(n!==void 0&&D!=null){let z=o0(t,D);Array.isArray(z)&&(z=z.map(W=>pV(t,i0(t,W)))),_(n,["tools"],z)}const k=w(e,["toolConfig"]);n!==void 0&&k!=null&&_(n,["toolConfig"],pte(t,k));const C=w(e,["labels"]);n!==void 0&&C!=null&&_(n,["labels"],C);const T=w(e,["cachedContent"]);n!==void 0&&T!=null&&_(n,["cachedContent"],fc(t,T));const P=w(e,["responseModalities"]);P!=null&&_(r,["responseModalities"],P);const A=w(e,["mediaResolution"]);A!=null&&_(r,["mediaResolution"],A);const R=w(e,["speechConfig"]);R!=null&&_(r,["speechConfig"],xte(t,cV(t,R)));const M=w(e,["audioTimestamp"]);M!=null&&_(r,["audioTimestamp"],M);const j=w(e,["thinkingConfig"]);return j!=null&&_(r,["thinkingConfig"],vte(t,j)),r}function Ij(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["contents"]);if(s!=null){let o=hc(t,s);Array.isArray(o)&&(o=o.map(l=>rf(t,l))),_(n,["contents"],o)}const i=w(e,["config"]);return i!=null&&_(n,["generationConfig"],wte(t,i,n)),n}function bte(t,e,n){const r={},s=w(e,["taskType"]);n!==void 0&&s!=null&&_(n,["instances[]","task_type"],s);const i=w(e,["title"]);n!==void 0&&i!=null&&_(n,["instances[]","title"],i);const o=w(e,["outputDimensionality"]);n!==void 0&&o!=null&&_(n,["parameters","outputDimensionality"],o);const l=w(e,["mimeType"]);n!==void 0&&l!=null&&_(n,["instances[]","mimeType"],l);const c=w(e,["autoTruncate"]);return n!==void 0&&c!=null&&_(n,["parameters","autoTruncate"],c),r}function _te(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["contents"]);s!=null&&_(n,["instances[]","content"],aV(t,s));const i=w(e,["config"]);return i!=null&&_(n,["config"],bte(t,i,n)),n}function Ste(t,e,n){const r={},s=w(e,["outputGcsUri"]);n!==void 0&&s!=null&&_(n,["parameters","storageUri"],s);const i=w(e,["negativePrompt"]);n!==void 0&&i!=null&&_(n,["parameters","negativePrompt"],i);const o=w(e,["numberOfImages"]);n!==void 0&&o!=null&&_(n,["parameters","sampleCount"],o);const l=w(e,["aspectRatio"]);n!==void 0&&l!=null&&_(n,["parameters","aspectRatio"],l);const c=w(e,["guidanceScale"]);n!==void 0&&c!=null&&_(n,["parameters","guidanceScale"],c);const u=w(e,["seed"]);n!==void 0&&u!=null&&_(n,["parameters","seed"],u);const d=w(e,["safetyFilterLevel"]);n!==void 0&&d!=null&&_(n,["parameters","safetySetting"],d);const h=w(e,["personGeneration"]);n!==void 0&&h!=null&&_(n,["parameters","personGeneration"],h);const f=w(e,["includeSafetyAttributes"]);n!==void 0&&f!=null&&_(n,["parameters","includeSafetyAttributes"],f);const m=w(e,["includeRaiReason"]);n!==void 0&&m!=null&&_(n,["parameters","includeRaiReason"],m);const g=w(e,["language"]);n!==void 0&&g!=null&&_(n,["parameters","language"],g);const x=w(e,["outputMimeType"]);n!==void 0&&x!=null&&_(n,["parameters","outputOptions","mimeType"],x);const E=w(e,["outputCompressionQuality"]);n!==void 0&&E!=null&&_(n,["parameters","outputOptions","compressionQuality"],E);const v=w(e,["addWatermark"]);n!==void 0&&v!=null&&_(n,["parameters","addWatermark"],v);const b=w(e,["enhancePrompt"]);return n!==void 0&&b!=null&&_(n,["parameters","enhancePrompt"],b),r}function Ete(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["prompt"]);s!=null&&_(n,["instances[0]","prompt"],s);const i=w(e,["config"]);return i!=null&&_(n,["config"],Ste(t,i,n)),n}function V1(t,e){const n={},r=w(e,["gcsUri"]);r!=null&&_(n,["gcsUri"],r);const s=w(e,["imageBytes"]);s!=null&&_(n,["bytesBase64Encoded"],mc(t,s));const i=w(e,["mimeType"]);return i!=null&&_(n,["mimeType"],i),n}function Cte(t,e){const n={},r=w(e,["maskMode"]);r!=null&&_(n,["maskMode"],r);const s=w(e,["segmentationClasses"]);s!=null&&_(n,["maskClasses"],s);const i=w(e,["maskDilation"]);return i!=null&&_(n,["dilation"],i),n}function Tte(t,e){const n={},r=w(e,["controlType"]);r!=null&&_(n,["controlType"],r);const s=w(e,["enableControlImageComputation"]);return s!=null&&_(n,["computeControl"],s),n}function Ite(t,e){const n={},r=w(e,["styleDescription"]);return r!=null&&_(n,["styleDescription"],r),n}function Nte(t,e){const n={},r=w(e,["subjectType"]);r!=null&&_(n,["subjectType"],r);const s=w(e,["subjectDescription"]);return s!=null&&_(n,["subjectDescription"],s),n}function Pte(t,e){const n={},r=w(e,["referenceImage"]);r!=null&&_(n,["referenceImage"],V1(t,r));const s=w(e,["referenceId"]);s!=null&&_(n,["referenceId"],s);const i=w(e,["referenceType"]);i!=null&&_(n,["referenceType"],i);const o=w(e,["maskImageConfig"]);o!=null&&_(n,["maskImageConfig"],Cte(t,o));const l=w(e,["controlImageConfig"]);l!=null&&_(n,["controlImageConfig"],Tte(t,l));const c=w(e,["styleImageConfig"]);c!=null&&_(n,["styleImageConfig"],Ite(t,c));const u=w(e,["subjectImageConfig"]);return u!=null&&_(n,["subjectImageConfig"],Nte(t,u)),n}function Ate(t,e,n){const r={},s=w(e,["outputGcsUri"]);n!==void 0&&s!=null&&_(n,["parameters","storageUri"],s);const i=w(e,["negativePrompt"]);n!==void 0&&i!=null&&_(n,["parameters","negativePrompt"],i);const o=w(e,["numberOfImages"]);n!==void 0&&o!=null&&_(n,["parameters","sampleCount"],o);const l=w(e,["aspectRatio"]);n!==void 0&&l!=null&&_(n,["parameters","aspectRatio"],l);const c=w(e,["guidanceScale"]);n!==void 0&&c!=null&&_(n,["parameters","guidanceScale"],c);const u=w(e,["seed"]);n!==void 0&&u!=null&&_(n,["parameters","seed"],u);const d=w(e,["safetyFilterLevel"]);n!==void 0&&d!=null&&_(n,["parameters","safetySetting"],d);const h=w(e,["personGeneration"]);n!==void 0&&h!=null&&_(n,["parameters","personGeneration"],h);const f=w(e,["includeSafetyAttributes"]);n!==void 0&&f!=null&&_(n,["parameters","includeSafetyAttributes"],f);const m=w(e,["includeRaiReason"]);n!==void 0&&m!=null&&_(n,["parameters","includeRaiReason"],m);const g=w(e,["language"]);n!==void 0&&g!=null&&_(n,["parameters","language"],g);const x=w(e,["outputMimeType"]);n!==void 0&&x!=null&&_(n,["parameters","outputOptions","mimeType"],x);const E=w(e,["outputCompressionQuality"]);n!==void 0&&E!=null&&_(n,["parameters","outputOptions","compressionQuality"],E);const v=w(e,["editMode"]);n!==void 0&&v!=null&&_(n,["parameters","editMode"],v);const b=w(e,["baseSteps"]);return n!==void 0&&b!=null&&_(n,["parameters","editConfig","baseSteps"],b),r}function kte(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["prompt"]);s!=null&&_(n,["instances[0]","prompt"],s);const i=w(e,["referenceImages"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>Pte(t,c))),_(n,["instances[0]","referenceImages"],l)}const o=w(e,["config"]);return o!=null&&_(n,["config"],Ate(t,o,n)),n}function Rte(t,e,n){const r={},s=w(e,["includeRaiReason"]);n!==void 0&&s!=null&&_(n,["parameters","includeRaiReason"],s);const i=w(e,["outputMimeType"]);n!==void 0&&i!=null&&_(n,["parameters","outputOptions","mimeType"],i);const o=w(e,["outputCompressionQuality"]);n!==void 0&&o!=null&&_(n,["parameters","outputOptions","compressionQuality"],o);const l=w(e,["numberOfImages"]);n!==void 0&&l!=null&&_(n,["parameters","sampleCount"],l);const c=w(e,["mode"]);return n!==void 0&&c!=null&&_(n,["parameters","mode"],c),r}function jte(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["image"]);s!=null&&_(n,["instances[0]","image"],V1(t,s));const i=w(e,["upscaleFactor"]);i!=null&&_(n,["parameters","upscaleConfig","upscaleFactor"],i);const o=w(e,["config"]);return o!=null&&_(n,["config"],Rte(t,o,n)),n}function Dte(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","name"],er(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function Mte(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&_(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);n!==void 0&&i!=null&&_(n,["_query","pageToken"],i);const o=w(e,["filter"]);n!==void 0&&o!=null&&_(n,["_query","filter"],o);const l=w(e,["queryBase"]);return n!==void 0&&l!=null&&_(n,["_url","models_url"],hV(t,l)),r}function Lte(t,e){const n={},r=w(e,["config"]);return r!=null&&_(n,["config"],Mte(t,r,n)),n}function Fte(t,e,n){const r={},s=w(e,["displayName"]);n!==void 0&&s!=null&&_(n,["displayName"],s);const i=w(e,["description"]);n!==void 0&&i!=null&&_(n,["description"],i);const o=w(e,["defaultCheckpointId"]);return n!==void 0&&o!=null&&_(n,["defaultCheckpointId"],o),r}function Ote(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],Fte(t,s,n)),n}function $te(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","name"],er(t,r));const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function Vte(t,e,n){const r={},s=w(e,["systemInstruction"]);n!==void 0&&s!=null&&_(n,["systemInstruction"],rf(t,ni(t,s)));const i=w(e,["tools"]);if(n!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>pV(t,c))),_(n,["tools"],l)}const o=w(e,["generationConfig"]);return n!==void 0&&o!=null&&_(n,["generationConfig"],o),r}function Ute(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["contents"]);if(s!=null){let o=hc(t,s);Array.isArray(o)&&(o=o.map(l=>rf(t,l))),_(n,["contents"],o)}const i=w(e,["config"]);return i!=null&&_(n,["config"],Vte(t,i,n)),n}function Bte(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["contents"]);if(s!=null){let o=hc(t,s);Array.isArray(o)&&(o=o.map(l=>rf(t,l))),_(n,["contents"],o)}const i=w(e,["config"]);return i!=null&&_(n,["config"],i),n}function zte(t,e,n){const r={},s=w(e,["numberOfVideos"]);n!==void 0&&s!=null&&_(n,["parameters","sampleCount"],s);const i=w(e,["outputGcsUri"]);n!==void 0&&i!=null&&_(n,["parameters","storageUri"],i);const o=w(e,["fps"]);n!==void 0&&o!=null&&_(n,["parameters","fps"],o);const l=w(e,["durationSeconds"]);n!==void 0&&l!=null&&_(n,["parameters","durationSeconds"],l);const c=w(e,["seed"]);n!==void 0&&c!=null&&_(n,["parameters","seed"],c);const u=w(e,["aspectRatio"]);n!==void 0&&u!=null&&_(n,["parameters","aspectRatio"],u);const d=w(e,["resolution"]);n!==void 0&&d!=null&&_(n,["parameters","resolution"],d);const h=w(e,["personGeneration"]);n!==void 0&&h!=null&&_(n,["parameters","personGeneration"],h);const f=w(e,["pubsubTopic"]);n!==void 0&&f!=null&&_(n,["parameters","pubsubTopic"],f);const m=w(e,["negativePrompt"]);n!==void 0&&m!=null&&_(n,["parameters","negativePrompt"],m);const g=w(e,["enhancePrompt"]);return n!==void 0&&g!=null&&_(n,["parameters","enhancePrompt"],g),r}function Gte(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["_url","model"],er(t,r));const s=w(e,["prompt"]);s!=null&&_(n,["instances[0]","prompt"],s);const i=w(e,["image"]);i!=null&&_(n,["instances[0]","image"],V1(t,i));const o=w(e,["config"]);return o!=null&&_(n,["config"],zte(t,o,n)),n}function Wte(t,e){const n={},r=w(e,["data"]);r!=null&&_(n,["data"],r);const s=w(e,["mimeType"]);return s!=null&&_(n,["mimeType"],s),n}function Hte(t,e){const n={},r=w(e,["thought"]);r!=null&&_(n,["thought"],r);const s=w(e,["inlineData"]);s!=null&&_(n,["inlineData"],Wte(t,s));const i=w(e,["codeExecutionResult"]);i!=null&&_(n,["codeExecutionResult"],i);const o=w(e,["executableCode"]);o!=null&&_(n,["executableCode"],o);const l=w(e,["fileData"]);l!=null&&_(n,["fileData"],l);const c=w(e,["functionCall"]);c!=null&&_(n,["functionCall"],c);const u=w(e,["functionResponse"]);u!=null&&_(n,["functionResponse"],u);const d=w(e,["text"]);return d!=null&&_(n,["text"],d),n}function qte(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Hte(t,o))),_(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&_(n,["role"],s),n}function Kte(t,e){const n={},r=w(e,["citationSources"]);return r!=null&&_(n,["citations"],r),n}function Yte(t,e){const n={},r=w(e,["content"]);r!=null&&_(n,["content"],qte(t,r));const s=w(e,["citationMetadata"]);s!=null&&_(n,["citationMetadata"],Kte(t,s));const i=w(e,["tokenCount"]);i!=null&&_(n,["tokenCount"],i);const o=w(e,["finishReason"]);o!=null&&_(n,["finishReason"],o);const l=w(e,["avgLogprobs"]);l!=null&&_(n,["avgLogprobs"],l);const c=w(e,["groundingMetadata"]);c!=null&&_(n,["groundingMetadata"],c);const u=w(e,["index"]);u!=null&&_(n,["index"],u);const d=w(e,["logprobsResult"]);d!=null&&_(n,["logprobsResult"],d);const h=w(e,["safetyRatings"]);return h!=null&&_(n,["safetyRatings"],h),n}function Nj(t,e){const n={},r=w(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>Yte(t,c))),_(n,["candidates"],l)}const s=w(e,["modelVersion"]);s!=null&&_(n,["modelVersion"],s);const i=w(e,["promptFeedback"]);i!=null&&_(n,["promptFeedback"],i);const o=w(e,["usageMetadata"]);return o!=null&&_(n,["usageMetadata"],o),n}function Jte(t,e){const n={},r=w(e,["values"]);return r!=null&&_(n,["values"],r),n}function Xte(){return{}}function Qte(t,e){const n={},r=w(e,["embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Jte(t,o))),_(n,["embeddings"],i)}return w(e,["metadata"])!=null&&_(n,["metadata"],Xte()),n}function Zte(t,e){const n={},r=w(e,["bytesBase64Encoded"]);r!=null&&_(n,["imageBytes"],mc(t,r));const s=w(e,["mimeType"]);return s!=null&&_(n,["mimeType"],s),n}function gV(t,e){const n={},r=w(e,["safetyAttributes","categories"]);r!=null&&_(n,["categories"],r);const s=w(e,["safetyAttributes","scores"]);s!=null&&_(n,["scores"],s);const i=w(e,["contentType"]);return i!=null&&_(n,["contentType"],i),n}function ene(t,e){const n={},r=w(e,["_self"]);r!=null&&_(n,["image"],Zte(t,r));const s=w(e,["raiFilteredReason"]);s!=null&&_(n,["raiFilteredReason"],s);const i=w(e,["_self"]);return i!=null&&_(n,["safetyAttributes"],gV(t,i)),n}function tne(t,e){const n={},r=w(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>ene(t,o))),_(n,["generatedImages"],i)}const s=w(e,["positivePromptSafetyAttributes"]);return s!=null&&_(n,["positivePromptSafetyAttributes"],gV(t,s)),n}function nne(t,e){const n={},r=w(e,["baseModel"]);r!=null&&_(n,["baseModel"],r);const s=w(e,["createTime"]);s!=null&&_(n,["createTime"],s);const i=w(e,["updateTime"]);return i!=null&&_(n,["updateTime"],i),n}function qE(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["name"],r);const s=w(e,["displayName"]);s!=null&&_(n,["displayName"],s);const i=w(e,["description"]);i!=null&&_(n,["description"],i);const o=w(e,["version"]);o!=null&&_(n,["version"],o);const l=w(e,["_self"]);l!=null&&_(n,["tunedModelInfo"],nne(t,l));const c=w(e,["inputTokenLimit"]);c!=null&&_(n,["inputTokenLimit"],c);const u=w(e,["outputTokenLimit"]);u!=null&&_(n,["outputTokenLimit"],u);const d=w(e,["supportedGenerationMethods"]);return d!=null&&_(n,["supportedActions"],d),n}function rne(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&_(n,["nextPageToken"],r);const s=w(e,["_self"]);if(s!=null){let i=fV(t,s);Array.isArray(i)&&(i=i.map(o=>qE(t,o))),_(n,["models"],i)}return n}function sne(){return{}}function ine(t,e){const n={},r=w(e,["totalTokens"]);r!=null&&_(n,["totalTokens"],r);const s=w(e,["cachedContentTokenCount"]);return s!=null&&_(n,["cachedContentTokenCount"],s),n}function one(t,e){const n={},r=w(e,["video","uri"]);r!=null&&_(n,["uri"],r);const s=w(e,["video","encodedVideo"]);s!=null&&_(n,["videoBytes"],mc(t,s));const i=w(e,["encoding"]);return i!=null&&_(n,["mimeType"],i),n}function ane(t,e){const n={},r=w(e,["_self"]);return r!=null&&_(n,["video"],one(t,r)),n}function lne(t,e){const n={},r=w(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>ane(t,l))),_(n,["generatedVideos"],o)}const s=w(e,["raiMediaFilteredCount"]);s!=null&&_(n,["raiMediaFilteredCount"],s);const i=w(e,["raiMediaFilteredReasons"]);return i!=null&&_(n,["raiMediaFilteredReasons"],i),n}function cne(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["name"],r);const s=w(e,["metadata"]);s!=null&&_(n,["metadata"],s);const i=w(e,["done"]);i!=null&&_(n,["done"],i);const o=w(e,["error"]);o!=null&&_(n,["error"],o);const l=w(e,["response","generateVideoResponse"]);return l!=null&&_(n,["response"],lne(t,l)),n}function une(t,e){const n={},r=w(e,["displayName"]);r!=null&&_(n,["displayName"],r);const s=w(e,["data"]);s!=null&&_(n,["data"],s);const i=w(e,["mimeType"]);return i!=null&&_(n,["mimeType"],i),n}function dne(t,e){const n={},r=w(e,["videoMetadata"]);r!=null&&_(n,["videoMetadata"],r);const s=w(e,["thought"]);s!=null&&_(n,["thought"],s);const i=w(e,["inlineData"]);i!=null&&_(n,["inlineData"],une(t,i));const o=w(e,["codeExecutionResult"]);o!=null&&_(n,["codeExecutionResult"],o);const l=w(e,["executableCode"]);l!=null&&_(n,["executableCode"],l);const c=w(e,["fileData"]);c!=null&&_(n,["fileData"],c);const u=w(e,["functionCall"]);u!=null&&_(n,["functionCall"],u);const d=w(e,["functionResponse"]);d!=null&&_(n,["functionResponse"],d);const h=w(e,["text"]);return h!=null&&_(n,["text"],h),n}function hne(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>dne(t,o))),_(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&_(n,["role"],s),n}function fne(t,e){const n={},r=w(e,["citations"]);return r!=null&&_(n,["citations"],r),n}function mne(t,e){const n={},r=w(e,["content"]);r!=null&&_(n,["content"],hne(t,r));const s=w(e,["citationMetadata"]);s!=null&&_(n,["citationMetadata"],fne(t,s));const i=w(e,["finishMessage"]);i!=null&&_(n,["finishMessage"],i);const o=w(e,["finishReason"]);o!=null&&_(n,["finishReason"],o);const l=w(e,["avgLogprobs"]);l!=null&&_(n,["avgLogprobs"],l);const c=w(e,["groundingMetadata"]);c!=null&&_(n,["groundingMetadata"],c);const u=w(e,["index"]);u!=null&&_(n,["index"],u);const d=w(e,["logprobsResult"]);d!=null&&_(n,["logprobsResult"],d);const h=w(e,["safetyRatings"]);return h!=null&&_(n,["safetyRatings"],h),n}function Pj(t,e){const n={},r=w(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>mne(t,d))),_(n,["candidates"],u)}const s=w(e,["createTime"]);s!=null&&_(n,["createTime"],s);const i=w(e,["responseId"]);i!=null&&_(n,["responseId"],i);const o=w(e,["modelVersion"]);o!=null&&_(n,["modelVersion"],o);const l=w(e,["promptFeedback"]);l!=null&&_(n,["promptFeedback"],l);const c=w(e,["usageMetadata"]);return c!=null&&_(n,["usageMetadata"],c),n}function pne(t,e){const n={},r=w(e,["truncated"]);r!=null&&_(n,["truncated"],r);const s=w(e,["token_count"]);return s!=null&&_(n,["tokenCount"],s),n}function gne(t,e){const n={},r=w(e,["values"]);r!=null&&_(n,["values"],r);const s=w(e,["statistics"]);return s!=null&&_(n,["statistics"],pne(t,s)),n}function yne(t,e){const n={},r=w(e,["billableCharacterCount"]);return r!=null&&_(n,["billableCharacterCount"],r),n}function xne(t,e){const n={},r=w(e,["predictions[]","embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>gne(t,o))),_(n,["embeddings"],i)}const s=w(e,["metadata"]);return s!=null&&_(n,["metadata"],yne(t,s)),n}function vne(t,e){const n={},r=w(e,["gcsUri"]);r!=null&&_(n,["gcsUri"],r);const s=w(e,["bytesBase64Encoded"]);s!=null&&_(n,["imageBytes"],mc(t,s));const i=w(e,["mimeType"]);return i!=null&&_(n,["mimeType"],i),n}function yV(t,e){const n={},r=w(e,["safetyAttributes","categories"]);r!=null&&_(n,["categories"],r);const s=w(e,["safetyAttributes","scores"]);s!=null&&_(n,["scores"],s);const i=w(e,["contentType"]);return i!=null&&_(n,["contentType"],i),n}function U1(t,e){const n={},r=w(e,["_self"]);r!=null&&_(n,["image"],vne(t,r));const s=w(e,["raiFilteredReason"]);s!=null&&_(n,["raiFilteredReason"],s);const i=w(e,["_self"]);i!=null&&_(n,["safetyAttributes"],yV(t,i));const o=w(e,["prompt"]);return o!=null&&_(n,["enhancedPrompt"],o),n}function wne(t,e){const n={},r=w(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>U1(t,o))),_(n,["generatedImages"],i)}const s=w(e,["positivePromptSafetyAttributes"]);return s!=null&&_(n,["positivePromptSafetyAttributes"],yV(t,s)),n}function bne(t,e){const n={},r=w(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>U1(t,i))),_(n,["generatedImages"],s)}return n}function _ne(t,e){const n={},r=w(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>U1(t,i))),_(n,["generatedImages"],s)}return n}function Sne(t,e){const n={},r=w(e,["endpoint"]);r!=null&&_(n,["name"],r);const s=w(e,["deployedModelId"]);return s!=null&&_(n,["deployedModelId"],s),n}function Ene(t,e){const n={},r=w(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&_(n,["baseModel"],r);const s=w(e,["createTime"]);s!=null&&_(n,["createTime"],s);const i=w(e,["updateTime"]);return i!=null&&_(n,["updateTime"],i),n}function Cne(t,e){const n={},r=w(e,["checkpointId"]);r!=null&&_(n,["checkpointId"],r);const s=w(e,["epoch"]);s!=null&&_(n,["epoch"],s);const i=w(e,["step"]);return i!=null&&_(n,["step"],i),n}function KE(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["name"],r);const s=w(e,["displayName"]);s!=null&&_(n,["displayName"],s);const i=w(e,["description"]);i!=null&&_(n,["description"],i);const o=w(e,["versionId"]);o!=null&&_(n,["version"],o);const l=w(e,["deployedModels"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(m=>Sne(t,m))),_(n,["endpoints"],f)}const c=w(e,["labels"]);c!=null&&_(n,["labels"],c);const u=w(e,["_self"]);u!=null&&_(n,["tunedModelInfo"],Ene(t,u));const d=w(e,["defaultCheckpointId"]);d!=null&&_(n,["defaultCheckpointId"],d);const h=w(e,["checkpoints"]);if(h!=null){let f=h;Array.isArray(f)&&(f=f.map(m=>Cne(t,m))),_(n,["checkpoints"],f)}return n}function Tne(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&_(n,["nextPageToken"],r);const s=w(e,["_self"]);if(s!=null){let i=fV(t,s);Array.isArray(i)&&(i=i.map(o=>KE(t,o))),_(n,["models"],i)}return n}function Ine(){return{}}function Nne(t,e){const n={},r=w(e,["totalTokens"]);return r!=null&&_(n,["totalTokens"],r),n}function Pne(t,e){const n={},r=w(e,["tokensInfo"]);return r!=null&&_(n,["tokensInfo"],r),n}function Ane(t,e){const n={},r=w(e,["gcsUri"]);r!=null&&_(n,["uri"],r);const s=w(e,["bytesBase64Encoded"]);s!=null&&_(n,["videoBytes"],mc(t,s));const i=w(e,["mimeType"]);return i!=null&&_(n,["mimeType"],i),n}function kne(t,e){const n={},r=w(e,["_self"]);return r!=null&&_(n,["video"],Ane(t,r)),n}function Rne(t,e){const n={},r=w(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>kne(t,l))),_(n,["generatedVideos"],o)}const s=w(e,["raiMediaFilteredCount"]);s!=null&&_(n,["raiMediaFilteredCount"],s);const i=w(e,["raiMediaFilteredReasons"]);return i!=null&&_(n,["raiMediaFilteredReasons"],i),n}function jne(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["name"],r);const s=w(e,["metadata"]);s!=null&&_(n,["metadata"],s);const i=w(e,["done"]);i!=null&&_(n,["done"],i);const o=w(e,["error"]);o!=null&&_(n,["error"],o);const l=w(e,["response"]);return l!=null&&_(n,["response"],Rne(t,l)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Dne="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Mne(t,e,n){const r=new ZQ;let s;if(n.data instanceof Blob?s=JSON.parse(await n.data.text()):s=JSON.parse(n.data),t.isVertexAI()){const i=Cee(t,s);Object.assign(r,i)}else{const i=Eee(t,s);Object.assign(r,i)}e(r)}class Lne{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r,s,i;const o=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion();let c;const u=Vne(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())c=`${o}/ws/google.cloud.aiplatform.${l}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const I=this.apiClient.getApiKey();c=`${o}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateContent?key=${I}`}let d=()=>{};const h=new Promise(I=>{d=I}),f=e.callbacks,m=function(){var I;(I=f==null?void 0:f.onopen)===null||I===void 0||I.call(f),d({})},g=this.apiClient,x={onopen:m,onmessage:I=>{Mne(g,f.onmessage,I)},onerror:(n=f==null?void 0:f.onerror)!==null&&n!==void 0?n:function(I){},onclose:(r=f==null?void 0:f.onclose)!==null&&r!==void 0?r:function(I){}},E=this.webSocketFactory.create(c,$ne(u),x);E.connect(),await h;let v=er(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&v.startsWith("publishers/")){const I=this.apiClient.getProject(),D=this.apiClient.getLocation();v=`projects/${I}/locations/${D}/`+v}let b={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Dn.AUDIO]}:e.config.responseModalities=[Dn.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const S={model:v,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?b=YZ(this.apiClient,S):b=KZ(this.apiClient,S),delete b.config,E.send(JSON.stringify(b)),new One(E,this.apiClient)}}const Fne={turnComplete:!0};class One{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=hc(e,n.turns),e.isVertexAI()?r=r.map(s=>rf(e,s)):r=r.map(s=>l0(e,s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(Dne)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},Fne),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:tee(this.apiClient,e)}:n={realtimeInput:eee(this.apiClient,e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function $ne(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function Vne(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Une=class extends eg{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>await this.generateContentInternal(n),this.generateContentStream=async n=>await this.generateContentStreamInternal(n),this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var s;let i;const o=[];if(r!=null&&r.generatedImages)for(const c of r.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((s=c==null?void 0:c.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?i=c==null?void 0:c.safetyAttributes:o.push(c);let l;return i?l={generatedImages:o,positivePromptSafetyAttributes:i}:l={generatedImages:o},l}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new a0(Ph.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const s={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(s)}}async generateContentInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Ij(this.apiClient,e);return l=Bt("{model}:generateContent",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Pj(this.apiClient,d),f=new gy;return Object.assign(f,h),f})}else{const u=Tj(this.apiClient,e);return l=Bt("{model}:generateContent",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Nj(this.apiClient,d),f=new gy;return Object.assign(f,h),f})}}async generateContentStreamInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Ij(this.apiClient,e);l=Bt("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const d=this.apiClient;return o=d.requestStream({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(h){return Nv(this,arguments,function*(){var f,m,g,x;try{for(var E=!0,v=WE(h),b;b=yield bs(v.next()),f=b.done,!f;E=!0){x=b.value,E=!1;const I=Pj(d,yield bs(x.json())),D=new gy;Object.assign(D,I),yield yield bs(D)}}catch(S){m={error:S}}finally{try{!E&&!f&&(g=v.return)&&(yield bs(g.call(v)))}finally{if(m)throw m.error}}})})}else{const u=Tj(this.apiClient,e);l=Bt("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const d=this.apiClient;return o=d.requestStream({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(h){return Nv(this,arguments,function*(){var f,m,g,x;try{for(var E=!0,v=WE(h),b;b=yield bs(v.next()),f=b.done,!f;E=!0){x=b.value,E=!1;const I=Nj(d,yield bs(x.json())),D=new gy;Object.assign(D,I),yield yield bs(D)}}catch(S){m={error:S}}finally{try{!E&&!f&&(g=v.return)&&(yield bs(g.call(v)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=_te(this.apiClient,e);return l=Bt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=xne(this.apiClient,d),f=new fj;return Object.assign(f,h),f})}else{const u=Uee(this.apiClient,e);return l=Bt("{model}:batchEmbedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Qte(this.apiClient,d),f=new fj;return Object.assign(f,h),f})}}async generateImagesInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Ete(this.apiClient,e);return l=Bt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=wne(this.apiClient,d),f=new mj;return Object.assign(f,h),f})}else{const u=zee(this.apiClient,e);return l=Bt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=tne(this.apiClient,d),f=new mj;return Object.assign(f,h),f})}}async editImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=kte(this.apiClient,e);return i=Bt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=bne(this.apiClient,c),d=new qQ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=jte(this.apiClient,e);return i=Bt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=_ne(this.apiClient,c),d=new KQ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Dte(this.apiClient,e);return l=Bt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>KE(this.apiClient,d))}else{const u=Gee(this.apiClient,e);return l=Bt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>qE(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Lte(this.apiClient,e);return l=Bt("{models_url}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Tne(this.apiClient,d),f=new pj;return Object.assign(f,h),f})}else{const u=Hee(this.apiClient,e);return l=Bt("{models_url}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=rne(this.apiClient,d),f=new pj;return Object.assign(f,h),f})}}async update(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Ote(this.apiClient,e);return l=Bt("{model}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>KE(this.apiClient,d))}else{const u=Kee(this.apiClient,e);return l=Bt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>qE(this.apiClient,d))}}async delete(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=$te(this.apiClient,e);return l=Bt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(()=>{const d=Ine(),h=new gj;return Object.assign(h,d),h})}else{const u=Yee(this.apiClient,e);return l=Bt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=sne(),h=new gj;return Object.assign(h,d),h})}}async countTokens(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Ute(this.apiClient,e);return l=Bt("{model}:countTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Nne(this.apiClient,d),f=new yj;return Object.assign(f,h),f})}else{const u=Xee(this.apiClient,e);return l=Bt("{model}:countTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=ine(this.apiClient,d),f=new yj;return Object.assign(f,h),f})}}async computeTokens(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Bte(this.apiClient,e);return i=Bt("{model}:computeTokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=Pne(this.apiClient,c),d=new YQ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Gte(this.apiClient,e);return l=Bt("{model}:predictLongRunning",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>jne(this.apiClient,d))}else{const u=ete(this.apiClient,e);return l=Bt("{model}:predictLongRunning",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>cne(this.apiClient,d))}}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bne(t,e){const n={},r=w(e,["operationName"]);r!=null&&_(n,["_url","operationName"],r);const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function zne(t,e){const n={},r=w(e,["operationName"]);r!=null&&_(n,["_url","operationName"],r);const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function Gne(t,e){const n={},r=w(e,["operationName"]);r!=null&&_(n,["operationName"],r);const s=w(e,["resourceName"]);s!=null&&_(n,["_url","resourceName"],s);const i=w(e,["config"]);return i!=null&&_(n,["config"],i),n}function Wne(t,e){const n={},r=w(e,["video","uri"]);r!=null&&_(n,["uri"],r);const s=w(e,["video","encodedVideo"]);s!=null&&_(n,["videoBytes"],mc(t,s));const i=w(e,["encoding"]);return i!=null&&_(n,["mimeType"],i),n}function Hne(t,e){const n={},r=w(e,["_self"]);return r!=null&&_(n,["video"],Wne(t,r)),n}function qne(t,e){const n={},r=w(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Hne(t,l))),_(n,["generatedVideos"],o)}const s=w(e,["raiMediaFilteredCount"]);s!=null&&_(n,["raiMediaFilteredCount"],s);const i=w(e,["raiMediaFilteredReasons"]);return i!=null&&_(n,["raiMediaFilteredReasons"],i),n}function Kne(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["name"],r);const s=w(e,["metadata"]);s!=null&&_(n,["metadata"],s);const i=w(e,["done"]);i!=null&&_(n,["done"],i);const o=w(e,["error"]);o!=null&&_(n,["error"],o);const l=w(e,["response","generateVideoResponse"]);return l!=null&&_(n,["response"],qne(t,l)),n}function Yne(t,e){const n={},r=w(e,["gcsUri"]);r!=null&&_(n,["uri"],r);const s=w(e,["bytesBase64Encoded"]);s!=null&&_(n,["videoBytes"],mc(t,s));const i=w(e,["mimeType"]);return i!=null&&_(n,["mimeType"],i),n}function Jne(t,e){const n={},r=w(e,["_self"]);return r!=null&&_(n,["video"],Yne(t,r)),n}function Xne(t,e){const n={},r=w(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Jne(t,l))),_(n,["generatedVideos"],o)}const s=w(e,["raiMediaFilteredCount"]);s!=null&&_(n,["raiMediaFilteredCount"],s);const i=w(e,["raiMediaFilteredReasons"]);return i!=null&&_(n,["raiMediaFilteredReasons"],i),n}function Aj(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["name"],r);const s=w(e,["metadata"]);s!=null&&_(n,["metadata"],s);const i=w(e,["done"]);i!=null&&_(n,["done"],i);const o=w(e,["error"]);o!=null&&_(n,["error"],o);const l=w(e,["response"]);return l!=null&&_(n,["response"],Xne(t,l)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qne extends eg{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let i;return r&&"httpOptions"in r&&(i=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=zne(this.apiClient,e);return l=Bt("{operationName}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>Aj(this.apiClient,d))}else{const u=Bne(this.apiClient,e);return l=Bt("{operationName}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Kne(this.apiClient,d))}}async fetchPredictVideosOperationInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Gne(this.apiClient,e);return i=Bt("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>Aj(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Zne="Content-Type",ere="X-Server-Timeout",tre="User-Agent",nre="x-goog-api-client",rre="0.14.1",sre=`google-genai-sdk/${rre}`,ire="v1beta1",ore="v1beta",kj=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class xV extends Error{constructor(e,n){n?super(e,{cause:n}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class YE extends Error{constructor(e,n){n?super(e,{cause:n}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class are{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:ire,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:ore,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const s=[this.getRequestUrlInternal(n)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))s.searchParams.append(o,String(l));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.unaryApiCall(s,i,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[s,i]of Object.entries(n))typeof i=="object"?r[s]=Object.assign(Object.assign({},r[s]),i):i!==void 0&&(r[s]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.streamApiCall(s,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const s=new AbortController,i=s.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>s.abort(),n.timeout),r&&r.addEventListener("abort",()=>{s.abort()}),e.signal=i}return e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await Rj(s),new GE(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await Rj(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var n;return Nv(this,arguments,function*(){const s=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),i=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:c}=yield bs(s.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=i.decode(c);try{const h=JSON.parse(u);if("error"in h){const f=JSON.parse(JSON.stringify(h.error)),m=f.status,g=f.code,x=`got status: ${m}. ${JSON.stringify(h)}`;if(g>=400&&g<500)throw new xV(x);if(g>=500&&g<600)throw new YE(x)}}catch(h){const f=h;if(f.name==="ClientError"||f.name==="ServerError")throw h}o+=u;let d=o.match(kj);for(;d;){const h=d[1];try{const f=new Response(h,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield bs(new GE(f)),o=o.slice(d[0].length),d=o.match(kj)}catch(f){throw new Error(`exception parsing stream chunk ${h}. ${f}`)}}}}finally{s.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=sre+" "+this.clientOptions.userAgentExtra;return e[tre]=n,e[nre]=n,e[Zne]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,s]of Object.entries(e.headers))n.append(r,s);e.timeout&&e.timeout>0&&n.append(ere,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const i=this.clientOptions.uploader,o=await i.stat(e);s.sizeBytes=String(o.size);const l=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;const c=await this.fetchUploadUrl(s,n);return i.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let s={};n!=null&&n.httpOptions?s=n.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const i={file:e},o=await this.request({path:Bt("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:s});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function Rj(t){var e;if(t===void 0)throw new YE("response is undefined");if(!t.ok){const n=t.status,r=t.statusText;let s;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await t.json():s={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=`got status: ${n} ${r}. ${JSON.stringify(s)}`;throw n>=400&&n<500?new xV(i):n>=500&&n<600?new YE(i):new Error(i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lre(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["_url","name"],r);const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function cre(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&_(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);n!==void 0&&i!=null&&_(n,["_query","pageToken"],i);const o=w(e,["filter"]);return n!==void 0&&o!=null&&_(n,["_query","filter"],o),r}function ure(t,e){const n={},r=w(e,["config"]);return r!=null&&_(n,["config"],cre(t,r,n)),n}function dre(t,e){const n={},r=w(e,["textInput"]);r!=null&&_(n,["textInput"],r);const s=w(e,["output"]);return s!=null&&_(n,["output"],s),n}function hre(t,e){const n={};if(w(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=w(e,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>dre(t,i))),_(n,["examples","examples"],s)}return n}function fre(t,e,n){const r={};if(w(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=w(e,["tunedModelDisplayName"]);if(n!==void 0&&s!=null&&_(n,["displayName"],s),w(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=w(e,["epochCount"]);n!==void 0&&i!=null&&_(n,["tuningTask","hyperparameters","epochCount"],i);const o=w(e,["learningRateMultiplier"]);if(o!=null&&_(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),w(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(w(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=w(e,["batchSize"]);n!==void 0&&l!=null&&_(n,["tuningTask","hyperparameters","batchSize"],l);const c=w(e,["learningRate"]);return n!==void 0&&c!=null&&_(n,["tuningTask","hyperparameters","learningRate"],c),r}function mre(t,e){const n={},r=w(e,["baseModel"]);r!=null&&_(n,["baseModel"],r);const s=w(e,["trainingDataset"]);s!=null&&_(n,["tuningTask","trainingData"],hre(t,s));const i=w(e,["config"]);return i!=null&&_(n,["config"],fre(t,i,n)),n}function pre(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["_url","name"],r);const s=w(e,["config"]);return s!=null&&_(n,["config"],s),n}function gre(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&_(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);n!==void 0&&i!=null&&_(n,["_query","pageToken"],i);const o=w(e,["filter"]);return n!==void 0&&o!=null&&_(n,["_query","filter"],o),r}function yre(t,e){const n={},r=w(e,["config"]);return r!=null&&_(n,["config"],gre(t,r,n)),n}function xre(t,e,n){const r={},s=w(e,["gcsUri"]);if(n!==void 0&&s!=null&&_(n,["supervisedTuningSpec","trainingDatasetUri"],s),w(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function vre(t,e){const n={},r=w(e,["gcsUri"]);return r!=null&&_(n,["validationDatasetUri"],r),n}function wre(t,e,n){const r={},s=w(e,["validationDataset"]);n!==void 0&&s!=null&&_(n,["supervisedTuningSpec"],vre(t,s));const i=w(e,["tunedModelDisplayName"]);n!==void 0&&i!=null&&_(n,["tunedModelDisplayName"],i);const o=w(e,["description"]);n!==void 0&&o!=null&&_(n,["description"],o);const l=w(e,["epochCount"]);n!==void 0&&l!=null&&_(n,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=w(e,["learningRateMultiplier"]);n!==void 0&&c!=null&&_(n,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const u=w(e,["exportLastCheckpointOnly"]);n!==void 0&&u!=null&&_(n,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const d=w(e,["adapterSize"]);if(n!==void 0&&d!=null&&_(n,["supervisedTuningSpec","hyperParameters","adapterSize"],d),w(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(w(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function bre(t,e){const n={},r=w(e,["baseModel"]);r!=null&&_(n,["baseModel"],r);const s=w(e,["trainingDataset"]);s!=null&&_(n,["supervisedTuningSpec","trainingDatasetUri"],xre(t,s,n));const i=w(e,["config"]);return i!=null&&_(n,["config"],wre(t,i,n)),n}function _re(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["model"],r);const s=w(e,["name"]);return s!=null&&_(n,["endpoint"],s),n}function vV(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["name"],r);const s=w(e,["state"]);s!=null&&_(n,["state"],uV(t,s));const i=w(e,["createTime"]);i!=null&&_(n,["createTime"],i);const o=w(e,["tuningTask","startTime"]);o!=null&&_(n,["startTime"],o);const l=w(e,["tuningTask","completeTime"]);l!=null&&_(n,["endTime"],l);const c=w(e,["updateTime"]);c!=null&&_(n,["updateTime"],c);const u=w(e,["description"]);u!=null&&_(n,["description"],u);const d=w(e,["baseModel"]);d!=null&&_(n,["baseModel"],d);const h=w(e,["_self"]);h!=null&&_(n,["tunedModel"],_re(t,h));const f=w(e,["distillationSpec"]);f!=null&&_(n,["distillationSpec"],f);const m=w(e,["experiment"]);m!=null&&_(n,["experiment"],m);const g=w(e,["labels"]);g!=null&&_(n,["labels"],g);const x=w(e,["pipelineJob"]);x!=null&&_(n,["pipelineJob"],x);const E=w(e,["tunedModelDisplayName"]);return E!=null&&_(n,["tunedModelDisplayName"],E),n}function Sre(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&_(n,["nextPageToken"],r);const s=w(e,["tunedModels"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>vV(t,o))),_(n,["tuningJobs"],i)}return n}function Ere(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["name"],r);const s=w(e,["metadata"]);s!=null&&_(n,["metadata"],s);const i=w(e,["done"]);i!=null&&_(n,["done"],i);const o=w(e,["error"]);return o!=null&&_(n,["error"],o),n}function Cre(t,e){const n={},r=w(e,["checkpointId"]);r!=null&&_(n,["checkpointId"],r);const s=w(e,["epoch"]);s!=null&&_(n,["epoch"],s);const i=w(e,["step"]);i!=null&&_(n,["step"],i);const o=w(e,["endpoint"]);return o!=null&&_(n,["endpoint"],o),n}function Tre(t,e){const n={},r=w(e,["model"]);r!=null&&_(n,["model"],r);const s=w(e,["endpoint"]);s!=null&&_(n,["endpoint"],s);const i=w(e,["checkpoints"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>Cre(t,l))),_(n,["checkpoints"],o)}return n}function JE(t,e){const n={},r=w(e,["name"]);r!=null&&_(n,["name"],r);const s=w(e,["state"]);s!=null&&_(n,["state"],uV(t,s));const i=w(e,["createTime"]);i!=null&&_(n,["createTime"],i);const o=w(e,["startTime"]);o!=null&&_(n,["startTime"],o);const l=w(e,["endTime"]);l!=null&&_(n,["endTime"],l);const c=w(e,["updateTime"]);c!=null&&_(n,["updateTime"],c);const u=w(e,["error"]);u!=null&&_(n,["error"],u);const d=w(e,["description"]);d!=null&&_(n,["description"],d);const h=w(e,["baseModel"]);h!=null&&_(n,["baseModel"],h);const f=w(e,["tunedModel"]);f!=null&&_(n,["tunedModel"],Tre(t,f));const m=w(e,["supervisedTuningSpec"]);m!=null&&_(n,["supervisedTuningSpec"],m);const g=w(e,["tuningDataStats"]);g!=null&&_(n,["tuningDataStats"],g);const x=w(e,["encryptionSpec"]);x!=null&&_(n,["encryptionSpec"],x);const E=w(e,["partnerModelTuningSpec"]);E!=null&&_(n,["partnerModelTuningSpec"],E);const v=w(e,["distillationSpec"]);v!=null&&_(n,["distillationSpec"],v);const b=w(e,["experiment"]);b!=null&&_(n,["experiment"],b);const S=w(e,["labels"]);S!=null&&_(n,["labels"],S);const I=w(e,["pipelineJob"]);I!=null&&_(n,["pipelineJob"],I);const D=w(e,["tunedModelDisplayName"]);return D!=null&&_(n,["tunedModelDisplayName"],D),n}function Ire(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&_(n,["nextPageToken"],r);const s=w(e,["tuningJobs"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>JE(t,o))),_(n,["tuningJobs"],i)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Nre extends eg{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new a0(Ph.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let s="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?s=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(s=r.name.split("/operations/")[0]),{name:s,state:zE.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=pre(this.apiClient,e);return l=Bt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>JE(this.apiClient,d))}else{const u=lre(this.apiClient,e);return l=Bt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>vV(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=yre(this.apiClient,e);return l=Bt("tuningJobs",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Ire(this.apiClient,d),f=new xj;return Object.assign(f,h),f})}else{const u=ure(this.apiClient,e);return l=Bt("tunedModels",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Sre(this.apiClient,d),f=new xj;return Object.assign(f,h),f})}}async tuneInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=bre(this.apiClient,e);return i=Bt("tuningJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>JE(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=mre(this.apiClient,e);return i=Bt("tunedModels",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>Ere(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Pre{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Are=1024*1024*8,kre=3,Rre=1e3,jre=2,__="x-goog-upload-status";async function Dre(t,e,n){var r,s,i;let o=0,l=0,c=new GE(new Response),u="upload";for(o=t.size;l<o;){const h=Math.min(Are,o-l),f=t.slice(l,l+h);l+h>=o&&(u+=", finalize");let m=0,g=Rre;for(;m<kre&&(c=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(l),"Content-Length":String(h)}}}),!(!((r=c==null?void 0:c.headers)===null||r===void 0)&&r[__]));)m++,await Lre(g),g=g*jre;if(l+=h,((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s[__])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const d=await(c==null?void 0:c.json());if(((i=c==null?void 0:c.headers)===null||i===void 0?void 0:i[__])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return d.file}async function Mre(t){return{size:t.size,type:t.type}}function Lre(t){return new Promise(e=>setTimeout(e,t))}class Fre{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Dre(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Mre(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ore{create(e,n,r){return new $re(e,n,r)}}class $re{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jj="x-goog-api-key";class Vre{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(jj)===null&&e.append(jj,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ure="gl-node/";class hr{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=XX(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const s=new Vre(this.apiKey);this.apiClient=new are({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:Ure+"web",uploader:new Fre,downloader:new Pre}),this.models=new Une(this.apiClient),this.live=new Lne(this.apiClient,s,new Ore),this.chats=new sZ(this.models,this.apiClient),this.caches=new eZ(this.apiClient),this.files=new yZ(this.apiClient),this.operations=new Qne(this.apiClient),this.tunings=new Nre(this.apiClient)}}function Et(...t){return BX(Q$(t))}function tn(){return qX()}const Bre="CEVWpXluVU77FgaVriTzqBCoN4FD3f0VL2Y8bXNPynNfqUg2DoUgPt8t";console.log("[utils.jsx] VITE_PEXELS_API_KEY loaded:","Exists");const wV=Bre,zre="https://api.pexels.com/v1",Gre="AIzaSyA6fvf0Xgb29MloJ-JKiYJGzhv_jvPdL1Y";console.log("[utils.jsx] VITE_GEMINI_API_KEY loaded:","Exists");const Wre=Gre,Hre="your-shop-name.myshopify.com",Xl=async(t,e=1,n="landscape")=>{const r=`${zre}/search?query=${encodeURIComponent(t)}&per_page=${e}&orientation=${n}`;try{const s=await fetch(r,{headers:{Authorization:wV}});if(!s.ok){const o=await s.json();throw console.error("Pexels API error:",o),new Error(`Pexels API request failed: ${s.statusText}`)}const i=await s.json();if(!i.photos||i.photos.length===0){console.warn(`No Pexels images found for query: "${t}". Attempting fallback.`);const o=(l,c,u)=>`https://via.placeholder.com/${l}x${c}.png?text=NoImage:${encodeURIComponent(u)}`;return Array(e).fill(null).map((l,c)=>({id:tn(),src:{large:o(1200,800,`${t} ${c+1}`),medium:o(800,600,`${t} ${c+1}`),original:o(1920,1280,`${t} ${c+1}`),square:o(400,400,`${t} ${c+1}`),landscape:o(1200,800,`${t} ${c+1}`),portrait:o(800,1200,`${t} ${c+1}`),small:o(400,260,`${t} ${c+1}`),tiny:o(200,130,`${t} ${c+1}`)},photographer:"N/A",alt:`No image found for ${t} ${c+1}`}))}return i.photos.map(o=>({id:o.id,src:o.src,photographer:o.photographer,alt:o.alt||`Photo by ${o.photographer} of ${t}`}))}catch(s){console.error("Error fetching Pexels images:",s);const i=(o,l,c)=>`https://via.placeholder.com/${o}x${l}.png?text=${encodeURIComponent(c)}`;return Array(e).fill(null).map((o,l)=>({id:tn(),src:{large:i(1200,800,`Error ${t} ${l+1}`),medium:i(800,600,`Error ${t} ${l+1}`),original:i(1920,1280,`Error ${t} ${l+1}`),square:i(400,400,`Error ${t} ${l+1}`),landscape:i(1200,800,`Error ${t} ${l+1}`),portrait:i(800,1200,`Error ${t} ${l+1}`),small:i(400,260,`Error ${t} ${l+1}`),tiny:i(200,130,`Error ${t} ${l+1}`)},photographer:"Placeholder Error",alt:`Placeholder Error for ${t} ${l+1}`}))}},Gc=async(t,e=1,n="landscape")=>{const r=`https://api.pexels.com/videos/search?query=${encodeURIComponent(t)}&per_page=${e}&orientation=${n}`;try{const s=await fetch(r,{headers:{Authorization:wV}});if(!s.ok){const o=await s.json();throw console.error("Pexels Videos API error:",o),new Error(`Pexels Videos API request failed: ${s.statusText}`)}const i=await s.json();return!i.videos||i.videos.length===0?(console.warn(`No Pexels videos found for query: "${t}".`),Array(e).fill(null).map((o,l)=>({id:tn(),url:`https://videos.pexels.com/videos/no-video-${l+1}.mp4`,image:`https://via.placeholder.com/1280x720.png?text=No+Video+Found+${encodeURIComponent(t)}`,alt:`No video found for ${t} ${l+1}`}))):i.videos.map(o=>{var c,u;const l=o.video_files.find(d=>d.quality==="hd"&&d.file_type==="video/mp4")||o.video_files.find(d=>d.file_type==="video/mp4")||o.video_files[0];return{id:o.id,url:l?l.link:null,image:((c=o.video_pictures[0])==null?void 0:c.picture)||`https://via.placeholder.com/1280x720.png?text=${encodeURIComponent(o.url||t)}`,duration:o.duration,user:o.user,alt:`Video of ${t} by ${((u=o.user)==null?void 0:u.name)||"Pexels Contributor"}`}})}catch(s){return console.error("Error fetching Pexels videos:",s),Array(e).fill(null).map((i,o)=>({id:tn(),url:`https://videos.pexels.com/videos/error-video-${o+1}.mp4`,image:`https://via.placeholder.com/1280x720.png?text=Video+Error+${encodeURIComponent(t)}`,alt:`Error fetching video for ${t} ${o+1}`}))}},B1=async t=>{try{const e=new hr({apiKey:Wre}),n=[{category:xr.HARM_CATEGORY_HARASSMENT,threshold:vr.BLOCK_MEDIUM_AND_ABOVE},{category:xr.HARM_CATEGORY_HATE_SPEECH,threshold:vr.BLOCK_MEDIUM_AND_ABOVE},{category:xr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:vr.BLOCK_MEDIUM_AND_ABOVE},{category:xr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:vr.BLOCK_MEDIUM_AND_ABOVE}];console.log(`[utils.jsx/generateImageWithGemini] Calling Gemini with prompt: "${t}"`);const r=await e.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:[{text:t}],safetySettings:n,config:{responseModalities:[Dn.TEXT,Dn.IMAGE]}});let s=null,i="image/png";if(r.candidates&&r.candidates.length>0&&r.candidates[0].content&&r.candidates[0].content.parts){for(const o of r.candidates[0].content.parts)if(o.inlineData&&o.inlineData.data){s=o.inlineData.data,i=o.inlineData.mimeType||"image/png",console.log(`[utils.jsx/generateImageWithGemini] Image generated. MimeType: ${i}`);break}}if(s)return{url:`data:${i};base64,${s}`,alt:`AI Generated Image for: ${t}`};throw new Error("No image data found in Gemini response.")}catch(e){return console.error("[utils.jsx/generateImageWithGemini] Error generating image with Gemini:",e),{url:`https://via.placeholder.com/512x512.png?text=Error:${encodeURIComponent(t.substring(0,20))}`,alt:`Error generating image for: ${t}`}}},qre=(t,e)=>{const n={fashion:[`Elevate your style with our ${e}. Crafted for comfort and a modern look.`,`The ${e} is a must-have for any fashion-forward wardrobe. Versatile and chic.`,`Discover the perfect blend of quality and design in our ${e}. Ideal for any occasion.`],electronics:[`Experience next-level technology with the ${e}. Packed with features for modern life.`,`The ${e} offers superior performance and sleek design. Upgrade your tech today.`,`Unleash innovation with the ${e}. Reliable, powerful, and built to last.`],food:[`Savor the rich flavors of our ${e}. Made with the freshest, high-quality ingredients.`,`Our ${e} is a delicious treat for any time of day. Wholesome and satisfying.`,`Indulge in the authentic taste of ${e}. Perfect for sharing or enjoying solo.`],jewelry:[`Adorn yourself with the exquisite ${e}. A timeless piece that radiates elegance.`,`The ${e} is a symbol of sophistication and luxury. Crafted with precision.`,`Make a statement with our stunning ${e}. Perfect for special moments.`],general:[`Discover the quality and utility of the ${e}. A great addition to your collection.`,`The ${e} is designed for excellence and everyday use. You'll love it.`,`Enhance your life with the versatile ${e}. Built for performance and style.`]},r=n[t]||n.general;return r[Math.floor(Math.random()*r.length)]},z1=(t,e)=>{const n={fashion:`Step Into Style at ${e}`,electronics:`${e}: Your Tech Universe`,food:`Taste the Difference with ${e}`,jewelry:`Shine Bright with ${e}`,general:`Welcome to ${e} - Quality Finds!`},r={fashion:`Explore the latest trends and timeless classics. ${e} offers curated fashion for every individual. Express yourself with our unique collection.`,electronics:`Discover cutting-edge gadgets and essential electronics at ${e}. We bring you innovation, performance, and value, all in one place.`,food:`From farm-fresh produce to gourmet delights, ${e} is your source for delicious and wholesome food. Quality ingredients for a healthier life.`,jewelry:`Find exquisite pieces that tell your story. ${e} presents a stunning collection of fine jewelry, perfect for gifting or treating yourself.`,general:`Your one-stop shop for amazing products. ${e} offers a diverse range of quality items to meet your everyday needs and special desires.`},s=["Fast Worldwide Shipping","Secure Online Payments","24/7 Customer Support","Easy Returns & Exchanges"],i=["Get your orders delivered quickly and reliably, no matter where you are.","Shop with confidence using our encrypted and secure payment gateways.","Our dedicated team is here to help you around the clock with any queries.","Not satisfied? We offer a hassle-free return and exchange policy."],o=`Join the ${e} Family`,l="Sign up for our newsletter to receive exclusive offers, new product alerts, and style tips directly to your inbox. Don't miss out!";return{heroTitle:n[t]||n.general,heroDescription:r[t]||r.general,featureTitles:s,featureDescriptions:i,newsletterHeading:o,newsletterText:l}};function _t(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function Dj(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function c0(...t){return e=>{let n=!1;const r=t.map(s=>{const i=Dj(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():Dj(t[s],null)}}}}function Cn(...t){return p.useCallback(c0(...t),t)}function Kre(t,e){const n=p.createContext(e),r=i=>{const{children:o,...l}=i,c=p.useMemo(()=>l,Object.values(l));return a.jsx(n.Provider,{value:c,children:o})};r.displayName=t+"Provider";function s(i){const o=p.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,s]}function Li(t,e=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];const u=h=>{var v;const{scope:f,children:m,...g}=h,x=((v=f==null?void 0:f[t])==null?void 0:v[c])||l,E=p.useMemo(()=>g,Object.values(g));return a.jsx(x.Provider,{value:E,children:m})};u.displayName=i+"Provider";function d(h,f){var x;const m=((x=f==null?void 0:f[t])==null?void 0:x[c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return p.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,Yre(s,...e)]}function Yre(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function Ah(t){const e=Xre(t),n=p.forwardRef((r,s)=>{const{children:i,...o}=r,l=p.Children.toArray(i),c=l.find(Zre);if(c){const u=c.props.children,d=l.map(h=>h===c?p.Children.count(u)>1?p.Children.only(null):p.isValidElement(u)?u.props.children:null:h);return a.jsx(e,{...o,ref:s,children:p.isValidElement(u)?p.cloneElement(u,void 0,d):null})}return a.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}var Jre=Ah("Slot");function Xre(t){const e=p.forwardRef((n,r)=>{const{children:s,...i}=n;if(p.isValidElement(s)){const o=tse(s),l=ese(i,s.props);return s.type!==p.Fragment&&(l.ref=r?c0(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var bV=Symbol("radix.slottable");function Qre(t){const e=({children:n})=>a.jsx(a.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=bV,e}function Zre(t){return p.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===bV}function ese(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function tse(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function G1(t){const e=t+"CollectionProvider",[n,r]=Li(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=x=>{const{scope:E,children:v}=x,b=ht.useRef(null),S=ht.useRef(new Map).current;return a.jsx(s,{scope:E,itemMap:S,collectionRef:b,children:v})};o.displayName=e;const l=t+"CollectionSlot",c=Ah(l),u=ht.forwardRef((x,E)=>{const{scope:v,children:b}=x,S=i(l,v),I=Cn(E,S.collectionRef);return a.jsx(c,{ref:I,children:b})});u.displayName=l;const d=t+"CollectionItemSlot",h="data-radix-collection-item",f=Ah(d),m=ht.forwardRef((x,E)=>{const{scope:v,children:b,...S}=x,I=ht.useRef(null),D=Cn(E,I),k=i(d,v);return ht.useEffect(()=>(k.itemMap.set(I,{ref:I,...S}),()=>void k.itemMap.delete(I))),a.jsx(f,{[h]:"",ref:D,children:b})});m.displayName=d;function g(x){const E=i(t+"CollectionConsumer",x);return ht.useCallback(()=>{const b=E.collectionRef.current;if(!b)return[];const S=Array.from(b.querySelectorAll(`[${h}]`));return Array.from(E.itemMap.values()).sort((k,C)=>S.indexOf(k.ref.current)-S.indexOf(C.ref.current))},[E.collectionRef,E.itemMap])}return[{Provider:o,Slot:u,ItemSlot:m},g,r]}var nse=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Yt=nse.reduce((t,e)=>{const n=Ah(`Primitive.${e}`),r=p.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function W1(t,e){t&&Wa.flushSync(()=>t.dispatchEvent(e))}function Rr(t){const e=p.useRef(t);return p.useEffect(()=>{e.current=t}),p.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function rse(t,e=globalThis==null?void 0:globalThis.document){const n=Rr(t);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var sse="DismissableLayer",XE="dismissableLayer.update",ise="dismissableLayer.pointerDownOutside",ose="dismissableLayer.focusOutside",Mj,_V=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),u0=p.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=t,u=p.useContext(_V),[d,h]=p.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=p.useState({}),g=Cn(e,C=>h(C)),x=Array.from(u.layers),[E]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),v=x.indexOf(E),b=d?x.indexOf(d):-1,S=u.layersWithOutsidePointerEventsDisabled.size>0,I=b>=v,D=lse(C=>{const T=C.target,P=[...u.branches].some(A=>A.contains(T));!I||P||(s==null||s(C),o==null||o(C),C.defaultPrevented||l==null||l())},f),k=cse(C=>{const T=C.target;[...u.branches].some(A=>A.contains(T))||(i==null||i(C),o==null||o(C),C.defaultPrevented||l==null||l())},f);return rse(C=>{b===u.layers.size-1&&(r==null||r(C),!C.defaultPrevented&&l&&(C.preventDefault(),l()))},f),p.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Mj=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),Lj(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=Mj)}},[d,f,n,u]),p.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),Lj())},[d,u]),p.useEffect(()=>{const C=()=>m({});return document.addEventListener(XE,C),()=>document.removeEventListener(XE,C)},[]),a.jsx(Yt.div,{...c,ref:g,style:{pointerEvents:S?I?"auto":"none":void 0,...t.style},onFocusCapture:_t(t.onFocusCapture,k.onFocusCapture),onBlurCapture:_t(t.onBlurCapture,k.onBlurCapture),onPointerDownCapture:_t(t.onPointerDownCapture,D.onPointerDownCapture)})});u0.displayName=sse;var ase="DismissableLayerBranch",SV=p.forwardRef((t,e)=>{const n=p.useContext(_V),r=p.useRef(null),s=Cn(e,r);return p.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),a.jsx(Yt.div,{...t,ref:s})});SV.displayName=ase;function lse(t,e=globalThis==null?void 0:globalThis.document){const n=Rr(t),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let c=function(){EV(ise,n,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=c,e.addEventListener("click",s.current,{once:!0})):c()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function cse(t,e=globalThis==null?void 0:globalThis.document){const n=Rr(t),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&EV(ose,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Lj(){const t=new CustomEvent(XE);document.dispatchEvent(t)}function EV(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?W1(s,i):s.dispatchEvent(i)}var use=u0,dse=SV,ta=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},hse="Portal",d0=p.forwardRef((t,e)=>{var l;const{container:n,...r}=t,[s,i]=p.useState(!1);ta(()=>i(!0),[]);const o=n||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?D1.createPortal(a.jsx(Yt.div,{...r,ref:e}),o):null});d0.displayName=hse;function fse(t,e){return p.useReducer((n,r)=>e[n][r]??n,t)}var qs=t=>{const{present:e,children:n}=t,r=mse(e),s=typeof n=="function"?n({present:r.isPresent}):p.Children.only(n),i=Cn(r.ref,pse(s));return typeof n=="function"||r.isPresent?p.cloneElement(s,{ref:i}):null};qs.displayName="Presence";function mse(t){const[e,n]=p.useState(),r=p.useRef(null),s=p.useRef(t),i=p.useRef("none"),o=t?"mounted":"unmounted",[l,c]=fse(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const u=vy(r.current);i.current=l==="mounted"?u:"none"},[l]),ta(()=>{const u=r.current,d=s.current;if(d!==t){const f=i.current,m=vy(u);t?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),ta(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=m=>{const x=vy(r.current).includes(m.animationName);if(m.target===e&&x&&(c("ANIMATION_END"),!s.current)){const E=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=E)})}},f=m=>{m.target===e&&(i.current=vy(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(u=>{r.current=u?getComputedStyle(u):null,n(u)},[])}}function vy(t){return(t==null?void 0:t.animationName)||"none"}function pse(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var gse=Ow[" useInsertionEffect ".trim().toString()]||ta;function Bu({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[s,i,o]=yse({defaultProp:e,onChange:n}),l=t!==void 0,c=l?t:s;{const d=p.useRef(t!==void 0);p.useEffect(()=>{const h=d.current;h!==l&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,r])}const u=p.useCallback(d=>{var h;if(l){const f=xse(d)?d(t):d;f!==t&&((h=o.current)==null||h.call(o,f))}else i(d)},[l,t,i,o]);return[c,u]}function yse({defaultProp:t,onChange:e}){const[n,r]=p.useState(t),s=p.useRef(n),i=p.useRef(e);return gse(()=>{i.current=e},[e]),p.useEffect(()=>{var o;s.current!==n&&((o=i.current)==null||o.call(i,n),s.current=n)},[n,s]),[n,r,i]}function xse(t){return typeof t=="function"}var vse=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),wse="VisuallyHidden",H1=p.forwardRef((t,e)=>a.jsx(Yt.span,{...t,ref:e,style:{...vse,...t.style}}));H1.displayName=wse;var q1="ToastProvider",[K1,bse,_se]=G1("Toast"),[CV,kRe]=Li("Toast",[_se]),[Sse,h0]=CV(q1),TV=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=t,[l,c]=p.useState(null),[u,d]=p.useState(0),h=p.useRef(!1),f=p.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${q1}\`. Expected non-empty \`string\`.`),a.jsx(K1.Provider,{scope:e,children:a.jsx(Sse,{scope:e,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>d(m=>m+1),[]),onToastRemove:p.useCallback(()=>d(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};TV.displayName=q1;var IV="ToastViewport",Ese=["F8"],QE="toast.viewportPause",ZE="toast.viewportResume",NV=p.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=Ese,label:s="Notifications ({hotkey})",...i}=t,o=h0(IV,n),l=bse(n),c=p.useRef(null),u=p.useRef(null),d=p.useRef(null),h=p.useRef(null),f=Cn(e,h,o.onViewportChange),m=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=o.toastCount>0;p.useEffect(()=>{const E=v=>{var S;r.length!==0&&r.every(I=>v[I]||v.code===I)&&((S=h.current)==null||S.focus())};return document.addEventListener("keydown",E),()=>document.removeEventListener("keydown",E)},[r]),p.useEffect(()=>{const E=c.current,v=h.current;if(g&&E&&v){const b=()=>{if(!o.isClosePausedRef.current){const k=new CustomEvent(QE);v.dispatchEvent(k),o.isClosePausedRef.current=!0}},S=()=>{if(o.isClosePausedRef.current){const k=new CustomEvent(ZE);v.dispatchEvent(k),o.isClosePausedRef.current=!1}},I=k=>{!E.contains(k.relatedTarget)&&S()},D=()=>{E.contains(document.activeElement)||S()};return E.addEventListener("focusin",b),E.addEventListener("focusout",I),E.addEventListener("pointermove",b),E.addEventListener("pointerleave",D),window.addEventListener("blur",b),window.addEventListener("focus",S),()=>{E.removeEventListener("focusin",b),E.removeEventListener("focusout",I),E.removeEventListener("pointermove",b),E.removeEventListener("pointerleave",D),window.removeEventListener("blur",b),window.removeEventListener("focus",S)}}},[g,o.isClosePausedRef]);const x=p.useCallback(({tabbingDirection:E})=>{const b=l().map(S=>{const I=S.ref.current,D=[I,...Fse(I)];return E==="forwards"?D:D.reverse()});return(E==="forwards"?b.reverse():b).flat()},[l]);return p.useEffect(()=>{const E=h.current;if(E){const v=b=>{var D,k,C;const S=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!S){const T=document.activeElement,P=b.shiftKey;if(b.target===E&&P){(D=u.current)==null||D.focus();return}const M=x({tabbingDirection:P?"backwards":"forwards"}),j=M.findIndex(z=>z===T);S_(M.slice(j+1))?b.preventDefault():P?(k=u.current)==null||k.focus():(C=d.current)==null||C.focus()}};return E.addEventListener("keydown",v),()=>E.removeEventListener("keydown",v)}},[l,x]),a.jsxs(dse,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&a.jsx(eC,{ref:u,onFocusFromOutsideViewport:()=>{const E=x({tabbingDirection:"forwards"});S_(E)}}),a.jsx(K1.Slot,{scope:n,children:a.jsx(Yt.ol,{tabIndex:-1,...i,ref:f})}),g&&a.jsx(eC,{ref:d,onFocusFromOutsideViewport:()=>{const E=x({tabbingDirection:"backwards"});S_(E)}})]})});NV.displayName=IV;var PV="ToastFocusProxy",eC=p.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=h0(PV,n);return a.jsx(H1,{"aria-hidden":!0,tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(l))&&r()}})});eC.displayName=PV;var tg="Toast",Cse="toast.swipeStart",Tse="toast.swipeMove",Ise="toast.swipeCancel",Nse="toast.swipeEnd",AV=p.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=t,[l,c]=Bu({prop:r,defaultProp:s??!0,onChange:i,caller:tg});return a.jsx(qs,{present:n||l,children:a.jsx(kse,{open:l,...o,ref:e,onClose:()=>c(!1),onPause:Rr(t.onPause),onResume:Rr(t.onResume),onSwipeStart:_t(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:_t(t.onSwipeMove,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:_t(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:_t(t.onSwipeEnd,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})})});AV.displayName=tg;var[Pse,Ase]=CV(tg,{onClose(){}}),kse=p.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:m,...g}=t,x=h0(tg,n),[E,v]=p.useState(null),b=Cn(e,z=>v(z)),S=p.useRef(null),I=p.useRef(null),D=s||x.duration,k=p.useRef(0),C=p.useRef(D),T=p.useRef(0),{onToastAdd:P,onToastRemove:A}=x,R=Rr(()=>{var W;(E==null?void 0:E.contains(document.activeElement))&&((W=x.viewport)==null||W.focus()),o()}),M=p.useCallback(z=>{!z||z===1/0||(window.clearTimeout(T.current),k.current=new Date().getTime(),T.current=window.setTimeout(R,z))},[R]);p.useEffect(()=>{const z=x.viewport;if(z){const W=()=>{M(C.current),u==null||u()},q=()=>{const H=new Date().getTime()-k.current;C.current=C.current-H,window.clearTimeout(T.current),c==null||c()};return z.addEventListener(QE,q),z.addEventListener(ZE,W),()=>{z.removeEventListener(QE,q),z.removeEventListener(ZE,W)}}},[x.viewport,D,c,u,M]),p.useEffect(()=>{i&&!x.isClosePausedRef.current&&M(D)},[i,D,x.isClosePausedRef,M]),p.useEffect(()=>(P(),()=>A()),[P,A]);const j=p.useMemo(()=>E?FV(E):null,[E]);return x.viewport?a.jsxs(a.Fragment,{children:[j&&a.jsx(Rse,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:j}),a.jsx(Pse,{scope:n,onClose:R,children:Wa.createPortal(a.jsx(K1.ItemSlot,{scope:n,children:a.jsx(use,{asChild:!0,onEscapeKeyDown:_t(l,()=>{x.isFocusedToastEscapeKeyDownRef.current||R(),x.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(Yt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":x.swipeDirection,...g,ref:b,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:_t(t.onKeyDown,z=>{z.key==="Escape"&&(l==null||l(z.nativeEvent),z.nativeEvent.defaultPrevented||(x.isFocusedToastEscapeKeyDownRef.current=!0,R()))}),onPointerDown:_t(t.onPointerDown,z=>{z.button===0&&(S.current={x:z.clientX,y:z.clientY})}),onPointerMove:_t(t.onPointerMove,z=>{if(!S.current)return;const W=z.clientX-S.current.x,q=z.clientY-S.current.y,H=!!I.current,$=["left","right"].includes(x.swipeDirection),J=["left","up"].includes(x.swipeDirection)?Math.min:Math.max,O=$?J(0,W):0,V=$?0:J(0,q),G=z.pointerType==="touch"?10:2,F={x:O,y:V},ue={originalEvent:z,delta:F};H?(I.current=F,wy(Tse,h,ue,{discrete:!1})):Fj(F,x.swipeDirection,G)?(I.current=F,wy(Cse,d,ue,{discrete:!1}),z.target.setPointerCapture(z.pointerId)):(Math.abs(W)>G||Math.abs(q)>G)&&(S.current=null)}),onPointerUp:_t(t.onPointerUp,z=>{const W=I.current,q=z.target;if(q.hasPointerCapture(z.pointerId)&&q.releasePointerCapture(z.pointerId),I.current=null,S.current=null,W){const H=z.currentTarget,$={originalEvent:z,delta:W};Fj(W,x.swipeDirection,x.swipeThreshold)?wy(Nse,m,$,{discrete:!0}):wy(Ise,f,$,{discrete:!0}),H.addEventListener("click",J=>J.preventDefault(),{once:!0})}})})})}),x.viewport)})]}):null}),Rse=t=>{const{__scopeToast:e,children:n,...r}=t,s=h0(tg,e),[i,o]=p.useState(!1),[l,c]=p.useState(!1);return Mse(()=>o(!0)),p.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:a.jsx(d0,{asChild:!0,children:a.jsx(H1,{...r,children:i&&a.jsxs(a.Fragment,{children:[s.label," ",n]})})})},jse="ToastTitle",kV=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Yt.div,{...r,ref:e})});kV.displayName=jse;var Dse="ToastDescription",RV=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Yt.div,{...r,ref:e})});RV.displayName=Dse;var jV="ToastAction",DV=p.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?a.jsx(LV,{altText:n,asChild:!0,children:a.jsx(Y1,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${jV}\`. Expected non-empty \`string\`.`),null)});DV.displayName=jV;var MV="ToastClose",Y1=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,s=Ase(MV,n);return a.jsx(LV,{asChild:!0,children:a.jsx(Yt.button,{type:"button",...r,ref:e,onClick:_t(t.onClick,s.onClose)})})});Y1.displayName=MV;var LV=p.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...s}=t;return a.jsx(Yt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function FV(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),Lse(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...FV(r))}}),e}function wy(t,e,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?W1(s,i):s.dispatchEvent(i)}var Fj=(t,e,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return e==="left"||e==="right"?i&&r>n:!i&&s>n};function Mse(t=()=>{}){const e=Rr(t);ta(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function Lse(t){return t.nodeType===t.ELEMENT_NODE}function Fse(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function S_(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var Ose=TV,OV=NV,$V=AV,VV=kV,UV=RV,BV=DV,zV=Y1;const Oj=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,$j=Q$,J1=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return $j(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const f=Oj(d)||Oj(h);return s[u][f]}),l=n&&Object.entries(n).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:h,className:f,...m}=d;return Object.entries(m).every(g=>{let[x,E]=g;return Array.isArray(E)?E.includes({...i,...l}[x]):{...i,...l}[x]===E})?[...u,h,f]:u},[]);return $j(t,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};var $se={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Vse=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ue=(t,e)=>{const n=p.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:l,...c},u)=>p.createElement("svg",{ref:u,...$se,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${Vse(t)}`,...c},[...e.map(([d,h])=>p.createElement(d,h)),...(Array.isArray(l)?l:[l])||[]]));return n.displayName=`${t}`,n},Vj=Ue("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),ng=Ue("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Ra=Ue("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),lu=Ue("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Use=Ue("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),Bse=Ue("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),Pv=Ue("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),zse=Ue("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Gse=Ue("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),X1=Ue("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Yo=Ue("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),rg=Ue("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),f0=Ue("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Wse=Ue("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),GV=Ue("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Hse=Ue("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),qse=Ue("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),WV=Ue("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Bi=Ue("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Uj=Ue("DownloadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m8 17 4 4 4-4",key:"1ul180"}]]),HV=Ue("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),zd=Ue("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),Kse=Ue("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Yse=Ue("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),Tr=Ue("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Jse=Ue("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]),cu=Ue("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),E_=Ue("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),Bj=Ue("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),qV=Ue("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Xse=Ue("ImageDown",[["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10.8",key:"sqts6f"}],["path",{d:"m21 15-3.1-3.1a2 2 0 0 0-2.814.014L6 21",key:"1h47z9"}],["path",{d:"m14 19.5 3 3v-6",key:"1x9jmo"}],["path",{d:"m17 22.5 3-3",key:"xzuz0n"}]]),Qse=Ue("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),tC=Ue("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Zse=Ue("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),_x=Ue("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),eie=Ue("Layers3",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m6.08 9.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1e5n1m"}],["path",{d:"m6.08 14.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1iwflc"}]]),tie=Ue("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),nie=Ue("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),rie=Ue("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),St=Ue("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),KV=Ue("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),zj=Ue("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),Gj=Ue("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Gd=Ue("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),sie=Ue("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),iie=Ue("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),YV=Ue("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),oie=Ue("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),aie=Ue("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),nC=Ue("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),lie=Ue("MoveDown",[["path",{d:"M8 18L12 22L16 18",key:"cskvfv"}],["path",{d:"M12 2V22",key:"r89rzk"}]]),cie=Ue("MoveUp",[["path",{d:"M8 6L12 2L16 6",key:"1yvkyx"}],["path",{d:"M12 2V22",key:"r89rzk"}]]),Ei=Ue("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Q1=Ue("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),uie=Ue("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),Av=Ue("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),kv=Ue("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),Wj=Ue("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),die=Ue("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),hie=Ue("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),fie=Ue("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),JV=Ue("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),go=Ue("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),by=Ue("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Rv=Ue("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),mie=Ue("Replace",[["path",{d:"M14 4c0-1.1.9-2 2-2",key:"1mvvbw"}],["path",{d:"M20 2c1.1 0 2 .9 2 2",key:"1mj6oe"}],["path",{d:"M22 8c0 1.1-.9 2-2 2",key:"v1wql3"}],["path",{d:"M16 10c-1.1 0-2-.9-2-2",key:"821ux0"}],["path",{d:"m3 7 3 3 3-3",key:"x25e72"}],["path",{d:"M6 10V5c0-1.7 1.3-3 3-3h1",key:"13af7h"}],["rect",{width:"8",height:"8",x:"2",y:"14",rx:"2",key:"17ihk4"}]]),pie=Ue("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),C_=Ue("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Hj=Ue("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]),lh=Ue("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),gie=Ue("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),yie=Ue("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),wp=Ue("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),xie=Ue("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),XV=Ue("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),bp=Ue("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),is=Ue("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),QV=Ue("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),vie=Ue("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]),_y=Ue("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),rC=Ue("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Tm=Ue("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),ZV=Ue("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),sr=Ue("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Mf=Ue("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),jv=Ue("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),wie=Ue("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),bie=Ue("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),Jo=Ue("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]),_ie=Ue("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Sie=Ue("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),m0=Ue("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Eie=Ue("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),na=Ue("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),Ll=Ue("Wand",[["path",{d:"M15 4V2",key:"z1p9b7"}],["path",{d:"M15 16v-2",key:"px0unx"}],["path",{d:"M8 9h2",key:"1g203m"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M17.8 11.8 19 13",key:"yihg8r"}],["path",{d:"M15 9h0",key:"kg5t1u"}],["path",{d:"M17.8 6.2 19 5",key:"fd4us0"}],["path",{d:"m3 21 9-9",key:"1jfql5"}],["path",{d:"M12.2 6.2 11 5",key:"i3da3b"}]]),Dv=Ue("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),ra=Ue("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Cie=Ue("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),e3=Ue("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Tie=Ose,t3=ht.forwardRef(({className:t,...e},n)=>a.jsx(OV,{ref:n,className:Et("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));t3.displayName=OV.displayName;const Iie=J1("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),n3=ht.forwardRef(({className:t,variant:e,...n},r)=>a.jsx($V,{ref:r,className:Et(Iie({variant:e}),t),...n}));n3.displayName=$V.displayName;const Nie=ht.forwardRef(({className:t,...e},n)=>a.jsx(BV,{ref:n,className:Et("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));Nie.displayName=BV.displayName;const r3=ht.forwardRef(({className:t,...e},n)=>a.jsx(zV,{ref:n,className:Et("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:a.jsx(ra,{className:"h-4 w-4"})}));r3.displayName=zV.displayName;const s3=ht.forwardRef(({className:t,...e},n)=>a.jsx(VV,{ref:n,className:Et("text-sm font-semibold",t),...e}));s3.displayName=VV.displayName;const i3=ht.forwardRef(({className:t,...e},n)=>a.jsx(UV,{ref:n,className:Et("text-sm opacity-90",t),...e}));i3.displayName=UV.displayName;const Pie=1;let T_=0;function Aie(){return T_=(T_+1)%Number.MAX_VALUE,T_.toString()}const Ls={state:{toasts:[]},listeners:[],getState:()=>Ls.state,setState:t=>{typeof t=="function"?Ls.state=t(Ls.state):Ls.state={...Ls.state,...t},Ls.listeners.forEach(e=>e(Ls.state))},subscribe:t=>(Ls.listeners.push(t),()=>{Ls.listeners=Ls.listeners.filter(e=>e!==t)})},kie=({...t})=>{const e=Aie(),n=s=>Ls.setState(i=>({...i,toasts:i.toasts.map(o=>o.id===e?{...o,...s}:o)})),r=()=>Ls.setState(s=>({...s,toasts:s.toasts.filter(i=>i.id!==e)}));return Ls.setState(s=>({...s,toasts:[{...t,id:e,dismiss:r},...s.toasts].slice(0,Pie)})),{id:e,dismiss:r,update:n}};function Ks(){const[t,e]=p.useState(Ls.getState());return p.useEffect(()=>Ls.subscribe(r=>{e(r)}),[]),p.useEffect(()=>{const n=[];return t.toasts.forEach(r=>{if(r.duration===1/0)return;const s=setTimeout(()=>{r.dismiss()},r.duration||5e3);n.push(s)}),()=>{n.forEach(r=>clearTimeout(r))}},[t.toasts]),{toast:kie,toasts:t.toasts}}function Rie(){const{toasts:t}=Ks();return a.jsxs(Tie,{children:[t.map(({id:e,title:n,description:r,action:s,dismiss:i,...o})=>a.jsxs(n3,{...o,children:[a.jsxs("div",{className:"grid gap-1",children:[n&&a.jsx(s3,{children:n}),r&&a.jsx(i3,{children:r})]}),s,a.jsx(r3,{})]},e)),a.jsx(t3,{})]})}var jie=Ow[" useId ".trim().toString()]||(()=>{}),Die=0;function uu(t){const[e,n]=p.useState(jie());return ta(()=>{t||n(r=>r??String(Die++))},[t]),t||(e?`radix-${e}`:"")}var I_="focusScope.autoFocusOnMount",N_="focusScope.autoFocusOnUnmount",qj={bubbles:!1,cancelable:!0},Mie="FocusScope",Z1=p.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[l,c]=p.useState(null),u=Rr(s),d=Rr(i),h=p.useRef(null),f=Cn(e,x=>c(x)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let x=function(S){if(m.paused||!l)return;const I=S.target;l.contains(I)?h.current=I:ul(h.current,{select:!0})},E=function(S){if(m.paused||!l)return;const I=S.relatedTarget;I!==null&&(l.contains(I)||ul(h.current,{select:!0}))},v=function(S){if(document.activeElement===document.body)for(const D of S)D.removedNodes.length>0&&ul(l)};document.addEventListener("focusin",x),document.addEventListener("focusout",E);const b=new MutationObserver(v);return l&&b.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",E),b.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){Yj.add(m);const x=document.activeElement;if(!l.contains(x)){const v=new CustomEvent(I_,qj);l.addEventListener(I_,u),l.dispatchEvent(v),v.defaultPrevented||(Lie(Uie(o3(l)),{select:!0}),document.activeElement===x&&ul(l))}return()=>{l.removeEventListener(I_,u),setTimeout(()=>{const v=new CustomEvent(N_,qj);l.addEventListener(N_,d),l.dispatchEvent(v),v.defaultPrevented||ul(x??document.body,{select:!0}),l.removeEventListener(N_,d),Yj.remove(m)},0)}}},[l,u,d,m]);const g=p.useCallback(x=>{if(!n&&!r||m.paused)return;const E=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,v=document.activeElement;if(E&&v){const b=x.currentTarget,[S,I]=Fie(b);S&&I?!x.shiftKey&&v===I?(x.preventDefault(),n&&ul(S,{select:!0})):x.shiftKey&&v===S&&(x.preventDefault(),n&&ul(I,{select:!0})):v===b&&x.preventDefault()}},[n,r,m.paused]);return a.jsx(Yt.div,{tabIndex:-1,...o,ref:f,onKeyDown:g})});Z1.displayName=Mie;function Lie(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(ul(r,{select:e}),document.activeElement!==n)return}function Fie(t){const e=o3(t),n=Kj(e,t),r=Kj(e.reverse(),t);return[n,r]}function o3(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Kj(t,e){for(const n of t)if(!Oie(n,{upTo:e}))return n}function Oie(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function $ie(t){return t instanceof HTMLInputElement&&"select"in t}function ul(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&$ie(t)&&e&&t.select()}}var Yj=Vie();function Vie(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=Jj(t,e),t.unshift(e)},remove(e){var n;t=Jj(t,e),(n=t[0])==null||n.resume()}}}function Jj(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function Uie(t){return t.filter(e=>e.tagName!=="A")}var P_=0;function a3(){p.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Xj()),document.body.insertAdjacentElement("beforeend",t[1]??Xj()),P_++,()=>{P_===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),P_--}},[])}function Xj(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Es=function(){return Es=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Es.apply(this,arguments)};function sf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function l3(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var Im="right-scroll-bar-position",Nm="width-before-scroll-bar",Bie="with-scroll-bars-hidden",zie="--removed-body-scroll-bar-size";function A_(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Gie(t,e){var n=p.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var Wie=typeof window<"u"?p.useLayoutEffect:p.useEffect,Qj=new WeakMap;function c3(t,e){var n=Gie(e||null,function(r){return t.forEach(function(s){return A_(s,r)})});return Wie(function(){var r=Qj.get(n);if(r){var s=new Set(r),i=new Set(t),o=n.current;s.forEach(function(l){i.has(l)||A_(l,null)}),i.forEach(function(l){s.has(l)||A_(l,o)})}Qj.set(n,t)},[t]),n}function Hie(t){return t}function qie(t,e){e===void 0&&(e=Hie);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(l){return i(l)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var l=n;n=[],l.forEach(i),o=n}var c=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),n={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),n}}}};return s}function u3(t){t===void 0&&(t={});var e=qie(null);return e.options=Es({async:!0,ssr:!1},t),e}var d3=function(t){var e=t.sideCar,n=sf(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return p.createElement(r,Es({},n))};d3.isSideCarExport=!0;function h3(t,e){return t.useMedium(e),d3}var f3=u3(),k_=function(){},p0=p.forwardRef(function(t,e){var n=p.useRef(null),r=p.useState({onScrollCapture:k_,onWheelCapture:k_,onTouchMoveCapture:k_}),s=r[0],i=r[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,m=t.noRelative,g=t.noIsolation,x=t.inert,E=t.allowPinchZoom,v=t.as,b=v===void 0?"div":v,S=t.gapMode,I=sf(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),D=f,k=c3([n,e]),C=Es(Es({},I),s);return p.createElement(p.Fragment,null,d&&p.createElement(D,{sideCar:f3,removeScrollBar:u,shards:h,noRelative:m,noIsolation:g,inert:x,setCallbacks:i,allowPinchZoom:!!E,lockRef:n,gapMode:S}),o?p.cloneElement(p.Children.only(l),Es(Es({},C),{ref:k})):p.createElement(b,Es({},C,{className:c,ref:k}),l))});p0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};p0.classNames={fullWidth:Nm,zeroRight:Im};var Zj,Kie=function(){if(Zj)return Zj;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Yie(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Kie();return e&&t.setAttribute("nonce",e),t}function Jie(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Xie(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Qie=function(){var t=0,e=null;return{add:function(n){t==0&&(e=Yie())&&(Jie(e,n),Xie(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Zie=function(){var t=Qie();return function(e,n){p.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},eI=function(){var t=Zie(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},eoe={left:0,top:0,right:0,gap:0},R_=function(t){return parseInt(t||"",10)||0},toe=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[R_(n),R_(r),R_(s)]},noe=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return eoe;var e=toe(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},roe=eI(),ch="data-scroll-locked",soe=function(t,e,n,r){var s=t.left,i=t.top,o=t.right,l=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(Bie,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(ch,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Im,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Nm,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Im," .").concat(Im,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Nm," .").concat(Nm,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(ch,`] {
    `).concat(zie,": ").concat(l,`px;
  }
`)},e2=function(){var t=parseInt(document.body.getAttribute(ch)||"0",10);return isFinite(t)?t:0},ioe=function(){p.useEffect(function(){return document.body.setAttribute(ch,(e2()+1).toString()),function(){var t=e2()-1;t<=0?document.body.removeAttribute(ch):document.body.setAttribute(ch,t.toString())}},[])},m3=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;ioe();var i=p.useMemo(function(){return noe(s)},[s]);return p.createElement(roe,{styles:soe(i,!e,s,n?"":"!important")})},sC=!1;if(typeof window<"u")try{var Sy=Object.defineProperty({},"passive",{get:function(){return sC=!0,!0}});window.addEventListener("test",Sy,Sy),window.removeEventListener("test",Sy,Sy)}catch{sC=!1}var od=sC?{passive:!1}:!1,ooe=function(t){return t.tagName==="TEXTAREA"},p3=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!ooe(t)&&n[e]==="visible")},aoe=function(t){return p3(t,"overflowY")},loe=function(t){return p3(t,"overflowX")},t2=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=g3(t,r);if(s){var i=y3(t,r),o=i[1],l=i[2];if(o>l)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},coe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},uoe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},g3=function(t,e){return t==="v"?aoe(e):loe(e)},y3=function(t,e){return t==="v"?coe(e):uoe(e)},doe=function(t,e){return t==="h"&&e==="rtl"?-1:1},hoe=function(t,e,n,r,s){var i=doe(t,window.getComputedStyle(e).direction),o=i*r,l=n.target,c=e.contains(l),u=!1,d=o>0,h=0,f=0;do{if(!l)break;var m=y3(t,l),g=m[0],x=m[1],E=m[2],v=x-E-i*g;(g||v)&&g3(t,l)&&(h+=v,f+=g);var b=l.parentNode;l=b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE?b.host:b}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&(s&&Math.abs(h)<1||!s&&o>h)||!d&&(s&&Math.abs(f)<1||!s&&-o>f))&&(u=!0),u},Ey=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},n2=function(t){return[t.deltaX,t.deltaY]},r2=function(t){return t&&"current"in t?t.current:t},foe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},moe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},poe=0,ad=[];function goe(t){var e=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(poe++)[0],i=p.useState(eI)[0],o=p.useRef(t);p.useEffect(function(){o.current=t},[t]),p.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var x=l3([t.lockRef.current],(t.shards||[]).map(r2),!0).filter(Boolean);return x.forEach(function(E){return E.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),x.forEach(function(E){return E.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=p.useCallback(function(x,E){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!o.current.allowPinchZoom;var v=Ey(x),b=n.current,S="deltaX"in x?x.deltaX:b[0]-v[0],I="deltaY"in x?x.deltaY:b[1]-v[1],D,k=x.target,C=Math.abs(S)>Math.abs(I)?"h":"v";if("touches"in x&&C==="h"&&k.type==="range")return!1;var T=t2(C,k);if(!T)return!0;if(T?D=C:(D=C==="v"?"h":"v",T=t2(C,k)),!T)return!1;if(!r.current&&"changedTouches"in x&&(S||I)&&(r.current=D),!D)return!0;var P=r.current||D;return hoe(P,E,x,P==="h"?S:I,!0)},[]),c=p.useCallback(function(x){var E=x;if(!(!ad.length||ad[ad.length-1]!==i)){var v="deltaY"in E?n2(E):Ey(E),b=e.current.filter(function(D){return D.name===E.type&&(D.target===E.target||E.target===D.shadowParent)&&foe(D.delta,v)})[0];if(b&&b.should){E.cancelable&&E.preventDefault();return}if(!b){var S=(o.current.shards||[]).map(r2).filter(Boolean).filter(function(D){return D.contains(E.target)}),I=S.length>0?l(E,S[0]):!o.current.noIsolation;I&&E.cancelable&&E.preventDefault()}}},[]),u=p.useCallback(function(x,E,v,b){var S={name:x,delta:E,target:v,should:b,shadowParent:yoe(v)};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(I){return I!==S})},1)},[]),d=p.useCallback(function(x){n.current=Ey(x),r.current=void 0},[]),h=p.useCallback(function(x){u(x.type,n2(x),x.target,l(x,t.lockRef.current))},[]),f=p.useCallback(function(x){u(x.type,Ey(x),x.target,l(x,t.lockRef.current))},[]);p.useEffect(function(){return ad.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,od),document.addEventListener("touchmove",c,od),document.addEventListener("touchstart",d,od),function(){ad=ad.filter(function(x){return x!==i}),document.removeEventListener("wheel",c,od),document.removeEventListener("touchmove",c,od),document.removeEventListener("touchstart",d,od)}},[]);var m=t.removeScrollBar,g=t.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:moe(s)}):null,m?p.createElement(m3,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function yoe(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const xoe=h3(f3,goe);var x3=p.forwardRef(function(t,e){return p.createElement(p0,Es({},t,{ref:e,sideCar:xoe}))});x3.classNames=p0.classNames;const v3=x3;var voe=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},ld=new WeakMap,Cy=new WeakMap,Ty={},j_=0,w3=function(t){return t&&(t.host||w3(t.parentNode))},woe=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=w3(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},boe=function(t,e,n,r){var s=woe(e,Array.isArray(t)?t:[t]);Ty[n]||(Ty[n]=new WeakMap);var i=Ty[n],o=[],l=new Set,c=new Set(s),u=function(h){!h||l.has(h)||(l.add(h),u(h.parentNode))};s.forEach(u);var d=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(f){if(l.has(f))d(f);else try{var m=f.getAttribute(r),g=m!==null&&m!=="false",x=(ld.get(f)||0)+1,E=(i.get(f)||0)+1;ld.set(f,x),i.set(f,E),o.push(f),x===1&&g&&Cy.set(f,!0),E===1&&f.setAttribute(n,"true"),g||f.setAttribute(r,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return d(e),l.clear(),j_++,function(){o.forEach(function(h){var f=ld.get(h)-1,m=i.get(h)-1;ld.set(h,f),i.set(h,m),f||(Cy.has(h)||h.removeAttribute(r),Cy.delete(h)),m||h.removeAttribute(n)}),j_--,j_||(ld=new WeakMap,ld=new WeakMap,Cy=new WeakMap,Ty={})}},tI=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=e||voe(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),boe(r,s,n,"aria-hidden")):function(){return null}},g0="Dialog",[b3,_3]=Li(g0),[_oe,Io]=b3(g0),S3=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,l=p.useRef(null),c=p.useRef(null),[u,d]=Bu({prop:r,defaultProp:s??!1,onChange:i,caller:g0});return a.jsx(_oe,{scope:e,triggerRef:l,contentRef:c,contentId:uu(),titleId:uu(),descriptionId:uu(),open:u,onOpenChange:d,onOpenToggle:p.useCallback(()=>d(h=>!h),[d]),modal:o,children:n})};S3.displayName=g0;var E3="DialogTrigger",C3=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Io(E3,n),i=Cn(e,s.triggerRef);return a.jsx(Yt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":sI(s.open),...r,ref:i,onClick:_t(t.onClick,s.onOpenToggle)})});C3.displayName=E3;var nI="DialogPortal",[Soe,T3]=b3(nI,{forceMount:void 0}),I3=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:s}=t,i=Io(nI,e);return a.jsx(Soe,{scope:e,forceMount:n,children:p.Children.map(r,o=>a.jsx(qs,{present:n||i.open,children:a.jsx(d0,{asChild:!0,container:s,children:o})}))})};I3.displayName=nI;var Mv="DialogOverlay",N3=p.forwardRef((t,e)=>{const n=T3(Mv,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Io(Mv,t.__scopeDialog);return i.modal?a.jsx(qs,{present:r||i.open,children:a.jsx(Coe,{...s,ref:e})}):null});N3.displayName=Mv;var Eoe=Ah("DialogOverlay.RemoveScroll"),Coe=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Io(Mv,n);return a.jsx(v3,{as:Eoe,allowPinchZoom:!0,shards:[s.contentRef],children:a.jsx(Yt.div,{"data-state":sI(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Su="DialogContent",P3=p.forwardRef((t,e)=>{const n=T3(Su,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Io(Su,t.__scopeDialog);return a.jsx(qs,{present:r||i.open,children:i.modal?a.jsx(Toe,{...s,ref:e}):a.jsx(Ioe,{...s,ref:e})})});P3.displayName=Su;var Toe=p.forwardRef((t,e)=>{const n=Io(Su,t.__scopeDialog),r=p.useRef(null),s=Cn(e,n.contentRef,r);return p.useEffect(()=>{const i=r.current;if(i)return tI(i)},[]),a.jsx(A3,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:_t(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:_t(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:_t(t.onFocusOutside,i=>i.preventDefault())})}),Ioe=p.forwardRef((t,e)=>{const n=Io(Su,t.__scopeDialog),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(A3,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),A3=p.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,l=Io(Su,n),c=p.useRef(null),u=Cn(e,c);return a3(),a.jsxs(a.Fragment,{children:[a.jsx(Z1,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(u0,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":sI(l.open),...o,ref:u,onDismiss:()=>l.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(Poe,{titleId:l.titleId}),a.jsx(koe,{contentRef:c,descriptionId:l.descriptionId})]})]})}),rI="DialogTitle",k3=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Io(rI,n);return a.jsx(Yt.h2,{id:s.titleId,...r,ref:e})});k3.displayName=rI;var R3="DialogDescription",j3=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Io(R3,n);return a.jsx(Yt.p,{id:s.descriptionId,...r,ref:e})});j3.displayName=R3;var D3="DialogClose",M3=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Io(D3,n);return a.jsx(Yt.button,{type:"button",...r,ref:e,onClick:_t(t.onClick,()=>s.onOpenChange(!1))})});M3.displayName=D3;function sI(t){return t?"open":"closed"}var L3="DialogTitleWarning",[Noe,F3]=Kre(L3,{contentName:Su,titleName:rI,docsSlug:"dialog"}),Poe=({titleId:t})=>{const e=F3(L3),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return p.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},Aoe="DialogDescriptionWarning",koe=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${F3(Aoe).contentName}}.`;return p.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},O3=S3,Roe=C3,$3=I3,iI=N3,oI=P3,aI=k3,lI=j3,y0=M3;const Ps=O3,joe=$3,ja=y0,V3=ht.forwardRef(({className:t,...e},n)=>a.jsx(iI,{ref:n,className:Et("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));V3.displayName=iI.displayName;const ls=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(joe,{children:[a.jsx(V3,{}),a.jsxs(oI,{ref:r,className:Et("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,a.jsxs(y0,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(ra,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ls.displayName=oI.displayName;const cs=({className:t,...e})=>a.jsx("div",{className:Et("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});cs.displayName="DialogHeader";const jr=({className:t,...e})=>a.jsx("div",{className:Et("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});jr.displayName="DialogFooter";const us=ht.forwardRef(({className:t,...e},n)=>a.jsx(aI,{ref:n,className:Et("text-lg font-semibold leading-none tracking-tight",t),...e}));us.displayName=aI.displayName;const No=ht.forwardRef(({className:t,...e},n)=>a.jsx(lI,{ref:n,className:Et("text-sm text-muted-foreground",t),...e}));No.displayName=lI.displayName;const cI=J1("inline-flex items-center justify-center rounded-xl text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-foreground text-primary-foreground hover:bg-foreground/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-xl px-3",lg:"h-11 rounded-xl px-8",icon:"h-10 w-10 rounded-xl"}},defaultVariants:{variant:"default",size:"default"}}),U=ht.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},i)=>{const o=r?Jre:"button";return a.jsx(o,{className:Et(cI({variant:e,size:n,className:t})),ref:i,...s})});U.displayName="Button";const st=ht.forwardRef(({className:t,type:e,...n},r)=>a.jsx("input",{type:e,className:Et("flex h-10 w-full rounded-xl bg-white dark:bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-400 dark:placeholder:text-zinc-600 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n}));st.displayName="Input";const pc="AIzaSyA6fvf0Xgb29MloJ-JKiYJGzhv_jvPdL1Y";async function U3(t){const e=new hr({apiKey:pc}),n={type:Xe.ARRAY,items:{type:Xe.STRING},description:"An array of 5 creative and catchy store name suggestions."};try{const r=`Suggest 5 creative and catchy store name options based on the following description or keywords: "${t}". Return exactly 5 suggestions.`,s=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:r}]}],config:{responseMimeType:"application/json",responseSchema:n}}),i=s.text;if(typeof i!="string"||i.trim()==="")throw console.error("Model did not return a text response for store name suggestions. Response:",JSON.stringify(s)),new Error("Model response for store name suggestions was empty or not a string.");try{const o=JSON.parse(i);return Array.isArray(o)&&o.every(l=>typeof l=="string")?{suggestions:o.slice(0,5).map(l=>l.trim()).filter(l=>l.length>0)}:(console.error("Parsed store name suggestions are not an array of strings:",o),{error:"AI response was not in the expected format (array of strings).",rawResponse:i})}catch(o){return console.error("Failed to parse JSON response for store names:",i,"ParseError:",o),{error:"Failed to parse store name suggestions from AI.",rawResponse:i}}}catch(r){return console.error("Error generating store name suggestions:",r),{error:`Error generating suggestions: ${r.message}`}}}async function B3(t){const e=new hr({apiKey:pc}),n={type:Xe.OBJECT,properties:{heroTitle:{type:Xe.STRING,description:"The catchy hero title for the store."},heroDescription:{type:Xe.STRING,description:"A short (1-2 sentences) engaging hero description."}},required:["heroTitle","heroDescription"]},{name:r,niche:s,description:i,targetAudience:o,style:l}=t;let c=`Generate a compelling hero title and a short, engaging hero description for an online store.
Store Name: ${r||"N/A"}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of products."}
Target Audience: ${o||"General consumers"}
Style/Vibe: ${l||"Modern and friendly"}

Return the hero title and description as a JSON object matching the schema.`;try{const u=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:c}]}],config:{responseMimeType:"application/json",responseSchema:n}}),d=u.text;if(typeof d!="string"||d.trim()==="")throw console.error("Model did not return a text response for hero content. Response:",JSON.stringify(u)),new Error("Model response for hero content was empty or not a string.");try{const h=JSON.parse(d);return h&&typeof h.heroTitle=="string"&&typeof h.heroDescription=="string"?{heroTitle:h.heroTitle,heroDescription:h.heroDescription}:(console.error("Parsed hero content is not in the expected format:",h),{error:"AI response was not in the expected format for hero content.",rawResponse:d})}catch(h){return console.error("Failed to parse JSON response for hero content:",d,"ParseError:",h),{error:"Failed to parse hero content from AI.",rawResponse:d}}}catch(u){return console.error("Error generating hero content:",u),{error:`Error generating hero content: ${u.message}`}}}async function Doe(t){if(!t||!t.name)return console.error("Product information (at least name) is required for image prompt suggestions."),{error:"Product information required."};const e=new hr({apiKey:pc}),{name:n,description:r,niche:s,storeName:i}=t,o={type:Xe.ARRAY,items:{type:Xe.STRING},description:"An array of 6 diverse and creative text prompts for AI image generation related to a product."};let l=`product named "${n}"`;r&&(l+=` with description "${r}"`),i&&(l+=` from a store called "${i}"`),s&&(l+=` in the "${s}" niche`);const c=`Based on a ${l}, generate 6 diverse and creative text prompts suitable for AI image generation. These prompts should aim to create visually appealing images for marketing this product. Examples: "A dynamic shot of [product name] on a clean, modern background with soft lighting", "Lifestyle image of [product name] being used by a happy customer in a [relevant setting]", "Close-up detail of [product name]'s unique feature with artistic blur". Return exactly 6 prompt suggestions.`;try{const u=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:c}]}],config:{responseMimeType:"application/json",responseSchema:o}}),d=u.text;if(typeof d!="string"||d.trim()==="")throw console.error("Model did not return a text response for image prompt suggestions. Response:",JSON.stringify(u)),new Error("Model response for image prompt suggestions was empty or not a string.");try{const h=JSON.parse(d);return Array.isArray(h)&&h.every(f=>typeof f=="string")?{suggestions:h.slice(0,6).map(f=>f.trim()).filter(f=>f.length>0)}:(console.error("Parsed image prompt suggestions are not an array of strings:",h),{error:"AI response was not in the expected format for image prompts (array of strings).",rawResponse:d})}catch(h){return console.error("Failed to parse JSON response for image prompt suggestions:",d,"ParseError:",h),{error:"Failed to parse image prompt suggestions from AI.",rawResponse:d}}}catch(u){return console.error("Error generating image prompt suggestions:",u),{error:`Error generating image prompt suggestions: ${u.message}`}}}async function Moe(t){const e=new hr({apiKey:pc}),n={name:"extract_store_name",description:`Extracts the desired store name if explicitly mentioned in the prompt using phrases like "store called 'My Store'", "named 'My Store'", or "store 'My Store'". The name should be the direct object of such phrases.`,parameters:{type:Xe.OBJECT,properties:{storeName:{type:Xe.STRING,description:"The explicitly mentioned name of the store."}},required:["storeName"]}};try{const i=(await e.getGenerativeModel({model:"gemini-pro"}).generateContent({contents:[{role:"user",parts:[{text:t}]}],tools:[{functionDeclarations:[n]}]})).response.functionCalls();return i&&i.length>0&&i[0].name==="extract_store_name"&&i[0].args&&i[0].args.storeName?(console.log(`[extractExplicitStoreName] Gemini identified store name: ${i[0].args.storeName}`),i[0].args.storeName):(console.log("[extractExplicitStoreName] Gemini did not identify an explicit store name via function call."),null)}catch(r){return console.error("Error during Gemini store name extraction:",r),null}}async function z3(t){const e=new hr({apiKey:pc}),n={type:Xe.OBJECT,properties:{title:{type:Xe.STRING,description:"The main title for 'The [StoreName] Way' section (e.g., 'The AwesomeStore Way')."},subtitle:{type:Xe.STRING,description:"A short, engaging subtitle for this section (1-2 sentences)."},items:{type:Xe.ARRAY,description:"An array of 3 to 4 items representing the store's core values or unique selling points.",items:{type:Xe.OBJECT,properties:{emoji:{type:Xe.STRING,description:"A single relevant emoji for the item (e.g., '✨', '🌿')."},title:{type:Xe.STRING,description:"A short title for the item (2-4 words)."},description:{type:Xe.STRING,description:"A brief description of the item (10-20 words)."}},required:["emoji","title","description"]},minItems:3,maxItems:4}},required:["title","subtitle","items"]},{name:r,niche:s,description:i,targetAudience:o,style:l}=t,c=r||"Our Store";let u=`Generate content for "The ${c} Way" section of an online store. This section highlights the store's core values and what makes it unique.
Store Name: ${c}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of quality products."}
Target Audience: ${o||"General consumers"}
Style/Vibe: ${l||"Modern and customer-focused"}

The content should include:
1.  A main title (e.g., "The ${c} Way"). This title should dynamically incorporate the actual store name.
2.  A short subtitle (1-2 sentences) that is specific and engaging for this store.
3.  3 to 4 items, each with:
    *   A unique and highly relevant emoji that visually represents the item's theme and is specific to this store's niche/style/keywords. This emoji is mandatory and must not be a generic placeholder. For example, if the store sells coffee, an emoji like ☕ or 🌿 (for organic beans) would be appropriate. If it's a tech store, 💡 or 🚀.
    *   A short, catchy title for the item (2-4 words, e.g., "Artisanal Roasts", "Cutting-Edge Tech"). This title must be specific to the store's theme.
    *   A brief description (10-20 words) elaborating on the item's title, specific to the store's values and offerings.

Return this content as a JSON object matching the schema. Ensure all text content and emojis are distinct, creative, and directly reflect the store's unique characteristics and offerings. Do not use generic examples in the output.`;try{const d=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:u}]}],config:{responseMimeType:"application/json",responseSchema:n}}),h=d.text;if(typeof h!="string"||h.trim()==="")throw console.error("Model did not return a text response for store way content. Response:",JSON.stringify(d)),new Error("Model response for store way content was empty or not a string.");try{const f=JSON.parse(h);return f&&typeof f.title=="string"&&typeof f.subtitle=="string"&&Array.isArray(f.items)&&f.items.length>=3&&f.items.length<=4&&f.items.every(m=>typeof m.emoji=="string"&&m.emoji.length>0&&typeof m.title=="string"&&typeof m.description=="string")?(f.title=`The ${c} Way`,f):(console.error("Parsed store way content is not in the expected format:",f),{error:"AI response was not in the expected format for store way content.",rawResponse:h})}catch(f){return console.error("Failed to parse JSON response for store way content:",h,"ParseError:",f),{error:"Failed to parse store way content from AI.",rawResponse:h}}}catch(d){return console.error("Error generating store way content:",d),{error:`Error generating store way content: ${d.message}`}}}async function G3(t){const e=[{iconName:"Truck",title:"Fast Shipping",description:"Get your orders delivered quickly and reliably."},{iconName:"ShieldCheck",title:"Secure Payments",description:"Shop with confidence using our secure payment gateways."},{iconName:"MessageSquare",title:"24/7 Support",description:"Our dedicated team is here to help you around the clock."},{iconName:"Repeat",title:"Easy Returns",description:"Hassle-free return and exchange policy if you're not satisfied."},{iconName:"Award",title:"Quality Guaranteed",description:"We stand by the quality of our products."},{iconName:"Gift",title:"Gift Options",description:"Special gift wrapping and messaging available."}],n=[{iconName:"Users",number:"10K+",label:"Active Users"},{iconName:"Star",number:"4.8",label:"Avg. Rating"},{iconName:"PackageCheck",number:"20K+",label:"Orders Shipped"},{iconName:"ShieldCheck",number:"100%",label:"Secure Checkout"},{iconName:"ThumbsUp",number:"95%",label:"Positive Feedback"},{iconName:"Globe",number:"Worldwide",label:"Shipping"}],r=new hr({apiKey:pc}),s={type:Xe.OBJECT,properties:{title:{type:Xe.STRING,description:"Main title for the features/experience section (e.g., 'An Exceptional Experience')."},subtitle:{type:Xe.STRING,description:"Engaging subtitle for the features section (1-2 sentences)."},items:{type:Xe.ARRAY,description:"An array of 3 to 4 feature items highlighting key store benefits.",items:{type:Xe.OBJECT,properties:{emoji:{type:Xe.STRING,description:"A single relevant emoji for the feature (e.g., '🛡️', '🌍', '💎')."},title:{type:Xe.STRING,description:"Short title for the feature (2-4 words, e.g., 'Secure Payments', 'Global Reach')."},description:{type:Xe.STRING,description:"Brief description of the feature (10-20 words)."}},required:["emoji","title","description"]},minItems:3,maxItems:4},secondaryItems:{type:Xe.ARRAY,description:"An array of up to 4 secondary feature items highlighting broader store benefits or values. The function will ensure 4 items are present by adding defaults if needed.",items:{type:Xe.OBJECT,properties:{iconName:{type:Xe.STRING,description:"Name of a Lucide icon (e.g., 'GlobeIcon', 'AwardIcon', 'UsersIcon', 'HeartIcon') for the secondary feature."},title:{type:Xe.STRING,description:"Short title for the secondary feature (2-4 words, e.g., 'Global Shipping', 'Quality Assured')."},description:{type:Xe.STRING,description:"Brief description of the secondary feature (10-15 words)."}},required:["iconName","title","description"]},minItems:0,maxItems:4},statsItems:{type:Xe.ARRAY,description:"An array of exactly 4 stat items highlighting key metrics or achievements.",items:{type:Xe.OBJECT,properties:{iconName:{type:Xe.STRING,description:"Name of a Lucide icon for the stat (e.g., 'UsersIcon', 'StarIcon', 'ZapIcon')."},number:{type:Xe.STRING,description:"The statistic value (e.g., '50K+', '99.9%', '4.9')."},label:{type:Xe.STRING,description:"The label for the statistic (e.g., 'Happy Customers', 'Uptime', 'Average Rating')."}},required:["iconName","number","label"]},minItems:4,maxItems:4}},required:["title","subtitle","items","secondaryItems","statsItems"]},{name:i,niche:o,description:l,targetAudience:c,style:u}=t,d=i||"Our Store";let h=`Generate content for a store features section, often titled "An Exceptional Experience" or similar, for an online store named "${d}".
This section should highlight key benefits and unique selling propositions.
Store Name: ${d}
Niche: ${o||"General E-commerce"}
Description/Keywords: ${l||"A variety of quality products."}
Target Audience: ${c||"General consumers"}
Style/Vibe: ${u||"Modern and customer-focused"}

The content should include:
1.  A main title for the section (e.g., "Why Choose Us?", "Our Commitment to You", "An Exceptional Experience").
2.  A short, engaging subtitle (1-2 sentences).
3.  3 to 4 feature items, each with:
    *   A unique and highly relevant emoji that visually represents the feature (e.g., ✨ for innovation,  for eco-friendly,  for smart tech). This emoji is mandatory and must be specific to the feature's theme.
    *   A short, catchy, and descriptive title for the feature (2-5 words, e.g., "Innovative Designs", "Sustainable Materials", "Smart Home Solutions"). This title will be used to search for a relevant background video, so make it evocative.
    *   A brief description (10-20 words) explaining the benefit of the feature.
4.  Up to 4 secondary feature items (the system will ensure 4 by adding defaults if fewer are provided by AI), each with:
    *   An \`iconName\` string representing a Lucide icon (e.g., "GlobeIcon", "AwardIcon", "UsersIcon", "HeartIcon"). Choose an icon name that best fits the feature. Examples: GlobeIcon, AwardIcon, UsersIcon, HeartIcon, PackageIcon, ShieldIcon, ZapIcon.
    *   A short title for the secondary feature (2-4 words, e.g., "Global Shipping", "Quality Assured", "Community Love", "Eco-Friendly Focus").
    *   A brief description (10-15 words) for the secondary feature. These should highlight broader store values or benefits.
5.  Exactly 4 stat items, each with:
    *   An \`iconName\` string for a Lucide icon (e.g., "UsersIcon", "StarIcon", "ZapIcon", "PackageIcon").
    *   A \`number\` or key metric (e.g., "50K+", "99.9%", "4.9", "1M+"). Avoid including symbols like ★ in the number string itself.
    *   A descriptive \`label\` (e.g., "Happy Customers", "Uptime Guarantee", "Average Rating", "Units Sold").

Return this content as a JSON object matching the schema. Ensure all text content, emojis, and iconNames are distinct, creative, and directly reflect positive attributes of a store like "${d}". Do not use generic examples in the output. Examples of main features could be related to payment security, shipping, product quality, customer service. Secondary features could be about global reach, quality assurance, community, sustainability etc. Stats should reflect plausible achievements or service levels for a store selling "${o||"various items"}".`;try{const f=await r.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:h}]}],config:{responseMimeType:"application/json",responseSchema:s}}),m=f.text;if(typeof m!="string"||m.trim()==="")throw console.error("Model did not return a text response for store features content. Response:",JSON.stringify(f)),new Error("Model response for store features content was empty or not a string.");try{const g=JSON.parse(m);if(g&&typeof g.title=="string"&&typeof g.subtitle=="string"&&Array.isArray(g.items)&&g.items.length>=3&&g.items.length<=4&&g.items.every(x=>typeof x.emoji=="string"&&x.emoji.length>0&&typeof x.title=="string"&&typeof x.description=="string")){let x=[];g.secondaryItems&&Array.isArray(g.secondaryItems)&&(x=g.secondaryItems.filter(S=>S&&typeof S.iconName=="string"&&S.iconName.length>0&&typeof S.title=="string"&&S.title.length>0&&typeof S.description=="string"&&S.description.length>0).slice(0,4));const E=4-x.length;if(E>0){const S=new Set(x.map(D=>D.title)),I=e.filter(D=>!S.has(D.title)).slice(0,E);x.push(...I)}g.secondaryItems=x.slice(0,4);let v=[];g.statsItems&&Array.isArray(g.statsItems)&&(v=g.statsItems.filter(S=>S&&typeof S.iconName=="string"&&S.iconName.length>0&&typeof S.number=="string"&&S.number.length>0&&typeof S.label=="string"&&S.label.length>0).slice(0,4));const b=4-v.length;if(b>0){const S=new Set(v.map(D=>D.label)),I=n.filter(D=>!S.has(D.label)).slice(0,b);v.push(...I)}return g.statsItems=v.slice(0,4),Array.isArray(g.secondaryItems)&&g.secondaryItems.every(S=>typeof S.iconName=="string"&&S.iconName.length>0&&typeof S.title=="string"&&typeof S.description=="string")&&Array.isArray(g.statsItems)&&g.statsItems.length===4&&g.statsItems.every(S=>typeof S.iconName=="string"&&S.iconName.length>0&&typeof S.number=="string"&&S.number.length>0&&typeof S.label=="string"&&S.label.length>0)?g:(console.error("Parsed store features content is not in the expected format after padding/validation:",g),(!g.statsItems||g.statsItems.length!==4)&&(console.warn("Stats items still not 4, forcing defaults for stats."),g.statsItems=n.slice(0,4)),(!g.secondaryItems||g.secondaryItems.length===0)&&(console.warn("Secondary items empty, forcing defaults for secondary."),g.secondaryItems=e.slice(0,Math.min(4,e.length))),g.title&&g.subtitle&&g.items?g:{error:"AI response format error after final processing.",rawResponse:m,processedContent:g})}else return console.error("Initial parsed store features content structure is invalid:",g),{error:"AI response (initial structure) was not in the expected format for store features content.",rawResponse:m}}catch(g){return console.error("Failed to parse JSON response for store features content:",m,"ParseError:",g),{error:"Failed to parse store features content from AI.",rawResponse:m}}}catch(f){return console.error("Error generating store features content:",f),{error:`Error generating store features content: ${f.message}`}}}async function W3(t){const e=new hr({apiKey:pc}),n={type:Xe.OBJECT,properties:{title:{type:Xe.STRING,description:"Catchy title for a section highlighting craftsmanship/quality (e.g., 'Our Commitment to Quality')."},subtitle:{type:Xe.STRING,description:"Engaging subtitle (1-2 sentences) related to the title."},text:{type:Xe.STRING,description:"Main descriptive text (2-3 sentences) about the store's dedication to quality, materials, or process."},listItems:{type:Xe.ARRAY,description:"An array of 3-4 short bullet points (3-5 words each) highlighting key aspects (e.g., 'Premium Materials', 'Expert Craftsmanship').",items:{type:Xe.STRING},minItems:3,maxItems:4},ctaText:{type:Xe.STRING,description:"Call to action button text (e.g., 'Explore Our Process', 'Learn More')."}},required:["title","subtitle","text","listItems","ctaText"]},{name:r,niche:s,description:i}=t,o=t.productExamples?`Key products include: ${t.productExamples}.`:"The store offers a range of specialized gear.",l=`Generate content for a website section for a store with a "sharp" and "tactical" aesthetic. This section has an image on the right and text on the left, emphasizing the store's precision, quality, craftsmanship, or unique process.
Store Name: "${r||"Our Store"}"
Niche/Type: "${s||"high-performance gear"}"
Store Description: "${i||"A store dedicated to excellence and precision."}"
${o}
Generate a title, subtitle, main text (2-3 sentences), 3-4 list items (3-5 words each), and a CTA button text.
The tone should be bold, confident, and precise, fitting a high-tech or tactical brand.
Focus on aspects like durability, advanced technology, expert design, or mission-readiness.
Return as a JSON object matching the schema.`;try{const u=(await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:l}]}],config:{responseMimeType:"application/json",responseSchema:n}})).text;if(!(u!=null&&u.trim()))throw new Error("Empty response from AI.");const d=JSON.parse(u);return d.title&&d.subtitle&&d.text&&Array.isArray(d.listItems)&&d.listItems.length>=3&&d.ctaText?d:(console.error("Invalid structure from AI for ImageRightSection:",d),{error:"AI response format error for ImageRightSection.",rawResponse:u})}catch(c){return console.error("Error generating ImageRightSection content:",c),{error:`Error generating ImageRightSection content: ${c.message}`}}}async function H3(t){const e=new hr({apiKey:pc}),n={type:Xe.OBJECT,properties:{title:{type:Xe.STRING,description:"Catchy title for a section showcasing a product or brand story via video (e.g., 'Experience the Difference')."},subtitle:{type:Xe.STRING,description:"Engaging subtitle (1-2 sentences) related to the video's theme."},text:{type:Xe.STRING,description:"Main descriptive text (2-3 sentences) complementing the video."},listItems:{type:Xe.ARRAY,description:"An array of 2-3 short bullet points (3-5 words each) highlighting key takeaways or features shown in a video.",items:{type:Xe.STRING},minItems:2,maxItems:3},ctaText:{type:Xe.STRING,description:"Call to action button text (e.g., 'Watch Now', 'See It In Action')."}},required:["title","subtitle","text","listItems","ctaText"]},{name:r,niche:s,description:i}=t,o=t.productExamples?`The video might showcase products like: ${t.productExamples}.`:"The video showcases our innovative products.",l=`Generate content for a website section for a store with a "sharp" and "tactical" aesthetic. This section has a video on the left and text on the right, aiming to engage users with a dynamic visual story or product demonstration.
Store Name: "${r||"Our Store"}"
Niche/Type: "${s||"cutting-edge solutions"}"
Store Description: "${i||"A store focused on performance and innovation."}"
${o}
Generate a title, subtitle, main text (2-3 sentences), 2-3 list items (3-5 words each highlighting video takeaways), and a CTA button text.
The tone should be energetic, impactful, and forward-thinking, suitable for a high-performance brand.
Focus on action, benefits, or the experience the video portrays.
Return as a JSON object matching the schema.`;try{const u=(await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:l}]}],config:{responseMimeType:"application/json",responseSchema:n}})).text;if(!(u!=null&&u.trim()))throw new Error("Empty response from AI.");const d=JSON.parse(u);return d.title&&d.subtitle&&d.text&&Array.isArray(d.listItems)&&d.listItems.length>=2&&d.ctaText?d:(console.error("Invalid structure from AI for VideoLeftSection:",d),{error:"AI response format error for VideoLeftSection.",rawResponse:u})}catch(c){return console.error("Error generating VideoLeftSection content:",c),{error:`Error generating VideoLeftSection content: ${c.message}`}}}const Vn=ht.forwardRef(({className:t,...e},n)=>a.jsx("textarea",{className:Et("flex min-h-[80px] w-full rounded-xl bg-white dark:bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-zinc-400 dark:placeholder:text-zinc-600 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));Vn.displayName="Textarea";var Loe="Label",q3=p.forwardRef((t,e)=>a.jsx(Yt.label,{...t,ref:e,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));q3.displayName=Loe;var K3=q3;const je=ht.forwardRef(({className:t,...e},n)=>a.jsx(K3,{ref:n,className:Et("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...e}));je.displayName=K3.displayName;var Foe=p.createContext(void 0);function x0(t){const e=p.useContext(Foe);return t||e||"ltr"}var D_="rovingFocusGroup.onEntryFocus",Ooe={bubbles:!1,cancelable:!0},sg="RovingFocusGroup",[iC,Y3,$oe]=G1(sg),[Voe,v0]=Li(sg,[$oe]),[Uoe,Boe]=Voe(sg),J3=p.forwardRef((t,e)=>a.jsx(iC.Provider,{scope:t.__scopeRovingFocusGroup,children:a.jsx(iC.Slot,{scope:t.__scopeRovingFocusGroup,children:a.jsx(zoe,{...t,ref:e})})}));J3.displayName=sg;var zoe=p.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=t,f=p.useRef(null),m=Cn(e,f),g=x0(i),[x,E]=Bu({prop:o,defaultProp:l??null,onChange:c,caller:sg}),[v,b]=p.useState(!1),S=Rr(u),I=Y3(n),D=p.useRef(!1),[k,C]=p.useState(0);return p.useEffect(()=>{const T=f.current;if(T)return T.addEventListener(D_,S),()=>T.removeEventListener(D_,S)},[S]),a.jsx(Uoe,{scope:n,orientation:r,dir:g,loop:s,currentTabStopId:x,onItemFocus:p.useCallback(T=>E(T),[E]),onItemShiftTab:p.useCallback(()=>b(!0),[]),onFocusableItemAdd:p.useCallback(()=>C(T=>T+1),[]),onFocusableItemRemove:p.useCallback(()=>C(T=>T-1),[]),children:a.jsx(Yt.div,{tabIndex:v||k===0?-1:0,"data-orientation":r,...h,ref:m,style:{outline:"none",...t.style},onMouseDown:_t(t.onMouseDown,()=>{D.current=!0}),onFocus:_t(t.onFocus,T=>{const P=!D.current;if(T.target===T.currentTarget&&P&&!v){const A=new CustomEvent(D_,Ooe);if(T.currentTarget.dispatchEvent(A),!A.defaultPrevented){const R=I().filter(q=>q.focusable),M=R.find(q=>q.active),j=R.find(q=>q.id===x),W=[M,j,...R].filter(Boolean).map(q=>q.ref.current);Z3(W,d)}}D.current=!1}),onBlur:_t(t.onBlur,()=>b(!1))})})}),X3="RovingFocusGroupItem",Q3=p.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:o,...l}=t,c=uu(),u=i||c,d=Boe(X3,n),h=d.currentTabStopId===u,f=Y3(n),{onFocusableItemAdd:m,onFocusableItemRemove:g,currentTabStopId:x}=d;return p.useEffect(()=>{if(r)return m(),()=>g()},[r,m,g]),a.jsx(iC.ItemSlot,{scope:n,id:u,focusable:r,active:s,children:a.jsx(Yt.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...l,ref:e,onMouseDown:_t(t.onMouseDown,E=>{r?d.onItemFocus(u):E.preventDefault()}),onFocus:_t(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:_t(t.onKeyDown,E=>{if(E.key==="Tab"&&E.shiftKey){d.onItemShiftTab();return}if(E.target!==E.currentTarget)return;const v=Hoe(E,d.orientation,d.dir);if(v!==void 0){if(E.metaKey||E.ctrlKey||E.altKey||E.shiftKey)return;E.preventDefault();let S=f().filter(I=>I.focusable).map(I=>I.ref.current);if(v==="last")S.reverse();else if(v==="prev"||v==="next"){v==="prev"&&S.reverse();const I=S.indexOf(E.currentTarget);S=d.loop?qoe(S,I+1):S.slice(I+1)}setTimeout(()=>Z3(S))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:x!=null}):o})})});Q3.displayName=X3;var Goe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Woe(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Hoe(t,e,n){const r=Woe(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Goe[r]}function Z3(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function qoe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var eU=J3,tU=Q3,w0="Tabs",[Koe,RRe]=Li(w0,[v0]),nU=v0(),[Yoe,uI]=Koe(w0),rU=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...u}=t,d=x0(l),[h,f]=Bu({prop:r,onChange:s,defaultProp:i??"",caller:w0});return a.jsx(Yoe,{scope:n,baseId:uu(),value:h,onValueChange:f,orientation:o,dir:d,activationMode:c,children:a.jsx(Yt.div,{dir:d,"data-orientation":o,...u,ref:e})})});rU.displayName=w0;var sU="TabsList",iU=p.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...s}=t,i=uI(sU,n),o=nU(n);return a.jsx(eU,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:r,children:a.jsx(Yt.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});iU.displayName=sU;var oU="TabsTrigger",aU=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=t,o=uI(oU,n),l=nU(n),c=uU(o.baseId,r),u=dU(o.baseId,r),d=r===o.value;return a.jsx(tU,{asChild:!0,...l,focusable:!s,active:d,children:a.jsx(Yt.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...i,ref:e,onMouseDown:_t(t.onMouseDown,h=>{!s&&h.button===0&&h.ctrlKey===!1?o.onValueChange(r):h.preventDefault()}),onKeyDown:_t(t.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(r)}),onFocus:_t(t.onFocus,()=>{const h=o.activationMode!=="manual";!d&&!s&&h&&o.onValueChange(r)})})})});aU.displayName=oU;var lU="TabsContent",cU=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...o}=t,l=uI(lU,n),c=uU(l.baseId,r),u=dU(l.baseId,r),d=r===l.value,h=p.useRef(d);return p.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),a.jsx(qs,{present:s||d,children:({present:f})=>a.jsx(Yt.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:u,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});cU.displayName=lU;function uU(t,e){return`${t}-trigger-${e}`}function dU(t,e){return`${t}-content-${e}`}var Joe=rU,hU=iU,fU=aU,mU=cU;const Fi=Joe,hi=ht.forwardRef(({className:t,...e},n)=>a.jsx(hU,{ref:n,className:Et("inline-flex h-10 items-center justify-center rounded-[18px] bg-white dark:bg-[#1c1c1c] p-1 text-muted-foreground",t),...e}));hi.displayName=hU.displayName;const Gt=ht.forwardRef(({className:t,...e},n)=>a.jsx(fU,{ref:n,className:Et("inline-flex items-center justify-center whitespace-nowrap rounded-xl px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-gray-100 data-[state=active]:dark:bg-zinc-700 data-[state=active]:text-foreground data-[state=active]:shadow-sm data-[state=active]:border data-[state=active]:border-[#8d9499] data-[state=active]:relative data-[state=active]:-top-px",t),...e}));Gt.displayName=fU.displayName;const Wt=ht.forwardRef(({className:t,...e},n)=>a.jsx(mU,{ref:n,className:Et("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));Wt.displayName=mU.displayName;var Xoe="Separator",s2="horizontal",Qoe=["horizontal","vertical"],pU=p.forwardRef((t,e)=>{const{decorative:n,orientation:r=s2,...s}=t,i=Zoe(r)?r:s2,l=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return a.jsx(Yt.div,{"data-orientation":i,...l,...s,ref:e})});pU.displayName=Xoe;function Zoe(t){return Qoe.includes(t)}var gU=pU;const Da=ht.forwardRef(({className:t,orientation:e="horizontal",decorative:n=!0,...r},s)=>a.jsx(gU,{ref:s,decorative:n,orientation:e,className:Et("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...r}));Da.displayName=gU.displayName;const yU="AIzaSyA6fvf0Xgb29MloJ-JKiYJGzhv_jvPdL1Y";console.log("[geminiImageGeneration Module] VITE_GEMINI_API_KEY loaded:",`"${yU.substring(0,5)}..."`);const xU="YsU4YZtXedeyLPn6bQaNT8PD";console.log("[geminiImageGeneration Module] VITE_REMOVE_BG_API_KEY loaded:",`"${xU.substring(0,5)}..."`);const zu=yU,dI=xU,gc=[{category:xr.HARM_CATEGORY_HARASSMENT,threshold:vr.BLOCK_NONE},{category:xr.HARM_CATEGORY_HATE_SPEECH,threshold:vr.BLOCK_NONE},{category:xr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:vr.BLOCK_NONE},{category:xr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:vr.BLOCK_NONE}];async function eae(t,e,n){var r;try{const s=[{inlineData:{mimeType:e,data:t}},{text:"Describe the main colors of this logo. Is it primarily black, white, or colorful? If black or white, state which. If colorful, list the dominant colors."}],i=await n.models.generateContent({model:"gemini-2.0-flash",contents:s,safetySettings:gc,config:{responseModalities:[Dn.TEXT]}}),o=((r=i==null?void 0:i.text)==null?void 0:r.toLowerCase())||"";return console.log("[getLogoColorType] Gemini color description:",o),o.includes("primarily black")||o.includes("black logo")?"black":o.includes("primarily white")||o.includes("white logo")?"white":(o.includes("colorful")||o.includes("multiple colors")||o.includes("various colors")||console.warn("[getLogoColorType] Could not clearly determine logo color type. Defaulting to 'colored'. Desc:",o),"colored")}catch(s){return console.error("[getLogoColorType] Error analyzing logo color:",s),"colored"}}async function ig(t,e=(n,r)=>console.log(`Logo Progress: ${n}%, Message: ${r||""}`)){var l,c,u,d;if(!t)throw new Error("Store name is required.");const n=new hr({apiKey:zu}),r=`Create a modern, clean, and professional logo for an e-commerce store named "${t}". The logo should be suitable for a website header. Avoid text in the logo itself, or if text is present, ensure it is "${t}" and highly legible. Focus on an iconic and memorable design. Generate a square image. The main subject of the logo should be prominent.`;let s="",i=null,o=null;try{console.log("[generateLogoWithGemini] Generating initial logo for:",t),e(void 0,`Generating initial logo for ${t}...`);const h=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:gc,config:{responseModalities:[Dn.TEXT,Dn.IMAGE]}});if((u=(c=(l=h.candidates)==null?void 0:l[0])==null?void 0:c.content)!=null&&u.parts){for(const b of h.candidates[0].content.parts)if(b.text)s+=b.text;else if((d=b.inlineData)!=null&&d.data){i=b.inlineData.data,o=b.inlineData.mimeType;break}}if(!i)throw new Error("Failed to generate initial image data. "+(s||"No text explanation."));console.log("[generateLogoWithGemini] Initial logo generated. MimeType:",o);let f=null,m=null,g=i,x=o;if(dI)try{console.log("[generateLogoWithGemini] Removing background."),e(void 0,"Removing logo background..."),g=await vU(i,o),x="image/png",console.log("[generateLogoWithGemini] Background removed."),e(void 0,"Background removed.")}catch(b){console.warn("[generateLogoWithGemini] BG removal failed, using original:",b.message),e(void 0,"Background removal failed.")}const E=await eae(g,x,n),v=`data:${x};base64,${g}`;if(E==="black"){m=v;try{const b=await Ql(g,x,"Convert this black logo to a white logo, maintaining transparency and all details precisely. Output only the modified image.");if(b.editedImageData)f=`data:${b.newMimeType};base64,${b.editedImageData}`;else throw new Error("Inversion to white failed.")}catch(b){console.warn("[generateLogoWithGemini] Failed to make white version:",b.message),f=v}}else if(E==="white"){f=v;try{const b=await Ql(g,x,"Convert this white logo to a black logo, maintaining transparency and all details precisely. Output only the modified image.");if(b.editedImageData)m=`data:${b.newMimeType};base64,${b.editedImageData}`;else throw new Error("Inversion to black failed.")}catch(b){console.warn("[generateLogoWithGemini] Failed to make black version:",b.message),m=v}}else f=v,m=v;return{logoUrlLight:f,logoUrlDark:m,textResponse:s}}catch(h){throw console.error("[generateLogoWithGemini] Main error:",h.message,h.stack),new Error(`Logo generation failed: ${h.message||"Unknown error"}`)}}async function Wd(t,e,n){return console.warn("Skipping image caption generation due to environment limitations."),["Generated image description."]}function tae(t,e){const n=atob(t),r=new Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return new Blob([new Uint8Array(r)],{type:e})}async function vU(t,e){const n=tae(t,e),r=new FormData;r.append("size","auto"),r.append("image_file",n,"logo_temp"+(e.startsWith("image/")?"."+e.substring(6):".bin")),r.append("format","png");try{const s=await fetch("https://api.remove.bg/v1.0/removebg",{method:"POST",headers:{"X-Api-Key":dI},body:r});if(!s.ok){const o=await s.text();throw new Error(`Remove.bg API Error ${s.status}: ${o}`)}const i=await s.arrayBuffer();return btoa(new Uint8Array(i).reduce((o,l)=>o+String.fromCharCode(l),""))}catch(s){throw console.error("[removeBackgroundFromLogo] Error:",s.message),s}}async function Ql(t,e,n){var i,o,l,c;if(!t||!e||!n)throw new Error("Image data, MIME type, and prompt required.");const r=new hr({apiKey:zu}),s=[{text:n},{inlineData:{mimeType:e,data:t}}];try{const u=await r.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:s,safetySettings:gc,config:{responseModalities:[Dn.TEXT,Dn.IMAGE]}});let d=null,h="",f=e;if((l=(o=(i=u.candidates)==null?void 0:i[0])==null?void 0:o.content)!=null&&l.parts){for(const m of u.candidates[0].content.parts)if(m.text)h+=m.text;else if((c=m.inlineData)!=null&&c.data){d=m.inlineData.data,f=m.inlineData.mimeType||e;break}}if(!d)throw new Error("Failed to edit image. "+(h||"No text explanation."));return{editedImageData:d,newMimeType:f,editTextResponse:h}}catch(u){throw console.error("[editImageWithGemini] Error:",u.message),new Error(`Image editing failed: ${u.message||"Unknown error"}`)}}async function wU(t,e){var s,i,o,l;if(!t)throw new Error("Product name required.");const n=new hr({apiKey:zu});let r=`Generate a clean, commercial-style product image for "${t}".`;e&&(r+=` Description: "${e}".`),r+=" Main focus on product, simple/neutral/white background for e-commerce. Square image.";try{const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:gc,config:{responseModalities:[Dn.TEXT,Dn.IMAGE]}});let u=null,d="",h="image/png";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const f of c.candidates[0].content.parts)if(f.text)d+=f.text;else if((l=f.inlineData)!=null&&l.data){u=f.inlineData.data,h=f.inlineData.mimeType||"image/png";break}}if(!u)throw new Error("Failed to generate product image. "+(d||"No text explanation."));if(dI)try{return{imageData:await vU(u,h),textResponse:d}}catch(f){console.warn("[generateGenericProductImageWithGemini] BG removal failed, using original:",f.message)}return{imageData:u,textResponse:d}}catch(c){throw console.error("[generateGenericProductImageWithGemini] Error:",c.message),new Error(`Product image generation failed: ${c.message||"Unknown error"}`)}}async function b0({prompt:t,referenceImage:e}){var i,o,l,c;if(!t)throw new Error("Prompt required.");const n=new hr({apiKey:zu});let r;const s=`Generate visually appealing image/print design to place on a product based on the following user prompt for a store generator: "${t}". Solely the image/design alone that is intended to go on products (canvas, t-shirts, mugs) not the products themselves. Square image.`;e!=null&&e.base64Data&&(e!=null&&e.mimeType)?r=[{text:`Using the provided image as a reference, generate a new image based on the following concept: "${t}". Ensure the output is suitable for print-on-demand merchandise and is a square image.`},{inlineData:{mimeType:e.mimeType,data:e.base64Data}}]:r=s;try{const u=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:gc,config:{responseModalities:[Dn.TEXT,Dn.IMAGE]}});let d=null,h=null,f="";if((l=(o=(i=u.candidates)==null?void 0:i[0])==null?void 0:o.content)!=null&&l.parts){for(const m of u.candidates[0].content.parts)if(m.text)f+=m.text;else if((c=m.inlineData)!=null&&c.data){d=m.inlineData.data,h=m.inlineData.mimeType;break}}if(!d)throw new Error("Failed to generate image from prompt. "+(f||"No text explanation."));return{imageData:d,imageMimeType:h,textResponse:f}}catch(u){throw console.error("[generateImageFromPromptForPod] Error:",u.message),new Error(`Image generation for POD failed: ${u.message||"Unknown error"}`)}}async function nae(t){try{const e=await fetch(t);if(!e.ok)throw console.warn(`Direct fetch for ${t} failed with status ${e.status}. Retrying without proxy for now.`),new Error(`Failed to fetch image ${t}: ${e.statusText}`);const n=await e.blob(),r=n.type;if(!r.startsWith("image/"))throw new Error(`Fetched content from ${t} is not an image. MIME type: ${r}`);const s=await n.arrayBuffer();return{base64Data:btoa(new Uint8Array(s).reduce((o,l)=>o+String.fromCharCode(l),"")),mimeType:r}}catch(e){throw console.error(`Error in fetchImageAsBase64 for ${t}:`,e),e}}async function og(t,e,n,r,s){var o,l,c,u;if(!t||!e||!n||!r||!s)throw console.error("[visualizeImageOnProductWithGemini] Missing required parameters."),new Error("Missing required parameters for product visualization.");const i=new hr({apiKey:zu});try{console.log(`[visualizeImageOnProductWithGemini] Fetching base product image from: ${n}`);const{base64Data:d,mimeType:h}=await nae(n);console.log(`[visualizeImageOnProductWithGemini] Fetched mockup: ${h}, length: ${d.length}`);const f={inlineData:{mimeType:e,data:t}},m={inlineData:{mimeType:h,data:d}},x=[{text:`You are an expert product visualization AI.
Task: Place the first provided image (the 'design') onto the second provided image (the '${s}' mockup).
Design Details: The design was conceptualized with the idea: "${r}".
Mockup: The mockup is a '${s}'.
Instructions:
1. Realistically superimpose the design onto the mockup.
2. Ensure the design conforms to the shape and texture of the mockup.
3. Maintain the original quality and details of both the design and the mockup where appropriate.
4. Output only the final visualized product image. Do not add any extra text or explanations in the image itself.
`},f,m];console.log(`[visualizeImageOnProductWithGemini] Calling Gemini API for ${s} with prompt: "${r}"`);const E=await i.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:x,safetySettings:gc,config:{responseModalities:[Dn.TEXT,Dn.IMAGE]}});let v=null,b=null,S="";if((c=(l=(o=E.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const I of E.candidates[0].content.parts)if(I.text)S+=I.text;else if((u=I.inlineData)!=null&&u.data){v=I.inlineData.data,b=I.inlineData.mimeType;break}}if(console.log(`[visualizeImageOnProductWithGemini] API Text Response: ${S}`),!v)throw console.error("[visualizeImageOnProductWithGemini] Failed to get visualized image data from API.",S),new Error("Failed to visualize product. API did not return image data. "+(S||"No text explanation."));return console.log(`[visualizeImageOnProductWithGemini] Visualization successful for ${s}. MimeType: ${b}`),{visualizedImageData:v,visualizedImageMimeType:b,productDetails:{title:`Custom ${s} (Viz)`,price:24.99,description:`Unique ${s} featuring the design: "${r}".`},apiTextResponse:S}}catch(d){return console.error(`[visualizeImageOnProductWithGemini] Error visualizing ${s}:`,d),{visualizedImageData:null,visualizedImageMimeType:null,productDetails:{title:`Custom ${s}`,price:24.99,description:`Failed to visualize design on ${s}. Error: ${d.message}`},error:d.message}}}async function hI(t,e,n){var o,l,c,u;if(!t||!e||!n)throw new Error("Image data, MIME type, and product name required.");const r=new hr({apiKey:zu}),s=[`Show this product, "${n}", from a slightly high front-left angle. Maintain product integrity.`,`Show this product, "${n}", from a direct side view. Maintain product integrity.`,`Show this product, "${n}", from a top-down perspective. Maintain product integrity.`],i=[];try{for(const d of s){const h=[{text:d},{inlineData:{mimeType:e,data:t}}],f=await r.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:h,safetySettings:gc,config:{responseModalities:[Dn.TEXT,Dn.IMAGE]}});let m=null;if((c=(l=(o=f.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const g of f.candidates[0].content.parts)if((u=g.inlineData)!=null&&u.data){m=`data:${g.inlineData.mimeType};base64,${g.inlineData.data}`,i.push(m);break}}m||console.warn("[generateDifferentAnglesFromImage] No image data for one angle.")}if(i.length===0)throw new Error("Failed to generate any additional angle images.");return i}catch(d){throw console.error("[generateDifferentAnglesFromImage] Error:",d.message),new Error(`Generating different angles failed: ${d.message||"Unknown error"}`)}}async function bU(t,e){var s,i,o,l;if(!t)throw new Error("Collection name is required to generate an image.");const n=new hr({apiKey:zu});let r=`Generate a visually appealing banner image for an e-commerce collection named "${t}".`;e&&(r+=` The collection is described as: "${e}".`),r+=" The image should be thematic or abstract, suitable for a collection header or card. It should evoke the essence of the collection. Consider a wide aspect ratio like 16:9 or a square image if more appropriate for a card.";try{console.log(`[generateCollectionImageWithGemini] Generating image for collection: ${t}`);const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:[{role:"user",parts:[{text:r}]}],safetySettings:gc,config:{responseModalities:[Dn.TEXT,Dn.IMAGE]}});let u=null,d="image/png",h="";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const f of c.candidates[0].content.parts)if(f.text)h+=f.text;else if((l=f.inlineData)!=null&&l.data){u=f.inlineData.data,d=f.inlineData.mimeType||d;break}}if(!u)throw new Error("Failed to generate image data for the collection. "+(h||"No text explanation from AI."));return{imageData:u,imageMimeType:d,textResponse:h}}catch(c){throw console.error(`[generateCollectionImageWithGemini] Error generating image for collection "${t}":`,c),new Error(`Collection image generation failed for "${t}": ${c.message||"Unknown error"}`)}}const rae=Object.freeze(Object.defineProperty({__proto__:null,editImageWithGemini:Ql,generateCaptionForImageData:Wd,generateCollectionImageWithGemini:bU,generateDifferentAnglesFromImage:hI,generateGenericProductImageWithGemini:wU,generateImageFromPromptForPod:b0,generateLogoWithGemini:ig,visualizeImageOnProductWithGemini:og},Symbol.toStringTag,{value:"Module"})),fI="AIzaSyA6fvf0Xgb29MloJ-JKiYJGzhv_jvPdL1Y",Lv=new hr({apiKey:fI}),sae=async(t,e={})=>{var n,r,s;if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required.");console.log(`Starting video generation with prompt: "${t}"`);try{let i=await Lv.models.generateVideos({model:"veo-2.0-generate-001",prompt:t,config:{personGeneration:"dont_allow",aspectRatio:"16:9",numberOfVideos:1,durationSeconds:6,...e}});for(console.log("Video generation operation started:",i.name);!i.done;)console.log(`Polling operation ${i.name}, current status: ${((n=i.metadata)==null?void 0:n.state)||"UNKNOWN"}`),await new Promise(l=>setTimeout(l,1e4)),i=await Lv.operations.getVideosOperation({operation:i});if(console.log("Video generation operation completed:",i.name,"Done:",i.done),i.error)throw console.error("Error during video generation operation:",i.error),new Error(`Video generation failed: ${i.error.message||"Unknown error"}`);const o=(r=i.response)==null?void 0:r.generatedVideos;if(o&&o.length>0&&((s=o[0].video)!=null&&s.uri)){const c=`${o[0].video.uri}&key=${fI}`;return console.log("Generated video URI (with key appended):",c),c}else throw console.error("No video URI found in the response:",i.response),new Error("Video generation completed, but no video URI was returned.")}catch(i){throw console.error("Failed to generate video with Veo:",i),i.message&&i.message.includes("Quota")?new Error("Video generation failed due to quota limits. Please check your Google Cloud project quotas."):i.message&&i.message.includes("API key not valid")?new Error("Video generation failed due to an invalid API key. Please check your VITE_GEMINI_API_KEY."):i}},_U=async(t,e,n,r={})=>{var s,i,o;if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required.");if(!e||typeof e!="string")throw new Error("Valid base64 image data string is required.");if(!n||typeof n!="string")throw new Error("Valid image MIME type string is required.");console.log(`Starting image-to-video generation with prompt: "${t}" and image (mimeType: ${n})`);try{const l={model:"veo-2.0-generate-001",prompt:t,image:{imageBytes:e,mimeType:n},config:{personGeneration:"dont_allow",aspectRatio:"16:9",numberOfVideos:1,durationSeconds:6,...r}};console.log("Veo image-to-video payload (excluding imageBytes):",{...l,image:{mimeType:l.image.mimeType,imageBytes:"..."}});let c=await Lv.models.generateVideos(l);for(console.log("Image-to-video generation operation started:",c.name);!c.done;)console.log(`Polling operation ${c.name}, current status: ${((s=c.metadata)==null?void 0:s.state)||"UNKNOWN"}`),await new Promise(d=>setTimeout(d,1e4)),c=await Lv.operations.getVideosOperation({operation:c});if(console.log("Image-to-video generation operation completed:",c.name,"Done:",c.done),c.error)throw console.error("Error during image-to-video generation operation:",c.error),new Error(`Image-to-video generation failed: ${c.error.message||"Unknown error"}`);const u=(i=c.response)==null?void 0:i.generatedVideos;if(u&&u.length>0&&((o=u[0].video)!=null&&o.uri)){const h=`${u[0].video.uri}&key=${fI}`;return console.log("Generated image-to-video URI (with key appended):",h),h}else throw console.error("No video URI found in the image-to-video response:",c.response),new Error("Image-to-video generation completed, but no video URI was returned.")}catch(l){throw console.error("Failed to generate image-to-video with Veo:",l),l.message&&l.message.includes("Quota")?new Error("Image-to-video generation failed due to quota limits."):l.message&&l.message.includes("API key not valid")?new Error("Image-to-video generation failed due to an invalid API key."):l}},mI=p.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),_0=p.createContext({}),S0=p.createContext(null),E0=typeof document<"u",ag=E0?p.useLayoutEffect:p.useEffect,SU=p.createContext({strict:!1}),pI=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),iae="framerAppearId",EU="data-"+pI(iae);function oae(t,e,n,r){const{visualElement:s}=p.useContext(_0),i=p.useContext(SU),o=p.useContext(S0),l=p.useContext(mI).reducedMotion,c=p.useRef();r=r||i.renderer,!c.current&&r&&(c.current=r(t,{visualState:e,parent:s,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current;p.useInsertionEffect(()=>{u&&u.update(n,o)});const d=p.useRef(!!(n[EU]&&!window.HandoffComplete));return ag(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),p.useEffect(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,window.HandoffComplete=!0))}),u}function Hd(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function aae(t,e,n){return p.useCallback(r=>{r&&t.mount&&t.mount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):Hd(n)&&(n.current=r))},[e])}function _p(t){return typeof t=="string"||Array.isArray(t)}function C0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const gI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],yI=["initial",...gI];function T0(t){return C0(t.animate)||yI.some(e=>_p(t[e]))}function CU(t){return!!(T0(t)||t.variants)}function lae(t,e){if(T0(t)){const{initial:n,animate:r}=t;return{initial:n===!1||_p(n)?n:void 0,animate:_p(r)?r:void 0}}return t.inherit!==!1?e:{}}function cae(t){const{initial:e,animate:n}=lae(t,p.useContext(_0));return p.useMemo(()=>({initial:e,animate:n}),[i2(e),i2(n)])}function i2(t){return Array.isArray(t)?t.join(" "):t}const o2={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Sp={};for(const t in o2)Sp[t]={isEnabled:e=>o2[t].some(n=>!!e[n])};function uae(t){for(const e in t)Sp[e]={...Sp[e],...t[e]}}const xI=p.createContext({}),TU=p.createContext({}),dae=Symbol.for("motionComponentSymbol");function hae({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:s}){t&&uae(t);function i(l,c){let u;const d={...p.useContext(mI),...l,layoutId:fae(l)},{isStatic:h}=d,f=cae(l),m=r(l,h);if(!h&&E0){f.visualElement=oae(s,m,d,e);const g=p.useContext(TU),x=p.useContext(SU).strict;f.visualElement&&(u=f.visualElement.loadFeatures(d,x,t,g))}return p.createElement(_0.Provider,{value:f},u&&f.visualElement?p.createElement(u,{visualElement:f.visualElement,...d}):null,n(s,l,aae(m,f.visualElement,c),m,h,f.visualElement))}const o=p.forwardRef(i);return o[dae]=s,o}function fae({layoutId:t}){const e=p.useContext(xI).id;return e&&t!==void 0?e+"-"+t:t}function mae(t){function e(r,s={}){return hae(t(r,s))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(r,s)=>(n.has(s)||n.set(s,e(s)),n.get(s))})}const pae=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function vI(t){return typeof t!="string"||t.includes("-")?!1:!!(pae.indexOf(t)>-1||/[A-Z]/.test(t))}const Fv={};function gae(t){Object.assign(Fv,t)}const lg=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Gu=new Set(lg);function IU(t,{layout:e,layoutId:n}){return Gu.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Fv[t]||t==="opacity")}const ui=t=>!!(t&&t.getVelocity),yae={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},xae=lg.length;function vae(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},r,s){let i="";for(let o=0;o<xae;o++){const l=lg[o];if(t[l]!==void 0){const c=yae[l]||l;i+=`${c}(${t[l]}) `}}return e&&!t.z&&(i+="translateZ(0)"),i=i.trim(),s?i=s(t,r?"":i):n&&r&&(i="none"),i}const NU=t=>e=>typeof e=="string"&&e.startsWith(t),PU=NU("--"),oC=NU("var(--"),wae=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,bae=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Zl=(t,e,n)=>Math.min(Math.max(n,t),e),Wu={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Pm={...Wu,transform:t=>Zl(0,1,t)},Iy={...Wu,default:1},Am=t=>Math.round(t*1e5)/1e5,I0=/(-)?([\d]*\.?[\d])+/g,AU=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,_ae=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function cg(t){return typeof t=="string"}const ug=t=>({test:e=>cg(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),dl=ug("deg"),Xo=ug("%"),Dt=ug("px"),Sae=ug("vh"),Eae=ug("vw"),a2={...Xo,parse:t=>Xo.parse(t)/100,transform:t=>Xo.transform(t*100)},l2={...Wu,transform:Math.round},kU={borderWidth:Dt,borderTopWidth:Dt,borderRightWidth:Dt,borderBottomWidth:Dt,borderLeftWidth:Dt,borderRadius:Dt,radius:Dt,borderTopLeftRadius:Dt,borderTopRightRadius:Dt,borderBottomRightRadius:Dt,borderBottomLeftRadius:Dt,width:Dt,maxWidth:Dt,height:Dt,maxHeight:Dt,size:Dt,top:Dt,right:Dt,bottom:Dt,left:Dt,padding:Dt,paddingTop:Dt,paddingRight:Dt,paddingBottom:Dt,paddingLeft:Dt,margin:Dt,marginTop:Dt,marginRight:Dt,marginBottom:Dt,marginLeft:Dt,rotate:dl,rotateX:dl,rotateY:dl,rotateZ:dl,scale:Iy,scaleX:Iy,scaleY:Iy,scaleZ:Iy,skew:dl,skewX:dl,skewY:dl,distance:Dt,translateX:Dt,translateY:Dt,translateZ:Dt,x:Dt,y:Dt,z:Dt,perspective:Dt,transformPerspective:Dt,opacity:Pm,originX:a2,originY:a2,originZ:Dt,zIndex:l2,fillOpacity:Pm,strokeOpacity:Pm,numOctaves:l2};function wI(t,e,n,r){const{style:s,vars:i,transform:o,transformOrigin:l}=t;let c=!1,u=!1,d=!0;for(const h in e){const f=e[h];if(PU(h)){i[h]=f;continue}const m=kU[h],g=bae(f,m);if(Gu.has(h)){if(c=!0,o[h]=g,!d)continue;f!==(m.default||0)&&(d=!1)}else h.startsWith("origin")?(u=!0,l[h]=g):s[h]=g}if(e.transform||(c||r?s.transform=vae(t.transform,n,d,r):s.transform&&(s.transform="none")),u){const{originX:h="50%",originY:f="50%",originZ:m=0}=l;s.transformOrigin=`${h} ${f} ${m}`}}const bI=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function RU(t,e,n){for(const r in e)!ui(e[r])&&!IU(r,n)&&(t[r]=e[r])}function Cae({transformTemplate:t},e,n){return p.useMemo(()=>{const r=bI();return wI(r,e,{enableHardwareAcceleration:!n},t),Object.assign({},r.vars,r.style)},[e])}function Tae(t,e,n){const r=t.style||{},s={};return RU(s,r,t),Object.assign(s,Cae(t,e,n)),t.transformValues?t.transformValues(s):s}function Iae(t,e,n){const r={},s=Tae(t,e,n);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=s,r}const Nae=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Ov(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Nae.has(t)}let jU=t=>!Ov(t);function Pae(t){t&&(jU=e=>e.startsWith("on")?!Ov(e):t(e))}try{Pae(require("@emotion/is-prop-valid").default)}catch{}function Aae(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(jU(s)||n===!0&&Ov(s)||!e&&!Ov(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}function c2(t,e,n){return typeof t=="string"?t:Dt.transform(e+n*t)}function kae(t,e,n){const r=c2(e,t.x,t.width),s=c2(n,t.y,t.height);return`${r} ${s}`}const Rae={offset:"stroke-dashoffset",array:"stroke-dasharray"},jae={offset:"strokeDashoffset",array:"strokeDasharray"};function Dae(t,e,n=1,r=0,s=!0){t.pathLength=1;const i=s?Rae:jae;t[i.offset]=Dt.transform(-r);const o=Dt.transform(e),l=Dt.transform(n);t[i.array]=`${o} ${l}`}function _I(t,{attrX:e,attrY:n,attrScale:r,originX:s,originY:i,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...u},d,h,f){if(wI(t,u,d,f),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:g,dimensions:x}=t;m.transform&&(x&&(g.transform=m.transform),delete m.transform),x&&(s!==void 0||i!==void 0||g.transform)&&(g.transformOrigin=kae(x,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(m.x=e),n!==void 0&&(m.y=n),r!==void 0&&(m.scale=r),o!==void 0&&Dae(m,o,l,c,!1)}const DU=()=>({...bI(),attrs:{}}),SI=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Mae(t,e,n,r){const s=p.useMemo(()=>{const i=DU();return _I(i,e,{enableHardwareAcceleration:!1},SI(r),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};RU(i,t.style,t),s.style={...i,...s.style}}return s}function Lae(t=!1){return(n,r,s,{latestValues:i},o)=>{const c=(vI(n)?Mae:Iae)(r,i,o,n),d={...Aae(r,typeof n=="string",t),...c,ref:s},{children:h}=r,f=p.useMemo(()=>ui(h)?h.get():h,[h]);return p.createElement(n,{...d,children:f})}}function MU(t,{style:e,vars:n},r,s){Object.assign(t.style,e,s&&s.getProjectionStyles(r));for(const i in n)t.style.setProperty(i,n[i])}const LU=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function FU(t,e,n,r){MU(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(LU.has(s)?s:pI(s),e.attrs[s])}function EI(t,e){const{style:n}=t,r={};for(const s in n)(ui(n[s])||e.style&&ui(e.style[s])||IU(s,t))&&(r[s]=n[s]);return r}function OU(t,e){const n=EI(t,e);for(const r in t)if(ui(t[r])||ui(e[r])){const s=lg.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[s]=t[r]}return n}function CI(t,e,n,r={},s={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),e}function dg(t){const e=p.useRef(null);return e.current===null&&(e.current=t()),e.current}const $v=t=>Array.isArray(t),Fae=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),Oae=t=>$v(t)?t[t.length-1]||0:t;function Sx(t){const e=ui(t)?t.get():t;return Fae(e)?e.toValue():e}function $ae({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},r,s,i){const o={latestValues:Vae(r,s,i,t),renderState:e()};return n&&(o.mount=l=>n(r,l,o)),o}const $U=t=>(e,n)=>{const r=p.useContext(_0),s=p.useContext(S0),i=()=>$ae(t,e,r,s);return n?i():dg(i)};function Vae(t,e,n,r){const s={},i=r(t,{});for(const f in i)s[f]=Sx(i[f]);let{initial:o,animate:l}=t;const c=T0(t),u=CU(t);e&&u&&!c&&t.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let d=n?n.initial===!1:!1;d=d||o===!1;const h=d?l:o;return h&&typeof h!="boolean"&&!C0(h)&&(Array.isArray(h)?h:[h]).forEach(m=>{const g=CI(t,m);if(!g)return;const{transitionEnd:x,transition:E,...v}=g;for(const b in v){let S=v[b];if(Array.isArray(S)){const I=d?S.length-1:0;S=S[I]}S!==null&&(s[b]=S)}for(const b in x)s[b]=x[b]}),s}const yr=t=>t;class u2{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function Uae(t){let e=new u2,n=new u2,r=0,s=!1,i=!1;const o=new WeakSet,l={schedule:(c,u=!1,d=!1)=>{const h=d&&s,f=h?e:n;return u&&o.add(c),f.add(c)&&h&&s&&(r=e.order.length),c},cancel:c=>{n.remove(c),o.delete(c)},process:c=>{if(s){i=!0;return}if(s=!0,[e,n]=[n,e],n.clear(),r=e.order.length,r)for(let u=0;u<r;u++){const d=e.order[u];d(c),o.has(d)&&(l.schedule(d),t())}s=!1,i&&(i=!1,l.process(c))}};return l}const Ny=["prepare","read","update","preRender","render","postRender"],Bae=40;function zae(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=Ny.reduce((h,f)=>(h[f]=Uae(()=>n=!0),h),{}),o=h=>i[h].process(s),l=()=>{const h=performance.now();n=!1,s.delta=r?1e3/60:Math.max(Math.min(h-s.timestamp,Bae),1),s.timestamp=h,s.isProcessing=!0,Ny.forEach(o),s.isProcessing=!1,n&&e&&(r=!1,t(l))},c=()=>{n=!0,r=!0,s.isProcessing||t(l)};return{schedule:Ny.reduce((h,f)=>{const m=i[f];return h[f]=(g,x=!1,E=!1)=>(n||c(),m.schedule(g,x,E)),h},{}),cancel:h=>Ny.forEach(f=>i[f].cancel(h)),state:s,steps:i}}const{schedule:En,cancel:Eo,state:ts,steps:M_}=zae(typeof requestAnimationFrame<"u"?requestAnimationFrame:yr,!0),Gae={useVisualState:$U({scrapeMotionValuesFromProps:OU,createRenderState:DU,onMount:(t,e,{renderState:n,latestValues:r})=>{En.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),En.render(()=>{_I(n,r,{enableHardwareAcceleration:!1},SI(e.tagName),t.transformTemplate),FU(e,n)})}})},Wae={useVisualState:$U({scrapeMotionValuesFromProps:EI,createRenderState:bI})};function Hae(t,{forwardMotionProps:e=!1},n,r){return{...vI(t)?Gae:Wae,preloadedFeatures:n,useRender:Lae(e),createVisualElement:r,Component:t}}function va(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const VU=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function N0(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const qae=t=>e=>VU(e)&&t(e,N0(e));function Ca(t,e,n,r){return va(t,e,qae(n),r)}const Kae=(t,e)=>n=>e(t(n)),Fl=(...t)=>t.reduce(Kae);function UU(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const d2=UU("dragHorizontal"),h2=UU("dragVertical");function BU(t){let e=!1;if(t==="y")e=h2();else if(t==="x")e=d2();else{const n=d2(),r=h2();n&&r?e=()=>{n(),r()}:(n&&n(),r&&r())}return e}function zU(){const t=BU(!0);return t?(t(),!1):!0}class yc{constructor(e){this.isMounted=!1,this.node=e}update(){}}function f2(t,e){const n="pointer"+(e?"enter":"leave"),r="onHover"+(e?"Start":"End"),s=(i,o)=>{if(i.pointerType==="touch"||zU())return;const l=t.getProps();t.animationState&&l.whileHover&&t.animationState.setActive("whileHover",e),l[r]&&En.update(()=>l[r](i,o))};return Ca(t.current,n,s,{passive:!t.getProps()[r]})}class Yae extends yc{mount(){this.unmount=Fl(f2(this.node,!0),f2(this.node,!1))}unmount(){}}class Jae extends yc{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Fl(va(this.node.current,"focus",()=>this.onFocus()),va(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const GU=(t,e)=>e?t===e?!0:GU(t,e.parentElement):!1;function L_(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,N0(n))}class Xae extends yc{constructor(){super(...arguments),this.removeStartListeners=yr,this.removeEndListeners=yr,this.removeAccessibleListeners=yr,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const r=this.node.getProps(),i=Ca(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:d,globalTapTarget:h}=this.node.getProps();En.update(()=>{!h&&!GU(this.node.current,l.target)?d&&d(l,c):u&&u(l,c)})},{passive:!(r.onTap||r.onPointerUp)}),o=Ca(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=Fl(i,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=l=>{l.key!=="Enter"||!this.checkPressEnd()||L_("up",(c,u)=>{const{onTap:d}=this.node.getProps();d&&En.update(()=>d(c,u))})};this.removeEndListeners(),this.removeEndListeners=va(this.node.current,"keyup",o),L_("down",(l,c)=>{this.startPress(l,c)})},n=va(this.node.current,"keydown",e),r=()=>{this.isPressing&&L_("cancel",(i,o)=>this.cancelPress(i,o))},s=va(this.node.current,"blur",r);this.removeAccessibleListeners=Fl(n,s)}}startPress(e,n){this.isPressing=!0;const{onTapStart:r,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&En.update(()=>r(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!zU()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&En.update(()=>r(e,n))}mount(){const e=this.node.getProps(),n=Ca(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),r=va(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Fl(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const aC=new WeakMap,F_=new WeakMap,Qae=t=>{const e=aC.get(t.target);e&&e(t)},Zae=t=>{t.forEach(Qae)};function ele({root:t,...e}){const n=t||document;F_.has(n)||F_.set(n,{});const r=F_.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(Zae,{root:t,...e})),r[s]}function tle(t,e,n){const r=ele(e);return aC.set(t,n),r.observe(t),()=>{aC.delete(t),r.unobserve(t)}}const nle={some:0,all:1};class rle extends yc{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:nle[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:h}=this.node.getProps(),f=u?d:h;f&&f(c)};return tle(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(sle(e,n))&&this.startObserver()}unmount(){}}function sle({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const ile={inView:{Feature:rle},tap:{Feature:Xae},focus:{Feature:Jae},hover:{Feature:Yae}};function WU(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function ole(t){const e={};return t.values.forEach((n,r)=>e[r]=n.get()),e}function ale(t){const e={};return t.values.forEach((n,r)=>e[r]=n.getVelocity()),e}function P0(t,e,n){const r=t.getProps();return CI(r,e,n!==void 0?n:r.custom,ole(t),ale(t))}let HU=yr,A0=yr;const Ol=t=>t*1e3,Ta=t=>t/1e3,lle={current:!1},qU=t=>Array.isArray(t)&&typeof t[0]=="number";function KU(t){return!!(!t||typeof t=="string"&&YU[t]||qU(t)||Array.isArray(t)&&t.every(KU))}const nm=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,YU={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:nm([0,.65,.55,1]),circOut:nm([.55,0,1,.45]),backIn:nm([.31,.01,.66,-.59]),backOut:nm([.33,1.53,.69,.99])};function JU(t){if(t)return qU(t)?nm(t):Array.isArray(t)?t.map(JU):YU[t]}function cle(t,e,n,{delay:r=0,duration:s,repeat:i=0,repeatType:o="loop",ease:l,times:c}={}){const u={[e]:n};c&&(u.offset=c);const d=JU(l);return Array.isArray(d)&&(u.easing=d),t.animate(u,{delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function ule(t,{repeat:e,repeatType:n="loop"}){const r=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[r]}const XU=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,dle=1e-7,hle=12;function fle(t,e,n,r,s){let i,o,l=0;do o=e+(n-e)/2,i=XU(o,r,s)-t,i>0?n=o:e=o;while(Math.abs(i)>dle&&++l<hle);return o}function hg(t,e,n,r){if(t===e&&n===r)return yr;const s=i=>fle(i,0,1,t,n);return i=>i===0||i===1?i:XU(s(i),e,r)}const mle=hg(.42,0,1,1),ple=hg(0,0,.58,1),QU=hg(.42,0,.58,1),gle=t=>Array.isArray(t)&&typeof t[0]!="number",ZU=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,e5=t=>e=>1-t(1-e),TI=t=>1-Math.sin(Math.acos(t)),t5=e5(TI),yle=ZU(TI),n5=hg(.33,1.53,.69,.99),II=e5(n5),xle=ZU(II),vle=t=>(t*=2)<1?.5*II(t):.5*(2-Math.pow(2,-10*(t-1))),wle={linear:yr,easeIn:mle,easeInOut:QU,easeOut:ple,circIn:TI,circInOut:yle,circOut:t5,backIn:II,backInOut:xle,backOut:n5,anticipate:vle},m2=t=>{if(Array.isArray(t)){A0(t.length===4);const[e,n,r,s]=t;return hg(e,n,r,s)}else if(typeof t=="string")return wle[t];return t},NI=(t,e)=>n=>!!(cg(n)&&_ae.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),r5=(t,e,n)=>r=>{if(!cg(r))return r;const[s,i,o,l]=r.match(I0);return{[t]:parseFloat(s),[e]:parseFloat(i),[n]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},ble=t=>Zl(0,255,t),O_={...Wu,transform:t=>Math.round(ble(t))},nu={test:NI("rgb","red"),parse:r5("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+O_.transform(t)+", "+O_.transform(e)+", "+O_.transform(n)+", "+Am(Pm.transform(r))+")"};function _le(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const lC={test:NI("#"),parse:_le,transform:nu.transform},qd={test:NI("hsl","hue"),parse:r5("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Xo.transform(Am(e))+", "+Xo.transform(Am(n))+", "+Am(Pm.transform(r))+")"},Fs={test:t=>nu.test(t)||lC.test(t)||qd.test(t),parse:t=>nu.test(t)?nu.parse(t):qd.test(t)?qd.parse(t):lC.parse(t),transform:t=>cg(t)?t:t.hasOwnProperty("red")?nu.transform(t):qd.transform(t)},or=(t,e,n)=>-n*t+n*e+t;function $_(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Sle({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,i=0,o=0;if(!e)s=i=o=n;else{const l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;s=$_(c,l,t+1/3),i=$_(c,l,t),o=$_(c,l,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}const V_=(t,e,n)=>{const r=t*t;return Math.sqrt(Math.max(0,n*(e*e-r)+r))},Ele=[lC,nu,qd],Cle=t=>Ele.find(e=>e.test(t));function p2(t){const e=Cle(t);let n=e.parse(t);return e===qd&&(n=Sle(n)),n}const s5=(t,e)=>{const n=p2(t),r=p2(e),s={...n};return i=>(s.red=V_(n.red,r.red,i),s.green=V_(n.green,r.green,i),s.blue=V_(n.blue,r.blue,i),s.alpha=or(n.alpha,r.alpha,i),nu.transform(s))};function Tle(t){var e,n;return isNaN(t)&&cg(t)&&(((e=t.match(I0))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(AU))===null||n===void 0?void 0:n.length)||0)>0}const i5={regex:wae,countKey:"Vars",token:"${v}",parse:yr},o5={regex:AU,countKey:"Colors",token:"${c}",parse:Fs.parse},a5={regex:I0,countKey:"Numbers",token:"${n}",parse:Wu.parse};function U_(t,{regex:e,countKey:n,token:r,parse:s}){const i=t.tokenised.match(e);i&&(t["num"+n]=i.length,t.tokenised=t.tokenised.replace(e,r),t.values.push(...i.map(s)))}function Vv(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&U_(n,i5),U_(n,o5),U_(n,a5),n}function l5(t){return Vv(t).values}function c5(t){const{values:e,numColors:n,numVars:r,tokenised:s}=Vv(t),i=e.length;return o=>{let l=s;for(let c=0;c<i;c++)c<r?l=l.replace(i5.token,o[c]):c<r+n?l=l.replace(o5.token,Fs.transform(o[c])):l=l.replace(a5.token,Am(o[c]));return l}}const Ile=t=>typeof t=="number"?0:t;function Nle(t){const e=l5(t);return c5(t)(e.map(Ile))}const ec={test:Tle,parse:l5,createTransformer:c5,getAnimatableNone:Nle},u5=(t,e)=>n=>`${n>0?e:t}`;function d5(t,e){return typeof t=="number"?n=>or(t,e,n):Fs.test(t)?s5(t,e):t.startsWith("var(")?u5(t,e):f5(t,e)}const h5=(t,e)=>{const n=[...t],r=n.length,s=t.map((i,o)=>d5(i,e[o]));return i=>{for(let o=0;o<r;o++)n[o]=s[o](i);return n}},Ple=(t,e)=>{const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=d5(t[s],e[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}},f5=(t,e)=>{const n=ec.createTransformer(e),r=Vv(t),s=Vv(e);return r.numVars===s.numVars&&r.numColors===s.numColors&&r.numNumbers>=s.numNumbers?Fl(h5(r.values,s.values),n):u5(t,e)},kh=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},g2=(t,e)=>n=>or(t,e,n);function Ale(t){return typeof t=="number"?g2:typeof t=="string"?Fs.test(t)?s5:f5:Array.isArray(t)?h5:typeof t=="object"?Ple:g2}function kle(t,e,n){const r=[],s=n||Ale(t[0]),i=t.length-1;for(let o=0;o<i;o++){let l=s(t[o],t[o+1]);if(e){const c=Array.isArray(e)?e[o]||yr:e;l=Fl(c,l)}r.push(l)}return r}function k0(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const i=t.length;if(A0(i===e.length),i===1)return()=>e[0];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=kle(e,r,s),l=o.length,c=u=>{let d=0;if(l>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const h=kh(t[d],t[d+1],u);return o[d](h)};return n?u=>c(Zl(t[0],t[i-1],u)):c}function Rle(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=kh(0,e,r);t.push(or(n,1,s))}}function m5(t){const e=[0];return Rle(e,t.length-1),e}function jle(t,e){return t.map(n=>n*e)}function Dle(t,e){return t.map(()=>e||QU).splice(0,t.length-1)}function Uv({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=gle(r)?r.map(m2):m2(r),i={done:!1,value:e[0]},o=jle(n&&n.length===e.length?n:m5(e),t),l=k0(o,e,{ease:Array.isArray(s)?s:Dle(e,s)});return{calculatedDuration:t,next:c=>(i.value=l(c),i.done=c>=t,i)}}function PI(t,e){return e?t*(1e3/e):0}const Mle=5;function p5(t,e,n){const r=Math.max(e-Mle,0);return PI(n-t(r),e-r)}const B_=.001,Lle=.01,y2=10,Fle=.05,Ole=1;function $le({duration:t=800,bounce:e=.25,velocity:n=0,mass:r=1}){let s,i;HU(t<=Ol(y2));let o=1-e;o=Zl(Fle,Ole,o),t=Zl(Lle,y2,Ta(t)),o<1?(s=u=>{const d=u*o,h=d*t,f=d-n,m=cC(u,o),g=Math.exp(-h);return B_-f/m*g},i=u=>{const h=u*o*t,f=h*n+n,m=Math.pow(o,2)*Math.pow(u,2)*t,g=Math.exp(-h),x=cC(Math.pow(u,2),o);return(-s(u)+B_>0?-1:1)*((f-m)*g)/x}):(s=u=>{const d=Math.exp(-u*t),h=(u-n)*t+1;return-B_+d*h},i=u=>{const d=Math.exp(-u*t),h=(n-u)*(t*t);return d*h});const l=5/t,c=Ule(s,i,l);if(t=Ol(t),isNaN(c))return{stiffness:100,damping:10,duration:t};{const u=Math.pow(c,2)*r;return{stiffness:u,damping:o*2*Math.sqrt(r*u),duration:t}}}const Vle=12;function Ule(t,e,n){let r=n;for(let s=1;s<Vle;s++)r=r-t(r)/e(r);return r}function cC(t,e){return t*Math.sqrt(1-e*e)}const Ble=["duration","bounce"],zle=["stiffness","damping","mass"];function x2(t,e){return e.some(n=>t[n]!==void 0)}function Gle(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!x2(t,zle)&&x2(t,Ble)){const n=$le(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function g5({keyframes:t,restDelta:e,restSpeed:n,...r}){const s=t[0],i=t[t.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:f}=Gle({...r,velocity:-Ta(r.velocity||0)}),m=h||0,g=c/(2*Math.sqrt(l*u)),x=i-s,E=Ta(Math.sqrt(l/u)),v=Math.abs(x)<5;n||(n=v?.01:2),e||(e=v?.005:.5);let b;if(g<1){const S=cC(E,g);b=I=>{const D=Math.exp(-g*E*I);return i-D*((m+g*E*x)/S*Math.sin(S*I)+x*Math.cos(S*I))}}else if(g===1)b=S=>i-Math.exp(-E*S)*(x+(m+E*x)*S);else{const S=E*Math.sqrt(g*g-1);b=I=>{const D=Math.exp(-g*E*I),k=Math.min(S*I,300);return i-D*((m+g*E*x)*Math.sinh(k)+S*x*Math.cosh(k))/S}}return{calculatedDuration:f&&d||null,next:S=>{const I=b(S);if(f)o.done=S>=d;else{let D=m;S!==0&&(g<1?D=p5(b,S,I):D=0);const k=Math.abs(D)<=n,C=Math.abs(i-I)<=e;o.done=k&&C}return o.value=o.done?i:I,o}}}function v2({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:c,restDelta:u=.5,restSpeed:d}){const h=t[0],f={done:!1,value:h},m=T=>l!==void 0&&T<l||c!==void 0&&T>c,g=T=>l===void 0?c:c===void 0||Math.abs(l-T)<Math.abs(c-T)?l:c;let x=n*e;const E=h+x,v=o===void 0?E:o(E);v!==E&&(x=v-h);const b=T=>-x*Math.exp(-T/r),S=T=>v+b(T),I=T=>{const P=b(T),A=S(T);f.done=Math.abs(P)<=u,f.value=f.done?v:A};let D,k;const C=T=>{m(f.value)&&(D=T,k=g5({keyframes:[f.value,g(f.value)],velocity:p5(S,T,f.value),damping:s,stiffness:i,restDelta:u,restSpeed:d}))};return C(0),{calculatedDuration:null,next:T=>{let P=!1;return!k&&D===void 0&&(P=!0,I(T),C(T)),D!==void 0&&T>D?k.next(T-D):(!P&&I(T),f)}}}const Wle=t=>{const e=({timestamp:n})=>t(n);return{start:()=>En.update(e,!0),stop:()=>Eo(e),now:()=>ts.isProcessing?ts.timestamp:performance.now()}},w2=2e4;function b2(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<w2;)e+=n,r=t.next(e);return e>=w2?1/0:e}const Hle={decay:v2,inertia:v2,tween:Uv,keyframes:Uv,spring:g5};function Bv({autoplay:t=!0,delay:e=0,driver:n=Wle,keyframes:r,type:s="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:l="loop",onPlay:c,onStop:u,onComplete:d,onUpdate:h,...f}){let m=1,g=!1,x,E;const v=()=>{E=new Promise(V=>{x=V})};v();let b;const S=Hle[s]||Uv;let I;S!==Uv&&typeof r[0]!="number"&&(I=k0([0,100],r,{clamp:!1}),r=[0,100]);const D=S({...f,keyframes:r});let k;l==="mirror"&&(k=S({...f,keyframes:[...r].reverse(),velocity:-(f.velocity||0)}));let C="idle",T=null,P=null,A=null;D.calculatedDuration===null&&i&&(D.calculatedDuration=b2(D));const{calculatedDuration:R}=D;let M=1/0,j=1/0;R!==null&&(M=R+o,j=M*(i+1)-o);let z=0;const W=V=>{if(P===null)return;m>0&&(P=Math.min(P,V)),m<0&&(P=Math.min(V-j/m,P)),T!==null?z=T:z=Math.round(V-P)*m;const G=z-e*(m>=0?1:-1),F=m>=0?G<0:G>j;z=Math.max(G,0),C==="finished"&&T===null&&(z=j);let ue=z,Ee=D;if(i){const Ze=Math.min(z,j)/M;let ze=Math.floor(Ze),nt=Ze%1;!nt&&Ze>=1&&(nt=1),nt===1&&ze--,ze=Math.min(ze,i+1),!!(ze%2)&&(l==="reverse"?(nt=1-nt,o&&(nt-=o/M)):l==="mirror"&&(Ee=k)),ue=Zl(0,1,nt)*M}const Se=F?{done:!1,value:r[0]}:Ee.next(ue);I&&(Se.value=I(Se.value));let{done:we}=Se;!F&&R!==null&&(we=m>=0?z>=j:z<=0);const Fe=T===null&&(C==="finished"||C==="running"&&we);return h&&h(Se.value),Fe&&$(),Se},q=()=>{b&&b.stop(),b=void 0},H=()=>{C="idle",q(),x(),v(),P=A=null},$=()=>{C="finished",d&&d(),q(),x()},J=()=>{if(g)return;b||(b=n(W));const V=b.now();c&&c(),T!==null?P=V-T:(!P||C==="finished")&&(P=V),C==="finished"&&v(),A=P,T=null,C="running",b.start()};t&&J();const O={then(V,G){return E.then(V,G)},get time(){return Ta(z)},set time(V){V=Ol(V),z=V,T!==null||!b||m===0?T=V:P=b.now()-V/m},get duration(){const V=D.calculatedDuration===null?b2(D):D.calculatedDuration;return Ta(V)},get speed(){return m},set speed(V){V===m||!b||(m=V,O.time=Ta(z))},get state(){return C},play:J,pause:()=>{C="paused",T=z},stop:()=>{g=!0,C!=="idle"&&(C="idle",u&&u(),H())},cancel:()=>{A!==null&&W(A),H()},complete:()=>{C="finished"},sample:V=>(P=0,W(V))};return O}function qle(t){let e;return()=>(e===void 0&&(e=t()),e)}const Kle=qle(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Yle=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Py=10,Jle=2e4,Xle=(t,e)=>e.type==="spring"||t==="backgroundColor"||!KU(e.ease);function Qle(t,e,{onUpdate:n,onComplete:r,...s}){if(!(Kle()&&Yle.has(e)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let o=!1,l,c,u=!1;const d=()=>{c=new Promise(S=>{l=S})};d();let{keyframes:h,duration:f=300,ease:m,times:g}=s;if(Xle(e,s)){const S=Bv({...s,repeat:0,delay:0});let I={done:!1,value:h[0]};const D=[];let k=0;for(;!I.done&&k<Jle;)I=S.sample(k),D.push(I.value),k+=Py;g=void 0,h=D,f=k-Py,m="linear"}const x=cle(t.owner.current,e,h,{...s,duration:f,ease:m,times:g}),E=()=>{u=!1,x.cancel()},v=()=>{u=!0,En.update(E),l(),d()};return x.onfinish=()=>{u||(t.set(ule(h,s)),r&&r(),v())},{then(S,I){return c.then(S,I)},attachTimeline(S){return x.timeline=S,x.onfinish=null,yr},get time(){return Ta(x.currentTime||0)},set time(S){x.currentTime=Ol(S)},get speed(){return x.playbackRate},set speed(S){x.playbackRate=S},get duration(){return Ta(f)},play:()=>{o||(x.play(),Eo(E))},pause:()=>x.pause(),stop:()=>{if(o=!0,x.playState==="idle")return;const{currentTime:S}=x;if(S){const I=Bv({...s,autoplay:!1});t.setWithVelocity(I.sample(S-Py).value,I.sample(S).value,Py)}v()},complete:()=>{u||x.finish()},cancel:v}}function Zle({keyframes:t,delay:e,onUpdate:n,onComplete:r}){const s=()=>(n&&n(t[t.length-1]),r&&r(),{time:0,speed:1,duration:0,play:yr,pause:yr,stop:yr,then:i=>(i(),Promise.resolve()),cancel:yr,complete:yr});return e?Bv({keyframes:[0,1],duration:0,delay:e,onComplete:s}):s()}const ece={type:"spring",stiffness:500,damping:25,restSpeed:10},tce=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),nce={type:"keyframes",duration:.8},rce={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},sce=(t,{keyframes:e})=>e.length>2?nce:Gu.has(t)?t.startsWith("scale")?tce(e[1]):ece:rce,uC=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(ec.test(e)||e==="0")&&!e.startsWith("url(")),ice=new Set(["brightness","contrast","saturate","opacity"]);function oce(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(I0)||[];if(!r)return t;const s=n.replace(r,"");let i=ice.has(e)?1:0;return r!==n&&(i*=100),e+"("+i+s+")"}const ace=/([a-z-]*)\(.*?\)/g,dC={...ec,getAnimatableNone:t=>{const e=t.match(ace);return e?e.map(oce).join(" "):t}},lce={...kU,color:Fs,backgroundColor:Fs,outlineColor:Fs,fill:Fs,stroke:Fs,borderColor:Fs,borderTopColor:Fs,borderRightColor:Fs,borderBottomColor:Fs,borderLeftColor:Fs,filter:dC,WebkitFilter:dC},AI=t=>lce[t];function y5(t,e){let n=AI(t);return n!==dC&&(n=ec),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const x5=t=>/^0[^.\s]+$/.test(t);function cce(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||x5(t)}function uce(t,e,n,r){const s=uC(e,n);let i;Array.isArray(n)?i=[...n]:i=[null,n];const o=r.from!==void 0?r.from:t.get();let l;const c=[];for(let u=0;u<i.length;u++)i[u]===null&&(i[u]=u===0?o:i[u-1]),cce(i[u])&&c.push(u),typeof i[u]=="string"&&i[u]!=="none"&&i[u]!=="0"&&(l=i[u]);if(s&&c.length&&l)for(let u=0;u<c.length;u++){const d=c[u];i[d]=y5(e,l)}return i}function dce({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}function kI(t,e){return t[e]||t.default||t}const hce={skipAnimations:!1},RI=(t,e,n,r={})=>s=>{const i=kI(r,t)||{},o=i.delay||r.delay||0;let{elapsed:l=0}=r;l=l-Ol(o);const c=uce(e,t,n,i),u=c[0],d=c[c.length-1],h=uC(t,u),f=uC(t,d);let m={keyframes:c,velocity:e.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:g=>{e.set(g),i.onUpdate&&i.onUpdate(g)},onComplete:()=>{s(),i.onComplete&&i.onComplete()}};if(dce(i)||(m={...m,...sce(t,m)}),m.duration&&(m.duration=Ol(m.duration)),m.repeatDelay&&(m.repeatDelay=Ol(m.repeatDelay)),!h||!f||lle.current||i.type===!1||hce.skipAnimations)return Zle(m);if(!r.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const g=Qle(e,t,m);if(g)return g}return Bv(m)};function zv(t){return!!(ui(t)&&t.add)}const v5=t=>/^\-?\d*\.?\d+$/.test(t);function jI(t,e){t.indexOf(e)===-1&&t.push(e)}function DI(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class MI{constructor(){this.subscriptions=[]}add(e){return jI(this.subscriptions,e),()=>DI(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const fce=t=>!isNaN(parseFloat(t)),km={current:void 0};class mce{constructor(e,n={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(r,s=!0)=>{this.prev=this.current,this.current=r;const{delta:i,timestamp:o}=ts;this.lastUpdated!==o&&(this.timeDelta=i,this.lastUpdated=o,En.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>En.postRender(this.velocityCheck),this.velocityCheck=({timestamp:r})=>{r!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=fce(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new MI);const r=this.events[e].add(n);return e==="change"?()=>{r(),En.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=e,this.timeDelta=r}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return km.current&&km.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?PI(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function yo(t,e){return new mce(t,e)}const w5=t=>e=>e.test(t),pce={test:t=>t==="auto",parse:t=>t},b5=[Wu,Dt,Xo,dl,Eae,Sae,pce],Lf=t=>b5.find(w5(t)),gce=[...b5,Fs,ec],yce=t=>gce.find(w5(t));function xce(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,yo(n))}function vce(t,e){const n=P0(t,e);let{transitionEnd:r={},transition:s={},...i}=n?t.makeTargetAnimatable(n,!1):{};i={...i,...r};for(const o in i){const l=Oae(i[o]);xce(t,o,l)}}function wce(t,e,n){var r,s;const i=Object.keys(e).filter(l=>!t.hasValue(l)),o=i.length;if(o)for(let l=0;l<o;l++){const c=i[l],u=e[c];let d=null;Array.isArray(u)&&(d=u[0]),d===null&&(d=(s=(r=n[c])!==null&&r!==void 0?r:t.readValue(c))!==null&&s!==void 0?s:e[c]),d!=null&&(typeof d=="string"&&(v5(d)||x5(d))?d=parseFloat(d):!yce(d)&&ec.test(u)&&(d=y5(c,u)),t.addValue(c,yo(d,{owner:t})),n[c]===void 0&&(n[c]=d),d!==null&&t.setBaseTarget(c,d))}}function bce(t,e){return e?(e[t]||e.default||e).from:void 0}function _ce(t,e,n){const r={};for(const s in t){const i=bce(s,e);if(i!==void 0)r[s]=i;else{const o=n.getValue(s);o&&(r[s]=o.get())}}return r}function Sce({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function Ece(t,e){const n=t.get();if(Array.isArray(e)){for(let r=0;r<e.length;r++)if(e[r]!==n)return!0}else return n!==e}function _5(t,e,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...l}=t.makeTargetAnimatable(e);const c=t.getValue("willChange");r&&(i=r);const u=[],d=s&&t.animationState&&t.animationState.getState()[s];for(const h in l){const f=t.getValue(h),m=l[h];if(!f||m===void 0||d&&Sce(d,h))continue;const g={delay:n,elapsed:0,...kI(i||{},h)};if(window.HandoffAppearAnimations){const v=t.getProps()[EU];if(v){const b=window.HandoffAppearAnimations(v,h,f,En);b!==null&&(g.elapsed=b,g.isHandoff=!0)}}let x=!g.isHandoff&&!Ece(f,m);if(g.type==="spring"&&(f.getVelocity()||g.velocity)&&(x=!1),f.animation&&(x=!1),x)continue;f.start(RI(h,f,m,t.shouldReduceMotion&&Gu.has(h)?{type:!1}:g));const E=f.animation;zv(c)&&(c.add(h),E.then(()=>c.remove(h))),u.push(E)}return o&&Promise.all(u).then(()=>{o&&vce(t,o)}),u}function hC(t,e,n={}){const r=P0(t,e,n.custom);let{transition:s=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(_5(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return Cce(t,e,u+c,d,h,n)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(n.delay)])}function Cce(t,e,n=0,r=0,s=1,i){const o=[],l=(t.variantChildren.size-1)*r,c=s===1?(u=0)=>u*r:(u=0)=>l-u*r;return Array.from(t.variantChildren).sort(Tce).forEach((u,d)=>{u.notify("AnimationStart",e),o.push(hC(u,e,{...i,delay:n+c(d)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(o)}function Tce(t,e){return t.sortNodePosition(e)}function Ice(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>hC(t,i,n));r=Promise.all(s)}else if(typeof e=="string")r=hC(t,e,n);else{const s=typeof e=="function"?P0(t,e,n.custom):e;r=Promise.all(_5(t,s,n))}return r.then(()=>t.notify("AnimationComplete",e))}const Nce=[...gI].reverse(),Pce=gI.length;function Ace(t){return e=>Promise.all(e.map(({animation:n,options:r})=>Ice(t,n,r)))}function kce(t){let e=Ace(t);const n=jce();let r=!0;const s=(c,u)=>{const d=P0(t,u);if(d){const{transition:h,transitionEnd:f,...m}=d;c={...c,...m,...f}}return c};function i(c){e=c(t)}function o(c,u){const d=t.getProps(),h=t.getVariantContext(!0)||{},f=[],m=new Set;let g={},x=1/0;for(let v=0;v<Pce;v++){const b=Nce[v],S=n[b],I=d[b]!==void 0?d[b]:h[b],D=_p(I),k=b===u?S.isActive:null;k===!1&&(x=v);let C=I===h[b]&&I!==d[b]&&D;if(C&&r&&t.manuallyAnimateOnMount&&(C=!1),S.protectedKeys={...g},!S.isActive&&k===null||!I&&!S.prevProp||C0(I)||typeof I=="boolean")continue;let P=Rce(S.prevProp,I)||b===u&&S.isActive&&!C&&D||v>x&&D,A=!1;const R=Array.isArray(I)?I:[I];let M=R.reduce(s,{});k===!1&&(M={});const{prevResolvedValues:j={}}=S,z={...j,...M},W=q=>{P=!0,m.has(q)&&(A=!0,m.delete(q)),S.needsAnimating[q]=!0};for(const q in z){const H=M[q],$=j[q];if(g.hasOwnProperty(q))continue;let J=!1;$v(H)&&$v($)?J=!WU(H,$):J=H!==$,J?H!==void 0?W(q):m.add(q):H!==void 0&&m.has(q)?W(q):S.protectedKeys[q]=!0}S.prevProp=I,S.prevResolvedValues=M,S.isActive&&(g={...g,...M}),r&&t.blockInitialAnimation&&(P=!1),P&&(!C||A)&&f.push(...R.map(q=>({animation:q,options:{type:b,...c}})))}if(m.size){const v={};m.forEach(b=>{const S=t.getBaseTarget(b);S!==void 0&&(v[b]=S)}),f.push({animation:v})}let E=!!f.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(E=!1),r=!1,E?e(f):Promise.resolve()}function l(c,u,d){var h;if(n[c].isActive===u)return Promise.resolve();(h=t.variantChildren)===null||h===void 0||h.forEach(m=>{var g;return(g=m.animationState)===null||g===void 0?void 0:g.setActive(c,u)}),n[c].isActive=u;const f=o(d,c);for(const m in n)n[m].protectedKeys={};return f}return{animateChanges:o,setActive:l,setAnimateFunction:i,getState:()=>n}}function Rce(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!WU(e,t):!1}function Pc(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function jce(){return{animate:Pc(!0),whileInView:Pc(),whileHover:Pc(),whileTap:Pc(),whileDrag:Pc(),whileFocus:Pc(),exit:Pc()}}class Dce extends yc{constructor(e){super(e),e.animationState||(e.animationState=kce(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),C0(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let Mce=0;class Lce extends yc{constructor(){super(...arguments),this.id=Mce++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e,{custom:r??this.node.getProps().custom});n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Fce={animation:{Feature:Dce},exit:{Feature:Lce}},_2=(t,e)=>Math.abs(t-e);function Oce(t,e){const n=_2(t.x,e.x),r=_2(t.y,e.y);return Math.sqrt(n**2+r**2)}class S5{constructor(e,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=G_(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,m=Oce(h.offset,{x:0,y:0})>=3;if(!f&&!m)return;const{point:g}=h,{timestamp:x}=ts;this.history.push({...g,timestamp:x});const{onStart:E,onMove:v}=this.handlers;f||(E&&E(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=z_(f,this.transformPagePoint),En.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:m,onSessionEnd:g,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=G_(h.type==="pointercancel"?this.lastMoveEventInfo:z_(f,this.transformPagePoint),this.history);this.startEvent&&m&&m(h,E),g&&g(h,E)},!VU(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const o=N0(e),l=z_(o,this.transformPagePoint),{point:c}=l,{timestamp:u}=ts;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=n;d&&d(e,G_(l,this.history)),this.removeListeners=Fl(Ca(this.contextWindow,"pointermove",this.handlePointerMove),Ca(this.contextWindow,"pointerup",this.handlePointerUp),Ca(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Eo(this.updatePoint)}}function z_(t,e){return e?{point:e(t.point)}:t}function S2(t,e){return{x:t.x-e.x,y:t.y-e.y}}function G_({point:t},e){return{point:t,delta:S2(t,E5(e)),offset:S2(t,$ce(e)),velocity:Vce(e,.1)}}function $ce(t){return t[0]}function E5(t){return t[t.length-1]}function Vce(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=E5(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>Ol(e)));)n--;if(!r)return{x:0,y:0};const i=Ta(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Ri(t){return t.max-t.min}function fC(t,e=0,n=.01){return Math.abs(t-e)<=n}function E2(t,e,n,r=.5){t.origin=r,t.originPoint=or(e.min,e.max,t.origin),t.scale=Ri(n)/Ri(e),(fC(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=or(n.min,n.max,t.origin)-t.originPoint,(fC(t.translate)||isNaN(t.translate))&&(t.translate=0)}function Rm(t,e,n,r){E2(t.x,e.x,n.x,r?r.originX:void 0),E2(t.y,e.y,n.y,r?r.originY:void 0)}function C2(t,e,n){t.min=n.min+e.min,t.max=t.min+Ri(e)}function Uce(t,e,n){C2(t.x,e.x,n.x),C2(t.y,e.y,n.y)}function T2(t,e,n){t.min=e.min-n.min,t.max=t.min+Ri(e)}function jm(t,e,n){T2(t.x,e.x,n.x),T2(t.y,e.y,n.y)}function Bce(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?or(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?or(n,t,r.max):Math.min(t,n)),t}function I2(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function zce(t,{top:e,left:n,bottom:r,right:s}){return{x:I2(t.x,n,s),y:I2(t.y,e,r)}}function N2(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function Gce(t,e){return{x:N2(t.x,e.x),y:N2(t.y,e.y)}}function Wce(t,e){let n=.5;const r=Ri(t),s=Ri(e);return s>r?n=kh(e.min,e.max-r,t.min):r>s&&(n=kh(t.min,t.max-s,e.min)),Zl(0,1,n)}function Hce(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const mC=.35;function qce(t=mC){return t===!1?t=0:t===!0&&(t=mC),{x:P2(t,"left","right"),y:P2(t,"top","bottom")}}function P2(t,e,n){return{min:A2(t,e),max:A2(t,n)}}function A2(t,e){return typeof t=="number"?t:t[e]||0}const k2=()=>({translate:0,scale:1,origin:0,originPoint:0}),Kd=()=>({x:k2(),y:k2()}),R2=()=>({min:0,max:0}),Pr=()=>({x:R2(),y:R2()});function $i(t){return[t("x"),t("y")]}function C5({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function Kce({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Yce(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function W_(t){return t===void 0||t===1}function pC({scale:t,scaleX:e,scaleY:n}){return!W_(t)||!W_(e)||!W_(n)}function Dc(t){return pC(t)||T5(t)||t.z||t.rotate||t.rotateX||t.rotateY}function T5(t){return j2(t.x)||j2(t.y)}function j2(t){return t&&t!=="0%"}function Gv(t,e,n){const r=t-n,s=e*r;return n+s}function D2(t,e,n,r,s){return s!==void 0&&(t=Gv(t,s,r)),Gv(t,n,r)+e}function gC(t,e=0,n=1,r,s){t.min=D2(t.min,e,n,r,s),t.max=D2(t.max,e,n,r,s)}function I5(t,{x:e,y:n}){gC(t.x,e.translate,e.scale,e.originPoint),gC(t.y,n.translate,n.scale,n.originPoint)}function Jce(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let i,o;for(let l=0;l<s;l++){i=n[l],o=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Yd(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,I5(t,o)),r&&Dc(i.latestValues)&&Yd(t,i.latestValues))}e.x=M2(e.x),e.y=M2(e.y)}function M2(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function gl(t,e){t.min=t.min+e,t.max=t.max+e}function L2(t,e,[n,r,s]){const i=e[s]!==void 0?e[s]:.5,o=or(t.min,t.max,i);gC(t,e[n],e[r],o,e.scale)}const Xce=["x","scaleX","originX"],Qce=["y","scaleY","originY"];function Yd(t,e){L2(t.x,e,Xce),L2(t.y,e,Qce)}function N5(t,e){return C5(Yce(t.getBoundingClientRect(),e))}function Zce(t,e,n){const r=N5(t,n),{scroll:s}=e;return s&&(gl(r.x,s.offset.x),gl(r.y,s.offset.y)),r}const P5=({current:t})=>t?t.ownerDocument.defaultView:null,eue=new WeakMap;class tue{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Pr(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(N0(d,"page").point)},i=(d,h)=>{const{drag:f,dragPropagation:m,onDragStart:g}=this.getProps();if(f&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=BU(f),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),$i(E=>{let v=this.getAxisMotionValue(E).get()||0;if(Xo.test(v)){const{projection:b}=this.visualElement;if(b&&b.layout){const S=b.layout.layoutBox[E];S&&(v=Ri(S)*(parseFloat(v)/100))}}this.originPoint[E]=v}),g&&En.update(()=>g(d,h),!1,!0);const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(d,h)=>{const{dragPropagation:f,dragDirectionLock:m,onDirectionLock:g,onDrag:x}=this.getProps();if(!f&&!this.openGlobalLock)return;const{offset:E}=h;if(m&&this.currentDirection===null){this.currentDirection=nue(E),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",h.point,E),this.updateAxis("y",h.point,E),this.visualElement.render(),x&&x(d,h)},l=(d,h)=>this.stop(d,h),c=()=>$i(d=>{var h;return this.getAnimationState(d)==="paused"&&((h=this.getAxisMotionValue(d).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new S5(e,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:P5(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&En.update(()=>i(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!Ay(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=Bce(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&Hd(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=zce(s.layoutBox,n):this.constraints=!1,this.elastic=qce(r),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&$i(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=Hce(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Hd(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=Zce(r,s.root,this.visualElement.getTransformPagePoint());let o=Gce(s.layout.layoutBox,i);if(n){const l=n(Kce(o));this.hasMutatedConstraints=!!l,l&&(o=C5(l))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=$i(d=>{if(!Ay(d,n,this.currentDirection))return;let h=c&&c[d]||{};o&&(h={min:0,max:0});const f=s?200:1e6,m=s?40:1e7,g={type:"inertia",velocity:r?e[d]:0,bounceStiffness:f,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(d,g)});return Promise.all(u).then(l)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return r.start(RI(e,r,0,n))}stopAnimation(){$i(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){$i(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){$i(n=>{const{drag:r}=this.getProps();if(!Ay(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[n];i.set(e[n]-or(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Hd(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};$i(o=>{const l=this.getAxisMotionValue(o);if(l){const c=l.get();s[o]=Wce({min:c,max:c},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),$i(o=>{if(!Ay(o,e,null))return;const l=this.getAxisMotionValue(o),{min:c,max:u}=this.constraints[o];l.set(or(c,u,s[o]))})}addListeners(){if(!this.visualElement.current)return;eue.set(this.visualElement,this);const e=this.visualElement.current,n=Ca(e,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),r=()=>{const{dragConstraints:c}=this.getProps();Hd(c)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),r();const o=va(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&($i(d=>{const h=this.getAxisMotionValue(d);h&&(this.originPoint[d]+=c[d].translate,h.set(h.get()+c[d].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=mC,dragMomentum:l=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:l}}}function Ay(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function nue(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class rue extends yc{constructor(e){super(e),this.removeGroupControls=yr,this.removeListeners=yr,this.controls=new tue(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||yr}unmount(){this.removeGroupControls(),this.removeListeners()}}const F2=t=>(e,n)=>{t&&En.update(()=>t(e,n))};class sue extends yc{constructor(){super(...arguments),this.removePointerDownListener=yr}onPointerDown(e){this.session=new S5(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:P5(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:F2(e),onStart:F2(n),onMove:r,onEnd:(i,o)=>{delete this.session,s&&En.update(()=>s(i,o))}}}mount(){this.removePointerDownListener=Ca(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function iue(){const t=p.useContext(S0);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:r}=t,s=p.useId();return p.useEffect(()=>r(s),[]),!e&&n?[!1,()=>n&&n(s)]:[!0]}const Ex={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function O2(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Ff={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Dt.test(t))t=parseFloat(t);else return t;const n=O2(t,e.target.x),r=O2(t,e.target.y);return`${n}% ${r}%`}},oue={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=ec.parse(t);if(s.length>5)return r;const i=ec.createTransformer(t),o=typeof s[0]!="number"?1:0,l=n.x.scale*e.x,c=n.y.scale*e.y;s[0+o]/=l,s[1+o]/=c;const u=or(l,c,.5);return typeof s[2+o]=="number"&&(s[2+o]/=u),typeof s[3+o]=="number"&&(s[3+o]/=u),i(s)}};class aue extends ht.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;gae(lue),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Ex.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,o=r.projection;return o&&(o.isPresent=i,s||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||En.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function A5(t){const[e,n]=iue(),r=p.useContext(xI);return ht.createElement(aue,{...t,layoutGroup:r,switchLayoutGroup:p.useContext(TU),isPresent:e,safeToRemove:n})}const lue={borderRadius:{...Ff,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ff,borderTopRightRadius:Ff,borderBottomLeftRadius:Ff,borderBottomRightRadius:Ff,boxShadow:oue},k5=["TopLeft","TopRight","BottomLeft","BottomRight"],cue=k5.length,$2=t=>typeof t=="string"?parseFloat(t):t,V2=t=>typeof t=="number"||Dt.test(t);function uue(t,e,n,r,s,i){s?(t.opacity=or(0,n.opacity!==void 0?n.opacity:1,due(r)),t.opacityExit=or(e.opacity!==void 0?e.opacity:1,0,hue(r))):i&&(t.opacity=or(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<cue;o++){const l=`border${k5[o]}Radius`;let c=U2(e,l),u=U2(n,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||V2(c)===V2(u)?(t[l]=Math.max(or($2(c),$2(u),r),0),(Xo.test(u)||Xo.test(c))&&(t[l]+="%")):t[l]=u}(e.rotate||n.rotate)&&(t.rotate=or(e.rotate||0,n.rotate||0,r))}function U2(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const due=R5(0,.5,t5),hue=R5(.5,.95,yr);function R5(t,e,n){return r=>r<t?0:r>e?1:n(kh(t,e,r))}function B2(t,e){t.min=e.min,t.max=e.max}function Oi(t,e){B2(t.x,e.x),B2(t.y,e.y)}function z2(t,e,n,r,s){return t-=e,t=Gv(t,1/n,r),s!==void 0&&(t=Gv(t,1/s,r)),t}function fue(t,e=0,n=1,r=.5,s,i=t,o=t){if(Xo.test(e)&&(e=parseFloat(e),e=or(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=or(i.min,i.max,r);t===i&&(l-=e),t.min=z2(t.min,e,n,l,s),t.max=z2(t.max,e,n,l,s)}function G2(t,e,[n,r,s],i,o){fue(t,e[n],e[r],e[s],e.scale,i,o)}const mue=["x","scaleX","originX"],pue=["y","scaleY","originY"];function W2(t,e,n,r){G2(t.x,e,mue,n?n.x:void 0,r?r.x:void 0),G2(t.y,e,pue,n?n.y:void 0,r?r.y:void 0)}function H2(t){return t.translate===0&&t.scale===1}function j5(t){return H2(t.x)&&H2(t.y)}function gue(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function D5(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function q2(t){return Ri(t.x)/Ri(t.y)}class yue{constructor(){this.members=[]}add(e){jI(this.members,e),e.scheduleRender()}remove(e){if(DI(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function K2(t,e,n){let r="";const s=t.x.translate/e.x,i=t.y.translate/e.y;if((s||i)&&(r=`translate3d(${s}px, ${i}px, 0) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:c,rotateX:u,rotateY:d}=n;c&&(r+=`rotate(${c}deg) `),u&&(r+=`rotateX(${u}deg) `),d&&(r+=`rotateY(${d}deg) `)}const o=t.x.scale*e.x,l=t.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const xue=(t,e)=>t.depth-e.depth;class vue{constructor(){this.children=[],this.isDirty=!1}add(e){jI(this.children,e),this.isDirty=!0}remove(e){DI(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(xue),this.isDirty=!1,this.children.forEach(e)}}function wue(t,e){const n=performance.now(),r=({timestamp:s})=>{const i=s-n;i>=e&&(Eo(r),t(i-e))};return En.read(r,!0),()=>Eo(r)}function bue(t){window.MotionDebug&&window.MotionDebug.record(t)}function _ue(t){return t instanceof SVGElement&&t.tagName!=="svg"}function Sue(t,e,n){const r=ui(t)?t:yo(t);return r.start(RI("",r,e,n)),r.animation}const Y2=["","X","Y","Z"],Eue={visibility:"hidden"},J2=1e3;let Cue=0;const Mc={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function M5({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(o={},l=e==null?void 0:e()){this.id=Cue++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Mc.totalNodes=Mc.resolvedTargetDeltas=Mc.recalculatedProjection=0,this.nodes.forEach(Nue),this.nodes.forEach(jue),this.nodes.forEach(Due),this.nodes.forEach(Pue),bue(Mc)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new vue)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new MI),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=_ue(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(u||c)&&(this.isLayoutDirty=!0),t){let h;const f=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=wue(f,250),Ex.hasAnimatedSinceResize&&(Ex.hasAnimatedSinceResize=!1,this.nodes.forEach(Q2))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeTargetChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||d.getDefaultTransition()||$ue,{onLayoutAnimationStart:E,onLayoutAnimationComplete:v}=d.getProps(),b=!this.targetLayout||!D5(this.targetLayout,g)||m,S=!f&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||S||f&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,S);const I={...kI(x,"layout"),onPlay:E,onComplete:v};(d.shouldReduceMotion||this.options.layoutRoot)&&(I.delay=0,I.type=!1),this.startAnimation(I)}else f||Q2(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Eo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Mue),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const h=this.path[d];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(X2);return}this.isUpdating||this.nodes.forEach(kue),this.isUpdating=!1,this.nodes.forEach(Rue),this.nodes.forEach(Tue),this.nodes.forEach(Iue),this.clearAllSnapshots();const l=performance.now();ts.delta=Zl(0,1e3/60,l-ts.timestamp),ts.timestamp=l,ts.isProcessing=!0,M_.update.process(ts),M_.preRender.process(ts),M_.render.process(ts),ts.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Aue),this.sharedNodes.forEach(Lue)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,En.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){En.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Pr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:r(this.instance),offset:n(this.instance)})}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!j5(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;o&&(l||Dc(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),Vue(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Pr();const l=o.measureViewportBox(),{scroll:c}=this.root;return c&&(gl(l.x,c.offset.x),gl(l.y,c.offset.y)),l}removeElementScroll(o){const l=Pr();Oi(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;if(u!==this.root&&d&&h.layoutScroll){if(d.isRoot){Oi(l,o);const{scroll:f}=this.root;f&&(gl(l.x,-f.offset.x),gl(l.y,-f.offset.y))}gl(l.x,d.offset.x),gl(l.y,d.offset.y)}}return l}applyTransform(o,l=!1){const c=Pr();Oi(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Yd(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Dc(d.latestValues)&&Yd(c,d.latestValues)}return Dc(this.latestValues)&&Yd(c,this.latestValues),c}removeTransform(o){const l=Pr();Oi(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Dc(u.latestValues))continue;pC(u.latestValues)&&u.updateSnapshot();const d=Pr(),h=u.measurePageBox();Oi(d,h),W2(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Dc(this.latestValues)&&W2(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ts.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:f}=this.options;if(!(!this.layout||!(h||f))){if(this.resolvedRelativeTargetAt=ts.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Pr(),this.relativeTargetOrigin=Pr(),jm(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Oi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Pr(),this.targetWithTransforms=Pr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Uce(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Oi(this.target,this.layout.layoutBox),I5(this.target,this.targetDelta)):Oi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Pr(),this.relativeTargetOrigin=Pr(),jm(this.relativeTargetOrigin,this.target,m.target),Oi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Mc.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||pC(this.parent.latestValues)||T5(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===ts.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;Oi(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;Jce(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:g}=l;if(!g){this.projectionTransform&&(this.projectionDelta=Kd(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Kd(),this.projectionDeltaWithTransform=Kd());const x=this.projectionTransform;Rm(this.projectionDelta,this.layoutCorrected,g,this.latestValues),this.projectionTransform=K2(this.projectionDelta,this.treeScale),(this.projectionTransform!==x||this.treeScale.x!==f||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),Mc.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},h=Kd();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const f=Pr(),m=c?c.source:void 0,g=this.layout?this.layout.source:void 0,x=m!==g,E=this.getStack(),v=!E||E.members.length<=1,b=!!(x&&!v&&this.options.crossfade===!0&&!this.path.some(Oue));this.animationProgress=0;let S;this.mixTargetDelta=I=>{const D=I/1e3;Z2(h.x,o.x,D),Z2(h.y,o.y,D),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(jm(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Fue(this.relativeTarget,this.relativeTargetOrigin,f,D),S&&gue(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=Pr()),Oi(S,this.relativeTarget)),x&&(this.animationValues=d,uue(d,u,this.latestValues,D,b,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Eo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=En.update(()=>{Ex.hasAnimatedSinceResize=!0,this.currentAnimation=Sue(0,J2,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(J2),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=o;if(!(!l||!c||!u)){if(this!==o&&this.layout&&u&&L5(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Pr();const h=Ri(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+h;const f=Ri(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+f}Oi(l,c),Yd(l,d),Rm(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new yue),this.sharedNodes.get(o).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const u={};for(let d=0;d<Y2.length;d++){const h="rotate"+Y2[d];c[h]&&(u[h]=c[h],o.setStaticValue(h,0))}o.render();for(const d in u)o.setStaticValue(d,u[d]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Eue;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=Sx(o==null?void 0:o.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=Sx(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Dc(this.latestValues)&&(x.transform=d?d({},""):"none",this.hasProjected=!1),x}const f=h.animationValues||h.latestValues;this.applyTransformsToTarget(),u.transform=K2(this.projectionDeltaWithTransform,this.treeScale,f),d&&(u.transform=d(f,u.transform));const{x:m,y:g}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,h.animationValues?u.opacity=h===this?(c=(l=f.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:u.opacity=h===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const x in Fv){if(f[x]===void 0)continue;const{correct:E,applyTo:v}=Fv[x],b=u.transform==="none"?f[x]:E(f[x],h);if(v){const S=v.length;for(let I=0;I<S;I++)u[v[I]]=b}else u[x]=b}return this.options.layoutId&&(u.pointerEvents=h===this?Sx(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(X2),this.root.sharedNodes.clear()}}}function Tue(t){t.updateLayout()}function Iue(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;i==="size"?$i(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],m=Ri(f);f.min=r[h].min,f.max=f.min+m}):L5(i,n.layoutBox,r)&&$i(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],m=Ri(r[h]);f.max=f.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+m)});const l=Kd();Rm(l,r,n.layoutBox);const c=Kd();o?Rm(c,t.applyTransform(s,!0),n.measuredBox):Rm(c,r,n.layoutBox);const u=!j5(l);let d=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:m}=h;if(f&&m){const g=Pr();jm(g,n.layoutBox,f.layoutBox);const x=Pr();jm(x,r,m.layoutBox),D5(g,x)||(d=!0),h.options.layoutRoot&&(t.relativeTarget=x,t.relativeTargetOrigin=g,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Nue(t){Mc.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Pue(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Aue(t){t.clearSnapshot()}function X2(t){t.clearMeasurements()}function kue(t){t.isLayoutDirty=!1}function Rue(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Q2(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function jue(t){t.resolveTargetDelta()}function Due(t){t.calcProjection()}function Mue(t){t.resetRotation()}function Lue(t){t.removeLeadSnapshot()}function Z2(t,e,n){t.translate=or(e.translate,0,n),t.scale=or(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function eD(t,e,n,r){t.min=or(e.min,n.min,r),t.max=or(e.max,n.max,r)}function Fue(t,e,n,r){eD(t.x,e.x,n.x,r),eD(t.y,e.y,n.y,r)}function Oue(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const $ue={duration:.45,ease:[.4,0,.1,1]},tD=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),nD=tD("applewebkit/")&&!tD("chrome/")?Math.round:yr;function rD(t){t.min=nD(t.min),t.max=nD(t.max)}function Vue(t){rD(t.x),rD(t.y)}function L5(t,e,n){return t==="position"||t==="preserve-aspect"&&!fC(q2(e),q2(n),.2)}const Uue=M5({attachResizeListener:(t,e)=>va(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),H_={current:void 0},F5=M5({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!H_.current){const t=new Uue({});t.mount(window),t.setOptions({layoutScroll:!0}),H_.current=t}return H_.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Bue={pan:{Feature:sue},drag:{Feature:rue,ProjectionNode:F5,MeasureLayout:A5}},zue=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Gue(t){const e=zue.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]}function yC(t,e,n=1){const[r,s]=Gue(t);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const o=i.trim();return v5(o)?parseFloat(o):o}else return oC(s)?yC(s,e,n+1):s}function Wue(t,{...e},n){const r=t.current;if(!(r instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(s=>{const i=s.get();if(!oC(i))return;const o=yC(i,r);o&&s.set(o)});for(const s in e){const i=e[s];if(!oC(i))continue;const o=yC(i,r);o&&(e[s]=o,n||(n={}),n[s]===void 0&&(n[s]=i))}return{target:e,transitionEnd:n}}const Hue=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),O5=t=>Hue.has(t),que=t=>Object.keys(t).some(O5),sD=t=>t===Wu||t===Dt,iD=(t,e)=>parseFloat(t.split(", ")[e]),oD=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/);if(s)return iD(s[1],e);{const i=r.match(/^matrix\((.+)\)$/);return i?iD(i[1],t):0}},Kue=new Set(["x","y","z"]),Yue=lg.filter(t=>!Kue.has(t));function Jue(t){const e=[];return Yue.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const Rh={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:oD(4,13),y:oD(5,14)};Rh.translateX=Rh.x;Rh.translateY=Rh.y;const Xue=(t,e,n)=>{const r=e.measureViewportBox(),s=e.current,i=getComputedStyle(s),{display:o}=i,l={};o==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(u=>{l[u]=Rh[u](r,i)}),e.render();const c=e.measureViewportBox();return n.forEach(u=>{const d=e.getValue(u);d&&d.jump(l[u]),t[u]=Rh[u](c,i)}),t},Que=(t,e,n={},r={})=>{e={...e},r={...r};const s=Object.keys(e).filter(O5);let i=[],o=!1;const l=[];if(s.forEach(c=>{const u=t.getValue(c);if(!t.hasValue(c))return;let d=n[c],h=Lf(d);const f=e[c];let m;if($v(f)){const g=f.length,x=f[0]===null?1:0;d=f[x],h=Lf(d);for(let E=x;E<g&&f[E]!==null;E++)m?A0(Lf(f[E])===m):m=Lf(f[E])}else m=Lf(f);if(h!==m)if(sD(h)&&sD(m)){const g=u.get();typeof g=="string"&&u.set(parseFloat(g)),typeof f=="string"?e[c]=parseFloat(f):Array.isArray(f)&&m===Dt&&(e[c]=f.map(parseFloat))}else h!=null&&h.transform&&(m!=null&&m.transform)&&(d===0||f===0)?d===0?u.set(m.transform(d)):e[c]=h.transform(f):(o||(i=Jue(t),o=!0),l.push(c),r[c]=r[c]!==void 0?r[c]:e[c],u.jump(f))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,u=Xue(e,t,l);return i.length&&i.forEach(([d,h])=>{t.getValue(d).set(h)}),t.render(),E0&&c!==null&&window.scrollTo({top:c}),{target:u,transitionEnd:r}}else return{target:e,transitionEnd:r}};function Zue(t,e,n,r){return que(e)?Que(t,e,n,r):{target:e,transitionEnd:r}}const ede=(t,e,n,r)=>{const s=Wue(t,e,r);return e=s.target,r=s.transitionEnd,Zue(t,e,n,r)},xC={current:null},$5={current:!1};function tde(){if($5.current=!0,!!E0)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>xC.current=t.matches;t.addListener(e),e()}else xC.current=!1}function nde(t,e,n){const{willChange:r}=e;for(const s in e){const i=e[s],o=n[s];if(ui(i))t.addValue(s,i),zv(r)&&r.add(s);else if(ui(o))t.addValue(s,yo(i,{owner:t})),zv(r)&&r.remove(s);else if(o!==i)if(t.hasValue(s)){const l=t.getValue(s);!l.hasAnimated&&l.set(i)}else{const l=t.getStaticValue(s);t.addValue(s,yo(l!==void 0?l:i,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const aD=new WeakMap,V5=Object.keys(Sp),rde=V5.length,lD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],sde=yI.length;class ide{constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>En.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.isControllingVariants=T0(n),this.isVariantNode=CU(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{});for(const h in d){const f=d[h];l[h]!==void 0&&ui(f)&&(f.set(l[h],!1),zv(u)&&u.add(h))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,aD.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),$5.current||tde(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:xC.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){aD.delete(this.current),this.projection&&this.projection.unmount(),Eo(this.notifyUpdate),Eo(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const r=Gu.has(e),s=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&En.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{s(),i()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},r,s,i){let o,l;for(let c=0;c<rde;c++){const u=V5[c],{isEnabled:d,Feature:h,ProjectionNode:f,MeasureLayout:m}=Sp[u];f&&(o=f),d(n)&&(!this.features[u]&&h&&(this.features[u]=new h(this)),m&&(l=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:d,dragConstraints:h,layoutScroll:f,layoutRoot:m}=n;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||h&&Hd(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:i,layoutScroll:f,layoutRoot:m})}return l}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Pr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<lD.length;r++){const s=lD[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i=e["on"+s];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=nde(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const n={};for(let r=0;r<sde;r++){const s=yI[r],i=this.props[s];(_p(i)||i===!1)&&(n[s]=i)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=yo(n,{owner:this}),this.addValue(e,r)),r}readValue(e){var n;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props,s=typeof r=="string"||typeof r=="object"?(n=CI(this.props,r))===null||n===void 0?void 0:n[e]:void 0;if(r&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!ui(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new MI),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class U5 extends ide{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...r},{transformValues:s},i){let o=_ce(r,e||{},this);if(s&&(n&&(n=s(n)),r&&(r=s(r)),o&&(o=s(o))),i){wce(this,r,o);const l=ede(this,r,o,n);n=l.transitionEnd,r=l.target}return{transition:e,transitionEnd:n,...r}}}function ode(t){return window.getComputedStyle(t)}class ade extends U5{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,n){if(Gu.has(n)){const r=AI(n);return r&&r.default||0}else{const r=ode(e),s=(PU(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return N5(e,n)}build(e,n,r,s){wI(e,n,r,s.transformTemplate)}scrapeMotionValuesFromProps(e,n){return EI(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ui(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,r,s){MU(e,n,r,s)}}class lde extends U5{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Gu.has(n)){const r=AI(n);return r&&r.default||0}return n=LU.has(n)?n:pI(n),e.getAttribute(n)}measureInstanceViewportBox(){return Pr()}scrapeMotionValuesFromProps(e,n){return OU(e,n)}build(e,n,r,s){_I(e,n,r,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,r,s){FU(e,n,r,s)}mount(e){this.isSVGTag=SI(e.tagName),super.mount(e)}}const cde=(t,e)=>vI(t)?new lde(e,{enableHardwareAcceleration:!1}):new ade(e,{enableHardwareAcceleration:!0}),ude={layout:{ProjectionNode:F5,MeasureLayout:A5}},dde={...Fce,...ile,...Bue,...ude},It=mae((t,e)=>Hae(t,e,dde,cde));function B5(){const t=p.useRef(!1);return ag(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function hde(){const t=B5(),[e,n]=p.useState(0),r=p.useCallback(()=>{t.current&&n(e+1)},[e]);return[p.useCallback(()=>En.postRender(r),[r]),e]}class fde extends p.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function mde({children:t,isPresent:e}){const n=p.useId(),r=p.useRef(null),s=p.useRef({width:0,height:0,top:0,left:0});return p.useInsertionEffect(()=>{const{width:i,height:o,top:l,left:c}=s.current;if(e||!r.current||!i||!o)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),p.createElement(fde,{isPresent:e,childRef:r,sizeRef:s},p.cloneElement(t,{ref:r}))}const q_=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:o})=>{const l=dg(pde),c=p.useId(),u=p.useMemo(()=>({id:c,initial:e,isPresent:n,custom:s,onExitComplete:d=>{l.set(d,!0);for(const h of l.values())if(!h)return;r&&r()},register:d=>(l.set(d,!1),()=>l.delete(d))}),i?void 0:[n]);return p.useMemo(()=>{l.forEach((d,h)=>l.set(h,!1))},[n]),p.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),o==="popLayout"&&(t=p.createElement(mde,{isPresent:n},t)),p.createElement(S0.Provider,{value:u},t)};function pde(){return new Map}function gde(t){return p.useEffect(()=>()=>t(),[])}const Lc=t=>t.key||"";function yde(t,e){t.forEach(n=>{const r=Lc(n);e.set(r,n)})}function xde(t){const e=[];return p.Children.forEach(t,n=>{p.isValidElement(n)&&e.push(n)}),e}const Eu=({children:t,custom:e,initial:n=!0,onExitComplete:r,exitBeforeEnter:s,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const l=p.useContext(xI).forceRender||hde()[0],c=B5(),u=xde(t);let d=u;const h=p.useRef(new Map).current,f=p.useRef(d),m=p.useRef(new Map).current,g=p.useRef(!0);if(ag(()=>{g.current=!1,yde(u,m),f.current=d}),gde(()=>{g.current=!0,m.clear(),h.clear()}),g.current)return p.createElement(p.Fragment,null,d.map(b=>p.createElement(q_,{key:Lc(b),isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:i,mode:o},b)));d=[...d];const x=f.current.map(Lc),E=u.map(Lc),v=x.length;for(let b=0;b<v;b++){const S=x[b];E.indexOf(S)===-1&&!h.has(S)&&h.set(S,void 0)}return o==="wait"&&h.size&&(d=[]),h.forEach((b,S)=>{if(E.indexOf(S)!==-1)return;const I=m.get(S);if(!I)return;const D=x.indexOf(S);let k=b;if(!k){const C=()=>{h.delete(S);const T=Array.from(m.keys()).filter(P=>!E.includes(P));if(T.forEach(P=>m.delete(P)),f.current=u.filter(P=>{const A=Lc(P);return A===S||T.includes(A)}),!h.size){if(c.current===!1)return;l(),r&&r()}};k=p.createElement(q_,{key:Lc(I),isPresent:!1,onExitComplete:C,custom:e,presenceAffectsLayout:i,mode:o},I),h.set(S,k)}d.splice(D,0,k)}),d=d.map(b=>{const S=b.key;return h.has(S)?b:p.createElement(q_,{key:Lc(b),isPresent:!0,presenceAffectsLayout:i,mode:o},b)}),p.createElement(p.Fragment,null,h.size?d:d.map(b=>p.cloneElement(b)))};function vde(t){const e=dg(()=>yo(t)),{isStatic:n}=p.useContext(mI);if(n){const[,r]=p.useState(t);p.useEffect(()=>e.on("change",r),[])}return e}const wde=t=>t&&typeof t=="object"&&t.mix,bde=t=>wde(t)?t.mix:void 0;function _de(...t){const e=!Array.isArray(t[0]),n=e?0:-1,r=t[0+n],s=t[1+n],i=t[2+n],o=t[3+n],l=k0(s,i,{mixer:bde(i[0]),...o});return e?l(r):l}function z5(t,e){const n=vde(e()),r=()=>n.set(e());return r(),ag(()=>{const s=()=>En.update(r,!1,!0),i=t.map(o=>o.on("change",s));return()=>{i.forEach(o=>o()),Eo(r)}}),n}function Sde(t){km.current=[],t();const e=z5(km.current,t);return km.current=void 0,e}function K_(t,e,n,r){if(typeof t=="function")return Sde(t);const s=typeof e=="function"?e:_de(e,n,r);return Array.isArray(t)?cD(t,s):cD([t],([i])=>s(i))}function cD(t,e){const n=dg(()=>[]);return z5(t,()=>{n.length=0;const r=t.length;for(let s=0;s<r;s++)n[s]=t[s].get();return e(n)})}function G5(t,e,n){var r;if(typeof t=="string"){let s=document;e&&(A0(!!e.current),s=e.current),n?((r=n[t])!==null&&r!==void 0||(n[t]=s.querySelectorAll(t)),t=n[t]):t=s.querySelectorAll(t)}else t instanceof Element&&(t=[t]);return Array.from(t||[])}const Cx=new WeakMap;let hl;function Ede(t,e){if(e){const{inlineSize:n,blockSize:r}=e[0];return{width:n,height:r}}else return t instanceof SVGElement&&"getBBox"in t?t.getBBox():{width:t.offsetWidth,height:t.offsetHeight}}function Cde({target:t,contentRect:e,borderBoxSize:n}){var r;(r=Cx.get(t))===null||r===void 0||r.forEach(s=>{s({target:t,contentSize:e,get size(){return Ede(t,n)}})})}function Tde(t){t.forEach(Cde)}function Ide(){typeof ResizeObserver>"u"||(hl=new ResizeObserver(Tde))}function Nde(t,e){hl||Ide();const n=G5(t);return n.forEach(r=>{let s=Cx.get(r);s||(s=new Set,Cx.set(r,s)),s.add(e),hl==null||hl.observe(r)}),()=>{n.forEach(r=>{const s=Cx.get(r);s==null||s.delete(e),s!=null&&s.size||hl==null||hl.unobserve(r)})}}const Tx=new Set;let Dm;function Pde(){Dm=()=>{const t={width:window.innerWidth,height:window.innerHeight},e={target:window,size:t,contentSize:t};Tx.forEach(n=>n(e))},window.addEventListener("resize",Dm)}function Ade(t){return Tx.add(t),Dm||Pde(),()=>{Tx.delete(t),!Tx.size&&Dm&&(Dm=void 0)}}function kde(t,e){return typeof t=="function"?Ade(t):Nde(t,e)}const Rde=50,uD=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),jde=()=>({time:0,x:uD(),y:uD()}),Dde={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function dD(t,e,n,r){const s=n[e],{length:i,position:o}=Dde[e],l=s.current,c=n.time;s.current=t["scroll"+o],s.scrollLength=t["scroll"+i]-t["client"+i],s.offset.length=0,s.offset[0]=0,s.offset[1]=s.scrollLength,s.progress=kh(0,s.scrollLength,s.current);const u=r-c;s.velocity=u>Rde?0:PI(s.current-l,u)}function Mde(t,e,n){dD(t,"x",e,n),dD(t,"y",e,n),e.time=n}function Lde(t,e){const n={x:0,y:0};let r=t;for(;r&&r!==e;)if(r instanceof HTMLElement)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;else if(r.tagName==="svg"){const s=r.getBoundingClientRect();r=r.parentElement;const i=r.getBoundingClientRect();n.x+=s.left-i.left,n.y+=s.top-i.top}else if(r instanceof SVGGraphicsElement){const{x:s,y:i}=r.getBBox();n.x+=s,n.y+=i;let o=null,l=r.parentNode;for(;!o;)l.tagName==="svg"&&(o=l),l=r.parentNode;r=o}else break;return n}const Fde={Enter:[[0,1],[1,1]],Exit:[[0,0],[1,0]],Any:[[1,0],[0,1]],All:[[0,0],[1,1]]},vC={start:0,center:.5,end:1};function hD(t,e,n=0){let r=0;if(vC[t]!==void 0&&(t=vC[t]),typeof t=="string"){const s=parseFloat(t);t.endsWith("px")?r=s:t.endsWith("%")?t=s/100:t.endsWith("vw")?r=s/100*document.documentElement.clientWidth:t.endsWith("vh")?r=s/100*document.documentElement.clientHeight:t=s}return typeof t=="number"&&(r=e*t),n+r}const Ode=[0,0];function $de(t,e,n,r){let s=Array.isArray(t)?t:Ode,i=0,o=0;return typeof t=="number"?s=[t,t]:typeof t=="string"&&(t=t.trim(),t.includes(" ")?s=t.split(" "):s=[t,vC[t]?t:"0"]),i=hD(s[0],n,r),o=hD(s[1],e),i-o}const Vde={x:0,y:0};function Ude(t){return"getBBox"in t&&t.tagName!=="svg"?t.getBBox():{width:t.clientWidth,height:t.clientHeight}}function Bde(t,e,n){let{offset:r=Fde.All}=n;const{target:s=t,axis:i="y"}=n,o=i==="y"?"height":"width",l=s!==t?Lde(s,t):Vde,c=s===t?{width:t.scrollWidth,height:t.scrollHeight}:Ude(s),u={width:t.clientWidth,height:t.clientHeight};e[i].offset.length=0;let d=!e[i].interpolate;const h=r.length;for(let f=0;f<h;f++){const m=$de(r[f],u[o],c[o],l[i]);!d&&m!==e[i].interpolatorOffsets[f]&&(d=!0),e[i].offset[f]=m}d&&(e[i].interpolate=k0(e[i].offset,m5(r)),e[i].interpolatorOffsets=[...e[i].offset]),e[i].progress=e[i].interpolate(e[i].current)}function zde(t,e=t,n){if(n.x.targetOffset=0,n.y.targetOffset=0,e!==t){let r=e;for(;r&&r!==t;)n.x.targetOffset+=r.offsetLeft,n.y.targetOffset+=r.offsetTop,r=r.offsetParent}n.x.targetLength=e===t?e.scrollWidth:e.clientWidth,n.y.targetLength=e===t?e.scrollHeight:e.clientHeight,n.x.containerLength=t.clientWidth,n.y.containerLength=t.clientHeight}function Gde(t,e,n,r={}){return{measure:()=>zde(t,r.target,n),update:s=>{Mde(t,n,s),(r.offset||r.target)&&Bde(t,n,r)},notify:()=>e(n)}}const Of=new WeakMap,fD=new WeakMap,Y_=new WeakMap,mD=t=>t===document.documentElement?window:t;function Wde(t,{container:e=document.documentElement,...n}={}){let r=Y_.get(e);r||(r=new Set,Y_.set(e,r));const s=jde(),i=Gde(e,t,s,n);if(r.add(i),!Of.has(e)){const l=()=>{for(const f of r)f.measure()},c=()=>{for(const f of r)f.update(ts.timestamp)},u=()=>{for(const f of r)f.notify()},d=()=>{En.read(l,!1,!0),En.read(c,!1,!0),En.update(u,!1,!0)};Of.set(e,d);const h=mD(e);window.addEventListener("resize",d,{passive:!0}),e!==document.documentElement&&fD.set(e,kde(e,d)),h.addEventListener("scroll",d,{passive:!0})}const o=Of.get(e);return En.read(o,!1,!0),()=>{var l;Eo(o);const c=Y_.get(e);if(!c||(c.delete(i),c.size))return;const u=Of.get(e);Of.delete(e),u&&(mD(e).removeEventListener("scroll",u),(l=fD.get(e))===null||l===void 0||l(),window.removeEventListener("resize",u))}}function pD(t,e){HU(!!(!e||e.current))}const Hde=()=>({scrollX:yo(0),scrollY:yo(0),scrollXProgress:yo(0),scrollYProgress:yo(0)});function qde({container:t,target:e,layoutEffect:n=!0,...r}={}){const s=dg(Hde);return(n?ag:p.useEffect)(()=>(pD("target",e),pD("container",t),Wde(({x:o,y:l})=>{s.scrollX.set(o.current),s.scrollXProgress.set(o.progress),s.scrollY.set(l.current),s.scrollYProgress.set(l.progress)},{...r,container:(t==null?void 0:t.current)||void 0,target:(e==null?void 0:e.current)||void 0})),[t,e,JSON.stringify(r.offset)]),s}const Kde={some:0,all:1};function Yde(t,e,{root:n,margin:r,amount:s="some"}={}){const i=G5(t),o=new WeakMap,l=u=>{u.forEach(d=>{const h=o.get(d.target);if(d.isIntersecting!==!!h)if(d.isIntersecting){const f=e(d);typeof f=="function"?o.set(d.target,f):c.unobserve(d.target)}else h&&(h(d),o.delete(d.target))})},c=new IntersectionObserver(l,{root:n,rootMargin:r,threshold:typeof s=="number"?s:Kde[s]});return i.forEach(u=>c.observe(u)),()=>c.disconnect()}function Jde(t,{root:e,margin:n,amount:r,once:s=!1}={}){const[i,o]=p.useState(!1);return p.useEffect(()=>{if(!t.current||s&&i)return;const l=()=>(o(!0),s?void 0:()=>o(!1)),c={root:e&&e.current||void 0,margin:n,amount:r};return Yde(t.current,l,c)},[e,t,n,s,r]),i}function Xde(t,[e,n]){return Math.min(n,Math.max(e,t))}function Qde(t,e){return p.useReducer((n,r)=>e[n][r]??n,t)}var LI="ScrollArea",[W5,DRe]=Li(LI),[Zde,no]=W5(LI),H5=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...o}=t,[l,c]=p.useState(null),[u,d]=p.useState(null),[h,f]=p.useState(null),[m,g]=p.useState(null),[x,E]=p.useState(null),[v,b]=p.useState(0),[S,I]=p.useState(0),[D,k]=p.useState(!1),[C,T]=p.useState(!1),P=Cn(e,R=>c(R)),A=x0(s);return a.jsx(Zde,{scope:n,type:r,dir:A,scrollHideDelay:i,scrollArea:l,viewport:u,onViewportChange:d,content:h,onContentChange:f,scrollbarX:m,onScrollbarXChange:g,scrollbarXEnabled:D,onScrollbarXEnabledChange:k,scrollbarY:x,onScrollbarYChange:E,scrollbarYEnabled:C,onScrollbarYEnabledChange:T,onCornerWidthChange:b,onCornerHeightChange:I,children:a.jsx(Yt.div,{dir:A,...o,ref:P,style:{position:"relative","--radix-scroll-area-corner-width":v+"px","--radix-scroll-area-corner-height":S+"px",...t.style}})})});H5.displayName=LI;var q5="ScrollAreaViewport",K5=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=t,o=no(q5,n),l=p.useRef(null),c=Cn(e,l,o.onViewportChange);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),a.jsx(Yt.div,{"data-radix-scroll-area-viewport":"",...i,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...t.style},children:a.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});K5.displayName=q5;var la="ScrollAreaScrollbar",FI=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=no(la,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=s,l=t.orientation==="horizontal";return p.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),s.type==="hover"?a.jsx(ehe,{...r,ref:e,forceMount:n}):s.type==="scroll"?a.jsx(the,{...r,ref:e,forceMount:n}):s.type==="auto"?a.jsx(Y5,{...r,ref:e,forceMount:n}):s.type==="always"?a.jsx(OI,{...r,ref:e}):null});FI.displayName=la;var ehe=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=no(la,t.__scopeScrollArea),[i,o]=p.useState(!1);return p.useEffect(()=>{const l=s.scrollArea;let c=0;if(l){const u=()=>{window.clearTimeout(c),o(!0)},d=()=>{c=window.setTimeout(()=>o(!1),s.scrollHideDelay)};return l.addEventListener("pointerenter",u),l.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",u),l.removeEventListener("pointerleave",d)}}},[s.scrollArea,s.scrollHideDelay]),a.jsx(qs,{present:n||i,children:a.jsx(Y5,{"data-state":i?"visible":"hidden",...r,ref:e})})}),the=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=no(la,t.__scopeScrollArea),i=t.orientation==="horizontal",o=j0(()=>c("SCROLL_END"),100),[l,c]=Qde("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return p.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>c("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,s.scrollHideDelay,c]),p.useEffect(()=>{const u=s.viewport,d=i?"scrollLeft":"scrollTop";if(u){let h=u[d];const f=()=>{const m=u[d];h!==m&&(c("SCROLL"),o()),h=m};return u.addEventListener("scroll",f),()=>u.removeEventListener("scroll",f)}},[s.viewport,i,c,o]),a.jsx(qs,{present:n||l!=="hidden",children:a.jsx(OI,{"data-state":l==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:_t(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:_t(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),Y5=p.forwardRef((t,e)=>{const n=no(la,t.__scopeScrollArea),{forceMount:r,...s}=t,[i,o]=p.useState(!1),l=t.orientation==="horizontal",c=j0(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,d=n.viewport.offsetHeight<n.viewport.scrollHeight;o(l?u:d)}},10);return jh(n.viewport,c),jh(n.content,c),a.jsx(qs,{present:r||i,children:a.jsx(OI,{"data-state":i?"visible":"hidden",...s,ref:e})})}),OI=p.forwardRef((t,e)=>{const{orientation:n="vertical",...r}=t,s=no(la,t.__scopeScrollArea),i=p.useRef(null),o=p.useRef(0),[l,c]=p.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=e6(l.viewport,l.content),d={...r,sizes:l,onSizesChange:c,hasThumb:u>0&&u<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function h(f,m){return ahe(f,o.current,l,m)}return n==="horizontal"?a.jsx(nhe,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollLeft,m=gD(f,l,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollLeft=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollLeft=h(f,s.dir))}}):n==="vertical"?a.jsx(rhe,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollTop,m=gD(f,l);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollTop=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollTop=h(f))}}):null}),nhe=p.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=no(la,t.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=Cn(e,c,i.onScrollbarXChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(X5,{"data-orientation":"horizontal",...s,ref:u,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":R0(n)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.x),onDragScroll:d=>t.onDragScroll(d.x),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+d.deltaX;t.onWheelScroll(f),n6(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:Hv(o.paddingLeft),paddingEnd:Hv(o.paddingRight)}})}})}),rhe=p.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=no(la,t.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=Cn(e,c,i.onScrollbarYChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(X5,{"data-orientation":"vertical",...s,ref:u,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":R0(n)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.y),onDragScroll:d=>t.onDragScroll(d.y),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollTop+d.deltaY;t.onWheelScroll(f),n6(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:Hv(o.paddingTop),paddingEnd:Hv(o.paddingBottom)}})}})}),[she,J5]=W5(la),X5=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:d,onResize:h,...f}=t,m=no(la,n),[g,x]=p.useState(null),E=Cn(e,P=>x(P)),v=p.useRef(null),b=p.useRef(""),S=m.viewport,I=r.content-r.viewport,D=Rr(d),k=Rr(c),C=j0(h,10);function T(P){if(v.current){const A=P.clientX-v.current.left,R=P.clientY-v.current.top;u({x:A,y:R})}}return p.useEffect(()=>{const P=A=>{const R=A.target;(g==null?void 0:g.contains(R))&&D(A,I)};return document.addEventListener("wheel",P,{passive:!1}),()=>document.removeEventListener("wheel",P,{passive:!1})},[S,g,I,D]),p.useEffect(k,[r,k]),jh(g,C),jh(m.content,C),a.jsx(she,{scope:n,scrollbar:g,hasThumb:s,onThumbChange:Rr(i),onThumbPointerUp:Rr(o),onThumbPositionChange:k,onThumbPointerDown:Rr(l),children:a.jsx(Yt.div,{...f,ref:E,style:{position:"absolute",...f.style},onPointerDown:_t(t.onPointerDown,P=>{P.button===0&&(P.target.setPointerCapture(P.pointerId),v.current=g.getBoundingClientRect(),b.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),T(P))}),onPointerMove:_t(t.onPointerMove,T),onPointerUp:_t(t.onPointerUp,P=>{const A=P.target;A.hasPointerCapture(P.pointerId)&&A.releasePointerCapture(P.pointerId),document.body.style.webkitUserSelect=b.current,m.viewport&&(m.viewport.style.scrollBehavior=""),v.current=null})})})}),Wv="ScrollAreaThumb",Q5=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=J5(Wv,t.__scopeScrollArea);return a.jsx(qs,{present:n||s.hasThumb,children:a.jsx(ihe,{ref:e,...r})})}),ihe=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:r,...s}=t,i=no(Wv,n),o=J5(Wv,n),{onThumbPositionChange:l}=o,c=Cn(e,h=>o.onThumbChange(h)),u=p.useRef(void 0),d=j0(()=>{u.current&&(u.current(),u.current=void 0)},100);return p.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(d(),!u.current){const m=lhe(h,l);u.current=m,l()}};return l(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,d,l]),a.jsx(Yt.div,{"data-state":o.hasThumb?"visible":"hidden",...s,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:_t(t.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),g=h.clientX-m.left,x=h.clientY-m.top;o.onThumbPointerDown({x:g,y:x})}),onPointerUp:_t(t.onPointerUp,o.onThumbPointerUp)})});Q5.displayName=Wv;var $I="ScrollAreaCorner",Z5=p.forwardRef((t,e)=>{const n=no($I,t.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?a.jsx(ohe,{...t,ref:e}):null});Z5.displayName=$I;var ohe=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,...r}=t,s=no($I,n),[i,o]=p.useState(0),[l,c]=p.useState(0),u=!!(i&&l);return jh(s.scrollbarX,()=>{var h;const d=((h=s.scrollbarX)==null?void 0:h.offsetHeight)||0;s.onCornerHeightChange(d),c(d)}),jh(s.scrollbarY,()=>{var h;const d=((h=s.scrollbarY)==null?void 0:h.offsetWidth)||0;s.onCornerWidthChange(d),o(d)}),u?a.jsx(Yt.div,{...r,ref:e,style:{width:i,height:l,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function Hv(t){return t?parseInt(t,10):0}function e6(t,e){const n=t/e;return isNaN(n)?0:n}function R0(t){const e=e6(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-n)*e;return Math.max(r,18)}function ahe(t,e,n,r="ltr"){const s=R0(n),i=s/2,o=e||i,l=s-o,c=n.scrollbar.paddingStart+o,u=n.scrollbar.size-n.scrollbar.paddingEnd-l,d=n.content-n.viewport,h=r==="ltr"?[0,d]:[d*-1,0];return t6([c,u],h)(t)}function gD(t,e,n="ltr"){const r=R0(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-s,o=e.content-e.viewport,l=i-r,c=n==="ltr"?[0,o]:[o*-1,0],u=Xde(t,c);return t6([0,o],[0,l])(u)}function t6(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function n6(t,e){return t>0&&t<e}var lhe=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},r=0;return function s(){const i={left:t.scrollLeft,top:t.scrollTop},o=n.left!==i.left,l=n.top!==i.top;(o||l)&&e(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function j0(t,e){const n=Rr(t),r=p.useRef(0);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),p.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,e)},[n,e])}function jh(t,e){const n=Rr(e);ta(()=>{let r=0;if(t){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(t),()=>{window.cancelAnimationFrame(r),s.unobserve(t)}}},[t,n])}var r6=H5,che=K5,uhe=Z5;const Zi=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(r6,{ref:r,className:Et("relative overflow-hidden",t),...n,children:[a.jsx(che,{className:"h-full w-full rounded-[inherit]",children:e}),a.jsx(s6,{}),a.jsx(uhe,{})]}));Zi.displayName=r6.displayName;const s6=ht.forwardRef(({className:t,orientation:e="vertical",...n},r)=>a.jsx(FI,{ref:r,orientation:e,className:Et("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:a.jsx(Q5,{className:"relative flex-1 rounded-full bg-border"})}));s6.displayName=FI.displayName;const wC="RFC3986",bC={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},dhe="RFC1738",hhe=Array.isArray,Ro=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),J_=1024,fhe=(t,e,n,r,s)=>{if(t.length===0)return t;let i=t;if(typeof t=="symbol"?i=Symbol.prototype.toString.call(t):typeof t!="string"&&(i=String(t)),n==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let o="";for(let l=0;l<i.length;l+=J_){const c=i.length>=J_?i.slice(l,l+J_):i,u=[];for(let d=0;d<c.length;++d){let h=c.charCodeAt(d);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||s===dhe&&(h===40||h===41)){u[u.length]=c.charAt(d);continue}if(h<128){u[u.length]=Ro[h];continue}if(h<2048){u[u.length]=Ro[192|h>>6]+Ro[128|h&63];continue}if(h<55296||h>=57344){u[u.length]=Ro[224|h>>12]+Ro[128|h>>6&63]+Ro[128|h&63];continue}d+=1,h=65536+((h&1023)<<10|c.charCodeAt(d)&1023),u[u.length]=Ro[240|h>>18]+Ro[128|h>>12&63]+Ro[128|h>>6&63]+Ro[128|h&63]}o+=u.join("")}return o};function mhe(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function yD(t,e){if(hhe(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const phe=Object.prototype.hasOwnProperty,i6={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},Mo=Array.isArray,ghe=Array.prototype.push,o6=function(t,e){ghe.apply(t,Mo(e)?e:[e])},yhe=Date.prototype.toISOString,Lr={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:fhe,encodeValuesOnly:!1,format:wC,formatter:bC[wC],indices:!1,serializeDate(t){return yhe.call(t)},skipNulls:!1,strictNullHandling:!1};function xhe(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const X_={};function a6(t,e,n,r,s,i,o,l,c,u,d,h,f,m,g,x,E,v){let b=t,S=v,I=0,D=!1;for(;(S=S.get(X_))!==void 0&&!D;){const A=S.get(t);if(I+=1,typeof A<"u"){if(A===I)throw new RangeError("Cyclic object value");D=!0}typeof S.get(X_)>"u"&&(I=0)}if(typeof u=="function"?b=u(e,b):b instanceof Date?b=f==null?void 0:f(b):n==="comma"&&Mo(b)&&(b=yD(b,function(A){return A instanceof Date?f==null?void 0:f(A):A})),b===null){if(i)return c&&!x?c(e,Lr.encoder,E,"key",m):e;b=""}if(xhe(b)||mhe(b)){if(c){const A=x?e:c(e,Lr.encoder,E,"key",m);return[(g==null?void 0:g(A))+"="+(g==null?void 0:g(c(b,Lr.encoder,E,"value",m)))]}return[(g==null?void 0:g(e))+"="+(g==null?void 0:g(String(b)))]}const k=[];if(typeof b>"u")return k;let C;if(n==="comma"&&Mo(b))x&&c&&(b=yD(b,c)),C=[{value:b.length>0?b.join(",")||null:void 0}];else if(Mo(u))C=u;else{const A=Object.keys(b);C=d?A.sort(d):A}const T=l?String(e).replace(/\./g,"%2E"):String(e),P=r&&Mo(b)&&b.length===1?T+"[]":T;if(s&&Mo(b)&&b.length===0)return P+"[]";for(let A=0;A<C.length;++A){const R=C[A],M=typeof R=="object"&&typeof R.value<"u"?R.value:b[R];if(o&&M===null)continue;const j=h&&l?R.replace(/\./g,"%2E"):R,z=Mo(b)?typeof n=="function"?n(P,j):P:P+(h?"."+j:"["+j+"]");v.set(t,I);const W=new WeakMap;W.set(X_,v),o6(k,a6(M,z,n,r,s,i,o,l,n==="comma"&&x&&Mo(b)?null:c,u,d,h,f,m,g,x,E,W))}return k}function vhe(t=Lr){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Lr.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=wC;if(typeof t.format<"u"){if(!phe.call(bC,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=bC[n];let s=Lr.filter;(typeof t.filter=="function"||Mo(t.filter))&&(s=t.filter);let i;if(t.arrayFormat&&t.arrayFormat in i6?i=t.arrayFormat:"indices"in t?i=t.indices?"indices":"repeat":i=Lr.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Lr.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Lr.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Lr.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Lr.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Lr.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Lr.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Lr.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Lr.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Lr.encodeValuesOnly,filter:s,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Lr.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Lr.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Lr.strictNullHandling}}function whe(t,e={}){let n=t;const r=vhe(e);let s,i;typeof r.filter=="function"?(i=r.filter,n=i("",n)):Mo(r.filter)&&(i=r.filter,s=i);const o=[];if(typeof n!="object"||n===null)return"";const l=i6[r.arrayFormat],c=l==="comma"&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const u=new WeakMap;for(let f=0;f<s.length;++f){const m=s[f];r.skipNulls&&n[m]===null||o6(o,a6(n[m],m,l,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}const d=o.join(r.delimiter);let h=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),d.length>0?h+d:""}const Sd="4.104.0";let xD=!1,Mm,l6,c6,_C,u6,d6,h6,f6,m6;function bhe(t,e={auto:!1}){if(xD)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(Mm)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${Mm}'\``);xD=e.auto,Mm=t.kind,l6=t.fetch,t.Request,t.Response,t.Headers,c6=t.FormData,t.Blob,_C=t.File,u6=t.ReadableStream,d6=t.getMultipartRequestOptions,h6=t.getDefaultAgent,f6=t.fileFromPath,m6=t.isFsReadStream}class _he{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function She({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new _he(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}const p6=()=>{Mm||bhe(She(),{auto:!0})};p6();class Mt extends Error{}class ds extends Mt{constructor(e,n,r,s){super(`${ds.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=n;const i=n;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e||!s)return new D0({message:r,cause:EC(n)});const i=n==null?void 0:n.error;return e===400?new g6(e,i,r,s):e===401?new y6(e,i,r,s):e===403?new x6(e,i,r,s):e===404?new v6(e,i,r,s):e===409?new w6(e,i,r,s):e===422?new b6(e,i,r,s):e===429?new _6(e,i,r,s):e>=500?new S6(e,i,r,s):new ds(e,i,r,s)}}class Wi extends ds{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class D0 extends ds{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class VI extends D0{constructor({message:e}={}){super({message:e??"Request timed out."})}}class g6 extends ds{}class y6 extends ds{}class x6 extends ds{}class v6 extends ds{}class w6 extends ds{}class b6 extends ds{}class _6 extends ds{}class S6 extends ds{}class E6 extends Mt{constructor(){super("Could not parse response content as the length limit was reached")}}class C6 extends Mt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var ky=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Ac=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},gi;class M0{constructor(){gi.set(this,void 0),this.buffer=new Uint8Array,ky(this,gi,null,"f")}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+n.length);r.set(this.buffer),r.set(n,this.buffer.length),this.buffer=r;const s=[];let i;for(;(i=Ehe(this.buffer,Ac(this,gi,"f")))!=null;){if(i.carriage&&Ac(this,gi,"f")==null){ky(this,gi,i.index,"f");continue}if(Ac(this,gi,"f")!=null&&(i.index!==Ac(this,gi,"f")+1||i.carriage)){s.push(this.decodeText(this.buffer.slice(0,Ac(this,gi,"f")-1))),this.buffer=this.buffer.slice(Ac(this,gi,"f")),ky(this,gi,null,"f");continue}const o=Ac(this,gi,"f")!==null?i.preceding-1:i.preceding,l=this.decodeText(this.buffer.slice(0,o));s.push(l),this.buffer=this.buffer.slice(i.index),ky(this,gi,null,"f")}return s}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Mt(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Mt(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Mt("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}gi=new WeakMap;M0.NEWLINE_CHARS=new Set([`
`,"\r"]);M0.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Ehe(t,e){for(let s=e??0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function Che(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}function T6(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class Uo{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const o of The(e,n))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null||o.event.startsWith("response.")||o.event.startsWith("transcript.")){let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(l&&l.error)throw new ds(void 0,l.error,void 0,j6(e.headers));yield l}else{let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(o.event=="error")throw new ds(void 0,l.error,l.message,void 0);yield{event:o.event,data:l}}}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||n.abort()}}return new Uo(s,n)}static fromReadableStream(e,n){let r=!1;async function*s(){const o=new M0,l=T6(e);for await(const c of l)for(const u of o.decode(c))yield u;for(const c of o.flush())yield c}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const l of s())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||n.abort()}}return new Uo(i,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),n.push(o)}return i.shift()}});return[new Uo(()=>s(e),this.controller),new Uo(()=>s(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new u6({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:o}=await n.next();if(o)return s.close();const l=r.encode(JSON.stringify(i)+`
`);s.enqueue(l)}catch(i){s.error(i)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*The(t,e){if(!t.body)throw e.abort(),new Mt("Attempted to iterate over a response with no body");const n=new Nhe,r=new M0,s=T6(t.body);for await(const i of Ihe(s))for(const o of r.decode(i)){const l=n.decode(o);l&&(yield l)}for(const i of r.flush()){const o=n.decode(i);o&&(yield o)}}async function*Ihe(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=Che(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class Nhe{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=Phe(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function Phe(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}const I6=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",N6=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&L0(t),L0=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",Ahe=t=>N6(t)||I6(t)||m6(t);async function P6(t,e,n){var s;if(t=await t,N6(t))return t;if(I6(t)){const i=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=L0(i)?[await i.arrayBuffer()]:[i];return new _C(o,e,n)}const r=await khe(t);if(e||(e=jhe(t)??"unknown_file"),!(n!=null&&n.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(n={...n,type:i})}return new _C(r,e,n)}async function khe(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(L0(t))e.push(await t.arrayBuffer());else if(Dhe(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(n=t==null?void 0:t.constructor)==null?void 0:n.name}; props: ${Rhe(t)}`);return e}function Rhe(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function jhe(t){var e;return Q_(t.name)||Q_(t.filename)||((e=Q_(t.path))==null?void 0:e.split(/[\\/]/).pop())}const Q_=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},Dhe=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",vD=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",Cu=async t=>{const e=await Mhe(t.body);return d6(e,t)},Mhe=async t=>{const e=new c6;return await Promise.all(Object.entries(t||{}).map(([n,r])=>SC(e,n,r))),e},SC=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(Ahe(n)){const r=await P6(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>SC(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>SC(t,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Lhe=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Fhe=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ry;p6();async function A6(t){var o;const{response:e}=t;if(t.options.stream)return $l("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):Uo.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type"),r=(o=n==null?void 0:n.split(";")[0])==null?void 0:o.trim();if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.endsWith("+json"))){const l=await e.json();return $l("response",e.status,e.url,e.headers,l),k6(l,e)}const i=await e.text();return $l("response",e.status,e.url,e.headers,i),i}function k6(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class F0 extends Promise{constructor(e,n=A6){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new F0(this.responsePromise,async n=>k6(e(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Ohe{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=Z_("maxRetries",n),this.timeout=Z_("timeout",r),this.httpAgent=s,this.fetch=i??l6}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...zhe(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${qhe()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&L0(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:n,...s,body:i}}))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:n=0}={}){var x;const r={...e},{method:s,path:i,query:o,headers:l={}}=r,c=ArrayBuffer.isView(r.body)||r.__binaryRequest&&typeof r.body=="string"?r.body:vD(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,u=this.calculateContentLength(c),d=this.buildURL(i,o);"timeout"in r&&Z_("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const h=r.httpAgent??this.httpAgent??h6(d),f=r.timeout+1e3;typeof((x=h==null?void 0:h.options)==null?void 0:x.timeout)=="number"&&f>(h.options.timeout??0)&&(h.options.timeout=f),this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:r,headers:l,contentLength:u,retryCount:n});return{req:{method:s,...c&&{body:c},headers:m,...h&&{agent:h},signal:r.signal??null},url:d,timeout:r.timeout}}buildHeaders({options:e,headers:n,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const o=this.defaultHeaders(e);return SD(i,o),SD(i,n),vD(e.body)&&Mm!=="node"&&delete i["content-type"],Dy(o,"x-stainless-retry-count")===void 0&&Dy(n,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),Dy(o,"x-stainless-timeout")===void 0&&Dy(n,"x-stainless-timeout")===void 0&&e.timeout&&(i["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(i,n),i}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,s){return ds.generate(e,n,r,s)}request(e,n=null){return new F0(this.makeRequest(e,n))}async makeRequest(e,n){var h,f;const r=await e,s=r.maxRetries??this.maxRetries;n==null&&(n=s),await this.prepareOptions(r);const{req:i,url:o,timeout:l}=this.buildRequest(r,{retryCount:s-n});if(await this.prepareRequest(i,{url:o,options:r}),$l("request",o,r,i.headers),(h=r.signal)!=null&&h.aborted)throw new Wi;const c=new AbortController,u=await this.fetchWithTimeout(o,i,l,c).catch(EC);if(u instanceof Error){if((f=r.signal)!=null&&f.aborted)throw new Wi;if(n)return this.retryRequest(r,n);throw u.name==="AbortError"?new VI:new D0({cause:u})}const d=j6(u.headers);if(!u.ok){if(n&&this.shouldRetry(u)){const b=`retrying, ${n} attempts remaining`;return $l(`response (error; ${b})`,u.status,o,d),this.retryRequest(r,n,d)}const m=await u.text().catch(b=>EC(b).message),g=Ghe(m),x=g?void 0:m;throw $l(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,u.status,o,d,x),this.makeStatusError(u.status,g,x,d)}return{response:u,options:r,controller:c}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new $he(this,r,e)}buildURL(e,n){const r=Hhe(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return D6(s)||(n={...s,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new Mt(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,s){const{signal:i,...o}=n||{};i&&i.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),r),c={signal:s.signal,...o};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,e,c).finally(()=>{clearTimeout(l)})}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const l=parseFloat(i);Number.isNaN(l)||(s=l)}const o=r==null?void 0:r["retry-after"];if(o&&!s){const l=parseFloat(o);Number.isNaN(l)?s=Date.parse(o)-Date.now():s=l*1e3}if(!(s&&0<=s&&s<60*1e3)){const l=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,l)}return await fg(s),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,o=Math.min(.5*Math.pow(2,i),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Sd}`}}class R6{constructor(e,n,r,s){Ry.set(this,void 0),Lhe(this,Ry,e,"f"),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Mt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);n.query=void 0,n.path=e.url.toString()}return await Fhe(this,Ry,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Ry=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class $he extends F0{constructor(e,n,r){super(n,async s=>new r(e,s.response,await A6(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const j6=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),Vhe={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},dr=t=>typeof t=="object"&&t!==null&&!D6(t)&&Object.keys(t).every(e=>M6(Vhe,e)),Uhe=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Sd,"X-Stainless-OS":bD(Deno.build.os),"X-Stainless-Arch":wD(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Sd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Sd,"X-Stainless-OS":bD(process.platform),"X-Stainless-Arch":wD(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=Bhe();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Sd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Sd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Bhe(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${s}.${i}.${o}`}}}return null}const wD=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",bD=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let _D;const zhe=()=>_D??(_D=Uhe()),Ghe=t=>{try{return JSON.parse(t)}catch{return}},Whe=/^[a-z][a-z0-9+.-]*:/i,Hhe=t=>Whe.test(t),fg=t=>new Promise(e=>setTimeout(e,t)),Z_=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Mt(`${t} must be an integer`);if(e<0)throw new Mt(`${t} must be a positive integer`);return e},EC=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},jy=t=>{var e,n,r,s,i;if(typeof process<"u")return((n=(e=process.env)==null?void 0:e[t])==null?void 0:n.trim())??void 0;if(typeof Deno<"u")return(i=(s=(r=Deno.env)==null?void 0:r.get)==null?void 0:s.call(r,t))==null?void 0:i.trim()};function D6(t){if(!t)return!0;for(const e in t)return!1;return!0}function M6(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function SD(t,e){for(const n in e){if(!M6(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];s===null?delete t[r]:s!==void 0&&(t[r]=s)}}const ED=new Set(["authorization","api-key"]);function $l(t,...e){var n;if(typeof process<"u"&&((n=process==null?void 0:process.env)==null?void 0:n.DEBUG)==="true"){const r=e.map(s=>{if(!s)return s;if(s.headers){const o={...s,headers:{...s.headers}};for(const l in s.headers)ED.has(l.toLowerCase())&&(o.headers[l]="REDACTED");return o}let i=null;for(const o in s)ED.has(o.toLowerCase())&&(i??(i={...s}),i[o]="REDACTED");return i??s});console.log(`OpenAI:DEBUG:${t}`,...r)}}const qhe=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),Khe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Yhe=t=>typeof(t==null?void 0:t.get)=="function",Dy=(t,e)=>{var r;const n=e.toLowerCase();if(Yhe(t)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,o,l)=>o+l.toUpperCase());for(const i of[e,n,e.toUpperCase(),s]){const o=t.get(i);if(o)return o}}for(const[s,i]of Object.entries(t))if(s.toLowerCase()===n)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i},Jhe=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=e.charCodeAt(s);return Array.from(new Float32Array(r.buffer))}};function eS(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class O0 extends R6{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Vr extends R6{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const n=(r=e[e.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class Vt{constructor(e){this._client=e}}let L6=class extends Vt{list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/chat/completions/${e}/messages`,Xhe,{query:n,...r})}},$0=class extends Vt{constructor(){super(...arguments),this.messages=new L6(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(`/chat/completions/${e}`,n)}update(e,n,r){return this._client.post(`/chat/completions/${e}`,{body:n,...r})}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/chat/completions",V0,{query:e,...n})}del(e,n){return this._client.delete(`/chat/completions/${e}`,n)}};class V0 extends Vr{}class Xhe extends Vr{}$0.ChatCompletionsPage=V0;$0.Messages=L6;let U0=class extends Vt{constructor(){super(...arguments),this.completions=new $0(this._client)}};U0.Completions=$0;U0.ChatCompletionsPage=V0;class F6 extends Vt{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}class O6 extends Vt{create(e,n){return this._client.post("/audio/transcriptions",Cu({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}}))}}class $6 extends Vt{create(e,n){return this._client.post("/audio/translations",Cu({body:e,...n,__metadata:{model:e.model}}))}}class mg extends Vt{constructor(){super(...arguments),this.transcriptions=new O6(this._client),this.translations=new $6(this._client),this.speech=new F6(this._client)}}mg.Transcriptions=O6;mg.Translations=$6;mg.Speech=F6;class UI extends Vt{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/batches",BI,{query:e,...n})}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}}class BI extends Vr{}UI.BatchesPage=BI;var lo=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},rr=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},CC,Ix,Nx,rm,sm,Px,im,ha,om,qv,Kv,Ed,V6;class zI{constructor(){CC.add(this),this.controller=new AbortController,Ix.set(this,void 0),Nx.set(this,()=>{}),rm.set(this,()=>{}),sm.set(this,void 0),Px.set(this,()=>{}),im.set(this,()=>{}),ha.set(this,{}),om.set(this,!1),qv.set(this,!1),Kv.set(this,!1),Ed.set(this,!1),lo(this,Ix,new Promise((e,n)=>{lo(this,Nx,e,"f"),lo(this,rm,n,"f")}),"f"),lo(this,sm,new Promise((e,n)=>{lo(this,Px,e,"f"),lo(this,im,n,"f")}),"f"),rr(this,Ix,"f").catch(()=>{}),rr(this,sm,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},rr(this,CC,"m",V6).bind(this))},0)}_connected(){this.ended||(rr(this,Nx,"f").call(this),this._emit("connect"))}get ended(){return rr(this,om,"f")}get errored(){return rr(this,qv,"f")}get aborted(){return rr(this,Kv,"f")}abort(){this.controller.abort()}on(e,n){return(rr(this,ha,"f")[e]||(rr(this,ha,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=rr(this,ha,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(rr(this,ha,"f")[e]||(rr(this,ha,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{lo(this,Ed,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){lo(this,Ed,!0,"f"),await rr(this,sm,"f")}_emit(e,...n){if(rr(this,om,"f"))return;e==="end"&&(lo(this,om,!0,"f"),rr(this,Px,"f").call(this));const r=rr(this,ha,"f")[e];if(r&&(rr(this,ha,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!rr(this,Ed,"f")&&!(r!=null&&r.length)&&Promise.reject(s),rr(this,rm,"f").call(this,s),rr(this,im,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!rr(this,Ed,"f")&&!(r!=null&&r.length)&&Promise.reject(s),rr(this,rm,"f").call(this,s),rr(this,im,"f").call(this,s),this._emit("end")}}_emitFinal(){}}Ix=new WeakMap,Nx=new WeakMap,rm=new WeakMap,sm=new WeakMap,Px=new WeakMap,im=new WeakMap,ha=new WeakMap,om=new WeakMap,qv=new WeakMap,Kv=new WeakMap,Ed=new WeakMap,CC=new WeakSet,V6=function(e){if(lo(this,qv,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Wi),e instanceof Wi)return lo(this,Kv,!0,"f"),this._emit("abort",e);if(e instanceof Mt)return this._emit("error",e);if(e instanceof Error){const n=new Mt(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new Mt(String(e)))};var Pt=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},pi=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},ns,TC,Lo,Ax,uo,ru,Jd,Wc,Yv,xi,kx,Rx,Lm,am,lm,CD,TD,ID,ND,PD,AD,kD;class xo extends zI{constructor(){super(...arguments),ns.add(this),TC.set(this,[]),Lo.set(this,{}),Ax.set(this,{}),uo.set(this,void 0),ru.set(this,void 0),Jd.set(this,void 0),Wc.set(this,void 0),Yv.set(this,void 0),xi.set(this,void 0),kx.set(this,void 0),Rx.set(this,void 0),Lm.set(this,void 0)}[(TC=new WeakMap,Lo=new WeakMap,Ax=new WeakMap,uo=new WeakMap,ru=new WeakMap,Jd=new WeakMap,Wc=new WeakMap,Yv=new WeakMap,xi=new WeakMap,kx=new WeakMap,Rx=new WeakMap,Lm=new WeakMap,ns=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new xo;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=Uo.fromReadableStream(e,this.controller);for await(const o of s)Pt(this,ns,"m",am).call(this,o);if((i=s.controller.signal)!=null&&i.aborted)throw new Wi;return this._addRun(Pt(this,ns,"m",lm).call(this))}toReadableStream(){return new Uo(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,s,i){const o=new xo;return o._run(()=>o._runToolAssistantStream(e,n,r,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,n,r,s,i){var u;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...s,stream:!0},c=await e.submitToolOutputs(n,r,l,{...i,signal:this.controller.signal});this._connected();for await(const d of c)Pt(this,ns,"m",am).call(this,d);if((u=c.controller.signal)!=null&&u.aborted)throw new Wi;return this._addRun(Pt(this,ns,"m",lm).call(this))}static createThreadAssistantStream(e,n,r){const s=new xo;return s._run(()=>s._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,n,r,s){const i=new xo;return i._run(()=>i._runAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return Pt(this,kx,"f")}currentRun(){return Pt(this,Rx,"f")}currentMessageSnapshot(){return Pt(this,uo,"f")}currentRunStepSnapshot(){return Pt(this,Lm,"f")}async finalRunSteps(){return await this.done(),Object.values(Pt(this,Lo,"f"))}async finalMessages(){return await this.done(),Object.values(Pt(this,Ax,"f"))}async finalRun(){if(await this.done(),!Pt(this,ru,"f"))throw Error("Final run was not received.");return Pt(this,ru,"f")}async _createThreadAssistantStream(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const c of o)Pt(this,ns,"m",am).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new Wi;return this._addRun(Pt(this,ns,"m",lm).call(this))}async _createAssistantStream(e,n,r,s){var c;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},l=await e.create(n,o,{...s,signal:this.controller.signal});this._connected();for await(const u of l)Pt(this,ns,"m",am).call(this,u);if((c=l.controller.signal)!=null&&c.aborted)throw new Wi;return this._addRun(Pt(this,ns,"m",lm).call(this))}static accumulateDelta(e,n){for(const[r,s]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(eS(i)&&eS(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...s);continue}for(const o of s){if(!eS(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const l=o.index;if(l==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const c=i[l];c==null?i.push(o):i[l]=this.accumulateDelta(c,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,s){return await this._createAssistantStream(n,e,r,s)}async _runToolAssistantStream(e,n,r,s,i){return await this._createToolAssistantStream(r,e,n,s,i)}}am=function(e){if(!this.ended)switch(pi(this,kx,e,"f"),Pt(this,ns,"m",ID).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Pt(this,ns,"m",kD).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Pt(this,ns,"m",TD).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Pt(this,ns,"m",CD).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},lm=function(){if(this.ended)throw new Mt("stream has ended, this shouldn't happen");if(!Pt(this,ru,"f"))throw Error("Final run has not been received");return Pt(this,ru,"f")},CD=function(e){const[n,r]=Pt(this,ns,"m",PD).call(this,e,Pt(this,uo,"f"));pi(this,uo,n,"f"),Pt(this,Ax,"f")[n.id]=n;for(const s of r){const i=n.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,o=n.content[s.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=Pt(this,Jd,"f")){if(Pt(this,Wc,"f"))switch(Pt(this,Wc,"f").type){case"text":this._emit("textDone",Pt(this,Wc,"f").text,Pt(this,uo,"f"));break;case"image_file":this._emit("imageFileDone",Pt(this,Wc,"f").image_file,Pt(this,uo,"f"));break}pi(this,Jd,s.index,"f")}pi(this,Wc,n.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Pt(this,Jd,"f")!==void 0){const s=e.data.content[Pt(this,Jd,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,Pt(this,uo,"f"));break;case"text":this._emit("textDone",s.text,Pt(this,uo,"f"));break}}Pt(this,uo,"f")&&this._emit("messageDone",e.data),pi(this,uo,void 0,"f")}},TD=function(e){const n=Pt(this,ns,"m",ND).call(this,e);switch(pi(this,Lm,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==Pt(this,Yv,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(Pt(this,xi,"f")&&this._emit("toolCallDone",Pt(this,xi,"f")),pi(this,Yv,i.index,"f"),pi(this,xi,n.step_details.tool_calls[i.index],"f"),Pt(this,xi,"f")&&this._emit("toolCallCreated",Pt(this,xi,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":pi(this,Lm,void 0,"f"),e.data.step_details.type=="tool_calls"&&Pt(this,xi,"f")&&(this._emit("toolCallDone",Pt(this,xi,"f")),pi(this,xi,void 0,"f")),this._emit("runStepDone",e.data,n);break}},ID=function(e){Pt(this,TC,"f").push(e),this._emit("event",e)},ND=function(e){switch(e.event){case"thread.run.step.created":return Pt(this,Lo,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=Pt(this,Lo,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=xo.accumulateDelta(n,r.delta);Pt(this,Lo,"f")[e.data.id]=s}return Pt(this,Lo,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Pt(this,Lo,"f")[e.data.id]=e.data;break}if(Pt(this,Lo,"f")[e.data.id])return Pt(this,Lo,"f")[e.data.id];throw new Error("No snapshot available")},PD=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in n.content){let o=n.content[i.index];n.content[i.index]=Pt(this,ns,"m",AD).call(this,i,o)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},AD=function(e,n){return xo.accumulateDelta(n,e)},kD=function(e){switch(pi(this,Rx,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":pi(this,ru,e.data,"f"),Pt(this,xi,"f")&&(this._emit("toolCallDone",Pt(this,xi,"f")),pi(this,xi,void 0,"f"));break}};class GI extends Vt{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/assistants/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/assistants",WI,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class WI extends Vr{}GI.AssistantsPage=WI;function RD(t){return typeof t.parse=="function"}const uh=t=>(t==null?void 0:t.role)==="assistant",U6=t=>(t==null?void 0:t.role)==="function",B6=t=>(t==null?void 0:t.role)==="tool";function HI(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function pg(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function Qhe(t,e){return!e||!z6(e)?{...t,choices:t.choices.map(n=>({...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:qI(t,e)}function qI(t,e){const n=t.choices.map(r=>{var s;if(r.finish_reason==="length")throw new E6;if(r.finish_reason==="content_filter")throw new C6;return{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(i=>efe(e,i)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?Zhe(e,r.message.content):null}}});return{...t,choices:n}}function Zhe(t,e){var n,r;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=t.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function efe(t,e){var r;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:pg(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function tfe(t,e){var r;if(!t)return!1;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return pg(n)||(n==null?void 0:n.function.strict)||!1}function z6(t){var e;return HI(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>pg(n)||n.type==="function"&&n.function.strict===!0))??!1}function nfe(t){for(const e of t??[]){if(e.type!=="function")throw new Mt(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new Mt(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Xs=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},ws,IC,Jv,NC,PC,AC,G6,kC;const jD=10;class W6 extends zI{constructor(){super(...arguments),ws.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(U6(e)||B6(e))&&e.content)this._emit("functionCallResult",e.content);else if(uh(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(uh(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new Mt("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),Xs(this,ws,"m",IC).call(this)}async finalMessage(){return await this.done(),Xs(this,ws,"m",Jv).call(this)}async finalFunctionCall(){return await this.done(),Xs(this,ws,"m",NC).call(this)}async finalFunctionCallResult(){return await this.done(),Xs(this,ws,"m",PC).call(this)}async totalUsage(){return await this.done(),Xs(this,ws,"m",AC).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=Xs(this,ws,"m",Jv).call(this);n&&this._emit("finalMessage",n);const r=Xs(this,ws,"m",IC).call(this);r&&this._emit("finalContent",r);const s=Xs(this,ws,"m",NC).call(this);s&&this._emit("finalFunctionCall",s);const i=Xs(this,ws,"m",PC).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",Xs(this,ws,"m",AC).call(this))}async _createChatCompletion(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Xs(this,ws,"m",G6).call(this,n);const i=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(qI(i,n))}async _runChatCompletion(e,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,n,r)}async _runFunctions(e,n,r){var f;const s="function",{function_call:i="auto",stream:o,...l}=n,c=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:u=jD}=r||{},d={};for(const m of n.functions)d[m.name||m.function.name]=m;const h=n.functions.map(m=>({name:m.name||m.function.name,parameters:m.parameters,description:m.description}));for(const m of n.messages)this._addMessage(m,!1);for(let m=0;m<u;++m){const x=(f=(await this._createChatCompletion(e,{...l,function_call:i,functions:h,messages:[...this.messages]},r)).choices[0])==null?void 0:f.message;if(!x)throw new Mt("missing message in ChatCompletion response");if(!x.function_call)return;const{name:E,arguments:v}=x.function_call,b=d[E];if(b){if(c&&c!==E){const k=`Invalid function_call: ${JSON.stringify(E)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,name:E,content:k});continue}}else{const k=`Invalid function_call: ${JSON.stringify(E)}. Available options are: ${h.map(C=>JSON.stringify(C.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:E,content:k});continue}let S;try{S=RD(b)?await b.parse(v):v}catch(k){this._addMessage({role:s,name:E,content:k instanceof Error?k.message:String(k)});continue}const I=await b.function(S,this),D=Xs(this,ws,"m",kC).call(this,I);if(this._addMessage({role:s,name:E,content:D}),c)return}}async _runTools(e,n,r){var m,g,x;const s="tool",{tool_choice:i="auto",stream:o,...l}=n,c=typeof i!="string"&&((m=i==null?void 0:i.function)==null?void 0:m.name),{maxChatCompletions:u=jD}=r||{},d=n.tools.map(E=>{if(pg(E)){if(!E.$callback)throw new Mt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:E.$callback,name:E.function.name,description:E.function.description||"",parameters:E.function.parameters,parse:E.$parseRaw,strict:!0}}}return E}),h={};for(const E of d)E.type==="function"&&(h[E.function.name||E.function.function.name]=E.function);const f="tools"in n?d.map(E=>E.type==="function"?{type:"function",function:{name:E.function.name||E.function.function.name,parameters:E.function.parameters,description:E.function.description,strict:E.function.strict}}:E):void 0;for(const E of n.messages)this._addMessage(E,!1);for(let E=0;E<u;++E){const b=(g=(await this._createChatCompletion(e,{...l,tool_choice:i,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:g.message;if(!b)throw new Mt("missing message in ChatCompletion response");if(!((x=b.tool_calls)!=null&&x.length))return;for(const S of b.tool_calls){if(S.type!=="function")continue;const I=S.id,{name:D,arguments:k}=S.function,C=h[D];if(C){if(c&&c!==D){const R=`Invalid tool_call: ${JSON.stringify(D)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,tool_call_id:I,content:R});continue}}else{const R=`Invalid tool_call: ${JSON.stringify(D)}. Available options are: ${Object.keys(h).map(M=>JSON.stringify(M)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:I,content:R});continue}let T;try{T=RD(C)?await C.parse(k):k}catch(R){const M=R instanceof Error?R.message:String(R);this._addMessage({role:s,tool_call_id:I,content:M});continue}const P=await C.function(T,this),A=Xs(this,ws,"m",kC).call(this,P);if(this._addMessage({role:s,tool_call_id:I,content:A}),c)return}}}}ws=new WeakSet,IC=function(){return Xs(this,ws,"m",Jv).call(this).content??null},Jv=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(uh(n)){const{function_call:r,...s}=n,i={...s,content:n.content??null,refusal:n.refusal??null};return r&&(i.function_call=r),i}}throw new Mt("stream ended without producing a ChatCompletionMessage with role=assistant")},NC=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(uh(s)&&(s!=null&&s.function_call))return s.function_call;if(uh(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(n=s.tool_calls.at(-1))==null?void 0:n.function}},PC=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(U6(n)&&n.content!=null||B6(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},AC=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},G6=function(e){if(e.n!=null&&e.n>1)throw new Mt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},kC=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Ep extends W6{static runFunctions(e,n,r){const s=new Ep,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Ep,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}_addMessage(e,n=!0){super._addMessage(e,n),uh(e)&&e.content&&this._emit("content",e.content)}}const H6=1,q6=2,K6=4,Y6=8,J6=16,X6=32,Q6=64,Z6=128,eB=256,tB=Z6|eB,nB=J6|X6|tB|Q6,rB=H6|q6|nB,sB=K6|Y6,rfe=rB|sB,Gr={STR:H6,NUM:q6,ARR:K6,OBJ:Y6,NULL:J6,BOOL:X6,NAN:Q6,INFINITY:Z6,MINUS_INFINITY:eB,INF:tB,SPECIAL:nB,ATOM:rB,COLLECTION:sB,ALL:rfe};class sfe extends Error{}class ife extends Error{}function ofe(t,e=Gr.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return afe(t.trim(),e)}const afe=(t,e)=>{const n=t.length;let r=0;const s=f=>{throw new sfe(`${f} at position ${r}`)},i=f=>{throw new ife(`${f} at position ${r}`)},o=()=>(h(),r>=n&&s("Unexpected end of input"),t[r]==='"'?l():t[r]==="{"?c():t[r]==="["?u():t.substring(r,r+4)==="null"||Gr.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||Gr.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||Gr.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||Gr.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||Gr.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||Gr.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):d()),l=()=>{const f=r;let m=!1;for(r++;r<n&&(t[r]!=='"'||m&&t[r-1]==="\\");)m=t[r]==="\\"?!m:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(f,++r-Number(m)))}catch(g){i(String(g))}else if(Gr.STR&e)try{return JSON.parse(t.substring(f,r-Number(m))+'"')}catch{return JSON.parse(t.substring(f,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{r++,h();const f={};try{for(;t[r]!=="}";){if(h(),r>=n&&Gr.OBJ&e)return f;const m=l();h(),r++;try{const g=o();Object.defineProperty(f,m,{value:g,writable:!0,enumerable:!0,configurable:!0})}catch(g){if(Gr.OBJ&e)return f;throw g}h(),t[r]===","&&r++}}catch{if(Gr.OBJ&e)return f;s("Expected '}' at end of object")}return r++,f},u=()=>{r++;const f=[];try{for(;t[r]!=="]";)f.push(o()),h(),t[r]===","&&r++}catch{if(Gr.ARR&e)return f;s("Expected ']' at end of array")}return r++,f},d=()=>{if(r===0){t==="-"&&Gr.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(m){if(Gr.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}i(String(m))}}const f=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(Gr.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(t.substring(f,r))}catch{t.substring(f,r)==="-"&&Gr.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(f,t.lastIndexOf("e")))}catch(g){i(String(g))}}},h=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return o()},DD=t=>ofe(t,Gr.ALL^Gr.NUM);var cd=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},jn=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Mr,da,ud,tl,tS,My,nS,rS,sS,Ly,iS,MD;class Cp extends W6{constructor(e){super(),Mr.add(this),da.set(this,void 0),ud.set(this,void 0),tl.set(this,void 0),cd(this,da,e,"f"),cd(this,ud,[],"f")}get currentChatCompletionSnapshot(){return jn(this,tl,"f")}static fromReadableStream(e){const n=new Cp(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const s=new Cp(n);return s._run(()=>s._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,n,r){var o;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),jn(this,Mr,"m",tS).call(this);const i=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const l of i)jn(this,Mr,"m",nS).call(this,l);if((o=i.controller.signal)!=null&&o.aborted)throw new Wi;return this._addChatCompletion(jn(this,Mr,"m",Ly).call(this))}async _fromReadableStream(e,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),jn(this,Mr,"m",tS).call(this),this._connected();const s=Uo.fromReadableStream(e,this.controller);let i;for await(const l of s)i&&i!==l.id&&this._addChatCompletion(jn(this,Mr,"m",Ly).call(this)),jn(this,Mr,"m",nS).call(this,l),i=l.id;if((o=s.controller.signal)!=null&&o.aborted)throw new Wi;return this._addChatCompletion(jn(this,Mr,"m",Ly).call(this))}[(da=new WeakMap,ud=new WeakMap,tl=new WeakMap,Mr=new WeakSet,tS=function(){this.ended||cd(this,tl,void 0,"f")},My=function(n){let r=jn(this,ud,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},jn(this,ud,"f")[n.index]=r,r)},nS=function(n){var s,i,o,l,c,u,d,h,f,m,g,x,E,v,b;if(this.ended)return;const r=jn(this,Mr,"m",MD).call(this,n);this._emit("chunk",n,r);for(const S of n.choices){const I=r.choices[S.index];S.delta.content!=null&&((s=I.message)==null?void 0:s.role)==="assistant"&&((i=I.message)!=null&&i.content)&&(this._emit("content",S.delta.content,I.message.content),this._emit("content.delta",{delta:S.delta.content,snapshot:I.message.content,parsed:I.message.parsed})),S.delta.refusal!=null&&((o=I.message)==null?void 0:o.role)==="assistant"&&((l=I.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:S.delta.refusal,snapshot:I.message.refusal}),((c=S.logprobs)==null?void 0:c.content)!=null&&((u=I.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(d=S.logprobs)==null?void 0:d.content,snapshot:((h=I.logprobs)==null?void 0:h.content)??[]}),((f=S.logprobs)==null?void 0:f.refusal)!=null&&((m=I.message)==null?void 0:m.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(g=S.logprobs)==null?void 0:g.refusal,snapshot:((x=I.logprobs)==null?void 0:x.refusal)??[]});const D=jn(this,Mr,"m",My).call(this,I);I.finish_reason&&(jn(this,Mr,"m",sS).call(this,I),D.current_tool_call_index!=null&&jn(this,Mr,"m",rS).call(this,I,D.current_tool_call_index));for(const k of S.delta.tool_calls??[])D.current_tool_call_index!==k.index&&(jn(this,Mr,"m",sS).call(this,I),D.current_tool_call_index!=null&&jn(this,Mr,"m",rS).call(this,I,D.current_tool_call_index)),D.current_tool_call_index=k.index;for(const k of S.delta.tool_calls??[]){const C=(E=I.message.tool_calls)==null?void 0:E[k.index];C!=null&&C.type&&((C==null?void 0:C.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=C.function)==null?void 0:v.name,index:k.index,arguments:C.function.arguments,parsed_arguments:C.function.parsed_arguments,arguments_delta:((b=k.function)==null?void 0:b.arguments)??""}):(C==null||C.type,void 0))}}},rS=function(n,r){var o,l,c;if(jn(this,Mr,"m",My).call(this,n).done_tool_calls.has(r))return;const i=(o=n.message.tool_calls)==null?void 0:o[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const u=(c=(l=jn(this,da,"f"))==null?void 0:l.tools)==null?void 0:c.find(d=>d.type==="function"&&d.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:pg(u)?u.$parseRaw(i.function.arguments):u!=null&&u.function.strict?JSON.parse(i.function.arguments):null})}else i.type},sS=function(n){var s,i;const r=jn(this,Mr,"m",My).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const o=jn(this,Mr,"m",iS).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(s=n.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(i=n.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},Ly=function(){if(this.ended)throw new Mt("stream has ended, this shouldn't happen");const n=jn(this,tl,"f");if(!n)throw new Mt("request ended without sending any chunks");return cd(this,tl,void 0,"f"),cd(this,ud,[],"f"),lfe(n,jn(this,da,"f"))},iS=function(){var r;const n=(r=jn(this,da,"f"))==null?void 0:r.response_format;return HI(n)?n:null},MD=function(n){var r,s,i,o;let l=jn(this,tl,"f");const{choices:c,...u}=n;l?Object.assign(l,u):l=cd(this,tl,{...u,choices:[]},"f");for(const{delta:d,finish_reason:h,index:f,logprobs:m=null,...g}of n.choices){let x=l.choices[f];if(x||(x=l.choices[f]={finish_reason:h,index:f,message:{},logprobs:m,...g}),m)if(!x.logprobs)x.logprobs=Object.assign({},m);else{const{content:k,refusal:C,...T}=m;Object.assign(x.logprobs,T),k&&((r=x.logprobs).content??(r.content=[]),x.logprobs.content.push(...k)),C&&((s=x.logprobs).refusal??(s.refusal=[]),x.logprobs.refusal.push(...C))}if(h&&(x.finish_reason=h,jn(this,da,"f")&&z6(jn(this,da,"f")))){if(h==="length")throw new E6;if(h==="content_filter")throw new C6}if(Object.assign(x,g),!d)continue;const{content:E,refusal:v,function_call:b,role:S,tool_calls:I,...D}=d;if(Object.assign(x.message,D),v&&(x.message.refusal=(x.message.refusal||"")+v),S&&(x.message.role=S),b&&(x.message.function_call?(b.name&&(x.message.function_call.name=b.name),b.arguments&&((i=x.message.function_call).arguments??(i.arguments=""),x.message.function_call.arguments+=b.arguments)):x.message.function_call=b),E&&(x.message.content=(x.message.content||"")+E,!x.message.refusal&&jn(this,Mr,"m",iS).call(this)&&(x.message.parsed=DD(x.message.content))),I){x.message.tool_calls||(x.message.tool_calls=[]);for(const{index:k,id:C,type:T,function:P,...A}of I){const R=(o=x.message.tool_calls)[k]??(o[k]={});Object.assign(R,A),C&&(R.id=C),T&&(R.type=T),P&&(R.function??(R.function={name:P.name??"",arguments:""})),P!=null&&P.name&&(R.function.name=P.name),P!=null&&P.arguments&&(R.function.arguments+=P.arguments,tfe(jn(this,da,"f"),R)&&(R.function.parsed_arguments=DD(R.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Uo(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function lfe(t,e){const{id:n,choices:r,created:s,model:i,system_fingerprint:o,...l}=t,c={...l,id:n,choices:r.map(({message:u,finish_reason:d,index:h,logprobs:f,...m})=>{if(!d)throw new Mt(`missing finish_reason for choice ${h}`);const{content:g=null,function_call:x,tool_calls:E,...v}=u,b=u.role;if(!b)throw new Mt(`missing role for choice ${h}`);if(x){const{arguments:S,name:I}=x;if(S==null)throw new Mt(`missing function_call.arguments for choice ${h}`);if(!I)throw new Mt(`missing function_call.name for choice ${h}`);return{...m,message:{content:g,function_call:{arguments:S,name:I},role:b,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}return E?{...m,index:h,finish_reason:d,logprobs:f,message:{...v,role:b,content:g,refusal:u.refusal??null,tool_calls:E.map((S,I)=>{const{function:D,type:k,id:C,...T}=S,{arguments:P,name:A,...R}=D||{};if(C==null)throw new Mt(`missing choices[${h}].tool_calls[${I}].id
${Fy(t)}`);if(k==null)throw new Mt(`missing choices[${h}].tool_calls[${I}].type
${Fy(t)}`);if(A==null)throw new Mt(`missing choices[${h}].tool_calls[${I}].function.name
${Fy(t)}`);if(P==null)throw new Mt(`missing choices[${h}].tool_calls[${I}].function.arguments
${Fy(t)}`);return{...T,id:C,type:k,function:{...R,name:A,arguments:P}}})}}:{...m,message:{...v,content:g,role:b,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}),created:s,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return Qhe(c,e)}function Fy(t){return JSON.stringify(t)}class dh extends Cp{static fromReadableStream(e){const n=new dh(null);return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,r){const s=new dh(null),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new dh(n),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}}let iB=class extends Vt{parse(e,n){return nfe(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>qI(r,e))}runFunctions(e,n){return e.stream?dh.runFunctions(this._client,e,n):Ep.runFunctions(this._client,e,n)}runTools(e,n){return e.stream?dh.runTools(this._client,e,n):Ep.runTools(this._client,e,n)}stream(e,n){return Cp.createChatCompletion(this._client,e,n)}};class RC extends Vt{constructor(){super(...arguments),this.completions=new iB(this._client)}}(function(t){t.Completions=iB})(RC||(RC={}));class oB extends Vt{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class aB extends Vt{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class B0 extends Vt{constructor(){super(...arguments),this.sessions=new oB(this._client),this.transcriptionSessions=new aB(this._client)}}B0.Sessions=oB;B0.TranscriptionSessions=aB;class KI extends Vt{create(e,n,r){return this._client.post(`/threads/${e}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/messages/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,YI,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class YI extends Vr{}KI.MessagesPage=YI;class JI extends Vt{retrieve(e,n,r,s={},i){return dr(s)?this.retrieve(e,n,r,{},s):this._client.get(`/threads/${e}/runs/${n}/steps/${r}`,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,n,r={},s){return dr(r)?this.list(e,n,{},r):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,XI,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class XI extends Vr{}JI.RunStepsPage=XI;let gg=class extends Vt{constructor(){super(...arguments),this.steps=new JI(this._client)}create(e,n,r){const{include:s,...i}=n;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:i,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(e,n,r){return this._client.get(`/threads/${e}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,QI,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}createAndStream(e,n,r){return xo.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await fg(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,n,r){return xo.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,n,r,s){const i=await this.submitToolOutputs(e,n,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,n,r,s){return xo.createToolAssistantStream(e,n,this._client.beta.threads.runs,r,s)}};class QI extends Vr{}gg.RunsPage=QI;gg.Steps=JI;gg.RunStepsPage=XI;class of extends Vt{constructor(){super(...arguments),this.runs=new gg(this._client),this.messages=new KI(this._client)}create(e={},n){return dr(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/threads/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(e,n){return xo.createThreadAssistantStream(e,this._client.beta.threads,n)}}of.Runs=gg;of.RunsPage=QI;of.Messages=KI;of.MessagesPage=YI;class af extends Vt{constructor(){super(...arguments),this.realtime=new B0(this._client),this.chat=new RC(this._client),this.assistants=new GI(this._client),this.threads=new of(this._client)}}af.Realtime=B0;af.Assistants=GI;af.AssistantsPage=WI;af.Threads=of;class lB extends Vt{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}let cB=class extends Vt{retrieve(e,n,r){return this._client.get(`/containers/${e}/files/${n}/content`,{...r,headers:{Accept:"application/binary",...r==null?void 0:r.headers},__binaryResponse:!0})}},z0=class extends Vt{constructor(){super(...arguments),this.content=new cB(this._client)}create(e,n,r){return this._client.post(`/containers/${e}/files`,Cu({body:n,...r}))}retrieve(e,n,r){return this._client.get(`/containers/${e}/files/${n}`,r)}list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/containers/${e}/files`,ZI,{query:n,...r})}del(e,n,r){return this._client.delete(`/containers/${e}/files/${n}`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}};class ZI extends Vr{}z0.FileListResponsesPage=ZI;z0.Content=cB;class yg extends Vt{constructor(){super(...arguments),this.files=new z0(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(`/containers/${e}`,n)}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/containers",eN,{query:e,...n})}del(e,n){return this._client.delete(`/containers/${e}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}}class eN extends Vr{}yg.ContainerListResponsesPage=eN;yg.Files=z0;yg.FileListResponsesPage=ZI;class uB extends Vt{create(e,n){const r=!!e.encoding_format;let s=r?e.encoding_format:"base64";r&&$l("Request","User defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:s},...n});return r?i:($l("response","Decoding base64 embeddings to float32 array"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(l=>{const c=l.embedding;l.embedding=Jhe(c)}),o)))}}class tN extends Vt{retrieve(e,n,r,s){return this._client.get(`/evals/${e}/runs/${n}/output_items/${r}`,s)}list(e,n,r={},s){return dr(r)?this.list(e,n,{},r):this._client.getAPIList(`/evals/${e}/runs/${n}/output_items`,nN,{query:r,...s})}}class nN extends Vr{}tN.OutputItemListResponsesPage=nN;class xg extends Vt{constructor(){super(...arguments),this.outputItems=new tN(this._client)}create(e,n,r){return this._client.post(`/evals/${e}/runs`,{body:n,...r})}retrieve(e,n,r){return this._client.get(`/evals/${e}/runs/${n}`,r)}list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/evals/${e}/runs`,rN,{query:n,...r})}del(e,n,r){return this._client.delete(`/evals/${e}/runs/${n}`,r)}cancel(e,n,r){return this._client.post(`/evals/${e}/runs/${n}`,r)}}class rN extends Vr{}xg.RunListResponsesPage=rN;xg.OutputItems=tN;xg.OutputItemListResponsesPage=nN;class vg extends Vt{constructor(){super(...arguments),this.runs=new xg(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(`/evals/${e}`,n)}update(e,n,r){return this._client.post(`/evals/${e}`,{body:n,...r})}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/evals",sN,{query:e,...n})}del(e,n){return this._client.delete(`/evals/${e}`,n)}}class sN extends Vr{}vg.EvalListResponsesPage=sN;vg.Runs=xg;vg.RunListResponsesPage=rN;let iN=class extends Vt{create(e,n){return this._client.post("/files",Cu({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/files",oN,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,n)}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!s.has(o.status);)if(await fg(n),o=await this.retrieve(e),Date.now()-i>r)throw new VI({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}};class oN extends Vr{}iN.FileObjectsPage=oN;class dB extends Vt{}let hB=class extends Vt{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class aN extends Vt{constructor(){super(...arguments),this.graders=new hB(this._client)}}aN.Graders=hB;class lN extends Vt{create(e,n,r){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,cN,{body:n,method:"post",...r})}retrieve(e,n={},r){return dr(n)?this.retrieve(e,{},n):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...r})}del(e,n,r){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${n}`,r)}}class cN extends O0{}lN.PermissionCreateResponsesPage=cN;let G0=class extends Vt{constructor(){super(...arguments),this.permissions=new lN(this._client)}};G0.Permissions=lN;G0.PermissionCreateResponsesPage=cN;class uN extends Vt{list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,dN,{query:n,...r})}}class dN extends Vr{}uN.FineTuningJobCheckpointsPage=dN;class lf extends Vt{constructor(){super(...arguments),this.checkpoints=new uN(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",hN,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return dr(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,fN,{query:n,...r})}pause(e,n){return this._client.post(`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(`/fine_tuning/jobs/${e}/resume`,n)}}class hN extends Vr{}class fN extends Vr{}lf.FineTuningJobsPage=hN;lf.FineTuningJobEventsPage=fN;lf.Checkpoints=uN;lf.FineTuningJobCheckpointsPage=dN;class xc extends Vt{constructor(){super(...arguments),this.methods=new dB(this._client),this.jobs=new lf(this._client),this.checkpoints=new G0(this._client),this.alpha=new aN(this._client)}}xc.Methods=dB;xc.Jobs=lf;xc.FineTuningJobsPage=hN;xc.FineTuningJobEventsPage=fN;xc.Checkpoints=G0;xc.Alpha=aN;class fB extends Vt{}class mN extends Vt{constructor(){super(...arguments),this.graderModels=new fB(this._client)}}mN.GraderModels=fB;class mB extends Vt{createVariation(e,n){return this._client.post("/images/variations",Cu({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",Cu({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}class pN extends Vt{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",gN,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class gN extends O0{}pN.ModelsPage=gN;class pB extends Vt{create(e,n){return this._client.post("/moderations",{body:e,...n})}}function cfe(t,e){return!e||!dfe(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(r=>({...r,parsed:null}))}:n)}:gB(t,e)}function gB(t,e){const n=t.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:mfe(e,s)};if(s.type==="message"){const i=s.content.map(o=>o.type==="output_text"?{...o,parsed:ufe(e,o.text)}:o);return{...s,content:i}}return s}),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||yB(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const s of r.output)if(s.type==="message"){for(const i of s.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),r}function ufe(t,e){var n,r,s,i;return((r=(n=t.text)==null?void 0:n.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((s=t.text)==null?void 0:s.format)?((i=t.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function dfe(t){var e;return!!HI((e=t.text)==null?void 0:e.format)}function hfe(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function ffe(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function mfe(t,e){const n=ffe(t.tools??[],e.name);return{...e,...e,parsed_arguments:hfe(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function yB(t){const e=[];for(const n of t.output)if(n.type==="message")for(const r of n.content)r.type==="output_text"&&e.push(r.text);t.output_text=e.join("")}class xB extends Vt{list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/responses/${e}/input_items`,gfe,{query:n,...r})}}var dd=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},nl=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},hd,Oy,rl,$y,LD,FD,OD,$D;class yN extends zI{constructor(e){super(),hd.add(this),Oy.set(this,void 0),rl.set(this,void 0),$y.set(this,void 0),dd(this,Oy,e,"f")}static createResponse(e,n,r){const s=new yN(n);return s._run(()=>s._createOrRetrieveResponse(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createOrRetrieveResponse(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),nl(this,hd,"m",LD).call(this);let i,o=null;"response_id"in n?(i=await e.responses.retrieve(n.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),o=n.starting_after??null):i=await e.responses.create({...n,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const c of i)nl(this,hd,"m",FD).call(this,c,o);if((l=i.controller.signal)!=null&&l.aborted)throw new Wi;return nl(this,hd,"m",OD).call(this)}[(Oy=new WeakMap,rl=new WeakMap,$y=new WeakMap,hd=new WeakSet,LD=function(){this.ended||dd(this,rl,void 0,"f")},FD=function(n,r){if(this.ended)return;const s=(o,l)=>{(r==null||l.sequence_number>r)&&this._emit(o,l)},i=nl(this,hd,"m",$D).call(this,n);switch(s("event",n),n.type){case"response.output_text.delta":{const o=i.output[n.output_index];if(!o)throw new Mt(`missing output at index ${n.output_index}`);if(o.type==="message"){const l=o.content[n.content_index];if(!l)throw new Mt(`missing content at index ${n.content_index}`);if(l.type!=="output_text")throw new Mt(`expected content to be 'output_text', got ${l.type}`);s("response.output_text.delta",{...n,snapshot:l.text})}break}case"response.function_call_arguments.delta":{const o=i.output[n.output_index];if(!o)throw new Mt(`missing output at index ${n.output_index}`);o.type==="function_call"&&s("response.function_call_arguments.delta",{...n,snapshot:o.arguments});break}default:s(n.type,n);break}},OD=function(){if(this.ended)throw new Mt("stream has ended, this shouldn't happen");const n=nl(this,rl,"f");if(!n)throw new Mt("request ended without sending any events");dd(this,rl,void 0,"f");const r=pfe(n,nl(this,Oy,"f"));return dd(this,$y,r,"f"),r},$D=function(n){let r=nl(this,rl,"f");if(!r){if(n.type!=="response.created")throw new Mt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return r=dd(this,rl,n.response,"f"),r}switch(n.type){case"response.output_item.added":{r.output.push(n.item);break}case"response.content_part.added":{const s=r.output[n.output_index];if(!s)throw new Mt(`missing output at index ${n.output_index}`);s.type==="message"&&s.content.push(n.part);break}case"response.output_text.delta":{const s=r.output[n.output_index];if(!s)throw new Mt(`missing output at index ${n.output_index}`);if(s.type==="message"){const i=s.content[n.content_index];if(!i)throw new Mt(`missing content at index ${n.content_index}`);if(i.type!=="output_text")throw new Mt(`expected content to be 'output_text', got ${i.type}`);i.text+=n.delta}break}case"response.function_call_arguments.delta":{const s=r.output[n.output_index];if(!s)throw new Mt(`missing output at index ${n.output_index}`);s.type==="function_call"&&(s.arguments+=n.delta);break}case"response.completed":{dd(this,rl,n.response,"f");break}}return r},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=nl(this,$y,"f");if(!e)throw new Mt("stream ended without producing a ChatCompletion");return e}}function pfe(t,e){return cfe(t,e)}class xN extends Vt{constructor(){super(...arguments),this.inputItems=new xB(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&yB(r),r))}retrieve(e,n={},r){return this._client.get(`/responses/${e}`,{query:n,...r,stream:(n==null?void 0:n.stream)??!1})}del(e,n){return this._client.delete(`/responses/${e}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(r=>gB(r,e))}stream(e,n){return yN.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(`/responses/${e}/cancel`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}}class gfe extends Vr{}xN.InputItems=xB;class vB extends Vt{create(e,n,r){return this._client.post(`/uploads/${e}/parts`,Cu({body:n,...r}))}}class vN extends Vt{constructor(){super(...arguments),this.parts=new vB(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(`/uploads/${e}/complete`,{body:n,...r})}}vN.Parts=vB;const yfe=async t=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};class W0 extends Vt{create(e,n,r){return this._client.post(`/vector_stores/${e}/files`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/vector_stores/${e}/files/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,H0,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,n,{...r,headers:s}).withResponse(),o=i.data;switch(o.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=i.response.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await fg(l);break;case"failed":case"completed":return o}}}async upload(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,n,r){const s=await this.upload(e,n,r);return await this.poll(e,s.id,r)}content(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/files/${n}/content`,wN,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class H0 extends Vr{}class wN extends O0{}W0.VectorStoreFilesPage=H0;W0.FileContentResponsesPage=wN;class wB extends Vt{create(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n);return await this.poll(e,s.id,r)}listFiles(e,n,r={},s){return dr(r)?this.listFiles(e,n,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,H0,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await fg(l);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},s){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(s==null?void 0:s.maxConcurrency)??5,o=Math.min(i,n.length),l=this._client,c=n.values(),u=[...r];async function d(f){for(let m of f){const g=await l.files.create({file:m,purpose:"assistants"},s);u.push(g.id)}}const h=Array(o).fill(c).map(d);return await yfe(h),await this.createAndPoll(e,{file_ids:u})}}class vc extends Vt{constructor(){super(...arguments),this.files=new W0(this._client),this.fileBatches=new wB(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/vector_stores/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/vector_stores",bN,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}search(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/search`,_N,{body:n,method:"post",...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class bN extends Vr{}class _N extends O0{}vc.VectorStoresPage=bN;vc.VectorStoreSearchResponsesPage=_N;vc.Files=W0;vc.VectorStoreFilesPage=H0;vc.FileContentResponsesPage=wN;vc.FileBatches=wB;var bB;class Zt extends Ohe{constructor({baseURL:e=jy("OPENAI_BASE_URL"),apiKey:n=jy("OPENAI_API_KEY"),organization:r=jy("OPENAI_ORG_ID")??null,project:s=jy("OPENAI_PROJECT_ID")??null,...i}={}){if(n===void 0)throw new Mt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:n,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&Khe())throw new Mt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new lB(this),this.chat=new U0(this),this.embeddings=new uB(this),this.files=new iN(this),this.images=new mB(this),this.audio=new mg(this),this.moderations=new pB(this),this.models=new pN(this),this.fineTuning=new xc(this),this.graders=new mN(this),this.vectorStores=new vc(this),this.beta=new af(this),this.batches=new UI(this),this.uploads=new vN(this),this.responses=new xN(this),this.evals=new vg(this),this.containers=new yg(this),this._options=o,this.apiKey=n,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return whe(e,{arrayFormat:"brackets"})}}bB=Zt;Zt.OpenAI=bB;Zt.DEFAULT_TIMEOUT=6e5;Zt.OpenAIError=Mt;Zt.APIError=ds;Zt.APIConnectionError=D0;Zt.APIConnectionTimeoutError=VI;Zt.APIUserAbortError=Wi;Zt.NotFoundError=v6;Zt.ConflictError=w6;Zt.RateLimitError=_6;Zt.BadRequestError=g6;Zt.AuthenticationError=y6;Zt.InternalServerError=S6;Zt.PermissionDeniedError=x6;Zt.UnprocessableEntityError=b6;Zt.toFile=P6;Zt.fileFromPath=f6;Zt.Completions=lB;Zt.Chat=U0;Zt.ChatCompletionsPage=V0;Zt.Embeddings=uB;Zt.Files=iN;Zt.FileObjectsPage=oN;Zt.Images=mB;Zt.Audio=mg;Zt.Moderations=pB;Zt.Models=pN;Zt.ModelsPage=gN;Zt.FineTuning=xc;Zt.Graders=mN;Zt.VectorStores=vc;Zt.VectorStoresPage=bN;Zt.VectorStoreSearchResponsesPage=_N;Zt.Beta=af;Zt.Batches=UI;Zt.BatchesPage=BI;Zt.Uploads=vN;Zt.Responses=xN;Zt.Evals=vg;Zt.EvalListResponsesPage=sN;Zt.Containers=yg;Zt.ContainerListResponsesPage=eN;const xfe=Zt,vfe="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",wfe=new xfe({apiKey:vfe,dangerouslyAllowBrowser:!0});async function bfe(t,e={}){if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required for OpenAI image generation.");console.log(`[OpenAI] Generating image with prompt: "${t}"`);try{const n=await wfe.images.generate({model:"gpt-image-1",prompt:t,n:e.n||1,size:e.size||"1024x1024",quality:e.quality||"auto",response_format:"b64_json"});if(console.log("[OpenAI] Image generation response:",n),n.data&&n.data.length>0&&n.data[0].b64_json)return{b64_json:n.data[0].b64_json,alt:`OpenAI generated image for: ${t.substring(0,50)}`,revised_prompt:n.data[0].revised_prompt};throw new Error("No image data found in OpenAI response.")}catch(n){throw console.error("[OpenAI] Error generating image:",n),n.response&&n.response.data&&n.response.data.error?new Error(`OpenAI API Error: ${n.response.data.error.message}`):n}}const _fe=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _B=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Sfe=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},SB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,h=(i&3)<<4|l>>4;let f=(l&15)<<2|u>>6,m=u&63;c||(m=64,o||(f=64)),r.push(n[d],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(_B(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Sfe(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||h==null)throw new Efe;const f=i<<2|l>>4;if(r.push(f),u!==64){const m=l<<4&240|u>>2;if(r.push(m),h!==64){const g=u<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Efe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Cfe=function(t){const e=_B(t);return SB.encodeByteArray(e,!0)},Xv=function(t){return Cfe(t).replace(/\./g,"")},EB=function(t){try{return SB.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CB(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tfe=()=>CB().__FIREBASE_DEFAULTS__,Ife=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Nfe=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&EB(t[1]);return e&&JSON.parse(e)},q0=()=>{try{return _fe()||Tfe()||Ife()||Nfe()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},TB=t=>{var e,n;return(n=(e=q0())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},SN=t=>{const e=TB(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},IB=()=>{var t;return(t=q0())===null||t===void 0?void 0:t.config},NB=t=>{var e;return(e=q0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pfe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wc(t){return t.endsWith(".cloudworkstations.dev")}async function K0(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PB(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[Xv(JSON.stringify(n)),Xv(JSON.stringify(o)),l].join(".")}const Fm={};function Afe(){const t={prod:[],emulator:[]};for(const e of Object.keys(Fm))Fm[e]?t.emulator.push(e):t.prod.push(e);return t}function kfe(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let VD=!1;function Y0(t,e){if(typeof window>"u"||typeof document>"u"||!wc(window.location.host)||Fm[t]===e||Fm[t]||VD)return;Fm[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=Afe().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function l(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,m){f.setAttribute("width","24"),f.setAttribute("id",m),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function u(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{VD=!0,o()},f}function d(f,m){f.setAttribute("id",m),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=kfe(r),m=n("text"),g=document.getElementById(m)||document.createElement("span"),x=n("learnmore"),E=document.getElementById(x)||document.createElement("a"),v=n("preprendIcon"),b=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const S=f.element;l(S),d(E,x);const I=u();c(b,v),S.append(b,g,E,I),document.body.appendChild(S)}i?(g.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $r(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Rfe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($r())}function AB(){var t;const e=(t=q0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function jfe(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Dfe(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Mfe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Lfe(){const t=$r();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function kB(){return!AB()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function RB(){return!AB()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function jB(){try{return typeof indexedDB=="object"}catch{return!1}}function Ffe(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ofe="FirebaseError";class Po extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Ofe,Object.setPrototypeOf(this,Po.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wg.prototype.create)}}class wg{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?$fe(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Po(s,l,r)}}function $fe(t,e){return t.replace(Vfe,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Vfe=/\{\$([^}]+)}/g;function Ufe(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Tu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(UD(i)&&UD(o)){if(!Tu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function UD(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bg(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function cm(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function um(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Bfe(t,e){const n=new zfe(t,e);return n.subscribe.bind(n)}class zfe{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Gfe(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=oS),s.error===void 0&&(s.error=oS),s.complete===void 0&&(s.complete=oS);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Gfe(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function oS(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zn(t){return t&&t._delegate?t._delegate:t}class Ma{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wfe{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Pfe;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(qfe(e))try{this.getOrInitializeService({instanceIdentifier:Fc})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Fc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Fc){return this.instances.has(e)}getOptions(e=Fc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Hfe(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Fc){return this.component?this.component.multipleInstances?e:Fc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Hfe(t){return t===Fc?void 0:t}function qfe(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kfe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Wfe(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(hn||(hn={}));const Yfe={debug:hn.DEBUG,verbose:hn.VERBOSE,info:hn.INFO,warn:hn.WARN,error:hn.ERROR,silent:hn.SILENT},Jfe=hn.INFO,Xfe={[hn.DEBUG]:"log",[hn.VERBOSE]:"log",[hn.INFO]:"info",[hn.WARN]:"warn",[hn.ERROR]:"error"},Qfe=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Xfe[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class EN{constructor(e){this.name=e,this._logLevel=Jfe,this._logHandler=Qfe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in hn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Yfe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,hn.DEBUG,...e),this._logHandler(this,hn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,hn.VERBOSE,...e),this._logHandler(this,hn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,hn.INFO,...e),this._logHandler(this,hn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,hn.WARN,...e),this._logHandler(this,hn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,hn.ERROR,...e),this._logHandler(this,hn.ERROR,...e)}}const Zfe=(t,e)=>e.some(n=>t instanceof n);let BD,zD;function eme(){return BD||(BD=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function tme(){return zD||(zD=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const DB=new WeakMap,jC=new WeakMap,MB=new WeakMap,aS=new WeakMap,CN=new WeakMap;function nme(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Vl(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&DB.set(n,t)}).catch(()=>{}),CN.set(e,t),e}function rme(t){if(jC.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});jC.set(t,e)}let DC={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return jC.get(t);if(e==="objectStoreNames")return t.objectStoreNames||MB.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Vl(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function sme(t){DC=t(DC)}function ime(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(lS(this),e,...n);return MB.set(r,e.sort?e.sort():[e]),Vl(r)}:tme().includes(t)?function(...e){return t.apply(lS(this),e),Vl(DB.get(this))}:function(...e){return Vl(t.apply(lS(this),e))}}function ome(t){return typeof t=="function"?ime(t):(t instanceof IDBTransaction&&rme(t),Zfe(t,eme())?new Proxy(t,DC):t)}function Vl(t){if(t instanceof IDBRequest)return nme(t);if(aS.has(t))return aS.get(t);const e=ome(t);return e!==t&&(aS.set(t,e),CN.set(e,t)),e}const lS=t=>CN.get(t);function ame(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Vl(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Vl(o.result),c.oldVersion,c.newVersion,Vl(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const lme=["get","getKey","getAll","getAllKeys","count"],cme=["put","add","delete","clear"],cS=new Map;function GD(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(cS.get(e))return cS.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=cme.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||lme.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return cS.set(e,i),i}sme(t=>({...t,get:(e,n,r)=>GD(e,n)||t.get(e,n,r),has:(e,n)=>!!GD(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ume{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(dme(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function dme(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const MC="@firebase/app",WD="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La=new EN("@firebase/app"),hme="@firebase/app-compat",fme="@firebase/analytics-compat",mme="@firebase/analytics",pme="@firebase/app-check-compat",gme="@firebase/app-check",yme="@firebase/auth",xme="@firebase/auth-compat",vme="@firebase/database",wme="@firebase/data-connect",bme="@firebase/database-compat",_me="@firebase/functions",Sme="@firebase/functions-compat",Eme="@firebase/installations",Cme="@firebase/installations-compat",Tme="@firebase/messaging",Ime="@firebase/messaging-compat",Nme="@firebase/performance",Pme="@firebase/performance-compat",Ame="@firebase/remote-config",kme="@firebase/remote-config-compat",Rme="@firebase/storage",jme="@firebase/storage-compat",Dme="@firebase/firestore",Mme="@firebase/ai",Lme="@firebase/firestore-compat",Fme="firebase",Ome="11.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC="[DEFAULT]",$me={[MC]:"fire-core",[hme]:"fire-core-compat",[mme]:"fire-analytics",[fme]:"fire-analytics-compat",[gme]:"fire-app-check",[pme]:"fire-app-check-compat",[yme]:"fire-auth",[xme]:"fire-auth-compat",[vme]:"fire-rtdb",[wme]:"fire-data-connect",[bme]:"fire-rtdb-compat",[_me]:"fire-fn",[Sme]:"fire-fn-compat",[Eme]:"fire-iid",[Cme]:"fire-iid-compat",[Tme]:"fire-fcm",[Ime]:"fire-fcm-compat",[Nme]:"fire-perf",[Pme]:"fire-perf-compat",[Ame]:"fire-rc",[kme]:"fire-rc-compat",[Rme]:"fire-gcs",[jme]:"fire-gcs-compat",[Dme]:"fire-fst",[Lme]:"fire-fst-compat",[Mme]:"fire-vertex","fire-js":"fire-js",[Fme]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv=new Map,Vme=new Map,FC=new Map;function HD(t,e){try{t.container.addComponent(e)}catch(n){La.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function tc(t){const e=t.name;if(FC.has(e))return La.debug(`There were multiple attempts to register component ${e}.`),!1;FC.set(e,t);for(const n of Qv.values())HD(n,t);for(const n of Vme.values())HD(n,t);return!0}function _g(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function $s(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ume={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ul=new wg("app","Firebase",Ume);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bme{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ma("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ul.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hu=Ome;function LB(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:LC,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw Ul.create("bad-app-name",{appName:String(s)});if(n||(n=IB()),!n)throw Ul.create("no-options");const i=Qv.get(s);if(i){if(Tu(n,i.options)&&Tu(r,i.config))return i;throw Ul.create("duplicate-app",{appName:s})}const o=new Kfe(s);for(const c of FC.values())o.addComponent(c);const l=new Bme(n,r,o);return Qv.set(s,l),l}function J0(t=LC){const e=Qv.get(t);if(!e&&t===LC&&IB())return LB();if(!e)throw Ul.create("no-app",{appName:t});return e}function Ki(t,e,n){var r;let s=(r=$me[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),La.warn(l.join(" "));return}tc(new Ma(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zme="firebase-heartbeat-database",Gme=1,Tp="firebase-heartbeat-store";let uS=null;function FB(){return uS||(uS=ame(zme,Gme,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Tp)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ul.create("idb-open",{originalErrorMessage:t.message})})),uS}async function Wme(t){try{const n=(await FB()).transaction(Tp),r=await n.objectStore(Tp).get(OB(t));return await n.done,r}catch(e){if(e instanceof Po)La.warn(e.message);else{const n=Ul.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});La.warn(n.message)}}}async function qD(t,e){try{const r=(await FB()).transaction(Tp,"readwrite");await r.objectStore(Tp).put(e,OB(t)),await r.done}catch(n){if(n instanceof Po)La.warn(n.message);else{const r=Ul.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});La.warn(r.message)}}}function OB(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hme=1024,qme=30;class Kme{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Jme(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=KD();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>qme){const o=Xme(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){La.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=KD(),{heartbeatsToSend:r,unsentEntries:s}=Yme(this._heartbeatsCache.heartbeats),i=Xv(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return La.warn(n),""}}}function KD(){return new Date().toISOString().substring(0,10)}function Yme(t,e=Hme){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),YD(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),YD(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Jme{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jB()?Ffe().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Wme(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return qD(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return qD(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function YD(t){return Xv(JSON.stringify({version:2,heartbeats:t})).length}function Xme(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qme(t){tc(new Ma("platform-logger",e=>new ume(e),"PRIVATE")),tc(new Ma("heartbeat",e=>new Kme(e),"PRIVATE")),Ki(MC,WD,t),Ki(MC,WD,"esm2017"),Ki("fire-js","")}Qme("");var Zme="firebase",epe="11.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ki(Zme,epe,"app");function $B(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const tpe=$B,VB=new wg("auth","Firebase",$B());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zv=new EN("@firebase/auth");function npe(t,...e){Zv.logLevel<=hn.WARN&&Zv.warn(`Auth (${Hu}): ${t}`,...e)}function jx(t,...e){Zv.logLevel<=hn.ERROR&&Zv.error(`Auth (${Hu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eo(t,...e){throw IN(t,...e)}function _o(t,...e){return IN(t,...e)}function TN(t,e,n){const r=Object.assign(Object.assign({},tpe()),{[e]:n});return new wg("auth","Firebase",r).create(e,{appName:t.name})}function Ia(t){return TN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function rpe(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&eo(t,"argument-error"),TN(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function IN(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return VB.create(t,...e)}function Lt(t,e,...n){if(!t)throw IN(e,...n)}function wa(t){const e="INTERNAL ASSERTION FAILED: "+t;throw jx(e),new Error(e)}function Fa(t,e){t||wa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OC(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function spe(){return JD()==="http:"||JD()==="https:"}function JD(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ipe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(spe()||Dfe()||"connection"in navigator)?navigator.onLine:!0}function ope(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg{constructor(e,n){this.shortDelay=e,this.longDelay=n,Fa(n>e,"Short delay should be less than long delay!"),this.isMobile=Rfe()||Mfe()}get(){return ipe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NN(t,e){Fa(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UB{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;wa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;wa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;wa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ape={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lpe=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],cpe=new Sg(3e4,6e4);function bc(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function _c(t,e,n,r,s={}){return BB(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=bg(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return jfe()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&wc(t.emulatorConfig.host)&&(u.credentials="include"),UB.fetch()(await zB(t,t.config.apiHost,n,l),u)})}async function BB(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},ape),e);try{const s=new dpe(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Vy(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Vy(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Vy(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Vy(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw TN(t,d,u);eo(t,d)}}catch(s){if(s instanceof Po)throw s;eo(t,"network-request-failed",{message:String(s)})}}async function Eg(t,e,n,r,s={}){const i=await _c(t,e,n,r,s);return"mfaPendingCredential"in i&&eo(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function zB(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?NN(t.config,s):`${t.config.apiScheme}://${s}`;return lpe.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function upe(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class dpe{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(_o(this.auth,"network-request-failed")),cpe.get())})}}function Vy(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=_o(t,e,r);return s.customData._tokenResponse=n,s}function XD(t){return t!==void 0&&t.enterprise!==void 0}class hpe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return upe(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function fpe(t,e){return _c(t,"GET","/v2/recaptchaConfig",bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mpe(t,e){return _c(t,"POST","/v1/accounts:delete",e)}async function ew(t,e){return _c(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Om(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ppe(t,e=!1){const n=zn(t),r=await n.getIdToken(e),s=PN(r);Lt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Om(dS(s.auth_time)),issuedAtTime:Om(dS(s.iat)),expirationTime:Om(dS(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function dS(t){return Number(t)*1e3}function PN(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return jx("JWT malformed, contained fewer than 3 sections"),null;try{const s=EB(n);return s?JSON.parse(s):(jx("Failed to decode base64 JWT payload"),null)}catch(s){return jx("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function QD(t){const e=PN(t);return Lt(e,"internal-error"),Lt(typeof e.exp<"u","internal-error"),Lt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ip(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Po&&gpe(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function gpe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ype{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Om(this.lastLoginAt),this.creationTime=Om(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tw(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Ip(t,ew(n,{idToken:r}));Lt(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?GB(i.providerUserInfo):[],l=vpe(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new $C(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function xpe(t){const e=zn(t);await tw(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function vpe(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function GB(t){return t.map(e=>{var{providerId:n}=e,r=sf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wpe(t,e){const n=await BB(t,{},async()=>{const r=bg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await zB(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",UB.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function bpe(t,e){return _c(t,"POST","/v2/accounts:revokeToken",bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Lt(e.idToken,"internal-error"),Lt(typeof e.idToken<"u","internal-error"),Lt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):QD(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Lt(e.length!==0,"internal-error");const n=QD(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Lt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await wpe(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new hh;return r&&(Lt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(Lt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(Lt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new hh,this.toJSON())}_performRefresh(){return wa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sl(t,e){Lt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class vo{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=sf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ype(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new $C(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Ip(this,this.stsTokenManager.getToken(this.auth,e));return Lt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return ppe(this,e)}reload(){return xpe(this)}_assign(e){this!==e&&(Lt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new vo(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Lt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await tw(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($s(this.auth.app))return Promise.reject(Ia(this.auth));const e=await this.getIdToken();return await Ip(this,mpe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,u,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(s=n.email)!==null&&s!==void 0?s:void 0,m=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,g=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(l=n.tenantId)!==null&&l!==void 0?l:void 0,E=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,v=(u=n.createdAt)!==null&&u!==void 0?u:void 0,b=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:S,emailVerified:I,isAnonymous:D,providerData:k,stsTokenManager:C}=n;Lt(S&&C,e,"internal-error");const T=hh.fromJSON(this.name,C);Lt(typeof S=="string",e,"internal-error"),sl(h,e.name),sl(f,e.name),Lt(typeof I=="boolean",e,"internal-error"),Lt(typeof D=="boolean",e,"internal-error"),sl(m,e.name),sl(g,e.name),sl(x,e.name),sl(E,e.name),sl(v,e.name),sl(b,e.name);const P=new vo({uid:S,auth:e,email:f,emailVerified:I,displayName:h,isAnonymous:D,photoURL:g,phoneNumber:m,tenantId:x,stsTokenManager:T,createdAt:v,lastLoginAt:b});return k&&Array.isArray(k)&&(P.providerData=k.map(A=>Object.assign({},A))),E&&(P._redirectEventId=E),P}static async _fromIdTokenResponse(e,n,r=!1){const s=new hh;s.updateFromServerResponse(n);const i=new vo({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await tw(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Lt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?GB(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new hh;l.updateFromIdToken(r);const c=new vo({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new $C(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZD=new Map;function ba(t){Fa(t instanceof Function,"Expected a class definition");let e=ZD.get(t);return e?(Fa(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,ZD.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WB{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}WB.type="NONE";const eM=WB;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(t,e,n){return`firebase:${t}:${e}:${n}`}class fh{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Dx(this.userKey,s.apiKey,i),this.fullPersistenceKey=Dx("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await ew(this.auth,{idToken:e}).catch(()=>{});return n?vo._fromGetAccountInfoResponse(this.auth,n,e):null}return vo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new fh(ba(eM),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||ba(eM);const o=Dx(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){let h;if(typeof d=="string"){const f=await ew(e,{idToken:d}).catch(()=>{});if(!f)break;h=await vo._fromGetAccountInfoResponse(e,f,d)}else h=vo._fromJSON(e,d);u!==i&&(l=h),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new fh(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new fh(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tM(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(YB(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(HB(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(XB(e))return"Blackberry";if(QB(e))return"Webos";if(qB(e))return"Safari";if((e.includes("chrome/")||KB(e))&&!e.includes("edge/"))return"Chrome";if(JB(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function HB(t=$r()){return/firefox\//i.test(t)}function qB(t=$r()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function KB(t=$r()){return/crios\//i.test(t)}function YB(t=$r()){return/iemobile/i.test(t)}function JB(t=$r()){return/android/i.test(t)}function XB(t=$r()){return/blackberry/i.test(t)}function QB(t=$r()){return/webos/i.test(t)}function AN(t=$r()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function _pe(t=$r()){var e;return AN(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Spe(){return Lfe()&&document.documentMode===10}function ZB(t=$r()){return AN(t)||JB(t)||QB(t)||XB(t)||/windows phone/i.test(t)||YB(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ez(t,e=[]){let n;switch(t){case"Browser":n=tM($r());break;case"Worker":n=`${tM($r())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Hu}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Epe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cpe(t,e={}){return _c(t,"GET","/v2/passwordPolicy",bc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tpe=6;class Ipe{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Tpe,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Npe{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nM(this),this.idTokenSubscription=new nM(this),this.beforeStateQueue=new Epe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=VB,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ba(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await fh.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await ew(this,{idToken:e}),r=await vo._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if($s(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Lt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await tw(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ope()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if($s(this.app))return Promise.reject(Ia(this));const n=e?zn(e):null;return n&&Lt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Lt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return $s(this.app)?Promise.reject(Ia(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return $s(this.app)?Promise.reject(Ia(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ba(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Cpe(this),n=new Ipe(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new wg("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await bpe(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ba(e)||this._popupRedirectResolver;Lt(n,this,"argument-error"),this.redirectPersistenceManager=await fh.create(this,[ba(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Lt(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Lt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ez(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if($s(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&npe(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Sc(t){return zn(t)}class nM{constructor(e){this.auth=e,this.observer=null,this.addObserver=Bfe(n=>this.observer=n)}get next(){return Lt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let X0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ppe(t){X0=t}function tz(t){return X0.loadJS(t)}function Ape(){return X0.recaptchaEnterpriseScript}function kpe(){return X0.gapiScript}function Rpe(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class jpe{constructor(){this.enterprise=new Dpe}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Dpe{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const Mpe="recaptcha-enterprise",nz="NO_RECAPTCHA";class Lpe{constructor(e){this.type=Mpe,this.auth=Sc(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{fpe(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new hpe(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;XD(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(nz)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new jpe().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&XD(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=Ape();c.length!==0&&(c+=l),tz(c).then(()=>{s(l,i,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function $f(t,e,n,r=!1,s=!1){const i=new Lpe(t);let o;if(s)o=nz;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const l=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function VC(t,e,n,r,s){var i,o;if(s==="EMAIL_PASSWORD_PROVIDER")if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await $f(t,e,n,n==="getOobCode");return r(t,l)}else return r(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await $f(t,e,n,n==="getOobCode");return r(t,c)}else return Promise.reject(l)});else if(s==="PHONE_PROVIDER")if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){const l=await $f(t,e,n);return r(t,l).catch(async c=>{var u;if(((u=t._getRecaptchaConfig())===null||u===void 0?void 0:u.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const d=await $f(t,e,n,!1,!0);return r(t,d)}return Promise.reject(c)})}else{const l=await $f(t,e,n,!1,!0);return r(t,l)}else return Promise.reject(s+" provider is not supported.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fpe(t,e){const n=_g(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Tu(i,e??{}))return s;eo(s,"already-initialized")}return n.initialize({options:e})}function Ope(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ba);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function $pe(t,e,n){const r=Sc(t);Lt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=rz(e),{host:o,port:l}=Vpe(e),c=l===null?"":`:${l}`,u={url:`${i}//${o}${c}/`},d=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Lt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Lt(Tu(u,r.config.emulator)&&Tu(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,wc(o)?(K0(`${i}//${o}${c}`),Y0("Auth",!0)):s||Upe()}function rz(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Vpe(t){const e=rz(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:rM(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:rM(o)}}}function rM(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Upe(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return wa("not implemented")}_getIdTokenResponse(e){return wa("not implemented")}_linkToIdToken(e,n){return wa("not implemented")}_getReauthenticationResolver(e){return wa("not implemented")}}async function Bpe(t,e){return _c(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zpe(t,e){return Eg(t,"POST","/v1/accounts:signInWithPassword",bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gpe(t,e){return Eg(t,"POST","/v1/accounts:signInWithEmailLink",bc(t,e))}async function Wpe(t,e){return Eg(t,"POST","/v1/accounts:signInWithEmailLink",bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np extends kN{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Np(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Np(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return VC(e,n,"signInWithPassword",zpe,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Gpe(e,{email:this._email,oobCode:this._password});default:eo(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return VC(e,r,"signUpPassword",Bpe,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Wpe(e,{idToken:n,email:this._email,oobCode:this._password});default:eo(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mh(t,e){return Eg(t,"POST","/v1/accounts:signInWithIdp",bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hpe="http://localhost";class Iu extends kN{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Iu(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):eo("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=sf(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Iu(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return mh(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,mh(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,mh(e,n)}buildRequest(){const e={requestUri:Hpe,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=bg(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qpe(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Kpe(t){const e=cm(um(t)).link,n=e?cm(um(e)).deep_link_id:null,r=cm(um(t)).deep_link_id;return(r?cm(um(r)).link:null)||r||n||e||t}class RN{constructor(e){var n,r,s,i,o,l;const c=cm(um(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=qpe((s=c.mode)!==null&&s!==void 0?s:null);Lt(u&&d&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=d,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.lang)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=Kpe(e);try{return new RN(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(){this.providerId=cf.PROVIDER_ID}static credential(e,n){return Np._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=RN.parseLink(n);return Lt(r,"argument-error"),Np._fromEmailAndCode(e,r.code,r.tenantId)}}cf.PROVIDER_ID="password";cf.EMAIL_PASSWORD_SIGN_IN_METHOD="password";cf.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg extends jN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl extends Cg{constructor(){super("facebook.com")}static credential(e){return Iu._fromParams({providerId:vl.PROVIDER_ID,signInMethod:vl.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vl.credentialFromTaggedObject(e)}static credentialFromError(e){return vl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vl.credential(e.oauthAccessToken)}catch{return null}}}vl.FACEBOOK_SIGN_IN_METHOD="facebook.com";vl.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga extends Cg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Iu._fromParams({providerId:ga.PROVIDER_ID,signInMethod:ga.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ga.credentialFromTaggedObject(e)}static credentialFromError(e){return ga.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return ga.credential(n,r)}catch{return null}}}ga.GOOGLE_SIGN_IN_METHOD="google.com";ga.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl extends Cg{constructor(){super("github.com")}static credential(e){return Iu._fromParams({providerId:wl.PROVIDER_ID,signInMethod:wl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wl.credentialFromTaggedObject(e)}static credentialFromError(e){return wl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wl.credential(e.oauthAccessToken)}catch{return null}}}wl.GITHUB_SIGN_IN_METHOD="github.com";wl.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl extends Cg{constructor(){super("twitter.com")}static credential(e,n){return Iu._fromParams({providerId:bl.PROVIDER_ID,signInMethod:bl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return bl.credentialFromTaggedObject(e)}static credentialFromError(e){return bl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return bl.credential(n,r)}catch{return null}}}bl.TWITTER_SIGN_IN_METHOD="twitter.com";bl.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ype(t,e){return Eg(t,"POST","/v1/accounts:signUp",bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await vo._fromIdTokenResponse(e,r,s),o=sM(r);return new Nu({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=sM(r);return new Nu({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function sM(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw extends Po{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,nw.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new nw(e,n,r,s)}}function sz(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?nw._fromErrorAndOperation(t,i,e,r):i})}async function Jpe(t,e,n=!1){const r=await Ip(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Nu._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xpe(t,e,n=!1){const{auth:r}=t;if($s(r.app))return Promise.reject(Ia(r));const s="reauthenticate";try{const i=await Ip(t,sz(r,s,e,t),n);Lt(i.idToken,r,"internal-error");const o=PN(i.idToken);Lt(o,r,"internal-error");const{sub:l}=o;return Lt(t.uid===l,r,"user-mismatch"),Nu._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&eo(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iz(t,e,n=!1){if($s(t.app))return Promise.reject(Ia(t));const r="signIn",s=await sz(t,r,e),i=await Nu._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Qpe(t,e){return iz(Sc(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oz(t){const e=Sc(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Zpe(t,e,n){if($s(t.app))return Promise.reject(Ia(t));const r=Sc(t),o=await VC(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ype,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&oz(t),c}),l=await Nu._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function ege(t,e,n){return $s(t.app)?Promise.reject(Ia(t)):Qpe(zn(t),cf.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&oz(t),r})}function tge(t,e,n,r){return zn(t).onIdTokenChanged(e,n,r)}function nge(t,e,n){return zn(t).beforeAuthStateChanged(e,n)}function rge(t,e,n,r){return zn(t).onAuthStateChanged(e,n,r)}function sge(t){return zn(t).signOut()}const rw="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class az{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(rw,"1"),this.storage.removeItem(rw),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ige=1e3,oge=10;class lz extends az{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ZB(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Spe()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,oge):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},ige)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}lz.type="LOCAL";const age=lz;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cz extends az{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}cz.type="SESSION";const uz=cz;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lge(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Q0(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await lge(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Q0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DN(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cge{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=DN("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(f.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qo(){return window}function uge(t){Qo().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dz(){return typeof Qo().WorkerGlobalScope<"u"&&typeof Qo().importScripts=="function"}async function dge(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function hge(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function fge(){return dz()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hz="firebaseLocalStorageDb",mge=1,sw="firebaseLocalStorage",fz="fbase_key";class Tg{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Z0(t,e){return t.transaction([sw],e?"readwrite":"readonly").objectStore(sw)}function pge(){const t=indexedDB.deleteDatabase(hz);return new Tg(t).toPromise()}function UC(){const t=indexedDB.open(hz,mge);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(sw,{keyPath:fz})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(sw)?e(r):(r.close(),await pge(),e(await UC()))})})}async function iM(t,e,n){const r=Z0(t,!0).put({[fz]:e,value:n});return new Tg(r).toPromise()}async function gge(t,e){const n=Z0(t,!1).get(e),r=await new Tg(n).toPromise();return r===void 0?null:r.value}function oM(t,e){const n=Z0(t,!0).delete(e);return new Tg(n).toPromise()}const yge=800,xge=3;class mz{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await UC(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>xge)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return dz()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Q0._getInstance(fge()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await dge(),!this.activeServiceWorker)return;this.sender=new cge(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||hge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await UC();return await iM(e,rw,"1"),await oM(e,rw),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>iM(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>gge(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>oM(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Z0(s,!1).getAll();return new Tg(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),yge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}mz.type="LOCAL";const vge=mz;new Sg(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pz(t,e){return e?ba(e):(Lt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN extends kN{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mh(e,this._buildIdpRequest())}_linkToIdToken(e,n){return mh(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return mh(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function wge(t){return iz(t.auth,new MN(t),t.bypassAuthState)}function bge(t){const{auth:e,user:n}=t;return Lt(n,e,"internal-error"),Xpe(n,new MN(t),t.bypassAuthState)}async function _ge(t){const{auth:e,user:n}=t;return Lt(n,e,"internal-error"),Jpe(n,new MN(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gz{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return wge;case"linkViaPopup":case"linkViaRedirect":return _ge;case"reauthViaPopup":case"reauthViaRedirect":return bge;default:eo(this.auth,"internal-error")}}resolve(e){Fa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Fa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sge=new Sg(2e3,1e4);async function Ege(t,e,n){if($s(t.app))return Promise.reject(_o(t,"operation-not-supported-in-this-environment"));const r=Sc(t);rpe(t,e,jN);const s=pz(r,n);return new su(r,"signInViaPopup",e,s).executeNotNull()}class su extends gz{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,su.currentPopupAction&&su.currentPopupAction.cancel(),su.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Lt(e,this.auth,"internal-error"),e}async onExecution(){Fa(this.filter.length===1,"Popup operations only handle one event");const e=DN();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(_o(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_o(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,su.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_o(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Sge.get())};e()}}su.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cge="pendingRedirect",Mx=new Map;class Tge extends gz{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Mx.get(this.auth._key());if(!e){try{const r=await Ige(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Mx.set(this.auth._key(),e)}return this.bypassAuthState||Mx.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Ige(t,e){const n=Age(e),r=Pge(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function Nge(t,e){Mx.set(t._key(),e)}function Pge(t){return ba(t._redirectPersistence)}function Age(t){return Dx(Cge,t.config.apiKey,t.name)}async function kge(t,e,n=!1){if($s(t.app))return Promise.reject(Ia(t));const r=Sc(t),s=pz(r,e),o=await new Tge(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rge=10*60*1e3;class jge{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Dge(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!yz(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(_o(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Rge&&this.cachedEventUids.clear(),this.cachedEventUids.has(aM(e))}saveEventToCache(e){this.cachedEventUids.add(aM(e)),this.lastProcessedEventTime=Date.now()}}function aM(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function yz({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Dge(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yz(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mge(t,e={}){return _c(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lge=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Fge=/^https?/;async function Oge(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Mge(t);for(const n of e)try{if($ge(n))return}catch{}eo(t,"unauthorized-domain")}function $ge(t){const e=OC(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Fge.test(n))return!1;if(Lge.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vge=new Sg(3e4,6e4);function lM(){const t=Qo().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Uge(t){return new Promise((e,n)=>{var r,s,i;function o(){lM(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{lM(),n(_o(t,"network-request-failed"))},timeout:Vge.get()})}if(!((s=(r=Qo().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Qo().gapi)===null||i===void 0)&&i.load)o();else{const l=Rpe("iframefcb");return Qo()[l]=()=>{gapi.load?o():n(_o(t,"network-request-failed"))},tz(`${kpe()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw Lx=null,e})}let Lx=null;function Bge(t){return Lx=Lx||Uge(t),Lx}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zge=new Sg(5e3,15e3),Gge="__/auth/iframe",Wge="emulator/auth/iframe",Hge={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},qge=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Kge(t){const e=t.config;Lt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?NN(e,Wge):`https://${t.config.authDomain}/${Gge}`,r={apiKey:e.apiKey,appName:t.name,v:Hu},s=qge.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${bg(r).slice(1)}`}async function Yge(t){const e=await Bge(t),n=Qo().gapi;return Lt(n,t,"internal-error"),e.open({where:document.body,url:Kge(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Hge,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=_o(t,"network-request-failed"),l=Qo().setTimeout(()=>{i(o)},zge.get());function c(){Qo().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jge={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Xge=500,Qge=600,Zge="_blank",eye="http://localhost";class cM{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tye(t,e,n,r=Xge,s=Qge){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},Jge),{width:r.toString(),height:s.toString(),top:i,left:o}),u=$r().toLowerCase();n&&(l=KB(u)?Zge:n),HB(u)&&(e=e||eye,c.scrollbars="yes");const d=Object.entries(c).reduce((f,[m,g])=>`${f}${m}=${g},`,"");if(_pe(u)&&l!=="_self")return nye(e||"",l),new cM(null);const h=window.open(e||"",l,d);Lt(h,t,"popup-blocked");try{h.focus()}catch{}return new cM(h)}function nye(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rye="__/auth/handler",sye="emulator/auth/handler",iye=encodeURIComponent("fac");async function uM(t,e,n,r,s,i){Lt(t.config.authDomain,t,"auth-domain-config-required"),Lt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Hu,eventId:s};if(e instanceof jN){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Ufe(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries(i||{}))o[d]=h}if(e instanceof Cg){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${iye}=${encodeURIComponent(c)}`:"";return`${oye(t)}?${bg(l).slice(1)}${u}`}function oye({config:t}){return t.emulator?NN(t,sye):`https://${t.authDomain}/${rye}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hS="webStorageSupport";class aye{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=uz,this._completeRedirectFn=kge,this._overrideRedirectResult=Nge}async _openPopup(e,n,r,s){var i;Fa((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await uM(e,n,r,OC(),s);return tye(e,o,DN())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await uM(e,n,r,OC(),s);return uge(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Fa(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Yge(e),r=new jge(e);return n.register("authEvent",s=>(Lt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(hS,{type:hS},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[hS];o!==void 0&&n(!!o),eo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Oge(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return ZB()||qB()||AN()}}const lye=aye;var dM="@firebase/auth",hM="1.10.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cye{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Lt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uye(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function dye(t){tc(new Ma("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;Lt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ez(t)},u=new Npe(r,s,i,c);return Ope(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),tc(new Ma("auth-internal",e=>{const n=Sc(e.getProvider("auth").getImmediate());return(r=>new cye(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ki(dM,hM,uye(t)),Ki(dM,hM,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hye=5*60,fye=NB("authIdTokenMaxAge")||hye;let fM=null;const mye=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>fye)return;const s=n==null?void 0:n.token;fM!==s&&(fM=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function pye(t=J0()){const e=_g(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Fpe(t,{popupRedirectResolver:lye,persistence:[vge,age,uz]}),r=NB("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=mye(i.toString());nge(n,o,()=>o(n.currentUser)),tge(n,l=>o(l))}}const s=TB("auth");return s&&$pe(n,`http://${s}`),n}function gye(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}Ppe({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=_o("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",gye().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});dye("Browser");var mM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Bl,xz;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,T){function P(){}P.prototype=T.prototype,C.D=T.prototype,C.prototype=new P,C.prototype.constructor=C,C.C=function(A,R,M){for(var j=Array(arguments.length-2),z=2;z<arguments.length;z++)j[z-2]=arguments[z];return T.prototype[R].apply(A,j)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(C,T,P){P||(P=0);var A=Array(16);if(typeof T=="string")for(var R=0;16>R;++R)A[R]=T.charCodeAt(P++)|T.charCodeAt(P++)<<8|T.charCodeAt(P++)<<16|T.charCodeAt(P++)<<24;else for(R=0;16>R;++R)A[R]=T[P++]|T[P++]<<8|T[P++]<<16|T[P++]<<24;T=C.g[0],P=C.g[1],R=C.g[2];var M=C.g[3],j=T+(M^P&(R^M))+A[0]+3614090360&4294967295;T=P+(j<<7&4294967295|j>>>25),j=M+(R^T&(P^R))+A[1]+3905402710&4294967295,M=T+(j<<12&4294967295|j>>>20),j=R+(P^M&(T^P))+A[2]+606105819&4294967295,R=M+(j<<17&4294967295|j>>>15),j=P+(T^R&(M^T))+A[3]+3250441966&4294967295,P=R+(j<<22&4294967295|j>>>10),j=T+(M^P&(R^M))+A[4]+4118548399&4294967295,T=P+(j<<7&4294967295|j>>>25),j=M+(R^T&(P^R))+A[5]+1200080426&4294967295,M=T+(j<<12&4294967295|j>>>20),j=R+(P^M&(T^P))+A[6]+2821735955&4294967295,R=M+(j<<17&4294967295|j>>>15),j=P+(T^R&(M^T))+A[7]+4249261313&4294967295,P=R+(j<<22&4294967295|j>>>10),j=T+(M^P&(R^M))+A[8]+1770035416&4294967295,T=P+(j<<7&4294967295|j>>>25),j=M+(R^T&(P^R))+A[9]+2336552879&4294967295,M=T+(j<<12&4294967295|j>>>20),j=R+(P^M&(T^P))+A[10]+4294925233&4294967295,R=M+(j<<17&4294967295|j>>>15),j=P+(T^R&(M^T))+A[11]+2304563134&4294967295,P=R+(j<<22&4294967295|j>>>10),j=T+(M^P&(R^M))+A[12]+1804603682&4294967295,T=P+(j<<7&4294967295|j>>>25),j=M+(R^T&(P^R))+A[13]+4254626195&4294967295,M=T+(j<<12&4294967295|j>>>20),j=R+(P^M&(T^P))+A[14]+2792965006&4294967295,R=M+(j<<17&4294967295|j>>>15),j=P+(T^R&(M^T))+A[15]+1236535329&4294967295,P=R+(j<<22&4294967295|j>>>10),j=T+(R^M&(P^R))+A[1]+4129170786&4294967295,T=P+(j<<5&4294967295|j>>>27),j=M+(P^R&(T^P))+A[6]+3225465664&4294967295,M=T+(j<<9&4294967295|j>>>23),j=R+(T^P&(M^T))+A[11]+643717713&4294967295,R=M+(j<<14&4294967295|j>>>18),j=P+(M^T&(R^M))+A[0]+3921069994&4294967295,P=R+(j<<20&4294967295|j>>>12),j=T+(R^M&(P^R))+A[5]+3593408605&4294967295,T=P+(j<<5&4294967295|j>>>27),j=M+(P^R&(T^P))+A[10]+38016083&4294967295,M=T+(j<<9&4294967295|j>>>23),j=R+(T^P&(M^T))+A[15]+3634488961&4294967295,R=M+(j<<14&4294967295|j>>>18),j=P+(M^T&(R^M))+A[4]+3889429448&4294967295,P=R+(j<<20&4294967295|j>>>12),j=T+(R^M&(P^R))+A[9]+568446438&4294967295,T=P+(j<<5&4294967295|j>>>27),j=M+(P^R&(T^P))+A[14]+3275163606&4294967295,M=T+(j<<9&4294967295|j>>>23),j=R+(T^P&(M^T))+A[3]+4107603335&4294967295,R=M+(j<<14&4294967295|j>>>18),j=P+(M^T&(R^M))+A[8]+1163531501&4294967295,P=R+(j<<20&4294967295|j>>>12),j=T+(R^M&(P^R))+A[13]+2850285829&4294967295,T=P+(j<<5&4294967295|j>>>27),j=M+(P^R&(T^P))+A[2]+4243563512&4294967295,M=T+(j<<9&4294967295|j>>>23),j=R+(T^P&(M^T))+A[7]+1735328473&4294967295,R=M+(j<<14&4294967295|j>>>18),j=P+(M^T&(R^M))+A[12]+2368359562&4294967295,P=R+(j<<20&4294967295|j>>>12),j=T+(P^R^M)+A[5]+4294588738&4294967295,T=P+(j<<4&4294967295|j>>>28),j=M+(T^P^R)+A[8]+2272392833&4294967295,M=T+(j<<11&4294967295|j>>>21),j=R+(M^T^P)+A[11]+1839030562&4294967295,R=M+(j<<16&4294967295|j>>>16),j=P+(R^M^T)+A[14]+4259657740&4294967295,P=R+(j<<23&4294967295|j>>>9),j=T+(P^R^M)+A[1]+2763975236&4294967295,T=P+(j<<4&4294967295|j>>>28),j=M+(T^P^R)+A[4]+1272893353&4294967295,M=T+(j<<11&4294967295|j>>>21),j=R+(M^T^P)+A[7]+4139469664&4294967295,R=M+(j<<16&4294967295|j>>>16),j=P+(R^M^T)+A[10]+3200236656&4294967295,P=R+(j<<23&4294967295|j>>>9),j=T+(P^R^M)+A[13]+681279174&4294967295,T=P+(j<<4&4294967295|j>>>28),j=M+(T^P^R)+A[0]+3936430074&4294967295,M=T+(j<<11&4294967295|j>>>21),j=R+(M^T^P)+A[3]+3572445317&4294967295,R=M+(j<<16&4294967295|j>>>16),j=P+(R^M^T)+A[6]+76029189&4294967295,P=R+(j<<23&4294967295|j>>>9),j=T+(P^R^M)+A[9]+3654602809&4294967295,T=P+(j<<4&4294967295|j>>>28),j=M+(T^P^R)+A[12]+3873151461&4294967295,M=T+(j<<11&4294967295|j>>>21),j=R+(M^T^P)+A[15]+530742520&4294967295,R=M+(j<<16&4294967295|j>>>16),j=P+(R^M^T)+A[2]+3299628645&4294967295,P=R+(j<<23&4294967295|j>>>9),j=T+(R^(P|~M))+A[0]+4096336452&4294967295,T=P+(j<<6&4294967295|j>>>26),j=M+(P^(T|~R))+A[7]+1126891415&4294967295,M=T+(j<<10&4294967295|j>>>22),j=R+(T^(M|~P))+A[14]+2878612391&4294967295,R=M+(j<<15&4294967295|j>>>17),j=P+(M^(R|~T))+A[5]+4237533241&4294967295,P=R+(j<<21&4294967295|j>>>11),j=T+(R^(P|~M))+A[12]+1700485571&4294967295,T=P+(j<<6&4294967295|j>>>26),j=M+(P^(T|~R))+A[3]+2399980690&4294967295,M=T+(j<<10&4294967295|j>>>22),j=R+(T^(M|~P))+A[10]+4293915773&4294967295,R=M+(j<<15&4294967295|j>>>17),j=P+(M^(R|~T))+A[1]+2240044497&4294967295,P=R+(j<<21&4294967295|j>>>11),j=T+(R^(P|~M))+A[8]+1873313359&4294967295,T=P+(j<<6&4294967295|j>>>26),j=M+(P^(T|~R))+A[15]+4264355552&4294967295,M=T+(j<<10&4294967295|j>>>22),j=R+(T^(M|~P))+A[6]+2734768916&4294967295,R=M+(j<<15&4294967295|j>>>17),j=P+(M^(R|~T))+A[13]+1309151649&4294967295,P=R+(j<<21&4294967295|j>>>11),j=T+(R^(P|~M))+A[4]+4149444226&4294967295,T=P+(j<<6&4294967295|j>>>26),j=M+(P^(T|~R))+A[11]+3174756917&4294967295,M=T+(j<<10&4294967295|j>>>22),j=R+(T^(M|~P))+A[2]+718787259&4294967295,R=M+(j<<15&4294967295|j>>>17),j=P+(M^(R|~T))+A[9]+3951481745&4294967295,C.g[0]=C.g[0]+T&4294967295,C.g[1]=C.g[1]+(R+(j<<21&4294967295|j>>>11))&4294967295,C.g[2]=C.g[2]+R&4294967295,C.g[3]=C.g[3]+M&4294967295}r.prototype.u=function(C,T){T===void 0&&(T=C.length);for(var P=T-this.blockSize,A=this.B,R=this.h,M=0;M<T;){if(R==0)for(;M<=P;)s(this,C,M),M+=this.blockSize;if(typeof C=="string"){for(;M<T;)if(A[R++]=C.charCodeAt(M++),R==this.blockSize){s(this,A),R=0;break}}else for(;M<T;)if(A[R++]=C[M++],R==this.blockSize){s(this,A),R=0;break}}this.h=R,this.o+=T},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var T=1;T<C.length-8;++T)C[T]=0;var P=8*this.o;for(T=C.length-8;T<C.length;++T)C[T]=P&255,P/=256;for(this.u(C),C=Array(16),T=P=0;4>T;++T)for(var A=0;32>A;A+=8)C[P++]=this.g[T]>>>A&255;return C};function i(C,T){var P=l;return Object.prototype.hasOwnProperty.call(P,C)?P[C]:P[C]=T(C)}function o(C,T){this.h=T;for(var P=[],A=!0,R=C.length-1;0<=R;R--){var M=C[R]|0;A&&M==T||(P[R]=M,A=!1)}this.g=P}var l={};function c(C){return-128<=C&&128>C?i(C,function(T){return new o([T|0],0>T?-1:0)}):new o([C|0],0>C?-1:0)}function u(C){if(isNaN(C)||!isFinite(C))return h;if(0>C)return E(u(-C));for(var T=[],P=1,A=0;C>=P;A++)T[A]=C/P|0,P*=4294967296;return new o(T,0)}function d(C,T){if(C.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(C.charAt(0)=="-")return E(d(C.substring(1),T));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=u(Math.pow(T,8)),A=h,R=0;R<C.length;R+=8){var M=Math.min(8,C.length-R),j=parseInt(C.substring(R,R+M),T);8>M?(M=u(Math.pow(T,M)),A=A.j(M).add(u(j))):(A=A.j(P),A=A.add(u(j)))}return A}var h=c(0),f=c(1),m=c(16777216);t=o.prototype,t.m=function(){if(x(this))return-E(this).m();for(var C=0,T=1,P=0;P<this.g.length;P++){var A=this.i(P);C+=(0<=A?A:4294967296+A)*T,T*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(g(this))return"0";if(x(this))return"-"+E(this).toString(C);for(var T=u(Math.pow(C,6)),P=this,A="";;){var R=I(P,T).g;P=v(P,R.j(T));var M=((0<P.g.length?P.g[0]:P.h)>>>0).toString(C);if(P=R,g(P))return M+A;for(;6>M.length;)M="0"+M;A=M+A}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function g(C){if(C.h!=0)return!1;for(var T=0;T<C.g.length;T++)if(C.g[T]!=0)return!1;return!0}function x(C){return C.h==-1}t.l=function(C){return C=v(this,C),x(C)?-1:g(C)?0:1};function E(C){for(var T=C.g.length,P=[],A=0;A<T;A++)P[A]=~C.g[A];return new o(P,~C.h).add(f)}t.abs=function(){return x(this)?E(this):this},t.add=function(C){for(var T=Math.max(this.g.length,C.g.length),P=[],A=0,R=0;R<=T;R++){var M=A+(this.i(R)&65535)+(C.i(R)&65535),j=(M>>>16)+(this.i(R)>>>16)+(C.i(R)>>>16);A=j>>>16,M&=65535,j&=65535,P[R]=j<<16|M}return new o(P,P[P.length-1]&-2147483648?-1:0)};function v(C,T){return C.add(E(T))}t.j=function(C){if(g(this)||g(C))return h;if(x(this))return x(C)?E(this).j(E(C)):E(E(this).j(C));if(x(C))return E(this.j(E(C)));if(0>this.l(m)&&0>C.l(m))return u(this.m()*C.m());for(var T=this.g.length+C.g.length,P=[],A=0;A<2*T;A++)P[A]=0;for(A=0;A<this.g.length;A++)for(var R=0;R<C.g.length;R++){var M=this.i(A)>>>16,j=this.i(A)&65535,z=C.i(R)>>>16,W=C.i(R)&65535;P[2*A+2*R]+=j*W,b(P,2*A+2*R),P[2*A+2*R+1]+=M*W,b(P,2*A+2*R+1),P[2*A+2*R+1]+=j*z,b(P,2*A+2*R+1),P[2*A+2*R+2]+=M*z,b(P,2*A+2*R+2)}for(A=0;A<T;A++)P[A]=P[2*A+1]<<16|P[2*A];for(A=T;A<2*T;A++)P[A]=0;return new o(P,0)};function b(C,T){for(;(C[T]&65535)!=C[T];)C[T+1]+=C[T]>>>16,C[T]&=65535,T++}function S(C,T){this.g=C,this.h=T}function I(C,T){if(g(T))throw Error("division by zero");if(g(C))return new S(h,h);if(x(C))return T=I(E(C),T),new S(E(T.g),E(T.h));if(x(T))return T=I(C,E(T)),new S(E(T.g),T.h);if(30<C.g.length){if(x(C)||x(T))throw Error("slowDivide_ only works with positive integers.");for(var P=f,A=T;0>=A.l(C);)P=D(P),A=D(A);var R=k(P,1),M=k(A,1);for(A=k(A,2),P=k(P,2);!g(A);){var j=M.add(A);0>=j.l(C)&&(R=R.add(P),M=j),A=k(A,1),P=k(P,1)}return T=v(C,R.j(T)),new S(R,T)}for(R=h;0<=C.l(T);){for(P=Math.max(1,Math.floor(C.m()/T.m())),A=Math.ceil(Math.log(P)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),M=u(P),j=M.j(T);x(j)||0<j.l(C);)P-=A,M=u(P),j=M.j(T);g(M)&&(M=f),R=R.add(M),C=v(C,j)}return new S(R,C)}t.A=function(C){return I(this,C).h},t.and=function(C){for(var T=Math.max(this.g.length,C.g.length),P=[],A=0;A<T;A++)P[A]=this.i(A)&C.i(A);return new o(P,this.h&C.h)},t.or=function(C){for(var T=Math.max(this.g.length,C.g.length),P=[],A=0;A<T;A++)P[A]=this.i(A)|C.i(A);return new o(P,this.h|C.h)},t.xor=function(C){for(var T=Math.max(this.g.length,C.g.length),P=[],A=0;A<T;A++)P[A]=this.i(A)^C.i(A);return new o(P,this.h^C.h)};function D(C){for(var T=C.g.length+1,P=[],A=0;A<T;A++)P[A]=C.i(A)<<1|C.i(A-1)>>>31;return new o(P,C.h)}function k(C,T){var P=T>>5;T%=32;for(var A=C.g.length-P,R=[],M=0;M<A;M++)R[M]=0<T?C.i(M+P)>>>T|C.i(M+P+1)<<32-T:C.i(M+P);return new o(R,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,xz=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Bl=o}).apply(typeof mM<"u"?mM:typeof self<"u"?self:typeof window<"u"?window:{});var Uy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var vz,dm,wz,Fx,BC,bz,_z,Sz;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,N,L){return y==Array.prototype||y==Object.prototype||(y[N]=L.value),y};function n(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Uy=="object"&&Uy];for(var N=0;N<y.length;++N){var L=y[N];if(L&&L.Math==Math)return L}throw Error("Cannot find global object")}var r=n(this);function s(y,N){if(N)e:{var L=r;y=y.split(".");for(var B=0;B<y.length-1;B++){var ie=y[B];if(!(ie in L))break e;L=L[ie]}y=y[y.length-1],B=L[y],N=N(B),N!=B&&N!=null&&e(L,y,{configurable:!0,writable:!0,value:N})}}function i(y,N){y instanceof String&&(y+="");var L=0,B=!1,ie={next:function(){if(!B&&L<y.length){var xe=L++;return{value:N(xe,y[xe]),done:!1}}return B=!0,{done:!0,value:void 0}}};return ie[Symbol.iterator]=function(){return ie},ie}s("Array.prototype.values",function(y){return y||function(){return i(this,function(N,L){return L})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(y){var N=typeof y;return N=N!="object"?N:y?Array.isArray(y)?"array":N:"null",N=="array"||N=="object"&&typeof y.length=="number"}function u(y){var N=typeof y;return N=="object"&&y!=null||N=="function"}function d(y,N,L){return y.call.apply(y.bind,arguments)}function h(y,N,L){if(!y)throw Error();if(2<arguments.length){var B=Array.prototype.slice.call(arguments,2);return function(){var ie=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ie,B),y.apply(N,ie)}}return function(){return y.apply(N,arguments)}}function f(y,N,L){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,f.apply(null,arguments)}function m(y,N){var L=Array.prototype.slice.call(arguments,1);return function(){var B=L.slice();return B.push.apply(B,arguments),y.apply(this,B)}}function g(y,N){function L(){}L.prototype=N.prototype,y.aa=N.prototype,y.prototype=new L,y.prototype.constructor=y,y.Qb=function(B,ie,xe){for(var rt=Array(arguments.length-2),Ln=2;Ln<arguments.length;Ln++)rt[Ln-2]=arguments[Ln];return N.prototype[ie].apply(B,rt)}}function x(y){const N=y.length;if(0<N){const L=Array(N);for(let B=0;B<N;B++)L[B]=y[B];return L}return[]}function E(y,N){for(let L=1;L<arguments.length;L++){const B=arguments[L];if(c(B)){const ie=y.length||0,xe=B.length||0;y.length=ie+xe;for(let rt=0;rt<xe;rt++)y[ie+rt]=B[rt]}else y.push(B)}}class v{constructor(N,L){this.i=N,this.j=L,this.h=0,this.g=null}get(){let N;return 0<this.h?(this.h--,N=this.g,this.g=N.next,N.next=null):N=this.i(),N}}function b(y){return/^[\s\xa0]*$/.test(y)}function S(){var y=l.navigator;return y&&(y=y.userAgent)?y:""}function I(y){return I[" "](y),y}I[" "]=function(){};var D=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function k(y,N,L){for(const B in y)N.call(L,y[B],B,y)}function C(y,N){for(const L in y)N.call(void 0,y[L],L,y)}function T(y){const N={};for(const L in y)N[L]=y[L];return N}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(y,N){let L,B;for(let ie=1;ie<arguments.length;ie++){B=arguments[ie];for(L in B)y[L]=B[L];for(let xe=0;xe<P.length;xe++)L=P[xe],Object.prototype.hasOwnProperty.call(B,L)&&(y[L]=B[L])}}function R(y){var N=1;y=y.split(":");const L=[];for(;0<N&&y.length;)L.push(y.shift()),N--;return y.length&&L.push(y.join(":")),L}function M(y){l.setTimeout(()=>{throw y},0)}function j(){var y=J;let N=null;return y.g&&(N=y.g,y.g=y.g.next,y.g||(y.h=null),N.next=null),N}class z{constructor(){this.h=this.g=null}add(N,L){const B=W.get();B.set(N,L),this.h?this.h.next=B:this.g=B,this.h=B}}var W=new v(()=>new q,y=>y.reset());class q{constructor(){this.next=this.g=this.h=null}set(N,L){this.h=N,this.g=L,this.next=null}reset(){this.next=this.g=this.h=null}}let H,$=!1,J=new z,O=()=>{const y=l.Promise.resolve(void 0);H=()=>{y.then(V)}};var V=()=>{for(var y;y=j();){try{y.h.call(y.g)}catch(L){M(L)}var N=W;N.j(y),100>N.h&&(N.h++,y.next=N.g,N.g=y)}$=!1};function G(){this.s=this.s,this.C=this.C}G.prototype.s=!1,G.prototype.ma=function(){this.s||(this.s=!0,this.N())},G.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(y,N){this.type=y,this.g=this.target=N,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var ue=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var y=!1,N=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const L=()=>{};l.addEventListener("test",L,N),l.removeEventListener("test",L,N)}catch{}return y}();function Ee(y,N){if(F.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y){var L=this.type=y.type,B=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;if(this.target=y.target||y.srcElement,this.g=N,N=y.relatedTarget){if(D){e:{try{I(N.nodeName);var ie=!0;break e}catch{}ie=!1}ie||(N=null)}}else L=="mouseover"?N=y.fromElement:L=="mouseout"&&(N=y.toElement);this.relatedTarget=N,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=typeof y.pointerType=="string"?y.pointerType:Se[y.pointerType]||"",this.state=y.state,this.i=y,y.defaultPrevented&&Ee.aa.h.call(this)}}g(Ee,F);var Se={2:"touch",3:"pen",4:"mouse"};Ee.prototype.h=function(){Ee.aa.h.call(this);var y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var we="closure_listenable_"+(1e6*Math.random()|0),Fe=0;function Ze(y,N,L,B,ie){this.listener=y,this.proxy=null,this.src=N,this.type=L,this.capture=!!B,this.ha=ie,this.key=++Fe,this.da=this.fa=!1}function ze(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function nt(y){this.src=y,this.g={},this.h=0}nt.prototype.add=function(y,N,L,B,ie){var xe=y.toString();y=this.g[xe],y||(y=this.g[xe]=[],this.h++);var rt=yt(y,N,B,ie);return-1<rt?(N=y[rt],L||(N.fa=!1)):(N=new Ze(N,this.src,xe,!!B,ie),N.fa=L,y.push(N)),N};function qe(y,N){var L=N.type;if(L in y.g){var B=y.g[L],ie=Array.prototype.indexOf.call(B,N,void 0),xe;(xe=0<=ie)&&Array.prototype.splice.call(B,ie,1),xe&&(ze(N),y.g[L].length==0&&(delete y.g[L],y.h--))}}function yt(y,N,L,B){for(var ie=0;ie<y.length;++ie){var xe=y[ie];if(!xe.da&&xe.listener==N&&xe.capture==!!L&&xe.ha==B)return ie}return-1}var Le="closure_lm_"+(1e6*Math.random()|0),Ae={};function pt(y,N,L,B,ie){if(B&&B.once)return Ft(y,N,L,B,ie);if(Array.isArray(N)){for(var xe=0;xe<N.length;xe++)pt(y,N[xe],L,B,ie);return null}return L=he(L),y&&y[we]?y.K(N,L,u(B)?!!B.capture:!!B,ie):mt(y,N,L,!1,B,ie)}function mt(y,N,L,B,ie,xe){if(!N)throw Error("Invalid event type");var rt=u(ie)?!!ie.capture:!!ie,Ln=Be(y);if(Ln||(y[Le]=Ln=new nt(y)),L=Ln.add(N,L,B,rt,xe),L.proxy)return L;if(B=Ht(),L.proxy=B,B.src=y,B.listener=L,y.addEventListener)ue||(ie=rt),ie===void 0&&(ie=!1),y.addEventListener(N.toString(),B,ie);else if(y.attachEvent)y.attachEvent(gn(N.toString()),B);else if(y.addListener&&y.removeListener)y.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return L}function Ht(){function y(L){return N.call(y.src,y.listener,L)}const N=Qe;return y}function Ft(y,N,L,B,ie){if(Array.isArray(N)){for(var xe=0;xe<N.length;xe++)Ft(y,N[xe],L,B,ie);return null}return L=he(L),y&&y[we]?y.L(N,L,u(B)?!!B.capture:!!B,ie):mt(y,N,L,!0,B,ie)}function nn(y,N,L,B,ie){if(Array.isArray(N))for(var xe=0;xe<N.length;xe++)nn(y,N[xe],L,B,ie);else B=u(B)?!!B.capture:!!B,L=he(L),y&&y[we]?(y=y.i,N=String(N).toString(),N in y.g&&(xe=y.g[N],L=yt(xe,L,B,ie),-1<L&&(ze(xe[L]),Array.prototype.splice.call(xe,L,1),xe.length==0&&(delete y.g[N],y.h--)))):y&&(y=Be(y))&&(N=y.g[N.toString()],y=-1,N&&(y=yt(N,L,B,ie)),(L=-1<y?N[y]:null)&&Tn(L))}function Tn(y){if(typeof y!="number"&&y&&!y.da){var N=y.src;if(N&&N[we])qe(N.i,y);else{var L=y.type,B=y.proxy;N.removeEventListener?N.removeEventListener(L,B,y.capture):N.detachEvent?N.detachEvent(gn(L),B):N.addListener&&N.removeListener&&N.removeListener(B),(L=Be(N))?(qe(L,y),L.h==0&&(L.src=null,N[Le]=null)):ze(y)}}}function gn(y){return y in Ae?Ae[y]:Ae[y]="on"+y}function Qe(y,N){if(y.da)y=!0;else{N=new Ee(N,this);var L=y.listener,B=y.ha||y.src;y.fa&&Tn(y),y=L.call(B,N)}return y}function Be(y){return y=y[Le],y instanceof nt?y:null}var ct="__closure_events_fn_"+(1e9*Math.random()>>>0);function he(y){return typeof y=="function"?y:(y[ct]||(y[ct]=function(N){return y.handleEvent(N)}),y[ct])}function Ie(){G.call(this),this.i=new nt(this),this.M=this,this.F=null}g(Ie,G),Ie.prototype[we]=!0,Ie.prototype.removeEventListener=function(y,N,L,B){nn(this,y,N,L,B)};function ee(y,N){var L,B=y.F;if(B)for(L=[];B;B=B.F)L.push(B);if(y=y.M,B=N.type||N,typeof N=="string")N=new F(N,y);else if(N instanceof F)N.target=N.target||y;else{var ie=N;N=new F(B,y),A(N,ie)}if(ie=!0,L)for(var xe=L.length-1;0<=xe;xe--){var rt=N.g=L[xe];ie=ne(rt,B,!0,N)&&ie}if(rt=N.g=y,ie=ne(rt,B,!0,N)&&ie,ie=ne(rt,B,!1,N)&&ie,L)for(xe=0;xe<L.length;xe++)rt=N.g=L[xe],ie=ne(rt,B,!1,N)&&ie}Ie.prototype.N=function(){if(Ie.aa.N.call(this),this.i){var y=this.i,N;for(N in y.g){for(var L=y.g[N],B=0;B<L.length;B++)ze(L[B]);delete y.g[N],y.h--}}this.F=null},Ie.prototype.K=function(y,N,L,B){return this.i.add(String(y),N,!1,L,B)},Ie.prototype.L=function(y,N,L,B){return this.i.add(String(y),N,!0,L,B)};function ne(y,N,L,B){if(N=y.i.g[String(N)],!N)return!0;N=N.concat();for(var ie=!0,xe=0;xe<N.length;++xe){var rt=N[xe];if(rt&&!rt.da&&rt.capture==L){var Ln=rt.listener,Qr=rt.ha||rt.src;rt.fa&&qe(y.i,rt),ie=Ln.call(Qr,B)!==!1&&ie}}return ie&&!B.defaultPrevented}function X(y,N,L){if(typeof y=="function")L&&(y=f(y,L));else if(y&&typeof y.handleEvent=="function")y=f(y.handleEvent,y);else throw Error("Invalid listener argument");return 2147483647<Number(N)?-1:l.setTimeout(y,N||0)}function me(y){y.g=X(()=>{y.g=null,y.i&&(y.i=!1,me(y))},y.l);const N=y.h;y.h=null,y.m.apply(null,N)}class ye extends G{constructor(N,L){super(),this.m=N,this.l=L,this.h=null,this.i=!1,this.g=null}j(N){this.h=arguments,this.g?this.i=!0:me(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function De(y){G.call(this),this.h=y,this.g={}}g(De,G);var Oe=[];function re(y){k(y.g,function(N,L){this.g.hasOwnProperty(L)&&Tn(N)},y),y.g={}}De.prototype.N=function(){De.aa.N.call(this),re(this)},De.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pe=l.JSON.stringify,Me=l.JSON.parse,ve=class{stringify(y){return l.JSON.stringify(y,void 0)}parse(y){return l.JSON.parse(y,void 0)}};function gt(){}gt.prototype.h=null;function wt(y){return y.h||(y.h=y.i())}function dt(){}var xt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function At(){F.call(this,"d")}g(At,F);function Nn(){F.call(this,"c")}g(Nn,F);var on={},_r=null;function Gn(){return _r=_r||new Ie}on.La="serverreachability";function Jt(y){F.call(this,on.La,y)}g(Jt,F);function an(y){const N=Gn();ee(N,new Jt(N))}on.STAT_EVENT="statevent";function Mn(y,N){F.call(this,on.STAT_EVENT,y),this.stat=N}g(Mn,F);function K(y){const N=Gn();ee(N,new Mn(N,y))}on.Ma="timingevent";function te(y,N){F.call(this,on.Ma,y),this.size=N}g(te,F);function ce(y,N){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){y()},N)}function ke(){this.g=!0}ke.prototype.xa=function(){this.g=!1};function Ve(y,N,L,B,ie,xe){y.info(function(){if(y.g)if(xe)for(var rt="",Ln=xe.split("&"),Qr=0;Qr<Ln.length;Qr++){var bn=Ln[Qr].split("=");if(1<bn.length){var ps=bn[0];bn=bn[1];var gs=ps.split("_");rt=2<=gs.length&&gs[1]=="type"?rt+(ps+"="+bn+"&"):rt+(ps+"=redacted&")}}else rt=null;else rt=xe;return"XMLHTTP REQ ("+B+") [attempt "+ie+"]: "+N+`
`+L+`
`+rt})}function Y(y,N,L,B,ie,xe,rt){y.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+ie+"]: "+N+`
`+L+`
`+xe+" "+rt})}function Z(y,N,L,B){y.info(function(){return"XMLHTTP TEXT ("+N+"): "+be(y,L)+(B?" "+B:"")})}function oe(y,N){y.info(function(){return"TIMEOUT: "+N})}ke.prototype.info=function(){};function be(y,N){if(!y.g)return N;if(!N)return null;try{var L=JSON.parse(N);if(L){for(y=0;y<L.length;y++)if(Array.isArray(L[y])){var B=L[y];if(!(2>B.length)){var ie=B[1];if(Array.isArray(ie)&&!(1>ie.length)){var xe=ie[0];if(xe!="noop"&&xe!="stop"&&xe!="close")for(var rt=1;rt<ie.length;rt++)ie[rt]=""}}}}return pe(L)}catch{return N}}var Ce={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Q={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},fe;function Re(){}g(Re,gt),Re.prototype.g=function(){return new XMLHttpRequest},Re.prototype.i=function(){return{}},fe=new Re;function et(y,N,L,B){this.j=y,this.i=N,this.l=L,this.R=B||1,this.U=new De(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new it}function it(){this.i=null,this.g="",this.h=!1}var Te={},ft={};function Ct(y,N,L){y.L=1,y.v=Jr(_n(N)),y.m=L,y.P=!0,mn(y,null)}function mn(y,N){y.F=Date.now(),Kn(y),y.A=_n(y.v);var L=y.A,B=y.R;Array.isArray(B)||(B=[String(B)]),AA(L.i,"t",B),y.C=0,L=y.j.J,y.h=new it,y.g=KA(y.j,L?N:null,!y.m),0<y.O&&(y.M=new ye(f(y.Y,y,y.g),y.O)),N=y.U,L=y.g,B=y.ca;var ie="readystatechange";Array.isArray(ie)||(ie&&(Oe[0]=ie.toString()),ie=Oe);for(var xe=0;xe<ie.length;xe++){var rt=pt(L,ie[xe],B||N.handleEvent,!1,N.h||N);if(!rt)break;N.g[rt.key]=rt}N=y.H?T(y.H):{},y.m?(y.u||(y.u="POST"),N["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.A,y.u,y.m,N)):(y.u="GET",y.g.ea(y.A,y.u,null,N)),an(),Ve(y.i,y.u,y.A,y.l,y.R,y.m)}et.prototype.ca=function(y){y=y.target;const N=this.M;N&&ua(y)==3?N.j():this.Y(y)},et.prototype.Y=function(y){try{if(y==this.g)e:{const gs=ua(this.g);var N=this.g.Ba();const rd=this.g.Z();if(!(3>gs)&&(gs!=3||this.g&&(this.h.h||this.g.oa()||FA(this.g)))){this.J||gs!=4||N==7||(N==8||0>=rd?an(3):an(2)),fs(this);var L=this.g.Z();this.X=L;t:if(xn(this)){var B=FA(this.g);y="";var ie=B.length,xe=ua(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ms(this),Js(this);var rt="";break t}this.h.i=new l.TextDecoder}for(N=0;N<ie;N++)this.h.h=!0,y+=this.h.i.decode(B[N],{stream:!(xe&&N==ie-1)});B.length=0,this.h.g+=y,this.C=0,rt=this.h.g}else rt=this.g.oa();if(this.o=L==200,Y(this.i,this.u,this.A,this.l,this.R,gs,L),this.o){if(this.T&&!this.K){t:{if(this.g){var Ln,Qr=this.g;if((Ln=Qr.g?Qr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(Ln)){var bn=Ln;break t}}bn=null}if(L=bn)Z(this.i,this.l,L,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Xt(this,L);else{this.o=!1,this.s=3,K(12),ms(this),Js(this);break e}}if(this.P){L=!0;let io;for(;!this.J&&this.C<rt.length;)if(io=nr(this,rt),io==ft){gs==4&&(this.s=4,K(14),L=!1),Z(this.i,this.l,null,"[Incomplete Response]");break}else if(io==Te){this.s=4,K(15),Z(this.i,this.l,rt,"[Invalid Chunk]"),L=!1;break}else Z(this.i,this.l,io,null),Xt(this,io);if(xn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gs!=4||rt.length!=0||this.h.h||(this.s=1,K(16),L=!1),this.o=this.o&&L,!L)Z(this.i,this.l,rt,"[Invalid Chunked Response]"),ms(this),Js(this);else if(0<rt.length&&!this.W){this.W=!0;var ps=this.j;ps.g==this&&ps.ba&&!ps.M&&(ps.j.info("Great, no buffering proxy detected. Bytes received: "+rt.length),Wb(ps),ps.M=!0,K(11))}}else Z(this.i,this.l,rt,null),Xt(this,rt);gs==4&&ms(this),this.o&&!this.J&&(gs==4?GA(this.j,this):(this.o=!1,Kn(this)))}else iq(this.g),L==400&&0<rt.indexOf("Unknown SID")?(this.s=3,K(12)):(this.s=0,K(13)),ms(this),Js(this)}}}catch{}finally{}};function xn(y){return y.g?y.u=="GET"&&y.L!=2&&y.j.Ca:!1}function nr(y,N){var L=y.C,B=N.indexOf(`
`,L);return B==-1?ft:(L=Number(N.substring(L,B)),isNaN(L)?Te:(B+=1,B+L>N.length?ft:(N=N.slice(B,B+L),y.C=B+L,N)))}et.prototype.cancel=function(){this.J=!0,ms(this)};function Kn(y){y.S=Date.now()+y.I,hs(y,y.I)}function hs(y,N){if(y.B!=null)throw Error("WatchDog timer not null");y.B=ce(f(y.ba,y),N)}function fs(y){y.B&&(l.clearTimeout(y.B),y.B=null)}et.prototype.ba=function(){this.B=null;const y=Date.now();0<=y-this.S?(oe(this.i,this.A),this.L!=2&&(an(),K(17)),ms(this),this.s=2,Js(this)):hs(this,this.S-y)};function Js(y){y.j.G==0||y.J||GA(y.j,y)}function ms(y){fs(y);var N=y.M;N&&typeof N.ma=="function"&&N.ma(),y.M=null,re(y.U),y.g&&(N=y.g,y.g=null,N.abort(),N.ma())}function Xt(y,N){try{var L=y.j;if(L.G!=0&&(L.g==y||Ne(L.h,y))){if(!y.K&&Ne(L.h,y)&&L.G==3){try{var B=L.Da.g.parse(N)}catch{B=null}if(Array.isArray(B)&&B.length==3){var ie=B;if(ie[0]==0){e:if(!L.u){if(L.g)if(L.g.F+3e3<y.F)qg(L),Wg(L);else break e;Gb(L),K(18)}}else L.za=ie[1],0<L.za-L.T&&37500>ie[2]&&L.F&&L.v==0&&!L.C&&(L.C=ce(f(L.Za,L),6e3));if(1>=ge(L.h)&&L.ca){try{L.ca()}catch{}L.ca=void 0}}else Nc(L,11)}else if((y.K||L.g==y)&&qg(L),!b(N))for(ie=L.Da.g.parse(N),N=0;N<ie.length;N++){let bn=ie[N];if(L.T=bn[0],bn=bn[1],L.G==2)if(bn[0]=="c"){L.K=bn[1],L.ia=bn[2];const ps=bn[3];ps!=null&&(L.la=ps,L.j.info("VER="+L.la));const gs=bn[4];gs!=null&&(L.Aa=gs,L.j.info("SVER="+L.Aa));const rd=bn[5];rd!=null&&typeof rd=="number"&&0<rd&&(B=1.5*rd,L.L=B,L.j.info("backChannelRequestTimeoutMs_="+B)),B=L;const io=y.g;if(io){const Yg=io.g?io.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Yg){var xe=B.h;xe.g||Yg.indexOf("spdy")==-1&&Yg.indexOf("quic")==-1&&Yg.indexOf("h2")==-1||(xe.j=xe.l,xe.g=new Set,xe.h&&($e(xe,xe.h),xe.h=null))}if(B.D){const Hb=io.g?io.g.getResponseHeader("X-HTTP-Session-Id"):null;Hb&&(B.ya=Hb,rn(B.I,B.D,Hb))}}L.G=3,L.l&&L.l.ua(),L.ba&&(L.R=Date.now()-y.F,L.j.info("Handshake RTT: "+L.R+"ms")),B=L;var rt=y;if(B.qa=qA(B,B.J?B.ia:null,B.W),rt.K){_e(B.h,rt);var Ln=rt,Qr=B.L;Qr&&(Ln.I=Qr),Ln.B&&(fs(Ln),Kn(Ln)),B.g=rt}else BA(B);0<L.i.length&&Hg(L)}else bn[0]!="stop"&&bn[0]!="close"||Nc(L,7);else L.G==3&&(bn[0]=="stop"||bn[0]=="close"?bn[0]=="stop"?Nc(L,7):zb(L):bn[0]!="noop"&&L.l&&L.l.ta(bn),L.v=0)}}an(4)}catch{}}var se=class{constructor(y,N){this.g=y,this.map=N}};function de(y){this.l=y||10,l.PerformanceNavigationTiming?(y=l.performance.getEntriesByType("navigation"),y=0<y.length&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ae(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function ge(y){return y.h?1:y.g?y.g.size:0}function Ne(y,N){return y.h?y.h==N:y.g?y.g.has(N):!1}function $e(y,N){y.g?y.g.add(N):y.h=N}function _e(y,N){y.h&&y.h==N?y.h=null:y.g&&y.g.has(N)&&y.g.delete(N)}de.prototype.cancel=function(){if(this.i=Je(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Je(y){if(y.h!=null)return y.i.concat(y.h.D);if(y.g!=null&&y.g.size!==0){let N=y.i;for(const L of y.g.values())N=N.concat(L.D);return N}return x(y.i)}function Nt(y){if(y.V&&typeof y.V=="function")return y.V();if(typeof Map<"u"&&y instanceof Map||typeof Set<"u"&&y instanceof Set)return Array.from(y.values());if(typeof y=="string")return y.split("");if(c(y)){for(var N=[],L=y.length,B=0;B<L;B++)N.push(y[B]);return N}N=[],L=0;for(B in y)N[L++]=y[B];return N}function Ut(y){if(y.na&&typeof y.na=="function")return y.na();if(!y.V||typeof y.V!="function"){if(typeof Map<"u"&&y instanceof Map)return Array.from(y.keys());if(!(typeof Set<"u"&&y instanceof Set)){if(c(y)||typeof y=="string"){var N=[];y=y.length;for(var L=0;L<y;L++)N.push(L);return N}N=[],L=0;for(const B in y)N[L++]=B;return N}}}function Ye(y,N){if(y.forEach&&typeof y.forEach=="function")y.forEach(N,void 0);else if(c(y)||typeof y=="string")Array.prototype.forEach.call(y,N,void 0);else for(var L=Ut(y),B=Nt(y),ie=B.length,xe=0;xe<ie;xe++)N.call(void 0,B[xe],L&&L[xe],y)}var Ot=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fr(y,N){if(y){y=y.split("&");for(var L=0;L<y.length;L++){var B=y[L].indexOf("="),ie=null;if(0<=B){var xe=y[L].substring(0,B);ie=y[L].substring(B+1)}else xe=y[L];N(xe,ie?decodeURIComponent(ie.replace(/\+/g," ")):"")}}}function Rt(y){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,y instanceof Rt){this.h=y.h,Yr(this,y.j),this.o=y.o,this.g=y.g,Br(this,y.s),this.l=y.l;var N=y.i,L=new zr;L.i=N.i,N.g&&(L.g=new Map(N.g),L.h=N.h),js(this,L),this.m=y.m}else y&&(N=String(y).match(Ot))?(this.h=!1,Yr(this,N[1]||"",!0),this.o=Qt(N[2]||""),this.g=Qt(N[3]||"",!0),Br(this,N[4]),this.l=Qt(N[5]||"",!0),js(this,N[6]||"",!0),this.m=Qt(N[7]||"")):(this.h=!1,this.i=new zr(null,this.h))}Rt.prototype.toString=function(){var y=[],N=this.j;N&&y.push(Xr(N,pn,!0),":");var L=this.g;return(L||N=="file")&&(y.push("//"),(N=this.o)&&y.push(Xr(N,pn,!0),"@"),y.push(encodeURIComponent(String(L)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L=this.s,L!=null&&y.push(":",String(L))),(L=this.l)&&(this.g&&L.charAt(0)!="/"&&y.push("/"),y.push(Xr(L,L.charAt(0)=="/"?Xa:Yn,!0))),(L=this.i.toString())&&y.push("?",L),(L=this.m)&&y.push("#",Xr(L,Ds)),y.join("")};function _n(y){return new Rt(y)}function Yr(y,N,L){y.j=L?Qt(N,!0):N,y.j&&(y.j=y.j.replace(/:$/,""))}function Br(y,N){if(N){if(N=Number(N),isNaN(N)||0>N)throw Error("Bad port number "+N);y.s=N}else y.s=null}function js(y,N,L){N instanceof zr?(y.i=N,QH(y.i,y.h)):(L||(N=Xr(N,Ao)),y.i=new zr(N,y.h))}function rn(y,N,L){y.i.set(N,L)}function Jr(y){return rn(y,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),y}function Qt(y,N){return y?N?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function Xr(y,N,L){return typeof y=="string"?(y=encodeURI(y).replace(N,ln),L&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function ln(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var pn=/[#\/\?@]/g,Yn=/[#\?:]/g,Xa=/[#\?]/g,Ao=/[#\?@]/g,Ds=/#/g;function zr(y,N){this.h=this.g=null,this.i=y||null,this.j=!!N}function so(y){y.g||(y.g=new Map,y.h=0,y.i&&fr(y.i,function(N,L){y.add(decodeURIComponent(N.replace(/\+/g," ")),L)}))}t=zr.prototype,t.add=function(y,N){so(this),this.i=null,y=td(this,y);var L=this.g.get(y);return L||this.g.set(y,L=[]),L.push(N),this.h+=1,this};function NA(y,N){so(y),N=td(y,N),y.g.has(N)&&(y.i=null,y.h-=y.g.get(N).length,y.g.delete(N))}function PA(y,N){return so(y),N=td(y,N),y.g.has(N)}t.forEach=function(y,N){so(this),this.g.forEach(function(L,B){L.forEach(function(ie){y.call(N,ie,B,this)},this)},this)},t.na=function(){so(this);const y=Array.from(this.g.values()),N=Array.from(this.g.keys()),L=[];for(let B=0;B<N.length;B++){const ie=y[B];for(let xe=0;xe<ie.length;xe++)L.push(N[B])}return L},t.V=function(y){so(this);let N=[];if(typeof y=="string")PA(this,y)&&(N=N.concat(this.g.get(td(this,y))));else{y=Array.from(this.g.values());for(let L=0;L<y.length;L++)N=N.concat(y[L])}return N},t.set=function(y,N){return so(this),this.i=null,y=td(this,y),PA(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[N]),this.h+=1,this},t.get=function(y,N){return y?(y=this.V(y),0<y.length?String(y[0]):N):N};function AA(y,N,L){NA(y,N),0<L.length&&(y.i=null,y.g.set(td(y,N),x(L)),y.h+=L.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],N=Array.from(this.g.keys());for(var L=0;L<N.length;L++){var B=N[L];const xe=encodeURIComponent(String(B)),rt=this.V(B);for(B=0;B<rt.length;B++){var ie=xe;rt[B]!==""&&(ie+="="+encodeURIComponent(String(rt[B]))),y.push(ie)}}return this.i=y.join("&")};function td(y,N){return N=String(N),y.j&&(N=N.toLowerCase()),N}function QH(y,N){N&&!y.j&&(so(y),y.i=null,y.g.forEach(function(L,B){var ie=B.toLowerCase();B!=ie&&(NA(this,B),AA(this,ie,L))},y)),y.j=N}function ZH(y,N){const L=new ke;if(l.Image){const B=new Image;B.onload=m(Qa,L,"TestLoadImage: loaded",!0,N,B),B.onerror=m(Qa,L,"TestLoadImage: error",!1,N,B),B.onabort=m(Qa,L,"TestLoadImage: abort",!1,N,B),B.ontimeout=m(Qa,L,"TestLoadImage: timeout",!1,N,B),l.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=y}else N(!1)}function eq(y,N){const L=new ke,B=new AbortController,ie=setTimeout(()=>{B.abort(),Qa(L,"TestPingServer: timeout",!1,N)},1e4);fetch(y,{signal:B.signal}).then(xe=>{clearTimeout(ie),xe.ok?Qa(L,"TestPingServer: ok",!0,N):Qa(L,"TestPingServer: server error",!1,N)}).catch(()=>{clearTimeout(ie),Qa(L,"TestPingServer: error",!1,N)})}function Qa(y,N,L,B,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),B(L)}catch{}}function tq(){this.g=new ve}function nq(y,N,L){const B=L||"";try{Ye(y,function(ie,xe){let rt=ie;u(ie)&&(rt=pe(ie)),N.push(B+xe+"="+encodeURIComponent(rt))})}catch(ie){throw N.push(B+"type="+encodeURIComponent("_badmap")),ie}}function Bg(y){this.l=y.Ub||null,this.j=y.eb||!1}g(Bg,gt),Bg.prototype.g=function(){return new zg(this.l,this.j)},Bg.prototype.i=function(y){return function(){return y}}({});function zg(y,N){Ie.call(this),this.D=y,this.o=N,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(zg,Ie),t=zg.prototype,t.open=function(y,N){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=y,this.A=N,this.readyState=1,vf(this)},t.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const N={headers:this.u,method:this.B,credentials:this.m,cache:void 0};y&&(N.body=y),(this.D||l).fetch(new Request(this.A,N)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,xf(this)),this.readyState=0},t.Sa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,vf(this)),this.g&&(this.readyState=3,vf(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;kA(this)}else y.text().then(this.Ra.bind(this),this.ga.bind(this))};function kA(y){y.j.read().then(y.Pa.bind(y)).catch(y.ga.bind(y))}t.Pa=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var N=y.value?y.value:new Uint8Array(0);(N=this.v.decode(N,{stream:!y.done}))&&(this.response=this.responseText+=N)}y.done?xf(this):vf(this),this.readyState==3&&kA(this)}},t.Ra=function(y){this.g&&(this.response=this.responseText=y,xf(this))},t.Qa=function(y){this.g&&(this.response=y,xf(this))},t.ga=function(){this.g&&xf(this)};function xf(y){y.readyState=4,y.l=null,y.j=null,y.v=null,vf(y)}t.setRequestHeader=function(y,N){this.u.append(y,N)},t.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],N=this.h.entries();for(var L=N.next();!L.done;)L=L.value,y.push(L[0]+": "+L[1]),L=N.next();return y.join(`\r
`)};function vf(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(zg.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function RA(y){let N="";return k(y,function(L,B){N+=B,N+=":",N+=L,N+=`\r
`}),N}function Bb(y,N,L){e:{for(B in L){var B=!1;break e}B=!0}B||(L=RA(L),typeof y=="string"?L!=null&&encodeURIComponent(String(L)):rn(y,N,L))}function mr(y){Ie.call(this),this.headers=new Map,this.o=y||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(mr,Ie);var rq=/^https?$/i,sq=["POST","PUT"];t=mr.prototype,t.Ha=function(y){this.J=y},t.ea=function(y,N,L,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);N=N?N.toUpperCase():"GET",this.D=y,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():fe.g(),this.v=this.o?wt(this.o):wt(fe),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(N,String(y),!0),this.B=!1}catch(xe){jA(this,xe);return}if(y=L||"",L=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var ie in B)L.set(ie,B[ie]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const xe of B.keys())L.set(xe,B.get(xe));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(L.keys()).find(xe=>xe.toLowerCase()=="content-type"),ie=l.FormData&&y instanceof l.FormData,!(0<=Array.prototype.indexOf.call(sq,N,void 0))||B||ie||L.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[xe,rt]of L)this.g.setRequestHeader(xe,rt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{LA(this),this.u=!0,this.g.send(y),this.u=!1}catch(xe){jA(this,xe)}};function jA(y,N){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=N,y.m=5,DA(y),Gg(y)}function DA(y){y.A||(y.A=!0,ee(y,"complete"),ee(y,"error"))}t.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=y||7,ee(this,"complete"),ee(this,"abort"),Gg(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gg(this,!0)),mr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?MA(this):this.bb())},t.bb=function(){MA(this)};function MA(y){if(y.h&&typeof o<"u"&&(!y.v[1]||ua(y)!=4||y.Z()!=2)){if(y.u&&ua(y)==4)X(y.Ea,0,y);else if(ee(y,"readystatechange"),ua(y)==4){y.h=!1;try{const rt=y.Z();e:switch(rt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var N=!0;break e;default:N=!1}var L;if(!(L=N)){var B;if(B=rt===0){var ie=String(y.D).match(Ot)[1]||null;!ie&&l.self&&l.self.location&&(ie=l.self.location.protocol.slice(0,-1)),B=!rq.test(ie?ie.toLowerCase():"")}L=B}if(L)ee(y,"complete"),ee(y,"success");else{y.m=6;try{var xe=2<ua(y)?y.g.statusText:""}catch{xe=""}y.l=xe+" ["+y.Z()+"]",DA(y)}}finally{Gg(y)}}}}function Gg(y,N){if(y.g){LA(y);const L=y.g,B=y.v[0]?()=>{}:null;y.g=null,y.v=null,N||ee(y,"ready");try{L.onreadystatechange=B}catch{}}}function LA(y){y.I&&(l.clearTimeout(y.I),y.I=null)}t.isActive=function(){return!!this.g};function ua(y){return y.g?y.g.readyState:0}t.Z=function(){try{return 2<ua(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(y){if(this.g){var N=this.g.responseText;return y&&N.indexOf(y)==0&&(N=N.substring(y.length)),Me(N)}};function FA(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.H){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function iq(y){const N={};y=(y.g&&2<=ua(y)&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<y.length;B++){if(b(y[B]))continue;var L=R(y[B]);const ie=L[0];if(L=L[1],typeof L!="string")continue;L=L.trim();const xe=N[ie]||[];N[ie]=xe,xe.push(L)}C(N,function(B){return B.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function wf(y,N,L){return L&&L.internalChannelParams&&L.internalChannelParams[y]||N}function OA(y){this.Aa=0,this.i=[],this.j=new ke,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=wf("failFast",!1,y),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=wf("baseRetryDelayMs",5e3,y),this.cb=wf("retryDelaySeedMs",1e4,y),this.Wa=wf("forwardChannelMaxRetries",2,y),this.wa=wf("forwardChannelRequestTimeoutMs",2e4,y),this.pa=y&&y.xmlHttpFactory||void 0,this.Xa=y&&y.Tb||void 0,this.Ca=y&&y.useFetchStreams||!1,this.L=void 0,this.J=y&&y.supportsCrossDomainXhr||!1,this.K="",this.h=new de(y&&y.concurrentRequestLimit),this.Da=new tq,this.P=y&&y.fastHandshake||!1,this.O=y&&y.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=y&&y.Rb||!1,y&&y.xa&&this.j.xa(),y&&y.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&y&&y.detectBufferingProxy||!1,this.ja=void 0,y&&y.longPollingTimeout&&0<y.longPollingTimeout&&(this.ja=y.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=OA.prototype,t.la=8,t.G=1,t.connect=function(y,N,L,B){K(0),this.W=y,this.H=N||{},L&&B!==void 0&&(this.H.OSID=L,this.H.OAID=B),this.F=this.X,this.I=qA(this,null,this.W),Hg(this)};function zb(y){if($A(y),y.G==3){var N=y.U++,L=_n(y.I);if(rn(L,"SID",y.K),rn(L,"RID",N),rn(L,"TYPE","terminate"),bf(y,L),N=new et(y,y.j,N),N.L=2,N.v=Jr(_n(L)),L=!1,l.navigator&&l.navigator.sendBeacon)try{L=l.navigator.sendBeacon(N.v.toString(),"")}catch{}!L&&l.Image&&(new Image().src=N.v,L=!0),L||(N.g=KA(N.j,null),N.g.ea(N.v)),N.F=Date.now(),Kn(N)}HA(y)}function Wg(y){y.g&&(Wb(y),y.g.cancel(),y.g=null)}function $A(y){Wg(y),y.u&&(l.clearTimeout(y.u),y.u=null),qg(y),y.h.cancel(),y.s&&(typeof y.s=="number"&&l.clearTimeout(y.s),y.s=null)}function Hg(y){if(!ae(y.h)&&!y.s){y.s=!0;var N=y.Ga;H||O(),$||(H(),$=!0),J.add(N,y),y.B=0}}function oq(y,N){return ge(y.h)>=y.h.j-(y.s?1:0)?!1:y.s?(y.i=N.D.concat(y.i),!0):y.G==1||y.G==2||y.B>=(y.Va?0:y.Wa)?!1:(y.s=ce(f(y.Ga,y,N),WA(y,y.B)),y.B++,!0)}t.Ga=function(y){if(this.s)if(this.s=null,this.G==1){if(!y){this.U=Math.floor(1e5*Math.random()),y=this.U++;const ie=new et(this,this.j,y);let xe=this.o;if(this.S&&(xe?(xe=T(xe),A(xe,this.S)):xe=this.S),this.m!==null||this.O||(ie.H=xe,xe=null),this.P)e:{for(var N=0,L=0;L<this.i.length;L++){t:{var B=this.i[L];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(N+=B,4096<N){N=L;break e}if(N===4096||L===this.i.length-1){N=L+1;break e}}N=1e3}else N=1e3;N=UA(this,ie,N),L=_n(this.I),rn(L,"RID",y),rn(L,"CVER",22),this.D&&rn(L,"X-HTTP-Session-Id",this.D),bf(this,L),xe&&(this.O?N="headers="+encodeURIComponent(String(RA(xe)))+"&"+N:this.m&&Bb(L,this.m,xe)),$e(this.h,ie),this.Ua&&rn(L,"TYPE","init"),this.P?(rn(L,"$req",N),rn(L,"SID","null"),ie.T=!0,Ct(ie,L,null)):Ct(ie,L,N),this.G=2}}else this.G==3&&(y?VA(this,y):this.i.length==0||ae(this.h)||VA(this))};function VA(y,N){var L;N?L=N.l:L=y.U++;const B=_n(y.I);rn(B,"SID",y.K),rn(B,"RID",L),rn(B,"AID",y.T),bf(y,B),y.m&&y.o&&Bb(B,y.m,y.o),L=new et(y,y.j,L,y.B+1),y.m===null&&(L.H=y.o),N&&(y.i=N.D.concat(y.i)),N=UA(y,L,1e3),L.I=Math.round(.5*y.wa)+Math.round(.5*y.wa*Math.random()),$e(y.h,L),Ct(L,B,N)}function bf(y,N){y.H&&k(y.H,function(L,B){rn(N,B,L)}),y.l&&Ye({},function(L,B){rn(N,B,L)})}function UA(y,N,L){L=Math.min(y.i.length,L);var B=y.l?f(y.l.Na,y.l,y):null;e:{var ie=y.i;let xe=-1;for(;;){const rt=["count="+L];xe==-1?0<L?(xe=ie[0].g,rt.push("ofs="+xe)):xe=0:rt.push("ofs="+xe);let Ln=!0;for(let Qr=0;Qr<L;Qr++){let bn=ie[Qr].g;const ps=ie[Qr].map;if(bn-=xe,0>bn)xe=Math.max(0,ie[Qr].g-100),Ln=!1;else try{nq(ps,rt,"req"+bn+"_")}catch{B&&B(ps)}}if(Ln){B=rt.join("&");break e}}}return y=y.i.splice(0,L),N.D=y,B}function BA(y){if(!y.g&&!y.u){y.Y=1;var N=y.Fa;H||O(),$||(H(),$=!0),J.add(N,y),y.v=0}}function Gb(y){return y.g||y.u||3<=y.v?!1:(y.Y++,y.u=ce(f(y.Fa,y),WA(y,y.v)),y.v++,!0)}t.Fa=function(){if(this.u=null,zA(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var y=2*this.R;this.j.info("BP detection timer enabled: "+y),this.A=ce(f(this.ab,this),y)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,K(10),Wg(this),zA(this))};function Wb(y){y.A!=null&&(l.clearTimeout(y.A),y.A=null)}function zA(y){y.g=new et(y,y.j,"rpc",y.Y),y.m===null&&(y.g.H=y.o),y.g.O=0;var N=_n(y.qa);rn(N,"RID","rpc"),rn(N,"SID",y.K),rn(N,"AID",y.T),rn(N,"CI",y.F?"0":"1"),!y.F&&y.ja&&rn(N,"TO",y.ja),rn(N,"TYPE","xmlhttp"),bf(y,N),y.m&&y.o&&Bb(N,y.m,y.o),y.L&&(y.g.I=y.L);var L=y.g;y=y.ia,L.L=1,L.v=Jr(_n(N)),L.m=null,L.P=!0,mn(L,y)}t.Za=function(){this.C!=null&&(this.C=null,Wg(this),Gb(this),K(19))};function qg(y){y.C!=null&&(l.clearTimeout(y.C),y.C=null)}function GA(y,N){var L=null;if(y.g==N){qg(y),Wb(y),y.g=null;var B=2}else if(Ne(y.h,N))L=N.D,_e(y.h,N),B=1;else return;if(y.G!=0){if(N.o)if(B==1){L=N.m?N.m.length:0,N=Date.now()-N.F;var ie=y.B;B=Gn(),ee(B,new te(B,L)),Hg(y)}else BA(y);else if(ie=N.s,ie==3||ie==0&&0<N.X||!(B==1&&oq(y,N)||B==2&&Gb(y)))switch(L&&0<L.length&&(N=y.h,N.i=N.i.concat(L)),ie){case 1:Nc(y,5);break;case 4:Nc(y,10);break;case 3:Nc(y,6);break;default:Nc(y,2)}}}function WA(y,N){let L=y.Ta+Math.floor(Math.random()*y.cb);return y.isActive()||(L*=2),L*N}function Nc(y,N){if(y.j.info("Error code "+N),N==2){var L=f(y.fb,y),B=y.Xa;const ie=!B;B=new Rt(B||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Yr(B,"https"),Jr(B),ie?ZH(B.toString(),L):eq(B.toString(),L)}else K(2);y.G=0,y.l&&y.l.sa(N),HA(y),$A(y)}t.fb=function(y){y?(this.j.info("Successfully pinged google.com"),K(2)):(this.j.info("Failed to ping google.com"),K(1))};function HA(y){if(y.G=0,y.ka=[],y.l){const N=Je(y.h);(N.length!=0||y.i.length!=0)&&(E(y.ka,N),E(y.ka,y.i),y.h.i.length=0,x(y.i),y.i.length=0),y.l.ra()}}function qA(y,N,L){var B=L instanceof Rt?_n(L):new Rt(L);if(B.g!="")N&&(B.g=N+"."+B.g),Br(B,B.s);else{var ie=l.location;B=ie.protocol,N=N?N+"."+ie.hostname:ie.hostname,ie=+ie.port;var xe=new Rt(null);B&&Yr(xe,B),N&&(xe.g=N),ie&&Br(xe,ie),L&&(xe.l=L),B=xe}return L=y.D,N=y.ya,L&&N&&rn(B,L,N),rn(B,"VER",y.la),bf(y,B),B}function KA(y,N,L){if(N&&!y.J)throw Error("Can't create secondary domain capable XhrIo object.");return N=y.Ca&&!y.pa?new mr(new Bg({eb:L})):new mr(y.pa),N.Ha(y.J),N}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function YA(){}t=YA.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Kg(){}Kg.prototype.g=function(y,N){return new mi(y,N)};function mi(y,N){Ie.call(this),this.g=new OA(N),this.l=y,this.h=N&&N.messageUrlParams||null,y=N&&N.messageHeaders||null,N&&N.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=N&&N.initMessageHeaders||null,N&&N.messageContentType&&(y?y["X-WebChannel-Content-Type"]=N.messageContentType:y={"X-WebChannel-Content-Type":N.messageContentType}),N&&N.va&&(y?y["X-WebChannel-Client-Profile"]=N.va:y={"X-WebChannel-Client-Profile":N.va}),this.g.S=y,(y=N&&N.Sb)&&!b(y)&&(this.g.m=y),this.v=N&&N.supportsCrossDomainXhr||!1,this.u=N&&N.sendRawJson||!1,(N=N&&N.httpSessionIdParam)&&!b(N)&&(this.g.D=N,y=this.h,y!==null&&N in y&&(y=this.h,N in y&&delete y[N])),this.j=new nd(this)}g(mi,Ie),mi.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},mi.prototype.close=function(){zb(this.g)},mi.prototype.o=function(y){var N=this.g;if(typeof y=="string"){var L={};L.__data__=y,y=L}else this.u&&(L={},L.__data__=pe(y),y=L);N.i.push(new se(N.Ya++,y)),N.G==3&&Hg(N)},mi.prototype.N=function(){this.g.l=null,delete this.j,zb(this.g),delete this.g,mi.aa.N.call(this)};function JA(y){At.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var N=y.__sm__;if(N){e:{for(const L in N){y=L;break e}y=void 0}(this.i=y)&&(y=this.i,N=N!==null&&y in N?N[y]:void 0),this.data=N}else this.data=y}g(JA,At);function XA(){Nn.call(this),this.status=1}g(XA,Nn);function nd(y){this.g=y}g(nd,YA),nd.prototype.ua=function(){ee(this.g,"a")},nd.prototype.ta=function(y){ee(this.g,new JA(y))},nd.prototype.sa=function(y){ee(this.g,new XA)},nd.prototype.ra=function(){ee(this.g,"b")},Kg.prototype.createWebChannel=Kg.prototype.g,mi.prototype.send=mi.prototype.o,mi.prototype.open=mi.prototype.m,mi.prototype.close=mi.prototype.close,Sz=function(){return new Kg},_z=function(){return Gn()},bz=on,BC={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ce.NO_ERROR=0,Ce.TIMEOUT=8,Ce.HTTP_ERROR=6,Fx=Ce,Q.COMPLETE="complete",wz=Q,dt.EventType=xt,xt.OPEN="a",xt.CLOSE="b",xt.ERROR="c",xt.MESSAGE="d",Ie.prototype.listen=Ie.prototype.K,dm=dt,mr.prototype.listenOnce=mr.prototype.L,mr.prototype.getLastError=mr.prototype.Ka,mr.prototype.getLastErrorCode=mr.prototype.Ba,mr.prototype.getStatus=mr.prototype.Z,mr.prototype.getResponseJson=mr.prototype.Oa,mr.prototype.getResponseText=mr.prototype.oa,mr.prototype.send=mr.prototype.ea,mr.prototype.setWithCredentials=mr.prototype.Ha,vz=mr}).apply(typeof Uy<"u"?Uy:typeof self<"u"?self:typeof window<"u"?window:{});const pM="@firebase/firestore",gM="4.7.16";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}rs.UNAUTHENTICATED=new rs(null),rs.GOOGLE_CREDENTIALS=new rs("google-credentials-uid"),rs.FIRST_PARTY=new rs("first-party-uid"),rs.MOCK_USER=new rs("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uf="11.8.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pu=new EN("@firebase/firestore");function Cd(){return Pu.logLevel}function Ge(t,...e){if(Pu.logLevel<=hn.DEBUG){const n=e.map(LN);Pu.debug(`Firestore (${uf}): ${t}`,...n)}}function Vs(t,...e){if(Pu.logLevel<=hn.ERROR){const n=e.map(LN);Pu.error(`Firestore (${uf}): ${t}`,...n)}}function Au(t,...e){if(Pu.logLevel<=hn.WARN){const n=e.map(LN);Pu.warn(`Firestore (${uf}): ${t}`,...n)}}function LN(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Ez(t,r,n)}function Ez(t,e,n){let r=`FIRESTORE (${uf}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Vs(r),new Error(r)}function Tt(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||Ez(e,s,r)}function Kt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class lt extends Po{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cz{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class yye{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(rs.UNAUTHENTICATED))}shutdown(){}}class xye{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class vye{constructor(e){this.t=e,this.currentUser=rs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Tt(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Zo;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Zo,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Zo)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Tt(typeof r.accessToken=="string",31837,{l:r}),new Cz(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Tt(e===null||typeof e=="string",2055,{h:e}),new rs(e)}}class wye{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=rs.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class bye{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new wye(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(rs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class yM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class _ye{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,$s(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Tt(this.o===void 0,3512);const r=i=>{i.error!=null&&Ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Ge("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new yM(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Tt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new yM(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sye(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tz(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iz{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=Sye(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function $t(t,e){return t<e?-1:t>e?1:0}function zC(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return $t(r,s);{const i=Tz(),o=Eye(i.encode(xM(t,n)),i.encode(xM(e,n)));return o!==0?o:$t(r,s)}}n+=r>65535?2:1}return $t(t.length,e.length)}function xM(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function Eye(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return $t(t[n],e[n]);return $t(t.length,e.length)}function Dh(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function Nz(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vM=-62135596800,wM=1e6;class cr{static now(){return cr.fromMillis(Date.now())}static fromDate(e){return cr.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*wM);return new cr(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new lt(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new lt(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<vM)throw new lt(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new lt(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/wM}_compareTo(e){return this.seconds===e.seconds?$t(this.nanoseconds,e.nanoseconds):$t(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-vM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{static fromTimestamp(e){return new kt(e)}static min(){return new kt(new cr(0,0))}static max(){return new kt(new cr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bM="__name__";class Fo{constructor(e,n,r){n===void 0?n=0:n>e.length&&bt(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&bt(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Fo.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Fo?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Fo.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return $t(e.length,n.length)}static compareSegments(e,n){const r=Fo.isNumericId(e),s=Fo.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Fo.extractNumericId(e).compare(Fo.extractNumericId(n)):zC(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Bl.fromString(e.substring(4,e.length-2))}}class In extends Fo{construct(e,n,r){return new In(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new lt(Pe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new In(n)}static emptyPath(){return new In([])}}const Cye=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ar extends Fo{construct(e,n,r){return new ar(e,n,r)}static isValidIdentifier(e){return Cye.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ar.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bM}static keyField(){return new ar([bM])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new lt(Pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new lt(Pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new lt(Pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new lt(Pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ar(n)}static emptyPath(){return new ar([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e){this.path=e}static fromPath(e){return new ut(In.fromString(e))}static fromName(e){return new ut(In.fromString(e).popFirst(5))}static empty(){return new ut(In.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&In.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return In.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ut(new In(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pp=-1;class iw{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function GC(t){return t.fields.find(e=>e.kind===2)}function Oc(t){return t.fields.filter(e=>e.kind!==2)}iw.UNKNOWN_ID=-1;class Ox{constructor(e,n){this.fieldPath=e,this.kind=n}}class Ap{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ap(0,ji.min())}}function Tye(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=kt.fromTimestamp(r===1e9?new cr(n+1,0):new cr(n,r));return new ji(s,ut.empty(),e)}function Pz(t){return new ji(t.readTime,t.key,Pp)}class ji{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new ji(kt.min(),ut.empty(),Pp)}static max(){return new ji(kt.max(),ut.empty(),Pp)}}function FN(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ut.comparator(t.documentKey,e.documentKey),n!==0?n:$t(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Az="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class kz{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qu(t){if(t.code!==Pe.FAILED_PRECONDITION||t.message!==Az)throw t;Ge("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&bt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new le((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof le?n:le.resolve(n)}catch(n){return le.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):le.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):le.reject(n)}static resolve(e){return new le((n,r)=>{n(e)})}static reject(e){return new le((n,r)=>{r(e)})}static waitFor(e){return new le((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=le.resolve(!1);for(const r of e)n=n.next(s=>s?le.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new le((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new le((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i="SimpleDb";class eb{static open(e,n,r,s){try{return new eb(n,e.transaction(s,r))}catch(i){throw new $m(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Zo,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new $m(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=ON(r.target.error);this.S.reject(new $m(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ge(_i,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new Nye(n)}}class zl{static delete(e){return Ge(_i,"Removing database:",e),Hc(CB().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!jB())return!1;if(zl.F())return!0;const e=$r(),n=zl.M(e),r=0<n&&n<10,s=Rz(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.B=r,this.L=null,zl.M($r())===12.2&&Vs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(Ge(_i,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new $m(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new lt(Pe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new lt(Pe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new $m(e,o))},s.onupgradeneeded=i=>{Ge(_i,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;if(this.L!==null&&this.L!==i.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${i.oldVersion}, event.newVersion=${i.newVersion}, db.version=${o.version}`);this.B.q(o,s.transaction,i.oldVersion,this.version).next(()=>{Ge(_i,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",n=>{const r=n.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=n=>this.$(n)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const l=eb.open(this.db,e,i?"readonly":"readwrite",r),c=s(l).next(u=>(l.v(),u)).catch(u=>(l.abort(u),le.reject(u))).toPromise();return c.catch(()=>{}),await l.D,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(Ge(_i,"Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Rz(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class Iye{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return Hc(this.K.delete())}}class $m extends lt{constructor(e,n){super(Pe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Ec(t){return t.name==="IndexedDbTransactionError"}class Nye{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Ge(_i,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(Ge(_i,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Hc(r)}add(e){return Ge(_i,"ADD",this.store.name,e,e),Hc(this.store.add(e))}get(e){return Hc(this.store.get(e)).next(n=>(n===void 0&&(n=null),Ge(_i,"GET",this.store.name,e,n),n))}delete(e){return Ge(_i,"DELETE",this.store.name,e),Hc(this.store.delete(e))}count(){return Ge(_i,"COUNT",this.store.name),Hc(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new le((o,l)=>{i.onerror=c=>{l(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.Y(i,(l,c)=>{o.push(c)}).next(()=>o)}}Z(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new le((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}X(e,n){Ge(_i,"DELETE ALL",this.store.name);const r=this.options(e,n);r.ee=!1;const s=this.cursor(r);return this.Y(s,(i,o,l)=>l.delete())}te(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.Y(s,n)}ne(e){const n=this.cursor({});return new le((r,s)=>{n.onerror=i=>{const o=ON(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():r()}):r()}})}Y(e,n){const r=[];return new le((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const c=new Iye(l),u=n(l.primaryKey,l.value,c);if(u instanceof le){const d=u.catch(h=>(c.done(),le.reject(h)));r.push(d)}c.isDone?s():c.j===null?l.continue():l.continue(c.j)}}).next(()=>le.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Hc(t){return new le((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=ON(r.target.error);n(s)}})}let _M=!1;function ON(t){const e=zl.M($r());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new lt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return _M||(_M=!0,setTimeout(()=>{throw r},0)),r}}return t}const Vm="IndexBackfiller";class Pye{constructor(e,n){this.asyncQueue=e,this.re=n,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){Ge(Vm,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.re.se();Ge(Vm,`Documents written: ${n}`)}catch(n){Ec(n)?Ge(Vm,"Ignoring IndexedDB error during index backfill: ",n):await qu(n)}await this.ie(6e4)})}}class Aye{constructor(e,n){this.localStore=e,this.persistence=n}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.oe(n,e))}oe(e,n){const r=new Set;let s=n,i=!0;return le.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Ge(Vm,`Processing collection: ${o}`),this._e(e,o,s).next(l=>{s-=l,r.add(o)});i=!1})).next(()=>n-s)}_e(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ae(s,i)).next(l=>(Ge(Vm,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,n,l))).next(()=>o.size)}))}ae(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=Pz(i);FN(o,r)>0&&(r=o)}),new ji(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>n.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Hi.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const du=-1;function tb(t){return t==null}function kp(t){return t===0&&1/t==-1/0}function kye(t){return typeof t=="number"&&Number.isInteger(t)&&!kp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ow="";function Ts(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=SM(e)),e=Rye(t.get(n),e);return SM(e)}function Rye(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case ow:n+="";break;default:n+=i}}return n}function SM(t){return t+ow+""}function Bo(t){const e=t.length;if(Tt(e>=2,64408,{path:t}),e===2)return Tt(t.charAt(0)===ow&&t.charAt(1)==="",56145,{path:t}),In.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(ow,i);switch((o<0||o>n)&&bt(50515,{path:t}),t.charAt(o+1)){case"":const l=t.substring(i,o);let c;s.length===0?c=l:(s+=l,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:bt(61167,{path:t})}i=o+2}return new In(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $c="remoteDocuments",Ig="owner",fd="owner",Rp="mutationQueues",jye="userId",mo="mutations",EM="batchId",iu="userMutationsIndex",CM=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $x(t,e){return[t,Ts(e)]}function jz(t,e,n){return[t,Ts(e),n]}const Dye={},Mh="documentMutations",aw="remoteDocumentsV14",Mye=["prefixPath","collectionGroup","readTime","documentId"],Vx="documentKeyIndex",Lye=["prefixPath","collectionGroup","documentId"],Dz="collectionGroupIndex",Fye=["collectionGroup","readTime","prefixPath","documentId"],jp="remoteDocumentGlobal",WC="remoteDocumentGlobalKey",Lh="targets",Mz="queryTargetsIndex",Oye=["canonicalId","targetId"],Fh="targetDocuments",$ye=["targetId","path"],$N="documentTargetsIndex",Vye=["path","targetId"],lw="targetGlobalKey",hu="targetGlobal",Dp="collectionParents",Uye=["collectionId","parent"],Oh="clientMetadata",Bye="clientId",nb="bundles",zye="bundleId",rb="namedQueries",Gye="name",VN="indexConfiguration",Wye="indexId",HC="collectionGroupIndex",Hye="collectionGroup",Um="indexState",qye=["indexId","uid"],Lz="sequenceNumberIndex",Kye=["uid","sequenceNumber"],Bm="indexEntries",Yye=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Fz="documentKeyIndex",Jye=["indexId","uid","orderedDocumentKey"],sb="documentOverlays",Xye=["userId","collectionPath","documentId"],qC="collectionPathOverlayIndex",Qye=["userId","collectionPath","largestBatchId"],Oz="collectionGroupOverlayIndex",Zye=["userId","collectionGroup","largestBatchId"],UN="globals",exe="name",$z=[Rp,mo,Mh,$c,Lh,Ig,hu,Fh,Oh,jp,Dp,nb,rb],txe=[...$z,sb],Vz=[Rp,mo,Mh,aw,Lh,Ig,hu,Fh,Oh,jp,Dp,nb,rb,sb],Uz=Vz,BN=[...Uz,VN,Um,Bm],nxe=BN,Bz=[...BN,UN],rxe=Bz;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC extends kz{constructor(e,n){super(),this.he=e,this.currentSequenceNumber=n}}function Ur(t,e){const n=Kt(t);return zl.N(n.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TM(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Cc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zz(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n){this.comparator=e,this.root=n||ss.EMPTY}insert(e,n){return new tr(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ss.BLACK,null,null))}remove(e){return new tr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ss.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new By(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new By(this.root,e,this.comparator,!1)}getReverseIterator(){return new By(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new By(this.root,e,this.comparator,!0)}}class By{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ss{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ss.RED,this.left=s??ss.EMPTY,this.right=i??ss.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ss(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ss.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ss.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ss.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ss.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw bt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw bt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw bt(27949);return e+(this.isRed()?0:1)}}ss.EMPTY=null,ss.RED=!0,ss.BLACK=!1;ss.EMPTY=new class{constructor(){this.size=0}get key(){throw bt(57766)}get value(){throw bt(16141)}get color(){throw bt(16727)}get left(){throw bt(29726)}get right(){throw bt(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new ss(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this.comparator=e,this.data=new tr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new IM(this.data.getIterator())}getIteratorFrom(e){return new IM(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Rn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Rn(this.comparator);return n.data=e,n}}class IM{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function md(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this.fields=e,e.sort(ar.comparator)}static empty(){return new ri([])}unionWith(e){let n=new Rn(ar.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new ri(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Dh(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gz extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Gz("Invalid base64 string: "+i):i}}(e);return new Dr(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Dr(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $t(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Dr.EMPTY_BYTE_STRING=new Dr("");const sxe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Oa(t){if(Tt(!!t,39018),typeof t=="string"){let e=0;const n=sxe.exec(t);if(Tt(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qn(t.seconds),nanos:Qn(t.nanos)}}function Qn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function $a(t){return typeof t=="string"?Dr.fromBase64String(t):Dr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wz="server_timestamp",Hz="__type__",qz="__previous_value__",Kz="__local_write_time__";function zN(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[Hz])===null||n===void 0?void 0:n.stringValue)===Wz}function ib(t){const e=t.mapValue.fields[qz];return zN(e)?ib(e):e}function Mp(t){const e=Oa(t.mapValue.fields[Kz].timestampValue);return new cr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ixe{constructor(e,n,r,s,i,o,l,c,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=d}}const cw="(default)";class ku{constructor(e,n){this.projectId=e,this.database=n||cw}static empty(){return new ku("","")}get isDefaultDatabase(){return this.database===cw}isEqual(e){return e instanceof ku&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GN="__type__",Yz="__max__",Il={mapValue:{fields:{__type__:{stringValue:Yz}}}},WN="__vector__",$h="value",Ux={nullValue:"NULL_VALUE"};function nc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?zN(t)?4:Jz(t)?9007199254740991:ob(t)?10:11:bt(28295,{value:t})}function sa(t,e){if(t===e)return!0;const n=nc(t);if(n!==nc(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Mp(t).isEqual(Mp(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Oa(s.timestampValue),l=Oa(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return $a(s.bytesValue).isEqual($a(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Qn(s.geoPointValue.latitude)===Qn(i.geoPointValue.latitude)&&Qn(s.geoPointValue.longitude)===Qn(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Qn(s.integerValue)===Qn(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Qn(s.doubleValue),l=Qn(i.doubleValue);return o===l?kp(o)===kp(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Dh(t.arrayValue.values||[],e.arrayValue.values||[],sa);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(TM(o)!==TM(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!sa(o[c],l[c])))return!1;return!0}(t,e);default:return bt(52216,{left:t})}}function Lp(t,e){return(t.values||[]).find(n=>sa(n,e))!==void 0}function rc(t,e){if(t===e)return 0;const n=nc(t),r=nc(e);if(n!==r)return $t(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return $t(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Qn(i.integerValue||i.doubleValue),c=Qn(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return NM(t.timestampValue,e.timestampValue);case 4:return NM(Mp(t),Mp(e));case 5:return zC(t.stringValue,e.stringValue);case 6:return function(i,o){const l=$a(i),c=$a(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=$t(l[u],c[u]);if(d!==0)return d}return $t(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=$t(Qn(i.latitude),Qn(o.latitude));return l!==0?l:$t(Qn(i.longitude),Qn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return PM(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const h=i.fields||{},f=o.fields||{},m=(l=h[$h])===null||l===void 0?void 0:l.arrayValue,g=(c=f[$h])===null||c===void 0?void 0:c.arrayValue,x=$t(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((d=g==null?void 0:g.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:PM(m,g)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Il.mapValue&&o===Il.mapValue)return 0;if(i===Il.mapValue)return 1;if(o===Il.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){const f=zC(c[h],d[h]);if(f!==0)return f;const m=rc(l[c[h]],u[d[h]]);if(m!==0)return m}return $t(c.length,d.length)}(t.mapValue,e.mapValue);default:throw bt(23264,{Pe:n})}}function NM(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return $t(t,e);const n=Oa(t),r=Oa(e),s=$t(n.seconds,r.seconds);return s!==0?s:$t(n.nanos,r.nanos)}function PM(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=rc(n[s],r[s]);if(i)return i}return $t(n.length,r.length)}function Vh(t){return YC(t)}function YC(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Oa(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return $a(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ut.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=YC(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${YC(n.fields[o])}`;return s+"}"}(t.mapValue):bt(61005,{value:t})}function Bx(t){switch(nc(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ib(t);return e?16+Bx(e):16;case 5:return 2*t.stringValue.length;case 6:return $a(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Bx(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Cc(r.fields,(i,o)=>{s+=i.length+Bx(o)}),s}(t.mapValue);default:throw bt(13486,{value:t})}}function Fp(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function JC(t){return!!t&&"integerValue"in t}function Op(t){return!!t&&"arrayValue"in t}function AM(t){return!!t&&"nullValue"in t}function kM(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function zx(t){return!!t&&"mapValue"in t}function ob(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[GN])===null||n===void 0?void 0:n.stringValue)===WN}function zm(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Cc(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=zm(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=zm(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Jz(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Yz}const Xz={mapValue:{fields:{[GN]:{stringValue:WN},[$h]:{arrayValue:{}}}}};function oxe(t){return"nullValue"in t?Ux:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Fp(ku.empty(),ut.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?ob(t)?Xz:{mapValue:{}}:bt(35942,{value:t})}function axe(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Fp(ku.empty(),ut.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?Xz:"mapValue"in t?ob(t)?{mapValue:{}}:Il:bt(61959,{value:t})}function RM(t,e){const n=rc(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function jM(t,e){const n=rc(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e){this.value=e}static empty(){return new Cs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!zx(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=zm(n)}setAll(e){let n=ar.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=zm(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());zx(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return sa(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];zx(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Cc(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Cs(zm(this.value))}}function Qz(t){const e=[];return Cc(t.fields,(n,r)=>{const s=new ar([n]);if(zx(r)){const i=Qz(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new ri(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new gr(e,0,kt.min(),kt.min(),kt.min(),Cs.empty(),0)}static newFoundDocument(e,n,r,s){return new gr(e,1,n,kt.min(),r,s,0)}static newNoDocument(e,n){return new gr(e,2,n,kt.min(),kt.min(),Cs.empty(),0)}static newUnknownDocument(e,n){return new gr(e,3,n,kt.min(),kt.min(),Cs.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(kt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Cs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Cs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=kt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof gr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new gr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,n){this.position=e,this.inclusive=n}}function DM(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ut.comparator(ut.fromName(o.referenceValue),n.key):r=rc(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function MM(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!sa(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e,n="asc"){this.field=e,this.dir=n}}function lxe(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zz{}class fn extends Zz{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new cxe(e,n,r):n==="array-contains"?new hxe(e,r):n==="in"?new i9(e,r):n==="not-in"?new fxe(e,r):n==="array-contains-any"?new mxe(e,r):new fn(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new uxe(e,r):new dxe(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(rc(n,this.value)):n!==null&&nc(this.value)===nc(n)&&this.matchesComparison(rc(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return bt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class An extends Zz{constructor(e,n){super(),this.filters=e,this.op=n,this.Te=null}static create(e,n){return new An(e,n)}matches(e){return Bh(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function Bh(t){return t.op==="and"}function XC(t){return t.op==="or"}function HN(t){return e9(t)&&Bh(t)}function e9(t){for(const e of t.filters)if(e instanceof An)return!1;return!0}function QC(t){if(t instanceof fn)return t.field.canonicalString()+t.op.toString()+Vh(t.value);if(HN(t))return t.filters.map(e=>QC(e)).join(",");{const e=t.filters.map(n=>QC(n)).join(",");return`${t.op}(${e})`}}function t9(t,e){return t instanceof fn?function(r,s){return s instanceof fn&&r.op===s.op&&r.field.isEqual(s.field)&&sa(r.value,s.value)}(t,e):t instanceof An?function(r,s){return s instanceof An&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&t9(o,s.filters[l]),!0):!1}(t,e):void bt(19439)}function n9(t,e){const n=t.filters.concat(e);return An.create(n,t.op)}function r9(t){return t instanceof fn?function(n){return`${n.field.canonicalString()} ${n.op} ${Vh(n.value)}`}(t):t instanceof An?function(n){return n.op.toString()+" {"+n.getFilters().map(r9).join(" ,")+"}"}(t):"Filter"}class cxe extends fn{constructor(e,n,r){super(e,n,r),this.key=ut.fromName(r.referenceValue)}matches(e){const n=ut.comparator(e.key,this.key);return this.matchesComparison(n)}}class uxe extends fn{constructor(e,n){super(e,"in",n),this.keys=s9("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class dxe extends fn{constructor(e,n){super(e,"not-in",n),this.keys=s9("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function s9(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ut.fromName(r.referenceValue))}class hxe extends fn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Op(n)&&Lp(n.arrayValue,this.value)}}class i9 extends fn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Lp(this.value.arrayValue,n)}}class fxe extends fn{constructor(e,n){super(e,"not-in",n)}matches(e){if(Lp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Lp(this.value.arrayValue,n)}}class mxe extends fn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Op(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Lp(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pxe{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Ie=null}}function ZC(t,e=null,n=[],r=[],s=null,i=null,o=null){return new pxe(t,e,n,r,s,i,o)}function Ru(t){const e=Kt(t);if(e.Ie===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>QC(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),tb(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Vh(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Vh(r)).join(",")),e.Ie=n}return e.Ie}function Ng(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!lxe(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!t9(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!MM(t.startAt,e.startAt)&&MM(t.endAt,e.endAt)}function dw(t){return ut.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function hw(t,e){return t.filters.filter(n=>n instanceof fn&&n.field.isEqual(e))}function LM(t,e,n){let r=Ux,s=!0;for(const i of hw(t,e)){let o=Ux,l=!0;switch(i.op){case"<":case"<=":o=oxe(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=Ux}RM({value:r,inclusive:s},{value:o,inclusive:l})<0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];RM({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function FM(t,e,n){let r=Il,s=!0;for(const i of hw(t,e)){let o=Il,l=!0;switch(i.op){case">=":case">":o=axe(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=Il}jM({value:r,inclusive:s},{value:o,inclusive:l})>0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];jM({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function gxe(t,e,n,r,s,i,o,l){return new Pg(t,e,n,r,s,i,o,l)}function Ag(t){return new Pg(t)}function OM(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function o9(t){return t.collectionGroup!==null}function Gm(t){const e=Kt(t);if(e.Ee===null){e.Ee=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ee.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Rn(ar.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ee.push(new uw(i,r))}),n.has(ar.keyField().canonicalString())||e.Ee.push(new uw(ar.keyField(),r))}return e.Ee}function Yi(t){const e=Kt(t);return e.de||(e.de=yxe(e,Gm(t))),e.de}function yxe(t,e){if(t.limitType==="F")return ZC(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new uw(s.field,i)});const n=t.endAt?new Uh(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Uh(t.startAt.position,t.startAt.inclusive):null;return ZC(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function eT(t,e){const n=t.filters.concat([e]);return new Pg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function fw(t,e,n){return new Pg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ab(t,e){return Ng(Yi(t),Yi(e))&&t.limitType===e.limitType}function a9(t){return`${Ru(Yi(t))}|lt:${t.limitType}`}function Td(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>r9(s)).join(", ")}]`),tb(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Vh(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Vh(s)).join(",")),`Target(${r})`}(Yi(t))}; limitType=${t.limitType})`}function kg(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ut.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Gm(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=DM(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,Gm(r),s)||r.endAt&&!function(o,l,c){const u=DM(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,Gm(r),s))}(t,e)}function xxe(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function l9(t){return(e,n)=>{let r=!1;for(const s of Gm(t)){const i=vxe(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function vxe(t,e,n){const r=t.field.isKeyField()?ut.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?rc(c,u):bt(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return bt(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Cc(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return zz(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wxe=new tr(ut.comparator);function Ti(){return wxe}const c9=new tr(ut.comparator);function hm(...t){let e=c9;for(const n of t)e=e.insert(n.key,n);return e}function u9(t){let e=c9;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function zo(){return Wm()}function d9(){return Wm()}function Wm(){return new Ka(t=>t.toString(),(t,e)=>t.isEqual(e))}const bxe=new tr(ut.comparator),_xe=new Rn(ut.comparator);function sn(...t){let e=_xe;for(const n of t)e=e.add(n);return e}const Sxe=new Rn($t);function Exe(){return Sxe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qN(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:kp(e)?"-0":e}}function h9(t){return{integerValue:""+t}}function Cxe(t,e){return kye(e)?h9(e):qN(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{constructor(){this._=void 0}}function Txe(t,e,n){return t instanceof $p?function(s,i){const o={fields:{[Hz]:{stringValue:Wz},[Kz]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&zN(i)&&(i=ib(i)),i&&(o.fields[qz]=i),{mapValue:o}}(n,e):t instanceof zh?m9(t,e):t instanceof Gh?p9(t,e):function(s,i){const o=f9(s,i),l=$M(o)+$M(s.Re);return JC(o)&&JC(s.Re)?h9(l):qN(s.serializer,l)}(t,e)}function Ixe(t,e,n){return t instanceof zh?m9(t,e):t instanceof Gh?p9(t,e):n}function f9(t,e){return t instanceof Vp?function(r){return JC(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class $p extends lb{}class zh extends lb{constructor(e){super(),this.elements=e}}function m9(t,e){const n=g9(e);for(const r of t.elements)n.some(s=>sa(s,r))||n.push(r);return{arrayValue:{values:n}}}class Gh extends lb{constructor(e){super(),this.elements=e}}function p9(t,e){let n=g9(e);for(const r of t.elements)n=n.filter(s=>!sa(s,r));return{arrayValue:{values:n}}}class Vp extends lb{constructor(e,n){super(),this.serializer=e,this.Re=n}}function $M(t){return Qn(t.integerValue||t.doubleValue)}function g9(t){return Op(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nxe{constructor(e,n){this.field=e,this.transform=n}}function Pxe(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof zh&&s instanceof zh||r instanceof Gh&&s instanceof Gh?Dh(r.elements,s.elements,sa):r instanceof Vp&&s instanceof Vp?sa(r.Re,s.Re):r instanceof $p&&s instanceof $p}(t.transform,e.transform)}class Axe{constructor(e,n){this.version=e,this.transformResults=n}}class Bs{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Bs}static exists(e){return new Bs(void 0,e)}static updateTime(e){return new Bs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Gx(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class cb{}function y9(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ub(t.key,Bs.none()):new df(t.key,t.data,Bs.none());{const n=t.data,r=Cs.empty();let s=new Rn(ar.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Ya(t.key,r,new ri(s.toArray()),Bs.none())}}function kxe(t,e,n){t instanceof df?function(s,i,o){const l=s.value.clone(),c=UM(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Ya?function(s,i,o){if(!Gx(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=UM(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(x9(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Hm(t,e,n,r){return t instanceof df?function(i,o,l,c){if(!Gx(i.precondition,o))return l;const u=i.value.clone(),d=BM(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ya?function(i,o,l,c){if(!Gx(i.precondition,o))return l;const u=BM(i.fieldTransforms,c,o),d=o.data;return d.setAll(x9(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,o,l){return Gx(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function Rxe(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=f9(r.transform,s||null);i!=null&&(n===null&&(n=Cs.empty()),n.set(r.field,i))}return n||null}function VM(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Dh(r,s,(i,o)=>Pxe(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class df extends cb{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ya extends cb{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function x9(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function UM(t,e,n){const r=new Map;Tt(t.length===n.length,32656,{Ve:n.length,me:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,Ixe(o,l,n[s]))}return r}function BM(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,Txe(i,o,e))}return r}class ub extends cb{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class v9 extends cb{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&kxe(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Hm(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Hm(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=d9();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=y9(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(kt.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),sn())}isEqual(e){return this.batchId===e.batchId&&Dh(this.mutations,e.mutations,(n,r)=>VM(n,r))&&Dh(this.baseMutations,e.baseMutations,(n,r)=>VM(n,r))}}class YN{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Tt(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let s=function(){return bxe}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new YN(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jxe{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nr,yn;function Dxe(t){switch(t){case Pe.OK:return bt(64938);case Pe.CANCELLED:case Pe.UNKNOWN:case Pe.DEADLINE_EXCEEDED:case Pe.RESOURCE_EXHAUSTED:case Pe.INTERNAL:case Pe.UNAVAILABLE:case Pe.UNAUTHENTICATED:return!1;case Pe.INVALID_ARGUMENT:case Pe.NOT_FOUND:case Pe.ALREADY_EXISTS:case Pe.PERMISSION_DENIED:case Pe.FAILED_PRECONDITION:case Pe.ABORTED:case Pe.OUT_OF_RANGE:case Pe.UNIMPLEMENTED:case Pe.DATA_LOSS:return!0;default:return bt(15467,{code:t})}}function w9(t){if(t===void 0)return Vs("GRPC error has no .code"),Pe.UNKNOWN;switch(t){case Nr.OK:return Pe.OK;case Nr.CANCELLED:return Pe.CANCELLED;case Nr.UNKNOWN:return Pe.UNKNOWN;case Nr.DEADLINE_EXCEEDED:return Pe.DEADLINE_EXCEEDED;case Nr.RESOURCE_EXHAUSTED:return Pe.RESOURCE_EXHAUSTED;case Nr.INTERNAL:return Pe.INTERNAL;case Nr.UNAVAILABLE:return Pe.UNAVAILABLE;case Nr.UNAUTHENTICATED:return Pe.UNAUTHENTICATED;case Nr.INVALID_ARGUMENT:return Pe.INVALID_ARGUMENT;case Nr.NOT_FOUND:return Pe.NOT_FOUND;case Nr.ALREADY_EXISTS:return Pe.ALREADY_EXISTS;case Nr.PERMISSION_DENIED:return Pe.PERMISSION_DENIED;case Nr.FAILED_PRECONDITION:return Pe.FAILED_PRECONDITION;case Nr.ABORTED:return Pe.ABORTED;case Nr.OUT_OF_RANGE:return Pe.OUT_OF_RANGE;case Nr.UNIMPLEMENTED:return Pe.UNIMPLEMENTED;case Nr.DATA_LOSS:return Pe.DATA_LOSS;default:return bt(39323,{code:t})}}(yn=Nr||(Nr={}))[yn.OK=0]="OK",yn[yn.CANCELLED=1]="CANCELLED",yn[yn.UNKNOWN=2]="UNKNOWN",yn[yn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yn[yn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yn[yn.NOT_FOUND=5]="NOT_FOUND",yn[yn.ALREADY_EXISTS=6]="ALREADY_EXISTS",yn[yn.PERMISSION_DENIED=7]="PERMISSION_DENIED",yn[yn.UNAUTHENTICATED=16]="UNAUTHENTICATED",yn[yn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yn[yn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yn[yn.ABORTED=10]="ABORTED",yn[yn.OUT_OF_RANGE=11]="OUT_OF_RANGE",yn[yn.UNIMPLEMENTED=12]="UNIMPLEMENTED",yn[yn.INTERNAL=13]="INTERNAL",yn[yn.UNAVAILABLE=14]="UNAVAILABLE",yn[yn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mxe=new Bl([4294967295,4294967295],0);function zM(t){const e=Tz().encode(t),n=new xz;return n.update(e),new Uint8Array(n.digest())}function GM(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Bl([n,r],0),new Bl([s,i],0)]}class XN{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new fm(`Invalid padding: ${n}`);if(r<0)throw new fm(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new fm(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new fm(`Invalid padding when bitmap length is 0: ${n}`);this.pe=8*e.length-n,this.ye=Bl.fromNumber(this.pe)}we(e,n,r){let s=e.add(n.multiply(Bl.fromNumber(r)));return s.compare(Mxe)===1&&(s=new Bl([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}Se(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const n=zM(e),[r,s]=GM(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);if(!this.Se(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new XN(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.pe===0)return;const n=zM(e),[r,s]=GM(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class fm extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Rg.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new db(kt.min(),s,new tr($t),Ti(),sn())}}class Rg{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Rg(r,n,sn(),sn(),sn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e,n,r,s){this.De=e,this.removedTargetIds=n,this.key=r,this.ve=s}}class b9{constructor(e,n){this.targetId=e,this.Ce=n}}class _9{constructor(e,n,r=Dr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class WM{constructor(){this.Fe=0,this.Me=HM(),this.xe=Dr.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=sn(),n=sn(),r=sn();return this.Me.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:bt(38017,{changeType:i})}}),new Rg(this.xe,this.Oe,e,n,r)}Qe(){this.Ne=!1,this.Me=HM()}$e(e,n){this.Ne=!0,this.Me=this.Me.insert(e,n)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Tt(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class Lxe{constructor(e){this.ze=e,this.je=new Map,this.He=Ti(),this.Je=zy(),this.Ye=zy(),this.Ze=new tr($t)}Xe(e){for(const n of e.De)e.ve&&e.ve.isFoundDocument()?this.et(n,e.ve):this.tt(n,e.key,e.ve);for(const n of e.removedTargetIds)this.tt(n,e.key,e.ve)}nt(e){this.forEachTarget(e,n=>{const r=this.rt(n);switch(e.state){case 0:this.it(n)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(n);break;case 3:this.it(n)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(n)&&(this.st(n),r.ke(e.resumeToken));break;default:bt(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.je.forEach((r,s)=>{this.it(s)&&n(s)})}ot(e){const n=e.targetId,r=e.Ce.count,s=this._t(n);if(s){const i=s.target;if(dw(i))if(r===0){const o=new ut(i.path);this.tt(n,o,gr.newNoDocument(o,kt.min()))}else Tt(r===1,20013,{expectedCount:r});else{const o=this.ut(n);if(o!==r){const l=this.ct(e),c=l?this.lt(l,e,o):1;if(c!==0){this.st(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,u)}}}}}ct(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=$a(r).toUint8Array()}catch(c){if(c instanceof Gz)return Au("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new XN(o,s,i)}catch(c){return Au(c instanceof fm?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.pe===0?null:l}lt(e,n,r){return n.Ce.count===r-this.Tt(e,n.targetId)?0:2}Tt(e,n){const r=this.ze.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.ze.Pt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.tt(n,i,null),s++)}),s}It(e){const n=new Map;this.je.forEach((i,o)=>{const l=this._t(o);if(l){if(i.current&&dw(l.target)){const c=new ut(l.target.path);this.Et(c).has(o)||this.dt(o,c)||this.tt(o,c,gr.newNoDocument(c,e))}i.Le&&(n.set(o,i.qe()),i.Qe())}});let r=sn();this.Ye.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this._t(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.He.forEach((i,o)=>o.setReadTime(e));const s=new db(e,n,this.Ze,this.He,r);return this.He=Ti(),this.Je=zy(),this.Ye=zy(),this.Ze=new tr($t),s}et(e,n){if(!this.it(e))return;const r=this.dt(e,n.key)?2:0;this.rt(e).$e(n.key,r),this.He=this.He.insert(n.key,n),this.Je=this.Je.insert(n.key,this.Et(n.key).add(e)),this.Ye=this.Ye.insert(n.key,this.At(n.key).add(e))}tt(e,n,r){if(!this.it(e))return;const s=this.rt(e);this.dt(e,n)?s.$e(n,1):s.Ue(n),this.Ye=this.Ye.insert(n,this.At(n).delete(e)),this.Ye=this.Ye.insert(n,this.At(n).add(e)),r&&(this.He=this.He.insert(n,r))}removeTarget(e){this.je.delete(e)}ut(e){const n=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let n=this.je.get(e);return n||(n=new WM,this.je.set(e,n)),n}At(e){let n=this.Ye.get(e);return n||(n=new Rn($t),this.Ye=this.Ye.insert(e,n)),n}Et(e){let n=this.Je.get(e);return n||(n=new Rn($t),this.Je=this.Je.insert(e,n)),n}it(e){const n=this._t(e)!==null;return n||Ge("WatchChangeAggregator","Detected inactive target",e),n}_t(e){const n=this.je.get(e);return n&&n.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new WM),this.ze.getRemoteKeysForTarget(e).forEach(n=>{this.tt(e,n,null)})}dt(e,n){return this.ze.getRemoteKeysForTarget(e).has(n)}}function zy(){return new tr(ut.comparator)}function HM(){return new tr(ut.comparator)}const Fxe=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Oxe=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),$xe=(()=>({and:"AND",or:"OR"}))();class Vxe{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function tT(t,e){return t.useProto3Json||tb(e)?e:{value:e}}function Wh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function S9(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Uxe(t,e){return Wh(t,e.toTimestamp())}function Gs(t){return Tt(!!t,49232),kt.fromTimestamp(function(n){const r=Oa(n);return new cr(r.seconds,r.nanos)}(t))}function QN(t,e){return nT(t,e).canonicalString()}function nT(t,e){const n=function(s){return new In(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function E9(t){const e=In.fromString(t);return Tt(j9(e),10190,{key:e.toString()}),e}function mw(t,e){return QN(t.databaseId,e.path)}function fu(t,e){const n=E9(e);if(n.get(1)!==t.databaseId.projectId)throw new lt(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new lt(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ut(I9(n))}function C9(t,e){return QN(t.databaseId,e)}function T9(t){const e=E9(t);return e.length===4?In.emptyPath():I9(e)}function rT(t){return new In(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function I9(t){return Tt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function qM(t,e,n){return{name:mw(t,e),fields:n.value.mapValue.fields}}function Bxe(t,e,n){const r=fu(t,e.name),s=Gs(e.updateTime),i=e.createTime?Gs(e.createTime):kt.min(),o=new Cs({mapValue:{fields:e.fields}}),l=gr.newFoundDocument(r,s,i,o);return n&&l.setHasCommittedMutations(),n?l.setHasCommittedMutations():l}function zxe(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:bt(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Tt(d===void 0||typeof d=="string",58123),Dr.fromBase64String(d||"")):(Tt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Dr.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?Pe.UNKNOWN:w9(u.code);return new lt(d,u.message||"")}(o);n=new _9(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=fu(t,r.document.name),i=Gs(r.document.updateTime),o=r.document.createTime?Gs(r.document.createTime):kt.min(),l=new Cs({mapValue:{fields:r.document.fields}}),c=gr.newFoundDocument(s,i,o,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Wx(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=fu(t,r.document),i=r.readTime?Gs(r.readTime):kt.min(),o=gr.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Wx([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=fu(t,r.document),i=r.removedTargetIds||[];n=new Wx([],i,s,null)}else{if(!("filter"in e))return bt(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new jxe(s,i),l=r.targetId;n=new b9(l,o)}}return n}function pw(t,e){let n;if(e instanceof df)n={update:qM(t,e.key,e.value)};else if(e instanceof ub)n={delete:mw(t,e.key)};else if(e instanceof Ya)n={update:qM(t,e.key,e.data),updateMask:Yxe(e.fieldMask)};else{if(!(e instanceof v9))return bt(16599,{ft:e.type});n={verify:mw(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof $p)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof zh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Gh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Vp)return{fieldPath:o.field.canonicalString(),increment:l.Re};throw bt(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Uxe(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:bt(27497)}(t,e.precondition)),n}function sT(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Bs.updateTime(Gs(i.updateTime)):i.exists!==void 0?Bs.exists(i.exists):Bs.none()}(e.currentDocument):Bs.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,l){let c=null;if("setToServerValue"in l)Tt(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),c=new $p;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new zh(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new Gh(d)}else"increment"in l?c=new Vp(o,l.increment):bt(16584,{proto:l});const u=ar.fromServerFormat(l.fieldPath);return new Nxe(u,c)}(t,s)):[];if(e.update){e.update.name;const s=fu(t,e.update.name),i=new Cs({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new ri(u.map(d=>ar.fromServerFormat(d)))}(e.updateMask);return new Ya(s,i,o,n,r)}return new df(s,i,n,r)}if(e.delete){const s=fu(t,e.delete);return new ub(s,n)}if(e.verify){const s=fu(t,e.verify);return new v9(s,n)}return bt(1463,{proto:e})}function Gxe(t,e){return t&&t.length>0?(Tt(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Gs(s.updateTime):Gs(i);return o.isEqual(kt.min())&&(o=Gs(i)),new Axe(o,s.transformResults||[])}(n,e))):[]}function N9(t,e){return{documents:[C9(t,e.path)]}}function P9(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=C9(t,s);const i=function(u){if(u.length!==0)return R9(An.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(f){return{field:Id(f.field),direction:Hxe(f.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=tT(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{gt:n,parent:s}}function A9(t){let e=T9(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Tt(r===1,65062);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(h){const f=k9(h);return f instanceof An&&HN(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(g){return new uw(Nd(g.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(f))}(n.orderBy));let l=null;n.limit&&(l=function(h){let f;return f=typeof h=="object"?h.value:h,tb(f)?null:f}(n.limit));let c=null;n.startAt&&(c=function(h){const f=!!h.before,m=h.values||[];return new Uh(m,f)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const f=!h.before,m=h.values||[];return new Uh(m,f)}(n.endAt)),gxe(e,s,o,i,l,"F",c,u)}function Wxe(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return bt(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function k9(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Nd(n.unaryFilter.field);return fn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Nd(n.unaryFilter.field);return fn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Nd(n.unaryFilter.field);return fn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Nd(n.unaryFilter.field);return fn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return bt(61313);default:return bt(60726)}}(t):t.fieldFilter!==void 0?function(n){return fn.create(Nd(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return bt(58110);default:return bt(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return An.create(n.compositeFilter.filters.map(r=>k9(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return bt(1026)}}(n.compositeFilter.op))}(t):bt(30097,{filter:t})}function Hxe(t){return Fxe[t]}function qxe(t){return Oxe[t]}function Kxe(t){return $xe[t]}function Id(t){return{fieldPath:t.canonicalString()}}function Nd(t){return ar.fromServerFormat(t.fieldPath)}function R9(t){return t instanceof fn?function(n){if(n.op==="=="){if(kM(n.value))return{unaryFilter:{field:Id(n.field),op:"IS_NAN"}};if(AM(n.value))return{unaryFilter:{field:Id(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(kM(n.value))return{unaryFilter:{field:Id(n.field),op:"IS_NOT_NAN"}};if(AM(n.value))return{unaryFilter:{field:Id(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Id(n.field),op:qxe(n.op),value:n.value}}}(t):t instanceof An?function(n){const r=n.getFilters().map(s=>R9(s));return r.length===1?r[0]:{compositeFilter:{op:Kxe(n.op),filters:r}}}(t):bt(54877,{filter:t})}function Yxe(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function j9(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e,n,r,s,i=kt.min(),o=kt.min(),l=Dr.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new _a(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new _a(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D9{constructor(e){this.wt=e}}function Jxe(t,e){let n;if(e.document)n=Bxe(t.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ut.fromSegments(e.noDocument.path),s=Du(e.noDocument.readTime);n=gr.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return bt(56709);{const r=ut.fromSegments(e.unknownDocument.path),s=Du(e.unknownDocument.version);n=gr.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new cr(s[0],s[1]);return kt.fromTimestamp(i)}(e.readTime)),n}function KM(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:gw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:mw(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Wh(i,o.version.toTimestamp()),createTime:Wh(i,o.createTime.toTimestamp())}}(t.wt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ju(e.version)};else{if(!e.isUnknownDocument())return bt(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:ju(e.version)}}return r}function gw(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ju(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Du(t){const e=new cr(t.seconds,t.nanoseconds);return kt.fromTimestamp(e)}function qc(t,e){const n=(e.baseMutations||[]).map(i=>sT(t.wt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>sT(t.wt,i)),s=cr.fromMillis(e.localWriteTimeMs);return new KN(e.batchId,s,n,r)}function mm(t){const e=Du(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Du(t.lastLimboFreeSnapshotVersion):kt.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return Tt(o===1,1966,{count:o}),Yi(Ag(T9(i.documents[0])))}(t.query):function(i){return Yi(A9(i))}(t.query),new _a(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Dr.fromBase64String(t.resumeToken))}function M9(t,e){const n=ju(e.snapshotVersion),r=ju(e.lastLimboFreeSnapshotVersion);let s;s=dw(e.target)?N9(t.wt,e.target):P9(t.wt,e.target).gt;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ru(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function L9(t){const e=A9({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?fw(e,e.limit,"L"):e}function fS(t,e){return new JN(e.largestBatchId,sT(t.wt,e.overlayMutation))}function YM(t,e){const n=e.path.lastSegment();return[t,Ts(e.path.popLast()),n]}function JM(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:ju(r.readTime),documentKey:Ts(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xxe{getBundleMetadata(e,n){return XM(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Du(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return XM(e).put(function(s){return{bundleId:s.id,createTime:ju(Gs(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return QM(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:L9(i.bundledQuery),readTime:Du(i.readTime)}}(r)})}saveNamedQuery(e,n){return QM(e).put(function(s){return{name:s.name,readTime:ju(Gs(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function XM(t){return Ur(t,nb)}function QM(t){return Ur(t,rb)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(e,n){this.serializer=e,this.userId=n}static St(e,n){const r=n.uid||"";return new hb(e,r)}getOverlay(e,n){return Vf(e).get(YM(this.userId,n)).next(r=>r?fS(this.serializer,r):null)}getOverlays(e,n){const r=zo();return le.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const l=new JN(n,o);s.push(this.bt(e,l))}),le.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Ts(o.getCollectionPath())));const i=[];return s.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Vf(e).X(qC,l))}),le.waitFor(i)}getOverlaysForCollection(e,n,r){const s=zo(),i=Ts(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Vf(e).J(qC,o).next(l=>{for(const c of l){const u=fS(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=zo();let o;const l=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Vf(e).te({index:Oz,range:l},(c,u,d)=>{const h=fS(this.serializer,u);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>i)}bt(e,n){return Vf(e).put(function(s,i,o){const[l,c,u]=YM(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:pw(s.wt,o.mutation)}}(this.serializer,this.userId,n))}}function Vf(t){return Ur(t,sb)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qxe{Dt(e){return Ur(e,UN)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Dr.fromUint8Array(r):Dr.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Dt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(){}vt(e,n){this.Ct(e,n),n.Ft()}Ct(e,n){if("nullValue"in e)this.Mt(n,5);else if("booleanValue"in e)this.Mt(n,10),n.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(n,15),n.xt(Qn(e.integerValue));else if("doubleValue"in e){const r=Qn(e.doubleValue);isNaN(r)?this.Mt(n,13):(this.Mt(n,15),kp(r)?n.xt(0):n.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(n,20),typeof r=="string"&&(r=Oa(r)),n.Ot(`${r.seconds||""}`),n.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,n),this.Bt(n);else if("bytesValue"in e)this.Mt(n,30),n.Lt($a(e.bytesValue)),this.Bt(n);else if("referenceValue"in e)this.kt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Mt(n,45),n.xt(r.latitude||0),n.xt(r.longitude||0)}else"mapValue"in e?Jz(e)?this.Mt(n,Number.MAX_SAFE_INTEGER):ob(e)?this.qt(e.mapValue,n):(this.Qt(e.mapValue,n),this.Bt(n)):"arrayValue"in e?(this.$t(e.arrayValue,n),this.Bt(n)):bt(19022,{Ut:e})}Nt(e,n){this.Mt(n,25),this.Kt(e,n)}Kt(e,n){n.Ot(e)}Qt(e,n){const r=e.fields||{};this.Mt(n,55);for(const s of Object.keys(r))this.Nt(s,n),this.Ct(r[s],n)}qt(e,n){var r,s;const i=e.fields||{};this.Mt(n,53);const o=$h,l=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Mt(n,15),n.xt(Qn(l)),this.Nt(o,n),this.Ct(i[o],n)}$t(e,n){const r=e.values||[];this.Mt(n,50);for(const s of r)this.Ct(s,n)}kt(e,n){this.Mt(n,37),ut.fromName(e).path.forEach(r=>{this.Mt(n,60),this.Kt(r,n)})}Mt(e,n){e.xt(n)}Bt(e){e.xt(2)}}Kc.Wt=new Kc;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pd=255;function Zxe(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function ZM(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=Zxe(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class eve{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.zt(r.value),r=n.next();this.jt()}Ht(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Yt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{const s=n.codePointAt(0);this.zt(240|s>>>18),this.zt(128|63&s>>>12),this.zt(128|63&s>>>6),this.zt(128|63&s)}}this.jt()}Xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Yt()}en(e){const n=this.tn(e),r=ZM(n);this.nn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}rn(e){const n=this.tn(e),r=ZM(n);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}sn(){this._n(pd),this._n(255)}an(){this.un(pd),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}zt(e){const n=255&e;n===0?(this._n(0),this._n(255)):n===pd?(this._n(pd),this._n(0)):this._n(n)}Jt(e){const n=255&e;n===0?(this.un(0),this.un(255)):n===pd?(this.un(pd),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class tve{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class nve{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class Uf{constructor(){this.ln=new eve,this.hn=new tve(this.ln),this.Pn=new nve(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(e,n,r,s){this.In=e,this.En=n,this.dn=r,this.An=s}Rn(){const e=this.An.length,n=e===0||this.An[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.An,0),n!==e?r.set([0],this.An.length):++r[r.length-1],new Yc(this.In,this.En,this.dn,r)}Vn(e,n,r){return{indexId:this.In,uid:e,arrayValue:Hx(this.dn),directionalValue:Hx(this.An),orderedDocumentKey:Hx(n),documentKey:r.path.toArray()}}mn(e,n,r){const s=this.Vn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function il(t,e){let n=t.In-e.In;return n!==0?n:(n=e4(t.dn,e.dn),n!==0?n:(n=e4(t.An,e.An),n!==0?n:ut.comparator(t.En,e.En)))}function e4(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Hx(t){return RB()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function t4(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class n4{constructor(e){this.fn=new Rn((n,r)=>ar.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const n of e.filters){const r=n;r.isInequality()?this.fn=this.fn.add(r):this.pn.push(r)}}get yn(){return this.fn.size>1}wn(e){if(Tt(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const n=GC(e);if(n!==void 0&&!this.Sn(n))return!1;const r=Oc(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.Sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.fn.size>0){const l=this.fn.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=r[i];if(!this.bn(l,c)||!this.Dn(this.gn[o++],c))return!1}++i}for(;i<r.length;++i){const l=r[i];if(o>=this.gn.length||!this.Dn(this.gn[o++],l))return!1}return!0}vn(){if(this.yn)return null;let e=new Rn(ar.comparator);const n=[];for(const r of this.pn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Ox(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Ox(r.field,0))}for(const r of this.gn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Ox(r.field,r.dir==="asc"?0:1)));return new iw(iw.UNKNOWN_ID,this.collectionId,n,Ap.empty())}Sn(e){for(const n of this.pn)if(this.bn(n,e))return!0;return!1}bn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}Dn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F9(t){var e,n;if(Tt(t instanceof fn||t instanceof An,20012),t instanceof fn){if(t instanceof i9){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>fn.create(t.field,"==",i)))||[];return An.create(s,"or")}return t}const r=t.filters.map(s=>F9(s));return An.create(r,t.op)}function rve(t){if(t.getFilters().length===0)return[];const e=aT(F9(t));return Tt(O9(e),7391),iT(e)||oT(e)?[e]:e.getFilters()}function iT(t){return t instanceof fn}function oT(t){return t instanceof An&&HN(t)}function O9(t){return iT(t)||oT(t)||function(n){if(n instanceof An&&XC(n)){for(const r of n.getFilters())if(!iT(r)&&!oT(r))return!1;return!0}return!1}(t)}function aT(t){if(Tt(t instanceof fn||t instanceof An,34018),t instanceof fn)return t;if(t.filters.length===1)return aT(t.filters[0]);const e=t.filters.map(r=>aT(r));let n=An.create(e,t.op);return n=yw(n),O9(n)?n:(Tt(n instanceof An,64498),Tt(Bh(n),40251),Tt(n.filters.length>1,57927),n.filters.reduce((r,s)=>ZN(r,s)))}function ZN(t,e){let n;return Tt(t instanceof fn||t instanceof An,38388),Tt(e instanceof fn||e instanceof An,25473),n=t instanceof fn?e instanceof fn?function(s,i){return An.create([s,i],"and")}(t,e):r4(t,e):e instanceof fn?r4(e,t):function(s,i){if(Tt(s.filters.length>0&&i.filters.length>0,48005),Bh(s)&&Bh(i))return n9(s,i.getFilters());const o=XC(s)?s:i,l=XC(s)?i:s,c=o.filters.map(u=>ZN(u,l));return An.create(c,"or")}(t,e),yw(n)}function r4(t,e){if(Bh(e))return n9(e,t.getFilters());{const n=e.filters.map(r=>ZN(t,r));return An.create(n,"or")}}function yw(t){if(Tt(t instanceof fn||t instanceof An,11850),t instanceof fn)return t;const e=t.getFilters();if(e.length===1)return yw(e[0]);if(e9(t))return t;const n=e.map(s=>yw(s)),r=[];return n.forEach(s=>{s instanceof fn?r.push(s):s instanceof An&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:An.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sve{constructor(){this.Cn=new eP}addToCollectionParentIndex(e,n){return this.Cn.add(n),le.resolve()}getCollectionParents(e,n){return le.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return le.resolve()}deleteFieldIndex(e,n){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,n){return le.resolve()}getDocumentsMatchingTarget(e,n){return le.resolve(null)}getIndexType(e,n){return le.resolve(0)}getFieldIndexes(e,n){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,n){return le.resolve(ji.min())}getMinOffsetFromCollectionGroup(e,n){return le.resolve(ji.min())}updateCollectionGroup(e,n,r){return le.resolve()}updateIndexEntries(e,n){return le.resolve()}}class eP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Rn(In.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Rn(In.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4="IndexedDbIndexManager",Gy=new Uint8Array(0);class ive{constructor(e,n){this.databaseId=n,this.Fn=new eP,this.Mn=new Ka(r=>Ru(r),(r,s)=>Ng(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Fn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.Fn.add(n)});const i={collectionId:r,parent:Ts(s)};return i4(e).put(i)}return le.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[Nz(n),""],!1,!0);return i4(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Bo(o.parent))}return r})}addFieldIndex(e,n){const r=Bf(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=yd(e);return i.next(l=>{o.put(JM(l,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Bf(e),s=yd(e),i=gd(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Bf(e),r=gd(e),s=yd(e);return n.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,n){return le.forEach(this.xn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new n4(r).vn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=gd(e);let s=!0;const i=new Map;return le.forEach(this.xn(n),o=>this.On(e,o).next(l=>{s&&(s=!!l),i.set(o,l)})).next(()=>{if(s){let o=sn();const l=[];return le.forEach(i,(c,u)=>{Ge(s4,`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(I=>`${I.fieldPath}:${I.kind}`).join(",")}`}(c)} to execute ${Ru(n)}`);const d=function(S,I){const D=GC(I);if(D===void 0)return null;for(const k of hw(S,D.fieldPath))switch(k.op){case"array-contains-any":return k.value.arrayValue.values||[];case"array-contains":return[k.value]}return null}(u,c),h=function(S,I){const D=new Map;for(const k of Oc(I))for(const C of hw(S,k.fieldPath))switch(C.op){case"==":case"in":D.set(k.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return D.set(k.fieldPath.canonicalString(),C.value),Array.from(D.values())}return null}(u,c),f=function(S,I){const D=[];let k=!0;for(const C of Oc(I)){const T=C.kind===0?LM(S,C.fieldPath,S.startAt):FM(S,C.fieldPath,S.startAt);D.push(T.value),k&&(k=T.inclusive)}return new Uh(D,k)}(u,c),m=function(S,I){const D=[];let k=!0;for(const C of Oc(I)){const T=C.kind===0?FM(S,C.fieldPath,S.endAt):LM(S,C.fieldPath,S.endAt);D.push(T.value),k&&(k=T.inclusive)}return new Uh(D,k)}(u,c),g=this.Nn(c,u,f),x=this.Nn(c,u,m),E=this.Bn(c,u,h),v=this.Ln(c.indexId,d,g,f.inclusive,x,m.inclusive,E);return le.forEach(v,b=>r.Z(b,n.limit).next(S=>{S.forEach(I=>{const D=ut.fromSegments(I.documentKey);o.has(D)||(o=o.add(D),l.push(D))})}))}).next(()=>l)}return le.resolve(null)})}xn(e){let n=this.Mn.get(e);return n||(e.filters.length===0?n=[e]:n=rve(An.create(e.filters,"and")).map(r=>ZC(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,n),n)}Ln(e,n,r,s,i,o,l){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),u=c/(n!=null?n.length:1),d=[];for(let h=0;h<c;++h){const f=n?this.kn(n[h/u]):Gy,m=this.qn(e,f,r[h%u],s),g=this.Qn(e,f,i[h%u],o),x=l.map(E=>this.qn(e,f,E,!0));d.push(...this.createRange(m,g,x))}return d}qn(e,n,r,s){const i=new Yc(e,ut.empty(),n,r);return s?i:i.Rn()}Qn(e,n,r,s){const i=new Yc(e,ut.empty(),n,r);return s?i.Rn():i}On(e,n){const r=new n4(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const l of i)r.wn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,n){let r=2;const s=this.xn(n);return le.forEach(s,i=>this.On(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new Rn(ar.comparator),d=!1;for(const h of c.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?d=!0:u=u.add(f.field));for(const h of c.orderBy)h.field.isKeyField()||(u=u.add(h.field));return u.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}$n(e,n){const r=new Uf;for(const s of Oc(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Tn(s.kind);Kc.Wt.vt(i,o)}return r.cn()}kn(e){const n=new Uf;return Kc.Wt.vt(e,n.Tn(0)),n.cn()}Un(e,n){const r=new Uf;return Kc.Wt.vt(Fp(this.databaseId,n),r.Tn(function(i){const o=Oc(i);return o.length===0?0:o[o.length-1].kind}(e))),r.cn()}Bn(e,n,r){if(r===null)return[];let s=[];s.push(new Uf);let i=0;for(const o of Oc(e)){const l=r[i++];for(const c of s)if(this.Kn(n,o.fieldPath)&&Op(l))s=this.Wn(s,o,l);else{const u=c.Tn(o.kind);Kc.Wt.vt(l,u)}}return this.Gn(s)}Nn(e,n,r){return this.Bn(e,n,r.position)}Gn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].cn();return n}Wn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const l of s){const c=new Uf;c.seed(l.cn()),Kc.Wt.vt(o,c.Tn(n.kind)),i.push(c)}return i}Kn(e,n){return!!e.filters.find(r=>r instanceof fn&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Bf(e),s=yd(e);return(n?r.J(HC,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return le.forEach(i,l=>s.get([l.indexId,this.uid]).next(c=>{o.push(function(d,h){const f=h?new Ap(h.sequenceNumber,new ji(Du(h.readTime),new ut(Bo(h.documentKey)),h.largestBatchId)):Ap.empty(),m=d.fields.map(([g,x])=>new Ox(ar.fromServerFormat(g),x));return new iw(d.indexId,d.collectionGroup,m,f)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:$t(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Bf(e),i=yd(e);return this.zn(e).next(o=>s.J(HC,IDBKeyRange.bound(n,n)).next(l=>le.forEach(l,c=>i.put(JM(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return le.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?le.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(r.set(s.collectionGroup,l),le.forEach(l,c=>this.jn(e,s,c).next(u=>{const d=this.Hn(i,c);return u.isEqual(d)?le.resolve():this.Jn(e,i,c,u,d)}))))})}Yn(e,n,r,s){return gd(e).put(s.Vn(this.uid,this.Un(r,n.key),n.key))}Zn(e,n,r,s){return gd(e).delete(s.mn(this.uid,this.Un(r,n.key),n.key))}jn(e,n,r){const s=gd(e);let i=new Rn(il);return s.te({index:Fz,range:IDBKeyRange.only([r.indexId,this.uid,Hx(this.Un(r,n))])},(o,l)=>{i=i.add(new Yc(r.indexId,n,t4(l.arrayValue),t4(l.directionalValue)))}).next(()=>i)}Hn(e,n){let r=new Rn(il);const s=this.$n(n,e);if(s==null)return r;const i=GC(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Op(o))for(const l of o.arrayValue.values||[])r=r.add(new Yc(n.indexId,e.key,this.kn(l),s))}else r=r.add(new Yc(n.indexId,e.key,Gy,s));return r}Jn(e,n,r,s,i){Ge(s4,"Updating index entries for document '%s'",n.key);const o=[];return function(c,u,d,h,f){const m=c.getIterator(),g=u.getIterator();let x=md(m),E=md(g);for(;x||E;){let v=!1,b=!1;if(x&&E){const S=d(x,E);S<0?b=!0:S>0&&(v=!0)}else x!=null?b=!0:v=!0;v?(h(E),E=md(g)):b?(f(x),x=md(m)):(x=md(m),E=md(g))}}(s,i,il,l=>{o.push(this.Yn(e,n,r,l))},l=>{o.push(this.Zn(e,n,r,l))}),le.waitFor(o)}zn(e){let n=1;return yd(e).te({index:Lz,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,l)=>il(o,l)).filter((o,l,c)=>!l||il(o,c[l-1])!==0);const s=[];s.push(e);for(const o of r){const l=il(o,e),c=il(o,n);if(l===0)s[0]=e.Rn();else if(l>0&&c<0)s.push(o),s.push(o.Rn());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Xn(s[o],s[o+1]))return[];const l=s[o].mn(this.uid,Gy,ut.empty()),c=s[o+1].mn(this.uid,Gy,ut.empty());i.push(IDBKeyRange.bound(l,c))}return i}Xn(e,n){return il(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(o4)}getMinOffset(e,n){return le.mapArray(this.xn(n),r=>this.On(e,r).next(s=>s||bt(44426))).next(o4)}}function i4(t){return Ur(t,Dp)}function gd(t){return Ur(t,Bm)}function Bf(t){return Ur(t,VN)}function yd(t){return Ur(t,Um)}function o4(t){Tt(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;FN(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new ji(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a4={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$9=41943040;class _s{static withCacheSize(e){return new _s(e,_s.DEFAULT_COLLECTION_PERCENTILE,_s.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V9(t,e,n){const r=t.store(mo),s=t.store(Mh),i=[],o=IDBKeyRange.only(n.batchId);let l=0;const c=r.te({range:o},(d,h,f)=>(l++,f.delete()));i.push(c.next(()=>{Tt(l===1,47070,{batchId:n.batchId})}));const u=[];for(const d of n.mutations){const h=jz(e,d.key.path,n.batchId);i.push(s.delete(h)),u.push(d.key)}return le.waitFor(i).next(()=>u)}function xw(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw bt(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_s.DEFAULT_COLLECTION_PERCENTILE=10,_s.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_s.DEFAULT=new _s($9,_s.DEFAULT_COLLECTION_PERCENTILE,_s.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_s.DISABLED=new _s(-1,0,0);class fb{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.er={}}static St(e,n,r,s){Tt(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new fb(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ol(e).te({index:iu,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Pd(e),o=ol(e);return o.add({}).next(l=>{Tt(typeof l=="number",49019);const c=new KN(l,n,r,s),u=function(m,g,x){const E=x.baseMutations.map(b=>pw(m.wt,b)),v=x.mutations.map(b=>pw(m.wt,b));return{userId:g,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:E,mutations:v}}(this.serializer,this.userId,c),d=[];let h=new Rn((f,m)=>$t(f.canonicalString(),m.canonicalString()));for(const f of s){const m=jz(this.userId,f.key.path,l);h=h.add(f.key.path.popLast()),d.push(o.put(u)),d.push(i.put(m,Dye))}return h.forEach(f=>{d.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.er[l]=c.keys()}),le.waitFor(d).next(()=>c)})}lookupMutationBatch(e,n){return ol(e).get(n).next(r=>r?(Tt(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),qc(this.serializer,r)):null)}tr(e,n){return this.er[n]?le.resolve(this.er[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.er[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return ol(e).te({index:iu,range:s},(o,l,c)=>{l.userId===this.userId&&(Tt(l.batchId>=r,47524,{nr:r}),i=qc(this.serializer,l)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=du;return ol(e).te({index:iu,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,du],[this.userId,Number.POSITIVE_INFINITY]);return ol(e).J(iu,n).next(r=>r.map(s=>qc(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=$x(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Pd(e).te({range:s},(o,l,c)=>{const[u,d,h]=o,f=Bo(d);if(u===this.userId&&n.path.isEqual(f))return ol(e).get(h).next(m=>{if(!m)throw bt(61480,{rr:o,batchId:h});Tt(m.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:m.userId,batchId:h}),i.push(qc(this.serializer,m))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Rn($t);const s=[];return n.forEach(i=>{const o=$x(this.userId,i.path),l=IDBKeyRange.lowerBound(o),c=Pd(e).te({range:l},(u,d,h)=>{const[f,m,g]=u,x=Bo(m);f===this.userId&&i.path.isEqual(x)?r=r.add(g):h.done()});s.push(c)}),le.waitFor(s).next(()=>this.ir(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=$x(this.userId,r),o=IDBKeyRange.lowerBound(i);let l=new Rn($t);return Pd(e).te({range:o},(c,u,d)=>{const[h,f,m]=c,g=Bo(f);h===this.userId&&r.isPrefixOf(g)?g.length===s&&(l=l.add(m)):d.done()}).next(()=>this.ir(e,l))}ir(e,n){const r=[],s=[];return n.forEach(i=>{s.push(ol(e).get(i).next(o=>{if(o===null)throw bt(35274,{batchId:i});Tt(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(qc(this.serializer,o))}))}),le.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return V9(e.he,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.sr(n.batchId)}),le.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return le.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Pd(e).te({range:r},(i,o,l)=>{if(i[0]===this.userId){const c=Bo(i[1]);s.push(c)}else l.done()}).next(()=>{Tt(s.length===0,56720,{_r:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return U9(e,this.userId,n)}ar(e){return B9(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:du,lastStreamToken:""})}}function U9(t,e,n){const r=$x(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Pd(t).te({range:i,ee:!0},(l,c,u)=>{const[d,h,f]=l;d===e&&h===s&&(o=!0),u.done()}).next(()=>o)}function ol(t){return Ur(t,mo)}function Pd(t){return Ur(t,Mh)}function B9(t){return Ur(t,Rp)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Mu(0)}static lr(){return new Mu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ove{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.hr(e).next(n=>{const r=new Mu(n.highestTargetId);return n.highestTargetId=r.next(),this.Pr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(n=>kt.fromTimestamp(new cr(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.hr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Pr(e,s)))}addTargetData(e,n){return this.Tr(e,n).next(()=>this.hr(e).next(r=>(r.targetCount+=1,this.Ir(n,r),this.Pr(e,r))))}updateTargetData(e,n){return this.Tr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>xd(e).delete(n.targetId)).next(()=>this.hr(e)).next(r=>(Tt(r.targetCount>0,8065),r.targetCount-=1,this.Pr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return xd(e).te((o,l)=>{const c=mm(l);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>le.waitFor(i)).next(()=>s)}forEachTarget(e,n){return xd(e).te((r,s)=>{const i=mm(s);n(i)})}hr(e){return l4(e).get(lw).next(n=>(Tt(n!==null,2888),n))}Pr(e,n){return l4(e).put(lw,n)}Tr(e,n){return xd(e).put(M9(this.serializer,n))}Ir(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.hr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Ru(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return xd(e).te({range:s,index:Mz},(o,l,c)=>{const u=mm(l);Ng(n,u.target)&&(i=u,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=_l(e);return n.forEach(o=>{const l=Ts(o.path);s.push(i.put({targetId:r,path:l})),s.push(this.referenceDelegate.addReference(e,r,o))}),le.waitFor(s)}removeMatchingKeys(e,n,r){const s=_l(e);return le.forEach(n,i=>{const o=Ts(i.path);return le.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=_l(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=_l(e);let i=sn();return s.te({range:r,ee:!0},(o,l,c)=>{const u=Bo(o[1]),d=new ut(u);i=i.add(d)}).next(()=>i)}containsKey(e,n){const r=Ts(n.path),s=IDBKeyRange.bound([r],[Nz(r)],!1,!0);let i=0;return _l(e).te({index:$N,ee:!0,range:s},([o,l],c,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}Rt(e,n){return xd(e).get(n).next(r=>r?mm(r):null)}}function xd(t){return Ur(t,Lh)}function l4(t){return Ur(t,hu)}function _l(t){return Ur(t,Fh)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4="LruGarbageCollector",ave=1048576;function u4([t,e],[n,r]){const s=$t(t,n);return s===0?$t(e,r):s}class lve{constructor(e){this.Er=e,this.buffer=new Rn(u4),this.dr=0}Ar(){return++this.dr}Rr(e){const n=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();u4(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class z9{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Ge(c4,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ec(n)?Ge(c4,"Ignoring IndexedDB error during garbage collection: ",n):await qu(n)}await this.mr(3e5)})}}class cve{constructor(e,n){this.gr=e,this.params=n}calculateTargetCount(e,n){return this.gr.pr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return le.resolve(Hi.le);const r=new lve(n);return this.gr.forEachTarget(e,s=>r.Rr(s.sequenceNumber)).next(()=>this.gr.yr(e,s=>r.Rr(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.gr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.gr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ge("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(a4)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Ge("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),a4):this.wr(e,n))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,n){let r,s,i,o,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Ge("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,l=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),Cd()<=hn.DEBUG&&Ge("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function G9(t,e){return new cve(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uve{constructor(e,n){this.db=e,this.garbageCollector=G9(this,n)}pr(e){const n=this.Sr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Sr(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}yr(e,n){return this.br(e,(r,s)=>n(s))}addReference(e,n,r){return Wy(e,r)}removeReference(e,n,r){return Wy(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Wy(e,n)}Dr(e,n){return function(s,i){let o=!1;return B9(s).ne(l=>U9(s,l,i).next(c=>(c&&(o=!0),le.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.br(e,(o,l)=>{if(l<=n){const c=this.Dr(e,o).next(u=>{if(!u)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,kt.min()),_l(e).delete(function(h){return[0,Ts(h.path)]}(o))))});s.push(c)}}).next(()=>le.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Wy(e,n)}br(e,n){const r=_l(e);let s,i=Hi.le;return r.te({index:$N},([o,l],{path:c,sequenceNumber:u})=>{o===0?(i!==Hi.le&&n(new ut(Bo(s)),i),i=u,s=c):i=Hi.le}).next(()=>{i!==Hi.le&&n(new ut(Bo(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Wy(t,e){return _l(t).put(function(r,s){return{targetId:0,path:Ts(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W9{constructor(){this.changes=new Ka(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,gr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?le.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dve{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return kc(e).put(r)}removeEntry(e,n,r){return kc(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],gw(o),l[l.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.vr(e,r)))}getEntry(e,n){let r=gr.newInvalidDocument(n);return kc(e).te({index:Vx,range:IDBKeyRange.only(zf(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}Fr(e,n){let r={size:0,document:gr.newInvalidDocument(n)};return kc(e).te({index:Vx,range:IDBKeyRange.only(zf(n))},(s,i)=>{r={document:this.Cr(n,i),size:xw(i)}}).next(()=>r)}getEntries(e,n){let r=Ti();return this.Mr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Or(e,n){let r=Ti(),s=new tr(ut.comparator);return this.Mr(e,n,(i,o)=>{const l=this.Cr(i,o);r=r.insert(i,l),s=s.insert(i,xw(o))}).next(()=>({documents:r,Nr:s}))}Mr(e,n,r){if(n.isEmpty())return le.resolve();let s=new Rn(f4);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(zf(s.first()),zf(s.last())),o=s.getIterator();let l=o.getNext();return kc(e).te({index:Vx,range:i},(c,u,d)=>{const h=ut.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&f4(l,h)<0;)r(l,null),l=o.getNext();l&&l.isEqual(h)&&(r(l,u),l=o.hasNext()?o.getNext():null),l?d.H(zf(l)):d.done()}).next(()=>{for(;l;)r(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,l=[o.popLast().toArray(),o.lastSegment(),gw(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return kc(e).J(IDBKeyRange.bound(l,c,!0)).next(u=>{i==null||i.incrementDocumentReadCount(u.length);let d=Ti();for(const h of u){const f=this.Cr(ut.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(kg(n,f)||s.has(f.key))&&(d=d.insert(f.key,f))}return d})}getAllFromCollectionGroup(e,n,r,s){let i=Ti();const o=h4(n,r),l=h4(n,ji.max());return kc(e).te({index:Dz,range:IDBKeyRange.bound(o,l,!0)},(c,u,d)=>{const h=this.Cr(ut.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(h.key,h),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new hve(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return d4(e).get(WC).next(n=>(Tt(!!n,20021),n))}vr(e,n){return d4(e).put(WC,n)}Cr(e,n){if(n){const r=Jxe(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(kt.min())))return r}return gr.newInvalidDocument(e)}}function H9(t){return new dve(t)}class hve extends W9{constructor(e,n){super(),this.Br=e,this.trackRemovals=n,this.Lr=new Ka(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Rn((i,o)=>$t(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.Lr.get(i);if(n.push(this.Br.removeEntry(e,i,l.readTime)),o.isValidDocument()){const c=KM(this.Br.serializer,o);s=s.add(i.path.popLast());const u=xw(c);r+=u-l.size,n.push(this.Br.addEntry(e,i,c))}else if(r-=l.size,this.trackRemovals){const c=KM(this.Br.serializer,o.convertToNoDocument(kt.min()));n.push(this.Br.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.Br.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Br.updateMetadata(e,r)),le.waitFor(n)}getFromCache(e,n){return this.Br.Fr(e,n).next(r=>(this.Lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Br.Or(e,n).next(({documents:r,Nr:s})=>(s.forEach((i,o)=>{this.Lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function d4(t){return Ur(t,jp)}function kc(t){return Ur(t,aw)}function zf(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function h4(t,e){const n=e.documentKey.path.toArray();return[t,gw(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function f4(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=$t(n[i],r[i]),s)return s;return s=$t(n.length,r.length),s||(s=$t(n[n.length-2],r[r.length-2]),s||$t(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fve{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q9{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Hm(r.mutation,s,ri.empty(),cr.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,sn()).next(()=>r))}getLocalViewOfDocuments(e,n,r=sn()){const s=zo();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=hm();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=zo();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,sn()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Ti();const o=Wm(),l=function(){return Wm()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof Ya)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Hm(d.mutation,u,d.mutation.getFieldMask(),cr.now())):o.set(u.key,ri.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var h;return l.set(u,new fve(d,(h=o.get(u))!==null&&h!==void 0?h:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Wm();let s=new tr((o,l)=>o-l),i=sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||ri.empty();d=l.applyToLocalView(u,d),r.set(c,d);const h=(s.get(l.batchId)||sn()).add(c);s=s.insert(l.batchId,h)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,h=d9();d.forEach(f=>{if(!i.has(f)){const m=y9(n.get(f),r.get(f));m!==null&&h.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return le.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ut.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):o9(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):le.resolve(zo());let l=Pp,c=i;return o.next(u=>le.forEach(u,(d,h)=>(l<h.largestBatchId&&(l=h.largestBatchId),i.get(d)?le.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{c=c.insert(d,f)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,sn())).next(d=>({batchId:l,changes:u9(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ut(n)).next(r=>{let s=hm();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=hm();return this.indexManager.getCollectionParents(e,i).next(l=>le.forEach(l,c=>{const u=function(h,f){return new Pg(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,gr.newInvalidDocument(d)))});let l=hm();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&Hm(d.mutation,u,ri.empty(),cr.now()),kg(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mve{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,n){return le.resolve(this.kr.get(n))}saveBundleMetadata(e,n){return this.kr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Gs(s.createTime)}}(n)),le.resolve()}getNamedQuery(e,n){return le.resolve(this.qr.get(n))}saveNamedQuery(e,n){return this.qr.set(n.name,function(s){return{name:s.name,query:L9(s.bundledQuery),readTime:Gs(s.readTime)}}(n)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pve{constructor(){this.overlays=new tr(ut.comparator),this.Qr=new Map}getOverlay(e,n){return le.resolve(this.overlays.get(n))}getOverlays(e,n){const r=zo();return le.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.bt(e,n,i)}),le.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Qr.delete(r)),le.resolve()}getOverlaysForCollection(e,n,r){const s=zo(),i=n.length+1,o=new ut(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return le.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new tr((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=zo(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=zo(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return le.resolve(l)}bt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Qr.get(s.largestBatchId).delete(r.key);this.Qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new JN(n,r));let i=this.Qr.get(n);i===void 0&&(i=sn(),this.Qr.set(n,i)),this.Qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gve{constructor(){this.sessionToken=Dr.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(){this.$r=new Rn(Wr.Ur),this.Kr=new Rn(Wr.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,n){const r=new Wr(e,n);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.zr(new Wr(e,n))}jr(e,n){e.forEach(r=>this.removeReference(r,n))}Hr(e){const n=new ut(new In([])),r=new Wr(n,e),s=new Wr(n,e+1),i=[];return this.Kr.forEachInRange([r,s],o=>{this.zr(o),i.push(o.key)}),i}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const n=new ut(new In([])),r=new Wr(n,e),s=new Wr(n,e+1);let i=sn();return this.Kr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Wr(e,0),r=this.$r.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Wr{constructor(e,n){this.key=e,this.Zr=n}static Ur(e,n){return ut.comparator(e.key,n.key)||$t(e.Zr,n.Zr)}static Wr(e,n){return $t(e.Zr,n.Zr)||ut.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yve{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.nr=1,this.Xr=new Rn(Wr.Ur)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new KN(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Xr=this.Xr.add(new Wr(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return le.resolve(o)}lookupMutationBatch(e,n){return le.resolve(this.ei(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ti(r),i=s<0?0:s;return le.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?du:this.nr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Wr(n,0),s=new Wr(n,Number.POSITIVE_INFINITY),i=[];return this.Xr.forEachInRange([r,s],o=>{const l=this.ei(o.Zr);i.push(l)}),le.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Rn($t);return n.forEach(s=>{const i=new Wr(s,0),o=new Wr(s,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([i,o],l=>{r=r.add(l.Zr)})}),le.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ut.isDocumentKey(i)||(i=i.child(""));const o=new Wr(new ut(i),0);let l=new Rn($t);return this.Xr.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.Zr)),!0)},o),le.resolve(this.ni(l))}ni(e){const n=[];return e.forEach(r=>{const s=this.ei(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Tt(this.ri(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return le.forEach(n.mutations,s=>{const i=new Wr(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,n){const r=new Wr(n,0),s=this.Xr.firstAfterOrEqual(r);return le.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ri(e,n){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const n=this.ti(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xve{constructor(e){this.ii=e,this.docs=function(){return new tr(ut.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ii(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return le.resolve(r?r.document.mutableCopy():gr.newInvalidDocument(n))}getEntries(e,n){let r=Ti();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():gr.newInvalidDocument(s))}),le.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Ti();const o=n.path,l=new ut(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||FN(Pz(d),r)<=0||(s.has(d.key)||kg(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return le.resolve(i)}getAllFromCollectionGroup(e,n,r,s){bt(9500)}si(e,n){return le.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new vve(this)}getSize(e){return le.resolve(this.size)}}class vve extends W9{constructor(e){super(),this.Br=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Br.addEntry(e,s)):this.Br.removeEntry(r)}),le.waitFor(n)}getFromCache(e,n){return this.Br.getEntry(e,n)}getAllFromCache(e,n){return this.Br.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wve{constructor(e){this.persistence=e,this.oi=new Ka(n=>Ru(n),Ng),this.lastRemoteSnapshotVersion=kt.min(),this.highestTargetId=0,this._i=0,this.ai=new tP,this.targetCount=0,this.ui=Mu.cr()}forEachTarget(e,n){return this.oi.forEach((r,s)=>n(s)),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this._i&&(this._i=n),le.resolve()}Tr(e){this.oi.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ui=new Mu(n),this.highestTargetId=n),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,n){return this.Tr(n),this.targetCount+=1,le.resolve()}updateTargetData(e,n){return this.Tr(n),le.resolve()}removeTargetData(e,n){return this.oi.delete(n.target),this.ai.Hr(n.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.oi.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.oi.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),le.waitFor(i).next(()=>s)}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,n){const r=this.oi.get(n)||null;return le.resolve(r)}addMatchingKeys(e,n,r){return this.ai.Gr(n,r),le.resolve()}removeMatchingKeys(e,n,r){this.ai.jr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),le.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.ai.Hr(n),le.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ai.Yr(n);return le.resolve(r)}containsKey(e,n){return le.resolve(this.ai.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e,n){this.ci={},this.overlays={},this.li=new Hi(0),this.hi=!1,this.hi=!0,this.Pi=new gve,this.referenceDelegate=e(this),this.Ti=new wve(this),this.indexManager=new sve,this.remoteDocumentCache=function(s){return new xve(s)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new D9(n),this.Ei=new mve(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new pve,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ci[e.toKey()];return r||(r=new yve(n,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,n,r){Ge("MemoryPersistence","Starting transaction:",e);const s=new bve(this.li.next());return this.referenceDelegate.di(),r(s).next(i=>this.referenceDelegate.Ai(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ri(e,n){return le.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,n)))}}class bve extends kz{constructor(e){super(),this.currentSequenceNumber=e}}class mb{constructor(e){this.persistence=e,this.Vi=new tP,this.mi=null}static fi(e){return new mb(e)}get gi(){if(this.mi)return this.mi;throw bt(60996)}addReference(e,n,r){return this.Vi.addReference(r,n),this.gi.delete(r.toString()),le.resolve()}removeReference(e,n,r){return this.Vi.removeReference(r,n),this.gi.add(r.toString()),le.resolve()}markPotentiallyOrphaned(e,n){return this.gi.add(n.toString()),le.resolve()}removeTarget(e,n){this.Vi.Hr(n.targetId).forEach(s=>this.gi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.gi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}di(){this.mi=new Set}Ai(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.gi,r=>{const s=ut.fromPath(r);return this.pi(e,s).next(i=>{i||n.removeEntry(s,kt.min())})}).next(()=>(this.mi=null,n.apply(e)))}updateLimboDocument(e,n){return this.pi(e,n).next(r=>{r?this.gi.delete(n.toString()):this.gi.add(n.toString())})}Ii(e){return 0}pi(e,n){return le.or([()=>le.resolve(this.Vi.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ri(e,n)])}}class vw{constructor(e,n){this.persistence=e,this.yi=new Ka(r=>Ts(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=G9(this,n)}static fi(e,n){return new vw(e,n)}di(){}Ai(e){return le.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}pr(e){const n=this.Sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Sr(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}yr(e,n){return le.forEach(this.yi,(r,s)=>this.Dr(e,r,s).next(i=>i?le.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.si(e,o=>this.Dr(e,o,n).next(l=>{l||(r++,i.removeEntry(o,kt.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.yi.set(n,e.currentSequenceNumber),le.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),le.resolve()}removeReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,n){return this.yi.set(n,e.currentSequenceNumber),le.resolve()}Ii(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Bx(e.data.value)),n}Dr(e,n,r){return le.or([()=>this.persistence.Ri(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.yi.get(n);return le.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _ve{constructor(e){this.serializer=e}q(e,n,r,s){const i=new eb("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore(Ig)}(e),function(c){c.createObjectStore(Rp,{keyPath:jye}),c.createObjectStore(mo,{keyPath:EM,autoIncrement:!0}).createIndex(iu,CM,{unique:!0}),c.createObjectStore(Mh)}(e),m4(e),function(c){c.createObjectStore($c)}(e));let o=le.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore(Fh),c.deleteObjectStore(Lh),c.deleteObjectStore(hu)}(e),m4(e)),o=o.next(()=>function(c){const u=c.store(hu),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:kt.min().toTimestamp(),targetCount:0};return u.put(lw,d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store(mo).J().next(h=>{c.deleteObjectStore(mo),c.createObjectStore(mo,{keyPath:EM,autoIncrement:!0}).createIndex(iu,CM,{unique:!0});const f=u.store(mo),m=h.map(g=>f.put(g));return le.waitFor(m)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore(Oh,{keyPath:Bye})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.wi(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore(jp)}(e),this.Si(i)))),r<7&&s>=7&&(o=o.next(()=>this.bi(i))),r<8&&s>=8&&(o=o.next(()=>this.Di(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Ci(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(nb,{keyPath:zye})})(e),function(c){c.createObjectStore(rb,{keyPath:Gye})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore(sb,{keyPath:Xye});u.createIndex(qC,Qye,{unique:!1}),u.createIndex(Oz,Zye,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore(aw,{keyPath:Mye});u.createIndex(Vx,Lye),u.createIndex(Dz,Fye)}(e)).next(()=>this.Fi(e,i)).next(()=>e.deleteObjectStore($c))),r<14&&s>=14&&(o=o.next(()=>this.Mi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore(VN,{keyPath:Wye,autoIncrement:!0}).createIndex(HC,Hye,{unique:!1}),c.createObjectStore(Um,{keyPath:qye}).createIndex(Lz,Kye,{unique:!1}),c.createObjectStore(Bm,{keyPath:Yye}).createIndex(Fz,Jye,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(Um).clear()}).next(()=>{n.objectStore(Bm).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(UN,{keyPath:exe})})(e)})),r<18&&s>=18&&RB()&&(o=o.next(()=>{n.objectStore(Um).clear()}).next(()=>{n.objectStore(Bm).clear()})),o}Si(e){let n=0;return e.store($c).te((r,s)=>{n+=xw(s)}).next(()=>{const r={byteSize:n};return e.store(jp).put(WC,r)})}wi(e){const n=e.store(Rp),r=e.store(mo);return n.J().next(s=>le.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,du],[i.userId,i.lastAcknowledgedBatchId]);return r.J(iu,o).next(l=>le.forEach(l,c=>{Tt(c.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const u=qc(this.serializer,c);return V9(e,i.userId,u).next(()=>{})}))}))}bi(e){const n=e.store(Fh),r=e.store($c);return e.store(hu).get(lw).next(s=>{const i=[];return r.te((o,l)=>{const c=new In(o),u=function(h){return[0,Ts(h)]}(c);i.push(n.get(u).next(d=>d?le.resolve():(h=>n.put({targetId:0,path:Ts(h),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>le.waitFor(i))})}Di(e,n){e.createObjectStore(Dp,{keyPath:Uye});const r=n.store(Dp),s=new eP,i=o=>{if(s.add(o)){const l=o.lastSegment(),c=o.popLast();return r.put({collectionId:l,parent:Ts(c)})}};return n.store($c).te({ee:!0},(o,l)=>{const c=new In(o);return i(c.popLast())}).next(()=>n.store(Mh).te({ee:!0},([o,l,c],u)=>{const d=Bo(l);return i(d.popLast())}))}Ci(e){const n=e.store(Lh);return n.te((r,s)=>{const i=mm(s),o=M9(this.serializer,i);return n.put(o)})}Fi(e,n){const r=n.store($c),s=[];return r.te((i,o)=>{const l=n.store(aw),c=function(h){return h.document?new ut(In.fromString(h.document.name).popFirst(5)):h.noDocument?ut.fromSegments(h.noDocument.path):h.unknownDocument?ut.fromSegments(h.unknownDocument.path):bt(36783)}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(l.put(u))}).next(()=>le.waitFor(s))}Mi(e,n){const r=n.store(mo),s=H9(this.serializer),i=new nP(mb.fi,this.serializer.wt);return r.J().next(o=>{const l=new Map;return o.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:sn();qc(this.serializer,c).keys().forEach(h=>d=d.add(h)),l.set(c.userId,d)}),le.forEach(l,(c,u)=>{const d=new rs(u),h=hb.St(this.serializer,d),f=i.getIndexManager(d),m=fb.St(d,this.serializer,f,i.referenceDelegate);return new q9(s,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new KC(n,Hi.le),c).next()})})}}function m4(t){t.createObjectStore(Fh,{keyPath:$ye}).createIndex($N,Vye,{unique:!0}),t.createObjectStore(Lh,{keyPath:"targetId"}).createIndex(Mz,Oye,{unique:!0}),t.createObjectStore(hu)}const al="IndexedDbPersistence",mS=18e5,pS=5e3,gS="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Sve="main";class rP{constructor(e,n,r,s,i,o,l,c,u,d,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.xi=i,this.window=o,this.document=l,this.Oi=u,this.Ni=d,this.Bi=h,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=f=>Promise.resolve(),!rP.C())throw new lt(Pe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new uve(this,s),this.Ui=n+Sve,this.serializer=new D9(c),this.Ki=new zl(this.Ui,this.Bi,new _ve(this.serializer)),this.Pi=new Qxe,this.Ti=new ove(this.referenceDelegate,this.serializer),this.remoteDocumentCache=H9(this.serializer),this.Ei=new Xxe,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,d===!1&&Vs(al,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new lt(Pe.FAILED_PRECONDITION,gS);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new Hi(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Hy(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(n=>{n||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(n=>this.isPrimary&&!n?this.Xi(e).next(()=>!1):!!n&&this.es(e).next(()=>!0))).catch(e=>{if(Ec(e))return Ge(al,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ge(al,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return Gf(e).get(fd).next(n=>le.resolve(this.ts(n)))}ns(e){return Hy(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,mS)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Ur(n,Oh);return r.J().next(s=>{const i=this._s(s,mS),o=s.filter(l=>i.indexOf(l)===-1);return le.forEach(o,l=>r.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Wi)for(const n of e)this.Wi.removeItem(this.us(n.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?le.resolve(!0):Gf(e).get(fd).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,pS)&&!this.cs(n.ownerId)){if(this.ts(n)&&this.networkEnabled)return!0;if(!this.ts(n)){if(!n.allowTabSynchronization)throw new lt(Pe.FAILED_PRECONDITION,gS);return!1}}return!(!this.networkEnabled||!this.inForeground)||Hy(e).J().next(r=>this._s(r,pS).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&Ge(al,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[Ig,Oh],e=>{const n=new KC(e,Hi.le);return this.Xi(n).next(()=>this.ns(n))}),this.Ki.close(),this.Ts()}_s(e,n){return e.filter(r=>this.ss(r.updateTimeMs,n)&&!this.cs(r.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>Hy(e).J().next(n=>this._s(n,mS).map(r=>r.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,n){return fb.St(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new ive(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return hb.St(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,n,r){Ge(al,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===18?rxe:c===17?Bz:c===16?nxe:c===15?BN:c===14?Uz:c===13?Vz:c===12?txe:c===11?$z:void bt(60245)}(this.Bi);let o;return this.Ki.runTransaction(e,s,i,l=>(o=new KC(l,this.li?this.li.next():Hi.le),n==="readwrite-primary"?this.Yi(o).next(c=>!!c||this.Zi(o)).next(c=>{if(!c)throw Vs(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new lt(Pe.FAILED_PRECONDITION,Az);return r(o)}).next(c=>this.es(o).next(()=>c)):this.Es(o).next(()=>r(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Es(e){return Gf(e).get(fd).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,pS)&&!this.cs(n.ownerId)&&!this.ts(n)&&!(this.Ni||this.allowTabSynchronization&&n.allowTabSynchronization))throw new lt(Pe.FAILED_PRECONDITION,gS)})}es(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Gf(e).put(fd,n)}static C(){return zl.C()}Xi(e){const n=Gf(e);return n.get(fd).next(r=>this.ts(r)?(Ge(al,"Releasing primary lease."),n.delete(fd)):le.resolve())}ss(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Vs(`Detected an update time that is in the future: ${e} > ${r}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const n=/(?:Version|Mobile)\/1[456]/;kB()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var n;try{const r=((n=this.Wi)===null||n===void 0?void 0:n.getItem(this.us(e)))!==null;return Ge(al,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Vs(al,"Failed to get zombied client id.",r),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){Vs("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Gf(t){return Ur(t,Ig)}function Hy(t){return Ur(t,Oh)}function Eve(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.ds=r,this.As=s}static Rs(e,n){let r=sn(),s=sn();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new sP(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cve{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K9{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return kB()?8:Rz($r())>0?6:4}()}initialize(e,n){this.ys=e,this.indexManager=n,this.Vs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ws(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Ss(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new Cve;return this.bs(e,n,o).next(l=>{if(i.result=l,this.fs)return this.Ds(e,n,o,l.size)})}).next(()=>i.result)}Ds(e,n,r,s){return r.documentReadCount<this.gs?(Cd()<=hn.DEBUG&&Ge("QueryEngine","SDK will not create cache indexes for query:",Td(n),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),le.resolve()):(Cd()<=hn.DEBUG&&Ge("QueryEngine","Query:",Td(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ps*s?(Cd()<=hn.DEBUG&&Ge("QueryEngine","The SDK decides to create cache indexes for query:",Td(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Yi(n))):le.resolve())}ws(e,n){if(OM(n))return le.resolve(null);let r=Yi(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=fw(n,null,"F"),r=Yi(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=sn(...i);return this.ys.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.vs(n,l);return this.Cs(n,u,o,c.readTime)?this.ws(e,fw(n,null,"F")):this.Fs(e,u,n,c)}))})))}Ss(e,n,r,s){return OM(n)||s.isEqual(kt.min())?le.resolve(null):this.ys.getDocuments(e,r).next(i=>{const o=this.vs(n,i);return this.Cs(n,o,r,s)?le.resolve(null):(Cd()<=hn.DEBUG&&Ge("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Td(n)),this.Fs(e,o,n,Tye(s,Pp)).next(l=>l))})}vs(e,n){let r=new Rn(l9(e));return n.forEach((s,i)=>{kg(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}bs(e,n,r){return Cd()<=hn.DEBUG&&Ge("QueryEngine","Using full collection scan to execute query:",Td(n)),this.ys.getDocumentsMatchingQuery(e,n,ji.min(),r)}Fs(e,n,r,s){return this.ys.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP="LocalStore",Tve=3e8;class Ive{constructor(e,n,r,s){this.persistence=e,this.Ms=n,this.serializer=s,this.xs=new tr($t),this.Os=new Ka(i=>Ru(i),Ng),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new q9(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.xs))}}function Y9(t,e,n,r){return new Ive(t,e,n,r)}async function J9(t,e){const n=Kt(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=sn();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({ks:u,removedBatchIds:o,addedBatchIds:l}))})})}function Nve(t,e){const n=Kt(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Bs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const h=u.batch,f=h.keys();let m=le.resolve();return f.forEach(g=>{m=m.next(()=>d.getEntry(c,g)).next(x=>{const E=u.docVersions.get(g);Tt(E!==null,48541),x.version.compareTo(E)<0&&(h.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),d.addEntry(x)))})}),m.next(()=>l.mutationQueue.removeMutationBatch(c,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=sn();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function X9(t){const e=Kt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ti.getLastRemoteSnapshotVersion(n))}function Pve(t,e){const n=Kt(t),r=e.snapshotVersion;let s=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Bs.newChangeBuffer({trackRemovals:!0});s=n.xs;const l=[];e.targetChanges.forEach((d,h)=>{const f=s.get(h);if(!f)return;l.push(n.Ti.removeMatchingKeys(i,d.removedDocuments,h).next(()=>n.Ti.addMatchingKeys(i,d.addedDocuments,h)));let m=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(Dr.EMPTY_BYTE_STRING,kt.min()).withLastLimboFreeSnapshotVersion(kt.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),s=s.insert(h,m),function(x,E,v){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=Tve?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(f,m,d)&&l.push(n.Ti.updateTargetData(i,m))});let c=Ti(),u=sn();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(Ave(i,o,e.documentUpdates).next(d=>{c=d.qs,u=d.Qs})),!r.isEqual(kt.min())){const d=n.Ti.getLastRemoteSnapshotVersion(i).next(h=>n.Ti.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return le.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.xs=s,i))}function Ave(t,e,n){let r=sn(),s=sn();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Ti();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(kt.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Ge(iP,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{qs:o,Qs:s}})}function kve(t,e){const n=Kt(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=du),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Rve(t,e){const n=Kt(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ti.getTargetData(r,e).next(i=>i?(s=i,le.resolve(s)):n.Ti.allocateTargetId(r).next(o=>(s=new _a(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ti.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.xs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.xs=n.xs.insert(r.targetId,r),n.Os.set(e,r.targetId)),r})}async function lT(t,e,n){const r=Kt(t),s=r.xs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ec(o))throw o;Ge(iP,`Failed to update sequence numbers for target ${e}: ${o}`)}r.xs=r.xs.remove(e),r.Os.delete(s.target)}function p4(t,e,n){const r=Kt(t);let s=kt.min(),i=sn();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const h=Kt(c),f=h.Os.get(d);return f!==void 0?le.resolve(h.xs.get(f)):h.Ti.getTargetData(u,d)}(r,o,Yi(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.Ms.getDocumentsMatchingQuery(o,e,n?s:kt.min(),n?i:sn())).next(l=>(jve(r,xxe(e),l),{documents:l,$s:i})))}function jve(t,e,n){let r=t.Ns.get(e)||kt.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ns.set(e,r)}class g4{constructor(){this.activeTargetIds=Exe()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Q9{constructor(){this.xo=new g4,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,n,r){this.Oo[e]=n}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new g4,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dve{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4="ConnectivityMonitor";class x4{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Ge(y4,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Ge(y4,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qy=null;function cT(){return qy===null?qy=function(){return 268435456+Math.round(2147483648*Math.random())}():qy++,"0x"+qy.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS="RestConnection",Mve={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Lve{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ko=n+"://"+e.host,this.Wo=`projects/${r}/databases/${s}`,this.Go=this.databaseId.database===cw?`project_id=${r}`:`project_id=${r}&database_id=${s}`}zo(e,n,r,s,i){const o=cT(),l=this.jo(e,n.toUriEncodedString());Ge(yS,`Sending RPC '${e}' ${o}:`,l,r);const c={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(c,s,i);const{host:u}=new URL(l),d=wc(u);return this.Jo(e,l,c,r,d).then(h=>(Ge(yS,`Received RPC '${e}' ${o}: `,h),h),h=>{throw Au(yS,`RPC '${e}' ${o} failed with error: `,h,"url: ",l,"request:",r),h})}Yo(e,n,r,s,i,o){return this.zo(e,n,r,s,i)}Ho(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+uf}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}jo(e,n){const r=Mve[e];return`${this.Ko}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fve{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vs="WebChannelConnection";class Ove extends Lve{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=cT();return new Promise((l,c)=>{const u=new vz;u.setWithCredentials(!0),u.listenOnce(wz.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Fx.NO_ERROR:const h=u.getResponseJson();Ge(vs,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),l(h);break;case Fx.TIMEOUT:Ge(vs,`RPC '${e}' ${o} timed out`),c(new lt(Pe.DEADLINE_EXCEEDED,"Request time out"));break;case Fx.HTTP_ERROR:const f=u.getStatus();if(Ge(vs,`RPC '${e}' ${o} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const x=function(v){const b=v.toLowerCase().replace(/_/g,"-");return Object.values(Pe).indexOf(b)>=0?b:Pe.UNKNOWN}(g.status);c(new lt(x,g.message))}else c(new lt(Pe.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new lt(Pe.UNAVAILABLE,"Connection failed."));break;default:bt(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Ge(vs,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);Ge(vs,`RPC '${e}' ${o} sending request:`,s),u.send(n,"POST",d,r,15)})}T_(e,n,r){const s=cT(),i=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Sz(),l=_z(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Ho(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");Ge(vs,`Creating RPC '${e}' stream ${s}: ${d}`,c);const h=o.createWebChannel(d,c);let f=!1,m=!1;const g=new Fve({Zo:E=>{m?Ge(vs,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(f||(Ge(vs,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),Ge(vs,`RPC '${e}' stream ${s} sending:`,E),h.send(E))},Xo:()=>h.close()}),x=(E,v,b)=>{E.listen(v,S=>{try{b(S)}catch(I){setTimeout(()=>{throw I},0)}})};return x(h,dm.EventType.OPEN,()=>{m||(Ge(vs,`RPC '${e}' stream ${s} transport opened.`),g.__())}),x(h,dm.EventType.CLOSE,()=>{m||(m=!0,Ge(vs,`RPC '${e}' stream ${s} transport closed`),g.u_())}),x(h,dm.EventType.ERROR,E=>{m||(m=!0,Au(vs,`RPC '${e}' stream ${s} transport errored. Name:`,E.name,"Message:",E.message),g.u_(new lt(Pe.UNAVAILABLE,"The operation could not be completed")))}),x(h,dm.EventType.MESSAGE,E=>{var v;if(!m){const b=E.data[0];Tt(!!b,16349);const S=b,I=(S==null?void 0:S.error)||((v=S[0])===null||v===void 0?void 0:v.error);if(I){Ge(vs,`RPC '${e}' stream ${s} received error:`,I);const D=I.status;let k=function(P){const A=Nr[P];if(A!==void 0)return w9(A)}(D),C=I.message;k===void 0&&(k=Pe.INTERNAL,C="Unknown error status: "+D+" with message "+I.message),m=!0,g.u_(new lt(k,C)),h.close()}else Ge(vs,`RPC '${e}' stream ${s} received:`,b),g.c_(b)}}),x(l,bz.STAT_EVENT,E=>{E.stat===BC.PROXY?Ge(vs,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===BC.NOPROXY&&Ge(vs,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.a_()},0),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $ve(){return typeof window<"u"?window:null}function qx(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pb(t){return new Vxe(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z9{constructor(e,n,r=1e3,s=1.5,i=6e4){this.xi=e,this.timerId=n,this.I_=r,this.E_=s,this.d_=i,this.A_=0,this.R_=null,this.V_=Date.now(),this.reset()}reset(){this.A_=0}m_(){this.A_=this.d_}f_(e){this.cancel();const n=Math.floor(this.A_+this.g_()),r=Math.max(0,Date.now()-this.V_),s=Math.max(0,n-r);s>0&&Ge("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.A_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.R_=this.xi.enqueueAfterDelay(this.timerId,s,()=>(this.V_=Date.now(),e())),this.A_*=this.E_,this.A_<this.I_&&(this.A_=this.I_),this.A_>this.d_&&(this.A_=this.d_)}p_(){this.R_!==null&&(this.R_.skipDelay(),this.R_=null)}cancel(){this.R_!==null&&(this.R_.cancel(),this.R_=null)}g_(){return(Math.random()-.5)*this.A_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v4="PersistentStream";class e8{constructor(e,n,r,s,i,o,l,c){this.xi=e,this.y_=r,this.w_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.S_=0,this.b_=null,this.D_=null,this.stream=null,this.v_=0,this.C_=new Z9(e,n)}F_(){return this.state===1||this.state===5||this.M_()}M_(){return this.state===2||this.state===3}start(){this.v_=0,this.state!==4?this.auth():this.x_()}async stop(){this.F_()&&await this.close(0)}O_(){this.state=0,this.C_.reset()}N_(){this.M_()&&this.b_===null&&(this.b_=this.xi.enqueueAfterDelay(this.y_,6e4,()=>this.B_()))}L_(e){this.k_(),this.stream.send(e)}async B_(){if(this.M_())return this.close(0)}k_(){this.b_&&(this.b_.cancel(),this.b_=null)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}async close(e,n){this.k_(),this.q_(),this.C_.cancel(),this.S_++,e!==4?this.C_.reset():n&&n.code===Pe.RESOURCE_EXHAUSTED?(Vs(n.toString()),Vs("Using maximum backoff delay to prevent overloading the backend."),this.C_.m_()):n&&n.code===Pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Q_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(n)}Q_(){}auth(){this.state=1;const e=this.U_(this.S_),n=this.S_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.S_===n&&this.K_(r,s)},r=>{e(()=>{const s=new lt(Pe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.W_(s)})})}K_(e,n){const r=this.U_(this.S_);this.stream=this.G_(e,n),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.D_=this.xi.enqueueAfterDelay(this.w_,1e4,()=>(this.M_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(s=>{r(()=>this.W_(s))}),this.stream.onMessage(s=>{r(()=>++this.v_==1?this.z_(s):this.onNext(s))})}x_(){this.state=5,this.C_.f_(async()=>{this.state=0,this.start()})}W_(e){return Ge(v4,`close with error: ${e}`),this.stream=null,this.close(4,e)}U_(e){return n=>{this.xi.enqueueAndForget(()=>this.S_===e?n():(Ge(v4,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Vve extends e8{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}G_(e,n){return this.connection.T_("Listen",e,n)}z_(e){return this.onNext(e)}onNext(e){this.C_.reset();const n=zxe(this.serializer,e),r=function(i){if(!("targetChange"in i))return kt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?kt.min():o.readTime?Gs(o.readTime):kt.min()}(e);return this.listener.j_(n,r)}H_(e){const n={};n.database=rT(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=dw(c)?{documents:N9(i,c)}:{query:P9(i,c).gt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=S9(i,o.resumeToken);const u=tT(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(kt.min())>0){l.readTime=Wh(i,o.snapshotVersion.toTimestamp());const u=tT(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=Wxe(this.serializer,e);r&&(n.labels=r),this.L_(n)}J_(e){const n={};n.database=rT(this.serializer),n.removeTarget=e,this.L_(n)}}class Uve extends e8{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Y_(){return this.v_>0}start(){this.lastStreamToken=void 0,super.start()}Q_(){this.Y_&&this.Z_([])}G_(e,n){return this.connection.T_("Write",e,n)}z_(e){return Tt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Tt(!e.writeResults||e.writeResults.length===0,55816),this.listener.X_()}onNext(e){Tt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.C_.reset();const n=Gxe(e.writeResults,e.commitTime),r=Gs(e.commitTime);return this.listener.ea(r,n)}ta(){const e={};e.database=rT(this.serializer),this.L_(e)}Z_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>pw(this.serializer,r))};this.L_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bve{}class zve extends Bve{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.na=!1}ra(){if(this.na)throw new lt(Pe.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,n,r,s){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.zo(e,nT(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new lt(Pe.UNKNOWN,i.toString())})}Yo(e,n,r,s,i){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Yo(e,nT(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new lt(Pe.UNKNOWN,o.toString())})}terminate(){this.na=!0,this.connection.terminate()}}class Gve{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.ia=0,this.sa=null,this.oa=!0}_a(){this.ia===0&&(this.aa("Unknown"),this.sa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.sa=null,this.ua("Backend didn't respond within 10 seconds."),this.aa("Offline"),Promise.resolve())))}ca(e){this.state==="Online"?this.aa("Unknown"):(this.ia++,this.ia>=1&&(this.la(),this.ua(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.aa("Offline")))}set(e){this.la(),this.ia=0,e==="Online"&&(this.oa=!1),this.aa(e)}aa(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ua(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.oa?(Vs(n),this.oa=!1):Ge("OnlineStateTracker",n)}la(){this.sa!==null&&(this.sa.cancel(),this.sa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lu="RemoteStore";class Wve{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.ha=[],this.Pa=new Map,this.Ta=new Set,this.Ia=[],this.Ea=i,this.Ea.No(o=>{r.enqueueAndForget(async()=>{Ku(this)&&(Ge(Lu,"Restarting streams for network reachability change."),await async function(c){const u=Kt(c);u.Ta.add(4),await jg(u),u.da.set("Unknown"),u.Ta.delete(4),await gb(u)}(this))})}),this.da=new Gve(r,s)}}async function gb(t){if(Ku(t))for(const e of t.Ia)await e(!0)}async function jg(t){for(const e of t.Ia)await e(!1)}function t8(t,e){const n=Kt(t);n.Pa.has(e.targetId)||(n.Pa.set(e.targetId,e),cP(n)?lP(n):hf(n).M_()&&aP(n,e))}function oP(t,e){const n=Kt(t),r=hf(n);n.Pa.delete(e),r.M_()&&n8(n,e),n.Pa.size===0&&(r.M_()?r.N_():Ku(n)&&n.da.set("Unknown"))}function aP(t,e){if(t.Aa.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(kt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}hf(t).H_(e)}function n8(t,e){t.Aa.Ke(e),hf(t).J_(e)}function lP(t){t.Aa=new Lxe({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Pa.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),hf(t).start(),t.da._a()}function cP(t){return Ku(t)&&!hf(t).F_()&&t.Pa.size>0}function Ku(t){return Kt(t).Ta.size===0}function r8(t){t.Aa=void 0}async function Hve(t){t.da.set("Online")}async function qve(t){t.Pa.forEach((e,n)=>{aP(t,e)})}async function Kve(t,e){r8(t),cP(t)?(t.da.ca(e),lP(t)):t.da.set("Unknown")}async function Yve(t,e,n){if(t.da.set("Online"),e instanceof _9&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Pa.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Pa.delete(l),s.Aa.removeTarget(l))}(t,e)}catch(r){Ge(Lu,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ww(t,r)}else if(e instanceof Wx?t.Aa.Xe(e):e instanceof b9?t.Aa.ot(e):t.Aa.nt(e),!n.isEqual(kt.min()))try{const r=await X9(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Aa.It(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.Pa.get(u);d&&i.Pa.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.Pa.get(c);if(!d)return;i.Pa.set(c,d.withResumeToken(Dr.EMPTY_BYTE_STRING,d.snapshotVersion)),n8(i,c);const h=new _a(d.target,c,u,d.sequenceNumber);aP(i,h)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Ge(Lu,"Failed to raise snapshot:",r),await ww(t,r)}}async function ww(t,e,n){if(!Ec(e))throw e;t.Ta.add(1),await jg(t),t.da.set("Offline"),n||(n=()=>X9(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ge(Lu,"Retrying IndexedDB access"),await n(),t.Ta.delete(1),await gb(t)})}function s8(t,e){return e().catch(n=>ww(t,n,e))}async function Dg(t){const e=Kt(t),n=sc(e);let r=e.ha.length>0?e.ha[e.ha.length-1].batchId:du;for(;Jve(e);)try{const s=await kve(e.localStore,r);if(s===null){e.ha.length===0&&n.N_();break}r=s.batchId,Xve(e,s)}catch(s){await ww(e,s)}i8(e)&&o8(e)}function Jve(t){return Ku(t)&&t.ha.length<10}function Xve(t,e){t.ha.push(e);const n=sc(t);n.M_()&&n.Y_&&n.Z_(e.mutations)}function i8(t){return Ku(t)&&!sc(t).F_()&&t.ha.length>0}function o8(t){sc(t).start()}async function Qve(t){sc(t).ta()}async function Zve(t){const e=sc(t);for(const n of t.ha)e.Z_(n.mutations)}async function ewe(t,e,n){const r=t.ha.shift(),s=YN.from(r,e,n);await s8(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Dg(t)}async function twe(t,e){e&&sc(t).Y_&&await async function(r,s){if(function(o){return Dxe(o)&&o!==Pe.ABORTED}(s.code)){const i=r.ha.shift();sc(r).O_(),await s8(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Dg(r)}}(t,e),i8(t)&&o8(t)}async function w4(t,e){const n=Kt(t);n.asyncQueue.verifyOperationInProgress(),Ge(Lu,"RemoteStore received new credentials");const r=Ku(n);n.Ta.add(3),await jg(n),r&&n.da.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ta.delete(3),await gb(n)}async function nwe(t,e){const n=Kt(t);e?(n.Ta.delete(2),await gb(n)):e||(n.Ta.add(2),await jg(n),n.da.set("Unknown"))}function hf(t){return t.Ra||(t.Ra=function(n,r,s){const i=Kt(n);return i.ra(),new Vve(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:Hve.bind(null,t),n_:qve.bind(null,t),i_:Kve.bind(null,t),j_:Yve.bind(null,t)}),t.Ia.push(async e=>{e?(t.Ra.O_(),cP(t)?lP(t):t.da.set("Unknown")):(await t.Ra.stop(),r8(t))})),t.Ra}function sc(t){return t.Va||(t.Va=function(n,r,s){const i=Kt(n);return i.ra(),new Uve(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:Qve.bind(null,t),i_:twe.bind(null,t),X_:Zve.bind(null,t),ea:ewe.bind(null,t)}),t.Ia.push(async e=>{e?(t.Va.O_(),await Dg(t)):(await t.Va.stop(),t.ha.length>0&&(Ge(Lu,`Stopping write stream with ${t.ha.length} pending writes`),t.ha=[]))})),t.Va}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Zo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new uP(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new lt(Pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function dP(t,e){if(Vs("AsyncQueue",`${e}: ${t}`),Ec(t))return new lt(Pe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{static emptySet(e){return new ph(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ut.comparator(n.key,r.key):(n,r)=>ut.comparator(n.key,r.key),this.keyedMap=hm(),this.sortedSet=new tr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ph)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ph;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(){this.ma=new tr(ut.comparator)}track(e){const n=e.doc.key,r=this.ma.get(n);r?e.type!==0&&r.type===3?this.ma=this.ma.insert(n,e):e.type===3&&r.type!==1?this.ma=this.ma.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ma=this.ma.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ma=this.ma.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ma=this.ma.remove(n):e.type===1&&r.type===2?this.ma=this.ma.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ma=this.ma.insert(n,{type:2,doc:e.doc}):bt(63341,{Vt:e,fa:r}):this.ma=this.ma.insert(n,e)}ga(){const e=[];return this.ma.inorderTraversal((n,r)=>{e.push(r)}),e}}class Hh{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Hh(e,n,ph.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ab(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rwe{constructor(){this.pa=void 0,this.ya=[]}wa(){return this.ya.some(e=>e.Sa())}}class swe{constructor(){this.queries=_4(),this.onlineState="Unknown",this.ba=new Set}terminate(){(function(n,r){const s=Kt(n),i=s.queries;s.queries=_4(),i.forEach((o,l)=>{for(const c of l.ya)c.onError(r)})})(this,new lt(Pe.ABORTED,"Firestore shutting down"))}}function _4(){return new Ka(t=>a9(t),ab)}async function hP(t,e){const n=Kt(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.wa()&&e.Sa()&&(r=2):(i=new rwe,r=e.Sa()?0:1);try{switch(r){case 0:i.pa=await n.onListen(s,!0);break;case 1:i.pa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=dP(o,`Initialization of query '${Td(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.ya.push(e),e.Da(n.onlineState),i.pa&&e.va(i.pa)&&mP(n)}async function fP(t,e){const n=Kt(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ya.indexOf(e);o>=0&&(i.ya.splice(o,1),i.ya.length===0?s=e.Sa()?0:1:!i.wa()&&e.Sa()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function iwe(t,e){const n=Kt(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.ya)l.va(s)&&(r=!0);o.pa=s}}r&&mP(n)}function owe(t,e,n){const r=Kt(t),s=r.queries.get(e);if(s)for(const i of s.ya)i.onError(n);r.queries.delete(e)}function mP(t){t.ba.forEach(e=>{e.next()})}var uT,S4;(S4=uT||(uT={})).Ca="default",S4.Cache="cache";class pP{constructor(e,n,r){this.query=e,this.Fa=n,this.Ma=!1,this.xa=null,this.onlineState="Unknown",this.options=r||{}}va(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Hh(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Ma?this.Oa(e)&&(this.Fa.next(e),n=!0):this.Na(e,this.onlineState)&&(this.Ba(e),n=!0),this.xa=e,n}onError(e){this.Fa.error(e)}Da(e){this.onlineState=e;let n=!1;return this.xa&&!this.Ma&&this.Na(this.xa,e)&&(this.Ba(this.xa),n=!0),n}Na(e,n){if(!e.fromCache||!this.Sa())return!0;const r=n!=="Offline";return(!this.options.La||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Oa(e){if(e.docChanges.length>0)return!0;const n=this.xa&&this.xa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Ba(e){e=Hh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Ma=!0,this.Fa.next(e)}Sa(){return this.options.source!==uT.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a8{constructor(e){this.key=e}}class l8{constructor(e){this.key=e}}class awe{constructor(e,n){this.query=e,this.Ga=n,this.za=null,this.hasCachedResults=!1,this.current=!1,this.ja=sn(),this.mutatedKeys=sn(),this.Ha=l9(e),this.Ja=new ph(this.Ha)}get Ya(){return this.Ga}Za(e,n){const r=n?n.Xa:new b4,s=n?n.Ja:this.Ja;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,h)=>{const f=s.get(d),m=kg(this.query,h)?h:null,g=!!f&&this.mutatedKeys.has(f.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let E=!1;f&&m?f.data.isEqual(m.data)?g!==x&&(r.track({type:3,doc:m}),E=!0):this.eu(f,m)||(r.track({type:2,doc:m}),E=!0,(c&&this.Ha(m,c)>0||u&&this.Ha(m,u)<0)&&(l=!0)):!f&&m?(r.track({type:0,doc:m}),E=!0):f&&!m&&(r.track({type:1,doc:f}),E=!0,(c||u)&&(l=!0)),E&&(m?(o=o.add(m),i=x?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ja:o,Xa:r,Cs:l,mutatedKeys:i}}eu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ja;this.Ja=e.Ja,this.mutatedKeys=e.mutatedKeys;const o=e.Xa.ga();o.sort((d,h)=>function(m,g){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return bt(20277,{Vt:E})}};return x(m)-x(g)}(d.type,h.type)||this.Ha(d.doc,h.doc)),this.tu(r),s=s!=null&&s;const l=n&&!s?this.nu():[],c=this.ja.size===0&&this.current&&!s?1:0,u=c!==this.za;return this.za=c,o.length!==0||u?{snapshot:new Hh(this.query,e.Ja,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),ru:l}:{ru:l}}Da(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ja:this.Ja,Xa:new b4,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ru:[]}}iu(e){return!this.Ga.has(e)&&!!this.Ja.has(e)&&!this.Ja.get(e).hasLocalMutations}tu(e){e&&(e.addedDocuments.forEach(n=>this.Ga=this.Ga.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ga=this.Ga.delete(n)),this.current=e.current)}nu(){if(!this.current)return[];const e=this.ja;this.ja=sn(),this.Ja.forEach(r=>{this.iu(r.key)&&(this.ja=this.ja.add(r.key))});const n=[];return e.forEach(r=>{this.ja.has(r)||n.push(new l8(r))}),this.ja.forEach(r=>{e.has(r)||n.push(new a8(r))}),n}su(e){this.Ga=e.$s,this.ja=sn();const n=this.Za(e.documents);return this.applyChanges(n,!0)}ou(){return Hh.fromInitialDocuments(this.query,this.Ja,this.mutatedKeys,this.za===0,this.hasCachedResults)}}const gP="SyncEngine";class lwe{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class cwe{constructor(e){this.key=e,this._u=!1}}class uwe{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.au={},this.uu=new Ka(l=>a9(l),ab),this.cu=new Map,this.lu=new Set,this.hu=new tr(ut.comparator),this.Pu=new Map,this.Tu=new tP,this.Iu={},this.Eu=new Map,this.du=Mu.lr(),this.onlineState="Unknown",this.Au=void 0}get isPrimaryClient(){return this.Au===!0}}async function dwe(t,e,n=!0){const r=m8(t);let s;const i=r.uu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.ou()):s=await c8(r,e,n,!0),s}async function hwe(t,e){const n=m8(t);await c8(n,e,!0,!1)}async function c8(t,e,n,r){const s=await Rve(t.localStore,Yi(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await fwe(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&t8(t.remoteStore,s),l}async function fwe(t,e,n,r,s){t.Ru=(h,f,m)=>async function(x,E,v,b){let S=E.view.Za(v);S.Cs&&(S=await p4(x.localStore,E.query,!1).then(({documents:C})=>E.view.Za(C,S)));const I=b&&b.targetChanges.get(E.targetId),D=b&&b.targetMismatches.get(E.targetId)!=null,k=E.view.applyChanges(S,x.isPrimaryClient,I,D);return C4(x,E.targetId,k.ru),k.snapshot}(t,h,f,m);const i=await p4(t.localStore,e,!0),o=new awe(e,i.$s),l=o.Za(i.documents),c=Rg.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);C4(t,n,u.ru);const d=new lwe(e,n,o);return t.uu.set(e,d),t.cu.has(n)?t.cu.get(n).push(e):t.cu.set(n,[e]),u.snapshot}async function mwe(t,e,n){const r=Kt(t),s=r.uu.get(e),i=r.cu.get(s.targetId);if(i.length>1)return r.cu.set(s.targetId,i.filter(o=>!ab(o,e))),void r.uu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await lT(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&oP(r.remoteStore,s.targetId),dT(r,s.targetId)}).catch(qu)):(dT(r,s.targetId),await lT(r.localStore,s.targetId,!0))}async function pwe(t,e){const n=Kt(t),r=n.uu.get(e),s=n.cu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),oP(n.remoteStore,r.targetId))}async function gwe(t,e,n){const r=p8(t);try{const s=await function(o,l){const c=Kt(o),u=cr.now(),d=l.reduce((m,g)=>m.add(g.key),sn());let h,f;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=Ti(),x=sn();return c.Bs.getEntries(m,d).next(E=>{g=E,g.forEach((v,b)=>{b.isValidDocument()||(x=x.add(v))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,g)).next(E=>{h=E;const v=[];for(const b of l){const S=Rxe(b,h.get(b.key).overlayedDocument);S!=null&&v.push(new Ya(b.key,S,Qz(S.value.mapValue),Bs.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,v,l)}).next(E=>{f=E;const v=E.applyToLocalDocumentSet(h,x);return c.documentOverlayCache.saveOverlays(m,E.batchId,v)})}).then(()=>({batchId:f.batchId,changes:u9(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Iu[o.currentUser.toKey()];u||(u=new tr($t)),u=u.insert(l,c),o.Iu[o.currentUser.toKey()]=u}(r,s.batchId,n),await Mg(r,s.changes),await Dg(r.remoteStore)}catch(s){const i=dP(s,"Failed to persist write");n.reject(i)}}async function u8(t,e){const n=Kt(t);try{const r=await Pve(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Pu.get(i);o&&(Tt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o._u=!0:s.modifiedDocuments.size>0?Tt(o._u,14607):s.removedDocuments.size>0&&(Tt(o._u,42227),o._u=!1))}),await Mg(n,r,e)}catch(r){await qu(r)}}function E4(t,e,n){const r=Kt(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.uu.forEach((i,o)=>{const l=o.view.Da(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=Kt(o);c.onlineState=l;let u=!1;c.queries.forEach((d,h)=>{for(const f of h.ya)f.Da(l)&&(u=!0)}),u&&mP(c)}(r.eventManager,e),s.length&&r.au.j_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ywe(t,e,n){const r=Kt(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Pu.get(e),i=s&&s.key;if(i){let o=new tr(ut.comparator);o=o.insert(i,gr.newNoDocument(i,kt.min()));const l=sn().add(i),c=new db(kt.min(),new Map,new tr($t),o,l);await u8(r,c),r.hu=r.hu.remove(i),r.Pu.delete(e),yP(r)}else await lT(r.localStore,e,!1).then(()=>dT(r,e,n)).catch(qu)}async function xwe(t,e){const n=Kt(t),r=e.batch.batchId;try{const s=await Nve(n.localStore,e);h8(n,r,null),d8(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Mg(n,s)}catch(s){await qu(s)}}async function vwe(t,e,n){const r=Kt(t);try{const s=await function(o,l){const c=Kt(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(h=>(Tt(h!==null,37113),d=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);h8(r,e,n),d8(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Mg(r,s)}catch(s){await qu(s)}}function d8(t,e){(t.Eu.get(e)||[]).forEach(n=>{n.resolve()}),t.Eu.delete(e)}function h8(t,e,n){const r=Kt(t);let s=r.Iu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Iu[r.currentUser.toKey()]=s}}function dT(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.cu.get(e))t.uu.delete(r),n&&t.au.Vu(r,n);t.cu.delete(e),t.isPrimaryClient&&t.Tu.Hr(e).forEach(r=>{t.Tu.containsKey(r)||f8(t,r)})}function f8(t,e){t.lu.delete(e.path.canonicalString());const n=t.hu.get(e);n!==null&&(oP(t.remoteStore,n),t.hu=t.hu.remove(e),t.Pu.delete(n),yP(t))}function C4(t,e,n){for(const r of n)r instanceof a8?(t.Tu.addReference(r.key,e),wwe(t,r)):r instanceof l8?(Ge(gP,"Document no longer in limbo: "+r.key),t.Tu.removeReference(r.key,e),t.Tu.containsKey(r.key)||f8(t,r.key)):bt(19791,{mu:r})}function wwe(t,e){const n=e.key,r=n.path.canonicalString();t.hu.get(n)||t.lu.has(r)||(Ge(gP,"New document in limbo: "+n),t.lu.add(r),yP(t))}function yP(t){for(;t.lu.size>0&&t.hu.size<t.maxConcurrentLimboResolutions;){const e=t.lu.values().next().value;t.lu.delete(e);const n=new ut(In.fromString(e)),r=t.du.next();t.Pu.set(r,new cwe(n)),t.hu=t.hu.insert(n,r),t8(t.remoteStore,new _a(Yi(Ag(n.path)),r,"TargetPurposeLimboResolution",Hi.le))}}async function Mg(t,e,n){const r=Kt(t),s=[],i=[],o=[];r.uu.isEmpty()||(r.uu.forEach((l,c)=>{o.push(r.Ru(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const h=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){s.push(u);const h=sP.Rs(c.targetId,u);i.push(h)}}))}),await Promise.all(o),r.au.j_(s),await async function(c,u){const d=Kt(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>le.forEach(u,f=>le.forEach(f.ds,m=>d.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>le.forEach(f.As,m=>d.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!Ec(h))throw h;Ge(iP,"Failed to update sequence numbers: "+h)}for(const h of u){const f=h.targetId;if(!h.fromCache){const m=d.xs.get(f),g=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(g);d.xs=d.xs.insert(f,x)}}}(r.localStore,i))}async function bwe(t,e){const n=Kt(t);if(!n.currentUser.isEqual(e)){Ge(gP,"User change. New user:",e.toKey());const r=await J9(n.localStore,e);n.currentUser=e,function(i,o){i.Eu.forEach(l=>{l.forEach(c=>{c.reject(new lt(Pe.CANCELLED,o))})}),i.Eu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Mg(n,r.ks)}}function _we(t,e){const n=Kt(t),r=n.Pu.get(e);if(r&&r._u)return sn().add(r.key);{let s=sn();const i=n.cu.get(e);if(!i)return s;for(const o of i){const l=n.uu.get(o);s=s.unionWith(l.view.Ya)}return s}}function m8(t){const e=Kt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=u8.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=_we.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ywe.bind(null,e),e.au.j_=iwe.bind(null,e.eventManager),e.au.Vu=owe.bind(null,e.eventManager),e}function p8(t){const e=Kt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xwe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vwe.bind(null,e),e}class Up{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=pb(e.databaseInfo.databaseId),this.sharedClientState=this.pu(e),this.persistence=this.yu(e),await this.persistence.start(),this.localStore=this.wu(e),this.gcScheduler=this.Su(e,this.localStore),this.indexBackfillerScheduler=this.bu(e,this.localStore)}Su(e,n){return null}bu(e,n){return null}wu(e){return Y9(this.persistence,new K9,e.initialUser,this.serializer)}yu(e){return new nP(mb.fi,this.serializer)}pu(e){return new Q9}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Up.provider={build:()=>new Up};class Swe extends Up{constructor(e){super(),this.cacheSizeBytes=e}Su(e,n){Tt(this.persistence.referenceDelegate instanceof vw,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new z9(r,e.asyncQueue,n)}yu(e){const n=this.cacheSizeBytes!==void 0?_s.withCacheSize(this.cacheSizeBytes):_s.DEFAULT;return new nP(r=>vw.fi(r,n),this.serializer)}}class Ewe extends Up{constructor(e,n,r){super(),this.Du=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Du.initialize(this,e),await p8(this.Du.syncEngine),await Dg(this.Du.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}wu(e){return Y9(this.persistence,new K9,e.initialUser,this.serializer)}Su(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new z9(r,e.asyncQueue,n)}bu(e,n){const r=new Aye(n,this.persistence);return new Pye(e.asyncQueue,r)}yu(e){const n=Eve(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?_s.withCacheSize(this.cacheSizeBytes):_s.DEFAULT;return new rP(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,$ve(),qx(),this.serializer,this.sharedClientState,!!this.forceOwnership)}pu(e){return new Q9}}class bw{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>E4(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=bwe.bind(null,this.syncEngine),await nwe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new swe}()}createDatastore(e){const n=pb(e.databaseInfo.databaseId),r=function(i){return new Ove(i)}(e.databaseInfo);return function(i,o,l,c){return new zve(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new Wve(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>E4(this.syncEngine,n,0),function(){return x4.C()?new x4:new Dve}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,d){const h=new uwe(s,i,o,l,c,u);return d&&(h.Au=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Kt(s);Ge(Lu,"RemoteStore shutting down."),i.Ta.add(5),await jg(i),i.Ea.shutdown(),i.da.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}bw.provider={build:()=>new bw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.vu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.vu(this.observer.error,e):Vs("Uncaught Error in snapshot listener:",e.toString()))}Cu(){this.muted=!0}vu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ic="FirestoreClient";class Cwe{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=rs.UNAUTHENTICATED,this.clientId=Iz.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Ge(ic,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Ge(ic,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=dP(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function xS(t,e){t.asyncQueue.verifyOperationInProgress(),Ge(ic,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await J9(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function T4(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Twe(t);Ge(ic,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>w4(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>w4(e.remoteStore,s)),t._onlineComponents=e}async function Twe(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ge(ic,"Using user provided OfflineComponentProvider");try{await xS(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===Pe.FAILED_PRECONDITION||s.code===Pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Au("Error using user provided cache. Falling back to memory cache: "+n),await xS(t,new Up)}}else Ge(ic,"Using default OfflineComponentProvider"),await xS(t,new Swe(void 0));return t._offlineComponents}async function g8(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ge(ic,"Using user provided OnlineComponentProvider"),await T4(t,t._uninitializedComponentsProvider._online)):(Ge(ic,"Using default OnlineComponentProvider"),await T4(t,new bw))),t._onlineComponents}function Iwe(t){return g8(t).then(e=>e.syncEngine)}async function _w(t){const e=await g8(t),n=e.eventManager;return n.onListen=dwe.bind(null,e.syncEngine),n.onUnlisten=mwe.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=hwe.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=pwe.bind(null,e.syncEngine),n}function Nwe(t,e,n={}){const r=new Zo;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new xP({next:f=>{d.Cu(),o.enqueueAndForget(()=>fP(i,h));const m=f.docs.has(l);!m&&f.fromCache?u.reject(new lt(Pe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&c&&c.source==="server"?u.reject(new lt(Pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new pP(Ag(l.path),d,{includeMetadataChanges:!0,La:!0});return hP(i,h)}(await _w(t),t.asyncQueue,e,n,r)),r.promise}function Pwe(t,e,n={}){const r=new Zo;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new xP({next:f=>{d.Cu(),o.enqueueAndForget(()=>fP(i,h)),f.fromCache&&c.source==="server"?u.reject(new lt(Pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new pP(l,d,{includeMetadataChanges:!0,La:!0});return hP(i,h)}(await _w(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y8(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x8(t,e,n){if(!n)throw new lt(Pe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Awe(t,e,n,r){if(e===!0&&r===!0)throw new lt(Pe.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function N4(t){if(!ut.isDocumentKey(t))throw new lt(Pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function P4(t){if(ut.isDocumentKey(t))throw new lt(Pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function yb(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":bt(12329,{type:typeof t})}function li(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new lt(Pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=yb(t);throw new lt(Pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function kwe(t,e){if(e<=0)throw new lt(Pe.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v8="firestore.googleapis.com",A4=!0;class k4{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new lt(Pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=v8,this.ssl=A4}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:A4;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$9;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ave)throw new lt(Pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Awe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=y8((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new lt(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new lt(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new lt(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xb{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new k4({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new lt(Pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new lt(Pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new k4(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new yye;switch(r.type){case"firstParty":return new bye(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new lt(Pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=I4.get(n);r&&(Ge("ComponentProvider","Removing Datastore"),I4.delete(n),r.terminate())}(this),Promise.resolve()}}function Rwe(t,e,n,r={}){var s;t=li(t,xb);const i=wc(e),o=t._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),c=`${e}:${n}`;i&&(K0(`https://${c}`),Y0("Firestore",!0)),o.host!==v8&&o.host!==c&&Au("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},o),{host:c,ssl:i,emulatorOptions:r});if(!Tu(u,l)&&(t._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=rs.MOCK_USER;else{d=PB(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new lt(Pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new rs(f)}t._authCredentials=new xye(new Cz(d,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Tc(this.firestore,e,this._query)}}class Is{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Gl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Is(this.firestore,e,this._key)}}class Gl extends Tc{constructor(e,n,r){super(e,n,Ag(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Is(this.firestore,null,new ut(e))}withConverter(e){return new Gl(this.firestore,e,this._path)}}function Vc(t,e,...n){if(t=zn(t),x8("collection","path",e),t instanceof xb){const r=In.fromString(e,...n);return P4(r),new Gl(t,null,r)}{if(!(t instanceof Is||t instanceof Gl))throw new lt(Pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(In.fromString(e,...n));return P4(r),new Gl(t.firestore,null,r)}}function vi(t,e,...n){if(t=zn(t),arguments.length===1&&(e=Iz.newId()),x8("doc","path",e),t instanceof xb){const r=In.fromString(e,...n);return N4(r),new Is(t,null,new ut(r))}{if(!(t instanceof Is||t instanceof Gl))throw new lt(Pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(In.fromString(e,...n));return N4(r),new Is(t.firestore,t instanceof Gl?t.converter:null,new ut(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4="AsyncQueue";class j4{constructor(e=Promise.resolve()){this.zu=[],this.ju=!1,this.Hu=[],this.Ju=null,this.Yu=!1,this.Zu=!1,this.Xu=[],this.C_=new Z9(this,"async_queue_retry"),this.ec=()=>{const r=qx();r&&Ge(R4,"Visibility state changed to "+r.visibilityState),this.C_.p_()},this.tc=e;const n=qx();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.ec)}get isShuttingDown(){return this.ju}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nc(),this.rc(e)}enterRestrictedMode(e){if(!this.ju){this.ju=!0,this.Zu=e||!1;const n=qx();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.ec)}}enqueue(e){if(this.nc(),this.ju)return new Promise(()=>{});const n=new Zo;return this.rc(()=>this.ju&&this.Zu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.zu.push(e),this.sc()))}async sc(){if(this.zu.length!==0){try{await this.zu[0](),this.zu.shift(),this.C_.reset()}catch(e){if(!Ec(e))throw e;Ge(R4,"Operation failed with retryable error: "+e)}this.zu.length>0&&this.C_.f_(()=>this.sc())}}rc(e){const n=this.tc.then(()=>(this.Yu=!0,e().catch(r=>{throw this.Ju=r,this.Yu=!1,Vs("INTERNAL UNHANDLED ERROR: ",D4(r)),r}).then(r=>(this.Yu=!1,r))));return this.tc=n,n}enqueueAfterDelay(e,n,r){this.nc(),this.Xu.indexOf(e)>-1&&(n=0);const s=uP.createAndSchedule(this,e,n,r,i=>this.oc(i));return this.Hu.push(s),s}nc(){this.Ju&&bt(47125,{_c:D4(this.Ju)})}verifyOperationInProgress(){}async ac(){let e;do e=this.tc,await e;while(e!==this.tc)}uc(e){for(const n of this.Hu)if(n.timerId===e)return!0;return!1}cc(e){return this.ac().then(()=>{this.Hu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Hu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.ac()})}lc(e){this.Xu.push(e)}oc(e){const n=this.Hu.indexOf(e);this.Hu.splice(n,1)}}function D4(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M4(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jwe=-1;class Va extends xb{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new j4,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new j4(e),this._firestoreClient=void 0,await e}}}function Dwe(t,e){const n=typeof t=="object"?t:J0(),r=typeof t=="string"?t:e||cw,s=_g(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=SN("firestore");i&&Rwe(s,...i)}return s}function vb(t){if(t._terminated)throw new lt(Pe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||w8(t),t._firestoreClient}function w8(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new ixe(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,y8(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new Cwe(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function Mwe(t,e){Au("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return Lwe(t,bw.provider,{build:r=>new Ewe(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function Lwe(t,e,n){if((t=li(t,Va))._firestoreClient||t._terminated)throw new lt(Pe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new lt(Pe.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},w8(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new qh(Dr.fromBase64String(e))}catch(n){throw new lt(Pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new qh(Dr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new lt(Pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ar(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new lt(Pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new lt(Pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return $t(this._lat,e._lat)||$t(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fwe=/^__.*__$/;class Owe{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ya(e,this.data,this.fieldMask,n,this.fieldTransforms):new df(e,this.data,n,this.fieldTransforms)}}class b8{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ya(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function _8(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw bt(40011,{hc:t})}}class _P{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Pc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get hc(){return this.settings.hc}Tc(e){return new _P(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ic(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tc({path:r,Ec:!1});return s.dc(e),s}Ac(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tc({path:r,Ec:!1});return s.Pc(),s}Rc(e){return this.Tc({path:void 0,Ec:!0})}Vc(e){return Sw(e,this.settings.methodName,this.settings.mc||!1,this.path,this.settings.fc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pc(){if(this.path)for(let e=0;e<this.path.length;e++)this.dc(this.path.get(e))}dc(e){if(e.length===0)throw this.Vc("Document fields must not be empty");if(_8(this.hc)&&Fwe.test(e))throw this.Vc('Document fields cannot begin and end with "__"')}}class $we{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||pb(e)}gc(e,n,r,s=!1){return new _P({hc:e,methodName:n,fc:r,path:ar.emptyPath(),Ec:!1,mc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function SP(t){const e=t._freezeSettings(),n=pb(t._databaseId);return new $we(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Vwe(t,e,n,r,s,i={}){const o=t.gc(i.merge||i.mergeFields?2:0,e,n,s);EP("Data must be an object, but it was:",o,r);const l=S8(r,o);let c,u;if(i.merge)c=new ri(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const f=hT(e,h,n);if(!o.contains(f))throw new lt(Pe.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);C8(d,f)||d.push(f)}c=new ri(d),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new Owe(new Cs(l),c,u)}class bb extends vP{_toFieldTransform(e){if(e.hc!==2)throw e.hc===1?e.Vc(`${this._methodName}() can only appear at the top level of your update data`):e.Vc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bb}}function Uwe(t,e,n,r){const s=t.gc(1,e,n);EP("Data must be an object, but it was:",s,r);const i=[],o=Cs.empty();Cc(r,(c,u)=>{const d=CP(e,c,n);u=zn(u);const h=s.Ac(d);if(u instanceof bb)i.push(d);else{const f=Lg(u,h);f!=null&&(i.push(d),o.set(d,f))}});const l=new ri(i);return new b8(o,l,s.fieldTransforms)}function Bwe(t,e,n,r,s,i){const o=t.gc(1,e,n),l=[hT(e,r,n)],c=[s];if(i.length%2!=0)throw new lt(Pe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)l.push(hT(e,i[f])),c.push(i[f+1]);const u=[],d=Cs.empty();for(let f=l.length-1;f>=0;--f)if(!C8(u,l[f])){const m=l[f];let g=c[f];g=zn(g);const x=o.Ac(m);if(g instanceof bb)u.push(m);else{const E=Lg(g,x);E!=null&&(u.push(m),d.set(m,E))}}const h=new ri(u);return new b8(d,h,o.fieldTransforms)}function zwe(t,e,n,r=!1){return Lg(n,t.gc(r?4:3,e))}function Lg(t,e){if(E8(t=zn(t)))return EP("Unsupported field value:",e,t),S8(t,e);if(t instanceof vP)return function(r,s){if(!_8(s.hc))throw s.Vc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Vc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Ec&&e.hc!==4)throw e.Vc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=Lg(l,s.Rc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=zn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Cxe(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=cr.fromDate(r);return{timestampValue:Wh(s.serializer,i)}}if(r instanceof cr){const i=new cr(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Wh(s.serializer,i)}}if(r instanceof wP)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof qh)return{bytesValue:S9(s.serializer,r._byteString)};if(r instanceof Is){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Vc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:QN(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof bP)return function(o,l){return{mapValue:{fields:{[GN]:{stringValue:WN},[$h]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Vc("VectorValues must only contain numeric values.");return qN(l.serializer,u)})}}}}}}(r,s);throw s.Vc(`Unsupported field value: ${yb(r)}`)}(t,e)}function S8(t,e){const n={};return zz(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Cc(t,(r,s)=>{const i=Lg(s,e.Ic(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function E8(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof cr||t instanceof wP||t instanceof qh||t instanceof Is||t instanceof vP||t instanceof bP)}function EP(t,e,n){if(!E8(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=yb(n);throw r==="an object"?e.Vc(t+" a custom object"):e.Vc(t+" "+r)}}function hT(t,e,n){if((e=zn(e))instanceof wb)return e._internalPath;if(typeof e=="string")return CP(t,e);throw Sw("Field path arguments must be of type string or ",t,!1,void 0,n)}const Gwe=new RegExp("[~\\*/\\[\\]]");function CP(t,e,n){if(e.search(Gwe)>=0)throw Sw(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new wb(...e.split("."))._internalPath}catch{throw Sw(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Sw(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new lt(Pe.INVALID_ARGUMENT,l+t+c)}function C8(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T8{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Is(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Wwe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(TP("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Wwe extends T8{data(){return super.data()}}function TP(t,e){return typeof e=="string"?CP(t,e):e instanceof wb?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I8(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new lt(Pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class IP{}class N8 extends IP{}function fT(t,e,...n){let r=[];e instanceof IP&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof NP).length,l=i.filter(c=>c instanceof _b).length;if(o>1||o>0&&l>0)throw new lt(Pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class _b extends N8{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new _b(e,n,r)}_apply(e){const n=this._parse(e);return P8(e._query,n),new Tc(e.firestore,e.converter,eT(e._query,n))}_parse(e){const n=SP(e.firestore);return function(i,o,l,c,u,d,h){let f;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new lt(Pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){F4(h,d);const g=[];for(const x of h)g.push(L4(c,i,x));f={arrayValue:{values:g}}}else f=L4(c,i,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||F4(h,d),f=zwe(l,o,h,d==="in"||d==="not-in");return fn.create(u,d,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function mT(t,e,n){const r=e,s=TP("where",t);return _b._create(s,r,n)}class NP extends IP{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new NP(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:An.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)P8(o,c),o=eT(o,c)}(e._query,n),new Tc(e.firestore,e.converter,eT(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class PP extends N8{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new PP(e,n,r)}_apply(e){return new Tc(e.firestore,e.converter,fw(e._query,this._limit,this._limitType))}}function Hwe(t){return kwe("limit",t),PP._create("limit",t,"F")}function L4(t,e,n){if(typeof(n=zn(n))=="string"){if(n==="")throw new lt(Pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!o9(e)&&n.indexOf("/")!==-1)throw new lt(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(In.fromString(n));if(!ut.isDocumentKey(r))throw new lt(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Fp(t,new ut(r))}if(n instanceof Is)return Fp(t,n._key);throw new lt(Pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${yb(n)}.`)}function F4(t,e){if(!Array.isArray(t)||t.length===0)throw new lt(Pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function P8(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new lt(Pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new lt(Pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class qwe{convertValue(e,n="none"){switch(nc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes($a(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw bt(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Cc(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[$h].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Qn(o.doubleValue));return new bP(i)}convertGeoPoint(e){return new wP(Qn(e.latitude),Qn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=ib(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Mp(e));default:return null}}convertTimestamp(e){const n=Oa(e);return new cr(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=In.fromString(e);Tt(j9(r),9688,{name:e});const s=new ku(r.get(1),r.get(3)),i=new ut(r.popFirst(5));return s.isEqual(n)||Vs(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kwe(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class A8 extends T8{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Kx(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(TP("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Kx extends A8{data(e={}){return super.data(e)}}class k8{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new pm(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Kx(this._firestore,this._userDataWriter,r.key,r,new pm(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new lt(Pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new Kx(s._firestore,s._userDataWriter,l.doc.key,l.doc,new pm(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new Kx(s._firestore,s._userDataWriter,l.doc.key,l.doc,new pm(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:Ywe(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function Ywe(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return bt(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jwe(t){t=li(t,Is);const e=li(t.firestore,Va);return Nwe(vb(e),t._key).then(n=>R8(e,t,n))}class AP extends qwe{constructor(e){super(),this.firestore=e}convertBytes(e){return new qh(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Is(this.firestore,null,n)}}function Uc(t){t=li(t,Tc);const e=li(t.firestore,Va),n=vb(e),r=new AP(e);return I8(t._query),Pwe(n,t._query).then(s=>new k8(e,r,t,s))}function qm(t,e,n){t=li(t,Is);const r=li(t.firestore,Va),s=Kwe(t.converter,e,n);return kP(r,[Vwe(SP(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Bs.none())])}function Ky(t,e,n,...r){t=li(t,Is);const s=li(t.firestore,Va),i=SP(s);let o;return o=typeof(e=zn(e))=="string"||e instanceof wb?Bwe(i,"updateDoc",t._key,e,n,r):Uwe(i,"updateDoc",t._key,e),kP(s,[o.toMutation(t._key,Bs.exists(!0))])}function vS(t){return kP(li(t.firestore,Va),[new ub(t._key,Bs.none())])}function Xwe(t,...e){var n,r,s;t=zn(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||M4(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(M4(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let c,u,d;if(t instanceof Is)u=li(t.firestore,Va),d=Ag(t._key.path),c={next:h=>{e[o]&&e[o](R8(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=li(t,Tc);u=li(h.firestore,Va),d=h._query;const f=new AP(u);c={next:m=>{e[o]&&e[o](new k8(u,f,h,m))},error:e[o+1],complete:e[o+2]},I8(t._query)}return function(f,m,g,x){const E=new xP(x),v=new pP(m,E,g);return f.asyncQueue.enqueueAndForget(async()=>hP(await _w(f),v)),()=>{E.Cu(),f.asyncQueue.enqueueAndForget(async()=>fP(await _w(f),v))}}(vb(u),d,l,c)}function kP(t,e){return function(r,s){const i=new Zo;return r.asyncQueue.enqueueAndForget(async()=>gwe(await Iwe(r),s,i)),i.promise}(vb(t),e)}function R8(t,e,n){const r=n.docs.get(e._key),s=new AP(t);return new A8(t,s,e._key,r,new pm(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){uf=s})(Hu),tc(new Ma("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new Va(new vye(r.getProvider("auth-internal")),new _ye(o,r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new lt(Pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ku(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Ki(pM,gM,e),Ki(pM,gM,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j8="firebasestorage.googleapis.com",D8="storageBucket",Qwe=2*60*1e3,Zwe=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br extends Po{constructor(e,n,r=0){super(wS(e),`Firebase Storage: ${n} (${wS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,br.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return wS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var wr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(wr||(wr={}));function wS(t){return"storage/"+t}function RP(){const t="An unknown error occurred, please check the error payload for server response.";return new br(wr.UNKNOWN,t)}function e0e(t){return new br(wr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function t0e(t){return new br(wr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function n0e(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new br(wr.UNAUTHENTICATED,t)}function r0e(){return new br(wr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function s0e(t){return new br(wr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function i0e(){return new br(wr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function o0e(){return new br(wr.CANCELED,"User canceled the upload/download.")}function a0e(t){return new br(wr.INVALID_URL,"Invalid URL '"+t+"'.")}function l0e(t){return new br(wr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function c0e(){return new br(wr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+D8+"' property when initializing the app?")}function u0e(){return new br(wr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function d0e(){return new br(wr.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function h0e(t){return new br(wr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function pT(t){return new br(wr.INVALID_ARGUMENT,t)}function M8(){return new br(wr.APP_DELETED,"The Firebase app was deleted.")}function f0e(t){return new br(wr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Km(t,e){return new br(wr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Wf(t){throw new br(wr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Ii.makeFromUrl(e,n)}catch{return new Ii(e,"")}if(r.path==="")return r;throw l0e(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function u(I){I.path_=decodeURIComponent(I.path)}const d="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${d}/b/${s}/o${f}`,"i"),g={bucket:1,path:3},x=n===j8?"(?:storage.googleapis.com|storage.cloud.google.com)":n,E="([^?#]*)",v=new RegExp(`^https?://${x}/${s}/${E}`,"i"),S=[{regex:l,indices:c,postModify:i},{regex:m,indices:g,postModify:u},{regex:v,indices:{bucket:1,path:2},postModify:u}];for(let I=0;I<S.length;I++){const D=S[I],k=D.regex.exec(e);if(k){const C=k[D.indices.bucket];let T=k[D.indices.path];T||(T=""),r=new Ii(C,T),D.postModify(r);break}}if(r==null)throw a0e(e);return r}}class m0e{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0e(t,e,n){let r=1,s=null,i=null,o=!1,l=0;function c(){return l===2}let u=!1;function d(...E){u||(u=!0,e.apply(null,E))}function h(E){s=setTimeout(()=>{s=null,t(m,c())},E)}function f(){i&&clearTimeout(i)}function m(E,...v){if(u){f();return}if(E){f(),d.call(null,E,...v);return}if(c()||o){f(),d.call(null,E,...v);return}r<64&&(r*=2);let S;l===1?(l=2,S=0):S=(r+Math.random())*1e3,h(S)}let g=!1;function x(E){g||(g=!0,f(),!u&&(s!==null?(E||(l=2),clearTimeout(s),h(0)):E||(l=1)))}return h(0),i=setTimeout(()=>{o=!0,x(!0)},n),x}function g0e(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0e(t){return t!==void 0}function x0e(t){return typeof t=="object"&&!Array.isArray(t)}function jP(t){return typeof t=="string"||t instanceof String}function O4(t){return DP()&&t instanceof Blob}function DP(){return typeof Blob<"u"}function $4(t,e,n,r){if(r<e)throw pT(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw pT(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MP(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function L8(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var mu;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(mu||(mu={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v0e(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0e{constructor(e,n,r,s,i,o,l,c,u,d,h,f=!0,m=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,x)=>{this.resolve_=g,this.reject_=x,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Yy(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===mu.NO_ERROR,c=i.getStatus();if(!l||v0e(c,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===mu.ABORT;r(!1,new Yy(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new Yy(u,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());y0e(c)?i(c):i()}catch(c){o(c)}else if(l!==null){const c=RP();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(s.canceled){const c=this.appDelete_?M8():o0e();o(c)}else{const c=i0e();o(c)}};this.canceled_?n(!1,new Yy(!1,null,!0)):this.backoffId_=p0e(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&g0e(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Yy{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function b0e(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function _0e(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function S0e(t,e){e&&(t["X-Firebase-GMPID"]=e)}function E0e(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function C0e(t,e,n,r,s,i,o=!0,l=!1){const c=L8(t.urlParams),u=t.url+c,d=Object.assign({},t.headers);return S0e(d,e),b0e(d,n),_0e(d,i),E0e(d,r),new w0e(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T0e(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function I0e(...t){const e=T0e();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(DP())return new Blob(t);throw new br(wr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function N0e(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0e(t){if(typeof atob>"u")throw h0e("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Go={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class bS{constructor(e,n){this.data=e,this.contentType=n||null}}function A0e(t,e){switch(t){case Go.RAW:return new bS(F8(e));case Go.BASE64:case Go.BASE64URL:return new bS(O8(t,e));case Go.DATA_URL:return new bS(R0e(e),j0e(e))}throw RP()}function F8(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function k0e(t){let e;try{e=decodeURIComponent(t)}catch{throw Km(Go.DATA_URL,"Malformed data URL.")}return F8(e)}function O8(t,e){switch(t){case Go.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Km(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Go.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Km(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=P0e(e)}catch(s){throw s.message.includes("polyfill")?s:Km(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class $8{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Km(Go.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=D0e(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function R0e(t){const e=new $8(t);return e.base64?O8(Go.BASE64,e.rest):k0e(e.rest)}function j0e(t){return new $8(t).contentType}function D0e(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e,n){let r=0,s="";O4(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(O4(this.data_)){const r=this.data_,s=N0e(r,e,n);return s===null?null:new Sl(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Sl(r,!0)}}static getBlob(...e){if(DP()){const n=e.map(r=>r instanceof Sl?r.data_:r);return new Sl(I0e.apply(null,n))}else{const n=e.map(o=>jP(o)?A0e(Go.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new Sl(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V8(t){let e;try{e=JSON.parse(t)}catch{return null}return x0e(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M0e(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function L0e(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function U8(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F0e(t,e){return e}class Ms{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||F0e}}let Jy=null;function O0e(t){return!jP(t)||t.length<2?t:U8(t)}function B8(){if(Jy)return Jy;const t=[];t.push(new Ms("bucket")),t.push(new Ms("generation")),t.push(new Ms("metageneration")),t.push(new Ms("name","fullPath",!0));function e(i,o){return O0e(o)}const n=new Ms("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new Ms("size");return s.xform=r,t.push(s),t.push(new Ms("timeCreated")),t.push(new Ms("updated")),t.push(new Ms("md5Hash",null,!0)),t.push(new Ms("cacheControl",null,!0)),t.push(new Ms("contentDisposition",null,!0)),t.push(new Ms("contentEncoding",null,!0)),t.push(new Ms("contentLanguage",null,!0)),t.push(new Ms("contentType",null,!0)),t.push(new Ms("metadata","customMetadata",!0)),Jy=t,Jy}function $0e(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Ii(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function V0e(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return $0e(r,t),r}function z8(t,e,n){const r=V8(e);return r===null?null:V0e(t,r,n)}function U0e(t,e,n,r){const s=V8(e);if(s===null||!jP(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,h=t.fullPath,f="/b/"+o(d)+"/o/"+o(h),m=MP(f,n,r),g=L8({alt:"media",token:u});return m+g})[0]}function B0e(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class G8{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W8(t){if(!t)throw RP()}function z0e(t,e){function n(r,s){const i=z8(t,s,e);return W8(i!==null),i}return n}function G0e(t,e){function n(r,s){const i=z8(t,s,e);return W8(i!==null),U0e(i,s,t.host,t._protocol)}return n}function H8(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=r0e():s=n0e():n.getStatus()===402?s=t0e(t.bucket):n.getStatus()===403?s=s0e(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function W0e(t){const e=H8(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=e0e(t.path)),i.serverResponse=s.serverResponse,i}return n}function H0e(t,e,n){const r=e.fullServerUrl(),s=MP(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new G8(s,i,G0e(t,n),o);return l.errorHandler=W0e(e),l}function q0e(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function K0e(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=q0e(null,e)),r}function Y0e(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let S="";for(let I=0;I<2;I++)S=S+Math.random().toString().slice(2);return S}const c=l();o["Content-Type"]="multipart/related; boundary="+c;const u=K0e(e,r,s),d=B0e(u,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,f=`\r
--`+c+"--",m=Sl.getBlob(h,r,f);if(m===null)throw u0e();const g={name:u.fullPath},x=MP(i,t.host,t._protocol),E="POST",v=t.maxUploadRetryTime,b=new G8(x,E,z0e(t,n),v);return b.urlParams=g,b.headers=o,b.body=m.uploadData(),b.errorHandler=H8(e),b}class J0e{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=mu.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=mu.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=mu.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw Wf("cannot .send() more than once");if(wc(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Wf("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Wf("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Wf("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Wf("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class X0e extends J0e{initXhr(){this.xhr_.responseType="text"}}function q8(){return new X0e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,n){this._service=e,n instanceof Ii?this._location=n:this._location=Ii.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Fu(e,n)}get root(){const e=new Ii(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return U8(this._location.path)}get storage(){return this._service}get parent(){const e=M0e(this._location.path);if(e===null)return null;const n=new Ii(this._location.bucket,e);return new Fu(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw f0e(e)}}function Q0e(t,e,n){t._throwIfRoot("uploadBytes");const r=Y0e(t.storage,t._location,B8(),new Sl(e,!0),n);return t.storage.makeRequestWithTokens(r,q8).then(s=>({metadata:s,ref:t}))}function Z0e(t){t._throwIfRoot("getDownloadURL");const e=H0e(t.storage,t._location,B8());return t.storage.makeRequestWithTokens(e,q8).then(n=>{if(n===null)throw d0e();return n})}function ebe(t,e){const n=L0e(t._location.path,e),r=new Ii(t._location.bucket,n);return new Fu(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tbe(t){return/^[A-Za-z]+:\/\//.test(t)}function nbe(t,e){return new Fu(t,e)}function K8(t,e){if(t instanceof LP){const n=t;if(n._bucket==null)throw c0e();const r=new Fu(n,n._bucket);return e!=null?K8(r,e):r}else return e!==void 0?ebe(t,e):t}function rbe(t,e){if(e&&tbe(e)){if(t instanceof LP)return nbe(t,e);throw pT("To use ref(service, url), the first argument must be a Storage instance.")}else return K8(t,e)}function V4(t,e){const n=e==null?void 0:e[D8];return n==null?null:Ii.makeFromBucketSpec(n,t)}function sbe(t,e,n,r={}){t.host=`${e}:${n}`;const s=wc(e);s&&(K0(`https://${t.host}`),Y0("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:PB(i,t.app.options.projectId))}class LP{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=j8,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Qwe,this._maxUploadRetryTime=Zwe,this._requests=new Set,s!=null?this._bucket=Ii.makeFromBucketSpec(s,this._host):this._bucket=V4(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ii.makeFromBucketSpec(this._url,e):this._bucket=V4(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$4("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$4("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if($s(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Fu(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new m0e(M8());{const o=C0e(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const U4="@firebase/storage",B4="0.13.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y8="storage";function Xd(t,e,n){return t=zn(t),Q0e(t,e,n)}function Qd(t){return t=zn(t),Z0e(t)}function Zd(t,e){return t=zn(t),rbe(t,e)}function ibe(t=J0(),e){t=zn(t);const r=_g(t,Y8).getImmediate({identifier:e}),s=SN("storage");return s&&obe(r,...s),r}function obe(t,e,n,r={}){sbe(t,e,n,r)}function abe(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new LP(n,r,s,e,Hu)}function lbe(){tc(new Ma(Y8,abe,"PUBLIC").setMultipleInstances(!0)),Ki(U4,B4,""),Ki(U4,B4,"esm2017")}lbe();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cbe="type.googleapis.com/google.protobuf.Int64Value",ube="type.googleapis.com/google.protobuf.UInt64Value";function J8(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function Ew(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Ew(e));if(typeof t=="function"||typeof t=="object")return J8(t,e=>Ew(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Kh(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case cbe:case ube:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Kh(e)):typeof t=="function"||typeof t=="object"?J8(t,e=>Kh(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z4={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class si extends Po{constructor(e,n,r){super(`${FP}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,si.prototype)}}function dbe(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Cw(t,e){let n=dbe(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!z4[o])return new si("internal","internal");n=z4[o],r=o}const l=i.message;typeof l=="string"&&(r=l),s=i.details,s!==void 0&&(s=Kh(s))}}catch{}return n==="ok"?null:new si(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hbe{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,$s(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gT="us-central1",fbe=/^data: (.*?)(?:\n|$)/;function mbe(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new si("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class pbe{constructor(e,n,r,s,i=gT,o=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new hbe(e,n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=gT}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function gbe(t,e,n){const r=wc(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(K0(t.emulatorOrigin),Y0("Functions",!0))}function ybe(t,e,n){const r=s=>vbe(t,e,s,n||{});return r.stream=(s,i)=>bbe(t,e,s,i),r}async function xbe(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}async function X8(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function vbe(t,e,n,r){const s=t._url(e);return wbe(t,s,n,r)}async function wbe(t,e,n,r){n=Ew(n);const s={data:n},i=await X8(t,r),o=r.timeout||7e4,l=mbe(o),c=await Promise.race([xbe(e,s,i,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!c)throw new si("cancelled","Firebase Functions instance was deleted.");const u=Cw(c.status,c.json);if(u)throw u;if(!c.json)throw new si("internal","Response is not valid JSON object.");let d=c.json.data;if(typeof d>"u"&&(d=c.json.result),typeof d>"u")throw new si("internal","Response is missing data field.");return{data:Kh(d)}}function bbe(t,e,n,r){const s=t._url(e);return _be(t,s,n,r||{})}async function _be(t,e,n,r){var s;n=Ew(n);const i={data:n},o=await X8(t,r);o["Content-Type"]="application/json",o.Accept="text/event-stream";let l;try{l=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(i),headers:o,signal:r==null?void 0:r.signal})}catch(m){if(m instanceof Error&&m.name==="AbortError"){const x=new si("cancelled","Request was cancelled.");return{data:Promise.reject(x),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(x)}}}}}}const g=Cw(0,null);return{data:Promise.reject(g),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(g)}}}}}}let c,u;const d=new Promise((m,g)=>{c=m,u=g});(s=r==null?void 0:r.signal)===null||s===void 0||s.addEventListener("abort",()=>{const m=new si("cancelled","Request was cancelled.");u(m)});const h=l.body.getReader(),f=Sbe(h,c,u,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const m=f.getReader();return{async next(){const{value:g,done:x}=await m.read();return{value:g,done:x}},async return(){return await m.cancel(),{done:!0,value:void 0}}}}},data:d}}function Sbe(t,e,n,r){const s=(o,l)=>{const c=o.match(fbe);if(!c)return;const u=c[1];try{const d=JSON.parse(u);if("result"in d){e(Kh(d.result));return}if("message"in d){l.enqueue(Kh(d.message));return}if("error"in d){const h=Cw(0,d);l.error(h),n(h);return}}catch(d){if(d instanceof si){l.error(d),n(d);return}}},i=new TextDecoder;return new ReadableStream({start(o){let l="";return c();async function c(){if(r!=null&&r.aborted){const u=new si("cancelled","Request was cancelled");return o.error(u),n(u),Promise.resolve()}try{const{value:u,done:d}=await t.read();if(d){l.trim()&&s(l.trim(),o),o.close();return}if(r!=null&&r.aborted){const f=new si("cancelled","Request was cancelled");o.error(f),n(f),await t.cancel();return}l+=i.decode(u,{stream:!0});const h=l.split(`
`);l=h.pop()||"";for(const f of h)f.trim()&&s(f.trim(),o);return c()}catch(u){const d=u instanceof si?u:Cw(0,null);o.error(d),n(d)}}},cancel(){return t.cancel()}})}const G4="@firebase/functions",W4="0.12.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ebe="auth-internal",Cbe="app-check-internal",Tbe="messaging-internal";function Ibe(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(Ebe),o=n.getProvider(Tbe),l=n.getProvider(Cbe);return new pbe(s,i,o,l,r)};tc(new Ma(FP,e,"PUBLIC").setMultipleInstances(!0)),Ki(G4,W4,t),Ki(G4,W4,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sb(t=J0(),e=gT){const r=_g(zn(t),FP).getImmediate({identifier:e}),s=SN("functions");return s&&Nbe(r,...s),r}function Nbe(t,e,n){gbe(zn(t),e,n)}function gh(t,e,n){return ybe(zn(t),e,n)}Ibe();function Wl(t){return t?t.toLowerCase().replace(/\s+/g,"-"):""}const Pbe={apiKey:"AIzaSyB9eq6qMrLlISUUT4J81jKfkASAecDYxUY",authDomain:"freshauth-3d.firebaseapp.com",projectId:"freshauth-3d",storageBucket:"freshauth-3d.firebasestorage.app",messagingSenderId:"92054003296",appId:"1:92054003296:web:9b27de83304042a2ccad05"},Eb=LB(Pbe),Ym=pye(Eb),Q8=Dwe(Eb),eh=ibe(Eb),_S=Sb(Eb);try{Mwe(Q8,{cacheSizeBytes:jwe}).then(()=>{console.log("Firestore offline persistence enabled.")}).catch(t=>{t.code=="failed-precondition"?console.warn("Firestore offline persistence failed: Multiple tabs open or other precondition failed.",t):t.code=="unimplemented"?console.warn("Firestore offline persistence failed: Browser does not support required features.",t):console.error("Firestore offline persistence failed with error: ",t)})}catch(t){console.error("Error enabling Firestore offline persistence: ",t)}const Er=Q8;async function yT(t){if(!t||typeof t!="string"||t.trim()==="")return!1;const e=Wl(t.trim());try{const n=Vc(Er,"stores"),r=fT(n,mT("urlSlug","==",e),Hwe(1));return!(await Uc(r)).empty}catch(n){throw console.error("Error checking store name availability in Firestore:",n),new Error("Failed to check store name availability due to a database error.")}}const Z8=p.createContext(),Abe=({children:t})=>{const[e,n]=p.useState(null),[r,s]=p.useState(null),[i,o]=p.useState(null),[l,c]=p.useState(!0),[u,d]=p.useState(null);p.useEffect(()=>{let g=()=>{};const x=rge(Ym,async E=>{if(c(!0),n(E),s(E),g(),E){const v=vi(Er,"profiles",E.uid);g=Xwe(v,b=>{if(b.exists()){const S=b.data();o(S),d((S==null?void 0:S.role)||"store_owner"),console.log("AuthContext: Profile updated from snapshot:",S)}else console.warn("AuthContext: No profile found for user:",E.uid),o(null),d("store_owner");c(!1)},b=>{console.error("AuthContext: Error listening to profile:",b.message),o(null),d(null),c(!1)})}else o(null),d(null),c(!1)});return()=>{x(),g()}},[]);const m={user:e,session:r,profile:i,isAuthenticated:!!r&&!!e,userRole:u,loadingRole:l,logout:async()=>{try{await sge(Ym),console.log("User signed out successfully.")}catch(g){console.error("Error signing out: ",g)}},subscriptionStatus:"active"};return a.jsx(Z8.Provider,{value:m,children:t})},ro=()=>{const t=p.useContext(Z8);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},Oo=[{name:"Canvas",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/Canvas.jpeg?alt=media&token=bfcade71-3242-4fc1-a623-1779f4b4773c",category:"Wall Art"},{name:"Hat",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/Hat.jpeg?alt=media&token=e71e8dd0-2fc8-49ba-be13-98fd3909db3c",category:"Apparel"},{name:"Black hoodie",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/Hoodie.jpeg?alt=media&token=90fee73f-96f5-4372-9f15-44e44403adca",category:"Apparel"},{name:"Mug",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/Mug.png?alt=media&token=ff8dd2df-7dad-4ef7-8fa8-7867a6770dba",category:"Drinkware"},{name:"Notebook",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/Notebook.jpeg?alt=media&token=807b6222-96ad-4179-a11a-16406c4b4509",category:"Stationery"},{name:"Pillow",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/Pillow.webp?alt=media&token=50f5c317-8c39-4c48-b55c-d1da9216fa2e",category:"Home Decor"},{name:"Shirt",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/Shirt.webp?alt=media&token=7c5f9b2f-6161-4a01-b9eb-1ae7813f3d6c",category:"Apparel"},{name:"Totebag",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/Totebag.jpeg?alt=media&token=2d4dad9f-53d8-45b5-afce-5cef1a8e9f1c",category:"Accessories"},{name:"Travel mug",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/Travelmug.jpeg?alt=media&token=312cd2d7-add0-4180-8872-355ec15ed00e",category:"Drinkware"},{name:"Blanket",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/Bl.webp?alt=media&token=882cefc9-c725-40e7-a225-69f91d3ea2f6",category:"Home Decor"}],Tw=[{value:"fashion",label:"Fashion & Apparel"},{value:"electronics",label:"Electronics & Gadgets"},{value:"food",label:"Food & Beverage"},{value:"jewelry",label:"Jewelry & Accessories"},{value:"homedecor",label:"Home Decor & Furnishings"},{value:"beauty",label:"Beauty & Personal Care"},{value:"books",label:"Books & Media"},{value:"sports",label:"Sports & Outdoors"},{value:"toys",label:"Toys & Games"},{value:"art_collectibles",label:"Art & Collectibles"},{value:"general",label:"General Merchandise"}],eG=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{const c=s.toDataURL("image/png").split(",")[1];e({base64ImageData:c,mimeType:"image/png"})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed, possibly due to CORS or tainted canvas."))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),kbe="AIzaSyA6fvf0Xgb29MloJ-JKiYJGzhv_jvPdL1Y",Rbe=[{category:xr.HARM_CATEGORY_HARASSMENT,threshold:vr.BLOCK_MEDIUM_AND_ABOVE},{category:xr.HARM_CATEGORY_HATE_SPEECH,threshold:vr.BLOCK_MEDIUM_AND_ABOVE},{category:xr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:vr.BLOCK_MEDIUM_AND_ABOVE},{category:xr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:vr.BLOCK_MEDIUM_AND_ABOVE}],jbe=t=>{if(!t)return null;const e=t.split(",");if(e.length<2)return null;const n=e[0].match(/:(.*?);/);if(!n||n.length<2)return null;const r=n[1],s=atob(e[1]);let i=s.length;const o=new Uint8Array(i);for(;i--;)o[i]=s.charCodeAt(i);return new Blob([o],{type:r})};async function tG(t,e,n=null,r="image/png",s=[],i=(u,d)=>console.log(`ProductGen Progress: ${u}%, Message: ${d||""}`),o=0,l=5,c=""){if(!t||!e)throw new Error("Product type and store name are required to generate a product.");const u=new hr({apiKey:kbe});let d=`You are an expert product creator for e-commerce stores.
Generate a product for a store named "${e}" that sells ${t}.
The overall theme and request for the store is: "${c}". Use this full prompt to ensure the product aligns well with the user's vision.

The product should include:
1. A catchy title.
2. A brief description (15-25 words).
3. A realistic price (e.g., 29.99, 45.00).
4. Relevant product options/variants (e.g., for a shirt: Size [S, M, L, XL], Color [White, Black, Blue]; for a shoe: Size [8, 9, 10], Color [Red, Grey]). Generate 1 to 2 variant types, each with 2 to 5 option values. If no variants are typically applicable for the product type, return an empty array for "variants".
5. A visually appealing product image.

Return the text details (title, description, price, variants) as a single JSON object in the text part of your response.
Your entire text response MUST be ONLY longed JSON object. Do not include any other words, phrases, or conversational text before or after the JSON object.
The JSON object should strictly follow this format:
{
  "title": "Example Product Title",
  "description": "This is a fantastic example product, perfect for your needs and desires.",
  "price": "19.99",
  "variants": [
    { "name": "Size", "values": ["S", "M", "L", "XL"] },
    { "name": "Color", "values": ["White", "Black", "Blue"] }
  ]
}
Or, if no variants apply:
{
  "title": "Example Product Title",
  "description": "This is a fantastic example product, perfect for your needs and desires.",
  "price": "19.99",
  "variants": []
}


Generate an image for this product in the image part of your response.`,h=d;if(s&&s.length>0&&(h+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),n){let b=d;s&&s.length>0&&(b+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),n&&(b+=`

A logo image is also provided. Subtly incorporate this logo onto the product, its packaging, or in the scene if appropriate. For example, it could be a small brand mark on the item or a logo in the background if it's a lifestyle shot. Ensure the product remains the main focus.`),console.log(n?`[geminiProductGeneration Function] Generating product with logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`:`[geminiProductGeneration Function] Generating product without logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`)}else{let b=d;s&&s.length>0&&(b+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),console.log(`[geminiProductGeneration Function] Generating product without logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`)}let f=null,m=null,g="",x=0;const E=3;let v=[];for(;x<E;){x++,console.log(`[geminiProductGeneration Function] Attempt ${x} to generate content...`);const b=o+(x-1)/E*(l*.2);i(b,`Generating product (attempt ${x}/${E})...`);let S=d;s&&s.length>0&&(S+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),v.length>0&&(S+=`

ADDITIONALLY IMPORTANT: Avoid re-generating the following titles which were duplicates in previous attempts of THIS request: "${v.join('", "')}". Ensure the new title is truly novel and not similar to these.`),n&&(S+=`

A logo image is also provided. Subtly incorporate this logo onto the product, its packaging, or in the scene if appropriate. For example, it could be a small brand mark on the item or a logo in the background if it's a lifestyle shot. Ensure the product remains the main focus.`);const I=[{text:S}];if(n&&I.push({inlineData:{data:n,mimeType:r}}),x===1){const D=[...s,...v];console.log(`[geminiProductGeneration Function] Generating product for type: ${t}, store: ${e}. Initial exclusions (if any): ${D.join(", ")||"None"}. Logo: ${n?"Yes":"No"}`)}try{const D=await u.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:I,safetySettings:Rbe,config:{responseModalities:[Dn.TEXT,Dn.IMAGE]}});f=null,m=null;let k="";if(D.candidates&&D.candidates.length>0&&D.candidates[0].content&&D.candidates[0].content.parts)for(const C of D.candidates[0].content.parts)if(C.text){k+=C.text;try{const T=C.text.trim();let P=null;const A=T.match(/```json\s*([\s\S]*?)\s*```/);if(A&&A[1])P=A[1],console.log(`[geminiProductGeneration Function] Attempt ${x}: Found JSON in markdown block.`);else{const R=T.indexOf("{"),M=T.lastIndexOf("}");R!==-1&&M>R&&(P=T.substring(R,M+1),console.log(`[geminiProductGeneration Function] Attempt ${x}: Extracted potential JSON between first '{' and last '}'.`))}P?(f=JSON.parse(P),console.log(`[geminiProductGeneration Function] Attempt ${x}: Successfully parsed JSON.`)):C.text&&(C.text.includes("{")||C.text.includes("}"))?console.warn(`[geminiProductGeneration Function] Attempt ${x}: Text part contained braces but simple extraction failed. Text:`,C.text):C.text&&console.warn(`[geminiProductGeneration Function] Attempt ${x}: No JSON structure (markdown or simple braces) found in text part:`,C.text)}catch(T){console.warn(`[geminiProductGeneration Function] Attempt ${x}: Error parsing JSON. Attempted to parse: "${typeof jsonStringToParse=="string"?jsonStringToParse:"[jsonStringToParse was not a string or was null]"}". Original text from part:`,C.text,"Error:",T.message),f=null}}else C.inlineData&&C.inlineData.data&&(m=C.inlineData.data,console.log(`[geminiProductGeneration Function] Attempt ${x}: Image data found.`));if(g+=(g?`
---
Attempt `+x+`:
`:"Attempt "+x+`:
`)+k,f&&f.title){const C=f.title.toLowerCase();i(o+l*.8,`Validating product details for "${f.title}"...`);const T=s.some(A=>A.toLowerCase()===C),P=v.some(A=>A.toLowerCase()===C);if(T||P)console.warn(`[geminiProductGeneration Function] Attempt ${x}: Generated title "${f.title}" is a duplicate. Adding to exclusion list for next attempt.`),v.push(f.title),f=null;else if(!f.price||typeof f.price!="string"&&typeof f.price!="number"||String(f.price).trim()==="")console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" is unique, but price is missing or invalid. Price:`,f.price),f=null;else if(!f.variants||!Array.isArray(f.variants))console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" is unique and price is valid, but variants are missing or not an array. Variants:`,f.variants),f=null;else for(const A of f.variants)if(!A.name||typeof A.name!="string"||!Array.isArray(A.values)||!A.values.every(R=>typeof R=="string")){console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" has malformed variant entry. Variant:`,A),f=null;break}}if(f&&f.title&&(f.price||f.price===0)&&f.variants&&m){console.log(`[geminiProductGeneration Function] Successfully generated complete and unique product data (including variants) on attempt ${x}.`);break}else m||console.warn(`[geminiProductGeneration Function] Attempt ${x} missing image data.`),f?(f.title||console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing title.`),!f.price&&f.price!==0&&console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing price.`),f.variants||console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing variants or variants malformed.`)):console.warn(`[geminiProductGeneration Function] Attempt ${x} missing text details (or title was duplicate/price missing/variants malformed).`)}catch(D){console.error(`[geminiProductGeneration Function] Error during attempt ${x}:`,D.message,D.stack),g+=(g?`
---
`:"")+`Attempt ${x} Error: ${D.message}`}x>=E&&(!f||!m)&&console.error(`[geminiProductGeneration Function] Exhausted ${E} attempts. Product generation failed.`)}if(!f||!m){let b=`Failed to generate complete and unique product data after ${E} attempts. `;throw f||(b+="Text details (or unique title) missing. "),m||(b+="Image data missing. "),console.error(b,"Accumulated raw text responses:",g),new Error(b+`Last raw text (if any): ${g}`)}if(typeof f.title!="string"||typeof f.description!="string"||typeof f.price!="string"&&typeof f.price!="number"||!Array.isArray(f.variants)||!f.variants.every(b=>typeof b.name=="string"&&Array.isArray(b.values)&&b.values.every(S=>typeof S=="string")))throw console.error("[geminiProductGeneration Function] Parsed product details are not in the expected format:",f),new Error("AI response for product details was not in the expected format (title, description, price, variants).");if(f.price=String(f.price),console.log("[geminiProductGeneration Function] Successfully generated product details (including variants) and image data."),m){const b=`data:image/png;base64,${m}`,S=jbe(b);if(S){const I=tn(),k=`product_images_generated/${`${e.replace(/\s+/g,"_").toLowerCase()}_${f.title.replace(/\s+/g,"_").toLowerCase().substring(0,20)}_${I}.png`}`,C=Zd(eh,k);try{i(o+l*.9,`Uploading image for "${f.title}"...`),await Xd(C,S);const T=await Qd(C);return console.log(`[geminiProductGeneration Function] Image uploaded to Firebase Storage: ${T}`),i(o+l,`Product "${f.title}" generated successfully.`),{...f,images:[T]}}catch(T){throw console.error("[geminiProductGeneration Function] Error uploading image to Firebase Storage:",T),new Error(`Failed to upload generated image to Firebase Storage: ${T.message}`)}}else throw console.error("[geminiProductGeneration Function] Failed to convert base64 image data to Blob."),new Error("Failed to process generated image data for upload.")}else return i(o+l,`Product "${f.title}" generated (no image).`),{...f,images:[]}}const Dbe="AIzaSyA6fvf0Xgb29MloJ-JKiYJGzhv_jvPdL1Y",H4=new hr({apiKey:Dbe});async function nG(t,e,n,r=[],s=(l,c)=>console.log(`CollectionGen Progress: ${l}%, Message: ${c||""}`),i=0,o=5){const l=()=>{let h=[];return n&&n.length>0&&(h=n.map(f=>f.name).filter(f=>typeof f=="string"&&f.trim()!=="").slice(0,4)),h.length===0?{name:"Our Special Collection",description:"Discover a range of our finest products, specially selected for you.",imageData:null,product_ids:[],isPlaceholder:!0}:{name:`${t?t.charAt(0).toUpperCase()+t.slice(1):"Featured"} Selection`,description:`A curated selection of our popular ${t||"items"}. Explore customer favorites and top picks.`,imageData:null,product_ids:h,isPlaceholder:!0}},c=n&&n.length>0?n.map(h=>h.name).filter(h=>h).join(", "):"various items",u=r.length>0?`Do NOT use any of the following names: ${r.join(", ")}.`:"",d=`
    You are an AI assistant for an e-commerce store named "${e}" that sells "${t}".
    Based on the following products: ${c}, suggest a compelling and UNIQUE collection name and a short, engaging description (max 2 sentences) for a new collection.
    The collection should group related products or highlight a specific theme.
    ${u}
    Provide the output in a JSON format like this:
    {
      "name": "Collection Name",
      "description": "Collection Description",
      "product_names": ["Product Name 1", "Product Name 2"]
    }
    Ensure the collection name is concise, unique from the provided list (if any), and the description is appealing.
    The "product_names" array should contain a selection of 2 to 4 relevant product names from the provided product list that fit well within this new collection.
  `;s(i+o*.1,"Generating collection details...");try{const h=await H4.models.generateContent({model:"gemini-2.0-flash",contents:[{text:d}],config:{responseModalities:[Dn.TEXT]}});let f="";if(h&&h.candidates&&h.candidates.length>0&&h.candidates[0].content&&h.candidates[0].content.parts&&h.candidates[0].content.parts.length>0)for(const b of h.candidates[0].content.parts)b.text&&(f+=b.text);if(!f)return console.error("Gemini text generation did not return any text content. Full response:",h),console.warn("Returning fallback collection due to no text from AI."),l();let m;try{const b=f.match(/```json\n([\s\S]*?)\n```/);if(b&&b[1])m=JSON.parse(b[1]);else try{m=JSON.parse(f)}catch{console.warn("Failed to parse Gemini response as JSON directly, trying to extract from text:",f);const I=f.indexOf("{"),D=f.lastIndexOf("}");if(I!==-1&&D!==-1&&D>I){const k=f.substring(I,D+1);try{m=JSON.parse(k)}catch(C){throw console.error("Final attempt to parse extracted JSON failed:",k,C),C}}else throw new Error("No valid JSON structure found in response.")}}catch(b){return console.error("Failed to parse Gemini response as JSON:",f,b),console.warn("Returning fallback collection due to JSON parsing error."),l()}if(!m||!m.name||!m.description||!Array.isArray(m.product_names)||m.product_names.length===0)return console.error("AI did not return valid collection data (name, description, or non-empty product_names array):",m),console.warn("Returning fallback collection due to invalid/incomplete AI data."),s(i+o*.5,"Failed to get valid collection details."),l();s(i+o*.5,`Collection details "${m.name}" received.`);const g=b=>{if(typeof b!="string")return"";let S=b.toLowerCase();return S=S.replace(/\b(a|an|the)\b/g,""),S.endsWith("s")&&S.length>3&&(S=S.slice(0,-1)),S=S.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),S},x=[];m.product_names&&n&&m.product_names.forEach(b=>{const S=g(b);if(!S){console.warn(`AI product name "${b}" normalized to an empty string. Skipping.`);return}let I=null;I=n.find(D=>g(D.name)===S),I||(I=n.find(D=>{const k=g(D.name);return k.includes(S)||S.includes(k)})),I&&I.name?(x.push(I.name),console.log(`Matched AI product "${b}" (normalized: "${S}") to existing product "${I.name}" (using name as ID)`)):console.warn(`Product name "${b}" (normalized: "${S}") from AI response not found in provided product list or missing name after normalization and fallback search.`)});const E=`A vibrant and appealing e-commerce collection image for "${m.name}", described as "${m.description}", suitable for a store selling ${t}.`;let v=null;s(i+o*.6,`Generating image for collection "${m.name}"...`);try{const b=[{text:E}],S=await H4.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:b,config:{responseModalities:[Dn.TEXT,Dn.IMAGE]}});if(S&&S.candidates&&S.candidates.length>0&&S.candidates[0].content&&S.candidates[0].content.parts&&S.candidates[0].content.parts.length>0){for(const I of S.candidates[0].content.parts)if(I.inlineData&&I.inlineData.data){v=I.inlineData.data;break}}v?s(void 0,`Image generated for collection "${m.name}".`):(console.warn(`Gemini image generation did not return image data for collection: "${m.name}". Full Response:`,S),s(void 0,`Image generation failed for collection "${m.name}".`))}catch(b){console.error(`Error generating image for collection "${m.name}" with Gemini:`,b),s(void 0,`Error generating image for collection "${m.name}".`)}return s(i+o,`Collection "${m.name}" processing complete.`),{name:m.name,description:m.description,imageData:v,product_ids:x}}catch(h){return console.error("Error generating collection with Gemini:",h),console.warn("Returning fallback collection due to an unexpected error in generation process."),s(i+o,"Collection generation failed (unexpected error)."),l()}}const Mbe="2025-04",Cb=async(t,e,n,r={})=>{var l,c;if(!t||t==="your-shop-name.myshopify.com"||!e||e==="YOUR_SHOPIFY_STOREFRONT_ACCESS_TOKEN")throw new Error("Shopify domain or access token is not configured or is using placeholder values.");let s=t.trim().replace(/^(https?:\/\/)/,"").replace(/\/$/,"");s.includes(".")?!s.endsWith(".myshopify.com")&&s.includes("."):s=`${s}.myshopify.com`,s.includes(".")||(s=`${s}.myshopify.com`);let i=t.trim().replace(/^(https?:\/\/)/,"").replace(/\/$/,"");i.includes(".")||(i=`${i}.myshopify.com`);const o=`https://${i}/api/${Mbe}/graphql.json`;try{const u=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":e},body:JSON.stringify({query:n,variables:r})});if(!u.ok){let h;try{h=await u.json()}catch{}const f=((c=(l=h==null?void 0:h.errors)==null?void 0:l[0])==null?void 0:c.message)||`Shopify API request failed: ${u.status} ${u.statusText}`;throw console.error("Shopify API Error:",h||u.statusText),new Error(f)}const d=await u.json();if(d.errors)throw console.error("Shopify GraphQL Errors:",d.errors),new Error(d.errors.map(h=>h.message).join(", "));return d.data}catch(u){throw console.error("Error fetching from Shopify Storefront API:",u),u}},Lbe=`
  query GetShopMetadata {
    shop {
      name
      description 
      primaryDomain {
        host
        url
      }
      brand {
        logo {
          image { # Reverted to use image field
            url
            altText
          }
        }
        squareLogo { # Added, assuming similar structure
          image {
            url
            altText # Assuming altText is available, can be removed if not
          }
        }
        coverImage {
          image { # Reverted to use image field
            url
            altText
          }
        }
        slogan
        shortDescription # Added
        colors {
          primary {
            background
            foreground
          }
          secondary {
            background
            foreground
          }
        }
      }
    }
  }
`,Fbe=`
  query GetProducts($first: Int = 10, $cursor: String) {
    products(first: $first, after: $cursor) {
      edges {
        node {
          id
          title
          description # Changed from descriptionHtml
          handle
          tags
          images(first: 5) { # Changed from first: 1
            edges {
              node {
                url
                altText
              }
            }
          }
          variants(first: 5) { # Changed from first: 1
            edges {
              node {
                id # Added for variants
                title # Added for variants
                availableForSale # Added
                sku # Added from debug guide example
                price: priceV2 { # Changed from priceRange.minVariantPrice to priceV2, aliased to price
                    amount
                    currencyCode
                }
                image {
                   url
                   altText
                }
              }
            }
          }
        }
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
`,Obe=`
  query GetCollections($first: Int = 10, $cursor: String) {
    collections(first: $first, after: $cursor) {
      edges {
        node {
          id
          title
          description
          handle
          products(first: 5) { # Example: fetch first 5 products in each collection
            edges {
              node {
                id
                title
              }
            }
          }
        }
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
`,$be=`
  query GetLocalizationInfo @inContext(country: "US") { # Defaulting to US, can be parameterized
    localization {
      availableCountries {
        isoCode
        name
        currency {
          isoCode
          name
          symbol
        }
      }
      availableLanguages {
        isoCode
        name
        endonymName
      }
    }
  }
`,Yh=()=>["#3B82F6","#8B5CF6","#EC4899","#10B981","#F59E0B","#EF4444","#6366F1","#14B8A6","#F97316"][Math.floor(Math.random()*9)],OP=()=>["Inter","Roboto","Poppins","Montserrat","Open Sans"][Math.floor(Math.random()*5)],$P=()=>["grid","list"][Math.floor(Math.random()*2)],Vbe=async(t,e,n,r,{fetchPexelsImages:s=Xl,generateId:i=tn}={})=>{const o=[],l={fashion:{min:20,max:200},electronics:{min:50,max:1300},food:{min:5,max:50},jewelry:{min:100,max:1e3},general:{min:10,max:300}},c=l[t]||l.general,u={fashion:["Classic Tee","Urban Jeans","Silk Scarf","Leather Boots","Summer Dress","Knit Sweater"],electronics:["HD Webcam","Noise-Cancelling Buds","Smart Display","Gaming Pad","Portable Drive","VR Headset"],food:["Artisan Bread","Gourmet Cheese","Organic Berries","Craft Coffee","Spiced Nuts","Dark Chocolate Bar"],jewelry:["Pearl Necklace","Sapphire Ring","Gold Hoops","Charm Bracelet","Silver Cufflinks","Diamond Studs"],general:["Utility Tool","Desk Organizer","Travel Mug","Yoga Mat","Scented Candle","Board Game"]},h=[...u[t]||u.general].sort(()=>.5-Math.random()).slice(0,e),f=h.map(g=>`${t} ${g} product shot`),m=await s(f.join(";"),e,"square");for(let g=0;g<e;g++){const x=h[g],E=m[g];let v;if(E&&E.src&&E.src.medium&&r)try{console.log(`[generateAIProductsData] Overlaying logo on Pexels image: ${E.src.medium}`),v=await overlayLogoOnProductImage(E.src.medium,r)}catch(b){console.error(`[generateAIProductsData] Failed to overlay logo on ${E.src.medium}, using original.`,b),v=E.src.medium}else E&&E.src&&E.src.medium?v=E.src.medium:v=`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(x)}`;o.push({id:`product-ai-${i()}`,name:x,price:parseFloat((Math.random()*(c.max-c.min)+c.min).toFixed(2)),description:qre(t,x),rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,image:{id:E&&E.id||i(),src:{medium:v},alt:E&&E.alt||`Product image for ${x}`},storeName:n})}return o},Ube=async(t,{fetchPexelsImages:e=Xl,generateId:n=tn}={})=>{var S,I,D,k,C,T,P,A,R,M,j,z;const r=`store-wizard-${n()}`,{productType:s,storeName:i,logoUrl:o,products:l,prompt:c}=t;let u=[];(l.source==="ai"||l.source==="printOnDemand"||l.source==="manual")&&(u=l.items.map(W=>({id:W.id||`product-wizard-${n()}`,name:W.name,price:parseFloat(W.price)||0,description:W.description||"",images:W.images&&W.images.length>0?W.images:[`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(W.name||"Product")}`],image:{id:n(),src:{medium:W.images&&W.images.length>0?W.images[0]:`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(W.name||"Product")}`},alt:W.name||"Product Image"},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,isPrintOnDemand:W.isPrintOnDemand||!1,podDetails:W.podDetails||null,variants:W.variants||[]})));const d=3,h=await e(`${s} ${i} hero slideshow ${c}`,d,"landscape"),f=h.length>0?h[0]:{src:{large:"https://via.placeholder.com/1200x800.png?text=Hero+Image"},alt:"Placeholder Hero Image"},m=await Gc(`${s} ${i} store ambiance ${c}`,1,"landscape"),g=z1(s,i),x=await e(`${i} ${s} abstract background`,1,"landscape"),E=((I=(S=x[0])==null?void 0:S.src)==null?void 0:I.large)||((k=(D=x[0])==null?void 0:D.src)==null?void 0:k.original)||"",v="v1";let b={...g,heroSlideshowImages:h.map(W=>({src:W.src.large,alt:W.alt||i+" hero image"})),...((C=t.content)==null?void 0:C.hero)&&{heroTitle:t.content.hero.heroTitle||g.heroTitle,heroDescription:t.content.hero.heroDescription||g.heroDescription},...((T=t.content)==null?void 0:T.storeWay)&&{storeWay:t.content.storeWay},imageRightSection:null,videoLeftSection:null};if(t.template_version==="sharp"){u.slice(0,3).map($=>$.name).join(", ");const W={name:i,niche:s,description:c||`A ${s} store called ${i}`},q=await W3(W);if(q&&!q.error){const $=q.title||`${i} craftsmanship`,J=await e($,1,"landscape");b.imageRightSection={...q,imageUrl:((A=(P=J[0])==null?void 0:P.src)==null?void 0:A.large)||"https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}}const H=await H3(W);if(H&&!H.error){const $=H.title||`${i} product action`,J=await Gc($,1,"landscape");b.videoLeftSection={...H,videoUrl:((R=J[0])==null?void 0:R.url)||null,videoPosterUrl:((M=J[0])==null?void 0:M.image)||null}}}return{id:r,name:i,template_version:v,type:s,description:b.heroDescription||g.heroDescription,prompt:c||`A ${s} store called ${i}`,products:u,collections:t.collections.items.map(W=>({id:W.id||`collection-wizard-${n()}`,name:W.name,description:W.description,imageUrl:W.imageUrl,product_ids:W.product_ids||[]})),hero_image:f,content:b,hero_video_url:((j=m[0])==null?void 0:j.url)||null,hero_video_poster_url:((z=m[0])==null?void 0:z.image)||null,logo_url:t.logoUrlDark||t.logoUrlLight||`https://via.placeholder.com/100x100.png?text=${i.substring(0,1)}`,logo_url_light:t.logoUrlLight||null,logo_url_dark:t.logoUrlDark||null,theme:{primaryColor:Yh(),secondaryColor:Yh(),fontFamily:OP(),layout:$P()},data_source:"wizard",card_background_url:E}},Bbe=async(t,{storeNameOverride:e=null,nicheDetails:n=null,fetchPexelsImages:r=Xl,generateId:s=tn}={},i=(o,l)=>{console.log(`Progress: ${o}%, Message: ${l||"(no message)"}`)})=>{var we,Fe,Ze,ze,nt,qe,yt,Le,Ae,pt,mt,Ht,Ft,nn,Tn,gn;const o=(Qe,Be)=>{typeof Qe=="number"&&!isNaN(Qe)?i(Qe,Be):Be&&i(void 0,Be)};o(0,"Initializing store generation...");const l=`store-ai-${s()}`,c=t.toLowerCase().split(" ");let u="general";n&&n.name?u=n.name.toLowerCase().replace(/ /g,"-")||"general":c.some(Qe=>["clothing","fashion","apparel","wear"].includes(Qe))?u="fashion":c.some(Qe=>["tech","electronics","gadget","digital"].includes(Qe))?u="electronics":c.some(Qe=>["food","grocery","meal","organic"].includes(Qe))?u="food":c.some(Qe=>["jewelry","accessory","watch","luxury"].includes(Qe))&&(u="jewelry");let d=e,h=null;if(!d)try{h=await Moe(t),h&&(d=h,console.log(`[generateStoreFromPromptData] Extracted store name via Gemini Function Calling: "${d}" (Raw response: "${h}")`))}catch(Qe){console.error("[generateStoreFromPromptData] Error during Gemini function call for name extraction:",Qe)}if(!d)try{console.log(`[generateStoreFromPromptData] No name from override or function call. Attempting AI name suggestion using prompt: "${t}"`),o(void 0,"Suggesting store names...");const Qe=await U3(t);if(Qe&&Qe.suggestions&&Qe.suggestions.length>0)d=Qe.suggestions[0],console.log(`[generateStoreFromPromptData] AI generated store name: ${d}`);else{console.warn("[generateStoreFromPromptData] AI name generation yielded no suggestions. Falling back to heuristic.");const Be=t.split(" ").filter(ct=>ct.charAt(0)===ct.charAt(0).toUpperCase()&&ct.length>2);Be.length>0&&(d=Be[0])}}catch(Qe){console.error("[generateStoreFromPromptData] Error during AI store name generation:",Qe);const Be=t.split(" ").filter(ct=>ct.charAt(0)===ct.charAt(0).toUpperCase()&&ct.length>2);Be.length>0&&(d=Be[0])}d||(d=`${u.charAt(0).toUpperCase()+u.slice(1)} Emporium ${s().substring(0,4)}`,console.log(`[generateStoreFromPromptData] Using final fallback store name: ${d}`)),d&&d.length>50&&(d=d.substring(0,50));let f=null,m=null,g=null,x=`https://via.placeholder.com/100x100.png?text=${d.substring(0,1)}`;try{console.log(`[generateStoreFromPromptData] Generating logo for: ${d}`),o(5,`Generating logo for ${d}...`);const Qe=await ig(d,o);if(Qe){m=Qe.logoUrlLight,g=Qe.logoUrlDark,g?x=g:m&&(x=m);const Be=m||g;if(Be&&Be.startsWith("data:image/")){const ct=Be.split(",");ct.length===2&&(f=ct[1])}console.log(`[generateStoreFromPromptData] Logos generated for ${d}. Light: ${!!m}, Dark: ${!!g}`),i(20,`${d} logo generated.`)}else console.warn(`[generateStoreFromPromptData] Logo generation did not return expected result for ${d}.`),o(20,`Logo generation issue for ${d}.`)}catch(Qe){console.error(`[generateStoreFromPromptData] Error generating logo for ${d}:`,Qe),o(20,`Error generating logo for ${d}.`)}o(25,`Generating ${u} products...`);const E=[],v=[],b=6,S=b*2;let I=0;const D=25,k=45;for(console.log(`[generateStoreFromPromptData] Attempting to generate ${b} unique products for ${d} (type: ${u}).`);E.length<b&&I<S;){I++;const Qe=D+Math.floor(E.length/b*k);o(Qe,`Generating product ${E.length+1}/${b}...`);try{console.log(`[generateStoreFromPromptData] Generating product attempt ${I} (aiming for ${E.length+1}/${b} unique products)... Excluding titles: ${v.join(", ")}`);const Be=await tG(u,d,f,"image/png",v,o,Qe,k/b,t);if(Be&&Be.images&&Be.images.length>0&&Be.title&&Be.title.trim()!==""&&typeof Be.price=="string"&&typeof Be.description=="string"){const ct=Be.title.toLowerCase().trim();if(v.includes(ct))console.warn(`[generateStoreFromPromptData] Duplicate product title generated and skipped: "${Be.title}". Attempt ${I}/${S}.`);else{let he=Be.variants||[];if(u==="fashion"){const Ie=he.some(ne=>ne.name.toLowerCase()==="size"),ee=he.some(ne=>ne.name.toLowerCase()==="color");Ie||he.push({name:"Size",values:["S","M","L","XL"]}),ee||he.push({name:"Color",values:["White","Black","Blue","Red"]})}E.push({id:`product-gemini-${s()}`,name:Be.title,price:parseFloat(Be.price)||0,description:Be.description,images:Be.images,image:{id:s(),src:{medium:Be.images[0]},alt:Be.title},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,variants:he}),v.push(ct),console.log(`[generateStoreFromPromptData] Product "${Be.title}" generated successfully and is unique. (${E.length}/${b})`),o(D+Math.floor(E.length/b*k),`Product "${Be.title}" generated.`)}}else console.warn(`[generateStoreFromPromptData] Failed to generate complete data (or image) for product attempt ${I}. Data:`,Be)}catch(Be){console.error(`[generateStoreFromPromptData] Error during product generation attempt ${I}:`,Be)}}o(D+k,`${E.length} products generated.`),E.length<b&&console.warn(`[generateStoreFromPromptData] Could only generate ${E.length} unique products after ${S} total attempts.`),E.length===0&&b>0&&console.warn("[generateStoreFromPromptData] No products were generated successfully. The store will be created with an empty product list.");const C=70,T=20,P=3,A=await r(`${u} ${d} hero slideshow ${t}`,P,"landscape"),R=A.length>0?A[0]:{src:{large:"https://via.placeholder.com/1200x800.png?text=Hero+Image"},alt:"Placeholder Hero Image"},M=await Gc(`${u} ${d} store ambiance ${t}`,1,"landscape"),j=await Gc(`${d} ${u} product showcase`,1,"landscape");await Gc(`${d} ${u} craftsmanship process`,1,"landscape");const z={name:d,niche:u,description:t},W=await B3(z),q=await z3(z),H=await G3(z),$=z1(u,d),J=await r(`${d} ${u} store background`,1,"landscape"),O=((Fe=(we=J[0])==null?void 0:we.src)==null?void 0:Fe.large)||((ze=(Ze=J[0])==null?void 0:Ze.src)==null?void 0:ze.original)||"";let V="fresh";if(n&&n.templates&&n.templates.length>0){const Qe=n.templates.some(Be=>Be.toLowerCase()==="sharp");if(u==="technology"&&Qe)V="sharp";else{const Be=n.templates[0].toLowerCase();["classic","modern","v1"].includes(Be)?V="v1":Be==="premium"?V="premium":Be==="sharp"?V="sharp":Be==="sleek"&&(V="sleek")}}else t.toLowerCase().includes("modern")?V="v1":t.toLowerCase().includes("premium")?V="premium":t.toLowerCase().includes("sharp")?V="sharp":t.toLowerCase().includes("sleek")&&(V="sleek");V==="modern"&&(V="v1");let G={url:null,poster:null};if(V==="v2"){const Qe=await Gc(`${d} ${u} customer experience why choose us`,1,"landscape");G.url=((nt=Qe[0])==null?void 0:nt.url)||null,G.poster=((qe=Qe[0])==null?void 0:qe.image)||null}const F=[],ue=3,Ee=[];if(E.length>0){o(C,`Generating collections for products: ${v.slice(0,3).join(", ")}...`),console.log(`[generateStoreFromPromptData] Attempting to generate ${ue} collections for ${d}.`);for(let Qe=0;Qe<ue;Qe++){const Be=C+Math.floor((Qe+1)/ue*T);o(Be,`Generating collection ${Qe+1}/${ue}...`);try{console.log(`[generateStoreFromPromptData] Generating collection ${Qe+1}/${ue}...`);const ct=await nG(u,d,E,Ee,o,Be,T/ue);if(ct&&!ct.error&&ct.name){let he="";if(ct.imageData)he=`data:image/png;base64,${ct.imageData}`,console.log(`[generateStoreFromPromptData] Using Gemini-generated image for collection "${ct.name}".`);else{console.warn(`[generateStoreFromPromptData] Gemini image generation failed for collection "${ct.name}". Attempting Pexels fallback.`);const Ie=`${ct.name} ${u} collection banner`;try{const ee=await r(Ie,1,"landscape");ee&&ee.length>0&&((yt=ee[0].src)!=null&&yt.large)?(he=ee[0].src.large,console.log(`[generateStoreFromPromptData] Using Pexels fallback image for collection "${ct.name}": ${he}`)):(he=`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(ct.name||"Collection")}`,console.warn(`[generateStoreFromPromptData] Pexels fallback also failed for collection "${ct.name}". Using placeholder.`))}catch(ee){console.error(`[generateStoreFromPromptData] Error fetching Pexels image for collection "${ct.name}":`,ee),he=`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(ct.name||"Collection")}`}}F.push({id:`collection-gemini-${s()}`,name:ct.name,description:ct.description,imageUrl:he,product_ids:ct.product_ids||[]}),Ee.push(ct.name),console.log(`[generateStoreFromPromptData] Collection "${ct.name}" generated with ${((Le=ct.product_ids)==null?void 0:Le.length)||0} products.`),o(Be,`Collection "${ct.name}" generated.`)}else console.warn(`[generateStoreFromPromptData] Failed to generate complete data for collection ${Qe+1}. Error: ${ct==null?void 0:ct.error}`)}catch(ct){console.error(`[generateStoreFromPromptData] Error during collection generation attempt ${Qe+1}:`,ct)}}o(C+T,`${F.length} collections generated.`)}else console.warn(`[generateStoreFromPromptData] Skipping collection generation as no products were generated for ${d}.`),o(C+T,"Skipped collection generation (no products).");o(95,"Loading storefront...");let Se={id:l,name:d,template_version:V,type:u,description:W&&!W.error?W.heroDescription:$.heroDescription,prompt:t,products:E,collections:F,hero_image:R,hero_video_url:((Ae=M[0])==null?void 0:Ae.url)||null,hero_video_poster_url:((pt=M[0])==null?void 0:pt.image)||null,logo_url:x,logo_url_light:m,logo_url_dark:g,theme:{primaryColor:(n==null?void 0:n.primaryColor)||Yh(),secondaryColor:(n==null?void 0:n.secondaryColor)||Yh(),fontFamily:OP(),layout:$P()},content:{...$,...W&&!W.error&&{heroTitle:W.heroTitle||$.heroTitle,heroDescription:W.heroDescription||$.heroDescription},...q&&!q.error&&{storeWay:q},...H&&!H.error&&{storeFeatures:H},heroSlideshowImages:A.map(Qe=>({src:Qe.src.large,alt:Qe.alt||d+" hero image"})),imageRightSection:null,videoLeftSection:null},data_source:"ai",card_background_url:O};if(V==="sharp"){E.slice(0,3).map(ct=>ct.name).join(", ");const Qe=await W3(z);if(Qe&&!Qe.error){const ct=Qe.title||`${d} craftsmanship`,he=await r(ct,1,"landscape");Se.content.imageRightSection={...Qe,imageUrl:((Ht=(mt=he[0])==null?void 0:mt.src)==null?void 0:Ht.large)||"https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}}const Be=await H3(z);if(Be&&!Be.error){const ct=Be.title||`${d} product action`,he=await Gc(ct,1,"landscape");Se.content.videoLeftSection={...Be,videoUrl:((Ft=he[0])==null?void 0:Ft.url)||null,videoPosterUrl:((nn=he[0])==null?void 0:nn.image)||null}}Se.content.heroFollowUpVideoUrl=((Tn=j[0])==null?void 0:Tn.url)||null,Se.content.heroFollowUpVideoPosterUrl=((gn=j[0])==null?void 0:gn.image)||null}else V==="fresh"&&(Se.content.featuresVideoUrl=G.url,Se.content.featuresVideoPosterUrl=G.poster);return V!=="sharp"&&(Se.content.heroFollowUpVideoUrl=null,Se.content.heroFollowUpVideoPosterUrl=null),V!=="fresh"&&(Se.content.featuresVideoUrl=null,Se.content.featuresVideoPosterUrl=null),Se},zbe=async(t,e)=>(await Cb(t,e,Lbe)).shop,Gbe=async(t,e,n=10,r=null)=>(await Cb(t,e,Obe,{first:n,cursor:r})).collections,Wbe=async(t,e,n=10,r=null)=>(await Cb(t,e,Fbe,{first:n,cursor:r})).products,Hbe=async(t,e,n="US",r="EN")=>(await Cb(t,e,$be,{})).localization,qbe=async(t,e,n,{generateId:r=tn}={},s=null)=>{var d,h,f,m,g,x,E,v,b,S;console.log("Mapping BigCommerce Data:",{bcStoreSettings:t,bcProducts:e,domain:n,generatedLogoDataUrl:s});const i=e.map(I=>{var D,k,C,T,P,A,R;return{id:((D=I.entityId)==null?void 0:D.toString())||`bc-product-${r()}`,name:I.name||"Unnamed Product",description:I.description||`Product: ${I.name||"Unnamed Product"}`,price:parseFloat(((C=(k=I.prices)==null?void 0:k.price)==null?void 0:C.value)||0),currencyCode:((P=(T=I.prices)==null?void 0:T.price)==null?void 0:P.currencyCode)||"USD",image:{id:`bc-img-${r()}`,src:{medium:((A=I.defaultImage)==null?void 0:A.url)||`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(I.name||"Product")}`},alt:((R=I.defaultImage)==null?void 0:R.altText)||I.name||"Product Image"},sku:I.sku||"",rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*100)+10}}),o=s||((h=(d=t.logo)==null?void 0:d.image)==null?void 0:h.url)||`https://via.placeholder.com/100x100.png?text=${(t.storeName||"S").substring(0,1)}`,l=z1("general",t.storeName||"My BigCommerce Store"),c=await Xl(`${t.storeName||"store"} background`,1,"landscape"),u=((m=(f=c[0])==null?void 0:f.src)==null?void 0:m.large)||((x=(g=c[0])==null?void 0:g.src)==null?void 0:x.original)||"";return{id:`store-bc-${(t.storeHash||n).replace(/[\.\/\:]/g,"-")}-${r()}`,name:t.storeName||"My BigCommerce Store",type:"bigcommerce-imported",description:t.description||`Store imported from ${n}`||l.heroDescription,products:i,hero_image:{id:r(),src:{large:((v=(E=t.logo)==null?void 0:E.image)==null?void 0:v.url)||`https://via.placeholder.com/1200x800.png?text=${encodeURIComponent(t.storeName||"Store")}`},alt:((S=(b=t.logo)==null?void 0:b.image)==null?void 0:S.altText)||t.storeName||"Store Hero"},logo_url:o,theme:{primaryColor:Yh(),secondaryColor:Yh(),fontFamily:OP(),layout:$P()},content:{...l,heroTitle:`Welcome to ${t.storeName||"Our Store"}`,heroDescription:t.description||l.heroDescription},data_source:"bigcommerce",card_background_url:u}};async function Kbe(t,e){const n=`
    query StoreSettings {
      site {
        settings {
          storeName
          storeHash
          status
          logo {
            title
            image {
              url(width: 500)
              altText
            }
          }
        }
      }
    }
  `;if(typeof t!="string"||!t.trim()){const i=new TypeError("Invalid or empty storeDomain provided to fetchStoreSettings.");throw console.error(i.message,{storeDomain:t}),i}if(typeof e!="string"||!e.trim()){const i=new TypeError("Invalid or empty token provided to fetchStoreSettings.");throw console.error(i.message,{tokenProvided:typeof e=="string"&&e.length>0?"Yes":"No"}),i}const r=`https://${t}/graphql`,s={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:n})};console.log(`[fetchStoreSettings] Attempting to fetch: ${r}`,{domain:t,tokenProvided:!!e,queryLength:n.length});try{let i;try{i=await fetch(r,s)}catch(l){console.error(`[fetchStoreSettings] Initial fetch to ${r} failed:`,l);let c=`Initial fetch to ${r} failed.`;throw l.name==="TypeError"?c+=` This is often due to a CORS misconfiguration (check 'allowed_cors_origins' for your BigCommerce Storefront API token), a DNS issue, or the server not being reachable. Please check the browser's Network DevTools for more specific error messages. Original error: ${l.message}`:c+=` Error: ${l.message||"Unknown network error"}`,new Error(c)}if(console.log(`[fetchStoreSettings] Response from ${r} - Status: ${i.status}, Complexity: ${i.headers.get("X-Bc-GraphQL-Complexity")}`),!i.ok){let l=`Could not retrieve error body (status: ${i.status}).`;try{l=await i.text()}catch(c){console.warn("Failed to read error response body:",c)}throw new Error(`HTTP error ${i.status} for ${r}: ${l}`)}let o;try{o=await i.json()}catch(l){let c="Could not retrieve raw response text after JSON parse failure.";try{c=await(await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:n})})).text()}catch(u){console.warn("Failed to re-fetch for raw text:",u)}throw console.error("Failed to parse JSON response from BigCommerce.",l,{graphqlUrl:r,rawTextPreview:c.substring(0,500)}),new Error(`Failed to parse JSON response from ${r}. Preview: ${c.substring(0,200)}...`)}if(o.errors)throw console.error("BigCommerce GraphQL errors (fetchStoreSettings):",o.errors,{graphqlUrl:r}),new Error(`GraphQL error: ${o.errors.map(l=>l.message).join(", ")}`);if(!o.data||!o.data.site||!o.data.site.settings)throw console.error("Invalid data structure in BigCommerce response (fetchStoreSettings):",o.data,{graphqlUrl:r}),new Error("Invalid data structure received from BigCommerce API for store settings.");return o.data.site.settings}catch(i){throw i.message.startsWith("Invalid or empty storeDomain")||i.message.startsWith("Invalid or empty token")||i.message.startsWith("HTTP error")||i.message.startsWith("GraphQL error")||i.message.startsWith("Failed to parse JSON")||i.message.startsWith("Network error")||console.error(`[fetchStoreSettings] Unexpected error for ${r}:`,i.name,i.message,i.stack,i),i}}async function q4(t,e){var l,c;let n=[],r=null,s=!0;if(typeof t!="string"||!t.trim()){const u=new TypeError("Invalid or empty storeDomain provided to fetchAllProducts.");throw console.error(u.message,{storeDomain:t}),u}if(typeof e!="string"||!e.trim()){const u=new TypeError("Invalid or empty token provided to fetchAllProducts.");throw console.error(u.message,{tokenProvided:typeof e=="string"&&e.length>0?"Yes":"No"}),u}const i=`https://${t}/graphql`,o=`
    query ProductsPage($first: Int!, $after: String) {
      site {
        products(first: $first, after: $after) {
          pageInfo {
            hasNextPage
            endCursor
          }
          edges {
            node {
              entityId
              name
              sku
              defaultImage {
                url(width: 800)
                altText
              }
              prices {
                price { value currencyCode }
                retailPrice { value currencyCode }
              }
            }
          }
        }
      }
    }
  `;console.log(`[fetchAllProducts] Starting to fetch products from: ${i}`,{domain:t,tokenProvided:!!e});try{let u=1;for(;s;){const d={first:50,after:r},h={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:o,variables:d})};let f;try{f=await fetch(i,h)}catch(x){console.error(`[fetchAllProducts] Initial fetch (Page ${u}) to ${i} failed:`,x);let E=`Initial fetch (Page ${u}) to ${i} failed.`;throw x.name==="TypeError"?E+=` This is often due to a CORS misconfiguration (check 'allowed_cors_origins' for your BigCommerce Storefront API token), a DNS issue, or the server not being reachable. Please check the browser's Network DevTools for more specific error messages. Original error: ${x.message}`:E+=` Error: ${x.message||"Unknown network error"}`,new Error(E)}if(console.log(`[fetchAllProducts] Response (Page ${u}) from ${i} - Status: ${f.status}, Complexity: ${f.headers.get("X-Bc-GraphQL-Complexity")}`),u++,!f.ok){let x=`Could not retrieve error body (status: ${f.status}).`;try{x=await f.text()}catch(E){console.warn("[fetchAllProducts] Failed to read error response body:",E)}throw new Error(`HTTP error ${f.status} for ${i} (products): ${x}`)}let m;try{m=await f.json()}catch(x){let E="Could not retrieve raw response text after JSON parse failure (fetchAllProducts).";try{E=await(await fetch(i,h)).text()}catch{}throw console.error("[fetchAllProducts] Failed to parse JSON response from BigCommerce.",x,{graphqlUrl:i,rawTextPreview:E.substring(0,500)}),new Error(`Failed to parse JSON response from ${i} (products). Preview: ${E.substring(0,200)}...`)}if(m.errors)throw console.error("[fetchAllProducts] BigCommerce GraphQL errors:",m.errors,{graphqlUrl:i}),new Error(`GraphQL error (products): ${m.errors.map(x=>x.message).join(", ")}`);const g=(c=(l=m.data)==null?void 0:l.site)==null?void 0:c.products;if(!g||!g.edges||!g.pageInfo)throw console.error("[fetchAllProducts] Invalid data structure in BigCommerce response:",m.data,{graphqlUrl:i}),new Error("Invalid data structure received from BigCommerce API for products.");g.edges.forEach(x=>n.push(x.node)),s=g.pageInfo.hasNextPage,r=g.pageInfo.endCursor}return n}catch(u){throw u.message.startsWith("Invalid or empty storeDomain")||u.message.startsWith("Invalid or empty token")||u.message.startsWith("HTTP error")||u.message.startsWith("GraphQL error")||u.message.startsWith("Failed to parse JSON")||u.message.startsWith("Network error")||console.error(`[fetchAllProducts] Unexpected error for ${i}:`,u.name,u.message,u.stack,u),u}}const We=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:Et("rounded-xl border bg-card text-card-foreground shadow-sm",t),...e}));We.displayName="Card";const ot=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:Et("flex flex-col space-y-1.5 p-6",t),...e}));ot.displayName="CardHeader";const at=ht.forwardRef(({className:t,...e},n)=>a.jsx("h3",{ref:n,className:Et("text-2xl font-semibold leading-none tracking-tight",t),...e}));at.displayName="CardTitle";const qt=ht.forwardRef(({className:t,...e},n)=>a.jsx("p",{ref:n,className:Et("text-sm text-muted-foreground",t),...e}));qt.displayName="CardDescription";const tt=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:Et("p-6 pt-0",t),...e}));tt.displayName="CardContent";const Yu=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:Et("flex items-center p-6 pt-0",t),...e}));Yu.displayName="CardFooter";const Ybe=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),Jbe=({isOpen:t,onClose:e,products:n,onFinalize:r})=>{const[s,i]=p.useState([]),[o,l]=p.useState(!1),[c,u]=p.useState({}),[d,h]=p.useState(null),[f,m]=p.useState(!1),{toast:g}=Ks(),{generatePodCollectionFromDesign:x,addPendingPodCollectionData:E,isGeneratingPodCollection:v,currentStore:b}=Fn();p.useEffect(()=>{n&&i(n.map(H=>{var J,O;let $=[];return Array.isArray(H.images)?$=[...H.images]:(O=(J=H.image)==null?void 0:J.src)!=null&&O.medium&&($=[H.image.src.medium]),{...H,images:$,variants:Array.isArray(H.variants)?H.variants.map(V=>({...V,values:Array.isArray(V.values)?[...V.values]:[]})):[]}}))},[n]);const S=(H,$,J)=>{i(O=>{const V=[...O];return V[H]={...V[H],[$]:J},V})},I=async(H,$)=>{if($)try{const J=await Ybe($);i(O=>{const V=[...O],G=Array.isArray(V[H].images)?V[H].images:[];return V[H].images=[...G,J],V})}catch(J){console.error("Error converting file to base64:",J),g({title:"Image Upload Error",description:"Could not process image.",variant:"destructive"})}},D=(H,$)=>{i(J=>{const O=[...J];return O[H].images=O[H].images.filter((V,G)=>G!==$),O})},k=async H=>{g({title:"Image Generation",description:"AI Image generation for this product is not yet implemented in this modal."}),console.log("Attempting to generate image for product at index:",H,s[H].name)},C=async H=>{const $=s[H];if(!$||!$.name){g({title:"Missing Product Info",description:"Product name is required to generate visuals.",variant:"destructive"});return}const J=$.images&&$.images.length>0?$.images[0]:null;if(!J){g({title:"Missing Base Image",description:"At least one image is required to generate more visuals.",variant:"destructive"});return}u(O=>({...O,[H]:!0}));try{const{base64ImageData:O,mimeType:V}=await eG(J),G=$.name;let F=[];try{const Ee=await hI(O,V,G);Ee&&Ee.length>0&&F.push(...Ee.slice(0,2)),g({title:"Angles Generated",description:`${Math.min(2,(Ee==null?void 0:Ee.length)||0)} angle images generated.`,variant:"success"})}catch(Ee){console.error("Error generating angles:",Ee),g({title:"Angle Generation Failed",description:Ee.message,variant:"destructive"})}const ue=[`Place this product, "${G}", in a realistic home setting where it might be used or displayed. Focus on a natural context.`,`Show this product, "${G}", in an outdoor lifestyle setting, highlighting its use case or appeal.`];for(const Ee of ue)try{const Se=await Ql(O,V,Ee);Se&&Se.editedImageData&&F.push(`data:${Se.newMimeType};base64,${Se.editedImageData}`)}catch(Se){console.error(`Error generating context image with prompt "${Ee}":`,Se),g({title:"Context Image Failed",description:`Failed for: ${Ee.substring(0,30)}...`,variant:"destructive"})}g({title:"Context Images Attempted",description:`Attempted to generate ${ue.length} context images.`,variant:"success"}),F.length>0?(i(Ee=>{const Se=[...Ee],we=Array.isArray(Se[H].images)?Se[H].images:[];return Se[H].images=[...we,...F],Se}),g({title:"Visuals Added",description:`${F.length} new images added to the product.`,variant:"success"})):g({title:"No New Visuals",description:"Could not generate additional visuals.",variant:"default"})}catch(O){console.error("Error in handleGenerateMoreVisuals:",O),g({title:"Visual Generation Error",description:O.message,variant:"destructive"})}finally{u(O=>({...O,[H]:!1}))}},T=(H,$,J)=>{i(O=>{const V=[...O],G={...V[H]};return G.variants=[...G.variants||[]],G.variants[$]={...G.variants[$],name:J},V[H]=G,V})},P=(H,$,J,O)=>{i(V=>{const G=[...V],F={...G[H]};F.variants=[...F.variants||[]];const ue={...F.variants[$]};return ue.values=[...ue.values||[]],ue.values[J]=O,F.variants[$]=ue,G[H]=F,G})},A=(H,$)=>{i(J=>{const O=[...J],V={...O[H]};V.variants=[...V.variants||[]];const G={...V.variants[$]};return G.values=[...G.values||[],""],V.variants[$]=G,O[H]=V,O})},R=(H,$,J)=>{i(O=>{const V=[...O],G={...V[H]};G.variants=[...G.variants||[]];const F={...G.variants[$]};return F.values=(F.values||[]).filter((ue,Ee)=>Ee!==J),G.variants[$]=F,V[H]=G,V})},M=H=>{i($=>{const J=[...$],O={...J[H]};return O.variants=[...O.variants||[],{name:"",values:[""]}],J[H]=O,J})},j=(H,$)=>{i(J=>{const O=[...J],V={...O[H]};return V.variants=(V.variants||[]).filter((G,F)=>F!==$),O[H]=V,O})},z=()=>{if(l(!0),!s.every($=>$.name&&$.name.trim()!==""&&($.price||$.price===0)&&String($.price).trim()!=="")){g({title:"Missing Information",description:"Please ensure all products have a name and a valid price.",variant:"destructive"}),l(!1);return}r(s),l(!1)},W=H=>{h(H),m(!0)},q=async H=>{var F;const $=s[H];if(!$||!((F=$.podDetails)!=null&&F.originalDesignImageUrl)){g({title:"Error",description:"Product details or original design image missing for POD collection.",variant:"destructive"});return}const J=$.podDetails.originalDesignImageUrl,O=$.podDetails.designPrompt||`Design based on ${$.name}`,V=$.podDetails.baseProductName||$.name,G=await x(J,O,V);G&&G.newProducts&&G.newCollection?E({newProducts:G.newProducts,newCollection:G.newCollection}):console.error("POD Collection generation in modal failed or returned no data.")};return t?a.jsxs(a.Fragment,{children:[a.jsx(Ps,{open:t,onOpenChange:H=>!H&&e(),children:a.jsxs(ls,{className:"max-w-3xl",children:[a.jsxs(cs,{children:[a.jsx(us,{children:"Finalize Your Products"}),a.jsx(No,{children:"Review and edit the AI-generated products before creating your store."})]}),a.jsx(Zi,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"space-y-6 pr-4",children:s.map((H,$)=>{var J;return a.jsxs(We,{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:`productName-${$}`,children:"Product Name"}),a.jsx(st,{id:`productName-${$}`,value:H.name,onChange:O=>S($,"name",O.target.value),placeholder:"Product Name"})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:`productPrice-${$}`,children:"Price (USD)"}),a.jsx(st,{id:`productPrice-${$}`,type:"number",value:H.price,onChange:O=>S($,"price",O.target.value),placeholder:"0.00"})]})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:`productDescription-${$}`,children:"Description"}),a.jsx(Vn,{id:`productDescription-${$}`,value:H.description,onChange:O=>S($,"description",O.target.value),placeholder:"Product Description",rows:3})]}),a.jsxs("div",{className:"space-y-2 mb-[3px]",children:[a.jsx(je,{children:"Product Images"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(H.images||[]).map((O,V)=>a.jsxs("div",{className:"relative group w-24 h-24 cursor-pointer",onClick:()=>W(O),children:[a.jsx("img",{src:O,alt:`Product ${$+1} image ${V+1}`,className:"w-full h-full object-contain rounded-md border"}),a.jsx(U,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>D($,V),children:a.jsx(sr,{className:"h-3 w-3"})})]},V))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(U,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`productImageUpload-${$}`).click(),children:[a.jsx(Jo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsx(st,{id:`productImageUpload-${$}`,type:"file",accept:"image/*",className:"hidden",onChange:O=>I($,O.target.files[0])}),a.jsxs(U,{type:"button",variant:"outline",size:"sm",onClick:()=>k($),disabled:o||!H.name,children:[o?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(is,{className:"mr-2 h-4 w-4"}),"Generate Image"]}),a.jsxs(U,{type:"button",variant:"outline",size:"sm",onClick:()=>C($),disabled:o||c[$]||!H.name||!H.images||H.images.length===0,children:[c[$]?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(is,{className:"mr-2 h-4 w-4"}),"More Angles/Context"]})]}),H.isPrintOnDemand&&((J=H.podDetails)==null?void 0:J.originalDesignImageUrl)&&a.jsxs(U,{type:"button",variant:"outline",size:"sm",className:"mt-2 w-full",onClick:()=>q($),disabled:o||c[$]||v,children:[v&&c[$]!==!0?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(eie,{className:"mr-2 h-4 w-4"}),"Create Full POD Collection"]})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(H.variants||[]).map((O,V)=>a.jsxs(We,{className:"p-2 space-y-2 bg-muted/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(je,{htmlFor:`variantName-${$}-${V}`,className:"text-xs",children:"Option Name"}),a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>j($,V),className:"h-6 w-6",children:a.jsx(sr,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(st,{id:`variantName-${$}-${V}`,value:O.name||"",onChange:G=>T($,V,G.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(je,{className:"text-xs",children:"Option Values (comma-separated or add one by one)"}),(O.values||[]).map((G,F)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(st,{value:G||"",onChange:ue=>P($,V,F,ue.target.value),placeholder:"e.g., Red",className:"text-sm h-8"}),a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>R($,V,F),className:"h-6 w-6",children:a.jsx(sr,{className:"h-3 w-3 text-destructive"})})]},F)),a.jsxs(U,{variant:"outline",size:"sm",onClick:()=>A($,V),className:"text-xs h-7",children:[a.jsx(go,{className:"mr-1 h-3 w-3"})," Add Value"]})]},V)),a.jsxs(U,{variant:"outline",onClick:()=>M($),className:"w-full text-sm h-8",children:[a.jsx(go,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]},H.id||$)})})}),a.jsxs(jr,{children:[a.jsx(ja,{asChild:!0,children:a.jsx(U,{type:"button",variant:"outline",onClick:e,children:"Cancel"})}),a.jsxs(U,{type:"button",onClick:z,disabled:o,children:[o?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Finalize and Create Store"]})]})]})}),f&&d&&a.jsx(Ps,{open:f,onOpenChange:m,children:a.jsxs(ls,{className:"max-w-xl max-h-[80vh]",children:[a.jsxs(cs,{children:[a.jsx(us,{children:"Enlarged Image"}),a.jsx(ja,{asChild:!0,children:a.jsxs(U,{variant:"ghost",size:"icon",className:"absolute top-4 right-4",onClick:()=>m(!1),children:[a.jsx(go,{className:"h-4 w-4 rotate-45"})," "]})})]}),a.jsx("div",{className:"flex justify-center items-center p-4",children:a.jsx("img",{src:d,alt:"Enlarged product",className:"max-w-full max-h-[70vh] object-contain"})})]})})]}):null},Sr="/placeholder-image.png",rG=p.createContext(null),Fn=()=>{const t=p.useContext(rG);if(!t)throw new Error("useStore must be used within a StoreProvider");return t},K4="ecommerce-cart",Xbe=({children:t})=>{const[e,n]=p.useState([]),[r,s]=p.useState(null),[i,o]=p.useState(!1),[l,c]=p.useState(0),[u,d]=p.useState(""),[h,f]=p.useState(!1),[m,g]=p.useState([]),[x,E]=p.useState("published"),{toast:v}=Ks(),b=di(),{user:S,session:I,profile:D}=ro(),k=se=>{se==="published"||se==="edit"?E(se):(console.warn(`Invalid view mode: ${se}. Defaulting to 'published'.`),E("published"))},[C,T]=p.useState(0),[P,A]=p.useState(""),[R,M]=p.useState(""),[j,z]=p.useState(null),[W,q]=p.useState({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[H,$]=p.useState({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[J,O]=p.useState(null),[V,G]=p.useState(!1),[F,ue]=p.useState(null),[Ee,Se]=p.useState(null),[we,Fe]=p.useState(!1),[Ze,ze]=p.useState(null),[nt,qe]=p.useState(null),[yt,Le]=p.useState(!1),[Ae,pt]=p.useState(!1),[mt,Ht]=p.useState(!1),[Ft,nn]=p.useState([]),[Tn,gn]=p.useState(null),[Qe,Be]=p.useState(!1),ct=p.useCallback(({newProducts:se,newCollection:de})=>{nn(ae=>[...ae,...se]),gn(ae=>({...ae,collections:[...(ae==null?void 0:ae.collections)||[],de]})),v({title:"POD Items Added",description:`${se.length} products and 1 collection are ready for finalization.`,variant:"success"})},[nn,gn,v]),[he,Ie]=p.useState(0),[ee,ne]=p.useState(""),[X,me]=p.useState(""),[ye,De]=p.useState(null),[Oe,re]=p.useState({items:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[pe,Me]=p.useState(!1),[ve,gt]=p.useState(null),wt=async(se,de)=>{if(!se||!de)return console.error("Missing base64 string or path for Firebase Storage upload."),null;const ae=se.split(",")[1];if(!ae)return console.error("Invalid base64 string provided for upload."),null;const ge=Zd(eh,de),Ne={contentType:"image/png"};try{const $e=atob(ae),_e=new Array($e.length);for(let Ye=0;Ye<$e.length;Ye++)_e[Ye]=$e.charCodeAt(Ye);const Je=new Uint8Array(_e),Nt=await Xd(ge,Je,Ne),Ut=await Qd(Nt.ref);return console.log(`Uploaded ${de} to Firebase Storage. URL: ${Ut}`),Ut}catch($e){throw console.error(`Error uploading ${de} to Firebase Storage:`,$e),$e}},dt=se=>se?se.map(de=>{const ae={...de};if(ae.logo_url&&ae.logo_url.startsWith("data:image/")&&ae.logo_url.length>2048&&(ae.logo_url=`${ae.logo_url.substring(0,30)}...[truncated]`),ae.hero_image&&ae.hero_image.src){const ge={...ae.hero_image.src};ge.large&&ge.large.startsWith("data:image/")&&ge.large.length>2048&&(ge.large=`${ge.large.substring(0,30)}...[truncated]`),ge.medium&&ge.medium.startsWith("data:image/")&&ge.medium.length>2048&&(ge.medium=`${ge.medium.substring(0,30)}...[truncated]`),ae.hero_image={...ae.hero_image,src:ge}}return ae.products&&Array.isArray(ae.products)&&(ae.products=ae.products.map(ge=>{const Ne={...ge};if(Ne.image&&Ne.image.src){const $e={...Ne.image.src};$e.medium&&$e.medium.startsWith("data:image/")&&$e.medium.length>2048&&($e.medium=`${$e.medium.substring(0,30)}...[truncated]`),$e.large&&$e.large.startsWith("data:image/")&&$e.large.length>2048&&($e.large=`${$e.large.substring(0,30)}...[truncated]`),Ne.image={...Ne.image,src:$e}}return Ne})),ae}):[],xt=p.useCallback(async se=>{f(!0),console.log(`[StoreContext] loadStores called for userId: ${se||"Guest"}`);let de=[],ae=[];const ge=localStorage.getItem("ecommerce-stores");if(ge)try{de=JSON.parse(ge),console.log(`[StoreContext] Loaded ${de.length} stores from localStorage.`)}catch(Ne){console.error("[StoreContext] Failed to parse localStorage stores:",Ne),v({title:"Local Cache Error",description:"Failed to load stores from local cache.",variant:"warning"}),de=[]}if(n(de),se){console.log(`[StoreContext] Fetching cloud stores for userId: ${se}`);try{const $e=Vc(Er,"stores"),_e=fT($e,mT("merchant_id","==",se)),Je=await Uc(_e);if(Je.empty)console.log("[StoreContext] No cloud stores found for this user.");else{console.log(`[StoreContext] Fetched ${Je.size} stores from Firestore. Processing details...`);const Nt=Je.docs.map(Ye=>({id:Ye.id,...Ye.data()}));ae=await Promise.all(Nt.map(async Ye=>{var Ot,fr;try{const Rt=Vc(Er,"stores",Ye.id,"products"),Br=(await Uc(Rt)).docs.map(ln=>({id:ln.id,...ln.data()})).map(ln=>{let pn={src:{large:"",medium:""}};return ln.images&&Array.isArray(ln.images)&&ln.images.length>0&&(pn.src.large=ln.images[0],pn.src.medium=ln.images[0]),{...ln,price:ln.priceAmount,image:pn,variants:ln.variants||[]}}),js={...Ye,createdAt:((fr=(Ot=Ye.created_at)==null?void 0:Ot.toDate())==null?void 0:fr.toISOString())||new Date().toISOString()};let rn=[];const Jr=Vc(Er,"stores",Ye.id,"collections"),Xr=(await Uc(Jr)).docs.map(ln=>({id:ln.id,...ln.data()}));return Xr&&Xr.length>0&&(rn=await Promise.all(Xr.map(async ln=>{let pn=[];return ln.product_ids&&ln.product_ids.length>0&&(pn=Br.filter(Yn=>ln.product_ids.includes(Yn.id))),{...ln,image:{src:ln.image_url||""},products:pn}}))),{...js,products:Br,collections:rn}}catch(Rt){return console.error(`[StoreContext] Critical error processing details for store ${Ye.id}:`,Rt),{...Ye,products:[],collections:[]}}})),console.log(`[StoreContext] Finished processing details for ${ae.length} cloud stores.`)}}catch($e){console.error("[StoreContext] Overall critical error in fetching cloud stores:",$e),v({title:"Cloud Loading Error",description:"A critical error occurred while fetching cloud store data.",variant:"destructive"})}const Ne=[...de];ae.forEach($e=>{const _e=Ne.findIndex(Je=>Je.id===$e.id);_e>-1?Ne[_e]=$e:Ne.push($e)}),Ne.sort(($e,_e)=>new Date(_e.createdAt||_e.created_at)-new Date($e.createdAt||$e.created_at)),n(Ne);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dt(Ne))),console.log("[StoreContext] Updated localStorage with merged stores.")}catch($e){console.error("[StoreContext] Failed to save merged stores to localStorage:",$e),v({title:"Local Cache Update Failed",description:"Could not update the local cache after cloud sync.",variant:"warning",duration:7e3})}}else console.log("[StoreContext] No user logged in. Displaying local stores only.");f(!1),console.log(`[StoreContext] loadStores finished. isLoadingStores: false. Final stores count: ${e.length}`)},[v,Er,dt]),At=p.useCallback(async(se,de)=>{var Ne,$e;const ae=e.find(_e=>_e.id===se);if(!ae){console.warn(`[StoreContext] updateStore: Store with ID ${se} not found in current state.`),v({title:"Update Failed",description:"Store not found for update.",variant:"destructive"});return}const ge={...ae,...de};if(console.log(`[StoreContext] updateStore: updatedLocalStore for store ${se} - Products: ${((Ne=ge.products)==null?void 0:Ne.length)||0}, Collections: ${(($e=ge.collections)==null?void 0:$e.length)||0}`),n(_e=>{const Je=_e.map(Nt=>Nt.id===se?ge:Nt);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dt(Je))),console.log(`[StoreContext] updateStore: Saved ${Je.length} stores to localStorage.`)}catch(Nt){console.error("Failed to save stores to localStorage during update:",Nt),v({title:"Local Cache Update Failed",description:"Could not update the local cache for the store.",variant:"warning",duration:7e3})}return Je}),r&&r.id===se&&(s(ge),console.log(`[StoreContext] updateStore: currentStore updated for store ${se}.`)),v({title:"Store Updated (Locally)",description:"Changes saved locally."}),S){f(!0);try{const{settings:_e,products:Je,collections:Nt,user_id:Ut,...Ye}=de,Ot=vi(Er,"stores",se);await Ky(Ot,Ye),console.log(`Store ${se} synced to Firestore asynchronously.`)}catch(_e){console.error("Unexpected error during async Firestore updateStore:",_e),v({title:"Cloud Sync Error",description:"An unexpected error occurred during cloud sync.",variant:"destructive"})}finally{f(!1)}}},[e,S,v,r,s,n,f,dt]),Nn=p.useCallback(async(se,de)=>{if(!r||!r.id){v({title:"Error",description:"No current store selected to update.",variant:"destructive"});return}if(typeof se!="string"||se.trim()===""){v({title:"Error",description:"Invalid identifier for text content.",variant:"destructive"});return}const ae=r.id,ge=typeof r.content=="object"&&r.content!==null?r.content:{};let Ne=JSON.parse(JSON.stringify(ge));const $e=se.split(".");let _e=Ne;for(let Je=0;Je<$e.length-1;Je++){const Nt=$e[Je];(!_e[Nt]||typeof _e[Nt]!="object")&&(_e[Nt]={}),_e=_e[Nt]}_e[$e[$e.length-1]]=de,await At(ae,{content:Ne})},[r,At,v]);p.useEffect(()=>{localStorage.setItem(K4,JSON.stringify(m))},[m]),p.useEffect(()=>{const se=localStorage.getItem(K4);if(se)try{g(JSON.parse(se))}catch(de){console.error("Failed to parse stored cart:",de)}},[]);const on=async se=>{let de={...se};const ae=de.name||`Store-${tn().substring(0,6)}`;de.name||(de.name=ae);const ge=await _r(ae);if(!ge.available){const Rt=ge.error===!0?`Failed to verify store name "${ae}". Please try again.`:`The store name "${ae}" or a similar URL is already in use. Please choose a different name.`;throw v({title:"Store Name Unavailable",description:Rt,variant:"destructive"}),new Error(Rt)}de.urlSlug=ge.slug,de.template_version||(de.template_version="v1");const Ne=de.id||tn(),$e={...de,id:Ne,createdAt:new Date().toISOString()};let _e=$e.products||[];const Je=new Map;let Nt=[];if(_e=_e.map(Rt=>({...Rt,id:Rt.id||tn()})),_e.forEach(Rt=>{Je.set(Rt.name,Rt.id)}),S&&S.uid)try{const{id:Rt,settings:_n,products:Yr,collections:Br,user_id:js,...rn}=$e,Jr=vi(Er,"stores",Rt);let Qt=rn.logo_url;if(Qt&&Qt.startsWith("data:image/"))try{const ln=`store_logos/${Rt}/logo_${tn()}.png`;Qt=await wt(Qt,ln)}catch(ln){console.error("Error uploading store logo to Firebase Storage:",ln),v({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),Qt=Sr}else Qt||(Qt=Sr);const Xr={...rn,merchant_id:S.uid,created_at:new Date,logo_url:Qt||Sr,urlSlug:$e.urlSlug};if(await qm(Jr,Xr),console.log(`Store ${Rt} saved to Firestore asynchronously.`),$e.products&&$e.products.length>0){const ln=[];for(const pn of $e.products){let Yn=[];if(pn.images&&Array.isArray(pn.images))for(const Ds of pn.images)if(Ds.startsWith("data:image/"))try{const zr=`store_products/${Rt}/${pn.id||tn()}/${tn()}.png`,so=await wt(Ds,zr);so?Yn.push(so):Yn.push(Sr)}catch(zr){console.error(`Error uploading product image for ${pn.name}:`,zr),v({title:"Product Image Upload Failed",description:`Could not upload image for ${pn.name}.`,variant:"warning"}),Yn.push(Sr)}else Ds?Yn.push(Ds):Yn.push(Sr);Yn.length===0&&Yn.push(Sr);const Xa={store_id:Rt,name:pn.name||`Product ${tn().substring(0,8)}`,description:pn.description||"No description available.",images:Yn,priceAmount:Number(pn.price)>=0?Number(pn.price):0,currency:"usd",variants:pn.variants||[],created_at:new Date},Ao=vi(Er,"stores",Rt,"products",pn.id||tn());ln.push(qm(Ao,Xa)),Je.set(pn.name,Ao.id)}await Promise.all(ln)}if($e.collections&&$e.collections.length>0){const ln=[];for(const pn of $e.collections){let Yn=pn.imageUrl;if(Yn&&Yn.startsWith("data:image/"))try{const zr=`store_collections/${Rt}/${pn.id||tn()}/${tn()}.png`;Yn=await wt(Yn,zr)}catch(zr){console.error("Error uploading collection image to Firebase Storage:",zr),v({title:"Collection Image Upload Failed",description:"Could not upload collection image.",variant:"warning"}),Yn=Sr}else Yn||(Yn=Sr);const Xa=(pn.product_ids||[]).map(zr=>Je.get(zr)).filter(Boolean),Ao={store_id:Rt,name:pn.name,description:pn.description,image_url:Yn||Sr,product_ids:Xa,created_at:new Date},Ds=vi(Er,"stores",Rt,"collections",pn.id||tn());ln.push(qm(Ds,Ao)),Nt.push({id:Ds.id,...Ao})}await Promise.all(ln)}}catch(Rt){console.error("Overall async Firestore store creation error. Code:",Rt.code,"Message:",Rt.message,"Full Error:",Rt),setTimeout(()=>{v({title:"Cloud Sync Error",description:`Firestore error (${Rt.code||"Unknown Code"}): ${Rt.message}`,variant:"destructive"})},0)}else S&&!S.uid&&(console.error("Firestore save skipped: User object is present but user.uid is undefined."),setTimeout(()=>{v({title:"User UID Missing",description:"Cannot save to cloud: User UID is missing. Please try logging out and back in.",variant:"destructive"})},0));let Ut=[];const Ye=$e.collections||[],Ot=_e.map(Rt=>{const _n=Array.isArray(Rt.images)&&Rt.images.length>0?Rt.images[0]:Sr;return{...Rt,image:{src:{medium:_n,large:_n}}}});Ye.length>0&&(Ut=Ye.map(Rt=>{let _n={};if(S&&Nt&&Nt.length>0){const js=Nt.find(rn=>rn.name===Rt.name);js&&(_n=js)}let Yr=[];Rt.product_ids&&Rt.product_ids.length>0&&Rt.product_ids.forEach(js=>{const rn=Je.get(js);let Jr=null;rn?(Jr=Ot.find(Qt=>Qt.id===rn),Jr||js!==rn&&(Jr=Ot.find(Qt=>Qt.id===js))):Jr=Ot.find(Qt=>Qt.id===js),Jr&&Yr.push(Jr)});const Br=(_n==null?void 0:_n.image_url)||Rt.imageUrl||"";return{...Rt,..._n,image:{src:Br},products:Yr}}));const fr={...$e,products:Ot,collections:Ut};return n(Rt=>{const _n=[fr,...Rt.filter(Yr=>Yr.id!==fr.id)];try{localStorage.setItem("ecommerce-stores",JSON.stringify(dt(_n)))}catch(Yr){console.error("Failed to save stores to localStorage during store creation:",Yr),v({title:"Local Cache Update Failed",description:"Could not update the local cache after creating the store.",variant:"warning",duration:7e3})}return _n}),s(fr),fr},_r=async se=>{if(!se||typeof se!="string"||se.trim()==="")return{available:!0,slug:"",error:"Name cannot be empty."};const de=Wl(se.trim());if(!de)return{available:!0,slug:"",error:"Invalid name for URL generation."};try{const ae=Vc(Er,"stores"),ge=fT(ae,mT("urlSlug","==",de));return{available:(await Uc(ge)).empty,slug:de}}catch(ae){return console.error("Error checking store name availability:",ae),v({title:"Name Check Failed",description:"Could not verify store name uniqueness.",variant:"destructive"}),{available:!1,slug:de,error:!0}}},Gn=async se=>{var de,ae;o(!0),c(0),d("Initializing wizard-based store generation...");try{const ge=await Ube(se,{fetchPexelsImages:Xl,generateId:tn}),Ne=await on(ge);return c(100),d("Store generation complete!"),Ne}catch(ge){return console.error("Error generating store from wizard:",ge),!((de=ge.message)!=null&&de.includes("already in use"))&&!((ae=ge.message)!=null&&ae.includes("Failed to verify store name"))&&v({title:"Wizard Generation Failed",description:ge.message||"Failed to generate store.",variant:"destructive"}),c(0),d("Generation failed."),null}finally{o(!1)}},Jt=async(se,de=null,ae=null,ge=[])=>{o(!0),c(0),d("Initializing generation...");try{let $e=await Bbe(se,{storeNameOverride:de,productTypeOverride:ae,fetchPexelsImages:Xl,generateId:tn},(Je,Nt)=>{c(Je),Nt&&d(Nt)}),_e=$e.products||[];return ge&&ge.length>0&&(_e=[...ge,..._e],$e={...$e,products:_e}),nn(_e),gn($e),Ht(!0),d("Products generated. Please review and finalize."),c(90),null}catch(Ne){return console.error("Error generating store from prompt:",Ne),Ne.message&&Ne.message.toLowerCase().includes("name taken")?v({title:"Store Name Taken",description:Ne.message,variant:"destructive"}):v({title:"Generation Failed",description:Ne.message||"Failed to generate store.",variant:"destructive"}),c(0),d("Generation failed."),null}finally{o(!1)}},an=async(se,de,ae,ge=null)=>{if(!se)return v({title:"Error",description:"Missing design image for POD collection generation.",variant:"destructive"}),null;if(ge===null)console.log("Generating POD collection data for pre-finalization stage.");else{if(!ge)return v({title:"Error",description:"Store ID is invalid for updating POD collection.",variant:"destructive"}),null;console.log(`Generating POD collection for existing store: ${ge}`)}Be(!0),v({title:"Generating POD Collection",description:"Applying design to all mockups..."});let Ne=[],$e=`Collection from ${ae} Design`;try{const{base64ImageData:_e,mimeType:Je}=await eG(se);for(const Ut of Oo){if(Ut.name===ae){console.log(`Skipping visualization for base product: ${ae}`);continue}console.log(`Visualizing design on mockup: ${Ut.name}`);const Ye=await og(_e,Je,Ut.imageUrl,de||`Product based on ${ae} design`,Ut.name);if(Ye&&Ye.visualizedImageData&&Ye.productDetails){const Ot=`data:${Ye.visualizedImageMimeType};base64,${Ye.visualizedImageData}`;Ne.push({id:tn(),name:Ye.productDetails.title,price:parseFloat(Ye.productDetails.price),description:Ye.productDetails.description,images:[Ot],isPrintOnDemand:!0,podDetails:{originalDesignImageUrl:se,designPrompt:de,baseProductName:Ut.name,baseProductImageUrl:Ut.imageUrl},variants:Ye.productDetails.variants||[]})}else console.warn(`Failed to visualize design on ${Ut.name} for collection. Error: ${Ye==null?void 0:Ye.error}`)}if(Ne.length===0)return v({title:"Collection Generation Incomplete",description:"Could not create any new products for the collection.",variant:"warning"}),null;const Nt={id:tn(),name:$e,description:`A collection of products featuring the design from ${ae}. Original design prompt: ${de||"N/A"}`,imageUrl:Ne[0].images[0]||Sr,product_ids:Ne.map(Ut=>Ut.id)};if(ge||(Nt.products=[...Ne]),ge){const Ut=e.find(fr=>fr.id===ge);if(!Ut)throw new Error("Store not found to add the new collection.");const Ye=[...Ut.products||[],...Ne],Ot=[...Ut.collections||[],Nt];return await At(ge,{products:Ye,collections:Ot}),v({title:"POD Collection Created",description:`Collection "${$e}" with ${Ne.length} products added to store.`,variant:"success"}),{success:!0}}else return v({title:"POD Items Generated",description:`${Ne.length} products and 1 collection ready.`,variant:"info"}),{newProducts:Ne,newCollection:Nt}}catch(_e){return console.error("Error generating POD collection from design:",_e),v({title:"POD Collection Error",description:_e.message,variant:"destructive"}),null}finally{Be(!1)}},Mn=p.useCallback(()=>{T(0),A(""),M(""),z(null),q({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),$({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),O(null),G(!1),ue(null),Se(null),Fe(!1),ze(null)},[]),K=p.useCallback(async(se,de)=>{A(se),M(de),G(!0),ue(null),z(null);try{v({title:"Connecting to Shopify...",description:"Fetching store information."});const ae=await zbe(se,de);if(!ae)throw new Error("Failed to fetch Shopify store metadata. The store might not exist or the token might be invalid.");return z(ae),T(2),!0}catch(ae){return console.error("Error starting Shopify import wizard (fetching metadata):",ae),ue(ae.message||"Failed to connect to Shopify and fetch store information."),v({title:"Connection Failed",description:ae.message||"Could not fetch store information.",variant:"destructive"}),!1}finally{G(!1)}},[v,A,M,G,ue,z,T]),te=p.useCallback(()=>{Ie(0),ne(""),me(""),De(null),re({items:[],pageInfo:{hasNextPage:!1,endCursor:null}}),Me(!1),gt(null)},[]),ce=p.useCallback(async(se,de)=>{const ae=se||ee,ge=de||X;if(!ae||!ge){gt("Domain or token missing for fetching BigCommerce settings.");return}G(!0),gt(null);try{const Ne=await Kbe(ae,ge);De(Ne)}catch(Ne){console.error("Error fetching BigCommerce settings for wizard:",Ne),gt(Ne.message||"Failed to fetch store settings."),v({title:"BigCommerce Settings Fetch Failed",description:Ne.message,variant:"destructive"})}finally{Me(!1)}},[ee,X,v,gt,De,Me]),ke=p.useCallback(async(se,de)=>{ne(se),me(de),Ie(2),await ce(se,de)},[ne,me,Ie,ce]),Ve=p.useCallback(async(se=10)=>{if(!ee||!X){gt("Domain or token missing for fetching BigCommerce products.");return}Me(!0),gt(null);try{const de=`
      query ProductsPreview($first: Int!) {
        site {
          products(first: $first) {
            edges {
              node {
                entityId name sku defaultImage { url(width: 200) altText }
                prices { price { value currencyCode } }
              }
            }
          }
        }
      }
    `,ae={first:se},Ne=await(await fetch(`https://${ee}/graphql`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${X}`},body:JSON.stringify({query:de,variables:ae})})).json();if(Ne.errors)throw new Error(Ne.errors.map($e=>$e.message).join(", "));re({items:Ne.data.site.products.edges.map($e=>$e.node),pageInfo:{hasNextPage:!1,endCursor:null}})}catch(de){console.error("Error fetching BigCommerce products for wizard:",de),gt(de.message||"Failed to fetch products."),v({title:"BigCommerce Product Fetch Failed",description:de.message,variant:"destructive"})}finally{Me(!1)}},[ee,X,v,gt,re,Me]),Y=p.useCallback(async()=>{if(!ye||!ee||!X)return v({title:"Import Error",description:"Missing BigCommerce data to finalize import.",variant:"destructive"}),!1;o(!0),gt(null);try{const se=await q4(ee,X),de=qbe(ye,se,ee,{generateId:tn},null);return await on(de)?(te(),!0):!1}catch(se){return console.error("Error finalizing BigCommerce import from wizard:",se),gt(se.message||"Failed to finalize BigCommerce import."),v({title:"BigCommerce Import Failed",description:se.message,variant:"destructive"}),!1}finally{o(!1)}},[ye,ee,X,on,te,v,o,gt,q4]),Z=p.useCallback(async(se=10,de=null)=>{if(!P||!R){ue("Domain or token missing for fetching products.");return}G(!0),ue(null);try{const ae=await Wbe(P,R,se,de);q(ge=>({edges:de?[...ge.edges,...ae.edges]:ae.edges,pageInfo:ae.pageInfo}))}catch(ae){console.error("Error fetching Shopify products for wizard:",ae),ue(ae.message||"Failed to fetch products."),v({title:"Product Fetch Failed",description:ae.message,variant:"destructive"})}finally{G(!1)}},[P,R,v,ue,q,G]),oe=p.useCallback(async(se=10,de=null)=>{if(!P||!R){ue("Domain or token missing for fetching collections.");return}G(!0),ue(null);try{const ae=await Gbe(P,R,se,de);$(ge=>({edges:de?[...ge.edges,...ae.edges]:ae.edges,pageInfo:ae.pageInfo}))}catch(ae){console.error("Error fetching Shopify collections for wizard:",ae),ue(ae.message||"Failed to fetch collections."),v({title:"Collection Fetch Failed",description:ae.message,variant:"destructive"})}finally{G(!1)}},[P,R,v,ue,$,G]),be=p.useCallback(async(se="US",de="EN")=>{if(!P||!R){ue("Domain or token missing for fetching localization.");return}G(!0),ue(null);try{const ae=await Hbe(P,R,se,de);O(ae)}catch(ae){console.error("Error fetching Shopify localization for wizard:",ae),ue(ae.message||"Failed to fetch localization info."),v({title:"Localization Info Fetch Failed",description:ae.message,variant:"default"})}finally{G(!1)}},[P,R,v,ue,O,G]),Ce=p.useCallback(async()=>{if(console.log("[StoreContext] Attempting to generate Shopify store logo..."),!j||!j.name){console.warn("[StoreContext] Cannot generate logo: Shopify preview metadata or store name is missing.",j),ze("Store name is not available to generate a logo."),v({title:"Logo Generation Error",description:"Store name missing. Ensure Shopify store details were fetched correctly.",variant:"destructive"});return}const se=j.name;console.log(`[StoreContext] Generating logo for store name: "${se}"`),Fe(!0),ze(null),Se(null);try{console.log("[StoreContext] Calling generateLogoWithGemini...");const{imageData:de,textResponse:ae}=await ig(se);if(console.log("[StoreContext] generateLogoWithGemini response:",{imageData:de?"imageData received (see next log)":"no imageData",textResponse:ae}),de)console.log("[StoreContext] imageData (first 50 chars):",de.substring(0,50)),Se(`data:image/png;base64,${de}`),v({title:"Logo Generated!",description:"A new logo has been generated successfully."}),console.log("[StoreContext] Logo generated and state updated.");else throw console.error("[StoreContext] generateLogoWithGemini returned no imageData. Text response:",ae),new Error(ae||"Gemini did not return image data.")}catch(de){console.error("[StoreContext] Error during Shopify store logo generation:",de.message,de.stack),ze(de.message||"Failed to generate logo."),v({title:"Logo Generation Failed",description:`Error: ${de.message}`,variant:"destructive"})}finally{Fe(!1),console.log("[StoreContext] Finished logo generation attempt.")}},[j,v,ze,Fe,Se]),Q=p.useCallback(async()=>{var se,de,ae,ge,Ne,$e,_e,Je,Nt,Ut,Ye,Ot,fr,Rt;if(!j||!P||!R)return v({title:"Import Error",description:"Missing essential Shopify data to finalize import.",variant:"destructive"}),!1;o(!0),ue(null);try{const _n=W.edges.map(Qt=>Qt.node),Yr=H.edges.map(Qt=>Qt.node);let Br=`Create a store named '${j.name}'.`;j.description&&(Br+=` The store's description is: "${j.description}".`),(se=j.brand)!=null&&se.slogan&&(Br+=` Slogan: "${j.brand.slogan}".`),_n.length>0&&(Br+=` It sells products like ${_n.slice(0,3).map(Qt=>Qt.title).join(", ")}.`),Yr.length>0&&(Br+=` Key collections include ${Yr.slice(0,2).map(Qt=>Qt.title).join(", ")}.`),(ge=(ae=(de=j.brand)==null?void 0:de.colors)==null?void 0:ae.primary)!=null&&ge.background&&(Br+=` The primary brand color is ${j.brand.colors.primary.background}.`),(_e=($e=(Ne=j.brand)==null?void 0:Ne.colors)==null?void 0:$e.secondary)!=null&&_e.background&&(Br+=` The secondary brand color is ${j.brand.colors.secondary.background}.`);const js=_n.map(Qt=>{var Xr,ln,pn,Yn,Xa,Ao;return{name:Qt.title,price:((Yn=(pn=(ln=(Xr=Qt.variants)==null?void 0:Xr.edges[0])==null?void 0:ln.node)==null?void 0:pn.price)==null?void 0:Yn.amount)||"0",description:Qt.descriptionHtml?Qt.descriptionHtml.replace(/<[^>]*>?/gm,""):Qt.description||"",images:((Xa=Qt.images)==null?void 0:Xa.edges.map(Ds=>Ds.node.url))||[],variants:((Ao=Qt.variants)==null?void 0:Ao.edges.map(Ds=>{var zr;return{id:Ds.node.id,title:Ds.node.title,price:((zr=Ds.node.price)==null?void 0:zr.amount)||"0"}}))||[]}}),rn=Yr.map(Qt=>{var Xr,ln;return{name:Qt.title,description:Qt.descriptionHtml?Qt.descriptionHtml.replace(/<[^>]*>?/gm,""):Qt.description||"",imageUrl:((Xr=Qt.image)==null?void 0:Xr.url)||"",product_ids:((ln=Qt.products)==null?void 0:ln.edges.map(pn=>pn.node.id))||[]}}),Jr={name:j.name,prompt:Br,logoUrl:Ee||((Ut=(Nt=(Je=j==null?void 0:j.brand)==null?void 0:Je.logo)==null?void 0:Nt.image)==null?void 0:Ut.url)||((fr=(Ot=(Ye=j==null?void 0:j.brand)==null?void 0:Ye.squareLogo)==null?void 0:Ot.image)==null?void 0:fr.url),products:js,collections:rn,brandColors:(Rt=j.brand)==null?void 0:Rt.colors};return qe(Jr),Le(!0),Mn(),T(4),pt(!0),v({title:"Import Successful",description:"Store data imported. Proceed to configure and generate your store.",duration:5e3}),!0}catch(_n){return console.error("Error preparing data for StoreGenerator from Shopify import:",_n),ue(_n.message||"Failed to process Shopify data for generator."),v({title:"Import Processing Failed",description:_n.message||"Could not prepare imported data.",variant:"destructive"}),!1}finally{o(!1)}},[j,P,R,W,H,Ee,on,Mn,T,pt,qe,Le,v,o,ue]),fe=p.useCallback(()=>{qe(null),Le(!1)},[]),Re=p.useCallback(se=>{const de=e.find(ae=>ae.id===se);return de?{...de}:null},[e]),et=p.useCallback(se=>{const de=e.find(ae=>Wl(ae.name)===se);return de?{...de}:null},[e]),it=p.useCallback((se,de)=>{const ae=Re(se),ge=ae==null?void 0:ae.products.find(Ne=>Ne.id===de);return ge?{...ge}:null},[Re]),Te=async(se,de)=>{if(!S){v({title:"Authentication Required",description:"Please log in to set a pass key.",variant:"destructive"});return}f(!0);try{const ae=vi(Er,"stores",se);await Ky(ae,{pass_key:de}),n(ge=>{const Ne=ge.map($e=>$e.id===se?{...$e,pass_key:de}:$e);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dt(Ne)))}catch($e){console.error("Failed to save stores to localStorage after pass key update:",$e),v({title:"Local Cache Update Failed",description:"Could not update the local cache after pass key update.",variant:"warning",duration:7e3})}return Ne}),r&&r.id===se&&s(ge=>ge?{...ge,pass_key:de}:null),v({title:"Store Pass Key Set",description:"The pass key for the store has been updated."})}catch(ae){console.error("Unexpected error in updateStorePassKey:",ae),v({title:"Pass Key Update Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{f(!1)}},ft=async(se,de)=>{if(!S){v({title:"Authentication Required",description:"Please log in to assign a manager.",variant:"destructive"});return}if(!se||!de){v({title:"Missing Information",description:"Store ID and Manager Email are required.",variant:"destructive"});return}f(!0);try{console.warn("Assign Store Manager functionality needs to be migrated to a Firebase Cloud Function or direct Firestore logic."),v({title:"Manager Assignment (Placeholder)",description:"Functionality needs Firebase Cloud Function implementation.",variant:"info"}),v({title:"Store Manager Assigned",description:`Manager ${de} assigned to store.`})}catch(ae){console.error("Unexpected error in assignStoreManager:",ae),v({title:"Manager Assignment Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{f(!1)}},Ct=async(se,de,ae)=>{if(!S){v({title:"Authentication Required",description:"Please log in to update product images.",variant:"destructive"});return}const ge=e.find(_e=>_e.id===se);if(!ge){console.warn(`[StoreContext] updateProductImage: Store with ID ${se} not found.`),v({title:"Update Failed",description:"Store not found for updating product image.",variant:"destructive"});return}let Ne=ae.src.large;if(Ne&&Ne.startsWith("data:image/"))try{const _e=`store_products/${se}/${de}/image_${tn()}.png`,Je=await wt(Ne,_e);Je?Ne=Je:(Ne=Ne.startsWith("data:image/")?Sr:Ne,v({title:"Image Upload Failed",description:"Could not upload new product image. Using placeholder or existing.",variant:"warning"}))}catch(_e){console.error(`Error uploading new product image for ${de}:`,_e),v({title:"Image Upload Failed",description:"Could not upload new product image.",variant:"destructive"}),Ne=Sr}else Ne||(Ne=Sr);const $e=ge.products.map(_e=>_e.id===de?{..._e,image:{..._e.image,src:{large:Ne,medium:Ne}},images:_e.images?[..._e.images.filter(Je=>Je!==_e.image.src.large),Ne]:[Ne]}:_e);try{const _e=vi(Er,"stores",se,"products",de);await Ky(_e,{images:$e.find(Je=>Je.id===de).images,image:{src:{large:Ne,medium:Ne}}}),v({title:"Product Image Updated",description:"The product image has been changed."})}catch(_e){console.error("Error updating product image in Firestore:",_e),v({title:"Cloud Sync Failed",description:`Failed to save product image to cloud: ${_e.message}`,variant:"destructive"});return}n(_e=>{const Je=_e.map(Nt=>Nt.id===se?{...Nt,products:$e}:Nt);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dt(Je)))}catch(Nt){console.error("Failed to save stores to localStorage during product image update:",Nt),v({title:"Local Cache Update Failed",description:"Could not update the local cache for product image.",variant:"warning",duration:7e3})}return Je}),r&&r.id===se&&s(_e=>_e?{..._e,products:$e}:null)},mn=async se=>{if(!S){v({title:"Authentication Required",description:"Please log in to delete a store.",variant:"destructive"});return}const de=[...e];n(ae=>{const ge=ae.filter(Ne=>Ne.id!==se);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dt(ge)))}catch(Ne){console.error("Failed to save stores to localStorage during optimistic delete:",Ne),v({title:"Local Cache Update Issue",description:"Could not update the local cache during store deletion. Cloud operation will proceed.",variant:"warning",duration:7e3})}return ge}),r&&r.id===se&&s(null);try{const ae=Vc(Er,"stores",se,"products"),ge=await Uc(ae),Ne=[];for(const Ut of ge.docs)Ne.push(vS(vi(Er,"stores",se,"products",Ut.id)));await Promise.all(Ne),console.log(`Deleted ${ge.size} products for store ${se}.`);const $e=Vc(Er,"stores",se,"collections"),_e=await Uc($e),Je=[];for(const Ut of _e.docs)Je.push(vS(vi(Er,"stores",se,"collections",Ut.id)));await Promise.all(Je),console.log(`Deleted ${_e.size} collections for store ${se}.`);const Nt=vi(Er,"stores",se);await vS(Nt),console.log(`Store ${se} deleted from Firestore.`),v({title:"Store Deleted",description:"Your store has been deleted."})}catch(ae){console.error("Error deleting store from Firestore:",ae),v({title:"Deletion Failed",description:ae.message,variant:"destructive"}),n(de);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dt(de)))}catch(ge){console.error("Failed to save stores to localStorage during delete rollback:",ge),v({title:"Local Cache Revert Failed",description:"Could not revert local cache changes after a failed deletion.",variant:"error",duration:8e3})}de.find(ge=>ge.id===se)&&s(de.find(ge=>ge.id===se)||null);return}},xn=async(se,de,ae)=>{if(!S){v({title:"Authentication Required",description:"Please log in to update product images.",variant:"destructive"});return}const ge=e.find(Je=>Je.id===se);if(!ge){console.warn(`[StoreContext] updateProductImagesArray: Store with ID ${se} not found.`),v({title:"Update Failed",description:"Store not found for updating product images.",variant:"destructive"});return}let Ne=!1,$e=[];for(const Je of ae)if(typeof Je=="string"&&Je.startsWith("data:image/"))try{const Nt=`store_products/${se}/${de}/gallery_${tn()}.png`,Ut=await wt(Je,Nt);Ut?$e.push(Ut):$e.push(Sr)}catch(Nt){console.error(`Error uploading gallery image for product ${de}:`,Nt),v({title:"Image Upload Failed",description:"Could not upload one or more product gallery images.",variant:"destructive"}),$e.push(Sr)}else typeof Je=="string"&&Je?$e.push(Je):(console.warn(`[StoreContext] updateProductImagesArray: Invalid or empty image in newImagesArray for product ${de}`,Je),$e.push(Sr));$e.length===0&&ae.length>0&&$e.push(Sr);const _e=ge.products.map(Je=>{var Nt,Ut;if(Je.id===de){Ne=!0;const Ye=$e.length>0?$e[0]:((Ut=(Nt=Je.image)==null?void 0:Nt.src)==null?void 0:Ut.medium)||Sr;return{...Je,images:$e.length>0?$e:[Sr],image:{...Je.image||{id:tn(),alt:Je.name||"Product Image"},src:{medium:Ye,large:Ye}}}}return Je});if(!Ne){console.warn(`[StoreContext] updateProductImagesArray: Product with ID ${de} not found in store ${se}.`),v({title:"Update Failed",description:"Product not found for updating images.",variant:"destructive"});return}try{const Je=vi(Er,"stores",se,"products",de),Nt=_e.find(Ut=>Ut.id===de);if(Nt)await Ky(Je,{images:Nt.images,image:Nt.image}),v({title:"Product Images Updated",description:"The product's image gallery has been updated."});else throw new Error("Updated product data not found for Firestore update.")}catch(Je){console.error("Error updating product images array in Firestore:",Je),v({title:"Cloud Sync Failed",description:`Failed to save product images to cloud: ${Je.message}`,variant:"destructive"});return}n(Je=>{const Nt=Je.map(Ut=>Ut.id===se?{...Ut,products:_e}:Ut);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dt(Nt)))}catch(Ut){console.error("Failed to save stores to localStorage during product images array update:",Ut),v({title:"Local Cache Update Failed",description:"Could not update the local cache for product images array.",variant:"warning",duration:7e3})}return Nt}),r&&r.id===se&&s(Je=>Je?{...Je,products:_e}:null)},nr=(se,de)=>{g(ae=>ae.find(Ne=>Ne.id===se.id&&Ne.storeId===de)?ae.map(Ne=>Ne.id===se.id&&Ne.storeId===de?{...Ne,quantity:Ne.quantity+1}:Ne):[...ae,{...se,quantity:1,storeId:de}]),v({title:"Added to Cart",description:`${se.name} has been added to your cart.`})},Kn=(se,de)=>{g(ae=>ae.filter(ge=>!(ge.id===se&&ge.storeId===de))),v({title:"Removed from Cart",description:"Item removed from your cart.",variant:"destructive"})},hs=(se,de,ae)=>{if(ae<1){Kn(se,de);return}g(ge=>ge.map(Ne=>Ne.id===se&&Ne.storeId===de?{...Ne,quantity:ae}:Ne))},fs=()=>{g([]),v({title:"Cart Cleared",description:"Your shopping cart is now empty."})},Js=p.useCallback((se,de)=>{const ae=e.find($e=>$e.id===se);if(!ae)return console.warn(`[getUpdatesForVersion] Store with ID ${se} not found.`),{template_version:de};let ge={template_version:de};const Ne=ae.theme||{};return ae.template_version,de==="v1"?["Montserrat","PremiumMain","SharpFont","FreshFont","SleekFont"].includes(Ne.fontFamily)||!Ne.fontFamily?ge.theme={...Ne,fontFamily:"Inter"}:ge.theme={...Ne}:de==="premium"&&(ge.theme={...Ne,fontFamily:"PremiumMain"}),ge},[e]),Xt={stores:e,currentStore:r,isGenerating:i,isLoadingStores:h,cart:m,user:S,progress:l,statusMessage:u,loadStores:xt,generateStore:Jt,updateStoreTextContent:Nn,checkStoreNameAvailability:_r,getStoreById:Re,getStoreByName:et,updateStore:At,deleteStore:mn,setCurrentStore:s,updateStorePassKey:Te,assignStoreManager:ft,updateStoreTemplateVersion:async(se,de)=>{if(!se||!de){v({title:"Error",description:"Store ID and new template version are required.",variant:"destructive"});return}const ae=Js(se,de);await At(se,ae);let ge=de;de==="v1"?ge="Modern":de==="premium"?ge="Premium":de==="sharp"?ge="Sharp":de==="fresh"?ge="Fresh":de==="sleek"?ge="Sleek":ge=de.charAt(0).toUpperCase()+de.slice(1),v({title:"Template Updated",description:`Store template is now ${ge}.`})},getProductById:it,updateProductImage:Ct,generateStoreFromWizard:Gn,addToCart:nr,removeFromCart:Kn,updateQuantity:hs,clearCart:fs,generateAIProducts:Vbe,updateProductImagesArray:xn,generatePodCollectionFromDesign:an,addPendingPodCollectionData:ct,isGeneratingPodCollection:Qe,viewMode:x,setViewMode:k,shopifyWizardStep:C,setShopifyWizardStep:T,shopifyDomain:P,setShopifyDomain:A,shopifyToken:R,setShopifyToken:M,shopifyPreviewMetadata:j,shopifyPreviewProducts:W,shopifyPreviewCollections:H,shopifyLocalization:J,isFetchingShopifyPreviewData:V,shopifyImportError:F,generatedLogoImage:Ee,isGeneratingLogo:we,logoGenerationError:Ze,shopifyWizardShouldShowGenerator:Ae,setShopifyWizardShouldShowGenerator:pt,startShopifyImportWizard:K,fetchShopifyWizardProducts:Z,importedStoreDataForGenerator:nt,isImportDataReadyForGenerator:yt,clearImportedStoreDataForGenerator:fe,fetchShopifyWizardCollections:oe,fetchShopifyWizardLocalization:be,generateShopifyStoreLogo:Ce,finalizeShopifyImportFromWizard:Q,resetShopifyWizardState:Mn,updateShopifyPreviewMetadata:se=>{z(se)},updateShopifyPreviewProduct:se=>{q(de=>{const ae=de.edges.map(ge=>ge.node.id===se.id?{...ge,node:se}:ge);return{...de,edges:ae}})},updateShopifyPreviewCollection:se=>{$(de=>{const ae=de.edges.map(ge=>ge.node.id===se.id?{...ge,node:se}:ge);return{...de,edges:ae}})},bigCommerceWizardStep:he,setBigCommerceWizardStep:Ie,bigCommerceStoreDomain:ee,bigCommerceApiToken:X,bigCommercePreviewSettings:ye,bigCommercePreviewProducts:Oe,isFetchingBigCommercePreviewData:pe,bigCommerceImportError:ve,startBigCommerceImportWizard:ke,fetchBigCommerceWizardSettings:ce,fetchBigCommerceWizardProducts:Ve,finalizeBigCommerceImportFromWizard:Y,resetBigCommerceWizardState:te,openProductFinalizationModal:(se,de)=>{nn(se),gn(de),Ht(!0)},closeProductFinalizationModal:()=>{Ht(!1),nn([]),gn(null),o(!1),c(0),d("")},handleFinalizeProducts:async se=>{if(!Tn){v({title:"Error",description:"Store data for finalization is missing.",variant:"destructive"}),Ht(!1),o(!1);return}o(!0),d("Finalizing store creation..."),c(95);const de={...Tn,products:se};try{const ae=await on(de);if(ae)c(100),d("Store generation complete!"),v({title:"Store Created!",description:`Store "${ae.name}" has been created.`}),b(`/${ae.urlSlug||Wl(ae.name)}`);else throw new Error("Store creation returned no result after finalization.")}catch(ae){console.error("Error during final store creation after product finalization:",ae),v({title:"Finalization Failed",description:ae.message||"Failed to create store after finalization.",variant:"destructive"}),c(0),d("Finalization failed.")}finally{Ht(!1),nn([]),gn(null),o(!1)}}};return a.jsxs(rG.Provider,{value:Xt,children:[t,a.jsx(Jbe,{isOpen:mt,onClose:Xt.closeProductFinalizationModal,products:Ft,onFinalize:Xt.handleFinalizeProducts})]})},Hf=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),Qbe=({product:t,storeId:e,onContentCreated:n})=>{var ee,ne;const{toast:r}=Ks(),{storeName:s}=s0(),i=qa(),o=(ee=i.state)==null?void 0:ee.product,l=(ne=i.state)==null?void 0:ne.storeData,c=t||o,{getStoreById:u,getStoreByName:d}=Fn(),[h,f]=p.useState("text-to-image"),[m,g]=p.useState(""),[x,E]=p.useState(""),[v,b]=p.useState(!1),[S,I]=p.useState(!1),[D,k]=p.useState(null),[C,T]=p.useState([]),[P,A]=p.useState(!1),[R,M]=p.useState(""),[j,z]=p.useState(null),[W,q]=p.useState(!1),[H,$]=p.useState(null),[J,O]=p.useState([]),[V,G]=p.useState(""),[F,ue]=p.useState(!1),[Ee,Se]=p.useState(null),[we,Fe]=p.useState(!1),[Ze,ze]=p.useState([]),[nt,qe]=p.useState(!1),[yt,Le]=p.useState(!1),[Ae,pt]=p.useState(null),mt=async()=>{var X,me;if(!(!Ae||!Ae.url))try{const ye=document.createElement("a");let De="download";if(Ae.url.startsWith("data:")){const Oe=Ae.url.match(/:(.*?);/),pe=(Oe?Oe[1]:"application/octet-stream").split("/")[1]||"bin";De=`${((X=Ae.caption)==null?void 0:X.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${pe}`,ye.href=Ae.url}else{const re=await(await fetch(Ae.url)).blob();ye.href=URL.createObjectURL(re);const pe=Ae.url.substring(Ae.url.lastIndexOf("/")+1).split("?")[0],Me=pe.includes(".")?pe.substring(pe.lastIndexOf(".")+1):"",ve=Ae.type==="video"?"mp4":"png";De=pe||`${((me=Ae.caption)==null?void 0:me.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${Me||ve}`}ye.download=De,document.body.appendChild(ye),ye.click(),document.body.removeChild(ye),Ae.url.startsWith("data:")||URL.revokeObjectURL(ye.href),r({title:"Download Started",description:`Downloading ${De}`})}catch(ye){console.error("Error downloading media:",ye),r({title:"Download Failed",description:ye.message,variant:"destructive"})}};p.useEffect(()=>{let X=l;if(X||(s?X=d(s):e?X=u(e):c&&c.store_id&&(X=u(c.store_id))),X&&X.products){qe(!0);const me=X.products.map(ye=>{var De,Oe,re;return{id:ye.id,name:ye.name,image:{src:{medium:((Oe=(De=ye.image)==null?void 0:De.src)==null?void 0:Oe.medium)||`https://via.placeholder.com/100x100.png?text=${encodeURIComponent(((re=ye.name)==null?void 0:re.substring(0,10))||"P")}`}}}});ze(me),qe(!1)}else console.warn("[ContentCreationPage] No current store products found. Falling back to sample product catalog."),ze([{id:"sample_prod_1",name:"Sample Product Alpha",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Alpha"}}},{id:"sample_prod_2",name:"Sample Product Beta",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Beta"}}},{id:"sample_prod_3",name:"Sample Product Gamma",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Gamma"}}}]),qe(!1);c&&c.name&&(g(`A captivating image of ${c.name}`),(async()=>{A(!0);try{const ye={name:c.name,description:c.description||"",niche:(X==null?void 0:X.type)||c.niche||"",storeName:(X==null?void 0:X.name)||c.storeName||""},De=await Doe(ye);De.suggestions&&De.suggestions.length>0?T(De.suggestions):De.error&&console.warn("Could not fetch prompt suggestions:",De.error)}catch(ye){console.error("Error fetching prompt suggestions:",ye)}finally{A(!1)}})())},[c,l,s,e,u,d]);const Ht=async()=>{if(!m.trim()){r({title:"Error",description:"Please enter a prompt for image generation",variant:"destructive"});return}b(!0),k(null),G("");try{const X=await B1(m);let me=X.alt?[X.alt]:[`Image for: ${m.substring(0,30)}`];if(X.url)try{const{base64ImageData:ye,mimeType:De}=await Hf(X.url);me=await Wd(ye,De,`Image of ${m}`)}catch(ye){console.error("Error generating caption for Gemini image:",ye),me=[`Failed to generate caption for: ${m.substring(0,30)}`]}k({url:X.url,captions:me,sourceApi:"gemini"}),me&&me.length>0&&G(me[0])}catch(X){console.error("Error generating image with Gemini:",X),r({title:"Image Generation Failed",description:X.message,variant:"destructive"})}finally{b(!1)}},Ft=async()=>{if(!x.trim()){r({title:"Error",description:"Please enter a prompt for OpenAI image generation",variant:"destructive"});return}I(!0),k(null),G("");try{const X=await bfe(x),me=`data:image/png;base64,${X.b64_json}`;let ye=X.alt?[X.alt]:[`OpenAI image for: ${x.substring(0,30)}`];try{const{base64ImageData:De,mimeType:Oe}=await Hf(me);ye=await Wd(De,Oe,`OpenAI-generated image of ${x}`)}catch(De){console.error("Error generating caption for OpenAI image:",De),ye=[`Failed to generate caption for: ${x.substring(0,30)}`]}k({url:me,captions:ye,sourceApi:"openai"}),ye&&ye.length>0&&G(ye[0]),r({title:"Image Generated (OpenAI)",description:"Image successfully generated using OpenAI."})}catch(X){console.error("Error generating image with OpenAI:",X),r({title:"OpenAI Image Generation Failed",description:X.message,variant:"destructive"})}finally{I(!1)}},nn=async(X,me)=>{if(!X||!X.url){r({title:"Error",description:"No image selected to edit with Gemini.",variant:"destructive"});return}if(!me.trim()){r({title:"Error",description:"Please enter an edit prompt for Gemini.",variant:"destructive"});return}q(!0),$(null),G("");try{const{base64ImageData:ye,mimeType:De}=await Hf(X.url),Oe=await Ql(ye,De,me);if(Oe&&Oe.editedImageData){const re=`data:${Oe.newMimeType};base64,${Oe.editedImageData}`;let pe=Oe.editTextResponse?[Oe.editTextResponse]:[`Edited with Gemini: ${X.caption||X.id}`];try{pe=await Wd(Oe.editedImageData,Oe.newMimeType,`Edited image based on: ${me}`)}catch(Me){console.error("Error generating caption for Gemini edited image:",Me)}$({url:re,captions:pe,sourceApi:"gemini"}),pe&&pe.length>0&&G(pe[0]),r({title:"Image Edited (Gemini)",description:"Image successfully edited with Gemini."})}else throw new Error("Gemini image edit did not return image data.")}catch(ye){console.error("Error editing image with Gemini:",ye),r({title:"Gemini Edit Failed",description:ye.message,variant:"destructive"})}finally{q(!1)}},Tn=async X=>{const me=X.target.files[0];if(me){Fe(!0),Se(null),G("");try{const ye=new FileReader;ye.onload=async De=>{const Oe=De.target.result,re=me.type.startsWith("video/")?"video":"image";let pe=[me.name];if(re==="image")try{const{base64ImageData:Me,mimeType:ve}=await Hf(Oe);pe=await Wd(Me,ve,"Uploaded image caption")}catch(Me){console.error("Error generating caption for uploaded image:",Me)}else pe=[`Uploaded video: ${me.name}`];Se({url:Oe,captions:pe,type:re}),pe&&pe.length>0&&G(pe[0]),Fe(!1)},ye.onerror=()=>{r({title:"Upload Failed",description:"Failed to read the selected file",variant:"destructive"}),Fe(!1)},ye.readAsDataURL(me)}catch(ye){console.error("Error processing uploaded file:",ye),r({title:"Upload Failed",description:ye.message,variant:"destructive"}),Fe(!1)}}},gn=(X,me,ye="image")=>{if(!X){r({title:"Cannot Add",description:"Item URL is missing.",variant:"destructive"});return}const De={id:tn(),type:ye,url:X,caption:me||`Item ${J.length+1}`,isVideo:ye==="video"};O(Oe=>[...Oe,De]),r({title:"Added to Timeline",description:`${ye==="video"?"Video":"Image"} added to your content timeline.`}),k(null),$(null),Se(null),z(null),G("")},Qe=(X,me)=>{const ye=[...J],De=ye[X],Oe=X+me;Oe<0||Oe>=ye.length||(ye.splice(X,1),ye.splice(Oe,0,De),O(ye))},Be=X=>{O(me=>me.filter(ye=>ye.id!==X)),r({title:"Removed from Timeline",description:"Item removed."})},ct=async(X,me)=>{if(X.isVideo){r({title:"Already a Video",description:"This item is already a video."});return}ue(!0);try{const{base64ImageData:ye,mimeType:De}=await Hf(X.url),Oe=X.caption||`Create a short video from this image: ${c?c.name:"product showcase"}`,re=await _U(Oe,ye,De),pe=[...J];pe[me]={...X,url:re,isVideo:!0,type:"video",caption:X.caption+" (Veo Video)"},O(pe),r({title:"Veo Video Generated",description:"Image converted to video using Veo."})}catch(ye){console.error("Error converting to Veo video:",ye),r({title:"Veo Conversion Failed",description:ye.message,variant:"destructive"})}finally{ue(!1)}},he=X=>{const me=J.find(De=>De.id===X);if(!me)return;const ye=prompt("Edit caption:",me.caption);ye!==null&&ye.trim()!==me.caption&&(O(De=>De.map(Oe=>Oe.id===X?{...Oe,caption:ye.trim()}:Oe)),r({title:"Caption Updated"}))},Ie=X=>{if(X.image&&X.image.src&&X.image.src.medium){const me=`Product: ${X.name}`;gn(X.image.src.medium,me,"image")}else r({title:"No Image",description:`Product ${X.name} has no image.`,variant:"destructive"});Le(!1)};return a.jsxs("div",{className:"container mx-auto p-4 md:p-6 lg:p-8 space-y-8 bg-background",children:[" ",a.jsxs("header",{className:"relative text-center pb-4",children:[a.jsx(Us,{to:"/",className:"absolute left-0 top-0",children:a.jsxs(U,{variant:"outline",size:"icon",children:[a.jsx(Ra,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Back to Home"})]})}),a.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight",children:"AI Content Creation Studio"}),a.jsx("p",{className:"text-muted-foreground mt-2 text-lg",children:"Generate images, edit them, create videos, and build your content sequence."})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 xl:gap-8",children:[a.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[a.jsxs(Fi,{value:h,onValueChange:f,className:"w-full",children:[a.jsxs(hi,{className:"grid w-full grid-cols-3",children:[a.jsxs(Gt,{value:"text-to-image",children:[a.jsx(Ll,{className:"mr-1 h-4 w-4 inline-block"}),"Gen Image"]}),a.jsxs(Gt,{value:"image-edit",children:[a.jsx(Hj,{className:"mr-1 h-4 w-4 inline-block"}),"Edit Image"]}),a.jsxs(Gt,{value:"upload",children:[a.jsx(_ie,{className:"mr-1 h-4 w-4 inline-block"}),"Upload"]})]}),a.jsxs(Wt,{value:"text-to-image",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(je,{htmlFor:"text-prompt-model1",className:"text-lg font-semibold",children:"Text-to-Image (Quick)"}),a.jsx(Vn,{id:"text-prompt-model1",placeholder:"e.g., 'A futuristic cityscape at sunset'",value:m,onChange:X=>g(X.target.value),rows:3,className:"mt-2",disabled:v||S}),P&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Loading prompt suggestions..."}),C.length>0&&!P&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx(je,{className:"text-xs text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:C.map((X,me)=>a.jsx(U,{variant:"outline",size:"xs",onClick:()=>g(X),className:"text-xs",children:X.length>40?X.substring(0,37)+"...":X},me))})]}),a.jsxs(U,{onClick:Ht,disabled:v||S||!m.trim(),className:"w-full mt-3",children:[v?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ll,{className:"mr-2 h-4 w-4"}),"Generate with Quick"]}),a.jsx(Da,{className:"my-4"}),a.jsx(je,{htmlFor:"text-prompt-model2",className:"text-lg font-semibold",children:"Text-to-Image (Quality)"}),a.jsx(Vn,{id:"text-prompt-model2",placeholder:"e.g., 'A photorealistic cat astronaut'",value:x,onChange:X=>E(X.target.value),rows:3,className:"mt-2",disabled:v||S}),a.jsxs(U,{onClick:Ft,disabled:v||S||!x.trim(),className:"w-full mt-3",children:[S?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Qse,{className:"mr-2 h-4 w-4"}),"Generate with Quality"]}),D&&D.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:D.url,alt:`Generated by ${D.sourceApi==="gemini"?"Quick":D.sourceApi==="openai"?"Quality":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",D.sourceApi==="gemini"?"Quick":D.sourceApi==="openai"?"Quality":"AI"]}),a.jsx(je,{className:"text-sm font-medium",children:"Choose a caption:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(D.captions||[]).map((X,me)=>a.jsx(U,{variant:V===X?"default":"outline",size:"sm",onClick:()=>G(X),className:"text-xs",children:X},me))}),a.jsxs(U,{onClick:()=>gn(D.url,V),size:"sm",className:"w-full mt-2",disabled:!V,children:[a.jsx(by,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]}),a.jsxs(Wt,{value:"image-edit",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(je,{className:"text-lg font-semibold",children:"Image Editing"}),!j&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select an image from the timeline to enable editing."}),j&&a.jsxs("div",{className:"mt-2 space-y-3",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Editing: ",a.jsx("span",{className:"text-primary truncate",children:j.caption})]}),a.jsx("img",{src:j.url,alt:"Selected for editing",className:"w-full rounded-md object-contain max-h-48 border"}),a.jsx(je,{htmlFor:"edit-prompt-model1",children:"Edit with Quick"}),a.jsx(Vn,{id:"edit-prompt-model1",placeholder:"Describe edits (e.g., 'change background to a beach')",value:R,onChange:X=>M(X.target.value),rows:2,disabled:W}),a.jsxs(U,{onClick:()=>nn(j,R),disabled:W||!R.trim(),className:"w-full",children:[W?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ll,{className:"mr-2 h-4 w-4"}),"Edit with Quick"]})]}),H&&H.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:H.url,alt:`Edited by ${H.sourceApi==="gemini"?"Quick":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",H.sourceApi==="gemini"?"Quick":"AI"]}),a.jsx(je,{className:"text-sm font-medium",children:"Choose a caption for the edited image:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(H.captions||[]).map((X,me)=>a.jsx(U,{variant:V===X?"default":"outline",size:"sm",onClick:()=>G(X),className:"text-xs",children:X},me))}),a.jsxs(U,{onClick:()=>gn(H.url,V),size:"sm",className:"w-full mt-2",disabled:!V,children:[a.jsx(by,{className:"mr-2 h-4 w-4"})," Add Edited to Timeline"]})]})]}),a.jsxs(Wt,{value:"upload",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(je,{htmlFor:"file-upload",className:"text-lg font-semibold",children:"Upload Image or Video"}),a.jsx(st,{id:"file-upload",type:"file",accept:"image/*,video/*",onChange:Tn,className:"mt-2",disabled:we}),we&&a.jsxs("div",{className:"mt-2 flex items-center text-sm text-muted-foreground",children:[a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"})," Processing..."]}),Ee&&Ee.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[Ee.type==="image"?a.jsx("img",{src:Ee.url,alt:"Uploaded content",className:"w-full rounded-md object-contain max-h-96"}):a.jsx("video",{src:Ee.url,controls:!0,className:"w-full rounded-md max-h-96",children:"Your browser does not support the video tag."}),a.jsx(je,{className:"text-sm font-medium",children:"Choose a caption for the uploaded content:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(Ee.captions||[]).map((X,me)=>a.jsx(U,{variant:V===X?"default":"outline",size:"sm",onClick:()=>G(X),className:"text-xs",children:X},me))}),a.jsxs(U,{onClick:()=>gn(Ee.url,V,Ee.type),size:"sm",className:"w-full mt-2",disabled:!V,children:[a.jsx(by,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Product Catalog"}),a.jsxs(U,{variant:"outline",size:"sm",onClick:()=>Le(!yt),children:[yt?"Hide":"Show"," Products ",a.jsx(Hse,{className:"ml-2 h-4 w-4"})]})]}),yt&&a.jsx(Zi,{className:"mt-2 h-48 border rounded-md p-2",children:a.jsx("div",{className:"space-y-2",children:Ze.map(X=>{var me,ye;return a.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md hover:bg-muted cursor-pointer",onClick:()=>Ie(X),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:(ye=(me=X.image)==null?void 0:me.src)==null?void 0:ye.medium,alt:X.name,className:"w-10 h-10 object-cover rounded"}),a.jsx("span",{className:"text-sm",children:X.name})]}),a.jsx(U,{size:"xs",variant:"ghost",children:a.jsx(by,{className:"h-4 w-4"})})]},X.id)})})})]})]}),a.jsx("div",{className:"lg:col-span-2 space-y-6",children:a.jsxs("div",{className:"p-4 md:p-6 border rounded-lg bg-card shadow min-h-[400px]",children:[a.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Content Timeline"}),a.jsx(Zi,{className:"h-[calc(100vh-350px)] min-h-[300px] pr-3",children:J.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[a.jsx(Jse,{className:"h-12 w-12 mb-3"}),a.jsx("p",{children:"Your timeline is empty."}),a.jsx("p",{className:"text-sm",children:"Generate or upload content to get started."})]}):a.jsx(Eu,{children:J.map((X,me)=>a.jsxs(It.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-50},transition:{type:"spring",stiffness:300,damping:30},className:"mb-3 p-3 border rounded-md flex items-start gap-3 hover:shadow-md transition-shadow bg-background cursor-pointer",onClick:()=>pt(X),children:[a.jsxs("div",{className:"w-24 h-24 flex-shrink-0 relative rounded overflow-hidden group bg-muted",children:[X.isVideo?a.jsx("video",{src:X.url,className:"w-full h-full object-cover",controls:!1,muted:!0,loop:!0,onMouseOver:ye=>ye.target.play(),onMouseOut:ye=>ye.target.pause()}):a.jsx("img",{src:X.url,alt:X.caption,className:"w-full h-full object-cover"}),!X.isVideo&&a.jsx(U,{size:"icon",variant:"secondary",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:ye=>{ye.stopPropagation(),ct(X,me)},disabled:F,title:"Convert to Veo Video",children:F?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(JV,{className:"h-4 w-4"})}),a.jsx(U,{size:"icon",variant:"outline",className:"absolute bottom-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:ye=>{ye.stopPropagation(),z(X),f("image-edit")},disabled:X.isVideo,title:"Edit this image",children:a.jsx(Hj,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:`text-xs font-semibold px-1.5 py-0.5 rounded-sm ${X.isVideo?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:[X.isVideo?"Video":"Image"," ",me+1]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(U,{size:"icon",variant:"ghost",onClick:ye=>{ye.stopPropagation(),Qe(me,-1)},disabled:me===0,className:"h-7 w-7",children:a.jsx(cie,{className:"h-4 w-4"})}),a.jsx(U,{size:"icon",variant:"ghost",onClick:ye=>{ye.stopPropagation(),Qe(me,1)},disabled:me===J.length-1,className:"h-7 w-7",children:a.jsx(lie,{className:"h-4 w-4"})}),a.jsx(U,{size:"icon",variant:"ghost",onClick:ye=>{ye.stopPropagation(),he(X.id)},className:"h-7 w-7",children:a.jsx(die,{className:"h-4 w-4"})}),a.jsx(U,{size:"icon",variant:"ghost",onClick:ye=>{ye.stopPropagation(),Be(X.id)},className:"h-7 w-7 text-destructive",children:a.jsx(sr,{className:"h-4 w-4"})})]})]}),a.jsx("p",{className:"text-sm mt-1 text-muted-foreground line-clamp-3",title:X.caption,children:X.caption})]})]},X.id))})}),J.length>0&&a.jsx(Da,{className:"my-4"}),Ae&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Media Viewer"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(U,{variant:"outline",size:"sm",onClick:mt,children:[a.jsx(HV,{className:"mr-2 h-4 w-4"}),"Download"]}),a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>pt(null),children:a.jsx(ra,{className:"h-5 w-5"})})]})]}),Ae.type==="image"||!Ae.isVideo?a.jsx("img",{src:Ae.url,alt:Ae.caption||"Viewing media",className:"w-full max-h-[60vh] rounded-md object-contain border"}):a.jsx("video",{src:Ae.url,controls:!0,className:"w-full max-h-[60vh] rounded-md border bg-black",children:"Your browser does not support the video tag."}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:Ae.caption})]})]})})]})]})};function sG(t){const e=p.useRef({value:t,previous:t});return p.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}function VP(t){const[e,n]=p.useState(void 0);return ta(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var Tb="Switch",[Zbe,JRe]=Li(Tb),[e_e,t_e]=Zbe(Tb),iG=p.forwardRef((t,e)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:u,form:d,...h}=t,[f,m]=p.useState(null),g=Cn(e,S=>m(S)),x=p.useRef(!1),E=f?d||!!f.closest("form"):!0,[v,b]=Bu({prop:s,defaultProp:i??!1,onChange:u,caller:Tb});return a.jsxs(e_e,{scope:n,checked:v,disabled:l,children:[a.jsx(Yt.button,{type:"button",role:"switch","aria-checked":v,"aria-required":o,"data-state":cG(v),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:g,onClick:_t(t.onClick,S=>{b(I=>!I),E&&(x.current=S.isPropagationStopped(),x.current||S.stopPropagation())})}),E&&a.jsx(lG,{control:f,bubbles:!x.current,name:r,value:c,checked:v,required:o,disabled:l,form:d,style:{transform:"translateX(-100%)"}})]})});iG.displayName=Tb;var oG="SwitchThumb",aG=p.forwardRef((t,e)=>{const{__scopeSwitch:n,...r}=t,s=t_e(oG,n);return a.jsx(Yt.span,{"data-state":cG(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:e})});aG.displayName=oG;var n_e="SwitchBubbleInput",lG=p.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:r=!0,...s},i)=>{const o=p.useRef(null),l=Cn(o,i),c=sG(n),u=VP(e);return p.useEffect(()=>{const d=o.current;if(!d)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(c!==n&&m){const g=new Event("click",{bubbles:r});m.call(d,n),d.dispatchEvent(g)}},[c,n,r]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:l,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});lG.displayName=n_e;function cG(t){return t?"checked":"unchecked"}var uG=iG,r_e=aG;const Wo=ht.forwardRef(({className:t,...e},n)=>a.jsx(uG,{className:Et("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...e,ref:n,children:a.jsx(r_e,{className:Et("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Wo.displayName=uG.displayName;const s_e=["top","right","bottom","left"],oc=Math.min,Si=Math.max,Iw=Math.round,Xy=Math.floor,ea=t=>({x:t,y:t}),i_e={left:"right",right:"left",bottom:"top",top:"bottom"},o_e={start:"end",end:"start"};function xT(t,e,n){return Si(t,oc(e,n))}function Ua(t,e){return typeof t=="function"?t(e):t}function Ba(t){return t.split("-")[0]}function ff(t){return t.split("-")[1]}function UP(t){return t==="x"?"y":"x"}function BP(t){return t==="y"?"height":"width"}function Ho(t){return["top","bottom"].includes(Ba(t))?"y":"x"}function zP(t){return UP(Ho(t))}function a_e(t,e,n){n===void 0&&(n=!1);const r=ff(t),s=zP(t),i=BP(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Nw(o)),[o,Nw(o)]}function l_e(t){const e=Nw(t);return[vT(t),e,vT(e)]}function vT(t){return t.replace(/start|end/g,e=>o_e[e])}function c_e(t,e,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?s:r:e?r:s;case"left":case"right":return e?i:o;default:return[]}}function u_e(t,e,n,r){const s=ff(t);let i=c_e(Ba(t),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(vT)))),i}function Nw(t){return t.replace(/left|right|bottom|top/g,e=>i_e[e])}function d_e(t){return{top:0,right:0,bottom:0,left:0,...t}}function dG(t){return typeof t!="number"?d_e(t):{top:t,right:t,bottom:t,left:t}}function Pw(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function Y4(t,e,n){let{reference:r,floating:s}=t;const i=Ho(e),o=zP(e),l=BP(o),c=Ba(e),u=i==="y",d=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,f=r[l]/2-s[l]/2;let m;switch(c){case"top":m={x:d,y:r.y-s.height};break;case"bottom":m={x:d,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:h};break;case"left":m={x:r.x-s.width,y:h};break;default:m={x:r.x,y:r.y}}switch(ff(e)){case"start":m[o]-=f*(n&&u?-1:1);break;case"end":m[o]+=f*(n&&u?-1:1);break}return m}const h_e=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:d,y:h}=Y4(u,r,c),f=r,m={},g=0;for(let x=0;x<l.length;x++){const{name:E,fn:v}=l[x],{x:b,y:S,data:I,reset:D}=await v({x:d,y:h,initialPlacement:r,placement:f,strategy:s,middlewareData:m,rects:u,platform:o,elements:{reference:t,floating:e}});d=b??d,h=S??h,m={...m,[E]:{...m[E],...I}},D&&g<=50&&(g++,typeof D=="object"&&(D.placement&&(f=D.placement),D.rects&&(u=D.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):D.rects),{x:d,y:h}=Y4(u,f,c)),x=-1)}return{x:d,y:h,placement:f,strategy:s,middlewareData:m}};async function Bp(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:l,strategy:c}=t,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:m=0}=Ua(e,t),g=dG(m),E=l[f?h==="floating"?"reference":"floating":h],v=Pw(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(E)))==null||n?E:E.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),b=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),I=await(i.isElement==null?void 0:i.isElement(S))?await(i.getScale==null?void 0:i.getScale(S))||{x:1,y:1}:{x:1,y:1},D=Pw(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:b,offsetParent:S,strategy:c}):b);return{top:(v.top-D.top+g.top)/I.y,bottom:(D.bottom-v.bottom+g.bottom)/I.y,left:(v.left-D.left+g.left)/I.x,right:(D.right-v.right+g.right)/I.x}}const f_e=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:o,elements:l,middlewareData:c}=e,{element:u,padding:d=0}=Ua(t,e)||{};if(u==null)return{};const h=dG(d),f={x:n,y:r},m=zP(s),g=BP(m),x=await o.getDimensions(u),E=m==="y",v=E?"top":"left",b=E?"bottom":"right",S=E?"clientHeight":"clientWidth",I=i.reference[g]+i.reference[m]-f[m]-i.floating[g],D=f[m]-i.reference[m],k=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let C=k?k[S]:0;(!C||!await(o.isElement==null?void 0:o.isElement(k)))&&(C=l.floating[S]||i.floating[g]);const T=I/2-D/2,P=C/2-x[g]/2-1,A=oc(h[v],P),R=oc(h[b],P),M=A,j=C-x[g]-R,z=C/2-x[g]/2+T,W=xT(M,z,j),q=!c.arrow&&ff(s)!=null&&z!==W&&i.reference[g]/2-(z<M?A:R)-x[g]/2<0,H=q?z<M?z-M:z-j:0;return{[m]:f[m]+H,data:{[m]:W,centerOffset:z-W-H,...q&&{alignmentOffset:H}},reset:q}}}),m_e=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:x=!0,...E}=Ua(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const v=Ba(s),b=Ho(l),S=Ba(l)===l,I=await(c.isRTL==null?void 0:c.isRTL(u.floating)),D=f||(S||!x?[Nw(l)]:l_e(l)),k=g!=="none";!f&&k&&D.push(...u_e(l,x,g,I));const C=[l,...D],T=await Bp(e,E),P=[];let A=((r=i.flip)==null?void 0:r.overflows)||[];if(d&&P.push(T[v]),h){const z=a_e(s,o,I);P.push(T[z[0]],T[z[1]])}if(A=[...A,{placement:s,overflows:P}],!P.every(z=>z<=0)){var R,M;const z=(((R=i.flip)==null?void 0:R.index)||0)+1,W=C[z];if(W&&(!(h==="alignment"?b!==Ho(W):!1)||A.every($=>$.overflows[0]>0&&Ho($.placement)===b)))return{data:{index:z,overflows:A},reset:{placement:W}};let q=(M=A.filter(H=>H.overflows[0]<=0).sort((H,$)=>H.overflows[1]-$.overflows[1])[0])==null?void 0:M.placement;if(!q)switch(m){case"bestFit":{var j;const H=(j=A.filter($=>{if(k){const J=Ho($.placement);return J===b||J==="y"}return!0}).map($=>[$.placement,$.overflows.filter(J=>J>0).reduce((J,O)=>J+O,0)]).sort(($,J)=>$[1]-J[1])[0])==null?void 0:j[0];H&&(q=H);break}case"initialPlacement":q=l;break}if(s!==q)return{reset:{placement:q}}}return{}}}};function J4(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function X4(t){return s_e.some(e=>t[e]>=0)}const p_e=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=Ua(t,e);switch(r){case"referenceHidden":{const i=await Bp(e,{...s,elementContext:"reference"}),o=J4(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:X4(o)}}}case"escaped":{const i=await Bp(e,{...s,altBoundary:!0}),o=J4(i,n.floating);return{data:{escapedOffsets:o,escaped:X4(o)}}}default:return{}}}}};async function g_e(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=Ba(n),l=ff(n),c=Ho(n)==="y",u=["left","top"].includes(o)?-1:1,d=i&&c?-1:1,h=Ua(e,t);let{mainAxis:f,crossAxis:m,alignmentAxis:g}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof g=="number"&&(m=l==="end"?g*-1:g),c?{x:m*d,y:f*u}:{x:f*u,y:m*d}}const y_e=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:o,middlewareData:l}=e,c=await g_e(e,t);return o===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:o}}}}},x_e=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:E=>{let{x:v,y:b}=E;return{x:v,y:b}}},...c}=Ua(t,e),u={x:n,y:r},d=await Bp(e,c),h=Ho(Ba(s)),f=UP(h);let m=u[f],g=u[h];if(i){const E=f==="y"?"top":"left",v=f==="y"?"bottom":"right",b=m+d[E],S=m-d[v];m=xT(b,m,S)}if(o){const E=h==="y"?"top":"left",v=h==="y"?"bottom":"right",b=g+d[E],S=g-d[v];g=xT(b,g,S)}const x=l.fn({...e,[f]:m,[h]:g});return{...x,data:{x:x.x-n,y:x.y-r,enabled:{[f]:i,[h]:o}}}}}},v_e=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=Ua(t,e),d={x:n,y:r},h=Ho(s),f=UP(h);let m=d[f],g=d[h];const x=Ua(l,e),E=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(c){const S=f==="y"?"height":"width",I=i.reference[f]-i.floating[S]+E.mainAxis,D=i.reference[f]+i.reference[S]-E.mainAxis;m<I?m=I:m>D&&(m=D)}if(u){var v,b;const S=f==="y"?"width":"height",I=["top","left"].includes(Ba(s)),D=i.reference[h]-i.floating[S]+(I&&((v=o.offset)==null?void 0:v[h])||0)+(I?0:E.crossAxis),k=i.reference[h]+i.reference[S]+(I?0:((b=o.offset)==null?void 0:b[h])||0)-(I?E.crossAxis:0);g<D?g=D:g>k&&(g=k)}return{[f]:m,[h]:g}}}},w_e=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:s,rects:i,platform:o,elements:l}=e,{apply:c=()=>{},...u}=Ua(t,e),d=await Bp(e,u),h=Ba(s),f=ff(s),m=Ho(s)==="y",{width:g,height:x}=i.floating;let E,v;h==="top"||h==="bottom"?(E=h,v=f===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(v=h,E=f==="end"?"top":"bottom");const b=x-d.top-d.bottom,S=g-d.left-d.right,I=oc(x-d[E],b),D=oc(g-d[v],S),k=!e.middlewareData.shift;let C=I,T=D;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(T=S),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(C=b),k&&!f){const A=Si(d.left,0),R=Si(d.right,0),M=Si(d.top,0),j=Si(d.bottom,0);m?T=g-2*(A!==0||R!==0?A+R:Si(d.left,d.right)):C=x-2*(M!==0||j!==0?M+j:Si(d.top,d.bottom))}await c({...e,availableWidth:T,availableHeight:C});const P=await o.getDimensions(l.floating);return g!==P.width||x!==P.height?{reset:{rects:!0}}:{}}}};function Ib(){return typeof window<"u"}function mf(t){return hG(t)?(t.nodeName||"").toLowerCase():"#document"}function Ai(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function ca(t){var e;return(e=(hG(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function hG(t){return Ib()?t instanceof Node||t instanceof Ai(t).Node:!1}function Co(t){return Ib()?t instanceof Element||t instanceof Ai(t).Element:!1}function ia(t){return Ib()?t instanceof HTMLElement||t instanceof Ai(t).HTMLElement:!1}function Q4(t){return!Ib()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ai(t).ShadowRoot}function Fg(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=To(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(s)}function b_e(t){return["table","td","th"].includes(mf(t))}function Nb(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function GP(t){const e=WP(),n=Co(t)?To(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function __e(t){let e=ac(t);for(;ia(e)&&!Jh(e);){if(GP(e))return e;if(Nb(e))return null;e=ac(e)}return null}function WP(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Jh(t){return["html","body","#document"].includes(mf(t))}function To(t){return Ai(t).getComputedStyle(t)}function Pb(t){return Co(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ac(t){if(mf(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Q4(t)&&t.host||ca(t);return Q4(e)?e.host:e}function fG(t){const e=ac(t);return Jh(e)?t.ownerDocument?t.ownerDocument.body:t.body:ia(e)&&Fg(e)?e:fG(e)}function zp(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=fG(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),o=Ai(s);if(i){const l=wT(o);return e.concat(o,o.visualViewport||[],Fg(s)?s:[],l&&n?zp(l):[])}return e.concat(s,zp(s,[],n))}function wT(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function mG(t){const e=To(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=ia(t),i=s?t.offsetWidth:n,o=s?t.offsetHeight:r,l=Iw(n)!==i||Iw(r)!==o;return l&&(n=i,r=o),{width:n,height:r,$:l}}function HP(t){return Co(t)?t:t.contextElement}function yh(t){const e=HP(t);if(!ia(e))return ea(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=mG(e);let o=(i?Iw(n.width):n.width)/r,l=(i?Iw(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const S_e=ea(0);function pG(t){const e=Ai(t);return!WP()||!e.visualViewport?S_e:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function E_e(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Ai(t)?!1:e}function Ou(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=HP(t);let o=ea(1);e&&(r?Co(r)&&(o=yh(r)):o=yh(t));const l=E_e(i,n,r)?pG(i):ea(0);let c=(s.left+l.x)/o.x,u=(s.top+l.y)/o.y,d=s.width/o.x,h=s.height/o.y;if(i){const f=Ai(i),m=r&&Co(r)?Ai(r):r;let g=f,x=wT(g);for(;x&&r&&m!==g;){const E=yh(x),v=x.getBoundingClientRect(),b=To(x),S=v.left+(x.clientLeft+parseFloat(b.paddingLeft))*E.x,I=v.top+(x.clientTop+parseFloat(b.paddingTop))*E.y;c*=E.x,u*=E.y,d*=E.x,h*=E.y,c+=S,u+=I,g=Ai(x),x=wT(g)}}return Pw({width:d,height:h,x:c,y:u})}function qP(t,e){const n=Pb(t).scrollLeft;return e?e.left+n:Ou(ca(t)).left+n}function gG(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=r.left+e.scrollLeft-(n?0:qP(t,r)),i=r.top+e.scrollTop;return{x:s,y:i}}function C_e(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",o=ca(r),l=e?Nb(e.floating):!1;if(r===o||l&&i)return n;let c={scrollLeft:0,scrollTop:0},u=ea(1);const d=ea(0),h=ia(r);if((h||!h&&!i)&&((mf(r)!=="body"||Fg(o))&&(c=Pb(r)),ia(r))){const m=Ou(r);u=yh(r),d.x=m.x+r.clientLeft,d.y=m.y+r.clientTop}const f=o&&!h&&!i?gG(o,c,!0):ea(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-c.scrollLeft*u.x+d.x+f.x,y:n.y*u.y-c.scrollTop*u.y+d.y+f.y}}function T_e(t){return Array.from(t.getClientRects())}function I_e(t){const e=ca(t),n=Pb(t),r=t.ownerDocument.body,s=Si(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=Si(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+qP(t);const l=-n.scrollTop;return To(r).direction==="rtl"&&(o+=Si(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:l}}function N_e(t,e){const n=Ai(t),r=ca(t),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,l=0,c=0;if(s){i=s.width,o=s.height;const u=WP();(!u||u&&e==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:i,height:o,x:l,y:c}}function P_e(t,e){const n=Ou(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=ia(t)?yh(t):ea(1),o=t.clientWidth*i.x,l=t.clientHeight*i.y,c=s*i.x,u=r*i.y;return{width:o,height:l,x:c,y:u}}function Z4(t,e,n){let r;if(e==="viewport")r=N_e(t,n);else if(e==="document")r=I_e(ca(t));else if(Co(e))r=P_e(e,n);else{const s=pG(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Pw(r)}function yG(t,e){const n=ac(t);return n===e||!Co(n)||Jh(n)?!1:To(n).position==="fixed"||yG(n,e)}function A_e(t,e){const n=e.get(t);if(n)return n;let r=zp(t,[],!1).filter(l=>Co(l)&&mf(l)!=="body"),s=null;const i=To(t).position==="fixed";let o=i?ac(t):t;for(;Co(o)&&!Jh(o);){const l=To(o),c=GP(o);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||Fg(o)&&!c&&yG(t,o))?r=r.filter(d=>d!==o):s=l,o=ac(o)}return e.set(t,r),r}function k_e(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?Nb(e)?[]:A_e(e,this._c):[].concat(n),r],l=o[0],c=o.reduce((u,d)=>{const h=Z4(e,d,s);return u.top=Si(h.top,u.top),u.right=oc(h.right,u.right),u.bottom=oc(h.bottom,u.bottom),u.left=Si(h.left,u.left),u},Z4(e,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function R_e(t){const{width:e,height:n}=mG(t);return{width:e,height:n}}function j_e(t,e,n){const r=ia(e),s=ca(e),i=n==="fixed",o=Ou(t,!0,i,e);let l={scrollLeft:0,scrollTop:0};const c=ea(0);function u(){c.x=qP(s)}if(r||!r&&!i)if((mf(e)!=="body"||Fg(s))&&(l=Pb(e)),r){const m=Ou(e,!0,i,e);c.x=m.x+e.clientLeft,c.y=m.y+e.clientTop}else s&&u();i&&!r&&s&&u();const d=s&&!r&&!i?gG(s,l):ea(0),h=o.left+l.scrollLeft-c.x-d.x,f=o.top+l.scrollTop-c.y-d.y;return{x:h,y:f,width:o.width,height:o.height}}function SS(t){return To(t).position==="static"}function eL(t,e){if(!ia(t)||To(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return ca(t)===n&&(n=n.ownerDocument.body),n}function xG(t,e){const n=Ai(t);if(Nb(t))return n;if(!ia(t)){let s=ac(t);for(;s&&!Jh(s);){if(Co(s)&&!SS(s))return s;s=ac(s)}return n}let r=eL(t,e);for(;r&&b_e(r)&&SS(r);)r=eL(r,e);return r&&Jh(r)&&SS(r)&&!GP(r)?n:r||__e(t)||n}const D_e=async function(t){const e=this.getOffsetParent||xG,n=this.getDimensions,r=await n(t.floating);return{reference:j_e(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function M_e(t){return To(t).direction==="rtl"}const L_e={convertOffsetParentRelativeRectToViewportRelativeRect:C_e,getDocumentElement:ca,getClippingRect:k_e,getOffsetParent:xG,getElementRects:D_e,getClientRects:T_e,getDimensions:R_e,getScale:yh,isElement:Co,isRTL:M_e};function vG(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function F_e(t,e){let n=null,r;const s=ca(t);function i(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const u=t.getBoundingClientRect(),{left:d,top:h,width:f,height:m}=u;if(l||e(),!f||!m)return;const g=Xy(h),x=Xy(s.clientWidth-(d+f)),E=Xy(s.clientHeight-(h+m)),v=Xy(d),S={rootMargin:-g+"px "+-x+"px "+-E+"px "+-v+"px",threshold:Si(0,oc(1,c))||1};let I=!0;function D(k){const C=k[0].intersectionRatio;if(C!==c){if(!I)return o();C?o(!1,C):r=setTimeout(()=>{o(!1,1e-7)},1e3)}C===1&&!vG(u,t.getBoundingClientRect())&&o(),I=!1}try{n=new IntersectionObserver(D,{...S,root:s.ownerDocument})}catch{n=new IntersectionObserver(D,S)}n.observe(t)}return o(!0),i}function wG(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,u=HP(t),d=s||i?[...u?zp(u):[],...zp(e)]:[];d.forEach(v=>{s&&v.addEventListener("scroll",n,{passive:!0}),i&&v.addEventListener("resize",n)});const h=u&&l?F_e(u,n):null;let f=-1,m=null;o&&(m=new ResizeObserver(v=>{let[b]=v;b&&b.target===u&&m&&(m.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var S;(S=m)==null||S.observe(e)})),n()}),u&&!c&&m.observe(u),m.observe(e));let g,x=c?Ou(t):null;c&&E();function E(){const v=Ou(t);x&&!vG(x,v)&&n(),x=v,g=requestAnimationFrame(E)}return n(),()=>{var v;d.forEach(b=>{s&&b.removeEventListener("scroll",n),i&&b.removeEventListener("resize",n)}),h==null||h(),(v=m)==null||v.disconnect(),m=null,c&&cancelAnimationFrame(g)}}const O_e=y_e,$_e=x_e,V_e=m_e,U_e=w_e,B_e=p_e,tL=f_e,z_e=v_e,G_e=(t,e,n)=>{const r=new Map,s={platform:L_e,...n},i={...s.platform,_c:r};return h_e(t,e,{...s,platform:i})};var W_e=typeof document<"u",H_e=function(){},Yx=W_e?p.useLayoutEffect:H_e;function Aw(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!Aw(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!Aw(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function bG(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function nL(t,e){const n=bG(t);return Math.round(e*n)/n}function ES(t){const e=p.useRef(t);return Yx(()=>{e.current=t}),e}function _G(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=t,[d,h]=p.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,m]=p.useState(r);Aw(f,r)||m(r);const[g,x]=p.useState(null),[E,v]=p.useState(null),b=p.useCallback($=>{$!==k.current&&(k.current=$,x($))},[]),S=p.useCallback($=>{$!==C.current&&(C.current=$,v($))},[]),I=i||g,D=o||E,k=p.useRef(null),C=p.useRef(null),T=p.useRef(d),P=c!=null,A=ES(c),R=ES(s),M=ES(u),j=p.useCallback(()=>{if(!k.current||!C.current)return;const $={placement:e,strategy:n,middleware:f};R.current&&($.platform=R.current),G_e(k.current,C.current,$).then(J=>{const O={...J,isPositioned:M.current!==!1};z.current&&!Aw(T.current,O)&&(T.current=O,Wa.flushSync(()=>{h(O)}))})},[f,e,n,R,M]);Yx(()=>{u===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,h($=>({...$,isPositioned:!1})))},[u]);const z=p.useRef(!1);Yx(()=>(z.current=!0,()=>{z.current=!1}),[]),Yx(()=>{if(I&&(k.current=I),D&&(C.current=D),I&&D){if(A.current)return A.current(I,D,j);j()}},[I,D,j,A,P]);const W=p.useMemo(()=>({reference:k,floating:C,setReference:b,setFloating:S}),[b,S]),q=p.useMemo(()=>({reference:I,floating:D}),[I,D]),H=p.useMemo(()=>{const $={position:n,left:0,top:0};if(!q.floating)return $;const J=nL(q.floating,d.x),O=nL(q.floating,d.y);return l?{...$,transform:"translate("+J+"px, "+O+"px)",...bG(q.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:J,top:O}},[n,l,q.floating,d.x,d.y]);return p.useMemo(()=>({...d,update:j,refs:W,elements:q,floatingStyles:H}),[d,j,W,q,H])}const q_e=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?tL({element:r.current,padding:s}).fn(n):{}:r?tL({element:r,padding:s}).fn(n):{}}}},SG=(t,e)=>({...O_e(t),options:[t,e]}),EG=(t,e)=>({...$_e(t),options:[t,e]}),CG=(t,e)=>({...z_e(t),options:[t,e]}),TG=(t,e)=>({...V_e(t),options:[t,e]}),IG=(t,e)=>({...U_e(t),options:[t,e]}),NG=(t,e)=>({...B_e(t),options:[t,e]}),PG=(t,e)=>({...q_e(t),options:[t,e]});var K_e="Arrow",AG=p.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return a.jsx(Yt.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});AG.displayName=K_e;var Y_e=AG,KP="Popper",[kG,RG]=Li(KP),[J_e,jG]=kG(KP),DG=t=>{const{__scopePopper:e,children:n}=t,[r,s]=p.useState(null);return a.jsx(J_e,{scope:e,anchor:r,onAnchorChange:s,children:n})};DG.displayName=KP;var MG="PopperAnchor",LG=p.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=jG(MG,n),o=p.useRef(null),l=Cn(e,o);return p.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:a.jsx(Yt.div,{...s,ref:l})});LG.displayName=MG;var YP="PopperContent",[X_e,Q_e]=kG(YP),FG=p.forwardRef((t,e)=>{var we,Fe,Ze,ze,nt,qe;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:m="optimized",onPlaced:g,...x}=t,E=jG(YP,n),[v,b]=p.useState(null),S=Cn(e,yt=>b(yt)),[I,D]=p.useState(null),k=VP(I),C=(k==null?void 0:k.width)??0,T=(k==null?void 0:k.height)??0,P=r+(i!=="center"?"-"+i:""),A=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},R=Array.isArray(u)?u:[u],M=R.length>0,j={padding:A,boundary:R.filter(eSe),altBoundary:M},{refs:z,floatingStyles:W,placement:q,isPositioned:H,middlewareData:$}=_G({strategy:"fixed",placement:P,whileElementsMounted:(...yt)=>wG(...yt,{animationFrame:m==="always"}),elements:{reference:E.anchor},middleware:[SG({mainAxis:s+T,alignmentAxis:o}),c&&EG({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?CG():void 0,...j}),c&&TG({...j}),IG({...j,apply:({elements:yt,rects:Le,availableWidth:Ae,availableHeight:pt})=>{const{width:mt,height:Ht}=Le.reference,Ft=yt.floating.style;Ft.setProperty("--radix-popper-available-width",`${Ae}px`),Ft.setProperty("--radix-popper-available-height",`${pt}px`),Ft.setProperty("--radix-popper-anchor-width",`${mt}px`),Ft.setProperty("--radix-popper-anchor-height",`${Ht}px`)}}),I&&PG({element:I,padding:l}),tSe({arrowWidth:C,arrowHeight:T}),f&&NG({strategy:"referenceHidden",...j})]}),[J,O]=VG(q),V=Rr(g);ta(()=>{H&&(V==null||V())},[H,V]);const G=(we=$.arrow)==null?void 0:we.x,F=(Fe=$.arrow)==null?void 0:Fe.y,ue=((Ze=$.arrow)==null?void 0:Ze.centerOffset)!==0,[Ee,Se]=p.useState();return ta(()=>{v&&Se(window.getComputedStyle(v).zIndex)},[v]),a.jsx("div",{ref:z.setFloating,"data-radix-popper-content-wrapper":"",style:{...W,transform:H?W.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ee,"--radix-popper-transform-origin":[(ze=$.transformOrigin)==null?void 0:ze.x,(nt=$.transformOrigin)==null?void 0:nt.y].join(" "),...((qe=$.hide)==null?void 0:qe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:a.jsx(X_e,{scope:n,placedSide:J,onArrowChange:D,arrowX:G,arrowY:F,shouldHideArrow:ue,children:a.jsx(Yt.div,{"data-side":J,"data-align":O,...x,ref:S,style:{...x.style,animation:H?void 0:"none"}})})})});FG.displayName=YP;var OG="PopperArrow",Z_e={top:"bottom",right:"left",bottom:"top",left:"right"},$G=p.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=Q_e(OG,r),o=Z_e[i.placedSide];return a.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:a.jsx(Y_e,{...s,ref:n,style:{...s.style,display:"block"}})})});$G.displayName=OG;function eSe(t){return t!==null}var tSe=t=>({name:"transformOrigin",options:t,fn(e){var E,v,b;const{placement:n,rects:r,middlewareData:s}=e,o=((E=s.arrow)==null?void 0:E.centerOffset)!==0,l=o?0:t.arrowWidth,c=o?0:t.arrowHeight,[u,d]=VG(n),h={start:"0%",center:"50%",end:"100%"}[d],f=(((v=s.arrow)==null?void 0:v.x)??0)+l/2,m=(((b=s.arrow)==null?void 0:b.y)??0)+c/2;let g="",x="";return u==="bottom"?(g=o?h:`${f}px`,x=`${-c}px`):u==="top"?(g=o?h:`${f}px`,x=`${r.floating.height+c}px`):u==="right"?(g=`${-c}px`,x=o?h:`${m}px`):u==="left"&&(g=`${r.floating.width+c}px`,x=o?h:`${m}px`),{data:{x:g,y:x}}}});function VG(t){const[e,n="center"]=t.split("-");return[e,n]}var nSe=DG,rSe=LG,sSe=FG,iSe=$G,bT=["Enter"," "],oSe=["ArrowDown","PageUp","Home"],UG=["ArrowUp","PageDown","End"],aSe=[...oSe,...UG],lSe={ltr:[...bT,"ArrowRight"],rtl:[...bT,"ArrowLeft"]},cSe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Og="Menu",[Gp,uSe,dSe]=G1(Og),[Ju,BG]=Li(Og,[dSe,RG,v0]),Ab=RG(),zG=v0(),[hSe,Xu]=Ju(Og),[fSe,$g]=Ju(Og),GG=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:s,onOpenChange:i,modal:o=!0}=t,l=Ab(e),[c,u]=p.useState(null),d=p.useRef(!1),h=Rr(i),f=x0(s);return p.useEffect(()=>{const m=()=>{d.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>d.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),a.jsx(nSe,{...l,children:a.jsx(hSe,{scope:e,open:n,onOpenChange:h,content:c,onContentChange:u,children:a.jsx(fSe,{scope:e,onClose:p.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:f,modal:o,children:r})})})};GG.displayName=Og;var mSe="MenuAnchor",JP=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=Ab(n);return a.jsx(rSe,{...s,...r,ref:e})});JP.displayName=mSe;var XP="MenuPortal",[pSe,WG]=Ju(XP,{forceMount:void 0}),HG=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:s}=t,i=Xu(XP,e);return a.jsx(pSe,{scope:e,forceMount:n,children:a.jsx(qs,{present:n||i.open,children:a.jsx(d0,{asChild:!0,container:s,children:r})})})};HG.displayName=XP;var Ji="MenuContent",[gSe,QP]=Ju(Ji),qG=p.forwardRef((t,e)=>{const n=WG(Ji,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=Xu(Ji,t.__scopeMenu),o=$g(Ji,t.__scopeMenu);return a.jsx(Gp.Provider,{scope:t.__scopeMenu,children:a.jsx(qs,{present:r||i.open,children:a.jsx(Gp.Slot,{scope:t.__scopeMenu,children:o.modal?a.jsx(ySe,{...s,ref:e}):a.jsx(xSe,{...s,ref:e})})})})}),ySe=p.forwardRef((t,e)=>{const n=Xu(Ji,t.__scopeMenu),r=p.useRef(null),s=Cn(e,r);return p.useEffect(()=>{const i=r.current;if(i)return tI(i)},[]),a.jsx(ZP,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:_t(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),xSe=p.forwardRef((t,e)=>{const n=Xu(Ji,t.__scopeMenu);return a.jsx(ZP,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),vSe=Ah("MenuContent.ScrollLock"),ZP=p.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,disableOutsideScroll:g,...x}=t,E=Xu(Ji,n),v=$g(Ji,n),b=Ab(n),S=zG(n),I=uSe(n),[D,k]=p.useState(null),C=p.useRef(null),T=Cn(e,C,E.onContentChange),P=p.useRef(0),A=p.useRef(""),R=p.useRef(0),M=p.useRef(null),j=p.useRef("right"),z=p.useRef(0),W=g?v3:p.Fragment,q=g?{as:vSe,allowPinchZoom:!0}:void 0,H=J=>{var we,Fe;const O=A.current+J,V=I().filter(Ze=>!Ze.disabled),G=document.activeElement,F=(we=V.find(Ze=>Ze.ref.current===G))==null?void 0:we.textValue,ue=V.map(Ze=>Ze.textValue),Ee=kSe(ue,O,F),Se=(Fe=V.find(Ze=>Ze.textValue===Ee))==null?void 0:Fe.ref.current;(function Ze(ze){A.current=ze,window.clearTimeout(P.current),ze!==""&&(P.current=window.setTimeout(()=>Ze(""),1e3))})(O),Se&&setTimeout(()=>Se.focus())};p.useEffect(()=>()=>window.clearTimeout(P.current),[]),a3();const $=p.useCallback(J=>{var V,G;return j.current===((V=M.current)==null?void 0:V.side)&&jSe(J,(G=M.current)==null?void 0:G.area)},[]);return a.jsx(gSe,{scope:n,searchRef:A,onItemEnter:p.useCallback(J=>{$(J)&&J.preventDefault()},[$]),onItemLeave:p.useCallback(J=>{var O;$(J)||((O=C.current)==null||O.focus(),k(null))},[$]),onTriggerLeave:p.useCallback(J=>{$(J)&&J.preventDefault()},[$]),pointerGraceTimerRef:R,onPointerGraceIntentChange:p.useCallback(J=>{M.current=J},[]),children:a.jsx(W,{...q,children:a.jsx(Z1,{asChild:!0,trapped:s,onMountAutoFocus:_t(i,J=>{var O;J.preventDefault(),(O=C.current)==null||O.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:a.jsx(u0,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,children:a.jsx(eU,{asChild:!0,...S,dir:v.dir,orientation:"vertical",loop:r,currentTabStopId:D,onCurrentTabStopIdChange:k,onEntryFocus:_t(c,J=>{v.isUsingKeyboardRef.current||J.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(sSe,{role:"menu","aria-orientation":"vertical","data-state":c7(E.open),"data-radix-menu-content":"",dir:v.dir,...b,...x,ref:T,style:{outline:"none",...x.style},onKeyDown:_t(x.onKeyDown,J=>{const V=J.target.closest("[data-radix-menu-content]")===J.currentTarget,G=J.ctrlKey||J.altKey||J.metaKey,F=J.key.length===1;V&&(J.key==="Tab"&&J.preventDefault(),!G&&F&&H(J.key));const ue=C.current;if(J.target!==ue||!aSe.includes(J.key))return;J.preventDefault();const Se=I().filter(we=>!we.disabled).map(we=>we.ref.current);UG.includes(J.key)&&Se.reverse(),PSe(Se)}),onBlur:_t(t.onBlur,J=>{J.currentTarget.contains(J.target)||(window.clearTimeout(P.current),A.current="")}),onPointerMove:_t(t.onPointerMove,Wp(J=>{const O=J.target,V=z.current!==J.clientX;if(J.currentTarget.contains(O)&&V){const G=J.clientX>z.current?"right":"left";j.current=G,z.current=J.clientX}}))})})})})})})});qG.displayName=Ji;var wSe="MenuGroup",eA=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Yt.div,{role:"group",...r,ref:e})});eA.displayName=wSe;var bSe="MenuLabel",KG=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Yt.div,{...r,ref:e})});KG.displayName=bSe;var kw="MenuItem",rL="menu.itemSelect",kb=p.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...s}=t,i=p.useRef(null),o=$g(kw,t.__scopeMenu),l=QP(kw,t.__scopeMenu),c=Cn(e,i),u=p.useRef(!1),d=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent(rL,{bubbles:!0,cancelable:!0});h.addEventListener(rL,m=>r==null?void 0:r(m),{once:!0}),W1(h,f),f.defaultPrevented?u.current=!1:o.onClose()}};return a.jsx(YG,{...s,ref:c,disabled:n,onClick:_t(t.onClick,d),onPointerDown:h=>{var f;(f=t.onPointerDown)==null||f.call(t,h),u.current=!0},onPointerUp:_t(t.onPointerUp,h=>{var f;u.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:_t(t.onKeyDown,h=>{const f=l.searchRef.current!=="";n||f&&h.key===" "||bT.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});kb.displayName=kw;var YG=p.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=t,o=QP(kw,n),l=zG(n),c=p.useRef(null),u=Cn(e,c),[d,h]=p.useState(!1),[f,m]=p.useState("");return p.useEffect(()=>{const g=c.current;g&&m((g.textContent??"").trim())},[i.children]),a.jsx(Gp.ItemSlot,{scope:n,disabled:r,textValue:s??f,children:a.jsx(tU,{asChild:!0,...l,focusable:!r,children:a.jsx(Yt.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:u,onPointerMove:_t(t.onPointerMove,Wp(g=>{r?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:_t(t.onPointerLeave,Wp(g=>o.onItemLeave(g))),onFocus:_t(t.onFocus,()=>h(!0)),onBlur:_t(t.onBlur,()=>h(!1))})})})}),_Se="MenuCheckboxItem",JG=p.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...s}=t;return a.jsx(t7,{scope:t.__scopeMenu,checked:n,children:a.jsx(kb,{role:"menuitemcheckbox","aria-checked":Rw(n)?"mixed":n,...s,ref:e,"data-state":nA(n),onSelect:_t(s.onSelect,()=>r==null?void 0:r(Rw(n)?!0:!n),{checkForDefaultPrevented:!1})})})});JG.displayName=_Se;var XG="MenuRadioGroup",[SSe,ESe]=Ju(XG,{value:void 0,onValueChange:()=>{}}),QG=p.forwardRef((t,e)=>{const{value:n,onValueChange:r,...s}=t,i=Rr(r);return a.jsx(SSe,{scope:t.__scopeMenu,value:n,onValueChange:i,children:a.jsx(eA,{...s,ref:e})})});QG.displayName=XG;var ZG="MenuRadioItem",e7=p.forwardRef((t,e)=>{const{value:n,...r}=t,s=ESe(ZG,t.__scopeMenu),i=n===s.value;return a.jsx(t7,{scope:t.__scopeMenu,checked:i,children:a.jsx(kb,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":nA(i),onSelect:_t(r.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,n)},{checkForDefaultPrevented:!1})})})});e7.displayName=ZG;var tA="MenuItemIndicator",[t7,CSe]=Ju(tA,{checked:!1}),n7=p.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...s}=t,i=CSe(tA,n);return a.jsx(qs,{present:r||Rw(i.checked)||i.checked===!0,children:a.jsx(Yt.span,{...s,ref:e,"data-state":nA(i.checked)})})});n7.displayName=tA;var TSe="MenuSeparator",r7=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Yt.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});r7.displayName=TSe;var ISe="MenuArrow",s7=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=Ab(n);return a.jsx(iSe,{...s,...r,ref:e})});s7.displayName=ISe;var NSe="MenuSub",[XRe,i7]=Ju(NSe),gm="MenuSubTrigger",o7=p.forwardRef((t,e)=>{const n=Xu(gm,t.__scopeMenu),r=$g(gm,t.__scopeMenu),s=i7(gm,t.__scopeMenu),i=QP(gm,t.__scopeMenu),o=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,u={__scopeMenu:t.__scopeMenu},d=p.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return p.useEffect(()=>d,[d]),p.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),a.jsx(JP,{asChild:!0,...u,children:a.jsx(YG,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":c7(n.open),...t,ref:c0(e,s.onTriggerChange),onClick:h=>{var f;(f=t.onClick)==null||f.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:_t(t.onPointerMove,Wp(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:_t(t.onPointerLeave,Wp(h=>{var m,g;d();const f=(m=n.content)==null?void 0:m.getBoundingClientRect();if(f){const x=(g=n.content)==null?void 0:g.dataset.side,E=x==="right",v=E?-5:5,b=f[E?"left":"right"],S=f[E?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+v,y:h.clientY},{x:b,y:f.top},{x:S,y:f.top},{x:S,y:f.bottom},{x:b,y:f.bottom}],side:x}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:_t(t.onKeyDown,h=>{var m;const f=i.searchRef.current!=="";t.disabled||f&&h.key===" "||lSe[r.dir].includes(h.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),h.preventDefault())})})})});o7.displayName=gm;var a7="MenuSubContent",l7=p.forwardRef((t,e)=>{const n=WG(Ji,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=Xu(Ji,t.__scopeMenu),o=$g(Ji,t.__scopeMenu),l=i7(a7,t.__scopeMenu),c=p.useRef(null),u=Cn(e,c);return a.jsx(Gp.Provider,{scope:t.__scopeMenu,children:a.jsx(qs,{present:r||i.open,children:a.jsx(Gp.Slot,{scope:t.__scopeMenu,children:a.jsx(ZP,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;o.isUsingKeyboardRef.current&&((h=c.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:_t(t.onFocusOutside,d=>{d.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:_t(t.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:_t(t.onKeyDown,d=>{var m;const h=d.currentTarget.contains(d.target),f=cSe[o.dir].includes(d.key);h&&f&&(i.onOpenChange(!1),(m=l.trigger)==null||m.focus(),d.preventDefault())})})})})})});l7.displayName=a7;function c7(t){return t?"open":"closed"}function Rw(t){return t==="indeterminate"}function nA(t){return Rw(t)?"indeterminate":t?"checked":"unchecked"}function PSe(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function ASe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function kSe(t,e,n){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=ASe(t,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function RSe(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const l=e[i],c=e[o],u=l.x,d=l.y,h=c.x,f=c.y;d>r!=f>r&&n<(h-u)*(r-d)/(f-d)+u&&(s=!s)}return s}function jSe(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return RSe(n,e)}function Wp(t){return e=>e.pointerType==="mouse"?t(e):void 0}var DSe=GG,MSe=JP,LSe=HG,FSe=qG,OSe=eA,$Se=KG,VSe=kb,USe=JG,BSe=QG,zSe=e7,GSe=n7,WSe=r7,HSe=s7,qSe=o7,KSe=l7,Rb="DropdownMenu",[YSe,QRe]=Li(Rb,[BG]),Ys=BG(),[JSe,u7]=YSe(Rb),d7=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:o,modal:l=!0}=t,c=Ys(e),u=p.useRef(null),[d,h]=Bu({prop:s,defaultProp:i??!1,onChange:o,caller:Rb});return a.jsx(JSe,{scope:e,triggerId:uu(),triggerRef:u,contentId:uu(),open:d,onOpenChange:h,onOpenToggle:p.useCallback(()=>h(f=>!f),[h]),modal:l,children:a.jsx(DSe,{...c,open:d,onOpenChange:h,dir:r,modal:l,children:n})})};d7.displayName=Rb;var h7="DropdownMenuTrigger",f7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=t,i=u7(h7,n),o=Ys(n);return a.jsx(MSe,{asChild:!0,...o,children:a.jsx(Yt.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:c0(e,i.triggerRef),onPointerDown:_t(t.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:_t(t.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});f7.displayName=h7;var XSe="DropdownMenuPortal",m7=t=>{const{__scopeDropdownMenu:e,...n}=t,r=Ys(e);return a.jsx(LSe,{...r,...n})};m7.displayName=XSe;var p7="DropdownMenuContent",g7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=u7(p7,n),i=Ys(n),o=p.useRef(!1);return a.jsx(FSe,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:e,onCloseAutoFocus:_t(t.onCloseAutoFocus,l=>{var c;o.current||(c=s.triggerRef.current)==null||c.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:_t(t.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,d=c.button===2||u;(!s.modal||d)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});g7.displayName=p7;var QSe="DropdownMenuGroup",ZSe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Ys(n);return a.jsx(OSe,{...s,...r,ref:e})});ZSe.displayName=QSe;var eEe="DropdownMenuLabel",y7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Ys(n);return a.jsx($Se,{...s,...r,ref:e})});y7.displayName=eEe;var tEe="DropdownMenuItem",x7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Ys(n);return a.jsx(VSe,{...s,...r,ref:e})});x7.displayName=tEe;var nEe="DropdownMenuCheckboxItem",v7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Ys(n);return a.jsx(USe,{...s,...r,ref:e})});v7.displayName=nEe;var rEe="DropdownMenuRadioGroup",sEe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Ys(n);return a.jsx(BSe,{...s,...r,ref:e})});sEe.displayName=rEe;var iEe="DropdownMenuRadioItem",w7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Ys(n);return a.jsx(zSe,{...s,...r,ref:e})});w7.displayName=iEe;var oEe="DropdownMenuItemIndicator",b7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Ys(n);return a.jsx(GSe,{...s,...r,ref:e})});b7.displayName=oEe;var aEe="DropdownMenuSeparator",_7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Ys(n);return a.jsx(WSe,{...s,...r,ref:e})});_7.displayName=aEe;var lEe="DropdownMenuArrow",cEe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Ys(n);return a.jsx(HSe,{...s,...r,ref:e})});cEe.displayName=lEe;var uEe="DropdownMenuSubTrigger",S7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Ys(n);return a.jsx(qSe,{...s,...r,ref:e})});S7.displayName=uEe;var dEe="DropdownMenuSubContent",E7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Ys(n);return a.jsx(KSe,{...s,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});E7.displayName=dEe;var hEe=d7,fEe=f7,mEe=m7,C7=g7,T7=y7,I7=x7,N7=v7,P7=w7,A7=b7,k7=_7,R7=S7,j7=E7;const pEe=hEe,gEe=fEe,yEe=p.forwardRef(({className:t,inset:e,children:n,...r},s)=>a.jsxs(R7,{ref:s,className:Et("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...r,children:[n,a.jsx(Wse,{className:"ml-auto"})]}));yEe.displayName=R7.displayName;const xEe=p.forwardRef(({className:t,...e},n)=>a.jsx(j7,{ref:n,className:Et("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...e}));xEe.displayName=j7.displayName;const D7=p.forwardRef(({className:t,sideOffset:e=4,...n},r)=>a.jsx(mEe,{children:a.jsx(C7,{ref:r,sideOffset:e,className:Et("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n})}));D7.displayName=C7.displayName;const Ad=p.forwardRef(({className:t,inset:e,...n},r)=>a.jsx(I7,{ref:r,className:Et("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",e&&"pl-8",t),...n}));Ad.displayName=I7.displayName;const vEe=p.forwardRef(({className:t,children:e,checked:n,...r},s)=>a.jsxs(N7,{ref:s,className:Et("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(A7,{children:a.jsx(rg,{className:"h-4 w-4"})})}),e]}));vEe.displayName=N7.displayName;const wEe=p.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(P7,{ref:r,className:Et("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(A7,{children:a.jsx(qse,{className:"h-2 w-2 fill-current"})})}),e]}));wEe.displayName=P7.displayName;const M7=p.forwardRef(({className:t,inset:e,...n},r)=>a.jsx(T7,{ref:r,className:Et("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));M7.displayName=T7.displayName;const L7=p.forwardRef(({className:t,...e},n)=>a.jsx(k7,{ref:n,className:Et("-mx-1 my-1 h-px bg-muted",t),...e}));L7.displayName=k7.displayName;var F7="basil",bEe=function(e){return e===3?"v3":e},O7="https://js.stripe.com",_Ee="".concat(O7,"/").concat(F7,"/stripe.js"),SEe=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,EEe=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,sL="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",CEe=function(e){return SEe.test(e)||EEe.test(e)},TEe=function(){for(var e=document.querySelectorAll('script[src^="'.concat(O7,'"]')),n=0;n<e.length;n++){var r=e[n];if(CEe(r.src))return r}return null},iL=function(e){var n=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(_Ee).concat(n);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(r),r},IEe=function(e,n){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"7.3.1",startTime:n})},qf=null,Qy=null,Zy=null,NEe=function(e){return function(n){e(new Error("Failed to load Stripe.js",{cause:n}))}},PEe=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},AEe=function(e){return qf!==null?qf:(qf=new Promise(function(n,r){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe&&e&&console.warn(sL),window.Stripe){n(window.Stripe);return}try{var s=TEe();if(s&&e)console.warn(sL);else if(!s)s=iL(e);else if(s&&Zy!==null&&Qy!==null){var i;s.removeEventListener("load",Zy),s.removeEventListener("error",Qy),(i=s.parentNode)===null||i===void 0||i.removeChild(s),s=iL(e)}Zy=PEe(n,r),Qy=NEe(r),s.addEventListener("load",Zy),s.addEventListener("error",Qy)}catch(o){r(o);return}}),qf.catch(function(n){return qf=null,Promise.reject(n)}))},kEe=function(e,n,r){if(e===null)return null;var s=n[0],i=s.match(/^pk_test/),o=bEe(e.version),l=F7;i&&o!==l&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("7.3.1"," expected Stripe.js@").concat(l,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var c=e.apply(void 0,n);return IEe(c,r),c},Kf,$7=!1,V7=function(){return Kf||(Kf=AEe(null).catch(function(e){return Kf=null,Promise.reject(e)}),Kf)};Promise.resolve().then(function(){return V7()}).catch(function(t){$7||console.warn(t)});var rA=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];$7=!0;var s=Date.now();return V7().then(function(i){return kEe(i,n,s)})};const REe="pk_live_51NAoUjDktew9heHOJD5Px4jn1IaolhvVvqoE6NukJV7MxZa8PhIVSwcOVWXdQx6MFNgIGmEYeg64lFUGlYfAyVqu004n16tAdG",jEe=rA(REe),DEe={}.VITE_STRIPE_PRO_PLAN_PRICE_ID||"price_1RPDinDktew9heHOLkkL3ZDv",_T=({onSubscribed:t,className:e=""})=>{const{user:n,isAuthenticated:r}=ro(),[s,i]=p.useState(!1),[o,l]=p.useState(null),c=async()=>{if(!r||!n){l("You must be logged in to subscribe.");return}i(!0),l(null);try{const u=Sb(),d=gh(u,"createStripeCheckoutSession"),h=`${window.location.origin}/dashboard?subscription_success=true`,f=`${window.location.origin}/pricing`,m={priceId:DEe,quantity:1,successUrl:h,cancelUrl:f};console.log("Calling createStripeCheckoutSession with payload:",m);const g=await d(m),{sessionId:x,error:E}=g.data;if(E)throw console.error("Firebase function error:",E),new Error(E.message||"Failed to create subscription session via Firebase function.");if(!x)throw console.error("No sessionId returned from Firebase function"),new Error("Failed to retrieve a session ID from the server.");console.log("Received sessionId:",x);const v=await jEe,{error:b}=await v.redirectToCheckout({sessionId:x});b?(console.error("Stripe redirect error:",b),l(b.message)):t&&t()}catch(u){console.error("Subscription error:",u.message,u),l(u.message)}finally{i(!1)}};return a.jsxs("div",{children:[a.jsx(U,{onClick:c,disabled:s,className:`bg-gradient-to-r from-[#77B8B8] to-[#3B82F6] hover:from-[#6AB0B0] hover:to-[#2F73E0] text-white ${e}`,children:s?"Processing...":"Subscribe to Pro"}),o&&a.jsxs("p",{style:{color:"red",marginTop:"10px",fontSize:"0.8rem"},children:["Error: ",o]})," "]})},sA=()=>{const{isAuthenticated:t,user:e,logout:n,session:r,subscriptionStatus:s,loadingProfile:i,profile:o}=ro(),l=di(),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),[g,x]=p.useState(null),[E,v]=p.useState(!1),[b,S]=p.useState(!1),I=s==="active",D=(o==null?void 0:o.stripe_account_id)&&(o==null?void 0:o.stripe_account_details_submitted);p.useEffect(()=>{const R=localStorage.getItem("theme"),M=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;R==="dark"||!R&&M?(document.documentElement.classList.add("dark"),v(!0)):(document.documentElement.classList.remove("dark"),v(!1))},[]);const k=()=>{E?(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")),v(!E)},C=async()=>{try{await n(),l("/auth")}catch(R){console.error("Error logging out:",R)}},T=async()=>{if(!e){h("Authentication required. Please log in again.");return}u(!0),h(null);try{const j=(await gh(_S,"stripeCreatePortalSession")()).data;if(j&&j.url)window.location.href=j.url;else throw new Error(j.error||"Failed to create portal session URL.")}catch(R){console.error("Portal session error:",R),h(R.message||"An unexpected error occurred.")}finally{u(!1)}},P=async()=>{if(!e){x("Authentication required.");return}m(!0),x(null);try{const j=(await gh(_S,"stripeCreateConnectAccount")({email:e.email})).data;if(j&&j.accountLinkUrl)window.location.href=j.accountLinkUrl;else throw new Error(j.error||"Failed to create Stripe Connect account link.")}catch(R){console.error("Stripe Connect account creation error:",R),x(R.message||"An unexpected error occurred.")}finally{m(!1)}},A=async()=>{if(!e||!(o!=null&&o.stripe_account_id)){x("Stripe account not connected or user not authenticated.");return}m(!0),x(null);try{const j=(await gh(_S,"stripeCreateLoginLink")({stripeAccountId:o.stripe_account_id})).data;if(j&&j.loginLinkUrl)window.location.href=j.loginLinkUrl;else throw new Error(j.error||"Failed to create Stripe login link.")}catch(R){console.error("Stripe login link error:",R),x(R.message||"An unexpected error occurred.")}finally{m(!1)}};return a.jsxs(a.Fragment,{children:[!i&&t&&!D&&a.jsxs("div",{className:"bg-foreground text-background py-2 px-4 text-center text-sm dark:bg-blue-700 dark:text-white",children:[a.jsx("button",{onClick:P,disabled:f,className:"hover:underline focus:outline-none",children:f?"Processing...":"Create A Business to Activate Checkout"}),g&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:g})]}),a.jsxs(It.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full py-4 px-6 flex justify-between items-center sticky top-0 z-50 bg-background/80 backdrop-blur-md border-b",children:[a.jsxs(Us,{to:"/",className:"flex items-center gap-2",children:[a.jsx("img",{src:E?"https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/ffwhite.png?alt=media&token=a8f26828-97a9-42b9-9bd3-3c63506f894b":"https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/Ffblack%20(1).png?alt=media&token=ccd72cd1-cd34-4670-a453-9e8424a3c93b",alt:"FreshFront Logo",className:"h-10 sm:h-[60px] w-auto transition-all"}),a.jsx("span",{className:"font-bold text-lg sm:text-xl transition-all",children:"FreshFront"})]}),a.jsxs("nav",{className:"hidden md:flex items-center gap-3",children:[t&&!i&&a.jsxs(a.Fragment,{children:[a.jsx(_T,{className:"px-3 py-1.5 rounded-full text-sm font-medium",showIcon:!0}),a.jsxs(pEe,{children:[a.jsx(gEe,{asChild:!0,children:a.jsxs(U,{variant:"outline",size:"sm",className:"rounded-full px-3 py-1.5 text-sm font-medium",children:[a.jsx(Gse,{className:"mr-2 h-4 w-4"})," Business ",a.jsx(f0,{className:"ml-1 h-4 w-4"})]})}),a.jsxs(D7,{align:"end",children:[a.jsx(M7,{children:"Stripe Connect"}),a.jsx(L7,{}),D?a.jsxs(Ad,{onClick:A,disabled:f,children:[a.jsx(zd,{className:"mr-2 h-4 w-4"})," ",f?"Processing...":"Dashboard"]}):a.jsxs(Ad,{onClick:P,disabled:f,children:[a.jsx(zd,{className:"mr-2 h-4 w-4"}),f?"Processing...":"Create Business Account"]}),I&&a.jsxs(Ad,{onClick:T,disabled:c,children:[a.jsx(wp,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Billing"]}),g&&a.jsx(Ad,{disabled:!0,children:a.jsx("p",{className:"text-xs text-destructive",children:g})}),d&&a.jsx(Ad,{disabled:!0,children:a.jsx("p",{className:"text-xs text-destructive",children:d})})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Wo,{id:"theme-switcher-desktop",checked:E,onCheckedChange:k,"aria-label":"Toggle dark mode"}),E?a.jsx(nC,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(rC,{className:"h-5 w-5 text-muted-foreground"})]}),t?a.jsxs(a.Fragment,{children:[(e==null?void 0:e.photoURL)&&a.jsx("img",{src:e.photoURL,alt:"User avatar",className:"h-6 w-6 rounded-full"}),a.jsxs("span",{className:"text-sm text-muted-foreground hidden lg:inline",children:[" ",e==null?void 0:e.email]}),a.jsxs(U,{variant:"outline",size:"sm",onClick:C,children:[a.jsx(Gj,{className:"mr-2 h-4 w-4"})," Logout"]})]}):a.jsx(Us,{to:"/auth",children:a.jsxs(U,{variant:"outline",size:"sm",children:[a.jsx(zj,{className:"mr-2 h-4 w-4"})," Login"]})})]}),a.jsx("div",{className:"md:hidden",children:a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>S(!b),children:b?a.jsx(ra,{className:"h-6 w-6"}):a.jsx(YV,{className:"h-6 w-6"})})})]}),a.jsx(Eu,{children:b&&a.jsx(It.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"md:hidden fixed inset-x-0 top-[117px] z-40 bg-background/95 backdrop-blur-sm p-6 border-b shadow-lg",children:a.jsxs("nav",{className:"flex flex-col gap-4",children:[t&&!i&&a.jsxs(a.Fragment,{children:[a.jsx(_T,{className:"w-full justify-start px-3 py-2 text-base",showIcon:!0}),D?a.jsxs(U,{variant:"outline",onClick:A,disabled:f,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(zd,{className:"mr-2 h-4 w-4"})," ",f?"Processing...":"Dashboard"]}):a.jsxs(U,{variant:"outline",onClick:P,disabled:f,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(zd,{className:"mr-2 h-4 w-4"}),f?"Processing...":"Create Business Account"]}),I&&a.jsxs(U,{variant:"outline",onClick:T,disabled:c,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(wp,{className:"mr-2 h-4 w-4"})," ",c?"Loading...":"Manage Billing"]}),g&&a.jsx("p",{className:"text-xs text-destructive px-3 py-1",children:g}),d&&a.jsx("p",{className:"text-xs text-destructive px-3 py-1",children:d})]}),a.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[a.jsx("span",{className:"text-base",children:"Dark Mode"}),a.jsx(Wo,{id:"theme-switcher-mobile",checked:E,onCheckedChange:k,"aria-label":"Toggle dark mode"})]}),t?a.jsxs(a.Fragment,{children:[(e==null?void 0:e.photoURL)&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",children:[a.jsx("img",{src:e.photoURL,alt:"User avatar",className:"h-8 w-8 rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:e==null?void 0:e.email})]}),a.jsxs(U,{variant:"outline",onClick:C,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(Gj,{className:"mr-2 h-4 w-4"})," Logout"]})]}):a.jsx(Us,{to:"/auth",className:"w-full",children:a.jsxs(U,{variant:"outline",className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(zj,{className:"mr-2 h-4 w-4"})," Login"]})})]})})})]})},oL=["Create a luxury jewelry store called 'Elegance' with diamond rings and gold necklaces, featuring a dark, sophisticated theme.","Build a tech gadget store named 'FutureTech' with the latest smartphones and accessories, using a futuristic blue and silver color scheme.","Design an organic food market 'GreenHarvest' with fresh produce and healthy snacks, emphasizing natural textures and earthy tones.","Make a trendy fashion boutique 'Urban Threads' with summer dresses and casual wear, aiming for a bright, minimalist aesthetic."],CS={"Healthy Food":{keywords:["healthy food","organic food","greenharvest","fresh produce","natural food","health store"],primaryColor:"green",secondaryColor:"orange",templates:["Classic","Fresh","Sleek"]},"Fast Food":{keywords:["fast food","burgers","fries","pizza","takeaway","quick serve"],primaryColor:"red",secondaryColor:"orange",templates:["Premium","Modern","Classic","Fresh","Sleek"]},Technology:{keywords:["tech","gadget","electronics","software","computer","phone","futuretech"],primaryColor:"blue",secondaryColor:"purple",templates:["Classic","Fresh","Sleek","Sharp","Premium","Modern"]},"General Store":{keywords:["general store","variety store","convenience store","department store"],primaryColor:"navy",secondaryColor:"grey",templates:["Classic","Fresh","Sleek","Premium","Modern"]},"Female Fashion/Beauty":{keywords:["female fashion","beauty","cosmetics","makeup","women's clothing","boutique","urban threads"],primaryColor:"peach",secondaryColor:"purple",templates:["Classic","Fresh","Sleek"]},Jewelry:{keywords:["jewelry","rings","necklaces","earrings","diamonds","gold","elegance"],primaryColor:"grey",secondaryColor:"darkpurple",templates:["Classic","Fresh","Sleek","Premium","Modern"]},Fashion:{keywords:["fashion","clothing","apparel","style","wear"],primaryColor:"navyblue",secondaryColor:"mediumred",templates:["Classic","Fresh","Sleek","Premium","Modern"]},Furniture:{keywords:["furniture","home decor","sofa","table","chair","furnishings"],primaryColor:"brown",secondaryColor:"darkgrey",templates:["Classic","Fresh","Sleek"]},Default:{keywords:[],primaryColor:"blue",secondaryColor:"gray",templates:["Fresh","Classic","Sleek","Modern"]}},MEe=t=>{const e=t.toLowerCase();for(const n in CS){if(n==="Default")continue;const r=CS[n];if(r.keywords.some(s=>e.includes(s.toLowerCase())))return{...r,name:n}}return{...CS.Default,name:"General Store"}},LEe=()=>{const[t,e]=p.useState(""),[n,r]=p.useState(""),[s,i]=p.useState(null),[o,l]=p.useState(!1),{generateStore:c,isGenerating:u,importedStoreDataForGenerator:d,isImportDataReadyForGenerator:h,clearImportedStoreDataForGenerator:f}=Fn(),[m,g]=p.useState(!1),[x,E]=p.useState(null),[v,b]=p.useState(!1);p.useEffect(()=>{h&&d&&(e(d.name||""),r(d.prompt||""),d.name&&I(d.name),f())},[h,d,f]);const S=C=>{e(C.target.value),E(null)},I=p.useCallback(async C=>{const T=C||t;if(!T.trim())return E({status:"error",message:"Store name cannot be empty."}),!1;g(!0),E(null);try{return await yT(T.trim())?(E({status:"claimed",message:"Not available"}),!1):(E({status:"available",message:"Available"}),!0)}catch(P){return console.error("Store name availability check failed in StoreGenerator:",P),E({status:"error",message:P.message||"Failed to check name. Please try again."}),!1}finally{g(!1)}},[t]),D=C=>{i(C);const T=oL[C],P=T.match(/(?:store called|store named|market|boutique) '([^']+)'/i),A=P&&P[1]?P[1]:"";e(A),r(T),E(null),A&&setTimeout(()=>I(A),0)},k=async C=>{C.preventDefault();let T=!1;if(x&&x.status==="available"?T=!0:t.trim()?T=await I(t):E({status:"error",message:"Store name cannot be empty."}),!T)return;if(!n.trim()){alert("Please provide a description for your store.");return}if(u||m||v)return;const P=MEe(n);let A=[];if(o){b(!0);const R=[Oo.find(j=>j.name==="Canvas"),Oo.find(j=>j.name==="Hat"),Oo.find(j=>j.name==="Black hoodie"),Oo.find(j=>j.name==="Mug"),Oo.find(j=>j.name==="Notebook"),Oo.find(j=>j.name==="Pillow")].filter(Boolean);if(R.length===0){alert("Could not find specified POD products for generation.");return}const M=R.slice(0,6);for(const j of M)try{console.log(`Generating initial design for ${j.name}...`);const z=await b0({prompt:n});if(!z||!z.imageData||!z.imageMimeType){console.error(`Failed to generate initial design for ${j.name}`);continue}const W=z.imageData,q=z.imageMimeType,H=`data:${q};base64,${W}`;console.log(`Initial design for ${j.name} generated.`),console.log(`Visualizing design on ${j.name}...`);const $=await og(W,q,j.imageUrl,n,j.name);if(!$||!$.visualizedImageData||!$.productDetails){console.error(`Failed to visualize design on ${j.name}. Error: ${$==null?void 0:$.error}`);continue}const J=`data:${$.visualizedImageMimeType};base64,${$.visualizedImageData}`;console.log(`Visualization for ${j.name} complete.`),A.push({id:tn(),name:$.productDetails.title||`${j.name} with "${n.substring(0,20)}..." Design`,description:$.productDetails.description||`A unique ${j.name} featuring a custom design based on your prompt.`,price:$.productDetails.price||"29.99",images:[H,J],variants:$.productDetails.variants||[],isPrintOnDemand:!0,podDetails:{originalDesignImageUrl:H,designPrompt:n,baseProductName:j.name,baseProductImageUrl:j.imageUrl},category:j.category||"Print on Demand"})}catch(z){console.error(`Error processing POD product ${j.name}:`,z)}console.log("Generated POD products:",A),M.length>0&&A.length===0&&alert("Print on Demand generation was enabled, but no POD products could be created. Please check the console for errors. Proceeding with standard store generation if applicable."),b(!1)}try{await c(n,t,P,A)}catch(R){console.error("Error calling generateStore from StoreGenerator:",R),alert(`An error occurred during the final store generation step: ${R.message}`),b(!1)}};return a.jsx(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full",children:a.jsxs("form",{onSubmit:k,className:"space-y-6",children:[" ",a.jsxs("div",{children:[a.jsx("label",{htmlFor:"storeName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Store Name"}),a.jsxs("div",{className:"relative flex items-center",children:[a.jsx(st,{id:"storeName",type:"text",placeholder:"ex. Future Furniture",className:Et("text-base flex-grow",(x==null?void 0:x.status)==="claimed"&&"border-red-500 focus:border-red-500 dark:border-red-500 dark:focus:border-red-500",(x==null?void 0:x.status)==="error"&&"border-yellow-500 focus:border-yellow-500 dark:border-yellow-500 dark:focus:border-yellow-500",(x==null?void 0:x.status)==="available"&&"border-green-500 focus:border-green-500 dark:border-green-500 dark:focus:border-green-500","pr-24"),value:t,onChange:S,disabled:u||m}),a.jsxs(U,{type:"button",variant:"ghost",size:"sm",onClick:()=>I(),disabled:!t.trim()||m,className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 px-2 z-10",children:[m?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(Yo,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-1 hidden sm:inline",children:"Check"})]})]}),a.jsxs("div",{className:"h-5 mt-1",children:[" ",m&&t.trim()&&a.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[a.jsx(St,{className:"h-4 w-4 animate-spin mr-2"})," Checking..."]}),x&&t.trim()&&!m&&a.jsxs("p",{className:`text-sm font-medium flex items-center ${x.status==="available"?"text-green-600":x.status==="claimed"?"text-red-600":x.status==="error"?"text-yellow-600":"text-muted-foreground"}`,children:[x.status==="available"&&a.jsx(Yo,{className:"h-4 w-4 mr-1"}),x.status==="claimed"&&a.jsx(Vj,{className:"h-4 w-4 mr-1"}),x.status==="error"&&a.jsx(Vj,{className:"h-4 w-4 mr-1"}),x.message]})]})]}),a.jsxs("div",{className:"-mt-[15px]",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("label",{htmlFor:"storePrompt",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"printOnDemandCheckbox",checked:o,onChange:C=>l(C.target.checked),className:"appearance-none h-5 w-5 border border-gray-400 dark:border-gray-500 rounded-full checked:bg-blue-600 checked:border-transparent focus:outline-none focus:ring-2 focus:ring-offset-1 dark:focus:ring-offset-gray-900 focus:ring-blue-500 cursor-pointer"}),a.jsx("label",{htmlFor:"printOnDemandCheckbox",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Print on Demand"})]})]}),a.jsx(Vn,{id:"storePrompt",placeholder:"e.g., 'A modern furniture store specializing in sustainable and innovative designs for the contemporary home. Focus on minimalist aesthetics and smart functionality.'",className:"min-h-[120px] text-base resize-none w-full",value:n,onChange:C=>r(C.target.value),disabled:u})]})," ",a.jsx(U,{type:"submit",disabled:!t.trim()||!n.trim()||u||m||v||x&&x.status!=="available",className:"w-full bg-gradient-to-r from-green-600 to-cyan-600 hover:from-green-700 hover:to-cyan-700 text-white mt-6",size:"lg",children:v?a.jsxs(a.Fragment,{children:[a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing Print on Demand Designs..."]}):u?a.jsxs(a.Fragment,{children:[a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Store..."]}):a.jsxs(a.Fragment,{children:[a.jsx(na,{className:"mr-2 h-4 w-4"}),"Generate Store"]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Or try one of these examples for inspiration:"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:oL.map((C,T)=>a.jsx(U,{type:"button",variant:"outline",className:Et("h-auto py-2 px-3 justify-start text-left text-sm font-normal",s===T?"bg-[#c9ccd1] text-black hover:bg-[#c9ccd1] dark:bg-[#242424] dark:text-gray-300 dark:hover:bg-[#242424]":"hover:bg-accent hover:text-accent-foreground"),onClick:()=>D(T),disabled:u,children:C},T))})]})]})})};var U7="AlertDialog",[FEe,ZRe]=Li(U7,[_3]),Ja=_3(),B7=t=>{const{__scopeAlertDialog:e,...n}=t,r=Ja(e);return a.jsx(O3,{...r,...n,modal:!0})};B7.displayName=U7;var OEe="AlertDialogTrigger",z7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Ja(n);return a.jsx(Roe,{...s,...r,ref:e})});z7.displayName=OEe;var $Ee="AlertDialogPortal",G7=t=>{const{__scopeAlertDialog:e,...n}=t,r=Ja(e);return a.jsx($3,{...r,...n})};G7.displayName=$Ee;var VEe="AlertDialogOverlay",W7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Ja(n);return a.jsx(iI,{...s,...r,ref:e})});W7.displayName=VEe;var xh="AlertDialogContent",[UEe,BEe]=FEe(xh),zEe=Qre("AlertDialogContent"),H7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,children:r,...s}=t,i=Ja(n),o=p.useRef(null),l=Cn(e,o),c=p.useRef(null);return a.jsx(Noe,{contentName:xh,titleName:q7,docsSlug:"alert-dialog",children:a.jsx(UEe,{scope:n,cancelRef:c,children:a.jsxs(oI,{role:"alertdialog",...i,...s,ref:l,onOpenAutoFocus:_t(s.onOpenAutoFocus,u=>{var d;u.preventDefault(),(d=c.current)==null||d.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[a.jsx(zEe,{children:r}),a.jsx(WEe,{contentRef:o})]})})})});H7.displayName=xh;var q7="AlertDialogTitle",K7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Ja(n);return a.jsx(aI,{...s,...r,ref:e})});K7.displayName=q7;var Y7="AlertDialogDescription",J7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Ja(n);return a.jsx(lI,{...s,...r,ref:e})});J7.displayName=Y7;var GEe="AlertDialogAction",X7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Ja(n);return a.jsx(y0,{...s,...r,ref:e})});X7.displayName=GEe;var Q7="AlertDialogCancel",Z7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,{cancelRef:s}=BEe(Q7,n),i=Ja(n),o=Cn(e,s);return a.jsx(y0,{...i,...r,ref:o})});Z7.displayName=Q7;var WEe=({contentRef:t})=>{const e=`\`${xh}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${xh}\` by passing a \`${Y7}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${xh}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{var r;document.getElementById((r=t.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(e)},[e,t]),null},HEe=B7,qEe=z7,KEe=G7,eW=W7,tW=H7,nW=X7,rW=Z7,sW=K7,iW=J7;const YEe=HEe,JEe=qEe,XEe=KEe,oW=ht.forwardRef(({className:t,...e},n)=>a.jsx(eW,{className:Et("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:n}));oW.displayName=eW.displayName;const aW=ht.forwardRef(({className:t,...e},n)=>a.jsxs(XEe,{children:[a.jsx(oW,{}),a.jsx(tW,{ref:n,className:Et("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e})]}));aW.displayName=tW.displayName;const lW=({className:t,...e})=>a.jsx("div",{className:Et("flex flex-col space-y-2 text-center sm:text-left",t),...e});lW.displayName="AlertDialogHeader";const cW=({className:t,...e})=>a.jsx("div",{className:Et("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});cW.displayName="AlertDialogFooter";const uW=ht.forwardRef(({className:t,...e},n)=>a.jsx(sW,{ref:n,className:Et("text-lg font-semibold",t),...e}));uW.displayName=sW.displayName;const dW=ht.forwardRef(({className:t,...e},n)=>a.jsx(iW,{ref:n,className:Et("text-sm text-muted-foreground",t),...e}));dW.displayName=iW.displayName;const hW=ht.forwardRef(({className:t,...e},n)=>a.jsx(nW,{ref:n,className:Et(cI(),t),...e}));hW.displayName=nW.displayName;const fW=ht.forwardRef(({className:t,...e},n)=>a.jsx(rW,{ref:n,className:Et(cI({variant:"outline"}),"mt-2 sm:mt-0",t),...e}));fW.displayName=rW.displayName;const QEe=({store:t})=>{const e=di(),{deleteStore:n,updateStorePassKey:r,assignStoreManager:s,updateStoreTemplateVersion:i}=Fn(),[o,l]=ht.useState(""),[c,u]=ht.useState(""),[d,h]=ht.useState(!1),f=()=>{r&&o&&t.id&&r(t.id,o)},m=()=>{s&&c&&t.id&&s(t.id,c)},g=E=>{if(!E)return"N/A";try{const v=new Date(E);return isNaN(v.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(v)}catch(v){return console.error("Error formatting date:",E,v),"Error Date"}},x=E=>{switch(E){case"fashion":return a.jsx(XV,{className:"h-5 w-5 text-pink-500"});case"electronics":return a.jsx(_y,{className:"h-5 w-5 text-blue-500"});case"food":return a.jsx(_y,{className:"h-5 w-5 text-green-500"});case"jewelry":return a.jsx(_y,{className:"h-5 w-5 text-amber-500"});default:return a.jsx(_y,{className:"h-5 w-5 text-gray-500"})}};return a.jsx(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"store-preview relative bg-cover bg-center rounded-[15px] overflow-hidden",style:t.card_background_url?{backgroundImage:`url(${t.card_background_url})`}:{backgroundColor:"#374151"},children:a.jsxs(We,{className:"h-full overflow-hidden border-2 border-white/20 hover:border-primary/50 transition-all duration-300 bg-black/30 backdrop-blur-sm text-white rounded-[15px]",children:[" ",a.jsxs("div",{className:"relative z-10 p-1 rounded-[15px]",children:[" ",a.jsxs(ot,{className:"pb-2",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[t.logo_url?a.jsx("img",{src:t.logo_url,alt:`${t.name} logo`,className:"h-6 w-6 rounded-sm object-contain bg-white/30 p-0.5"}):x(t.type),a.jsx(at,{className:"text-xl text-white drop-shadow-md",children:t.name})]}),a.jsx("span",{className:"px-2 py-1 bg-white/10 text-gray-200 text-xs rounded-full backdrop-blur-xs",children:t.type.charAt(0).toUpperCase()+t.type.slice(1)})]}),a.jsx(qt,{className:"line-clamp-2 mt-1 text-gray-300 drop-shadow-sm",children:t.description})]}),a.jsxs(tt,{className:"pb-2",children:[a.jsxs("div",{className:"flex items-center text-sm text-gray-300 drop-shadow-sm gap-1 mb-3",children:[a.jsx(X1,{className:"h-3.5 w-3.5 mr-1 text-gray-400"}),"Created on ",g(t.created_at||t.createdAt)]}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:t&&t.products&&Array.isArray(t.products)&&t.products.length>0?t.products.slice(0,4).map(E=>a.jsxs("div",{className:"bg-white/10 p-2 rounded-md text-xs flex flex-col backdrop-blur-xs",children:[a.jsx("span",{className:"font-medium truncate text-gray-200",children:E.name||"Unnamed Product"}),a.jsxs("span",{className:"text-sky-300",children:[" ",typeof E.price=="number"?`$${E.price.toFixed(2)}`:"Price N/A"]})]},E.id)):a.jsx("p",{className:"text-xs text-gray-400 col-span-2",children:t&&t.products&&t.products.length===0?"No products yet.":"Product data unavailable."})})]}),a.jsxs(Yu,{className:"flex flex-col items-start gap-2 pt-2",children:[a.jsxs("div",{className:"flex w-full justify-between items-center",children:[a.jsx(U,{variant:"outline",size:"sm",className:"bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:()=>{t&&t.name?e(`/${Wl(t.name)}`):console.error("Store name is missing, cannot navigate to preview.")},children:"Preview"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(U,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-300 hover:text-white hover:bg-white/10",onClick:()=>t&&t.name&&e(`/${Wl(t.name)}?edit=true`),children:[a.jsx(kv,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Edit"})]}),a.jsxs(YEe,{children:[a.jsx(JEe,{asChild:!0,children:a.jsxs(U,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-400 hover:text-red-300 hover:bg-red-500/10",children:[a.jsx(sr,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Delete"})]})}),a.jsxs(aW,{children:[a.jsxs(lW,{children:[a.jsx(uW,{children:"Are you sure?"}),a.jsxs(dW,{children:['This will permanently delete the "',t.name,'" store and all its data. This action cannot be undone.']})]}),a.jsxs(cW,{children:[a.jsx(fW,{children:"Cancel"}),a.jsx(hW,{className:"bg-red-500 text-white hover:bg-red-600",onClick:()=>n(t.id),children:"Delete"})]})]})]})]})]}),a.jsxs("div",{className:"flex w-full items-center gap-2 mt-2",children:[a.jsx(st,{type:"password",placeholder:"Set Pass Key",value:o,onChange:E=>l(E.target.value),className:"h-8 text-xs flex-grow bg-neutral-700/60 dark:bg-neutral-800/60 border-neutral-500 dark:border-neutral-600 placeholder-zinc-400 text-white focus:outline-none"}),a.jsxs(U,{variant:"outline",size:"icon",className:"h-8 w-8 bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:f,disabled:!o.trim(),children:[a.jsx(KV,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Set Pass Key"})]})]}),a.jsxs("div",{className:"w-full mt-2",children:[a.jsx(U,{variant:"outline",size:"sm",className:"w-full bg-white/10 hover:bg-white/20 text-gray-200 border-gray-500 hover:border-gray-400",onClick:()=>h(!d),children:d?"Cancel Assignment":"Assign Manager"}),d&&a.jsxs("div",{className:"flex w-full items-center gap-2 mt-2",children:[a.jsx(st,{type:"email",placeholder:"Manager Email",value:c,onChange:E=>u(E.target.value),className:"h-8 text-xs flex-grow bg-neutral-700/60 dark:bg-neutral-800/60 border-neutral-500 dark:border-neutral-600 placeholder-zinc-400 text-white focus:outline-none"}),a.jsxs(U,{variant:"outline",size:"icon",className:"h-8 w-8 bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:()=>{m()},disabled:!c.trim(),children:[a.jsx(Sie,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Confirm Assign Manager"})]})]})]})]})]})]})})},ZEe=()=>{const{stores:t,loadStores:e,isLoadingStores:n}=Fn(),{user:r}=ro(),s=()=>{console.log("[StoreList] handleRefreshStores called. User:",r),r&&r.uid?(console.log(`[StoreList] Calling loadStores for user UID: ${r.uid}`),e(r.uid)):console.warn("[StoreList] handleRefreshStores: No user or user.uid found, cannot refresh stores.")};return a.jsxs(It.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},className:"w-full max-w-6xl mx-auto mt-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Your Stores"}),a.jsxs(U,{onClick:s,variant:"outline",disabled:!r||n,children:[a.jsx(Rv,{className:`mr-2 h-4 w-4 ${n?"animate-spin":""}`}),n?"Loading...":"Load Stores"]})]}),n&&t.length===0&&a.jsx("div",{className:"text-center py-10",children:a.jsx("p",{className:"text-muted-foreground",children:"Loading your stores..."})}),!n&&t.length===0&&a.jsx("div",{className:"text-center py-10",children:a.jsx("p",{className:"text-muted-foreground",children:"You haven't created any stores yet. Get started by generating a new store!"})}),t.length>0&&a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(i=>a.jsx(QEe,{store:i},i.id))})]})},eCe=({open:t,onOpenChange:e,onSuccessfulConnect:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState(""),{startShopifyImportWizard:l,isFetchingShopifyPreviewData:c,shopifyImportError:u,setShopifyWizardStep:d}=Fn(),h=async f=>{if(f.preventDefault(),!r||!i){alert("Please enter both Shopify domain and access token.");return}await l(r,i)&&n&&n()};return a.jsx(Ps,{open:t,onOpenChange:f=>{e(f)},children:a.jsxs(ls,{className:"sm:max-w-[425px] sm:rounded-xl",children:[" ",a.jsxs(cs,{children:[a.jsx(us,{children:"Connect to Shopify"}),a.jsxs(No,{className:"text-slate-500 dark:text-slate-400",children:[" ","Enter your Shopify store domain and Storefront Access Token to begin importing."]})]}),a.jsxs("form",{onSubmit:h,className:"grid gap-4 py-4",children:[u&&a.jsx("div",{className:"col-span-4 p-2 text-sm text-red-600 bg-red-100 border border-red-300 rounded",children:u}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"domain",className:"text-right",children:"Domain"}),a.jsx(st,{id:"domain",value:r,onChange:f=>s(f.target.value),placeholder:Hre,className:"col-span-3",disabled:c})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"token",className:"text-right",children:"Token"}),a.jsx(st,{id:"token",type:"password",value:i,onChange:f=>o(f.target.value),placeholder:"Storefront Access Token",className:"col-span-3",disabled:c})]}),a.jsxs(jr,{children:[a.jsx(U,{type:"button",variant:"outline",disabled:c,onClick:()=>e(!1),children:"Cancel"}),a.jsx(U,{type:"submit",disabled:c||!r||!i,children:c?a.jsxs(a.Fragment,{children:[a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}),"Connecting..."]}):"Connect & Fetch Info"})]})]})]})})},tCe=({open:t,onOpenChange:e,onSuccessfulConnect:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState("");p.useState(!1),p.useState(null),p.useState("");const{startBigCommerceImportWizard:l,bigCommerceImportError:c,isFetchingBigCommercePreviewData:u}=Fn(),d=async h=>{if(h.preventDefault(),!r||!i){alert("Both Store Domain and API Token are required.");return}await l(r,i),n&&n({storeDomain:r,apiToken:i})};return t?a.jsx("div",{className:"w-full",children:a.jsxs("form",{onSubmit:d,children:[a.jsxs(tt,{className:"space-y-4 pt-6",children:[" ",a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"bc-store-domain",children:"Store Domain"}),a.jsx(st,{id:"bc-store-domain",type:"text",placeholder:"e.g., mystore.mybigcommerce.com",value:r,onChange:h=>s(h.target.value.trim()),disabled:u})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"bc-api-token",children:"Storefront API Token"}),a.jsx(st,{id:"bc-api-token",type:"password",placeholder:"Enter your Storefront API Token",value:i,onChange:h=>o(h.target.value.trim()),disabled:u})]}),c&&a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(Dv,{className:"mr-2 h-4 w-4"})," ",c]})]}),a.jsx(Yu,{className:"flex flex-col space-y-2",children:a.jsxs(U,{type:"submit",className:"w-full",disabled:u,children:[u?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Yo,{className:"mr-2 h-4 w-4"}),u?"Connecting...":"Connect to BigCommerce"]})})]})}):null},nCe="modulepreload",rCe=function(t){return"/"+t},aL={},jt=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=rCe(i),i in aL)return;aL[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const h=s[d];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":nCe,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};function wn(){return wn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wn.apply(null,arguments)}function lL(t,[e,n]){return Math.min(n,Math.max(e,t))}function qr(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function iA(t,e=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];function u(h){const{scope:f,children:m,...g}=h,x=(f==null?void 0:f[t][c])||l,E=p.useMemo(()=>g,Object.values(g));return p.createElement(x.Provider,{value:E},m)}function d(h,f){const m=(f==null?void 0:f[t][c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,d]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return p.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,sCe(s,...e)]}function sCe(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function iCe(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function mW(...t){return e=>t.forEach(n=>iCe(n,e))}function As(...t){return p.useCallback(mW(...t),t)}const Hp=p.forwardRef((t,e)=>{const{children:n,...r}=t,s=p.Children.toArray(n),i=s.find(aCe);if(i){const o=i.props.children,l=s.map(c=>c===i?p.Children.count(o)>1?p.Children.only(null):p.isValidElement(o)?o.props.children:null:c);return p.createElement(ST,wn({},r,{ref:e}),p.isValidElement(o)?p.cloneElement(o,void 0,l):null)}return p.createElement(ST,wn({},r,{ref:e}),n)});Hp.displayName="Slot";const ST=p.forwardRef((t,e)=>{const{children:n,...r}=t;return p.isValidElement(n)?p.cloneElement(n,{...lCe(r,n.props),ref:e?mW(e,n.ref):n.ref}):p.Children.count(n)>1?p.Children.only(null):null});ST.displayName="SlotClone";const oCe=({children:t})=>p.createElement(p.Fragment,null,t);function aCe(t){return p.isValidElement(t)&&t.type===oCe}function lCe(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{i(...l),s(...l)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function cCe(t){const e=t+"CollectionProvider",[n,r]=iA(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=m=>{const{scope:g,children:x}=m,E=ht.useRef(null),v=ht.useRef(new Map).current;return ht.createElement(s,{scope:g,itemMap:v,collectionRef:E},x)},l=t+"CollectionSlot",c=ht.forwardRef((m,g)=>{const{scope:x,children:E}=m,v=i(l,x),b=As(g,v.collectionRef);return ht.createElement(Hp,{ref:b},E)}),u=t+"CollectionItemSlot",d="data-radix-collection-item",h=ht.forwardRef((m,g)=>{const{scope:x,children:E,...v}=m,b=ht.useRef(null),S=As(g,b),I=i(u,x);return ht.useEffect(()=>(I.itemMap.set(b,{ref:b,...v}),()=>void I.itemMap.delete(b))),ht.createElement(Hp,{[d]:"",ref:S},E)});function f(m){const g=i(t+"CollectionConsumer",m);return ht.useCallback(()=>{const E=g.collectionRef.current;if(!E)return[];const v=Array.from(E.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((I,D)=>v.indexOf(I.ref.current)-v.indexOf(D.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:o,Slot:c,ItemSlot:h},f,r]}const uCe=p.createContext(void 0);function dCe(t){const e=p.useContext(uCe);return t||e||"ltr"}const hCe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],ks=hCe.reduce((t,e)=>{const n=p.forwardRef((r,s)=>{const{asChild:i,...o}=r,l=i?Hp:e;return p.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),p.createElement(l,wn({},o,{ref:s}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function fCe(t,e){t&&Wa.flushSync(()=>t.dispatchEvent(e))}function za(t){const e=p.useRef(t);return p.useEffect(()=>{e.current=t}),p.useMemo(()=>(...n)=>{var r;return(r=e.current)===null||r===void 0?void 0:r.call(e,...n)},[])}function mCe(t,e=globalThis==null?void 0:globalThis.document){const n=za(t);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r),()=>e.removeEventListener("keydown",r)},[n,e])}const ET="dismissableLayer.update",pCe="dismissableLayer.pointerDownOutside",gCe="dismissableLayer.focusOutside";let cL;const yCe=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),xCe=p.forwardRef((t,e)=>{var n;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:l,onDismiss:c,...u}=t,d=p.useContext(yCe),[h,f]=p.useState(null),m=(n=h==null?void 0:h.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,g]=p.useState({}),x=As(e,T=>f(T)),E=Array.from(d.layers),[v]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),b=E.indexOf(v),S=h?E.indexOf(h):-1,I=d.layersWithOutsidePointerEventsDisabled.size>0,D=S>=b,k=vCe(T=>{const P=T.target,A=[...d.branches].some(R=>R.contains(P));!D||A||(i==null||i(T),l==null||l(T),T.defaultPrevented||c==null||c())},m),C=wCe(T=>{const P=T.target;[...d.branches].some(R=>R.contains(P))||(o==null||o(T),l==null||l(T),T.defaultPrevented||c==null||c())},m);return mCe(T=>{S===d.layers.size-1&&(s==null||s(T),!T.defaultPrevented&&c&&(T.preventDefault(),c()))},m),p.useEffect(()=>{if(h)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(cL=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(h)),d.layers.add(h),uL(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=cL)}},[h,m,r,d]),p.useEffect(()=>()=>{h&&(d.layers.delete(h),d.layersWithOutsidePointerEventsDisabled.delete(h),uL())},[h,d]),p.useEffect(()=>{const T=()=>g({});return document.addEventListener(ET,T),()=>document.removeEventListener(ET,T)},[]),p.createElement(ks.div,wn({},u,{ref:x,style:{pointerEvents:I?D?"auto":"none":void 0,...t.style},onFocusCapture:qr(t.onFocusCapture,C.onFocusCapture),onBlurCapture:qr(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:qr(t.onPointerDownCapture,k.onPointerDownCapture)}))});function vCe(t,e=globalThis==null?void 0:globalThis.document){const n=za(t),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let u=function(){pW(pCe,n,c,{discrete:!0})};const c={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=u,e.addEventListener("click",s.current,{once:!0})):u()}r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function wCe(t,e=globalThis==null?void 0:globalThis.document){const n=za(t),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&pW(gCe,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function uL(){const t=new CustomEvent(ET);document.dispatchEvent(t)}function pW(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?fCe(s,i):s.dispatchEvent(i)}let TS=0;function bCe(){p.useEffect(()=>{var t,e;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=n[0])!==null&&t!==void 0?t:dL()),document.body.insertAdjacentElement("beforeend",(e=n[1])!==null&&e!==void 0?e:dL()),TS++,()=>{TS===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),TS--}},[])}function dL(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}const IS="focusScope.autoFocusOnMount",NS="focusScope.autoFocusOnUnmount",hL={bubbles:!1,cancelable:!0},_Ce=p.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[l,c]=p.useState(null),u=za(s),d=za(i),h=p.useRef(null),f=As(e,x=>c(x)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let x=function(S){if(m.paused||!l)return;const I=S.target;l.contains(I)?h.current=I:fl(h.current,{select:!0})},E=function(S){if(m.paused||!l)return;const I=S.relatedTarget;I!==null&&(l.contains(I)||fl(h.current,{select:!0}))},v=function(S){const I=document.activeElement;for(const D of S)D.removedNodes.length>0&&(l!=null&&l.contains(I)||fl(l))};document.addEventListener("focusin",x),document.addEventListener("focusout",E);const b=new MutationObserver(v);return l&&b.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",E),b.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){mL.add(m);const x=document.activeElement;if(!l.contains(x)){const v=new CustomEvent(IS,hL);l.addEventListener(IS,u),l.dispatchEvent(v),v.defaultPrevented||(SCe(NCe(gW(l)),{select:!0}),document.activeElement===x&&fl(l))}return()=>{l.removeEventListener(IS,u),setTimeout(()=>{const v=new CustomEvent(NS,hL);l.addEventListener(NS,d),l.dispatchEvent(v),v.defaultPrevented||fl(x??document.body,{select:!0}),l.removeEventListener(NS,d),mL.remove(m)},0)}}},[l,u,d,m]);const g=p.useCallback(x=>{if(!n&&!r||m.paused)return;const E=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,v=document.activeElement;if(E&&v){const b=x.currentTarget,[S,I]=ECe(b);S&&I?!x.shiftKey&&v===I?(x.preventDefault(),n&&fl(S,{select:!0})):x.shiftKey&&v===S&&(x.preventDefault(),n&&fl(I,{select:!0})):v===b&&x.preventDefault()}},[n,r,m.paused]);return p.createElement(ks.div,wn({tabIndex:-1},o,{ref:f,onKeyDown:g}))});function SCe(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(fl(r,{select:e}),document.activeElement!==n)return}function ECe(t){const e=gW(t),n=fL(e,t),r=fL(e.reverse(),t);return[n,r]}function gW(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function fL(t,e){for(const n of t)if(!CCe(n,{upTo:e}))return n}function CCe(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function TCe(t){return t instanceof HTMLInputElement&&"select"in t}function fl(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&TCe(t)&&e&&t.select()}}const mL=ICe();function ICe(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=pL(t,e),t.unshift(e)},remove(e){var n;t=pL(t,e),(n=t[0])===null||n===void 0||n.resume()}}}function pL(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function NCe(t){return t.filter(e=>e.tagName!=="A")}const to=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},PCe=Ow["useId".toString()]||(()=>{});let ACe=0;function yW(t){const[e,n]=p.useState(PCe());return to(()=>{t||n(r=>r??String(ACe++))},[t]),t||(e?`radix-${e}`:"")}function kCe(t){const[e,n]=p.useState(void 0);return to(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}const xW="Popper",[vW,wW]=iA(xW),[RCe,bW]=vW(xW),jCe=t=>{const{__scopePopper:e,children:n}=t,[r,s]=p.useState(null);return p.createElement(RCe,{scope:e,anchor:r,onAnchorChange:s},n)},DCe="PopperAnchor",MCe=p.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=bW(DCe,n),o=p.useRef(null),l=As(e,o);return p.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:p.createElement(ks.div,wn({},s,{ref:l}))}),_W="PopperContent",[LCe,eje]=vW(_W),FCe=p.forwardRef((t,e)=>{var n,r,s,i,o,l,c,u;const{__scopePopper:d,side:h="bottom",sideOffset:f=0,align:m="center",alignOffset:g=0,arrowPadding:x=0,collisionBoundary:E=[],collisionPadding:v=0,sticky:b="partial",hideWhenDetached:S=!1,avoidCollisions:I=!0,onPlaced:D,...k}=t,C=bW(_W,d),[T,P]=p.useState(null),A=As(e,Le=>P(Le)),[R,M]=p.useState(null),j=kCe(R),z=(n=j==null?void 0:j.width)!==null&&n!==void 0?n:0,W=(r=j==null?void 0:j.height)!==null&&r!==void 0?r:0,q=h+(m!=="center"?"-"+m:""),H=typeof v=="number"?v:{top:0,right:0,bottom:0,left:0,...v},$=Array.isArray(E)?E:[E],J=$.length>0,O={padding:H,boundary:$.filter(OCe),altBoundary:J},{refs:V,floatingStyles:G,placement:F,isPositioned:ue,middlewareData:Ee}=_G({strategy:"fixed",placement:q,whileElementsMounted:wG,elements:{reference:C.anchor},middleware:[SG({mainAxis:f+W,alignmentAxis:g}),I&&EG({mainAxis:!0,crossAxis:!1,limiter:b==="partial"?CG():void 0,...O}),I&&TG({...O}),IG({...O,apply:({elements:Le,rects:Ae,availableWidth:pt,availableHeight:mt})=>{const{width:Ht,height:Ft}=Ae.reference,nn=Le.floating.style;nn.setProperty("--radix-popper-available-width",`${pt}px`),nn.setProperty("--radix-popper-available-height",`${mt}px`),nn.setProperty("--radix-popper-anchor-width",`${Ht}px`),nn.setProperty("--radix-popper-anchor-height",`${Ft}px`)}}),R&&PG({element:R,padding:x}),$Ce({arrowWidth:z,arrowHeight:W}),S&&NG({strategy:"referenceHidden"})]}),[Se,we]=SW(F),Fe=za(D);to(()=>{ue&&(Fe==null||Fe())},[ue,Fe]);const Ze=(s=Ee.arrow)===null||s===void 0?void 0:s.x,ze=(i=Ee.arrow)===null||i===void 0?void 0:i.y,nt=((o=Ee.arrow)===null||o===void 0?void 0:o.centerOffset)!==0,[qe,yt]=p.useState();return to(()=>{T&&yt(window.getComputedStyle(T).zIndex)},[T]),p.createElement("div",{ref:V.setFloating,"data-radix-popper-content-wrapper":"",style:{...G,transform:ue?G.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:qe,"--radix-popper-transform-origin":[(l=Ee.transformOrigin)===null||l===void 0?void 0:l.x,(c=Ee.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:t.dir},p.createElement(LCe,{scope:d,placedSide:Se,onArrowChange:M,arrowX:Ze,arrowY:ze,shouldHideArrow:nt},p.createElement(ks.div,wn({"data-side":Se,"data-align":we},k,{ref:A,style:{...k.style,animation:ue?void 0:"none",opacity:(u=Ee.hide)!==null&&u!==void 0&&u.referenceHidden?0:void 0}}))))});function OCe(t){return t!==null}const $Ce=t=>({name:"transformOrigin",options:t,fn(e){var n,r,s,i,o;const{placement:l,rects:c,middlewareData:u}=e,h=((n=u.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,f=h?0:t.arrowWidth,m=h?0:t.arrowHeight,[g,x]=SW(l),E={start:"0%",center:"50%",end:"100%"}[x],v=((r=(s=u.arrow)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:0)+f/2,b=((i=(o=u.arrow)===null||o===void 0?void 0:o.y)!==null&&i!==void 0?i:0)+m/2;let S="",I="";return g==="bottom"?(S=h?E:`${v}px`,I=`${-m}px`):g==="top"?(S=h?E:`${v}px`,I=`${c.floating.height+m}px`):g==="right"?(S=`${-m}px`,I=h?E:`${b}px`):g==="left"&&(S=`${c.floating.width+m}px`,I=h?E:`${b}px`),{data:{x:S,y:I}}}});function SW(t){const[e,n="center"]=t.split("-");return[e,n]}const VCe=jCe,UCe=MCe,BCe=FCe,zCe=p.forwardRef((t,e)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...s}=t;return r?D1.createPortal(p.createElement(ks.div,wn({},s,{ref:e})),r):null});function gL({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=GCe({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,l=za(n),c=p.useCallback(u=>{if(i){const h=typeof u=="function"?u(t):u;h!==t&&l(h)}else s(u)},[i,t,s,l]);return[o,c]}function GCe({defaultProp:t,onChange:e}){const n=p.useState(t),[r]=n,s=p.useRef(r),i=za(e);return p.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}function WCe(t){const e=p.useRef({value:t,previous:t});return p.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}function HCe(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function qCe(...t){return e=>t.forEach(n=>HCe(n,e))}const EW=p.forwardRef((t,e)=>{const{children:n,...r}=t,s=p.Children.toArray(n),i=s.find(YCe);if(i){const o=i.props.children,l=s.map(c=>c===i?p.Children.count(o)>1?p.Children.only(null):p.isValidElement(o)?o.props.children:null:c);return p.createElement(CT,wn({},r,{ref:e}),p.isValidElement(o)?p.cloneElement(o,void 0,l):null)}return p.createElement(CT,wn({},r,{ref:e}),n)});EW.displayName="Slot";const CT=p.forwardRef((t,e)=>{const{children:n,...r}=t;return p.isValidElement(n)?p.cloneElement(n,{...JCe(r,n.props),ref:e?qCe(e,n.ref):n.ref}):p.Children.count(n)>1?p.Children.only(null):null});CT.displayName="SlotClone";const KCe=({children:t})=>p.createElement(p.Fragment,null,t);function YCe(t){return p.isValidElement(t)&&t.type===KCe}function JCe(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{i(...l),s(...l)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}const XCe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],QCe=XCe.reduce((t,e)=>{const n=p.forwardRef((r,s)=>{const{asChild:i,...o}=r,l=i?EW:e;return p.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),p.createElement(l,wn({},o,{ref:s}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{}),ZCe=p.forwardRef((t,e)=>p.createElement(QCe.span,wn({},t,{ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}})));var CW=u3(),PS=function(){},jb=p.forwardRef(function(t,e){var n=p.useRef(null),r=p.useState({onScrollCapture:PS,onWheelCapture:PS,onTouchMoveCapture:PS}),s=r[0],i=r[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,m=t.noIsolation,g=t.inert,x=t.allowPinchZoom,E=t.as,v=E===void 0?"div":E,b=sf(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),S=f,I=c3([n,e]),D=Es(Es({},b),s);return p.createElement(p.Fragment,null,d&&p.createElement(S,{sideCar:CW,removeScrollBar:u,shards:h,noIsolation:m,inert:g,setCallbacks:i,allowPinchZoom:!!x,lockRef:n}),o?p.cloneElement(p.Children.only(l),Es(Es({},D),{ref:I})):p.createElement(v,Es({},D,{className:c,ref:I}),l))});jb.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};jb.classNames={fullWidth:Nm,zeroRight:Im};var TT=!1;if(typeof window<"u")try{var ex=Object.defineProperty({},"passive",{get:function(){return TT=!0,!0}});window.addEventListener("test",ex,ex),window.removeEventListener("test",ex,ex)}catch{TT=!1}var vd=TT?{passive:!1}:!1,eTe=function(t){return t.tagName==="TEXTAREA"},TW=function(t,e){var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!eTe(t)&&n[e]==="visible")},tTe=function(t){return TW(t,"overflowY")},nTe=function(t){return TW(t,"overflowX")},yL=function(t,e){var n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=IW(t,n);if(r){var s=NW(t,n),i=s[1],o=s[2];if(i>o)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},rTe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},sTe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},IW=function(t,e){return t==="v"?tTe(e):nTe(e)},NW=function(t,e){return t==="v"?rTe(e):sTe(e)},iTe=function(t,e){return t==="h"&&e==="rtl"?-1:1},oTe=function(t,e,n,r,s){var i=iTe(t,window.getComputedStyle(e).direction),o=i*r,l=n.target,c=e.contains(l),u=!1,d=o>0,h=0,f=0;do{var m=NW(t,l),g=m[0],x=m[1],E=m[2],v=x-E-i*g;(g||v)&&IW(t,l)&&(h+=v,f+=g),l=l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&(s&&h===0||!s&&o>h)||!d&&(s&&f===0||!s&&-o>f))&&(u=!0),u},tx=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},xL=function(t){return[t.deltaX,t.deltaY]},vL=function(t){return t&&"current"in t?t.current:t},aTe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},lTe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},cTe=0,wd=[];function uTe(t){var e=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(cTe++)[0],i=p.useState(function(){return eI()})[0],o=p.useRef(t);p.useEffect(function(){o.current=t},[t]),p.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var x=l3([t.lockRef.current],(t.shards||[]).map(vL),!0).filter(Boolean);return x.forEach(function(E){return E.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),x.forEach(function(E){return E.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=p.useCallback(function(x,E){if("touches"in x&&x.touches.length===2)return!o.current.allowPinchZoom;var v=tx(x),b=n.current,S="deltaX"in x?x.deltaX:b[0]-v[0],I="deltaY"in x?x.deltaY:b[1]-v[1],D,k=x.target,C=Math.abs(S)>Math.abs(I)?"h":"v";if("touches"in x&&C==="h"&&k.type==="range")return!1;var T=yL(C,k);if(!T)return!0;if(T?D=C:(D=C==="v"?"h":"v",T=yL(C,k)),!T)return!1;if(!r.current&&"changedTouches"in x&&(S||I)&&(r.current=D),!D)return!0;var P=r.current||D;return oTe(P,E,x,P==="h"?S:I,!0)},[]),c=p.useCallback(function(x){var E=x;if(!(!wd.length||wd[wd.length-1]!==i)){var v="deltaY"in E?xL(E):tx(E),b=e.current.filter(function(D){return D.name===E.type&&D.target===E.target&&aTe(D.delta,v)})[0];if(b&&b.should){E.cancelable&&E.preventDefault();return}if(!b){var S=(o.current.shards||[]).map(vL).filter(Boolean).filter(function(D){return D.contains(E.target)}),I=S.length>0?l(E,S[0]):!o.current.noIsolation;I&&E.cancelable&&E.preventDefault()}}},[]),u=p.useCallback(function(x,E,v,b){var S={name:x,delta:E,target:v,should:b};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(I){return I!==S})},1)},[]),d=p.useCallback(function(x){n.current=tx(x),r.current=void 0},[]),h=p.useCallback(function(x){u(x.type,xL(x),x.target,l(x,t.lockRef.current))},[]),f=p.useCallback(function(x){u(x.type,tx(x),x.target,l(x,t.lockRef.current))},[]);p.useEffect(function(){return wd.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,vd),document.addEventListener("touchmove",c,vd),document.addEventListener("touchstart",d,vd),function(){wd=wd.filter(function(x){return x!==i}),document.removeEventListener("wheel",c,vd),document.removeEventListener("touchmove",c,vd),document.removeEventListener("touchstart",d,vd)}},[]);var m=t.removeScrollBar,g=t.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:lTe(s)}):null,m?p.createElement(m3,{gapMode:"margin"}):null)}const dTe=h3(CW,uTe);var PW=p.forwardRef(function(t,e){return p.createElement(jb,Es({},t,{ref:e,sideCar:dTe}))});PW.classNames=jb.classNames;const hTe=PW,fTe=[" ","Enter","ArrowUp","ArrowDown"],mTe=[" ","Enter"],Db="Select",[Mb,Lb,pTe]=cCe(Db),[pf,tje]=iA(Db,[pTe,wW]),oA=wW(),[gTe,Qu]=pf(Db),[yTe,xTe]=pf(Db),vTe=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:s,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:u,name:d,autoComplete:h,disabled:f,required:m}=t,g=oA(e),[x,E]=p.useState(null),[v,b]=p.useState(null),[S,I]=p.useState(!1),D=dCe(u),[k=!1,C]=gL({prop:r,defaultProp:s,onChange:i}),[T,P]=gL({prop:o,defaultProp:l,onChange:c}),A=p.useRef(null),R=x?!!x.closest("form"):!0,[M,j]=p.useState(new Set),z=Array.from(M).map(W=>W.props.value).join(";");return p.createElement(VCe,g,p.createElement(gTe,{required:m,scope:e,trigger:x,onTriggerChange:E,valueNode:v,onValueNodeChange:b,valueNodeHasChildren:S,onValueNodeHasChildrenChange:I,contentId:yW(),value:T,onValueChange:P,open:k,onOpenChange:C,dir:D,triggerPointerDownPosRef:A,disabled:f},p.createElement(Mb.Provider,{scope:e},p.createElement(yTe,{scope:t.__scopeSelect,onNativeOptionAdd:p.useCallback(W=>{j(q=>new Set(q).add(W))},[]),onNativeOptionRemove:p.useCallback(W=>{j(q=>{const H=new Set(q);return H.delete(W),H})},[])},n)),R?p.createElement(jW,{key:z,"aria-hidden":!0,required:m,tabIndex:-1,name:d,autoComplete:h,value:T,onChange:W=>P(W.target.value),disabled:f},T===void 0?p.createElement("option",{value:""}):null,Array.from(M)):null))},wTe="SelectTrigger",bTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...s}=t,i=oA(n),o=Qu(wTe,n),l=o.disabled||r,c=As(e,o.onTriggerChange),u=Lb(n),[d,h,f]=DW(g=>{const x=u().filter(b=>!b.disabled),E=x.find(b=>b.value===o.value),v=MW(x,g,E);v!==void 0&&o.onValueChange(v.value)}),m=()=>{l||(o.onOpenChange(!0),f())};return p.createElement(UCe,wn({asChild:!0},i),p.createElement(ks.button,wn({type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":o.value===void 0?"":void 0},s,{ref:c,onClick:qr(s.onClick,g=>{g.currentTarget.focus()}),onPointerDown:qr(s.onPointerDown,g=>{const x=g.target;x.hasPointerCapture(g.pointerId)&&x.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&(m(),o.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)},g.preventDefault())}),onKeyDown:qr(s.onKeyDown,g=>{const x=d.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&h(g.key),!(x&&g.key===" ")&&fTe.includes(g.key)&&(m(),g.preventDefault())})})))}),_Te="SelectValue",STe=p.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:o,...l}=t,c=Qu(_Te,n),{onValueNodeHasChildrenChange:u}=c,d=i!==void 0,h=As(e,c.onValueNodeChange);return to(()=>{u(d)},[u,d]),p.createElement(ks.span,wn({},l,{ref:h,style:{pointerEvents:"none"}}),c.value===void 0&&o!==void 0?o:i)}),ETe=p.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...s}=t;return p.createElement(ks.span,wn({"aria-hidden":!0},s,{ref:e}),r||"▼")}),CTe=t=>p.createElement(zCe,wn({asChild:!0},t)),Xh="SelectContent",TTe=p.forwardRef((t,e)=>{const n=Qu(Xh,t.__scopeSelect),[r,s]=p.useState();if(to(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?Wa.createPortal(p.createElement(AW,{scope:t.__scopeSelect},p.createElement(Mb.Slot,{scope:t.__scopeSelect},p.createElement("div",null,t.children))),i):null}return p.createElement(ITe,wn({},t,{ref:e}))}),ma=10,[AW,Zu]=pf(Xh),ITe=p.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:x,avoidCollisions:E,...v}=t,b=Qu(Xh,n),[S,I]=p.useState(null),[D,k]=p.useState(null),C=As(e,we=>I(we)),[T,P]=p.useState(null),[A,R]=p.useState(null),M=Lb(n),[j,z]=p.useState(!1),W=p.useRef(!1);p.useEffect(()=>{if(S)return tI(S)},[S]),bCe();const q=p.useCallback(we=>{const[Fe,...Ze]=M().map(qe=>qe.ref.current),[ze]=Ze.slice(-1),nt=document.activeElement;for(const qe of we)if(qe===nt||(qe==null||qe.scrollIntoView({block:"nearest"}),qe===Fe&&D&&(D.scrollTop=0),qe===ze&&D&&(D.scrollTop=D.scrollHeight),qe==null||qe.focus(),document.activeElement!==nt))return},[M,D]),H=p.useCallback(()=>q([T,S]),[q,T,S]);p.useEffect(()=>{j&&H()},[j,H]);const{onOpenChange:$,triggerPointerDownPosRef:J}=b;p.useEffect(()=>{if(S){let we={x:0,y:0};const Fe=ze=>{var nt,qe,yt,Le;we={x:Math.abs(Math.round(ze.pageX)-((nt=(qe=J.current)===null||qe===void 0?void 0:qe.x)!==null&&nt!==void 0?nt:0)),y:Math.abs(Math.round(ze.pageY)-((yt=(Le=J.current)===null||Le===void 0?void 0:Le.y)!==null&&yt!==void 0?yt:0))}},Ze=ze=>{we.x<=10&&we.y<=10?ze.preventDefault():S.contains(ze.target)||$(!1),document.removeEventListener("pointermove",Fe),J.current=null};return J.current!==null&&(document.addEventListener("pointermove",Fe),document.addEventListener("pointerup",Ze,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Fe),document.removeEventListener("pointerup",Ze,{capture:!0})}}},[S,$,J]),p.useEffect(()=>{const we=()=>$(!1);return window.addEventListener("blur",we),window.addEventListener("resize",we),()=>{window.removeEventListener("blur",we),window.removeEventListener("resize",we)}},[$]);const[O,V]=DW(we=>{const Fe=M().filter(nt=>!nt.disabled),Ze=Fe.find(nt=>nt.ref.current===document.activeElement),ze=MW(Fe,we,Ze);ze&&setTimeout(()=>ze.ref.current.focus())}),G=p.useCallback((we,Fe,Ze)=>{const ze=!W.current&&!Ze;(b.value!==void 0&&b.value===Fe||ze)&&(P(we),ze&&(W.current=!0))},[b.value]),F=p.useCallback(()=>S==null?void 0:S.focus(),[S]),ue=p.useCallback((we,Fe,Ze)=>{const ze=!W.current&&!Ze;(b.value!==void 0&&b.value===Fe||ze)&&R(we)},[b.value]),Ee=r==="popper"?wL:NTe,Se=Ee===wL?{side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:x,avoidCollisions:E}:{};return p.createElement(AW,{scope:n,content:S,viewport:D,onViewportChange:k,itemRefCallback:G,selectedItem:T,onItemLeave:F,itemTextRefCallback:ue,focusSelectedItem:H,selectedItemText:A,position:r,isPositioned:j,searchRef:O},p.createElement(hTe,{as:Hp,allowPinchZoom:!0},p.createElement(_Ce,{asChild:!0,trapped:b.open,onMountAutoFocus:we=>{we.preventDefault()},onUnmountAutoFocus:qr(s,we=>{var Fe;(Fe=b.trigger)===null||Fe===void 0||Fe.focus({preventScroll:!0}),we.preventDefault()})},p.createElement(xCe,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:we=>we.preventDefault(),onDismiss:()=>b.onOpenChange(!1)},p.createElement(Ee,wn({role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:we=>we.preventDefault()},v,Se,{onPlaced:()=>z(!0),ref:C,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:qr(v.onKeyDown,we=>{const Fe=we.ctrlKey||we.altKey||we.metaKey;if(we.key==="Tab"&&we.preventDefault(),!Fe&&we.key.length===1&&V(we.key),["ArrowUp","ArrowDown","Home","End"].includes(we.key)){let ze=M().filter(nt=>!nt.disabled).map(nt=>nt.ref.current);if(["ArrowUp","End"].includes(we.key)&&(ze=ze.slice().reverse()),["ArrowUp","ArrowDown"].includes(we.key)){const nt=we.target,qe=ze.indexOf(nt);ze=ze.slice(qe+1)}setTimeout(()=>q(ze)),we.preventDefault()}})}))))))}),NTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...s}=t,i=Qu(Xh,n),o=Zu(Xh,n),[l,c]=p.useState(null),[u,d]=p.useState(null),h=As(e,C=>d(C)),f=Lb(n),m=p.useRef(!1),g=p.useRef(!0),{viewport:x,selectedItem:E,selectedItemText:v,focusSelectedItem:b}=o,S=p.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&u&&x&&E&&v){const C=i.trigger.getBoundingClientRect(),T=u.getBoundingClientRect(),P=i.valueNode.getBoundingClientRect(),A=v.getBoundingClientRect();if(i.dir!=="rtl"){const nt=A.left-T.left,qe=P.left-nt,yt=C.left-qe,Le=C.width+yt,Ae=Math.max(Le,T.width),pt=window.innerWidth-ma,mt=lL(qe,[ma,pt-Ae]);l.style.minWidth=Le+"px",l.style.left=mt+"px"}else{const nt=T.right-A.right,qe=window.innerWidth-P.right-nt,yt=window.innerWidth-C.right-qe,Le=C.width+yt,Ae=Math.max(Le,T.width),pt=window.innerWidth-ma,mt=lL(qe,[ma,pt-Ae]);l.style.minWidth=Le+"px",l.style.right=mt+"px"}const R=f(),M=window.innerHeight-ma*2,j=x.scrollHeight,z=window.getComputedStyle(u),W=parseInt(z.borderTopWidth,10),q=parseInt(z.paddingTop,10),H=parseInt(z.borderBottomWidth,10),$=parseInt(z.paddingBottom,10),J=W+q+j+$+H,O=Math.min(E.offsetHeight*5,J),V=window.getComputedStyle(x),G=parseInt(V.paddingTop,10),F=parseInt(V.paddingBottom,10),ue=C.top+C.height/2-ma,Ee=M-ue,Se=E.offsetHeight/2,we=E.offsetTop+Se,Fe=W+q+we,Ze=J-Fe;if(Fe<=ue){const nt=E===R[R.length-1].ref.current;l.style.bottom="0px";const qe=u.clientHeight-x.offsetTop-x.offsetHeight,yt=Math.max(Ee,Se+(nt?F:0)+qe+H),Le=Fe+yt;l.style.height=Le+"px"}else{const nt=E===R[0].ref.current;l.style.top="0px";const yt=Math.max(ue,W+x.offsetTop+(nt?G:0)+Se)+Ze;l.style.height=yt+"px",x.scrollTop=Fe-ue+x.offsetTop}l.style.margin=`${ma}px 0`,l.style.minHeight=O+"px",l.style.maxHeight=M+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[f,i.trigger,i.valueNode,l,u,x,E,v,i.dir,r]);to(()=>S(),[S]);const[I,D]=p.useState();to(()=>{u&&D(window.getComputedStyle(u).zIndex)},[u]);const k=p.useCallback(C=>{C&&g.current===!0&&(S(),b==null||b(),g.current=!1)},[S,b]);return p.createElement(PTe,{scope:n,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:k},p.createElement("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:I}},p.createElement(ks.div,wn({},s,{ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}}))))}),wL=p.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=ma,...i}=t,o=oA(n);return p.createElement(BCe,wn({},o,i,{ref:e,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[PTe,aA]=pf(Xh,{}),bL="SelectViewport",ATe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=Zu(bL,n),i=aA(bL,n),o=As(e,s.onViewportChange),l=p.useRef(0);return p.createElement(p.Fragment,null,p.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),p.createElement(Mb.Slot,{scope:n},p.createElement(ks.div,wn({"data-radix-select-viewport":"",role:"presentation"},r,{ref:o,style:{position:"relative",flex:1,overflow:"auto",...r.style},onScroll:qr(r.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=i;if(h!=null&&h.current&&d){const f=Math.abs(l.current-u.scrollTop);if(f>0){const m=window.innerHeight-ma*2,g=parseFloat(d.style.minHeight),x=parseFloat(d.style.height),E=Math.max(g,x);if(E<m){const v=E+f,b=Math.min(m,v),S=v-b;d.style.height=b+"px",d.style.bottom==="0px"&&(u.scrollTop=S>0?S:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})}))))}),kTe="SelectGroup",[nje,RTe]=pf(kTe),jTe="SelectLabel",DTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=RTe(jTe,n);return p.createElement(ks.div,wn({id:s.id},r,{ref:e}))}),IT="SelectItem",[MTe,kW]=pf(IT),LTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...o}=t,l=Qu(IT,n),c=Zu(IT,n),u=l.value===r,[d,h]=p.useState(i??""),[f,m]=p.useState(!1),g=As(e,v=>{var b;return(b=c.itemRefCallback)===null||b===void 0?void 0:b.call(c,v,r,s)}),x=yW(),E=()=>{s||(l.onValueChange(r),l.onOpenChange(!1))};return p.createElement(MTe,{scope:n,value:r,disabled:s,textId:x,isSelected:u,onItemTextChange:p.useCallback(v=>{h(b=>{var S;return b||((S=v==null?void 0:v.textContent)!==null&&S!==void 0?S:"").trim()})},[])},p.createElement(Mb.ItemSlot,{scope:n,value:r,disabled:s,textValue:d},p.createElement(ks.div,wn({role:"option","aria-labelledby":x,"data-highlighted":f?"":void 0,"aria-selected":u&&f,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1},o,{ref:g,onFocus:qr(o.onFocus,()=>m(!0)),onBlur:qr(o.onBlur,()=>m(!1)),onPointerUp:qr(o.onPointerUp,E),onPointerMove:qr(o.onPointerMove,v=>{if(s){var b;(b=c.onItemLeave)===null||b===void 0||b.call(c)}else v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:qr(o.onPointerLeave,v=>{if(v.currentTarget===document.activeElement){var b;(b=c.onItemLeave)===null||b===void 0||b.call(c)}}),onKeyDown:qr(o.onKeyDown,v=>{var b;((b=c.searchRef)===null||b===void 0?void 0:b.current)!==""&&v.key===" "||(mTe.includes(v.key)&&E(),v.key===" "&&v.preventDefault())})}))))}),nx="SelectItemText",FTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,...i}=t,o=Qu(nx,n),l=Zu(nx,n),c=kW(nx,n),u=xTe(nx,n),[d,h]=p.useState(null),f=As(e,v=>h(v),c.onItemTextChange,v=>{var b;return(b=l.itemTextRefCallback)===null||b===void 0?void 0:b.call(l,v,c.value,c.disabled)}),m=d==null?void 0:d.textContent,g=p.useMemo(()=>p.createElement("option",{key:c.value,value:c.value,disabled:c.disabled},m),[c.disabled,c.value,m]),{onNativeOptionAdd:x,onNativeOptionRemove:E}=u;return to(()=>(x(g),()=>E(g)),[x,E,g]),p.createElement(p.Fragment,null,p.createElement(ks.span,wn({id:c.textId},i,{ref:f})),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Wa.createPortal(i.children,o.valueNode):null)}),OTe="SelectItemIndicator",$Te=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return kW(OTe,n).isSelected?p.createElement(ks.span,wn({"aria-hidden":!0},r,{ref:e})):null}),_L="SelectScrollUpButton",VTe=p.forwardRef((t,e)=>{const n=Zu(_L,t.__scopeSelect),r=aA(_L,t.__scopeSelect),[s,i]=p.useState(!1),o=As(e,r.onScrollButtonChange);return to(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=l.scrollTop>0;i(u)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),s?p.createElement(RW,wn({},t,{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}})):null}),SL="SelectScrollDownButton",UTe=p.forwardRef((t,e)=>{const n=Zu(SL,t.__scopeSelect),r=aA(SL,t.__scopeSelect),[s,i]=p.useState(!1),o=As(e,r.onScrollButtonChange);return to(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=l.scrollHeight-l.clientHeight,d=Math.ceil(l.scrollTop)<u;i(d)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),s?p.createElement(RW,wn({},t,{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}})):null}),RW=p.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=t,i=Zu("SelectScrollButton",n),o=p.useRef(null),l=Lb(n),c=p.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),to(()=>{var u;const d=l().find(h=>h.ref.current===document.activeElement);d==null||(u=d.ref.current)===null||u===void 0||u.scrollIntoView({block:"nearest"})},[l]),p.createElement(ks.div,wn({"aria-hidden":!0},s,{ref:e,style:{flexShrink:0,...s.style},onPointerDown:qr(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:qr(s.onPointerMove,()=>{var u;(u=i.onItemLeave)===null||u===void 0||u.call(i),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:qr(s.onPointerLeave,()=>{c()})}))}),BTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return p.createElement(ks.div,wn({"aria-hidden":!0},r,{ref:e}))}),jW=p.forwardRef((t,e)=>{const{value:n,...r}=t,s=p.useRef(null),i=As(e,s),o=WCe(n);return p.useEffect(()=>{const l=s.current,c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==n&&d){const h=new Event("change",{bubbles:!0});d.call(l,n),l.dispatchEvent(h)}},[o,n]),p.createElement(ZCe,{asChild:!0},p.createElement("select",wn({},r,{ref:i,defaultValue:n})))});jW.displayName="BubbleSelect";function DW(t){const e=za(t),n=p.useRef(""),r=p.useRef(0),s=p.useCallback(o=>{const l=n.current+o;e(l),function c(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(l)},[e]),i=p.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function MW(t,e,n){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=zTe(t,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function zTe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}const GTe=vTe,LW=bTe,WTe=STe,HTe=ETe,qTe=CTe,FW=TTe,KTe=ATe,OW=DTe,$W=LTe,YTe=FTe,JTe=$Te,VW=VTe,UW=UTe,BW=BTe,pu=GTe,gu=WTe,Hl=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(LW,{ref:r,className:Et("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,a.jsx(HTe,{asChild:!0,children:a.jsx(f0,{className:"h-4 w-4 opacity-50"})})]}));Hl.displayName=LW.displayName;const zW=ht.forwardRef(({className:t,...e},n)=>a.jsx(VW,{ref:n,className:Et("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(GV,{className:"h-4 w-4"})}));zW.displayName=VW.displayName;const GW=ht.forwardRef(({className:t,...e},n)=>a.jsx(UW,{ref:n,className:Et("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(f0,{className:"h-4 w-4"})}));GW.displayName=UW.displayName;const ql=ht.forwardRef(({className:t,children:e,position:n="popper",...r},s)=>a.jsx(qTe,{children:a.jsxs(FW,{ref:s,className:Et("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[a.jsx(zW,{}),a.jsx(KTe,{className:Et("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),a.jsx(GW,{})]})}));ql.displayName=FW.displayName;const XTe=ht.forwardRef(({className:t,...e},n)=>a.jsx(OW,{ref:n,className:Et("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));XTe.displayName=OW.displayName;const Jn=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs($W,{ref:r,className:Et("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(JTe,{children:a.jsx(rg,{className:"h-4 w-4"})})}),a.jsx(YTe,{children:e})]}));Jn.displayName=$W.displayName;const QTe=ht.forwardRef(({className:t,...e},n)=>a.jsx(BW,{ref:n,className:Et("-mx-1 my-1 h-px bg-muted",t),...e}));QTe.displayName=BW.displayName;const ZTe="AIzaSyA6fvf0Xgb29MloJ-JKiYJGzhv_jvPdL1Y",e1e=async t=>{var i,o;if(!t||t.length===0)return{error:"No images provided for analysis."};const e=new hr({apiKey:ZTe}),n=t.map(l=>{if(!l.base64||!l.mimeType)throw console.error("Image object is missing base64 or mimeType:",l.name),new Error(`Image ${l.name} is missing data for AI processing.`);return{inlineData:{data:l.base64.startsWith("data:")?l.base64.split(",")[1]:l.base64,mimeType:l.mimeType}}}),r=`
    Analyze the following product images (${t.map(l=>l.name).join(", ")}). 
    Based on these images, provide the following details for setting up an e-commerce store.
    Please format your response as a single, valid JSON object with the exact keys specified below.

    1.  "productType": A concise category or niche for these products (e.g., "Handcrafted Leather Goods", "Vintage Streetwear", "Artisanal Coffee Beans").
    2.  "storeNameSuggestions": An array of 3-5 creative and relevant store name suggestions.
    3.  "logoDescription": A brief description of a suitable logo concept (e.g., "A minimalist line art of a coffee bean with earthy tones").
    4.  "products": An array of objects, one for each uploaded image. For each product, analyze its specific image content to generate the following:
        *   "originalImageName": The filename of the original image (use the names provided in this prompt, e.g., "${((i=t[0])==null?void 0:i.name)||"example_image.jpg"}").
        *   "name": A catchy and descriptive product name directly inspired by the visual details in THIS specific image.
        *   "price": A suggested retail price for THIS specific product, considering its appearance and likely category (e.g., "29.99"). Ensure this is a string representing a number.
        *   "description": A compelling product description (2-3 sentences) highlighting key visual features and benefits of THIS specific product shown in its image.
    5.  "collections": An array of 3 distinct collection suggestions, each with:
        *   "name": Collection name (e.g., "New Arrivals", "Essentials", "Gifts Under $50").
        *   "description": A brief description for the collection.
    6.  "storePrompt": A short paragraph describing the overall style, feel, and target audience for a store selling these products. This will be used as a base for further AI generation of store content.

    Example for a single product in the "products" array:
    {
      "originalImageName": "${((o=t[0])==null?void 0:o.name)||"example_image.jpg"}",
      "name": "Rustic Leather Wallet",
      "price": "45.00",
      "description": "Hand-stitched full-grain leather wallet with a timeless design. Perfect for everyday carry, offering both style and durability."
    }
  `,s={type:Xe.OBJECT,properties:{productType:{type:Xe.STRING},storeNameSuggestions:{type:Xe.ARRAY,items:{type:Xe.STRING}},logoDescription:{type:Xe.STRING},products:{type:Xe.ARRAY,items:{type:Xe.OBJECT,properties:{originalImageName:{type:Xe.STRING},name:{type:Xe.STRING},price:{type:Xe.STRING},description:{type:Xe.STRING}},required:["originalImageName","name","price","description"]}},collections:{type:Xe.ARRAY,items:{type:Xe.OBJECT,properties:{name:{type:Xe.STRING},description:{type:Xe.STRING}},required:["name","description"]}},storePrompt:{type:Xe.STRING}},required:["productType","storeNameSuggestions","logoDescription","products","collections","storePrompt"]};try{console.log("[geminiImageUnderstanding] Sending prompt to Gemini with images:",t.map(h=>h.name));const l=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:r},...n]}],config:{responseMimeType:"application/json",responseSchema:s}});if(console.log("[geminiImageUnderstanding] Full API call response object:",JSON.stringify(l,null,2)),!l||typeof l.text!="string"){let h="Invalid or missing response from API.";return l&&l.promptFeedback&&l.promptFeedback.blockReason?(h=`Request blocked: ${l.promptFeedback.blockReason}. ${l.promptFeedback.blockReasonMessage||""}`,console.error(`[geminiImageUnderstanding] Request blocked. Reason: ${l.promptFeedback.blockReason}, Message: ${l.promptFeedback.blockReasonMessage}`)):l&&l.candidates&&l.candidates.length>0&&l.candidates[0].finishReason!=="STOP"&&l.candidates[0].finishReason!=="MODEL_SPECIFIED_STOP"?(h=`Generation stopped for reason: ${l.candidates[0].finishReason}.`,console.error(`[geminiImageUnderstanding] Generation stopped. Reason: ${l.candidates[0].finishReason}`)):console.error("[geminiImageUnderstanding] API response is invalid or text property is missing/not a string. Full response:",l),{error:`AI analysis failed: ${h}`}}const c=l.text;if(c.trim()==="")return console.error("[geminiImageUnderstanding] Model did not return a text response (empty string). Full API Response:",JSON.stringify(l)),{error:"AI analysis failed: Model response was empty or not text."};let u;try{u=JSON.parse(c)}catch(h){return console.error("[geminiImageUnderstanding] Failed to parse Gemini JSON response:",c,"ParseError:",h),{error:"AI analysis failed: Could not understand the response from Gemini (invalid JSON)."}}if(!u.productType||!Array.isArray(u.storeNameSuggestions)||!Array.isArray(u.products)||!Array.isArray(u.collections)||!u.storePrompt)return console.error("[geminiImageUnderstanding] Gemini response missing required fields or incorrect types:",u),{error:"AI analysis failed: The response from Gemini was incomplete or malformed."};const d=u.products.map(h=>{let f=[],m="Untitled Product (AI)",g="0.00",x="No description provided by AI.",E=null;if(h&&typeof h=="object")if(m=h.name||m,g=h.price||g,x=h.description||x,E=h.originalImageName||null,typeof h.originalImageName=="string"){const v=t.find(b=>b&&b.name===h.originalImageName);v&&typeof v.base64=="string"?f=[v.base64]:console.warn(`[geminiImageUnderstanding] Original image or its base64 not found for product with AI-provided originalImageName: "${h.originalImageName}". AI Product Name: "${h.name}"`)}else console.warn("[geminiImageUnderstanding] Product item from AI is missing 'originalImageName' string or is invalid:",h);else console.warn("[geminiImageUnderstanding] Invalid product item received from AI (not an object):",h);return{...h&&typeof h=="object"?h:{},name:m,price:g,description:x,originalImageName:E,images:f}});return{productType:u.productType,storeNameSuggestions:u.storeNameSuggestions,logoDescription:u.logoDescription,products:d,collections:u.collections,storePrompt:u.storePrompt,error:null}}catch(l){return console.error("[geminiImageUnderstanding] Error calling Gemini API or processing response:",l),{error:`AI analysis API call failed: ${l.message}`}}},t1e="AIzaSyA6fvf0Xgb29MloJ-JKiYJGzhv_jvPdL1Y",n1e=[{category:xr.HARM_CATEGORY_HARASSMENT,threshold:vr.BLOCK_MEDIUM_AND_ABOVE},{category:xr.HARM_CATEGORY_HATE_SPEECH,threshold:vr.BLOCK_MEDIUM_AND_ABOVE},{category:xr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:vr.BLOCK_MEDIUM_AND_ABOVE},{category:xr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:vr.BLOCK_MEDIUM_AND_ABOVE}],r1e=["Shirt","Mug","Hat","Totebag","Poster"];async function s1e(t,e){var l;if(!t)return console.warn("[geminiPromptAnalysis] User store prompt is empty. Defaulting to standard strategy."),{strategy:"standard",theme:"General",requestedProductTypes:[],isPod:!1,podConfidence:0,suggestedPodProducts:[]};const r=new hr({apiKey:t1e}).getGenerativeModel({model:"gemini-1.5-flash-latest",safetySettings:n1e}),s=Oo.map(c=>c.name).join(", "),i=((l=Tw.find(c=>c.value===e))==null?void 0:l.label)||e||"General",o=`
    Analyze the following user prompt for an e-commerce store and the store's product niche.
    User Prompt: "${t}"
    Product Niche: "${i}"
    Available Print-on-Demand (POD) base product types: ${s}.

    Your goal is to determine the best product generation strategy.

    Consider these scenarios:
    1.  If the prompt explicitly mentions "print on demand", "POD", "custom designs on products", "merch", or implies selling items like t-shirts, mugs, posters with custom graphics, or a store themed around a concept (e.g., "Spiderman store", "cat lovers store") where designs are applied to standard products.
    2.  If the prompt requests specific products that are typically print-on-demand (e.g., "I want to sell t-shirts and hoodies with my art", "custom phone cases").
    3.  If the prompt describes a theme (e.g., "a store for coffee lovers", "a store about space exploration") but doesn't specify products, AND the niche is NOT typically print-on-demand (e.g., food, high-end jewelry, complex electronics, furniture). In this case, a POD strategy might be appropriate to offer themed merchandise.
    4.  If the prompt requests products that are clearly NOT print-on-demand (e.g., "gourmet chocolates", "handmade silver necklaces", "custom-built drones", "artisanal wooden tables"), or if the niche itself strongly indicates non-POD products (e.g., "Restaurant", "Tech Repair Service").
    5.  If the prompt is very generic or doesn't give enough information to lean towards POD.

    Based on your analysis, return a JSON object with the following structure:
    {
      "isPod": boolean, // True if the store is likely print-on-demand focused or should use POD products.
      "podConfidence": number, // Confidence score (0.0 to 1.0) for isPod.
      "theme": "string", // A concise theme extracted from the prompt (e.g., "Vintage Cars", "Abstract Art", "Funny Quotes", "Spiderman"). If no clear theme, use "General".
      "requestedProductTypes": ["string"], // Array of specific product names mentioned in the prompt that match or are very similar to the available POD base product types. (e.g., ["Shirt", "Mug"]). Empty if none.
      "suggestedPodProducts": ["string"], // If isPod is true and requestedProductTypes is empty, suggest 3-5 relevant POD base product types from the available list based on the theme/niche. (e.g., ["Shirt", "Mug", "Poster"]). Empty otherwise.
      "generationStrategy": "string" // One of: "standard", "pod_theme_visualization", "pod_specific_products", "error"
    }

    Strategy decision logic:
    -   If "isPod" is true AND "requestedProductTypes" has items: "generationStrategy" should be "pod_specific_products".
    -   If "isPod" is true AND "requestedProductTypes" is empty (implying a themed POD store but no specific products mentioned by user): "generationStrategy" should be "pod_theme_visualization". Use "suggestedPodProducts" for this.
    -   If "isPod" is false: "generationStrategy" should be "standard".
    -   If the niche is something like food, complex tech, high-end jewelry, furniture, and the prompt doesn't strongly push for POD merch, lean towards "standard" even if a theme is mentioned. For example, a "Spiderman themed restaurant" is still "standard" for food products. A "Spiderman store" (general merch) is "pod_theme_visualization".

    Example 1 (Specific POD products):
    User Prompt: "I want to create a store selling t-shirts and coffee mugs with cool dog designs."
    Product Niche: "Fashion & Apparel"
    Expected Output: { "isPod": true, "podConfidence": 0.9, "theme": "Cool Dog Designs", "requestedProductTypes": ["Shirt", "Mug"], "suggestedPodProducts": [], "generationStrategy": "pod_specific_products" }

    Example 2 (Themed POD store, no specific products):
    User Prompt: "A store for fans of classic horror movies, with iconic imagery."
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": true, "podConfidence": 0.8, "theme": "Classic Horror Movies", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug", "Canvas"], "generationStrategy": "pod_theme_visualization" }

    Example 3 (Standard store, non-POD niche):
    User Prompt: "Selling delicious artisanal cookies and pastries."
    Product Niche: "Food & Beverage"
    Expected Output: { "isPod": false, "podConfidence": 0.1, "theme": "Artisanal Cookies and Pastries", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 4 (Themed store, but niche is non-POD, so standard products for niche, POD for merch):
    User Prompt: "A high-tech gadget store with a cyberpunk theme."
    Product Niche: "Electronics & Gadgets"
    Expected Output: { "isPod": false, "podConfidence": 0.3, "theme": "Cyberpunk", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }
    (Note: The task description implies if niche is non-POD but theme is present, we *should* call POD flow. Let's adjust this example's expectation for the AI)
    Revised Example 4 (Themed store, niche non-POD, but POD for merch is desired):
    User Prompt: "A high-tech gadget store with a cyberpunk theme. I want some cool merch too."
    Product Niche: "Electronics & Gadgets"
    Expected Output: { "isPod": true, "podConfidence": 0.7, "theme": "Cyberpunk", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug"], "generationStrategy": "pod_theme_visualization" }


    Example 5 (Unique products, not POD):
    User Prompt: "I craft unique, handmade wooden sculptures."
    Product Niche: "Art & Collectibles"
    Expected Output: { "isPod": false, "podConfidence": 0.05, "theme": "Handmade Wooden Sculptures", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 6 (Generic prompt, default to standard):
    User Prompt: "My new online shop"
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": false, "podConfidence": 0.2, "theme": "General", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 7 (Store theme implies POD, niche is general):
    User Prompt: "A store for all things Spiderman!"
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": true, "podConfidence": 0.9, "theme": "Spiderman", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug", "Hat", "Canvas"], "generationStrategy": "pod_theme_visualization" }

    Ensure the "theme" is concise. If "requestedProductTypes" are found, "suggestedPodProducts" should usually be empty. If "isPod" is true and "requestedProductTypes" is empty, "suggestedPodProducts" MUST be populated with 3-5 relevant items from the available POD list.
    The entire response MUST be a single JSON object.
  `;try{const d=(await r.generateContent(o)).response.text();let h;const f=d.match(/```json\s*([\s\S]*?)\s*```/);if(f&&f[1])h=JSON.parse(f[1]);else{const m=d.indexOf("{"),g=d.lastIndexOf("}");if(m!==-1&&g>m)h=JSON.parse(d.substring(m,g+1));else throw new Error("No JSON object found in response.")}return h.isPod&&(!h.requestedProductTypes||h.requestedProductTypes.length===0)&&(!h.suggestedPodProducts||h.suggestedPodProducts.length===0)&&(h.suggestedPodProducts=r1e.slice(0,Math.floor(Math.random()*3)+3),console.warn(`[geminiPromptAnalysis] POD strategy indicated but no specific or suggested POD products returned by AI. Defaulting suggestions: ${h.suggestedPodProducts.join(", ")}`)),h.strategy||(h.isPod&&h.requestedProductTypes&&h.requestedProductTypes.length>0?h.strategy="pod_specific_products":h.isPod?h.strategy="pod_theme_visualization":h.strategy="standard"),console.log("[geminiPromptAnalysis] Analysis result:",h),h}catch(c){return console.error("[geminiPromptAnalysis] Error analyzing store prompt:",c),{error:c.message,strategy:"error",theme:"General",requestedProductTypes:[],isPod:!1,podConfidence:0,suggestedPodProducts:[]}}}const i1e=J1("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function qp({className:t,variant:e,...n}){return a.jsx("div",{className:Et(i1e({variant:e}),t),...n})}var Fb="Checkbox",[o1e,rje]=Li(Fb),[a1e,lA]=o1e(Fb);function l1e(t){const{__scopeCheckbox:e,checked:n,children:r,defaultChecked:s,disabled:i,form:o,name:l,onCheckedChange:c,required:u,value:d="on",internal_do_not_use_render:h}=t,[f,m]=Bu({prop:n,defaultProp:s??!1,onChange:c,caller:Fb}),[g,x]=p.useState(null),[E,v]=p.useState(null),b=p.useRef(!1),S=g?!!o||!!g.closest("form"):!0,I={checked:f,disabled:i,setChecked:m,control:g,setControl:x,name:l,form:o,value:d,hasConsumerStoppedPropagationRef:b,required:u,defaultChecked:Kl(s)?!1:s,isFormControl:S,bubbleInput:E,setBubbleInput:v};return a.jsx(a1e,{scope:e,...I,children:c1e(h)?h(I):r})}var WW="CheckboxTrigger",HW=p.forwardRef(({__scopeCheckbox:t,onKeyDown:e,onClick:n,...r},s)=>{const{control:i,value:o,disabled:l,checked:c,required:u,setControl:d,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:m,bubbleInput:g}=lA(WW,t),x=Cn(s,d),E=p.useRef(c);return p.useEffect(()=>{const v=i==null?void 0:i.form;if(v){const b=()=>h(E.current);return v.addEventListener("reset",b),()=>v.removeEventListener("reset",b)}},[i,h]),a.jsx(Yt.button,{type:"button",role:"checkbox","aria-checked":Kl(c)?"mixed":c,"aria-required":u,"data-state":XW(c),"data-disabled":l?"":void 0,disabled:l,value:o,...r,ref:x,onKeyDown:_t(e,v=>{v.key==="Enter"&&v.preventDefault()}),onClick:_t(n,v=>{h(b=>Kl(b)?!0:!b),g&&m&&(f.current=v.isPropagationStopped(),f.current||v.stopPropagation())})})});HW.displayName=WW;var cA=p.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c,onCheckedChange:u,form:d,...h}=t;return a.jsx(l1e,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:l,required:o,onCheckedChange:u,name:r,form:d,value:c,internal_do_not_use_render:({isFormControl:f})=>a.jsxs(a.Fragment,{children:[a.jsx(HW,{...h,ref:e,__scopeCheckbox:n}),f&&a.jsx(JW,{__scopeCheckbox:n})]})})});cA.displayName=Fb;var qW="CheckboxIndicator",KW=p.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...s}=t,i=lA(qW,n);return a.jsx(qs,{present:r||Kl(i.checked)||i.checked===!0,children:a.jsx(Yt.span,{"data-state":XW(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...t.style}})})});KW.displayName=qW;var YW="CheckboxBubbleInput",JW=p.forwardRef(({__scopeCheckbox:t,...e},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:o,required:l,disabled:c,name:u,value:d,form:h,bubbleInput:f,setBubbleInput:m}=lA(YW,t),g=Cn(n,m),x=sG(i),E=VP(r);p.useEffect(()=>{const b=f;if(!b)return;const S=window.HTMLInputElement.prototype,D=Object.getOwnPropertyDescriptor(S,"checked").set,k=!s.current;if(x!==i&&D){const C=new Event("click",{bubbles:k});b.indeterminate=Kl(i),D.call(b,Kl(i)?!1:i),b.dispatchEvent(C)}},[f,x,i,s]);const v=p.useRef(Kl(i)?!1:i);return a.jsx(Yt.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??v.current,required:l,disabled:c,name:u,value:d,form:h,...e,tabIndex:-1,ref:g,style:{...e.style,...E,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});JW.displayName=YW;function c1e(t){return typeof t=="function"}function Kl(t){return t==="indeterminate"}function XW(t){return Kl(t)?"indeterminate":t?"checked":"unchecked"}const QW=p.forwardRef(({className:t,...e},n)=>a.jsx(cA,{ref:n,className:Et("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:a.jsx(KW,{className:Et("flex items-center justify-center text-current"),children:a.jsx(rg,{className:"h-4 w-4"})})}));QW.displayName=cA.displayName;const u1e=({isOpen:t,onClose:e,collection:n,allProducts:r,onSave:s})=>{const[i,o]=p.useState([]),[l,c]=p.useState("");if(p.useEffect(()=>{n&&n.product_ids?o(n.product_ids):o([])},[n]),!n)return null;const u=h=>{o(f=>f.includes(h)?f.filter(m=>m!==h):[...f,h])},d=()=>{s(n.id??n.name,i),e()};return a.jsx(Ps,{open:t,onOpenChange:e,children:a.jsxs(ls,{className:"sm:max-w-[525px]",children:[a.jsxs(cs,{children:[a.jsxs(us,{children:['Manage Products for "',n.name||"Unnamed Collection",'"']}),a.jsx(No,{children:"Select or unselect products to include in this collection. Use the search bar to filter products."})]}),a.jsxs("div",{className:"py-4",children:[a.jsx(st,{type:"text",placeholder:"Search products...",value:l,onChange:h=>c(h.target.value),className:"mb-4"}),r&&r.length>0?a.jsxs(Zi,{className:"h-[250px] pr-4",children:[" ",a.jsx("div",{className:"space-y-3",children:r.filter(h=>h.name.toLowerCase().includes(l.toLowerCase())).map(h=>a.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-md hover:bg-muted/50 transition-colors",children:[a.jsx(QW,{id:`product-${n.id??n.name}-${h.id??h.name}`,checked:i.includes(h.id??h.name),onCheckedChange:()=>u(h.id??h.name)}),a.jsx(je,{htmlFor:`product-${n.id??n.name}-${h.id??h.name}`,className:"flex-1 cursor-pointer",children:a.jsxs("div",{className:"flex items-center gap-3",children:[h.images&&h.images.length>0?a.jsx("img",{src:h.images[0],alt:h.name,className:"w-12 h-12 object-cover rounded-sm"}):a.jsx("div",{className:"w-12 h-12 bg-muted rounded-sm flex items-center justify-center text-xs text-muted-foreground",children:"No Img"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:h.name||"Untitled Product"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",h.price||"0.00"]})]})]})})]},h.id??h.name))})]}):a.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No products available to add to this collection. Please add products to your store first."})]}),a.jsxs(jr,{children:[a.jsx(ja,{asChild:!0,children:a.jsx(U,{type:"button",variant:"outline",children:"Cancel"})}),a.jsx(U,{type:"button",onClick:d,disabled:!r||r.length===0,children:"Save Changes"})]})]})})},d1e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),h1e=({isOpen:t,onClose:e,product:n,onSave:r,onGenerateMainImage:s,onGenerateMoreAngles:i,productIndexInWizard:o,isGeneratingProductImage:l,isGeneratingAngles:c})=>{const[u,d]=p.useState(null),{toast:h}=Ks();p.useEffect(()=>{if(n){const P=n.variants?n.variants.map(M=>({...M,values:Array.isArray(M.values)?[...M.values]:typeof M.values=="string"?M.values.split(",").map(j=>j.trim()).filter(j=>j):[]})):[],A=Array.isArray(n.images)?[...n.images]:[],R={...n,variants:P,images:A};A.length===0&&n.imageUrl&&(R.images=[n.imageUrl]),d(R)}else d(null)},[n,t]);const f=P=>{const{name:A,value:R,type:M}=P.target;d(j=>({...j,[A]:M==="number"?parseFloat(R)||0:R}))},m=P=>{d(A=>({...A,images:P}))},g=async P=>{if(P.target.files&&P.target.files.length>0){const R=Array.from(P.target.files).map(M=>d1e(M));try{const M=await Promise.all(R);m([...u.images||[],...M])}catch{h({title:"Image Upload Error",description:"Could not process some images.",variant:"destructive"})}}},x=P=>{m((u.images||[]).filter((A,R)=>R!==P))},E=async()=>{s&&o!==null&&u&&await s(o,u)},v=async()=>{i&&o!==null&&u&&u.images&&u.images.length>0?await i(o,u):h({title:"Cannot Generate Angles",description:"A main image is required first.",variant:"warning"})},b=(P,A,R)=>{d(M=>{const j=[...M.variants||[]];return j[P]={...j[P],[A]:R},{...M,variants:j}})},S=(P,A,R)=>{d(M=>{const j=[...M.variants||[]],z=[...j[P].values];return z[A]=R,j[P]={...j[P],values:z},{...M,variants:j}})},I=P=>{d(A=>{const R=[...A.variants||[]],M=[...R[P].values,""];return R[P]={...R[P],values:M},{...A,variants:R}})},D=(P,A)=>{d(R=>{const M=[...R.variants||[]],j=M[P].values.filter((z,W)=>W!==A);return M[P]={...M[P],values:j},j.length===0&&h({title:"Info",description:`Variant option "${M[P].name}" has no values.`,variant:"default"}),{...R,variants:M}})},k=()=>{d(P=>({...P,variants:[...P.variants||[],{name:"",values:[""]}]}))},C=P=>{d(A=>({...A,variants:(A.variants||[]).filter((R,M)=>M!==P)}))},T=()=>{if(!u.name||u.name.trim()===""){h({title:"Validation Error",description:"Product name cannot be empty.",variant:"destructive"});return}if(u.price===void 0||u.price===null||isNaN(parseFloat(u.price))||parseFloat(u.price)<0){h({title:"Validation Error",description:"Product price must be a valid non-negative number.",variant:"destructive"});return}const P=u.variants?u.variants.map(A=>({...A,name:A.name.trim(),values:A.values.map(R=>R.trim()).filter(R=>R!=="")})).filter(A=>A.name!==""&&A.values.length>0):[];r({...u,variants:P}),e()};return!t||!u?null:a.jsx(Ps,{open:t,onOpenChange:P=>{P||e()},children:a.jsxs(ls,{className:"sm:max-w-2xl",children:[a.jsxs(cs,{children:[a.jsx(us,{children:"Edit AI Generated Product"}),a.jsx(No,{children:"Modify the details of the generated product below."})]}),a.jsx(Zi,{className:"max-h-[70vh] p-1 pr-3",children:a.jsxs("div",{className:"space-y-4 py-4 pr-2",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"name",children:"Product Name"}),a.jsx(st,{id:"name",name:"name",value:u.name||"",onChange:f})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"price",children:"Price (USD)"}),a.jsx(st,{id:"price",name:"price",type:"number",value:u.price||0,onChange:f})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"description",children:"Description"}),a.jsx(Vn,{id:"description",name:"description",value:u.description||"",onChange:f,rows:4})]}),a.jsxs("div",{className:"space-y-2 border p-3 rounded-md",children:[a.jsx(je,{className:"text-md font-semibold",children:"Product Images"}),u.images&&u.images.length>0?a.jsx("div",{className:"overflow-x-auto py-2",children:a.jsx("div",{className:"flex flex-row gap-2 mb-2 min-w-max",children:u.images.map((P,A)=>a.jsxs("div",{className:"relative group flex-shrink-0",children:[a.jsx("img",{src:P,alt:`Product image ${A+1}`,className:"w-24 h-24 object-contain rounded-md border"}),a.jsx(U,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>x(A),children:a.jsx(sr,{className:"h-3.5 w-3.5"})})]},`${P}-${A}`))})}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No images yet."}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[a.jsxs(U,{variant:"outline",size:"sm",onClick:()=>document.getElementById("editAiProductImageUpload").click(),children:[a.jsx(Jo,{className:"mr-2 h-4 w-4"})," Upload Images"]}),a.jsx(st,{id:"editAiProductImageUpload",type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:g}),a.jsxs(U,{variant:"outline",size:"sm",onClick:E,disabled:l||!u.name,children:[l?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(is,{className:"mr-2 h-4 w-4"}),u.images&&u.images.length>0?"Regenerate Main":"Generate Main"]}),u.images&&u.images.length>0&&a.jsxs(U,{variant:"outline",size:"sm",onClick:v,disabled:c,children:[c?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(is,{className:"mr-2 h-4 w-4"}),"More Angles"]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-md font-semibold",children:"Variants"}),(u.variants||[]).map((P,A)=>a.jsxs(We,{className:"p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(je,{htmlFor:`variantName-${A}`,children:"Option Name"}),a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>C(A),className:"h-7 w-7",children:a.jsx(sr,{className:"h-4 w-4 text-destructive"})})]}),a.jsx(st,{id:`variantName-${A}`,value:P.name||"",onChange:R=>b(A,"name",R.target.value),placeholder:"e.g., Color, Size"}),a.jsx(je,{children:"Option Values"}),P.values.map((R,M)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(st,{value:R||"",onChange:j=>S(A,M,j.target.value),placeholder:"e.g., Red, Large"}),a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>D(A,M),className:"h-7 w-7",children:a.jsx(sr,{className:"h-4 w-4 text-destructive"})})]},M)),a.jsxs(U,{variant:"outline",size:"sm",onClick:()=>I(A),children:[a.jsx(go,{className:"mr-2 h-4 w-4"})," Add Value"]})]},A)),a.jsxs(U,{variant:"outline",onClick:k,className:"w-full",children:[a.jsx(go,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]})}),a.jsxs(jr,{children:[a.jsx(ja,{asChild:!0,children:a.jsx(U,{type:"button",variant:"outline",onClick:e,children:"Cancel"})}),a.jsx(U,{type:"button",onClick:T,children:"Save Changes"})]})]})})},bd=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),EL=(t,e)=>{const{formData:n,setFormData:r,handleInputChange:s,handleProductTypeChange:i,handleProductSourceChange:o,handleProductCountChange:l,handleManualProductChange:c,addManualProduct:u,removeManualProduct:d,suggestStoreName:h,generateLogo:f,generateAiProducts:m,generateAiCollections:g,handleGenerateManualProductImage:x,handleGenerateMoreAngles:E,isProcessing:v,isGeneratingProductImageForIndex:b,productImageGenerationError:S,isGeneratingAnglesForIndex:I,angleGenerationError:D,storeNameSuggestions:k,handleSuggestionClick:C,suggestionError:T,handleInitialImportMethodChange:P,handleProductPhotoUpload:A,uploadedProductPhotos:R,removeUploadedProductPhoto:M,isProcessingPhotos:j,handleGenerateCollectionImage:z,isGeneratingCollectionImageForIndex:W,collectionImageGenerationError:q,isCheckingStoreName:H,storeNameAvailability:$,handleManualStoreNameCheck:J}=e,[O,V]=p.useState(""),[G,F]=p.useState(""),[ue,Ee]=p.useState(null),[Se,we]=p.useState(null),[Fe,Ze]=p.useState(""),[ze,nt]=p.useState(""),[qe,yt]=p.useState([]),[Le,Ae]=p.useState([]);p.useState(null);const[pt,mt]=p.useState([]),[Ht,Ft]=p.useState(!1),[nn,Tn]=p.useState(!1),[gn,Qe]=p.useState(""),{toast:Be}=Ks(),[ct,he]=p.useState(!1),[Ie,ee]=p.useState(null),[ne,X]=p.useState(null),me=(Y,Z,oe)=>{r(be=>{const Ce=[...be.products.items],Q={...Ce[Y]};return Q.variants=[...Q.variants||[]],Q.variants[Z]={...Q.variants[Z],name:oe},Ce[Y]=Q,{...be,products:{...be.products,items:Ce}}})},ye=(Y,Z,oe,be)=>{r(Ce=>{const Q=[...Ce.products.items],fe={...Q[Y]};fe.variants=[...fe.variants||[]];const Re={...fe.variants[Z]};return Re.values=[...Re.values||[]],Re.values[oe]=be,fe.variants[Z]=Re,Q[Y]=fe,{...Ce,products:{...Ce.products,items:Q}}})},De=(Y,Z)=>{r(oe=>{const be=[...oe.products.items],Ce={...be[Y]};Ce.variants=[...Ce.variants||[]];const Q={...Ce.variants[Z]};return Q.values=[...Q.values||[],""],Ce.variants[Z]=Q,be[Y]=Ce,{...oe,products:{...oe.products,items:be}}})},Oe=(Y,Z,oe)=>{r(be=>{const Ce=[...be.products.items],Q={...Ce[Y]};Q.variants=[...Q.variants||[]];const fe={...Q.variants[Z]};return fe.values=(fe.values||[]).filter((Re,et)=>et!==oe),Q.variants[Z]=fe,fe.values.length===0&&Be({title:"Info",description:`Variant option "${fe.name}" has no values. Consider removing the option or adding values.`,variant:"default"}),Ce[Y]=Q,{...be,products:{...be.products,items:Ce}}})},re=Y=>{r(Z=>{const oe=[...Z.products.items],be={...oe[Y]};return be.variants=[...be.variants||[],{name:"",values:[""]}],oe[Y]=be,{...Z,products:{...Z.products,items:oe}}})},pe=(Y,Z)=>{r(oe=>{const be=[...oe.products.items],Ce={...be[Y]};return Ce.variants=(Ce.variants||[]).filter((Q,fe)=>fe!==Z),be[Y]=Ce,{...oe,products:{...oe.products,items:be}}})},Me=async Y=>{const Z=Y.target.files[0];if(Z){Qe(""),Ee(Z);try{const oe=await bd(Z);F(oe),V(""),Be({title:"Image Uploaded",description:"Your image is ready for visualization."})}catch(oe){console.error("Error converting uploaded file to base64:",oe),Qe("Failed to load uploaded image. Please try again."),Be({variant:"destructive",title:"Upload Failed",description:"Could not process the uploaded image."}),F(""),Ee(null)}}},ve=()=>{F(""),Ee(null),V(""),Qe("");const Y=document.getElementById("podImageUpload");Y&&(Y.value="")},gt=async Y=>{const Z=Y.target.files[0];if(Z){Qe(""),we(Z);try{const oe=await bd(Z);Ze(oe),Be({title:"Reference Image Added",description:"This image will be used with your prompt for generation."})}catch(oe){console.error("Error converting reference file to base64:",oe),Qe("Failed to load reference image. Please try again."),Be({variant:"destructive",title:"Reference Image Load Failed",description:"Could not process the reference image."}),Ze(""),we(null)}}},wt=()=>{Ze(""),we(null),Qe("");const Y=document.getElementById("podReferenceImageUpload");Y&&(Y.value="")},dt=async()=>{if(!O){Be({title:"Missing Prompt",description:"Please enter a prompt for image generation.",variant:"destructive"});return}if(ue){Be({title:"Image Already Uploaded",description:"An image has already been uploaded. Clear it if you want to generate a new one.",variant:"warning"});return}Ft(!0),Qe(""),F("");let Y={prompt:O};if(Se&&Fe){const[Z,oe]=Fe.split(","),be=Z.match(/:(.*?);/)[1];Y.referenceImage={base64Data:oe,mimeType:be,fileName:Se.name},console.log("Attempting to generate POD image preview with prompt and reference image:",O,Se.name)}else console.log("Attempting to generate POD image preview for prompt:",O);try{const Z=await b0(Y);if(Z.imageData&&Z.imageMimeType){const oe=`data:${Z.imageMimeType};base64,${Z.imageData}`;F(oe),console.log("POD Image preview generated successfully.")}else throw new Error(Z.textResponse||"Image data not returned from API.")}catch(Z){console.error("Error generating POD image preview:",Z);const oe=Z.message||"Failed to generate image preview.";Qe(oe),Be({variant:"destructive",title:"Image Generation Failed",description:oe})}finally{Ft(!1)}},xt=Y=>{const Z=Y.target.value;nt(Z),yt(Z?Oo.filter(oe=>oe.name.toLowerCase().includes(Z.toLowerCase())):[])},At=Y=>{Ae(Z=>Z.some(be=>be.name===Y.name)?Z.filter(be=>be.name!==Y.name):[...Z,Y])},Nn=async()=>{if(!G||Le.length===0){Be({title:"Missing Selections",description:"Please provide an image (generate or upload) and select at least one product type to visualize.",variant:"destructive"});return}let Y;if(ue&&ue.name?Y=`Uploaded: ${ue.name}`:O?Y=O:Y="Custom design",!ue&&!O){Be({title:"Missing Prompt",description:"If not uploading an image, please enter a prompt to generate an image first.",variant:"destructive"});return}Tn(!0),Qe(""),mt([]);const[Z,oe]=G.split(","),be=Z.match(/:(.*?);/)[1];let Ce=!0;const Q=[];for(const fe of Le)try{console.log("Attempting to visualize POD product:",fe.name);const Re=await og(oe,be,fe.imageUrl,Y,fe.name);if(Re.visualizedImageData&&Re.productDetails){const et=`data:${Re.visualizedImageMimeType};base64,${Re.visualizedImageData}`;Q.push({title:Re.productDetails.title,price:parseFloat(Re.productDetails.price).toFixed(2),description:Re.productDetails.description,finalImageUrl:et,baseProductName:fe.name,generatedImagePrompt:Y,baseProductImageUrl:fe.imageUrl,sourceImageUsedForVisualization:G,tempId:`${fe.name}-${Date.now()}`}),console.log("POD Product visualized successfully:",fe.name)}else Ce=!1,console.error("Visualization failed for product:",fe.name,Re),Qe(et=>et+`Visualization failed for ${fe.name}. `)}catch(Re){Ce=!1,console.error("Error visualizing POD product:",fe.name,Re);const et=Re.message||`Failed to visualize ${fe.name}.`;Qe(it=>it+et+" ")}mt(Q),Ce?Q.length>0&&Be({title:"Visualization Complete",description:`${Q.length} product(s) visualized. You can now add them to your store.`}):Be({variant:"destructive",title:"Some Visualizations Failed",description:"Check errors below. Some products may not have visualized correctly."}),Tn(!1)},on=Y=>{if(!Y)return;const Z={name:Y.title,price:Y.price,description:Y.description,imageUrl:Y.finalImageUrl,isPrintOnDemand:!0,podDetails:{...Y}};delete Z.podDetails.tempId,r(oe=>({...oe,products:{...oe.products,items:[...oe.products.items,Z]}})),mt(oe=>oe.filter(be=>be.tempId!==Y.tempId)),pt.length===1&&pt[0].tempId===Y.tempId&&(Ae([]),nt("")),Be({title:"Product Added",description:`"${Z.name}" added to your store's products.`})},_r=Y=>{r(Z=>({...Z,products:{...Z.products,items:Z.products.items.filter((oe,be)=>be!==Y)}})),Be({title:"Product Removed",description:"The Print on Demand product has been removed from your list.",variant:"destructive"})},[Gn,Jt]=p.useState(!1),[an,Mn]=p.useState(null),K=(Y,Z,oe)=>{r(be=>{const Ce=[...be.collections.items];return Ce[Y][Z]=oe,{...be,collections:{...be.collections,items:Ce}}})},te=()=>{r(Y=>({...Y,collections:{...Y.collections,items:[...Y.collections.items,{name:"",description:"",imageUrl:""}]}}))},ce=Y=>{r(Z=>{const oe=Z.collections.items.filter((be,Ce)=>Ce!==Y);return{...Z,collections:{...Z.collections,items:oe}}})},ke=Y=>{Mn(Y),Jt(!0)},Ve=(Y,Z)=>{r(oe=>{const be=oe.collections.items.map(Ce=>Ce.id&&Ce.id===Y||Ce.name===Y?{...Ce,product_ids:Z}:Ce);return{...oe,collections:{...oe.collections,items:be}}}),Jt(!1),Mn(null)};switch(t){case 1:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"initialImportMethod",className:"text-lg font-semibold",children:"How would you like to start?"}),a.jsxs(pu,{onValueChange:P,value:n.initialImportMethod||"productType",children:[a.jsx(Hl,{id:"initialImportMethod",className:"mt-2",children:a.jsx(gu,{placeholder:"Choose starting method..."})}),a.jsxs(ql,{children:[a.jsx(Jn,{value:"productType",children:"Describe Product Type"}),a.jsx(Jn,{value:"photos",children:"Start from Product Photos"})]})]})]}),n.initialImportMethod==="productType"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(je,{htmlFor:"productType",className:"text-md font-medium",children:"What kind of products will your store sell?"}),a.jsx(st,{id:"productType",name:"productType",value:n.productType,onChange:Y=>i(Y.target.value),placeholder:"e.g., Fashion, Electronics, Home Decor",list:"productTypeSuggestions"}),a.jsx("datalist",{id:"productTypeSuggestions",children:Tw.map(Y=>a.jsx("option",{value:Y.label},Y.value))}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This helps us tailor product suggestions and store design. Type to see suggestions."})]}),n.initialImportMethod==="photos"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(je,{htmlFor:"productPhotosUpload",className:"text-md font-medium",children:"Upload Product Photos"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload multiple photos of your products. We'll use AI to understand them and pre-fill store details."}),a.jsx(st,{id:"productPhotosUpload",type:"file",multiple:!0,accept:"image/*",onChange:A,className:`block w-full text-sm text-slate-500
                  file:mr-4 file:py-2 file:px-4
                  file:rounded-full file:border-0
                  file:text-sm file:font-semibold
                  file:bg-primary/10 file:text-primary
                  hover:file:bg-primary/20`,disabled:j}),j&&a.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing uploaded photos..."]}),R&&R.length>0&&a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Uploaded Photos (",R.length,"):"]}),a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3",children:R.map((Y,Z)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:Y.previewUrl||Y,alt:`Uploaded product ${Z+1}`,className:"w-full aspect-square object-cover rounded-md border"}),a.jsx(U,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:()=>M(Z),disabled:j,children:a.jsx(sr,{className:"h-3.5 w-3.5"})})]},Z))})]})]})]},"step1");case 2:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-4 w-full",children:[a.jsx(je,{htmlFor:"storeName",className:"text-lg font-semibold",children:"What's your store name?"}),a.jsxs("div",{className:"relative flex items-center gap-2",children:[a.jsx(st,{id:"storeName",name:"storeName",value:n.storeName,onChange:s,placeholder:"e.g., 'The Cozy Corner Bookstore'",className:"flex-grow pr-20"}),a.jsxs(U,{type:"button",variant:"ghost",size:"sm",onClick:J,disabled:!n.storeName||H,className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 px-2 z-10",children:[H?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(Yo,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-1 hidden sm:inline",children:"Check"})]})]}),a.jsxs(U,{type:"button",variant:"outline",onClick:h,disabled:v||H||!n.productType,className:"w-full mt-2 sm:w-auto sm:mt-0",children:[v&&!H?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(is,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2",children:"Suggest Names"})]}),a.jsxs("div",{className:"h-5 mt-1",children:[" ",H&&n.storeName&&a.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[a.jsx(St,{className:"h-4 w-4 animate-spin mr-2"})," Checking..."]}),$&&n.storeName&&!H&&a.jsxs("p",{className:`text-sm font-medium ${$.status==="available"?"text-green-600":$.status==="claimed"?"text-red-600":$.status==="error"?"text-yellow-600":"text-muted-foreground"}`,children:[$.message==="Available"?a.jsx(Yo,{className:"inline h-4 w-4 mr-1"}):"",$.message]})]}),!n.storeName&&!H&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:'Choose a catchy name or let us suggest one. Click "Check" to verify availability.'}),T&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:T}),k&&k.length>0&&a.jsxs("div",{className:"mt-3 space-y-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:k.map((Y,Z)=>a.jsx(U,{variant:"outline",size:"sm",onClick:()=>C(Y),className:"bg-primary-foreground dark:bg-neutral-800 hover:bg-primary/10 dark:hover:bg-neutral-700",children:Y},Z))})]})]},"step2");case 3:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(je,{className:"text-lg font-semibold",children:"Design a logo for your store"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center p-4 border rounded-md",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(je,{className:"text-sm mb-2",children:"For Light Backgrounds"}),n.logoUrlDark?a.jsx("img",{src:n.logoUrlDark,alt:"Logo for light backgrounds",className:"w-48 h-48 object-contain rounded-md border bg-white"}):a.jsx("div",{className:"w-48 h-48 bg-gray-100 rounded-md flex items-center justify-center text-muted-foreground",children:"Light Bg Preview"})]}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(je,{className:"text-sm mb-2",children:"For Dark Backgrounds"}),n.logoUrlLight?a.jsx("img",{src:n.logoUrlLight,alt:"Logo for dark backgrounds",className:"w-48 h-48 object-contain rounded-md border bg-gray-800"}):a.jsx("div",{className:"w-48 h-48 bg-gray-700 rounded-md flex items-center justify-center text-gray-400",children:"Dark Bg Preview"})]})]}),a.jsxs(U,{type:"button",onClick:f,disabled:v||!n.storeName,className:"w-full",children:[v?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(na,{className:"mr-2 h-4 w-4"}),"Generate Logo with AI (Light & Dark Versions)"]}),a.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"AI will generate a logo, remove its background, and attempt to create light/dark mode versions."}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(je,{className:"text-sm",children:"Manually set logos (optional):"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"logoUrlDarkUpload",className:"text-xs",children:"Logo for Light Background (e.g., black logo)"}),a.jsx(st,{id:"logoUrlDarkUpload",type:"file",accept:"image/*",className:"mt-1 text-xs",onChange:async Y=>{if(Y.target.files&&Y.target.files[0]){const Z=Y.target.files[0];try{const oe=await bd(Z);r(be=>({...be,logoUrlDark:oe}))}catch(oe){console.error("Error converting file for logoUrlDark:",oe)}}}})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"logoUrlLightUpload",className:"text-xs",children:"Logo for Dark Background (e.g., white logo)"}),a.jsx(st,{id:"logoUrlLightUpload",type:"file",accept:"image/*",className:"mt-1 text-xs",onChange:async Y=>{if(Y.target.files&&Y.target.files[0]){const Z=Y.target.files[0];try{const oe=await bd(Z);r(be=>({...be,logoUrlLight:oe}))}catch(oe){console.error("Error converting file for logoUrlLight:",oe)}}}})]})]})]}),(n.logoUrlLight||n.logoUrlDark)&&a.jsxs(U,{variant:"destructive",size:"sm",onClick:()=>r(Y=>({...Y,logoUrlLight:"",logoUrlDark:""})),className:"mt-4 w-full",children:[a.jsx(sr,{className:"mr-2 h-4 w-4"})," Remove All Logos"]})]},"step3");case 4:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(je,{className:"text-lg font-semibold",children:"How do you want to add products?"}),a.jsxs(pu,{onValueChange:o,value:n.products.source,children:[a.jsx(Hl,{children:a.jsx(gu,{placeholder:"Choose product source..."})}),a.jsxs(ql,{children:[a.jsx(Jn,{value:"ai",children:"Generate with AI"}),a.jsx(Jn,{value:"manual",children:"Add Manually"}),a.jsx(Jn,{value:"printOnDemand",children:"Print on Demand"}),a.jsx(Jn,{value:"csv",disabled:!0,children:"Upload CSV (Coming Soon)"})]})]}),n.products.source==="ai"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"productCount",children:"Number of AI Products to Generate"}),a.jsx(st,{id:"productCount",type:"number",min:"1",max:"5",value:n.products.count,onChange:l})]}),a.jsxs(U,{type:"button",onClick:m,disabled:v||!n.productType||!n.storeName,className:"w-full",children:[v?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(is,{className:"mr-2 h-4 w-4"}),"Generate Products with AI"]}),T&&n.products.source==="ai"&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:T}),n.products.items.length>0&&a.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2 mt-4",children:[" ",a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Generated Products:"}),n.products.items.map((Y,Z)=>a.jsxs(We,{className:"p-4 flex gap-4 items-start relative",children:[Y.images&&Y.images.length>0?a.jsx("img",{src:Y.images[0],alt:Y.name,className:"w-24 h-24 object-cover rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-md",children:Y.name||"Untitled Product"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["$",Y.price||"0.00"]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:Y.description||"No description."}),Y.variants&&Y.variants.length>0&&a.jsx("div",{className:"mt-1.5",children:Y.variants.map((oe,be)=>a.jsxs("div",{className:"text-xs",children:[a.jsxs("span",{className:"font-medium text-muted-foreground",children:[oe.name,": "]}),a.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:Array.isArray(oe.values)?oe.values.join(", "):oe.values})]},be))})]}),a.jsx(U,{variant:"outline",size:"icon",className:"absolute top-2 right-2 h-8 w-8",onClick:()=>{ee({...Y}),X(Z),he(!0)},children:a.jsx(Av,{className:"h-4 w-4"})})]},Z))]})]}),ct&&ne!==null&&n.products.items[ne]&&a.jsx(h1e,{isOpen:ct,onClose:()=>{he(!1),X(null)},product:n.products.items[ne],onSave:Y=>{r(Z=>{const oe=[...Z.products.items];return ne!==null&&oe[ne]&&(oe[ne]=Y),{...Z,products:{...Z.products,items:oe}}}),he(!1),ee(null),X(null),Be({title:"Product Updated",description:`"${Y.name}" has been updated.`})},onGenerateMainImage:x,onGenerateMoreAngles:E,productIndexInWizard:ne,isGeneratingProductImage:b===ne,isGeneratingAngles:I===ne}),n.products.source==="manual"&&a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[" ",n.products.items.map((Y,Z)=>a.jsxs(We,{className:"p-4 space-y-3 relative",children:[a.jsx(U,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7",onClick:()=>d(Z),disabled:n.products.items.length<=1,children:a.jsx(sr,{className:"h-4 w-4 text-destructive"})}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:`productName-${Z}`,children:"Product Name"}),a.jsx(st,{id:`productName-${Z}`,value:Y.name,onChange:oe=>c(Z,"name",oe.target.value),placeholder:"e.g., 'Handmade Coffee Mug'"})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:`productPrice-${Z}`,children:"Price (USD)"}),a.jsx(st,{id:`productPrice-${Z}`,type:"number",value:Y.price,onChange:oe=>c(Z,"price",oe.target.value),placeholder:"e.g., '24.99'"})]})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:`productDescription-${Z}`,children:"Short Description (Optional)"}),a.jsx(Vn,{id:`productDescription-${Z}`,value:Y.description,onChange:oe=>c(Z,"description",oe.target.value),placeholder:"e.g., 'Beautifully crafted ceramic mug, perfect for your morning coffee.'",rows:2})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 border rounded-md",children:[Y.images&&Y.images.length>0?a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:Y.images.map((oe,be)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:oe,alt:`${Y.name||"Product"} image ${be+1}`,className:"w-20 h-20 object-contain rounded-md border"}),a.jsx(U,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{const Ce=Y.images.filter((Q,fe)=>fe!==be);c(Z,"images",Ce)},children:a.jsx(sr,{className:"h-3 w-3"})})]},be))}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground mb-2",children:"No Images"}),a.jsx(je,{htmlFor:`productImageUpload-${Z}`,className:"text-sm sr-only",children:"Upload Product Images"}),a.jsx(st,{id:`productImageUpload-${Z}`,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:async oe=>{if(oe.target.files&&oe.target.files.length>0){const Ce=Array.from(oe.target.files).map(Q=>bd(Q));try{const Q=await Promise.all(Ce),fe=[...Y.images||[],...Q];c(Z,"images",fe)}catch(Q){console.error("Error converting files to base64:",Q),Be({title:"Image Upload Error",description:"Could not process some images.",variant:"destructive"})}}}}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs(U,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`productImageUpload-${Z}`).click(),children:[a.jsx(Jo,{className:"mr-2 h-4 w-4"})," Upload Images"]}),Y.images&&Y.images.length>0&&a.jsxs(U,{variant:"destructive",size:"sm",onClick:()=>c(Z,"images",[]),children:[a.jsx(sr,{className:"mr-2 h-4 w-4"})," Remove All"]}),a.jsxs(U,{type:"button",variant:"outline",size:"sm",onClick:()=>x(Z),disabled:b===Z||!Y.name,children:[b===Z?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(is,{className:"mr-2 h-4 w-4"}),"Generate Main Image"]}),Y.images&&Y.images.length>0&&a.jsxs(U,{type:"button",variant:"outline",size:"sm",onClick:()=>E(Z),disabled:I===Z,children:[I===Z?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(is,{className:"mr-2 h-4 w-4"}),"Generate More Angles"]})]}),S&&b===Z&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:S}),D&&I===Z&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:D})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(Y.variants||[]).map((oe,be)=>a.jsxs(We,{className:"p-2 space-y-2 bg-muted/50",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(je,{htmlFor:`manualVariantName-${Z}-${be}`,className:"text-xs",children:"Option Name"}),a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>pe(Z,be),className:"h-6 w-6",children:a.jsx(sr,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(st,{id:`manualVariantName-${Z}-${be}`,value:oe.name||"",onChange:Ce=>me(Z,be,Ce.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(je,{className:"text-xs",children:"Option Values"}),(oe.values||[]).map((Ce,Q)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(st,{value:Ce||"",onChange:fe=>ye(Z,be,Q,fe.target.value),placeholder:"e.g., Red, Large",className:"text-sm h-8"}),a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>Oe(Z,be,Q),className:"h-6 w-6",children:a.jsx(sr,{className:"h-3 w-3 text-destructive"})})]},Q)),a.jsxs(U,{variant:"outline",size:"sm",onClick:()=>De(Z,be),className:"text-xs h-7",children:[a.jsx(go,{className:"mr-1 h-3 w-3"})," Add Value"]})]},be)),a.jsxs(U,{variant:"outline",onClick:()=>re(Z),className:"w-full text-sm h-8",children:[a.jsx(go,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]},Z)),a.jsxs(U,{type:"button",variant:"outline",onClick:()=>{u()},className:"w-full",children:[a.jsx(go,{className:"mr-2 h-4 w-4"})," Add Another Product"]})]}),n.products.source==="printOnDemand"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-md font-semibold",children:"Configure Print on Demand Product"}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"podImagePrompt",children:"Image Generation Prompt"}),a.jsx(Vn,{id:"podImagePrompt",placeholder:"e.g., A majestic wolf howling at a vibrant aurora borealis",value:O,onChange:Y=>V(Y.target.value),rows:2}),a.jsxs(U,{type:"button",onClick:dt,disabled:v||Ht||!O||!!ue,className:"mt-2",variant:"outline",children:[Ht?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(is,{className:"mr-2 h-4 w-4"}),"Generate Image"]}),a.jsxs(U,{type:"button",variant:"outline",className:"mt-2 ml-2",onClick:()=>document.getElementById("podReferenceImageUpload").click(),disabled:v||Ht||!!ue,children:[a.jsx(Jo,{className:"mr-2 h-4 w-4"})," Add Ref. Image"]}),a.jsx(st,{id:"podReferenceImageUpload",type:"file",accept:"image/*",className:"hidden",onChange:gt})]}),Fe&&a.jsxs("div",{className:"mt-2 flex flex-col items-start text-sm",children:[a.jsx(je,{className:"mb-1",children:"Reference Image:"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:Fe,alt:"Reference preview",className:"w-16 h-16 object-contain rounded-md border bg-muted"}),a.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[150px]",children:Se==null?void 0:Se.name}),a.jsx(U,{type:"button",variant:"ghost",size:"icon",onClick:wt,className:"h-7 w-7",children:a.jsx(sr,{className:"h-4 w-4 text-destructive"})})]})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t",children:[a.jsx(je,{htmlFor:"podImageUpload",children:"Or Upload Final Image for Product"}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(st,{id:"podImageUpload",type:"file",accept:"image/*",onChange:Me,className:"flex-grow",disabled:Ht}),G&&ue&&a.jsx(U,{type:"button",variant:"ghost",size:"icon",onClick:ve,className:"h-9 w-9",children:a.jsx(sr,{className:"h-4 w-4 text-destructive"})})]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"If you upload an image, it will be used instead of the generated one."})]}),gn&&a.jsxs("div",{className:"mt-2 p-2 bg-destructive/10 border border-destructive/50 rounded-md text-destructive text-sm flex items-center gap-2",children:[a.jsx(ng,{className:"h-5 w-5"}),a.jsx("p",{children:gn})]}),G&&a.jsxs("div",{className:"mt-2 flex flex-col items-center",children:[a.jsx(je,{className:"mb-1",children:"Image Preview:"}),a.jsx("img",{src:G,alt:"Generated preview",className:"w-40 h-40 object-contain rounded-md border bg-muted"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(je,{htmlFor:"podProductSearch",children:"Search Print on Demand Products"}),a.jsx(st,{id:"podProductSearch",placeholder:"e.g., T-shirt, Mug",value:ze,onChange:xt,disabled:!G}),qe.length>0&&a.jsx(We,{className:"absolute z-10 w-full mt-1 max-h-48 overflow-y-auto border bg-background shadow-lg",children:qe.map(Y=>{const Z=Le.some(oe=>oe.name===Y.name);return a.jsxs("div",{className:`p-2 hover:bg-muted cursor-pointer flex items-center gap-2 ${Z?"bg-primary/10":""}`,onClick:()=>At(Y),children:[a.jsx("img",{src:Y.imageUrl,alt:Y.name,className:"w-8 h-8 object-contain rounded-sm"}),a.jsx("span",{children:Y.name}),Z&&a.jsx(Yo,{className:"h-4 w-4 text-primary ml-auto"})]},Y.name)})})]}),Le.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsx(je,{className:"text-sm mb-1 block",children:"Selected Product Types:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Le.map(Y=>a.jsxs(qp,{variant:"secondary",className:"flex items-center gap-1.5 pr-1",children:[Y.name,a.jsx(U,{variant:"ghost",size:"icon",className:"h-5 w-5 hover:bg-destructive/20",onClick:()=>At(Y),children:a.jsx(ra,{className:"h-3 w-3 text-destructive"})})]},Y.name))})]}),a.jsxs(U,{type:"button",onClick:Nn,disabled:v||nn||!G||Le.length===0,className:"w-full mt-2",children:[nn?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(na,{className:"mr-2 h-4 w-4"}),`Visualize Design on ${Le.length} Product(s)`]}),pt.length>0&&a.jsxs("div",{className:"mt-4 space-y-3",children:[a.jsx("h4",{className:"font-semibold text-md",children:"Visualized Products:"}),pt.map(Y=>a.jsxs(We,{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"flex gap-4 items-start",children:[a.jsx("img",{src:Y.finalImageUrl,alt:Y.title,className:"w-24 h-24 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("p",{className:"font-semibold",children:Y.title}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Base: ",Y.baseProductName]}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Price: $",Y.price]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-3",children:Y.description})]})]}),a.jsxs(U,{type:"button",onClick:()=>on(Y),className:"w-full bg-green-600 hover:bg-green-700",disabled:v,children:[a.jsx(go,{className:"mr-2 h-4 w-4"}),"Add This Product to Store"]})]},Y.tempId))]}),n.products.items.filter(Y=>Y.isPrintOnDemand).length>0&&a.jsxs("div",{className:"mt-6 space-y-3",children:[a.jsx("p",{className:"text-md font-semibold",children:"Added Print on Demand Products:"}),a.jsxs("div",{className:"max-h-96 overflow-y-auto pr-2 space-y-3",children:[" ",n.products.items.map((Y,Z)=>Y.isPrintOnDemand?a.jsxs(We,{className:"p-3 flex gap-3 items-start relative",children:[a.jsx("img",{src:Y.imageUrl,alt:Y.name,className:"w-20 h-20 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-sm",children:Y.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",Y.price]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:Y.description})]}),a.jsx(U,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-6 w-6",onClick:()=>_r(Z),children:a.jsx(sr,{className:"h-4 w-4 text-destructive"})})]},`pod-item-${Z}`):null)]})]})]})]},"step4");case 5:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(je,{className:"text-lg font-semibold",children:"How do you want to add collections?"}),a.jsxs(pu,{onValueChange:Y=>r(Z=>({...Z,collections:{...Z.collections,source:Y}})),value:n.collections.source,children:[a.jsx(Hl,{children:a.jsx(gu,{placeholder:"Choose collection source..."})}),a.jsxs(ql,{children:[a.jsx(Jn,{value:"ai",children:"Generate with AI"}),a.jsx(Jn,{value:"manual",children:"Add Manually"})]})]}),T&&n.collections.source==="ai"&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:T}),q&&n.collections.source==="manual"&&W===null&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:q}),n.collections.source==="ai"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"collectionCount",children:"Number of AI Collections to Generate"}),a.jsx(st,{id:"collectionCount",type:"number",min:"1",max:"5",value:n.collections.count,onChange:Y=>r(Z=>({...Z,collections:{...Z.collections,count:parseInt(Y.target.value)||1}}))})]}),a.jsxs(U,{type:"button",onClick:g,disabled:v||!n.productType||!n.storeName||n.products.items.length===0,className:"w-full",children:[v?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(is,{className:"mr-2 h-4 w-4"}),"Generate Collections with AI"]}),n.collections.items.length>0&&a.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2 mt-4",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Generated Collections:"}),n.collections.items.map((Y,Z)=>a.jsxs(We,{className:"p-4 flex gap-4 items-start",children:[Y.imageUrl?a.jsx("img",{src:Y.imageUrl,alt:Y.name,className:"w-24 h-24 object-cover rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-md",children:Y.name||"Untitled Collection"}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:Y.description||"No description."})]}),a.jsx("div",{className:"flex flex-col gap-1",children:a.jsx(U,{variant:"outline",size:"sm",className:"text-xs h-auto py-1 mt-2",onClick:()=>ke(Y),children:"Manage Products"})})]},Z))]}),an&&a.jsx(u1e,{isOpen:Gn,onClose:()=>{Jt(!1),Mn(null)},collection:an,allProducts:n.products.items,onSave:Ve})]}),n.collections.source==="manual"&&a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Your Collections:"}),n.collections.items.map((Y,Z)=>a.jsxs(We,{className:"p-4 space-y-3 relative",children:[a.jsx(U,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7",onClick:()=>ce(Z),disabled:n.collections.items.length<=1&&!Y.name&&!Y.description&&!Y.imageUrl,children:a.jsx(sr,{className:"h-4 w-4 text-destructive"})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.jsxs("div",{children:[a.jsx(je,{htmlFor:`collectionName-${Z}`,children:"Collection Name"}),a.jsx(st,{id:`collectionName-${Z}`,value:Y.name,onChange:oe=>K(Z,"name",oe.target.value),placeholder:"e.g., 'Summer Collection'"})]})}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:`collectionDescription-${Z}`,children:"Short Description (Optional)"}),a.jsx(Vn,{id:`collectionDescription-${Z}`,value:Y.description,onChange:oe=>K(Z,"description",oe.target.value),placeholder:"e.g., 'A curated selection of products perfect for the summer season.'",rows:2})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 border rounded-md",children:[Y.imageUrl?a.jsx("img",{src:Y.imageUrl,alt:Y.name||"Collection image",className:"w-24 h-24 object-contain rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsx(je,{htmlFor:`collectionImageUpload-${Z}`,className:"text-sm sr-only",children:"Upload Collection Image"}),a.jsx(st,{id:`collectionImageUpload-${Z}`,type:"file",accept:"image/*",className:"hidden",onChange:async oe=>{if(oe.target.files&&oe.target.files[0]){const be=oe.target.files[0];try{const Ce=await bd(be);K(Z,"imageUrl",Ce)}catch(Ce){console.error("Error converting file to base64:",Ce)}}}}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs(U,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`collectionImageUpload-${Z}`).click(),children:[a.jsx(Jo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsxs(U,{type:"button",variant:"outline",size:"sm",onClick:()=>z(Z),disabled:W===Z||!Y.name,children:[W===Z?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(is,{className:"mr-2 h-4 w-4"}),"Generate"]}),Y.imageUrl&&a.jsxs(U,{variant:"destructive",size:"sm",onClick:()=>K(Z,"imageUrl",""),children:[a.jsx(sr,{className:"mr-1 h-3 w-3"})," Remove Img"]})]})]}),q&&W===Z&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:q})]},Z)),a.jsxs(U,{type:"button",variant:"outline",onClick:te,className:"w-full",children:[a.jsx(go,{className:"mr-2 h-4 w-4"})," Add Another Collection"]})]})]},"step5");case 6:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-4 w-full",children:[a.jsx(je,{htmlFor:"prompt",className:"text-lg font-semibold",children:"Describe your store's overall style and feel"}),a.jsx(Vn,{id:"prompt",name:"prompt",value:n.prompt,onChange:s,placeholder:"e.g., 'A minimalist and modern design with a focus on high-quality product imagery. Use a cool color palette.' OR 'A vibrant and playful store with bold colors and fun animations.'",className:"min-h-[100px]"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This will influence the theme, layout, and imagery. Your store name, logo, and products are already included. You can also pick from the examples below."}),a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsx(je,{className:"text-md font-semibold",children:"AI Prompt Examples:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"elegance",displayName:"Elegance",storeName:"Elegant Finds",promptText:"A sophisticated and elegant store experience, focusing on timeless design and high-quality craftsmanship. The aesthetic is refined, with a clean layout and luxurious feel, using a palette of soft neutrals, gold accents, and rich textures."},{key:"futuretech",displayName:"FutureTech",storeName:"Nexus Innovations",promptText:"A cutting-edge, futuristic store specializing in the latest technology and gadgets. The design is sleek, minimalist, and dark-themed with neon blue or cyan accents, interactive elements, and a high-tech vibe."},{key:"greenharvest",displayName:"GreenHarvest",storeName:"Evergreen Market",promptText:"An eco-friendly and organic store focusing on sustainable and natural products. The design should feel earthy, warm, and inviting, using natural materials, green and brown tones, and imagery of nature."},{key:"urbanthreads",displayName:"UrbanThreads",storeName:"Metro Threads Co.",promptText:"A trendy, urban streetwear store with a gritty yet stylish aesthetic. Think industrial-chic, graffiti art influences, bold typography, and a dynamic, energetic feel. Muted colors with pops of vibrant color."}].map(Y=>a.jsx(U,{variant:"outline",size:"sm",onClick:()=>{e.setFormData(Z=>({...Z,storeName:Y.storeName,prompt:Y.promptText}))},className:"bg-primary-foreground dark:bg-neutral-800 hover:bg-primary/10 dark:hover:bg-neutral-700",children:Y.displayName},Y.key))})]})]},"step6");default:return null}},CL=(t,e,n)=>!!(t===1&&(e.initialImportMethod==="productType"&&!e.productType||e.initialImportMethod==="photos"&&(!n||n.length===0))||t===2&&!e.storeName||t===4&&(e.products.source==="manual"&&e.products.items.some(r=>!r.name||!r.price)||e.products.source==="ai"&&e.products.items.length===0&&e.products.count>0)||t===5&&(e.collections.source==="ai"&&e.collections.items.length===0&&e.collections.count>0||e.collections.source==="manual"&&e.collections.items.some(r=>!r.name))||t===6&&!e.prompt),ZW=({isEmbedded:t=!1,onGenerationComplete:e,initialDataFromImport:n=null})=>{const r=di(),[s,i]=p.useState(1),[o,l]=p.useState([]),[c,u]=p.useState({initialImportMethod:"productType",productType:"",storeName:"",logoUrlLight:"",logoUrlDark:"",products:{source:"ai",count:3,items:[]},collections:{source:"ai",count:3,items:[]},prompt:""}),[d,h]=p.useState([]),[f,m]=p.useState(!1),[g,x]=p.useState(!1),[E,v]=p.useState(null),[b,S]=p.useState(null),[I,D]=p.useState(null),[k,C]=p.useState(null),[T,P]=p.useState(null),[A,R]=p.useState(null),[M,j]=p.useState(null),[z,W]=p.useState(!1),[q,H]=p.useState(null),{generateStoreFromWizard:$,isGenerating:J,checkStoreNameAvailability:O,importedStoreDataForGenerator:V,isImportDataReadyForGenerator:G,clearImportedStoreDataForGenerator:F}=Fn();p.useEffect(()=>{t&&G&&V?(console.log("StoreWizard (Embedded) consuming imported data:",V),u(ee=>({...ee,storeName:V.name||ee.storeName,prompt:V.prompt||ee.prompt,logoUrlLight:V.logoUrl||ee.logoUrlLight,logoUrlDark:V.logoUrl||ee.logoUrlDark,products:V.products&&V.products.length>0?{source:"manual",count:V.products.length,items:V.products.map(ne=>({name:ne.name||"",price:ne.price||"",description:ne.description||"",images:ne.images||[],variants:ne.variants||[]}))}:ee.products,collections:V.collections&&V.collections.length>0?{source:"manual",count:V.collections.length,items:V.collections.map(ne=>({name:ne.name||"",description:ne.description||"",imageUrl:ne.imageUrl||"",product_ids:ne.product_ids||[]}))}:ee.collections})),V.name&&ue(V.name),F()):n&&(u(ee=>({...ee,storeName:n.name||ee.storeName,prompt:n.prompt||ee.prompt,logoUrlLight:n.logoUrl||ee.logoUrlLight,logoUrlDark:n.logoUrl||ee.logoUrlDark,products:n.products&&n.products.length>0?{source:"manual",count:n.products.length,items:n.products.map(ne=>({name:ne.name||"",price:ne.price||"",description:ne.description||"",images:ne.images||[],variants:ne.variants||[]}))}:ee.products,collections:n.collections&&n.collections.length>0?{source:"manual",count:n.collections.length,items:n.collections.map(ne=>({name:ne.name||"",description:ne.description||"",imageUrl:ne.imageUrl||"",product_ids:ne.product_ids||[]}))}:ee.collections})),n.name&&ue(n.name))},[t,G,V,F,n]);const ue=async ee=>{if(!(ee||c.storeName)){H({status:"error",message:"Please enter a store name to check."});return}W(!0),H(null),v(null);try{const X=await yT(c.storeName);H(X?{status:"claimed",message:"Not available"}:{status:"available",message:"Available"})}catch(X){console.error("Store name availability check failed:",X),H({status:"error",message:X.message||"Could not check store name. Please try again."})}finally{W(!1)}};p.useEffect(()=>{if(c.storeName&&E){const ee=E.toLowerCase();ee.includes("store name")&&(ee.includes("empty")||ee.includes("required"))&&v(null)}if(c.storeName&&s===2){const ee=setTimeout(async()=>{W(!0),H(null),v(null);try{const ne=await yT(c.storeName);H(ne?{status:"claimed",message:"This store name is already taken."}:{status:"available",message:"Store name is available!"})}catch(ne){console.error("Store name availability check failed:",ne),H({status:"error",message:ne.message||"Could not check store name. Please try again."})}finally{W(!1)}},750);return()=>{clearTimeout(ee)}}else!c.storeName&&s===2&&H(null)},[c.storeName,s,E]);const Ee=ee=>{u(ne=>({...ne,initialImportMethod:ee,productType:ee==="photos"?"":ne.productType})),ee==="productType"&&h([])},Se=ee=>new Promise((ne,X)=>{const me=new FileReader;me.onload=()=>ne(me.result),me.onerror=X,me.readAsDataURL(ee)}),we=async ee=>{const ne=Array.from(ee.target.files);if(ne.length===0)return;const X=10;if(d.length+ne.length>X){v(`You can upload a maximum of ${X} photos.`);return}v(null);const me=ne.map(async De=>{try{const Oe=await Se(De);return{file:De,previewUrl:URL.createObjectURL(De),base64:Oe,name:De.name,type:De.type}}catch(Oe){return console.error("Error processing file:",De.name,Oe),null}}),ye=(await Promise.all(me)).filter(Boolean);if(h(De=>{const Oe=[...De,...ye];return De.forEach(re=>{re.previewUrl&&re.previewUrl.startsWith("blob:")}),Oe}),c.initialImportMethod==="photos"&&ye.length>0){m(!0),v(null);try{const De=d.concat(ye).map(re=>({base64:re.base64,mimeType:re.type,name:re.name})),Oe=await e1e(De);Oe.error?v(Oe.error):(u(re=>({...re,productType:Oe.productType||re.productType,storeName:Oe.storeNameSuggestions&&Oe.storeNameSuggestions.length>0?Oe.storeNameSuggestions[0]:re.storeName,products:{source:"manual",count:Oe.products.length,items:Oe.products.map(pe=>({name:pe.name||"",price:pe.price||"",description:pe.description||"",images:pe.images||[],variants:[],isFromPhotoAI:!0}))},collections:{source:"manual",count:Oe.collections.length,items:Oe.collections.map(pe=>({name:pe.name||"",description:pe.description||"",imageUrl:"",product_ids:[],isFromPhotoAI:!0}))},prompt:Oe.storePrompt||re.prompt})),Oe.storeNameSuggestions&&Oe.storeNameSuggestions.length>0&&l(Oe.storeNameSuggestions),Oe.logoDescription&&console.log("AI Logo Description:",Oe.logoDescription))}catch(De){console.error("Error processing photos with AI:",De),v(`Failed to process images with AI: ${De.message}`)}finally{m(!1)}}},Fe=ee=>{h(ne=>{const X=ne[ee];return X&&X.previewUrl&&X.previewUrl.startsWith("blob:")&&URL.revokeObjectURL(X.previewUrl),ne.filter((me,ye)=>ye!==ee)})},Ze=ee=>{const{name:ne,value:X}=ee.target;u(me=>({...me,[ne]:X}))},ze=ee=>{u(ne=>({...ne,productType:ee}))},nt=ee=>{u(ne=>({...ne,products:{...ne.products,source:ee}}))},qe=ee=>{u(ne=>({...ne,products:{...ne.products,count:parseInt(ee.target.value)||1}}))},yt=(ee,ne,X)=>{const me=[...c.products.items];me[ee][ne]=X,u(ye=>({...ye,products:{...ye.products,items:me}}))},Le=()=>{u(ee=>({...ee,products:{...ee.products,items:[...ee.products.items,{name:"",price:"",description:"",images:[]}]}}))},Ae=ee=>{const ne=c.products.items.filter((X,me)=>me!==ee);u(X=>({...X,products:{...X.products,items:ne}}))},pt=async()=>{var ee;if(!c.productType){v("Please select a product type first.");return}x(!0),l([]),v(null);try{const ne=((ee=Tw.find(me=>me.value===c.productType))==null?void 0:ee.label)||c.productType,X=await U3(ne);X.error?(console.error("Failed to suggest store names:",X.error),v(X.error),l([])):X.suggestions&&X.suggestions.length>0?l(X.suggestions):(v("No suggestions received, or response was empty."),l([]))}catch(ne){console.error("Error in suggestStoreNameHandler:",ne),v(`An unexpected error occurred: ${ne.message}`),l([])}x(!1)},mt=ee=>{u(ne=>({...ne,storeName:ee})),l([])},Ht=async()=>{if(!c.storeName){console.warn("Store name is required to generate a logo."),v("Please ensure a store name is set before generating a logo.");return}x(!0),v(null);try{const ee=await ig(c.storeName);ee&&(ee.logoUrlLight||ee.logoUrlDark)?(u(ne=>({...ne,logoUrlLight:ee.logoUrlLight||"",logoUrlDark:ee.logoUrlDark||""})),console.log("Logos generated and URLs set:",ee),ee.textResponse&&console.log("Gemini text response for logo generation:",ee.textResponse)):(console.error("Failed to generate logos: No image data received for either version."),v("Failed to generate logo. The AI did not return sufficient image data."))}catch(ee){console.error("Failed to generate logos:",ee),v(`Logo generation failed: ${ee.message}`)}x(!1)},Ft=async()=>{if(!c.productType||!c.storeName){v("Please provide a product type and store name before generating AI products.");return}x(!0),v(null);let ee=[];try{const ne=await s1e(c.prompt,c.productType);if(console.log("Prompt Analysis Result:",ne),ne.error||ne.strategy==="error"){v(ne.error||"Failed to analyze store prompt for product strategy."),x(!1);return}let X=null,me="image/png";const ye=c.logoUrlLight||c.logoUrlDark;if(ye&&ye.startsWith("data:")){const De=ye.split(",");if(De.length===2){X=De[1];const Oe=De[0].match(/:(.*?);/);Oe&&Oe[1]&&(me=Oe[1])}}if(ne.strategy==="standard"){console.log("Strategy: Standard Product Generation");for(let De=0;De<c.products.count;De++){console.log(`Generating AI product ${De+1} of ${c.products.count}...`);const Oe=await tG(c.productType,c.storeName,X,me,ee.map(re=>re.name),void 0,void 0,void 0,c.prompt);Oe&&Oe.images&&Oe.images.length>0?ee.push({name:Oe.title,description:Oe.description,price:Oe.price,images:Oe.images,variants:Oe.variants||[]}):console.warn(`Failed to generate full data for standard product ${De+1}. Skipping.`)}}else if(ne.strategy==="pod_theme_visualization"||ne.strategy==="pod_specific_products"){console.log(`Strategy: Print on Demand - ${ne.strategy}`);const De=ne.theme&&ne.theme!=="General"?`Design for print-on-demand products for a store themed '${ne.theme}'. Store name: ${c.storeName}. User prompt: ${c.prompt}`:`Versatile design for print-on-demand products based on store prompt: "${c.prompt}". Store name: ${c.storeName}.`,Oe=6;let re=[];for(let ve=0;ve<Oe;ve++){const gt=`${De} (Design variation ${ve+1} of ${Oe}, ensure it's distinct from previous designs for this store if any were made).`;console.log(`Generating POD design ${ve+1}/${Oe}...`);const wt=await b0({prompt:gt});wt&&wt.imageData?re.push({base64:wt.imageData,mimeType:wt.imageMimeType||"image/png",prompt:gt}):console.warn(`Failed to generate POD design ${ve+1}.`)}if(re.length===0){v("Failed to generate any base designs for POD products."),x(!1);return}let pe=[...Oo],Me=[];for(let ve=0;ve<Math.min(re.length,pe.length);ve++){const gt=Math.floor(Math.random()*pe.length);Me.push(pe.splice(gt,1)[0])}if(Me.length===0){v("No POD mockup products available for visualization."),x(!1);return}for(let ve=0;ve<Math.min(re.length,Me.length);ve++){const gt=re[ve],wt=Me[ve];console.log(`Visualizing design ${ve+1} on ${wt.name}...`);const dt=await og(gt.base64,gt.mimeType,wt.imageUrl,ne.theme||c.prompt,wt.name);if(dt&&dt.visualizedImageData&&dt.productDetails){const xt=`data:${gt.mimeType};base64,${gt.base64}`,At=`data:${dt.visualizedImageMimeType};base64,${dt.visualizedImageData}`;ee.push({name:dt.productDetails.title,price:parseFloat(dt.productDetails.price).toFixed(2),description:dt.productDetails.description,images:[xt,At],isPrintOnDemand:!0,podDetails:{originalDesignImageUrl:xt,designPrompt:gt.prompt,baseProductName:wt.name,baseProductImageUrl:wt.imageUrl},variants:dt.productDetails.variants||[]})}else console.warn(`Failed to visualize design ${ve+1} on ${wt.name}. Skipping.`)}}u(De=>({...De,products:{...De.products,items:ee}})),ee.length===0&&c.products.count>0&&v("AI failed to generate any products with the selected strategy. Please try again or adjust settings.")}catch(ne){console.error("Error generating AI products:",ne),v(`Failed to generate AI products: ${ne.message}`)}x(!1)},nn=async()=>{if(!c.productType||!c.storeName||c.products.items.length===0){v("Please ensure product type, store name, and at least one product are set before generating AI collections.");return}x(!0),v(null);const ee=[],ne=c.collections.items.map(X=>X.name);try{for(let X=0;X<c.collections.count;X++){console.log(`Generating AI collection ${X+1} of ${c.collections.count}...`);const me=await nG(c.productType,c.storeName,c.products.items,ne);if(me&&!me.error&&me.name&&me.description&&me.product_ids){let ye=`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(me.name||"Collection")}`;me.imageData&&(ye=`data:image/png;base64,${me.imageData}`),ee.push({name:me.name,description:me.description,imageUrl:ye,product_ids:me.product_ids}),me.name&&ne.push(me.name)}else console.warn(`Failed to generate full data for collection ${X+1}. Skipping.`)}u(X=>({...X,collections:{...X.collections,items:ee}})),ee.length===0&&c.collections.count>0&&v("AI failed to generate any collections. Please try again or adjust settings.")}catch(X){console.error("Error generating AI collections:",X),v(`Failed to generate AI collections: ${X.message}`)}x(!1)},Tn=async ee=>{const ne=c.products.items[ee];if(!ne||!ne.name){D("Product name is required to generate an image.");return}S(ee),D(null);try{const X=await wU(ne.name,ne.description);if(X&&X.imageData){const me=`data:image/png;base64,${X.imageData}`,ye=[...c.products.items];ye[ee].images=[me],u(De=>({...De,products:{...De.products,items:ye}}))}else throw new Error(X.textResponse||"Failed to generate product image data.")}catch(X){console.error(`Error generating image for product ${ee}:`,X),D(X.message)}finally{S(null)}},gn=async ee=>{const ne=c.products.items[ee];if(!ne||!ne.images||ne.images.length===0){P("At least one image must be uploaded or generated first to create more angles.");return}const X=ne.images[0];C(ee),P(null);try{const{generateDifferentAnglesFromImage:me}=await jt(()=>Promise.resolve().then(()=>rae),void 0),ye=X.split(",");if(ye.length!==2)throw new Error("Invalid base image URL format for angle generation.");const De=ye[0],Oe=ye[1],re=De.match(/:(.*?);/);if(!re||!re[1])throw new Error("Could not determine mime type from base image URL.");const pe=re[1],Me=await me(Oe,pe,ne.name||"Product"),ve=[...c.products.items],gt=ve[ee].images||[];ve[ee].images=[...gt,...Me.filter(wt=>!gt.includes(wt))],u(wt=>({...wt,products:{...wt.products,items:ve}}))}catch(me){console.error(`Error generating more angles for product ${ee}:`,me),P(me.message||"Failed to generate additional angles.")}finally{C(null)}},Qe=async ee=>{const ne=c.collections.items[ee];if(!ne||!ne.name){j("Collection name is required to generate an image.");return}R(ee),j(null),v(null);try{const X=await bU(ne.name,ne.description);if(X&&X.imageData&&X.imageMimeType){const me=`data:${X.imageMimeType};base64,${X.imageData}`,ye=[...c.collections.items];ye[ee].imageUrl=me,u(De=>({...De,collections:{...De.collections,items:ye}}))}else throw new Error(X.textResponse||"Failed to generate collection image data.")}catch(X){console.error(`Error generating image for collection ${ee} ("${ne.name}"):`,X),j(X.message||"Unknown error during collection image generation.");const me=[...c.collections.items];me[ee].imageUrl="",u(ye=>({...ye,collections:{...ye.collections,items:me}}))}finally{R(null)}},Be=()=>i(ee=>ee+1),ct=()=>i(ee=>ee-1),he=async()=>{x(!0),v(null);try{const ee={name:c.storeName,niche:c.productType,description:c.prompt},ne=await B3(ee);ne.error&&console.warn("Failed to generate hero content:",ne.error);const X=await z3(ee);X.error&&console.warn("Failed to generate store way content:",X.error);const me=await G3(ee);me.error&&console.warn("Failed to generate store features content:",me.error);const ye={...c,content:{...c.content||{},hero:ne&&!ne.error?ne:void 0,storeWay:X&&!X.error?X:void 0,storeFeatures:me&&!me.error?me:void 0}},De=await $(ye);if(De){if(t&&e)e(De);else if(!t){const Oe=`/${De.urlSlug||Wl(De.name)}`;r(Oe)}}}catch(ee){console.error("Error during final store generation steps or navigation:",ee),v(`An error occurred during final store setup: ${ee.message}`)}finally{x(!1)}},Ie={formData:c,setFormData:u,handleInputChange:Ze,handleProductTypeChange:ze,handleProductSourceChange:nt,handleProductCountChange:qe,handleManualProductChange:yt,addManualProduct:Le,removeManualProduct:Ae,suggestStoreName:pt,generateLogo:Ht,generateAiProducts:Ft,generateAiCollections:nn,handleGenerateManualProductImage:Tn,handleGenerateMoreAngles:gn,isProcessing:g,isGeneratingProductImageForIndex:b,productImageGenerationError:I,isGeneratingAnglesForIndex:k,angleGenerationError:T,productTypeOptions:Tw,storeNameSuggestions:o,handleSuggestionClick:mt,suggestionError:E,handleInitialImportMethodChange:Ee,handleProductPhotoUpload:we,uploadedProductPhotos:d,removeUploadedProductPhoto:Fe,isProcessingPhotos:f,handleGenerateCollectionImage:Qe,isGeneratingCollectionImageForIndex:A,collectionImageGenerationError:M,isCheckingStoreName:z,storeNameAvailability:q,handleManualStoreNameCheck:ue};return t?a.jsxs("div",{className:"w-full p-2",children:[" ",a.jsx(Eu,{mode:"wait",children:EL(s,Ie)}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsxs(U,{variant:"outline",onClick:ct,disabled:s===1||J||f,children:[a.jsx(Ra,{className:"mr-2 h-4 w-4"})," Previous"]}),s<6?a.jsxs(U,{onClick:Be,disabled:CL(s,c,d)||J||f,children:["Next ",a.jsx(lu,{className:"ml-2 h-4 w-4"})]}):a.jsxs(U,{onClick:he,disabled:g||J||f||!c.prompt,className:"bg-primary hover:bg-primary/90",children:[g||J?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(na,{className:"mr-2 h-4 w-4"}),"Generate Store"]})]})]}):a.jsxs("div",{className:"w-full max-w-2xl mx-auto",children:[" ",a.jsxs(ot,{children:[a.jsx(at,{className:"text-2xl font-bold",children:"Store Creation Wizard"}),a.jsxs(qt,{children:["Step ",s," of 6: Let's build your online store together!"]}),a.jsx("div",{className:"w-full bg-green-200 dark:bg-green-800 rounded-full h-2.5 mt-2",children:a.jsx(It.div,{className:"bg-green-600 dark:bg-green-500 h-2.5 rounded-full",initial:{width:"0%"},animate:{width:`${s/6*100}%`},transition:{duration:.5,ease:"easeInOut"}})})]}),a.jsx(tt,{className:"min-h-[250px] flex items-center",children:a.jsx(Eu,{mode:"wait",children:EL(s,Ie)})}),a.jsxs(Yu,{className:"flex justify-between",children:[a.jsxs(U,{variant:"outline",onClick:ct,disabled:s===1||J||f,children:[a.jsx(Ra,{className:"mr-2 h-4 w-4"})," Previous"]}),s<6?a.jsxs(U,{onClick:Be,disabled:CL(s,c,d)||J||f,children:["Next ",a.jsx(lu,{className:"ml-2 h-4 w-4"})]}):a.jsxs(U,{onClick:he,disabled:g||J||f||!c.prompt,children:[g||J?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(na,{className:"mr-2 h-4 w-4"}),"Generate Store"]})]})]})},f1e=({isOpen:t,onClose:e,product:n,onSave:r})=>{const[s,i]=p.useState(null);if(p.useEffect(()=>{var d,h,f,m,g,x,E;if(n){const v=(h=(d=n.variants)==null?void 0:d.edges[0])==null?void 0:h.node;i({...n,name:n.title||"",price:((f=v==null?void 0:v.price)==null?void 0:f.amount)||0,currencyCode:((m=v==null?void 0:v.price)==null?void 0:m.currencyCode)||"USD",imageUrl:((E=(x=(g=n.images)==null?void 0:g.edges[0])==null?void 0:x.node)==null?void 0:E.url)||""})}else i(null)},[n]),!t||!s)return null;const o=d=>{const{name:h,value:f}=d.target;i(m=>({...m,[h]:f}))},l=d=>{const{value:h}=d.target;i(f=>({...f,price:parseFloat(h)||0}))},c=d=>{const{value:h}=d.target;i(f=>({...f,imageUrl:h}))},u=()=>{var h,f,m,g;const d={...s,title:s.name,images:{edges:[{node:{url:s.imageUrl,altText:s.name}}]},variants:{...s.variants,edges:[{node:{...((f=(h=s.variants)==null?void 0:h.edges[0])==null?void 0:f.node)||{},price:{amount:s.price,currencyCode:s.currencyCode}}},...((g=(m=s.variants)==null?void 0:m.edges)==null?void 0:g.slice(1))||[]]}};r(d),e()};return a.jsx(Ps,{open:t,onOpenChange:e,children:a.jsxs(ls,{className:"sm:max-w-lg",children:[a.jsxs(cs,{children:[a.jsxs(us,{children:["Edit Product: ",n.title]}),a.jsx(No,{children:"Make changes to the product details below."})]}),a.jsx(Zi,{className:"max-h-[60vh] p-1",children:a.jsxs("div",{className:"grid gap-4 py-4 pr-3",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"name",className:"text-right",children:"Name"}),a.jsx(st,{id:"name",name:"name",value:s.name,onChange:o,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"description",className:"text-right",children:"Description"}),a.jsx(Vn,{id:"description",name:"description",value:s.description,onChange:o,className:"col-span-3",rows:4})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"price",className:"text-right",children:"Price"}),a.jsx(st,{id:"price",name:"price",type:"number",value:s.price,onChange:l,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"imageUrl",className:"text-right",children:"Image URL"}),a.jsx(st,{id:"imageUrl",name:"imageUrl",value:s.imageUrl,onChange:c,className:"col-span-3"})]})]})}),a.jsxs(jr,{children:[a.jsx(U,{type:"button",variant:"outline",onClick:e,children:"Cancel"}),a.jsx(U,{type:"button",onClick:u,children:"Save Changes"})]})]})})},m1e=({isOpen:t,onClose:e,collection:n,onSave:r})=>{const[s,i]=p.useState(null);if(p.useEffect(()=>{i(n?{...n,name:n.title||""}:null)},[n]),!t||!s)return null;const o=c=>{const{name:u,value:d}=c.target;i(h=>({...h,[u]:d}))},l=()=>{const c={...s,title:s.name};r(c),e()};return a.jsx(Ps,{open:t,onOpenChange:e,children:a.jsxs(ls,{className:"sm:max-w-lg",children:[a.jsxs(cs,{children:[a.jsxs(us,{children:["Edit Collection: ",n.title]}),a.jsx(No,{children:"Make changes to the collection details below."})]}),a.jsx(Zi,{className:"max-h-[60vh] p-1",children:a.jsxs("div",{className:"grid gap-4 py-4 pr-3",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"name",className:"text-right",children:"Name"}),a.jsx(st,{id:"name",name:"name",value:s.name,onChange:o,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"description",className:"text-right",children:"Description"}),a.jsx(Vn,{id:"description",name:"description",value:s.description||"",onChange:o,className:"col-span-3",rows:4})]})]})}),a.jsxs(jr,{children:[a.jsx(U,{type:"button",variant:"outline",onClick:e,children:"Cancel"}),a.jsx(U,{type:"button",onClick:l,children:"Save Changes"})]})]})})},p1e=()=>{var x,E,v,b,S,I,D,k,C,T,P,A,R,M,j;const{shopifyPreviewMetadata:t,isFetchingShopifyPreviewData:e,shopifyImportError:n,updateShopifyPreviewMetadata:r}=Fn(),[s,i]=p.useState(((v=(E=(x=t==null?void 0:t.brand)==null?void 0:x.colors)==null?void 0:E.primary)==null?void 0:v.background)||"#000000"),[o,l]=p.useState(((I=(S=(b=t==null?void 0:t.brand)==null?void 0:b.colors)==null?void 0:S.secondary)==null?void 0:I.background)||"#ffffff");ht.useEffect(()=>{var z,W,q;(z=t==null?void 0:t.brand)!=null&&z.colors&&(i(((W=t.brand.colors.primary)==null?void 0:W.background)||"#000000"),l(((q=t.brand.colors.secondary)==null?void 0:q.background)||"#ffffff"))},[t]);const c=z=>{var q,H,$;const W=z.target.value;i(W),r&&r({...t,brand:{...t.brand,colors:{...(q=t.brand)==null?void 0:q.colors,primary:{...($=(H=t.brand)==null?void 0:H.colors)==null?void 0:$.primary,background:W}}}})},u=z=>{var q,H,$;const W=z.target.value;l(W),r&&r({...t,brand:{...t.brand,colors:{...(q=t.brand)==null?void 0:q.colors,secondary:{...($=(H=t.brand)==null?void 0:H.colors)==null?void 0:$.secondary,background:W}}}})};if(e&&!t)return a.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[a.jsx(St,{className:"h-12 w-12 animate-spin text-primary mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Fetching store information..."})]});if(n&&!t)return a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-destructive",children:[a.jsx(ng,{className:"h-12 w-12 mb-4"}),a.jsx("p",{className:"font-semibold",children:"Error Fetching Store Info"}),a.jsx("p",{className:"text-sm text-center",children:n})]});if(!t)return a.jsx("div",{className:"text-center text-muted-foreground",children:"No store metadata to display."});const{name:d,description:h,primaryDomain:f,brand:m}=t,g=((k=(D=m==null?void 0:m.logo)==null?void 0:D.image)==null?void 0:k.url)||((T=(C=m==null?void 0:m.squareLogo)==null?void 0:C.image)==null?void 0:T.url);return a.jsxs("div",{className:"w-full p-4",children:[a.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Store Preview"}),a.jsxs(We,{className:"mb-4",children:[a.jsx(ot,{children:a.jsxs("div",{className:"flex items-center space-x-4",children:[g?a.jsx("img",{src:g,alt:`${d} logo`,className:"h-16 w-16 object-contain rounded border"}):a.jsx("div",{className:"h-16 w-16 bg-muted rounded border flex items-center justify-center text-muted-foreground",children:a.jsx(tC,{size:32})}),a.jsxs("div",{children:[a.jsx(at,{children:d||"N/A"}),(f==null?void 0:f.host)&&a.jsx(qt,{children:f.host})]})]})}),a.jsxs(tt,{children:[a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[a.jsx("strong",{children:"Slogan:"})," ",(m==null?void 0:m.slogan)||"N/A"]}),a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[a.jsx("strong",{children:"Description:"})," ",h||(m==null?void 0:m.shortDescription)||"N/A"]}),((P=m==null?void 0:m.coverImage)==null?void 0:P.url)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-sm font-medium mb-1",children:"Cover Image:"}),a.jsx("img",{src:m.coverImage.url,alt:"Store cover",className:"rounded max-h-40 w-auto mx-auto border"})]})]})]}),(m==null?void 0:m.colors)&&a.jsxs(We,{className:"mt-4",children:[a.jsx(ot,{children:a.jsx(at,{className:"text-lg",children:"Brand Colors"})}),a.jsxs(tt,{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"primaryColorPicker",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Primary Color"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"color",id:"primaryColorPicker",value:s,onChange:c,className:"h-10 w-10 rounded border cursor-pointer"}),a.jsx("div",{className:"w-12 h-10 rounded border",style:{backgroundColor:s},title:`Primary Background: ${s}`}),a.jsx("span",{className:"text-sm",children:s})]}),((R=(A=m==null?void 0:m.colors)==null?void 0:A.primary)==null?void 0:R.foreground)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-xs text-muted-foreground",children:"Text/Icon Color (from Shopify):"}),a.jsx("div",{className:"w-full h-6 rounded border mt-1",style:{backgroundColor:m.colors.primary.foreground},title:`Primary Foreground: ${m.colors.primary.foreground}`})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"secondaryColorPicker",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Secondary Color"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"color",id:"secondaryColorPicker",value:o,onChange:u,className:"h-10 w-10 rounded border cursor-pointer"}),a.jsx("div",{className:"w-12 h-10 rounded border",style:{backgroundColor:o},title:`Secondary Background: ${o}`}),a.jsx("span",{className:"text-sm",children:o})]}),((j=(M=m==null?void 0:m.colors)==null?void 0:M.secondary)==null?void 0:j.foreground)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-xs text-muted-foreground",children:"Text/Icon Color (from Shopify):"}),a.jsx("div",{className:"w-full h-6 rounded border mt-1",style:{backgroundColor:m.colors.secondary.foreground},title:`Secondary Foreground: ${m.colors.secondary.foreground}`})]})]})]})]})]})},g1e=()=>{var W,q,H,$,J,O;const{shopifyPreviewProducts:t,shopifyPreviewCollections:e,fetchShopifyWizardProducts:n,fetchShopifyWizardCollections:r,isFetchingShopifyPreviewData:s,shopifyImportError:i,shopifyPreviewMetadata:o,generatedLogoImage:l,isGeneratingLogo:c,logoGenerationError:u,generateShopifyStoreLogo:d,updateShopifyPreviewProduct:h,updateShopifyPreviewCollection:f}=Fn(),[m,g]=p.useState(!1),[x,E]=p.useState(null),[v,b]=p.useState(!1),[S,I]=p.useState(null),D=V=>{E(V),g(!0)},k=()=>{g(!1),E(null)},C=V=>{h(V)},T=V=>{I(V),b(!0)},P=()=>{b(!1),I(null)},A=V=>{f(V)},R=()=>{t.pageInfo.hasNextPage&&n(10,t.pageInfo.endCursor)},M=()=>{e.pageInfo.hasNextPage&&r(10,e.pageInfo.endCursor)},j=(o==null?void 0:o.name)||"Your Store",z=((H=(q=(W=o==null?void 0:o.brand)==null?void 0:W.logo)==null?void 0:q.image)==null?void 0:H.url)||((O=(J=($=o==null?void 0:o.brand)==null?void 0:$.squareLogo)==null?void 0:J.image)==null?void 0:O.url);return a.jsxs("div",{className:"w-full p-4 space-y-6",children:[a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Generate Store Logo"}),a.jsxs(qt,{children:['Optionally, generate a new logo for "',j,'" using AI. The generated logo will be used for your new store if you proceed.']})]}),a.jsxs(tt,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Current Shopify Logo (if any):"}),z?a.jsx("img",{src:z,alt:`${j} current logo`,className:"h-48 w-auto object-contain"}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No logo found in Shopify data."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Generated Logo Preview:"}),c&&a.jsxs("div",{className:"h-48 w-full flex items-center justify-center",children:[a.jsx(St,{className:"h-12 w-12 animate-spin text-primary"})," "]}),!c&&l&&a.jsx("div",{className:"h-48 w-auto flex items-center justify-center",children:a.jsx("img",{src:l,alt:`${j} AI generated logo`,className:"h-full w-auto object-contain"})}),!c&&!l&&a.jsxs("div",{className:"h-48 w-full flex items-center justify-center text-muted-foreground",children:[a.jsx(tC,{className:"h-12 w-12 mr-2"})," ",a.jsx("span",{children:"Logo will appear here"})]})]})]}),a.jsxs(U,{onClick:d,disabled:c||!(o!=null&&o.name),className:"w-full md:w-auto",children:[c?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(is,{className:"mr-2 h-4 w-4"}),"Generate New Logo with AI"]}),u&&a.jsxs("p",{className:"text-sm text-destructive text-center mt-2",children:[a.jsx(ng,{className:"inline h-4 w-4 mr-1"}),u]}),!(o!=null&&o.name)&&a.jsx("p",{className:"text-sm text-amber-600 text-center mt-2",children:"Store name from Shopify is required to generate a logo."})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Products (",t.edges.length," loaded)"]}),i&&i.includes("products")&&a.jsx("p",{className:"text-destructive text-sm mb-2",children:i}),a.jsxs(Zi,{className:"h-60 border rounded p-2",children:[t.edges.length===0&&!s&&a.jsx("p",{className:"text-muted-foreground text-sm p-2",children:"No products loaded yet or none found."}),t.edges.map(({node:V})=>{var G,F,ue,Ee,Se,we,Fe,Ze,ze;return a.jsx("div",{className:"p-3 border-b last:border-b-0",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[((ue=(F=(G=V.images)==null?void 0:G.edges[0])==null?void 0:F.node)==null?void 0:ue.url)&&a.jsx("img",{src:V.images.edges[0].node.url,alt:V.title,className:"h-16 w-16 rounded object-cover border"}),!((we=(Se=(Ee=V.images)==null?void 0:Ee.edges[0])==null?void 0:Se.node)!=null&&we.url)&&a.jsx("div",{className:"h-16 w-16 bg-muted rounded border flex items-center justify-center text-muted-foreground",children:a.jsx(tC,{size:24})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm",children:V.title}),((ze=(Ze=(Fe=V.variants)==null?void 0:Fe.edges[0])==null?void 0:Ze.node)==null?void 0:ze.price)&&a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Price: ",V.variants.edges[0].node.price.amount," ",V.variants.edges[0].node.price.currencyCode]}),V.description&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1 truncate",title:V.description,children:["Desc: ",V.description.substring(0,50),V.description.length>50?"...":""]}),V.tags&&V.tags.length>0&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Tags: ",V.tags.join(", ")]})]}),a.jsx(U,{variant:"ghost",size:"sm",onClick:()=>D(V),className:"ml-auto",children:a.jsx(Av,{className:"h-4 w-4"})})]})},V.id)}),s&&t.pageInfo.hasNextPage&&a.jsx("div",{className:"flex justify-center py-2",children:a.jsx(St,{className:"h-5 w-5 animate-spin"})})]}),t.pageInfo.hasNextPage&&a.jsx(U,{onClick:R,disabled:s,className:"mt-2 w-full",children:s?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):"Load More Products"}),!t.pageInfo.hasNextPage&&t.edges.length>0&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"All products loaded."})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Collections (",e.edges.length," loaded)"]}),i&&i.includes("collections")&&a.jsx("p",{className:"text-destructive text-sm mb-2",children:i}),a.jsxs(Zi,{className:"h-60 border rounded p-2",children:[e.edges.length===0&&!s&&a.jsx("p",{className:"text-muted-foreground text-sm p-2",children:"No collections loaded yet or none found."}),e.edges.map(({node:V})=>a.jsxs("div",{className:"p-2 border-b text-sm flex justify-between items-center",children:[a.jsx("span",{children:V.title}),a.jsx(U,{variant:"ghost",size:"sm",onClick:()=>T(V),children:a.jsx(Av,{className:"h-4 w-4"})})]},V.id)),s&&e.pageInfo.hasNextPage&&a.jsx("div",{className:"flex justify-center py-2",children:a.jsx(St,{className:"h-5 w-5 animate-spin"})})]}),e.pageInfo.hasNextPage&&a.jsx(U,{onClick:M,disabled:s,className:"mt-2 w-full",children:s?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):"Load More Collections"}),!e.pageInfo.hasNextPage&&e.edges.length>0&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"All collections loaded."})]})]}),x&&a.jsx(f1e,{isOpen:m,onClose:k,product:x,onSave:C}),S&&a.jsx(m1e,{isOpen:v,onClose:P,collection:S,onSave:A})]})},y1e=()=>{var r,s;const{bigCommercePreviewSettings:t,isFetchingBigCommercePreviewData:e,bigCommerceImportError:n}=Fn();return e&&!t?a.jsxs("div",{className:"flex items-center justify-center p-8",children:[a.jsx(St,{className:"h-8 w-8 animate-spin"})," ",a.jsx("span",{className:"ml-2",children:"Fetching store settings..."})]}):n&&!t?a.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error: ",n]}):t?a.jsxs(We,{className:"w-full",children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Store Settings Preview (BigCommerce)"}),a.jsx(qt,{children:"Review your BigCommerce store's basic information."})]}),a.jsxs(tt,{className:"space-y-2",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Store Name:"})," ",t.storeName||"N/A"]}),((s=(r=t.logo)==null?void 0:r.image)==null?void 0:s.url)&&a.jsxs("div",{children:[a.jsx("strong",{children:"Logo:"}),a.jsx("img",{src:t.logo.image.url,alt:t.logo.image.altText||"Store Logo",className:"mt-2 max-w-xs max-h-24 object-contain border rounded"})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Store Hash:"})," ",t.storeHash||"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Status:"})," ",t.status||"N/A"]})]})]}):a.jsx("div",{className:"text-center p-4",children:"Connect to BigCommerce to see store settings, or settings are being fetched."})},x1e=()=>{const{bigCommercePreviewProducts:t,fetchBigCommerceWizardProducts:e,isFetchingBigCommercePreviewData:n,bigCommerceImportError:r}=Fn(),s=(t==null?void 0:t.items)||[];return n&&s.length===0?a.jsxs("div",{className:"flex items-center justify-center p-8",children:[a.jsx(St,{className:"h-8 w-8 animate-spin"})," ",a.jsx("span",{className:"ml-2",children:"Fetching products..."})]}):r&&s.length===0?a.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error fetching products: ",r]}):s.length===0?a.jsxs("div",{className:"text-center p-4",children:[a.jsx("p",{className:"mb-4",children:"No products loaded yet for BigCommerce."}),a.jsxs(U,{onClick:()=>e(10),disabled:n,children:[n?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Load Products Preview"]})]}):a.jsxs(We,{className:"w-full",children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Products Preview (BigCommerce)"}),a.jsx(qt,{children:"A sample of products from your BigCommerce store."})]}),a.jsxs(tt,{children:[a.jsx("ul",{className:"space-y-2 max-h-96 overflow-y-auto",children:s.slice(0,10).map(i=>{var o,l,c,u,d;return a.jsxs("li",{className:"p-2 border rounded text-sm flex justify-between items-center",children:[a.jsxs("div",{children:[i.name," - ",(l=(o=i.prices)==null?void 0:o.price)==null?void 0:l.value," ",(u=(c=i.prices)==null?void 0:c.price)==null?void 0:u.currencyCode]}),((d=i.defaultImage)==null?void 0:d.url)&&a.jsx("img",{src:i.defaultImage.url,alt:i.defaultImage.altText||i.name,className:"w-12 h-12 object-cover rounded ml-2"})]},i.entityId)})}),s.length>10&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Showing 10 of ",s.length," products fetched for preview."]})]})]})},v1e=({isOpen:t,onClose:e,initialImportSource:n="shopify"})=>{const r=di(),[s,i]=p.useState(n),{shopifyWizardStep:o,setShopifyWizardStep:l,resetShopifyWizardState:c,shopifyPreviewMetadata:u,shopifyPreviewProducts:d,shopifyPreviewCollections:h,isFetchingShopifyPreviewData:f,shopifyImportError:m,fetchShopifyWizardProducts:g,fetchShopifyWizardCollections:x,finalizeShopifyImportFromWizard:E,shopifyWizardShouldShowGenerator:v,setShopifyWizardShouldShowGenerator:b,bigCommerceWizardStep:S,setBigCommerceWizardStep:I,resetBigCommerceWizardState:D,bigCommercePreviewSettings:k,bigCommercePreviewProducts:C,isFetchingBigCommercePreviewData:T,bigCommerceImportError:P,fetchBigCommerceWizardProducts:A,finalizeBigCommerceImportFromWizard:R,isGenerating:M,generateStoreFromWizard:j}=Fn(),z={shopify:{wizardStep:o,setWizardStep:l,resetWizardState:c,previewMetadata:u,previewProducts:d,previewCollections:h,isFetchingPreviewData:f,importError:m,fetchWizardProducts:g,fetchWizardCollections:x,finalizeImportFromWizard:E,ConnectFormComponent:eCe,MetadataPreviewComponent:p1e,ItemsPreviewComponent:g1e,wizardShouldShowGenerator:v,setWizardShouldShowGenerator:b,totalSteps:5},bigcommerce:{wizardStep:S,setWizardStep:I,resetWizardState:D,previewMetadata:k,previewProducts:C,isFetchingPreviewData:T,importError:P,fetchWizardProducts:A,finalizeImportFromWizard:R,ConnectFormComponent:tCe,MetadataPreviewComponent:y1e,ItemsPreviewComponent:x1e,totalSteps:4}},W=z[s],{wizardStep:q,setWizardStep:H,resetWizardState:$,previewMetadata:J,previewProducts:O,previewCollections:V,isFetchingPreviewData:G,importError:F,fetchWizardProducts:ue,fetchWizardCollections:Ee,finalizeImportFromWizard:Se,ConnectFormComponent:we,MetadataPreviewComponent:Fe,ItemsPreviewComponent:Ze,totalSteps:ze,wizardShouldShowGenerator:nt,setWizardShouldShowGenerator:qe}=W;if(p.useEffect(()=>{i(n),n==="shopify"&&z.bigcommerce.resetWizardState&&z.bigcommerce.resetWizardState(),n==="bigcommerce"&&z.shopify.resetWizardState&&z.shopify.resetWizardState()},[n,z.bigcommerce,z.shopify]),p.useEffect(()=>{t&&q===0&&H(1),!t&&q!==0&&$()},[t,q,H,$]),!t||q===0)return null;const yt=async()=>{q<ze&&(s==="shopify"?q===2?((!O||O.edges.length===0)&&await ue(10),(!V||V.edges.length===0)&&await Ee(10),H(3)):q===3&&await Se():s==="bigcommerce"&&(q===1||(q===2?((!O||O.items.length===0)&&await ue(10),H(3)):q===3&&await pt())))},Le=()=>{q>1&&H(q-1)},Ae=()=>{$(),qe&&qe(!1),e&&e()},pt=async()=>{await Se()&&e&&e()},mt=()=>{switch(q){case 1:return a.jsx(we,{open:q===1,onOpenChange:Ft=>{Ft||Ae()},onSuccessfulConnect:Ft=>{s==="shopify"&&startShopifyImportWizard(Ft.domain,Ft.token)}});case 2:return a.jsx(Fe,{});case 3:return a.jsx(Ze,{});case 4:return s==="shopify"&&nt?a.jsx(ZW,{isEmbedded:!0,onGenerationComplete:Ft=>{if(Ft&&(Ft.urlSlug||Ft.name)){const nn=`/${Ft.urlSlug||Wl(Ft.name)}`;r(nn)}e&&e(),qe&&qe(!1)}}):a.jsx("div",{children:"Loading generator..."});default:return q===ze&&M?a.jsxs("div",{className:"flex flex-col items-center justify-center p-8",children:[a.jsx(St,{className:"h-8 w-8 animate-spin mb-4"})," ",a.jsx("p",{children:"Processing..."})]}):a.jsxs("div",{children:["Invalid Wizard Step or processing... (",q,")"]})}};if(q===1&&s==="shopify")return mt();const Ht=s==="shopify"?"Import from Shopify":s==="bigcommerce"?"Import from BigCommerce":"Import Store Data";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs(We,{className:"w-full max-w-2xl mx-auto shadow-xl",children:[a.jsxs(ot,{children:[a.jsx(at,{className:"text-2xl font-bold",children:q===1&&s==="bigcommerce"?"Connect to BigCommerce":Ht}),a.jsx(qt,{children:q===1&&s==="bigcommerce"?"Enter your store domain and API token.":q===4&&s==="shopify"?"Configure and generate your new store.":`Step ${q} of ${ze-1}`}),a.jsx("div",{className:"w-full bg-muted rounded-full h-2.5 mt-2",children:a.jsx(It.div,{className:"bg-primary h-2.5 rounded-full",initial:{width:"0%"},animate:{width:`${q/ze*100}%`},transition:{duration:.5,ease:"easeInOut"}})})]}),a.jsx(tt,{className:"min-h-[250px] max-h-[60vh] overflow-y-auto flex items-center justify-center",children:mt()}),a.jsxs(Yu,{className:"flex justify-between",children:[q>1&&q!==4&&a.jsxs(U,{variant:"outline",onClick:Ae,disabled:M||G,children:[a.jsx(Dv,{className:"mr-2 h-4 w-4"})," Cancel"]}),q===4&&s==="shopify"&&a.jsxs(U,{variant:"outline",onClick:Ae,disabled:M||G,children:[a.jsx(Dv,{className:"mr-2 h-4 w-4"})," Cancel Import"]}),a.jsxs("div",{children:[q>1&&q<ze-1&&a.jsxs(U,{variant:"outline",onClick:Le,disabled:M||G,className:"mr-2",children:[a.jsx(Ra,{className:"mr-2 h-4 w-4"})," Previous"]}),q===1&&s==="bigcommerce"&&a.jsxs(U,{onClick:yt,disabled:M||G,children:["Next ",a.jsx(lu,{className:"ml-2 h-4 w-4"})]}),q===2&&a.jsxs(U,{onClick:yt,disabled:M||G,children:["Next ",a.jsx(lu,{className:"ml-2 h-4 w-4"})]}),q===3&&a.jsxs(U,{onClick:yt,disabled:M||G,children:[M?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(lu,{className:"ml-2 h-4 w-4"}),"Configure Store"]}),q===ze&&M&&a.jsxs(U,{disabled:!0,children:[a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]})]})]})]})})},w1e=({onSelectSource:t,onClose:e})=>a.jsxs(We,{className:"w-full max-w-md mx-auto relative",children:[" ",a.jsx(U,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 text-muted-foreground hover:text-foreground",onClick:e,children:a.jsx(ra,{className:"h-5 w-5"})}),a.jsxs(ot,{children:[a.jsx(at,{children:"Import Store Data"}),a.jsxs(qt,{className:"text-slate-500 dark:text-slate-400",children:[" ","Select your e-commerce platform to begin importing your store and product data."]})]}),a.jsx(tt,{children:a.jsxs(Fi,{defaultValue:"shopify",className:"w-full",children:[a.jsxs(hi,{className:"grid w-full grid-cols-2",children:[a.jsx(Gt,{value:"shopify",children:"Shopify"}),a.jsx(Gt,{value:"bigcommerce",children:"BigCommerce"})]}),a.jsxs(Wt,{value:"shopify",className:"mt-4",children:[a.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:[" ","Connect to your Shopify store to import your shop details, products, and collections."]}),a.jsx(U,{className:"w-full",onClick:()=>t("shopify"),children:"Connect Shopify"})]}),a.jsxs(Wt,{value:"bigcommerce",className:"mt-4",children:[a.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:[" ","Connect to your BigCommerce store to import your store settings and product catalog."]}),a.jsx(U,{className:"w-full",onClick:()=>t("bigcommerce"),children:"Connect BigCommerce"})]})]})}),a.jsx(Yu,{children:a.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[" ","You will be guided through a few steps to connect and confirm the data to be imported."]})})]}),b1e=()=>{const[t,e]=p.useState(!1),[n,r]=p.useState(!1),[s,i]=p.useState(null),[o,l]=p.useState("ai-prompt");ro();const[c,u]=p.useState(!1);p.useState(!1),p.useState(null);const d=()=>{e(!0)},h=()=>{e(!1)},f=g=>{i(g),e(!1),r(!0)},m=()=>{r(!1),i(null)};return p.useEffect(()=>{let g,x;return g=setInterval(()=>{u(!0),x=setTimeout(()=>{u(!1)},2500)},5e3),()=>{clearInterval(g),clearTimeout(x)}},[]),a.jsxs("div",{className:"min-h-screen flex flex-col bg-[#ededed] dark:bg-[#131314]",children:[" ",a.jsx(sA,{}),a.jsxs(It.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"flex-1 container mx-auto px-4 py-8",children:[a.jsxs(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-10",children:[a.jsx("h1",{className:`text-4xl md:text-5xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-gray-600 to-gray-200 dark:from-gray-500 dark:to-gray-300 ${c?"animate-shimmer bg-200%":"bg-auto"}`,children:"Start Fresh"}),a.jsxs("p",{className:"text-lg font-inter text-muted-foreground max-w-3xl mx-auto",children:["You can create a store 3 ways: ",a.jsx("br",{})," Prompt, Steps or Import."]})]}),a.jsxs(Fi,{value:o,onValueChange:l,className:"w-full max-w-3xl mx-auto mb-12",children:[a.jsxs(hi,{className:"grid w-full grid-cols-2 md:grid-cols-3 mb-6",children:[a.jsxs(Gt,{value:"ai-prompt",children:[a.jsx("span",{className:"hidden sm:inline",children:"AI Prompt"}),a.jsx("span",{className:"sm:hidden",children:"AI Prompt"})]}),a.jsxs(Gt,{value:"wizard",children:[a.jsx("span",{className:"hidden sm:inline",children:"Step-by-Step"}),a.jsx("span",{className:"sm:hidden",children:"Steps"})]}),a.jsx(Gt,{value:"store-import",className:"hidden md:inline-flex",onClick:d,children:"Import Store"})]}),a.jsx(Wt,{value:"ai-prompt",children:a.jsx(LEe,{})}),a.jsx(Wt,{value:"wizard",children:a.jsx(ZW,{})}),a.jsxs(Wt,{value:"store-import",className:"text-center py-8",children:[" ",a.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Import data from Shopify or BigCommerce."})," ",a.jsxs(U,{onClick:d,variant:"default",size:"lg",children:[a.jsx(Uj,{className:"mr-2 h-5 w-5"}),"Select Import Source"]})]})]}),a.jsxs("div",{className:"mb-8 flex justify-center md:hidden",children:[" ",a.jsxs(U,{onClick:d,variant:"outline",size:"lg",className:"w-full max-w-xs",children:[a.jsx(Uj,{className:"mr-2 h-5 w-5"}),"Import Store Data"]})]}),a.jsx(ZEe,{})]}),a.jsx("footer",{className:"mt-auto py-6 text-center text-sm text-muted-foreground",children:a.jsxs("p",{children:["© ",new Date().getFullYear()," FreshFront. All rights reserved."]})}),t&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx(w1e,{onSelectSource:f,onClose:h})}),s&&a.jsx(v1e,{isOpen:n,onClose:m,initialImportSource:s})]})},_1e=()=>{const{user:t}=ro();return a.jsxs("div",{className:"min-h-screen flex flex-col",children:[a.jsx(sA,{}),a.jsxs("main",{className:"flex-1 container mx-auto px-4 py-8",children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Admin Dashboard"}),a.jsxs("p",{className:"mb-4",children:["Welcome, ",(t==null?void 0:t.email)||"Admin","!"]}),a.jsxs("div",{className:"bg-card p-6 rounded-lg shadow",children:[a.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Admin-Specific Content"}),a.jsx("p",{children:"This area is restricted to administrators. Here you can manage users, view all stores, access Stripe data, etc."}),a.jsx("div",{className:"mt-4 p-4 border border-dashed rounded",children:"Admin tools and data will be displayed here."})]})]}),a.jsx("footer",{className:"mt-auto py-6 text-center text-sm text-muted-foreground",children:a.jsxs("p",{children:["© ",new Date().getFullYear()," FreshFront - Admin Panel"]})})]})},S1e=({store:t,onEdit:e,currentTemplate:n,onTemplateChange:r,availableTemplates:s=[]})=>{const i=di(),{toast:o}=Ks(),{viewMode:l,setViewMode:c,currentStore:u,updateStore:d,updateStoreTemplateVersion:h}=Fn(),f=()=>{t&&t.name?(navigator.clipboard.writeText(`${window.location.origin}/${t.name}`),o({title:"Link Copied",description:"Store link has been copied to clipboard."})):o({title:"Error",description:"Could not copy link: Store name not available.",variant:"destructive"})},m=()=>{const b=l==="edit"?"published":"edit";c(b),o({title:`Switched to ${b==="published"?"Consumer View":"Admin View"}`,description:`Store is now in ${b==="published"?"consumer":"admin editing"} mode.`})},g=b=>{r&&r(b)},x=async b=>{let S=b;if(b==="classic"&&(S="v1"),t&&t.id&&S&&S!==t.template_version)try{await h(t.id,S),o({title:"Template Saved",description:`Store template successfully changed to ${b}.`,className:"bg-green-500 text-white"})}catch(I){console.error("Failed to save template:",I),o({title:"Save Failed",description:"Could not save the template change. Please try again.",variant:"destructive"})}else S===t.template_version&&o({title:"No Change",description:`Store is already using the ${b} template.`})},E=()=>{l!=="edit"&&c("edit"),e()},v=async()=>{if(t&&t.id)try{await d(t.id,{published_at:new Date().toISOString(),status:"published"}),o({title:"Store Published!",description:`${t.name} is now live.`,className:"bg-green-500 text-white"})}catch(b){console.error("Failed to publish store:",b),o({title:"Publish Failed",description:"Could not publish the store. Please try again.",variant:"destructive"})}};return l==="published"?a.jsx("button",{onClick:()=>c("edit"),className:"fixed bottom-4 left-4 p-2 z-50 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:"Open Admin Controls","aria-label":"Open Admin Controls",children:a.jsx(wp,{className:"h-6 w-6 text-gray-500 opacity-50 hover:opacity-75 dark:text-gray-400"})}):a.jsx(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"fixed bottom-0 left-0 right-0 bg-background/80 backdrop-blur-md border-t z-50 py-3",children:a.jsxs("div",{className:"container mx-auto px-4 flex items-center justify-between",children:[a.jsxs(U,{variant:"outline",size:"icon",onClick:()=>i("/"),title:"Back",children:[a.jsx(Ra,{className:"h-4 w-4"})," "]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(U,{variant:"outline",size:"icon",onClick:f,title:"Copy Link",children:[a.jsx(WV,{className:"h-4 w-4"})," "]}),a.jsx(U,{asChild:!0,variant:"outline",size:"sm",disabled:!t||!t.name,children:a.jsx(Us,{to:t&&t.name?`/${t.name}/dashboard`:"#",children:"Dashboard"})}),a.jsx(U,{asChild:!0,size:"sm",variant:"outline",disabled:!u||!u.name,children:a.jsxs(Us,{to:u&&u.name?`/${u.name}/content-creation`:"#",state:{storeData:u},children:[a.jsx(is,{className:"mr-2 h-4 w-4"}),"Create"]})}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs(pu,{value:n||"",onValueChange:g,children:[a.jsxs(Hl,{className:"w-[180px] h-9 text-sm",children:[a.jsx(Q1,{className:"mr-2 h-4 w-4"}),a.jsx(gu,{placeholder:"Switch Template"})]}),a.jsx(ql,{children:s.map(b=>a.jsx(Jn,{value:b,children:b.charAt(0).toUpperCase()+b.slice(1)},b))})]}),n&&n!==(t==null?void 0:t.template_version)&&a.jsx(U,{variant:"outline",size:"icon",className:"h-9 w-9 border-green-500 text-green-500 hover:bg-green-50 hover:text-green-600",onClick:()=>x(n),title:`Save ${n.charAt(0).toUpperCase()+n.slice(1)} Template`,children:a.jsx(rg,{className:"h-4 w-4"})})]}),a.jsxs(U,{size:"sm",onClick:E,children:[a.jsx(kv,{className:"mr-2 h-4 w-4"}),"Edit"]}),a.jsxs(U,{size:"sm",onClick:m,variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-50 hover:text-green-700",children:[a.jsx(Kse,{className:"mr-2 h-4 w-4"})," Customer"]}),a.jsxs(U,{size:"sm",onClick:v,className:"bg-green-500 hover:bg-green-600 text-white",children:[a.jsx(Jo,{className:"mr-2 h-4 w-4"}),"Publish"]})]})]})})},E1e=({store:t,open:e,onOpenChange:n})=>{var h;di();const{updateStore:r,isLoadingStores:s}=Fn(),[i,o]=p.useState({name:t.name,description:t.description,type:t.type,theme:{primaryColor:t.theme.primaryColor,secondaryColor:t.theme.secondaryColor,fontFamily:t.theme.fontFamily,layout:t.theme.layout},settings:{showThemeToggle:((h=t.settings)==null?void 0:h.showThemeToggle)??!0}}),l=f=>{const{name:m,value:g}=f.target;o(x=>({...x,[m]:g}))},c=(f,m)=>{o(g=>({...g,theme:{...g.theme,[f]:m}}))},u=(f,m)=>{o(g=>({...g,settings:{...g.settings,[f]:m}}))},d=f=>{f.preventDefault();const m={name:i.name,description:i.description,type:i.type,theme:i.theme,settings:i.settings};r(t.id,m),n(!1)};return a.jsx(Ps,{open:e,onOpenChange:n,children:a.jsxs(ls,{className:"sm:max-w-[600px] max-h-[85vh] overflow-y-auto",children:[a.jsxs(cs,{children:[a.jsx(us,{children:"Edit Store"}),a.jsx(No,{children:"Customize your store's details and appearance."})]}),a.jsxs("form",{onSubmit:d,className:"space-y-6 py-4",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"name",children:"Store Name"}),a.jsx(st,{id:"name",name:"name",value:i.name,onChange:l,required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"description",children:"Description"}),a.jsx(Vn,{id:"description",name:"description",value:i.description,onChange:l,rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"type",children:"Store Type"}),a.jsxs(pu,{value:i.type,onValueChange:f=>o(m=>({...m,type:f})),children:[a.jsx(Hl,{id:"type",children:a.jsx(gu,{placeholder:"Select store type"})}),a.jsxs(ql,{children:[a.jsx(Jn,{value:"fashion",children:"Fashion"}),a.jsx(Jn,{value:"electronics",children:"Electronics"}),a.jsx(Jn,{value:"food",children:"Food"}),a.jsx(Jn,{value:"jewelry",children:"Jewelry"}),a.jsx(Jn,{value:"general",children:"General"})]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-sm font-medium",children:"Theme Settings"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"primaryColor",children:"Primary Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(st,{id:"primaryColor",name:"primaryColor",type:"color",value:i.theme.primaryColor,onChange:f=>c("primaryColor",f.target.value),className:"w-12 h-10 p-1"}),a.jsx(st,{value:i.theme.primaryColor,onChange:f=>c("primaryColor",f.target.value),className:"flex-1"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"secondaryColor",children:"Secondary Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(st,{id:"secondaryColor",name:"secondaryColor",type:"color",value:i.theme.secondaryColor,onChange:f=>c("secondaryColor",f.target.value),className:"w-12 h-10 p-1"}),a.jsx(st,{value:i.theme.secondaryColor,onChange:f=>c("secondaryColor",f.target.value),className:"flex-1"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"fontFamily",children:"Font Family"}),a.jsxs(pu,{value:i.theme.fontFamily,onValueChange:f=>c("fontFamily",f),children:[a.jsx(Hl,{id:"fontFamily",children:a.jsx(gu,{placeholder:"Select font"})}),a.jsxs(ql,{children:[a.jsx(Jn,{value:"Inter",children:"Inter"}),a.jsx(Jn,{value:"Roboto",children:"Roboto"}),a.jsx(Jn,{value:"Poppins",children:"Poppins"}),a.jsx(Jn,{value:"Montserrat",children:"Montserrat"}),a.jsx(Jn,{value:"Open Sans",children:"Open Sans"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"layout",children:"Layout Style"}),a.jsxs(pu,{value:i.theme.layout,onValueChange:f=>c("layout",f),children:[a.jsx(Hl,{id:"layout",children:a.jsx(gu,{placeholder:"Select layout"})}),a.jsxs(ql,{children:[a.jsx(Jn,{value:"grid",children:"Grid"}),a.jsx(Jn,{value:"list",children:"List"}),a.jsx(Jn,{value:"masonry",children:"Masonry"}),a.jsx(Jn,{value:"carousel",children:"Carousel"})]})]})]}),a.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[a.jsx(je,{htmlFor:"showThemeToggle",className:"flex items-center",children:"Show Light/Dark Mode Toggle in Store Header"}),a.jsx(Wo,{id:"showThemeToggle",checked:i.settings.showThemeToggle,onCheckedChange:f=>u("showThemeToggle",f),disabled:s}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Allows customers to switch between light and dark themes on your store page."})]})]})]})]}),a.jsx(jr,{children:a.jsx(U,{type:"submit",disabled:s,children:"Save Changes"})})]})]})})};function C1e(t,e){const n=e||{};return(t[t.length-1]===""?[...t,""]:t).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const T1e=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,I1e=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,N1e={};function TL(t,e){return((e||N1e).jsx?I1e:T1e).test(t)}const P1e=/[ \t\n\f\r]/g;function A1e(t){return typeof t=="object"?t.type==="text"?IL(t.value):!1:IL(t)}function IL(t){return t.replace(P1e,"")===""}class Vg{constructor(e,n,r){this.normal=n,this.property=e,r&&(this.space=r)}}Vg.prototype.normal={};Vg.prototype.property={};Vg.prototype.space=void 0;function eH(t,e){const n={},r={};for(const s of t)Object.assign(n,s.property),Object.assign(r,s.normal);return new Vg(n,r,e)}function NT(t){return t.toLowerCase()}class fi{constructor(e,n){this.attribute=n,this.property=e}}fi.prototype.attribute="";fi.prototype.booleanish=!1;fi.prototype.boolean=!1;fi.prototype.commaOrSpaceSeparated=!1;fi.prototype.commaSeparated=!1;fi.prototype.defined=!1;fi.prototype.mustUseProperty=!1;fi.prototype.number=!1;fi.prototype.overloadedBoolean=!1;fi.prototype.property="";fi.prototype.spaceSeparated=!1;fi.prototype.space=void 0;let k1e=0;const en=ed(),Ar=ed(),PT=ed(),Ke=ed(),On=ed(),vh=ed(),yi=ed();function ed(){return 2**++k1e}const AT=Object.freeze(Object.defineProperty({__proto__:null,boolean:en,booleanish:Ar,commaOrSpaceSeparated:yi,commaSeparated:vh,number:Ke,overloadedBoolean:PT,spaceSeparated:On},Symbol.toStringTag,{value:"Module"})),AS=Object.keys(AT);class uA extends fi{constructor(e,n,r,s){let i=-1;if(super(e,n),NL(this,"space",s),typeof r=="number")for(;++i<AS.length;){const o=AS[i];NL(this,AS[i],(r&AT[o])===AT[o])}}}uA.prototype.defined=!0;function NL(t,e,n){n&&(t[e]=n)}function gf(t){const e={},n={};for(const[r,s]of Object.entries(t.properties)){const i=new uA(r,t.transform(t.attributes||{},r),s,t.space);t.mustUseProperty&&t.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),e[r]=i,n[NT(r)]=r,n[NT(i.attribute)]=r}return new Vg(e,n,t.space)}const tH=gf({properties:{ariaActiveDescendant:null,ariaAtomic:Ar,ariaAutoComplete:null,ariaBusy:Ar,ariaChecked:Ar,ariaColCount:Ke,ariaColIndex:Ke,ariaColSpan:Ke,ariaControls:On,ariaCurrent:null,ariaDescribedBy:On,ariaDetails:null,ariaDisabled:Ar,ariaDropEffect:On,ariaErrorMessage:null,ariaExpanded:Ar,ariaFlowTo:On,ariaGrabbed:Ar,ariaHasPopup:null,ariaHidden:Ar,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:On,ariaLevel:Ke,ariaLive:null,ariaModal:Ar,ariaMultiLine:Ar,ariaMultiSelectable:Ar,ariaOrientation:null,ariaOwns:On,ariaPlaceholder:null,ariaPosInSet:Ke,ariaPressed:Ar,ariaReadOnly:Ar,ariaRelevant:null,ariaRequired:Ar,ariaRoleDescription:On,ariaRowCount:Ke,ariaRowIndex:Ke,ariaRowSpan:Ke,ariaSelected:Ar,ariaSetSize:Ke,ariaSort:null,ariaValueMax:Ke,ariaValueMin:Ke,ariaValueNow:Ke,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function nH(t,e){return e in t?t[e]:e}function rH(t,e){return nH(t,e.toLowerCase())}const R1e=gf({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:vh,acceptCharset:On,accessKey:On,action:null,allow:null,allowFullScreen:en,allowPaymentRequest:en,allowUserMedia:en,alt:null,as:null,async:en,autoCapitalize:null,autoComplete:On,autoFocus:en,autoPlay:en,blocking:On,capture:null,charSet:null,checked:en,cite:null,className:On,cols:Ke,colSpan:null,content:null,contentEditable:Ar,controls:en,controlsList:On,coords:Ke|vh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:en,defer:en,dir:null,dirName:null,disabled:en,download:PT,draggable:Ar,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:en,formTarget:null,headers:On,height:Ke,hidden:PT,high:Ke,href:null,hrefLang:null,htmlFor:On,httpEquiv:On,id:null,imageSizes:null,imageSrcSet:null,inert:en,inputMode:null,integrity:null,is:null,isMap:en,itemId:null,itemProp:On,itemRef:On,itemScope:en,itemType:On,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:en,low:Ke,manifest:null,max:null,maxLength:Ke,media:null,method:null,min:null,minLength:Ke,multiple:en,muted:en,name:null,nonce:null,noModule:en,noValidate:en,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:en,optimum:Ke,pattern:null,ping:On,placeholder:null,playsInline:en,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:en,referrerPolicy:null,rel:On,required:en,reversed:en,rows:Ke,rowSpan:Ke,sandbox:On,scope:null,scoped:en,seamless:en,selected:en,shadowRootClonable:en,shadowRootDelegatesFocus:en,shadowRootMode:null,shape:null,size:Ke,sizes:null,slot:null,span:Ke,spellCheck:Ar,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Ke,step:null,style:null,tabIndex:Ke,target:null,title:null,translate:null,type:null,typeMustMatch:en,useMap:null,value:Ar,width:Ke,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:On,axis:null,background:null,bgColor:null,border:Ke,borderColor:null,bottomMargin:Ke,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:en,declare:en,event:null,face:null,frame:null,frameBorder:null,hSpace:Ke,leftMargin:Ke,link:null,longDesc:null,lowSrc:null,marginHeight:Ke,marginWidth:Ke,noResize:en,noHref:en,noShade:en,noWrap:en,object:null,profile:null,prompt:null,rev:null,rightMargin:Ke,rules:null,scheme:null,scrolling:Ar,standby:null,summary:null,text:null,topMargin:Ke,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Ke,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:en,disableRemotePlayback:en,prefix:null,property:null,results:Ke,security:null,unselectable:null},space:"html",transform:rH}),j1e=gf({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:yi,accentHeight:Ke,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Ke,amplitude:Ke,arabicForm:null,ascent:Ke,attributeName:null,attributeType:null,azimuth:Ke,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Ke,by:null,calcMode:null,capHeight:Ke,className:On,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Ke,diffuseConstant:Ke,direction:null,display:null,dur:null,divisor:Ke,dominantBaseline:null,download:en,dx:null,dy:null,edgeMode:null,editable:null,elevation:Ke,enableBackground:null,end:null,event:null,exponent:Ke,externalResourcesRequired:null,fill:null,fillOpacity:Ke,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:vh,g2:vh,glyphName:vh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Ke,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Ke,horizOriginX:Ke,horizOriginY:Ke,id:null,ideographic:Ke,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Ke,k:Ke,k1:Ke,k2:Ke,k3:Ke,k4:Ke,kernelMatrix:yi,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Ke,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Ke,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Ke,overlineThickness:Ke,paintOrder:null,panose1:null,path:null,pathLength:Ke,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:On,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Ke,pointsAtY:Ke,pointsAtZ:Ke,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:yi,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:yi,rev:yi,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:yi,requiredFeatures:yi,requiredFonts:yi,requiredFormats:yi,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Ke,specularExponent:Ke,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Ke,strikethroughThickness:Ke,string:null,stroke:null,strokeDashArray:yi,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Ke,strokeOpacity:Ke,strokeWidth:null,style:null,surfaceScale:Ke,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:yi,tabIndex:Ke,tableValues:null,target:null,targetX:Ke,targetY:Ke,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:yi,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Ke,underlineThickness:Ke,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Ke,values:null,vAlphabetic:Ke,vMathematical:Ke,vectorEffect:null,vHanging:Ke,vIdeographic:Ke,version:null,vertAdvY:Ke,vertOriginX:Ke,vertOriginY:Ke,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Ke,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:nH}),sH=gf({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),iH=gf({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:rH}),oH=gf({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),D1e={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},M1e=/[A-Z]/g,PL=/-[a-z]/g,L1e=/^data[-\w.:]+$/i;function F1e(t,e){const n=NT(e);let r=e,s=fi;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&L1e.test(e)){if(e.charAt(4)==="-"){const i=e.slice(5).replace(PL,$1e);r="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=e.slice(4);if(!PL.test(i)){let o=i.replace(M1e,O1e);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}s=uA}return new s(r,e)}function O1e(t){return"-"+t.toLowerCase()}function $1e(t){return t.charAt(1).toUpperCase()}const V1e=eH([tH,R1e,sH,iH,oH],"html"),dA=eH([tH,j1e,sH,iH,oH],"svg");function U1e(t){return t.join(" ").trim()}var hA={},AL=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,B1e=/\n/g,z1e=/^\s*/,G1e=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,W1e=/^:\s*/,H1e=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,q1e=/^[;\s]*/,K1e=/^\s+|\s+$/g,Y1e=`
`,kL="/",RL="*",Jc="",J1e="comment",X1e="declaration",Q1e=function(t,e){if(typeof t!="string")throw new TypeError("First argument must be a string");if(!t)return[];e=e||{};var n=1,r=1;function s(g){var x=g.match(B1e);x&&(n+=x.length);var E=g.lastIndexOf(Y1e);r=~E?g.length-E:r+g.length}function i(){var g={line:n,column:r};return function(x){return x.position=new o(g),u(),x}}function o(g){this.start=g,this.end={line:n,column:r},this.source=e.source}o.prototype.content=t;function l(g){var x=new Error(e.source+":"+n+":"+r+": "+g);if(x.reason=g,x.filename=e.source,x.line=n,x.column=r,x.source=t,!e.silent)throw x}function c(g){var x=g.exec(t);if(x){var E=x[0];return s(E),t=t.slice(E.length),x}}function u(){c(z1e)}function d(g){var x;for(g=g||[];x=h();)x!==!1&&g.push(x);return g}function h(){var g=i();if(!(kL!=t.charAt(0)||RL!=t.charAt(1))){for(var x=2;Jc!=t.charAt(x)&&(RL!=t.charAt(x)||kL!=t.charAt(x+1));)++x;if(x+=2,Jc===t.charAt(x-1))return l("End of comment missing");var E=t.slice(2,x-2);return r+=2,s(E),t=t.slice(x),r+=2,g({type:J1e,comment:E})}}function f(){var g=i(),x=c(G1e);if(x){if(h(),!c(W1e))return l("property missing ':'");var E=c(H1e),v=g({type:X1e,property:jL(x[0].replace(AL,Jc)),value:E?jL(E[0].replace(AL,Jc)):Jc});return c(q1e),v}}function m(){var g=[];d(g);for(var x;x=f();)x!==!1&&(g.push(x),d(g));return g}return u(),m()};function jL(t){return t?t.replace(K1e,Jc):Jc}var Z1e=Zx&&Zx.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(hA,"__esModule",{value:!0});hA.default=tIe;var eIe=Z1e(Q1e);function tIe(t,e){var n=null;if(!t||typeof t!="string")return n;var r=(0,eIe.default)(t),s=typeof e=="function";return r.forEach(function(i){if(i.type==="declaration"){var o=i.property,l=i.value;s?e(o,l,i):l&&(n=n||{},n[o]=l)}}),n}var Ob={};Object.defineProperty(Ob,"__esModule",{value:!0});Ob.camelCase=void 0;var nIe=/^--[a-zA-Z0-9_-]+$/,rIe=/-([a-z])/g,sIe=/^[^-]+$/,iIe=/^-(webkit|moz|ms|o|khtml)-/,oIe=/^-(ms)-/,aIe=function(t){return!t||sIe.test(t)||nIe.test(t)},lIe=function(t,e){return e.toUpperCase()},DL=function(t,e){return"".concat(e,"-")},cIe=function(t,e){return e===void 0&&(e={}),aIe(t)?t:(t=t.toLowerCase(),e.reactCompat?t=t.replace(oIe,DL):t=t.replace(iIe,DL),t.replace(rIe,lIe))};Ob.camelCase=cIe;var uIe=Zx&&Zx.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},dIe=uIe(hA),hIe=Ob;function kT(t,e){var n={};return!t||typeof t!="string"||(0,dIe.default)(t,function(r,s){r&&s&&(n[(0,hIe.camelCase)(r,e)]=s)}),n}kT.default=kT;var fIe=kT;const mIe=Lw(fIe),aH=lH("end"),fA=lH("start");function lH(t){return e;function e(n){const r=n&&n.position&&n.position[t]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function pIe(t){const e=fA(t),n=aH(t);if(e&&n)return{start:e,end:n}}function Jm(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?ML(t.position):"start"in t||"end"in t?ML(t):"line"in t||"column"in t?RT(t):""}function RT(t){return LL(t&&t.line)+":"+LL(t&&t.column)}function ML(t){return RT(t&&t.start)+"-"+RT(t&&t.end)}function LL(t){return t&&typeof t=="number"?t:1}class Rs extends Error{constructor(e,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let s="",i={},o=!1;if(n&&("line"in n&&"column"in n?i={place:n}:"start"in n&&"end"in n?i={place:n}:"type"in n?i={ancestors:[n],place:n.position}:i={...n}),typeof e=="string"?s=e:!i.cause&&e&&(o=!0,s=e.message,i.cause=e),!i.ruleId&&!i.source&&typeof r=="string"){const c=r.indexOf(":");c===-1?i.ruleId=r:(i.source=r.slice(0,c),i.ruleId=r.slice(c+1))}if(!i.place&&i.ancestors&&i.ancestors){const c=i.ancestors[i.ancestors.length-1];c&&(i.place=c.position)}const l=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=l?l.line:void 0,this.name=Jm(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=o&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}Rs.prototype.file="";Rs.prototype.name="";Rs.prototype.reason="";Rs.prototype.message="";Rs.prototype.stack="";Rs.prototype.column=void 0;Rs.prototype.line=void 0;Rs.prototype.ancestors=void 0;Rs.prototype.cause=void 0;Rs.prototype.fatal=void 0;Rs.prototype.place=void 0;Rs.prototype.ruleId=void 0;Rs.prototype.source=void 0;const mA={}.hasOwnProperty,gIe=new Map,yIe=/[A-Z]/g,xIe=new Set(["table","tbody","thead","tfoot","tr"]),vIe=new Set(["td","th"]),cH="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function wIe(t,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=NIe(n,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=IIe(n,e.jsx,e.jsxs)}const s={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?dA:V1e,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},i=uH(s,t,void 0);return i&&typeof i!="string"?i:s.create(t,s.Fragment,{children:i||void 0},void 0)}function uH(t,e,n){if(e.type==="element")return bIe(t,e,n);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return _Ie(t,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return EIe(t,e,n);if(e.type==="mdxjsEsm")return SIe(t,e);if(e.type==="root")return CIe(t,e,n);if(e.type==="text")return TIe(t,e)}function bIe(t,e,n){const r=t.schema;let s=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(s=dA,t.schema=s),t.ancestors.push(e);const i=hH(t,e.tagName,!1),o=PIe(t,e);let l=gA(t,e);return xIe.has(e.tagName)&&(l=l.filter(function(c){return typeof c=="string"?!A1e(c):!0})),dH(t,o,i,e),pA(o,l),t.ancestors.pop(),t.schema=r,t.create(e,i,o,n)}function _Ie(t,e){if(e.data&&e.data.estree&&t.evaluater){const r=e.data.estree.body[0];return r.type,t.evaluater.evaluateExpression(r.expression)}Kp(t,e.position)}function SIe(t,e){if(e.data&&e.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(e.data.estree);Kp(t,e.position)}function EIe(t,e,n){const r=t.schema;let s=r;e.name==="svg"&&r.space==="html"&&(s=dA,t.schema=s),t.ancestors.push(e);const i=e.name===null?t.Fragment:hH(t,e.name,!0),o=AIe(t,e),l=gA(t,e);return dH(t,o,i,e),pA(o,l),t.ancestors.pop(),t.schema=r,t.create(e,i,o,n)}function CIe(t,e,n){const r={};return pA(r,gA(t,e)),t.create(e,t.Fragment,r,n)}function TIe(t,e){return e.value}function dH(t,e,n,r){typeof n!="string"&&n!==t.Fragment&&t.passNode&&(e.node=r)}function pA(t,e){if(e.length>0){const n=e.length>1?e:e[0];n&&(t.children=n)}}function IIe(t,e,n){return r;function r(s,i,o,l){const u=Array.isArray(o.children)?n:e;return l?u(i,o,l):u(i,o)}}function NIe(t,e){return n;function n(r,s,i,o){const l=Array.isArray(i.children),c=fA(r);return e(s,i,o,l,{columnNumber:c?c.column-1:void 0,fileName:t,lineNumber:c?c.line:void 0},void 0)}}function PIe(t,e){const n={};let r,s;for(s in e.properties)if(s!=="children"&&mA.call(e.properties,s)){const i=kIe(t,s,e.properties[s]);if(i){const[o,l]=i;t.tableCellAlignToStyle&&o==="align"&&typeof l=="string"&&vIe.has(e.tagName)?r=l:n[o]=l}}if(r){const i=n.style||(n.style={});i[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function AIe(t,e){const n={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&t.evaluater){const i=r.data.estree.body[0];i.type;const o=i.expression;o.type;const l=o.properties[0];l.type,Object.assign(n,t.evaluater.evaluateExpression(l.argument))}else Kp(t,e.position);else{const s=r.name;let i;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&t.evaluater){const l=r.value.data.estree.body[0];l.type,i=t.evaluater.evaluateExpression(l.expression)}else Kp(t,e.position);else i=r.value===null?!0:r.value;n[s]=i}return n}function gA(t,e){const n=[];let r=-1;const s=t.passKeys?new Map:gIe;for(;++r<e.children.length;){const i=e.children[r];let o;if(t.passKeys){const c=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(c){const u=s.get(c)||0;o=c+"-"+u,s.set(c,u+1)}}const l=uH(t,i,o);l!==void 0&&n.push(l)}return n}function kIe(t,e,n){const r=F1e(t.schema,e);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?C1e(n):U1e(n)),r.property==="style"){let s=typeof n=="object"?n:RIe(t,String(n));return t.stylePropertyNameCase==="css"&&(s=jIe(s)),["style",s]}return[t.elementAttributeNameCase==="react"&&r.space?D1e[r.property]||r.property:r.attribute,n]}}function RIe(t,e){try{return mIe(e,{reactCompat:!0})}catch(n){if(t.ignoreInvalidStyle)return{};const r=n,s=new Rs("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw s.file=t.filePath||void 0,s.url=cH+"#cannot-parse-style-attribute",s}}function hH(t,e,n){let r;if(!n)r={type:"Literal",value:e};else if(e.includes(".")){const s=e.split(".");let i=-1,o;for(;++i<s.length;){const l=TL(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};o=o?{type:"MemberExpression",object:o,property:l,computed:!!(i&&l.type==="Literal"),optional:!1}:l}r=o}else r=TL(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const s=r.value;return mA.call(t.components,s)?t.components[s]:s}if(t.evaluater)return t.evaluater.evaluateExpression(r);Kp(t)}function Kp(t,e){const n=new Rs("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=t.filePath||void 0,n.url=cH+"#cannot-handle-mdx-estrees-without-createevaluater",n}function jIe(t){const e={};let n;for(n in t)mA.call(t,n)&&(e[DIe(n)]=t[n]);return e}function DIe(t){let e=t.replace(yIe,MIe);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function MIe(t){return"-"+t.toLowerCase()}const kS={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},LIe={};function FIe(t,e){const n=e||LIe,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,s=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return fH(t,r,s)}function fH(t,e,n){if(OIe(t)){if("value"in t)return t.type==="html"&&!n?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return FL(t.children,e,n)}return Array.isArray(t)?FL(t,e,n):""}function FL(t,e,n){const r=[];let s=-1;for(;++s<t.length;)r[s]=fH(t[s],e,n);return r.join("")}function OIe(t){return!!(t&&typeof t=="object")}const OL=document.createElement("i");function yA(t){const e="&"+t+";";OL.innerHTML=e;const n=OL.textContent;return n.charCodeAt(n.length-1)===59&&t!=="semi"||n===e?!1:n}function oa(t,e,n,r){const s=t.length;let i=0,o;if(e<0?e=-e>s?0:s+e:e=e>s?s:e,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(e,n),t.splice(...o);else for(n&&t.splice(e,n);i<r.length;)o=r.slice(i,i+1e4),o.unshift(e,0),t.splice(...o),i+=1e4,e+=1e4}function zi(t,e){return t.length>0?(oa(t,t.length,0,e),t):e}const $L={}.hasOwnProperty;function $Ie(t){const e={};let n=-1;for(;++n<t.length;)VIe(e,t[n]);return e}function VIe(t,e){let n;for(n in e){const s=($L.call(t,n)?t[n]:void 0)||(t[n]={}),i=e[n];let o;if(i)for(o in i){$L.call(s,o)||(s[o]=[]);const l=i[o];UIe(s[o],Array.isArray(l)?l:l?[l]:[])}}}function UIe(t,e){let n=-1;const r=[];for(;++n<e.length;)(e[n].add==="after"?t:r).push(e[n]);oa(t,0,0,r)}function mH(t,e){const n=Number.parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"�":String.fromCodePoint(n)}function wh(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Vo=Ic(/[A-Za-z]/),Ni=Ic(/[\dA-Za-z]/),BIe=Ic(/[#-'*+\--9=?A-Z^-~]/);function jT(t){return t!==null&&(t<32||t===127)}const DT=Ic(/\d/),zIe=Ic(/[\dA-Fa-f]/),GIe=Ic(/[!-/:-@[-`{-~]/);function zt(t){return t!==null&&t<-2}function ci(t){return t!==null&&(t<0||t===32)}function Sn(t){return t===-2||t===-1||t===32}const WIe=Ic(/\p{P}|\p{S}/u),HIe=Ic(/\s/);function Ic(t){return e;function e(n){return n!==null&&n>-1&&t.test(String.fromCharCode(n))}}function yf(t){const e=[];let n=-1,r=0,s=0;for(;++n<t.length;){const i=t.charCodeAt(n);let o="";if(i===37&&Ni(t.charCodeAt(n+1))&&Ni(t.charCodeAt(n+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(o=String.fromCharCode(i));else if(i>55295&&i<57344){const l=t.charCodeAt(n+1);i<56320&&l>56319&&l<57344?(o=String.fromCharCode(i,l),s=1):o="�"}else o=String.fromCharCode(i);o&&(e.push(t.slice(r,n),encodeURIComponent(o)),r=n+s+1,o=""),s&&(n+=s,s=0)}return e.join("")+t.slice(r)}function Bn(t,e,n,r){const s=r?r-1:Number.POSITIVE_INFINITY;let i=0;return o;function o(c){return Sn(c)?(t.enter(n),l(c)):e(c)}function l(c){return Sn(c)&&i++<s?(t.consume(c),l):(t.exit(n),e(c))}}const qIe={tokenize:KIe};function KIe(t){const e=t.attempt(this.parser.constructs.contentInitial,r,s);let n;return e;function r(l){if(l===null){t.consume(l);return}return t.enter("lineEnding"),t.consume(l),t.exit("lineEnding"),Bn(t,e,"linePrefix")}function s(l){return t.enter("paragraph"),i(l)}function i(l){const c=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=c),n=c,o(l)}function o(l){if(l===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(l);return}return zt(l)?(t.consume(l),t.exit("chunkText"),i):(t.consume(l),o)}}const YIe={tokenize:JIe},VL={tokenize:XIe};function JIe(t){const e=this,n=[];let r=0,s,i,o;return l;function l(S){if(r<n.length){const I=n[r];return e.containerState=I[1],t.attempt(I[0].continuation,c,u)(S)}return u(S)}function c(S){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,s&&b();const I=e.events.length;let D=I,k;for(;D--;)if(e.events[D][0]==="exit"&&e.events[D][1].type==="chunkFlow"){k=e.events[D][1].end;break}v(r);let C=I;for(;C<e.events.length;)e.events[C][1].end={...k},C++;return oa(e.events,D+1,0,e.events.slice(I)),e.events.length=C,u(S)}return l(S)}function u(S){if(r===n.length){if(!s)return f(S);if(s.currentConstruct&&s.currentConstruct.concrete)return g(S);e.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(VL,d,h)(S)}function d(S){return s&&b(),v(r),f(S)}function h(S){return e.parser.lazy[e.now().line]=r!==n.length,o=e.now().offset,g(S)}function f(S){return e.containerState={},t.attempt(VL,m,g)(S)}function m(S){return r++,n.push([e.currentConstruct,e.containerState]),f(S)}function g(S){if(S===null){s&&b(),v(0),t.consume(S);return}return s=s||e.parser.flow(e.now()),t.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),x(S)}function x(S){if(S===null){E(t.exit("chunkFlow"),!0),v(0),t.consume(S);return}return zt(S)?(t.consume(S),E(t.exit("chunkFlow")),r=0,e.interrupt=void 0,l):(t.consume(S),x)}function E(S,I){const D=e.sliceStream(S);if(I&&D.push(null),S.previous=i,i&&(i.next=S),i=S,s.defineSkip(S.start),s.write(D),e.parser.lazy[S.start.line]){let k=s.events.length;for(;k--;)if(s.events[k][1].start.offset<o&&(!s.events[k][1].end||s.events[k][1].end.offset>o))return;const C=e.events.length;let T=C,P,A;for(;T--;)if(e.events[T][0]==="exit"&&e.events[T][1].type==="chunkFlow"){if(P){A=e.events[T][1].end;break}P=!0}for(v(r),k=C;k<e.events.length;)e.events[k][1].end={...A},k++;oa(e.events,T+1,0,e.events.slice(C)),e.events.length=k}}function v(S){let I=n.length;for(;I-- >S;){const D=n[I];e.containerState=D[1],D[0].exit.call(e,t)}n.length=S}function b(){s.write([null]),i=void 0,s=void 0,e.containerState._closeFlow=void 0}}function XIe(t,e,n){return Bn(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function UL(t){if(t===null||ci(t)||HIe(t))return 1;if(WIe(t))return 2}function xA(t,e,n){const r=[];let s=-1;for(;++s<t.length;){const i=t[s].resolveAll;i&&!r.includes(i)&&(e=i(e,n),r.push(i))}return e}const MT={name:"attention",resolveAll:QIe,tokenize:ZIe};function QIe(t,e){let n=-1,r,s,i,o,l,c,u,d;for(;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(r=n;r--;)if(t[r][0]==="exit"&&t[r][1].type==="attentionSequence"&&t[r][1]._open&&e.sliceSerialize(t[r][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[r][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[r][1].end.offset-t[r][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;c=t[r][1].end.offset-t[r][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1;const h={...t[r][1].end},f={...t[n][1].start};BL(h,-c),BL(f,c),o={type:c>1?"strongSequence":"emphasisSequence",start:h,end:{...t[r][1].end}},l={type:c>1?"strongSequence":"emphasisSequence",start:{...t[n][1].start},end:f},i={type:c>1?"strongText":"emphasisText",start:{...t[r][1].end},end:{...t[n][1].start}},s={type:c>1?"strong":"emphasis",start:{...o.start},end:{...l.end}},t[r][1].end={...o.start},t[n][1].start={...l.end},u=[],t[r][1].end.offset-t[r][1].start.offset&&(u=zi(u,[["enter",t[r][1],e],["exit",t[r][1],e]])),u=zi(u,[["enter",s,e],["enter",o,e],["exit",o,e],["enter",i,e]]),u=zi(u,xA(e.parser.constructs.insideSpan.null,t.slice(r+1,n),e)),u=zi(u,[["exit",i,e],["enter",l,e],["exit",l,e],["exit",s,e]]),t[n][1].end.offset-t[n][1].start.offset?(d=2,u=zi(u,[["enter",t[n][1],e],["exit",t[n][1],e]])):d=0,oa(t,r-1,n-r+3,u),n=r+u.length-d-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function ZIe(t,e){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,s=UL(r);let i;return o;function o(c){return i=c,t.enter("attentionSequence"),l(c)}function l(c){if(c===i)return t.consume(c),l;const u=t.exit("attentionSequence"),d=UL(c),h=!d||d===2&&s||n.includes(c),f=!s||s===2&&d||n.includes(r);return u._open=!!(i===42?h:h&&(s||!f)),u._close=!!(i===42?f:f&&(d||!h)),e(c)}}function BL(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const eNe={name:"autolink",tokenize:tNe};function tNe(t,e,n){let r=0;return s;function s(m){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),i}function i(m){return Vo(m)?(t.consume(m),o):m===64?n(m):u(m)}function o(m){return m===43||m===45||m===46||Ni(m)?(r=1,l(m)):u(m)}function l(m){return m===58?(t.consume(m),r=0,c):(m===43||m===45||m===46||Ni(m))&&r++<32?(t.consume(m),l):(r=0,u(m))}function c(m){return m===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):m===null||m===32||m===60||jT(m)?n(m):(t.consume(m),c)}function u(m){return m===64?(t.consume(m),d):BIe(m)?(t.consume(m),u):n(m)}function d(m){return Ni(m)?h(m):n(m)}function h(m){return m===46?(t.consume(m),r=0,d):m===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):f(m)}function f(m){if((m===45||Ni(m))&&r++<63){const g=m===45?f:h;return t.consume(m),g}return n(m)}}const $b={partial:!0,tokenize:nNe};function nNe(t,e,n){return r;function r(i){return Sn(i)?Bn(t,s,"linePrefix")(i):s(i)}function s(i){return i===null||zt(i)?e(i):n(i)}}const pH={continuation:{tokenize:sNe},exit:iNe,name:"blockQuote",tokenize:rNe};function rNe(t,e,n){const r=this;return s;function s(o){if(o===62){const l=r.containerState;return l.open||(t.enter("blockQuote",{_container:!0}),l.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(o),t.exit("blockQuoteMarker"),i}return n(o)}function i(o){return Sn(o)?(t.enter("blockQuotePrefixWhitespace"),t.consume(o),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(o))}}function sNe(t,e,n){const r=this;return s;function s(o){return Sn(o)?Bn(t,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):i(o)}function i(o){return t.attempt(pH,e,n)(o)}}function iNe(t){t.exit("blockQuote")}const gH={name:"characterEscape",tokenize:oNe};function oNe(t,e,n){return r;function r(i){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(i),t.exit("escapeMarker"),s}function s(i){return GIe(i)?(t.enter("characterEscapeValue"),t.consume(i),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(i)}}const yH={name:"characterReference",tokenize:aNe};function aNe(t,e,n){const r=this;let s=0,i,o;return l;function l(h){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),c}function c(h){return h===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(h),t.exit("characterReferenceMarkerNumeric"),u):(t.enter("characterReferenceValue"),i=31,o=Ni,d(h))}function u(h){return h===88||h===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(h),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),i=6,o=zIe,d):(t.enter("characterReferenceValue"),i=7,o=DT,d(h))}function d(h){if(h===59&&s){const f=t.exit("characterReferenceValue");return o===Ni&&!yA(r.sliceSerialize(f))?n(h):(t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return o(h)&&s++<i?(t.consume(h),d):n(h)}}const zL={partial:!0,tokenize:cNe},GL={concrete:!0,name:"codeFenced",tokenize:lNe};function lNe(t,e,n){const r=this,s={partial:!0,tokenize:D};let i=0,o=0,l;return c;function c(k){return u(k)}function u(k){const C=r.events[r.events.length-1];return i=C&&C[1].type==="linePrefix"?C[2].sliceSerialize(C[1],!0).length:0,l=k,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),d(k)}function d(k){return k===l?(o++,t.consume(k),d):o<3?n(k):(t.exit("codeFencedFenceSequence"),Sn(k)?Bn(t,h,"whitespace")(k):h(k))}function h(k){return k===null||zt(k)?(t.exit("codeFencedFence"),r.interrupt?e(k):t.check(zL,x,I)(k)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),f(k))}function f(k){return k===null||zt(k)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),h(k)):Sn(k)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),Bn(t,m,"whitespace")(k)):k===96&&k===l?n(k):(t.consume(k),f)}function m(k){return k===null||zt(k)?h(k):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),g(k))}function g(k){return k===null||zt(k)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),h(k)):k===96&&k===l?n(k):(t.consume(k),g)}function x(k){return t.attempt(s,I,E)(k)}function E(k){return t.enter("lineEnding"),t.consume(k),t.exit("lineEnding"),v}function v(k){return i>0&&Sn(k)?Bn(t,b,"linePrefix",i+1)(k):b(k)}function b(k){return k===null||zt(k)?t.check(zL,x,I)(k):(t.enter("codeFlowValue"),S(k))}function S(k){return k===null||zt(k)?(t.exit("codeFlowValue"),b(k)):(t.consume(k),S)}function I(k){return t.exit("codeFenced"),e(k)}function D(k,C,T){let P=0;return A;function A(W){return k.enter("lineEnding"),k.consume(W),k.exit("lineEnding"),R}function R(W){return k.enter("codeFencedFence"),Sn(W)?Bn(k,M,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(W):M(W)}function M(W){return W===l?(k.enter("codeFencedFenceSequence"),j(W)):T(W)}function j(W){return W===l?(P++,k.consume(W),j):P>=o?(k.exit("codeFencedFenceSequence"),Sn(W)?Bn(k,z,"whitespace")(W):z(W)):T(W)}function z(W){return W===null||zt(W)?(k.exit("codeFencedFence"),C(W)):T(W)}}}function cNe(t,e,n){const r=this;return s;function s(o){return o===null?n(o):(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i)}function i(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}const RS={name:"codeIndented",tokenize:dNe},uNe={partial:!0,tokenize:hNe};function dNe(t,e,n){const r=this;return s;function s(u){return t.enter("codeIndented"),Bn(t,i,"linePrefix",4+1)(u)}function i(u){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?o(u):n(u)}function o(u){return u===null?c(u):zt(u)?t.attempt(uNe,o,c)(u):(t.enter("codeFlowValue"),l(u))}function l(u){return u===null||zt(u)?(t.exit("codeFlowValue"),o(u)):(t.consume(u),l)}function c(u){return t.exit("codeIndented"),e(u)}}function hNe(t,e,n){const r=this;return s;function s(o){return r.parser.lazy[r.now().line]?n(o):zt(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),s):Bn(t,i,"linePrefix",4+1)(o)}function i(o){const l=r.events[r.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(o):zt(o)?s(o):n(o)}}const fNe={name:"codeText",previous:pNe,resolve:mNe,tokenize:gNe};function mNe(t){let e=t.length-4,n=3,r,s;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(r=n;++r<e;)if(t[r][1].type==="codeTextData"){t[n][1].type="codeTextPadding",t[e][1].type="codeTextPadding",n+=2,e-=2;break}}for(r=n-1,e++;++r<=e;)s===void 0?r!==e&&t[r][1].type!=="lineEnding"&&(s=r):(r===e||t[r][1].type==="lineEnding")&&(t[s][1].type="codeTextData",r!==s+2&&(t[s][1].end=t[r-1][1].end,t.splice(s+2,r-s-2),e-=r-s-2,r=s+2),s=void 0);return t}function pNe(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function gNe(t,e,n){let r=0,s,i;return o;function o(h){return t.enter("codeText"),t.enter("codeTextSequence"),l(h)}function l(h){return h===96?(t.consume(h),r++,l):(t.exit("codeTextSequence"),c(h))}function c(h){return h===null?n(h):h===32?(t.enter("space"),t.consume(h),t.exit("space"),c):h===96?(i=t.enter("codeTextSequence"),s=0,d(h)):zt(h)?(t.enter("lineEnding"),t.consume(h),t.exit("lineEnding"),c):(t.enter("codeTextData"),u(h))}function u(h){return h===null||h===32||h===96||zt(h)?(t.exit("codeTextData"),c(h)):(t.consume(h),u)}function d(h){return h===96?(t.consume(h),s++,d):s===r?(t.exit("codeTextSequence"),t.exit("codeText"),e(h)):(i.type="codeTextData",u(h))}}class yNe{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,n,r){const s=n||0;this.setCursor(Math.trunc(e));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return r&&Yf(this.left,r),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),Yf(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),Yf(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const n=this.left.splice(e,Number.POSITIVE_INFINITY);Yf(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);Yf(this.left,n.reverse())}}}function Yf(t,e){let n=0;if(e.length<1e4)t.push(...e);else for(;n<e.length;)t.push(...e.slice(n,n+1e4)),n+=1e4}function xH(t){const e={};let n=-1,r,s,i,o,l,c,u;const d=new yNe(t);for(;++n<d.length;){for(;n in e;)n=e[n];if(r=d.get(n),n&&r[1].type==="chunkFlow"&&d.get(n-1)[1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,i=0,i<c.length&&c[i][1].type==="lineEndingBlank"&&(i+=2),i<c.length&&c[i][1].type==="content"))for(;++i<c.length&&c[i][1].type!=="content";)c[i][1].type==="chunkText"&&(c[i][1]._isInFirstContentOfListItem=!0,i++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,xNe(d,n)),n=e[n],u=!0);else if(r[1]._container){for(i=n,s=void 0;i--;)if(o=d.get(i),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),o[1].type="lineEnding",s=i);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;s&&(r[1].end={...d.get(s)[1].start},l=d.slice(s,n),l.unshift(r),d.splice(s,n-s+1,l))}}return oa(t,0,Number.POSITIVE_INFINITY,d.slice(0)),!u}function xNe(t,e){const n=t.get(e)[1],r=t.get(e)[2];let s=e-1;const i=[];let o=n._tokenizer;o||(o=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const l=o.events,c=[],u={};let d,h,f=-1,m=n,g=0,x=0;const E=[x];for(;m;){for(;t.get(++s)[1]!==m;);i.push(s),m._tokenizer||(d=r.sliceStream(m),m.next||d.push(null),h&&o.defineSkip(m.start),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(d),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),h=m,m=m.next}for(m=n;++f<l.length;)l[f][0]==="exit"&&l[f-1][0]==="enter"&&l[f][1].type===l[f-1][1].type&&l[f][1].start.line!==l[f][1].end.line&&(x=f+1,E.push(x),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(o.events=[],m?(m._tokenizer=void 0,m.previous=void 0):E.pop(),f=E.length;f--;){const v=l.slice(E[f],E[f+1]),b=i.pop();c.push([b,b+v.length-1]),t.splice(b,2,v)}for(c.reverse(),f=-1;++f<c.length;)u[g+c[f][0]]=g+c[f][1],g+=c[f][1]-c[f][0]-1;return u}const vNe={resolve:bNe,tokenize:_Ne},wNe={partial:!0,tokenize:SNe};function bNe(t){return xH(t),t}function _Ne(t,e){let n;return r;function r(l){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),s(l)}function s(l){return l===null?i(l):zt(l)?t.check(wNe,o,i)(l):(t.consume(l),s)}function i(l){return t.exit("chunkContent"),t.exit("content"),e(l)}function o(l){return t.consume(l),t.exit("chunkContent"),n.next=t.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,s}}function SNe(t,e,n){const r=this;return s;function s(o){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),Bn(t,i,"linePrefix")}function i(o){if(o===null||zt(o))return n(o);const l=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(o):t.interrupt(r.parser.constructs.flow,n,e)(o)}}function vH(t,e,n,r,s,i,o,l,c){const u=c||Number.POSITIVE_INFINITY;let d=0;return h;function h(v){return v===60?(t.enter(r),t.enter(s),t.enter(i),t.consume(v),t.exit(i),f):v===null||v===32||v===41||jT(v)?n(v):(t.enter(r),t.enter(o),t.enter(l),t.enter("chunkString",{contentType:"string"}),x(v))}function f(v){return v===62?(t.enter(i),t.consume(v),t.exit(i),t.exit(s),t.exit(r),e):(t.enter(l),t.enter("chunkString",{contentType:"string"}),m(v))}function m(v){return v===62?(t.exit("chunkString"),t.exit(l),f(v)):v===null||v===60||zt(v)?n(v):(t.consume(v),v===92?g:m)}function g(v){return v===60||v===62||v===92?(t.consume(v),m):m(v)}function x(v){return!d&&(v===null||v===41||ci(v))?(t.exit("chunkString"),t.exit(l),t.exit(o),t.exit(r),e(v)):d<u&&v===40?(t.consume(v),d++,x):v===41?(t.consume(v),d--,x):v===null||v===32||v===40||jT(v)?n(v):(t.consume(v),v===92?E:x)}function E(v){return v===40||v===41||v===92?(t.consume(v),x):x(v)}}function wH(t,e,n,r,s,i){const o=this;let l=0,c;return u;function u(m){return t.enter(r),t.enter(s),t.consume(m),t.exit(s),t.enter(i),d}function d(m){return l>999||m===null||m===91||m===93&&!c||m===94&&!l&&"_hiddenFootnoteSupport"in o.parser.constructs?n(m):m===93?(t.exit(i),t.enter(s),t.consume(m),t.exit(s),t.exit(r),e):zt(m)?(t.enter("lineEnding"),t.consume(m),t.exit("lineEnding"),d):(t.enter("chunkString",{contentType:"string"}),h(m))}function h(m){return m===null||m===91||m===93||zt(m)||l++>999?(t.exit("chunkString"),d(m)):(t.consume(m),c||(c=!Sn(m)),m===92?f:h)}function f(m){return m===91||m===92||m===93?(t.consume(m),l++,h):h(m)}}function bH(t,e,n,r,s,i){let o;return l;function l(f){return f===34||f===39||f===40?(t.enter(r),t.enter(s),t.consume(f),t.exit(s),o=f===40?41:f,c):n(f)}function c(f){return f===o?(t.enter(s),t.consume(f),t.exit(s),t.exit(r),e):(t.enter(i),u(f))}function u(f){return f===o?(t.exit(i),c(o)):f===null?n(f):zt(f)?(t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),Bn(t,u,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===o||f===null||zt(f)?(t.exit("chunkString"),u(f)):(t.consume(f),f===92?h:d)}function h(f){return f===o||f===92?(t.consume(f),d):d(f)}}function Xm(t,e){let n;return r;function r(s){return zt(s)?(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),n=!0,r):Sn(s)?Bn(t,r,n?"linePrefix":"lineSuffix")(s):e(s)}}const ENe={name:"definition",tokenize:TNe},CNe={partial:!0,tokenize:INe};function TNe(t,e,n){const r=this;let s;return i;function i(m){return t.enter("definition"),o(m)}function o(m){return wH.call(r,t,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(m)}function l(m){return s=wh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),m===58?(t.enter("definitionMarker"),t.consume(m),t.exit("definitionMarker"),c):n(m)}function c(m){return ci(m)?Xm(t,u)(m):u(m)}function u(m){return vH(t,d,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(m)}function d(m){return t.attempt(CNe,h,h)(m)}function h(m){return Sn(m)?Bn(t,f,"whitespace")(m):f(m)}function f(m){return m===null||zt(m)?(t.exit("definition"),r.parser.defined.push(s),e(m)):n(m)}}function INe(t,e,n){return r;function r(l){return ci(l)?Xm(t,s)(l):n(l)}function s(l){return bH(t,i,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function i(l){return Sn(l)?Bn(t,o,"whitespace")(l):o(l)}function o(l){return l===null||zt(l)?e(l):n(l)}}const NNe={name:"hardBreakEscape",tokenize:PNe};function PNe(t,e,n){return r;function r(i){return t.enter("hardBreakEscape"),t.consume(i),s}function s(i){return zt(i)?(t.exit("hardBreakEscape"),e(i)):n(i)}}const ANe={name:"headingAtx",resolve:kNe,tokenize:RNe};function kNe(t,e){let n=t.length-2,r=3,s,i;return t[r][1].type==="whitespace"&&(r+=2),n-2>r&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&t[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(s={type:"atxHeadingText",start:t[r][1].start,end:t[n][1].end},i={type:"chunkText",start:t[r][1].start,end:t[n][1].end,contentType:"text"},oa(t,r,n-r+1,[["enter",s,e],["enter",i,e],["exit",i,e],["exit",s,e]])),t}function RNe(t,e,n){let r=0;return s;function s(d){return t.enter("atxHeading"),i(d)}function i(d){return t.enter("atxHeadingSequence"),o(d)}function o(d){return d===35&&r++<6?(t.consume(d),o):d===null||ci(d)?(t.exit("atxHeadingSequence"),l(d)):n(d)}function l(d){return d===35?(t.enter("atxHeadingSequence"),c(d)):d===null||zt(d)?(t.exit("atxHeading"),e(d)):Sn(d)?Bn(t,l,"whitespace")(d):(t.enter("atxHeadingText"),u(d))}function c(d){return d===35?(t.consume(d),c):(t.exit("atxHeadingSequence"),l(d))}function u(d){return d===null||d===35||ci(d)?(t.exit("atxHeadingText"),l(d)):(t.consume(d),u)}}const jNe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],WL=["pre","script","style","textarea"],DNe={concrete:!0,name:"htmlFlow",resolveTo:FNe,tokenize:ONe},MNe={partial:!0,tokenize:VNe},LNe={partial:!0,tokenize:$Ne};function FNe(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function ONe(t,e,n){const r=this;let s,i,o,l,c;return u;function u(F){return d(F)}function d(F){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(F),h}function h(F){return F===33?(t.consume(F),f):F===47?(t.consume(F),i=!0,x):F===63?(t.consume(F),s=3,r.interrupt?e:O):Vo(F)?(t.consume(F),o=String.fromCharCode(F),E):n(F)}function f(F){return F===45?(t.consume(F),s=2,m):F===91?(t.consume(F),s=5,l=0,g):Vo(F)?(t.consume(F),s=4,r.interrupt?e:O):n(F)}function m(F){return F===45?(t.consume(F),r.interrupt?e:O):n(F)}function g(F){const ue="CDATA[";return F===ue.charCodeAt(l++)?(t.consume(F),l===ue.length?r.interrupt?e:M:g):n(F)}function x(F){return Vo(F)?(t.consume(F),o=String.fromCharCode(F),E):n(F)}function E(F){if(F===null||F===47||F===62||ci(F)){const ue=F===47,Ee=o.toLowerCase();return!ue&&!i&&WL.includes(Ee)?(s=1,r.interrupt?e(F):M(F)):jNe.includes(o.toLowerCase())?(s=6,ue?(t.consume(F),v):r.interrupt?e(F):M(F)):(s=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(F):i?b(F):S(F))}return F===45||Ni(F)?(t.consume(F),o+=String.fromCharCode(F),E):n(F)}function v(F){return F===62?(t.consume(F),r.interrupt?e:M):n(F)}function b(F){return Sn(F)?(t.consume(F),b):A(F)}function S(F){return F===47?(t.consume(F),A):F===58||F===95||Vo(F)?(t.consume(F),I):Sn(F)?(t.consume(F),S):A(F)}function I(F){return F===45||F===46||F===58||F===95||Ni(F)?(t.consume(F),I):D(F)}function D(F){return F===61?(t.consume(F),k):Sn(F)?(t.consume(F),D):S(F)}function k(F){return F===null||F===60||F===61||F===62||F===96?n(F):F===34||F===39?(t.consume(F),c=F,C):Sn(F)?(t.consume(F),k):T(F)}function C(F){return F===c?(t.consume(F),c=null,P):F===null||zt(F)?n(F):(t.consume(F),C)}function T(F){return F===null||F===34||F===39||F===47||F===60||F===61||F===62||F===96||ci(F)?D(F):(t.consume(F),T)}function P(F){return F===47||F===62||Sn(F)?S(F):n(F)}function A(F){return F===62?(t.consume(F),R):n(F)}function R(F){return F===null||zt(F)?M(F):Sn(F)?(t.consume(F),R):n(F)}function M(F){return F===45&&s===2?(t.consume(F),q):F===60&&s===1?(t.consume(F),H):F===62&&s===4?(t.consume(F),V):F===63&&s===3?(t.consume(F),O):F===93&&s===5?(t.consume(F),J):zt(F)&&(s===6||s===7)?(t.exit("htmlFlowData"),t.check(MNe,G,j)(F)):F===null||zt(F)?(t.exit("htmlFlowData"),j(F)):(t.consume(F),M)}function j(F){return t.check(LNe,z,G)(F)}function z(F){return t.enter("lineEnding"),t.consume(F),t.exit("lineEnding"),W}function W(F){return F===null||zt(F)?j(F):(t.enter("htmlFlowData"),M(F))}function q(F){return F===45?(t.consume(F),O):M(F)}function H(F){return F===47?(t.consume(F),o="",$):M(F)}function $(F){if(F===62){const ue=o.toLowerCase();return WL.includes(ue)?(t.consume(F),V):M(F)}return Vo(F)&&o.length<8?(t.consume(F),o+=String.fromCharCode(F),$):M(F)}function J(F){return F===93?(t.consume(F),O):M(F)}function O(F){return F===62?(t.consume(F),V):F===45&&s===2?(t.consume(F),O):M(F)}function V(F){return F===null||zt(F)?(t.exit("htmlFlowData"),G(F)):(t.consume(F),V)}function G(F){return t.exit("htmlFlow"),e(F)}}function $Ne(t,e,n){const r=this;return s;function s(o){return zt(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i):n(o)}function i(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}function VNe(t,e,n){return r;function r(s){return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),t.attempt($b,e,n)}}const UNe={name:"htmlText",tokenize:BNe};function BNe(t,e,n){const r=this;let s,i,o;return l;function l(O){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(O),c}function c(O){return O===33?(t.consume(O),u):O===47?(t.consume(O),D):O===63?(t.consume(O),S):Vo(O)?(t.consume(O),T):n(O)}function u(O){return O===45?(t.consume(O),d):O===91?(t.consume(O),i=0,g):Vo(O)?(t.consume(O),b):n(O)}function d(O){return O===45?(t.consume(O),m):n(O)}function h(O){return O===null?n(O):O===45?(t.consume(O),f):zt(O)?(o=h,H(O)):(t.consume(O),h)}function f(O){return O===45?(t.consume(O),m):h(O)}function m(O){return O===62?q(O):O===45?f(O):h(O)}function g(O){const V="CDATA[";return O===V.charCodeAt(i++)?(t.consume(O),i===V.length?x:g):n(O)}function x(O){return O===null?n(O):O===93?(t.consume(O),E):zt(O)?(o=x,H(O)):(t.consume(O),x)}function E(O){return O===93?(t.consume(O),v):x(O)}function v(O){return O===62?q(O):O===93?(t.consume(O),v):x(O)}function b(O){return O===null||O===62?q(O):zt(O)?(o=b,H(O)):(t.consume(O),b)}function S(O){return O===null?n(O):O===63?(t.consume(O),I):zt(O)?(o=S,H(O)):(t.consume(O),S)}function I(O){return O===62?q(O):S(O)}function D(O){return Vo(O)?(t.consume(O),k):n(O)}function k(O){return O===45||Ni(O)?(t.consume(O),k):C(O)}function C(O){return zt(O)?(o=C,H(O)):Sn(O)?(t.consume(O),C):q(O)}function T(O){return O===45||Ni(O)?(t.consume(O),T):O===47||O===62||ci(O)?P(O):n(O)}function P(O){return O===47?(t.consume(O),q):O===58||O===95||Vo(O)?(t.consume(O),A):zt(O)?(o=P,H(O)):Sn(O)?(t.consume(O),P):q(O)}function A(O){return O===45||O===46||O===58||O===95||Ni(O)?(t.consume(O),A):R(O)}function R(O){return O===61?(t.consume(O),M):zt(O)?(o=R,H(O)):Sn(O)?(t.consume(O),R):P(O)}function M(O){return O===null||O===60||O===61||O===62||O===96?n(O):O===34||O===39?(t.consume(O),s=O,j):zt(O)?(o=M,H(O)):Sn(O)?(t.consume(O),M):(t.consume(O),z)}function j(O){return O===s?(t.consume(O),s=void 0,W):O===null?n(O):zt(O)?(o=j,H(O)):(t.consume(O),j)}function z(O){return O===null||O===34||O===39||O===60||O===61||O===96?n(O):O===47||O===62||ci(O)?P(O):(t.consume(O),z)}function W(O){return O===47||O===62||ci(O)?P(O):n(O)}function q(O){return O===62?(t.consume(O),t.exit("htmlTextData"),t.exit("htmlText"),e):n(O)}function H(O){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(O),t.exit("lineEnding"),$}function $(O){return Sn(O)?Bn(t,J,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(O):J(O)}function J(O){return t.enter("htmlTextData"),o(O)}}const vA={name:"labelEnd",resolveAll:HNe,resolveTo:qNe,tokenize:KNe},zNe={tokenize:YNe},GNe={tokenize:JNe},WNe={tokenize:XNe};function HNe(t){let e=-1;const n=[];for(;++e<t.length;){const r=t[e][1];if(n.push(t[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const s=r.type==="labelImage"?4:2;r.type="data",e+=s}}return t.length!==n.length&&oa(t,0,t.length,n),t}function qNe(t,e){let n=t.length,r=0,s,i,o,l;for(;n--;)if(s=t[n][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;t[n][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(o){if(t[n][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=n,s.type!=="labelLink")){r=2;break}}else s.type==="labelEnd"&&(o=n);const c={type:t[i][1].type==="labelLink"?"link":"image",start:{...t[i][1].start},end:{...t[t.length-1][1].end}},u={type:"label",start:{...t[i][1].start},end:{...t[o][1].end}},d={type:"labelText",start:{...t[i+r+2][1].end},end:{...t[o-2][1].start}};return l=[["enter",c,e],["enter",u,e]],l=zi(l,t.slice(i+1,i+r+3)),l=zi(l,[["enter",d,e]]),l=zi(l,xA(e.parser.constructs.insideSpan.null,t.slice(i+r+4,o-3),e)),l=zi(l,[["exit",d,e],t[o-2],t[o-1],["exit",u,e]]),l=zi(l,t.slice(o+1)),l=zi(l,[["exit",c,e]]),oa(t,i,t.length,l),t}function KNe(t,e,n){const r=this;let s=r.events.length,i,o;for(;s--;)if((r.events[s][1].type==="labelImage"||r.events[s][1].type==="labelLink")&&!r.events[s][1]._balanced){i=r.events[s][1];break}return l;function l(f){return i?i._inactive?h(f):(o=r.parser.defined.includes(wh(r.sliceSerialize({start:i.end,end:r.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(f),t.exit("labelMarker"),t.exit("labelEnd"),c):n(f)}function c(f){return f===40?t.attempt(zNe,d,o?d:h)(f):f===91?t.attempt(GNe,d,o?u:h)(f):o?d(f):h(f)}function u(f){return t.attempt(WNe,d,h)(f)}function d(f){return e(f)}function h(f){return i._balanced=!0,n(f)}}function YNe(t,e,n){return r;function r(h){return t.enter("resource"),t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),s}function s(h){return ci(h)?Xm(t,i)(h):i(h)}function i(h){return h===41?d(h):vH(t,o,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function o(h){return ci(h)?Xm(t,c)(h):d(h)}function l(h){return n(h)}function c(h){return h===34||h===39||h===40?bH(t,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):d(h)}function u(h){return ci(h)?Xm(t,d)(h):d(h)}function d(h){return h===41?(t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),t.exit("resource"),e):n(h)}}function JNe(t,e,n){const r=this;return s;function s(l){return wH.call(r,t,i,o,"reference","referenceMarker","referenceString")(l)}function i(l){return r.parser.defined.includes(wh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(l):n(l)}function o(l){return n(l)}}function XNe(t,e,n){return r;function r(i){return t.enter("reference"),t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),s}function s(i){return i===93?(t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),t.exit("reference"),e):n(i)}}const QNe={name:"labelStartImage",resolveAll:vA.resolveAll,tokenize:ZNe};function ZNe(t,e,n){const r=this;return s;function s(l){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(l),t.exit("labelImageMarker"),i}function i(l){return l===91?(t.enter("labelMarker"),t.consume(l),t.exit("labelMarker"),t.exit("labelImage"),o):n(l)}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(l):e(l)}}const ePe={name:"labelStartLink",resolveAll:vA.resolveAll,tokenize:tPe};function tPe(t,e,n){const r=this;return s;function s(o){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(o),t.exit("labelMarker"),t.exit("labelLink"),i}function i(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):e(o)}}const jS={name:"lineEnding",tokenize:nPe};function nPe(t,e){return n;function n(r){return t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),Bn(t,e,"linePrefix")}}const Jx={name:"thematicBreak",tokenize:rPe};function rPe(t,e,n){let r=0,s;return i;function i(u){return t.enter("thematicBreak"),o(u)}function o(u){return s=u,l(u)}function l(u){return u===s?(t.enter("thematicBreakSequence"),c(u)):r>=3&&(u===null||zt(u))?(t.exit("thematicBreak"),e(u)):n(u)}function c(u){return u===s?(t.consume(u),r++,c):(t.exit("thematicBreakSequence"),Sn(u)?Bn(t,l,"whitespace")(u):l(u))}}const Qs={continuation:{tokenize:aPe},exit:cPe,name:"list",tokenize:oPe},sPe={partial:!0,tokenize:uPe},iPe={partial:!0,tokenize:lPe};function oPe(t,e,n){const r=this,s=r.events[r.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,o=0;return l;function l(m){const g=r.containerState.type||(m===42||m===43||m===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!r.containerState.marker||m===r.containerState.marker:DT(m)){if(r.containerState.type||(r.containerState.type=g,t.enter(g,{_container:!0})),g==="listUnordered")return t.enter("listItemPrefix"),m===42||m===45?t.check(Jx,n,u)(m):u(m);if(!r.interrupt||m===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),c(m)}return n(m)}function c(m){return DT(m)&&++o<10?(t.consume(m),c):(!r.interrupt||o<2)&&(r.containerState.marker?m===r.containerState.marker:m===41||m===46)?(t.exit("listItemValue"),u(m)):n(m)}function u(m){return t.enter("listItemMarker"),t.consume(m),t.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||m,t.check($b,r.interrupt?n:d,t.attempt(sPe,f,h))}function d(m){return r.containerState.initialBlankLine=!0,i++,f(m)}function h(m){return Sn(m)?(t.enter("listItemPrefixWhitespace"),t.consume(m),t.exit("listItemPrefixWhitespace"),f):n(m)}function f(m){return r.containerState.size=i+r.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(m)}}function aPe(t,e,n){const r=this;return r.containerState._closeFlow=void 0,t.check($b,s,i);function s(l){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Bn(t,e,"listItemIndent",r.containerState.size+1)(l)}function i(l){return r.containerState.furtherBlankLines||!Sn(l)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(l)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,t.attempt(iPe,e,o)(l))}function o(l){return r.containerState._closeFlow=!0,r.interrupt=void 0,Bn(t,t.attempt(Qs,e,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function lPe(t,e,n){const r=this;return Bn(t,s,"listItemIndent",r.containerState.size+1);function s(i){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?e(i):n(i)}}function cPe(t){t.exit(this.containerState.type)}function uPe(t,e,n){const r=this;return Bn(t,s,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4+1);function s(i){const o=r.events[r.events.length-1];return!Sn(i)&&o&&o[1].type==="listItemPrefixWhitespace"?e(i):n(i)}}const HL={name:"setextUnderline",resolveTo:dPe,tokenize:hPe};function dPe(t,e){let n=t.length,r,s,i;for(;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){r=n;break}t[n][1].type==="paragraph"&&(s=n)}else t[n][1].type==="content"&&t.splice(n,1),!i&&t[n][1].type==="definition"&&(i=n);const o={type:"setextHeading",start:{...t[r][1].start},end:{...t[t.length-1][1].end}};return t[s][1].type="setextHeadingText",i?(t.splice(s,0,["enter",o,e]),t.splice(i+1,0,["exit",t[r][1],e]),t[r][1].end={...t[i][1].end}):t[r][1]=o,t.push(["exit",o,e]),t}function hPe(t,e,n){const r=this;let s;return i;function i(u){let d=r.events.length,h;for(;d--;)if(r.events[d][1].type!=="lineEnding"&&r.events[d][1].type!=="linePrefix"&&r.events[d][1].type!=="content"){h=r.events[d][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||h)?(t.enter("setextHeadingLine"),s=u,o(u)):n(u)}function o(u){return t.enter("setextHeadingLineSequence"),l(u)}function l(u){return u===s?(t.consume(u),l):(t.exit("setextHeadingLineSequence"),Sn(u)?Bn(t,c,"lineSuffix")(u):c(u))}function c(u){return u===null||zt(u)?(t.exit("setextHeadingLine"),e(u)):n(u)}}const fPe={tokenize:mPe};function mPe(t){const e=this,n=t.attempt($b,r,t.attempt(this.parser.constructs.flowInitial,s,Bn(t,t.attempt(this.parser.constructs.flow,s,t.attempt(vNe,s)),"linePrefix")));return n;function r(i){if(i===null){t.consume(i);return}return t.enter("lineEndingBlank"),t.consume(i),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function s(i){if(i===null){t.consume(i);return}return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),e.currentConstruct=void 0,n}}const pPe={resolveAll:SH()},gPe=_H("string"),yPe=_H("text");function _H(t){return{resolveAll:SH(t==="text"?xPe:void 0),tokenize:e};function e(n){const r=this,s=this.parser.constructs[t],i=n.attempt(s,o,l);return o;function o(d){return u(d)?i(d):l(d)}function l(d){if(d===null){n.consume(d);return}return n.enter("data"),n.consume(d),c}function c(d){return u(d)?(n.exit("data"),i(d)):(n.consume(d),c)}function u(d){if(d===null)return!0;const h=s[d];let f=-1;if(h)for(;++f<h.length;){const m=h[f];if(!m.previous||m.previous.call(r,r.previous))return!0}return!1}}}function SH(t){return e;function e(n,r){let s=-1,i;for(;++s<=n.length;)i===void 0?n[s]&&n[s][1].type==="data"&&(i=s,s++):(!n[s]||n[s][1].type!=="data")&&(s!==i+2&&(n[i][1].end=n[s-1][1].end,n.splice(i+2,s-i-2),s=i+2),i=void 0);return t?t(n,r):n}}function xPe(t,e){let n=0;for(;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){const r=t[n-1][1],s=e.sliceStream(r);let i=s.length,o=-1,l=0,c;for(;i--;){const u=s[i];if(typeof u=="string"){for(o=u.length;u.charCodeAt(o-1)===32;)l++,o--;if(o)break;o=-1}else if(u===-2)c=!0,l++;else if(u!==-1){i++;break}}if(e._contentTypeTextTrailing&&n===t.length&&(l=0),l){const u={type:n===t.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?o:r.start._bufferIndex+o,_index:r.start._index+i,line:r.end.line,column:r.end.column-l,offset:r.end.offset-l},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(t.splice(n,0,["enter",u,e],["exit",u,e]),n+=2)}n++}return t}const vPe={42:Qs,43:Qs,45:Qs,48:Qs,49:Qs,50:Qs,51:Qs,52:Qs,53:Qs,54:Qs,55:Qs,56:Qs,57:Qs,62:pH},wPe={91:ENe},bPe={[-2]:RS,[-1]:RS,32:RS},_Pe={35:ANe,42:Jx,45:[HL,Jx],60:DNe,61:HL,95:Jx,96:GL,126:GL},SPe={38:yH,92:gH},EPe={[-5]:jS,[-4]:jS,[-3]:jS,33:QNe,38:yH,42:MT,60:[eNe,UNe],91:ePe,92:[NNe,gH],93:vA,95:MT,96:fNe},CPe={null:[MT,pPe]},TPe={null:[42,95]},IPe={null:[]},NPe=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:TPe,contentInitial:wPe,disable:IPe,document:vPe,flow:_Pe,flowInitial:bPe,insideSpan:CPe,string:SPe,text:EPe},Symbol.toStringTag,{value:"Module"}));function PPe(t,e,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const s={},i=[];let o=[],l=[];const c={attempt:C(D),check:C(k),consume:b,enter:S,exit:I,interrupt:C(k,{interrupt:!0})},u={code:null,containerState:{},defineSkip:x,events:[],now:g,parser:t,previous:null,sliceSerialize:f,sliceStream:m,write:h};let d=e.tokenize.call(u,c);return e.resolveAll&&i.push(e),u;function h(R){return o=zi(o,R),E(),o[o.length-1]!==null?[]:(T(e,0),u.events=xA(i,u.events,u),u.events)}function f(R,M){return kPe(m(R),M)}function m(R){return APe(o,R)}function g(){const{_bufferIndex:R,_index:M,line:j,column:z,offset:W}=r;return{_bufferIndex:R,_index:M,line:j,column:z,offset:W}}function x(R){s[R.line]=R.column,A()}function E(){let R;for(;r._index<o.length;){const M=o[r._index];if(typeof M=="string")for(R=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===R&&r._bufferIndex<M.length;)v(M.charCodeAt(r._bufferIndex));else v(M)}}function v(R){d=d(R)}function b(R){zt(R)?(r.line++,r.column=1,r.offset+=R===-3?2:1,A()):R!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=R}function S(R,M){const j=M||{};return j.type=R,j.start=g(),u.events.push(["enter",j,u]),l.push(j),j}function I(R){const M=l.pop();return M.end=g(),u.events.push(["exit",M,u]),M}function D(R,M){T(R,M.from)}function k(R,M){M.restore()}function C(R,M){return j;function j(z,W,q){let H,$,J,O;return Array.isArray(z)?G(z):"tokenize"in z?G([z]):V(z);function V(Se){return we;function we(Fe){const Ze=Fe!==null&&Se[Fe],ze=Fe!==null&&Se.null,nt=[...Array.isArray(Ze)?Ze:Ze?[Ze]:[],...Array.isArray(ze)?ze:ze?[ze]:[]];return G(nt)(Fe)}}function G(Se){return H=Se,$=0,Se.length===0?q:F(Se[$])}function F(Se){return we;function we(Fe){return O=P(),J=Se,Se.partial||(u.currentConstruct=Se),Se.name&&u.parser.constructs.disable.null.includes(Se.name)?Ee():Se.tokenize.call(M?Object.assign(Object.create(u),M):u,c,ue,Ee)(Fe)}}function ue(Se){return R(J,O),W}function Ee(Se){return O.restore(),++$<H.length?F(H[$]):q}}}function T(R,M){R.resolveAll&&!i.includes(R)&&i.push(R),R.resolve&&oa(u.events,M,u.events.length-M,R.resolve(u.events.slice(M),u)),R.resolveTo&&(u.events=R.resolveTo(u.events,u))}function P(){const R=g(),M=u.previous,j=u.currentConstruct,z=u.events.length,W=Array.from(l);return{from:z,restore:q};function q(){r=R,u.previous=M,u.currentConstruct=j,u.events.length=z,l=W,A()}}function A(){r.line in s&&r.column<2&&(r.column=s[r.line],r.offset+=s[r.line]-1)}}function APe(t,e){const n=e.start._index,r=e.start._bufferIndex,s=e.end._index,i=e.end._bufferIndex;let o;if(n===s)o=[t[n].slice(r,i)];else{if(o=t.slice(n,s),r>-1){const l=o[0];typeof l=="string"?o[0]=l.slice(r):o.shift()}i>0&&o.push(t[s].slice(0,i))}return o}function kPe(t,e){let n=-1;const r=[];let s;for(;++n<t.length;){const i=t[n];let o;if(typeof i=="string")o=i;else switch(i){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=e?" ":"	";break}case-1:{if(!e&&s)continue;o=" ";break}default:o=String.fromCharCode(i)}s=i===-2,r.push(o)}return r.join("")}function RPe(t){const r={constructs:$Ie([NPe,...(t||{}).extensions||[]]),content:s(qIe),defined:[],document:s(YIe),flow:s(fPe),lazy:{},string:s(gPe),text:s(yPe)};return r;function s(i){return o;function o(l){return PPe(r,i,l)}}}function jPe(t){for(;!xH(t););return t}const qL=/[\0\t\n\r]/g;function DPe(){let t=1,e="",n=!0,r;return s;function s(i,o,l){const c=[];let u,d,h,f,m;for(i=e+(typeof i=="string"?i.toString():new TextDecoder(o||void 0).decode(i)),h=0,e="",n&&(i.charCodeAt(0)===65279&&h++,n=void 0);h<i.length;){if(qL.lastIndex=h,u=qL.exec(i),f=u&&u.index!==void 0?u.index:i.length,m=i.charCodeAt(f),!u){e=i.slice(h);break}if(m===10&&h===f&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),h<f&&(c.push(i.slice(h,f)),t+=f-h),m){case 0:{c.push(65533),t++;break}case 9:{for(d=Math.ceil(t/4)*4,c.push(-2);t++<d;)c.push(-1);break}case 10:{c.push(-4),t=1;break}default:r=!0,t=1}h=f+1}return l&&(r&&c.push(-5),e&&c.push(e),c.push(null)),c}}const MPe=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function LPe(t){return t.replace(MPe,FPe)}function FPe(t,e,n){if(e)return e;if(n.charCodeAt(0)===35){const s=n.charCodeAt(1),i=s===120||s===88;return mH(n.slice(i?2:1),i?16:10)}return yA(n)||t}const EH={}.hasOwnProperty;function OPe(t,e,n){return typeof e!="string"&&(n=e,e=void 0),$Pe(n)(jPe(RPe(n).document().write(DPe()(t,e,!0))))}function $Pe(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(Ft),autolinkProtocol:P,autolinkEmail:P,atxHeading:i(Ae),blockQuote:i(ze),characterEscape:P,characterReference:P,codeFenced:i(nt),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:i(nt,o),codeText:i(qe,o),codeTextData:P,data:P,codeFlowValue:P,definition:i(yt),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:i(Le),hardBreakEscape:i(pt),hardBreakTrailing:i(pt),htmlFlow:i(mt,o),htmlFlowData:P,htmlText:i(mt,o),htmlTextData:P,image:i(Ht),label:o,link:i(Ft),listItem:i(Tn),listItemValue:f,listOrdered:i(nn,h),listUnordered:i(nn),paragraph:i(gn),reference:F,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:i(Ae),strong:i(Qe),thematicBreak:i(ct)},exit:{atxHeading:c(),atxHeadingSequence:D,autolink:c(),autolinkEmail:Ze,autolinkProtocol:Fe,blockQuote:c(),characterEscapeValue:A,characterReferenceMarkerHexadecimal:Ee,characterReferenceMarkerNumeric:Ee,characterReferenceValue:Se,characterReference:we,codeFenced:c(E),codeFencedFence:x,codeFencedFenceInfo:m,codeFencedFenceMeta:g,codeFlowValue:A,codeIndented:c(v),codeText:c(W),codeTextData:A,data:A,definition:c(),definitionDestinationString:I,definitionLabelString:b,definitionTitleString:S,emphasis:c(),hardBreakEscape:c(M),hardBreakTrailing:c(M),htmlFlow:c(j),htmlFlowData:A,htmlText:c(z),htmlTextData:A,image:c(H),label:J,labelText:$,lineEnding:R,link:c(q),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:ue,resourceDestinationString:O,resourceTitleString:V,resource:G,setextHeading:c(T),setextHeadingLineSequence:C,setextHeadingText:k,strong:c(),thematicBreak:c()}};CH(e,(t||{}).mdastExtensions||[]);const n={};return r;function r(he){let Ie={type:"root",children:[]};const ee={stack:[Ie],tokenStack:[],config:e,enter:l,exit:u,buffer:o,resume:d,data:n},ne=[];let X=-1;for(;++X<he.length;)if(he[X][1].type==="listOrdered"||he[X][1].type==="listUnordered")if(he[X][0]==="enter")ne.push(X);else{const me=ne.pop();X=s(he,me,X)}for(X=-1;++X<he.length;){const me=e[he[X][0]];EH.call(me,he[X][1].type)&&me[he[X][1].type].call(Object.assign({sliceSerialize:he[X][2].sliceSerialize},ee),he[X][1])}if(ee.tokenStack.length>0){const me=ee.tokenStack[ee.tokenStack.length-1];(me[1]||KL).call(ee,void 0,me[0])}for(Ie.position={start:ll(he.length>0?he[0][1].start:{line:1,column:1,offset:0}),end:ll(he.length>0?he[he.length-2][1].end:{line:1,column:1,offset:0})},X=-1;++X<e.transforms.length;)Ie=e.transforms[X](Ie)||Ie;return Ie}function s(he,Ie,ee){let ne=Ie-1,X=-1,me=!1,ye,De,Oe,re;for(;++ne<=ee;){const pe=he[ne];switch(pe[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{pe[0]==="enter"?X++:X--,re=void 0;break}case"lineEndingBlank":{pe[0]==="enter"&&(ye&&!re&&!X&&!Oe&&(Oe=ne),re=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:re=void 0}if(!X&&pe[0]==="enter"&&pe[1].type==="listItemPrefix"||X===-1&&pe[0]==="exit"&&(pe[1].type==="listUnordered"||pe[1].type==="listOrdered")){if(ye){let Me=ne;for(De=void 0;Me--;){const ve=he[Me];if(ve[1].type==="lineEnding"||ve[1].type==="lineEndingBlank"){if(ve[0]==="exit")continue;De&&(he[De][1].type="lineEndingBlank",me=!0),ve[1].type="lineEnding",De=Me}else if(!(ve[1].type==="linePrefix"||ve[1].type==="blockQuotePrefix"||ve[1].type==="blockQuotePrefixWhitespace"||ve[1].type==="blockQuoteMarker"||ve[1].type==="listItemIndent"))break}Oe&&(!De||Oe<De)&&(ye._spread=!0),ye.end=Object.assign({},De?he[De][1].start:pe[1].end),he.splice(De||ne,0,["exit",ye,pe[2]]),ne++,ee++}if(pe[1].type==="listItemPrefix"){const Me={type:"listItem",_spread:!1,start:Object.assign({},pe[1].start),end:void 0};ye=Me,he.splice(ne,0,["enter",Me,pe[2]]),ne++,ee++,Oe=void 0,re=!0}}}return he[Ie][1]._spread=me,ee}function i(he,Ie){return ee;function ee(ne){l.call(this,he(ne),ne),Ie&&Ie.call(this,ne)}}function o(){this.stack.push({type:"fragment",children:[]})}function l(he,Ie,ee){this.stack[this.stack.length-1].children.push(he),this.stack.push(he),this.tokenStack.push([Ie,ee||void 0]),he.position={start:ll(Ie.start),end:void 0}}function c(he){return Ie;function Ie(ee){he&&he.call(this,ee),u.call(this,ee)}}function u(he,Ie){const ee=this.stack.pop(),ne=this.tokenStack.pop();if(ne)ne[0].type!==he.type&&(Ie?Ie.call(this,he,ne[0]):(ne[1]||KL).call(this,he,ne[0]));else throw new Error("Cannot close `"+he.type+"` ("+Jm({start:he.start,end:he.end})+"): it’s not open");ee.position.end=ll(he.end)}function d(){return FIe(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function f(he){if(this.data.expectingFirstListItemValue){const Ie=this.stack[this.stack.length-2];Ie.start=Number.parseInt(this.sliceSerialize(he),10),this.data.expectingFirstListItemValue=void 0}}function m(){const he=this.resume(),Ie=this.stack[this.stack.length-1];Ie.lang=he}function g(){const he=this.resume(),Ie=this.stack[this.stack.length-1];Ie.meta=he}function x(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function E(){const he=this.resume(),Ie=this.stack[this.stack.length-1];Ie.value=he.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function v(){const he=this.resume(),Ie=this.stack[this.stack.length-1];Ie.value=he.replace(/(\r?\n|\r)$/g,"")}function b(he){const Ie=this.resume(),ee=this.stack[this.stack.length-1];ee.label=Ie,ee.identifier=wh(this.sliceSerialize(he)).toLowerCase()}function S(){const he=this.resume(),Ie=this.stack[this.stack.length-1];Ie.title=he}function I(){const he=this.resume(),Ie=this.stack[this.stack.length-1];Ie.url=he}function D(he){const Ie=this.stack[this.stack.length-1];if(!Ie.depth){const ee=this.sliceSerialize(he).length;Ie.depth=ee}}function k(){this.data.setextHeadingSlurpLineEnding=!0}function C(he){const Ie=this.stack[this.stack.length-1];Ie.depth=this.sliceSerialize(he).codePointAt(0)===61?1:2}function T(){this.data.setextHeadingSlurpLineEnding=void 0}function P(he){const ee=this.stack[this.stack.length-1].children;let ne=ee[ee.length-1];(!ne||ne.type!=="text")&&(ne=Be(),ne.position={start:ll(he.start),end:void 0},ee.push(ne)),this.stack.push(ne)}function A(he){const Ie=this.stack.pop();Ie.value+=this.sliceSerialize(he),Ie.position.end=ll(he.end)}function R(he){const Ie=this.stack[this.stack.length-1];if(this.data.atHardBreak){const ee=Ie.children[Ie.children.length-1];ee.position.end=ll(he.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(Ie.type)&&(P.call(this,he),A.call(this,he))}function M(){this.data.atHardBreak=!0}function j(){const he=this.resume(),Ie=this.stack[this.stack.length-1];Ie.value=he}function z(){const he=this.resume(),Ie=this.stack[this.stack.length-1];Ie.value=he}function W(){const he=this.resume(),Ie=this.stack[this.stack.length-1];Ie.value=he}function q(){const he=this.stack[this.stack.length-1];if(this.data.inReference){const Ie=this.data.referenceType||"shortcut";he.type+="Reference",he.referenceType=Ie,delete he.url,delete he.title}else delete he.identifier,delete he.label;this.data.referenceType=void 0}function H(){const he=this.stack[this.stack.length-1];if(this.data.inReference){const Ie=this.data.referenceType||"shortcut";he.type+="Reference",he.referenceType=Ie,delete he.url,delete he.title}else delete he.identifier,delete he.label;this.data.referenceType=void 0}function $(he){const Ie=this.sliceSerialize(he),ee=this.stack[this.stack.length-2];ee.label=LPe(Ie),ee.identifier=wh(Ie).toLowerCase()}function J(){const he=this.stack[this.stack.length-1],Ie=this.resume(),ee=this.stack[this.stack.length-1];if(this.data.inReference=!0,ee.type==="link"){const ne=he.children;ee.children=ne}else ee.alt=Ie}function O(){const he=this.resume(),Ie=this.stack[this.stack.length-1];Ie.url=he}function V(){const he=this.resume(),Ie=this.stack[this.stack.length-1];Ie.title=he}function G(){this.data.inReference=void 0}function F(){this.data.referenceType="collapsed"}function ue(he){const Ie=this.resume(),ee=this.stack[this.stack.length-1];ee.label=Ie,ee.identifier=wh(this.sliceSerialize(he)).toLowerCase(),this.data.referenceType="full"}function Ee(he){this.data.characterReferenceType=he.type}function Se(he){const Ie=this.sliceSerialize(he),ee=this.data.characterReferenceType;let ne;ee?(ne=mH(Ie,ee==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):ne=yA(Ie);const X=this.stack[this.stack.length-1];X.value+=ne}function we(he){const Ie=this.stack.pop();Ie.position.end=ll(he.end)}function Fe(he){A.call(this,he);const Ie=this.stack[this.stack.length-1];Ie.url=this.sliceSerialize(he)}function Ze(he){A.call(this,he);const Ie=this.stack[this.stack.length-1];Ie.url="mailto:"+this.sliceSerialize(he)}function ze(){return{type:"blockquote",children:[]}}function nt(){return{type:"code",lang:null,meta:null,value:""}}function qe(){return{type:"inlineCode",value:""}}function yt(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Le(){return{type:"emphasis",children:[]}}function Ae(){return{type:"heading",depth:0,children:[]}}function pt(){return{type:"break"}}function mt(){return{type:"html",value:""}}function Ht(){return{type:"image",title:null,url:"",alt:null}}function Ft(){return{type:"link",title:null,url:"",children:[]}}function nn(he){return{type:"list",ordered:he.type==="listOrdered",start:null,spread:he._spread,children:[]}}function Tn(he){return{type:"listItem",spread:he._spread,checked:null,children:[]}}function gn(){return{type:"paragraph",children:[]}}function Qe(){return{type:"strong",children:[]}}function Be(){return{type:"text",value:""}}function ct(){return{type:"thematicBreak"}}}function ll(t){return{line:t.line,column:t.column,offset:t.offset}}function CH(t,e){let n=-1;for(;++n<e.length;){const r=e[n];Array.isArray(r)?CH(t,r):VPe(t,r)}}function VPe(t,e){let n;for(n in e)if(EH.call(e,n))switch(n){case"canContainEols":{const r=e[n];r&&t[n].push(...r);break}case"transforms":{const r=e[n];r&&t[n].push(...r);break}case"enter":case"exit":{const r=e[n];r&&Object.assign(t[n],r);break}}}function KL(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+Jm({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+Jm({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+Jm({start:e.start,end:e.end})+") is still open")}function UPe(t){const e=this;e.parser=n;function n(r){return OPe(r,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function BPe(t,e){const n={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(e),!0)};return t.patch(e,n),t.applyData(e,n)}function zPe(t,e){const n={type:"element",tagName:"br",properties:{},children:[]};return t.patch(e,n),[t.applyData(e,n),{type:"text",value:`
`}]}function GPe(t,e){const n=e.value?e.value+`
`:"",r={};e.lang&&(r.className=["language-"+e.lang]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return e.meta&&(s.data={meta:e.meta}),t.patch(e,s),s=t.applyData(e,s),s={type:"element",tagName:"pre",properties:{},children:[s]},t.patch(e,s),s}function WPe(t,e){const n={type:"element",tagName:"del",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function HPe(t,e){const n={type:"element",tagName:"em",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function qPe(t,e){const n=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),s=yf(r.toLowerCase()),i=t.footnoteOrder.indexOf(r);let o,l=t.footnoteCounts.get(r);l===void 0?(l=0,t.footnoteOrder.push(r),o=t.footnoteOrder.length):o=i+1,l+=1,t.footnoteCounts.set(r,l);const c={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+s,id:n+"fnref-"+s+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};t.patch(e,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return t.patch(e,u),t.applyData(e,u)}function KPe(t,e){const n={type:"element",tagName:"h"+e.depth,properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function YPe(t,e){if(t.options.allowDangerousHtml){const n={type:"raw",value:e.value};return t.patch(e,n),t.applyData(e,n)}}function TH(t,e){const n=e.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const s=t.all(e),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const o=s[s.length-1];return o&&o.type==="text"?o.value+=r:s.push({type:"text",value:r}),s}function JPe(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return TH(t,e);const s={src:yf(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"img",properties:s,children:[]};return t.patch(e,i),t.applyData(e,i)}function XPe(t,e){const n={src:yf(e.url)};e.alt!==null&&e.alt!==void 0&&(n.alt=e.alt),e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"img",properties:n,children:[]};return t.patch(e,r),t.applyData(e,r)}function QPe(t,e){const n={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};t.patch(e,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return t.patch(e,r),t.applyData(e,r)}function ZPe(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return TH(t,e);const s={href:yf(r.url||"")};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"a",properties:s,children:t.all(e)};return t.patch(e,i),t.applyData(e,i)}function eAe(t,e){const n={href:yf(e.url)};e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"a",properties:n,children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function tAe(t,e,n){const r=t.all(e),s=n?nAe(n):IH(e),i={},o=[];if(typeof e.checked=="boolean"){const d=r[0];let h;d&&d.type==="element"&&d.tagName==="p"?h=d:(h={type:"element",tagName:"p",properties:{},children:[]},r.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let l=-1;for(;++l<r.length;){const d=r[l];(s||l!==0||d.type!=="element"||d.tagName!=="p")&&o.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?o.push(...d.children):o.push(d)}const c=r[r.length-1];c&&(s||c.type!=="element"||c.tagName!=="p")&&o.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:i,children:o};return t.patch(e,u),t.applyData(e,u)}function nAe(t){let e=!1;if(t.type==="list"){e=t.spread||!1;const n=t.children;let r=-1;for(;!e&&++r<n.length;)e=IH(n[r])}return e}function IH(t){const e=t.spread;return e??t.children.length>1}function rAe(t,e){const n={},r=t.all(e);let s=-1;for(typeof e.start=="number"&&e.start!==1&&(n.start=e.start);++s<r.length;){const o=r[s];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const i={type:"element",tagName:e.ordered?"ol":"ul",properties:n,children:t.wrap(r,!0)};return t.patch(e,i),t.applyData(e,i)}function sAe(t,e){const n={type:"element",tagName:"p",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function iAe(t,e){const n={type:"root",children:t.wrap(t.all(e))};return t.patch(e,n),t.applyData(e,n)}function oAe(t,e){const n={type:"element",tagName:"strong",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function aAe(t,e){const n=t.all(e),r=n.shift(),s=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:t.wrap([r],!0)};t.patch(e.children[0],o),s.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:t.wrap(n,!0)},l=fA(e.children[1]),c=aH(e.children[e.children.length-1]);l&&c&&(o.position={start:l,end:c}),s.push(o)}const i={type:"element",tagName:"table",properties:{},children:t.wrap(s,!0)};return t.patch(e,i),t.applyData(e,i)}function lAe(t,e,n){const r=n?n.children:void 0,i=(r?r.indexOf(e):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,l=o?o.length:e.children.length;let c=-1;const u=[];for(;++c<l;){const h=e.children[c],f={},m=o?o[c]:void 0;m&&(f.align=m);let g={type:"element",tagName:i,properties:f,children:[]};h&&(g.children=t.all(h),t.patch(h,g),g=t.applyData(h,g)),u.push(g)}const d={type:"element",tagName:"tr",properties:{},children:t.wrap(u,!0)};return t.patch(e,d),t.applyData(e,d)}function cAe(t,e){const n={type:"element",tagName:"td",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}const YL=9,JL=32;function uAe(t){const e=String(t),n=/\r?\n|\r/g;let r=n.exec(e),s=0;const i=[];for(;r;)i.push(XL(e.slice(s,r.index),s>0,!0),r[0]),s=r.index+r[0].length,r=n.exec(e);return i.push(XL(e.slice(s),s>0,!1)),i.join("")}function XL(t,e,n){let r=0,s=t.length;if(e){let i=t.codePointAt(r);for(;i===YL||i===JL;)r++,i=t.codePointAt(r)}if(n){let i=t.codePointAt(s-1);for(;i===YL||i===JL;)s--,i=t.codePointAt(s-1)}return s>r?t.slice(r,s):""}function dAe(t,e){const n={type:"text",value:uAe(String(e.value))};return t.patch(e,n),t.applyData(e,n)}function hAe(t,e){const n={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(e,n),t.applyData(e,n)}const fAe={blockquote:BPe,break:zPe,code:GPe,delete:WPe,emphasis:HPe,footnoteReference:qPe,heading:KPe,html:YPe,imageReference:JPe,image:XPe,inlineCode:QPe,linkReference:ZPe,link:eAe,listItem:tAe,list:rAe,paragraph:sAe,root:iAe,strong:oAe,table:aAe,tableCell:cAe,tableRow:lAe,text:dAe,thematicBreak:hAe,toml:rx,yaml:rx,definition:rx,footnoteDefinition:rx};function rx(){}const NH=-1,Vb=0,Qm=1,jw=2,wA=3,bA=4,_A=5,SA=6,PH=7,AH=8,QL=typeof self=="object"?self:globalThis,mAe=(t,e)=>{const n=(s,i)=>(t.set(i,s),s),r=s=>{if(t.has(s))return t.get(s);const[i,o]=e[s];switch(i){case Vb:case NH:return n(o,s);case Qm:{const l=n([],s);for(const c of o)l.push(r(c));return l}case jw:{const l=n({},s);for(const[c,u]of o)l[r(c)]=r(u);return l}case wA:return n(new Date(o),s);case bA:{const{source:l,flags:c}=o;return n(new RegExp(l,c),s)}case _A:{const l=n(new Map,s);for(const[c,u]of o)l.set(r(c),r(u));return l}case SA:{const l=n(new Set,s);for(const c of o)l.add(r(c));return l}case PH:{const{name:l,message:c}=o;return n(new QL[l](c),s)}case AH:return n(BigInt(o),s);case"BigInt":return n(Object(BigInt(o)),s);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:l}=new Uint8Array(o);return n(new DataView(l),o)}}return n(new QL[i](o),s)};return r},ZL=t=>mAe(new Map,t)(0),_d="",{toString:pAe}={},{keys:gAe}=Object,Jf=t=>{const e=typeof t;if(e!=="object"||!t)return[Vb,e];const n=pAe.call(t).slice(8,-1);switch(n){case"Array":return[Qm,_d];case"Object":return[jw,_d];case"Date":return[wA,_d];case"RegExp":return[bA,_d];case"Map":return[_A,_d];case"Set":return[SA,_d];case"DataView":return[Qm,n]}return n.includes("Array")?[Qm,n]:n.includes("Error")?[PH,n]:[jw,n]},sx=([t,e])=>t===Vb&&(e==="function"||e==="symbol"),yAe=(t,e,n,r)=>{const s=(o,l)=>{const c=r.push(o)-1;return n.set(l,c),c},i=o=>{if(n.has(o))return n.get(o);let[l,c]=Jf(o);switch(l){case Vb:{let d=o;switch(c){case"bigint":l=AH,d=o.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+c);d=null;break;case"undefined":return s([NH],o)}return s([l,d],o)}case Qm:{if(c){let f=o;return c==="DataView"?f=new Uint8Array(o.buffer):c==="ArrayBuffer"&&(f=new Uint8Array(o)),s([c,[...f]],o)}const d=[],h=s([l,d],o);for(const f of o)d.push(i(f));return h}case jw:{if(c)switch(c){case"BigInt":return s([c,o.toString()],o);case"Boolean":case"Number":case"String":return s([c,o.valueOf()],o)}if(e&&"toJSON"in o)return i(o.toJSON());const d=[],h=s([l,d],o);for(const f of gAe(o))(t||!sx(Jf(o[f])))&&d.push([i(f),i(o[f])]);return h}case wA:return s([l,o.toISOString()],o);case bA:{const{source:d,flags:h}=o;return s([l,{source:d,flags:h}],o)}case _A:{const d=[],h=s([l,d],o);for(const[f,m]of o)(t||!(sx(Jf(f))||sx(Jf(m))))&&d.push([i(f),i(m)]);return h}case SA:{const d=[],h=s([l,d],o);for(const f of o)(t||!sx(Jf(f)))&&d.push(i(f));return h}}const{message:u}=o;return s([l,{name:c,message:u}],o)};return i},eF=(t,{json:e,lossy:n}={})=>{const r=[];return yAe(!(e||n),!!e,new Map,r)(t),r},Dw=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?ZL(eF(t,e)):structuredClone(t):(t,e)=>ZL(eF(t,e));function xAe(t,e){const n=[{type:"text",value:"↩"}];return e>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),n}function vAe(t,e){return"Back to reference "+(t+1)+(e>1?"-"+e:"")}function wAe(t){const e=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",n=t.options.footnoteBackContent||xAe,r=t.options.footnoteBackLabel||vAe,s=t.options.footnoteLabel||"Footnotes",i=t.options.footnoteLabelTagName||"h2",o=t.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<t.footnoteOrder.length;){const u=t.footnoteById.get(t.footnoteOrder[c]);if(!u)continue;const d=t.all(u),h=String(u.identifier).toUpperCase(),f=yf(h.toLowerCase());let m=0;const g=[],x=t.footnoteCounts.get(h);for(;x!==void 0&&++m<=x;){g.length>0&&g.push({type:"text",value:" "});let b=typeof n=="string"?n:n(c,m);typeof b=="string"&&(b={type:"text",value:b}),g.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+f+(m>1?"-"+m:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(c,m),className:["data-footnote-backref"]},children:Array.isArray(b)?b:[b]})}const E=d[d.length-1];if(E&&E.type==="element"&&E.tagName==="p"){const b=E.children[E.children.length-1];b&&b.type==="text"?b.value+=" ":E.children.push({type:"text",value:" "}),E.children.push(...g)}else d.push(...g);const v={type:"element",tagName:"li",properties:{id:e+"fn-"+f},children:t.wrap(d,!0)};t.patch(u,v),l.push(v)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...Dw(o),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(l,!0)},{type:"text",value:`
`}]}}const kH=function(t){if(t==null)return EAe;if(typeof t=="function")return Ub(t);if(typeof t=="object")return Array.isArray(t)?bAe(t):_Ae(t);if(typeof t=="string")return SAe(t);throw new Error("Expected function, string, or object as test")};function bAe(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=kH(t[n]);return Ub(r);function r(...s){let i=-1;for(;++i<e.length;)if(e[i].apply(this,s))return!0;return!1}}function _Ae(t){const e=t;return Ub(n);function n(r){const s=r;let i;for(i in t)if(s[i]!==e[i])return!1;return!0}}function SAe(t){return Ub(e);function e(n){return n&&n.type===t}}function Ub(t){return e;function e(n,r,s){return!!(CAe(n)&&t.call(this,n,typeof r=="number"?r:void 0,s||void 0))}}function EAe(){return!0}function CAe(t){return t!==null&&typeof t=="object"&&"type"in t}const RH=[],TAe=!0,tF=!1,IAe="skip";function NAe(t,e,n,r){let s;typeof e=="function"&&typeof n!="function"?(r=n,n=e):s=e;const i=kH(s),o=r?-1:1;l(t,void 0,[])();function l(c,u,d){const h=c&&typeof c=="object"?c:{};if(typeof h.type=="string"){const m=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(c.type+(m?"<"+m+">":""))+")"})}return f;function f(){let m=RH,g,x,E;if((!e||i(c,u,d[d.length-1]||void 0))&&(m=PAe(n(c,d)),m[0]===tF))return m;if("children"in c&&c.children){const v=c;if(v.children&&m[0]!==IAe)for(x=(r?v.children.length:-1)+o,E=d.concat(v);x>-1&&x<v.children.length;){const b=v.children[x];if(g=l(b,x,E)(),g[0]===tF)return g;x=typeof g[1]=="number"?g[1]:x+o}}return m}}}function PAe(t){return Array.isArray(t)?t:typeof t=="number"?[TAe,t]:t==null?RH:[t]}function jH(t,e,n,r){let s,i,o;typeof e=="function"&&typeof n!="function"?(i=void 0,o=e,s=n):(i=e,o=n,s=r),NAe(t,i,l,s);function l(c,u){const d=u[u.length-1],h=d?d.children.indexOf(c):void 0;return o(c,h,d)}}const LT={}.hasOwnProperty,AAe={};function kAe(t,e){const n=e||AAe,r=new Map,s=new Map,i=new Map,o={...fAe,...n.handlers},l={all:u,applyData:jAe,definitionById:r,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:o,one:c,options:n,patch:RAe,wrap:MAe};return jH(t,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const h=d.type==="definition"?r:s,f=String(d.identifier).toUpperCase();h.has(f)||h.set(f,d)}}),l;function c(d,h){const f=d.type,m=l.handlers[f];if(LT.call(l.handlers,f)&&m)return m(l,d,h);if(l.options.passThrough&&l.options.passThrough.includes(f)){if("children"in d){const{children:x,...E}=d,v=Dw(E);return v.children=l.all(d),v}return Dw(d)}return(l.options.unknownHandler||DAe)(l,d,h)}function u(d){const h=[];if("children"in d){const f=d.children;let m=-1;for(;++m<f.length;){const g=l.one(f[m],d);if(g){if(m&&f[m-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=nF(g.value)),!Array.isArray(g)&&g.type==="element")){const x=g.children[0];x&&x.type==="text"&&(x.value=nF(x.value))}Array.isArray(g)?h.push(...g):h.push(g)}}}return h}}function RAe(t,e){t.position&&(e.position=pIe(t))}function jAe(t,e){let n=e;if(t&&t.data){const r=t.data.hName,s=t.data.hChildren,i=t.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const o="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:o}}n.type==="element"&&i&&Object.assign(n.properties,Dw(i)),"children"in n&&n.children&&s!==null&&s!==void 0&&(n.children=s)}return n}function DAe(t,e){const n=e.data||{},r="value"in e&&!(LT.call(n,"hProperties")||LT.call(n,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function MAe(t,e){const n=[];let r=-1;for(e&&n.push({type:"text",value:`
`});++r<t.length;)r&&n.push({type:"text",value:`
`}),n.push(t[r]);return e&&t.length>0&&n.push({type:"text",value:`
`}),n}function nF(t){let e=0,n=t.charCodeAt(e);for(;n===9||n===32;)e++,n=t.charCodeAt(e);return t.slice(e)}function rF(t,e){const n=kAe(t,e),r=n.one(t,void 0),s=wAe(n),i=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function LAe(t,e){return t&&"run"in t?async function(n,r){const s=rF(n,{file:r,...e});await t.run(s,r)}:function(n,r){return rF(n,{file:r,...t||e})}}function sF(t){if(t)throw t}var Xx=Object.prototype.hasOwnProperty,DH=Object.prototype.toString,iF=Object.defineProperty,oF=Object.getOwnPropertyDescriptor,aF=function(e){return typeof Array.isArray=="function"?Array.isArray(e):DH.call(e)==="[object Array]"},lF=function(e){if(!e||DH.call(e)!=="[object Object]")return!1;var n=Xx.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&Xx.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;var s;for(s in e);return typeof s>"u"||Xx.call(e,s)},cF=function(e,n){iF&&n.name==="__proto__"?iF(e,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):e[n.name]=n.newValue},uF=function(e,n){if(n==="__proto__")if(Xx.call(e,n)){if(oF)return oF(e,n).value}else return;return e[n]},FAe=function t(){var e,n,r,s,i,o,l=arguments[0],c=1,u=arguments.length,d=!1;for(typeof l=="boolean"&&(d=l,l=arguments[1]||{},c=2),(l==null||typeof l!="object"&&typeof l!="function")&&(l={});c<u;++c)if(e=arguments[c],e!=null)for(n in e)r=uF(l,n),s=uF(e,n),l!==s&&(d&&s&&(lF(s)||(i=aF(s)))?(i?(i=!1,o=r&&aF(r)?r:[]):o=r&&lF(r)?r:{},cF(l,{name:n,newValue:t(d,o,s)})):typeof s<"u"&&cF(l,{name:n,newValue:s}));return l};const DS=Lw(FAe);function FT(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function OAe(){const t=[],e={run:n,use:r};return e;function n(...s){let i=-1;const o=s.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);l(null,...s);function l(c,...u){const d=t[++i];let h=-1;if(c){o(c);return}for(;++h<s.length;)(u[h]===null||u[h]===void 0)&&(u[h]=s[h]);s=u,d?$Ae(d,l)(...u):o(null,...u)}}function r(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return t.push(s),e}}function $Ae(t,e){let n;return r;function r(...o){const l=t.length>o.length;let c;l&&o.push(s);try{c=t.apply(this,o)}catch(u){const d=u;if(l&&n)throw d;return s(d)}l||(c&&c.then&&typeof c.then=="function"?c.then(i,s):c instanceof Error?s(c):i(c))}function s(o,...l){n||(n=!0,e(o,...l))}function i(o){s(null,o)}}const Do={basename:VAe,dirname:UAe,extname:BAe,join:zAe,sep:"/"};function VAe(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');Ug(t);let n=0,r=-1,s=t.length,i;if(e===void 0||e.length===0||e.length>t.length){for(;s--;)if(t.codePointAt(s)===47){if(i){n=s+1;break}}else r<0&&(i=!0,r=s+1);return r<0?"":t.slice(n,r)}if(e===t)return"";let o=-1,l=e.length-1;for(;s--;)if(t.codePointAt(s)===47){if(i){n=s+1;break}}else o<0&&(i=!0,o=s+1),l>-1&&(t.codePointAt(s)===e.codePointAt(l--)?l<0&&(r=s):(l=-1,r=o));return n===r?r=o:r<0&&(r=t.length),t.slice(n,r)}function UAe(t){if(Ug(t),t.length===0)return".";let e=-1,n=t.length,r;for(;--n;)if(t.codePointAt(n)===47){if(r){e=n;break}}else r||(r=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function BAe(t){Ug(t);let e=t.length,n=-1,r=0,s=-1,i=0,o;for(;e--;){const l=t.codePointAt(e);if(l===47){if(o){r=e+1;break}continue}n<0&&(o=!0,n=e+1),l===46?s<0?s=e:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||n<0||i===0||i===1&&s===n-1&&s===r+1?"":t.slice(s,n)}function zAe(...t){let e=-1,n;for(;++e<t.length;)Ug(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":GAe(n)}function GAe(t){Ug(t);const e=t.codePointAt(0)===47;let n=WAe(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.codePointAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function WAe(t,e){let n="",r=0,s=-1,i=0,o=-1,l,c;for(;++o<=t.length;){if(o<t.length)l=t.codePointAt(o);else{if(l===47)break;l=47}if(l===47){if(!(s===o-1||i===1))if(s!==o-1&&i===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(c=n.lastIndexOf("/"),c!==n.length-1){c<0?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}}else if(n.length>0){n="",r=0,s=o,i=0;continue}}e&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+t.slice(s+1,o):n=t.slice(s+1,o),r=o-s-1;s=o,i=0}else l===46&&i>-1?i++:i=-1}return n}function Ug(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const HAe={cwd:qAe};function qAe(){return"/"}function OT(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function KAe(t){if(typeof t=="string")t=new URL(t);else if(!OT(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return YAe(t)}function YAe(t){if(t.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.codePointAt(n)===37&&e.codePointAt(n+1)===50){const r=e.codePointAt(n+2);if(r===70||r===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(e)}const MS=["history","path","basename","stem","extname","dirname"];class MH{constructor(e){let n;e?OT(e)?n={path:e}:typeof e=="string"||JAe(e)?n={value:e}:n=e:n={},this.cwd="cwd"in n?"":HAe.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<MS.length;){const i=MS[r];i in n&&n[i]!==void 0&&n[i]!==null&&(this[i]=i==="history"?[...n[i]]:n[i])}let s;for(s in n)MS.includes(s)||(this[s]=n[s])}get basename(){return typeof this.path=="string"?Do.basename(this.path):void 0}set basename(e){FS(e,"basename"),LS(e,"basename"),this.path=Do.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?Do.dirname(this.path):void 0}set dirname(e){dF(this.basename,"dirname"),this.path=Do.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?Do.extname(this.path):void 0}set extname(e){if(LS(e,"extname"),dF(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Do.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){OT(e)&&(e=KAe(e)),FS(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?Do.basename(this.path,this.extname):void 0}set stem(e){FS(e,"stem"),LS(e,"stem"),this.path=Do.join(this.dirname||"",e+(this.extname||""))}fail(e,n,r){const s=this.message(e,n,r);throw s.fatal=!0,s}info(e,n,r){const s=this.message(e,n,r);return s.fatal=void 0,s}message(e,n,r){const s=new Rs(e,n,r);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function LS(t,e){if(t&&t.includes(Do.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+Do.sep+"`")}function FS(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function dF(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function JAe(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const XAe=function(t){const r=this.constructor.prototype,s=r[t],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,r),i},QAe={}.hasOwnProperty;class EA extends XAe{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=OAe()}copy(){const e=new EA;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];e.use(...r)}return e.data(DS(!0,{},this.namespace)),e}data(e,n){return typeof e=="string"?arguments.length===2?(VS("data",this.frozen),this.namespace[e]=n,this):QAe.call(this.namespace,e)&&this.namespace[e]||void 0:e?(VS("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const s=n.call(e,...r);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const n=ix(e),r=this.parser||this.Parser;return OS("parse",r),r(String(n),n)}process(e,n){const r=this;return this.freeze(),OS("process",this.parser||this.Parser),$S("process",this.compiler||this.Compiler),n?s(void 0,n):new Promise(s);function s(i,o){const l=ix(e),c=r.parse(l);r.run(c,l,function(d,h,f){if(d||!h||!f)return u(d);const m=h,g=r.stringify(m,f);tke(g)?f.value=g:f.result=g,u(d,f)});function u(d,h){d||!h?o(d):i?i(h):n(void 0,h)}}}processSync(e){let n=!1,r;return this.freeze(),OS("processSync",this.parser||this.Parser),$S("processSync",this.compiler||this.Compiler),this.process(e,s),fF("processSync","process",n),r;function s(i,o){n=!0,sF(i),r=o}}run(e,n,r){hF(e),this.freeze();const s=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?i(void 0,r):new Promise(i);function i(o,l){const c=ix(n);s.run(e,c,u);function u(d,h,f){const m=h||e;d?l(d):o?o(m):r(void 0,m,f)}}}runSync(e,n){let r=!1,s;return this.run(e,n,i),fF("runSync","run",r),s;function i(o,l){sF(o),s=l,r=!0}}stringify(e,n){this.freeze();const r=ix(n),s=this.compiler||this.Compiler;return $S("stringify",s),hF(e),s(e,r)}use(e,...n){const r=this.attachers,s=this.namespace;if(VS("use",this.frozen),e!=null)if(typeof e=="function")c(e,n);else if(typeof e=="object")Array.isArray(e)?l(e):o(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function i(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[d,...h]=u;c(d,h)}else o(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function o(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(u.plugins),u.settings&&(s.settings=DS(!0,s.settings,u.settings))}function l(u){let d=-1;if(u!=null)if(Array.isArray(u))for(;++d<u.length;){const h=u[d];i(h)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,d){let h=-1,f=-1;for(;++h<r.length;)if(r[h][0]===u){f=h;break}if(f===-1)r.push([u,...d]);else if(d.length>0){let[m,...g]=d;const x=r[f][1];FT(x)&&FT(m)&&(m=DS(!0,x,m)),r[f]=[u,m,...g]}}}}const ZAe=new EA().freeze();function OS(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function $S(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function VS(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function hF(t){if(!FT(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function fF(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function ix(t){return eke(t)?t:new MH(t)}function eke(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function tke(t){return typeof t=="string"||nke(t)}function nke(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const rke="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",mF=[],pF={allowDangerousHtml:!0},ske=/^(https?|ircs?|mailto|xmpp)$/i,ike=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function oke(t){const e=ake(t),n=lke(t);return cke(e.runSync(e.parse(n),n),t)}function ake(t){const e=t.rehypePlugins||mF,n=t.remarkPlugins||mF,r=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...pF}:pF;return ZAe().use(UPe).use(n).use(LAe,r).use(e)}function lke(t){const e=t.children||"",n=new MH;return typeof e=="string"&&(n.value=e),n}function cke(t,e){const n=e.allowedElements,r=e.allowElement,s=e.components,i=e.disallowedElements,o=e.skipHtml,l=e.unwrapDisallowed,c=e.urlTransform||uke;for(const d of ike)Object.hasOwn(e,d.from)&&(""+d.from+(d.to?"use `"+d.to+"` instead":"remove it")+rke+d.id,void 0);return jH(t,u),wIe(t,{Fragment:a.Fragment,components:s,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function u(d,h,f){if(d.type==="raw"&&f&&typeof h=="number")return o?f.children.splice(h,1):f.children[h]={type:"text",value:d.value},h;if(d.type==="element"){let m;for(m in kS)if(Object.hasOwn(kS,m)&&Object.hasOwn(d.properties,m)){const g=d.properties[m],x=kS[m];(x===null||x.includes(d.tagName))&&(d.properties[m]=c(String(g||""),m,d))}}if(d.type==="element"){let m=n?!n.includes(d.tagName):i?i.includes(d.tagName):!1;if(!m&&r&&typeof h=="number"&&(m=!r(d,h,f)),m&&f&&typeof h=="number")return l&&d.children?f.children.splice(h,1,...d.children):f.children.splice(h,1),h}}}function uke(t){const e=t.indexOf(":"),n=t.indexOf("?"),r=t.indexOf("#"),s=t.indexOf("/");return e===-1||s!==-1&&e>s||n!==-1&&e>n||r!==-1&&e>r||ske.test(t.slice(0,e))?t:""}const dke=({productData:t,onViewDetails:e,onAddToCart:n,onBuyNow:r,onVisualize:s})=>{if(!t)return null;const{name:i,description:o,price:l,imageUrl:c,id:u}=t;return a.jsxs(We,{className:"mb-2 w-full max-w-xs sm:max-w-sm overflow-hidden shadow-md border border-border",children:[c&&a.jsx("div",{className:"w-full h-32 sm:h-40 overflow-hidden bg-muted",children:a.jsx("img",{src:c,alt:i||"Product image",className:"w-full h-full object-contain"})}),a.jsx(ot,{className:"p-3",children:i&&a.jsx(at,{className:"text-sm sm:text-base font-semibold leading-tight line-clamp-2",children:i})}),a.jsxs(tt,{className:"p-3 pt-0 text-xs sm:text-sm",children:[o&&a.jsx(qt,{className:"mb-2 line-clamp-2 sm:line-clamp-3 text-muted-foreground",children:o}),l&&a.jsx("p",{className:"font-semibold text-sm sm:text-base",children:typeof l=="number"?`$${l.toFixed(2)}`:l}),a.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row sm:space-x-2 space-y-2 sm:space-y-0",children:[e&&a.jsx(U,{size:"sm",variant:"outline",className:"flex-1 text-xs sm:text-sm",onClick:()=>e(u,i),children:"View"}),n&&a.jsx(U,{size:"sm",variant:"secondary",className:"flex-1 text-xs sm:text-sm",onClick:()=>n(u,i),children:"Add to Cart"}),r&&a.jsx(U,{size:"sm",variant:"default",className:"flex-1 text-xs sm:text-sm",onClick:()=>r(u,i),children:"Buy Now"})]}),s&&a.jsxs(U,{size:"sm",variant:"outline",className:"w-full mt-2 text-xs sm:text-sm",onClick:()=>s(u,i),children:[a.jsx(is,{className:"mr-2 h-4 w-4"}),"Visualize with Image"]})]})]})},hke="AIzaSyA6fvf0Xgb29MloJ-JKiYJGzhv_jvPdL1Y",fke=new hr({apiKey:hke}),mke="gemini-2.0-flash-preview-image-generation";async function US(t,e){if(!t)throw new Error("Image source is undefined or null.");let n,r=e;if(typeof t=="string"&&(t.startsWith("http://")||t.startsWith("https://"))){console.log(`Fetching image from URL: ${t}`);const i=await fetch(t);if(!i.ok)throw new Error(`Failed to fetch image from ${t}: ${i.statusText}`);const o=await i.blob();r=o.type||r||"image/jpeg",n=await new Promise((l,c)=>{const u=new FileReader;u.onloadend=()=>{typeof u.result=="string"?l(u.result.split(",")[1]):c(new Error("FileReader did not return a string for URL image."))},u.onerror=d=>c(new Error(`FileReader failed for URL image: ${d}`)),u.readAsDataURL(o)})}else if(typeof t=="string"&&t.startsWith("data:")){console.log("Processing Data URL image.");try{const i=t.split(",");if(i.length<2)throw new Error("Invalid data URL structure.");const o=i[0];n=i[1];const l=o.match(/:(.*?);/);if(!l||!l[1])throw new Error("Could not parse MIME type from data URL.");r=l[1]}catch(i){throw console.error("Error parsing data URL:",t,i),new Error(`Invalid data URL format: ${i.message}`)}}else if(typeof File<"u"&&t instanceof File)console.log(`Processing File object: ${t.name}`),r=t.type,n=await new Promise((i,o)=>{const l=new FileReader;l.onloadend=()=>{typeof l.result=="string"?i(l.result.split(",")[1]):o(new Error("FileReader did not return a string for File object."))},l.onerror=c=>o(new Error(`FileReader failed for File object: ${c}`)),l.readAsDataURL(t)});else if(typeof t=="string"){console.warn(`Received string imageSource that is not a URL or Data URL: "${t}". This path is intended for Node.js file paths.`);try{console.log(`Attempting to read image from local path (Node.js context): ${t}`),n=(await(await jt(()=>import("./__vite-browser-external-b25bb000.js"),[])).readFile(t)).toString("base64");const c=(await jt(()=>import("./__vite-browser-external-b25bb000.js"),[])).extname(t).toLowerCase();if(!r)if(c===".png")r="image/png";else if(c===".jpg"||c===".jpeg")r="image/jpeg";else if(c===".webp")r="image/webp";else if(c===".gif")r="image/gif";else throw new Error(`Unsupported image extension or MIME type not provided for path: ${t}`)}catch(i){throw console.error("Failed to process string as Node.js file path (this is expected in browser):",i),new Error("Unsupported string imageSource in browser. Must be URL or Data URL, or provide a File object.")}}else throw new Error("Unsupported image source type. Provide a URL, Data URL, or File object.");if(!n)throw new Error("Could not obtain base64 image data.");r||(r="image/jpeg",console.warn("MIME type could not be determined, defaulting to image/jpeg."));const s=["image/png","image/jpeg","image/webp","image/heic","image/heif"];return s.includes(r)||console.warn(`MIME type ${r} may not be optimally supported. Supported types are: ${s.join(", ")}.`),{inlineData:{data:n,mimeType:r}}}async function LH({mainProduct:t,referenceSceneSource:e,additionalProducts:n=[],customInstructions:r=""}){var o,l,c,u,d,h,f,m;if(!t||!t.name||!t.imageSource)throw new Error("Main product with name and imageSource is required.");if(!e)throw new Error("Reference scene imageSource is required.");const s=[];let i=`Visually integrate the product named "${t.name}" into a scene inspired by the provided reference scene image.
The main product is described as: "${t.description||"Not specified"}".
The reference scene image sets the style, lighting, and overall environment.
Make the main product the primary focus, well-lit, and naturally fitting the scene's perspective.
`;n.length>0&&(i+=`
Also, incorporate the following additional products naturally into the scene:
`,n.forEach((g,x)=>{i+=`- Product ${x+1}: "${g.name}" (Description: "${g.description||"Not specified"}")
`})),r.trim()!==""&&(i+=`
Specific User Instructions: "${r.trim()}"
`),i+=`
Please generate a high-quality, photorealistic image based on these instructions and the provided images. Also provide a brief text commentary about the generated image or any challenges encountered.`,s.push({text:i});try{s.push(await US(e)),s.push(await US(t.imageSource));for(const g of n)if(g.imageSource)try{s.push(await US(g.imageSource))}catch(x){console.warn(`Could not process image for additional product "${g.name}": ${x.message}. Skipping this image.`)}}catch(g){throw new Error(`Failed to process one or more input images: ${g.message}`)}console.log("Constructed prompt parts. Total parts:",s.length);try{const g=await fke.models.generateContent({model:mke,contents:[{role:"user",parts:s}],generationConfig:{temperature:.6,candidateCount:1},safetySettings:[{category:xr.HARM_CATEGORY_HARASSMENT,threshold:vr.BLOCK_MEDIUM_AND_ABOVE},{category:xr.HARM_CATEGORY_HATE_SPEECH,threshold:vr.BLOCK_MEDIUM_AND_ABOVE},{category:xr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:vr.BLOCK_MEDIUM_AND_ABOVE},{category:xr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:vr.BLOCK_MEDIUM_AND_ABOVE}],config:{responseModalities:[Dn.TEXT,Dn.IMAGE]}}),x=g;if(!x)throw console.error("Full API result from Gemini was undefined:",g),new Error("Invalid or empty response from Gemini API.");let E=null,v="No specific commentary from the model.";console.log("Full API response from Gemini:",JSON.stringify(x,null,2)),(o=x.promptFeedback)!=null&&o.blockReason&&(v=`Image generation may have been blocked. Reason: ${x.promptFeedback.blockReason}.`,console.warn(v));const b=(l=x.candidates)==null?void 0:l[0];if(b){if(b.finishReason&&b.finishReason!=="STOP"&&b.finishReason!=="MAX_TOKENS"){const S=`Generation stopped. Reason: ${b.finishReason}.`;v=v==="No specific commentary from the model."?S:`${v}. ${S}`,console.warn(S)}if(((u=(c=b.content)==null?void 0:c.parts)==null?void 0:u.length)>0)for(const S of b.content.parts)S.text?v=v==="No specific commentary from the model."||!v.includes(S.text)?v==="No specific commentary from the model."?S.text:v+" "+S.text:v:(h=(d=S.inlineData)==null?void 0:d.mimeType)!=null&&h.startsWith("image/")&&(E=`data:${S.inlineData.mimeType};base64,${S.inlineData.data}`,console.log(`Image generated successfully. MIME type: ${S.inlineData.mimeType}`))}else(f=x.promptFeedback)!=null&&f.blockReason||(v=v==="No specific commentary from the model."?"No candidates returned by the model.":`${v}. Also, no candidates were returned.`);return!E&&v==="No specific commentary from the model."&&(v="Image generation failed, and no specific reason or commentary was provided."),{imageUrl:E,commentary:v,promptUsed:i}}catch(g){console.error("Error during Gemini API call or response processing:",g);let x=g.message;throw(m=g.response)!=null&&m.message?x=g.response.message:g.response&&(x=JSON.stringify(g.response)),new Error(`Product visualization failed: ${x}`)}}rA("pk_live_51NAoUjDktew9heHOJD5Px4jn1IaolhvVvqoE6NukJV7MxZa8PhIVSwcOVWXdQx6MFNgIGmEYeg64lFUGlYfAyVqu004n16tAdG");const FH=()=>{var Oe;const t=di(),{currentStore:e,addToCart:n,getProductById:r,updateQuantity:s,viewMode:i}=Fn(),{userRole:o}=ro(),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[h,f]=p.useState('You are a friendly and helpful AI assistant for an e-commerce store. Be concise and helpful. Always format your responses using Markdown. If a user asks you to find a product, your primary action should be to use the `find_and_open_product` function. **Only after the `find_and_open_product` function successfully returns product details (indicated by `product_found: true` in the function\'s result) should you then say something like "Here is the product I found for you:".** At that point, a product card will also be displayed by the UI. Following your acknowledgment, you MUST ask a relevant follow-up question, such as "Would you like to see more details, add it to your cart, or keep browsing?". If the function call indicates the product was not found (`product_found: false`), you should inform the user you could not find the product and offer to search again or help with something else. Do not repeat raw product data (like image URLs or full product objects) in your text response, as the card already displays this information.'),[m,g]=p.useState(""),[x,E]=p.useState([]),[v,b]=p.useState(null),[S,I]=p.useState(null),[D,k]=p.useState(!1),[C,T]=p.useState(null),P=p.useRef(null),A=p.useRef([]),R=p.useRef(null),M=p.useRef(null),[j,z]=p.useState(null),[W,q]=p.useState(!1),H=p.useRef(!1),$={name:"find_and_open_product",description:"Finds a product based on a query (name, keywords, or ID) and returns its details for display. It does NOT navigate. After displaying, ask if the user wants to navigate or add to cart.",parameters:{type:Xe.OBJECT,properties:{product_query:{type:Xe.STRING,description:"The name, keywords, or ID of the product to find."}},required:["product_query"]}},J={name:"navigate_to_product_detail_page",description:"Navigates the user to the detailed page for a specific product, given its ID.",parameters:{type:Xe.OBJECT,properties:{product_id:{type:Xe.STRING,description:"The unique ID of the product."},product_name:{type:Xe.STRING,description:"The name of the product (for confirmation)."}},required:["product_id"]}},O={name:"add_to_cart",description:"Adds a specified product to the user's shopping cart.",parameters:{type:Xe.OBJECT,properties:{product_id:{type:Xe.STRING,description:"The unique ID of the product to add."},product_name:{type:Xe.STRING,description:"The name of the product (for confirmation)."},quantity:{type:Xe.NUMBER,description:"The quantity to add. Defaults to 1 if not specified."}},required:["product_id"]}},V={name:"initiate_purchase",description:"Initiates the purchase process for a specified product, potentially by adding to cart and navigating to checkout or directly to a payment page.",parameters:{type:Xe.OBJECT,properties:{product_id:{type:Xe.STRING,description:"The unique ID of the product to purchase."},product_name:{type:Xe.STRING,description:"The name of the product (for confirmation)."}},required:["product_id"]}},G={name:"navigate_home",description:`Navigates the user to the application's home page (typically the root path "/").`,parameters:{type:Xe.OBJECT,properties:{}}},F={name:"navigate_to_content_creation_page",description:"Navigates the user to the content creation page.",parameters:{type:Xe.OBJECT,properties:{}}},ue={name:"navigate_to_store_dashboard",description:"Navigates the user to the store dashboard page.",parameters:{type:Xe.OBJECT,properties:{}}},Ee={name:"navigate_to_route",description:'Navigates the user to a specified route within the application. Use for requests like "go to a specific page". This is a generic navigation tool.',parameters:{type:Xe.OBJECT,properties:{route:{type:Xe.STRING,description:'The path to navigate to (e.g., "/", "/content-creation", "/dashboard").'}},required:["route"]}},Se={name:"toggle_theme_mode",description:"Toggles the application's visual theme between light and dark mode.",parameters:{type:Xe.OBJECT,properties:{}}},we={name:"open_import_store_dialog",description:"Opens the dialog or interface for importing a store from another platform.",parameters:{type:Xe.OBJECT,properties:{}}},Fe={name:"go_to_cart",description:"Navigates the user to their shopping cart page.",parameters:{type:Xe.OBJECT,properties:{}}},Ze=[$,J,O,V,Ee,Se,we,Fe,G,F,ue],ze=()=>{var re;(re=R.current)==null||re.scrollIntoView({behavior:"smooth"})};p.useEffect(ze,[x]);const nt=()=>c(!l),qe=()=>d(!u),yt=()=>{d(!1)},Le=(re=null)=>{const pe=typeof re=="string"?re:m;if(pe.trim()==="")return;const Me=`user-text-${Date.now()}`;E(ve=>[...ve,{id:Me,role:"user",text:pe}]),typeof re!="string"&&g(""),v==="gemini"&&S?Ae(pe):console.error("Error: Gemini chat not active. Cannot send message.")},Ae=async re=>{if(!S){console.error("Gemini chat not initialized.");return}try{const pe=await S.sendMessageStream({message:[{text:re}]}),Me=`assistant-gemini-${Date.now()}`;E(wt=>[...wt,{id:Me,role:"assistant",text:"",functionCallData:null}]);let ve="",gt=null;for await(const wt of pe){let dt=null;wt.functionCalls&&wt.functionCalls.length>0?dt=wt.functionCalls[0]:wt.functionCall&&(dt=wt.functionCall),dt&&(gt=dt);const xt=wt.text;xt&&(ve+=xt,E(At=>At.map(Nn=>Nn.id===Me?{...Nn,text:ve}:Nn)))}gt?(E(wt=>wt.map(dt=>{if(dt.id===Me){let xt=`(Function call: ${gt.name})`;gt.name==="find_and_open_product"&&(xt="Searching for product…");const At=ve.trim()===""?xt:`${ve}
${xt}`;return{...dt,text:At,functionCallData:gt}}return dt})),await Be(gt,Me)):ve.trim()!==""||E(wt=>wt.map(dt=>dt.id===Me?{...dt,text:"(Assistant responded without text)"}:dt))}catch(pe){console.error("Error sending/receiving Gemini message:",pe)}},pt=re=>{const pe=re.route;if(pe)try{return t(pe),{success:!0,detail:`Successfully navigated to ${pe}`}}catch(Me){return console.error("Navigation error:",Me),{success:!1,detail:`Failed to navigate: ${Me.message}`}}return{success:!1,detail:"Route not provided in arguments."}},mt=re=>({success:!0,detail:"Theme toggled (placeholder action)."}),Ht=re=>({success:!0,detail:"Import store dialog would be shown (placeholder action)."}),Ft=re=>{try{return t("/cart"),{success:!0,detail:"Navigated to cart page."}}catch(pe){return console.error("Navigation to cart error:",pe),{success:!1,detail:`Failed to navigate to cart: ${pe.message}`}}},nn=re=>{var gt,wt,dt,xt,At,Nn,on,_r,Gn;const pe=(gt=re.product_query)==null?void 0:gt.toLowerCase().trim();if(!pe)return{success:!0,product_found:!1,detail:"Product query not provided."};if(!e||!e.products||e.products.length===0)return{success:!0,product_found:!1,detail:"No products available in the current store to search."};const Me=e.products;let ve=null;if(ve=Me.find(Jt=>{var an;return((an=Jt.name)==null?void 0:an.toLowerCase())===pe}),!ve){const Jt=pe.split(/\s+/).filter(an=>an.length>1);if(Jt.length>0){let an=Me.map(Mn=>{var ke,Ve;const K=((ke=Mn.name)==null?void 0:ke.toLowerCase())||"",te=((Ve=Mn.description)==null?void 0:Ve.toLowerCase())||"";let ce=0;return Jt.forEach(Y=>{K.includes(Y)&&(ce+=2),te.includes(Y)&&(ce+=1)}),K.includes(pe)&&(ce+=5),te.includes(pe)&&(ce+=2),{product:Mn,score:ce}});an=an.filter(Mn=>Mn.score>0).sort((Mn,K)=>K.score-Mn.score),an.length>0&&(ve=an[0].product)}}if(ve||/^[a-zA-Z0-9-_]+$/.test(pe)&&!pe.includes(" ")&&(ve=Me.find(Jt=>{var an;return((an=Jt.id)==null?void 0:an.toString())===pe})),ve){let Jt=null;return(dt=(wt=ve.image)==null?void 0:wt.src)!=null&&dt.large&&typeof ve.image.src.large=="string"?Jt=ve.image.src.large:(At=(xt=ve.image)==null?void 0:xt.src)!=null&&At.medium&&typeof ve.image.src.medium=="string"?Jt=ve.image.src.medium:(on=(Nn=ve.image)==null?void 0:Nn.src)!=null&&on.small&&typeof ve.image.src.small=="string"?Jt=ve.image.src.small:ve.image_url&&typeof ve.image_url=="string"?Jt=ve.image_url:ve.imageUrl&&typeof ve.imageUrl=="string"?Jt=ve.imageUrl:ve.image&&typeof ve.image=="string"?Jt=ve.image:ve.images&&Array.isArray(ve.images)&&ve.images.length>0&&((_r=ve.images[0])!=null&&_r.src)&&typeof ve.images[0].src=="string"?Jt=ve.images[0].src:(Gn=ve.featuredImage)!=null&&Gn.url&&typeof ve.featuredImage.url=="string"&&(Jt=ve.featuredImage.url),Jt&&typeof Jt=="string"&&Jt.trim()!==""?Jt=Jt.trim():Jt=null,{success:!0,product_found:!0,product_data:{id:ve.id,name:ve.name,description:ve.description||"No description available.",price:ve.price||"Price not available.",imageUrl:Jt},detail:`Found product: ${ve.name}`}}else return{success:!0,product_found:!1,detail:`Could not find a matching or relevant product for query: "${re.product_query}"`}},Tn=re=>re.product_id&&e&&e.id?(t(`/store/${e.id}/product/${re.product_id}`),{success:!0,detail:`Navigated to product page for ID ${re.product_id} in store ${e.id}`}):!e||!e.id?{success:!1,detail:"Current store information is not available for navigation."}:{success:!1,detail:"Product ID not provided for navigation."},gn=re=>{if(!e||!e.id)return{success:!1,detail:"Current store not available for cart operation."};if(!re.product_id)return{success:!1,detail:"Product ID not provided to add to cart."};const pe=r(e.id,re.product_id);if(pe){const Me=re.quantity||1;return n(pe,e.id),Me>1&&s(re.product_id,e.id,Me),{success:!0,detail:`${re.product_name||pe.name||"Product"} added/updated in cart with quantity ${Me}.`}}else return{success:!1,detail:`Product with ID ${re.product_id} not found.`}},Qe=re=>{const{product_id:pe,product_name:Me}=re;if(!e||!e.id)return console.error("Buy Now: Current store not available."),{success:!1,detail:"Current store information is not available to initiate purchase."};if(!pe)return console.error("Buy Now: Product ID not provided."),{success:!1,detail:"Product ID not provided."};const ve=r(e.id,pe);if(!ve)return console.error(`Buy Now: Product with ID ${pe} not found.`),{success:!1,detail:`Product with ID ${pe} not found.`};try{return n(ve,e.id),t("/checkout",{state:{action:"buyNow",productToAddId:ve.id,storeId:e.id}}),{success:!0,detail:`Added ${ve.name||"product"} to cart and navigated to checkout.`}}catch(gt){return console.error("Error during Buy Now (add to cart & navigate) process:",gt),{success:!1,detail:gt.message||"Could not process Buy Now action."}}},Be=async(re,pe)=>{let Me,ve=!1;switch(re.name){case"navigate_to_route":Me=pt(re.args),ve=Me.success;break;case"toggle_theme_mode":Me=mt(re.args),ve=Me.success;break;case"open_import_store_dialog":Me=Ht(re.args),ve=Me.success;break;case"go_to_cart":Me=Ft(re.args),ve=Me.success;break;case"navigate_home":Me=pt({route:"/"}),ve=Me.success;break;case"navigate_to_content_creation_page":Me=pt({route:"/content-creation"}),ve=Me.success;break;case"navigate_to_store_dashboard":Me=pt({route:"/dashboard"}),ve=Me.success;break;case"find_and_open_product":Me=nn(re.args),ve=Me.success;break;case"navigate_to_product_detail_page":Me=Tn(re.args),ve=Me.success;break;case"add_to_cart":Me=gn(re.args),ve=Me.success;break;case"initiate_purchase":Me=Qe(re.args),ve=Me.success;break;default:Me={success:!1,detail:`Error: Unknown function ${re.name}`}}if(!ve){console.error(`Function ${re.name} execution failed: ${Me.detail}`),E(wt=>wt.map(dt=>dt.id===pe?{...dt,text:(dt.text.replace(/\(Function call: .*\)/,"").trim()+`
(Function ${re.name} failed)`).trim(),functionCallData:null}:dt));return}const gt={message:[{functionResponse:{name:re.name,response:{result:Me}}}]};try{const wt=await S.sendMessageStream(gt);let dt="";E(xt=>xt.map(At=>At.id===pe?{...At,text:"",functionCallData:null,productCardData:null}:At));for await(const xt of wt){if(xt.functionCalls||xt.functionCall){console.error("Model attempted another function call immediately after a function response.");break}const At=xt.text;At&&(dt+=At,E(Nn=>Nn.map(on=>{if(on.id===pe){const _r={...on,text:dt};return re.name==="find_and_open_product"&&Me.success&&Me.product_found&&(_r.productCardData=Me.product_data),_r}return on})))}re.name==="find_and_open_product"&&Me.success&&Me.product_found&&E(xt=>xt.map(At=>At.id===pe?{...At,productCardData:Me.product_data}:At)),dt.trim()===""&&(re.name==="find_and_open_product"&&Me.product_found?E(xt=>xt.map(At=>At.id===pe&&At.text.trim()===""?{...At,text:"Here is the product information:"}:At)):E(xt=>xt.map(At=>At.id===pe&&At.text.trim()===""?{...At,text:"(Function processed)"}:At)))}catch(wt){console.error("Error sending function response or getting final response from Gemini:",wt),E(dt=>dt.map(xt=>xt.id===pe?{...xt,text:(xt.text+`
(Error processing function result)`).trim(),functionCallData:null}:xt))}},ct=async()=>{if(S||W)return;q(!0);const re="AIzaSyA6fvf0Xgb29MloJ-JKiYJGzhv_jvPdL1Y";try{const pe=new hr({apiKey:re}),ve=x.filter(dt=>dt.role==="user"||dt.role==="assistant").map(dt=>({role:dt.role==="assistant"?"model":"user",parts:[{text:dt.text||""}]})).filter(dt=>dt.parts.every(xt=>typeof xt.text=="string"&&xt.text.trim()!=="")),gt={tools:[{functionDeclarations:Ze}],systemInstruction:h},wt=pe.chats.create({model:"gemini-2.0-flash",history:ve,config:gt,generationConfig:{}});if(!wt)throw new Error("genAI.chats.create() returned a null or undefined chat instance.");I(wt),b("gemini"),H.current=!1}catch(pe){console.error("Error initializing Gemini chat:",pe),I(null),b(null)}finally{q(!1)}},he=()=>{I(null),q(!1),b(null),H.current=!1};p.useEffect(()=>(l?!S&&!W&&ct():he(),()=>he()),[l]),p.useEffect(()=>{v==="gemini"?H.current?h&&!W&&S&&(I(null),H.current=!1,ct()):H.current=!0:H.current=!1},[h,v,W,S]);const Ie=(re,pe)=>{Tn({product_id:re})},ee=(re,pe)=>{if(!e||!e.id){console.error("Cannot add to cart: current store not available.");return}const Me=r(e.id,re);Me?n(Me,e.id):console.error(`Product with ID ${re} not found, cannot add to cart.`)},ne=async(re,pe)=>{const Me=await Qe({product_id:re,product_name:pe});Me.success||console.error("Buy Now failed:",Me.detail)},X=(re,pe)=>{var Me;z({id:re,name:pe}),(Me=M.current)==null||Me.click()},me=re=>{var Me,ve,gt,wt,dt,xt,At,Nn;if(!re)return null;let pe=null;return(ve=(Me=re.image)==null?void 0:Me.src)!=null&&ve.large&&typeof re.image.src.large=="string"?pe=re.image.src.large:(wt=(gt=re.image)==null?void 0:gt.src)!=null&&wt.medium&&typeof re.image.src.medium=="string"?pe=re.image.src.medium:(xt=(dt=re.image)==null?void 0:dt.src)!=null&&xt.small&&typeof re.image.src.small=="string"?pe=re.image.src.small:re.image_url&&typeof re.image_url=="string"?pe=re.image_url:re.imageUrl&&typeof re.imageUrl=="string"?pe=re.imageUrl:re.image&&typeof re.image=="string"?pe=re.image:re.images&&Array.isArray(re.images)&&re.images.length>0&&((At=re.images[0])!=null&&At.src)?pe=re.images[0].src:(Nn=re.featuredImage)!=null&&Nn.url&&(pe=re.featuredImage.url),pe&&typeof pe=="string"&&pe.trim()!==""?pe.trim():null},ye=async re=>{var Me;const pe=(Me=re.target.files)==null?void 0:Me[0];if(!pe||!j){z(null),M.current&&(M.current.value="");return}E(ve=>[...ve,{id:`system-visualizing-${Date.now()}`,role:"system",text:`Visualizing ${j.name} with your uploaded image. This may take a moment...`}]);try{console.log("[ChatViz] Getting product details for ID:",j.id);const ve=r(e.id,j.id);if(!ve)throw console.error("[ChatViz] Product not found for ID:",j.id),new Error("Product details not found for visualization.");console.log("[ChatViz] Product found:",ve.name);const gt=me(ve);if(!gt)throw console.error("[ChatViz] Product actual image URL is missing or invalid for product:",ve.name,"Raw product data:",ve),new Error("Product does not have a valid existing image to use for visualization context.");console.log("[ChatViz] Actual Product imageUrl to use:",gt);const wt={name:ve.name,description:ve.description,imageSource:gt},dt=`Visualize the product "${ve.name}" in a new scene inspired by the provided reference image. Focus on a creative and appealing composition.`;console.log("[ChatViz] Calling generateProductVisualization...");const xt=await LH({mainProduct:wt,referenceSceneSource:pe,additionalProducts:[],customInstructions:dt});if(console.log("[ChatViz] generateProductVisualization result:",xt),xt&&xt.imageUrl)E(At=>[...At,{id:`assistant-viz-${Date.now()}`,role:"assistant",text:xt.commentary||`Here's a new visualization for ${ve.name}:`,imageDataUrl:xt.imageUrl}]);else throw console.error("[ChatViz] generateProductVisualization did not return an imageUrl. Commentary:",xt==null?void 0:xt.commentary),new Error((xt==null?void 0:xt.commentary)||"Visualization did not return an image.")}catch(ve){console.error("Error during visualization in chat:",ve.name,ve.message,ve.stack),E(gt=>[...gt,{id:`error-viz-${Date.now()}`,role:"system",text:`Sorry, I couldn't visualize the product. Error: ${ve.name} - ${ve.message}`}])}finally{z(null),M.current&&(M.current.value="")}},De=async()=>{if(D)P.current&&P.current.state==="recording"&&P.current.stop(),k(!1);else try{const re=await navigator.mediaDevices.getUserMedia({audio:!0});P.current=new MediaRecorder(re),A.current=[],P.current.ondataavailable=pe=>{A.current.push(pe.data)},P.current.onstop=async()=>{const pe=new Blob(A.current,{type:"audio/webm"});A.current=[],console.log("Audio recorded:",pe),E(Me=>[...Me,{id:`user-audio-${Date.now()}`,role:"user",text:"[User sent audio]"}]),setTimeout(()=>{const Me=`assistant-audio-${Date.now()}`;E(ve=>[...ve,{id:Me,role:"assistant",text:"[Assistant audio response]"}])},2e3)},P.current.start(),k(!0),E(pe=>[...pe,{id:`system-rec-${Date.now()}`,role:"system",text:"Recording started..."}])}catch(re){console.error("Error accessing microphone:",re),E(pe=>[...pe,{id:`error-mic-${Date.now()}`,role:"system",text:"Error: Could not access microphone."}])}};return p.useEffect(()=>()=>{C&&C.context.state!=="closed"&&C.context.close(),P.current&&P.current.stream&&P.current.stream.getTracks().forEach(re=>re.stop())},[C]),a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"file",ref:M,style:{display:"none"},accept:"image/*",onChange:ye}),!l&&a.jsx(U,{onClick:nt,className:"fixed bottom-[96px] right-0 py-4 pl-4 pr-1.5 shadow-lg z-50 rounded-tl-[20px] rounded-bl-[20px] rounded-tr-none rounded-br-none",size:"icon","aria-label":"Open Chatbot",style:{backgroundColor:((Oe=e==null?void 0:e.theme)==null?void 0:Oe.primaryColor)||"#007bff"},children:a.jsx(oie,{size:20})}),l&&a.jsxs(We,{className:"fixed bottom-[96px] right-4 w-full max-w-md h-[70vh] max-h-[600px] shadow-xl z-[1000] flex flex-col bg-background border rounded-lg",children:[a.jsxs(ot,{className:"flex flex-row items-center justify-between p-3 border-b",children:[a.jsx(at,{className:"text-md font-semibold",children:"Gemini Assistant"}),a.jsxs("div",{className:"flex items-center gap-1",children:[(o==="admin"||i==="edit")&&a.jsx(U,{variant:"ghost",size:"icon",onClick:qe,title:"Set Knowledge Base",children:a.jsx(yie,{size:18})}),a.jsx(U,{variant:"ghost",size:"icon",onClick:nt,title:"Close Chat",children:a.jsx(ra,{size:18})})]})]}),u&&a.jsxs("div",{className:"p-3 border-b bg-muted/40",children:[a.jsx("label",{htmlFor:"knowledgeBaseInput",className:"text-xs font-medium mb-1 block text-muted-foreground",children:"Knowledge Base (Instructions for Gemini)"}),a.jsx(Vn,{id:"knowledgeBaseInput",placeholder:"Enter instructions for the assistant...",value:h,onChange:re=>f(re.target.value),className:"h-28 text-xs mb-2 rounded-md"}),a.jsx(U,{onClick:yt,size:"sm",className:"w-full",disabled:W||!S,children:"Save & Apply Instructions"})]}),a.jsxs(tt,{className:"flex-grow p-3 overflow-y-auto space-y-3",children:[x.map(re=>(re.role==="user"||re.role==="assistant")&&a.jsx("div",{className:`flex flex-col ${re.role==="user"?"items-end":"items-start"}`,children:a.jsx("div",{className:`max-w-[80%] p-2.5 rounded-lg text-sm ${re.role==="user"?"bg-primary text-primary-foreground rounded-br-none":"bg-muted rounded-bl-none"}`,children:re.role==="assistant"?a.jsxs(a.Fragment,{children:[re.productCardData&&a.jsx(dke,{productData:re.productCardData,onViewDetails:Ie,onAddToCart:ee,onBuyNow:ne,onVisualize:re.productCardData.imageUrl&&typeof re.productCardData.imageUrl=="string"&&re.productCardData.imageUrl.trim()!==""?X:null}),re.imageDataUrl&&a.jsx("img",{src:re.imageDataUrl,alt:"Generated visualization",className:"max-w-full h-auto rounded-md my-2"}),re.text&&a.jsx("div",{className:`prose prose-sm max-w-none dark:prose-invert ${re.productCardData||re.imageDataUrl?"mt-2":""}`,children:a.jsx(oke,{children:re.text})}),!re.productCardData&&!re.text&&!re.imageDataUrl&&a.jsx("p",{className:"whitespace-pre-wrap",children:"(Assistant message)"})]}):a.jsx("p",{className:"whitespace-pre-wrap",children:re.text})})},re.id)),a.jsx("div",{ref:R})]}),a.jsx(Yu,{className:"p-3 border-t",children:a.jsxs("div",{className:"flex w-full items-center gap-2",children:[a.jsx(U,{onClick:De,size:"icon",variant:D?"destructive":"outline",title:D?"Stop Recording":"Start Recording",disabled:!v||W,className:"p-2",children:D?a.jsx(vie,{size:18}):a.jsx(aie,{size:18})}),a.jsx(Vn,{placeholder:D?"Recording audio...":"Type a message or use microphone...",value:m,onChange:re=>g(re.target.value),onKeyPress:re=>{re.key==="Enter"&&!re.shiftKey&&(re.preventDefault(),Le())},className:"flex-grow resize-none text-sm p-2 rounded-md min-h-[40px] max-h-[100px]",rows:1,disabled:!v||W||D}),a.jsx(U,{onClick:()=>Le(),size:"icon",title:"Send Message",disabled:!m.trim()||!v||W||D,children:a.jsx(gie,{size:18})})]})})]})]})};function pke({title:t,titleId:e,...n},r){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?p.createElement("title",{id:e},t):null,p.createElement("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"}))}const gke=p.forwardRef(pke),yke=gke;function xke({title:t,titleId:e,...n},r){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?p.createElement("title",{id:e},t):null,p.createElement("path",{d:"M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z"}))}const vke=p.forwardRef(xke),wke=vke,$n=({initialText:t,onSave:e,isAdmin:n,placeholder:r="Enter text...",as:s="span",className:i="",textClassName:o="",inputClassName:l="",useTextarea:c=!1})=>{const[u,d]=p.useState(!1),[h,f]=p.useState(t),m=p.useRef(null);p.useEffect(()=>{f(t)},[t]),p.useEffect(()=>{u&&m.current&&(m.current.focus(),m.current.select(),c&&(m.current.style.height="auto",m.current.style.height=`${m.current.scrollHeight}px`))},[u,c]);const g=()=>{e&&e(h),d(!1)},x=b=>{f(b.target.value),c&&m.current&&(m.current.style.height="auto",m.current.style.height=`${m.current.scrollHeight}px`)},E=b=>{b.key==="Enter"&&!c?g():b.key==="Escape"&&(f(t),d(!1))},v=s;return n?a.jsx(v,{className:`inline-text-edit-container relative group ${i} ${u?"w-full":""}`,children:u?a.jsxs("div",{className:"flex items-start space-x-1 w-full",children:[" ",c?a.jsx("textarea",{ref:m,value:h,onChange:x,onKeyDown:E,onBlur:g,className:`p-0 m-0 border-none focus:ring-0 focus:outline-none resize-none overflow-hidden bg-transparent text-inherit font-inherit w-full ${o} ${l}`,placeholder:r,rows:1}):a.jsx("input",{ref:m,type:"text",value:h,onChange:x,onKeyDown:E,onBlur:g,className:`p-0 m-0 border-none focus:ring-0 focus:outline-none bg-transparent text-inherit font-inherit w-full ${o} ${l}`,placeholder:r}),a.jsx("button",{onClick:g,className:"p-1 text-green-500 hover:text-green-700 flex-shrink-0",title:"Save",children:a.jsx(yke,{className:"h-5 w-5"})})]}):a.jsxs("div",{className:`flex items-center space-x-1 cursor-pointer w-full ${o}`,onClick:()=>d(!0),role:"button",tabIndex:0,onKeyDown:b=>{b.key==="Enter"&&d(!0)},children:[a.jsx("span",{className:"flex-grow",children:h||r}),a.jsx(wke,{className:"h-4 w-4 text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"})]})}):a.jsx(v,{className:o,children:h||r})},bke=({store:t,isPublishedView:e=!1})=>{var h;const{updateStore:n}=Fn(),r=(t==null?void 0:t.name)||"Our Store",s=t==null?void 0:t.id,i=!e,o={title:`The ${r} Way`,subtitle:"Discover the core values that make us unique.",items:[{emoji:"✨",icon:is,title:"Quality First",description:"We prioritize premium materials and craftsmanship in every product."},{emoji:"🌿",icon:nie,title:"Sustainable Practices",description:"Committed to eco-friendly sourcing and ethical production."},{emoji:"⚡️",icon:e3,title:"Innovative Design",description:"Blending timeless styles with modern, cutting-edge aesthetics."},{emoji:"💖",icon:qV,title:"Customer Love",description:"Our customers are at the heart of everything we do."}]},l=((h=t==null?void 0:t.content)==null?void 0:h.storeWay)||o,c=l.items&&l.items.length>0?l.items:o.items,u=async(f,m,g=null)=>{if(!s)return;let x={title:l.title,subtitle:l.subtitle,items:[...c].map(E=>({...E}))};g!==null&&x.items[g]?f==="itemTitle"?x.items[g].title=m:f==="itemDescription"?x.items[g].description=m:f==="itemEmoji"&&(x.items[g].emoji=m):f==="title"?x.title=m:f==="subtitle"&&(x.subtitle=m);try{await n(s,{content:{...t.content,storeWay:x}})}catch(E){console.error(`Failed to update store way content for ${f}:`,E)}},d=({item:f})=>{const m=f.icon||ZV;return a.jsx(m,{className:"w-8 h-8 mb-4 text-[var(--theme-primary)]"})};return a.jsx("section",{className:"py-16 md:py-24 bg-background",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12 md:mb-16",children:[a.jsx("div",{className:"inline-flex items-center justify-center bg-[var(--theme-primary-10)] p-3 rounded-full mb-4",children:a.jsx(Q1,{className:"h-8 w-8 text-[var(--theme-primary)]"})}),a.jsx($n,{initialText:l.title,onSave:f=>u("title",f),isAdmin:i,placeholder:"Section Title",as:"h2",textClassName:"text-4xl md:text-5xl font-bold tracking-tight text-foreground"}),a.jsx($n,{initialText:l.subtitle,onSave:f=>u("subtitle",f),isAdmin:i,placeholder:"Section Subtitle",as:"p",textClassName:"text-lg text-muted-foreground max-w-xl mx-auto mt-3"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:c.map((f,m)=>a.jsxs(It.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.4,delay:m*.1+.2},className:"bg-card p-6 rounded-xl shadow-lg text-center border border-border/50 hover:shadow-2xl transition-shadow",children:[a.jsxs("div",{className:"flex justify-center items-center mb-4",children:[i?a.jsx($n,{initialText:f.emoji,onSave:g=>u("itemEmoji",g,m),isAdmin:i,placeholder:"✨",textClassName:"text-4xl"}):a.jsx("span",{className:"text-4xl",children:f.emoji}),!f.emoji&&a.jsx(d,{item:f})]}),a.jsx("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:a.jsx($n,{initialText:f.title,onSave:g=>u("itemTitle",g,m),isAdmin:i,placeholder:"Item Title"})}),a.jsx("p",{className:"text-muted-foreground text-sm",children:a.jsx($n,{initialText:f.description,onSave:g=>u("itemDescription",g,m),isAdmin:i,placeholder:"Item Description",useTextarea:!0})})]},m))})]})})},OH="CEVWpXluVU77FgaVriTzqBCoN4FD3f0VL2Y8bXNPynNfqUg2DoUgPt8t",_ke="https://api.pexels.com/videos",Ske="https://api.pexels.com/v1";async function $H(t,e=9){if(!t||!t.trim())return{error:"Search query cannot be empty."};const n=`${_ke}/search?query=${encodeURIComponent(t)}&per_page=${e}`;try{const r=await fetch(n,{headers:{Authorization:OH}});if(!r.ok){const o=await r.json().catch(()=>({message:r.statusText}));return console.error("Pexels API error:",r.status,o),{error:`Pexels API error: ${o.message||r.statusText}`}}const s=await r.json();return{videos:s.videos.map(o=>{const l=o.video_files.find(c=>c.file_type==="video/mp4"&&(c.quality==="hd"||c.quality==="sd"))||o.video_files.find(c=>c.file_type==="video/mp4");return{id:o.id,width:o.width,height:o.height,duration:o.duration,imageUrl:o.image,videoUrl:l?l.link:o.video_files[0]?o.video_files[0].link:null,photographer:o.user.name,pexelsUrl:o.url}}).filter(o=>o.videoUrl),totalResults:s.total_results,page:s.page,perPage:s.per_page}}catch(r){return console.error("Error fetching from Pexels API:",r),{error:`Network error or other issue fetching Pexels videos: ${r.message}`}}}async function Eke(t,e=9){if(!t||!t.trim())return{error:"Search query cannot be empty."};const n=`${Ske}/search?query=${encodeURIComponent(t)}&per_page=${e}`;try{const r=await fetch(n,{headers:{Authorization:OH}});if(!r.ok){const o=await r.json().catch(()=>({message:r.statusText}));return console.error("Pexels API error:",r.status,o),{error:`Pexels API error: ${o.message||r.statusText}`}}const s=await r.json();return{photos:s.photos.map(o=>({id:o.id,width:o.width,height:o.height,src:o.src.medium,alt:o.alt,photographer:o.photographer,pexelsUrl:o.url})),totalResults:s.total_results,page:s.page,perPage:s.per_page}}catch(r){return console.error("Error fetching from Pexels API:",r),{error:`Network error or other issue fetching Pexels photos: ${r.message}`}}}const Cke=({open:t,onOpenChange:e,storeId:n,currentVideoUrl:r,onVideoReplaced:s})=>{const[i,o]=p.useState("ai"),[l,c]=p.useState(""),[u,d]=p.useState(!1),[h,f]=p.useState(null),[m,g]=p.useState(""),[x,E]=p.useState([]),[v,b]=p.useState(!1),[S,I]=p.useState(null),[D,k]=p.useState(null),[C,T]=p.useState(null),[P,A]=p.useState(!1);p.useEffect(()=>{t&&(c(""),d(!1),f(null),g(""),E([]),b(!1),I(null),k(null),T(null),A(!1))},[t]);const R=async()=>{if(!l.trim()){f("Please enter a prompt for the video.");return}d(!0),f(null);try{console.log(`Generating video for store ${n} with prompt: "${l}"`);const q=await sae(l);s&&s(q),e(!1),c("")}catch(q){console.error("Error generating video with AI:",q),f(q.message||"Failed to generate video. Please try again.")}finally{d(!1)}},M=async()=>{if(!m.trim()){I("Please enter a search query for Pexels.");return}b(!0),I(null),E([]);try{const q=await $H(m);q.error?(I(q.error),E([])):(E(q.videos||[]),(q.videos||[]).length===0&&I("No videos found for your query."))}catch(q){console.error("Error searching Pexels videos:",q),I(q.message||"Failed to search Pexels. Please try again.")}finally{b(!1)}},j=q=>{s&&q?(s(q),e(!1)):I("Invalid video URL selected or replacement handler missing.")},z=q=>{const H=q.target.files[0];if(H){if(H.size>50*1024*1024){T("File is too large. Please select a video under 50MB."),k(null);return}if(!H.type.startsWith("video/")){T("Invalid file type. Please select a video file."),k(null);return}k(H),T(null)}},W=()=>{if(D&&s){A(!0),T(null);const q=new FileReader;q.onloadend=()=>{s(q.result),e(!1),k(null),A(!1)},q.onerror=()=>{T("Failed to read video file for upload."),A(!1)},q.readAsDataURL(D)}else T("No video file selected or replacement handler missing.")};return a.jsx(Ps,{open:t,onOpenChange:e,children:a.jsxs(ls,{className:"sm:max-w-[672px]",children:[a.jsxs(cs,{className:"text-left",children:[a.jsx(us,{children:"Replace Hero Video"}),a.jsxs(No,{className:"text-left",children:["Current video: ",a.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline truncate block max-w-full",children:r||"No video set"})]})]}),a.jsxs(Fi,{value:i,onValueChange:o,className:"w-full",children:[a.jsxs(hi,{className:"grid w-full grid-cols-3",children:[" ",a.jsx(Gt,{value:"ai",children:"AI Generation (Veo)"}),a.jsx(Gt,{value:"pexels",children:"Search Pexels"}),a.jsx(Gt,{value:"upload",children:"Upload Video"})," "]}),a.jsxs(Wt,{value:"ai",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"aiPrompt",className:"text-left block mb-1",children:"AI Video Prompt"}),a.jsx(st,{id:"aiPrompt",value:l,onChange:q=>c(q.target.value),placeholder:"e.g., A futuristic cityscape at sunset",disabled:u})]}),h&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:h}),a.jsxs(jr,{className:"justify-start pt-4",children:[a.jsx(U,{variant:"outline",onClick:()=>e(!1),disabled:u,children:"Cancel"}),a.jsx(U,{onClick:R,disabled:u||!l.trim(),children:u?"Generating...":"Generate Video"})]})]}),a.jsxs(Wt,{value:"pexels",className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(st,{id:"pexelsQuery",value:m,onChange:q=>g(q.target.value),placeholder:"e.g., Nature, Business, Technology",disabled:v,className:"flex-grow"}),a.jsx(U,{onClick:M,disabled:v||!m.trim(),children:v?"Searching...":"Search"})]}),S&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:S}),v&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Loading Pexels videos..."}),!v&&x.length>0&&a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 max-h-[300px] overflow-y-auto pr-2",children:x.map(q=>a.jsxs("div",{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border hover:border-primary",onClick:()=>j(q.videoUrl),children:[a.jsx("img",{src:q.imageUrl,alt:`Pexels video by ${q.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),a.jsx("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:a.jsx("p",{className:"text-white text-xs text-center p-1 bg-black/50 rounded",children:"Use Video"})})]},q.id))}),a.jsx(jr,{className:"justify-start pt-4",children:a.jsx(U,{variant:"outline",onClick:()=>e(!1),disabled:v,children:"Cancel"})})]}),a.jsxs(Wt,{value:"upload",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"video-upload-input",className:"text-left block mb-1",children:"Select Video File"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(st,{id:"video-upload-input",type:"file",accept:"video/*",onChange:z,className:"flex-grow",disabled:P})}),D&&a.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected: ",D.name," (",(D.size/1024/1024).toFixed(2)," MB)"]}),C&&a.jsx("p",{className:"text-sm text-red-500 text-center mt-2",children:C})]}),a.jsxs(jr,{className:"justify-start pt-4",children:[a.jsx(U,{variant:"outline",onClick:()=>e(!1),disabled:P,children:"Cancel"}),a.jsx(U,{onClick:W,disabled:P||!D,children:P?"Uploading...":"Confirm Upload"})]})]})]})]})})},Tke=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),Ike=({isOpen:t,onOpenChange:e,currentImageUrl:n,onImageSelected:r,imageSearchContext:s="image",modalTitle:i="Change Image",storeName:o="your store"})=>{const{toast:l}=Ks(),[c,u]=p.useState("search"),[d,h]=p.useState(s),[f,m]=p.useState([]),[g,x]=p.useState(!1),[E,v]=p.useState(`A visually appealing ${s} for ${o}`),b=async()=>{if(d.trim()){x(!0),m([]);try{const k=await Xl(d,9,"landscape");m(k.map(C=>({id:C.id.toString(),src:{medium:C.src.large,large:C.src.large},alt:C.alt||d,photographer:C.photographer})))}catch(k){l({title:"Pexels Search Failed",description:k.message,variant:"destructive"})}x(!1)}},S=async()=>{if(E.trim()){x(!0),m([]);try{const k=await B1(E);if(k&&k.url)m([{id:tn(),src:{medium:k.url,large:k.url},alt:k.alt||E,photographer:"Generated by AI"}]),l({title:"AI Image Generated",description:"Select the image below or generate more."});else throw new Error("AI did not return an image URL.")}catch(k){l({title:"AI Image Generation Failed",description:k.message,variant:"destructive"})}x(!1)}},I=async k=>{const C=k.target.files[0];if(C){x(!0);try{const T=await Tke(C);r(T),l({title:"Image Uploaded",description:"Your image has been selected."}),e(!1)}catch{l({title:"Upload Failed",description:"Could not process the uploaded file.",variant:"destructive"})}x(!1)}},D=k=>{r(k),e(!1)};return p.useEffect(()=>{t&&(h(s||"abstract background"),v(`A visually appealing ${s||"image"} for ${o||"a store"}`),m([]),u("search"))},[t,s,o]),a.jsx(Ps,{open:t,onOpenChange:e,children:a.jsxs(ls,{className:"sm:max-w-2xl md:max-w-3xl lg:max-w-4xl",children:[a.jsx(cs,{children:a.jsx(us,{children:i})}),a.jsxs("div",{className:"py-4",children:[a.jsxs(Fi,{value:c,onValueChange:u,className:"w-full",children:[a.jsxs(hi,{className:"grid w-full grid-cols-3",children:[a.jsx(Gt,{value:"search",children:"Search Pexels"}),a.jsx(Gt,{value:"ai",children:"Generate with AI"}),a.jsx(Gt,{value:"upload",children:"Upload"})]}),a.jsx(Wt,{value:"search",className:"mt-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(st,{placeholder:"Search for images on Pexels...",value:d,onChange:k=>h(k.target.value),onKeyPress:k=>k.key==="Enter"&&b()}),a.jsxs(U,{onClick:b,disabled:g||!d.trim(),children:[g?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(lh,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Search"})]})]})}),a.jsx(Wt,{value:"ai",className:"mt-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(st,{placeholder:"Describe the image you want AI to generate...",value:E,onChange:k=>v(k.target.value),onKeyPress:k=>k.key==="Enter"&&S()}),a.jsxs(U,{onClick:S,disabled:g||!E.trim(),children:[g?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(na,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Generate"})]})]})}),a.jsxs(Wt,{value:"upload",className:"mt-4",children:[a.jsx(je,{htmlFor:"image-upload-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Upload your own image:"}),a.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-md",children:a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsx(Jo,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsxs("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:[a.jsxs("label",{htmlFor:"image-upload-input-file",className:"relative cursor-pointer bg-white dark:bg-gray-800 rounded-md font-medium text-primary hover:text-primary-focus focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary-ring",children:[a.jsx("span",{children:"Upload a file"}),a.jsx(st,{id:"image-upload-input-file",name:"image-upload-input-file",type:"file",className:"sr-only",accept:"image/*",onChange:I})]}),a.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF up to 10MB"})]})})]})]}),g&&f.length===0&&a.jsxs("div",{className:"text-center py-10",children:[a.jsx(St,{className:"h-8 w-8 animate-spin mx-auto text-primary"}),a.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Fetching images..."})]}),f.length>0&&a.jsx(ScrollArea,{className:"mt-4 max-h-[50vh]",children:a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 p-1",children:f.map(k=>a.jsxs(It.div,{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border-2 border-transparent hover:border-primary transition-all",onClick:()=>D(k.src.large||k.src.medium),whileHover:{scale:1.03},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[a.jsx("img",{src:k.src.medium,alt:k.alt||"Search result",className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(Nke,{className:"h-10 w-10 text-white"})}),a.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] p-1 truncate text-center",children:k.photographer||k.alt||"Untitled"})]},k.id))})})]}),a.jsx(jr,{children:a.jsx(ja,{asChild:!0,children:a.jsx(U,{type:"button",variant:"outline",children:"Cancel"})})})]})})},Nke=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),Pke=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");e({base64ImageData:i,mimeType:o[1]})}catch(r){n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o=s.toDataURL("image/png"),l="image/png";(!o||o.length<100)&&(o=s.toDataURL("image/jpeg"),l="image/jpeg");const c=o.split(",");e({base64ImageData:c[1],mimeType:l})}catch(o){n(new Error("Canvas toDataURL failed: "+o.message))}},r.onerror=()=>n(new Error("Failed to load image from URL for conversion.")),r.src=t}}),Ake=({isOpen:t,onOpenChange:e,currentImageUrl:n,onImageEdited:r,imageContext:s="image",modalTitle:i="Edit Image with AI"})=>{const{toast:o}=Ks(),[l,c]=p.useState(""),[u,d]=p.useState(!1),[h,f]=p.useState("");p.useEffect(()=>{t&&n&&(f(n),c(""))},[t,n]);const m=async()=>{if(!l.trim()||!h){o({title:"Missing data",description:"Image or edit prompt is missing.",variant:"destructive"});return}d(!0);try{const{base64ImageData:g,mimeType:x}=await Pke(h),E=await Ql(g,x,l);if(E&&E.editedImageData&&E.newMimeType){const v=`data:${E.newMimeType};base64,${E.editedImageData}`;r(v),o({title:"Image Edited",description:"Image updated with AI edit."}),e(!1)}else throw new Error((E==null?void 0:E.textResponse)||"AI did not return an edited image.")}catch(g){console.error("Error editing image:",g),o({title:"Image Edit Failed",description:g.message,variant:"destructive"})}d(!1)};return a.jsx(Ps,{open:t,onOpenChange:e,children:a.jsxs(ls,{className:"sm:max-w-md",children:[a.jsx(cs,{children:a.jsx(us,{children:i})}),a.jsxs("div",{className:"space-y-4 py-4",children:[h&&a.jsxs("div",{className:"flex flex-col items-center space-y-2 mb-4",children:[a.jsx("img",{src:h,alt:`Current ${s} to edit`,className:"max-h-48 w-auto object-contain rounded border"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Editing: Current ",s]})]}),a.jsx(je,{htmlFor:"editPrompt",className:"text-left",children:"Edit Instruction:"}),a.jsx(Vn,{id:"editPrompt",placeholder:`e.g., 'make the background blue', 'add sparkles to the ${s}'`,value:l,onChange:g=>c(g.target.value),rows:3,className:"resize-none"})]}),a.jsxs(jr,{children:[a.jsx(ja,{asChild:!0,children:a.jsx(U,{type:"button",variant:"outline",disabled:u,children:"Cancel"})}),a.jsxs(U,{onClick:m,disabled:u||!l.trim(),children:[u?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(na,{className:"mr-2 h-4 w-4"}),"Apply Edit"]})]})]})})},VH=({store:t,isPublishedView:e=!1})=>{var F,ue,Ee,Se,we,Fe,Ze,ze,nt,qe,yt;const{updateStore:n,updateStoreTextContent:r}=Fn(),[s,i]=p.useState(0),[o,l]=p.useState(null),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(!1),[g,x]=p.useState(!1),[E,v]=p.useState(null),b=p.useRef(null),S={Shield:xie,Truck:jv,CreditCard:Bi,Headphones:Bj,Star:QV,Zap:e3,GlobeIcon:cu,AwardIcon:Bse,UsersIcon:m0,HeartIcon:qV,CheckCircle:Yo,Sparkles:is,ArrowRight:lu,Play:JV,Pause:uie,Package:Ei},I=Jde(b,{once:!0,margin:"-100px"}),{scrollYProgress:D}=qde({target:b,offset:["start end","end start"]}),k=K_(D,[0,1],[100,-100]),C=K_(D,[0,.2,.8,1],[0,1,1,0]),T=K_(D,[0,.2,.8,1],[.8,1,1,.8]),P=((F=t==null?void 0:t.theme)==null?void 0:F.primaryColor)||"#6366F1",A=t==null?void 0:t.id,R=!e,M={title:"An Exceptional Experience",subtitle:"We're committed to providing you with the best shopping experience through our premium services and customer-first approach.",items:[{emoji:"",iconName:"Zap",title:"Smart Solutions",description:"Innovative products designed for modern living and efficiency.",color:"#007AFF",stats:"Future Ready",image:"https://images.pexels.com/photos/373543/pexels-photo-373543.jpeg?auto=compress&cs=tinysrgb&w=600&q=80",videoUrl:""},{emoji:"🚚",icon:jv,title:"Fast Delivery",description:"Free shipping worldwide with express delivery options available.",color:"#3B82F6",stats:"2-3 Days",image:"https://images.unsplash.com/photo-1566576912321-d58ddd7a6088?w=600&q=80"},{emoji:"💳",icon:Bi,title:"Easy Returns",description:"30-day hassle-free returns with full refund guarantee.",color:"#8B5CF6",stats:"30 Days",image:"https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=600&q=80"},{emoji:"🎧",icon:Bj,title:"24/7 Support",description:"Round-the-clock customer support via chat, email, and phone.",color:"#F59E0B",stats:"Always On",image:"https://images.unsplash.com/photo-1553484771-371a605b060b?w=600&q=80"}],secondaryItems:[{iconName:"GlobeIcon",title:"Global Reach",description:"Serving customers in 50+ countries"},{iconName:"AwardIcon",title:"Premium Quality",description:"Certified products with quality guarantee"},{iconName:"UsersIcon",title:"Community Driven",description:"Join 100K+ satisfied customers"},{iconName:"HeartIcon",title:"Eco-Conscious",description:"Sustainable packaging and practices"}],statsItems:[{iconName:"UsersIcon",number:"50K+",label:"Happy Customers"},{iconName:"ZapIcon",number:"99.9%",label:"Uptime"},{iconName:"HeadphonesIcon",number:"24/7",label:"Support"},{iconName:"StarIcon",number:"4.9★",label:"Rating"}]},j=(ue=t==null?void 0:t.content)!=null&&ue.storeFeatures?{...M,...t.content.storeFeatures,items:t.content.storeFeatures.items&&t.content.storeFeatures.items.length>0?t.content.storeFeatures.items:M.items,secondaryItems:t.content.storeFeatures.secondaryItems&&t.content.storeFeatures.secondaryItems.length>0?t.content.storeFeatures.secondaryItems:M.secondaryItems,statsItems:t.content.storeFeatures.statsItems&&t.content.storeFeatures.statsItems.length>0?t.content.storeFeatures.statsItems:M.statsItems}:M,z=j.items&&j.items.length>0?j.items:M.items;p.useEffect(()=>{const Le=async()=>{const Ae=z[s];if(Ae&&!Ae.videoUrl){const pt=Ae.title||Ae.description||"modern abstract motion";try{console.log(`[Modern StoreFeatures] Fetching Pexels video for active feature "${pt}"`);const mt=await $H(pt,1);mt&&mt.videos&&mt.videos.length>0?(l(mt.videos[0].videoUrl),u(mt.videos[0].imageUrl)):(console.warn(`No Pexels video found for query: "${pt}". Clearing previous Pexels video.`),l(null),u(null))}catch(mt){console.error(`Failed to fetch Pexels video for query "${pt}":`,mt),l(null),u(null)}}else Ae&&Ae.videoUrl&&(l(null),u(null))};z&&z.length>0&&s<z.length&&Le()},[s,z]);const W=async(Le,Ae)=>{!A||!R||console.log(`[ModernStoreFeatures] handleSaveText called with field: ${Le}, value: ${Ae}. This might be redundant if InlineTextEdit is used.`)},q=Le=>{v(Le),m(!0)},H=async Le=>{if(A==null||E==null||!Le)return;const Ae=JSON.parse(JSON.stringify(j));if(Ae.items&&Ae.items[E])Ae.items[E].image=Le,Ae.items[E].videoUrl="";else{console.error("Cannot update feature image: active feature item not found."),m(!1);return}try{await n(A,{content:{...t.content,storeFeatures:Ae}})}catch(pt){console.error("Failed to update store with new feature image URL:",pt)}m(!1),v(null)},$=()=>h(!0),J=async Le=>{if(!A||!R||s===null||!z[s])return;const Ae=JSON.parse(JSON.stringify(j));if(Ae.items&&Ae.items[s])Ae.items[s].videoUrl=Le,Ae.items[s].image="",l(null),u(null);else{console.error("Cannot update video URL: active feature item not found."),h(!1);return}try{await n(A,{content:{...t.content,storeFeatures:Ae}})}catch(pt){console.error("Failed to update store with new feature video URL:",pt)}h(!1)},O={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},V={hidden:{opacity:0,y:30},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.25,.46,.45,.94]}}},G={hidden:{opacity:0,x:-50},visible:{opacity:1,x:0,transition:{duration:.8,ease:[.25,.46,.45,.94]}}};return a.jsxs("section",{ref:b,className:"relative py-20 gradient-bg overflow-hidden",id:`features-${A}`,children:[a.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[a.jsx(It.div,{className:"absolute top-20 left-20 w-96 h-96 bg-primary/5 blur-3xl rounded-full",style:{backgroundColor:`${P}10`,y:k}}),a.jsx(It.div,{className:"absolute bottom-20 right-20 w-80 h-80 bg-secondary/5 blur-3xl rounded-full",style:{y:k}}),a.jsx(It.div,{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-accent/5 blur-3xl rounded-full",animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},transition:{duration:8,repeat:1/0}})]}),a.jsxs(It.div,{className:"container mx-auto px-6 relative z-10",style:{opacity:C,scale:T},children:[a.jsxs(It.div,{variants:O,initial:"hidden",animate:I?"visible":"hidden",className:"text-center mb-20",children:[a.jsxs(It.div,{variants:V,className:"inline-flex items-center gap-2 px-4 py-2 bg-white/10 dark:bg-black/10 backdrop-blur-md border border-white/20 dark:border-white/10 rounded-full text-sm font-medium mb-6",style:{color:P,borderColor:`${P}30`},children:[a.jsx(is,{className:"w-4 h-4"}),a.jsx("span",{children:"Why Choose Us"})]}),a.jsx(It.h2,{variants:V,className:"text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 dark:text-white mb-6 tracking-tight",children:a.jsx($n,{initialText:j.title,onSave:Le=>W("title",Le),isAdmin:R,placeholder:"Section Title",as:"span",textClassName:"bg-gradient-to-r from-gray-900 via-primary to-gray-900 dark:from-white dark:via-primary dark:to-white bg-clip-text text-transparent",style:{backgroundImage:`linear-gradient(90deg, currentColor, ${P}, currentColor)`}})}),a.jsx(It.p,{variants:V,className:"text-xl text-muted-foreground max-w-3xl mx-auto leading-relaxed",children:a.jsx($n,{initialText:j.subtitle,onSave:Le=>W("subtitle",Le),isAdmin:R,placeholder:"Section Subtitle",as:"span"})})]}),a.jsxs(It.div,{variants:O,initial:"hidden",animate:I?"visible":"hidden",className:"grid lg:grid-cols-2 gap-16 mb-20",children:[a.jsx(It.div,{variants:G,className:"space-y-6",children:z.map((Le,Ae)=>{const pt=Le.icon||Ei,mt=s===Ae;return a.jsx(It.div,{className:`p-6 rounded-3xl border transition-all duration-500 cursor-pointer ${mt?"bg-white/20 dark:bg-black/20 border-white/30 dark:border-white/20 shadow-float-lg":"bg-white/10 dark:bg-black/10 border-white/20 dark:border-white/10 hover:bg-white/15 dark:hover:bg-black/15"}`,onClick:()=>i(Ae),whileHover:{scale:1.02,y:-5},whileTap:{scale:.98},initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{delay:Ae*.1},children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center shadow-lg text-3xl",style:{backgroundColor:Le.color||P+"30"},children:Le.emoji||a.jsx(pt,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a.jsx($n,{initialText:Le.title,onSave:Ht=>W("itemTitle",Ht),isAdmin:R,placeholder:"Feature Title"})}),Le.stats&&a.jsx(qp,{variant:"secondary",className:"text-xs font-medium",style:{backgroundColor:`${Le.color||P}20`,color:Le.color||P},children:Le.stats})]}),a.jsx("p",{className:"text-muted-foreground leading-relaxed",children:a.jsx($n,{initialText:Le.description,onSave:Ht=>W("itemDescription",Ht),isAdmin:R,placeholder:"Feature Description",useTextarea:!0})}),mt&&a.jsx(It.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t border-white/20 dark:border-white/10",children:a.jsxs(U,{variant:"outline",size:"sm",className:"group",style:{borderColor:Le.color||P,color:Le.color||P},children:["Learn More",a.jsx(lu,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})})]})]})},Le.title+Ae)})}),z[s]&&a.jsxs(It.div,{variants:V,className:"relative aspect-square lg:aspect-[4/3] rounded-3xl overflow-hidden shadow-float-lg group",children:[!e&&z[s]&&a.jsx("div",{className:"absolute top-3 left-3 z-20 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(Ee=z[s])!=null&&Ee.videoUrl||o?a.jsxs(U,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:$,title:"Replace Feature Video",children:[a.jsx(Wj,{className:"h-4 w-4 mr-1"})," Replace Video"]}):a.jsxs(a.Fragment,{children:[a.jsxs(U,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:()=>q(s),title:"Change Feature Image",children:[a.jsx(Wj,{className:"h-4 w-4 mr-1"})," Change Image"]}),a.jsxs(U,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:()=>{v(s),x(!0)},title:"Edit Feature Image with AI",children:[a.jsx(na,{className:"h-4 w-4 mr-1"})," Edit with AI"]})]})}),(Se=z[s])!=null&&Se.videoUrl?a.jsx("video",{src:z[s].videoUrl,poster:z[s].image||c||"",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"},`feat-video-${s}`):o?a.jsx("video",{src:o,poster:c||((we=z[s])==null?void 0:we.image)||"",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"},`current-pexels-video-${s}`):(Fe=z[s])!=null&&Fe.image?a.jsx(It.img,{src:z[s].image,alt:z[s].title||"Modern feature image",className:"absolute inset-0 w-full h-full object-cover",initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},transition:{duration:.8}},`feat-img-${s}`):a.jsx(It.img,{src:"https://images.pexels.com/photos/1571460/pexels-photo-1571460.jpeg?auto=compress&cs=tinysrgb&w=600",alt:"Default modern feature background",className:"absolute inset-0 w-full h-full object-cover",initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},transition:{duration:.8}},`fallback-img-${s}`),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent"}),a.jsx(It.div,{className:"absolute bottom-6 left-6 right-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:a.jsxs("div",{className:"bg-white/10 dark:bg-black/10 backdrop-blur-md border border-white/20 dark:border-white/10 rounded-2xl p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl",style:{backgroundColor:z[s].color||P+"30"},children:z[s].emoji||ht.createElement(z[s].icon||Ei,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-bold text-white",children:z[s].title}),z[s].stats&&a.jsx("p",{className:"text-sm text-gray-200",children:z[s].stats})]})]}),a.jsx("p",{className:"text-gray-200 text-sm leading-relaxed",children:z[s].description})]})},`overlay-${s}`),a.jsx(It.div,{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/20 dark:bg-black/20 backdrop-blur-md rounded-2xl flex items-center justify-center border border-white/30 dark:border-white/20 z-10",animate:{y:[-8,8,-8],rotate:[0,10,0]},transition:{duration:6,repeat:1/0},children:a.jsx(Yo,{className:"w-12 h-12 text-green-400"})})]})]}),a.jsx(It.div,{variants:O,initial:"hidden",animate:I?"visible":"hidden",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16",children:(j.secondaryItems||[]).map((Le,Ae)=>{const pt=S[Le.iconName]||Ei;return a.jsxs(It.div,{variants:V,className:"text-center p-6 bg-white/10 dark:bg-black/10 backdrop-blur-md rounded-3xl border border-white/20 dark:border-white/10 hover:bg-white/15 dark:hover:bg-black/15 transition-all duration-300",whileHover:{scale:1.05,y:-5},children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center shadow-lg",style:{backgroundColor:P},children:a.jsx(pt,{className:"w-8 h-8 text-white"})}),a.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:a.jsx($n,{initialText:Le.title,onSave:mt=>W(`secondaryItemTitle.${Ae}`,mt),isAdmin:R,placeholder:"Feature Title"})}),a.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:a.jsx($n,{initialText:Le.description,onSave:mt=>W(`secondaryItemDescription.${Ae}`,mt),isAdmin:R,placeholder:"Feature Description",useTextarea:!0})})]},Le.title+Ae)})}),a.jsx(It.div,{variants:O,initial:"hidden",animate:I?"visible":"hidden",className:"grid grid-cols-2 md:grid-cols-4 gap-8 p-8 bg-white/10 dark:bg-black/10 backdrop-blur-md rounded-3xl border border-white/20 dark:border-white/10",children:(j.statsItems||[]).map((Le,Ae)=>{const pt=S[Le.iconName]||Ei;return a.jsxs(It.div,{variants:V,className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-xl flex items-center justify-center",style:{backgroundColor:`${P}20`},children:a.jsx(pt,{className:"w-6 h-6",style:{color:P}})}),a.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-1",children:a.jsx($n,{initialText:Le.number,onSave:mt=>W("statsItemNumber",mt),isAdmin:R,placeholder:"Stat Number"})}),a.jsx("div",{className:"text-sm text-muted-foreground",children:a.jsx($n,{initialText:Le.label,onSave:mt=>W("statsItemLabel",mt),isAdmin:R,placeholder:"Stat Label"})})]},Le.label+Ae)})})]}),!e&&A&&a.jsx(Cke,{open:d,onOpenChange:h,storeId:A,currentVideoUrl:((Ze=z[s])==null?void 0:Ze.videoUrl)||o,onVideoReplaced:J}),!e&&A&&E!==null&&z[E]&&a.jsx(Ike,{isOpen:f,onOpenChange:m,currentImageUrl:(ze=z[E])==null?void 0:ze.image,onImageSelected:Le=>H(Le),imageSearchContext:`feature image for ${((nt=z[E])==null?void 0:nt.title)||"section"}`,modalTitle:"Change Feature Image",storeName:t.name}),!e&&A&&E!==null&&z[E]&&a.jsx(Ake,{isOpen:g,onOpenChange:x,currentImageUrl:(qe=z[E])==null?void 0:qe.image,onImageEdited:Le=>H(Le),imageContext:`feature image for "${((yt=z[E])==null?void 0:yt.title)||"section"}"`,modalTitle:"Edit Feature Image with AI"})]})},kke=Object.freeze(Object.defineProperty({__proto__:null,default:VH},Symbol.toStringTag,{value:"Module"})),Rke=()=>{var Nt,Ut;console.log("[StorePreview] Component mounted.");const{storeName:t,productHandle:e}=s0();console.log("[StorePreview] storeName from params:",t);const{getStoreByName:n,getStoreById:r,currentStore:s,setCurrentStore:i,updateStore:o,viewMode:l,isLoadingStores:c,user:u}=Fn(),{toast:d}=Ks(),[h,f]=p.useState(null),[m,g]=p.useState(null),[x,E]=p.useState(null),[v,b]=p.useState(null),[S,I]=p.useState(null),[D,k]=p.useState(null),[C,T]=p.useState(null),[P,A]=p.useState(null),[R,M]=p.useState(null),[j,z]=p.useState(null),[W,q]=p.useState(null),[H,$]=p.useState(null),[J,O]=p.useState(null),[V,G]=p.useState(null),[F,ue]=p.useState(null),[Ee,Se]=p.useState(null),[we,Fe]=p.useState(null),[Ze,ze]=p.useState(null),[nt,qe]=p.useState(null),[yt,Le]=p.useState(null),[Ae,pt]=p.useState(null),[mt,Ht]=p.useState(null),[Ft,nn]=p.useState(null),[Tn,gn]=p.useState(null),[Qe,Be]=p.useState(null),[ct,he]=p.useState(null),[Ie,ee]=p.useState(null),[ne,X]=p.useState(null),[me,ye]=p.useState(null),[De,Oe]=p.useState(null),[re,pe]=p.useState(null),[Me,ve]=p.useState(null),[gt,wt]=p.useState(null),[dt,xt]=p.useState(null),[At,Nn]=p.useState(null),[on,_r]=p.useState(null),[Gn,Jt]=p.useState(null),[an,Mn]=p.useState(null),[K,te]=p.useState(null),[ce,ke]=p.useState(null),[Ve,Y]=p.useState(null),[Z,oe]=p.useState(null),[be,Ce]=p.useState(null),[Q,fe]=p.useState(null),[Re,et]=p.useState(null),[it,Te]=p.useState(null),[ft,Ct]=p.useState(null),[mn,xn]=p.useState(null),[nr,Kn]=p.useState(null),[hs,fs]=p.useState(null),[Js,ms]=p.useState(!1),[Xt,se]=p.useState(""),[de,ae]=p.useState(!1),[ge,Ne]=p.useState(!1);p.useEffect(()=>{console.log("[StorePreview] Sync effect triggered. isLoadingStores:",c,"storeName (slug from URL):",t,"contextCurrentStore ID:",s==null?void 0:s.id,"contextCurrentStore slug:",s==null?void 0:s.urlSlug);let Ye=null;if(s&&t&&s.urlSlug===t)Ye=s,console.log("[StorePreview] Using contextCurrentStore for local preview state (slug match). ID:",Ye.id);else if(t&&!c){const Ot=n(t);if(Ot)Ye=Ot,console.log("[StorePreview] Fetched store by name (slug) for local preview state:",Ot.name,"ID:",Ot.id),(!s||s.id!==Ot.id)&&(i(Ot),console.log("[StorePreview] Updated global currentStore with fetched data (found by slug in stores list)."));else{console.log("[StorePreview] Store not found by getStoreByName for slug:",t,"and contextCurrentStore didn't match."),c||d({title:"Store Not Found",description:`Could not find store with slug: ${t}`,variant:"destructive"}),f(null),g(null),ae(!1);return}}else{console.log("[StorePreview] Waiting for stores to load, or no storeName in URL, or contextCurrentStore does not match."),!c&&!t&&(f(null),g(null),ae(!1));return}if(Ye){let Ot=Ye.template_version||"v1";Ot==="v1"&&(Ot="classic"),console.log(`[StorePreview] Setting local store state for preview. DB Template: ${Ye.template_version}, UI Template: ${Ot}, Store ID: ${Ye.id}`);const fr=Ye.template_version==="v1"||!Ye.template_version?"classic":Ye.template_version;f(Ye),(m===null||h&&h.id!==Ye.id)&&(console.log(`[StorePreview] Sync effect: Initializing/Resetting previewTemplateVersion to DB version: ${fr}`),g(fr)),(m===null||h&&h.id!==Ye.id||h&&h.id===Ye.id&&h.template_version!==Ye.template_version)&&(console.log(`[StorePreview] Sync effect: Initializing/Resetting previewTemplateVersion to DB version: ${fr} for store ${Ye.id}`),g(fr)),!Ye.pass_key||u&&Ye.merchant_id===u.id?(ae(!0),console.log("[StorePreview] Authenticated (no passkey or user is owner).")):(ae(!1),console.log("[StorePreview] Not authenticated (passkey required)."))}else console.log("[StorePreview] No sourceStoreData available after checks, clearing local store."),f(null),g(null),ae(!1),!c&&t&&d({title:"Store Not Found",description:`Could not find store with slug: ${t}`,variant:"destructive"})},[t,n,i,d,c,u,s]),p.useEffect(()=>{const Ye=m||(h==null?void 0:h.template_version),Ot=document.documentElement;h&&h.theme?(h.theme.primaryColor?Ot.style.setProperty("--theme-primary-color",h.theme.primaryColor):Ot.style.removeProperty("--theme-primary-color"),h.theme.secondaryColor?Ot.style.setProperty("--theme-secondary-color",h.theme.secondaryColor):Ot.style.removeProperty("--theme-secondary-color"),Ye==="premium"?(Ot.style.setProperty("--premium-gradient-start-color",h.theme.primaryColor||"#667eea"),Ot.style.setProperty("--premium-gradient-end-color",h.theme.secondaryColor||"#764ba2")):(Ot.style.removeProperty("--premium-gradient-start-color"),Ot.style.removeProperty("--premium-gradient-end-color"))):(Ot.style.removeProperty("--theme-primary-color"),Ot.style.removeProperty("--theme-secondary-color"),Ot.style.removeProperty("--premium-gradient-start-color"),Ot.style.removeProperty("--premium-gradient-end-color"));let fr=!1;return Ye==="sharp"&&(Ot.classList.contains("dark")||(Ot.classList.add("dark"),fr=!0)),()=>{fr&&Ye!=="sharp"&&Ot.classList.contains("dark")}},[h==null?void 0:h.theme,h==null?void 0:h.template_version,m]),p.useEffect(()=>{if(h&&m){const Ye=m;console.log(`[StorePreview] Loading components for template: ${Ye}`),Ce(null),fe(null),et(null),Te(null),Ct(null),xn(null),Kn(null),fs(null),E(null),b(null),I(null),k(null),T(null),A(null),M(null),z(null),q(null),$(null),O(null),G(null),ue(null),Se(null),Fe(null),ze(null),qe(null),Le(null),pt(null),Ht(null),nn(null),gn(null),Be(null),he(null),ee(null),X(null),ye(null),Oe(null),pe(null),ve(null),wt(null),xt(null),Nn(null),_r(null),Jt(null),Mn(null),te(null),ke(null),Y(null),oe(null),Y(()=>bke),oe(()=>VH),Ye==="classic"?(Ce(()=>p.lazy(()=>jt(()=>Promise.resolve().then(()=>Dke),void 0))),fe(()=>p.lazy(()=>jt(()=>import("./StoreHero-e982599d.js"),[]))),et(()=>p.lazy(()=>jt(()=>import("./StoreCollections-ce4a75a5.js"),["assets/StoreCollections-ce4a75a5.js","assets/CollectionProductsDialog-60bce63c.js"]))),Te(()=>p.lazy(()=>jt(()=>import("./ProductGrid-91f405d9.js"),["assets/ProductGrid-91f405d9.js","assets/ProductEditModal-ec3ba471.js","assets/filter-16a345c2.js"]))),Ct(()=>p.lazy(()=>jt(()=>import("./StoreFeatures-a91122a8.js"),["assets/StoreFeatures-a91122a8.js","assets/shield-check-2b6ed753.js","assets/message-square-95252b71.js"]))),xn(()=>p.lazy(()=>jt(()=>import("./StoreTestimonials-fc37d3f5.js"),["assets/StoreTestimonials-fc37d3f5.js","assets/user-circle-3a91fd57.js"]))),Kn(()=>p.lazy(()=>jt(()=>import("./StoreNewsletter-bac6f124.js"),[]))),fs(()=>p.lazy(()=>jt(()=>Promise.resolve().then(()=>Mke),void 0)))):Ye==="modern"?(E(()=>p.lazy(()=>jt(()=>import("./StoreHeader-ced8b88e.js"),[]))),b(()=>p.lazy(()=>jt(()=>import("./StoreHero-736f8de4.js"),[]))),I(()=>p.lazy(()=>jt(()=>Promise.resolve().then(()=>kke),void 0))),k(()=>p.lazy(()=>jt(()=>import("./StoreCollections-9a0fbae3.js"),[]))),T(()=>p.lazy(()=>jt(()=>import("./ProductGrid-9354eb4c.js"),["assets/ProductGrid-9354eb4c.js","assets/ProductEditModal-ec3ba471.js","assets/minus-9f1d683a.js"]))),A(()=>p.lazy(()=>jt(()=>import("./Footer-524ed942.js"),[])))):Ye==="premium"?(M(()=>p.lazy(()=>jt(()=>import("./Header-a30de574.js"),[]))),z(()=>p.lazy(()=>jt(()=>import("./Hero-fde480ba.js"),[]))),q(()=>p.lazy(()=>jt(()=>import("./FeaturedProducts-4f627862.js"),["assets/FeaturedProducts-4f627862.js","assets/ProductEditModal-ec3ba471.js","assets/minus-9f1d683a.js","assets/filter-16a345c2.js"]))),$(()=>p.lazy(()=>jt(()=>import("./CategoryShowcase-9d2102c9.js"),["assets/CategoryShowcase-9d2102c9.js","assets/CollectionProductsDialog-60bce63c.js"]))),O(()=>p.lazy(()=>jt(()=>import("./SocialProof-f41b3737.js"),[]))),G(()=>p.lazy(()=>jt(()=>import("./Newsletter-3162f05d.js"),[]))),ue(()=>p.lazy(()=>jt(()=>import("./Footer-b60fdff8.js"),[])))):Ye==="sharp"?(Se(()=>p.lazy(()=>jt(()=>import("./StoreHeader-9dece614.js"),[]))),Fe(()=>p.lazy(()=>jt(()=>import("./StoreHero-c3b4614f.js"),["assets/StoreHero-c3b4614f.js","assets/ReplaceVideoModal-150339bc.js"]))),ze(()=>p.lazy(()=>jt(()=>import("./StoreFeatures-baa2cb4d.js"),[]))),qe(()=>p.lazy(()=>jt(()=>import("./ProductGrid-6e683663.js"),["assets/ProductGrid-6e683663.js","assets/ProductEditModal-ec3ba471.js"]))),Le(()=>p.lazy(()=>jt(()=>import("./Testimonials-095e653a.js"),["assets/Testimonials-095e653a.js","assets/message-square-95252b71.js","assets/user-circle-3a91fd57.js"]))),pt(()=>p.lazy(()=>jt(()=>import("./ImageRightSection-55a4a82f.js"),[]))),Ht(()=>p.lazy(()=>jt(()=>import("./VideoLeftSection-2da548ba.js"),["assets/VideoLeftSection-2da548ba.js","assets/ReplaceVideoModal-150339bc.js"]))),nn(()=>p.lazy(()=>jt(()=>import("./HeroFollowUpVideo-94171ac1.js"),["assets/HeroFollowUpVideo-94171ac1.js","assets/ReplaceVideoModal-150339bc.js"]))),gn(()=>p.lazy(()=>jt(()=>import("./Newsletter-18f17972.js"),[]))),Be(()=>p.lazy(()=>jt(()=>import("./Footer-69c2263b.js"),[])))):Ye==="fresh"?(he(()=>p.lazy(()=>jt(()=>import("./StoreHeader-fe593ce6.js"),[]))),ee(()=>p.lazy(()=>jt(()=>import("./StoreHero-7102a2eb.js"),[]))),X(()=>p.lazy(()=>jt(()=>import("./StoreFeatures-75f3f09e.js"),[]))),ye(()=>p.lazy(()=>jt(()=>import("./ProductGrid-662caab2.js"),["assets/ProductGrid-662caab2.js","assets/ProductEditModal-ec3ba471.js"]))),Oe(()=>p.lazy(()=>jt(()=>import("./StoreCollections-211e8be9.js"),["assets/StoreCollections-211e8be9.js","assets/CollectionProductsDialog-60bce63c.js"]))),pe(()=>p.lazy(()=>jt(()=>import("./Newsletter-00c62f90.js"),[]))),ve(()=>p.lazy(()=>jt(()=>import("./Footer-472a8bf9.js"),["assets/Footer-472a8bf9.js","assets/shield-check-2b6ed753.js"])))):Ye==="sleek"&&(wt(()=>p.lazy(()=>jt(()=>import("./StoreHeader-6e1acbf7.js"),[]))),xt(()=>p.lazy(()=>jt(()=>import("./StoreHero-ba4faec7.js"),[]))),Nn(()=>p.lazy(()=>jt(()=>import("./ProductGrid-6f34e39e.js"),["assets/ProductGrid-6f34e39e.js","assets/ProductEditModal-ec3ba471.js","assets/filter-16a345c2.js"]))),_r(()=>p.lazy(()=>jt(()=>import("./StoreFeatures-aa13278b.js"),[]))),Jt(()=>p.lazy(()=>jt(()=>import("./Testimonials-d1d8ca62.js"),["assets/Testimonials-d1d8ca62.js","assets/user-circle-3a91fd57.js"]))),Mn(()=>p.lazy(()=>jt(()=>import("./Newsletter-9a0c2927.js"),[]))),te(()=>p.lazy(()=>jt(()=>import("./Footer-584a925d.js"),[]))),ke(()=>p.lazy(()=>jt(()=>import("./StoreCollections-f06676b0.js"),[]))))}},[h==null?void 0:h.id,m]);const $e=()=>{if(!h||!h.pass_key){ae(!0);return}Ne(!0),setTimeout(()=>{Xt===h.pass_key?(ae(!0),d({title:"Access Granted",description:"Welcome to the store!"})):(d({title:"Access Denied",description:"Incorrect pass key.",variant:"destructive"}),se("")),Ne(!1)},500)};if(c)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading store..."})]})});if(!h)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("p",{className:"text-xl text-destructive",children:"Store not found."})});if(!de&&h.pass_key)return a.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 p-4",children:a.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-2xl w-full max-w-md text-center",children:[a.jsx(KV,{className:"h-16 w-16 text-primary mx-auto mb-6"}),a.jsx("h2",{className:"text-3xl font-bold text-card-foreground mb-3",children:"Protected Store"}),a.jsx("p",{className:"text-muted-foreground mb-8",children:"This store requires a pass key to view its content."}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx(st,{type:"password",placeholder:"Enter Pass Key",value:Xt,onChange:Ye=>se(Ye.target.value),className:"h-12 text-lg text-center bg-input border-border focus:ring-primary focus:border-primary",onKeyPress:Ye=>Ye.key==="Enter"&&$e()}),a.jsx(U,{onClick:$e,disabled:ge||!Xt.trim(),className:"h-12 text-lg w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:ge?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-current"}):a.jsxs(a.Fragment,{children:[a.jsx(bie,{className:"mr-2 h-5 w-5"})," Access Store"]})})]})]})});const _e=l==="published";let Je=m;if(Je||(Je=(h==null?void 0:h.template_version)==="v1"||!(h!=null&&h.template_version)?"classic":h.template_version),console.log(`[StorePreview] Determined templateVersionToRender: ${Je}. (previewTemplateVersion: ${m}, store.template_version: ${h==null?void 0:h.template_version})`),console.log(`[StorePreview] Rendering template: ${Je}. Store products: ${((Nt=h==null?void 0:h.products)==null?void 0:Nt.length)||0}, collections: ${((Ut=h==null?void 0:h.collections)==null?void 0:Ut.length)||0}`),Je==="classic"){if(!be||!Q||!Re||!it||!ft||!mn||!nr||!hs)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Classic Template Components..."})]})})}else if(Je==="modern"){if(!x||!v||!S||!D||!C||!P)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Modern Template Components..."})]})})}else if(Je==="premium"){if(!R||!j||!W||!H||!J||!V||!F)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Premium Template Components..."})]})})}else if(Je==="sharp"){if(!Ee||!we||!Ft||!Ze||!nt||!yt||!Ae||!mt||!Tn||!Qe)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Sharp Template Components..."})]})})}else if(Je==="sleek"){if(!gt||!dt||!At||!ce||!on||!Gn||!an||!K)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Sleek Template Components..."})]})})}else if(Je==="fresh"&&(!ct||!Ie||!ne||!me||!De||!re||!Me))return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Fresh Template Components..."})]})});return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx(p.Suspense,{fallback:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading Store Content..."}),children:Je==="classic"?a.jsxs(ht.Fragment,{children:[be&&a.jsx(be,{store:h,isPublishedView:_e}),Q&&a.jsx(Q,{store:h,isPublishedView:_e}),it&&a.jsx(it,{store:h,isPublishedView:_e}),Re&&a.jsx(Re,{store:h,isPublishedView:_e}),Z&&a.jsx(Z,{store:h,isPublishedView:_e}),Ve&&a.jsx(Ve,{store:h,isPublishedView:_e}),mn&&a.jsx(mn,{store:h,isPublishedView:_e}),nr&&a.jsx(nr,{store:h,isPublishedView:_e}),hs&&a.jsx(hs,{store:h,isPublishedView:_e})]},"classic"):Je==="modern"?a.jsx(ht.Fragment,{children:a.jsxs("div",{className:"min-h-screen flex flex-col",children:[a.jsxs("main",{className:"flex-1",children:[x&&a.jsx(x,{store:h,isPublishedView:_e}),v&&a.jsx(v,{store:h,isPublishedView:_e}),S?a.jsx(S,{store:h,isPublishedView:_e}):Z&&a.jsx(Z,{store:h,isPublishedView:_e}),C&&a.jsx(C,{store:h,products:(h==null?void 0:h.products)||[],isPublishedView:_e}),D&&a.jsx(D,{store:h,isPublishedView:_e}),Ve&&a.jsx(Ve,{store:h,isPublishedView:_e})]}),a.jsx("footer",{className:"mt-auto",children:P&&a.jsx(P,{store:h,isPublishedView:_e})})]})},"modern"):Je==="premium"?a.jsxs(ht.Fragment,{children:[R&&a.jsx(R,{store:h,isPublishedView:_e}),j&&a.jsx(j,{store:h,isPublishedView:_e}),W&&a.jsx(W,{store:h,isPublishedView:_e}),H&&a.jsx(H,{store:h,isPublishedView:_e}),Z&&a.jsx(Z,{store:h,isPublishedView:_e}),Ve&&a.jsx(Ve,{store:h,isPublishedView:_e}),J&&a.jsx(J,{store:h,isPublishedView:_e}),V&&a.jsx(V,{store:h,isPublishedView:_e}),F&&a.jsx(F,{store:h,isPublishedView:_e})]},"premium"):Je==="sharp"?a.jsxs(ht.Fragment,{children:[Ee&&a.jsx(Ee,{store:h,isPublishedView:_e}),we&&a.jsx(we,{store:h,isPublishedView:_e}),Ft&&a.jsx(Ft,{store:h}),nt&&a.jsx(nt,{store:h,isPublishedView:_e}),Ze?a.jsx(Ze,{store:h,isPublishedView:_e}):Z&&a.jsx(Z,{store:h,isPublishedView:_e}),Ve&&a.jsx(Ve,{store:h,isPublishedView:_e}),Ae&&a.jsx(Ae,{store:h,isPublishedView:_e}),mt&&a.jsx(mt,{store:h,isPublishedView:_e}),yt&&a.jsx(yt,{store:h,isPublishedView:_e}),Tn&&a.jsx(Tn,{store:h}),Qe&&a.jsx(Qe,{store:h})]},"sharp"):Je==="fresh"?a.jsxs(ht.Fragment,{children:[ct&&a.jsx(ct,{store:h,isPublishedView:_e}),Ie&&a.jsx(Ie,{store:h,isPublishedView:_e}),me&&a.jsx(me,{store:h,isPublishedView:_e})," ",De&&a.jsx(De,{store:h,isPublishedView:_e})," ",ne?a.jsx(ne,{store:h,isPublishedView:_e}):Z&&a.jsx(Z,{store:h,isPublishedView:_e}),Ve&&a.jsx(Ve,{store:h,isPublishedView:_e}),re&&a.jsx(re,{store:h}),Me&&a.jsx(Me,{store:h})]},"fresh"):Je==="sleek"?a.jsxs(ht.Fragment,{children:[gt&&a.jsx(gt,{store:h,isPublishedView:_e}),dt&&a.jsx(dt,{store:h,isPublishedView:_e}),At&&a.jsx(At,{store:h,isPublishedView:_e}),ce&&a.jsx(ce,{store:h,isPublishedView:_e}),on?a.jsx(on,{store:h,isPublishedView:_e}):Z&&a.jsx(Z,{store:h,isPublishedView:_e}),Ve&&a.jsx(Ve,{store:h,isPublishedView:_e}),Gn&&a.jsx(Gn,{store:h,isPublishedView:_e}),an&&a.jsx(an,{store:h,isPublishedView:_e}),K&&a.jsx(K,{store:h,isPublishedView:_e})]},"sleek"):null}),a.jsx(S1e,{store:h,onEdit:()=>ms(!0),currentTemplate:m,onTemplateChange:g,availableTemplates:["classic","modern","premium","sharp","fresh","sleek"]}),!_e&&h&&a.jsx(E1e,{store:h,open:Js,onOpenChange:ms,onStoreUpdate:Ye=>{f(Ot=>({...Ot,...Ye})),Ye.template_version&&Ye.template_version!==m&&g(Ye.template_version),(h&&h.id===Ye.id||s&&s.id===Ye.id)&&o(Ye.id,Ye)}}),a.jsx(FH,{storeId:h==null?void 0:h.id})," "]})},jke=({open:t,onOpenChange:e,storeId:n,storeName:r,currentLogoUrlLight:s,currentLogoUrlDark:i,onLogoReplaced:o})=>{const[l,c]=p.useState("ai"),[u,d]=p.useState(r||""),[h,f]=p.useState(!1),[m,g]=p.useState(null),[x,E]=p.useState({light:null,dark:null}),[v,b]=p.useState(""),[S,I]=p.useState([]),[D,k]=p.useState(!1),[C,T]=p.useState(null),[P,A]=p.useState(null),[R,M]=p.useState(null),[j,z]=p.useState(!1),[W,q]=p.useState(null);p.useEffect(()=>{t&&(d(r||""),f(!1),g(null),E({light:null,dark:null}),b(""),I([]),k(!1),T(null),A(null),M(null),z(!1),q(null))},[t,r]);const H=async()=>{if(!r){g("Store name is required to generate a logo with AI.");return}f(!0),g(null),E({light:null,dark:null});try{console.log(`Generating light/dark logos for store ${r}`);const F=await ig(r);F&&(F.logoUrlLight||F.logoUrlDark)?E({light:F.logoUrlLight,dark:F.logoUrlDark}):g(F.textResponse||"AI did not return sufficient image data for logos.")}catch(F){console.error("Error generating logos with AI:",F),g(F.message||"Failed to generate logos. Please try again.")}finally{f(!1)}},$=async()=>{if(!v.trim()){T("Please enter a search query for Pexels.");return}k(!0),T(null),I([]);try{const F=await Eke(v);F.error?(T(F.error),I([])):(I(F.photos||[]),(F.photos||[]).length===0&&T("No images found for your query."))}catch(F){console.error("Error searching Pexels images:",F),T(F.message||"Failed to search Pexels. Please try again.")}finally{k(!1)}},J=F=>{o&&F?(o({logoUrlLight:F,logoUrlDark:F}),e(!1)):T("Invalid image URL selected or replacement handler missing.")},O=F=>{const ue=F.target.files[0];if(ue){if(ue.size>10*1024*1024){M("File is too large. Please select an image under 10MB."),A(null),q(null);return}if(!ue.type.startsWith("image/")){M("Invalid file type. Please select an image file (e.g., PNG, JPG, GIF)."),A(null),q(null);return}A(ue),M(null);const Ee=new FileReader;Ee.onloadend=()=>{q(Ee.result)},Ee.readAsDataURL(ue)}},V=()=>{if(P&&o){z(!0),M(null);const F=new FileReader;F.onloadend=()=>{const ue=F.result;o({logoUrlLight:ue,logoUrlDark:ue}),e(!1),A(null),q(null),z(!1)},F.onerror=()=>{M("Failed to read image file for upload."),z(!1)},F.readAsDataURL(P)}else M("No image file selected or replacement handler missing.")},G=()=>{x.light||x.dark?(o({logoUrlLight:x.light,logoUrlDark:x.dark}),e(!1)):g("No AI generated logos available to confirm.")};return a.jsx(Ps,{open:t,onOpenChange:e,children:a.jsxs(ls,{className:"sm:max-w-[728px]",children:[" ",a.jsxs(cs,{className:"text-left",children:[a.jsx(us,{children:"Change Store Logo"}),a.jsxs(No,{className:"text-left space-y-2",children:[a.jsx("p",{children:"Current Logos:"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx(je,{className:"text-xs text-muted-foreground",children:"For Dark Backgrounds (Light Logo)"}),s?a.jsx("img",{src:s,alt:"Current light logo",className:"h-20 w-auto mx-auto max-w-full object-contain my-1 border rounded bg-gray-700 p-1"}):a.jsx("div",{className:"h-20 flex items-center justify-center text-xs text-muted-foreground bg-gray-200 dark:bg-gray-700 rounded my-1",children:"Not set"})]}),a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx(je,{className:"text-xs text-muted-foreground",children:"For Light Backgrounds (Dark Logo)"}),i?a.jsx("img",{src:i,alt:"Current dark logo",className:"h-20 w-auto mx-auto max-w-full object-contain my-1 border rounded bg-white p-1"}):a.jsx("div",{className:"h-20 flex items-center justify-center text-xs text-muted-foreground bg-gray-200 dark:bg-gray-700 rounded my-1",children:"Not set"})]})]})]})]}),a.jsxs(Fi,{value:l,onValueChange:c,className:"w-full",children:[a.jsxs(hi,{className:"grid w-full grid-cols-3",children:[a.jsx(Gt,{value:"ai",children:"Generate with AI"}),a.jsx(Gt,{value:"pexels",children:"Search Pexels"}),a.jsx(Gt,{value:"upload",children:"Upload Image"})]}),a.jsxs(Wt,{value:"ai",className:"space-y-4 py-4",children:[a.jsxs("p",{className:"text-sm text-muted-foreground",children:["AI will generate a logo based on your store name: ",a.jsx("strong",{children:r}),"."]}),m&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:m}),h&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Generating logos..."}),(x.light||x.dark)&&!h&&a.jsxs("div",{className:"flex flex-col items-center gap-4 mt-3",children:[a.jsx("p",{className:"text-sm font-medium",children:"Generated Previews:"}),a.jsxs("div",{className:"flex gap-4",children:[x.dark&&a.jsxs("div",{className:"text-center",children:[a.jsx(je,{className:"text-xs text-muted-foreground",children:"For Light BG"}),a.jsx("img",{src:x.dark,alt:"AI Generated Dark Logo",className:"h-24 w-24 object-contain border rounded-md bg-white p-1"})]}),x.light&&a.jsxs("div",{className:"text-center",children:[a.jsx(je,{className:"text-xs text-muted-foreground",children:"For Dark BG"}),a.jsx("img",{src:x.light,alt:"AI Generated Light Logo",className:"h-24 w-24 object-contain border rounded-md bg-gray-700 p-1"})]})]})]}),a.jsxs(jr,{className:"justify-start pt-4",children:[a.jsx(U,{variant:"outline",onClick:()=>e(!1),disabled:h,children:"Cancel"}),a.jsxs(U,{onClick:H,disabled:h||!r,children:[a.jsx(Q1,{className:"mr-2 h-4 w-4"}),h?"Generating...":x.light||x.dark?"Regenerate Logos":"Generate Logos"]}),(x.light||x.dark)&&a.jsx(U,{onClick:G,disabled:h,children:"Use These Logos"})]})]}),a.jsxs(Wt,{value:"pexels",className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(st,{id:"pexelsQuery",value:v,onChange:F=>b(F.target.value),placeholder:"e.g., Abstract, Minimal, Tech",disabled:D,className:"flex-grow"}),a.jsx(U,{onClick:$,disabled:D||!v.trim(),children:D?"Searching...":"Search Images"})]}),C&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:C}),D&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Loading Pexels images..."}),!D&&S.length>0&&a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-3 max-h-[300px] overflow-y-auto pr-2",children:S.map(F=>a.jsxs("div",{className:"relative aspect-square rounded-md overflow-hidden cursor-pointer group border hover:border-primary",onClick:()=>J(F.src.large2x||F.src.large||F.src.original),children:[a.jsx("img",{src:F.src.medium,alt:F.alt||`Pexels image by ${F.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),a.jsx("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:a.jsx("p",{className:"text-white text-xs text-center p-1 bg-black/50 rounded",children:"Use Image"})})]},F.id))}),a.jsx(jr,{className:"justify-start pt-4",children:a.jsx(U,{variant:"outline",onClick:()=>e(!1),disabled:D,children:"Cancel"})})]}),a.jsxs(Wt,{value:"upload",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"image-upload-input",className:"text-left block mb-1",children:"Select Image File"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(st,{id:"image-upload-input",type:"file",accept:"image/*",onChange:O,className:"flex-grow",disabled:j})}),W&&a.jsxs("div",{className:"mt-3 flex flex-col items-center",children:[a.jsx("p",{className:"text-sm font-medium mb-1",children:"Preview:"}),a.jsx("img",{src:W,alt:"Upload preview",className:"h-32 w-32 object-contain border rounded-md"})]}),P&&!W&&a.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected: ",P.name," (",(P.size/1024/1024).toFixed(2)," MB)"]}),R&&a.jsx("p",{className:"text-sm text-red-500 text-center mt-2",children:R})]}),a.jsxs(jr,{className:"justify-start pt-4",children:[a.jsx(U,{variant:"outline",onClick:()=>e(!1),disabled:j,children:"Cancel"}),a.jsx(U,{onClick:V,disabled:j||!P,children:j?"Uploading...":"Confirm Upload"})]})]})]})]})})},UH=({store:t,isPublishedView:e=!1})=>{const{name:n,theme:r,logo_url_light:s,logo_url_dark:i,id:o,settings:l,content:c,template_version:u}=t,{cart:d,removeFromCart:h,updateQuantity:f,updateStore:m,updateStoreTemplateVersion:g}=Fn(),[x,E]=p.useState(!1),[v,b]=p.useState(!1),[S,I]=p.useState(!1),D=!e,[k,C]=p.useState(!1),T=di(),P=d.filter(G=>G.storeId===o),A=P.reduce((G,F)=>G+F.quantity,0),R=P.reduce((G,F)=>G+F.price*F.quantity,0);p.useEffect(()=>{const G=localStorage.getItem("theme"),F=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;C(!!(G==="dark"||!G&&F))},[]);const M=async(G,F,ue=null)=>{if(o)try{if(G==="storeName")await m(o,{name:F});else if(G==="navLink"&&ue!==null){const Se=((c==null?void 0:c.navLinks)||J.map(we=>({label:we.label,href:we.href}))).map((we,Fe)=>Fe===ue?{...we,label:F}:we);await m(o,{content:{...c,navLinks:Se}})}await j()}catch(Ee){console.error(`Failed to update store ${G} or refresh template:`,Ee)}},j=async()=>{const G=u||"v1";console.log(`Performing template refresh. Current version: ${G}`),G==="v1"?(await g(o,"v2"),await g(o,"v1"),console.log("Template refreshed: v1 -> v2 -> v1")):G==="v2"&&(await g(o,"v1"),await g(o,"v2"),console.log("Template refreshed: v2 -> v1 -> v2"))},z=()=>{I(!0),console.log("Open change image dialog (placeholder)")},W=async G=>{if(o&&G)try{await m(o,{logo_url_light:G.logoUrlLight||t.logo_url_light,logo_url_dark:G.logoUrlDark||t.logo_url_dark}),console.log("Store logos updated successfully.")}catch(F){console.error("Failed to update store logos:",F)}},q=()=>{const G=!k;C(G),G?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},H=`/store/${o}`,$=[{href:H,label:"Home"},{href:`#products-${o}`,label:"Products"},{href:`#features-${o}`,label:"Features"},{href:`#contact-${o}`,label:"Contact"}],J=c!=null&&c.navLinks&&c.navLinks.length===$.length?c.navLinks.map((G,F)=>({...$[F],label:G.label||$[F].label})):$,O=(G,F)=>{if(G.preventDefault(),E(!1),F.startsWith("/store/"))T(F);else{const ue=F.substring(1),Ee=document.getElementById(ue);Ee?Ee.scrollIntoView({behavior:"smooth"}):T(H)}},V=()=>{b(!1),T("/checkout",{state:{cart:P,storeName:n,storeId:o}})};return a.jsxs(a.Fragment,{children:[a.jsx(It.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"sticky top-0 z-40 w-full bg-background/90 backdrop-blur-md border-b",style:{borderColor:`${r.primaryColor}30`},children:a.jsxs("div",{className:"container mx-auto px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Us,{to:H,className:"group",children:(k?s:i)?a.jsx("img",{src:k?s:i,alt:`${n} logo`,className:"h-16 w-16 object-contain group-hover:scale-105 transition-transform duration-200"}):s||i?a.jsx("img",{src:s||i,alt:`${n} logo (fallback)`,className:"h-16 w-16 object-contain group-hover:scale-105 transition-transform duration-200"}):null}),D&&(s||i)&&a.jsx(U,{variant:"outline",size:"icon",onClick:z,className:"h-8 w-8 p-0 -ml-2 relative z-10 bg-background hover:bg-muted",children:a.jsx(kv,{className:"h-4 w-4"})}),a.jsx(Us,{to:H,className:"group ml-2",children:a.jsx("span",{className:"font-bold text-xl tracking-tight group-hover:text-primary transition-colors",style:{color:r.primaryColor},children:a.jsx($n,{initialText:n,onSave:G=>M("storeName",G),isAdmin:D,placeholder:"Store Name"})})})]})," ",a.jsx("nav",{className:"hidden md:flex items-center gap-x-6",children:J.map((G,F)=>a.jsx("a",{href:G.href,onClick:ue=>O(ue,G.href),className:"text-sm font-medium text-muted-foreground hover:text-primary transition-colors",style:{"--hover-color":r.primaryColor},children:a.jsx($n,{initialText:G.label,onSave:ue=>M("navLink",ue,F),isAdmin:D,placeholder:`Link ${F+1}`})},G.label+F))}),a.jsxs("div",{className:"flex items-center gap-2",children:[((l==null?void 0:l.showThemeToggle)??!0)&&a.jsxs("div",{className:"hidden md:flex items-center gap-2 mr-2",children:[a.jsx(Wo,{id:`store-theme-switcher-${o}`,checked:k,onCheckedChange:q,"aria-label":"Toggle dark mode"}),k?a.jsx(nC,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(rC,{className:"h-5 w-5 text-muted-foreground"})]}),a.jsx(U,{variant:"ghost",size:"icon",className:"hidden md:flex text-muted-foreground hover:text-primary",style:{"--hover-color":r.primaryColor},children:a.jsx(lh,{className:"h-5 w-5"})}),a.jsxs(U,{variant:"outline",className:"relative",onClick:()=>b(!0),style:{borderColor:r.primaryColor,color:r.primaryColor},children:[a.jsx(bp,{className:"h-5 w-5"}),A>0&&a.jsx(qp,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center text-xs",style:{backgroundColor:r.secondaryColor||"red"},children:A}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Cart"})]}),a.jsx(U,{variant:"ghost",size:"icon",className:"md:hidden text-muted-foreground hover:text-primary",onClick:()=>E(!0),style:{"--hover-color":r.primaryColor},children:a.jsx(YV,{className:"h-6 w-6"})})]})]})}),a.jsx(Eu,{children:x&&a.jsxs(It.div,{initial:{opacity:0,x:"100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"100%"},transition:{type:"spring",stiffness:300,damping:30},className:"fixed inset-0 z-50 bg-background p-6 md:hidden",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Us,{to:H,className:"group",onClick:()=>E(!1),children:(k?s:i)?a.jsx("img",{src:k?s:i,alt:`${n} logo`,className:"h-16 w-16 object-contain"}):s||i?a.jsx("img",{src:s||i,alt:`${n} logo (fallback)`,className:"h-16 w-16 object-contain"}):null}),D&&(s||i)&&a.jsx(U,{variant:"outline",size:"icon",onClick:()=>{z(),E(!1)},className:"h-8 w-8 p-0 -ml-2 relative z-10 bg-background hover:bg-muted",children:a.jsx(kv,{className:"h-4 w-4"})}),a.jsx(Us,{to:H,className:"group ml-2",onClick:()=>E(!1),children:a.jsx("span",{className:"font-bold text-xl",style:{color:r.primaryColor},children:a.jsx($n,{initialText:n,onSave:G=>M("storeName",G),isAdmin:D,placeholder:"Store Name"})})})]})," ",a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>E(!1),children:a.jsx(ra,{className:"h-6 w-6"})})]}),a.jsxs("nav",{className:"flex flex-col gap-y-4",children:[J.map((G,F)=>a.jsx("a",{href:G.href,onClick:ue=>O(ue,G.href),className:"text-lg font-medium text-foreground hover:text-primary transition-colors",style:{"--hover-color":r.primaryColor},children:a.jsx($n,{initialText:G.label,onSave:ue=>M("navLink",ue,F),isAdmin:D,placeholder:`Link ${F+1}`})},G.label+F)),((l==null?void 0:l.showThemeToggle)??!0)&&a.jsxs("div",{className:"flex items-center gap-2 mt-4 pt-4 border-t border-border",children:[a.jsx(Wo,{id:`mobile-store-theme-switcher-${o}`,checked:k,onCheckedChange:q,"aria-label":"Toggle dark mode"}),k?a.jsx(nC,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(rC,{className:"h-5 w-5 text-muted-foreground"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:k?"Dark Mode":"Light Mode"})]})]})]})}),a.jsx(Eu,{children:v&&a.jsx(th.Root,{open:v,onOpenChange:b,children:a.jsxs(th.Portal,{children:[a.jsx(th.Overlay,{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm"}),a.jsxs(th.Content,{className:"fixed z-50 inset-y-0 right-0 h-full w-full max-w-md bg-background border-l shadow-xl flex flex-col",as:It.div,initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30},children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Your Cart"}),a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>b(!1),children:a.jsx(ra,{className:"h-5 w-5"})})]}),P.length===0?a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 text-center",children:[a.jsx(bp,{className:"h-16 w-16 text-muted-foreground mb-4"}),a.jsx("p",{className:"text-lg font-medium",children:"Your cart is empty"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Looks like you haven't added anything yet."}),a.jsx(U,{onClick:()=>b(!1),className:"mt-6",style:{backgroundColor:r.primaryColor},children:"Continue Shopping"})]}):a.jsxs(a.Fragment,{children:[a.jsx(Zi,{className:"flex-1 p-6",children:a.jsx("div",{className:"space-y-4",children:P.map(G=>{var F,ue,Ee,Se;return a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("img",{src:((ue=(F=G.image)==null?void 0:F.src)==null?void 0:ue.tiny)||((Se=(Ee=G.image)==null?void 0:Ee.src)==null?void 0:Se.medium)||`https://via.placeholder.com/80x80.png?text=${G.name.substring(0,1)}`,alt:G.name,className:"w-20 h-20 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-medium text-sm line-clamp-1",children:G.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Price: $",G.price.toFixed(2)]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(U,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>f(G.id,o,G.quantity-1),children:a.jsx("span",{className:"text-lg leading-none",children:"-"})}),a.jsx("span",{className:"text-sm w-4 text-center",children:G.quantity}),a.jsx(U,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>f(G.id,o,G.quantity+1),children:a.jsx("span",{className:"text-lg leading-none",children:"+"})})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-semibold text-sm",children:["$",(G.price*G.quantity).toFixed(2)]}),a.jsx(U,{variant:"ghost",size:"icon",className:"h-7 w-7 mt-1 text-muted-foreground hover:text-destructive",onClick:()=>h(G.id,o),children:a.jsx(sr,{className:"h-4 w-4"})})]})]},G.id)})})}),a.jsx(Da,{}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex justify-between font-medium",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:["$",R.toFixed(2)]})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Shipping and taxes calculated at checkout."}),a.jsx(U,{className:"w-full",size:"lg",style:{backgroundColor:r.primaryColor},onClick:V,children:"Proceed to Checkout"})]})]})]})]})})}),D&&a.jsx(jke,{open:S,onOpenChange:I,storeId:o,storeName:n,currentLogoUrl:i,currentLogoUrlLight:s,currentLogoUrlDark:i,onLogoReplaced:W})]})},th={Root:({children:t,...e})=>a.jsx("div",{...e,children:t}),Portal:({children:t})=>a.jsx(a.Fragment,{children:t}),Overlay:ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:Et("fixed inset-0 z-50",t),...e})),Content:ht.forwardRef(({className:t,children:e,...n},r)=>a.jsx("div",{ref:r,className:Et("fixed z-50",t),...n,children:e}))};th.Overlay.displayName="DialogPrimitive.Overlay";th.Content.displayName="DialogPrimitive.Content";const Dke=Object.freeze(Object.defineProperty({__proto__:null,default:UH},Symbol.toStringTag,{value:"Module"})),BH=({store:t,isPublishedView:e=!1})=>{const{name:n,theme:r,id:s,content:i}=t,{updateStore:o}=Fn(),l=!e,c=new Date().getFullYear(),u=[{icon:Yse,href:"#",label:"Facebook"},{icon:_x,href:"#",label:"Instagram"},{icon:wie,href:"#",label:"Twitter"},{icon:rie,href:"#",label:"LinkedIn"},{icon:Cie,href:"#",label:"YouTube"}],h=[{href:`/store/${s}`,label:"Home"},{href:`#products-${s}`,label:"Products"},{href:"#",label:"About Us"},{href:"#",label:"Contact"},{href:"#",label:"FAQ"},{href:"#",label:"Privacy Policy"},{href:"#",label:"Terms of Service"},{href:"#",label:"Shipping Info"},{href:"#",label:"Returns"}],f=i!=null&&i.footerNavLinks&&Array.isArray(i.footerNavLinks)&&i.footerNavLinks.length>0?i.footerNavLinks.map((k,C)=>{var T,P;return{href:k.href||((T=h[C])==null?void 0:T.href)||"#",label:k.label||((P=h[C])==null?void 0:P.label)||`Link ${C+1}`}}):h,m=()=>{window.scrollTo({top:0,behavior:"smooth"})},g=async(k,C,T=null)=>{if(s)try{if(k.startsWith("content.footerNavLinks")){const P=f.map((A,R)=>R===T?{...A,label:C}:A);await o(s,{content:{...i,footerNavLinks:P}})}else{const P=k.split(".");P.length===2&&P[0]==="content"?await o(s,{content:{...i,[P[1]]:C}}):console.warn("Unsupported identifier for footer text save:",k)}}catch(P){console.error(`Failed to update store footer text for ${k}:`,P)}},x=(i==null?void 0:i.footerStoreInfo)||`Your favorite destination for ${t.type||"quality products"}. We are committed to bringing you the best experience with premium quality and exceptional service.`,E=(i==null?void 0:i.footerQuickLinksTitle)||"Quick Links",v=(i==null?void 0:i.footerCustomerServiceTitle)||"Customer Service",b=(i==null?void 0:i.footerContactUsTitle)||"Contact Us",S=(i==null?void 0:i.footerAddress)||"123 Store Street, Cityville, ST 12345",I=(i==null?void 0:i.footerPhoneNumber)||"(123) 456-7890",D=(i==null?void 0:i.footerCopyrightSuffix)||"All Rights Reserved. Powered by FreshFront.";return a.jsxs("footer",{className:"bg-muted dark:bg-slate-900 text-muted-foreground relative overflow-hidden",id:`contact-${s}`,children:[a.jsx(It.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},viewport:{once:!0},className:"pt-16 pb-8",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-xl font-bold text-foreground font-poppins",style:{color:r.primaryColor},children:n}),a.jsx("div",{className:"text-sm",children:a.jsx($n,{initialText:x,onSave:k=>g("content.footerStoreInfo",k),isAdmin:l,placeholder:"Store information paragraph",useTextarea:!0,textClassName:"text-sm"})}),a.jsx("div",{className:"flex space-x-3 pt-2",children:u.map(k=>a.jsx("a",{href:k.href,"aria-label":k.label,className:"p-2 rounded-full bg-background/50 hover:bg-primary/10 hover:scale-110 transition-all duration-300",style:{"--hover-bg-color":`${r.primaryColor}1A`,"--hover-text-color":r.primaryColor},children:a.jsx(k.icon,{className:"h-5 w-5"})},k.label))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx($n,{initialText:E,onSave:k=>g("content.footerQuickLinksTitle",k),isAdmin:l,placeholder:"Quick Links Title",textClassName:"font-bold text-foreground"})}),a.jsx("ul",{className:"space-y-2",children:f.slice(0,5).map((k,C)=>a.jsx("li",{children:a.jsx("a",{href:k.href,className:"text-sm hover:text-primary transition-colors hover:translate-x-1 inline-block hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:a.jsx($n,{initialText:k.label,onSave:T=>g("content.footerNavLinks",T,C),isAdmin:l,placeholder:`Link ${C+1}`,textClassName:"text-sm"})})},k.label+C))})]}),a.jsxs(It.div,{variants:{hidden:{opacity:0,x:-30},visible:{opacity:1,x:0,transition:{duration:.5,ease:"easeOut",delay:.2}}},children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx($n,{initialText:v,onSave:k=>g("content.footerCustomerServiceTitle",k),isAdmin:l,placeholder:"Customer Service Title",textClassName:"font-bold text-foreground"})}),a.jsx("ul",{className:"space-y-2",children:f.slice(5).map((k,C)=>a.jsx("li",{children:a.jsx("a",{href:k.href,className:"text-sm hover:text-primary transition-colors hover:translate-x-1 inline-block hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:a.jsx($n,{initialText:k.label,onSave:T=>g("content.footerNavLinks",T,C+5),isAdmin:l,placeholder:`Link ${C+6}`,textClassName:"text-sm"})})},k.label+C+5))})]}),a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx($n,{initialText:b,onSave:k=>g("content.footerContactUsTitle",k),isAdmin:l,placeholder:"Contact Us Title",textClassName:"font-bold text-foreground"})}),a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(sie,{className:"h-5 w-5 mt-0.5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsx($n,{initialText:S,onSave:k=>g("content.footerAddress",k),isAdmin:l,placeholder:"Store Address",useTextarea:!0,textClassName:"text-sm"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Gd,{className:"h-5 w-5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsxs("a",{href:`mailto:info@${n.toLowerCase().replace(/\s+/g,"")}.com`,className:"hover:text-primary hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:["info@",n.toLowerCase().replace(/\s+/g,""),".com"]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(hie,{className:"h-5 w-5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsx($n,{initialText:I,onSave:k=>g("content.footerPhoneNumber",k),isAdmin:l,placeholder:"Store Phone Number",textClassName:"text-sm hover:text-primary hover:underline decoration-primary/30 underline-offset-4"})]})]})]}),a.jsxs("div",{className:"border-t border-border/50 pt-6 flex flex-col md:flex-row justify-between items-center text-sm",children:[a.jsxs("p",{children:["© ",c," ",n,". ",a.jsx($n,{initialText:D,onSave:k=>g("content.footerCopyrightSuffix",k),isAdmin:l,placeholder:"Copyright suffix",textClassName:"text-sm",as:"span"})]}),a.jsx("div",{className:"flex items-center mt-4 md:mt-0",children:a.jsx(U,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-primary/10 transition-all duration-300",onClick:m,style:{"--hover-bg-color":`${r.primaryColor}1A`},children:a.jsx(Use,{className:"h-5 w-5",style:{color:r.primaryColor}})})})]})]})}),a.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary/5 rounded-full translate-x-1/2 -translate-y-1/2 blur-3xl"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-secondary/5 rounded-full -translate-x-1/3 translate-y-1/3 blur-3xl"})]})},Mke=Object.freeze(Object.defineProperty({__proto__:null,default:BH},Symbol.toStringTag,{value:"Module"})),Lke=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),Fke=({open:t,onOpenChange:e,product:n,onVideoGenerated:r})=>{var I,D,k,C;const[s,i]=p.useState(""),[o,l]=p.useState(null),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(!1),[g,x]=p.useState(null),{toast:E}=Ks(),v=((D=(I=n==null?void 0:n.image)==null?void 0:I.src)==null?void 0:D.large)||((C=(k=n==null?void 0:n.image)==null?void 0:k.src)==null?void 0:C.medium);p.useEffect(()=>{t&&v&&(x(null),i(""),l(null),u(null),Lke(v).then(T=>{l(T.base64ImageData),u(T.mimeType)}).catch(T=>{console.error("Error loading product image data:",T),x(`Failed to load product image: ${T.message}`),E({title:"Error",description:`Failed to load product image: ${T.message}`,variant:"destructive"})}))},[t,v,E]);const b=async()=>{if(!o||!c){E({title:"Error",description:"Product image data is not available to suggest a prompt.",variant:"destructive"});return}h(!0),x(null);try{const T=await Wd(o,c);i(T)}catch(T){console.error("Error generating prompt suggestion:",T),x(`Failed to suggest prompt: ${T.message}`),E({title:"Suggestion Failed",description:`Could not suggest a prompt: ${T.message}`,variant:"destructive"})}finally{h(!1)}},S=async()=>{if(!s.trim()){x("Please enter a prompt for the video.");return}if(!o||!c){x("Product image data is not available.");return}m(!0),x(null);try{const T=await _U(s,o,c);r&&r(T),e(!1)}catch(T){console.error("Error generating product video:",T),x(T.message||"Failed to generate video. Please try again."),E({title:"Video Generation Failed",description:T.message,variant:"destructive"})}finally{m(!1)}};return n?a.jsx(Ps,{open:t,onOpenChange:e,children:a.jsxs(ls,{className:"sm:max-w-lg",children:[a.jsxs(cs,{children:[a.jsx(us,{children:"Generate Product Video"}),a.jsxs(No,{children:['Create a short video for "',n.name,'" using its image and a prompt.']})]}),a.jsxs("div",{className:"grid gap-4 py-4",children:[v&&a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx("img",{src:v,alt:n.name,className:"w-32 h-32 object-contain rounded border"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Using this image as the base."})]}),a.jsxs("div",{className:"grid w-full gap-1.5",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(je,{htmlFor:"video-prompt",children:"Video Prompt"}),a.jsxs(U,{variant:"outline",size:"sm",onClick:b,disabled:d||f||!o,children:[d?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ll,{className:"mr-2 h-4 w-4"}),"Suggest"]})]}),a.jsx(Vn,{id:"video-prompt",value:s,onChange:T=>i(T.target.value),placeholder:"e.g., A dynamic shot of the product with vibrant background...",rows:4,disabled:d||f}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"AI will use the product image and this prompt to create a video."})]}),g&&a.jsx("p",{className:"text-sm text-red-500 col-span-4 text-center",children:g})]}),a.jsxs(jr,{children:[a.jsx(ja,{asChild:!0,children:a.jsx(U,{variant:"outline",disabled:f,children:"Cancel"})}),a.jsxs(U,{onClick:S,disabled:d||f||!s.trim()||!o,children:[f?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ll,{className:"mr-2 h-4 w-4"}),"Generate Video"]})]})]})}):null};var CA="Progress",TA=100,[Oke,sje]=Li(CA),[$ke,Vke]=Oke(CA),zH=p.forwardRef((t,e)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=Uke,...o}=t;(s||s===0)&&!gF(s)&&console.error(Bke(`${s}`,"Progress"));const l=gF(s)?s:TA;r!==null&&!yF(r,l)&&console.error(zke(`${r}`,"Progress"));const c=yF(r,l)?r:null,u=Mw(c)?i(c,l):void 0;return a.jsx($ke,{scope:n,value:c,max:l,children:a.jsx(Yt.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":Mw(c)?c:void 0,"aria-valuetext":u,role:"progressbar","data-state":HH(c,l),"data-value":c??void 0,"data-max":l,...o,ref:e})})});zH.displayName=CA;var GH="ProgressIndicator",WH=p.forwardRef((t,e)=>{const{__scopeProgress:n,...r}=t,s=Vke(GH,n);return a.jsx(Yt.div,{"data-state":HH(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:e})});WH.displayName=GH;function Uke(t,e){return`${Math.round(t/e*100)}%`}function HH(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function Mw(t){return typeof t=="number"}function gF(t){return Mw(t)&&!isNaN(t)&&t>0}function yF(t,e){return Mw(t)&&!isNaN(t)&&t<=e&&t>=0}function Bke(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${TA}\`.`}function zke(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${TA} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var qH=zH,Gke=WH;const IA=p.forwardRef(({className:t,value:e,...n},r)=>a.jsx(qH,{ref:r,className:Et("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:a.jsx(Gke,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));IA.displayName=qH.displayName;const xF="msy_4wQeZBKbKsyGKmfCOGWk0Ux9F7zGIByWSgwC",vF="https://api.meshy.ai/openapi/v1",Wke=({open:t,onOpenChange:e,product:n,storeId:r,onModelGenerated:s})=>{const{toast:i}=Ks(),[o,l]=p.useState([]),[c,u]=p.useState(null),[d,h]=p.useState(0),[f,m]=p.useState(""),[g,x]=p.useState(""),[E,v]=p.useState(!1),[b,S]=p.useState(null),I=p.useCallback(()=>{var A,R,M,j,z,W,q;return n?(R=(A=n.image)==null?void 0:A.src)!=null&&R.large||(j=(M=n.image)==null?void 0:M.src)!=null&&j.medium?[{name:"Main Product Image",url:n.image.src.large||n.image.src.medium}]:((W=(z=n.images)==null?void 0:z.edges)==null?void 0:W.length)>0&&((q=n.images.edges[0].node)!=null&&q.url)?n.images.edges.map((H,$)=>({name:`Product Image ${$+1}`,url:H.node.url})).slice(0,4):[]:[]},[n]);p.useEffect(()=>{t&&n?(l(I().slice(0,1)),u(null),h(0),m(""),x(""),v(!1),b&&(clearInterval(b),S(null))):!t&&b&&(clearInterval(b),S(null))},[t,n,I,b]);const D=A=>{const R=Array.from(A.target.files);if(R.length===0)return;const M=[];let j=o.length;R.forEach(z=>{if(j>=4){i({title:"Limit Reached",description:"You can select up to 4 images.",variant:"warning"});return}const W=new FileReader;W.onload=q=>{M.push({name:z.name,url:q.target.result,file:z}),M.length===Math.min(R.length,4-o.length)&&l(H=>[...H,...M].slice(0,4))},W.readAsDataURL(z),j++})},k=A=>{l(R=>R.filter((M,j)=>j!==A))},C=async()=>{if(o.length===0){i({title:"No Image Selected",description:"Please select at least one image.",variant:"destructive"});return}v(!0),x(""),m("PENDING"),h(5);const A=o.length>1?"/multi-image-to-3d":"/image-to-3d",R=o.length>1?{image_urls:o.map(M=>M.url)}:{image_url:o[0].url};R.enable_pbr=!0,R.should_texture=!0,o.length===1&&(n!=null&&n.name);try{const M=await fetch(`${vF}${A}`,{method:"POST",headers:{Authorization:`Bearer ${xF}`,"Content-Type":"application/json"},body:JSON.stringify(R)}),j=await M.json();if(!M.ok)throw new Error(j.detail||j.message||`API Error: ${M.status}`);if(j.result){u(j.result),m("IN_PROGRESS"),h(10);const z=setInterval(()=>T(j.result,A),5e3);S(z)}else throw new Error("Task ID not found in response.")}catch(M){console.error("Error creating Meshy task:",M),x(`Error creating task: ${M.message}`),m("FAILED"),v(!1)}},T=async(A,R)=>{var M,j;try{const z=await fetch(`${vF}${R}/${A}`,{headers:{Authorization:`Bearer ${xF}`}}),W=await z.json();if(!z.ok){if(z.status===404&&d<30){h(q=>Math.min(q+5,30));return}throw new Error(W.detail||W.message||`API Error: ${z.status}`)}if(h(W.progress||d),m(W.status),W.status==="SUCCEEDED")if(b&&clearInterval(b),S(null),v(!1),(M=W.model_urls)!=null&&M.glb)s(W.model_urls.glb),i({title:"3D Model Generated!",description:"The model has been successfully created."}),e(!1);else throw new Error("GLB model URL not found in successful response.");else W.status==="FAILED"?(b&&clearInterval(b),S(null),x(((j=W.task_error)==null?void 0:j.message)||"Generation failed for an unknown reason."),v(!1)):(W.status==="PENDING"||W.status==="IN_PROGRESS")&&W.progress===100&&W.status==="IN_PROGRESS"&&h(99)}catch(z){console.error("Error polling Meshy task status:",z),x(`Error polling status: ${z.message}`),b&&clearInterval(b),S(null),m("FAILED"),v(!1)}},P=()=>{b&&(clearInterval(b),S(null)),e(!1)};return a.jsx(Ps,{open:t,onOpenChange:P,children:a.jsxs(ls,{className:"sm:max-w-lg",children:[a.jsx(cs,{children:a.jsxs(us,{children:["Generate 3D Model for ",(n==null?void 0:n.name)||(n==null?void 0:n.title)||"Product"]})}),a.jsxs("div",{className:"py-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"image-upload",children:"Product Images (select 1-4)"}),a.jsxs("div",{className:"mt-2 grid grid-cols-2 sm:grid-cols-4 gap-2 mb-2",children:[o.map((A,R)=>a.jsxs("div",{className:"relative group aspect-square border rounded-md overflow-hidden",children:[a.jsx("img",{src:A.url,alt:A.name,className:"w-full h-full object-cover"}),a.jsx(U,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 opacity-50 group-hover:opacity-100",onClick:()=>k(R),disabled:E||f==="IN_PROGRESS",children:a.jsx(sr,{size:14})})]},R)),o.length<4&&a.jsxs(je,{htmlFor:"image-upload-input",className:"aspect-square border-2 border-dashed rounded-md flex flex-col items-center justify-center cursor-pointer hover:border-primary transition-colors text-muted-foreground",children:[a.jsx(Jo,{size:24,className:"mb-1"}),a.jsx("span",{className:"text-xs",children:"Add Image"})]})]}),a.jsx(st,{id:"image-upload-input",type:"file",multiple:!0,accept:"image/png, image/jpeg, image/jpg",onChange:D,className:"hidden",disabled:E||f==="IN_PROGRESS"||o.length>=4}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Default is main product image. You can add up to 4 images (PNG, JPG). More images can improve quality."})]}),f&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs(je,{children:["Status: ",f]}),f==="SUCCEEDED"&&a.jsx(Yo,{className:"h-5 w-5 text-green-500"}),f==="FAILED"&&a.jsx(Dv,{className:"h-5 w-5 text-red-500"}),(f==="PENDING"||f==="IN_PROGRESS")&&a.jsx(St,{className:"h-5 w-5 animate-spin"})]}),a.jsx(IA,{value:d,className:"w-full"}),g&&a.jsx("p",{className:"text-sm text-red-500",children:g})]})]}),a.jsxs(jr,{children:[a.jsx(U,{type:"button",variant:"outline",onClick:P,disabled:E&&f==="IN_PROGRESS",children:"Cancel"}),a.jsxs(U,{type:"button",onClick:C,disabled:E||o.length===0||f==="IN_PROGRESS"||f==="SUCCEEDED",children:[E&&(f==="PENDING"||f==="IN_PROGRESS")?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):null,f==="IN_PROGRESS"?"Generating...":"Generate 3D Model"]})]})]})})},Hke=({modelUrl:t,thumbnailUrl:e,productName:n="Product",className:r="",height:s="400px",showControls:i=!0,autoRotate:o=!1,cameraControls:l=!0,ar:c=!0})=>{const u=p.useRef(null);p.useEffect(()=>{if(!window.customElements.get("model-viewer")){const m=document.createElement("script");m.type="module",m.src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js",document.head.appendChild(m)}},[]);const d=()=>{u.current&&(u.current.resetTurntableRotation(),u.current.jumpCameraToGoal())},h=()=>{u.current&&u.current.requestFullscreen&&u.current.requestFullscreen()},f=()=>{if(t){const m=document.createElement("a");m.href=t,m.download=`${n.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_3d_model.glb`,document.body.appendChild(m),m.click(),document.body.removeChild(m)}};return t?a.jsx(We,{className:r,children:a.jsxs(tt,{className:"p-0 relative",children:[a.jsxs("model-viewer",{ref:u,src:t,poster:e,alt:`3D model of ${n}`,style:{width:"100%",height:s,backgroundColor:"#f8f9fa"},"camera-controls":l,"auto-rotate":o,ar:c,"ar-modes":"webxr scene-viewer quick-look","environment-image":"neutral","shadow-intensity":"1",exposure:"1","tone-mapping":"neutral",loading:"eager",children:[a.jsx("div",{slot:"progress-bar",className:"absolute inset-0 flex items-center justify-center bg-background/80",children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading 3D model..."})]})}),a.jsx("div",{slot:"error",className:"absolute inset-0 flex items-center justify-center bg-background",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-destructive mb-2",children:"Failed to load 3D model"}),a.jsx(U,{variant:"outline",size:"sm",onClick:()=>window.location.reload(),children:"Retry"})]})})]}),i&&a.jsxs("div",{className:"absolute top-2 right-2 flex flex-col space-y-1",children:[a.jsx(U,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:d,title:"Reset camera",children:a.jsx(pie,{className:"h-4 w-4"})}),a.jsx(U,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:h,title:"Fullscreen",children:a.jsx(iie,{className:"h-4 w-4"})}),a.jsx(U,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:f,title:"Download model",children:a.jsx(HV,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"absolute bottom-2 right-2"})]})}):a.jsx(We,{className:r,children:a.jsx(tt,{className:"flex items-center justify-center p-6",style:{height:s},children:a.jsx("p",{className:"text-muted-foreground",children:"No 3D model available"})})})},qke=({product:t,storeId:e,isPublishedView:n=!1})=>{const{toast:r}=Ks(),{getStoreById:s}=Fn(),[i,o]=p.useState(null),[l,c]=p.useState(null),[u,d]=p.useState(""),[h,f]=p.useState([]),[m,g]=p.useState([]),[x,E]=p.useState(null),[v,b]=p.useState(!1),[S,I]=p.useState(""),[D,k]=p.useState("#FFFFFF"),[C,T]=p.useState({}),[P,A]=p.useState(""),[R,M]=p.useState(""),[j,z]=p.useState(!1),[W,q]=p.useState(!1);p.useEffect(()=>{if(e){const V=s(e);o(V),V&&t&&f(V.products.filter(G=>{var F,ue;return G.id!==t.id&&((ue=(F=G.image)==null?void 0:F.src)==null?void 0:ue.medium)}))}},[e,t,s]);const H=V=>{const G=V.target.files[0];if(G){G.size>5*1024*1024&&r({title:"File too large",description:"Reference image should ideally be under 5MB.",variant:"destructive"}),c(G);const F=new FileReader;F.onloadend=()=>d(F.result),F.readAsDataURL(G),E(null),A(""),M("")}},$=()=>{c(null),d(""),E(null),A(""),M("")},J=V=>{g(G=>G.find(F=>F.id===V.id)?G.filter(F=>F.id!==V.id):[...G,V]),E(null),A(""),M("")},O=async()=>{var F,ue,Ee,Se;if(!t||!l){r({title:"Missing inputs",description:"Main product and a reference image are required.",variant:"destructive"});return}b(!0),E(null),A(""),M("Generating visualization, please wait...");let V=S;D&&D!=="#FFFFFF"&&(V=`${V} The main product's color should be ${D}.`.trim());const G=Object.entries(C);if(G.length>0){const we=G.map(([Fe,Ze])=>`${Fe}: ${Ze}`).join(", ");V=`${V} Apply these product attributes: ${we}.`.trim()}try{const we={name:t.name,description:t.description,imageSource:((ue=(F=t.image)==null?void 0:F.src)==null?void 0:ue.large)||((Se=(Ee=t.image)==null?void 0:Ee.src)==null?void 0:Se.medium)},Fe=m.map(ze=>{var nt,qe,yt,Le;return{name:ze.name,description:ze.description,imageSource:((qe=(nt=ze.image)==null?void 0:nt.src)==null?void 0:qe.large)||((Le=(yt=ze.image)==null?void 0:yt.src)==null?void 0:Le.medium)}}),Ze=await LH({mainProduct:we,referenceSceneSource:l,additionalProducts:Fe,customInstructions:V});A(Ze.promptUsed||"Prompt details not available."),M(Ze.commentary||"Processing complete."),Ze&&Ze.imageUrl?(E(Ze.imageUrl),r({title:"Visualization Generated!",description:Ze.commentary||"Image created."})):r({title:"Visualization Issue",description:Ze.commentary||"No image generated by AI.",variant:"default",duration:7e3})}catch(we){console.error("Error in ProductVisualizer calling generateProductVisualization:",we);const Fe=we.message||"An unknown error occurred during visualization.";M(`Error: ${Fe}`),r({title:"Visualization Failed",description:Fe,variant:"destructive",duration:1e4})}finally{b(!1)}};return!t||!i?a.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"Initializing Product Visualizer..."}):a.jsxs("div",{className:"my-8 border rounded-lg shadow-sm bg-card",children:[a.jsxs("div",{className:"p-4 md:p-6 cursor-pointer flex justify-between items-center",onClick:()=>q(!W),role:"button",tabIndex:0,onKeyDown:V=>(V.key==="Enter"||V.key===" ")&&q(!W),"aria-expanded":W,"aria-controls":"product-visualizer-content-area",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl md:text-2xl font-semibold",children:"Product Visualizer"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["See how ",a.jsx("span",{className:"font-medium text-primary",children:t.name})," looks in different settings."]})]}),a.jsx(U,{variant:"ghost",size:"icon","aria-label":W?"Collapse visualizer":"Expand visualizer",children:W?a.jsx(GV,{className:"h-6 w-6"}):a.jsx(f0,{className:"h-6 w-6"})})]}),W&&a.jsxs("div",{id:"product-visualizer-content-area",className:"p-4 md:p-6 border-t",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[a.jsxs("div",{className:"space-y-4 md:space-y-6",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"visualizer-reference-image-upload",className:"text-md font-medium block mb-1",children:"1. Upload Reference Scene"}),a.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"E.g., a room, a model. (Max ~5MB recommended)"}),u?a.jsxs("div",{className:"relative group aspect-video rounded-md border overflow-hidden bg-muted/20",children:[a.jsx("img",{src:u,alt:"Reference scene preview",className:"w-full h-full object-contain"}),a.jsx(U,{variant:"destructive",size:"icon",className:"absolute top-2 right-2 opacity-50 group-hover:opacity-100 transition-opacity",onClick:$,"aria-label":"Remove reference image",children:a.jsx(ra,{className:"h-4 w-4"})})]}):a.jsxs("label",{htmlFor:"visualizer-reference-image-input",className:"mt-1 flex flex-col justify-center items-center w-full h-40 md:h-48 px-6 py-5 border-2 border-dashed rounded-md cursor-pointer hover:border-primary transition-colors",children:[a.jsx(Jo,{className:"mx-auto h-8 md:h-10 w-8 md:w-10 text-muted-foreground mb-2"}),a.jsx("span",{className:"font-semibold text-primary text-sm",children:"Click to upload image"}),a.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG, GIF, WEBP"}),a.jsx(st,{id:"visualizer-reference-image-input",type:"file",className:"sr-only",accept:"image/*",onChange:H})]})]}),h.length>0&&a.jsxs("div",{children:[a.jsx(je,{className:"text-md font-medium block mb-1",children:"2. Add Other Products (Optional)"}),a.jsx(Zi,{className:"h-32 md:h-40 border rounded-md p-2",children:a.jsx("div",{className:"space-y-1.5",children:h.map(V=>a.jsxs("div",{className:`flex items-center justify-between p-2 rounded-md cursor-pointer transition-all text-sm ${m.some(G=>G.id===V.id)?"bg-primary/10 ring-1 ring-primary":"hover:bg-muted/50"}`,onClick:()=>J(V),role:"checkbox","aria-checked":m.some(G=>G.id===V.id),tabIndex:0,onKeyDown:G=>(G.key==="Enter"||G.key===" ")&&J(V),children:[a.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[a.jsx("img",{src:V.image.src.medium,alt:V.name,className:"w-8 h-8 object-cover rounded flex-shrink-0"}),a.jsx("span",{className:"truncate",title:V.name,children:V.name})]}),m.some(G=>G.id===V.id)&&a.jsx(Yo,{className:"h-4 w-4 text-primary flex-shrink-0"})]},V.id))})})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"visualizer-product-color",className:"text-md font-medium block mb-1",children:"3. Main Product Color (Optional)"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(st,{type:"color",id:"visualizer-product-color",value:D,onChange:V=>k(V.target.value),className:"w-12 h-10 p-1"}),a.jsx(st,{type:"text",value:D,onChange:V=>k(V.target.value),placeholder:"#FFFFFF",className:"flex-grow h-10 text-sm"})]})]}),t.variants&&t.variants.length>0&&a.jsxs("div",{children:[a.jsx(je,{className:"text-md font-medium block mb-1",children:"3. Main Product Variants (Optional)"}),a.jsx("div",{className:"space-y-2",children:t.variants.map(V=>!V.name||!V.values||V.values.length===0?null:a.jsxs("div",{children:[a.jsx(je,{htmlFor:`visualizer-variant-${V.name}`,className:"text-sm text-muted-foreground",children:V.name}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:V.values.map(G=>a.jsx(U,{variant:C[V.name]===G?"default":"outline",size:"xs",onClick:()=>T(F=>({...F,[V.name]:G})),className:"text-xs px-2 py-1 h-auto",children:G},G))})]},V.name))})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"visualizer-custom-prompt",className:"text-md font-medium block mb-1",children:t.variants&&t.variants.length>0?"5. Additional Custom Instructions (Optional)":"4. Custom Instructions (Optional)"}),a.jsx(Vn,{id:"visualizer-custom-prompt",placeholder:"e.g., 'place the sofa by the window', 'make it a sunny day'",value:S,onChange:V=>I(V.target.value),rows:2,className:"resize-none text-sm"})]}),a.jsxs(U,{onClick:O,disabled:v||!l,className:"w-full py-2.5 text-sm md:text-base",size:"lg",children:[v?a.jsx(St,{className:"mr-2 h-5 w-5 animate-spin"}):a.jsx(na,{className:"mr-2 h-5 w-5"}),"Generate Visualization"]})]}),a.jsx("div",{className:"flex flex-col items-center justify-center border rounded-md p-2 md:p-4 bg-muted/30 min-h-[250px] md:min-h-[300px] lg:min-h-full relative",children:v?a.jsxs("div",{className:"text-center",children:[a.jsx(St,{className:"h-12 w-12 animate-spin text-primary mb-3"}),a.jsx("p",{className:"text-muted-foreground font-medium",children:R||"Generating your scene..."})]}):x?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:x,alt:"Generated Product Visualization",className:"max-w-full max-h-[calc(100%-40px)] object-contain rounded-md"}),R&&!R.toLowerCase().includes("error")&&a.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center max-w-xs mx-auto",children:R}),a.jsxs(U,{variant:"ghost",size:"sm",onClick:()=>z(!j),className:"absolute bottom-1 right-1 text-muted-foreground hover:text-primary h-auto p-1","aria-label":"Toggle prompt information",children:[a.jsx(Zse,{className:"h-4 w-4 mr-1"})," ",a.jsx("span",{className:"text-xs",children:"Info"})]})]}):a.jsxs("div",{className:"text-center text-muted-foreground p-4",children:[R&&a.jsx("p",{className:`text-sm mb-2 ${R.toLowerCase().includes("error")||R.toLowerCase().includes("failed")?"text-destructive":""}`,children:R}),a.jsx(na,{className:"h-12 w-12 mx-auto mb-3"}),a.jsx("p",{className:"font-medium",children:"Your product visualization will appear here."}),!x&&a.jsx("p",{className:"text-xs mt-1",children:'Upload a reference scene and click "Generate".'})]})})]}),j&&P&&!n&&a.jsxs("div",{className:"mt-4 p-3 border rounded-md bg-muted/50",children:[a.jsx(je,{className:"text-xs font-semibold text-muted-foreground",children:"Technical Prompt Sent to AI:"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1 whitespace-pre-wrap",children:P})]}),a.jsx(Da,{className:"mt-6 md:mt-8 mb-0"})]})]})};var KH=p.forwardRef(({transition:t,...e},n)=>{let r={position:"absolute",top:0,left:0,width:"100%",height:"100%",transition:t?`clip-path ${t}`:void 0,userSelect:"none",willChange:"clip-path, transition",KhtmlUserSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none"};return a.jsx("div",{...e,style:r,"data-rcs":"clip-item",ref:n})});KH.displayName="ContainerClip";var YH=p.forwardRef(({children:t,disabled:e,portrait:n,position:r,transition:s},i)=>{let o={position:"absolute",top:0,width:n?"100%":void 0,height:n?void 0:"100%",background:"none",border:0,padding:0,pointerEvents:"all",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",outline:0,transform:n?"translate3d(0, -50% ,0)":"translate3d(-50%, 0, 0)",transition:s?`${n?"top":"left"} ${s}`:void 0};return a.jsx("button",{ref:i,"aria-label":"Drag to move or focus and use arrow keys","aria-orientation":n?"vertical":"horizontal","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":r,"data-rcs":"handle-container",disabled:e,role:"slider",style:o,children:t})});YH.displayName="ThisHandleContainer";var wF=({flip:t})=>a.jsx("div",{className:"__rcs-handle-arrow",style:{width:0,height:0,borderTop:"8px solid transparent",borderRight:"10px solid",borderBottom:"8px solid transparent",transform:t?"rotate(180deg)":void 0}}),Kke=({className:t="__rcs-handle-root",disabled:e,buttonStyle:n,linesStyle:r,portrait:s,style:i,...o})=>{let l={display:"flex",flexDirection:s?"row":"column",placeItems:"center",height:"100%",cursor:e?"not-allowed":s?"ns-resize":"ew-resize",pointerEvents:"none",color:"#fff",...i},c={flexGrow:1,height:s?2:"100%",width:s?"100%":2,backgroundColor:"currentColor",pointerEvents:"auto",boxShadow:"0 0 4px rgba(0,0,0,.5)",...r},u={display:"grid",gridAutoFlow:"column",gap:8,placeContent:"center",flexShrink:0,width:56,height:56,borderRadius:"50%",borderStyle:"solid",borderWidth:2,pointerEvents:"auto",backdropFilter:"blur(7px)",WebkitBackdropFilter:"blur(7px)",backgroundColor:"rgba(0, 0, 0, 0.125)",boxShadow:"0 0 4px rgba(0,0,0,.35)",transform:s?"rotate(90deg)":void 0,...n};return a.jsxs("div",{...o,className:t,style:l,children:[a.jsx("div",{className:"__rcs-handle-line",style:c}),a.jsxs("div",{className:"__rcs-handle-button",style:u,children:[a.jsx(wF,{}),a.jsx(wF,{flip:!0})]}),a.jsx("div",{className:"__rcs-handle-line",style:c})]})},JH=(t=>(t.ARROW_LEFT="ArrowLeft",t.ARROW_RIGHT="ArrowRight",t.ARROW_UP="ArrowUp",t.ARROW_DOWN="ArrowDown",t))(JH||{}),Yke=({boxSizing:t="border-box",objectFit:e="cover",objectPosition:n="center center",...r}={})=>({display:"block",width:"100%",height:"100%",maxWidth:"100%",boxSizing:t,objectFit:e,objectPosition:n,...r}),Jke=t=>{let e=p.useRef(t);return p.useEffect(()=>{e.current=t}),e.current},BS=(t,e,n,r)=>{let s=p.useRef();p.useEffect(()=>{s.current=e},[e]),p.useEffect(()=>{if(!(n&&n.addEventListener))return;let i=o=>s.current&&s.current(o);return n.addEventListener(t,i,r),()=>{n.removeEventListener(t,i,r)}},[t,n,r])},Xke=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect,Qke=(t,e)=>{let n=p.useRef(),r=p.useCallback(()=>{t.current&&n.current&&n.current.observe(t.current)},[t]);Xke(()=>(n.current=new ResizeObserver(([s])=>e(s.contentRect)),r(),()=>{n.current&&n.current.disconnect()}),[e,r])},ox={capture:!1,passive:!0},zS={capture:!0,passive:!1},Zke=t=>{t.preventDefault(),t.currentTarget.focus()},XH=p.forwardRef(({boundsPadding:t=0,browsingContext:e=globalThis,changePositionOnHover:n=!1,disabled:r=!1,handle:s,itemOne:i,itemTwo:o,keyboardIncrement:l="5%",onlyHandleDraggable:c=!1,onPositionChange:u,portrait:d=!1,position:h=50,style:f,transition:m,...g},x)=>{let E=p.useRef(null),v=p.useRef(null),b=p.useRef(null),S=p.useRef(h),[I,D]=p.useState(!1),[k,C]=p.useState(!0),T=p.useRef(!1),[P,A]=p.useState(),R=Jke(h),M=p.useCallback(function({x:V,y:G,isOffset:F}){let ue=E.current,Ee=b.current,Se=v.current,{width:we,height:Fe,left:Ze,top:ze}=ue.getBoundingClientRect();if(we===0||Fe===0)return;let nt=d?F?G-ze-e.scrollY:G:F?V-Ze-e.scrollX:V,qe=Math.min(Math.max(nt/(d?Fe:we)*100,0),100),yt=d?Fe/(ue.offsetHeight||1):we/(ue.offsetWidth||1),Le=t*yt/(d?Fe:we)*100,Ae=Math.min(Math.max(qe,Le*yt),100-Le*yt);S.current=qe,Ee.setAttribute("aria-valuenow",`${Math.round(S.current)}`),Ee.style.top=d?`${Ae}%`:"0",Ee.style.left=d?"0":`${Ae}%`,Se.style.clipPath=d?`inset(${Ae}% 0 0 0)`:`inset(0 0 0 ${Ae}%)`,u&&u(S.current)},[t,u,d,e]);p.useEffect(()=>{let{width:V,height:G}=E.current.getBoundingClientRect(),F=h===R?S.current:h;M({x:V/100*F,y:G/100*F})},[t,h,d,R,M]);let j=p.useCallback(V=>{V.preventDefault(),!(r||V.button!==0)&&(M({isOffset:!0,x:V.pageX,y:V.pageY}),D(!0),C(!0))},[r,M]),z=p.useCallback(function(V){M({isOffset:!0,x:V.pageX,y:V.pageY}),C(!1)},[M]),W=p.useCallback(()=>{D(!1),C(!0)},[]),q=p.useCallback(({width:V,height:G})=>{let{width:F,height:ue}=E.current.getBoundingClientRect();M({x:V/100*S.current*F/V,y:G/100*S.current*ue/G})},[M]),H=p.useCallback(V=>{if(!Object.values(JH).includes(V.key))return;V.preventDefault(),C(!0);let{top:G,left:F}=b.current.getBoundingClientRect(),{width:ue,height:Ee}=E.current.getBoundingClientRect(),Se=typeof l=="string"?parseFloat(l):l/ue*100,we=d?V.key==="ArrowLeft"||V.key==="ArrowDown":V.key==="ArrowRight"||V.key==="ArrowUp",Fe=Math.min(Math.max(we?S.current+Se:S.current-Se,0),100);M({x:d?F:ue*Fe/100,y:d?Ee*Fe/100:G})},[l,d,M]);p.useEffect(()=>{A(c?b.current:E.current)},[c]),p.useEffect(()=>{let V=E.current,G=()=>{I||W()};return n&&(V.addEventListener("pointermove",z,ox),V.addEventListener("pointerleave",G,ox)),()=>{V.removeEventListener("pointermove",z),V.removeEventListener("pointerleave",G)}},[n,z,W,I]),p.useEffect(()=>(I&&!T.current&&(e.addEventListener("pointermove",z,ox),e.addEventListener("pointerup",W,ox),T.current=!0),()=>{T.current&&(e.removeEventListener("pointermove",z),e.removeEventListener("pointerup",W),T.current=!1)}),[z,W,I,e]),p.useImperativeHandle(x,()=>({rootContainer:E.current,handleContainer:b.current,setPosition(V){let{width:G,height:F}=E.current.getBoundingClientRect();M({x:G/100*V,y:F/100*V})}}),[M]),Qke(E,q),BS("keydown",H,b.current,zS),BS("click",Zke,b.current,zS),BS("pointerdown",j,P,zS);let $=s||a.jsx(Kke,{disabled:r,portrait:d}),J=k?m:void 0,O={position:"relative",display:"flex",overflow:"hidden",cursor:I?d?"ns-resize":"ew-resize":void 0,touchAction:"none",userSelect:"none",KhtmlUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",...f};return a.jsxs("div",{...g,ref:E,style:O,"data-rcs":"root",children:[i,a.jsx(KH,{ref:v,transition:J,children:o}),a.jsx(YH,{disabled:r,portrait:d,position:Math.round(S.current),ref:b,transition:J,children:$})]})});XH.displayName="ReactCompareSlider";var $T=p.forwardRef(({style:t,...e},n)=>{let r=Yke(t);return a.jsx("img",{ref:n,...e,style:r,"data-rcs":"image"})});$T.displayName="ReactCompareSliderImage";const eRe=()=>{var ce,ke,Ve,Y,Z,oe,be,Ce;const t=s0(),e=t.storeName,n=Q=>{if(typeof Q!="string"||Q.includes("://"))return!1;try{return btoa(atob(Q))===Q}catch{return!1}};let r=t.productId,s=r;if(n(r))try{s=atob(r)}catch(Q){console.error("Failed to decode Base64 productId:",r,Q)}const i=s,{getStoreByName:o,getProductById:l,updateProductImage:c,updateStore:u,isLoadingStores:d,viewMode:h,updateProductImagesArray:f}=Fn(),m=h==="published",{toast:g}=Ks(),x=di(),E=Sb(),[v,b]=p.useState(null),[S,I]=p.useState(null),[D,k]=p.useState(1),[C,T]=p.useState({}),[P,A]=p.useState(null),[R,M]=p.useState(!1),[j,z]=p.useState(""),[W,q]=p.useState([]),[H,$]=p.useState(!1),[J,O]=p.useState(!1),[V,G]=p.useState(""),[F,ue]=p.useState(!1),[Ee,Se]=p.useState(!1),[we,Fe]=p.useState(""),[Ze,ze]=p.useState(!1),[nt,qe]=p.useState(""),[yt,Le]=p.useState(""),[Ae,pt]=p.useState(""),[mt,Ht]=p.useState([]),[Ft,nn]=p.useState(!1),[Tn,gn]=p.useState(null),[Qe,Be]=p.useState(""),[ct,he]=p.useState(""),[Ie,ee]=p.useState(!1),[ne,X]=p.useState(!1),me=Q=>{let fe=Q.split(","),Re=fe[0].match(/:(.*?);/)[1],et=atob(fe[1]),it=et.length,Te=new Uint8Array(it);for(;it--;)Te[it]=et.charCodeAt(it);return new Blob([Te],{type:Re})},ye=async()=>{if(!Ae||!S||!v){g({title:"Missing data",description:"Cannot generate angles without an active image, product, or store context.",variant:"destructive"});return}ee(!0);try{const{base64ImageData:Q,mimeType:fe}=await Oe(Ae),Re=await hI(Q,fe,S.name||"Product");if(Re&&Re.length>0){const et=[];for(const Ct of Re)if(Ct.startsWith("data:")){const mn=me(Ct),xn=`angle-${Date.now()}-${Math.random().toString(36).substring(2,15)}.png`,nr=`products/${v.id}/${S.id}/angles/${xn}`,Kn=Zd(eh,nr);await Xd(Kn,mn);const hs=await Qd(Kn);et.push(hs)}else et.push(Ct);const it=et.map((Ct,mn)=>({id:`angle-${S.id}-${mt.length+mn}-${tn()}`,src:{medium:Ct,large:Ct},alt:`${S.name} - Angle ${mt.length+mn+1}`})),Te=[...mt,...it];Ht(Te);const ft=Te.map(Ct=>Ct.src.large||Ct.src.medium);await f(v.id,S.id,ft),g({title:"Angles Generated & Stored",description:`${et.length} new angle images added to gallery and storage.`})}else g({title:"No Angles Generated",description:"The AI did not return any new angle images.",variant:"default"})}catch(Q){console.error("Error generating or storing angles on detail page:",Q),g({title:"Angle Generation/Storage Failed",description:Q.message,variant:"destructive"})}ee(!1)},De=async Q=>{var et,it;if(!v||!S)return;const fe=mt.filter(Te=>Te.id!==Q);if(fe.length===0){const Te=`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(S.name||"Product")}`;Ht([{id:`placeholder-${S.id}`,src:{medium:Te,large:Te},alt:S.name||"Product image"}]),pt(Te)}else Ht(fe),(Ae===((et=mt.find(Te=>Te.id===Q))==null?void 0:et.src.large)||Ae===((it=mt.find(Te=>Te.id===Q))==null?void 0:it.src.medium))&&pt(fe[0].src.large||fe[0].src.medium);const Re=fe.map(Te=>Te.src.large||Te.src.medium).filter(Te=>!Te.includes("via.placeholder.com"));await f(v.id,S.id,Re),g({title:"Image Deleted",description:"Image removed from gallery.",variant:"destructive"})},Oe=p.useCallback(Q=>new Promise((fe,Re)=>{if(!Q)return Re(new Error("Image source is undefined or null."));if(Q.startsWith("data:"))try{const et=Q.split(",");if(et.length<2)throw new Error("Invalid data URL structure.");const it=et[0],Te=et[1],ft=it.match(/:(.*?);/);if(!ft||!ft[1])throw new Error("Could not parse MIME type from data URL.");const Ct=ft[1];fe({base64ImageData:Te,mimeType:Ct})}catch(et){console.error("Error parsing data URL:",Q,et),Re(new Error(`Invalid data URL format: ${et.message}`))}else{const et=new Image;et.crossOrigin="Anonymous",et.onload=()=>{const it=document.createElement("canvas");it.width=et.naturalWidth,it.height=et.naturalHeight,it.getContext("2d").drawImage(et,0,0);try{const mn=it.toDataURL("image/png").split(",")[1];fe({base64ImageData:mn,mimeType:"image/png"})}catch(ft){console.error("Canvas toDataURL failed:",ft),Re(new Error("Canvas toDataURL failed, possibly due to CORS or tainted canvas. "+ft.message))}},et.onerror=it=>{console.error("Failed to load image from URL for conversion:",Q,it),Re(new Error("Failed to load image from URL for conversion."))},et.src=Q}}),[]),re=p.useCallback(async()=>{if(!V.trim()||!Ae||!S||!v){g({title:"Missing data",description:"Active image, edit prompt, product, or store context is missing.",variant:"destructive"});return}ue(!0);try{const{base64ImageData:Q,mimeType:fe}=await Oe(Ae),Re=await Ql(Q,fe,V);if(Re&&Re.editedImageData&&Re.newMimeType){const et=`data:${Re.newMimeType};base64,${Re.editedImageData}`,it=me(et),Te=`edited-${Date.now()}.png`,ft=`products/${v.id}/${S.id}/images/${Te}`,Ct=Zd(eh,ft);await Xd(Ct,it);const mn=await Qd(Ct),xn={id:tn(),src:{medium:mn,large:mn},alt:`${S.name} (edited: ${V.substring(0,20)}...)`,photographer:"Edited with Gemini AI via Firebase Storage"};await c(v.id,i,xn);const nr=mt.map(Kn=>Kn.src.medium===Ae||Kn.src.large===Ae?xn:Kn);mt.some(Kn=>Kn.src.medium===Ae||Kn.src.large===Ae)||nr.push(xn),Ht(nr),pt(mn),g({title:"Image Edited & Stored",description:"Product image updated and saved to storage."}),O(!1),G("")}else throw new Error("AI did not return valid edited image data.")}catch(Q){console.error("Error editing image or uploading to storage:",Q),g({title:"Image Edit Failed",description:Q.message,variant:"destructive"})}ue(!1)},[Ae,V,S,v,i,c,mt,g,Oe,me]);p.useEffect(()=>{var fe,Re,et,it;if(d)return;const Q=o(e);if(Q){b(Q);const Te=l(Q.id,i);if(Te){I(Te),z(Te.name),Fe(Te.video_url||""),qe(Te.model_3d_url||""),Le(Te.model_3d_thumbnail_url||"");let ft=[];Te.images&&Array.isArray(Te.images)&&Te.images.length>0?ft=Te.images.map((mn,xn)=>({id:`gallery-img-${Te.id}-${xn}-${tn()}`,src:{medium:mn,large:mn},alt:`${Te.name||"Product"} image ${xn+1}`})):Te.image&&Te.image.src?ft=[{id:Te.image.id||`gallery-img-${Te.id}-0-${tn()}`,src:Te.image.src,alt:Te.image.alt||`${Te.name||"Product"} image`}]:ft=[{id:`placeholder-${Te.id||tn()}`,src:{medium:`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(Te.name||"Product")}`,large:`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(Te.name||"Product")}`},alt:Te.name||"Product image"}],Ht(ft),pt(((Re=(fe=ft[0])==null?void 0:fe.src)==null?void 0:Re.large)||((it=(et=ft[0])==null?void 0:et.src)==null?void 0:it.medium)||"");let Ct=[];if(Te.options&&Array.isArray(Te.options)?Ct=Te.options:Te.variants&&Array.isArray(Te.variants)&&Te.variants.length>0&&Te.variants[0].name&&Te.variants[0].values&&(Ct=Te.variants),Ct.length>0){const mn={};Ct.forEach(xn=>{xn.values&&xn.values.length>0&&(mn[xn.name]=xn.values[0])}),T(mn)}}else g({title:"Product not found",description:`Product ID ${i} not found in store ${Q.name}.`,variant:"destructive"}),x(`/${e}`)}else g({title:"Store not found",description:`Could not find store: ${e}`,variant:"destructive"}),x("/")},[e,i,o,l,x,g,d]),p.useEffect(()=>{var Q,fe,Re,et,it;if(S&&Object.keys(C).length>0){if(((fe=(Q=S.variants)==null?void 0:Q.edges)==null?void 0:fe.length)>0){const Te=(Re=S.variants.edges.find(ft=>!ft.node||!ft.node.selectedOptions?!1:ft.node.selectedOptions.every(Ct=>C[Ct.name]===Ct.value)))==null?void 0:Re.node;if(Te){A(Te);return}}}else S&&((it=(et=S.variants)==null?void 0:et.edges)==null?void 0:it.length)>0&&Object.keys(C).length},[S,C]);const pe=Q=>{const fe=parseInt(Q.target.value);fe>0&&k(fe)},Me=async()=>{if(!v||!S||!on||Gn===void 0||!Jt){g({title:"Error",description:"Product or store data is incomplete for checkout.",variant:"destructive"});return}X(!0);try{const Q=mt.map(Ct=>Ct.src.large||Ct.src.medium).filter(Ct=>Ct&&!Ct.includes("via.placeholder.com")&&!Ct.startsWith("data:")).slice(0,8),fe=`${window.location.origin}/${e}/product/${r}`,et=await gh(E,"createStripeProductAndPrice")({productName:S.name,description:S.description||`High-quality ${S.name}`,images:Q.length>0?Q:on&&!on.includes("via.placeholder.com")&&!on.startsWith("data:")?[on]:[],unitAmount:Math.round(Gn*100),currency:Jt.toLowerCase(),url:fe,metadata:{productId:S.id,storeId:v.id,storeName:v.name}}),{stripeProductId:it,stripePriceId:Te,error:ft}=et.data;if(ft)throw new Error(ft.message||"Failed to create Stripe product/price.");if(!it||!Te)throw new Error("Stripe Product ID or Price ID not received.");x("/checkout",{state:{stripeProductId:it,stripePriceId:Te,productName:S.name,productImage:{src:{medium:on.startsWith("data:")?null:on}},quantity:D,unitAmount:Math.round(Gn*100),currency:Jt.toLowerCase(),storeId:v.id,storeName:v.name}})}catch(Q){console.error("Error creating Stripe product/price or navigating:",Q),g({title:"Checkout Setup Failed",description:Q.message||"Could not prepare for checkout.",variant:"destructive"})}finally{X(!1)}},ve=async()=>{if(j.trim()){$(!0);try{const Q=await Xl(j,5,"square");q(Q)}catch(Q){g({title:"Image search failed",description:Q.message,variant:"destructive"})}$(!1)}},gt=async()=>{if(!j.trim()||!v||!S){g({title:"Missing context",description:"Store or product context is missing for image generation.",variant:"destructive"});return}$(!0);try{const Q=`Product image for: ${j}, ${(S==null?void 0:S.type)||(v==null?void 0:v.type)||"item"}`,fe=await B1(Q);if(!fe||!fe.url||!fe.url.startsWith("data:"))throw new Error("AI did not return a valid base64 image data URL.");const Re=`gemini-${Date.now()}.png`,et=`products/${v.id}/${S.id}/images/${Re}`,it=Zd(eh,et),ft=await(await fetch(fe.url)).blob();await Xd(it,ft);const Ct=await Qd(it),mn={id:Date.now().toString(),src:{medium:Ct,large:Ct},alt:fe.alt||j,photographer:"Gemini AI via Firebase Storage"};q(xn=>[mn,...xn.slice(0,4)]),g({title:"Image Generated & Stored",description:"Gemini AI generated an image, and it has been uploaded to storage."})}catch(Q){console.error("Gemini image generation or storage upload failed:",Q),g({title:"Gemini Process Failed",description:Q.message,variant:"destructive"})}$(!1)},wt=Q=>{const fe=Q.target.files[0];if(fe&&v&&S){$(!0);const Re=`uploaded-${Date.now()}-${fe.name}`,et=`products/${v.id}/${S.id}/images/${Re}`,it=Zd(eh,et);Xd(it,fe).then(()=>Qd(it)).then(Te=>{const ft={id:tn(),src:{medium:Te,large:Te},alt:fe.name,photographer:"Uploaded by user via Firebase Storage"};q(Ct=>[ft,...Ct.slice(0,4)]),g({title:"Image Uploaded & Stored",description:`${fe.name} uploaded. Select it from the results to use.`})}).catch(Te=>{console.error("Error uploading image to Firebase Storage:",Te),g({title:"Storage Upload Failed",description:Te.message,variant:"destructive"})}).finally(()=>{$(!1)})}else fe&&(g({title:"Missing context",description:"Store or product context is missing for image upload.",variant:"destructive"}),$(!1))},dt=async Q=>{if(!v||!S)return;const fe=v.products.map(Re=>Re.id===i?{...Re,video_url:Q}:Re);try{v&&v.id?(await u(v.id,{products:fe}),Fe(Q),g({title:"Product Video Generated",description:"The video has been added to the product."})):g({title:"Error",description:"Store ID not available for video update.",variant:"destructive"})}catch(Re){console.error("Failed to update store with product video:",Re),g({title:"Update Failed",description:"Could not save the product video.",variant:"destructive"})}},xt=async Q=>{if(!v||!S)return;const fe=v.products.map(Re=>Re.id===i?{...Re,model_3d_url:Q,model_3d_thumbnail_url:Q}:Re);try{v&&v.id?(await u(v.id,{products:fe}),qe(Q),Le(Q),g({title:"3D Model Generated",description:"The 3D model has been added to the product."})):g({title:"Error",description:"Store ID not available for 3D model update.",variant:"destructive"})}catch(Re){console.error("Failed to update store with 3D model:",Re),g({title:"Update Failed",description:"Could not save the 3D model.",variant:"destructive"})}},At=Q=>{if(v&&v.id&&S&&Q&&Q.src&&(Q.src.medium||Q.src.large)){const fe=Q.src.large||Q.src.medium;if(fe.startsWith("https://firebasestorage.googleapis.com")||fe.startsWith("http://localhost:")||fe.startsWith("https://images.pexels.com")){const Re={id:Q.id||tn(),src:{medium:fe,large:fe},alt:Q.alt||S.name,photographer:Q.photographer||"User"};if(c(v.id,i,Re),!mt.find(it=>it.src.medium===fe||it.src.large===fe)){const it={...Re,id:Re.id||tn()};Ht(Te=>{const ft=Te.filter(Ct=>!Ct.src.medium.includes("via.placeholder.com"));return[it,...ft.filter(Ct=>Ct.src.medium!==fe)]})}pt(fe),g({title:"Image Selected",description:"Product image updated."})}else g({title:"Invalid Image URL",description:"Selected image does not have a valid storage or Pexels URL.",variant:"destructive"})}else g({title:"Error",description:"Cannot select image. Store, product, or image data missing.",variant:"destructive"});M(!1),q([])};if(d||!v||!S)return a.jsxs("div",{className:"min-h-screen flex items-center justify-center",children:[a.jsx(St,{className:"h-12 w-12 animate-spin text-primary"}),a.jsx("p",{className:"ml-4 text-muted-foreground",children:"Loading product details..."})]});const Nn=mt.find(Q=>Q.src.large===Ae||Q.src.medium===Ae),on=Ae||((ke=(ce=S.image)==null?void 0:ce.src)==null?void 0:ke.large)||((Y=(Ve=S.image)==null?void 0:Ve.src)==null?void 0:Y.medium)||`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(S.name)}`,_r=(Nn==null?void 0:Nn.alt)||((Z=S.image)==null?void 0:Z.alt)||S.name,Gn=((oe=P==null?void 0:P.price)==null?void 0:oe.amount)!==void 0?parseFloat(P.price.amount):S.price,Jt=((be=P==null?void 0:P.price)==null?void 0:be.currencyCode)||S.currencyCode||"USD";let an;S.inventory_count!==void 0?an=S.inventory_count:S.stock!==void 0?an=S.stock:an=S.availableForSale?1:0;const Mn=((Ce=v==null?void 0:v.theme)==null?void 0:Ce.primaryColor)||"#000000";let K=[];S&&(S.options&&Array.isArray(S.options)?K=S.options.map(Q=>({...Q,name:Q.name,values:Q.values})):S.variants&&Array.isArray(S.variants)&&S.variants.length>0&&S.variants[0].name&&S.variants[0].values&&(K=S.variants.map(Q=>({...Q,name:Q.name,values:Q.values}))));const te=async()=>{if(!S||!Ae||Object.keys(C).length===0){g({title:"Cannot Visualize",description:"Product data, main image, or selected variants missing.",variant:"destructive"});return}nn(!0),gn(null),he(Ae);try{const{base64ImageData:Q,mimeType:fe}=await Oe(Ae);let Re=[];for(const ft in C)Re.push(`${ft}: ${C[ft]}`);const et=Re.join(", "),it=`Visualize the product "${S.name}" with the following attributes: ${et}. Apply these changes to the provided image.`,Te=await Ql(Q,fe,it);if(Te&&Te.editedImageData&&Te.newMimeType&&typeof Te.newMimeType=="string"&&Te.newMimeType.includes("/")){const ft=`data:${Te.newMimeType};base64,${Te.editedImageData}`,Ct={id:`visualized-${tn()}`,src:{medium:ft,large:ft},alt:`${S.name} visualized with ${et}`,photographer:"Variant Visualization by Gemini AI"};Ht(mn=>[Ct,...mn]),Be(Ct.src.medium||Ct.src.large),g({title:"Variant Visualized",description:"Comparison slider generated below."})}else{let ft="AI image generation failed: ";throw Te?Te.editedImageData?Te.newMimeType?ft+=`Invalid MIME type from AI ('${Te.newMimeType}').`:ft+="Missing MIME type from AI.":ft+="Missing image data from AI.":ft+="No result from AI.",new Error(ft)}}catch(Q){console.error("Error visualizing variant:",Q),gn(Q.message),g({title:"Visualization Failed",description:Q.message,variant:"destructive"})}nn(!1)};return a.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[a.jsx(UH,{store:v,isPublishedView:m}),a.jsxs(It.main,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"container mx-auto px-4 py-8 md:py-12 flex-grow",children:[a.jsxs(U,{variant:"outline",onClick:()=>x(`/${e}`),className:"mb-6",children:[a.jsx(Ra,{className:"mr-2 h-4 w-4"})," Back to Store"]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12",children:[a.jsxs(It.div,{initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},className:"flex flex-col items-center",children:[a.jsxs("div",{className:"relative group w-full",children:[a.jsx("img",{src:on,alt:_r,className:"w-full h-auto aspect-square object-cover rounded-xl shadow-lg border"},Ae),!m&&a.jsxs(a.Fragment,{children:[a.jsxs(U,{variant:"secondary",onClick:()=>M(!0),className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(mie,{className:"mr-2 h-4 w-4"})," Change Image"]}),a.jsxs(U,{variant:"outline",size:"sm",onClick:()=>O(!0),className:"absolute top-16 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(Av,{className:"mr-2 h-4 w-4"})," Edit Image"]}),a.jsxs(U,{variant:"outline",size:"sm",onClick:()=>Se(!0),className:"absolute top-28 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(Eie,{className:"mr-2 h-4 w-4"})," Gen Video"]}),a.jsxs(U,{variant:"outline",size:"sm",onClick:()=>ze(!0),className:"absolute top-40 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(zse,{className:"mr-2 h-4 w-4"})," Gen 3D"]})]})]}),mt.length>0&&a.jsxs(It.div,{className:"mt-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2,duration:.5},children:[a.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 gap-2",children:mt.map((Q,fe)=>a.jsxs(It.div,{className:"relative group",whileHover:{scale:1.05},children:[a.jsx("div",{className:`aspect-square rounded-md overflow-hidden cursor-pointer border-2 transition-all hover:opacity-80
                                    ${Q.src.large===Ae||Q.src.medium===Ae?"border-primary shadow-sm":"border-transparent"}`,onClick:()=>pt(Q.src.large||Q.src.medium),children:a.jsx("img",{src:Q.src.medium||Q.src.large,alt:Q.alt||`Product image ${fe+1}`,className:"w-full h-full object-cover"})}),!m&&mt.length>1&&!Q.src.medium.includes("via.placeholder.com")&&a.jsx(U,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:Re=>{Re.stopPropagation(),De(Q.id)},"aria-label":"Delete image",children:a.jsx(sr,{className:"h-3 w-3"})})]},Q.id||`gallery-${fe}`))}),!m&&Ae&&!Ae.includes("via.placeholder.com")&&a.jsxs(U,{variant:"outline",size:"sm",className:"mt-3 w-full",onClick:ye,disabled:Ie,children:[Ie?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(tie,{className:"mr-2 h-4 w-4"}),"Generate More Angles from Active Image"]})]})]}),we&&a.jsx(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"md:col-span-2 lg:col-span-1 aspect-video rounded-xl overflow-hidden shadow-lg border relative mt-4 md:mt-0",children:a.jsx("video",{src:we,controls:!0,autoPlay:!1,loop:!0,playsInline:!0,className:"w-full h-full object-cover",poster:on,children:"Your browser does not support the video tag."},we)}),a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"space-y-6",children:[a.jsx("h1",{className:"text-3xl lg:text-4xl font-bold tracking-tight text-foreground",children:S.name}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"flex items-center",children:[...Array(5)].map((Q,fe)=>a.jsx(QV,{className:`h-5 w-5 ${fe<Math.floor(S.rating)?"text-amber-400 fill-amber-400":"text-muted-foreground/30"}`},fe))}),a.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",S.rating," reviews)"]}),a.jsx(Da,{orientation:"vertical",className:"h-5"}),a.jsx(qp,{variant:"outline",style:{borderColor:v.theme.primaryColor,color:v.theme.primaryColor},children:an>0?"In Stock":"Out of Stock"})]}),a.jsxs("p",{className:"text-2xl lg:text-3xl font-semibold",style:{color:v.theme.primaryColor},children:[Jt," ",Gn.toFixed(2)]}),K.length>0&&a.jsxs("div",{className:"space-y-4 pt-4",children:[K.map(Q=>a.jsxs("div",{children:[a.jsxs(je,{className:"text-sm font-medium text-foreground",children:[Q.name,":",a.jsx("span",{className:"text-muted-foreground font-normal ml-1",children:C[Q.name]||""})]}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:Q.values.map(fe=>a.jsx(U,{variant:C[Q.name]===fe?"default":"outline",size:"sm",onClick:()=>{T(Re=>({...Re,[Q.name]:fe}))},style:C[Q.name]===fe?{backgroundColor:Mn,color:"white",borderColor:Mn}:{borderColor:v.theme.secondaryColor||"#cccccc",color:v.theme.secondaryColor||"#333333"},children:fe},fe))})]},Q.name)),K.length>0&&Object.keys(C).length>0&&a.jsxs("div",{className:"mt-4 w-full",children:[Qe&&ct&&a.jsx("div",{className:"mb-3 flex justify-center",children:a.jsx(XH,{itemOne:a.jsx($T,{src:ct,alt:"Original Image"}),itemTwo:a.jsx($T,{src:Qe,alt:"Visualized Variant"}),className:"w-full max-w-md h-auto aspect-square rounded-md border shadow-md"})}),a.jsxs(U,{onClick:te,disabled:Ft,className:"w-full",variant:"outline",children:[Ft?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ll,{className:"mr-2 h-4 w-4"}),"Visualize Variant"]}),Tn&&a.jsx("p",{className:"text-red-500 text-xs mt-2",children:Tn})]})]}),a.jsx("div",{className:"prose prose-sm sm:prose dark:prose-invert max-w-none text-muted-foreground pt-4",children:a.jsx("p",{children:S.description})}),S.tags&&S.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:S.tags.map(Q=>a.jsx(qp,{variant:"secondary",children:Q},Q))}),a.jsx(Da,{className:"my-6"}),a.jsxs("div",{className:"flex items-end gap-4 pt-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(je,{htmlFor:"quantity",className:"text-sm",children:"Quantity"}),a.jsx(st,{id:"quantity",type:"number",value:D,onChange:pe,min:"1",max:an,className:"w-20 h-10 text-center",disabled:an===0})]}),a.jsxs(U,{size:"lg",onClick:Me,className:"flex-1 h-10",style:{backgroundColor:Mn,color:"white"},disabled:an===0,children:[a.jsx(bp,{className:"mr-2 h-5 w-5"}),ne?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):null,an===0?"Out of Stock":ne?"Processing...":"Proceed to Checkout"]})]})]})]}),nt&&a.jsxs(It.div,{className:"mt-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 text-foreground",children:"3D Model"}),a.jsx(Hke,{modelUrl:nt,thumbnailUrl:yt,productName:S.name,height:"500px",className:"w-full"})]}),S&&v&&v.id&&a.jsx(It.div,{className:"mt-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.5},children:a.jsx(qke,{product:S,storeId:v.id,isPublishedView:m})})]}),a.jsx(BH,{store:v,isPublishedView:m}),!m&&a.jsxs(a.Fragment,{children:[a.jsx(Ps,{open:R,onOpenChange:M,children:a.jsxs(ls,{className:"sm:max-w-2xl",children:[a.jsx(cs,{children:a.jsx(us,{children:"Change Product Image"})}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(st,{placeholder:"Search Pexels or describe for AI...",value:j,onChange:Q=>z(Q.target.value)}),a.jsxs(U,{onClick:ve,disabled:H||!j.trim(),children:[H&&W.length===0?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(Xse,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Pexels"})]}),a.jsxs(U,{onClick:gt,variant:"outline",disabled:H||!j.trim(),children:[H&&W.length>0?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(Ll,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Gemini"})]}),a.jsxs(U,{variant:"outline",onClick:()=>{var Q;return(Q=document.getElementById("upload-image-input"))==null?void 0:Q.click()},disabled:H,children:[a.jsx(Jo,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Upload"})]}),a.jsx(st,{type:"file",id:"upload-image-input",className:"hidden",accept:"image/*",onChange:wt})]}),H&&W.length===0&&a.jsx("p",{className:"text-center text-sm text-muted-foreground",children:"Searching for images or processing upload..."}),W.length>0&&a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-80 overflow-y-auto",children:W.map(Q=>a.jsxs(It.div,{className:"relative aspect-square rounded-md overflow-hidden cursor-pointer group border-2 border-transparent hover:border-primary transition-all",onClick:()=>At(Q),whileHover:{scale:1.05},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},children:[a.jsx("img",{src:Q.src.medium,alt:Q.alt||"Search result",className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(tRe,{className:"h-8 w-8 text-white"})}),a.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/70 text-white text-xs p-1 truncate",children:Q.photographer||Q.alt})]},Q.id))})]}),a.jsx(jr,{children:a.jsx(ja,{asChild:!0,children:a.jsx(U,{type:"button",variant:"outline",children:"Cancel"})})})]})}),a.jsx(Ps,{open:J,onOpenChange:O,children:a.jsxs(ls,{className:"sm:max-w-md",children:[a.jsx(cs,{children:a.jsx(us,{children:"Edit Product Image"})}),a.jsxs("div",{className:"space-y-4 py-4",children:[S&&Ae&&a.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[a.jsx("img",{src:Ae,alt:"Current product to edit",className:"h-20 w-20 object-cover rounded border"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Editing: ",S.name]})]}),a.jsx(je,{htmlFor:"editPrompt",className:"text-left",children:"Edit Instruction:"}),a.jsx(Vn,{id:"editPrompt",placeholder:"e.g., 'make the background blue', 'add sunglasses to the person'",value:V,onChange:Q=>G(Q.target.value),rows:3,className:"resize-none"})]}),a.jsxs(jr,{children:[a.jsx(ja,{asChild:!0,children:a.jsx(U,{type:"button",variant:"outline",disabled:F,children:"Cancel"})}),a.jsxs(U,{onClick:re,disabled:F||!V.trim(),children:[F?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ll,{className:"mr-2 h-4 w-4"}),"Apply Edit"]})]})]})}),S&&a.jsx(Fke,{open:Ee,onOpenChange:Se,product:S,onVideoGenerated:dt}),S&&a.jsx(Wke,{open:Ze,onOpenChange:ze,product:S,onModelGenerated:xt,storeId:v==null?void 0:v.id})]})]})},tRe=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),nRe=rA("pk_live_51NAoUjDktew9heHOJD5Px4jn1IaolhvVvqoE6NukJV7MxZa8PhIVSwcOVWXdQx6MFNgIGmEYeg64lFUGlYfAyVqu004n16tAdG"),rRe=()=>{var k,C,T,P,A,R;const t=qa(),e=di(),{getStoreById:n}=Fn(),{toast:r}=Ks(),s=Sb(),[i,o]=p.useState(null),[l,c]=p.useState("Your"),[u,d]=p.useState(null),[h,f]=p.useState(null),[m,g]=p.useState(!1),[x,E]=p.useState("");p.useEffect(()=>{const{stripePriceId:M,productName:j,productImage:z,quantity:W,unitAmount:q,currency:H,storeId:$,storeName:J}=t.state||{};if(M&&j&&z&&W&&q&&H&&$&&J){o({stripePriceId:M,name:j,image:z,quantity:parseInt(W,10),unitAmount:parseInt(q,10),currency:H.toLowerCase()}),d($),c(J);const O=n($);f(O)}else r({title:"Checkout Error",description:"Missing product information for checkout. Redirecting...",variant:"destructive"}),e("/")},[t.state,e,r,n]);const v=i?i.unitAmount/100*i.quantity:0,b=v>0?5:0,S=v*.08,I=v+b+S,D=async M=>{if(M.preventDefault(),!i||!x.trim()){r({title:"Missing Information",description:"Please enter your email address.",variant:"destructive"});return}g(!0);try{const z=await gh(s,"createStripeCheckoutSession")({priceId:i.stripePriceId,quantity:i.quantity,customerEmail:x,successUrl:`${window.location.origin}/order-confirmation?session_id={CHECKOUT_SESSION_ID}&storeId=${u}`,cancelUrl:`${window.location.origin}/checkout?storeId=${u}&canceled=true`}),{sessionId:W,error:q}=z.data;if(q)throw new Error(q.message||"Failed to create checkout session.");if(!W)throw new Error("Checkout session ID not received.");const H=await nRe,{error:$}=await H.redirectToCheckout({sessionId:W});$&&(console.error("Stripe redirect error:",$),r({title:"Payment Error",description:$.message,variant:"destructive"}),g(!1))}catch(j){console.error("Error creating Stripe Checkout session:",j),r({title:"Checkout Failed",description:j.message||"Could not initiate payment.",variant:"destructive"}),g(!1)}};return!i&&!m?a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-900 dark:to-slate-900",children:[a.jsx(XV,{className:"h-24 w-24 text-primary mb-6"}),a.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Your Cart is Empty"}),a.jsx("p",{className:"text-muted-foreground mb-8",children:"There's nothing to check out yet."}),a.jsx(U,{asChild:!0,children:a.jsxs(Us,{to:u?`/preview/${u}`:"/",children:[a.jsx(Ra,{className:"mr-2 h-4 w-4"})," Continue Shopping"]})})]}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-gray-800 dark:to-slate-800 py-8 px-4",children:a.jsxs(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"container mx-auto max-w-4xl",children:[a.jsxs(U,{variant:"ghost",onClick:()=>e(u?`/preview/${u}`:"/"),className:"mb-6 text-primary hover:text-primary/80",children:[a.jsx(Ra,{className:"mr-2 h-4 w-4"})," Back to ",l]}),a.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-center mb-8 text-gray-800 dark:text-gray-100",children:"Checkout"}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[a.jsxs(We,{className:"md:col-span-1 h-fit sticky top-8 shadow-lg",children:[a.jsxs(ot,{children:[a.jsx(at,{className:"text-xl",children:"Order Summary"}),a.jsxs(qt,{children:["Review your item from ",l,"."]})]}),a.jsxs(tt,{className:"space-y-4",children:[i&&a.jsxs("div",{className:"flex justify-between items-center text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:((C=(k=i.image)==null?void 0:k.src)==null?void 0:C.tiny)||((T=i.image)==null?void 0:T.medium)||((P=i.image)==null?void 0:P.large)||`https://via.placeholder.com/40x40.png?text=${(A=i.name)==null?void 0:A.substring(0,1)}`,alt:i.name,className:"w-10 h-10 rounded object-cover"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium line-clamp-1",children:i.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Qty: ",i.quantity]})]})]}),a.jsxs("p",{className:"font-medium",children:["$",(i.unitAmount/100*i.quantity).toFixed(2)]})]}),a.jsx(Da,{}),a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Subtotal:"}),a.jsxs("span",{children:["$",v.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Shipping:"}),a.jsxs("span",{children:["$",b.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Taxes (est.):"}),a.jsxs("span",{children:["$",S.toFixed(2)]})]})]}),a.jsx(Da,{}),a.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{children:["$",I.toFixed(2)]})]})]})]}),a.jsxs("form",{onSubmit:D,className:"md:col-span-2 space-y-6",children:[a.jsxs(We,{className:"shadow-lg",children:[a.jsx(ot,{children:a.jsx(at,{className:"text-xl",children:"Contact Information"})}),a.jsx(tt,{className:"grid grid-cols-1 gap-4",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx(je,{htmlFor:"email",children:"Email Address"}),a.jsx(st,{id:"email",name:"email",type:"email",placeholder:"you@example.com",value:x,onChange:M=>E(M.target.value),required:!0})]})})]}),a.jsxs(U,{type:"submit",size:"lg",className:"w-full text-lg",disabled:m||!x.trim(),style:{backgroundColor:((R=h==null?void 0:h.theme)==null?void 0:R.primaryColor)||"#3B82F6"},children:[m?a.jsx(St,{className:"mr-2 h-5 w-5 animate-spin"}):a.jsx(Bi,{className:"mr-2 h-5 w-5"}),m?"Processing Payment...":`Pay $${I.toFixed(2)}`]})]})]})]})})},sRe="https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/ffwhite.png?alt=media&token=a8f26828-97a9-42b9-9bd3-3c63506f894b",iRe="https://firebasestorage.googleapis.com/v0/b/freshauth-3d.firebasestorage.app/o/Freshbg.png?alt=media&token=60974345-f93b-4c8e-9d9b-7f1c07dc1eda";function oRe(){const[t,e]=p.useState(!0),[n,r]=p.useState(""),[s,i]=p.useState(!1),o=p.useRef(),l=p.useRef(),c=di();p.useEffect(()=>{const h=localStorage.getItem("theme"),f=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;h==="dark"||!h&&f?(document.documentElement.classList.add("dark"),i(!0)):(document.documentElement.classList.remove("dark"),i(!1))},[]);const u=async h=>{r("");const f=o.current.value,m=l.current.value;if(!f||!m){r("Please enter both email and password.");return}try{let g;h==="login"?g=await ege(Ym,f,m):(g=await Zpe(Ym,f,m),await qm(vi(Er,"profiles",g.user.uid),{id:g.user.uid,email:g.user.email,role:"store_owner",created_at:new Date})),c("/")}catch(g){console.error("Authentication error (Email/Password):",g.message),r(g.message)}},d=async()=>{r("");const h=new ga;try{const m=(await Ege(Ym,h)).user,g=vi(Er,"profiles",m.uid);(await Jwe(g)).exists()||await qm(g,{id:m.uid,email:m.email,displayName:m.displayName,photoURL:m.photoURL,role:"store_owner",created_at:new Date}),c("/")}catch(f){console.error("Google Sign-In error:",f.message),f.code==="auth/popup-closed-by-user"?r("Google Sign-In was cancelled. Please try again."):f.code==="auth/account-exists-with-different-credential"?r("An account already exists with the same email address but different sign-in credentials. Try signing in with your original method."):r(`Google Sign-In failed: ${f.message}`)}};return a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-cover bg-center bg-no-repeat p-4",style:{backgroundImage:`url(${iRe})`},children:a.jsxs("div",{className:`w-full max-w-md p-8 md:p-10 space-y-6
                   bg-white/10 dark:bg-black/30 backdrop-blur-lg
                   shadow-2xl rounded-xl border border-white/20 dark:border-black/20`,children:[a.jsx("div",{className:"flex justify-center mb-6",children:a.jsx("img",{src:sRe,alt:"FreshFront Logo",className:"h-12 w-auto"})}),a.jsx("h2",{className:"text-center text-3xl font-extrabold text-white mb-6",children:t?"Sign In":"Sign Up"}),n&&a.jsx("p",{className:"text-red-500 text-center",children:n}),a.jsxs("form",{onSubmit:h=>{h.preventDefault(),u(t?"login":"signup")},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-white mb-1",children:"Email"}),a.jsx("input",{type:"email",id:"email",ref:o,required:!0,className:"w-full p-3 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"you@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-white mb-1",children:"Password"}),a.jsx("input",{type:"password",id:"password",ref:l,required:!0,className:"w-full p-3 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"••••••••"})]}),a.jsx("button",{type:"submit",className:"w-full bg-primary text-primary-foreground py-3 rounded-md font-semibold hover:bg-primary/90 transition-colors",children:t?"Sign In":"Sign Up"})]}),a.jsxs("div",{className:"relative my-6",children:[a.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:a.jsx("div",{className:"w-full border-t border-white/30"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-2 bg-white/10 dark:bg-black/30 text-white rounded-md",children:"Or continue with"})})]}),a.jsx("div",{children:a.jsxs("button",{type:"button",onClick:d,className:"w-full flex items-center justify-center gap-2 bg-white/90 dark:bg-white/10 text-black dark:text-white py-3 rounded-md font-semibold hover:bg-white dark:hover:bg-white/20 transition-colors border border-white/20",children:[a.jsx("svg",{className:"w-5 h-5","aria-hidden":"true",focusable:"false",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 18",children:a.jsxs("g",{fill:"none","fill-rule":"evenodd",children:[a.jsx("path",{d:"M17.64 9.2045c0-.6381-.0573-1.2518-.1636-1.8409H9v3.4818h4.8436c-.2086 1.125-.8427 2.0782-1.7777 2.7218v2.2582h2.9082c1.7018-1.5668 2.6836-3.8741 2.6836-6.621Z",fill:"#4285F4"}),a.jsx("path",{d:"M9 18c2.43 0 4.4673-.8055 5.9564-2.1818l-2.9082-2.2582c-.8055.5436-1.8368.8618-2.9945.8618-2.3127 0-4.2609-1.5668-4.9582-3.6709H1.0718v2.3318C2.5564 16.1632 5.5218 18 9 18Z",fill:"#34A853"}),a.jsx("path",{d:"M4.0418 10.7318c-.1164-.3464-.18-.7173-.18-1.0909 0-.3736.0636-.7445.18-1.0909V6.2182H1.0718C.3859 7.5614 0 9.0182 0 10.6409s.3859 3.0795 1.0718 4.4227l2.97-2.3318Z",fill:"#FBBC05"}),a.jsx("path",{d:"M9 3.5818c1.3218 0 2.5077.4559 3.4405 1.3468l2.5818-2.5818C13.4632.9918 11.43 0 9 0 5.5218 0 2.5564 1.8368 1.0718 4.5727l2.97 2.3318C4.7391 4.9855 6.6873 3.5818 9 3.5818Z",fill:"#EA4335"})]})}),t?"Sign in with Google":"Sign up with Google"]})}),a.jsxs("p",{className:"text-center text-sm text-white pt-4",children:[t?"Don't have an account?":"Already have an account?"," ",a.jsx("button",{onClick:()=>e(!t),className:"text-white hover:underline font-medium",children:t?"Sign Up":"Sign In"})]})]})})}const aRe=()=>{const{isAuthenticated:t,user:e}=ro();return a.jsxs(a.Fragment,{children:[a.jsx(sA,{}),a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Our Plan"}),a.jsx("p",{children:"Get full access to all store creation and management features."}),a.jsxs("div",{style:{border:"1px solid #ccc",padding:"20px",margin:"20px auto",maxWidth:"400px",borderRadius:"8px"},children:[a.jsx("h2",{children:"Store Creator Plan"}),a.jsx("p",{style:{fontSize:"2em",fontWeight:"bold",margin:"10px 0"},children:"$24.99 / month"}),a.jsxs("ul",{children:[a.jsx("li",{children:"Full access to publishing"}),a.jsx("li",{children:"Accept payments for your store"}),a.jsx("li",{children:"Unlimited products"}),a.jsx("li",{children:"And more!"})]}),t?a.jsx(_T,{}):a.jsxs("p",{children:["Please ",a.jsx(Us,{to:"/auth",children:"log in or sign up"})," to subscribe."]})]})]})]})};function lRe(){return new URLSearchParams(qa().search)}const cRe=()=>{const e=lRe().get("session_id");p.useState(null);const[n,r]=p.useState(!0),[s,i]=p.useState(null);return p.useEffect(()=>{if(!e){i("No session ID found. Your order might still be processing."),r(!1);return}r(!1)},[e]),n?a.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"Loading order details..."}):s?a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Order Status"}),a.jsx("p",{style:{color:"red"},children:s}),a.jsx(Us,{to:"/",children:"Go to Homepage"})]}):a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Thank You for Your Order!"}),a.jsx("p",{children:"Your payment was successful and your order is being processed."}),a.jsxs("p",{children:["Order (Session ID): ",e]}),a.jsx("p",{children:"You will receive an email confirmation shortly."}),a.jsx(Us,{to:"/",children:"Continue Shopping"})]})},uRe=()=>{const{isGenerating:t,progress:e,statusMessage:n}=Fn();return a.jsx(Eu,{children:t&&a.jsx(It.div,{initial:{y:"-100%",opacity:0},animate:{y:"20px",opacity:1},exit:{y:"-100%",opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"fixed top-0 left-0 right-0 flex justify-center z-[9999] p-4",children:a.jsxs(We,{className:"shadow-2xl rounded-xl overflow-hidden w-full max-w-md",children:[" ",a.jsxs(tt,{className:"p-6 space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Store Generation"}),a.jsxs("p",{className:"text-sm font-semibold text-blue-600 dark:text-blue-400",children:[Math.floor(e),"%"]})]}),a.jsx(IA,{value:e,className:"w-full h-2 [&>div]:bg-blue-600"}),a.jsx("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 pt-1 min-h-[1.2em]",children:n||"Processing..."})]})]})})})},dRe=()=>a.jsxs(Xbe,{children:[a.jsx(uRe,{})," ",a.jsxs("main",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-900 dark:to-slate-900",children:[a.jsx(HJ,{})," ",a.jsx(Rie,{}),a.jsx(FH,{})," "]})]});const hRe=({children:t,activeTab:e,setActiveTab:n,storeId:r,storeName:s})=>{const[i,o]=p.useState(""),[l,c]=p.useState([]),u=[{id:"orders",label:"Orders",icon:a.jsx(bp,{className:"h-5 w-5"})},{id:"products",label:"Products",icon:a.jsx(Ei,{className:"h-5 w-5"})},{id:"customers",label:"Customers",icon:a.jsx(m0,{className:"h-5 w-5"})},{id:"payments",label:"Payments",icon:a.jsx(Bi,{className:"h-5 w-5"})},{id:"analytics",label:"Analytics",icon:a.jsx(Pv,{className:"h-5 w-5"})},{id:"marketing",label:"Marketing",icon:a.jsx(Gd,{className:"h-5 w-5"})},{id:"shipping",label:"Shipping",icon:a.jsx(jv,{className:"h-5 w-5"})},{id:"settings",label:"Settings",icon:a.jsx(wp,{className:"h-5 w-5"})}],d=u.map(m=>({id:m.id,label:m.label,tab:m.id})),h=m=>{const g=m.target.value;if(o(g),g.trim()===""){c([]);return}const x=g.toLowerCase(),E=[];d.forEach(v=>{v.label.toLowerCase().includes(x)&&E.push({id:`${v.id}-main`,label:v.label,tab:v.tab}),v.subItems&&v.subItems.forEach(b=>{b.label.toLowerCase().includes(x)&&E.push({id:b.id,label:`${v.label} > ${b.label}`,tab:v.tab})})}),c(E)},f=m=>{n(m.tab),o(""),c([])};return a.jsxs("div",{className:"flex h-screen bg-muted/40",children:[" ",a.jsxs("div",{className:"w-64 bg-card border-r border-border flex flex-col",children:[" ",a.jsxs("div",{className:"p-4 border-b flex items-center gap-2",children:[" ",s&&a.jsx(U,{asChild:!0,variant:"outline",size:"icon",className:"flex-shrink-0",children:a.jsxs(Us,{to:`/${s}`,children:[" ",a.jsx(Ra,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Back to Store"})]})}),a.jsxs("div",{className:"relative flex-grow",children:[" ",a.jsx(lh,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),a.jsx(st,{type:"text",placeholder:"Search dashboard...",className:"pl-9 w-full",value:i,onChange:h}),l.length>0&&a.jsxs(We,{className:"absolute mt-1 w-full z-50 max-h-64 overflow-y-auto shadow-lg",children:[" ",a.jsxs("div",{className:"p-1",children:[" ",l.map(m=>a.jsx("button",{className:"w-full text-left px-3 py-1.5 hover:bg-accent rounded-md text-sm",onClick:()=>f(m),children:m.label},m.id))]})]})]})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:[" ",u.map(m=>a.jsxs(U,{variant:e===m.id?"secondary":"ghost",className:"w-full justify-start text-left h-10 px-3",onClick:()=>n(m.id),children:[a.jsx("span",{className:"mr-3",children:m.icon})," ",m.label]},m.id))]}),a.jsx("div",{className:"p-4 border-t",children:a.jsx(U,{variant:"ghost",className:"w-full justify-start text-left",children:"Help & Support"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[" ",t]})]})},bF=()=>{const[t,e]=p.useState("all"),n=[{id:"ORD-1234",customer:"John Doe",date:"2023-05-15",total:"$129.99",status:"Fulfilled"},{id:"ORD-1235",customer:"Jane Smith",date:"2023-05-14",total:"$89.50",status:"Processing"},{id:"ORD-1236",customer:"Robert Johnson",date:"2023-05-13",total:"$210.75",status:"Pending"}],r=[{id:"CART-567",customer:"Emily Davis",date:"2023-05-15",items:3,total:"$78.45",timeSpent:"12m 30s"},{id:"CART-568",customer:"Michael Brown",date:"2023-05-14",items:2,total:"$45.99",timeSpent:"5m 15s"}],s=[{id:"RET-890",orderId:"ORD-1230",customer:"Sarah Wilson",date:"2023-05-10",amount:"$65.00",reason:"Wrong size"},{id:"RET-891",orderId:"ORD-1228",customer:"David Miller",date:"2023-05-09",amount:"$120.50",reason:"Damaged item"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Orders"}),a.jsxs(Fi,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(hi,{className:"grid grid-cols-4 mb-6",children:[a.jsxs(Gt,{value:"all",children:[a.jsx(bp,{className:"mr-2 h-4 w-4"}),"All Orders"]}),a.jsxs(Gt,{value:"abandoned",children:[a.jsx(ng,{className:"mr-2 h-4 w-4"}),"Abandoned Checkouts"]}),a.jsxs(Gt,{value:"returns",children:[a.jsx(Rv,{className:"mr-2 h-4 w-4"}),"Returns & Refunds"]}),a.jsxs(Gt,{value:"fulfillment",children:[a.jsx(Ei,{className:"mr-2 h-4 w-4"}),"Order Fulfillment"]})]}),a.jsx(Wt,{value:"all",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"All Orders"}),a.jsx(qt,{children:"View and manage all customer orders"})]}),a.jsx(tt,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="Fulfilled"?"bg-green-100 text-green-800":i.status==="Processing"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:i.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(U,{variant:"outline",size:"sm",children:"View"})})]},i.id))})]})})})]})}),a.jsx(Wt,{value:"abandoned",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Abandoned Checkouts"}),a.jsx(qt,{children:"View details of abandoned shopping carts"})]}),a.jsx(tt,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Cart ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Items"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Time Spent"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.items}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:i.timeSpent}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(U,{variant:"outline",size:"sm",children:"View Details"})})]},i.id))})]})})})]})}),a.jsx(Wt,{value:"returns",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Returns & Refunds"}),a.jsx(qt,{children:"Manage customer returns and process refunds"})]}),a.jsx(tt,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Return ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.orderId}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.amount}),a.jsx("td",{className:"py-3 px-4",children:i.reason}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(U,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(U,{variant:"outline",size:"sm",children:"Process"})]})]},i.id))})]})})})]})}),a.jsx(Wt,{value:"fulfillment",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Order Fulfillment"}),a.jsx(qt,{children:"Manage and fulfill pending orders"})]}),a.jsx(tt,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Fraud Risk"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer Score"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="Fulfilled"?"bg-green-100 text-green-800":i.status==="Processing"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:i.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Low"})}),a.jsxs("td",{className:"py-3 px-4",children:[Math.floor(Math.random()*100),"/100"]}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(U,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(U,{variant:"default",size:"sm",disabled:i.status==="Fulfilled",children:"Fulfill"})]})]},i.id))})]})})})]})})]})]})},fRe=()=>{const[t,e]=p.useState("all"),n=[{id:"PRD-1234",name:"Premium T-Shirt",category:"Apparel",price:"$29.99",inventory:45,status:"Active"},{id:"PRD-1235",name:"Wireless Headphones",category:"Electronics",price:"$89.50",inventory:12,status:"Active"},{id:"PRD-1236",name:"Leather Wallet",category:"Accessories",price:"$49.99",inventory:0,status:"Out of Stock"}],r=[{id:"COL-567",name:"Summer Collection",products:12,type:"Manual",status:"Active"},{id:"COL-568",name:"Holiday Specials",products:8,type:"AI Generated",status:"Draft"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Products"}),a.jsxs(Fi,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(hi,{className:"grid grid-cols-3 mb-6",children:[a.jsxs(Gt,{value:"all",children:[a.jsx(Ei,{className:"mr-2 h-4 w-4"}),"All Products"]}),a.jsxs(Gt,{value:"inventory",children:[a.jsx(Tm,{className:"mr-2 h-4 w-4"}),"Inventory"]}),a.jsxs(Gt,{value:"collections",children:[a.jsx(E_,{className:"mr-2 h-4 w-4"}),"Collections"]})]}),a.jsx(Wt,{value:"all",children:a.jsxs(We,{children:[a.jsxs(ot,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(at,{children:"All Products"}),a.jsx(qt,{children:"Manage your product catalog"})]}),a.jsxs(U,{children:[a.jsx(Ei,{className:"mr-2 h-4 w-4"}),"Add Product"]})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"mb-4 flex items-center",children:[a.jsx(st,{placeholder:"Search products...",className:"max-w-sm mr-2"}),a.jsx(U,{variant:"outline",children:"Search"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Category"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Price"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Inventory"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.category}),a.jsx("td",{className:"py-3 px-4",children:s.price}),a.jsx("td",{className:"py-3 px-4",children:s.inventory}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(U,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(U,{variant:"outline",size:"sm",children:"Delete"})]})]},s.id))})]})})]})]})}),a.jsx(Wt,{value:"inventory",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Inventory Management"}),a.jsx(qt,{children:"Track and update product inventory levels"})]}),a.jsx(tt,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Current Stock"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Low Stock Alert"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.inventory}),a.jsx("td",{className:"py-3 px-4",children:"10"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.inventory>10?"bg-green-100 text-green-800":s.inventory>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.inventory>10?"In Stock":s.inventory>0?"Low Stock":"Out of Stock"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(U,{variant:"outline",size:"sm",children:"Update Stock"})})]},s.id))})]})})})]})}),a.jsx(Wt,{value:"collections",children:a.jsxs(We,{children:[a.jsxs(ot,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(at,{children:"Collections"}),a.jsx(qt,{children:"Organize products into collections"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(U,{variant:"outline",children:[a.jsx(E_,{className:"mr-2 h-4 w-4"}),"Create Manual Collection"]}),a.jsxs(U,{children:[a.jsx(E_,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]}),a.jsx(tt,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Collection Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Products"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.products}),a.jsx("td",{className:"py-3 px-4",children:s.type}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(U,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(U,{variant:"outline",size:"sm",children:"Delete"})]})]},s.id))})]})})})]})})]})]})},mRe=()=>{const t=[{id:"CUS-1234",name:"John Doe",email:"john.doe@example.com",orders:5,totalSpent:"$345.75",lastOrder:"2023-05-10",segment:"Loyal"},{id:"CUS-1235",name:"Jane Smith",email:"jane.smith@example.com",orders:2,totalSpent:"$129.50",lastOrder:"2023-04-22",segment:"New"},{id:"CUS-1236",name:"Robert Johnson",email:"robert.j@example.com",orders:8,totalSpent:"$780.25",lastOrder:"2023-05-15",segment:"VIP"}],e=[{id:"SEG-1",name:"New Customers",count:124,description:"Customers with 1-2 orders"},{id:"SEG-2",name:"Loyal Customers",count:86,description:"Customers with 3-7 orders"},{id:"SEG-3",name:"VIP Customers",count:32,description:"Customers with 8+ orders"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Customers"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:e.map(n=>a.jsxs(We,{children:[a.jsxs(ot,{className:"pb-2",children:[a.jsx(at,{className:"text-lg",children:n.name}),a.jsx(qt,{children:n.description})]}),a.jsxs(tt,{children:[a.jsx("div",{className:"text-3xl font-bold",children:n.count}),a.jsx(U,{variant:"link",className:"p-0",children:"View customers"})]})]},n.id))}),a.jsxs(We,{className:"mb-6",children:[a.jsxs(ot,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(at,{children:"Customer Insights"}),a.jsx(qt,{children:"AI-generated insights about your customer base"})]}),a.jsxs(U,{variant:"outline",children:[a.jsx(fie,{className:"mr-2 h-4 w-4"}),"Generate New Insights"]})]}),a.jsx(tt,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Demographics"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-card rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Demographics chart placeholder"})}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Your customer base is primarily 25-34 years old (45%), followed by 35-44 years old (30%). The gender distribution is 55% female and 45% male."})]}),a.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Geographic Distribution"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-card rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Geographic map placeholder"})}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Most of your customers are from California (25%), New York (18%), and Texas (12%). International customers make up 15% of your customer base."})]})]})})]}),a.jsxs(We,{children:[a.jsxs(ot,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(at,{children:"All Customers"}),a.jsx(qt,{children:"View and manage your customer database"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(U,{variant:"outline",children:[a.jsx(Tm,{className:"mr-2 h-4 w-4"}),"Add Tags"]}),a.jsxs(U,{children:[a.jsx(m0,{className:"mr-2 h-4 w-4"}),"Create Segment"]})]})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"mb-4 flex items-center",children:[a.jsx(st,{placeholder:"Search customers...",className:"max-w-sm mr-2"}),a.jsx(U,{variant:"outline",children:"Search"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Email"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Orders"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total Spent"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Last Order"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Segment"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:t.map(n=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:n.id}),a.jsx("td",{className:"py-3 px-4",children:n.name}),a.jsx("td",{className:"py-3 px-4",children:n.email}),a.jsx("td",{className:"py-3 px-4",children:n.orders}),a.jsx("td",{className:"py-3 px-4",children:n.totalSpent}),a.jsx("td",{className:"py-3 px-4",children:n.lastOrder}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${n.segment==="VIP"?"bg-purple-100 text-purple-800":n.segment==="Loyal"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:n.segment})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(U,{variant:"outline",size:"sm",children:"View Profile"})})]},n.id))})]})})]})]})]})},pRe=()=>{const[t,e]=p.useState("transactions"),{session:n,user:r}=ro(),[s,i]=p.useState(!1),[o,l]=p.useState(null),c=async()=>{if(!(n!=null&&n.access_token)||!r){l("Authentication token not found. Please log in again.");return}i(!0),l(null);try{const f=await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/create-stripe-connect-account",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n.access_token}`},body:JSON.stringify({record:{id:r.id,email:r.email}})}),m=await f.json();if(!f.ok){const g=m.error||m.data&&m.data.error||"Failed to create Stripe Connect account link.";throw new Error(g)}if(m.account_link_url)window.location.href=m.account_link_url;else if(m.url)window.location.href=m.url;else throw new Error("No URL returned from Stripe Connect account creation.")}catch(f){console.error("Stripe Connect account creation error:",f),l(f.message)}finally{i(!1)}},u=[{id:"TRX-1234",orderId:"ORD-1234",customer:"John Doe",date:"2023-05-15",amount:"$129.99",status:"Completed",method:"Credit Card"},{id:"TRX-1235",orderId:"ORD-1235",customer:"Jane Smith",date:"2023-05-14",amount:"$89.50",status:"Completed",method:"PayPal"},{id:"TRX-1236",orderId:"ORD-1236",customer:"Robert Johnson",date:"2023-05-13",amount:"$210.75",status:"Pending",method:"Credit Card"}],d=[{id:"PAY-567",date:"2023-05-15",amount:"$1,245.75",status:"Completed",destination:"Bank Account (****1234)"},{id:"PAY-568",date:"2023-05-01",amount:"$980.50",status:"Completed",destination:"Bank Account (****1234)"},{id:"PAY-569",scheduledDate:"2023-06-01",estimatedAmount:"$1,500.00",status:"Scheduled",destination:"Bank Account (****1234)"}],h=[{id:"DSP-890",transactionId:"TRX-1230",customer:"Sarah Wilson",date:"2023-05-10",amount:"$65.00",reason:"Item not received",status:"Under Review"},{id:"DSP-891",transactionId:"TRX-1228",customer:"David Miller",date:"2023-05-09",amount:"$120.50",reason:"Unauthorized charge",status:"Lost"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Payments & Payouts"}),a.jsxs(Fi,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(hi,{className:"grid grid-cols-4 mb-6",children:[" ",a.jsxs(Gt,{value:"overview",children:[" ",a.jsx(zd,{className:"mr-2 h-4 w-4"}),"Connect Account"]}),a.jsxs(Gt,{value:"transactions",children:[a.jsx(Bi,{className:"mr-2 h-4 w-4"}),"Transactions"]}),a.jsxs(Gt,{value:"payouts",children:[a.jsx(X1,{className:"mr-2 h-4 w-4"}),"Payout Schedule"]}),a.jsxs(Gt,{value:"disputes",children:[a.jsx(ng,{className:"mr-2 h-4 w-4"}),"Disputes & Chargebacks"]})]}),a.jsxs(Wt,{value:"overview",children:[" ",a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Connect Stripe Account"}),a.jsx(qt,{children:"Connect your Stripe account to start accepting payments and manage payouts."})]}),a.jsxs(tt,{children:[a.jsxs(U,{onClick:c,disabled:s,children:[a.jsx(zd,{className:"mr-2 h-4 w-4"}),s?"Connecting...":"Connect with Stripe"]}),o&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:o})]})]})]}),a.jsx(Wt,{value:"transactions",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"All Transactions"}),a.jsx(qt,{children:"View all payment transactions"})]}),a.jsx(tt,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Transaction ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Method"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:u.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.orderId}),a.jsx("td",{className:"py-3 px-4",children:f.customer}),a.jsx("td",{className:"py-3 px-4",children:f.date}),a.jsx("td",{className:"py-3 px-4",children:f.amount}),a.jsx("td",{className:"py-3 px-4",children:f.method}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(U,{variant:"outline",size:"sm",children:"View Details"})})]},f.id))})]})})})]})}),a.jsx(Wt,{value:"payouts",children:a.jsxs(We,{className:"mb-6",children:[a.jsxs(ot,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(at,{children:"Payout Schedule"}),a.jsx(qt,{children:"Manage your payout schedule and instant transfers"})]}),a.jsxs(U,{children:[a.jsx(Bi,{className:"mr-2 h-4 w-4"}),"Instant Transfer"]})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Current Balance"})}),a.jsxs(tt,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$1,845.75"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Available for payout"})]})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Next Payout"})}),a.jsxs(tt,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$1,500.00"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Scheduled for June 1, 2023"})]})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Payout Schedule"})}),a.jsxs(tt,{children:[a.jsx("div",{className:"text-xl font-medium",children:"Monthly"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Every 1st of the month"}),a.jsx(U,{variant:"link",className:"p-0 mt-2",children:"Change schedule"})]})]})]}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Payout History"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Payout ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Destination"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:d.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.date||f.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:f.amount||f.estimatedAmount}),a.jsx("td",{className:"py-3 px-4",children:f.destination}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Completed"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(U,{variant:"outline",size:"sm",children:"View Details"})})]},f.id))})]})]})]})]})}),a.jsx(Wt,{value:"disputes",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Disputes & Chargebacks"}),a.jsx(qt,{children:"Manage payment disputes and chargebacks"})]}),a.jsx(tt,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Dispute ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Transaction ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"AI Analysis"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:h.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.transactionId}),a.jsx("td",{className:"py-3 px-4",children:f.customer}),a.jsx("td",{className:"py-3 px-4",children:f.date}),a.jsx("td",{className:"py-3 px-4",children:f.amount}),a.jsx("td",{className:"py-3 px-4",children:f.reason}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Under Review"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:f.status==="Under Review"?a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"High chance of winning"}):a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"Insufficient evidence"})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(U,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),f.status==="Under Review"&&a.jsx(U,{variant:"default",size:"sm",children:"Respond"})]})]},f.id))})]})})})]})})]})]})},gRe=()=>{const[t,e]=p.useState("sales");return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Analytics & Reports"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Total Sales"})}),a.jsxs(tt,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$12,845.75"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(Mf,{className:"h-4 w-4 mr-1"})," +15% from last month"]})]})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Orders"})}),a.jsxs(tt,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"156"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(Mf,{className:"h-4 w-4 mr-1"})," +8% from last month"]})]})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Conversion Rate"})}),a.jsxs(tt,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"3.2%"}),a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(Mf,{className:"h-4 w-4 mr-1"})," -0.5% from last month"]})]})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Avg. Order Value"})}),a.jsxs(tt,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$82.34"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(Mf,{className:"h-4 w-4 mr-1"})," +5% from last month"]})]})]})]}),a.jsxs(Fi,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(hi,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(Gt,{value:"sales",children:[a.jsx(Pv,{className:"mr-2 h-4 w-4"}),"Sales Reports"]}),a.jsxs(Gt,{value:"traffic",children:[a.jsx(Mf,{className:"mr-2 h-4 w-4"}),"Traffic & Conversion"]}),a.jsxs(Gt,{value:"customers",children:[a.jsx(m0,{className:"mr-2 h-4 w-4"}),"Customer Insights"]}),a.jsxs(Gt,{value:"marketing",children:[a.jsx(ZV,{className:"mr-2 h-4 w-4"}),"Marketing Attribution"]}),a.jsxs(Gt,{value:"products",children:[a.jsx(Ei,{className:"mr-2 h-4 w-4"}),"Product Performance"]})]}),a.jsx(Wt,{value:"sales",children:a.jsxs(We,{children:[a.jsxs(ot,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(at,{children:"Sales Overview"}),a.jsx(qt,{children:"Comprehensive sales data with AI summarization"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(U,{variant:"outline",children:"Export"}),a.jsx(U,{variant:"outline",children:"Print"})]})]}),a.jsxs(tt,{children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"h-80 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Sales chart placeholder"})})}),a.jsxs(We,{className:"bg-muted/30",children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"AI Sales Summary"})}),a.jsxs(tt,{children:[a.jsxs("p",{className:"text-sm",children:[a.jsx("strong",{children:"Key Insights:"}),' Your sales have increased by 15% compared to last month, with the highest growth in the "Electronics" category (+24%). Weekend sales are particularly strong, accounting for 45% of your weekly revenue. The average order value has increased by 5%, indicating customers are purchasing higher-value items.']}),a.jsxs("p",{className:"text-sm mt-2",children:[a.jsx("strong",{children:"Recommendations:"}),' Consider running promotions on weekdays to boost sales during slower periods. The "Apparel" category has seen a slight decline (-3%) and may benefit from new product additions or targeted marketing.']})]})]})]})]})}),a.jsx(Wt,{value:"traffic",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Traffic & Conversion Analysis"}),a.jsx(qt,{children:"Website traffic sources and conversion rates"})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Traffic Sources"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Traffic sources chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Conversion Funnel"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Conversion funnel chart placeholder"})})]})]}),a.jsxs(We,{className:"bg-muted/30",children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"AI Conversion Recommendations"})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-sm",children:"Your current conversion rate of 3.2% is below the industry average of 4.5% for e-commerce stores in your category. The biggest drop-off occurs at the checkout page (45% abandonment rate)."}),a.jsx("p",{className:"text-sm mt-2",children:a.jsx("strong",{children:"Recommendations:"})}),a.jsxs("ul",{className:"text-sm list-disc pl-5 mt-1",children:[a.jsx("li",{children:"Simplify your checkout process by reducing the number of form fields"}),a.jsx("li",{children:"Add trust badges and security indicators near payment information"}),a.jsx("li",{children:"Implement exit-intent popups with discount offers to reduce cart abandonment"}),a.jsx("li",{children:"Optimize product page load times (currently averaging 3.2s, aim for under 2s)"})]})]})]})]})]})}),a.jsx(Wt,{value:"customers",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Customer Insights"}),a.jsx(qt,{children:"Detailed analysis of customer behavior and demographics"})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Customer Demographics"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Demographics chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Purchase Frequency"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Purchase frequency chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Customer Lifetime Value"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"CLV chart placeholder"})})]})]}),a.jsxs(We,{className:"bg-muted/30",children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Customer Personas"})}),a.jsx(tt,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Tech-Savvy Millennials"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"25-34 years old, urban areas, high income"}),a.jsx("p",{className:"text-sm mt-2",children:"Prefer electronics and premium products, shop primarily on mobile devices"})]}),a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Budget-Conscious Families"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"35-44 years old, suburban areas, middle income"}),a.jsx("p",{className:"text-sm mt-2",children:"Focus on value, frequently use discount codes, buy in bulk"})]}),a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Luxury Shoppers"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"45-60 years old, various locations, high income"}),a.jsx("p",{className:"text-sm mt-2",children:"Purchase high-end products, less price sensitive, value quality and service"})]})]})})]})]})]})}),a.jsx(Wt,{value:"marketing",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Marketing Attribution"}),a.jsx(qt,{children:"Track the effectiveness of your marketing channels"})]}),a.jsxs(tt,{children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"h-80 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Marketing attribution chart placeholder"})})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Channel"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Sessions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conversions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conv. Rate"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"ROAS"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Organic Search"}),a.jsx("td",{className:"py-3 px-4",children:"2,456"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:"4.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$7,845.00"}),a.jsx("td",{className:"py-3 px-4",children:"N/A"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Paid Search"}),a.jsx("td",{className:"py-3 px-4",children:"1,245"}),a.jsx("td",{className:"py-3 px-4",children:"62"}),a.jsx("td",{className:"py-3 px-4",children:"5.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$4,980.00"}),a.jsx("td",{className:"py-3 px-4",children:"3.2x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Social Media"}),a.jsx("td",{className:"py-3 px-4",children:"3,120"}),a.jsx("td",{className:"py-3 px-4",children:"78"}),a.jsx("td",{className:"py-3 px-4",children:"2.5%"}),a.jsx("td",{className:"py-3 px-4",children:"$5,460.00"}),a.jsx("td",{className:"py-3 px-4",children:"2.8x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Email Marketing"}),a.jsx("td",{className:"py-3 px-4",children:"980"}),a.jsx("td",{className:"py-3 px-4",children:"49"}),a.jsx("td",{className:"py-3 px-4",children:"5.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$3,920.00"}),a.jsx("td",{className:"py-3 px-4",children:"4.5x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Direct"}),a.jsx("td",{className:"py-3 px-4",children:"1,560"}),a.jsx("td",{className:"py-3 px-4",children:"47"}),a.jsx("td",{className:"py-3 px-4",children:"3.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$3,760.00"}),a.jsx("td",{className:"py-3 px-4",children:"N/A"})]})]})]})})]})]})}),a.jsx(Wt,{value:"products",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Product Performance"}),a.jsx(qt,{children:"Detailed analysis of product sales and performance"})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Top Selling Products"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Top products chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Product Category Performance"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Category performance chart placeholder"})})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Category"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Units Sold"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Profit Margin"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Return Rate"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Rating"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Premium T-Shirt"}),a.jsx("td",{className:"py-3 px-4",children:"Apparel"}),a.jsx("td",{className:"py-3 px-4",children:"245"}),a.jsx("td",{className:"py-3 px-4",children:"$7,345.55"}),a.jsx("td",{className:"py-3 px-4",children:"45%"}),a.jsx("td",{className:"py-3 px-4",children:"2.1%"}),a.jsx("td",{className:"py-3 px-4",children:"4.8/5"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Wireless Headphones"}),a.jsx("td",{className:"py-3 px-4",children:"Electronics"}),a.jsx("td",{className:"py-3 px-4",children:"124"}),a.jsx("td",{className:"py-3 px-4",children:"$11,098.00"}),a.jsx("td",{className:"py-3 px-4",children:"32%"}),a.jsx("td",{className:"py-3 px-4",children:"3.5%"}),a.jsx("td",{className:"py-3 px-4",children:"4.6/5"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Leather Wallet"}),a.jsx("td",{className:"py-3 px-4",children:"Accessories"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:"$4,899.02"}),a.jsx("td",{className:"py-3 px-4",children:"55%"}),a.jsx("td",{className:"py-3 px-4",children:"1.2%"}),a.jsx("td",{className:"py-3 px-4",children:"4.9/5"})]})]})]})})]})]})})]})]})},yRe=()=>{const[t,e]=p.useState("email"),n=[{id:"EM-1234",name:"Summer Sale Announcement",status:"Sent",sentDate:"2023-05-15",opens:1245,clicks:356,conversions:28,revenue:"$2,450"},{id:"EM-1235",name:"New Product Launch",status:"Draft",lastEdited:"2023-05-14"},{id:"EM-1236",name:"Customer Feedback Request",status:"Scheduled",scheduledDate:"2023-05-20"},{id:"EM-1237",name:"Abandoned Cart Recovery",status:"Sent",sentDate:"2023-05-12",opens:876,clicks:234,conversions:15,revenue:"$1,280"}],r=[{id:"SM-567",platform:"Instagram",content:"Summer collection now available!",status:"Published",publishDate:"2023-05-15",engagement:245,likes:189,comments:32},{id:"SM-568",platform:"Facebook",content:"Limited time offer: 20% off all accessories",status:"Scheduled",scheduledDate:"2023-05-18"},{id:"SM-569",platform:"Twitter",content:"Flash sale today only! Use code FLASH25",status:"Published",publishDate:"2023-05-14",engagement:178,likes:45,comments:12},{id:"SM-570",platform:"TikTok",content:"Behind the scenes of our latest photoshoot",status:"Draft",lastEdited:"2023-05-16"}],s=[{id:"BLG-890",title:"10 Summer Fashion Trends",status:"Published",publishDate:"2023-05-10",views:1245,comments:23,shares:56},{id:"BLG-891",title:"How to Choose the Perfect Headphones",status:"Draft",lastEdited:"2023-05-14"},{id:"BLG-892",title:"Sustainable Fashion: Our Commitment",status:"Published",publishDate:"2023-05-05",views:980,comments:18,shares:42},{id:"BLG-893",title:"Gift Guide: Father's Day Edition",status:"Scheduled",scheduledDate:"2023-05-25"}],i=[{id:"PROMO-123",name:"Summer Sale",type:"Discount",value:"20% off",status:"Active",startDate:"2023-05-01",endDate:"2023-05-31",usageCount:245},{id:"PROMO-124",name:"Free Shipping",type:"Free Shipping",value:"Orders over $50",status:"Active",startDate:"2023-05-01",endDate:"2023-06-30",usageCount:189},{id:"PROMO-125",name:"WELCOME10",type:"Discount",value:"10% off first order",status:"Active",startDate:"2023-01-01",endDate:"2023-12-31",usageCount:567},{id:"PROMO-126",name:"Holiday Bundle",type:"Bundle",value:"Buy 2 Get 1 Free",status:"Draft",startDate:"2023-11-15",endDate:"2023-12-25"}];return a.jsxs("div",{className:"bg-background",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Marketing"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(U,{variant:"outline",size:"sm",children:[a.jsx(X1,{className:"h-4 w-4 mr-2"}),"Content Calendar"]}),a.jsxs(U,{size:"sm",children:[a.jsx(go,{className:"h-4 w-4 mr-2"}),"Create Campaign"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Email Performance"})}),a.jsxs(tt,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"24.5%"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Average open rate"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+2.3% from last month"})]})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Social Engagement"})}),a.jsxs(tt,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"1,245"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Total interactions"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+15% from last month"})]})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Blog Traffic"})}),a.jsxs(tt,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"3,890"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Monthly page views"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+8% from last month"})]})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Promo Conversions"})}),a.jsxs(tt,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"12.8%"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Conversion rate"}),a.jsx("p",{className:"text-sm text-red-600 mt-2",children:"-1.2% from last month"})]})]})]}),a.jsxs(Fi,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(hi,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(Gt,{value:"email",children:[a.jsx(Gd,{className:"mr-2 h-4 w-4"}),"Email Campaigns"]}),a.jsxs(Gt,{value:"social",children:[a.jsx(_x,{className:"mr-2 h-4 w-4"}),"Social Media"]}),a.jsxs(Gt,{value:"seo",children:[a.jsx(lh,{className:"mr-2 h-4 w-4"}),"SEO Tools"]}),a.jsxs(Gt,{value:"blog",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Blog"]}),a.jsxs(Gt,{value:"promotions",children:[a.jsx(Tm,{className:"mr-2 h-4 w-4"}),"Promotions"]})]}),a.jsx(Wt,{value:"email",children:a.jsxs(We,{children:[a.jsxs(ot,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(at,{children:"Email Campaigns"}),a.jsx(qt,{children:"Create and manage email marketing campaigns"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(U,{variant:"outline",children:[a.jsx(Gd,{className:"mr-2 h-4 w-4"}),"Import Template"]}),a.jsxs(U,{children:[a.jsx(Gd,{className:"mr-2 h-4 w-4"}),"Create Campaign"]})]})]}),a.jsxs(tt,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Campaign Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Opens"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Clicks"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conversions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Sent"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.sentDate||o.lastEdited||o.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:o.opens||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.clicks||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.conversions||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.revenue||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(U,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),o.status!=="Sent"&&a.jsx(U,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Email Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate professional marketing emails with AI, including copy and layout suggestions."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(U,{children:[a.jsx(Gd,{className:"mr-2 h-4 w-4"}),"Generate New Email"]}),a.jsxs(U,{variant:"outline",children:[a.jsx(Pv,{className:"mr-2 h-4 w-4"}),"A/B Test Generator"]})]})]})]})]})}),a.jsx(Wt,{value:"social",children:a.jsxs(We,{children:[a.jsxs(ot,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(at,{children:"Social Media Campaigns"}),a.jsx(qt,{children:"Create and schedule social media content"})]}),a.jsxs(U,{children:[a.jsx(_x,{className:"mr-2 h-4 w-4"}),"Create Post"]})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Content Calendar"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Content calendar placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Platform Performance"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Performance chart placeholder"})})]})]}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Recent Posts"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Platform"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Content"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Engagement"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Likes"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Comments"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.platform}),a.jsx("td",{className:"py-3 px-4",children:o.content}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Published"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.publishDate||o.scheduledDate||o.lastEdited}),a.jsx("td",{className:"py-3 px-4",children:o.engagement||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.likes||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.comments||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(U,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),o.status!=="Published"&&a.jsx(U,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Content Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Transform product images into engaging social media content with AI."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(U,{children:[a.jsx(_x,{className:"mr-2 h-4 w-4"}),"Generate Social Media Images"]}),a.jsxs(U,{variant:"outline",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Generate Caption Ideas"]})]})]})]})]})}),a.jsx(Wt,{value:"seo",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"SEO Tools"}),a.jsx(qt,{children:"Optimize your store for search engines"})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Keyword Research"})}),a.jsxs(tt,{children:[a.jsxs("div",{className:"mb-4 flex gap-2",children:[a.jsx(st,{placeholder:"Enter a keyword to research...",className:"flex-1"}),a.jsxs(U,{children:[a.jsx(lh,{className:"mr-2 h-4 w-4"}),"Analyze"]})]}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Recent searches: wireless headphones, premium t-shirts, leather wallet"})]})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"SEO Performance"})}),a.jsx(tt,{children:a.jsx("div",{className:"h-40 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"SEO performance chart placeholder"})})})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Top Keywords"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Keyword"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Search Volume"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Difficulty"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Current Ranking"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Traffic"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"wireless headphones"}),a.jsx("td",{className:"py-3 px-4",children:"12,400"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800",children:"Medium"})}),a.jsx("td",{className:"py-3 px-4",children:"#8"}),a.jsx("td",{className:"py-3 px-4",children:"245"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(U,{variant:"outline",size:"sm",children:"Optimize"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"premium t-shirts"}),a.jsx("td",{className:"py-3 px-4",children:"5,800"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Low"})}),a.jsx("td",{className:"py-3 px-4",children:"#3"}),a.jsx("td",{className:"py-3 px-4",children:"320"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(U,{variant:"outline",size:"sm",children:"Optimize"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"leather wallet men"}),a.jsx("td",{className:"py-3 px-4",children:"8,200"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"High"})}),a.jsx("td",{className:"py-3 px-4",children:"#15"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(U,{variant:"outline",size:"sm",children:"Optimize"})})]})]})]})})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Content Optimizer"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate SEO-optimized content for your product pages and blog posts."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(U,{children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Generate SEO Content"]}),a.jsxs(U,{variant:"outline",children:[a.jsx(lh,{className:"mr-2 h-4 w-4"}),"Analyze Page SEO"]})]})]})]})]})}),a.jsx(Wt,{value:"blog",children:a.jsxs(We,{children:[a.jsxs(ot,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(at,{children:"Blog"}),a.jsx(qt,{children:"Create and manage blog content"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(U,{variant:"outline",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Import Article"]}),a.jsxs(U,{children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Create New Post"]})]})]}),a.jsxs(tt,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Title"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Views"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Comments"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Shares"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.title}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Published"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.publishDate||o.lastEdited||o.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:o.views||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.comments||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.shares||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(U,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(U,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Blog Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate engaging blog content with AI based on your products and target audience."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(U,{children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Generate Blog Post"]}),a.jsxs(U,{variant:"outline",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Generate Topic Ideas"]})]})]})]})]})}),a.jsx(Wt,{value:"promotions",children:a.jsxs(We,{children:[a.jsxs(ot,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(at,{children:"Promotions"}),a.jsx(qt,{children:"Create and manage promotional campaigns"})]}),a.jsxs(U,{children:[a.jsx(Tm,{className:"mr-2 h-4 w-4"}),"Create Promotion"]})]}),a.jsxs(tt,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Value"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Start Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"End Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Usage"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:i.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.name}),a.jsx("td",{className:"py-3 px-4",children:o.type}),a.jsx("td",{className:"py-3 px-4",children:o.value}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.startDate}),a.jsx("td",{className:"py-3 px-4",children:o.endDate}),a.jsx("td",{className:"py-3 px-4",children:o.usageCount||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(U,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(U,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Promotion Optimizer"}),a.jsx("p",{className:"text-sm mb-4",children:"Get AI recommendations for optimal discount levels and promotion timing based on your sales data."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(U,{children:[a.jsx(Tm,{className:"mr-2 h-4 w-4"}),"Generate Promotion Strategy"]}),a.jsxs(U,{variant:"outline",children:[a.jsx(Pv,{className:"mr-2 h-4 w-4"}),"Analyze Past Promotions"]})]})]})]})]})})]})]})},xRe=()=>{const[t,e]=p.useState("rates"),n=[{id:"ZONE-1",name:"Domestic",countries:["United States"],methods:[{name:"Standard",price:"$5.99",deliveryTime:"3-5 business days"},{name:"Express",price:"$12.99",deliveryTime:"1-2 business days"}]},{id:"ZONE-2",name:"Canada & Mexico",countries:["Canada","Mexico"],methods:[{name:"Standard",price:"$9.99",deliveryTime:"5-7 business days"},{name:"Express",price:"$19.99",deliveryTime:"2-3 business days"}]},{id:"ZONE-3",name:"International",countries:["Rest of World"],methods:[{name:"Standard",price:"$14.99",deliveryTime:"7-14 business days"},{name:"Express",price:"$29.99",deliveryTime:"3-5 business days"}]}],r=[{id:"SUP-1",name:"GlobalDropship Inc.",products:245,avgShippingTime:"4-7 days",status:"Connected"},{id:"SUP-2",name:"FastShip Solutions",products:189,avgShippingTime:"3-5 days",status:"Pending"},{id:"SUP-3",name:"EcoPackaging Co.",products:78,avgShippingTime:"5-8 days",status:"Connected"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Shipping & Delivery"}),a.jsxs(Fi,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(hi,{className:"grid grid-cols-3 mb-6",children:[a.jsxs(Gt,{value:"rates",children:[a.jsx(jv,{className:"mr-2 h-4 w-4"}),"Shipping Rates"]}),a.jsxs(Gt,{value:"dropshipping",children:[a.jsx(cu,{className:"mr-2 h-4 w-4"}),"Dropshipping"]}),a.jsxs(Gt,{value:"policy",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Shipping Policy"]})]}),a.jsx(Wt,{value:"rates",children:a.jsxs(We,{children:[a.jsxs(ot,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(at,{children:"Shipping Zones & Rates"}),a.jsx(qt,{children:"Configure shipping rates by zone and package type"})]}),a.jsxs(U,{children:[a.jsx(cu,{className:"mr-2 h-4 w-4"}),"Add Shipping Zone"]})]}),a.jsxs(tt,{children:[n.map(s=>a.jsxs(We,{className:"mb-6",children:[a.jsxs(ot,{className:"pb-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(at,{className:"text-lg",children:s.name}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(U,{variant:"outline",size:"sm",children:"Edit"}),a.jsx(U,{variant:"outline",size:"sm",children:"Delete"})]})]}),a.jsxs(qt,{children:["Countries: ",s.countries.join(", ")]})]}),a.jsxs(tt,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Method"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Price"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Delivery Time"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.methods.map((i,o)=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.name}),a.jsx("td",{className:"py-3 px-4",children:i.price}),a.jsx("td",{className:"py-3 px-4",children:i.deliveryTime}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(U,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(U,{variant:"outline",size:"sm",children:"Delete"})]})]},o))})]})}),a.jsxs(U,{variant:"outline",size:"sm",className:"mt-4",children:[a.jsx(Ei,{className:"mr-2 h-4 w-4"}),"Add Shipping Method"]})]})]},s.id)),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Package Types"}),a.jsx("p",{className:"text-sm mb-4",children:"Define standard package types to calculate shipping rates accurately."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Small Package"}),a.jsx(U,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 1 lb, 9" x 6" x 2"'})]}),a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Medium Package"}),a.jsx(U,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 5 lbs, 12" x 9" x 4"'})]}),a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Large Package"}),a.jsx(U,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 10 lbs, 18" x 12" x 6"'})]})]}),a.jsxs(U,{variant:"outline",size:"sm",children:[a.jsx(Ei,{className:"mr-2 h-4 w-4"}),"Add Package Type"]})]})]})]})}),a.jsx(Wt,{value:"dropshipping",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Dropshipping Integration"}),a.jsx(qt,{children:"Connect with dropshipping suppliers and manage fulfillment"})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Fulfillment Mode"})}),a.jsxs(tt,{children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(U,{variant:"outline",className:"flex-1",children:"Self-Fulfillment"}),a.jsx(U,{variant:"default",className:"flex-1",children:"Dropshipping"}),a.jsx(U,{variant:"outline",className:"flex-1",children:"Hybrid"})]}),a.jsxs("p",{className:"text-sm text-muted-foreground mt-4",children:["Current mode: ",a.jsx("strong",{children:"Dropshipping"}),". Products will be shipped directly from suppliers to customers."]})]})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Connect Supplier"})}),a.jsxs(tt,{children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(st,{placeholder:"Enter supplier API key or ID",className:"flex-1"}),a.jsxs(U,{children:[a.jsx(cu,{className:"mr-2 h-4 w-4"}),"Connect"]})]}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"We support direct integration with AliExpress, Spocket, Oberlo, and more."})]})]})]}),a.jsx("h3",{className:"font-medium mb-3",children:"Connected Suppliers"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Supplier"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Products"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Avg. Shipping Time"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.products}),a.jsx("td",{className:"py-3 px-4",children:s.avgShippingTime}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Connected"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(U,{variant:"outline",size:"sm",className:"mr-2",children:"View Products"}),a.jsx(U,{variant:"outline",size:"sm",children:"Disconnect"})]})]},s.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Automatic Order Routing"}),a.jsx("p",{className:"text-sm mb-4",children:"Configure how orders are routed to different suppliers based on product, location, or other criteria."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(U,{children:[a.jsx(Rv,{className:"mr-2 h-4 w-4"}),"Configure Routing Rules"]}),a.jsxs(U,{variant:"outline",children:[a.jsx(Ei,{className:"mr-2 h-4 w-4"}),"View Order Queue"]})]})]})]})]})}),a.jsx(Wt,{value:"policy",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Shipping Policy & Returns"}),a.jsx(qt,{children:"Configure your shipping policy and return management settings"})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Shipping Policy"}),a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Shipping Policy"}),a.jsx("p",{children:"We ship to all 50 US states and select international destinations. Orders are typically processed within 1-2 business days."}),a.jsx("h5",{children:"Domestic Shipping"}),a.jsxs("p",{children:["Standard shipping (3-5 business days): $5.99",a.jsx("br",{}),"Express shipping (1-2 business days): $12.99"]}),a.jsx("h5",{children:"International Shipping"}),a.jsxs("p",{children:["Standard shipping (7-14 business days): $14.99",a.jsx("br",{}),"Express shipping (3-5 business days): $29.99"]}),a.jsx("p",{children:"Free shipping on all domestic orders over $50. Shipping times may vary during peak seasons and holidays."})]})}),a.jsxs(U,{className:"mt-4",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Edit Shipping Policy"]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Return Policy"}),a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Return Policy"}),a.jsx("p",{children:"We offer a 30-day return policy for most items. To be eligible for a return, your item must be unused and in the same condition that you received it."}),a.jsx("h5",{children:"Return Process"}),a.jsxs("p",{children:["1. Contact our customer service team",a.jsx("br",{}),"2. Receive a Return Merchandise Authorization (RMA) number",a.jsx("br",{}),"3. Ship the item back with the RMA number clearly marked",a.jsx("br",{}),"4. Once received, we will process your refund within 5-7 business days"]}),a.jsx("h5",{children:"Exceptions"}),a.jsxs("p",{children:["Certain items cannot be returned, including:",a.jsx("br",{}),"- Personalized or custom-made products",a.jsx("br",{}),"- Digital downloads",a.jsx("br",{}),"- Gift cards"]})]})}),a.jsxs(U,{className:"mt-4",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Edit Return Policy"]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Return Management"}),a.jsx("p",{className:"text-sm mb-4",children:"Configure how returns are processed and managed."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Return Window"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(st,{type:"number",defaultValue:"30",className:"w-20"}),a.jsx("span",{className:"text-sm",children:"days after delivery"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Restocking Fee"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(st,{type:"number",defaultValue:"10",className:"w-20"}),a.jsx("span",{className:"text-sm",children:"% of item price"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Return Labels"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{variant:"outline",size:"sm",children:"Customer Pays"}),a.jsx(U,{variant:"default",size:"sm",children:"Store Provides"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Refund Method"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{variant:"default",size:"sm",children:"Original Payment"}),a.jsx(U,{variant:"outline",size:"sm",children:"Store Credit"})]})]})]}),a.jsxs(U,{className:"mt-4",children:[a.jsx(Rv,{className:"mr-2 h-4 w-4"}),"Save Return Settings"]})]})]})]})})]})]})},vRe=({store:t})=>{var v,b,S,I;const[e,n]=p.useState("store"),{user:r,session:s,subscriptionStatus:i}=ro(),{updateStore:o,isLoadingStores:l}=Fn(),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),g=i==="active",x=async()=>{if(!(s!=null&&s.access_token)){h("Authentication token not found. Please log in again.");return}u(!0),h(null);try{const D=await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/create-portal-session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`}}),k=await D.json();if(!D.ok)throw new Error(k.error||"Failed to create portal session.");window.location.href=k.url}catch(D){console.error("Portal session error:",D),h(D.message)}finally{u(!1)}},E=()=>{var k;const D=((k=r==null?void 0:r.store)==null?void 0:k.subdomain)||"your-store";navigator.clipboard.writeText(`${D}.storegen.app`),m(!0),setTimeout(()=>m(!1),2e3)};return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Settings"}),a.jsxs(Fi,{value:e,onValueChange:n,className:"w-full",children:[a.jsxs(hi,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(Gt,{value:"store",children:[a.jsx(wp,{className:"mr-2 h-4 w-4"}),"Store Details"]}),a.jsxs(Gt,{value:"billing",children:[a.jsx(Bi,{className:"mr-2 h-4 w-4"}),"Billing"]}),a.jsxs(Gt,{value:"domain",children:[a.jsx(cu,{className:"mr-2 h-4 w-4"}),"Domain Management"]}),a.jsxs(Gt,{value:"legal",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Legal Pages"]}),a.jsxs(Gt,{value:"footer",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Footer Editor"]})]}),a.jsx(Wt,{value:"store",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Store Details"}),a.jsx(qt,{children:"Update your store information and preferences"})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-name",children:"Store Name"}),a.jsx(st,{id:"store-name",placeholder:"Your Store Name",defaultValue:"My Awesome Store"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-email",children:"Store Email"}),a.jsx(st,{id:"store-email",type:"email",placeholder:"contact@yourstore.com",defaultValue:(r==null?void 0:r.email)||""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-phone",children:"Store Phone"}),a.jsx(st,{id:"store-phone",placeholder:"+1 (555) 123-4567",defaultValue:"+1 (555) 123-4567"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-address",children:"Store Address"}),a.jsx(Vn,{id:"store-address",placeholder:"123 Main St, City, State, ZIP",defaultValue:"123 Main St\\nNew York, NY 10001\\nUnited States",rows:3})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-currency",children:"Currency"}),a.jsxs("select",{id:"store-currency",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",defaultValue:"USD",children:[a.jsx("option",{value:"USD",children:"USD ($)"}),a.jsx("option",{value:"EUR",children:"EUR (€)"}),a.jsx("option",{value:"GBP",children:"GBP (£)"}),a.jsx("option",{value:"CAD",children:"CAD ($)"}),a.jsx("option",{value:"AUD",children:"AUD ($)"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-timezone",children:"Timezone"}),a.jsxs("select",{id:"store-timezone",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",defaultValue:"America/New_York",children:[a.jsx("option",{value:"America/New_York",children:"Eastern Time (ET)"}),a.jsx("option",{value:"America/Chicago",children:"Central Time (CT)"}),a.jsx("option",{value:"America/Denver",children:"Mountain Time (MT)"}),a.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PT)"}),a.jsx("option",{value:"Europe/London",children:"London (GMT)"})]})]})]})]})]}),a.jsxs("div",{className:"mt-6 space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-description",children:"Store Description"}),a.jsx(Vn,{id:"store-description",placeholder:"Tell customers about your store...",defaultValue:"Welcome to My Awesome Store! We offer high-quality products at competitive prices. Our mission is to provide exceptional customer service and a seamless shopping experience.",rows:4})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Wo,{id:"enable-reviews",defaultChecked:!0}),a.jsx(je,{htmlFor:"enable-reviews",children:"Enable customer reviews"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Wo,{id:"enable-inventory",defaultChecked:!0}),a.jsx(je,{htmlFor:"enable-inventory",children:"Show inventory warnings on product pages"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Wo,{id:"enable-tax",defaultChecked:!0}),a.jsx(je,{htmlFor:"enable-tax",children:"Enable automatic tax calculation"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Wo,{id:"enable-store-theme-toggle",checked:((v=t==null?void 0:t.settings)==null?void 0:v.showThemeToggle)??!0,onCheckedChange:D=>{t&&o&&o(t.id,{settings:{...t.settings,showThemeToggle:D}})},disabled:l||!t}),a.jsx(je,{htmlFor:"enable-store-theme-toggle",children:"Show theme (light/dark) toggle in store header"})]})]}),a.jsxs(U,{className:"mt-6",disabled:l||!t,children:[a.jsx(C_,{className:"mr-2 h-4 w-4"}),"Save Store Details"]})]})]})}),a.jsx(Wt,{value:"billing",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Billing Information"}),a.jsx(qt,{children:"Manage your subscription and payment methods"})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Current Plan"})}),a.jsxs(tt,{children:[a.jsx("div",{className:"text-xl font-medium",children:g?"Store Creator Plan":"Free Plan"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g?"$29.99/month, billed monthly":"Limited features"}),a.jsxs("div",{className:"mt-4",children:[g?a.jsxs(U,{onClick:x,disabled:c,children:[a.jsx(Bi,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Subscription"]}):a.jsxs(U,{onClick:x,disabled:c,children:[" ",a.jsx(Bi,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Upgrade to Pro"]}),d&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:d})]})]})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Payment Methods"})}),a.jsx(tt,{children:g?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"bg-blue-100 p-2 rounded-md mr-3",children:a.jsx(Bi,{className:"h-5 w-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Visa ending in 4242"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Expires 12/2025"})]})]}),a.jsx(U,{variant:"outline",size:"sm",onClick:x,disabled:c,children:"Edit"})]}),a.jsxs(U,{variant:"outline",onClick:x,disabled:c,children:[a.jsx(Bi,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Add Payment Method"]})]}):a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsxs("p",{className:"text-muted-foreground",children:["No payment methods available.",a.jsx("br",{}),"Upgrade to add payment methods."]})})})]})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Billing History"})}),a.jsx(tt,{children:g?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Description"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Invoice"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"May 1, 2023"}),a.jsx("td",{className:"py-3 px-4",children:"Store Creator Plan"}),a.jsx("td",{className:"py-3 px-4",children:"$29.99"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Paid"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(U,{variant:"outline",size:"sm",children:"Download"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Apr 1, 2023"}),a.jsx("td",{className:"py-3 px-4",children:"Store Creator Plan"}),a.jsx("td",{className:"py-3 px-4",children:"$29.99"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Paid"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(U,{variant:"outline",size:"sm",children:"Download"})})]})]})]})}):a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsxs("p",{className:"text-muted-foreground",children:["No billing history available.",a.jsx("br",{}),"Upgrade to view billing history."]})})})]})]})]})}),a.jsx(Wt,{value:"domain",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Domain Management"}),a.jsx(qt,{children:"Configure your store's domain and URL settings"})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Subdomain"})}),a.jsxs(tt,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(st,{defaultValue:((b=r==null?void 0:r.store)==null?void 0:b.subdomain)||"your-store",className:"flex-grow"}),a.jsx("span",{className:"text-muted-foreground",children:".storegen.app"})]}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsxs(U,{children:[a.jsx(C_,{className:"mr-2 h-4 w-4"}),"Save Subdomain"]}),a.jsx(U,{variant:"outline",onClick:E,children:f?a.jsxs(a.Fragment,{children:[a.jsx(rg,{className:"mr-2 h-4 w-4"})," Copied"]}):a.jsxs(a.Fragment,{children:[a.jsx(WV,{className:"mr-2 h-4 w-4"})," Copy URL"]})})]})]})]}),a.jsxs(We,{children:[a.jsxs(ot,{className:"pb-2",children:[a.jsx(at,{className:"text-lg",children:"Custom Domain"}),!g&&a.jsx(qt,{children:a.jsx("span",{className:"text-yellow-600",children:"Available on paid plans only"})})]}),a.jsx(tt,{children:g?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(st,{placeholder:"yourdomain.com",className:"flex-grow"}),a.jsxs(U,{children:[a.jsx(cu,{className:"mr-2 h-4 w-4"}),"Connect"]})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your domain name without http:// or www."})]}):a.jsxs("div",{className:"flex flex-col items-center justify-center h-32 space-y-4",children:[a.jsx("p",{className:"text-muted-foreground text-center",children:"Custom domains are available on paid plans only."}),a.jsxs(U,{onClick:x,disabled:c,children:[a.jsx(Bi,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Upgrade to Pro"]})]})})]})]}),g&&a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"DNS Configuration"})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm",children:"To connect your custom domain, add these DNS records in your domain provider's dashboard:"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Value"}),a.jsx("th",{className:"text-left py-3 px-4",children:"TTL"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"CNAME"}),a.jsx("td",{className:"py-3 px-4",children:"@"}),a.jsxs("td",{className:"py-3 px-4",children:[((S=r==null?void 0:r.store)==null?void 0:S.subdomain)||"your-store",".storegen.app"]}),a.jsx("td",{className:"py-3 px-4",children:"3600"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"CNAME"}),a.jsx("td",{className:"py-3 px-4",children:"www"}),a.jsxs("td",{className:"py-3 px-4",children:[((I=r==null?void 0:r.store)==null?void 0:I.subdomain)||"your-store",".storegen.app"]}),a.jsx("td",{className:"py-3 px-4",children:"3600"})]})]})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(U,{variant:"outline",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"View DNS Guide"]}),a.jsxs(U,{children:[a.jsx(cu,{className:"mr-2 h-4 w-4"}),"Verify DNS"]})]})]})})]})]})]})}),a.jsx(Wt,{value:"legal",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Legal Pages"}),a.jsx(qt,{children:"Configure your store's legal documents and policies"})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Privacy Policy"})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Privacy Policy"}),a.jsx("p",{children:"This Privacy Policy describes how your personal information is collected, used, and shared when you visit or make a purchase from our store."}),a.jsx("h5",{children:"Personal Information We Collect"}),a.jsx("p",{children:"When you visit the Site, we automatically collect certain information about your device, including information about your web browser, IP address, time zone, and some of the cookies that are installed on your device."}),a.jsx("p",{children:"Additionally, as you browse the Site, we collect information about the individual web pages or products that you view, what websites or search terms referred you to the Site, and information about how you interact with the Site."}),a.jsx("h5",{children:"How We Use Your Personal Information"}),a.jsx("p",{children:"We use the information that we collect generally to fulfill any orders placed through the Site (including processing your payment information, arranging for shipping, and providing you with invoices and/or order confirmations)."})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(U,{children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Edit Privacy Policy"]}),a.jsxs(U,{variant:"outline",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Terms of Service"})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Terms of Service"}),a.jsx("p",{children:"These Terms of Service govern your use of our website and the products and services provided by us."}),a.jsx("h5",{children:"Overview"}),a.jsx("p",{children:"By accessing our website, you agree to these Terms of Service. If you do not agree with any part of these terms, you may not access the website or use our services."}),a.jsx("h5",{children:"Products and Services"}),a.jsx("p",{children:"All products and services displayed on our website are subject to availability. We reserve the right to discontinue any product or service at any time."}),a.jsx("h5",{children:"Accuracy of Information"}),a.jsx("p",{children:"We make every effort to ensure that the information on our website is accurate and up-to-date. However, we do not warrant that product descriptions or other content is accurate, complete, reliable, current, or error-free."})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(U,{children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Edit Terms of Service"]}),a.jsxs(U,{variant:"outline",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Refund Policy"})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Refund Policy"}),a.jsx("p",{children:"We offer a 30-day return policy for most items. To be eligible for a return, your item must be unused and in the same condition that you received it."}),a.jsx("h5",{children:"Return Process"}),a.jsxs("p",{children:["1. Contact our customer service team",a.jsx("br",{}),"2. Receive a Return Merchandise Authorization (RMA) number",a.jsx("br",{}),"3. Ship the item back with the RMA number clearly marked",a.jsx("br",{}),"4. Once received, we will process your refund within 5-7 business days"]}),a.jsx("h5",{children:"Exceptions"}),a.jsxs("p",{children:["Certain items cannot be returned, including:",a.jsx("br",{}),"- Personalized or custom-made products",a.jsx("br",{}),"- Digital downloads",a.jsx("br",{}),"- Gift cards"]})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(U,{children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Edit Refund Policy"]}),a.jsxs(U,{variant:"outline",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Cookie Policy"})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Cookie Policy"}),a.jsx("p",{children:"This Cookie Policy explains how we use cookies and similar technologies to recognize you when you visit our website."}),a.jsx("h5",{children:"What are cookies?"}),a.jsx("p",{children:"Cookies are small data files that are placed on your computer or mobile device when you visit a website. Cookies are widely used by website owners in order to make their websites work, or to work more efficiently, as well as to provide reporting information."}),a.jsx("h5",{children:"How we use cookies"}),a.jsx("p",{children:'We use cookies for several reasons. Some cookies are required for technical reasons in order for our website to operate, and we refer to these as "essential" or "strictly necessary" cookies. Other cookies enable us to track and target the interests of our users to enhance the experience on our website.'})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(U,{children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Edit Cookie Policy"]}),a.jsxs(U,{variant:"outline",children:[a.jsx(Tr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]})]})]})]})}),a.jsx(Wt,{value:"footer",children:a.jsxs(We,{children:[a.jsxs(ot,{children:[a.jsx(at,{children:"Footer Editor"}),a.jsx(qt,{children:"Customize your store's footer information"})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Contact Information"})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-email",children:"Email"}),a.jsx(st,{id:"footer-email",type:"email",placeholder:"contact@yourstore.com",defaultValue:(r==null?void 0:r.email)||""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-phone",children:"Phone"}),a.jsx(st,{id:"footer-phone",placeholder:"+1 (555) 123-4567",defaultValue:"+1 (555) 123-4567"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-address",children:"Address"}),a.jsx(Vn,{id:"footer-address",placeholder:"123 Main St, City, State, ZIP",defaultValue:"123 Main St\\nNew York, NY 10001\\nUnited States",rows:3})]})]})})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Business Hours"})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-hours",children:"Hours of Operation"}),a.jsx(Vn,{id:"footer-hours",placeholder:"Monday-Friday: 9am-5pm",defaultValue:"Monday-Friday: 9am-5pm\\nSaturday: 10am-4pm\\nSunday: Closed",rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-support",children:"Customer Support Hours"}),a.jsx(Vn,{id:"footer-support",placeholder:"Monday-Friday: 9am-5pm",defaultValue:"Monday-Friday: 9am-6pm\\nSaturday: 10am-2pm\\nSunday: Closed",rows:3})]})]})})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"Social Media"})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-facebook",children:"Facebook"}),a.jsx(st,{id:"footer-facebook",placeholder:"https://facebook.com/yourstore",defaultValue:"https://facebook.com/yourstore"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-instagram",children:"Instagram"}),a.jsx(st,{id:"footer-instagram",placeholder:"https://instagram.com/yourstore",defaultValue:"https://instagram.com/yourstore"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-twitter",children:"Twitter"}),a.jsx(st,{id:"footer-twitter",placeholder:"https://twitter.com/yourstore",defaultValue:"https://twitter.com/yourstore"})]})]})})]})]}),a.jsxs(We,{children:[a.jsx(ot,{className:"pb-2",children:a.jsx(at,{className:"text-lg",children:"About Us"})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-about",children:"About Us Text"}),a.jsx(Vn,{id:"footer-about",placeholder:"Tell customers about your business...",defaultValue:"My Awesome Store was founded in 2023 with a mission to provide high-quality products at competitive prices. We are committed to exceptional customer service and a seamless shopping experience.",rows:4})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-copyright",children:"Copyright Text"}),a.jsx(st,{id:"footer-copyright",placeholder:"© 2023 Your Store. All rights reserved.",defaultValue:`© ${new Date().getFullYear()} My Awesome Store. All rights reserved.`})]})]})})]}),a.jsx("div",{className:"mt-6",children:a.jsxs(U,{children:[a.jsx(C_,{className:"mr-2 h-4 w-4"}),"Save Footer Settings"]})})]})]})})]})]})},wRe=()=>{const{storeName:t}=s0(),e=qa(),{getStoreById:n,getStoreByName:r,setCurrentStore:s,isLoadingStores:i}=Fn(),o=new URLSearchParams(e.search),l=o.get("tab")||"orders",[c,u]=p.useState(l),[d,h]=p.useState(null);p.useEffect(()=>{if(!i&&t){const m=r(t);m?(h(m),s(m)):console.error(`Store with name ${t} not found.`)}},[t,r,s,i]),p.useEffect(()=>{const m=o.get("tab");m&&m!==c&&u(m)},[e.search]);const f=()=>{switch(c){case"orders":return a.jsx(bF,{store:d});case"products":return a.jsx(fRe,{store:d});case"customers":return a.jsx(mRe,{store:d});case"payments":return a.jsx(pRe,{store:d});case"analytics":return a.jsx(gRe,{store:d});case"marketing":return a.jsx(yRe,{store:d});case"shipping":return a.jsx(xRe,{store:d});case"settings":return a.jsx(vRe,{store:d});default:return a.jsx(bF,{store:d})}};return i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading dashboard..."})]})}):!d&&!i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Store Not Found"}),a.jsxs("p",{className:"text-muted-foreground",children:["Could not load dashboard for store: ",t]})]})}):a.jsx(hRe,{activeTab:c,setActiveTab:u,storeId:d==null?void 0:d.id,storeName:d==null?void 0:d.name,children:f()})},bRe=()=>{const{isAuthenticated:t,userRole:e,loadingProfile:n}=ro();return n?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("p",{className:"text-xl",children:"Loading..."})}):t?e==="admin"?a.jsx(_1e,{}):a.jsx(b1e,{}):a.jsx(O1,{to:"/auth",replace:!0})},_Re=()=>{const{isAuthenticated:t,loadingProfile:e}=ro();return e?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("p",{className:"text-xl",children:"Loading..."})}):t?a.jsx(O1,{to:"/",replace:!0}):a.jsx(oRe,{})},SRe=[{element:a.jsxs(Abe,{children:[a.jsx(dRe,{})," "]}),children:[{index:!0,element:a.jsx(bRe,{})},{path:"auth",element:a.jsx(_Re,{})},{path:"pricing",element:a.jsx(aRe,{})},{path:":storeName",element:a.jsx(Rke,{})},{path:":storeName/product/:productId",element:a.jsx(eRe,{})},{path:"checkout",element:a.jsx(rRe,{})},{path:"order-confirmation",element:a.jsx(cRe,{})},{path:":storeName/content-creation",element:a.jsx(Qbe,{})},{path:":storeName/dashboard",element:a.jsx(wRe,{})},{path:"*",element:a.jsx(O1,{to:"/",replace:!0})}]}],ERe=!0,CRe=!0,TRe=eX(SRe,{future:{v7_startTransition:ERe,v7_relativeSplatPath:CRe}}),Qx=document.getElementById("root");Qx._reactRoot||(Qx._reactRoot=GS.createRoot(Qx));const _F=Qx._reactRoot;try{_F.render(a.jsx(ht.StrictMode,{children:a.jsx(cX,{router:TRe})}))}catch(t){console.error("Application initialization failed:",t);let e="Application failed to load. Please check the console for details.";t.message.includes("VITE_")&&t.message.includes("is not set")&&(e=`Configuration Error: ${t.message}. Please ensure all required environment variables are correctly set in your .env file and the application is rebuilt if necessary.`),_F.render(a.jsx(ht.StrictMode,{children:a.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",fontFamily:"sans-serif"},children:[a.jsx("h1",{children:"Application Load Error"}),a.jsx("p",{children:e}),a.jsxs("p",{children:["Please check your ",a.jsx("code",{children:".env"})," file and ensure all necessary environment variables are configured."]})]})}))}export{Yo as $,Eu as A,U as B,We as C,cu as D,Kse as E,mI as F,E_ as G,qV as H,$n as I,vde as J,ui as K,Us as L,Gd as M,Bv as N,ts as O,Wj as P,Ta as Q,ht as R,is as S,Mf as T,ag as U,qp as V,XV as W,ra as X,JV as Y,e3 as Z,m0 as _,qde as a,iie as a0,by as a1,hie as a2,sie as a3,Use as a4,Yse as a5,wie as a6,_x as a7,Cie as a8,rie as a9,Ike as aA,Ake as aB,rg as aC,gie as aD,ja as aE,Vn as aF,Jo as aG,St as aH,go as aI,Jse as aJ,eie as aK,xie as aa,Bj as ab,di as ac,nC as ad,rC as ae,Wo as af,Zi as ag,sr as ah,Ps as ai,ls as aj,cs as ak,us as al,No as am,Fi as an,hi as ao,Gt as ap,Wt as aq,je as ar,jr as as,sae as at,$H as au,ZV as av,Jde as aw,Ei as ax,uie as ay,na as az,K_ as b,QV as c,lu as d,Cke as e,Gc as f,tt as g,Yu as h,bp as i,a as j,kv as k,lh as l,It as m,Wl as n,Ue as o,jv as p,Bi as q,p as r,jEe as s,Bse as t,Fn as u,Eke as v,Et as w,Ks as x,st as y,YV as z};
