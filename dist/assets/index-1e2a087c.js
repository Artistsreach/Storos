function oF(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var zx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ew(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var aF={exports:{}},Cw={},lF={exports:{}},cn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vp=Symbol.for("react.element"),ZW=Symbol.for("react.portal"),eq=Symbol.for("react.fragment"),tq=Symbol.for("react.strict_mode"),nq=Symbol.for("react.profiler"),rq=Symbol.for("react.provider"),sq=Symbol.for("react.context"),iq=Symbol.for("react.forward_ref"),oq=Symbol.for("react.suspense"),aq=Symbol.for("react.memo"),lq=Symbol.for("react.lazy"),FA=Symbol.iterator;function cq(t){return t===null||typeof t!="object"?null:(t=FA&&t[FA]||t["@@iterator"],typeof t=="function"?t:null)}var cF={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},uF=Object.assign,dF={};function $h(t,e,n){this.props=t,this.context=e,this.refs=dF,this.updater=n||cF}$h.prototype.isReactComponent={};$h.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};$h.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function hF(){}hF.prototype=$h.prototype;function RT(t,e,n){this.props=t,this.context=e,this.refs=dF,this.updater=n||cF}var kT=RT.prototype=new hF;kT.constructor=RT;uF(kT,$h.prototype);kT.isPureReactComponent=!0;var OA=Array.isArray,fF=Object.prototype.hasOwnProperty,jT={current:null},mF={key:!0,ref:!0,__self:!0,__source:!0};function pF(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)fF.call(e,r)&&!mF.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Vp,type:t,key:i,ref:o,props:s,_owner:jT.current}}function uq(t,e){return{$$typeof:Vp,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function DT(t){return typeof t=="object"&&t!==null&&t.$$typeof===Vp}function dq(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var VA=/\/+/g;function F_(t,e){return typeof t=="object"&&t!==null&&t.key!=null?dq(""+t.key):e.toString(36)}function Jy(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Vp:case ZW:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+F_(o,0):r,OA(s)?(n="",t!=null&&(n=t.replace(VA,"$&/")+"/"),Jy(s,e,n,"",function(u){return u})):s!=null&&(DT(s)&&(s=uq(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(VA,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",OA(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+F_(i,l);o+=Jy(i,e,n,c,s)}else if(c=cq(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+F_(i,l++),o+=Jy(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Vg(t,e,n){if(t==null)return t;var r=[],s=0;return Jy(t,r,"","",function(i){return e.call(n,i,s++)}),r}function hq(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var js={current:null},Xy={transition:null},fq={ReactCurrentDispatcher:js,ReactCurrentBatchConfig:Xy,ReactCurrentOwner:jT};function gF(){throw Error("act(...) is not supported in production builds of React.")}cn.Children={map:Vg,forEach:function(t,e,n){Vg(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Vg(t,function(){e++}),e},toArray:function(t){return Vg(t,function(e){return e})||[]},only:function(t){if(!DT(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};cn.Component=$h;cn.Fragment=eq;cn.Profiler=nq;cn.PureComponent=RT;cn.StrictMode=tq;cn.Suspense=oq;cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fq;cn.act=gF;cn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=uF({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=jT.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)fF.call(e,c)&&!mF.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Vp,type:t.type,key:s,ref:i,props:r,_owner:o}};cn.createContext=function(t){return t={$$typeof:sq,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:rq,_context:t},t.Consumer=t};cn.createElement=pF;cn.createFactory=function(t){var e=pF.bind(null,t);return e.type=t,e};cn.createRef=function(){return{current:null}};cn.forwardRef=function(t){return{$$typeof:iq,render:t}};cn.isValidElement=DT;cn.lazy=function(t){return{$$typeof:lq,_payload:{_status:-1,_result:t},_init:hq}};cn.memo=function(t,e){return{$$typeof:aq,type:t,compare:e===void 0?null:e}};cn.startTransition=function(t){var e=Xy.transition;Xy.transition={};try{t()}finally{Xy.transition=e}};cn.unstable_act=gF;cn.useCallback=function(t,e){return js.current.useCallback(t,e)};cn.useContext=function(t){return js.current.useContext(t)};cn.useDebugValue=function(){};cn.useDeferredValue=function(t){return js.current.useDeferredValue(t)};cn.useEffect=function(t,e){return js.current.useEffect(t,e)};cn.useId=function(){return js.current.useId()};cn.useImperativeHandle=function(t,e,n){return js.current.useImperativeHandle(t,e,n)};cn.useInsertionEffect=function(t,e){return js.current.useInsertionEffect(t,e)};cn.useLayoutEffect=function(t,e){return js.current.useLayoutEffect(t,e)};cn.useMemo=function(t,e){return js.current.useMemo(t,e)};cn.useReducer=function(t,e,n){return js.current.useReducer(t,e,n)};cn.useRef=function(t){return js.current.useRef(t)};cn.useState=function(t){return js.current.useState(t)};cn.useSyncExternalStore=function(t,e,n){return js.current.useSyncExternalStore(t,e,n)};cn.useTransition=function(){return js.current.useTransition()};cn.version="18.3.1";lF.exports=cn;var p=lF.exports;const ct=Ew(p),Tw=oF({__proto__:null,default:ct},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mq=p,pq=Symbol.for("react.element"),gq=Symbol.for("react.fragment"),yq=Object.prototype.hasOwnProperty,xq=mq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vq={key:!0,ref:!0,__self:!0,__source:!0};function yF(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)yq.call(e,r)&&!vq.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:pq,type:t,key:i,ref:o,props:s,_owner:xq.current}}Cw.Fragment=gq;Cw.jsx=yF;Cw.jsxs=yF;aF.exports=Cw;var a=aF.exports,DS={},xF={exports:{}},wi={},vF={exports:{}},wF={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,X){var O=H.length;H.push(X);e:for(;0<O;){var z=O-1>>>1,Y=H[z];if(0<s(Y,X))H[z]=X,H[O]=Y,O=z;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var X=H[0],O=H.pop();if(O!==X){H[0]=O;e:for(var z=0,Y=H.length,F=Y>>>1;z<F;){var ye=2*(z+1)-1,Se=H[ye],De=ye+1,xe=H[De];if(0>s(Se,O))De<Y&&0>s(xe,Se)?(H[z]=xe,H[De]=O,z=De):(H[z]=Se,H[ye]=O,z=ye);else if(De<Y&&0>s(xe,O))H[z]=xe,H[De]=O,z=De;else break e}}return X}function s(H,X){var O=H.sortIndex-X.sortIndex;return O!==0?O:H.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,g=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(H){for(var X=n(u);X!==null;){if(X.callback===null)r(u);else if(X.startTime<=H)r(u),X.sortIndex=X.expirationTime,e(c,X);else break;X=n(u)}}function I(H){if(x=!1,S(H),!g)if(n(c)!==null)g=!0,K(M);else{var X=n(u);X!==null&&ee(I,X.startTime-H)}}function M(H,X){g=!1,x&&(x=!1,v(T),T=-1),m=!0;var O=f;try{for(S(X),h=n(c);h!==null&&(!(h.expirationTime>X)||H&&!D());){var z=h.callback;if(typeof z=="function"){h.callback=null,f=h.priorityLevel;var Y=z(h.expirationTime<=X);X=t.unstable_now(),typeof Y=="function"?h.callback=Y:h===n(c)&&r(c),S(X)}else r(c);h=n(c)}if(h!==null)var F=!0;else{var ye=n(u);ye!==null&&ee(I,ye.startTime-X),F=!1}return F}finally{h=null,f=O,m=!1}}var j=!1,C=null,T=-1,P=5,A=-1;function D(){return!(t.unstable_now()-A<P)}function R(){if(C!==null){var H=t.unstable_now();A=H;var X=!0;try{X=C(!0,H)}finally{X?k():(j=!1,C=null)}}else j=!1}var k;if(typeof _=="function")k=function(){_(R)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,B=U.port2;U.port1.onmessage=R,k=function(){B.postMessage(null)}}else k=function(){E(R,0)};function K(H){C=H,j||(j=!0,k())}function ee(H,X){T=E(function(){H(t.unstable_now())},X)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,K(M))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(H){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var O=f;f=X;try{return H()}finally{f=O}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,X){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var O=f;f=H;try{return X()}finally{f=O}},t.unstable_scheduleCallback=function(H,X,O){var z=t.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?z+O:z):O=z,H){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=O+Y,H={id:d++,callback:X,priorityLevel:H,startTime:O,expirationTime:Y,sortIndex:-1},O>z?(H.sortIndex=O,e(u,H),n(c)===null&&H===n(u)&&(x?(v(T),T=-1):x=!0,ee(I,O-z))):(H.sortIndex=Y,e(c,H),g||m||(g=!0,K(M))),H},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(H){var X=f;return function(){var O=f;f=X;try{return H.apply(this,arguments)}finally{f=O}}}})(wF);vF.exports=wF;var wq=vF.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _q=p,yi=wq;function He(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _F=new Set,Bm={};function Tu(t,e){ch(t,e),ch(t+"Capture",e)}function ch(t,e){for(Bm[t]=e,t=0;t<e.length;t++)_F.add(e[t])}var ga=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),MS=Object.prototype.hasOwnProperty,bq=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$A={},UA={};function Sq(t){return MS.call(UA,t)?!0:MS.call($A,t)?!1:bq.test(t)?UA[t]=!0:($A[t]=!0,!1)}function Eq(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Cq(t,e,n,r){if(e===null||typeof e>"u"||Eq(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ds(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Zr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Zr[t]=new Ds(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Zr[e]=new Ds(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Zr[t]=new Ds(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Zr[t]=new Ds(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Zr[t]=new Ds(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Zr[t]=new Ds(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Zr[t]=new Ds(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Zr[t]=new Ds(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Zr[t]=new Ds(t,5,!1,t.toLowerCase(),null,!1,!1)});var MT=/[\-:]([a-z])/g;function LT(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(MT,LT);Zr[e]=new Ds(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(MT,LT);Zr[e]=new Ds(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(MT,LT);Zr[e]=new Ds(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Zr[t]=new Ds(t,1,!1,t.toLowerCase(),null,!1,!1)});Zr.xlinkHref=new Ds("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Zr[t]=new Ds(t,1,!1,t.toLowerCase(),null,!0,!0)});function FT(t,e,n,r){var s=Zr.hasOwnProperty(e)?Zr[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Cq(e,n,s,r)&&(n=null),r||s===null?Sq(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ka=_q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$g=Symbol.for("react.element"),xd=Symbol.for("react.portal"),vd=Symbol.for("react.fragment"),OT=Symbol.for("react.strict_mode"),LS=Symbol.for("react.profiler"),bF=Symbol.for("react.provider"),SF=Symbol.for("react.context"),VT=Symbol.for("react.forward_ref"),FS=Symbol.for("react.suspense"),OS=Symbol.for("react.suspense_list"),$T=Symbol.for("react.memo"),nl=Symbol.for("react.lazy"),EF=Symbol.for("react.offscreen"),BA=Symbol.iterator;function ff(t){return t===null||typeof t!="object"?null:(t=BA&&t[BA]||t["@@iterator"],typeof t=="function"?t:null)}var or=Object.assign,O_;function Bf(t){if(O_===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);O_=e&&e[1]||""}return`
`+O_+t}var V_=!1;function $_(t,e){if(!t||V_)return"";V_=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{V_=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Bf(t):""}function Tq(t){switch(t.tag){case 5:return Bf(t.type);case 16:return Bf("Lazy");case 13:return Bf("Suspense");case 19:return Bf("SuspenseList");case 0:case 2:case 15:return t=$_(t.type,!1),t;case 11:return t=$_(t.type.render,!1),t;case 1:return t=$_(t.type,!0),t;default:return""}}function VS(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case vd:return"Fragment";case xd:return"Portal";case LS:return"Profiler";case OT:return"StrictMode";case FS:return"Suspense";case OS:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case SF:return(t.displayName||"Context")+".Consumer";case bF:return(t._context.displayName||"Context")+".Provider";case VT:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case $T:return e=t.displayName||null,e!==null?e:VS(t.type)||"Memo";case nl:e=t._payload,t=t._init;try{return VS(t(e))}catch{}}return null}function Iq(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return VS(e);case 8:return e===OT?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Fl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function CF(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Nq(t){var e=CF(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ug(t){t._valueTracker||(t._valueTracker=Nq(t))}function TF(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=CF(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Gx(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function $S(t,e){var n=e.checked;return or({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function zA(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Fl(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function IF(t,e){e=e.checked,e!=null&&FT(t,"checked",e,!1)}function US(t,e){IF(t,e);var n=Fl(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?BS(t,e.type,n):e.hasOwnProperty("defaultValue")&&BS(t,e.type,Fl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function GA(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function BS(t,e,n){(e!=="number"||Gx(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var zf=Array.isArray;function Gd(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Fl(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function zS(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(He(91));return or({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function HA(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(He(92));if(zf(n)){if(1<n.length)throw Error(He(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Fl(n)}}function NF(t,e){var n=Fl(e.value),r=Fl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function WA(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function PF(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function GS(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?PF(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Bg,AF=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Bg=Bg||document.createElement("div"),Bg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Bg.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function zm(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var lm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pq=["Webkit","ms","Moz","O"];Object.keys(lm).forEach(function(t){Pq.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),lm[e]=lm[t]})});function RF(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||lm.hasOwnProperty(t)&&lm[t]?(""+e).trim():e+"px"}function kF(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=RF(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Aq=or({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function HS(t,e){if(e){if(Aq[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(He(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(He(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(He(61))}if(e.style!=null&&typeof e.style!="object")throw Error(He(62))}}function WS(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qS=null;function UT(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var KS=null,Hd=null,Wd=null;function qA(t){if(t=Bp(t)){if(typeof KS!="function")throw Error(He(280));var e=t.stateNode;e&&(e=Rw(e),KS(t.stateNode,t.type,e))}}function jF(t){Hd?Wd?Wd.push(t):Wd=[t]:Hd=t}function DF(){if(Hd){var t=Hd,e=Wd;if(Wd=Hd=null,qA(t),e)for(t=0;t<e.length;t++)qA(e[t])}}function MF(t,e){return t(e)}function LF(){}var U_=!1;function FF(t,e,n){if(U_)return t(e,n);U_=!0;try{return MF(t,e,n)}finally{U_=!1,(Hd!==null||Wd!==null)&&(LF(),DF())}}function Gm(t,e){var n=t.stateNode;if(n===null)return null;var r=Rw(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(He(231,e,typeof n));return n}var YS=!1;if(ga)try{var mf={};Object.defineProperty(mf,"passive",{get:function(){YS=!0}}),window.addEventListener("test",mf,mf),window.removeEventListener("test",mf,mf)}catch{YS=!1}function Rq(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var cm=!1,Hx=null,Wx=!1,JS=null,kq={onError:function(t){cm=!0,Hx=t}};function jq(t,e,n,r,s,i,o,l,c){cm=!1,Hx=null,Rq.apply(kq,arguments)}function Dq(t,e,n,r,s,i,o,l,c){if(jq.apply(this,arguments),cm){if(cm){var u=Hx;cm=!1,Hx=null}else throw Error(He(198));Wx||(Wx=!0,JS=u)}}function Iu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function OF(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function KA(t){if(Iu(t)!==t)throw Error(He(188))}function Mq(t){var e=t.alternate;if(!e){if(e=Iu(t),e===null)throw Error(He(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return KA(s),t;if(i===r)return KA(s),e;i=i.sibling}throw Error(He(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(He(189))}}if(n.alternate!==r)throw Error(He(190))}if(n.tag!==3)throw Error(He(188));return n.stateNode.current===n?t:e}function VF(t){return t=Mq(t),t!==null?$F(t):null}function $F(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=$F(t);if(e!==null)return e;t=t.sibling}return null}var UF=yi.unstable_scheduleCallback,YA=yi.unstable_cancelCallback,Lq=yi.unstable_shouldYield,Fq=yi.unstable_requestPaint,yr=yi.unstable_now,Oq=yi.unstable_getCurrentPriorityLevel,BT=yi.unstable_ImmediatePriority,BF=yi.unstable_UserBlockingPriority,qx=yi.unstable_NormalPriority,Vq=yi.unstable_LowPriority,zF=yi.unstable_IdlePriority,Iw=null,Mo=null;function $q(t){if(Mo&&typeof Mo.onCommitFiberRoot=="function")try{Mo.onCommitFiberRoot(Iw,t,void 0,(t.current.flags&128)===128)}catch{}}var lo=Math.clz32?Math.clz32:zq,Uq=Math.log,Bq=Math.LN2;function zq(t){return t>>>=0,t===0?32:31-(Uq(t)/Bq|0)|0}var zg=64,Gg=4194304;function Gf(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Kx(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Gf(l):(i&=o,i!==0&&(r=Gf(i)))}else o=n&~s,o!==0?r=Gf(o):i!==0&&(r=Gf(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-lo(e),s=1<<n,r|=t[n],e&=~s;return r}function Gq(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Hq(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-lo(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=Gq(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function XS(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function GF(){var t=zg;return zg<<=1,!(zg&4194240)&&(zg=64),t}function B_(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function $p(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-lo(e),t[e]=n}function Wq(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-lo(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function zT(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-lo(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var In=0;function HF(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var WF,GT,qF,KF,YF,QS=!1,Hg=[],yl=null,xl=null,vl=null,Hm=new Map,Wm=new Map,il=[],qq="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function JA(t,e){switch(t){case"focusin":case"focusout":yl=null;break;case"dragenter":case"dragleave":xl=null;break;case"mouseover":case"mouseout":vl=null;break;case"pointerover":case"pointerout":Hm.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wm.delete(e.pointerId)}}function pf(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Bp(e),e!==null&&GT(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Kq(t,e,n,r,s){switch(e){case"focusin":return yl=pf(yl,t,e,n,r,s),!0;case"dragenter":return xl=pf(xl,t,e,n,r,s),!0;case"mouseover":return vl=pf(vl,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Hm.set(i,pf(Hm.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Wm.set(i,pf(Wm.get(i)||null,t,e,n,r,s)),!0}return!1}function JF(t){var e=$c(t.target);if(e!==null){var n=Iu(e);if(n!==null){if(e=n.tag,e===13){if(e=OF(n),e!==null){t.blockedOn=e,YF(t.priority,function(){qF(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Qy(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ZS(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);qS=r,n.target.dispatchEvent(r),qS=null}else return e=Bp(n),e!==null&&GT(e),t.blockedOn=n,!1;e.shift()}return!0}function XA(t,e,n){Qy(t)&&n.delete(e)}function Yq(){QS=!1,yl!==null&&Qy(yl)&&(yl=null),xl!==null&&Qy(xl)&&(xl=null),vl!==null&&Qy(vl)&&(vl=null),Hm.forEach(XA),Wm.forEach(XA)}function gf(t,e){t.blockedOn===e&&(t.blockedOn=null,QS||(QS=!0,yi.unstable_scheduleCallback(yi.unstable_NormalPriority,Yq)))}function qm(t){function e(s){return gf(s,t)}if(0<Hg.length){gf(Hg[0],t);for(var n=1;n<Hg.length;n++){var r=Hg[n];r.blockedOn===t&&(r.blockedOn=null)}}for(yl!==null&&gf(yl,t),xl!==null&&gf(xl,t),vl!==null&&gf(vl,t),Hm.forEach(e),Wm.forEach(e),n=0;n<il.length;n++)r=il[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<il.length&&(n=il[0],n.blockedOn===null);)JF(n),n.blockedOn===null&&il.shift()}var qd=ka.ReactCurrentBatchConfig,Yx=!0;function Jq(t,e,n,r){var s=In,i=qd.transition;qd.transition=null;try{In=1,HT(t,e,n,r)}finally{In=s,qd.transition=i}}function Xq(t,e,n,r){var s=In,i=qd.transition;qd.transition=null;try{In=4,HT(t,e,n,r)}finally{In=s,qd.transition=i}}function HT(t,e,n,r){if(Yx){var s=ZS(t,e,n,r);if(s===null)Q_(t,e,r,Jx,n),JA(t,r);else if(Kq(s,t,e,n,r))r.stopPropagation();else if(JA(t,r),e&4&&-1<qq.indexOf(t)){for(;s!==null;){var i=Bp(s);if(i!==null&&WF(i),i=ZS(t,e,n,r),i===null&&Q_(t,e,r,Jx,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Q_(t,e,r,null,n)}}var Jx=null;function ZS(t,e,n,r){if(Jx=null,t=UT(r),t=$c(t),t!==null)if(e=Iu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=OF(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Jx=t,null}function XF(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Oq()){case BT:return 1;case BF:return 4;case qx:case Vq:return 16;case zF:return 536870912;default:return 16}default:return 16}}var fl=null,WT=null,Zy=null;function QF(){if(Zy)return Zy;var t,e=WT,n=e.length,r,s="value"in fl?fl.value:fl.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Zy=s.slice(t,1<r?1-r:void 0)}function ex(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Wg(){return!0}function QA(){return!1}function _i(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Wg:QA,this.isPropagationStopped=QA,this}return or(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Wg)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Wg)},persist:function(){},isPersistent:Wg}),e}var Uh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qT=_i(Uh),Up=or({},Uh,{view:0,detail:0}),Qq=_i(Up),z_,G_,yf,Nw=or({},Up,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:KT,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==yf&&(yf&&t.type==="mousemove"?(z_=t.screenX-yf.screenX,G_=t.screenY-yf.screenY):G_=z_=0,yf=t),z_)},movementY:function(t){return"movementY"in t?t.movementY:G_}}),ZA=_i(Nw),Zq=or({},Nw,{dataTransfer:0}),eK=_i(Zq),tK=or({},Up,{relatedTarget:0}),H_=_i(tK),nK=or({},Uh,{animationName:0,elapsedTime:0,pseudoElement:0}),rK=_i(nK),sK=or({},Uh,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),iK=_i(sK),oK=or({},Uh,{data:0}),eR=_i(oK),aK={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lK={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cK={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uK(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=cK[t])?!!e[t]:!1}function KT(){return uK}var dK=or({},Up,{key:function(t){if(t.key){var e=aK[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ex(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?lK[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:KT,charCode:function(t){return t.type==="keypress"?ex(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ex(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),hK=_i(dK),fK=or({},Nw,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tR=_i(fK),mK=or({},Up,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:KT}),pK=_i(mK),gK=or({},Uh,{propertyName:0,elapsedTime:0,pseudoElement:0}),yK=_i(gK),xK=or({},Nw,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),vK=_i(xK),wK=[9,13,27,32],YT=ga&&"CompositionEvent"in window,um=null;ga&&"documentMode"in document&&(um=document.documentMode);var _K=ga&&"TextEvent"in window&&!um,ZF=ga&&(!YT||um&&8<um&&11>=um),nR=String.fromCharCode(32),rR=!1;function eO(t,e){switch(t){case"keyup":return wK.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tO(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var wd=!1;function bK(t,e){switch(t){case"compositionend":return tO(e);case"keypress":return e.which!==32?null:(rR=!0,nR);case"textInput":return t=e.data,t===nR&&rR?null:t;default:return null}}function SK(t,e){if(wd)return t==="compositionend"||!YT&&eO(t,e)?(t=QF(),Zy=WT=fl=null,wd=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ZF&&e.locale!=="ko"?null:e.data;default:return null}}var EK={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sR(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!EK[t.type]:e==="textarea"}function nO(t,e,n,r){jF(r),e=Xx(e,"onChange"),0<e.length&&(n=new qT("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var dm=null,Km=null;function CK(t){fO(t,0)}function Pw(t){var e=Sd(t);if(TF(e))return t}function TK(t,e){if(t==="change")return e}var rO=!1;if(ga){var W_;if(ga){var q_="oninput"in document;if(!q_){var iR=document.createElement("div");iR.setAttribute("oninput","return;"),q_=typeof iR.oninput=="function"}W_=q_}else W_=!1;rO=W_&&(!document.documentMode||9<document.documentMode)}function oR(){dm&&(dm.detachEvent("onpropertychange",sO),Km=dm=null)}function sO(t){if(t.propertyName==="value"&&Pw(Km)){var e=[];nO(e,Km,t,UT(t)),FF(CK,e)}}function IK(t,e,n){t==="focusin"?(oR(),dm=e,Km=n,dm.attachEvent("onpropertychange",sO)):t==="focusout"&&oR()}function NK(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Pw(Km)}function PK(t,e){if(t==="click")return Pw(e)}function AK(t,e){if(t==="input"||t==="change")return Pw(e)}function RK(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ho=typeof Object.is=="function"?Object.is:RK;function Ym(t,e){if(ho(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!MS.call(e,s)||!ho(t[s],e[s]))return!1}return!0}function aR(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function lR(t,e){var n=aR(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=aR(n)}}function iO(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?iO(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function oO(){for(var t=window,e=Gx();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Gx(t.document)}return e}function JT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function kK(t){var e=oO(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&iO(n.ownerDocument.documentElement,n)){if(r!==null&&JT(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=lR(n,i);var o=lR(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var jK=ga&&"documentMode"in document&&11>=document.documentMode,_d=null,eE=null,hm=null,tE=!1;function cR(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;tE||_d==null||_d!==Gx(r)||(r=_d,"selectionStart"in r&&JT(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),hm&&Ym(hm,r)||(hm=r,r=Xx(eE,"onSelect"),0<r.length&&(e=new qT("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=_d)))}function qg(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var bd={animationend:qg("Animation","AnimationEnd"),animationiteration:qg("Animation","AnimationIteration"),animationstart:qg("Animation","AnimationStart"),transitionend:qg("Transition","TransitionEnd")},K_={},aO={};ga&&(aO=document.createElement("div").style,"AnimationEvent"in window||(delete bd.animationend.animation,delete bd.animationiteration.animation,delete bd.animationstart.animation),"TransitionEvent"in window||delete bd.transitionend.transition);function Aw(t){if(K_[t])return K_[t];if(!bd[t])return t;var e=bd[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in aO)return K_[t]=e[n];return t}var lO=Aw("animationend"),cO=Aw("animationiteration"),uO=Aw("animationstart"),dO=Aw("transitionend"),hO=new Map,uR="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ql(t,e){hO.set(t,e),Tu(e,[t])}for(var Y_=0;Y_<uR.length;Y_++){var J_=uR[Y_],DK=J_.toLowerCase(),MK=J_[0].toUpperCase()+J_.slice(1);Ql(DK,"on"+MK)}Ql(lO,"onAnimationEnd");Ql(cO,"onAnimationIteration");Ql(uO,"onAnimationStart");Ql("dblclick","onDoubleClick");Ql("focusin","onFocus");Ql("focusout","onBlur");Ql(dO,"onTransitionEnd");ch("onMouseEnter",["mouseout","mouseover"]);ch("onMouseLeave",["mouseout","mouseover"]);ch("onPointerEnter",["pointerout","pointerover"]);ch("onPointerLeave",["pointerout","pointerover"]);Tu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LK=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hf));function dR(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Dq(r,e,void 0,t),t.currentTarget=null}function fO(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;dR(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;dR(s,l,u),i=c}}}if(Wx)throw t=JS,Wx=!1,JS=null,t}function Gn(t,e){var n=e[oE];n===void 0&&(n=e[oE]=new Set);var r=t+"__bubble";n.has(r)||(mO(e,t,2,!1),n.add(r))}function X_(t,e,n){var r=0;e&&(r|=4),mO(n,t,r,e)}var Kg="_reactListening"+Math.random().toString(36).slice(2);function Jm(t){if(!t[Kg]){t[Kg]=!0,_F.forEach(function(n){n!=="selectionchange"&&(LK.has(n)||X_(n,!1,t),X_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Kg]||(e[Kg]=!0,X_("selectionchange",!1,e))}}function mO(t,e,n,r){switch(XF(e)){case 1:var s=Jq;break;case 4:s=Xq;break;default:s=HT}n=s.bind(null,e,n,t),s=void 0,!YS||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Q_(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=$c(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}FF(function(){var u=i,d=UT(n),h=[];e:{var f=hO.get(t);if(f!==void 0){var m=qT,g=t;switch(t){case"keypress":if(ex(n)===0)break e;case"keydown":case"keyup":m=hK;break;case"focusin":g="focus",m=H_;break;case"focusout":g="blur",m=H_;break;case"beforeblur":case"afterblur":m=H_;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=ZA;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=eK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=pK;break;case lO:case cO:case uO:m=rK;break;case dO:m=yK;break;case"scroll":m=Qq;break;case"wheel":m=vK;break;case"copy":case"cut":case"paste":m=iK;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=tR}var x=(e&4)!==0,E=!x&&t==="scroll",v=x?f!==null?f+"Capture":null:f;x=[];for(var _=u,S;_!==null;){S=_;var I=S.stateNode;if(S.tag===5&&I!==null&&(S=I,v!==null&&(I=Gm(_,v),I!=null&&x.push(Xm(_,I,S)))),E)break;_=_.return}0<x.length&&(f=new m(f,g,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==qS&&(g=n.relatedTarget||n.fromElement)&&($c(g)||g[ya]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(g=n.relatedTarget||n.toElement,m=u,g=g?$c(g):null,g!==null&&(E=Iu(g),g!==E||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(x=ZA,I="onMouseLeave",v="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(x=tR,I="onPointerLeave",v="onPointerEnter",_="pointer"),E=m==null?f:Sd(m),S=g==null?f:Sd(g),f=new x(I,_+"leave",m,n,d),f.target=E,f.relatedTarget=S,I=null,$c(d)===u&&(x=new x(v,_+"enter",g,n,d),x.target=S,x.relatedTarget=E,I=x),E=I,m&&g)t:{for(x=m,v=g,_=0,S=x;S;S=Hu(S))_++;for(S=0,I=v;I;I=Hu(I))S++;for(;0<_-S;)x=Hu(x),_--;for(;0<S-_;)v=Hu(v),S--;for(;_--;){if(x===v||v!==null&&x===v.alternate)break t;x=Hu(x),v=Hu(v)}x=null}else x=null;m!==null&&hR(h,f,m,x,!1),g!==null&&E!==null&&hR(h,E,g,x,!0)}}e:{if(f=u?Sd(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var M=TK;else if(sR(f))if(rO)M=AK;else{M=NK;var j=IK}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(M=PK);if(M&&(M=M(t,u))){nO(h,M,n,d);break e}j&&j(t,f,u),t==="focusout"&&(j=f._wrapperState)&&j.controlled&&f.type==="number"&&BS(f,"number",f.value)}switch(j=u?Sd(u):window,t){case"focusin":(sR(j)||j.contentEditable==="true")&&(_d=j,eE=u,hm=null);break;case"focusout":hm=eE=_d=null;break;case"mousedown":tE=!0;break;case"contextmenu":case"mouseup":case"dragend":tE=!1,cR(h,n,d);break;case"selectionchange":if(jK)break;case"keydown":case"keyup":cR(h,n,d)}var C;if(YT)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else wd?eO(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(ZF&&n.locale!=="ko"&&(wd||T!=="onCompositionStart"?T==="onCompositionEnd"&&wd&&(C=QF()):(fl=d,WT="value"in fl?fl.value:fl.textContent,wd=!0)),j=Xx(u,T),0<j.length&&(T=new eR(T,t,null,n,d),h.push({event:T,listeners:j}),C?T.data=C:(C=tO(n),C!==null&&(T.data=C)))),(C=_K?bK(t,n):SK(t,n))&&(u=Xx(u,"onBeforeInput"),0<u.length&&(d=new eR("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=C))}fO(h,e)})}function Xm(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Xx(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Gm(t,n),i!=null&&r.unshift(Xm(t,i,s)),i=Gm(t,e),i!=null&&r.push(Xm(t,i,s))),t=t.return}return r}function Hu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function hR(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Gm(n,i),c!=null&&o.unshift(Xm(n,c,l))):s||(c=Gm(n,i),c!=null&&o.push(Xm(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var FK=/\r\n?/g,OK=/\u0000|\uFFFD/g;function fR(t){return(typeof t=="string"?t:""+t).replace(FK,`
`).replace(OK,"")}function Yg(t,e,n){if(e=fR(e),fR(t)!==e&&n)throw Error(He(425))}function Qx(){}var nE=null,rE=null;function sE(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var iE=typeof setTimeout=="function"?setTimeout:void 0,VK=typeof clearTimeout=="function"?clearTimeout:void 0,mR=typeof Promise=="function"?Promise:void 0,$K=typeof queueMicrotask=="function"?queueMicrotask:typeof mR<"u"?function(t){return mR.resolve(null).then(t).catch(UK)}:iE;function UK(t){setTimeout(function(){throw t})}function Z_(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),qm(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);qm(e)}function wl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function pR(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Bh=Math.random().toString(36).slice(2),No="__reactFiber$"+Bh,Qm="__reactProps$"+Bh,ya="__reactContainer$"+Bh,oE="__reactEvents$"+Bh,BK="__reactListeners$"+Bh,zK="__reactHandles$"+Bh;function $c(t){var e=t[No];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ya]||n[No]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=pR(t);t!==null;){if(n=t[No])return n;t=pR(t)}return e}t=n,n=t.parentNode}return null}function Bp(t){return t=t[No]||t[ya],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Sd(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(He(33))}function Rw(t){return t[Qm]||null}var aE=[],Ed=-1;function Zl(t){return{current:t}}function Hn(t){0>Ed||(t.current=aE[Ed],aE[Ed]=null,Ed--)}function Fn(t,e){Ed++,aE[Ed]=t.current,t.current=e}var Ol={},gs=Zl(Ol),qs=Zl(!1),iu=Ol;function uh(t,e){var n=t.type.contextTypes;if(!n)return Ol;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ks(t){return t=t.childContextTypes,t!=null}function Zx(){Hn(qs),Hn(gs)}function gR(t,e,n){if(gs.current!==Ol)throw Error(He(168));Fn(gs,e),Fn(qs,n)}function pO(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(He(108,Iq(t)||"Unknown",s));return or({},n,r)}function ev(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ol,iu=gs.current,Fn(gs,t),Fn(qs,qs.current),!0}function yR(t,e,n){var r=t.stateNode;if(!r)throw Error(He(169));n?(t=pO(t,e,iu),r.__reactInternalMemoizedMergedChildContext=t,Hn(qs),Hn(gs),Fn(gs,t)):Hn(qs),Fn(qs,n)}var na=null,kw=!1,eb=!1;function gO(t){na===null?na=[t]:na.push(t)}function GK(t){kw=!0,gO(t)}function ec(){if(!eb&&na!==null){eb=!0;var t=0,e=In;try{var n=na;for(In=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}na=null,kw=!1}catch(s){throw na!==null&&(na=na.slice(t+1)),UF(BT,ec),s}finally{In=e,eb=!1}}return null}var Cd=[],Td=0,tv=null,nv=0,Ai=[],Ri=0,ou=null,ra=1,sa="";function _c(t,e){Cd[Td++]=nv,Cd[Td++]=tv,tv=t,nv=e}function yO(t,e,n){Ai[Ri++]=ra,Ai[Ri++]=sa,Ai[Ri++]=ou,ou=t;var r=ra;t=sa;var s=32-lo(r)-1;r&=~(1<<s),n+=1;var i=32-lo(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ra=1<<32-lo(e)+s|n<<s|r,sa=i+t}else ra=1<<i|n<<s|r,sa=t}function XT(t){t.return!==null&&(_c(t,1),yO(t,1,0))}function QT(t){for(;t===tv;)tv=Cd[--Td],Cd[Td]=null,nv=Cd[--Td],Cd[Td]=null;for(;t===ou;)ou=Ai[--Ri],Ai[Ri]=null,sa=Ai[--Ri],Ai[Ri]=null,ra=Ai[--Ri],Ai[Ri]=null}var pi=null,di=null,Yn=!1,ro=null;function xO(t,e){var n=Di(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function xR(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,pi=t,di=wl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,pi=t,di=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ou!==null?{id:ra,overflow:sa}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Di(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,pi=t,di=null,!0):!1;default:return!1}}function lE(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cE(t){if(Yn){var e=di;if(e){var n=e;if(!xR(t,e)){if(lE(t))throw Error(He(418));e=wl(n.nextSibling);var r=pi;e&&xR(t,e)?xO(r,n):(t.flags=t.flags&-4097|2,Yn=!1,pi=t)}}else{if(lE(t))throw Error(He(418));t.flags=t.flags&-4097|2,Yn=!1,pi=t}}}function vR(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;pi=t}function Jg(t){if(t!==pi)return!1;if(!Yn)return vR(t),Yn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!sE(t.type,t.memoizedProps)),e&&(e=di)){if(lE(t))throw vO(),Error(He(418));for(;e;)xO(t,e),e=wl(e.nextSibling)}if(vR(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(He(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){di=wl(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}di=null}}else di=pi?wl(t.stateNode.nextSibling):null;return!0}function vO(){for(var t=di;t;)t=wl(t.nextSibling)}function dh(){di=pi=null,Yn=!1}function ZT(t){ro===null?ro=[t]:ro.push(t)}var HK=ka.ReactCurrentBatchConfig;function xf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(He(309));var r=n.stateNode}if(!r)throw Error(He(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(He(284));if(!n._owner)throw Error(He(290,t))}return t}function Xg(t,e){throw t=Object.prototype.toString.call(e),Error(He(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function wR(t){var e=t._init;return e(t._payload)}function wO(t){function e(v,_){if(t){var S=v.deletions;S===null?(v.deletions=[_],v.flags|=16):S.push(_)}}function n(v,_){if(!t)return null;for(;_!==null;)e(v,_),_=_.sibling;return null}function r(v,_){for(v=new Map;_!==null;)_.key!==null?v.set(_.key,_):v.set(_.index,_),_=_.sibling;return v}function s(v,_){return v=El(v,_),v.index=0,v.sibling=null,v}function i(v,_,S){return v.index=S,t?(S=v.alternate,S!==null?(S=S.index,S<_?(v.flags|=2,_):S):(v.flags|=2,_)):(v.flags|=1048576,_)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,_,S,I){return _===null||_.tag!==6?(_=ab(S,v.mode,I),_.return=v,_):(_=s(_,S),_.return=v,_)}function c(v,_,S,I){var M=S.type;return M===vd?d(v,_,S.props.children,I,S.key):_!==null&&(_.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===nl&&wR(M)===_.type)?(I=s(_,S.props),I.ref=xf(v,_,S),I.return=v,I):(I=ax(S.type,S.key,S.props,null,v.mode,I),I.ref=xf(v,_,S),I.return=v,I)}function u(v,_,S,I){return _===null||_.tag!==4||_.stateNode.containerInfo!==S.containerInfo||_.stateNode.implementation!==S.implementation?(_=lb(S,v.mode,I),_.return=v,_):(_=s(_,S.children||[]),_.return=v,_)}function d(v,_,S,I,M){return _===null||_.tag!==7?(_=Yc(S,v.mode,I,M),_.return=v,_):(_=s(_,S),_.return=v,_)}function h(v,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return _=ab(""+_,v.mode,S),_.return=v,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case $g:return S=ax(_.type,_.key,_.props,null,v.mode,S),S.ref=xf(v,null,_),S.return=v,S;case xd:return _=lb(_,v.mode,S),_.return=v,_;case nl:var I=_._init;return h(v,I(_._payload),S)}if(zf(_)||ff(_))return _=Yc(_,v.mode,S,null),_.return=v,_;Xg(v,_)}return null}function f(v,_,S,I){var M=_!==null?_.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return M!==null?null:l(v,_,""+S,I);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case $g:return S.key===M?c(v,_,S,I):null;case xd:return S.key===M?u(v,_,S,I):null;case nl:return M=S._init,f(v,_,M(S._payload),I)}if(zf(S)||ff(S))return M!==null?null:d(v,_,S,I,null);Xg(v,S)}return null}function m(v,_,S,I,M){if(typeof I=="string"&&I!==""||typeof I=="number")return v=v.get(S)||null,l(_,v,""+I,M);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case $g:return v=v.get(I.key===null?S:I.key)||null,c(_,v,I,M);case xd:return v=v.get(I.key===null?S:I.key)||null,u(_,v,I,M);case nl:var j=I._init;return m(v,_,S,j(I._payload),M)}if(zf(I)||ff(I))return v=v.get(S)||null,d(_,v,I,M,null);Xg(_,I)}return null}function g(v,_,S,I){for(var M=null,j=null,C=_,T=_=0,P=null;C!==null&&T<S.length;T++){C.index>T?(P=C,C=null):P=C.sibling;var A=f(v,C,S[T],I);if(A===null){C===null&&(C=P);break}t&&C&&A.alternate===null&&e(v,C),_=i(A,_,T),j===null?M=A:j.sibling=A,j=A,C=P}if(T===S.length)return n(v,C),Yn&&_c(v,T),M;if(C===null){for(;T<S.length;T++)C=h(v,S[T],I),C!==null&&(_=i(C,_,T),j===null?M=C:j.sibling=C,j=C);return Yn&&_c(v,T),M}for(C=r(v,C);T<S.length;T++)P=m(C,v,T,S[T],I),P!==null&&(t&&P.alternate!==null&&C.delete(P.key===null?T:P.key),_=i(P,_,T),j===null?M=P:j.sibling=P,j=P);return t&&C.forEach(function(D){return e(v,D)}),Yn&&_c(v,T),M}function x(v,_,S,I){var M=ff(S);if(typeof M!="function")throw Error(He(150));if(S=M.call(S),S==null)throw Error(He(151));for(var j=M=null,C=_,T=_=0,P=null,A=S.next();C!==null&&!A.done;T++,A=S.next()){C.index>T?(P=C,C=null):P=C.sibling;var D=f(v,C,A.value,I);if(D===null){C===null&&(C=P);break}t&&C&&D.alternate===null&&e(v,C),_=i(D,_,T),j===null?M=D:j.sibling=D,j=D,C=P}if(A.done)return n(v,C),Yn&&_c(v,T),M;if(C===null){for(;!A.done;T++,A=S.next())A=h(v,A.value,I),A!==null&&(_=i(A,_,T),j===null?M=A:j.sibling=A,j=A);return Yn&&_c(v,T),M}for(C=r(v,C);!A.done;T++,A=S.next())A=m(C,v,T,A.value,I),A!==null&&(t&&A.alternate!==null&&C.delete(A.key===null?T:A.key),_=i(A,_,T),j===null?M=A:j.sibling=A,j=A);return t&&C.forEach(function(R){return e(v,R)}),Yn&&_c(v,T),M}function E(v,_,S,I){if(typeof S=="object"&&S!==null&&S.type===vd&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case $g:e:{for(var M=S.key,j=_;j!==null;){if(j.key===M){if(M=S.type,M===vd){if(j.tag===7){n(v,j.sibling),_=s(j,S.props.children),_.return=v,v=_;break e}}else if(j.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===nl&&wR(M)===j.type){n(v,j.sibling),_=s(j,S.props),_.ref=xf(v,j,S),_.return=v,v=_;break e}n(v,j);break}else e(v,j);j=j.sibling}S.type===vd?(_=Yc(S.props.children,v.mode,I,S.key),_.return=v,v=_):(I=ax(S.type,S.key,S.props,null,v.mode,I),I.ref=xf(v,_,S),I.return=v,v=I)}return o(v);case xd:e:{for(j=S.key;_!==null;){if(_.key===j)if(_.tag===4&&_.stateNode.containerInfo===S.containerInfo&&_.stateNode.implementation===S.implementation){n(v,_.sibling),_=s(_,S.children||[]),_.return=v,v=_;break e}else{n(v,_);break}else e(v,_);_=_.sibling}_=lb(S,v.mode,I),_.return=v,v=_}return o(v);case nl:return j=S._init,E(v,_,j(S._payload),I)}if(zf(S))return g(v,_,S,I);if(ff(S))return x(v,_,S,I);Xg(v,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,_!==null&&_.tag===6?(n(v,_.sibling),_=s(_,S),_.return=v,v=_):(n(v,_),_=ab(S,v.mode,I),_.return=v,v=_),o(v)):n(v,_)}return E}var hh=wO(!0),_O=wO(!1),rv=Zl(null),sv=null,Id=null,e1=null;function t1(){e1=Id=sv=null}function n1(t){var e=rv.current;Hn(rv),t._currentValue=e}function uE(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Kd(t,e){sv=t,e1=Id=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(zs=!0),t.firstContext=null)}function Bi(t){var e=t._currentValue;if(e1!==t)if(t={context:t,memoizedValue:e,next:null},Id===null){if(sv===null)throw Error(He(308));Id=t,sv.dependencies={lanes:0,firstContext:t}}else Id=Id.next=t;return e}var Uc=null;function r1(t){Uc===null?Uc=[t]:Uc.push(t)}function bO(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,r1(e)):(n.next=s.next,s.next=n),e.interleaved=n,xa(t,r)}function xa(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var rl=!1;function s1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function SO(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ca(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function _l(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,gn&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,xa(t,n)}return s=r.interleaved,s===null?(e.next=e,r1(r)):(e.next=s.next,s.next=e),r.interleaved=e,xa(t,n)}function tx(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zT(t,n)}}function _R(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function iv(t,e,n,r){var s=t.updateQueue;rl=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,m=l.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=t,x=l;switch(f=e,m=n,x.tag){case 1:if(g=x.payload,typeof g=="function"){h=g.call(m,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,f=typeof g=="function"?g.call(m,h,f):g,f==null)break e;h=or({},h,f);break e;case 2:rl=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(1);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);lu|=o,t.lanes=o,t.memoizedState=h}}function bR(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(He(191,s));s.call(r)}}}var zp={},Lo=Zl(zp),Zm=Zl(zp),ep=Zl(zp);function Bc(t){if(t===zp)throw Error(He(174));return t}function i1(t,e){switch(Fn(ep,e),Fn(Zm,t),Fn(Lo,zp),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:GS(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=GS(e,t)}Hn(Lo),Fn(Lo,e)}function fh(){Hn(Lo),Hn(Zm),Hn(ep)}function EO(t){Bc(ep.current);var e=Bc(Lo.current),n=GS(e,t.type);e!==n&&(Fn(Zm,t),Fn(Lo,n))}function o1(t){Zm.current===t&&(Hn(Lo),Hn(Zm))}var tr=Zl(0);function ov(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var tb=[];function a1(){for(var t=0;t<tb.length;t++)tb[t]._workInProgressVersionPrimary=null;tb.length=0}var nx=ka.ReactCurrentDispatcher,nb=ka.ReactCurrentBatchConfig,au=0,sr=null,kr=null,Vr=null,av=!1,fm=!1,tp=0,WK=0;function os(){throw Error(He(321))}function l1(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ho(t[n],e[n]))return!1;return!0}function c1(t,e,n,r,s,i){if(au=i,sr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,nx.current=t===null||t.memoizedState===null?JK:XK,t=n(r,s),fm){i=0;do{if(fm=!1,tp=0,25<=i)throw Error(He(301));i+=1,Vr=kr=null,e.updateQueue=null,nx.current=QK,t=n(r,s)}while(fm)}if(nx.current=lv,e=kr!==null&&kr.next!==null,au=0,Vr=kr=sr=null,av=!1,e)throw Error(He(300));return t}function u1(){var t=tp!==0;return tp=0,t}function So(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vr===null?sr.memoizedState=Vr=t:Vr=Vr.next=t,Vr}function zi(){if(kr===null){var t=sr.alternate;t=t!==null?t.memoizedState:null}else t=kr.next;var e=Vr===null?sr.memoizedState:Vr.next;if(e!==null)Vr=e,kr=t;else{if(t===null)throw Error(He(310));kr=t,t={memoizedState:kr.memoizedState,baseState:kr.baseState,baseQueue:kr.baseQueue,queue:kr.queue,next:null},Vr===null?sr.memoizedState=Vr=t:Vr=Vr.next=t}return Vr}function np(t,e){return typeof e=="function"?e(t):e}function rb(t){var e=zi(),n=e.queue;if(n===null)throw Error(He(311));n.lastRenderedReducer=t;var r=kr,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((au&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,sr.lanes|=d,lu|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,ho(r,e.memoizedState)||(zs=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,sr.lanes|=i,lu|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function sb(t){var e=zi(),n=e.queue;if(n===null)throw Error(He(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);ho(i,e.memoizedState)||(zs=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function CO(){}function TO(t,e){var n=sr,r=zi(),s=e(),i=!ho(r.memoizedState,s);if(i&&(r.memoizedState=s,zs=!0),r=r.queue,d1(PO.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Vr!==null&&Vr.memoizedState.tag&1){if(n.flags|=2048,rp(9,NO.bind(null,n,r,s,e),void 0,null),zr===null)throw Error(He(349));au&30||IO(n,e,s)}return s}function IO(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=sr.updateQueue,e===null?(e={lastEffect:null,stores:null},sr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function NO(t,e,n,r){e.value=n,e.getSnapshot=r,AO(e)&&RO(t)}function PO(t,e,n){return n(function(){AO(e)&&RO(t)})}function AO(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ho(t,n)}catch{return!0}}function RO(t){var e=xa(t,1);e!==null&&co(e,t,1,-1)}function SR(t){var e=So();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:np,lastRenderedState:t},e.queue=t,t=t.dispatch=YK.bind(null,sr,t),[e.memoizedState,t]}function rp(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=sr.updateQueue,e===null?(e={lastEffect:null,stores:null},sr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function kO(){return zi().memoizedState}function rx(t,e,n,r){var s=So();sr.flags|=t,s.memoizedState=rp(1|e,n,void 0,r===void 0?null:r)}function jw(t,e,n,r){var s=zi();r=r===void 0?null:r;var i=void 0;if(kr!==null){var o=kr.memoizedState;if(i=o.destroy,r!==null&&l1(r,o.deps)){s.memoizedState=rp(e,n,i,r);return}}sr.flags|=t,s.memoizedState=rp(1|e,n,i,r)}function ER(t,e){return rx(8390656,8,t,e)}function d1(t,e){return jw(2048,8,t,e)}function jO(t,e){return jw(4,2,t,e)}function DO(t,e){return jw(4,4,t,e)}function MO(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function LO(t,e,n){return n=n!=null?n.concat([t]):null,jw(4,4,MO.bind(null,e,t),n)}function h1(){}function FO(t,e){var n=zi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&l1(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function OO(t,e){var n=zi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&l1(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function VO(t,e,n){return au&21?(ho(n,e)||(n=GF(),sr.lanes|=n,lu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,zs=!0),t.memoizedState=n)}function qK(t,e){var n=In;In=n!==0&&4>n?n:4,t(!0);var r=nb.transition;nb.transition={};try{t(!1),e()}finally{In=n,nb.transition=r}}function $O(){return zi().memoizedState}function KK(t,e,n){var r=Sl(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},UO(t))BO(e,n);else if(n=bO(t,e,n,r),n!==null){var s=As();co(n,t,r,s),zO(n,e,r)}}function YK(t,e,n){var r=Sl(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(UO(t))BO(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,ho(l,o)){var c=e.interleaved;c===null?(s.next=s,r1(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=bO(t,e,s,r),n!==null&&(s=As(),co(n,t,r,s),zO(n,e,r))}}function UO(t){var e=t.alternate;return t===sr||e!==null&&e===sr}function BO(t,e){fm=av=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function zO(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zT(t,n)}}var lv={readContext:Bi,useCallback:os,useContext:os,useEffect:os,useImperativeHandle:os,useInsertionEffect:os,useLayoutEffect:os,useMemo:os,useReducer:os,useRef:os,useState:os,useDebugValue:os,useDeferredValue:os,useTransition:os,useMutableSource:os,useSyncExternalStore:os,useId:os,unstable_isNewReconciler:!1},JK={readContext:Bi,useCallback:function(t,e){return So().memoizedState=[t,e===void 0?null:e],t},useContext:Bi,useEffect:ER,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,rx(4194308,4,MO.bind(null,e,t),n)},useLayoutEffect:function(t,e){return rx(4194308,4,t,e)},useInsertionEffect:function(t,e){return rx(4,2,t,e)},useMemo:function(t,e){var n=So();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=So();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=KK.bind(null,sr,t),[r.memoizedState,t]},useRef:function(t){var e=So();return t={current:t},e.memoizedState=t},useState:SR,useDebugValue:h1,useDeferredValue:function(t){return So().memoizedState=t},useTransition:function(){var t=SR(!1),e=t[0];return t=qK.bind(null,t[1]),So().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=sr,s=So();if(Yn){if(n===void 0)throw Error(He(407));n=n()}else{if(n=e(),zr===null)throw Error(He(349));au&30||IO(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,ER(PO.bind(null,r,i,t),[t]),r.flags|=2048,rp(9,NO.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=So(),e=zr.identifierPrefix;if(Yn){var n=sa,r=ra;n=(r&~(1<<32-lo(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=tp++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=WK++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},XK={readContext:Bi,useCallback:FO,useContext:Bi,useEffect:d1,useImperativeHandle:LO,useInsertionEffect:jO,useLayoutEffect:DO,useMemo:OO,useReducer:rb,useRef:kO,useState:function(){return rb(np)},useDebugValue:h1,useDeferredValue:function(t){var e=zi();return VO(e,kr.memoizedState,t)},useTransition:function(){var t=rb(np)[0],e=zi().memoizedState;return[t,e]},useMutableSource:CO,useSyncExternalStore:TO,useId:$O,unstable_isNewReconciler:!1},QK={readContext:Bi,useCallback:FO,useContext:Bi,useEffect:d1,useImperativeHandle:LO,useInsertionEffect:jO,useLayoutEffect:DO,useMemo:OO,useReducer:sb,useRef:kO,useState:function(){return sb(np)},useDebugValue:h1,useDeferredValue:function(t){var e=zi();return kr===null?e.memoizedState=t:VO(e,kr.memoizedState,t)},useTransition:function(){var t=sb(np)[0],e=zi().memoizedState;return[t,e]},useMutableSource:CO,useSyncExternalStore:TO,useId:$O,unstable_isNewReconciler:!1};function Qi(t,e){if(t&&t.defaultProps){e=or({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function dE(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:or({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Dw={isMounted:function(t){return(t=t._reactInternals)?Iu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=As(),s=Sl(t),i=ca(r,s);i.payload=e,n!=null&&(i.callback=n),e=_l(t,i,s),e!==null&&(co(e,t,s,r),tx(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=As(),s=Sl(t),i=ca(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=_l(t,i,s),e!==null&&(co(e,t,s,r),tx(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=As(),r=Sl(t),s=ca(n,r);s.tag=2,e!=null&&(s.callback=e),e=_l(t,s,r),e!==null&&(co(e,t,r,n),tx(e,t,r))}};function CR(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ym(n,r)||!Ym(s,i):!0}function GO(t,e,n){var r=!1,s=Ol,i=e.contextType;return typeof i=="object"&&i!==null?i=Bi(i):(s=Ks(e)?iu:gs.current,r=e.contextTypes,i=(r=r!=null)?uh(t,s):Ol),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Dw,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function TR(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Dw.enqueueReplaceState(e,e.state,null)}function hE(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},s1(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Bi(i):(i=Ks(e)?iu:gs.current,s.context=uh(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(dE(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Dw.enqueueReplaceState(s,s.state,null),iv(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function mh(t,e){try{var n="",r=e;do n+=Tq(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function ib(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function fE(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ZK=typeof WeakMap=="function"?WeakMap:Map;function HO(t,e,n){n=ca(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){uv||(uv=!0,SE=r),fE(t,e)},n}function WO(t,e,n){n=ca(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){fE(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){fE(t,e),typeof r!="function"&&(bl===null?bl=new Set([this]):bl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function IR(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new ZK;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=fY.bind(null,t,e,n),e.then(t,t))}function NR(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function PR(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ca(-1,1),e.tag=2,_l(n,e,1))),n.lanes|=1),t)}var eY=ka.ReactCurrentOwner,zs=!1;function Ts(t,e,n,r){e.child=t===null?_O(e,null,n,r):hh(e,t.child,n,r)}function AR(t,e,n,r,s){n=n.render;var i=e.ref;return Kd(e,s),r=c1(t,e,n,r,i,s),n=u1(),t!==null&&!zs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,va(t,e,s)):(Yn&&n&&XT(e),e.flags|=1,Ts(t,e,r,s),e.child)}function RR(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!w1(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,qO(t,e,i,r,s)):(t=ax(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ym,n(o,r)&&t.ref===e.ref)return va(t,e,s)}return e.flags|=1,t=El(i,r),t.ref=e.ref,t.return=e,e.child=t}function qO(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ym(i,r)&&t.ref===e.ref)if(zs=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(zs=!0);else return e.lanes=t.lanes,va(t,e,s)}return mE(t,e,n,r,s)}function KO(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fn(Pd,oi),oi|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Fn(Pd,oi),oi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Fn(Pd,oi),oi|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Fn(Pd,oi),oi|=r;return Ts(t,e,s,n),e.child}function YO(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function mE(t,e,n,r,s){var i=Ks(n)?iu:gs.current;return i=uh(e,i),Kd(e,s),n=c1(t,e,n,r,i,s),r=u1(),t!==null&&!zs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,va(t,e,s)):(Yn&&r&&XT(e),e.flags|=1,Ts(t,e,n,s),e.child)}function kR(t,e,n,r,s){if(Ks(n)){var i=!0;ev(e)}else i=!1;if(Kd(e,s),e.stateNode===null)sx(t,e),GO(e,n,r),hE(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Bi(u):(u=Ks(n)?iu:gs.current,u=uh(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&TR(e,o,r,u),rl=!1;var f=e.memoizedState;o.state=f,iv(e,r,o,s),c=e.memoizedState,l!==r||f!==c||qs.current||rl?(typeof d=="function"&&(dE(e,n,d,r),c=e.memoizedState),(l=rl||CR(e,n,l,r,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,SO(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Qi(e.type,l),o.props=u,h=e.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Bi(c):(c=Ks(n)?iu:gs.current,c=uh(e,c));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&TR(e,o,r,c),rl=!1,f=e.memoizedState,o.state=f,iv(e,r,o,s);var g=e.memoizedState;l!==h||f!==g||qs.current||rl?(typeof m=="function"&&(dE(e,n,m,r),g=e.memoizedState),(u=rl||CR(e,n,u,r,f,g,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return pE(t,e,n,r,i,s)}function pE(t,e,n,r,s,i){YO(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&yR(e,n,!1),va(t,e,i);r=e.stateNode,eY.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=hh(e,t.child,null,i),e.child=hh(e,null,l,i)):Ts(t,e,l,i),e.memoizedState=r.state,s&&yR(e,n,!0),e.child}function JO(t){var e=t.stateNode;e.pendingContext?gR(t,e.pendingContext,e.pendingContext!==e.context):e.context&&gR(t,e.context,!1),i1(t,e.containerInfo)}function jR(t,e,n,r,s){return dh(),ZT(s),e.flags|=256,Ts(t,e,n,r),e.child}var gE={dehydrated:null,treeContext:null,retryLane:0};function yE(t){return{baseLanes:t,cachePool:null,transitions:null}}function XO(t,e,n){var r=e.pendingProps,s=tr.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Fn(tr,s&1),t===null)return cE(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Fw(o,r,0,null),t=Yc(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=yE(n),e.memoizedState=gE,t):f1(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return tY(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=El(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=El(l,i):(i=Yc(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?yE(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=gE,r}return i=t.child,t=i.sibling,r=El(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function f1(t,e){return e=Fw({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Qg(t,e,n,r){return r!==null&&ZT(r),hh(e,t.child,null,n),t=f1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function tY(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=ib(Error(He(422))),Qg(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Fw({mode:"visible",children:r.children},s,0,null),i=Yc(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&hh(e,t.child,null,o),e.child.memoizedState=yE(o),e.memoizedState=gE,i);if(!(e.mode&1))return Qg(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(He(419)),r=ib(i,r,void 0),Qg(t,e,o,r)}if(l=(o&t.childLanes)!==0,zs||l){if(r=zr,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,xa(t,s),co(r,t,s,-1))}return v1(),r=ib(Error(He(421))),Qg(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=mY.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,di=wl(s.nextSibling),pi=e,Yn=!0,ro=null,t!==null&&(Ai[Ri++]=ra,Ai[Ri++]=sa,Ai[Ri++]=ou,ra=t.id,sa=t.overflow,ou=e),e=f1(e,r.children),e.flags|=4096,e)}function DR(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),uE(t.return,e,n)}function ob(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function QO(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Ts(t,e,r.children,n),r=tr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&DR(t,n,e);else if(t.tag===19)DR(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Fn(tr,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&ov(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),ob(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ov(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}ob(e,!0,n,null,i);break;case"together":ob(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function sx(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function va(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),lu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(He(153));if(e.child!==null){for(t=e.child,n=El(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=El(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function nY(t,e,n){switch(e.tag){case 3:JO(e),dh();break;case 5:EO(e);break;case 1:Ks(e.type)&&ev(e);break;case 4:i1(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Fn(rv,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Fn(tr,tr.current&1),e.flags|=128,null):n&e.child.childLanes?XO(t,e,n):(Fn(tr,tr.current&1),t=va(t,e,n),t!==null?t.sibling:null);Fn(tr,tr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return QO(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Fn(tr,tr.current),r)break;return null;case 22:case 23:return e.lanes=0,KO(t,e,n)}return va(t,e,n)}var ZO,xE,eV,tV;ZO=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};xE=function(){};eV=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Bc(Lo.current);var i=null;switch(n){case"input":s=$S(t,s),r=$S(t,r),i=[];break;case"select":s=or({},s,{value:void 0}),r=or({},r,{value:void 0}),i=[];break;case"textarea":s=zS(t,s),r=zS(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Qx)}HS(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Bm.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Bm.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Gn("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};tV=function(t,e,n,r){n!==r&&(e.flags|=4)};function vf(t,e){if(!Yn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function as(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function rY(t,e,n){var r=e.pendingProps;switch(QT(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return as(e),null;case 1:return Ks(e.type)&&Zx(),as(e),null;case 3:return r=e.stateNode,fh(),Hn(qs),Hn(gs),a1(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Jg(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ro!==null&&(TE(ro),ro=null))),xE(t,e),as(e),null;case 5:o1(e);var s=Bc(ep.current);if(n=e.type,t!==null&&e.stateNode!=null)eV(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(He(166));return as(e),null}if(t=Bc(Lo.current),Jg(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[No]=e,r[Qm]=i,t=(e.mode&1)!==0,n){case"dialog":Gn("cancel",r),Gn("close",r);break;case"iframe":case"object":case"embed":Gn("load",r);break;case"video":case"audio":for(s=0;s<Hf.length;s++)Gn(Hf[s],r);break;case"source":Gn("error",r);break;case"img":case"image":case"link":Gn("error",r),Gn("load",r);break;case"details":Gn("toggle",r);break;case"input":zA(r,i),Gn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Gn("invalid",r);break;case"textarea":HA(r,i),Gn("invalid",r)}HS(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Yg(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Yg(r.textContent,l,t),s=["children",""+l]):Bm.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Gn("scroll",r)}switch(n){case"input":Ug(r),GA(r,i,!0);break;case"textarea":Ug(r),WA(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Qx)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=PF(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[No]=e,t[Qm]=r,ZO(t,e,!1,!1),e.stateNode=t;e:{switch(o=WS(n,r),n){case"dialog":Gn("cancel",t),Gn("close",t),s=r;break;case"iframe":case"object":case"embed":Gn("load",t),s=r;break;case"video":case"audio":for(s=0;s<Hf.length;s++)Gn(Hf[s],t);s=r;break;case"source":Gn("error",t),s=r;break;case"img":case"image":case"link":Gn("error",t),Gn("load",t),s=r;break;case"details":Gn("toggle",t),s=r;break;case"input":zA(t,r),s=$S(t,r),Gn("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=or({},r,{value:void 0}),Gn("invalid",t);break;case"textarea":HA(t,r),s=zS(t,r),Gn("invalid",t);break;default:s=r}HS(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?kF(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&AF(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&zm(t,c):typeof c=="number"&&zm(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Bm.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Gn("scroll",t):c!=null&&FT(t,i,c,o))}switch(n){case"input":Ug(t),GA(t,r,!1);break;case"textarea":Ug(t),WA(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Fl(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Gd(t,!!r.multiple,i,!1):r.defaultValue!=null&&Gd(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Qx)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return as(e),null;case 6:if(t&&e.stateNode!=null)tV(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(He(166));if(n=Bc(ep.current),Bc(Lo.current),Jg(e)){if(r=e.stateNode,n=e.memoizedProps,r[No]=e,(i=r.nodeValue!==n)&&(t=pi,t!==null))switch(t.tag){case 3:Yg(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Yg(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[No]=e,e.stateNode=r}return as(e),null;case 13:if(Hn(tr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Yn&&di!==null&&e.mode&1&&!(e.flags&128))vO(),dh(),e.flags|=98560,i=!1;else if(i=Jg(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(He(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(He(317));i[No]=e}else dh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;as(e),i=!1}else ro!==null&&(TE(ro),ro=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||tr.current&1?jr===0&&(jr=3):v1())),e.updateQueue!==null&&(e.flags|=4),as(e),null);case 4:return fh(),xE(t,e),t===null&&Jm(e.stateNode.containerInfo),as(e),null;case 10:return n1(e.type._context),as(e),null;case 17:return Ks(e.type)&&Zx(),as(e),null;case 19:if(Hn(tr),i=e.memoizedState,i===null)return as(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)vf(i,!1);else{if(jr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ov(t),o!==null){for(e.flags|=128,vf(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Fn(tr,tr.current&1|2),e.child}t=t.sibling}i.tail!==null&&yr()>ph&&(e.flags|=128,r=!0,vf(i,!1),e.lanes=4194304)}else{if(!r)if(t=ov(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),vf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Yn)return as(e),null}else 2*yr()-i.renderingStartTime>ph&&n!==1073741824&&(e.flags|=128,r=!0,vf(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=yr(),e.sibling=null,n=tr.current,Fn(tr,r?n&1|2:n&1),e):(as(e),null);case 22:case 23:return x1(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?oi&1073741824&&(as(e),e.subtreeFlags&6&&(e.flags|=8192)):as(e),null;case 24:return null;case 25:return null}throw Error(He(156,e.tag))}function sY(t,e){switch(QT(e),e.tag){case 1:return Ks(e.type)&&Zx(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return fh(),Hn(qs),Hn(gs),a1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return o1(e),null;case 13:if(Hn(tr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(He(340));dh()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Hn(tr),null;case 4:return fh(),null;case 10:return n1(e.type._context),null;case 22:case 23:return x1(),null;case 24:return null;default:return null}}var Zg=!1,hs=!1,iY=typeof WeakSet=="function"?WeakSet:Set,gt=null;function Nd(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ur(t,e,r)}else n.current=null}function vE(t,e,n){try{n()}catch(r){ur(t,e,r)}}var MR=!1;function oY(t,e){if(nE=Yx,t=oO(),JT(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++u===s&&(l=o),f===i&&++d===r&&(c=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(rE={focusedElem:t,selectionRange:n},Yx=!1,gt=e;gt!==null;)if(e=gt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,gt=t;else for(;gt!==null;){e=gt;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,E=g.memoizedState,v=e.stateNode,_=v.getSnapshotBeforeUpdate(e.elementType===e.type?x:Qi(e.type,x),E);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(He(163))}}catch(I){ur(e,e.return,I)}if(t=e.sibling,t!==null){t.return=e.return,gt=t;break}gt=e.return}return g=MR,MR=!1,g}function mm(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&vE(e,n,i)}s=s.next}while(s!==r)}}function Mw(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function wE(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function nV(t){var e=t.alternate;e!==null&&(t.alternate=null,nV(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[No],delete e[Qm],delete e[oE],delete e[BK],delete e[zK])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function rV(t){return t.tag===5||t.tag===3||t.tag===4}function LR(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||rV(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _E(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Qx));else if(r!==4&&(t=t.child,t!==null))for(_E(t,e,n),t=t.sibling;t!==null;)_E(t,e,n),t=t.sibling}function bE(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(bE(t,e,n),t=t.sibling;t!==null;)bE(t,e,n),t=t.sibling}var Wr=null,eo=!1;function Ua(t,e,n){for(n=n.child;n!==null;)sV(t,e,n),n=n.sibling}function sV(t,e,n){if(Mo&&typeof Mo.onCommitFiberUnmount=="function")try{Mo.onCommitFiberUnmount(Iw,n)}catch{}switch(n.tag){case 5:hs||Nd(n,e);case 6:var r=Wr,s=eo;Wr=null,Ua(t,e,n),Wr=r,eo=s,Wr!==null&&(eo?(t=Wr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Wr.removeChild(n.stateNode));break;case 18:Wr!==null&&(eo?(t=Wr,n=n.stateNode,t.nodeType===8?Z_(t.parentNode,n):t.nodeType===1&&Z_(t,n),qm(t)):Z_(Wr,n.stateNode));break;case 4:r=Wr,s=eo,Wr=n.stateNode.containerInfo,eo=!0,Ua(t,e,n),Wr=r,eo=s;break;case 0:case 11:case 14:case 15:if(!hs&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&vE(n,e,o),s=s.next}while(s!==r)}Ua(t,e,n);break;case 1:if(!hs&&(Nd(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ur(n,e,l)}Ua(t,e,n);break;case 21:Ua(t,e,n);break;case 22:n.mode&1?(hs=(r=hs)||n.memoizedState!==null,Ua(t,e,n),hs=r):Ua(t,e,n);break;default:Ua(t,e,n)}}function FR(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new iY),e.forEach(function(r){var s=pY.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Yi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Wr=l.stateNode,eo=!1;break e;case 3:Wr=l.stateNode.containerInfo,eo=!0;break e;case 4:Wr=l.stateNode.containerInfo,eo=!0;break e}l=l.return}if(Wr===null)throw Error(He(160));sV(i,o,s),Wr=null,eo=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){ur(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)iV(e,t),e=e.sibling}function iV(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Yi(e,t),_o(t),r&4){try{mm(3,t,t.return),Mw(3,t)}catch(x){ur(t,t.return,x)}try{mm(5,t,t.return)}catch(x){ur(t,t.return,x)}}break;case 1:Yi(e,t),_o(t),r&512&&n!==null&&Nd(n,n.return);break;case 5:if(Yi(e,t),_o(t),r&512&&n!==null&&Nd(n,n.return),t.flags&32){var s=t.stateNode;try{zm(s,"")}catch(x){ur(t,t.return,x)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&IF(s,i),WS(l,o);var u=WS(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?kF(s,h):d==="dangerouslySetInnerHTML"?AF(s,h):d==="children"?zm(s,h):FT(s,d,h,u)}switch(l){case"input":US(s,i);break;case"textarea":NF(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Gd(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?Gd(s,!!i.multiple,i.defaultValue,!0):Gd(s,!!i.multiple,i.multiple?[]:"",!1))}s[Qm]=i}catch(x){ur(t,t.return,x)}}break;case 6:if(Yi(e,t),_o(t),r&4){if(t.stateNode===null)throw Error(He(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(x){ur(t,t.return,x)}}break;case 3:if(Yi(e,t),_o(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{qm(e.containerInfo)}catch(x){ur(t,t.return,x)}break;case 4:Yi(e,t),_o(t);break;case 13:Yi(e,t),_o(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(g1=yr())),r&4&&FR(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(hs=(u=hs)||d,Yi(e,t),hs=u):Yi(e,t),_o(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(gt=t,d=t.child;d!==null;){for(h=gt=d;gt!==null;){switch(f=gt,m=f.child,f.tag){case 0:case 11:case 14:case 15:mm(4,f,f.return);break;case 1:Nd(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(x){ur(r,n,x)}}break;case 5:Nd(f,f.return);break;case 22:if(f.memoizedState!==null){VR(h);continue}}m!==null?(m.return=f,gt=m):VR(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=RF("display",o))}catch(x){ur(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){ur(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Yi(e,t),_o(t),r&4&&FR(t);break;case 21:break;default:Yi(e,t),_o(t)}}function _o(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(rV(n)){var r=n;break e}n=n.return}throw Error(He(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(zm(s,""),r.flags&=-33);var i=LR(t);bE(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=LR(t);_E(t,l,o);break;default:throw Error(He(161))}}catch(c){ur(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function aY(t,e,n){gt=t,oV(t)}function oV(t,e,n){for(var r=(t.mode&1)!==0;gt!==null;){var s=gt,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Zg;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||hs;l=Zg;var u=hs;if(Zg=o,(hs=c)&&!u)for(gt=s;gt!==null;)o=gt,c=o.child,o.tag===22&&o.memoizedState!==null?$R(s):c!==null?(c.return=o,gt=c):$R(s);for(;i!==null;)gt=i,oV(i),i=i.sibling;gt=s,Zg=l,hs=u}OR(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,gt=i):OR(t)}}function OR(t){for(;gt!==null;){var e=gt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:hs||Mw(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!hs)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Qi(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&bR(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}bR(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&qm(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(He(163))}hs||e.flags&512&&wE(e)}catch(f){ur(e,e.return,f)}}if(e===t){gt=null;break}if(n=e.sibling,n!==null){n.return=e.return,gt=n;break}gt=e.return}}function VR(t){for(;gt!==null;){var e=gt;if(e===t){gt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,gt=n;break}gt=e.return}}function $R(t){for(;gt!==null;){var e=gt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Mw(4,e)}catch(c){ur(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){ur(e,s,c)}}var i=e.return;try{wE(e)}catch(c){ur(e,i,c)}break;case 5:var o=e.return;try{wE(e)}catch(c){ur(e,o,c)}}}catch(c){ur(e,e.return,c)}if(e===t){gt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,gt=l;break}gt=e.return}}var lY=Math.ceil,cv=ka.ReactCurrentDispatcher,m1=ka.ReactCurrentOwner,Fi=ka.ReactCurrentBatchConfig,gn=0,zr=null,Er=null,Qr=0,oi=0,Pd=Zl(0),jr=0,sp=null,lu=0,Lw=0,p1=0,pm=null,Us=null,g1=0,ph=1/0,ea=null,uv=!1,SE=null,bl=null,ey=!1,ml=null,dv=0,gm=0,EE=null,ix=-1,ox=0;function As(){return gn&6?yr():ix!==-1?ix:ix=yr()}function Sl(t){return t.mode&1?gn&2&&Qr!==0?Qr&-Qr:HK.transition!==null?(ox===0&&(ox=GF()),ox):(t=In,t!==0||(t=window.event,t=t===void 0?16:XF(t.type)),t):1}function co(t,e,n,r){if(50<gm)throw gm=0,EE=null,Error(He(185));$p(t,n,r),(!(gn&2)||t!==zr)&&(t===zr&&(!(gn&2)&&(Lw|=n),jr===4&&ol(t,Qr)),Ys(t,r),n===1&&gn===0&&!(e.mode&1)&&(ph=yr()+500,kw&&ec()))}function Ys(t,e){var n=t.callbackNode;Hq(t,e);var r=Kx(t,t===zr?Qr:0);if(r===0)n!==null&&YA(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&YA(n),e===1)t.tag===0?GK(UR.bind(null,t)):gO(UR.bind(null,t)),$K(function(){!(gn&6)&&ec()}),n=null;else{switch(HF(r)){case 1:n=BT;break;case 4:n=BF;break;case 16:n=qx;break;case 536870912:n=zF;break;default:n=qx}n=mV(n,aV.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function aV(t,e){if(ix=-1,ox=0,gn&6)throw Error(He(327));var n=t.callbackNode;if(Yd()&&t.callbackNode!==n)return null;var r=Kx(t,t===zr?Qr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=hv(t,r);else{e=r;var s=gn;gn|=2;var i=cV();(zr!==t||Qr!==e)&&(ea=null,ph=yr()+500,Kc(t,e));do try{dY();break}catch(l){lV(t,l)}while(1);t1(),cv.current=i,gn=s,Er!==null?e=0:(zr=null,Qr=0,e=jr)}if(e!==0){if(e===2&&(s=XS(t),s!==0&&(r=s,e=CE(t,s))),e===1)throw n=sp,Kc(t,0),ol(t,r),Ys(t,yr()),n;if(e===6)ol(t,r);else{if(s=t.current.alternate,!(r&30)&&!cY(s)&&(e=hv(t,r),e===2&&(i=XS(t),i!==0&&(r=i,e=CE(t,i))),e===1))throw n=sp,Kc(t,0),ol(t,r),Ys(t,yr()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(He(345));case 2:bc(t,Us,ea);break;case 3:if(ol(t,r),(r&130023424)===r&&(e=g1+500-yr(),10<e)){if(Kx(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){As(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=iE(bc.bind(null,t,Us,ea),e);break}bc(t,Us,ea);break;case 4:if(ol(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-lo(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=yr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*lY(r/1960))-r,10<r){t.timeoutHandle=iE(bc.bind(null,t,Us,ea),r);break}bc(t,Us,ea);break;case 5:bc(t,Us,ea);break;default:throw Error(He(329))}}}return Ys(t,yr()),t.callbackNode===n?aV.bind(null,t):null}function CE(t,e){var n=pm;return t.current.memoizedState.isDehydrated&&(Kc(t,e).flags|=256),t=hv(t,e),t!==2&&(e=Us,Us=n,e!==null&&TE(e)),t}function TE(t){Us===null?Us=t:Us.push.apply(Us,t)}function cY(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!ho(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ol(t,e){for(e&=~p1,e&=~Lw,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-lo(e),r=1<<n;t[n]=-1,e&=~r}}function UR(t){if(gn&6)throw Error(He(327));Yd();var e=Kx(t,0);if(!(e&1))return Ys(t,yr()),null;var n=hv(t,e);if(t.tag!==0&&n===2){var r=XS(t);r!==0&&(e=r,n=CE(t,r))}if(n===1)throw n=sp,Kc(t,0),ol(t,e),Ys(t,yr()),n;if(n===6)throw Error(He(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,bc(t,Us,ea),Ys(t,yr()),null}function y1(t,e){var n=gn;gn|=1;try{return t(e)}finally{gn=n,gn===0&&(ph=yr()+500,kw&&ec())}}function cu(t){ml!==null&&ml.tag===0&&!(gn&6)&&Yd();var e=gn;gn|=1;var n=Fi.transition,r=In;try{if(Fi.transition=null,In=1,t)return t()}finally{In=r,Fi.transition=n,gn=e,!(gn&6)&&ec()}}function x1(){oi=Pd.current,Hn(Pd)}function Kc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,VK(n)),Er!==null)for(n=Er.return;n!==null;){var r=n;switch(QT(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Zx();break;case 3:fh(),Hn(qs),Hn(gs),a1();break;case 5:o1(r);break;case 4:fh();break;case 13:Hn(tr);break;case 19:Hn(tr);break;case 10:n1(r.type._context);break;case 22:case 23:x1()}n=n.return}if(zr=t,Er=t=El(t.current,null),Qr=oi=e,jr=0,sp=null,p1=Lw=lu=0,Us=pm=null,Uc!==null){for(e=0;e<Uc.length;e++)if(n=Uc[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Uc=null}return t}function lV(t,e){do{var n=Er;try{if(t1(),nx.current=lv,av){for(var r=sr.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}av=!1}if(au=0,Vr=kr=sr=null,fm=!1,tp=0,m1.current=null,n===null||n.return===null){jr=1,sp=e,Er=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=Qr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=NR(o);if(m!==null){m.flags&=-257,PR(m,o,l,i,e),m.mode&1&&IR(i,u,e),e=m,c=u;var g=e.updateQueue;if(g===null){var x=new Set;x.add(c),e.updateQueue=x}else g.add(c);break e}else{if(!(e&1)){IR(i,u,e),v1();break e}c=Error(He(426))}}else if(Yn&&l.mode&1){var E=NR(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),PR(E,o,l,i,e),ZT(mh(c,l));break e}}i=c=mh(c,l),jr!==4&&(jr=2),pm===null?pm=[i]:pm.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=HO(i,c,e);_R(i,v);break e;case 1:l=c;var _=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(bl===null||!bl.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var I=WO(i,l,e);_R(i,I);break e}}i=i.return}while(i!==null)}dV(n)}catch(M){e=M,Er===n&&n!==null&&(Er=n=n.return);continue}break}while(1)}function cV(){var t=cv.current;return cv.current=lv,t===null?lv:t}function v1(){(jr===0||jr===3||jr===2)&&(jr=4),zr===null||!(lu&268435455)&&!(Lw&268435455)||ol(zr,Qr)}function hv(t,e){var n=gn;gn|=2;var r=cV();(zr!==t||Qr!==e)&&(ea=null,Kc(t,e));do try{uY();break}catch(s){lV(t,s)}while(1);if(t1(),gn=n,cv.current=r,Er!==null)throw Error(He(261));return zr=null,Qr=0,jr}function uY(){for(;Er!==null;)uV(Er)}function dY(){for(;Er!==null&&!Lq();)uV(Er)}function uV(t){var e=fV(t.alternate,t,oi);t.memoizedProps=t.pendingProps,e===null?dV(t):Er=e,m1.current=null}function dV(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=sY(n,e),n!==null){n.flags&=32767,Er=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{jr=6,Er=null;return}}else if(n=rY(n,e,oi),n!==null){Er=n;return}if(e=e.sibling,e!==null){Er=e;return}Er=e=t}while(e!==null);jr===0&&(jr=5)}function bc(t,e,n){var r=In,s=Fi.transition;try{Fi.transition=null,In=1,hY(t,e,n,r)}finally{Fi.transition=s,In=r}return null}function hY(t,e,n,r){do Yd();while(ml!==null);if(gn&6)throw Error(He(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(He(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Wq(t,i),t===zr&&(Er=zr=null,Qr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ey||(ey=!0,mV(qx,function(){return Yd(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Fi.transition,Fi.transition=null;var o=In;In=1;var l=gn;gn|=4,m1.current=null,oY(t,n),iV(n,t),kK(rE),Yx=!!nE,rE=nE=null,t.current=n,aY(n),Fq(),gn=l,In=o,Fi.transition=i}else t.current=n;if(ey&&(ey=!1,ml=t,dv=s),i=t.pendingLanes,i===0&&(bl=null),$q(n.stateNode),Ys(t,yr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(uv)throw uv=!1,t=SE,SE=null,t;return dv&1&&t.tag!==0&&Yd(),i=t.pendingLanes,i&1?t===EE?gm++:(gm=0,EE=t):gm=0,ec(),null}function Yd(){if(ml!==null){var t=HF(dv),e=Fi.transition,n=In;try{if(Fi.transition=null,In=16>t?16:t,ml===null)var r=!1;else{if(t=ml,ml=null,dv=0,gn&6)throw Error(He(331));var s=gn;for(gn|=4,gt=t.current;gt!==null;){var i=gt,o=i.child;if(gt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(gt=u;gt!==null;){var d=gt;switch(d.tag){case 0:case 11:case 15:mm(8,d,i)}var h=d.child;if(h!==null)h.return=d,gt=h;else for(;gt!==null;){d=gt;var f=d.sibling,m=d.return;if(nV(d),d===u){gt=null;break}if(f!==null){f.return=m,gt=f;break}gt=m}}}var g=i.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var E=x.sibling;x.sibling=null,x=E}while(x!==null)}}gt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,gt=o;else e:for(;gt!==null;){if(i=gt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:mm(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,gt=v;break e}gt=i.return}}var _=t.current;for(gt=_;gt!==null;){o=gt;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,gt=S;else e:for(o=_;gt!==null;){if(l=gt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Mw(9,l)}}catch(M){ur(l,l.return,M)}if(l===o){gt=null;break e}var I=l.sibling;if(I!==null){I.return=l.return,gt=I;break e}gt=l.return}}if(gn=s,ec(),Mo&&typeof Mo.onPostCommitFiberRoot=="function")try{Mo.onPostCommitFiberRoot(Iw,t)}catch{}r=!0}return r}finally{In=n,Fi.transition=e}}return!1}function BR(t,e,n){e=mh(n,e),e=HO(t,e,1),t=_l(t,e,1),e=As(),t!==null&&($p(t,1,e),Ys(t,e))}function ur(t,e,n){if(t.tag===3)BR(t,t,n);else for(;e!==null;){if(e.tag===3){BR(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(bl===null||!bl.has(r))){t=mh(n,t),t=WO(e,t,1),e=_l(e,t,1),t=As(),e!==null&&($p(e,1,t),Ys(e,t));break}}e=e.return}}function fY(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=As(),t.pingedLanes|=t.suspendedLanes&n,zr===t&&(Qr&n)===n&&(jr===4||jr===3&&(Qr&130023424)===Qr&&500>yr()-g1?Kc(t,0):p1|=n),Ys(t,e)}function hV(t,e){e===0&&(t.mode&1?(e=Gg,Gg<<=1,!(Gg&130023424)&&(Gg=4194304)):e=1);var n=As();t=xa(t,e),t!==null&&($p(t,e,n),Ys(t,n))}function mY(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),hV(t,n)}function pY(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(He(314))}r!==null&&r.delete(e),hV(t,n)}var fV;fV=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||qs.current)zs=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return zs=!1,nY(t,e,n);zs=!!(t.flags&131072)}else zs=!1,Yn&&e.flags&1048576&&yO(e,nv,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;sx(t,e),t=e.pendingProps;var s=uh(e,gs.current);Kd(e,n),s=c1(null,e,r,t,s,n);var i=u1();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ks(r)?(i=!0,ev(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s1(e),s.updater=Dw,e.stateNode=s,s._reactInternals=e,hE(e,r,t,n),e=pE(null,e,r,!0,i,n)):(e.tag=0,Yn&&i&&XT(e),Ts(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(sx(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=yY(r),t=Qi(r,t),s){case 0:e=mE(null,e,r,t,n);break e;case 1:e=kR(null,e,r,t,n);break e;case 11:e=AR(null,e,r,t,n);break e;case 14:e=RR(null,e,r,Qi(r.type,t),n);break e}throw Error(He(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Qi(r,s),mE(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Qi(r,s),kR(t,e,r,s,n);case 3:e:{if(JO(e),t===null)throw Error(He(387));r=e.pendingProps,i=e.memoizedState,s=i.element,SO(t,e),iv(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=mh(Error(He(423)),e),e=jR(t,e,r,n,s);break e}else if(r!==s){s=mh(Error(He(424)),e),e=jR(t,e,r,n,s);break e}else for(di=wl(e.stateNode.containerInfo.firstChild),pi=e,Yn=!0,ro=null,n=_O(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(dh(),r===s){e=va(t,e,n);break e}Ts(t,e,r,n)}e=e.child}return e;case 5:return EO(e),t===null&&cE(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,sE(r,s)?o=null:i!==null&&sE(r,i)&&(e.flags|=32),YO(t,e),Ts(t,e,o,n),e.child;case 6:return t===null&&cE(e),null;case 13:return XO(t,e,n);case 4:return i1(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=hh(e,null,r,n):Ts(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Qi(r,s),AR(t,e,r,s,n);case 7:return Ts(t,e,e.pendingProps,n),e.child;case 8:return Ts(t,e,e.pendingProps.children,n),e.child;case 12:return Ts(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Fn(rv,r._currentValue),r._currentValue=o,i!==null)if(ho(i.value,o)){if(i.children===s.children&&!qs.current){e=va(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=ca(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),uE(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(He(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),uE(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ts(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Kd(e,n),s=Bi(s),r=r(s),e.flags|=1,Ts(t,e,r,n),e.child;case 14:return r=e.type,s=Qi(r,e.pendingProps),s=Qi(r.type,s),RR(t,e,r,s,n);case 15:return qO(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Qi(r,s),sx(t,e),e.tag=1,Ks(r)?(t=!0,ev(e)):t=!1,Kd(e,n),GO(e,r,s),hE(e,r,s,n),pE(null,e,r,!0,t,n);case 19:return QO(t,e,n);case 22:return KO(t,e,n)}throw Error(He(156,e.tag))};function mV(t,e){return UF(t,e)}function gY(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Di(t,e,n,r){return new gY(t,e,n,r)}function w1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function yY(t){if(typeof t=="function")return w1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===VT)return 11;if(t===$T)return 14}return 2}function El(t,e){var n=t.alternate;return n===null?(n=Di(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ax(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")w1(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case vd:return Yc(n.children,s,i,e);case OT:o=8,s|=8;break;case LS:return t=Di(12,n,e,s|2),t.elementType=LS,t.lanes=i,t;case FS:return t=Di(13,n,e,s),t.elementType=FS,t.lanes=i,t;case OS:return t=Di(19,n,e,s),t.elementType=OS,t.lanes=i,t;case EF:return Fw(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case bF:o=10;break e;case SF:o=9;break e;case VT:o=11;break e;case $T:o=14;break e;case nl:o=16,r=null;break e}throw Error(He(130,t==null?t:typeof t,""))}return e=Di(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Yc(t,e,n,r){return t=Di(7,t,r,e),t.lanes=n,t}function Fw(t,e,n,r){return t=Di(22,t,r,e),t.elementType=EF,t.lanes=n,t.stateNode={isHidden:!1},t}function ab(t,e,n){return t=Di(6,t,null,e),t.lanes=n,t}function lb(t,e,n){return e=Di(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function xY(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=B_(0),this.expirationTimes=B_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=B_(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function _1(t,e,n,r,s,i,o,l,c){return t=new xY(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Di(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},s1(i),t}function vY(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xd,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function pV(t){if(!t)return Ol;t=t._reactInternals;e:{if(Iu(t)!==t||t.tag!==1)throw Error(He(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ks(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(He(171))}if(t.tag===1){var n=t.type;if(Ks(n))return pO(t,n,e)}return e}function gV(t,e,n,r,s,i,o,l,c){return t=_1(n,r,!0,t,s,i,o,l,c),t.context=pV(null),n=t.current,r=As(),s=Sl(n),i=ca(r,s),i.callback=e??null,_l(n,i,s),t.current.lanes=s,$p(t,s,r),Ys(t,r),t}function Ow(t,e,n,r){var s=e.current,i=As(),o=Sl(s);return n=pV(n),e.context===null?e.context=n:e.pendingContext=n,e=ca(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=_l(s,e,o),t!==null&&(co(t,s,o,i),tx(t,s,o)),o}function fv(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function zR(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function b1(t,e){zR(t,e),(t=t.alternate)&&zR(t,e)}function wY(){return null}var yV=typeof reportError=="function"?reportError:function(t){console.error(t)};function S1(t){this._internalRoot=t}Vw.prototype.render=S1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(He(409));Ow(t,e,null,null)};Vw.prototype.unmount=S1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;cu(function(){Ow(null,t,null,null)}),e[ya]=null}};function Vw(t){this._internalRoot=t}Vw.prototype.unstable_scheduleHydration=function(t){if(t){var e=KF();t={blockedOn:null,target:t,priority:e};for(var n=0;n<il.length&&e!==0&&e<il[n].priority;n++);il.splice(n,0,t),n===0&&JF(t)}};function E1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function $w(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function GR(){}function _Y(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=fv(o);i.call(u)}}var o=gV(e,r,t,0,null,!1,!1,"",GR);return t._reactRootContainer=o,t[ya]=o.current,Jm(t.nodeType===8?t.parentNode:t),cu(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=fv(c);l.call(u)}}var c=_1(t,0,!1,null,null,!1,!1,"",GR);return t._reactRootContainer=c,t[ya]=c.current,Jm(t.nodeType===8?t.parentNode:t),cu(function(){Ow(e,c,n,r)}),c}function Uw(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=fv(o);l.call(c)}}Ow(e,o,t,s)}else o=_Y(n,e,t,s,r);return fv(o)}WF=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Gf(e.pendingLanes);n!==0&&(zT(e,n|1),Ys(e,yr()),!(gn&6)&&(ph=yr()+500,ec()))}break;case 13:cu(function(){var r=xa(t,1);if(r!==null){var s=As();co(r,t,1,s)}}),b1(t,1)}};GT=function(t){if(t.tag===13){var e=xa(t,134217728);if(e!==null){var n=As();co(e,t,134217728,n)}b1(t,134217728)}};qF=function(t){if(t.tag===13){var e=Sl(t),n=xa(t,e);if(n!==null){var r=As();co(n,t,e,r)}b1(t,e)}};KF=function(){return In};YF=function(t,e){var n=In;try{return In=t,e()}finally{In=n}};KS=function(t,e,n){switch(e){case"input":if(US(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Rw(r);if(!s)throw Error(He(90));TF(r),US(r,s)}}}break;case"textarea":NF(t,n);break;case"select":e=n.value,e!=null&&Gd(t,!!n.multiple,e,!1)}};MF=y1;LF=cu;var bY={usingClientEntryPoint:!1,Events:[Bp,Sd,Rw,jF,DF,y1]},wf={findFiberByHostInstance:$c,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},SY={bundleType:wf.bundleType,version:wf.version,rendererPackageName:wf.rendererPackageName,rendererConfig:wf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ka.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=VF(t),t===null?null:t.stateNode},findFiberByHostInstance:wf.findFiberByHostInstance||wY,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ty=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ty.isDisabled&&ty.supportsFiber)try{Iw=ty.inject(SY),Mo=ty}catch{}}wi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bY;wi.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!E1(e))throw Error(He(200));return vY(t,e,null,n)};wi.createRoot=function(t,e){if(!E1(t))throw Error(He(299));var n=!1,r="",s=yV;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=_1(t,1,!1,null,null,n,!1,r,s),t[ya]=e.current,Jm(t.nodeType===8?t.parentNode:t),new S1(e)};wi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(He(188)):(t=Object.keys(t).join(","),Error(He(268,t)));return t=VF(e),t=t===null?null:t.stateNode,t};wi.flushSync=function(t){return cu(t)};wi.hydrate=function(t,e,n){if(!$w(e))throw Error(He(200));return Uw(null,t,e,!0,n)};wi.hydrateRoot=function(t,e,n){if(!E1(t))throw Error(He(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=yV;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=gV(e,null,t,1,n??null,s,!1,i,o),t[ya]=e.current,Jm(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Vw(e)};wi.render=function(t,e,n){if(!$w(e))throw Error(He(200));return Uw(null,t,e,!1,n)};wi.unmountComponentAtNode=function(t){if(!$w(t))throw Error(He(40));return t._reactRootContainer?(cu(function(){Uw(null,null,t,!1,function(){t._reactRootContainer=null,t[ya]=null})}),!0):!1};wi.unstable_batchedUpdates=y1;wi.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!$w(n))throw Error(He(200));if(t==null||t._reactInternals===void 0)throw Error(He(38));return Uw(t,e,n,!1,r)};wi.version="18.3.1-next-f1338f8080-20240426";function xV(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xV)}catch(t){console.error(t)}}xV(),xF.exports=wi;var ja=xF.exports;const C1=Ew(ja),EY=oF({__proto__:null,default:C1},[ja]);var HR=ja;DS.createRoot=HR.createRoot,DS.hydrateRoot=HR.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qn(){return qn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qn.apply(this,arguments)}var pr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(pr||(pr={}));const WR="popstate";function CY(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return ip("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:uu(s)}return IY(e,n,null,t)}function rn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function gh(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function TY(){return Math.random().toString(36).substr(2,8)}function qR(t,e){return{usr:t.state,key:t.key,idx:e}}function ip(t,e,n,r){return n===void 0&&(n=null),qn({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Da(e):e,{state:n,key:e&&e.key||r||TY()})}function uu(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Da(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function IY(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=pr.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(qn({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){l=pr.Pop;let E=d(),v=E==null?null:E-u;u=E,c&&c({action:l,location:x.location,delta:v})}function f(E,v){l=pr.Push;let _=ip(x.location,E,v);n&&n(_,E),u=d()+1;let S=qR(_,u),I=x.createHref(_);try{o.pushState(S,"",I)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;s.location.assign(I)}i&&c&&c({action:l,location:x.location,delta:1})}function m(E,v){l=pr.Replace;let _=ip(x.location,E,v);n&&n(_,E),u=d();let S=qR(_,u),I=x.createHref(_);o.replaceState(S,"",I),i&&c&&c({action:l,location:x.location,delta:0})}function g(E){let v=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof E=="string"?E:uu(E);return _=_.replace(/ $/,"%20"),rn(v,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,v)}let x={get action(){return l},get location(){return t(s,o)},listen(E){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(WR,h),c=E,()=>{s.removeEventListener(WR,h),c=null}},createHref(E){return e(s,E)},createURL:g,encodeLocation(E){let v=g(E);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:m,go(E){return o.go(E)}};return x}var Cn;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Cn||(Cn={}));const NY=new Set(["lazy","caseSensitive","path","id","index","children"]);function PY(t){return t.index===!0}function mv(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,i)=>{let o=[...n,String(i)],l=typeof s.id=="string"?s.id:o.join("-");if(rn(s.index!==!0||!s.children,"Cannot specify children on an index route"),rn(!r[l],'Found a route id collision on id "'+l+`".  Route id's must be globally unique within Data Router usages`),PY(s)){let c=qn({},s,e(s),{id:l});return r[l]=c,c}else{let c=qn({},s,e(s),{id:l,children:void 0});return r[l]=c,s.children&&(c.children=mv(s.children,e,o,r)),c}})}function Rc(t,e,n){return n===void 0&&(n="/"),lx(t,e,n,!1)}function lx(t,e,n,r){let s=typeof e=="string"?Da(e):e,i=zh(s.pathname||"/",n);if(i==null)return null;let o=vV(t);RY(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=BY(i);l=$Y(o[c],u,r)}return l}function AY(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function vV(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(rn(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=ua([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(rn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),vV(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:OY(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of wV(i.path))s(i,o,c)}),e}function wV(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=wV(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function RY(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:VY(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const kY=/^:[\w-]+$/,jY=3,DY=2,MY=1,LY=10,FY=-2,KR=t=>t==="*";function OY(t,e){let n=t.split("/"),r=n.length;return n.some(KR)&&(r+=FY),e&&(r+=DY),n.filter(s=>!KR(s)).reduce((s,i)=>s+(kY.test(i)?jY:i===""?MY:LY),r)}function VY(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function $Y(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=YR({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h&&u&&n&&!r[r.length-1].route.index&&(h=YR({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:ua([i,h.pathname]),pathnameBase:HY(ua([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=ua([i,h.pathnameBase]))}return o}function YR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=UY(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,h)=>{let{paramName:f,isOptional:m}=d;if(f==="*"){let x=l[h]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const g=l[h];return m&&!g?u[f]=void 0:u[f]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function UY(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),gh(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function BY(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return gh(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function zh(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function zY(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Da(t):t;return{pathname:n?n.startsWith("/")?n:GY(n,e):e,search:WY(r),hash:qY(s)}}function GY(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function cb(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function _V(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Bw(t,e){let n=_V(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function zw(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Da(t):(s=qn({},t),rn(!s.pathname||!s.pathname.includes("?"),cb("?","pathname","search",s)),rn(!s.pathname||!s.pathname.includes("#"),cb("#","pathname","hash",s)),rn(!s.search||!s.search.includes("#"),cb("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let h=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}l=h>=0?e[h]:"/"}let c=zY(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const ua=t=>t.join("/").replace(/\/\/+/g,"/"),HY=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),WY=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,qY=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class pv{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function op(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const bV=["post","put","patch","delete"],KY=new Set(bV),YY=["get",...bV],JY=new Set(YY),XY=new Set([301,302,303,307,308]),QY=new Set([307,308]),ub={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},ZY={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},_f={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},T1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eJ=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),SV="remix-router-transitions";function tJ(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;rn(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let q=t.detectErrorBoundary;s=te=>({hasErrorBoundary:q(te)})}else s=eJ;let i={},o=mv(t.routes,s,void 0,i),l,c=t.basename||"/",u=t.dataStrategy||iJ,d=t.patchRoutesOnNavigation,h=qn({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,m=new Set,g=null,x=null,E=null,v=t.hydrationData!=null,_=Rc(o,t.history.location,c),S=!1,I=null;if(_==null&&!d){let q=$s(404,{pathname:t.history.location.pathname}),{matches:te,route:le}=ok(o);_=te,I={[le.id]:q}}_&&!t.hydrationData&&Un(_,o,t.history.location.pathname).active&&(_=null);let M;if(_)if(_.some(q=>q.route.lazy))M=!1;else if(!_.some(q=>q.route.loader))M=!0;else if(h.v7_partialHydration){let q=t.hydrationData?t.hydrationData.loaderData:null,te=t.hydrationData?t.hydrationData.errors:null;if(te){let le=_.findIndex(Ie=>te[Ie.route.id]!==void 0);M=_.slice(0,le+1).every(Ie=>!NE(Ie.route,q,te))}else M=_.every(le=>!NE(le.route,q,te))}else M=t.hydrationData!=null;else if(M=!1,_=[],h.v7_partialHydration){let q=Un(null,o,t.history.location.pathname);q.active&&q.matches&&(S=!0,_=q.matches)}let j,C={historyAction:t.history.action,location:t.history.location,matches:_,initialized:M,navigation:ub,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||I,fetchers:new Map,blockers:new Map},T=pr.Pop,P=!1,A,D=!1,R=new Map,k=null,U=!1,B=!1,K=[],ee=new Set,H=new Map,X=0,O=-1,z=new Map,Y=new Set,F=new Map,ye=new Map,Se=new Set,De=new Map,xe=new Map,Me;function Ye(){if(f=t.history.listen(q=>{let{action:te,location:le,delta:Ie}=q;if(Me){Me(),Me=void 0;return}gh(xe.size===0||Ie!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Oe=Ht({currentLocation:C.location,nextLocation:le,historyAction:te});if(Oe&&Ie!=null){let ht=new Promise(dt=>{Me=dt});t.history.go(Ie*-1),Yt(Oe,{state:"blocked",location:le,proceed(){Yt(Oe,{state:"proceeding",proceed:void 0,reset:void 0,location:le}),ht.then(()=>t.history.go(Ie))},reset(){let dt=new Map(C.blockers);dt.set(Oe,_f),We({blockers:dt})}});return}return Je(te,le)}),n){vJ(e,R);let q=()=>wJ(e,R);e.addEventListener("pagehide",q),k=()=>e.removeEventListener("pagehide",q)}return C.initialized||Je(pr.Pop,C.location,{initialHydration:!0}),j}function qe(){f&&f(),k&&k(),m.clear(),A&&A.abort(),C.fetchers.forEach((q,te)=>Ve(te)),C.blockers.forEach((q,te)=>Pe(te))}function et(q){return m.add(q),()=>m.delete(q)}function We(q,te){te===void 0&&(te={}),C=qn({},C,q);let le=[],Ie=[];h.v7_fetcherPersist&&C.fetchers.forEach((Oe,ht)=>{Oe.state==="idle"&&(Se.has(ht)?Ie.push(ht):le.push(ht))}),Se.forEach(Oe=>{!C.fetchers.has(Oe)&&!H.has(Oe)&&Ie.push(Oe)}),[...m].forEach(Oe=>Oe(C,{deletedFetchers:Ie,viewTransitionOpts:te.viewTransitionOpts,flushSync:te.flushSync===!0})),h.v7_fetcherPersist?(le.forEach(Oe=>C.fetchers.delete(Oe)),Ie.forEach(Oe=>Ve(Oe))):Ie.forEach(Oe=>Se.delete(Oe))}function mt(q,te,le){var Ie,Oe;let{flushSync:ht}=le===void 0?{}:le,dt=C.actionData!=null&&C.navigation.formMethod!=null&&to(C.navigation.formMethod)&&C.navigation.state==="loading"&&((Ie=q.state)==null?void 0:Ie._isRedirect)!==!0,W;te.actionData?Object.keys(te.actionData).length>0?W=te.actionData:W=null:dt?W=C.actionData:W=null;let J=te.loaderData?sk(C.loaderData,te.loaderData,te.matches||[],te.errors):C.loaderData,se=C.blockers;se.size>0&&(se=new Map(se),se.forEach((we,ke)=>se.set(ke,_f)));let G=P===!0||C.navigation.formMethod!=null&&to(C.navigation.formMethod)&&((Oe=q.state)==null?void 0:Oe._isRedirect)!==!0;l&&(o=l,l=void 0),U||T===pr.Pop||(T===pr.Push?t.history.push(q,q.state):T===pr.Replace&&t.history.replace(q,q.state));let oe;if(T===pr.Pop){let we=R.get(C.location.pathname);we&&we.has(q.pathname)?oe={currentLocation:C.location,nextLocation:q}:R.has(q.pathname)&&(oe={currentLocation:q,nextLocation:C.location})}else if(D){let we=R.get(C.location.pathname);we?we.add(q.pathname):(we=new Set([q.pathname]),R.set(C.location.pathname,we)),oe={currentLocation:C.location,nextLocation:q}}We(qn({},te,{actionData:W,loaderData:J,historyAction:T,location:q,initialized:!0,navigation:ub,revalidation:"idle",restoreScrollPosition:xr(q,te.matches||C.matches),preventScrollReset:G,blockers:se}),{viewTransitionOpts:oe,flushSync:ht===!0}),T=pr.Pop,P=!1,D=!1,U=!1,B=!1,K=[]}async function Le(q,te){if(typeof q=="number"){t.history.go(q);return}let le=IE(C.location,C.matches,c,h.v7_prependBasename,q,h.v7_relativeSplatPath,te==null?void 0:te.fromRouteId,te==null?void 0:te.relative),{path:Ie,submission:Oe,error:ht}=JR(h.v7_normalizeFormMethod,!1,le,te),dt=C.location,W=ip(C.location,Ie,te&&te.state);W=qn({},W,t.history.encodeLocation(W));let J=te&&te.replace!=null?te.replace:void 0,se=pr.Push;J===!0?se=pr.Replace:J===!1||Oe!=null&&to(Oe.formMethod)&&Oe.formAction===C.location.pathname+C.location.search&&(se=pr.Replace);let G=te&&"preventScrollReset"in te?te.preventScrollReset===!0:void 0,oe=(te&&te.flushSync)===!0,we=Ht({currentLocation:dt,nextLocation:W,historyAction:se});if(we){Yt(we,{state:"blocked",location:W,proceed(){Yt(we,{state:"proceeding",proceed:void 0,reset:void 0,location:W}),Le(q,te)},reset(){let ke=new Map(C.blockers);ke.set(we,_f),We({blockers:ke})}});return}return await Je(se,W,{submission:Oe,pendingError:ht,preventScrollReset:G,replace:te&&te.replace,enableViewTransition:te&&te.viewTransition,flushSync:oe})}function ve(){if(de(),We({revalidation:"loading"}),C.navigation.state!=="submitting"){if(C.navigation.state==="idle"){Je(C.historyAction,C.location,{startUninterruptedRevalidation:!0});return}Je(T||C.historyAction,C.navigation.location,{overrideNavigation:C.navigation,enableViewTransition:D===!0})}}async function Je(q,te,le){A&&A.abort(),A=null,T=q,U=(le&&le.startUninterruptedRevalidation)===!0,mn(C.location,C.matches),P=(le&&le.preventScrollReset)===!0,D=(le&&le.enableViewTransition)===!0;let Ie=l||o,Oe=le&&le.overrideNavigation,ht=le!=null&&le.initialHydration&&C.matches&&C.matches.length>0&&!S?C.matches:Rc(Ie,te,c),dt=(le&&le.flushSync)===!0;if(ht&&C.initialized&&!B&&dJ(C.location,te)&&!(le&&le.submission&&to(le.submission.formMethod))){mt(te,{matches:ht},{flushSync:dt});return}let W=Un(ht,Ie,te.pathname);if(W.active&&W.matches&&(ht=W.matches),!ht){let{error:Ue,notFoundMatches:_e,route:Q}=Tt(te.pathname);mt(te,{matches:_e,loaderData:{},errors:{[Q.id]:Ue}},{flushSync:dt});return}A=new AbortController;let J=Wu(t.history,te,A.signal,le&&le.submission),se;if(le&&le.pendingError)se=[kc(ht).route.id,{type:Cn.error,error:le.pendingError}];else if(le&&le.submission&&to(le.submission.formMethod)){let Ue=await Xe(J,te,le.submission,ht,W.active,{replace:le.replace,flushSync:dt});if(Ue.shortCircuited)return;if(Ue.pendingActionResult){let[_e,Q]=Ue.pendingActionResult;if(ai(Q)&&op(Q.error)&&Q.error.status===404){A=null,mt(te,{matches:Ue.matches,loaderData:{},errors:{[_e]:Q.error}});return}}ht=Ue.matches||ht,se=Ue.pendingActionResult,Oe=db(te,le.submission),dt=!1,W.active=!1,J=Wu(t.history,J.url,J.signal)}let{shortCircuited:G,matches:oe,loaderData:we,errors:ke}=await kt(J,te,ht,W.active,Oe,le&&le.submission,le&&le.fetcherSubmission,le&&le.replace,le&&le.initialHydration===!0,dt,se);G||(A=null,mt(te,qn({matches:oe||ht},ik(se),{loaderData:we,errors:ke})))}async function Xe(q,te,le,Ie,Oe,ht){ht===void 0&&(ht={}),de();let dt=yJ(te,le);if(We({navigation:dt},{flushSync:ht.flushSync===!0}),Oe){let se=await Xt(Ie,te.pathname,q.signal);if(se.type==="aborted")return{shortCircuited:!0};if(se.type==="error"){let G=kc(se.partialMatches).route.id;return{matches:se.partialMatches,pendingActionResult:[G,{type:Cn.error,error:se.error}]}}else if(se.matches)Ie=se.matches;else{let{notFoundMatches:G,error:oe,route:we}=Tt(te.pathname);return{matches:G,pendingActionResult:[we.id,{type:Cn.error,error:oe}]}}}let W,J=Wf(Ie,te);if(!J.route.action&&!J.route.lazy)W={type:Cn.error,error:$s(405,{method:q.method,pathname:te.pathname,routeId:J.route.id})};else if(W=(await Ne("action",C,q,[J],Ie,null))[J.route.id],q.signal.aborted)return{shortCircuited:!0};if(zc(W)){let se;return ht&&ht.replace!=null?se=ht.replace:se=tk(W.response.headers.get("Location"),new URL(q.url),c)===C.location.pathname+C.location.search,await fe(q,W,!0,{submission:le,replace:se}),{shortCircuited:!0}}if(pl(W))throw $s(400,{type:"defer-action"});if(ai(W)){let se=kc(Ie,J.route.id);return(ht&&ht.replace)!==!0&&(T=pr.Push),{matches:Ie,pendingActionResult:[se.route.id,W]}}return{matches:Ie,pendingActionResult:[J.route.id,W]}}async function kt(q,te,le,Ie,Oe,ht,dt,W,J,se,G){let oe=Oe||db(te,ht),we=ht||dt||lk(oe),ke=!U&&(!h.v7_partialHydration||!J);if(Ie){if(ke){let on=Gt(G);We(qn({navigation:oe},on!==void 0?{actionData:on}:{}),{flushSync:se})}let vt=await Xt(le,te.pathname,q.signal);if(vt.type==="aborted")return{shortCircuited:!0};if(vt.type==="error"){let on=kc(vt.partialMatches).route.id;return{matches:vt.partialMatches,loaderData:{},errors:{[on]:vt.error}}}else if(vt.matches)le=vt.matches;else{let{error:on,notFoundMatches:Nr,route:Pt}=Tt(te.pathname);return{matches:Nr,loaderData:{},errors:{[Pt.id]:on}}}}let Ue=l||o,[_e,Q]=QR(t.history,C,le,we,te,h.v7_partialHydration&&J===!0,h.v7_skipActionErrorRevalidation,B,K,ee,Se,F,Y,Ue,c,G);if(yt(vt=>!(le&&le.some(on=>on.route.id===vt))||_e&&_e.some(on=>on.route.id===vt)),O=++X,_e.length===0&&Q.length===0){let vt=he();return mt(te,qn({matches:le,loaderData:{},errors:G&&ai(G[1])?{[G[0]]:G[1].error}:null},ik(G),vt?{fetchers:new Map(C.fetchers)}:{}),{flushSync:se}),{shortCircuited:!0}}if(ke){let vt={};if(!Ie){vt.navigation=oe;let on=Gt(G);on!==void 0&&(vt.actionData=on)}Q.length>0&&(vt.fetchers=fn(Q)),We(vt,{flushSync:se})}Q.forEach(vt=>{ut(vt.key),vt.controller&&H.set(vt.key,vt.controller)});let Z=()=>Q.forEach(vt=>ut(vt.key));A&&A.signal.addEventListener("abort",Z);let{loaderResults:ue,fetcherResults:ge}=await ne(C,le,_e,Q,q);if(q.signal.aborted)return{shortCircuited:!0};A&&A.signal.removeEventListener("abort",Z),Q.forEach(vt=>H.delete(vt.key));let Ae=ny(ue);if(Ae)return await fe(q,Ae.result,!0,{replace:W}),{shortCircuited:!0};if(Ae=ny(ge),Ae)return Y.add(Ae.key),await fe(q,Ae.result,!0,{replace:W}),{shortCircuited:!0};let{loaderData:je,errors:it}=rk(C,le,ue,G,Q,ge,De);De.forEach((vt,on)=>{vt.subscribe(Nr=>{(Nr||vt.done)&&De.delete(on)})}),h.v7_partialHydration&&J&&C.errors&&(it=qn({},C.errors,it));let ot=he(),Nt=be(O),Qt=ot||Nt||Q.length>0;return qn({matches:le,loaderData:je,errors:it},Qt?{fetchers:new Map(C.fetchers)}:{})}function Gt(q){if(q&&!ai(q[1]))return{[q[0]]:q[1].data};if(C.actionData)return Object.keys(C.actionData).length===0?null:C.actionData}function fn(q){return q.forEach(te=>{let le=C.fetchers.get(te.key),Ie=bf(void 0,le?le.data:void 0);C.fetchers.set(te.key,Ie)}),new Map(C.fetchers)}function sn(q,te,le,Ie){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ut(q);let Oe=(Ie&&Ie.flushSync)===!0,ht=l||o,dt=IE(C.location,C.matches,c,h.v7_prependBasename,le,h.v7_relativeSplatPath,te,Ie==null?void 0:Ie.relative),W=Rc(ht,dt,c),J=Un(W,ht,dt);if(J.active&&J.matches&&(W=J.matches),!W){Qe(q,te,$s(404,{pathname:dt}),{flushSync:Oe});return}let{path:se,submission:G,error:oe}=JR(h.v7_normalizeFormMethod,!0,dt,Ie);if(oe){Qe(q,te,oe,{flushSync:Oe});return}let we=Wf(W,se),ke=(Ie&&Ie.preventScrollReset)===!0;if(G&&to(G.formMethod)){ae(q,te,se,we,W,J.active,Oe,ke,G);return}F.set(q,{routeId:te,path:se}),me(q,te,se,we,W,J.active,Oe,ke,G)}async function ae(q,te,le,Ie,Oe,ht,dt,W,J){de(),F.delete(q);function se(an){if(!an.route.action&&!an.route.lazy){let lr=$s(405,{method:J.formMethod,pathname:le,routeId:te});return Qe(q,te,lr,{flushSync:dt}),!0}return!1}if(!ht&&se(Ie))return;let G=C.fetchers.get(q);Ee(q,xJ(J,G),{flushSync:dt});let oe=new AbortController,we=Wu(t.history,le,oe.signal,J);if(ht){let an=await Xt(Oe,new URL(we.url).pathname,we.signal,q);if(an.type==="aborted")return;if(an.type==="error"){Qe(q,te,an.error,{flushSync:dt});return}else if(an.matches){if(Oe=an.matches,Ie=Wf(Oe,le),se(Ie))return}else{Qe(q,te,$s(404,{pathname:le}),{flushSync:dt});return}}H.set(q,oe);let ke=X,_e=(await Ne("action",C,we,[Ie],Oe,q))[Ie.route.id];if(we.signal.aborted){H.get(q)===oe&&H.delete(q);return}if(h.v7_fetcherPersist&&Se.has(q)){if(zc(_e)||ai(_e)){Ee(q,Xa(void 0));return}}else{if(zc(_e))if(H.delete(q),O>ke){Ee(q,Xa(void 0));return}else return Y.add(q),Ee(q,bf(J)),fe(we,_e,!1,{fetcherSubmission:J,preventScrollReset:W});if(ai(_e)){Qe(q,te,_e.error);return}}if(pl(_e))throw $s(400,{type:"defer-action"});let Q=C.navigation.location||C.location,Z=Wu(t.history,Q,oe.signal),ue=l||o,ge=C.navigation.state!=="idle"?Rc(ue,C.navigation.location,c):C.matches;rn(ge,"Didn't find any matches after fetcher action");let Ae=++X;z.set(q,Ae);let je=bf(J,_e.data);C.fetchers.set(q,je);let[it,ot]=QR(t.history,C,ge,J,Q,!1,h.v7_skipActionErrorRevalidation,B,K,ee,Se,F,Y,ue,c,[Ie.route.id,_e]);ot.filter(an=>an.key!==q).forEach(an=>{let lr=an.key,_s=C.fetchers.get(lr),ft=bf(void 0,_s?_s.data:void 0);C.fetchers.set(lr,ft),ut(lr),an.controller&&H.set(lr,an.controller)}),We({fetchers:new Map(C.fetchers)});let Nt=()=>ot.forEach(an=>ut(an.key));oe.signal.addEventListener("abort",Nt);let{loaderResults:Qt,fetcherResults:vt}=await ne(C,ge,it,ot,Z);if(oe.signal.aborted)return;oe.signal.removeEventListener("abort",Nt),z.delete(q),H.delete(q),ot.forEach(an=>H.delete(an.key));let on=ny(Qt);if(on)return fe(Z,on.result,!1,{preventScrollReset:W});if(on=ny(vt),on)return Y.add(on.key),fe(Z,on.result,!1,{preventScrollReset:W});let{loaderData:Nr,errors:Pt}=rk(C,ge,Qt,void 0,ot,vt,De);if(C.fetchers.has(q)){let an=Xa(_e.data);C.fetchers.set(q,an)}be(Ae),C.navigation.state==="loading"&&Ae>O?(rn(T,"Expected pending action"),A&&A.abort(),mt(C.navigation.location,{matches:ge,loaderData:Nr,errors:Pt,fetchers:new Map(C.fetchers)})):(We({errors:Pt,loaderData:sk(C.loaderData,Nr,ge,Pt),fetchers:new Map(C.fetchers)}),B=!1)}async function me(q,te,le,Ie,Oe,ht,dt,W,J){let se=C.fetchers.get(q);Ee(q,bf(J,se?se.data:void 0),{flushSync:dt});let G=new AbortController,oe=Wu(t.history,le,G.signal);if(ht){let _e=await Xt(Oe,new URL(oe.url).pathname,oe.signal,q);if(_e.type==="aborted")return;if(_e.type==="error"){Qe(q,te,_e.error,{flushSync:dt});return}else if(_e.matches)Oe=_e.matches,Ie=Wf(Oe,le);else{Qe(q,te,$s(404,{pathname:le}),{flushSync:dt});return}}H.set(q,G);let we=X,Ue=(await Ne("loader",C,oe,[Ie],Oe,q))[Ie.route.id];if(pl(Ue)&&(Ue=await I1(Ue,oe.signal,!0)||Ue),H.get(q)===G&&H.delete(q),!oe.signal.aborted){if(Se.has(q)){Ee(q,Xa(void 0));return}if(zc(Ue))if(O>we){Ee(q,Xa(void 0));return}else{Y.add(q),await fe(oe,Ue,!1,{preventScrollReset:W});return}if(ai(Ue)){Qe(q,te,Ue.error);return}rn(!pl(Ue),"Unhandled fetcher deferred data"),Ee(q,Xa(Ue.data))}}async function fe(q,te,le,Ie){let{submission:Oe,fetcherSubmission:ht,preventScrollReset:dt,replace:W}=Ie===void 0?{}:Ie;te.response.headers.has("X-Remix-Revalidate")&&(B=!0);let J=te.response.headers.get("Location");rn(J,"Expected a Location header on the redirect Response"),J=tk(J,new URL(q.url),c);let se=ip(C.location,J,{_isRedirect:!0});if(n){let _e=!1;if(te.response.headers.has("X-Remix-Reload-Document"))_e=!0;else if(T1.test(J)){const Q=t.history.createURL(J);_e=Q.origin!==e.location.origin||zh(Q.pathname,c)==null}if(_e){W?e.location.replace(J):e.location.assign(J);return}}A=null;let G=W===!0||te.response.headers.has("X-Remix-Replace")?pr.Replace:pr.Push,{formMethod:oe,formAction:we,formEncType:ke}=C.navigation;!Oe&&!ht&&oe&&we&&ke&&(Oe=lk(C.navigation));let Ue=Oe||ht;if(QY.has(te.response.status)&&Ue&&to(Ue.formMethod))await Je(G,se,{submission:qn({},Ue,{formAction:J}),preventScrollReset:dt||P,enableViewTransition:le?D:void 0});else{let _e=db(se,Oe);await Je(G,se,{overrideNavigation:_e,fetcherSubmission:ht,preventScrollReset:dt||P,enableViewTransition:le?D:void 0})}}async function Ne(q,te,le,Ie,Oe,ht){let dt,W={};try{dt=await oJ(u,q,te,le,Ie,Oe,ht,i,s)}catch(J){return Ie.forEach(se=>{W[se.route.id]={type:Cn.error,error:J}}),W}for(let[J,se]of Object.entries(dt))if(hJ(se)){let G=se.result;W[J]={type:Cn.redirect,response:cJ(G,le,J,Oe,c,h.v7_relativeSplatPath)}}else W[J]=await lJ(se);return W}async function ne(q,te,le,Ie,Oe){let ht=q.matches,dt=Ne("loader",q,Oe,le,te,null),W=Promise.all(Ie.map(async G=>{if(G.matches&&G.match&&G.controller){let we=(await Ne("loader",q,Wu(t.history,G.path,G.controller.signal),[G.match],G.matches,G.key))[G.match.route.id];return{[G.key]:we}}else return Promise.resolve({[G.key]:{type:Cn.error,error:$s(404,{pathname:G.path})}})})),J=await dt,se=(await W).reduce((G,oe)=>Object.assign(G,oe),{});return await Promise.all([pJ(te,J,Oe.signal,ht,q.loaderData),gJ(te,se,Ie)]),{loaderResults:J,fetcherResults:se}}function de(){B=!0,K.push(...yt()),F.forEach((q,te)=>{H.has(te)&&ee.add(te),ut(te)})}function Ee(q,te,le){le===void 0&&(le={}),C.fetchers.set(q,te),We({fetchers:new Map(C.fetchers)},{flushSync:(le&&le.flushSync)===!0})}function Qe(q,te,le,Ie){Ie===void 0&&(Ie={});let Oe=kc(C.matches,te);Ve(q),We({errors:{[Oe.route.id]:le},fetchers:new Map(C.fetchers)},{flushSync:(Ie&&Ie.flushSync)===!0})}function re(q){return ye.set(q,(ye.get(q)||0)+1),Se.has(q)&&Se.delete(q),C.fetchers.get(q)||ZY}function Ve(q){let te=C.fetchers.get(q);H.has(q)&&!(te&&te.state==="loading"&&z.has(q))&&ut(q),F.delete(q),z.delete(q),Y.delete(q),h.v7_fetcherPersist&&Se.delete(q),ee.delete(q),C.fetchers.delete(q)}function Te(q){let te=(ye.get(q)||0)-1;te<=0?(ye.delete(q),Se.add(q),h.v7_fetcherPersist||Ve(q)):ye.set(q,te),We({fetchers:new Map(C.fetchers)})}function ut(q){let te=H.get(q);te&&(te.abort(),H.delete(q))}function pt(q){for(let te of q){let le=re(te),Ie=Xa(le.data);C.fetchers.set(te,Ie)}}function he(){let q=[],te=!1;for(let le of Y){let Ie=C.fetchers.get(le);rn(Ie,"Expected fetcher: "+le),Ie.state==="loading"&&(Y.delete(le),q.push(le),te=!0)}return pt(q),te}function be(q){let te=[];for(let[le,Ie]of z)if(Ie<q){let Oe=C.fetchers.get(le);rn(Oe,"Expected fetcher: "+le),Oe.state==="loading"&&(ut(le),z.delete(le),te.push(le))}return pt(te),te.length>0}function Fe(q,te){let le=C.blockers.get(q)||_f;return xe.get(q)!==te&&xe.set(q,te),le}function Pe(q){C.blockers.delete(q),xe.delete(q)}function Yt(q,te){let le=C.blockers.get(q)||_f;rn(le.state==="unblocked"&&te.state==="blocked"||le.state==="blocked"&&te.state==="blocked"||le.state==="blocked"&&te.state==="proceeding"||le.state==="blocked"&&te.state==="unblocked"||le.state==="proceeding"&&te.state==="unblocked","Invalid blocker state transition: "+le.state+" -> "+te.state);let Ie=new Map(C.blockers);Ie.set(q,te),We({blockers:Ie})}function Ht(q){let{currentLocation:te,nextLocation:le,historyAction:Ie}=q;if(xe.size===0)return;xe.size>1&&gh(!1,"A router only supports one blocker at a time");let Oe=Array.from(xe.entries()),[ht,dt]=Oe[Oe.length-1],W=C.blockers.get(ht);if(!(W&&W.state==="proceeding")&&dt({currentLocation:te,nextLocation:le,historyAction:Ie}))return ht}function Tt(q){let te=$s(404,{pathname:q}),le=l||o,{matches:Ie,route:Oe}=ok(le);return yt(),{notFoundMatches:Ie,route:Oe,error:te}}function yt(q){let te=[];return De.forEach((le,Ie)=>{(!q||q(Ie))&&(le.cancel(),te.push(Ie),De.delete(Ie))}),te}function Ft(q,te,le){if(g=q,E=te,x=le||null,!v&&C.navigation===ub){v=!0;let Ie=xr(C.location,C.matches);Ie!=null&&We({restoreScrollPosition:Ie})}return()=>{g=null,E=null,x=null}}function Sn(q,te){return x&&x(q,te.map(Ie=>AY(Ie,C.loaderData)))||q.key}function mn(q,te){if(g&&E){let le=Sn(q,te);g[le]=E()}}function xr(q,te){if(g){let le=Sn(q,te),Ie=g[le];if(typeof Ie=="number")return Ie}return null}function Un(q,te,le){if(d)if(q){if(Object.keys(q[0].params).length>0)return{active:!0,matches:lx(te,le,c,!0)}}else return{active:!0,matches:lx(te,le,c,!0)||[]};return{active:!1,matches:null}}async function Xt(q,te,le,Ie){if(!d)return{type:"success",matches:q};let Oe=q;for(;;){let ht=l==null,dt=l||o,W=i;try{await d({signal:le,path:te,matches:Oe,fetcherKey:Ie,patch:(G,oe)=>{le.aborted||ek(G,oe,dt,W,s)}})}catch(G){return{type:"error",error:G,partialMatches:Oe}}finally{ht&&!le.aborted&&(o=[...o])}if(le.aborted)return{type:"aborted"};let J=Rc(dt,te,c);if(J)return{type:"success",matches:J};let se=lx(dt,te,c,!0);if(!se||Oe.length===se.length&&Oe.every((G,oe)=>G.route.id===se[oe].route.id))return{type:"success",matches:null};Oe=se}}function nn(q){i={},l=mv(q,s,void 0,i)}function Bn(q,te){let le=l==null;ek(q,te,l||o,i,s),le&&(o=[...o],We({}))}return j={get basename(){return c},get future(){return h},get state(){return C},get routes(){return o},get window(){return e},initialize:Ye,subscribe:et,enableScrollRestoration:Ft,navigate:Le,fetch:sn,revalidate:ve,createHref:q=>t.history.createHref(q),encodeLocation:q=>t.history.encodeLocation(q),getFetcher:re,deleteFetcher:Te,dispose:qe,getBlocker:Fe,deleteBlocker:Pe,patchRoutes:Bn,_internalFetchControllers:H,_internalActiveDeferreds:De,_internalSetRoutes:nn},j}function nJ(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function IE(t,e,n,r,s,i,o,l){let c,u;if(o){c=[];for(let h of e)if(c.push(h),h.route.id===o){u=h;break}}else c=e,u=e[e.length-1];let d=zw(s||".",Bw(c,i),zh(t.pathname,n)||t.pathname,l==="path");if(s==null&&(d.search=t.search,d.hash=t.hash),(s==null||s===""||s===".")&&u){let h=N1(d.search);if(u.route.index&&!h)d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index";else if(!u.route.index&&h){let f=new URLSearchParams(d.search),m=f.getAll("index");f.delete("index"),m.filter(x=>x).forEach(x=>f.append("index",x));let g=f.toString();d.search=g?"?"+g:""}}return r&&n!=="/"&&(d.pathname=d.pathname==="/"?n:ua([n,d.pathname])),uu(d)}function JR(t,e,n,r){if(!r||!nJ(r))return{path:n};if(r.formMethod&&!mJ(r.formMethod))return{path:n,error:$s(405,{method:r.formMethod})};let s=()=>({path:n,error:$s(400,{type:"invalid-body"})}),i=r.formMethod||"get",o=t?i.toUpperCase():i.toLowerCase(),l=TV(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!to(o))return s();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((m,g)=>{let[x,E]=g;return""+m+x+"="+E+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!to(o))return s();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return s()}}}rn(typeof FormData=="function","FormData is not available in this environment");let c,u;if(r.formData)c=PE(r.formData),u=r.formData;else if(r.body instanceof FormData)c=PE(r.body),u=r.body;else if(r.body instanceof URLSearchParams)c=r.body,u=nk(c);else if(r.body==null)c=new URLSearchParams,u=new FormData;else try{c=new URLSearchParams(r.body),u=nk(c)}catch{return s()}let d={formMethod:o,formAction:l,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(to(d.formMethod))return{path:n,submission:d};let h=Da(n);return e&&h.search&&N1(h.search)&&c.append("index",""),h.search="?"+c,{path:uu(h),submission:d}}function XR(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(s=>s.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function QR(t,e,n,r,s,i,o,l,c,u,d,h,f,m,g,x){let E=x?ai(x[1])?x[1].error:x[1].data:void 0,v=t.createURL(e.location),_=t.createURL(s),S=n;i&&e.errors?S=XR(n,Object.keys(e.errors)[0],!0):x&&ai(x[1])&&(S=XR(n,x[0]));let I=x?x[1].statusCode:void 0,M=o&&I&&I>=400,j=S.filter((T,P)=>{let{route:A}=T;if(A.lazy)return!0;if(A.loader==null)return!1;if(i)return NE(A,e.loaderData,e.errors);if(rJ(e.loaderData,e.matches[P],T)||c.some(k=>k===T.route.id))return!0;let D=e.matches[P],R=T;return ZR(T,qn({currentUrl:v,currentParams:D.params,nextUrl:_,nextParams:R.params},r,{actionResult:E,actionStatus:I,defaultShouldRevalidate:M?!1:l||v.pathname+v.search===_.pathname+_.search||v.search!==_.search||EV(D,R)}))}),C=[];return h.forEach((T,P)=>{if(i||!n.some(U=>U.route.id===T.routeId)||d.has(P))return;let A=Rc(m,T.path,g);if(!A){C.push({key:P,routeId:T.routeId,path:T.path,matches:null,match:null,controller:null});return}let D=e.fetchers.get(P),R=Wf(A,T.path),k=!1;f.has(P)?k=!1:u.has(P)?(u.delete(P),k=!0):D&&D.state!=="idle"&&D.data===void 0?k=l:k=ZR(R,qn({currentUrl:v,currentParams:e.matches[e.matches.length-1].params,nextUrl:_,nextParams:n[n.length-1].params},r,{actionResult:E,actionStatus:I,defaultShouldRevalidate:M?!1:l})),k&&C.push({key:P,routeId:T.routeId,path:T.path,matches:A,match:R,controller:new AbortController})}),[j,C]}function NE(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,s=n!=null&&n[t.id]!==void 0;return!r&&s?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!s}function rJ(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function EV(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function ZR(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function ek(t,e,n,r,s){var i;let o;if(t){let u=r[t];rn(u,"No route found to patch children into: routeId = "+t),u.children||(u.children=[]),o=u.children}else o=n;let l=e.filter(u=>!o.some(d=>CV(u,d))),c=mv(l,s,[t||"_","patch",String(((i=o)==null?void 0:i.length)||"0")],r);o.push(...c)}function CV(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var s;return(s=e.children)==null?void 0:s.some(i=>CV(n,i))}):!1}async function sJ(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];rn(s,"No route found in manifest");let i={};for(let o in r){let c=s[o]!==void 0&&o!=="hasErrorBoundary";gh(!c,'Route "'+s.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!c&&!NY.has(o)&&(i[o]=r[o])}Object.assign(s,i),Object.assign(s,qn({},e(s),{lazy:void 0}))}async function iJ(t){let{matches:e}=t,n=e.filter(s=>s.shouldLoad);return(await Promise.all(n.map(s=>s.resolve()))).reduce((s,i,o)=>Object.assign(s,{[n[o].route.id]:i}),{})}async function oJ(t,e,n,r,s,i,o,l,c,u){let d=i.map(m=>m.route.lazy?sJ(m.route,c,l):void 0),h=i.map((m,g)=>{let x=d[g],E=s.some(_=>_.route.id===m.route.id);return qn({},m,{shouldLoad:E,resolve:async _=>(_&&r.method==="GET"&&(m.route.lazy||m.route.loader)&&(E=!0),E?aJ(e,r,m,x,_,u):Promise.resolve({type:Cn.data,result:void 0}))})}),f=await t({matches:h,request:r,params:i[0].params,fetcherKey:o,context:u});try{await Promise.all(d)}catch{}return f}async function aJ(t,e,n,r,s,i){let o,l,c=u=>{let d,h=new Promise((g,x)=>d=x);l=()=>d(),e.signal.addEventListener("abort",l);let f=g=>typeof u!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):u({request:e,params:n.params,context:i},...g!==void 0?[g]:[]),m=(async()=>{try{return{type:"data",result:await(s?s(x=>f(x)):f())}}catch(g){return{type:"error",result:g}}})();return Promise.race([m,h])};try{let u=n.route[t];if(r)if(u){let d,[h]=await Promise.all([c(u).catch(f=>{d=f}),r]);if(d!==void 0)throw d;o=h}else if(await r,u=n.route[t],u)o=await c(u);else if(t==="action"){let d=new URL(e.url),h=d.pathname+d.search;throw $s(405,{method:e.method,pathname:h,routeId:n.route.id})}else return{type:Cn.data,result:void 0};else if(u)o=await c(u);else{let d=new URL(e.url),h=d.pathname+d.search;throw $s(404,{pathname:h})}rn(o.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(u){return{type:Cn.error,result:u}}finally{l&&e.signal.removeEventListener("abort",l)}return o}async function lJ(t){let{result:e,type:n}=t;if(IV(e)){let h;try{let f=e.headers.get("Content-Type");f&&/\bapplication\/json\b/.test(f)?e.body==null?h=null:h=await e.json():h=await e.text()}catch(f){return{type:Cn.error,error:f}}return n===Cn.error?{type:Cn.error,error:new pv(e.status,e.statusText,h),statusCode:e.status,headers:e.headers}:{type:Cn.data,data:h,statusCode:e.status,headers:e.headers}}if(n===Cn.error){if(ak(e)){var r,s;if(e.data instanceof Error){var i,o;return{type:Cn.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}}return{type:Cn.error,error:new pv(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:op(e)?e.status:void 0,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:Cn.error,error:e,statusCode:op(e)?e.status:void 0}}if(fJ(e)){var l,c;return{type:Cn.deferred,deferredData:e,statusCode:(l=e.init)==null?void 0:l.status,headers:((c=e.init)==null?void 0:c.headers)&&new Headers(e.init.headers)}}if(ak(e)){var u,d;return{type:Cn.data,data:e.data,statusCode:(u=e.init)==null?void 0:u.status,headers:(d=e.init)!=null&&d.headers?new Headers(e.init.headers):void 0}}return{type:Cn.data,data:e}}function cJ(t,e,n,r,s,i){let o=t.headers.get("Location");if(rn(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!T1.test(o)){let l=r.slice(0,r.findIndex(c=>c.route.id===n)+1);o=IE(new URL(e.url),l,s,!0,o,i),t.headers.set("Location",o)}return t}function tk(t,e,n){if(T1.test(t)){let r=t,s=r.startsWith("//")?new URL(e.protocol+r):new URL(r),i=zh(s.pathname,n)!=null;if(s.origin===e.origin&&i)return s.pathname+s.search+s.hash}return t}function Wu(t,e,n,r){let s=t.createURL(TV(e)).toString(),i={signal:n};if(r&&to(r.formMethod)){let{formMethod:o,formEncType:l}=r;i.method=o.toUpperCase(),l==="application/json"?(i.headers=new Headers({"Content-Type":l}),i.body=JSON.stringify(r.json)):l==="text/plain"?i.body=r.text:l==="application/x-www-form-urlencoded"&&r.formData?i.body=PE(r.formData):i.body=r.formData}return new Request(s,i)}function PE(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function nk(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function uJ(t,e,n,r,s){let i={},o=null,l,c=!1,u={},d=n&&ai(n[1])?n[1].error:void 0;return t.forEach(h=>{if(!(h.route.id in e))return;let f=h.route.id,m=e[f];if(rn(!zc(m),"Cannot handle redirect results in processLoaderData"),ai(m)){let g=m.error;if(d!==void 0&&(g=d,d=void 0),o=o||{},s)o[f]=g;else{let x=kc(t,f);o[x.route.id]==null&&(o[x.route.id]=g)}i[f]=void 0,c||(c=!0,l=op(m.error)?m.error.status:500),m.headers&&(u[f]=m.headers)}else pl(m)?(r.set(f,m.deferredData),i[f]=m.deferredData.data,m.statusCode!=null&&m.statusCode!==200&&!c&&(l=m.statusCode),m.headers&&(u[f]=m.headers)):(i[f]=m.data,m.statusCode&&m.statusCode!==200&&!c&&(l=m.statusCode),m.headers&&(u[f]=m.headers))}),d!==void 0&&n&&(o={[n[0]]:d},i[n[0]]=void 0),{loaderData:i,errors:o,statusCode:l||200,loaderHeaders:u}}function rk(t,e,n,r,s,i,o){let{loaderData:l,errors:c}=uJ(e,n,r,o,!1);return s.forEach(u=>{let{key:d,match:h,controller:f}=u,m=i[d];if(rn(m,"Did not find corresponding fetcher result"),!(f&&f.signal.aborted))if(ai(m)){let g=kc(t.matches,h==null?void 0:h.route.id);c&&c[g.route.id]||(c=qn({},c,{[g.route.id]:m.error})),t.fetchers.delete(d)}else if(zc(m))rn(!1,"Unhandled fetcher revalidation redirect");else if(pl(m))rn(!1,"Unhandled fetcher deferred data");else{let g=Xa(m.data);t.fetchers.set(d,g)}}),{loaderData:l,errors:c}}function sk(t,e,n,r){let s=qn({},e);for(let i of n){let o=i.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(s[o]=e[o]):t[o]!==void 0&&i.route.loader&&(s[o]=t[o]),r&&r.hasOwnProperty(o))break}return s}function ik(t){return t?ai(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function kc(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function ok(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function $s(t,e){let{pathname:n,routeId:r,method:s,type:i,message:o}=e===void 0?{}:e,l="Unknown Server Error",c="Unknown @remix-run/router error";return t===400?(l="Bad Request",s&&n&&r?c="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?c="defer() is not supported in actions":i==="invalid-body"&&(c="Unable to encode submission body")):t===403?(l="Forbidden",c='Route "'+r+'" does not match URL "'+n+'"'):t===404?(l="Not Found",c='No route matches URL "'+n+'"'):t===405&&(l="Method Not Allowed",s&&n&&r?c="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(c='Invalid request method "'+s.toUpperCase()+'"')),new pv(t||500,l,new Error(c),!0)}function ny(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,s]=e[n];if(zc(s))return{key:r,result:s}}}function TV(t){let e=typeof t=="string"?Da(t):t;return uu(qn({},e,{hash:""}))}function dJ(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function hJ(t){return IV(t.result)&&XY.has(t.result.status)}function pl(t){return t.type===Cn.deferred}function ai(t){return t.type===Cn.error}function zc(t){return(t&&t.type)===Cn.redirect}function ak(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function fJ(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function IV(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function mJ(t){return JY.has(t.toLowerCase())}function to(t){return KY.has(t.toLowerCase())}async function pJ(t,e,n,r,s){let i=Object.entries(e);for(let o=0;o<i.length;o++){let[l,c]=i[o],u=t.find(f=>(f==null?void 0:f.route.id)===l);if(!u)continue;let d=r.find(f=>f.route.id===u.route.id),h=d!=null&&!EV(d,u)&&(s&&s[u.route.id])!==void 0;pl(c)&&h&&await I1(c,n,!1).then(f=>{f&&(e[l]=f)})}}async function gJ(t,e,n){for(let r=0;r<n.length;r++){let{key:s,routeId:i,controller:o}=n[r],l=e[s];t.find(u=>(u==null?void 0:u.route.id)===i)&&pl(l)&&(rn(o,"Expected an AbortController for revalidating fetcher deferred result"),await I1(l,o.signal,!0).then(u=>{u&&(e[s]=u)}))}}async function I1(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Cn.data,data:t.deferredData.unwrappedData}}catch(s){return{type:Cn.error,error:s}}return{type:Cn.data,data:t.deferredData.data}}}function N1(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Wf(t,e){let n=typeof e=="string"?Da(e).search:e.search;if(t[t.length-1].route.index&&N1(n||""))return t[t.length-1];let r=_V(t);return r[r.length-1]}function lk(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:i,json:o}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function db(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function yJ(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function bf(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function xJ(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Xa(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function vJ(t,e){try{let n=t.sessionStorage.getItem(SV);if(n){let r=JSON.parse(n);for(let[s,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function wJ(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(SV,JSON.stringify(n))}catch(r){gh(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ap(){return ap=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ap.apply(this,arguments)}const Gw=p.createContext(null),NV=p.createContext(null),tc=p.createContext(null),Hw=p.createContext(null),Ko=p.createContext({outlet:null,matches:[],isDataRoute:!1}),PV=p.createContext(null);function _J(t,e){let{relative:n}=e===void 0?{}:e;Gh()||rn(!1);let{basename:r,navigator:s}=p.useContext(tc),{hash:i,pathname:o,search:l}=RV(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:ua([r,o])),s.createHref({pathname:c,search:l,hash:i})}function Gh(){return p.useContext(Hw)!=null}function Ma(){return Gh()||rn(!1),p.useContext(Hw).location}function AV(t){p.useContext(tc).static||p.useLayoutEffect(t)}function bi(){let{isDataRoute:t}=p.useContext(Ko);return t?MJ():bJ()}function bJ(){Gh()||rn(!1);let t=p.useContext(Gw),{basename:e,future:n,navigator:r}=p.useContext(tc),{matches:s}=p.useContext(Ko),{pathname:i}=Ma(),o=JSON.stringify(Bw(s,n.v7_relativeSplatPath)),l=p.useRef(!1);return AV(()=>{l.current=!0}),p.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let h=zw(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ua([e,h.pathname])),(d.replace?r.replace:r.push)(h,d.state,d)},[e,r,o,i,t])}const SJ=p.createContext(null);function EJ(t){let e=p.useContext(Ko).outlet;return e&&p.createElement(SJ.Provider,{value:t},e)}function Ww(){let{matches:t}=p.useContext(Ko),e=t[t.length-1];return e?e.params:{}}function RV(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=p.useContext(tc),{matches:s}=p.useContext(Ko),{pathname:i}=Ma(),o=JSON.stringify(Bw(s,r.v7_relativeSplatPath));return p.useMemo(()=>zw(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function CJ(t,e,n,r){Gh()||rn(!1);let{navigator:s}=p.useContext(tc),{matches:i}=p.useContext(Ko),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=Ma(),d;if(e){var h;let E=typeof e=="string"?Da(e):e;c==="/"||(h=E.pathname)!=null&&h.startsWith(c)||rn(!1),d=E}else d=u;let f=d.pathname||"/",m=f;if(c!=="/"){let E=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(E.length).join("/")}let g=Rc(t,{pathname:m}),x=AJ(g&&g.map(E=>Object.assign({},E,{params:Object.assign({},l,E.params),pathname:ua([c,s.encodeLocation?s.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?c:ua([c,s.encodeLocation?s.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),i,n,r);return e&&x?p.createElement(Hw.Provider,{value:{location:ap({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:pr.Pop}},x):x}function TJ(){let t=DJ(),e=op(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},e),n?p.createElement("pre",{style:s},n):null,i)}const IJ=p.createElement(TJ,null);class NJ extends p.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?p.createElement(Ko.Provider,{value:this.props.routeContext},p.createElement(PV.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function PJ(t){let{routeContext:e,match:n,children:r}=t,s=p.useContext(Gw);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),p.createElement(Ko.Provider,{value:e},r)}function AJ(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let d=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||rn(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:m}=n,g=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||g){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,f)=>{let m,g=!1,x=null,E=null;n&&(m=l&&h.route.id?l[h.route.id]:void 0,x=h.route.errorElement||IJ,c&&(u<0&&f===0?(LJ("route-fallback",!1),g=!0,E=null):u===f&&(g=!0,E=h.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,f+1)),_=()=>{let S;return m?S=x:g?S=E:h.route.Component?S=p.createElement(h.route.Component,null):h.route.element?S=h.route.element:S=d,p.createElement(PJ,{match:h,routeContext:{outlet:d,matches:v,isDataRoute:n!=null},children:S})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?p.createElement(NJ,{location:n.location,revalidation:n.revalidation,component:x,error:m,children:_(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):_()},null)}var kV=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(kV||{}),gv=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(gv||{});function RJ(t){let e=p.useContext(Gw);return e||rn(!1),e}function kJ(t){let e=p.useContext(NV);return e||rn(!1),e}function jJ(t){let e=p.useContext(Ko);return e||rn(!1),e}function jV(t){let e=jJ(),n=e.matches[e.matches.length-1];return n.route.id||rn(!1),n.route.id}function DJ(){var t;let e=p.useContext(PV),n=kJ(gv.UseRouteError),r=jV(gv.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function MJ(){let{router:t}=RJ(kV.UseNavigateStable),e=jV(gv.UseNavigateStable),n=p.useRef(!1);return AV(()=>{n.current=!0}),p.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,ap({fromRouteId:e},i)))},[t,e])}const ck={};function LJ(t,e,n){!e&&!ck[t]&&(ck[t]=!0)}function FJ(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function P1(t){let{to:e,replace:n,state:r,relative:s}=t;Gh()||rn(!1);let{future:i,static:o}=p.useContext(tc),{matches:l}=p.useContext(Ko),{pathname:c}=Ma(),u=bi(),d=zw(e,Bw(l,i.v7_relativeSplatPath),c,s==="path"),h=JSON.stringify(d);return p.useEffect(()=>u(JSON.parse(h),{replace:n,state:r,relative:s}),[u,h,s,n,r]),null}function OJ(t){return EJ(t.context)}function VJ(t){let{basename:e="/",children:n=null,location:r,navigationType:s=pr.Pop,navigator:i,static:o=!1,future:l}=t;Gh()&&rn(!1);let c=e.replace(/^\/*/,"/"),u=p.useMemo(()=>({basename:c,navigator:i,static:o,future:ap({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=Da(r));let{pathname:d="/",search:h="",hash:f="",state:m=null,key:g="default"}=r,x=p.useMemo(()=>{let E=zh(d,c);return E==null?null:{location:{pathname:E,search:h,hash:f,state:m,key:g},navigationType:s}},[c,d,h,f,m,g,s]);return x==null?null:p.createElement(tc.Provider,{value:u},p.createElement(Hw.Provider,{children:n,value:x}))}new Promise(()=>{});function $J(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:p.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:p.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:p.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lp(){return lp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lp.apply(this,arguments)}function UJ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function BJ(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function zJ(t,e){return t.button===0&&(!e||e==="_self")&&!BJ(t)}const GJ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],HJ="6";try{window.__reactRouterVersion=HJ}catch{}function WJ(t,e){return tJ({basename:e==null?void 0:e.basename,future:lp({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:CY({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||qJ(),routes:t,mapRouteProperties:$J,dataStrategy:e==null?void 0:e.dataStrategy,patchRoutesOnNavigation:e==null?void 0:e.patchRoutesOnNavigation,window:e==null?void 0:e.window}).initialize()}function qJ(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=lp({},e,{errors:KJ(e.errors)})),e}function KJ(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new pv(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let o=new i(s.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let i=new Error(s.message);i.stack="",n[r]=i}}else n[r]=s;return n}const YJ=p.createContext({isTransitioning:!1}),JJ=p.createContext(new Map),XJ="startTransition",uk=Tw[XJ],QJ="flushSync",dk=EY[QJ];function ZJ(t){uk?uk(t):t()}function Sf(t){dk?dk(t):t()}let eX=class{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}};function tX(t){let{fallbackElement:e,router:n,future:r}=t,[s,i]=p.useState(n.state),[o,l]=p.useState(),[c,u]=p.useState({isTransitioning:!1}),[d,h]=p.useState(),[f,m]=p.useState(),[g,x]=p.useState(),E=p.useRef(new Map),{v7_startTransition:v}=r||{},_=p.useCallback(T=>{v?ZJ(T):T()},[v]),S=p.useCallback((T,P)=>{let{deletedFetchers:A,flushSync:D,viewTransitionOpts:R}=P;T.fetchers.forEach((U,B)=>{U.data!==void 0&&E.current.set(B,U.data)}),A.forEach(U=>E.current.delete(U));let k=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!R||k){D?Sf(()=>i(T)):_(()=>i(T));return}if(D){Sf(()=>{f&&(d&&d.resolve(),f.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:R.currentLocation,nextLocation:R.nextLocation})});let U=n.window.document.startViewTransition(()=>{Sf(()=>i(T))});U.finished.finally(()=>{Sf(()=>{h(void 0),m(void 0),l(void 0),u({isTransitioning:!1})})}),Sf(()=>m(U));return}f?(d&&d.resolve(),f.skipTransition(),x({state:T,currentLocation:R.currentLocation,nextLocation:R.nextLocation})):(l(T),u({isTransitioning:!0,flushSync:!1,currentLocation:R.currentLocation,nextLocation:R.nextLocation}))},[n.window,f,d,E,_]);p.useLayoutEffect(()=>n.subscribe(S),[n,S]),p.useEffect(()=>{c.isTransitioning&&!c.flushSync&&h(new eX)},[c]),p.useEffect(()=>{if(d&&o&&n.window){let T=o,P=d.promise,A=n.window.document.startViewTransition(async()=>{_(()=>i(T)),await P});A.finished.finally(()=>{h(void 0),m(void 0),l(void 0),u({isTransitioning:!1})}),m(A)}},[_,o,d,n.window]),p.useEffect(()=>{d&&o&&s.location.key===o.location.key&&d.resolve()},[d,f,s.location,o]),p.useEffect(()=>{!c.isTransitioning&&g&&(l(g.state),u({isTransitioning:!0,flushSync:!1,currentLocation:g.currentLocation,nextLocation:g.nextLocation}),x(void 0))},[c.isTransitioning,g]),p.useEffect(()=>{},[]);let I=p.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:T=>n.navigate(T),push:(T,P,A)=>n.navigate(T,{state:P,preventScrollReset:A==null?void 0:A.preventScrollReset}),replace:(T,P,A)=>n.navigate(T,{replace:!0,state:P,preventScrollReset:A==null?void 0:A.preventScrollReset})}),[n]),M=n.basename||"/",j=p.useMemo(()=>({router:n,navigator:I,static:!1,basename:M}),[n,I,M]),C=p.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return p.useEffect(()=>FJ(r,n.future),[r,n.future]),p.createElement(p.Fragment,null,p.createElement(Gw.Provider,{value:j},p.createElement(NV.Provider,{value:s},p.createElement(JJ.Provider,{value:E.current},p.createElement(YJ.Provider,{value:c},p.createElement(VJ,{basename:M,location:s.location,navigationType:s.historyAction,navigator:I,future:C},s.initialized||n.future.v7_partialHydration?p.createElement(nX,{routes:n.routes,future:n.future,state:s}):e))))),null)}const nX=p.memo(rX);function rX(t){let{routes:e,future:n,state:r}=t;return CJ(e,void 0,r,n)}const sX=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",iX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ns=p.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h}=e,f=UJ(e,GJ),{basename:m}=p.useContext(tc),g,x=!1;if(typeof u=="string"&&iX.test(u)&&(g=u,sX))try{let S=new URL(window.location.href),I=u.startsWith("//")?new URL(S.protocol+u):new URL(u),M=zh(I.pathname,m);I.origin===S.origin&&M!=null?u=M+I.search+I.hash:x=!0}catch{}let E=_J(u,{relative:s}),v=oX(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:h});function _(S){r&&r(S),S.defaultPrevented||v(S)}return p.createElement("a",lp({},f,{href:g||E,onClick:x||i?r:_,ref:n,target:c}))});var hk;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(hk||(hk={}));var fk;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(fk||(fk={}));function oX(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=bi(),u=Ma(),d=RV(t,{relative:o});return p.useCallback(h=>{if(zJ(h,n)){h.preventDefault();let f=r!==void 0?r:uu(u)===uu(d);c(t,{replace:f,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[u,c,d,r,s,n,t,i,o,l])}function DV(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=DV(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function MV(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=DV(t))&&(r&&(r+=" "),r+=e);return r}function aX(){for(var t=0,e,n,r="";t<arguments.length;)(e=arguments[t++])&&(n=LV(e))&&(r&&(r+=" "),r+=n);return r}function LV(t){if(typeof t=="string")return t;for(var e,n="",r=0;r<t.length;r++)t[r]&&(e=LV(t[r]))&&(n&&(n+=" "),n+=e);return n}var A1="-";function lX(t){var e=uX(t),n=t.conflictingClassGroups,r=t.conflictingClassGroupModifiers,s=r===void 0?{}:r;function i(l){var c=l.split(A1);return c[0]===""&&c.length!==1&&c.shift(),FV(c,e)||cX(l)}function o(l,c){var u=n[l]||[];return c&&s[l]?[].concat(u,s[l]):u}return{getClassGroupId:i,getConflictingClassGroupIds:o}}function FV(t,e){var o;if(t.length===0)return e.classGroupId;var n=t[0],r=e.nextPart.get(n),s=r?FV(t.slice(1),r):void 0;if(s)return s;if(e.validators.length!==0){var i=t.join(A1);return(o=e.validators.find(function(l){var c=l.validator;return c(i)}))==null?void 0:o.classGroupId}}var mk=/^\[(.+)\]$/;function cX(t){if(mk.test(t)){var e=mk.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}function uX(t){var e=t.theme,n=t.prefix,r={nextPart:new Map,validators:[]},s=hX(Object.entries(t.classGroups),n);return s.forEach(function(i){var o=i[0],l=i[1];AE(l,r,o,e)}),r}function AE(t,e,n,r){t.forEach(function(s){if(typeof s=="string"){var i=s===""?e:pk(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(dX(s)){AE(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(function(o){var l=o[0],c=o[1];AE(c,pk(e,l),n,r)})})}function pk(t,e){var n=t;return e.split(A1).forEach(function(r){n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n}function dX(t){return t.isThemeGetter}function hX(t,e){return e?t.map(function(n){var r=n[0],s=n[1],i=s.map(function(o){return typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(l){var c=l[0],u=l[1];return[e+c,u]})):o});return[r,i]}):t}function fX(t){if(t<1)return{get:function(){},set:function(){}};var e=0,n=new Map,r=new Map;function s(i,o){n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)}return{get:function(o){var l=n.get(o);if(l!==void 0)return l;if((l=r.get(o))!==void 0)return s(o,l),l},set:function(o,l){n.has(o)?n.set(o,l):s(o,l)}}}var OV="!";function mX(t){var e=t.separator||":",n=e.length===1,r=e[0],s=e.length;return function(o){for(var l=[],c=0,u=0,d,h=0;h<o.length;h++){var f=o[h];if(c===0){if(f===r&&(n||o.slice(h,h+s)===e)){l.push(o.slice(u,h)),u=h+s;continue}if(f==="/"){d=h;continue}}f==="["?c++:f==="]"&&c--}var m=l.length===0?o:o.substring(u),g=m.startsWith(OV),x=g?m.substring(1):m,E=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:g,baseClassName:x,maybePostfixModifierPosition:E}}}function pX(t){if(t.length<=1)return t;var e=[],n=[];return t.forEach(function(r){var s=r[0]==="[";s?(e.push.apply(e,n.sort().concat([r])),n=[]):n.push(r)}),e.push.apply(e,n.sort()),e}function gX(t){return{cache:fX(t.cacheSize),splitModifiers:mX(t),...lX(t)}}var yX=/\s+/;function xX(t,e){var n=e.splitModifiers,r=e.getClassGroupId,s=e.getConflictingClassGroupIds,i=new Set;return t.trim().split(yX).map(function(o){var l=n(o),c=l.modifiers,u=l.hasImportantModifier,d=l.baseClassName,h=l.maybePostfixModifierPosition,f=r(h?d.substring(0,h):d),m=!!h;if(!f){if(!h)return{isTailwindClass:!1,originalClassName:o};if(f=r(d),!f)return{isTailwindClass:!1,originalClassName:o};m=!1}var g=pX(c).join(":"),x=u?g+OV:g;return{isTailwindClass:!0,modifierId:x,classGroupId:f,originalClassName:o,hasPostfixModifier:m}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var l=o.modifierId,c=o.classGroupId,u=o.hasPostfixModifier,d=l+c;return i.has(d)?!1:(i.add(d),s(c,u).forEach(function(h){return i.add(l+h)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function vX(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,s,i,o=l;function l(u){var d=e[0],h=e.slice(1),f=h.reduce(function(m,g){return g(m)},d());return r=gX(f),s=r.cache.get,i=r.cache.set,o=c,c(u)}function c(u){var d=s(u);if(d)return d;var h=xX(u,r);return i(u,h),h}return function(){return o(aX.apply(null,arguments))}}function zn(t){var e=function(r){return r[t]||[]};return e.isThemeGetter=!0,e}var VV=/^\[(?:([a-z-]+):)?(.+)\]$/i,wX=/^\d+\/\d+$/,_X=new Set(["px","full","screen"]),bX=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,SX=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,EX=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Ji(t){return Gc(t)||_X.has(t)||wX.test(t)||RE(t)}function RE(t){return Nu(t,"length",AX)}function CX(t){return Nu(t,"size",$V)}function TX(t){return Nu(t,"position",$V)}function IX(t){return Nu(t,"url",RX)}function ry(t){return Nu(t,"number",Gc)}function Gc(t){return!Number.isNaN(Number(t))}function NX(t){return t.endsWith("%")&&Gc(t.slice(0,-1))}function Ef(t){return gk(t)||Nu(t,"number",gk)}function un(t){return VV.test(t)}function Cf(){return!0}function Ba(t){return bX.test(t)}function PX(t){return Nu(t,"",kX)}function Nu(t,e,n){var r=VV.exec(t);return r?r[1]?r[1]===e:n(r[2]):!1}function AX(t){return SX.test(t)}function $V(){return!1}function RX(t){return t.startsWith("url(")}function gk(t){return Number.isInteger(Number(t))}function kX(t){return EX.test(t)}function jX(){var t=zn("colors"),e=zn("spacing"),n=zn("blur"),r=zn("brightness"),s=zn("borderColor"),i=zn("borderRadius"),o=zn("borderSpacing"),l=zn("borderWidth"),c=zn("contrast"),u=zn("grayscale"),d=zn("hueRotate"),h=zn("invert"),f=zn("gap"),m=zn("gradientColorStops"),g=zn("gradientColorStopPositions"),x=zn("inset"),E=zn("margin"),v=zn("opacity"),_=zn("padding"),S=zn("saturate"),I=zn("scale"),M=zn("sepia"),j=zn("skew"),C=zn("space"),T=zn("translate"),P=function(){return["auto","contain","none"]},A=function(){return["auto","hidden","clip","visible","scroll"]},D=function(){return["auto",un,e]},R=function(){return[un,e]},k=function(){return["",Ji]},U=function(){return["auto",Gc,un]},B=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},K=function(){return["solid","dashed","dotted","double","none"]},ee=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},H=function(){return["start","end","center","between","around","evenly","stretch"]},X=function(){return["","0",un]},O=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},z=function(){return[Gc,ry]},Y=function(){return[Gc,un]};return{cacheSize:500,theme:{colors:[Cf],spacing:[Ji],blur:["none","",Ba,un],brightness:z(),borderColor:[t],borderRadius:["none","","full",Ba,un],borderSpacing:R(),borderWidth:k(),contrast:z(),grayscale:X(),hueRotate:Y(),invert:X(),gap:R(),gradientColorStops:[t],gradientColorStopPositions:[NX,RE],inset:D(),margin:D(),opacity:z(),padding:R(),saturate:z(),scale:z(),sepia:X(),skew:Y(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",un]}],container:["container"],columns:[{columns:[Ba]}],"break-after":[{"break-after":O()}],"break-before":[{"break-before":O()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(B(),[un])}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ef]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",un]}],grow:[{grow:X()}],shrink:[{shrink:X()}],order:[{order:["first","last","none",Ef]}],"grid-cols":[{"grid-cols":[Cf]}],"col-start-end":[{col:["auto",{span:["full",Ef]},un]}],"col-start":[{"col-start":U()}],"col-end":[{"col-end":U()}],"grid-rows":[{"grid-rows":[Cf]}],"row-start-end":[{row:["auto",{span:[Ef]},un]}],"row-start":[{"row-start":U()}],"row-end":[{"row-end":U()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",un]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",un]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal"].concat(H())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(H(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(H(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[E]}],mx:[{mx:[E]}],my:[{my:[E]}],ms:[{ms:[E]}],me:[{me:[E]}],mt:[{mt:[E]}],mr:[{mr:[E]}],mb:[{mb:[E]}],ml:[{ml:[E]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",un,e]}],"min-w":[{"min-w":["min","max","fit",un,Ji]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Ba]},Ba,un]}],h:[{h:[un,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",un,Ji]}],"max-h":[{"max-h":[un,e,"min","max","fit"]}],"font-size":[{text:["base",Ba,RE]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ry]}],"font-family":[{font:[Cf]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",un]}],"line-clamp":[{"line-clamp":["none",Gc,ry]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",un,Ji]}],"list-image":[{"list-image":["none",un]}],"list-style-type":[{list:["none","disc","decimal",un]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(K(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Ji]}],"underline-offset":[{"underline-offset":["auto",un,Ji]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",un]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",un]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(B(),[TX])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",CX]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},IX]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[].concat(K(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:K()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(K())}],"outline-offset":[{"outline-offset":[un,Ji]}],"outline-w":[{outline:[Ji]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:k()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[Ji]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Ba,PX]}],"shadow-color":[{shadow:[Cf]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":ee()}],"bg-blend":[{"bg-blend":ee()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Ba,un]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[S]}],sepia:[{sepia:[M]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[M]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",un]}],duration:[{duration:Y()}],ease:[{ease:["linear","in","out","in-out",un]}],delay:[{delay:Y()}],animate:[{animate:["none","spin","ping","pulse","bounce",un]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[I]}],"scale-x":[{"scale-x":[I]}],"scale-y":[{"scale-y":[I]}],rotate:[{rotate:[Ef,un]}],"translate-x":[{"translate-x":[T]}],"translate-y":[{"translate-y":[T]}],"skew-x":[{"skew-x":[j]}],"skew-y":[{"skew-y":[j]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",un]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",un]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",un]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Ji,ry]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var DX=vX(jX);let sy;const MX=new Uint8Array(16);function LX(){if(!sy&&(sy=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!sy))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return sy(MX)}const Hr=[];for(let t=0;t<256;++t)Hr.push((t+256).toString(16).slice(1));function FX(t,e=0){return Hr[t[e+0]]+Hr[t[e+1]]+Hr[t[e+2]]+Hr[t[e+3]]+"-"+Hr[t[e+4]]+Hr[t[e+5]]+"-"+Hr[t[e+6]]+Hr[t[e+7]]+"-"+Hr[t[e+8]]+Hr[t[e+9]]+"-"+Hr[t[e+10]]+Hr[t[e+11]]+Hr[t[e+12]]+Hr[t[e+13]]+Hr[t[e+14]]+Hr[t[e+15]]}const OX=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),yk={randomUUID:OX};function VX(t,e,n){if(yk.randomUUID&&!e&&!t)return yk.randomUUID();t=t||{};const r=t.random||(t.rng||LX)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=r[s];return e}return FX(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let $X,UX;function BX(){return{geminiUrl:$X,vertexUrl:UX}}function zX(t,e,n){var r,s,i;if(!(!((r=t.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=BX();return t.vertexai?(s=o.vertexUrl)!==null&&s!==void 0?s:e:(i=o.geminiUrl)!==null&&i!==void 0?i:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gp{}function $t(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const i=e[s];return i!=null?String(i):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function b(t,e,n){for(let i=0;i<e.length-1;i++){const o=e[i];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in t))if(Array.isArray(n))t[l]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[l])){const c=t[l];if(Array.isArray(n))for(let u=0;u<c.length;u++){const d=c[u];b(d,e.slice(i+1),n[u])}else for(const u of c)b(u,e.slice(i+1),n)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in t||(t[l]=[{}]);const c=t[l];b(c[0],e.slice(i+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],s=t[r];if(s!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===s)return;if(typeof s=="object"&&typeof n=="object"&&s!==null&&n!==null)Object.assign(s,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else t[r]=n}function w(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in t){const i=t[s];return Array.isArray(i)?i.map(o=>w(o,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Jn(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function UV(t,e){const n=Jn(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function BV(t,e){return Array.isArray(e)?e.map(n=>yv(t,n)):[yv(t,e)]}function yv(t,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function GX(t,e){const n=yv(t,e);if(n.mimeType&&n.mimeType.startsWith("image/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function HX(t,e){const n=yv(t,e);if(n.mimeType&&n.mimeType.startsWith("audio/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function xk(t,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function zV(t,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(n=>xk(t,n)):[xk(t,e)]}function kE(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function vk(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function wk(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function Gs(t,e){if(e==null)throw new Error("ContentUnion is required");return kE(e)?e:{role:"user",parts:zV(t,e)}}function GV(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=Gs(t,n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=Gs(t,e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>Gs(t,n)):[Gs(t,e)]}function nc(t,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(vk(e)||wk(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Gs(t,e)]}const n=[],r=[],s=kE(e[0]);for(const i of e){const o=kE(i);if(o!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)n.push(i);else{if(vk(i)||wk(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(i)}}return s||n.push({role:"user",parts:zV(t,r)}),n}function HV(t,e){return e}function WV(t,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function qw(t,e){return e}function Kw(t,e){if(!Array.isArray(e))throw new Error("tool is required and must be an array of Tools");return e}function WX(t,e,n,r=1){const s=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:s?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:s?`${n}/${e}`:e}function rc(t,e){if(typeof e!="string")throw new Error("name must be a string");return WX(t,e,"cachedContents")}function qV(t,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function sc(t,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function qX(t){return t!=null&&typeof t=="object"&&"name"in t}function KX(t){return t!=null&&typeof t=="object"&&"video"in t}function YX(t){return t!=null&&typeof t=="object"&&"uri"in t}function KV(t,e){var n;let r;if(qX(e)&&(r=e.name),!(YX(e)&&(r=e.uri,r===void 0))&&!(KX(e)&&(r=(n=e.video)===null||n===void 0?void 0:n.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const i=r.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${r}`);r=i[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function YV(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function JV(t,e){for(const n of["models","tunedModels","publisherModels"])if(JX(e,n))return e[n];return[]}function JX(t,e){return t!==null&&typeof t=="object"&&e in t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XX(t,e){const n={};if(w(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=w(e,["data"]);r!=null&&b(n,["data"],r);const s=w(e,["mimeType"]);return s!=null&&b(n,["mimeType"],s),n}function QX(t,e){const n={};if(w(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=w(e,["thought"]);r!=null&&b(n,["thought"],r);const s=w(e,["inlineData"]);s!=null&&b(n,["inlineData"],XX(t,s));const i=w(e,["codeExecutionResult"]);i!=null&&b(n,["codeExecutionResult"],i);const o=w(e,["executableCode"]);o!=null&&b(n,["executableCode"],o);const l=w(e,["fileData"]);l!=null&&b(n,["fileData"],l);const c=w(e,["functionCall"]);c!=null&&b(n,["functionCall"],c);const u=w(e,["functionResponse"]);u!=null&&b(n,["functionResponse"],u);const d=w(e,["text"]);return d!=null&&b(n,["text"],d),n}function _k(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>QX(t,o))),b(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&b(n,["role"],s),n}function ZX(){return{}}function eQ(t,e){const n={},r=w(e,["mode"]);r!=null&&b(n,["mode"],r);const s=w(e,["dynamicThreshold"]);return s!=null&&b(n,["dynamicThreshold"],s),n}function tQ(t,e){const n={},r=w(e,["dynamicRetrievalConfig"]);return r!=null&&b(n,["dynamicRetrievalConfig"],eQ(t,r)),n}function nQ(t,e){const n={};if(w(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");w(e,["googleSearch"])!=null&&b(n,["googleSearch"],ZX());const s=w(e,["googleSearchRetrieval"]);if(s!=null&&b(n,["googleSearchRetrieval"],tQ(t,s)),w(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(w(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=w(e,["codeExecution"]);i!=null&&b(n,["codeExecution"],i);const o=w(e,["functionDeclarations"]);return o!=null&&b(n,["functionDeclarations"],o),n}function rQ(t,e){const n={},r=w(e,["mode"]);r!=null&&b(n,["mode"],r);const s=w(e,["allowedFunctionNames"]);return s!=null&&b(n,["allowedFunctionNames"],s),n}function sQ(t,e){const n={},r=w(e,["functionCallingConfig"]);if(r!=null&&b(n,["functionCallingConfig"],rQ(t,r)),w(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}function iQ(t,e,n){const r={},s=w(e,["ttl"]);n!==void 0&&s!=null&&b(n,["ttl"],s);const i=w(e,["expireTime"]);n!==void 0&&i!=null&&b(n,["expireTime"],i);const o=w(e,["displayName"]);n!==void 0&&o!=null&&b(n,["displayName"],o);const l=w(e,["contents"]);if(n!==void 0&&l!=null){let h=nc(t,l);Array.isArray(h)&&(h=h.map(f=>_k(t,f))),b(n,["contents"],h)}const c=w(e,["systemInstruction"]);n!==void 0&&c!=null&&b(n,["systemInstruction"],_k(t,Gs(t,c)));const u=w(e,["tools"]);if(n!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(f=>nQ(t,f))),b(n,["tools"],h)}const d=w(e,["toolConfig"]);return n!==void 0&&d!=null&&b(n,["toolConfig"],sQ(t,d)),r}function oQ(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["model"],UV(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],iQ(t,s,n)),n}function aQ(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["_url","name"],rc(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function lQ(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["_url","name"],rc(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function cQ(t,e,n){const r={},s=w(e,["ttl"]);n!==void 0&&s!=null&&b(n,["ttl"],s);const i=w(e,["expireTime"]);return n!==void 0&&i!=null&&b(n,["expireTime"],i),r}function uQ(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["_url","name"],rc(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],cQ(t,s,n)),n}function dQ(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&b(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);return n!==void 0&&i!=null&&b(n,["_query","pageToken"],i),r}function hQ(t,e){const n={},r=w(e,["config"]);return r!=null&&b(n,["config"],dQ(t,r,n)),n}function fQ(t,e){const n={},r=w(e,["displayName"]);r!=null&&b(n,["displayName"],r);const s=w(e,["data"]);s!=null&&b(n,["data"],s);const i=w(e,["mimeType"]);return i!=null&&b(n,["mimeType"],i),n}function mQ(t,e){const n={},r=w(e,["videoMetadata"]);r!=null&&b(n,["videoMetadata"],r);const s=w(e,["thought"]);s!=null&&b(n,["thought"],s);const i=w(e,["inlineData"]);i!=null&&b(n,["inlineData"],fQ(t,i));const o=w(e,["codeExecutionResult"]);o!=null&&b(n,["codeExecutionResult"],o);const l=w(e,["executableCode"]);l!=null&&b(n,["executableCode"],l);const c=w(e,["fileData"]);c!=null&&b(n,["fileData"],c);const u=w(e,["functionCall"]);u!=null&&b(n,["functionCall"],u);const d=w(e,["functionResponse"]);d!=null&&b(n,["functionResponse"],d);const h=w(e,["text"]);return h!=null&&b(n,["text"],h),n}function bk(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>mQ(t,o))),b(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&b(n,["role"],s),n}function pQ(){return{}}function gQ(t,e){const n={},r=w(e,["mode"]);r!=null&&b(n,["mode"],r);const s=w(e,["dynamicThreshold"]);return s!=null&&b(n,["dynamicThreshold"],s),n}function yQ(t,e){const n={},r=w(e,["dynamicRetrievalConfig"]);return r!=null&&b(n,["dynamicRetrievalConfig"],gQ(t,r)),n}function xQ(){return{}}function vQ(t,e){const n={},r=w(e,["apiKeyString"]);return r!=null&&b(n,["apiKeyString"],r),n}function wQ(t,e){const n={},r=w(e,["apiKeyConfig"]);r!=null&&b(n,["apiKeyConfig"],vQ(t,r));const s=w(e,["authType"]);s!=null&&b(n,["authType"],s);const i=w(e,["googleServiceAccountConfig"]);i!=null&&b(n,["googleServiceAccountConfig"],i);const o=w(e,["httpBasicAuthConfig"]);o!=null&&b(n,["httpBasicAuthConfig"],o);const l=w(e,["oauthConfig"]);l!=null&&b(n,["oauthConfig"],l);const c=w(e,["oidcConfig"]);return c!=null&&b(n,["oidcConfig"],c),n}function _Q(t,e){const n={},r=w(e,["authConfig"]);return r!=null&&b(n,["authConfig"],wQ(t,r)),n}function bQ(t,e){const n={},r=w(e,["retrieval"]);r!=null&&b(n,["retrieval"],r),w(e,["googleSearch"])!=null&&b(n,["googleSearch"],pQ());const i=w(e,["googleSearchRetrieval"]);i!=null&&b(n,["googleSearchRetrieval"],yQ(t,i)),w(e,["enterpriseWebSearch"])!=null&&b(n,["enterpriseWebSearch"],xQ());const l=w(e,["googleMaps"]);l!=null&&b(n,["googleMaps"],_Q(t,l));const c=w(e,["codeExecution"]);c!=null&&b(n,["codeExecution"],c);const u=w(e,["functionDeclarations"]);return u!=null&&b(n,["functionDeclarations"],u),n}function SQ(t,e){const n={},r=w(e,["mode"]);r!=null&&b(n,["mode"],r);const s=w(e,["allowedFunctionNames"]);return s!=null&&b(n,["allowedFunctionNames"],s),n}function EQ(t,e){const n={},r=w(e,["latitude"]);r!=null&&b(n,["latitude"],r);const s=w(e,["longitude"]);return s!=null&&b(n,["longitude"],s),n}function CQ(t,e){const n={},r=w(e,["latLng"]);return r!=null&&b(n,["latLng"],EQ(t,r)),n}function TQ(t,e){const n={},r=w(e,["functionCallingConfig"]);r!=null&&b(n,["functionCallingConfig"],SQ(t,r));const s=w(e,["retrievalConfig"]);return s!=null&&b(n,["retrievalConfig"],CQ(t,s)),n}function IQ(t,e,n){const r={},s=w(e,["ttl"]);n!==void 0&&s!=null&&b(n,["ttl"],s);const i=w(e,["expireTime"]);n!==void 0&&i!=null&&b(n,["expireTime"],i);const o=w(e,["displayName"]);n!==void 0&&o!=null&&b(n,["displayName"],o);const l=w(e,["contents"]);if(n!==void 0&&l!=null){let h=nc(t,l);Array.isArray(h)&&(h=h.map(f=>bk(t,f))),b(n,["contents"],h)}const c=w(e,["systemInstruction"]);n!==void 0&&c!=null&&b(n,["systemInstruction"],bk(t,Gs(t,c)));const u=w(e,["tools"]);if(n!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(f=>bQ(t,f))),b(n,["tools"],h)}const d=w(e,["toolConfig"]);return n!==void 0&&d!=null&&b(n,["toolConfig"],TQ(t,d)),r}function NQ(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["model"],UV(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],IQ(t,s,n)),n}function PQ(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["_url","name"],rc(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function AQ(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["_url","name"],rc(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function RQ(t,e,n){const r={},s=w(e,["ttl"]);n!==void 0&&s!=null&&b(n,["ttl"],s);const i=w(e,["expireTime"]);return n!==void 0&&i!=null&&b(n,["expireTime"],i),r}function kQ(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["_url","name"],rc(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],RQ(t,s,n)),n}function jQ(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&b(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);return n!==void 0&&i!=null&&b(n,["_query","pageToken"],i),r}function DQ(t,e){const n={},r=w(e,["config"]);return r!=null&&b(n,["config"],jQ(t,r,n)),n}function cx(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["name"],r);const s=w(e,["displayName"]);s!=null&&b(n,["displayName"],s);const i=w(e,["model"]);i!=null&&b(n,["model"],i);const o=w(e,["createTime"]);o!=null&&b(n,["createTime"],o);const l=w(e,["updateTime"]);l!=null&&b(n,["updateTime"],l);const c=w(e,["expireTime"]);c!=null&&b(n,["expireTime"],c);const u=w(e,["usageMetadata"]);return u!=null&&b(n,["usageMetadata"],u),n}function MQ(){return{}}function LQ(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&b(n,["nextPageToken"],r);const s=w(e,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>cx(t,o))),b(n,["cachedContents"],i)}return n}function ux(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["name"],r);const s=w(e,["displayName"]);s!=null&&b(n,["displayName"],s);const i=w(e,["model"]);i!=null&&b(n,["model"],i);const o=w(e,["createTime"]);o!=null&&b(n,["createTime"],o);const l=w(e,["updateTime"]);l!=null&&b(n,["updateTime"],l);const c=w(e,["expireTime"]);c!=null&&b(n,["expireTime"],c);const u=w(e,["usageMetadata"]);return u!=null&&b(n,["usageMetadata"],u),n}function FQ(){return{}}function OQ(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&b(n,["nextPageToken"],r);const s=w(e,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>ux(t,o))),b(n,["cachedContents"],i)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var yh;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(yh||(yh={}));class Yw{constructor(e,n,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,s)}init(e,n,r){var s,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(i=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Sk;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Sk||(Sk={}));var Ek;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Ek||(Ek={}));var Ur;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Ur||(Ur={}));var Ck;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Ck||(Ck={}));var Br;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Br||(Br={}));var Tk;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Tk||(Tk={}));var Ik;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Ik||(Ik={}));var ze;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT"})(ze||(ze={}));var Nk;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY"})(Nk||(Nk={}));var Pk;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Pk||(Pk={}));var Ak;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Ak||(Ak={}));var Rk;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(Rk||(Rk={}));var kk;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(kk||(kk={}));var Rn;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Rn||(Rn={}));var jk;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(jk||(jk={}));var jE;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(jE||(jE={}));var Dk;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Dk||(Dk={}));var Mk;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Mk||(Mk={}));var Lk;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Lk||(Lk={}));var Fk;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(Fk||(Fk={}));var Ok;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Ok||(Ok={}));var Vk;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Vk||(Vk={}));var $k;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})($k||($k={}));var Uk;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Uk||(Uk={}));var Bk;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Bk||(Bk={}));var zk;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(zk||(zk={}));var Gk;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Gk||(Gk={}));var Hk;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Hk||(Hk={}));var Wk;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(Wk||(Wk={}));var qk;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(qk||(qk={}));var Kk;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Kk||(Kk={}));var Yk;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Yk||(Yk={}));var Jk;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Jk||(Jk={}));var Xk;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Xk||(Xk={}));class iy{get text(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",d=!1;const h=[];for(const f of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[m,g]of Object.entries(f))m!=="text"&&m!=="thought"&&(g!==null||g!==void 0)&&h.push(m);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;d=!0,u+=f.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?u:void 0}get data(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const d=[];for(const h of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[f,m]of Object.entries(h))f!=="inlineData"&&(m!==null||m!==void 0)&&d.push(f);h.inlineData&&typeof h.inlineData.data=="string"&&(u+=atob(h.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,s,i,o,l,c,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,s,i,o,l,c,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.output}}class Qk{}class Zk{}class VQ{}class $Q{}class ej{}class tj{}class nj{}class UQ{}class rj{}class sj{}class ij{}class BQ{}class DE{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class zQ{}class GQ{}class HQ{get text(){var e,n,r;let s="",i=!1;const o=[];for(const l of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,u]of Object.entries(l))c!=="text"&&c!=="thought"&&u!==null&&o.push(c);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;i=!0,s+=l.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?s:void 0}get data(){var e,n,r;let s="";const i=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(o))l!=="inlineData"&&c!==null&&i.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class WQ extends Gp{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Yw(yh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=NQ(this.apiClient,e);return l=$t("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>ux(this.apiClient,d))}else{const u=oQ(this.apiClient,e);return l=$t("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>cx(this.apiClient,d))}}async get(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=PQ(this.apiClient,e);return l=$t("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>ux(this.apiClient,d))}else{const u=aQ(this.apiClient,e);return l=$t("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>cx(this.apiClient,d))}}async delete(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=AQ(this.apiClient,e);return l=$t("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(()=>{const d=FQ(),h=new sj;return Object.assign(h,d),h})}else{const u=lQ(this.apiClient,e);return l=$t("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=MQ(),h=new sj;return Object.assign(h,d),h})}}async update(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=kQ(this.apiClient,e);return l=$t("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>ux(this.apiClient,d))}else{const u=uQ(this.apiClient,e);return l=$t("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>cx(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=DQ(this.apiClient,e);return l=$t("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=OQ(this.apiClient,d),f=new ij;return Object.assign(f,h),f})}else{const u=hQ(this.apiClient,e);return l=$t("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=LQ(this.apiClient,d),f=new ij;return Object.assign(f,h),f})}}}function oj(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function us(t){return this instanceof us?(this.v=t,this):new us(t)}function xv(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(g){return Promise.resolve(g).then(m,h)}}function l(m,g){r[m]&&(s[m]=function(x){return new Promise(function(E,v){i.push([m,x,E,v])>1||c(m,x)})},g&&(s[m]=g(s[m])))}function c(m,g){try{u(r[m](g))}catch(x){f(i[0][3],x)}}function u(m){m.value instanceof us?Promise.resolve(m.value.v).then(d,h):f(i[0][2],m)}function d(m){c("next",m)}function h(m){c("throw",m)}function f(m,g){m(g),i.shift(),i.length&&c(i[0][0],i[0][1])}}function ME(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof oj=="function"?oj(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(l,c){o=t[i](o),s(l,c,o.done,o.value)})}}function s(i,o,l,c){Promise.resolve(c).then(function(u){i({value:u,done:l})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qQ(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:XV(n)}function XV(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||e.text!==void 0&&e.text==="")return!1;return!0}function KQ(t){if(t.length!==0){if(t[0].role!=="user")throw new Error("History must start with a user turn.");for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function YQ(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0,s=t[0];for(;r<n;)if(t[r].role==="user")s=t[r],r++;else{const i=[];let o=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),o&&!XV(t[r])&&(o=!1),r++;o&&(e.push(s),e.push(...i))}return e}class JQ{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new XQ(this.apiClient,this.modelsModule,e.model,e.config,e.history)}}let XQ=class{constructor(e,n,r,s={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=s,this.history=i,this.sendPromise=Promise.resolve(),KQ(i)}async sendMessage(e){var n;await this.sendPromise;const r=Gs(this.apiClient,e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,o;const c=(o=(i=(await s).candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content,u=c?[c]:[];this.recordHistory(r,u)})(),await this.sendPromise,s}async sendMessageStream(e){var n;await this.sendPromise;const r=Gs(this.apiClient,e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const i=await s;return this.processStreamResponse(i,r)}getHistory(e=!1){return e?YQ(this.history):this.history}processStreamResponse(e,n){var r,s;return xv(this,arguments,function*(){var o,l,c,u;const d=[];try{for(var h=!0,f=ME(e),m;m=yield us(f.next()),o=m.done,!o;h=!0){u=m.value,h=!1;const g=u;if(qQ(g)){const x=(s=(r=g.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content;x!==void 0&&d.push(x)}yield yield us(g)}}catch(g){l={error:g}}finally{try{!h&&!o&&(c=f.return)&&(yield us(c.call(f)))}finally{if(l)throw l.error}}this.recordHistory(n,d)})}recordHistory(e,n){let r=[];n.length>0&&n.every(s=>s.role==="model")?r=n:r.push({role:"model",parts:[]}),this.history.push(e),this.history.push(...r)}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QQ(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&b(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);return n!==void 0&&i!=null&&b(n,["_query","pageToken"],i),r}function ZQ(t,e){const n={},r=w(e,["config"]);return r!=null&&b(n,["config"],QQ(t,r,n)),n}function eZ(t,e){const n={},r=w(e,["details"]);r!=null&&b(n,["details"],r);const s=w(e,["message"]);s!=null&&b(n,["message"],s);const i=w(e,["code"]);return i!=null&&b(n,["code"],i),n}function tZ(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["name"],r);const s=w(e,["displayName"]);s!=null&&b(n,["displayName"],s);const i=w(e,["mimeType"]);i!=null&&b(n,["mimeType"],i);const o=w(e,["sizeBytes"]);o!=null&&b(n,["sizeBytes"],o);const l=w(e,["createTime"]);l!=null&&b(n,["createTime"],l);const c=w(e,["expirationTime"]);c!=null&&b(n,["expirationTime"],c);const u=w(e,["updateTime"]);u!=null&&b(n,["updateTime"],u);const d=w(e,["sha256Hash"]);d!=null&&b(n,["sha256Hash"],d);const h=w(e,["uri"]);h!=null&&b(n,["uri"],h);const f=w(e,["downloadUri"]);f!=null&&b(n,["downloadUri"],f);const m=w(e,["state"]);m!=null&&b(n,["state"],m);const g=w(e,["source"]);g!=null&&b(n,["source"],g);const x=w(e,["videoMetadata"]);x!=null&&b(n,["videoMetadata"],x);const E=w(e,["error"]);return E!=null&&b(n,["error"],eZ(t,E)),n}function nZ(t,e){const n={},r=w(e,["file"]);r!=null&&b(n,["file"],tZ(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function rZ(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["_url","file"],KV(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function sZ(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["_url","file"],KV(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function iZ(t,e){const n={},r=w(e,["details"]);r!=null&&b(n,["details"],r);const s=w(e,["message"]);s!=null&&b(n,["message"],s);const i=w(e,["code"]);return i!=null&&b(n,["code"],i),n}function LE(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["name"],r);const s=w(e,["displayName"]);s!=null&&b(n,["displayName"],s);const i=w(e,["mimeType"]);i!=null&&b(n,["mimeType"],i);const o=w(e,["sizeBytes"]);o!=null&&b(n,["sizeBytes"],o);const l=w(e,["createTime"]);l!=null&&b(n,["createTime"],l);const c=w(e,["expirationTime"]);c!=null&&b(n,["expirationTime"],c);const u=w(e,["updateTime"]);u!=null&&b(n,["updateTime"],u);const d=w(e,["sha256Hash"]);d!=null&&b(n,["sha256Hash"],d);const h=w(e,["uri"]);h!=null&&b(n,["uri"],h);const f=w(e,["downloadUri"]);f!=null&&b(n,["downloadUri"],f);const m=w(e,["state"]);m!=null&&b(n,["state"],m);const g=w(e,["source"]);g!=null&&b(n,["source"],g);const x=w(e,["videoMetadata"]);x!=null&&b(n,["videoMetadata"],x);const E=w(e,["error"]);return E!=null&&b(n,["error"],iZ(t,E)),n}function oZ(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&b(n,["nextPageToken"],r);const s=w(e,["files"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>LE(t,o))),b(n,["files"],i)}return n}function aZ(){return{}}function lZ(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let cZ=class extends Gp{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Yw(yh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>LE(this.apiClient,n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=ZQ(this.apiClient,e);return i=$t("files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=oZ(this.apiClient,c),d=new BQ;return Object.assign(d,u),d})}}async createInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=nZ(this.apiClient,e);return i=$t("upload/v1beta/files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=aZ(),u=new zQ;return Object.assign(u,c),u})}}async get(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=rZ(this.apiClient,e);return i=$t("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>LE(this.apiClient,c))}}async delete(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=sZ(this.apiClient,e);return i=$t("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=lZ(),u=new GQ;return Object.assign(u,c),u})}}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uZ(t,e){const n={};if(w(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=w(e,["data"]);r!=null&&b(n,["data"],r);const s=w(e,["mimeType"]);return s!=null&&b(n,["mimeType"],s),n}function dZ(t,e){const n={},r=w(e,["displayName"]);r!=null&&b(n,["displayName"],r);const s=w(e,["data"]);s!=null&&b(n,["data"],s);const i=w(e,["mimeType"]);return i!=null&&b(n,["mimeType"],i),n}function hZ(t,e){const n={};if(w(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=w(e,["thought"]);r!=null&&b(n,["thought"],r);const s=w(e,["inlineData"]);s!=null&&b(n,["inlineData"],uZ(t,s));const i=w(e,["codeExecutionResult"]);i!=null&&b(n,["codeExecutionResult"],i);const o=w(e,["executableCode"]);o!=null&&b(n,["executableCode"],o);const l=w(e,["fileData"]);l!=null&&b(n,["fileData"],l);const c=w(e,["functionCall"]);c!=null&&b(n,["functionCall"],c);const u=w(e,["functionResponse"]);u!=null&&b(n,["functionResponse"],u);const d=w(e,["text"]);return d!=null&&b(n,["text"],d),n}function fZ(t,e){const n={},r=w(e,["videoMetadata"]);r!=null&&b(n,["videoMetadata"],r);const s=w(e,["thought"]);s!=null&&b(n,["thought"],s);const i=w(e,["inlineData"]);i!=null&&b(n,["inlineData"],dZ(t,i));const o=w(e,["codeExecutionResult"]);o!=null&&b(n,["codeExecutionResult"],o);const l=w(e,["executableCode"]);l!=null&&b(n,["executableCode"],l);const c=w(e,["fileData"]);c!=null&&b(n,["fileData"],c);const u=w(e,["functionCall"]);u!=null&&b(n,["functionCall"],u);const d=w(e,["functionResponse"]);d!=null&&b(n,["functionResponse"],d);const h=w(e,["text"]);return h!=null&&b(n,["text"],h),n}function mZ(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>hZ(t,o))),b(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&b(n,["role"],s),n}function pZ(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>fZ(t,o))),b(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&b(n,["role"],s),n}function gZ(){return{}}function yZ(){return{}}function xZ(t,e){const n={},r=w(e,["mode"]);r!=null&&b(n,["mode"],r);const s=w(e,["dynamicThreshold"]);return s!=null&&b(n,["dynamicThreshold"],s),n}function vZ(t,e){const n={},r=w(e,["mode"]);r!=null&&b(n,["mode"],r);const s=w(e,["dynamicThreshold"]);return s!=null&&b(n,["dynamicThreshold"],s),n}function wZ(t,e){const n={},r=w(e,["dynamicRetrievalConfig"]);return r!=null&&b(n,["dynamicRetrievalConfig"],xZ(t,r)),n}function _Z(t,e){const n={},r=w(e,["dynamicRetrievalConfig"]);return r!=null&&b(n,["dynamicRetrievalConfig"],vZ(t,r)),n}function bZ(){return{}}function SZ(t,e){const n={},r=w(e,["apiKeyString"]);return r!=null&&b(n,["apiKeyString"],r),n}function EZ(t,e){const n={},r=w(e,["apiKeyConfig"]);r!=null&&b(n,["apiKeyConfig"],SZ(t,r));const s=w(e,["authType"]);s!=null&&b(n,["authType"],s);const i=w(e,["googleServiceAccountConfig"]);i!=null&&b(n,["googleServiceAccountConfig"],i);const o=w(e,["httpBasicAuthConfig"]);o!=null&&b(n,["httpBasicAuthConfig"],o);const l=w(e,["oauthConfig"]);l!=null&&b(n,["oauthConfig"],l);const c=w(e,["oidcConfig"]);return c!=null&&b(n,["oidcConfig"],c),n}function CZ(t,e){const n={},r=w(e,["authConfig"]);return r!=null&&b(n,["authConfig"],EZ(t,r)),n}function TZ(t,e){const n={};if(w(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");w(e,["googleSearch"])!=null&&b(n,["googleSearch"],gZ());const s=w(e,["googleSearchRetrieval"]);if(s!=null&&b(n,["googleSearchRetrieval"],wZ(t,s)),w(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(w(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=w(e,["codeExecution"]);i!=null&&b(n,["codeExecution"],i);const o=w(e,["functionDeclarations"]);return o!=null&&b(n,["functionDeclarations"],o),n}function IZ(t,e){const n={},r=w(e,["retrieval"]);r!=null&&b(n,["retrieval"],r),w(e,["googleSearch"])!=null&&b(n,["googleSearch"],yZ());const i=w(e,["googleSearchRetrieval"]);i!=null&&b(n,["googleSearchRetrieval"],_Z(t,i)),w(e,["enterpriseWebSearch"])!=null&&b(n,["enterpriseWebSearch"],bZ());const l=w(e,["googleMaps"]);l!=null&&b(n,["googleMaps"],CZ(t,l));const c=w(e,["codeExecution"]);c!=null&&b(n,["codeExecution"],c);const u=w(e,["functionDeclarations"]);return u!=null&&b(n,["functionDeclarations"],u),n}function NZ(t,e){const n={},r=w(e,["handle"]);if(r!=null&&b(n,["handle"],r),w(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return n}function PZ(t,e){const n={},r=w(e,["handle"]);r!=null&&b(n,["handle"],r);const s=w(e,["transparent"]);return s!=null&&b(n,["transparent"],s),n}function aj(){return{}}function lj(){return{}}function AZ(t,e){const n={},r=w(e,["disabled"]);r!=null&&b(n,["disabled"],r);const s=w(e,["startOfSpeechSensitivity"]);s!=null&&b(n,["startOfSpeechSensitivity"],s);const i=w(e,["endOfSpeechSensitivity"]);i!=null&&b(n,["endOfSpeechSensitivity"],i);const o=w(e,["prefixPaddingMs"]);o!=null&&b(n,["prefixPaddingMs"],o);const l=w(e,["silenceDurationMs"]);return l!=null&&b(n,["silenceDurationMs"],l),n}function RZ(t,e){const n={},r=w(e,["disabled"]);r!=null&&b(n,["disabled"],r);const s=w(e,["startOfSpeechSensitivity"]);s!=null&&b(n,["startOfSpeechSensitivity"],s);const i=w(e,["endOfSpeechSensitivity"]);i!=null&&b(n,["endOfSpeechSensitivity"],i);const o=w(e,["prefixPaddingMs"]);o!=null&&b(n,["prefixPaddingMs"],o);const l=w(e,["silenceDurationMs"]);return l!=null&&b(n,["silenceDurationMs"],l),n}function kZ(t,e){const n={},r=w(e,["automaticActivityDetection"]);r!=null&&b(n,["automaticActivityDetection"],AZ(t,r));const s=w(e,["activityHandling"]);s!=null&&b(n,["activityHandling"],s);const i=w(e,["turnCoverage"]);return i!=null&&b(n,["turnCoverage"],i),n}function jZ(t,e){const n={},r=w(e,["automaticActivityDetection"]);r!=null&&b(n,["automaticActivityDetection"],RZ(t,r));const s=w(e,["activityHandling"]);s!=null&&b(n,["activityHandling"],s);const i=w(e,["turnCoverage"]);return i!=null&&b(n,["turnCoverage"],i),n}function DZ(t,e){const n={},r=w(e,["targetTokens"]);return r!=null&&b(n,["targetTokens"],r),n}function MZ(t,e){const n={},r=w(e,["targetTokens"]);return r!=null&&b(n,["targetTokens"],r),n}function LZ(t,e){const n={},r=w(e,["triggerTokens"]);r!=null&&b(n,["triggerTokens"],r);const s=w(e,["slidingWindow"]);return s!=null&&b(n,["slidingWindow"],DZ(t,s)),n}function FZ(t,e){const n={},r=w(e,["triggerTokens"]);r!=null&&b(n,["triggerTokens"],r);const s=w(e,["slidingWindow"]);return s!=null&&b(n,["slidingWindow"],MZ(t,s)),n}function OZ(t,e,n){const r={},s=w(e,["generationConfig"]);n!==void 0&&s!=null&&b(n,["setup","generationConfig"],s);const i=w(e,["responseModalities"]);n!==void 0&&i!=null&&b(n,["setup","generationConfig","responseModalities"],i);const o=w(e,["temperature"]);n!==void 0&&o!=null&&b(n,["setup","generationConfig","temperature"],o);const l=w(e,["topP"]);n!==void 0&&l!=null&&b(n,["setup","generationConfig","topP"],l);const c=w(e,["topK"]);n!==void 0&&c!=null&&b(n,["setup","generationConfig","topK"],c);const u=w(e,["maxOutputTokens"]);n!==void 0&&u!=null&&b(n,["setup","generationConfig","maxOutputTokens"],u);const d=w(e,["mediaResolution"]);n!==void 0&&d!=null&&b(n,["setup","generationConfig","mediaResolution"],d);const h=w(e,["seed"]);n!==void 0&&h!=null&&b(n,["setup","generationConfig","seed"],h);const f=w(e,["speechConfig"]);n!==void 0&&f!=null&&b(n,["setup","generationConfig","speechConfig"],f);const m=w(e,["systemInstruction"]);n!==void 0&&m!=null&&b(n,["setup","systemInstruction"],mZ(t,Gs(t,m)));const g=w(e,["tools"]);if(n!==void 0&&g!=null){let I=Kw(t,g);Array.isArray(I)&&(I=I.map(M=>TZ(t,qw(t,M)))),b(n,["setup","tools"],I)}const x=w(e,["sessionResumption"]);n!==void 0&&x!=null&&b(n,["setup","sessionResumption"],NZ(t,x));const E=w(e,["inputAudioTranscription"]);n!==void 0&&E!=null&&b(n,["setup","inputAudioTranscription"],aj());const v=w(e,["outputAudioTranscription"]);n!==void 0&&v!=null&&b(n,["setup","outputAudioTranscription"],aj());const _=w(e,["realtimeInputConfig"]);n!==void 0&&_!=null&&b(n,["setup","realtimeInputConfig"],kZ(t,_));const S=w(e,["contextWindowCompression"]);return n!==void 0&&S!=null&&b(n,["setup","contextWindowCompression"],LZ(t,S)),r}function VZ(t,e,n){const r={},s=w(e,["generationConfig"]);n!==void 0&&s!=null&&b(n,["setup","generationConfig"],s);const i=w(e,["responseModalities"]);n!==void 0&&i!=null&&b(n,["setup","generationConfig","responseModalities"],i);const o=w(e,["temperature"]);n!==void 0&&o!=null&&b(n,["setup","generationConfig","temperature"],o);const l=w(e,["topP"]);n!==void 0&&l!=null&&b(n,["setup","generationConfig","topP"],l);const c=w(e,["topK"]);n!==void 0&&c!=null&&b(n,["setup","generationConfig","topK"],c);const u=w(e,["maxOutputTokens"]);n!==void 0&&u!=null&&b(n,["setup","generationConfig","maxOutputTokens"],u);const d=w(e,["mediaResolution"]);n!==void 0&&d!=null&&b(n,["setup","generationConfig","mediaResolution"],d);const h=w(e,["seed"]);n!==void 0&&h!=null&&b(n,["setup","generationConfig","seed"],h);const f=w(e,["speechConfig"]);n!==void 0&&f!=null&&b(n,["setup","generationConfig","speechConfig"],f);const m=w(e,["systemInstruction"]);n!==void 0&&m!=null&&b(n,["setup","systemInstruction"],pZ(t,Gs(t,m)));const g=w(e,["tools"]);if(n!==void 0&&g!=null){let I=Kw(t,g);Array.isArray(I)&&(I=I.map(M=>IZ(t,qw(t,M)))),b(n,["setup","tools"],I)}const x=w(e,["sessionResumption"]);n!==void 0&&x!=null&&b(n,["setup","sessionResumption"],PZ(t,x));const E=w(e,["inputAudioTranscription"]);n!==void 0&&E!=null&&b(n,["setup","inputAudioTranscription"],lj());const v=w(e,["outputAudioTranscription"]);n!==void 0&&v!=null&&b(n,["setup","outputAudioTranscription"],lj());const _=w(e,["realtimeInputConfig"]);n!==void 0&&_!=null&&b(n,["setup","realtimeInputConfig"],jZ(t,_));const S=w(e,["contextWindowCompression"]);return n!==void 0&&S!=null&&b(n,["setup","contextWindowCompression"],FZ(t,S)),r}function $Z(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["setup","model"],Jn(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],OZ(t,s,n)),n}function UZ(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["setup","model"],Jn(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],VZ(t,s,n)),n}function BZ(){return{}}function zZ(){return{}}function GZ(){return{}}function HZ(){return{}}function WZ(t,e){const n={},r=w(e,["media"]);r!=null&&b(n,["mediaChunks"],BV(t,r));const s=w(e,["audio"]);s!=null&&b(n,["audio"],HX(t,s));const i=w(e,["audioStreamEnd"]);i!=null&&b(n,["audioStreamEnd"],i);const o=w(e,["video"]);o!=null&&b(n,["video"],GX(t,o));const l=w(e,["text"]);return l!=null&&b(n,["text"],l),w(e,["activityStart"])!=null&&b(n,["activityStart"],BZ()),w(e,["activityEnd"])!=null&&b(n,["activityEnd"],GZ()),n}function qZ(t,e){const n={},r=w(e,["media"]);if(r!=null&&b(n,["mediaChunks"],BV(t,r)),w(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const s=w(e,["audioStreamEnd"]);if(s!=null&&b(n,["audioStreamEnd"],s),w(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(w(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return w(e,["activityStart"])!=null&&b(n,["activityStart"],zZ()),w(e,["activityEnd"])!=null&&b(n,["activityEnd"],HZ()),n}function KZ(){return{}}function YZ(){return{}}function JZ(t,e){const n={},r=w(e,["data"]);r!=null&&b(n,["data"],r);const s=w(e,["mimeType"]);return s!=null&&b(n,["mimeType"],s),n}function XZ(t,e){const n={},r=w(e,["displayName"]);r!=null&&b(n,["displayName"],r);const s=w(e,["data"]);s!=null&&b(n,["data"],s);const i=w(e,["mimeType"]);return i!=null&&b(n,["mimeType"],i),n}function QZ(t,e){const n={},r=w(e,["thought"]);r!=null&&b(n,["thought"],r);const s=w(e,["inlineData"]);s!=null&&b(n,["inlineData"],JZ(t,s));const i=w(e,["codeExecutionResult"]);i!=null&&b(n,["codeExecutionResult"],i);const o=w(e,["executableCode"]);o!=null&&b(n,["executableCode"],o);const l=w(e,["fileData"]);l!=null&&b(n,["fileData"],l);const c=w(e,["functionCall"]);c!=null&&b(n,["functionCall"],c);const u=w(e,["functionResponse"]);u!=null&&b(n,["functionResponse"],u);const d=w(e,["text"]);return d!=null&&b(n,["text"],d),n}function ZZ(t,e){const n={},r=w(e,["videoMetadata"]);r!=null&&b(n,["videoMetadata"],r);const s=w(e,["thought"]);s!=null&&b(n,["thought"],s);const i=w(e,["inlineData"]);i!=null&&b(n,["inlineData"],XZ(t,i));const o=w(e,["codeExecutionResult"]);o!=null&&b(n,["codeExecutionResult"],o);const l=w(e,["executableCode"]);l!=null&&b(n,["executableCode"],l);const c=w(e,["fileData"]);c!=null&&b(n,["fileData"],c);const u=w(e,["functionCall"]);u!=null&&b(n,["functionCall"],u);const d=w(e,["functionResponse"]);d!=null&&b(n,["functionResponse"],d);const h=w(e,["text"]);return h!=null&&b(n,["text"],h),n}function eee(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>QZ(t,o))),b(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&b(n,["role"],s),n}function tee(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>ZZ(t,o))),b(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&b(n,["role"],s),n}function cj(t,e){const n={},r=w(e,["text"]);r!=null&&b(n,["text"],r);const s=w(e,["finished"]);return s!=null&&b(n,["finished"],s),n}function uj(t,e){const n={},r=w(e,["text"]);r!=null&&b(n,["text"],r);const s=w(e,["finished"]);return s!=null&&b(n,["finished"],s),n}function nee(t,e){const n={},r=w(e,["modelTurn"]);r!=null&&b(n,["modelTurn"],eee(t,r));const s=w(e,["turnComplete"]);s!=null&&b(n,["turnComplete"],s);const i=w(e,["interrupted"]);i!=null&&b(n,["interrupted"],i);const o=w(e,["groundingMetadata"]);o!=null&&b(n,["groundingMetadata"],o);const l=w(e,["generationComplete"]);l!=null&&b(n,["generationComplete"],l);const c=w(e,["inputTranscription"]);c!=null&&b(n,["inputTranscription"],cj(t,c));const u=w(e,["outputTranscription"]);return u!=null&&b(n,["outputTranscription"],cj(t,u)),n}function ree(t,e){const n={},r=w(e,["modelTurn"]);r!=null&&b(n,["modelTurn"],tee(t,r));const s=w(e,["turnComplete"]);s!=null&&b(n,["turnComplete"],s);const i=w(e,["interrupted"]);i!=null&&b(n,["interrupted"],i);const o=w(e,["groundingMetadata"]);o!=null&&b(n,["groundingMetadata"],o);const l=w(e,["generationComplete"]);l!=null&&b(n,["generationComplete"],l);const c=w(e,["inputTranscription"]);c!=null&&b(n,["inputTranscription"],uj(t,c));const u=w(e,["outputTranscription"]);return u!=null&&b(n,["outputTranscription"],uj(t,u)),n}function see(t,e){const n={},r=w(e,["id"]);r!=null&&b(n,["id"],r);const s=w(e,["args"]);s!=null&&b(n,["args"],s);const i=w(e,["name"]);return i!=null&&b(n,["name"],i),n}function iee(t,e){const n={},r=w(e,["args"]);r!=null&&b(n,["args"],r);const s=w(e,["name"]);return s!=null&&b(n,["name"],s),n}function oee(t,e){const n={},r=w(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>see(t,i))),b(n,["functionCalls"],s)}return n}function aee(t,e){const n={},r=w(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>iee(t,i))),b(n,["functionCalls"],s)}return n}function lee(t,e){const n={},r=w(e,["ids"]);return r!=null&&b(n,["ids"],r),n}function cee(t,e){const n={},r=w(e,["ids"]);return r!=null&&b(n,["ids"],r),n}function oy(t,e){const n={},r=w(e,["modality"]);r!=null&&b(n,["modality"],r);const s=w(e,["tokenCount"]);return s!=null&&b(n,["tokenCount"],s),n}function ay(t,e){const n={},r=w(e,["modality"]);r!=null&&b(n,["modality"],r);const s=w(e,["tokenCount"]);return s!=null&&b(n,["tokenCount"],s),n}function uee(t,e){const n={},r=w(e,["promptTokenCount"]);r!=null&&b(n,["promptTokenCount"],r);const s=w(e,["cachedContentTokenCount"]);s!=null&&b(n,["cachedContentTokenCount"],s);const i=w(e,["responseTokenCount"]);i!=null&&b(n,["responseTokenCount"],i);const o=w(e,["toolUsePromptTokenCount"]);o!=null&&b(n,["toolUsePromptTokenCount"],o);const l=w(e,["thoughtsTokenCount"]);l!=null&&b(n,["thoughtsTokenCount"],l);const c=w(e,["totalTokenCount"]);c!=null&&b(n,["totalTokenCount"],c);const u=w(e,["promptTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(g=>oy(t,g))),b(n,["promptTokensDetails"],m)}const d=w(e,["cacheTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(g=>oy(t,g))),b(n,["cacheTokensDetails"],m)}const h=w(e,["responseTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>oy(t,g))),b(n,["responseTokensDetails"],m)}const f=w(e,["toolUsePromptTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>oy(t,g))),b(n,["toolUsePromptTokensDetails"],m)}return n}function dee(t,e){const n={},r=w(e,["promptTokenCount"]);r!=null&&b(n,["promptTokenCount"],r);const s=w(e,["cachedContentTokenCount"]);s!=null&&b(n,["cachedContentTokenCount"],s);const i=w(e,["candidatesTokenCount"]);i!=null&&b(n,["responseTokenCount"],i);const o=w(e,["toolUsePromptTokenCount"]);o!=null&&b(n,["toolUsePromptTokenCount"],o);const l=w(e,["thoughtsTokenCount"]);l!=null&&b(n,["thoughtsTokenCount"],l);const c=w(e,["totalTokenCount"]);c!=null&&b(n,["totalTokenCount"],c);const u=w(e,["promptTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(x=>ay(t,x))),b(n,["promptTokensDetails"],g)}const d=w(e,["cacheTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(x=>ay(t,x))),b(n,["cacheTokensDetails"],g)}const h=w(e,["candidatesTokensDetails"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(x=>ay(t,x))),b(n,["responseTokensDetails"],g)}const f=w(e,["toolUsePromptTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(x=>ay(t,x))),b(n,["toolUsePromptTokensDetails"],g)}const m=w(e,["trafficType"]);return m!=null&&b(n,["trafficType"],m),n}function hee(t,e){const n={},r=w(e,["timeLeft"]);return r!=null&&b(n,["timeLeft"],r),n}function fee(t,e){const n={},r=w(e,["timeLeft"]);return r!=null&&b(n,["timeLeft"],r),n}function mee(t,e){const n={},r=w(e,["newHandle"]);r!=null&&b(n,["newHandle"],r);const s=w(e,["resumable"]);s!=null&&b(n,["resumable"],s);const i=w(e,["lastConsumedClientMessageIndex"]);return i!=null&&b(n,["lastConsumedClientMessageIndex"],i),n}function pee(t,e){const n={},r=w(e,["newHandle"]);r!=null&&b(n,["newHandle"],r);const s=w(e,["resumable"]);s!=null&&b(n,["resumable"],s);const i=w(e,["lastConsumedClientMessageIndex"]);return i!=null&&b(n,["lastConsumedClientMessageIndex"],i),n}function gee(t,e){const n={};w(e,["setupComplete"])!=null&&b(n,["setupComplete"],KZ());const s=w(e,["serverContent"]);s!=null&&b(n,["serverContent"],nee(t,s));const i=w(e,["toolCall"]);i!=null&&b(n,["toolCall"],oee(t,i));const o=w(e,["toolCallCancellation"]);o!=null&&b(n,["toolCallCancellation"],lee(t,o));const l=w(e,["usageMetadata"]);l!=null&&b(n,["usageMetadata"],uee(t,l));const c=w(e,["goAway"]);c!=null&&b(n,["goAway"],hee(t,c));const u=w(e,["sessionResumptionUpdate"]);return u!=null&&b(n,["sessionResumptionUpdate"],mee(t,u)),n}function yee(t,e){const n={};w(e,["setupComplete"])!=null&&b(n,["setupComplete"],YZ());const s=w(e,["serverContent"]);s!=null&&b(n,["serverContent"],ree(t,s));const i=w(e,["toolCall"]);i!=null&&b(n,["toolCall"],aee(t,i));const o=w(e,["toolCallCancellation"]);o!=null&&b(n,["toolCallCancellation"],cee(t,o));const l=w(e,["usageMetadata"]);l!=null&&b(n,["usageMetadata"],dee(t,l));const c=w(e,["goAway"]);c!=null&&b(n,["goAway"],fee(t,c));const u=w(e,["sessionResumptionUpdate"]);return u!=null&&b(n,["sessionResumptionUpdate"],pee(t,u)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xee(t,e){const n={};if(w(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=w(e,["data"]);r!=null&&b(n,["data"],r);const s=w(e,["mimeType"]);return s!=null&&b(n,["mimeType"],s),n}function vee(t,e){const n={};if(w(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=w(e,["thought"]);r!=null&&b(n,["thought"],r);const s=w(e,["inlineData"]);s!=null&&b(n,["inlineData"],xee(t,s));const i=w(e,["codeExecutionResult"]);i!=null&&b(n,["codeExecutionResult"],i);const o=w(e,["executableCode"]);o!=null&&b(n,["executableCode"],o);const l=w(e,["fileData"]);l!=null&&b(n,["fileData"],l);const c=w(e,["functionCall"]);c!=null&&b(n,["functionCall"],c);const u=w(e,["functionResponse"]);u!=null&&b(n,["functionResponse"],u);const d=w(e,["text"]);return d!=null&&b(n,["text"],d),n}function Jw(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>vee(t,o))),b(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&b(n,["role"],s),n}function wee(t,e){const n={};if(w(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=w(e,["category"]);r!=null&&b(n,["category"],r);const s=w(e,["threshold"]);return s!=null&&b(n,["threshold"],s),n}function _ee(){return{}}function bee(t,e){const n={},r=w(e,["mode"]);r!=null&&b(n,["mode"],r);const s=w(e,["dynamicThreshold"]);return s!=null&&b(n,["dynamicThreshold"],s),n}function See(t,e){const n={},r=w(e,["dynamicRetrievalConfig"]);return r!=null&&b(n,["dynamicRetrievalConfig"],bee(t,r)),n}function Eee(t,e){const n={};if(w(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");w(e,["googleSearch"])!=null&&b(n,["googleSearch"],_ee());const s=w(e,["googleSearchRetrieval"]);if(s!=null&&b(n,["googleSearchRetrieval"],See(t,s)),w(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(w(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=w(e,["codeExecution"]);i!=null&&b(n,["codeExecution"],i);const o=w(e,["functionDeclarations"]);return o!=null&&b(n,["functionDeclarations"],o),n}function Cee(t,e){const n={},r=w(e,["mode"]);r!=null&&b(n,["mode"],r);const s=w(e,["allowedFunctionNames"]);return s!=null&&b(n,["allowedFunctionNames"],s),n}function Tee(t,e){const n={},r=w(e,["functionCallingConfig"]);if(r!=null&&b(n,["functionCallingConfig"],Cee(t,r)),w(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}function Iee(t,e){const n={},r=w(e,["voiceName"]);return r!=null&&b(n,["voiceName"],r),n}function Nee(t,e){const n={},r=w(e,["prebuiltVoiceConfig"]);return r!=null&&b(n,["prebuiltVoiceConfig"],Iee(t,r)),n}function Pee(t,e){const n={},r=w(e,["voiceConfig"]);r!=null&&b(n,["voiceConfig"],Nee(t,r));const s=w(e,["languageCode"]);return s!=null&&b(n,["languageCode"],s),n}function Aee(t,e){const n={},r=w(e,["includeThoughts"]);r!=null&&b(n,["includeThoughts"],r);const s=w(e,["thinkingBudget"]);return s!=null&&b(n,["thinkingBudget"],s),n}function Ree(t,e,n){const r={},s=w(e,["systemInstruction"]);n!==void 0&&s!=null&&b(n,["systemInstruction"],Jw(t,Gs(t,s)));const i=w(e,["temperature"]);i!=null&&b(r,["temperature"],i);const o=w(e,["topP"]);o!=null&&b(r,["topP"],o);const l=w(e,["topK"]);l!=null&&b(r,["topK"],l);const c=w(e,["candidateCount"]);c!=null&&b(r,["candidateCount"],c);const u=w(e,["maxOutputTokens"]);u!=null&&b(r,["maxOutputTokens"],u);const d=w(e,["stopSequences"]);d!=null&&b(r,["stopSequences"],d);const h=w(e,["responseLogprobs"]);h!=null&&b(r,["responseLogprobs"],h);const f=w(e,["logprobs"]);f!=null&&b(r,["logprobs"],f);const m=w(e,["presencePenalty"]);m!=null&&b(r,["presencePenalty"],m);const g=w(e,["frequencyPenalty"]);g!=null&&b(r,["frequencyPenalty"],g);const x=w(e,["seed"]);x!=null&&b(r,["seed"],x);const E=w(e,["responseMimeType"]);E!=null&&b(r,["responseMimeType"],E);const v=w(e,["responseSchema"]);if(v!=null&&b(r,["responseSchema"],HV(t,v)),w(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(w(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=w(e,["safetySettings"]);if(n!==void 0&&_!=null){let A=_;Array.isArray(A)&&(A=A.map(D=>wee(t,D))),b(n,["safetySettings"],A)}const S=w(e,["tools"]);if(n!==void 0&&S!=null){let A=Kw(t,S);Array.isArray(A)&&(A=A.map(D=>Eee(t,qw(t,D)))),b(n,["tools"],A)}const I=w(e,["toolConfig"]);if(n!==void 0&&I!=null&&b(n,["toolConfig"],Tee(t,I)),w(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=w(e,["cachedContent"]);n!==void 0&&M!=null&&b(n,["cachedContent"],rc(t,M));const j=w(e,["responseModalities"]);j!=null&&b(r,["responseModalities"],j);const C=w(e,["mediaResolution"]);C!=null&&b(r,["mediaResolution"],C);const T=w(e,["speechConfig"]);if(T!=null&&b(r,["speechConfig"],Pee(t,WV(t,T))),w(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=w(e,["thinkingConfig"]);return P!=null&&b(r,["thinkingConfig"],Aee(t,P)),r}function dj(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["contents"]);if(s!=null){let o=nc(t,s);Array.isArray(o)&&(o=o.map(l=>Jw(t,l))),b(n,["contents"],o)}const i=w(e,["config"]);return i!=null&&b(n,["generationConfig"],Ree(t,i,n)),n}function kee(t,e,n){const r={},s=w(e,["taskType"]);n!==void 0&&s!=null&&b(n,["requests[]","taskType"],s);const i=w(e,["title"]);n!==void 0&&i!=null&&b(n,["requests[]","title"],i);const o=w(e,["outputDimensionality"]);if(n!==void 0&&o!=null&&b(n,["requests[]","outputDimensionality"],o),w(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(w(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function jee(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["contents"]);s!=null&&b(n,["requests[]","content"],GV(t,s));const i=w(e,["config"]);i!=null&&b(n,["config"],kee(t,i,n));const o=w(e,["model"]);return o!==void 0&&b(n,["requests[]","model"],Jn(t,o)),n}function Dee(t,e,n){const r={};if(w(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(w(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=w(e,["numberOfImages"]);n!==void 0&&s!=null&&b(n,["parameters","sampleCount"],s);const i=w(e,["aspectRatio"]);n!==void 0&&i!=null&&b(n,["parameters","aspectRatio"],i);const o=w(e,["guidanceScale"]);if(n!==void 0&&o!=null&&b(n,["parameters","guidanceScale"],o),w(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=w(e,["safetyFilterLevel"]);n!==void 0&&l!=null&&b(n,["parameters","safetySetting"],l);const c=w(e,["personGeneration"]);n!==void 0&&c!=null&&b(n,["parameters","personGeneration"],c);const u=w(e,["includeSafetyAttributes"]);n!==void 0&&u!=null&&b(n,["parameters","includeSafetyAttributes"],u);const d=w(e,["includeRaiReason"]);n!==void 0&&d!=null&&b(n,["parameters","includeRaiReason"],d);const h=w(e,["language"]);n!==void 0&&h!=null&&b(n,["parameters","language"],h);const f=w(e,["outputMimeType"]);n!==void 0&&f!=null&&b(n,["parameters","outputOptions","mimeType"],f);const m=w(e,["outputCompressionQuality"]);if(n!==void 0&&m!=null&&b(n,["parameters","outputOptions","compressionQuality"],m),w(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(w(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function Mee(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["prompt"]);s!=null&&b(n,["instances[0]","prompt"],s);const i=w(e,["config"]);return i!=null&&b(n,["config"],Dee(t,i,n)),n}function Lee(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","name"],Jn(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function Fee(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&b(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);n!==void 0&&i!=null&&b(n,["_query","pageToken"],i);const o=w(e,["filter"]);n!==void 0&&o!=null&&b(n,["_query","filter"],o);const l=w(e,["queryBase"]);return n!==void 0&&l!=null&&b(n,["_url","models_url"],YV(t,l)),r}function Oee(t,e){const n={},r=w(e,["config"]);return r!=null&&b(n,["config"],Fee(t,r,n)),n}function Vee(t,e,n){const r={},s=w(e,["displayName"]);n!==void 0&&s!=null&&b(n,["displayName"],s);const i=w(e,["description"]);n!==void 0&&i!=null&&b(n,["description"],i);const o=w(e,["defaultCheckpointId"]);return n!==void 0&&o!=null&&b(n,["defaultCheckpointId"],o),r}function $ee(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","name"],Jn(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],Vee(t,s,n)),n}function Uee(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","name"],Jn(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function Bee(t,e){const n={};if(w(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(w(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(w(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return n}function zee(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["contents"]);if(s!=null){let o=nc(t,s);Array.isArray(o)&&(o=o.map(l=>Jw(t,l))),b(n,["contents"],o)}const i=w(e,["config"]);return i!=null&&b(n,["config"],Bee(t,i)),n}function Gee(t,e){const n={};if(w(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=w(e,["imageBytes"]);r!=null&&b(n,["bytesBase64Encoded"],sc(t,r));const s=w(e,["mimeType"]);return s!=null&&b(n,["mimeType"],s),n}function Hee(t,e,n){const r={},s=w(e,["numberOfVideos"]);if(n!==void 0&&s!=null&&b(n,["parameters","sampleCount"],s),w(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(w(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=w(e,["durationSeconds"]);if(n!==void 0&&i!=null&&b(n,["parameters","durationSeconds"],i),w(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=w(e,["aspectRatio"]);if(n!==void 0&&o!=null&&b(n,["parameters","aspectRatio"],o),w(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=w(e,["personGeneration"]);if(n!==void 0&&l!=null&&b(n,["parameters","personGeneration"],l),w(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=w(e,["negativePrompt"]);if(n!==void 0&&c!=null&&b(n,["parameters","negativePrompt"],c),w(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function Wee(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["prompt"]);s!=null&&b(n,["instances[0]","prompt"],s);const i=w(e,["image"]);i!=null&&b(n,["instances[0]","image"],Gee(t,i));const o=w(e,["config"]);return o!=null&&b(n,["config"],Hee(t,o,n)),n}function qee(t,e){const n={},r=w(e,["displayName"]);r!=null&&b(n,["displayName"],r);const s=w(e,["data"]);s!=null&&b(n,["data"],s);const i=w(e,["mimeType"]);return i!=null&&b(n,["mimeType"],i),n}function Kee(t,e){const n={},r=w(e,["videoMetadata"]);r!=null&&b(n,["videoMetadata"],r);const s=w(e,["thought"]);s!=null&&b(n,["thought"],s);const i=w(e,["inlineData"]);i!=null&&b(n,["inlineData"],qee(t,i));const o=w(e,["codeExecutionResult"]);o!=null&&b(n,["codeExecutionResult"],o);const l=w(e,["executableCode"]);l!=null&&b(n,["executableCode"],l);const c=w(e,["fileData"]);c!=null&&b(n,["fileData"],c);const u=w(e,["functionCall"]);u!=null&&b(n,["functionCall"],u);const d=w(e,["functionResponse"]);d!=null&&b(n,["functionResponse"],d);const h=w(e,["text"]);return h!=null&&b(n,["text"],h),n}function Hh(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Kee(t,o))),b(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&b(n,["role"],s),n}function Yee(t,e){const n={},r=w(e,["featureSelectionPreference"]);return r!=null&&b(n,["featureSelectionPreference"],r),n}function Jee(t,e){const n={},r=w(e,["method"]);r!=null&&b(n,["method"],r);const s=w(e,["category"]);s!=null&&b(n,["category"],s);const i=w(e,["threshold"]);return i!=null&&b(n,["threshold"],i),n}function Xee(){return{}}function Qee(t,e){const n={},r=w(e,["mode"]);r!=null&&b(n,["mode"],r);const s=w(e,["dynamicThreshold"]);return s!=null&&b(n,["dynamicThreshold"],s),n}function Zee(t,e){const n={},r=w(e,["dynamicRetrievalConfig"]);return r!=null&&b(n,["dynamicRetrievalConfig"],Qee(t,r)),n}function ete(){return{}}function tte(t,e){const n={},r=w(e,["apiKeyString"]);return r!=null&&b(n,["apiKeyString"],r),n}function nte(t,e){const n={},r=w(e,["apiKeyConfig"]);r!=null&&b(n,["apiKeyConfig"],tte(t,r));const s=w(e,["authType"]);s!=null&&b(n,["authType"],s);const i=w(e,["googleServiceAccountConfig"]);i!=null&&b(n,["googleServiceAccountConfig"],i);const o=w(e,["httpBasicAuthConfig"]);o!=null&&b(n,["httpBasicAuthConfig"],o);const l=w(e,["oauthConfig"]);l!=null&&b(n,["oauthConfig"],l);const c=w(e,["oidcConfig"]);return c!=null&&b(n,["oidcConfig"],c),n}function rte(t,e){const n={},r=w(e,["authConfig"]);return r!=null&&b(n,["authConfig"],nte(t,r)),n}function QV(t,e){const n={},r=w(e,["retrieval"]);r!=null&&b(n,["retrieval"],r),w(e,["googleSearch"])!=null&&b(n,["googleSearch"],Xee());const i=w(e,["googleSearchRetrieval"]);i!=null&&b(n,["googleSearchRetrieval"],Zee(t,i)),w(e,["enterpriseWebSearch"])!=null&&b(n,["enterpriseWebSearch"],ete());const l=w(e,["googleMaps"]);l!=null&&b(n,["googleMaps"],rte(t,l));const c=w(e,["codeExecution"]);c!=null&&b(n,["codeExecution"],c);const u=w(e,["functionDeclarations"]);return u!=null&&b(n,["functionDeclarations"],u),n}function ste(t,e){const n={},r=w(e,["mode"]);r!=null&&b(n,["mode"],r);const s=w(e,["allowedFunctionNames"]);return s!=null&&b(n,["allowedFunctionNames"],s),n}function ite(t,e){const n={},r=w(e,["latitude"]);r!=null&&b(n,["latitude"],r);const s=w(e,["longitude"]);return s!=null&&b(n,["longitude"],s),n}function ote(t,e){const n={},r=w(e,["latLng"]);return r!=null&&b(n,["latLng"],ite(t,r)),n}function ate(t,e){const n={},r=w(e,["functionCallingConfig"]);r!=null&&b(n,["functionCallingConfig"],ste(t,r));const s=w(e,["retrievalConfig"]);return s!=null&&b(n,["retrievalConfig"],ote(t,s)),n}function lte(t,e){const n={},r=w(e,["voiceName"]);return r!=null&&b(n,["voiceName"],r),n}function cte(t,e){const n={},r=w(e,["prebuiltVoiceConfig"]);return r!=null&&b(n,["prebuiltVoiceConfig"],lte(t,r)),n}function ute(t,e){const n={},r=w(e,["voiceConfig"]);r!=null&&b(n,["voiceConfig"],cte(t,r));const s=w(e,["languageCode"]);return s!=null&&b(n,["languageCode"],s),n}function dte(t,e){const n={},r=w(e,["includeThoughts"]);r!=null&&b(n,["includeThoughts"],r);const s=w(e,["thinkingBudget"]);return s!=null&&b(n,["thinkingBudget"],s),n}function hte(t,e,n){const r={},s=w(e,["systemInstruction"]);n!==void 0&&s!=null&&b(n,["systemInstruction"],Hh(t,Gs(t,s)));const i=w(e,["temperature"]);i!=null&&b(r,["temperature"],i);const o=w(e,["topP"]);o!=null&&b(r,["topP"],o);const l=w(e,["topK"]);l!=null&&b(r,["topK"],l);const c=w(e,["candidateCount"]);c!=null&&b(r,["candidateCount"],c);const u=w(e,["maxOutputTokens"]);u!=null&&b(r,["maxOutputTokens"],u);const d=w(e,["stopSequences"]);d!=null&&b(r,["stopSequences"],d);const h=w(e,["responseLogprobs"]);h!=null&&b(r,["responseLogprobs"],h);const f=w(e,["logprobs"]);f!=null&&b(r,["logprobs"],f);const m=w(e,["presencePenalty"]);m!=null&&b(r,["presencePenalty"],m);const g=w(e,["frequencyPenalty"]);g!=null&&b(r,["frequencyPenalty"],g);const x=w(e,["seed"]);x!=null&&b(r,["seed"],x);const E=w(e,["responseMimeType"]);E!=null&&b(r,["responseMimeType"],E);const v=w(e,["responseSchema"]);v!=null&&b(r,["responseSchema"],HV(t,v));const _=w(e,["routingConfig"]);_!=null&&b(r,["routingConfig"],_);const S=w(e,["modelSelectionConfig"]);S!=null&&b(r,["modelConfig"],Yee(t,S));const I=w(e,["safetySettings"]);if(n!==void 0&&I!=null){let U=I;Array.isArray(U)&&(U=U.map(B=>Jee(t,B))),b(n,["safetySettings"],U)}const M=w(e,["tools"]);if(n!==void 0&&M!=null){let U=Kw(t,M);Array.isArray(U)&&(U=U.map(B=>QV(t,qw(t,B)))),b(n,["tools"],U)}const j=w(e,["toolConfig"]);n!==void 0&&j!=null&&b(n,["toolConfig"],ate(t,j));const C=w(e,["labels"]);n!==void 0&&C!=null&&b(n,["labels"],C);const T=w(e,["cachedContent"]);n!==void 0&&T!=null&&b(n,["cachedContent"],rc(t,T));const P=w(e,["responseModalities"]);P!=null&&b(r,["responseModalities"],P);const A=w(e,["mediaResolution"]);A!=null&&b(r,["mediaResolution"],A);const D=w(e,["speechConfig"]);D!=null&&b(r,["speechConfig"],ute(t,WV(t,D)));const R=w(e,["audioTimestamp"]);R!=null&&b(r,["audioTimestamp"],R);const k=w(e,["thinkingConfig"]);return k!=null&&b(r,["thinkingConfig"],dte(t,k)),r}function hj(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["contents"]);if(s!=null){let o=nc(t,s);Array.isArray(o)&&(o=o.map(l=>Hh(t,l))),b(n,["contents"],o)}const i=w(e,["config"]);return i!=null&&b(n,["generationConfig"],hte(t,i,n)),n}function fte(t,e,n){const r={},s=w(e,["taskType"]);n!==void 0&&s!=null&&b(n,["instances[]","task_type"],s);const i=w(e,["title"]);n!==void 0&&i!=null&&b(n,["instances[]","title"],i);const o=w(e,["outputDimensionality"]);n!==void 0&&o!=null&&b(n,["parameters","outputDimensionality"],o);const l=w(e,["mimeType"]);n!==void 0&&l!=null&&b(n,["instances[]","mimeType"],l);const c=w(e,["autoTruncate"]);return n!==void 0&&c!=null&&b(n,["parameters","autoTruncate"],c),r}function mte(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["contents"]);s!=null&&b(n,["instances[]","content"],GV(t,s));const i=w(e,["config"]);return i!=null&&b(n,["config"],fte(t,i,n)),n}function pte(t,e,n){const r={},s=w(e,["outputGcsUri"]);n!==void 0&&s!=null&&b(n,["parameters","storageUri"],s);const i=w(e,["negativePrompt"]);n!==void 0&&i!=null&&b(n,["parameters","negativePrompt"],i);const o=w(e,["numberOfImages"]);n!==void 0&&o!=null&&b(n,["parameters","sampleCount"],o);const l=w(e,["aspectRatio"]);n!==void 0&&l!=null&&b(n,["parameters","aspectRatio"],l);const c=w(e,["guidanceScale"]);n!==void 0&&c!=null&&b(n,["parameters","guidanceScale"],c);const u=w(e,["seed"]);n!==void 0&&u!=null&&b(n,["parameters","seed"],u);const d=w(e,["safetyFilterLevel"]);n!==void 0&&d!=null&&b(n,["parameters","safetySetting"],d);const h=w(e,["personGeneration"]);n!==void 0&&h!=null&&b(n,["parameters","personGeneration"],h);const f=w(e,["includeSafetyAttributes"]);n!==void 0&&f!=null&&b(n,["parameters","includeSafetyAttributes"],f);const m=w(e,["includeRaiReason"]);n!==void 0&&m!=null&&b(n,["parameters","includeRaiReason"],m);const g=w(e,["language"]);n!==void 0&&g!=null&&b(n,["parameters","language"],g);const x=w(e,["outputMimeType"]);n!==void 0&&x!=null&&b(n,["parameters","outputOptions","mimeType"],x);const E=w(e,["outputCompressionQuality"]);n!==void 0&&E!=null&&b(n,["parameters","outputOptions","compressionQuality"],E);const v=w(e,["addWatermark"]);n!==void 0&&v!=null&&b(n,["parameters","addWatermark"],v);const _=w(e,["enhancePrompt"]);return n!==void 0&&_!=null&&b(n,["parameters","enhancePrompt"],_),r}function gte(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["prompt"]);s!=null&&b(n,["instances[0]","prompt"],s);const i=w(e,["config"]);return i!=null&&b(n,["config"],pte(t,i,n)),n}function R1(t,e){const n={},r=w(e,["gcsUri"]);r!=null&&b(n,["gcsUri"],r);const s=w(e,["imageBytes"]);s!=null&&b(n,["bytesBase64Encoded"],sc(t,s));const i=w(e,["mimeType"]);return i!=null&&b(n,["mimeType"],i),n}function yte(t,e){const n={},r=w(e,["maskMode"]);r!=null&&b(n,["maskMode"],r);const s=w(e,["segmentationClasses"]);s!=null&&b(n,["maskClasses"],s);const i=w(e,["maskDilation"]);return i!=null&&b(n,["dilation"],i),n}function xte(t,e){const n={},r=w(e,["controlType"]);r!=null&&b(n,["controlType"],r);const s=w(e,["enableControlImageComputation"]);return s!=null&&b(n,["computeControl"],s),n}function vte(t,e){const n={},r=w(e,["styleDescription"]);return r!=null&&b(n,["styleDescription"],r),n}function wte(t,e){const n={},r=w(e,["subjectType"]);r!=null&&b(n,["subjectType"],r);const s=w(e,["subjectDescription"]);return s!=null&&b(n,["subjectDescription"],s),n}function _te(t,e){const n={},r=w(e,["referenceImage"]);r!=null&&b(n,["referenceImage"],R1(t,r));const s=w(e,["referenceId"]);s!=null&&b(n,["referenceId"],s);const i=w(e,["referenceType"]);i!=null&&b(n,["referenceType"],i);const o=w(e,["maskImageConfig"]);o!=null&&b(n,["maskImageConfig"],yte(t,o));const l=w(e,["controlImageConfig"]);l!=null&&b(n,["controlImageConfig"],xte(t,l));const c=w(e,["styleImageConfig"]);c!=null&&b(n,["styleImageConfig"],vte(t,c));const u=w(e,["subjectImageConfig"]);return u!=null&&b(n,["subjectImageConfig"],wte(t,u)),n}function bte(t,e,n){const r={},s=w(e,["outputGcsUri"]);n!==void 0&&s!=null&&b(n,["parameters","storageUri"],s);const i=w(e,["negativePrompt"]);n!==void 0&&i!=null&&b(n,["parameters","negativePrompt"],i);const o=w(e,["numberOfImages"]);n!==void 0&&o!=null&&b(n,["parameters","sampleCount"],o);const l=w(e,["aspectRatio"]);n!==void 0&&l!=null&&b(n,["parameters","aspectRatio"],l);const c=w(e,["guidanceScale"]);n!==void 0&&c!=null&&b(n,["parameters","guidanceScale"],c);const u=w(e,["seed"]);n!==void 0&&u!=null&&b(n,["parameters","seed"],u);const d=w(e,["safetyFilterLevel"]);n!==void 0&&d!=null&&b(n,["parameters","safetySetting"],d);const h=w(e,["personGeneration"]);n!==void 0&&h!=null&&b(n,["parameters","personGeneration"],h);const f=w(e,["includeSafetyAttributes"]);n!==void 0&&f!=null&&b(n,["parameters","includeSafetyAttributes"],f);const m=w(e,["includeRaiReason"]);n!==void 0&&m!=null&&b(n,["parameters","includeRaiReason"],m);const g=w(e,["language"]);n!==void 0&&g!=null&&b(n,["parameters","language"],g);const x=w(e,["outputMimeType"]);n!==void 0&&x!=null&&b(n,["parameters","outputOptions","mimeType"],x);const E=w(e,["outputCompressionQuality"]);n!==void 0&&E!=null&&b(n,["parameters","outputOptions","compressionQuality"],E);const v=w(e,["editMode"]);n!==void 0&&v!=null&&b(n,["parameters","editMode"],v);const _=w(e,["baseSteps"]);return n!==void 0&&_!=null&&b(n,["parameters","editConfig","baseSteps"],_),r}function Ste(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["prompt"]);s!=null&&b(n,["instances[0]","prompt"],s);const i=w(e,["referenceImages"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>_te(t,c))),b(n,["instances[0]","referenceImages"],l)}const o=w(e,["config"]);return o!=null&&b(n,["config"],bte(t,o,n)),n}function Ete(t,e,n){const r={},s=w(e,["includeRaiReason"]);n!==void 0&&s!=null&&b(n,["parameters","includeRaiReason"],s);const i=w(e,["outputMimeType"]);n!==void 0&&i!=null&&b(n,["parameters","outputOptions","mimeType"],i);const o=w(e,["outputCompressionQuality"]);n!==void 0&&o!=null&&b(n,["parameters","outputOptions","compressionQuality"],o);const l=w(e,["numberOfImages"]);n!==void 0&&l!=null&&b(n,["parameters","sampleCount"],l);const c=w(e,["mode"]);return n!==void 0&&c!=null&&b(n,["parameters","mode"],c),r}function Cte(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["image"]);s!=null&&b(n,["instances[0]","image"],R1(t,s));const i=w(e,["upscaleFactor"]);i!=null&&b(n,["parameters","upscaleConfig","upscaleFactor"],i);const o=w(e,["config"]);return o!=null&&b(n,["config"],Ete(t,o,n)),n}function Tte(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","name"],Jn(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function Ite(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&b(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);n!==void 0&&i!=null&&b(n,["_query","pageToken"],i);const o=w(e,["filter"]);n!==void 0&&o!=null&&b(n,["_query","filter"],o);const l=w(e,["queryBase"]);return n!==void 0&&l!=null&&b(n,["_url","models_url"],YV(t,l)),r}function Nte(t,e){const n={},r=w(e,["config"]);return r!=null&&b(n,["config"],Ite(t,r,n)),n}function Pte(t,e,n){const r={},s=w(e,["displayName"]);n!==void 0&&s!=null&&b(n,["displayName"],s);const i=w(e,["description"]);n!==void 0&&i!=null&&b(n,["description"],i);const o=w(e,["defaultCheckpointId"]);return n!==void 0&&o!=null&&b(n,["defaultCheckpointId"],o),r}function Ate(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],Pte(t,s,n)),n}function Rte(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","name"],Jn(t,r));const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function kte(t,e,n){const r={},s=w(e,["systemInstruction"]);n!==void 0&&s!=null&&b(n,["systemInstruction"],Hh(t,Gs(t,s)));const i=w(e,["tools"]);if(n!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>QV(t,c))),b(n,["tools"],l)}const o=w(e,["generationConfig"]);return n!==void 0&&o!=null&&b(n,["generationConfig"],o),r}function jte(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["contents"]);if(s!=null){let o=nc(t,s);Array.isArray(o)&&(o=o.map(l=>Hh(t,l))),b(n,["contents"],o)}const i=w(e,["config"]);return i!=null&&b(n,["config"],kte(t,i,n)),n}function Dte(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["contents"]);if(s!=null){let o=nc(t,s);Array.isArray(o)&&(o=o.map(l=>Hh(t,l))),b(n,["contents"],o)}const i=w(e,["config"]);return i!=null&&b(n,["config"],i),n}function Mte(t,e,n){const r={},s=w(e,["numberOfVideos"]);n!==void 0&&s!=null&&b(n,["parameters","sampleCount"],s);const i=w(e,["outputGcsUri"]);n!==void 0&&i!=null&&b(n,["parameters","storageUri"],i);const o=w(e,["fps"]);n!==void 0&&o!=null&&b(n,["parameters","fps"],o);const l=w(e,["durationSeconds"]);n!==void 0&&l!=null&&b(n,["parameters","durationSeconds"],l);const c=w(e,["seed"]);n!==void 0&&c!=null&&b(n,["parameters","seed"],c);const u=w(e,["aspectRatio"]);n!==void 0&&u!=null&&b(n,["parameters","aspectRatio"],u);const d=w(e,["resolution"]);n!==void 0&&d!=null&&b(n,["parameters","resolution"],d);const h=w(e,["personGeneration"]);n!==void 0&&h!=null&&b(n,["parameters","personGeneration"],h);const f=w(e,["pubsubTopic"]);n!==void 0&&f!=null&&b(n,["parameters","pubsubTopic"],f);const m=w(e,["negativePrompt"]);n!==void 0&&m!=null&&b(n,["parameters","negativePrompt"],m);const g=w(e,["enhancePrompt"]);return n!==void 0&&g!=null&&b(n,["parameters","enhancePrompt"],g),r}function Lte(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["_url","model"],Jn(t,r));const s=w(e,["prompt"]);s!=null&&b(n,["instances[0]","prompt"],s);const i=w(e,["image"]);i!=null&&b(n,["instances[0]","image"],R1(t,i));const o=w(e,["config"]);return o!=null&&b(n,["config"],Mte(t,o,n)),n}function Fte(t,e){const n={},r=w(e,["data"]);r!=null&&b(n,["data"],r);const s=w(e,["mimeType"]);return s!=null&&b(n,["mimeType"],s),n}function Ote(t,e){const n={},r=w(e,["thought"]);r!=null&&b(n,["thought"],r);const s=w(e,["inlineData"]);s!=null&&b(n,["inlineData"],Fte(t,s));const i=w(e,["codeExecutionResult"]);i!=null&&b(n,["codeExecutionResult"],i);const o=w(e,["executableCode"]);o!=null&&b(n,["executableCode"],o);const l=w(e,["fileData"]);l!=null&&b(n,["fileData"],l);const c=w(e,["functionCall"]);c!=null&&b(n,["functionCall"],c);const u=w(e,["functionResponse"]);u!=null&&b(n,["functionResponse"],u);const d=w(e,["text"]);return d!=null&&b(n,["text"],d),n}function Vte(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Ote(t,o))),b(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&b(n,["role"],s),n}function $te(t,e){const n={},r=w(e,["citationSources"]);return r!=null&&b(n,["citations"],r),n}function Ute(t,e){const n={},r=w(e,["content"]);r!=null&&b(n,["content"],Vte(t,r));const s=w(e,["citationMetadata"]);s!=null&&b(n,["citationMetadata"],$te(t,s));const i=w(e,["tokenCount"]);i!=null&&b(n,["tokenCount"],i);const o=w(e,["finishReason"]);o!=null&&b(n,["finishReason"],o);const l=w(e,["avgLogprobs"]);l!=null&&b(n,["avgLogprobs"],l);const c=w(e,["groundingMetadata"]);c!=null&&b(n,["groundingMetadata"],c);const u=w(e,["index"]);u!=null&&b(n,["index"],u);const d=w(e,["logprobsResult"]);d!=null&&b(n,["logprobsResult"],d);const h=w(e,["safetyRatings"]);return h!=null&&b(n,["safetyRatings"],h),n}function fj(t,e){const n={},r=w(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>Ute(t,c))),b(n,["candidates"],l)}const s=w(e,["modelVersion"]);s!=null&&b(n,["modelVersion"],s);const i=w(e,["promptFeedback"]);i!=null&&b(n,["promptFeedback"],i);const o=w(e,["usageMetadata"]);return o!=null&&b(n,["usageMetadata"],o),n}function Bte(t,e){const n={},r=w(e,["values"]);return r!=null&&b(n,["values"],r),n}function zte(){return{}}function Gte(t,e){const n={},r=w(e,["embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Bte(t,o))),b(n,["embeddings"],i)}return w(e,["metadata"])!=null&&b(n,["metadata"],zte()),n}function Hte(t,e){const n={},r=w(e,["bytesBase64Encoded"]);r!=null&&b(n,["imageBytes"],sc(t,r));const s=w(e,["mimeType"]);return s!=null&&b(n,["mimeType"],s),n}function ZV(t,e){const n={},r=w(e,["safetyAttributes","categories"]);r!=null&&b(n,["categories"],r);const s=w(e,["safetyAttributes","scores"]);s!=null&&b(n,["scores"],s);const i=w(e,["contentType"]);return i!=null&&b(n,["contentType"],i),n}function Wte(t,e){const n={},r=w(e,["_self"]);r!=null&&b(n,["image"],Hte(t,r));const s=w(e,["raiFilteredReason"]);s!=null&&b(n,["raiFilteredReason"],s);const i=w(e,["_self"]);return i!=null&&b(n,["safetyAttributes"],ZV(t,i)),n}function qte(t,e){const n={},r=w(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Wte(t,o))),b(n,["generatedImages"],i)}const s=w(e,["positivePromptSafetyAttributes"]);return s!=null&&b(n,["positivePromptSafetyAttributes"],ZV(t,s)),n}function Kte(t,e){const n={},r=w(e,["baseModel"]);r!=null&&b(n,["baseModel"],r);const s=w(e,["createTime"]);s!=null&&b(n,["createTime"],s);const i=w(e,["updateTime"]);return i!=null&&b(n,["updateTime"],i),n}function FE(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["name"],r);const s=w(e,["displayName"]);s!=null&&b(n,["displayName"],s);const i=w(e,["description"]);i!=null&&b(n,["description"],i);const o=w(e,["version"]);o!=null&&b(n,["version"],o);const l=w(e,["_self"]);l!=null&&b(n,["tunedModelInfo"],Kte(t,l));const c=w(e,["inputTokenLimit"]);c!=null&&b(n,["inputTokenLimit"],c);const u=w(e,["outputTokenLimit"]);u!=null&&b(n,["outputTokenLimit"],u);const d=w(e,["supportedGenerationMethods"]);return d!=null&&b(n,["supportedActions"],d),n}function Yte(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&b(n,["nextPageToken"],r);const s=w(e,["_self"]);if(s!=null){let i=JV(t,s);Array.isArray(i)&&(i=i.map(o=>FE(t,o))),b(n,["models"],i)}return n}function Jte(){return{}}function Xte(t,e){const n={},r=w(e,["totalTokens"]);r!=null&&b(n,["totalTokens"],r);const s=w(e,["cachedContentTokenCount"]);return s!=null&&b(n,["cachedContentTokenCount"],s),n}function Qte(t,e){const n={},r=w(e,["video","uri"]);r!=null&&b(n,["uri"],r);const s=w(e,["video","encodedVideo"]);s!=null&&b(n,["videoBytes"],sc(t,s));const i=w(e,["encoding"]);return i!=null&&b(n,["mimeType"],i),n}function Zte(t,e){const n={},r=w(e,["_self"]);return r!=null&&b(n,["video"],Qte(t,r)),n}function ene(t,e){const n={},r=w(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Zte(t,l))),b(n,["generatedVideos"],o)}const s=w(e,["raiMediaFilteredCount"]);s!=null&&b(n,["raiMediaFilteredCount"],s);const i=w(e,["raiMediaFilteredReasons"]);return i!=null&&b(n,["raiMediaFilteredReasons"],i),n}function tne(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["name"],r);const s=w(e,["metadata"]);s!=null&&b(n,["metadata"],s);const i=w(e,["done"]);i!=null&&b(n,["done"],i);const o=w(e,["error"]);o!=null&&b(n,["error"],o);const l=w(e,["response","generateVideoResponse"]);return l!=null&&b(n,["response"],ene(t,l)),n}function nne(t,e){const n={},r=w(e,["displayName"]);r!=null&&b(n,["displayName"],r);const s=w(e,["data"]);s!=null&&b(n,["data"],s);const i=w(e,["mimeType"]);return i!=null&&b(n,["mimeType"],i),n}function rne(t,e){const n={},r=w(e,["videoMetadata"]);r!=null&&b(n,["videoMetadata"],r);const s=w(e,["thought"]);s!=null&&b(n,["thought"],s);const i=w(e,["inlineData"]);i!=null&&b(n,["inlineData"],nne(t,i));const o=w(e,["codeExecutionResult"]);o!=null&&b(n,["codeExecutionResult"],o);const l=w(e,["executableCode"]);l!=null&&b(n,["executableCode"],l);const c=w(e,["fileData"]);c!=null&&b(n,["fileData"],c);const u=w(e,["functionCall"]);u!=null&&b(n,["functionCall"],u);const d=w(e,["functionResponse"]);d!=null&&b(n,["functionResponse"],d);const h=w(e,["text"]);return h!=null&&b(n,["text"],h),n}function sne(t,e){const n={},r=w(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>rne(t,o))),b(n,["parts"],i)}const s=w(e,["role"]);return s!=null&&b(n,["role"],s),n}function ine(t,e){const n={},r=w(e,["citations"]);return r!=null&&b(n,["citations"],r),n}function one(t,e){const n={},r=w(e,["content"]);r!=null&&b(n,["content"],sne(t,r));const s=w(e,["citationMetadata"]);s!=null&&b(n,["citationMetadata"],ine(t,s));const i=w(e,["finishMessage"]);i!=null&&b(n,["finishMessage"],i);const o=w(e,["finishReason"]);o!=null&&b(n,["finishReason"],o);const l=w(e,["avgLogprobs"]);l!=null&&b(n,["avgLogprobs"],l);const c=w(e,["groundingMetadata"]);c!=null&&b(n,["groundingMetadata"],c);const u=w(e,["index"]);u!=null&&b(n,["index"],u);const d=w(e,["logprobsResult"]);d!=null&&b(n,["logprobsResult"],d);const h=w(e,["safetyRatings"]);return h!=null&&b(n,["safetyRatings"],h),n}function mj(t,e){const n={},r=w(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>one(t,d))),b(n,["candidates"],u)}const s=w(e,["createTime"]);s!=null&&b(n,["createTime"],s);const i=w(e,["responseId"]);i!=null&&b(n,["responseId"],i);const o=w(e,["modelVersion"]);o!=null&&b(n,["modelVersion"],o);const l=w(e,["promptFeedback"]);l!=null&&b(n,["promptFeedback"],l);const c=w(e,["usageMetadata"]);return c!=null&&b(n,["usageMetadata"],c),n}function ane(t,e){const n={},r=w(e,["truncated"]);r!=null&&b(n,["truncated"],r);const s=w(e,["token_count"]);return s!=null&&b(n,["tokenCount"],s),n}function lne(t,e){const n={},r=w(e,["values"]);r!=null&&b(n,["values"],r);const s=w(e,["statistics"]);return s!=null&&b(n,["statistics"],ane(t,s)),n}function cne(t,e){const n={},r=w(e,["billableCharacterCount"]);return r!=null&&b(n,["billableCharacterCount"],r),n}function une(t,e){const n={},r=w(e,["predictions[]","embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>lne(t,o))),b(n,["embeddings"],i)}const s=w(e,["metadata"]);return s!=null&&b(n,["metadata"],cne(t,s)),n}function dne(t,e){const n={},r=w(e,["gcsUri"]);r!=null&&b(n,["gcsUri"],r);const s=w(e,["bytesBase64Encoded"]);s!=null&&b(n,["imageBytes"],sc(t,s));const i=w(e,["mimeType"]);return i!=null&&b(n,["mimeType"],i),n}function e$(t,e){const n={},r=w(e,["safetyAttributes","categories"]);r!=null&&b(n,["categories"],r);const s=w(e,["safetyAttributes","scores"]);s!=null&&b(n,["scores"],s);const i=w(e,["contentType"]);return i!=null&&b(n,["contentType"],i),n}function k1(t,e){const n={},r=w(e,["_self"]);r!=null&&b(n,["image"],dne(t,r));const s=w(e,["raiFilteredReason"]);s!=null&&b(n,["raiFilteredReason"],s);const i=w(e,["_self"]);i!=null&&b(n,["safetyAttributes"],e$(t,i));const o=w(e,["prompt"]);return o!=null&&b(n,["enhancedPrompt"],o),n}function hne(t,e){const n={},r=w(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>k1(t,o))),b(n,["generatedImages"],i)}const s=w(e,["positivePromptSafetyAttributes"]);return s!=null&&b(n,["positivePromptSafetyAttributes"],e$(t,s)),n}function fne(t,e){const n={},r=w(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>k1(t,i))),b(n,["generatedImages"],s)}return n}function mne(t,e){const n={},r=w(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>k1(t,i))),b(n,["generatedImages"],s)}return n}function pne(t,e){const n={},r=w(e,["endpoint"]);r!=null&&b(n,["name"],r);const s=w(e,["deployedModelId"]);return s!=null&&b(n,["deployedModelId"],s),n}function gne(t,e){const n={},r=w(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&b(n,["baseModel"],r);const s=w(e,["createTime"]);s!=null&&b(n,["createTime"],s);const i=w(e,["updateTime"]);return i!=null&&b(n,["updateTime"],i),n}function yne(t,e){const n={},r=w(e,["checkpointId"]);r!=null&&b(n,["checkpointId"],r);const s=w(e,["epoch"]);s!=null&&b(n,["epoch"],s);const i=w(e,["step"]);return i!=null&&b(n,["step"],i),n}function OE(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["name"],r);const s=w(e,["displayName"]);s!=null&&b(n,["displayName"],s);const i=w(e,["description"]);i!=null&&b(n,["description"],i);const o=w(e,["versionId"]);o!=null&&b(n,["version"],o);const l=w(e,["deployedModels"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(m=>pne(t,m))),b(n,["endpoints"],f)}const c=w(e,["labels"]);c!=null&&b(n,["labels"],c);const u=w(e,["_self"]);u!=null&&b(n,["tunedModelInfo"],gne(t,u));const d=w(e,["defaultCheckpointId"]);d!=null&&b(n,["defaultCheckpointId"],d);const h=w(e,["checkpoints"]);if(h!=null){let f=h;Array.isArray(f)&&(f=f.map(m=>yne(t,m))),b(n,["checkpoints"],f)}return n}function xne(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&b(n,["nextPageToken"],r);const s=w(e,["_self"]);if(s!=null){let i=JV(t,s);Array.isArray(i)&&(i=i.map(o=>OE(t,o))),b(n,["models"],i)}return n}function vne(){return{}}function wne(t,e){const n={},r=w(e,["totalTokens"]);return r!=null&&b(n,["totalTokens"],r),n}function _ne(t,e){const n={},r=w(e,["tokensInfo"]);return r!=null&&b(n,["tokensInfo"],r),n}function bne(t,e){const n={},r=w(e,["gcsUri"]);r!=null&&b(n,["uri"],r);const s=w(e,["bytesBase64Encoded"]);s!=null&&b(n,["videoBytes"],sc(t,s));const i=w(e,["mimeType"]);return i!=null&&b(n,["mimeType"],i),n}function Sne(t,e){const n={},r=w(e,["_self"]);return r!=null&&b(n,["video"],bne(t,r)),n}function Ene(t,e){const n={},r=w(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Sne(t,l))),b(n,["generatedVideos"],o)}const s=w(e,["raiMediaFilteredCount"]);s!=null&&b(n,["raiMediaFilteredCount"],s);const i=w(e,["raiMediaFilteredReasons"]);return i!=null&&b(n,["raiMediaFilteredReasons"],i),n}function Cne(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["name"],r);const s=w(e,["metadata"]);s!=null&&b(n,["metadata"],s);const i=w(e,["done"]);i!=null&&b(n,["done"],i);const o=w(e,["error"]);o!=null&&b(n,["error"],o);const l=w(e,["response"]);return l!=null&&b(n,["response"],Ene(t,l)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Tne="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Ine(t,e,n){const r=new HQ;let s;if(n.data instanceof Blob?s=JSON.parse(await n.data.text()):s=JSON.parse(n.data),t.isVertexAI()){const i=yee(t,s);Object.assign(r,i)}else{const i=gee(t,s);Object.assign(r,i)}e(r)}class Nne{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r,s,i;const o=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion();let c;const u=kne(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())c=`${o}/ws/google.cloud.aiplatform.${l}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const I=this.apiClient.getApiKey();c=`${o}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateContent?key=${I}`}let d=()=>{};const h=new Promise(I=>{d=I}),f=e.callbacks,m=function(){var I;(I=f==null?void 0:f.onopen)===null||I===void 0||I.call(f),d({})},g=this.apiClient,x={onopen:m,onmessage:I=>{Ine(g,f.onmessage,I)},onerror:(n=f==null?void 0:f.onerror)!==null&&n!==void 0?n:function(I){},onclose:(r=f==null?void 0:f.onclose)!==null&&r!==void 0?r:function(I){}},E=this.webSocketFactory.create(c,Rne(u),x);E.connect(),await h;let v=Jn(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&v.startsWith("publishers/")){const I=this.apiClient.getProject(),M=this.apiClient.getLocation();v=`projects/${I}/locations/${M}/`+v}let _={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Rn.AUDIO]}:e.config.responseModalities=[Rn.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const S={model:v,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?_=UZ(this.apiClient,S):_=$Z(this.apiClient,S),delete _.config,E.send(JSON.stringify(_)),new Ane(E,this.apiClient)}}const Pne={turnComplete:!0};class Ane{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=nc(e,n.turns),e.isVertexAI()?r=r.map(s=>Hh(e,s)):r=r.map(s=>Jw(e,s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(Tne)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},Pne),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:qZ(this.apiClient,e)}:n={realtimeInput:WZ(this.apiClient,e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function Rne(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function kne(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let jne=class extends Gp{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>await this.generateContentInternal(n),this.generateContentStream=async n=>await this.generateContentStreamInternal(n),this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var s;let i;const o=[];if(r!=null&&r.generatedImages)for(const c of r.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((s=c==null?void 0:c.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?i=c==null?void 0:c.safetyAttributes:o.push(c);let l;return i?l={generatedImages:o,positivePromptSafetyAttributes:i}:l={generatedImages:o},l}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Yw(yh.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const s={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(s)}}async generateContentInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=hj(this.apiClient,e);return l=$t("{model}:generateContent",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=mj(this.apiClient,d),f=new iy;return Object.assign(f,h),f})}else{const u=dj(this.apiClient,e);return l=$t("{model}:generateContent",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=fj(this.apiClient,d),f=new iy;return Object.assign(f,h),f})}}async generateContentStreamInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=hj(this.apiClient,e);l=$t("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const d=this.apiClient;return o=d.requestStream({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(h){return xv(this,arguments,function*(){var f,m,g,x;try{for(var E=!0,v=ME(h),_;_=yield us(v.next()),f=_.done,!f;E=!0){x=_.value,E=!1;const I=mj(d,yield us(x.json())),M=new iy;Object.assign(M,I),yield yield us(M)}}catch(S){m={error:S}}finally{try{!E&&!f&&(g=v.return)&&(yield us(g.call(v)))}finally{if(m)throw m.error}}})})}else{const u=dj(this.apiClient,e);l=$t("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const d=this.apiClient;return o=d.requestStream({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(h){return xv(this,arguments,function*(){var f,m,g,x;try{for(var E=!0,v=ME(h),_;_=yield us(v.next()),f=_.done,!f;E=!0){x=_.value,E=!1;const I=fj(d,yield us(x.json())),M=new iy;Object.assign(M,I),yield yield us(M)}}catch(S){m={error:S}}finally{try{!E&&!f&&(g=v.return)&&(yield us(g.call(v)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=mte(this.apiClient,e);return l=$t("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=une(this.apiClient,d),f=new Qk;return Object.assign(f,h),f})}else{const u=jee(this.apiClient,e);return l=$t("{model}:batchEmbedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Gte(this.apiClient,d),f=new Qk;return Object.assign(f,h),f})}}async generateImagesInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=gte(this.apiClient,e);return l=$t("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=hne(this.apiClient,d),f=new Zk;return Object.assign(f,h),f})}else{const u=Mee(this.apiClient,e);return l=$t("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=qte(this.apiClient,d),f=new Zk;return Object.assign(f,h),f})}}async editImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Ste(this.apiClient,e);return i=$t("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=fne(this.apiClient,c),d=new VQ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Cte(this.apiClient,e);return i=$t("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=mne(this.apiClient,c),d=new $Q;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Tte(this.apiClient,e);return l=$t("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>OE(this.apiClient,d))}else{const u=Lee(this.apiClient,e);return l=$t("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>FE(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Nte(this.apiClient,e);return l=$t("{models_url}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=xne(this.apiClient,d),f=new ej;return Object.assign(f,h),f})}else{const u=Oee(this.apiClient,e);return l=$t("{models_url}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Yte(this.apiClient,d),f=new ej;return Object.assign(f,h),f})}}async update(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Ate(this.apiClient,e);return l=$t("{model}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>OE(this.apiClient,d))}else{const u=$ee(this.apiClient,e);return l=$t("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>FE(this.apiClient,d))}}async delete(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Rte(this.apiClient,e);return l=$t("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(()=>{const d=vne(),h=new tj;return Object.assign(h,d),h})}else{const u=Uee(this.apiClient,e);return l=$t("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=Jte(),h=new tj;return Object.assign(h,d),h})}}async countTokens(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=jte(this.apiClient,e);return l=$t("{model}:countTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=wne(this.apiClient,d),f=new nj;return Object.assign(f,h),f})}else{const u=zee(this.apiClient,e);return l=$t("{model}:countTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Xte(this.apiClient,d),f=new nj;return Object.assign(f,h),f})}}async computeTokens(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Dte(this.apiClient,e);return i=$t("{model}:computeTokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=_ne(this.apiClient,c),d=new UQ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Lte(this.apiClient,e);return l=$t("{model}:predictLongRunning",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>Cne(this.apiClient,d))}else{const u=Wee(this.apiClient,e);return l=$t("{model}:predictLongRunning",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>tne(this.apiClient,d))}}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Dne(t,e){const n={},r=w(e,["operationName"]);r!=null&&b(n,["_url","operationName"],r);const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function Mne(t,e){const n={},r=w(e,["operationName"]);r!=null&&b(n,["_url","operationName"],r);const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function Lne(t,e){const n={},r=w(e,["operationName"]);r!=null&&b(n,["operationName"],r);const s=w(e,["resourceName"]);s!=null&&b(n,["_url","resourceName"],s);const i=w(e,["config"]);return i!=null&&b(n,["config"],i),n}function Fne(t,e){const n={},r=w(e,["video","uri"]);r!=null&&b(n,["uri"],r);const s=w(e,["video","encodedVideo"]);s!=null&&b(n,["videoBytes"],sc(t,s));const i=w(e,["encoding"]);return i!=null&&b(n,["mimeType"],i),n}function One(t,e){const n={},r=w(e,["_self"]);return r!=null&&b(n,["video"],Fne(t,r)),n}function Vne(t,e){const n={},r=w(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>One(t,l))),b(n,["generatedVideos"],o)}const s=w(e,["raiMediaFilteredCount"]);s!=null&&b(n,["raiMediaFilteredCount"],s);const i=w(e,["raiMediaFilteredReasons"]);return i!=null&&b(n,["raiMediaFilteredReasons"],i),n}function $ne(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["name"],r);const s=w(e,["metadata"]);s!=null&&b(n,["metadata"],s);const i=w(e,["done"]);i!=null&&b(n,["done"],i);const o=w(e,["error"]);o!=null&&b(n,["error"],o);const l=w(e,["response","generateVideoResponse"]);return l!=null&&b(n,["response"],Vne(t,l)),n}function Une(t,e){const n={},r=w(e,["gcsUri"]);r!=null&&b(n,["uri"],r);const s=w(e,["bytesBase64Encoded"]);s!=null&&b(n,["videoBytes"],sc(t,s));const i=w(e,["mimeType"]);return i!=null&&b(n,["mimeType"],i),n}function Bne(t,e){const n={},r=w(e,["_self"]);return r!=null&&b(n,["video"],Une(t,r)),n}function zne(t,e){const n={},r=w(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Bne(t,l))),b(n,["generatedVideos"],o)}const s=w(e,["raiMediaFilteredCount"]);s!=null&&b(n,["raiMediaFilteredCount"],s);const i=w(e,["raiMediaFilteredReasons"]);return i!=null&&b(n,["raiMediaFilteredReasons"],i),n}function pj(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["name"],r);const s=w(e,["metadata"]);s!=null&&b(n,["metadata"],s);const i=w(e,["done"]);i!=null&&b(n,["done"],i);const o=w(e,["error"]);o!=null&&b(n,["error"],o);const l=w(e,["response"]);return l!=null&&b(n,["response"],zne(t,l)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gne extends Gp{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let i;return r&&"httpOptions"in r&&(i=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Mne(this.apiClient,e);return l=$t("{operationName}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>pj(this.apiClient,d))}else{const u=Dne(this.apiClient,e);return l=$t("{operationName}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>$ne(this.apiClient,d))}}async fetchPredictVideosOperationInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Lne(this.apiClient,e);return i=$t("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>pj(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Hne="Content-Type",Wne="X-Server-Timeout",qne="User-Agent",Kne="x-goog-api-client",Yne="0.14.1",Jne=`google-genai-sdk/${Yne}`,Xne="v1beta1",Qne="v1beta",gj=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class t$ extends Error{constructor(e,n){n?super(e,{cause:n}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class VE extends Error{constructor(e,n){n?super(e,{cause:n}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class Zne{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Xne,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:Qne,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const s=[this.getRequestUrlInternal(n)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))s.searchParams.append(o,String(l));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.unaryApiCall(s,i,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[s,i]of Object.entries(n))typeof i=="object"?r[s]=Object.assign(Object.assign({},r[s]),i):i!==void 0&&(r[s]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.streamApiCall(s,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const s=new AbortController,i=s.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>s.abort(),n.timeout),r&&r.addEventListener("abort",()=>{s.abort()}),e.signal=i}return e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await yj(s),new DE(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await yj(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var n;return xv(this,arguments,function*(){const s=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),i=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:c}=yield us(s.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=i.decode(c);try{const h=JSON.parse(u);if("error"in h){const f=JSON.parse(JSON.stringify(h.error)),m=f.status,g=f.code,x=`got status: ${m}. ${JSON.stringify(h)}`;if(g>=400&&g<500)throw new t$(x);if(g>=500&&g<600)throw new VE(x)}}catch(h){const f=h;if(f.name==="ClientError"||f.name==="ServerError")throw h}o+=u;let d=o.match(gj);for(;d;){const h=d[1];try{const f=new Response(h,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield us(new DE(f)),o=o.slice(d[0].length),d=o.match(gj)}catch(f){throw new Error(`exception parsing stream chunk ${h}. ${f}`)}}}}finally{s.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=Jne+" "+this.clientOptions.userAgentExtra;return e[qne]=n,e[Kne]=n,e[Hne]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,s]of Object.entries(e.headers))n.append(r,s);e.timeout&&e.timeout>0&&n.append(Wne,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const i=this.clientOptions.uploader,o=await i.stat(e);s.sizeBytes=String(o.size);const l=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;const c=await this.fetchUploadUrl(s,n);return i.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let s={};n!=null&&n.httpOptions?s=n.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const i={file:e},o=await this.request({path:$t("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:s});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function yj(t){var e;if(t===void 0)throw new VE("response is undefined");if(!t.ok){const n=t.status,r=t.statusText;let s;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await t.json():s={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=`got status: ${n} ${r}. ${JSON.stringify(s)}`;throw n>=400&&n<500?new t$(i):n>=500&&n<600?new VE(i):new Error(i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ere(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["_url","name"],r);const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function tre(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&b(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);n!==void 0&&i!=null&&b(n,["_query","pageToken"],i);const o=w(e,["filter"]);return n!==void 0&&o!=null&&b(n,["_query","filter"],o),r}function nre(t,e){const n={},r=w(e,["config"]);return r!=null&&b(n,["config"],tre(t,r,n)),n}function rre(t,e){const n={},r=w(e,["textInput"]);r!=null&&b(n,["textInput"],r);const s=w(e,["output"]);return s!=null&&b(n,["output"],s),n}function sre(t,e){const n={};if(w(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=w(e,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>rre(t,i))),b(n,["examples","examples"],s)}return n}function ire(t,e,n){const r={};if(w(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=w(e,["tunedModelDisplayName"]);if(n!==void 0&&s!=null&&b(n,["displayName"],s),w(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=w(e,["epochCount"]);n!==void 0&&i!=null&&b(n,["tuningTask","hyperparameters","epochCount"],i);const o=w(e,["learningRateMultiplier"]);if(o!=null&&b(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),w(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(w(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=w(e,["batchSize"]);n!==void 0&&l!=null&&b(n,["tuningTask","hyperparameters","batchSize"],l);const c=w(e,["learningRate"]);return n!==void 0&&c!=null&&b(n,["tuningTask","hyperparameters","learningRate"],c),r}function ore(t,e){const n={},r=w(e,["baseModel"]);r!=null&&b(n,["baseModel"],r);const s=w(e,["trainingDataset"]);s!=null&&b(n,["tuningTask","trainingData"],sre(t,s));const i=w(e,["config"]);return i!=null&&b(n,["config"],ire(t,i,n)),n}function are(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["_url","name"],r);const s=w(e,["config"]);return s!=null&&b(n,["config"],s),n}function lre(t,e,n){const r={},s=w(e,["pageSize"]);n!==void 0&&s!=null&&b(n,["_query","pageSize"],s);const i=w(e,["pageToken"]);n!==void 0&&i!=null&&b(n,["_query","pageToken"],i);const o=w(e,["filter"]);return n!==void 0&&o!=null&&b(n,["_query","filter"],o),r}function cre(t,e){const n={},r=w(e,["config"]);return r!=null&&b(n,["config"],lre(t,r,n)),n}function ure(t,e,n){const r={},s=w(e,["gcsUri"]);if(n!==void 0&&s!=null&&b(n,["supervisedTuningSpec","trainingDatasetUri"],s),w(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function dre(t,e){const n={},r=w(e,["gcsUri"]);return r!=null&&b(n,["validationDatasetUri"],r),n}function hre(t,e,n){const r={},s=w(e,["validationDataset"]);n!==void 0&&s!=null&&b(n,["supervisedTuningSpec"],dre(t,s));const i=w(e,["tunedModelDisplayName"]);n!==void 0&&i!=null&&b(n,["tunedModelDisplayName"],i);const o=w(e,["description"]);n!==void 0&&o!=null&&b(n,["description"],o);const l=w(e,["epochCount"]);n!==void 0&&l!=null&&b(n,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=w(e,["learningRateMultiplier"]);n!==void 0&&c!=null&&b(n,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const u=w(e,["exportLastCheckpointOnly"]);n!==void 0&&u!=null&&b(n,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const d=w(e,["adapterSize"]);if(n!==void 0&&d!=null&&b(n,["supervisedTuningSpec","hyperParameters","adapterSize"],d),w(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(w(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function fre(t,e){const n={},r=w(e,["baseModel"]);r!=null&&b(n,["baseModel"],r);const s=w(e,["trainingDataset"]);s!=null&&b(n,["supervisedTuningSpec","trainingDatasetUri"],ure(t,s,n));const i=w(e,["config"]);return i!=null&&b(n,["config"],hre(t,i,n)),n}function mre(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["model"],r);const s=w(e,["name"]);return s!=null&&b(n,["endpoint"],s),n}function n$(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["name"],r);const s=w(e,["state"]);s!=null&&b(n,["state"],qV(t,s));const i=w(e,["createTime"]);i!=null&&b(n,["createTime"],i);const o=w(e,["tuningTask","startTime"]);o!=null&&b(n,["startTime"],o);const l=w(e,["tuningTask","completeTime"]);l!=null&&b(n,["endTime"],l);const c=w(e,["updateTime"]);c!=null&&b(n,["updateTime"],c);const u=w(e,["description"]);u!=null&&b(n,["description"],u);const d=w(e,["baseModel"]);d!=null&&b(n,["baseModel"],d);const h=w(e,["_self"]);h!=null&&b(n,["tunedModel"],mre(t,h));const f=w(e,["distillationSpec"]);f!=null&&b(n,["distillationSpec"],f);const m=w(e,["experiment"]);m!=null&&b(n,["experiment"],m);const g=w(e,["labels"]);g!=null&&b(n,["labels"],g);const x=w(e,["pipelineJob"]);x!=null&&b(n,["pipelineJob"],x);const E=w(e,["tunedModelDisplayName"]);return E!=null&&b(n,["tunedModelDisplayName"],E),n}function pre(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&b(n,["nextPageToken"],r);const s=w(e,["tunedModels"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>n$(t,o))),b(n,["tuningJobs"],i)}return n}function gre(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["name"],r);const s=w(e,["metadata"]);s!=null&&b(n,["metadata"],s);const i=w(e,["done"]);i!=null&&b(n,["done"],i);const o=w(e,["error"]);return o!=null&&b(n,["error"],o),n}function yre(t,e){const n={},r=w(e,["checkpointId"]);r!=null&&b(n,["checkpointId"],r);const s=w(e,["epoch"]);s!=null&&b(n,["epoch"],s);const i=w(e,["step"]);i!=null&&b(n,["step"],i);const o=w(e,["endpoint"]);return o!=null&&b(n,["endpoint"],o),n}function xre(t,e){const n={},r=w(e,["model"]);r!=null&&b(n,["model"],r);const s=w(e,["endpoint"]);s!=null&&b(n,["endpoint"],s);const i=w(e,["checkpoints"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>yre(t,l))),b(n,["checkpoints"],o)}return n}function $E(t,e){const n={},r=w(e,["name"]);r!=null&&b(n,["name"],r);const s=w(e,["state"]);s!=null&&b(n,["state"],qV(t,s));const i=w(e,["createTime"]);i!=null&&b(n,["createTime"],i);const o=w(e,["startTime"]);o!=null&&b(n,["startTime"],o);const l=w(e,["endTime"]);l!=null&&b(n,["endTime"],l);const c=w(e,["updateTime"]);c!=null&&b(n,["updateTime"],c);const u=w(e,["error"]);u!=null&&b(n,["error"],u);const d=w(e,["description"]);d!=null&&b(n,["description"],d);const h=w(e,["baseModel"]);h!=null&&b(n,["baseModel"],h);const f=w(e,["tunedModel"]);f!=null&&b(n,["tunedModel"],xre(t,f));const m=w(e,["supervisedTuningSpec"]);m!=null&&b(n,["supervisedTuningSpec"],m);const g=w(e,["tuningDataStats"]);g!=null&&b(n,["tuningDataStats"],g);const x=w(e,["encryptionSpec"]);x!=null&&b(n,["encryptionSpec"],x);const E=w(e,["partnerModelTuningSpec"]);E!=null&&b(n,["partnerModelTuningSpec"],E);const v=w(e,["distillationSpec"]);v!=null&&b(n,["distillationSpec"],v);const _=w(e,["experiment"]);_!=null&&b(n,["experiment"],_);const S=w(e,["labels"]);S!=null&&b(n,["labels"],S);const I=w(e,["pipelineJob"]);I!=null&&b(n,["pipelineJob"],I);const M=w(e,["tunedModelDisplayName"]);return M!=null&&b(n,["tunedModelDisplayName"],M),n}function vre(t,e){const n={},r=w(e,["nextPageToken"]);r!=null&&b(n,["nextPageToken"],r);const s=w(e,["tuningJobs"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>$E(t,o))),b(n,["tuningJobs"],i)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wre extends Gp{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Yw(yh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let s="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?s=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(s=r.name.split("/operations/")[0]),{name:s,state:jE.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=are(this.apiClient,e);return l=$t("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>$E(this.apiClient,d))}else{const u=ere(this.apiClient,e);return l=$t("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>n$(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=cre(this.apiClient,e);return l=$t("tuningJobs",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=vre(this.apiClient,d),f=new rj;return Object.assign(f,h),f})}else{const u=nre(this.apiClient,e);return l=$t("tunedModels",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=pre(this.apiClient,d),f=new rj;return Object.assign(f,h),f})}}async tuneInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=fre(this.apiClient,e);return i=$t("tuningJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>$E(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=ore(this.apiClient,e);return i=$t("tunedModels",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>gre(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _re{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const bre=1024*1024*8,Sre=3,Ere=1e3,Cre=2,hb="x-goog-upload-status";async function Tre(t,e,n){var r,s,i;let o=0,l=0,c=new DE(new Response),u="upload";for(o=t.size;l<o;){const h=Math.min(bre,o-l),f=t.slice(l,l+h);l+h>=o&&(u+=", finalize");let m=0,g=Ere;for(;m<Sre&&(c=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(l),"Content-Length":String(h)}}}),!(!((r=c==null?void 0:c.headers)===null||r===void 0)&&r[hb]));)m++,await Nre(g),g=g*Cre;if(l+=h,((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s[hb])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const d=await(c==null?void 0:c.json());if(((i=c==null?void 0:c.headers)===null||i===void 0?void 0:i[hb])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return d.file}async function Ire(t){return{size:t.size,type:t.type}}function Nre(t){return new Promise(e=>setTimeout(e,t))}class Pre{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Tre(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Ire(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Are{create(e,n,r){return new Rre(e,n,r)}}class Rre{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xj="x-goog-api-key";class kre{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(xj)===null&&e.append(xj,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jre="gl-node/";class ar{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=zX(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const s=new kre(this.apiKey);this.apiClient=new Zne({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:jre+"web",uploader:new Pre,downloader:new _re}),this.models=new jne(this.apiClient),this.live=new Nne(this.apiClient,s,new Are),this.chats=new JQ(this.models,this.apiClient),this.caches=new WQ(this.apiClient),this.files=new cZ(this.apiClient),this.operations=new Gne(this.apiClient),this.tunings=new wre(this.apiClient)}}function bt(...t){return DX(MV(t))}function en(){return VX()}const Dre="CEVWpXluVU77FgaVriTzqBCoN4FD3f0VL2Y8bXNPynNfqUg2DoUgPt8t";console.log("[utils.jsx] VITE_PEXELS_API_KEY loaded:","Exists");const r$=Dre,Mre="https://api.pexels.com/v1",Lre="AIzaSyBcpnUVVBDNaBLG7Rj_cEmE0J4zNlHmg7o";console.log("[utils.jsx] VITE_GEMINI_API_KEY loaded:","Exists");const Fre=Lre,Ore="your-shop-name.myshopify.com",wa=async(t,e=1,n="landscape")=>{const r=`${Mre}/search?query=${encodeURIComponent(t)}&per_page=${e}&orientation=${n}`;try{const s=await fetch(r,{headers:{Authorization:r$}});if(!s.ok){const o=await s.json();throw console.error("Pexels API error:",o),new Error(`Pexels API request failed: ${s.statusText}`)}const i=await s.json();if(!i.photos||i.photos.length===0){console.warn(`No Pexels images found for query: "${t}". Attempting fallback.`);const o=(l,c,u)=>`https://via.placeholder.com/${l}x${c}.png?text=NoImage:${encodeURIComponent(u)}`;return Array(e).fill(null).map((l,c)=>({id:en(),src:{large:o(1200,800,`${t} ${c+1}`),medium:o(800,600,`${t} ${c+1}`),original:o(1920,1280,`${t} ${c+1}`),square:o(400,400,`${t} ${c+1}`),landscape:o(1200,800,`${t} ${c+1}`),portrait:o(800,1200,`${t} ${c+1}`),small:o(400,260,`${t} ${c+1}`),tiny:o(200,130,`${t} ${c+1}`)},photographer:"N/A",alt:`No image found for ${t} ${c+1}`}))}return i.photos.map(o=>({id:o.id,src:o.src,photographer:o.photographer,alt:o.alt||`Photo by ${o.photographer} of ${t}`}))}catch(s){console.error("Error fetching Pexels images:",s);const i=(o,l,c)=>`https://via.placeholder.com/${o}x${l}.png?text=${encodeURIComponent(c)}`;return Array(e).fill(null).map((o,l)=>({id:en(),src:{large:i(1200,800,`Error ${t} ${l+1}`),medium:i(800,600,`Error ${t} ${l+1}`),original:i(1920,1280,`Error ${t} ${l+1}`),square:i(400,400,`Error ${t} ${l+1}`),landscape:i(1200,800,`Error ${t} ${l+1}`),portrait:i(800,1200,`Error ${t} ${l+1}`),small:i(400,260,`Error ${t} ${l+1}`),tiny:i(200,130,`Error ${t} ${l+1}`)},photographer:"Placeholder Error",alt:`Placeholder Error for ${t} ${l+1}`}))}},jc=async(t,e=1,n="landscape")=>{const r=`https://api.pexels.com/videos/search?query=${encodeURIComponent(t)}&per_page=${e}&orientation=${n}`;try{const s=await fetch(r,{headers:{Authorization:r$}});if(!s.ok){const o=await s.json();throw console.error("Pexels Videos API error:",o),new Error(`Pexels Videos API request failed: ${s.statusText}`)}const i=await s.json();return!i.videos||i.videos.length===0?(console.warn(`No Pexels videos found for query: "${t}".`),Array(e).fill(null).map((o,l)=>({id:en(),url:`https://videos.pexels.com/videos/no-video-${l+1}.mp4`,image:`https://via.placeholder.com/1280x720.png?text=No+Video+Found+${encodeURIComponent(t)}`,alt:`No video found for ${t} ${l+1}`}))):i.videos.map(o=>{var c,u;const l=o.video_files.find(d=>d.quality==="hd"&&d.file_type==="video/mp4")||o.video_files.find(d=>d.file_type==="video/mp4")||o.video_files[0];return{id:o.id,url:l?l.link:null,image:((c=o.video_pictures[0])==null?void 0:c.picture)||`https://via.placeholder.com/1280x720.png?text=${encodeURIComponent(o.url||t)}`,duration:o.duration,user:o.user,alt:`Video of ${t} by ${((u=o.user)==null?void 0:u.name)||"Pexels Contributor"}`}})}catch(s){return console.error("Error fetching Pexels videos:",s),Array(e).fill(null).map((i,o)=>({id:en(),url:`https://videos.pexels.com/videos/error-video-${o+1}.mp4`,image:`https://via.placeholder.com/1280x720.png?text=Video+Error+${encodeURIComponent(t)}`,alt:`Error fetching video for ${t} ${o+1}`}))}},j1=async t=>{try{const e=new ar({apiKey:Fre}),n=[{category:Ur.HARM_CATEGORY_HARASSMENT,threshold:Br.BLOCK_MEDIUM_AND_ABOVE},{category:Ur.HARM_CATEGORY_HATE_SPEECH,threshold:Br.BLOCK_MEDIUM_AND_ABOVE},{category:Ur.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Br.BLOCK_MEDIUM_AND_ABOVE},{category:Ur.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Br.BLOCK_MEDIUM_AND_ABOVE}];console.log(`[utils.jsx/generateImageWithGemini] Calling Gemini with prompt: "${t}"`);const r=await e.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:[{text:t}],safetySettings:n,config:{responseModalities:[Rn.TEXT,Rn.IMAGE]}});let s=null,i="image/png";if(r.candidates&&r.candidates.length>0&&r.candidates[0].content&&r.candidates[0].content.parts){for(const o of r.candidates[0].content.parts)if(o.inlineData&&o.inlineData.data){s=o.inlineData.data,i=o.inlineData.mimeType||"image/png",console.log(`[utils.jsx/generateImageWithGemini] Image generated. MimeType: ${i}`);break}}if(s)return{url:`data:${i};base64,${s}`,alt:`AI Generated Image for: ${t}`};throw new Error("No image data found in Gemini response.")}catch(e){return console.error("[utils.jsx/generateImageWithGemini] Error generating image with Gemini:",e),{url:`https://via.placeholder.com/512x512.png?text=Error:${encodeURIComponent(t.substring(0,20))}`,alt:`Error generating image for: ${t}`}}},Vre=(t,e)=>{const n={fashion:[`Elevate your style with our ${e}. Crafted for comfort and a modern look.`,`The ${e} is a must-have for any fashion-forward wardrobe. Versatile and chic.`,`Discover the perfect blend of quality and design in our ${e}. Ideal for any occasion.`],electronics:[`Experience next-level technology with the ${e}. Packed with features for modern life.`,`The ${e} offers superior performance and sleek design. Upgrade your tech today.`,`Unleash innovation with the ${e}. Reliable, powerful, and built to last.`],food:[`Savor the rich flavors of our ${e}. Made with the freshest, high-quality ingredients.`,`Our ${e} is a delicious treat for any time of day. Wholesome and satisfying.`,`Indulge in the authentic taste of ${e}. Perfect for sharing or enjoying solo.`],jewelry:[`Adorn yourself with the exquisite ${e}. A timeless piece that radiates elegance.`,`The ${e} is a symbol of sophistication and luxury. Crafted with precision.`,`Make a statement with our stunning ${e}. Perfect for special moments.`],general:[`Discover the quality and utility of the ${e}. A great addition to your collection.`,`The ${e} is designed for excellence and everyday use. You'll love it.`,`Enhance your life with the versatile ${e}. Built for performance and style.`]},r=n[t]||n.general;return r[Math.floor(Math.random()*r.length)]},Xw=(t,e)=>{const n={fashion:`Step Into Style at ${e}`,electronics:`${e}: Your Tech Universe`,food:`Taste the Difference with ${e}`,jewelry:`Shine Bright with ${e}`,general:`Welcome to ${e} - Quality Finds!`},r={fashion:`Explore the latest trends and timeless classics. ${e} offers curated fashion for every individual. Express yourself with our unique collection.`,electronics:`Discover cutting-edge gadgets and essential electronics at ${e}. We bring you innovation, performance, and value, all in one place.`,food:`From farm-fresh produce to gourmet delights, ${e} is your source for delicious and wholesome food. Quality ingredients for a healthier life.`,jewelry:`Find exquisite pieces that tell your story. ${e} presents a stunning collection of fine jewelry, perfect for gifting or treating yourself.`,general:`Your one-stop shop for amazing products. ${e} offers a diverse range of quality items to meet your everyday needs and special desires.`},s=["Fast Worldwide Shipping","Secure Online Payments","24/7 Customer Support","Easy Returns & Exchanges"],i=["Get your orders delivered quickly and reliably, no matter where you are.","Shop with confidence using our encrypted and secure payment gateways.","Our dedicated team is here to help you around the clock with any queries.","Not satisfied? We offer a hassle-free return and exchange policy."],o=`Join the ${e} Family`,l="Sign up for our newsletter to receive exclusive offers, new product alerts, and style tips directly to your inbox. Don't miss out!";return{heroTitle:n[t]||n.general,heroDescription:r[t]||r.general,featureTitles:s,featureDescriptions:i,newsletterHeading:o,newsletterText:l}};function wt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function vj(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Qw(...t){return e=>{let n=!1;const r=t.map(s=>{const i=vj(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():vj(t[s],null)}}}}function bn(...t){return p.useCallback(Qw(...t),t)}function $re(t,e){const n=p.createContext(e),r=i=>{const{children:o,...l}=i,c=p.useMemo(()=>l,Object.values(l));return a.jsx(n.Provider,{value:c,children:o})};r.displayName=t+"Provider";function s(i){const o=p.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,s]}function Si(t,e=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];const u=h=>{var v;const{scope:f,children:m,...g}=h,x=((v=f==null?void 0:f[t])==null?void 0:v[c])||l,E=p.useMemo(()=>g,Object.values(g));return a.jsx(x.Provider,{value:E,children:m})};u.displayName=i+"Provider";function d(h,f){var x;const m=((x=f==null?void 0:f[t])==null?void 0:x[c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return p.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,Ure(s,...e)]}function Ure(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function xh(t){const e=zre(t),n=p.forwardRef((r,s)=>{const{children:i,...o}=r,l=p.Children.toArray(i),c=l.find(Hre);if(c){const u=c.props.children,d=l.map(h=>h===c?p.Children.count(u)>1?p.Children.only(null):p.isValidElement(u)?u.props.children:null:h);return a.jsx(e,{...o,ref:s,children:p.isValidElement(u)?p.cloneElement(u,void 0,d):null})}return a.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}var Bre=xh("Slot");function zre(t){const e=p.forwardRef((n,r)=>{const{children:s,...i}=n;if(p.isValidElement(s)){const o=qre(s),l=Wre(i,s.props);return s.type!==p.Fragment&&(l.ref=r?Qw(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var s$=Symbol("radix.slottable");function Gre(t){const e=({children:n})=>a.jsx(a.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=s$,e}function Hre(t){return p.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===s$}function Wre(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function qre(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function D1(t){const e=t+"CollectionProvider",[n,r]=Si(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=x=>{const{scope:E,children:v}=x,_=ct.useRef(null),S=ct.useRef(new Map).current;return a.jsx(s,{scope:E,itemMap:S,collectionRef:_,children:v})};o.displayName=e;const l=t+"CollectionSlot",c=xh(l),u=ct.forwardRef((x,E)=>{const{scope:v,children:_}=x,S=i(l,v),I=bn(E,S.collectionRef);return a.jsx(c,{ref:I,children:_})});u.displayName=l;const d=t+"CollectionItemSlot",h="data-radix-collection-item",f=xh(d),m=ct.forwardRef((x,E)=>{const{scope:v,children:_,...S}=x,I=ct.useRef(null),M=bn(E,I),j=i(d,v);return ct.useEffect(()=>(j.itemMap.set(I,{ref:I,...S}),()=>void j.itemMap.delete(I))),a.jsx(f,{[h]:"",ref:M,children:_})});m.displayName=d;function g(x){const E=i(t+"CollectionConsumer",x);return ct.useCallback(()=>{const _=E.collectionRef.current;if(!_)return[];const S=Array.from(_.querySelectorAll(`[${h}]`));return Array.from(E.itemMap.values()).sort((j,C)=>S.indexOf(j.ref.current)-S.indexOf(C.ref.current))},[E.collectionRef,E.itemMap])}return[{Provider:o,Slot:u,ItemSlot:m},g,r]}var Kre=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Kt=Kre.reduce((t,e)=>{const n=xh(`Primitive.${e}`),r=p.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function M1(t,e){t&&ja.flushSync(()=>t.dispatchEvent(e))}function Cr(t){const e=p.useRef(t);return p.useEffect(()=>{e.current=t}),p.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function Yre(t,e=globalThis==null?void 0:globalThis.document){const n=Cr(t);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var Jre="DismissableLayer",UE="dismissableLayer.update",Xre="dismissableLayer.pointerDownOutside",Qre="dismissableLayer.focusOutside",wj,i$=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Zw=p.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=t,u=p.useContext(i$),[d,h]=p.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=p.useState({}),g=bn(e,C=>h(C)),x=Array.from(u.layers),[E]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),v=x.indexOf(E),_=d?x.indexOf(d):-1,S=u.layersWithOutsidePointerEventsDisabled.size>0,I=_>=v,M=ese(C=>{const T=C.target,P=[...u.branches].some(A=>A.contains(T));!I||P||(s==null||s(C),o==null||o(C),C.defaultPrevented||l==null||l())},f),j=tse(C=>{const T=C.target;[...u.branches].some(A=>A.contains(T))||(i==null||i(C),o==null||o(C),C.defaultPrevented||l==null||l())},f);return Yre(C=>{_===u.layers.size-1&&(r==null||r(C),!C.defaultPrevented&&l&&(C.preventDefault(),l()))},f),p.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(wj=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),_j(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=wj)}},[d,f,n,u]),p.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),_j())},[d,u]),p.useEffect(()=>{const C=()=>m({});return document.addEventListener(UE,C),()=>document.removeEventListener(UE,C)},[]),a.jsx(Kt.div,{...c,ref:g,style:{pointerEvents:S?I?"auto":"none":void 0,...t.style},onFocusCapture:wt(t.onFocusCapture,j.onFocusCapture),onBlurCapture:wt(t.onBlurCapture,j.onBlurCapture),onPointerDownCapture:wt(t.onPointerDownCapture,M.onPointerDownCapture)})});Zw.displayName=Jre;var Zre="DismissableLayerBranch",o$=p.forwardRef((t,e)=>{const n=p.useContext(i$),r=p.useRef(null),s=bn(e,r);return p.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),a.jsx(Kt.div,{...t,ref:s})});o$.displayName=Zre;function ese(t,e=globalThis==null?void 0:globalThis.document){const n=Cr(t),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let c=function(){a$(Xre,n,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=c,e.addEventListener("click",s.current,{once:!0})):c()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function tse(t,e=globalThis==null?void 0:globalThis.document){const n=Cr(t),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&a$(Qre,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function _j(){const t=new CustomEvent(UE);document.dispatchEvent(t)}function a$(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?M1(s,i):s.dispatchEvent(i)}var nse=Zw,rse=o$,Bo=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},sse="Portal",e0=p.forwardRef((t,e)=>{var l;const{container:n,...r}=t,[s,i]=p.useState(!1);Bo(()=>i(!0),[]);const o=n||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?C1.createPortal(a.jsx(Kt.div,{...r,ref:e}),o):null});e0.displayName=sse;function ise(t,e){return p.useReducer((n,r)=>e[n][r]??n,t)}var Ms=t=>{const{present:e,children:n}=t,r=ose(e),s=typeof n=="function"?n({present:r.isPresent}):p.Children.only(n),i=bn(r.ref,ase(s));return typeof n=="function"||r.isPresent?p.cloneElement(s,{ref:i}):null};Ms.displayName="Presence";function ose(t){const[e,n]=p.useState(),r=p.useRef(null),s=p.useRef(t),i=p.useRef("none"),o=t?"mounted":"unmounted",[l,c]=ise(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const u=ly(r.current);i.current=l==="mounted"?u:"none"},[l]),Bo(()=>{const u=r.current,d=s.current;if(d!==t){const f=i.current,m=ly(u);t?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),Bo(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=m=>{const x=ly(r.current).includes(m.animationName);if(m.target===e&&x&&(c("ANIMATION_END"),!s.current)){const E=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=E)})}},f=m=>{m.target===e&&(i.current=ly(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(u=>{r.current=u?getComputedStyle(u):null,n(u)},[])}}function ly(t){return(t==null?void 0:t.animationName)||"none"}function ase(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var lse=Tw[" useInsertionEffect ".trim().toString()]||Bo;function Pu({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[s,i,o]=cse({defaultProp:e,onChange:n}),l=t!==void 0,c=l?t:s;{const d=p.useRef(t!==void 0);p.useEffect(()=>{const h=d.current;h!==l&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,r])}const u=p.useCallback(d=>{var h;if(l){const f=use(d)?d(t):d;f!==t&&((h=o.current)==null||h.call(o,f))}else i(d)},[l,t,i,o]);return[c,u]}function cse({defaultProp:t,onChange:e}){const[n,r]=p.useState(t),s=p.useRef(n),i=p.useRef(e);return lse(()=>{i.current=e},[e]),p.useEffect(()=>{var o;s.current!==n&&((o=i.current)==null||o.call(i,n),s.current=n)},[n,s]),[n,r,i]}function use(t){return typeof t=="function"}var dse=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),hse="VisuallyHidden",L1=p.forwardRef((t,e)=>a.jsx(Kt.span,{...t,ref:e,style:{...dse,...t.style}}));L1.displayName=hse;var F1="ToastProvider",[O1,fse,mse]=D1("Toast"),[l$,wke]=Si("Toast",[mse]),[pse,t0]=l$(F1),c$=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=t,[l,c]=p.useState(null),[u,d]=p.useState(0),h=p.useRef(!1),f=p.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${F1}\`. Expected non-empty \`string\`.`),a.jsx(O1.Provider,{scope:e,children:a.jsx(pse,{scope:e,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>d(m=>m+1),[]),onToastRemove:p.useCallback(()=>d(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};c$.displayName=F1;var u$="ToastViewport",gse=["F8"],BE="toast.viewportPause",zE="toast.viewportResume",d$=p.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=gse,label:s="Notifications ({hotkey})",...i}=t,o=t0(u$,n),l=fse(n),c=p.useRef(null),u=p.useRef(null),d=p.useRef(null),h=p.useRef(null),f=bn(e,h,o.onViewportChange),m=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=o.toastCount>0;p.useEffect(()=>{const E=v=>{var S;r.length!==0&&r.every(I=>v[I]||v.code===I)&&((S=h.current)==null||S.focus())};return document.addEventListener("keydown",E),()=>document.removeEventListener("keydown",E)},[r]),p.useEffect(()=>{const E=c.current,v=h.current;if(g&&E&&v){const _=()=>{if(!o.isClosePausedRef.current){const j=new CustomEvent(BE);v.dispatchEvent(j),o.isClosePausedRef.current=!0}},S=()=>{if(o.isClosePausedRef.current){const j=new CustomEvent(zE);v.dispatchEvent(j),o.isClosePausedRef.current=!1}},I=j=>{!E.contains(j.relatedTarget)&&S()},M=()=>{E.contains(document.activeElement)||S()};return E.addEventListener("focusin",_),E.addEventListener("focusout",I),E.addEventListener("pointermove",_),E.addEventListener("pointerleave",M),window.addEventListener("blur",_),window.addEventListener("focus",S),()=>{E.removeEventListener("focusin",_),E.removeEventListener("focusout",I),E.removeEventListener("pointermove",_),E.removeEventListener("pointerleave",M),window.removeEventListener("blur",_),window.removeEventListener("focus",S)}}},[g,o.isClosePausedRef]);const x=p.useCallback(({tabbingDirection:E})=>{const _=l().map(S=>{const I=S.ref.current,M=[I,...Pse(I)];return E==="forwards"?M:M.reverse()});return(E==="forwards"?_.reverse():_).flat()},[l]);return p.useEffect(()=>{const E=h.current;if(E){const v=_=>{var M,j,C;const S=_.altKey||_.ctrlKey||_.metaKey;if(_.key==="Tab"&&!S){const T=document.activeElement,P=_.shiftKey;if(_.target===E&&P){(M=u.current)==null||M.focus();return}const R=x({tabbingDirection:P?"backwards":"forwards"}),k=R.findIndex(U=>U===T);fb(R.slice(k+1))?_.preventDefault():P?(j=u.current)==null||j.focus():(C=d.current)==null||C.focus()}};return E.addEventListener("keydown",v),()=>E.removeEventListener("keydown",v)}},[l,x]),a.jsxs(rse,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&a.jsx(GE,{ref:u,onFocusFromOutsideViewport:()=>{const E=x({tabbingDirection:"forwards"});fb(E)}}),a.jsx(O1.Slot,{scope:n,children:a.jsx(Kt.ol,{tabIndex:-1,...i,ref:f})}),g&&a.jsx(GE,{ref:d,onFocusFromOutsideViewport:()=>{const E=x({tabbingDirection:"backwards"});fb(E)}})]})});d$.displayName=u$;var h$="ToastFocusProxy",GE=p.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=t0(h$,n);return a.jsx(L1,{"aria-hidden":!0,tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(l))&&r()}})});GE.displayName=h$;var Hp="Toast",yse="toast.swipeStart",xse="toast.swipeMove",vse="toast.swipeCancel",wse="toast.swipeEnd",f$=p.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=t,[l,c]=Pu({prop:r,defaultProp:s??!0,onChange:i,caller:Hp});return a.jsx(Ms,{present:n||l,children:a.jsx(Sse,{open:l,...o,ref:e,onClose:()=>c(!1),onPause:Cr(t.onPause),onResume:Cr(t.onResume),onSwipeStart:wt(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:wt(t.onSwipeMove,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:wt(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:wt(t.onSwipeEnd,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})})});f$.displayName=Hp;var[_se,bse]=l$(Hp,{onClose(){}}),Sse=p.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:m,...g}=t,x=t0(Hp,n),[E,v]=p.useState(null),_=bn(e,U=>v(U)),S=p.useRef(null),I=p.useRef(null),M=s||x.duration,j=p.useRef(0),C=p.useRef(M),T=p.useRef(0),{onToastAdd:P,onToastRemove:A}=x,D=Cr(()=>{var B;(E==null?void 0:E.contains(document.activeElement))&&((B=x.viewport)==null||B.focus()),o()}),R=p.useCallback(U=>{!U||U===1/0||(window.clearTimeout(T.current),j.current=new Date().getTime(),T.current=window.setTimeout(D,U))},[D]);p.useEffect(()=>{const U=x.viewport;if(U){const B=()=>{R(C.current),u==null||u()},K=()=>{const ee=new Date().getTime()-j.current;C.current=C.current-ee,window.clearTimeout(T.current),c==null||c()};return U.addEventListener(BE,K),U.addEventListener(zE,B),()=>{U.removeEventListener(BE,K),U.removeEventListener(zE,B)}}},[x.viewport,M,c,u,R]),p.useEffect(()=>{i&&!x.isClosePausedRef.current&&R(M)},[i,M,x.isClosePausedRef,R]),p.useEffect(()=>(P(),()=>A()),[P,A]);const k=p.useMemo(()=>E?w$(E):null,[E]);return x.viewport?a.jsxs(a.Fragment,{children:[k&&a.jsx(Ese,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:k}),a.jsx(_se,{scope:n,onClose:D,children:ja.createPortal(a.jsx(O1.ItemSlot,{scope:n,children:a.jsx(nse,{asChild:!0,onEscapeKeyDown:wt(l,()=>{x.isFocusedToastEscapeKeyDownRef.current||D(),x.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(Kt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":x.swipeDirection,...g,ref:_,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:wt(t.onKeyDown,U=>{U.key==="Escape"&&(l==null||l(U.nativeEvent),U.nativeEvent.defaultPrevented||(x.isFocusedToastEscapeKeyDownRef.current=!0,D()))}),onPointerDown:wt(t.onPointerDown,U=>{U.button===0&&(S.current={x:U.clientX,y:U.clientY})}),onPointerMove:wt(t.onPointerMove,U=>{if(!S.current)return;const B=U.clientX-S.current.x,K=U.clientY-S.current.y,ee=!!I.current,H=["left","right"].includes(x.swipeDirection),X=["left","up"].includes(x.swipeDirection)?Math.min:Math.max,O=H?X(0,B):0,z=H?0:X(0,K),Y=U.pointerType==="touch"?10:2,F={x:O,y:z},ye={originalEvent:U,delta:F};ee?(I.current=F,cy(xse,h,ye,{discrete:!1})):bj(F,x.swipeDirection,Y)?(I.current=F,cy(yse,d,ye,{discrete:!1}),U.target.setPointerCapture(U.pointerId)):(Math.abs(B)>Y||Math.abs(K)>Y)&&(S.current=null)}),onPointerUp:wt(t.onPointerUp,U=>{const B=I.current,K=U.target;if(K.hasPointerCapture(U.pointerId)&&K.releasePointerCapture(U.pointerId),I.current=null,S.current=null,B){const ee=U.currentTarget,H={originalEvent:U,delta:B};bj(B,x.swipeDirection,x.swipeThreshold)?cy(wse,m,H,{discrete:!0}):cy(vse,f,H,{discrete:!0}),ee.addEventListener("click",X=>X.preventDefault(),{once:!0})}})})})}),x.viewport)})]}):null}),Ese=t=>{const{__scopeToast:e,children:n,...r}=t,s=t0(Hp,e),[i,o]=p.useState(!1),[l,c]=p.useState(!1);return Ise(()=>o(!0)),p.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:a.jsx(e0,{asChild:!0,children:a.jsx(L1,{...r,children:i&&a.jsxs(a.Fragment,{children:[s.label," ",n]})})})},Cse="ToastTitle",m$=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Kt.div,{...r,ref:e})});m$.displayName=Cse;var Tse="ToastDescription",p$=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Kt.div,{...r,ref:e})});p$.displayName=Tse;var g$="ToastAction",y$=p.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?a.jsx(v$,{altText:n,asChild:!0,children:a.jsx(V1,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${g$}\`. Expected non-empty \`string\`.`),null)});y$.displayName=g$;var x$="ToastClose",V1=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,s=bse(x$,n);return a.jsx(v$,{asChild:!0,children:a.jsx(Kt.button,{type:"button",...r,ref:e,onClick:wt(t.onClick,s.onClose)})})});V1.displayName=x$;var v$=p.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...s}=t;return a.jsx(Kt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function w$(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),Nse(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...w$(r))}}),e}function cy(t,e,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?M1(s,i):s.dispatchEvent(i)}var bj=(t,e,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return e==="left"||e==="right"?i&&r>n:!i&&s>n};function Ise(t=()=>{}){const e=Cr(t);Bo(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function Nse(t){return t.nodeType===t.ELEMENT_NODE}function Pse(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function fb(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var Ase=c$,_$=d$,b$=f$,S$=m$,E$=p$,C$=y$,T$=V1;const Sj=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Ej=MV,$1=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return Ej(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const f=Sj(d)||Sj(h);return s[u][f]}),l=n&&Object.entries(n).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:h,className:f,...m}=d;return Object.entries(m).every(g=>{let[x,E]=g;return Array.isArray(E)?E.includes({...i,...l}[x]):{...i,...l}[x]===E})?[...u,h,f]:u},[]);return Ej(t,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};var Rse={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const kse=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$e=(t,e)=>{const n=p.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:l,...c},u)=>p.createElement("svg",{ref:u,...Rse,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${kse(t)}`,...c},[...e.map(([d,h])=>p.createElement(d,h)),...(Array.isArray(l)?l:[l])||[]]));return n.displayName=`${t}`,n},Cj=$e("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Wp=$e("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Vl=$e("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),cp=$e("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),jse=$e("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),Dse=$e("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),vv=$e("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),Mse=$e("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Lse=$e("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),U1=$e("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),uo=$e("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),qp=$e("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),n0=$e("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Fse=$e("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),I$=$e("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Ose=$e("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),Vse=$e("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),N$=$e("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),ki=$e("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Tj=$e("DownloadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m8 17 4 4 4-4",key:"1ul180"}]]),P$=$e("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Ad=$e("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),$se=$e("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Use=$e("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),gr=$e("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Bse=$e("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]),Jc=$e("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),mb=$e("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),Ij=$e("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),A$=$e("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),zse=$e("ImageDown",[["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10.8",key:"sqts6f"}],["path",{d:"m21 15-3.1-3.1a2 2 0 0 0-2.814.014L6 21",key:"1h47z9"}],["path",{d:"m14 19.5 3 3v-6",key:"1x9jmo"}],["path",{d:"m17 22.5 3-3",key:"xzuz0n"}]]),Gse=$e("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),HE=$e("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Hse=$e("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),dx=$e("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),Wse=$e("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),qse=$e("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),Kse=$e("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),St=$e("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),R$=$e("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Nj=$e("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),Pj=$e("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Rd=$e("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Yse=$e("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Jse=$e("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),k$=$e("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Xse=$e("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),Qse=$e("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),WE=$e("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),Zse=$e("MoveDown",[["path",{d:"M8 18L12 22L16 18",key:"cskvfv"}],["path",{d:"M12 2V22",key:"r89rzk"}]]),eie=$e("MoveUp",[["path",{d:"M8 6L12 2L16 6",key:"1yvkyx"}],["path",{d:"M12 2V22",key:"r89rzk"}]]),ui=$e("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),B1=$e("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),tie=$e("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),wv=$e("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),_v=$e("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),Aj=$e("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),nie=$e("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),rie=$e("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),sie=$e("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),j$=$e("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),so=$e("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),uy=$e("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),bv=$e("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),iie=$e("Replace",[["path",{d:"M14 4c0-1.1.9-2 2-2",key:"1mvvbw"}],["path",{d:"M20 2c1.1 0 2 .9 2 2",key:"1mj6oe"}],["path",{d:"M22 8c0 1.1-.9 2-2 2",key:"v1wql3"}],["path",{d:"M16 10c-1.1 0-2-.9-2-2",key:"821ux0"}],["path",{d:"m3 7 3 3 3-3",key:"x25e72"}],["path",{d:"M6 10V5c0-1.7 1.3-3 3-3h1",key:"13af7h"}],["rect",{width:"8",height:"8",x:"2",y:"14",rx:"2",key:"17ihk4"}]]),oie=$e("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),pb=$e("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Rj=$e("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]),Jd=$e("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),aie=$e("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),lie=$e("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),up=$e("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),cie=$e("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),D$=$e("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),dp=$e("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Xr=$e("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),M$=$e("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),uie=$e("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]),dy=$e("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),qE=$e("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),ym=$e("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),L$=$e("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),er=$e("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Tf=$e("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Sv=$e("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),die=$e("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),hie=$e("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),Fo=$e("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]),fie=$e("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),mie=$e("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),r0=$e("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),pie=$e("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),_a=$e("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),Cl=$e("Wand",[["path",{d:"M15 4V2",key:"z1p9b7"}],["path",{d:"M15 16v-2",key:"px0unx"}],["path",{d:"M8 9h2",key:"1g203m"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M17.8 11.8 19 13",key:"yihg8r"}],["path",{d:"M15 9h0",key:"kg5t1u"}],["path",{d:"M17.8 6.2 19 5",key:"fd4us0"}],["path",{d:"m3 21 9-9",key:"1jfql5"}],["path",{d:"M12.2 6.2 11 5",key:"i3da3b"}]]),z1=$e("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),zo=$e("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),gie=$e("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),F$=$e("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),yie=Ase,O$=ct.forwardRef(({className:t,...e},n)=>a.jsx(_$,{ref:n,className:bt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));O$.displayName=_$.displayName;const xie=$1("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),V$=ct.forwardRef(({className:t,variant:e,...n},r)=>a.jsx(b$,{ref:r,className:bt(xie({variant:e}),t),...n}));V$.displayName=b$.displayName;const vie=ct.forwardRef(({className:t,...e},n)=>a.jsx(C$,{ref:n,className:bt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));vie.displayName=C$.displayName;const $$=ct.forwardRef(({className:t,...e},n)=>a.jsx(T$,{ref:n,className:bt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:a.jsx(zo,{className:"h-4 w-4"})}));$$.displayName=T$.displayName;const U$=ct.forwardRef(({className:t,...e},n)=>a.jsx(S$,{ref:n,className:bt("text-sm font-semibold",t),...e}));U$.displayName=S$.displayName;const B$=ct.forwardRef(({className:t,...e},n)=>a.jsx(E$,{ref:n,className:bt("text-sm opacity-90",t),...e}));B$.displayName=E$.displayName;const wie=1;let gb=0;function _ie(){return gb=(gb+1)%Number.MAX_VALUE,gb.toString()}const Es={state:{toasts:[]},listeners:[],getState:()=>Es.state,setState:t=>{typeof t=="function"?Es.state=t(Es.state):Es.state={...Es.state,...t},Es.listeners.forEach(e=>e(Es.state))},subscribe:t=>(Es.listeners.push(t),()=>{Es.listeners=Es.listeners.filter(e=>e!==t)})},bie=({...t})=>{const e=_ie(),n=s=>Es.setState(i=>({...i,toasts:i.toasts.map(o=>o.id===e?{...o,...s}:o)})),r=()=>Es.setState(s=>({...s,toasts:s.toasts.filter(i=>i.id!==e)}));return Es.setState(s=>({...s,toasts:[{...t,id:e,dismiss:r},...s.toasts].slice(0,wie)})),{id:e,dismiss:r,update:n}};function Ls(){const[t,e]=p.useState(Es.getState());return p.useEffect(()=>Es.subscribe(r=>{e(r)}),[]),p.useEffect(()=>{const n=[];return t.toasts.forEach(r=>{if(r.duration===1/0)return;const s=setTimeout(()=>{r.dismiss()},r.duration||5e3);n.push(s)}),()=>{n.forEach(r=>clearTimeout(r))}},[t.toasts]),{toast:bie,toasts:t.toasts}}function Sie(){const{toasts:t}=Ls();return a.jsxs(yie,{children:[t.map(({id:e,title:n,description:r,action:s,dismiss:i,...o})=>a.jsxs(V$,{...o,children:[a.jsxs("div",{className:"grid gap-1",children:[n&&a.jsx(U$,{children:n}),r&&a.jsx(B$,{children:r})]}),s,a.jsx($$,{})]},e)),a.jsx(O$,{})]})}var Eie=Tw[" useId ".trim().toString()]||(()=>{}),Cie=0;function Xc(t){const[e,n]=p.useState(Eie());return Bo(()=>{t||n(r=>r??String(Cie++))},[t]),t||(e?`radix-${e}`:"")}var yb="focusScope.autoFocusOnMount",xb="focusScope.autoFocusOnUnmount",kj={bubbles:!1,cancelable:!0},Tie="FocusScope",G1=p.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[l,c]=p.useState(null),u=Cr(s),d=Cr(i),h=p.useRef(null),f=bn(e,x=>c(x)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let x=function(S){if(m.paused||!l)return;const I=S.target;l.contains(I)?h.current=I:Qa(h.current,{select:!0})},E=function(S){if(m.paused||!l)return;const I=S.relatedTarget;I!==null&&(l.contains(I)||Qa(h.current,{select:!0}))},v=function(S){if(document.activeElement===document.body)for(const M of S)M.removedNodes.length>0&&Qa(l)};document.addEventListener("focusin",x),document.addEventListener("focusout",E);const _=new MutationObserver(v);return l&&_.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",E),_.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){Dj.add(m);const x=document.activeElement;if(!l.contains(x)){const v=new CustomEvent(yb,kj);l.addEventListener(yb,u),l.dispatchEvent(v),v.defaultPrevented||(Iie(kie(z$(l)),{select:!0}),document.activeElement===x&&Qa(l))}return()=>{l.removeEventListener(yb,u),setTimeout(()=>{const v=new CustomEvent(xb,kj);l.addEventListener(xb,d),l.dispatchEvent(v),v.defaultPrevented||Qa(x??document.body,{select:!0}),l.removeEventListener(xb,d),Dj.remove(m)},0)}}},[l,u,d,m]);const g=p.useCallback(x=>{if(!n&&!r||m.paused)return;const E=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,v=document.activeElement;if(E&&v){const _=x.currentTarget,[S,I]=Nie(_);S&&I?!x.shiftKey&&v===I?(x.preventDefault(),n&&Qa(S,{select:!0})):x.shiftKey&&v===S&&(x.preventDefault(),n&&Qa(I,{select:!0})):v===_&&x.preventDefault()}},[n,r,m.paused]);return a.jsx(Kt.div,{tabIndex:-1,...o,ref:f,onKeyDown:g})});G1.displayName=Tie;function Iie(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Qa(r,{select:e}),document.activeElement!==n)return}function Nie(t){const e=z$(t),n=jj(e,t),r=jj(e.reverse(),t);return[n,r]}function z$(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function jj(t,e){for(const n of t)if(!Pie(n,{upTo:e}))return n}function Pie(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Aie(t){return t instanceof HTMLInputElement&&"select"in t}function Qa(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&Aie(t)&&e&&t.select()}}var Dj=Rie();function Rie(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=Mj(t,e),t.unshift(e)},remove(e){var n;t=Mj(t,e),(n=t[0])==null||n.resume()}}}function Mj(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function kie(t){return t.filter(e=>e.tagName!=="A")}var vb=0;function G$(){p.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Lj()),document.body.insertAdjacentElement("beforeend",t[1]??Lj()),vb++,()=>{vb===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),vb--}},[])}function Lj(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var fs=function(){return fs=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},fs.apply(this,arguments)};function Wh(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function H$(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var xm="right-scroll-bar-position",vm="width-before-scroll-bar",jie="with-scroll-bars-hidden",Die="--removed-body-scroll-bar-size";function wb(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Mie(t,e){var n=p.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var Lie=typeof window<"u"?p.useLayoutEffect:p.useEffect,Fj=new WeakMap;function W$(t,e){var n=Mie(e||null,function(r){return t.forEach(function(s){return wb(s,r)})});return Lie(function(){var r=Fj.get(n);if(r){var s=new Set(r),i=new Set(t),o=n.current;s.forEach(function(l){i.has(l)||wb(l,null)}),i.forEach(function(l){s.has(l)||wb(l,o)})}Fj.set(n,t)},[t]),n}function Fie(t){return t}function Oie(t,e){e===void 0&&(e=Fie);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(l){return i(l)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var l=n;n=[],l.forEach(i),o=n}var c=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),n={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),n}}}};return s}function q$(t){t===void 0&&(t={});var e=Oie(null);return e.options=fs({async:!0,ssr:!1},t),e}var K$=function(t){var e=t.sideCar,n=Wh(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return p.createElement(r,fs({},n))};K$.isSideCarExport=!0;function Y$(t,e){return t.useMedium(e),K$}var J$=q$(),_b=function(){},s0=p.forwardRef(function(t,e){var n=p.useRef(null),r=p.useState({onScrollCapture:_b,onWheelCapture:_b,onTouchMoveCapture:_b}),s=r[0],i=r[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,m=t.noRelative,g=t.noIsolation,x=t.inert,E=t.allowPinchZoom,v=t.as,_=v===void 0?"div":v,S=t.gapMode,I=Wh(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),M=f,j=W$([n,e]),C=fs(fs({},I),s);return p.createElement(p.Fragment,null,d&&p.createElement(M,{sideCar:J$,removeScrollBar:u,shards:h,noRelative:m,noIsolation:g,inert:x,setCallbacks:i,allowPinchZoom:!!E,lockRef:n,gapMode:S}),o?p.cloneElement(p.Children.only(l),fs(fs({},C),{ref:j})):p.createElement(_,fs({},C,{className:c,ref:j}),l))});s0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};s0.classNames={fullWidth:vm,zeroRight:xm};var Oj,Vie=function(){if(Oj)return Oj;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function $ie(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Vie();return e&&t.setAttribute("nonce",e),t}function Uie(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Bie(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var zie=function(){var t=0,e=null;return{add:function(n){t==0&&(e=$ie())&&(Uie(e,n),Bie(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Gie=function(){var t=zie();return function(e,n){p.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},H1=function(){var t=Gie(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},Hie={left:0,top:0,right:0,gap:0},bb=function(t){return parseInt(t||"",10)||0},Wie=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[bb(n),bb(r),bb(s)]},qie=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Hie;var e=Wie(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},Kie=H1(),Xd="data-scroll-locked",Yie=function(t,e,n,r){var s=t.left,i=t.top,o=t.right,l=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(jie,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(Xd,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(xm,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(vm,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(xm," .").concat(xm,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(vm," .").concat(vm,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Xd,`] {
    `).concat(Die,": ").concat(l,`px;
  }
`)},Vj=function(){var t=parseInt(document.body.getAttribute(Xd)||"0",10);return isFinite(t)?t:0},Jie=function(){p.useEffect(function(){return document.body.setAttribute(Xd,(Vj()+1).toString()),function(){var t=Vj()-1;t<=0?document.body.removeAttribute(Xd):document.body.setAttribute(Xd,t.toString())}},[])},X$=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;Jie();var i=p.useMemo(function(){return qie(s)},[s]);return p.createElement(Kie,{styles:Yie(i,!e,s,n?"":"!important")})},KE=!1;if(typeof window<"u")try{var hy=Object.defineProperty({},"passive",{get:function(){return KE=!0,!0}});window.addEventListener("test",hy,hy),window.removeEventListener("test",hy,hy)}catch{KE=!1}var qu=KE?{passive:!1}:!1,Xie=function(t){return t.tagName==="TEXTAREA"},Q$=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!Xie(t)&&n[e]==="visible")},Qie=function(t){return Q$(t,"overflowY")},Zie=function(t){return Q$(t,"overflowX")},$j=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=Z$(t,r);if(s){var i=e3(t,r),o=i[1],l=i[2];if(o>l)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},eoe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},toe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},Z$=function(t,e){return t==="v"?Qie(e):Zie(e)},e3=function(t,e){return t==="v"?eoe(e):toe(e)},noe=function(t,e){return t==="h"&&e==="rtl"?-1:1},roe=function(t,e,n,r,s){var i=noe(t,window.getComputedStyle(e).direction),o=i*r,l=n.target,c=e.contains(l),u=!1,d=o>0,h=0,f=0;do{var m=e3(t,l),g=m[0],x=m[1],E=m[2],v=x-E-i*g;(g||v)&&Z$(t,l)&&(h+=v,f+=g),l=l.parentNode.host||l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&(s&&Math.abs(h)<1||!s&&o>h)||!d&&(s&&Math.abs(f)<1||!s&&-o>f))&&(u=!0),u},fy=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Uj=function(t){return[t.deltaX,t.deltaY]},Bj=function(t){return t&&"current"in t?t.current:t},soe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},ioe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},ooe=0,Ku=[];function aoe(t){var e=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(ooe++)[0],i=p.useState(H1)[0],o=p.useRef(t);p.useEffect(function(){o.current=t},[t]),p.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var x=H$([t.lockRef.current],(t.shards||[]).map(Bj),!0).filter(Boolean);return x.forEach(function(E){return E.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),x.forEach(function(E){return E.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=p.useCallback(function(x,E){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!o.current.allowPinchZoom;var v=fy(x),_=n.current,S="deltaX"in x?x.deltaX:_[0]-v[0],I="deltaY"in x?x.deltaY:_[1]-v[1],M,j=x.target,C=Math.abs(S)>Math.abs(I)?"h":"v";if("touches"in x&&C==="h"&&j.type==="range")return!1;var T=$j(C,j);if(!T)return!0;if(T?M=C:(M=C==="v"?"h":"v",T=$j(C,j)),!T)return!1;if(!r.current&&"changedTouches"in x&&(S||I)&&(r.current=M),!M)return!0;var P=r.current||M;return roe(P,E,x,P==="h"?S:I,!0)},[]),c=p.useCallback(function(x){var E=x;if(!(!Ku.length||Ku[Ku.length-1]!==i)){var v="deltaY"in E?Uj(E):fy(E),_=e.current.filter(function(M){return M.name===E.type&&(M.target===E.target||E.target===M.shadowParent)&&soe(M.delta,v)})[0];if(_&&_.should){E.cancelable&&E.preventDefault();return}if(!_){var S=(o.current.shards||[]).map(Bj).filter(Boolean).filter(function(M){return M.contains(E.target)}),I=S.length>0?l(E,S[0]):!o.current.noIsolation;I&&E.cancelable&&E.preventDefault()}}},[]),u=p.useCallback(function(x,E,v,_){var S={name:x,delta:E,target:v,should:_,shadowParent:loe(v)};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(I){return I!==S})},1)},[]),d=p.useCallback(function(x){n.current=fy(x),r.current=void 0},[]),h=p.useCallback(function(x){u(x.type,Uj(x),x.target,l(x,t.lockRef.current))},[]),f=p.useCallback(function(x){u(x.type,fy(x),x.target,l(x,t.lockRef.current))},[]);p.useEffect(function(){return Ku.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,qu),document.addEventListener("touchmove",c,qu),document.addEventListener("touchstart",d,qu),function(){Ku=Ku.filter(function(x){return x!==i}),document.removeEventListener("wheel",c,qu),document.removeEventListener("touchmove",c,qu),document.removeEventListener("touchstart",d,qu)}},[]);var m=t.removeScrollBar,g=t.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:ioe(s)}):null,m?p.createElement(X$,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function loe(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const coe=Y$(J$,aoe);var t3=p.forwardRef(function(t,e){return p.createElement(s0,fs({},t,{ref:e,sideCar:coe}))});t3.classNames=s0.classNames;const n3=t3;var uoe=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Yu=new WeakMap,my=new WeakMap,py={},Sb=0,r3=function(t){return t&&(t.host||r3(t.parentNode))},doe=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=r3(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},hoe=function(t,e,n,r){var s=doe(e,Array.isArray(t)?t:[t]);py[n]||(py[n]=new WeakMap);var i=py[n],o=[],l=new Set,c=new Set(s),u=function(h){!h||l.has(h)||(l.add(h),u(h.parentNode))};s.forEach(u);var d=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(f){if(l.has(f))d(f);else try{var m=f.getAttribute(r),g=m!==null&&m!=="false",x=(Yu.get(f)||0)+1,E=(i.get(f)||0)+1;Yu.set(f,x),i.set(f,E),o.push(f),x===1&&g&&my.set(f,!0),E===1&&f.setAttribute(n,"true"),g||f.setAttribute(r,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return d(e),l.clear(),Sb++,function(){o.forEach(function(h){var f=Yu.get(h)-1,m=i.get(h)-1;Yu.set(h,f),i.set(h,m),f||(my.has(h)||h.removeAttribute(r),my.delete(h)),m||h.removeAttribute(n)}),Sb--,Sb||(Yu=new WeakMap,Yu=new WeakMap,my=new WeakMap,py={})}},W1=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=e||uoe(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),hoe(r,s,n,"aria-hidden")):function(){return null}},i0="Dialog",[s3,i3]=Si(i0),[foe,yo]=s3(i0),o3=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,l=p.useRef(null),c=p.useRef(null),[u,d]=Pu({prop:r,defaultProp:s??!1,onChange:i,caller:i0});return a.jsx(foe,{scope:e,triggerRef:l,contentRef:c,contentId:Xc(),titleId:Xc(),descriptionId:Xc(),open:u,onOpenChange:d,onOpenToggle:p.useCallback(()=>d(h=>!h),[d]),modal:o,children:n})};o3.displayName=i0;var a3="DialogTrigger",l3=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=yo(a3,n),i=bn(e,s.triggerRef);return a.jsx(Kt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":Y1(s.open),...r,ref:i,onClick:wt(t.onClick,s.onOpenToggle)})});l3.displayName=a3;var q1="DialogPortal",[moe,c3]=s3(q1,{forceMount:void 0}),u3=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:s}=t,i=yo(q1,e);return a.jsx(moe,{scope:e,forceMount:n,children:p.Children.map(r,o=>a.jsx(Ms,{present:n||i.open,children:a.jsx(e0,{asChild:!0,container:s,children:o})}))})};u3.displayName=q1;var Ev="DialogOverlay",d3=p.forwardRef((t,e)=>{const n=c3(Ev,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=yo(Ev,t.__scopeDialog);return i.modal?a.jsx(Ms,{present:r||i.open,children:a.jsx(goe,{...s,ref:e})}):null});d3.displayName=Ev;var poe=xh("DialogOverlay.RemoveScroll"),goe=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=yo(Ev,n);return a.jsx(n3,{as:poe,allowPinchZoom:!0,shards:[s.contentRef],children:a.jsx(Kt.div,{"data-state":Y1(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),du="DialogContent",h3=p.forwardRef((t,e)=>{const n=c3(du,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=yo(du,t.__scopeDialog);return a.jsx(Ms,{present:r||i.open,children:i.modal?a.jsx(yoe,{...s,ref:e}):a.jsx(xoe,{...s,ref:e})})});h3.displayName=du;var yoe=p.forwardRef((t,e)=>{const n=yo(du,t.__scopeDialog),r=p.useRef(null),s=bn(e,n.contentRef,r);return p.useEffect(()=>{const i=r.current;if(i)return W1(i)},[]),a.jsx(f3,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:wt(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:wt(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:wt(t.onFocusOutside,i=>i.preventDefault())})}),xoe=p.forwardRef((t,e)=>{const n=yo(du,t.__scopeDialog),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(f3,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),f3=p.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,l=yo(du,n),c=p.useRef(null),u=bn(e,c);return G$(),a.jsxs(a.Fragment,{children:[a.jsx(G1,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(Zw,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":Y1(l.open),...o,ref:u,onDismiss:()=>l.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(woe,{titleId:l.titleId}),a.jsx(boe,{contentRef:c,descriptionId:l.descriptionId})]})]})}),K1="DialogTitle",m3=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=yo(K1,n);return a.jsx(Kt.h2,{id:s.titleId,...r,ref:e})});m3.displayName=K1;var p3="DialogDescription",g3=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=yo(p3,n);return a.jsx(Kt.p,{id:s.descriptionId,...r,ref:e})});g3.displayName=p3;var y3="DialogClose",x3=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=yo(y3,n);return a.jsx(Kt.button,{type:"button",...r,ref:e,onClick:wt(t.onClick,()=>s.onOpenChange(!1))})});x3.displayName=y3;function Y1(t){return t?"open":"closed"}var v3="DialogTitleWarning",[voe,w3]=$re(v3,{contentName:du,titleName:K1,docsSlug:"dialog"}),woe=({titleId:t})=>{const e=w3(v3),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return p.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},_oe="DialogDescriptionWarning",boe=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${w3(_oe).contentName}}.`;return p.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},_3=o3,Soe=l3,b3=u3,J1=d3,X1=h3,Q1=m3,Z1=g3,o0=x3;const ys=_3,Eoe=b3,ba=o0,S3=ct.forwardRef(({className:t,...e},n)=>a.jsx(J1,{ref:n,className:bt("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));S3.displayName=J1.displayName;const es=ct.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(Eoe,{children:[a.jsx(S3,{}),a.jsxs(X1,{ref:r,className:bt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,a.jsxs(o0,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(zo,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));es.displayName=X1.displayName;const ts=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});ts.displayName="DialogHeader";const Tr=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});Tr.displayName="DialogFooter";const ns=ct.forwardRef(({className:t,...e},n)=>a.jsx(Q1,{ref:n,className:bt("text-lg font-semibold leading-none tracking-tight",t),...e}));ns.displayName=Q1.displayName;const xo=ct.forwardRef(({className:t,...e},n)=>a.jsx(Z1,{ref:n,className:bt("text-sm text-muted-foreground",t),...e}));xo.displayName=Z1.displayName;const eI=$1("inline-flex items-center justify-center rounded-xl text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-foreground text-primary-foreground hover:bg-foreground/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-xl px-3",lg:"h-11 rounded-xl px-8",icon:"h-10 w-10 rounded-xl"}},defaultVariants:{variant:"default",size:"default"}}),V=ct.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},i)=>{const o=r?Bre:"button";return a.jsx(o,{className:bt(eI({variant:e,size:n,className:t})),ref:i,...s})});V.displayName="Button";const nt=ct.forwardRef(({className:t,type:e,...n},r)=>a.jsx("input",{type:e,className:bt("flex h-10 w-full rounded-xl bg-zinc-100 dark:bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-400 dark:placeholder:text-zinc-600 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n}));nt.displayName="Input";const ic="AIzaSyBcpnUVVBDNaBLG7Rj_cEmE0J4zNlHmg7o";async function E3(t){const e=new ar({apiKey:ic}),n={type:ze.ARRAY,items:{type:ze.STRING},description:"An array of 5 creative and catchy store name suggestions."};try{const r=`Suggest 5 creative and catchy store name options based on the following description or keywords: "${t}". Return exactly 5 suggestions.`,s=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:r}]}],config:{responseMimeType:"application/json",responseSchema:n}}),i=s.text;if(typeof i!="string"||i.trim()==="")throw console.error("Model did not return a text response for store name suggestions. Response:",JSON.stringify(s)),new Error("Model response for store name suggestions was empty or not a string.");try{const o=JSON.parse(i);return Array.isArray(o)&&o.every(l=>typeof l=="string")?{suggestions:o.slice(0,5).map(l=>l.trim()).filter(l=>l.length>0)}:(console.error("Parsed store name suggestions are not an array of strings:",o),{error:"AI response was not in the expected format (array of strings).",rawResponse:i})}catch(o){return console.error("Failed to parse JSON response for store names:",i,"ParseError:",o),{error:"Failed to parse store name suggestions from AI.",rawResponse:i}}}catch(r){return console.error("Error generating store name suggestions:",r),{error:`Error generating suggestions: ${r.message}`}}}async function C3(t){const e=new ar({apiKey:ic}),n={type:ze.OBJECT,properties:{heroTitle:{type:ze.STRING,description:"The catchy hero title for the store."},heroDescription:{type:ze.STRING,description:"A short (1-2 sentences) engaging hero description."}},required:["heroTitle","heroDescription"]},{name:r,niche:s,description:i,targetAudience:o,style:l}=t;let c=`Generate a compelling hero title and a short, engaging hero description for an online store.
Store Name: ${r||"N/A"}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of products."}
Target Audience: ${o||"General consumers"}
Style/Vibe: ${l||"Modern and friendly"}

Return the hero title and description as a JSON object matching the schema.`;try{const u=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:c}]}],config:{responseMimeType:"application/json",responseSchema:n}}),d=u.text;if(typeof d!="string"||d.trim()==="")throw console.error("Model did not return a text response for hero content. Response:",JSON.stringify(u)),new Error("Model response for hero content was empty or not a string.");try{const h=JSON.parse(d);return h&&typeof h.heroTitle=="string"&&typeof h.heroDescription=="string"?{heroTitle:h.heroTitle,heroDescription:h.heroDescription}:(console.error("Parsed hero content is not in the expected format:",h),{error:"AI response was not in the expected format for hero content.",rawResponse:d})}catch(h){return console.error("Failed to parse JSON response for hero content:",d,"ParseError:",h),{error:"Failed to parse hero content from AI.",rawResponse:d}}}catch(u){return console.error("Error generating hero content:",u),{error:`Error generating hero content: ${u.message}`}}}async function Coe(t){if(!t||!t.name)return console.error("Product information (at least name) is required for image prompt suggestions."),{error:"Product information required."};const e=new ar({apiKey:ic}),{name:n,description:r,niche:s,storeName:i}=t,o={type:ze.ARRAY,items:{type:ze.STRING},description:"An array of 6 diverse and creative text prompts for AI image generation related to a product."};let l=`product named "${n}"`;r&&(l+=` with description "${r}"`),i&&(l+=` from a store called "${i}"`),s&&(l+=` in the "${s}" niche`);const c=`Based on a ${l}, generate 6 diverse and creative text prompts suitable for AI image generation. These prompts should aim to create visually appealing images for marketing this product. Examples: "A dynamic shot of [product name] on a clean, modern background with soft lighting", "Lifestyle image of [product name] being used by a happy customer in a [relevant setting]", "Close-up detail of [product name]'s unique feature with artistic blur". Return exactly 6 prompt suggestions.`;try{const u=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:c}]}],config:{responseMimeType:"application/json",responseSchema:o}}),d=u.text;if(typeof d!="string"||d.trim()==="")throw console.error("Model did not return a text response for image prompt suggestions. Response:",JSON.stringify(u)),new Error("Model response for image prompt suggestions was empty or not a string.");try{const h=JSON.parse(d);return Array.isArray(h)&&h.every(f=>typeof f=="string")?{suggestions:h.slice(0,6).map(f=>f.trim()).filter(f=>f.length>0)}:(console.error("Parsed image prompt suggestions are not an array of strings:",h),{error:"AI response was not in the expected format for image prompts (array of strings).",rawResponse:d})}catch(h){return console.error("Failed to parse JSON response for image prompt suggestions:",d,"ParseError:",h),{error:"Failed to parse image prompt suggestions from AI.",rawResponse:d}}}catch(u){return console.error("Error generating image prompt suggestions:",u),{error:`Error generating image prompt suggestions: ${u.message}`}}}async function Toe(t){const e=new ar({apiKey:ic}),n={name:"extract_store_name",description:`Extracts the desired store name if explicitly mentioned in the prompt using phrases like "store called 'My Store'", "named 'My Store'", or "store 'My Store'". The name should be the direct object of such phrases.`,parameters:{type:ze.OBJECT,properties:{storeName:{type:ze.STRING,description:"The explicitly mentioned name of the store."}},required:["storeName"]}};try{const i=(await e.getGenerativeModel({model:"gemini-pro"}).generateContent({contents:[{role:"user",parts:[{text:t}]}],tools:[{functionDeclarations:[n]}]})).response.functionCalls();return i&&i.length>0&&i[0].name==="extract_store_name"&&i[0].args&&i[0].args.storeName?(console.log(`[extractExplicitStoreName] Gemini identified store name: ${i[0].args.storeName}`),i[0].args.storeName):(console.log("[extractExplicitStoreName] Gemini did not identify an explicit store name via function call."),null)}catch(r){return console.error("Error during Gemini store name extraction:",r),null}}async function T3(t){const e=new ar({apiKey:ic}),n={type:ze.OBJECT,properties:{title:{type:ze.STRING,description:"The main title for 'The [StoreName] Way' section (e.g., 'The AwesomeStore Way')."},subtitle:{type:ze.STRING,description:"A short, engaging subtitle for this section (1-2 sentences)."},items:{type:ze.ARRAY,description:"An array of 3 to 4 items representing the store's core values or unique selling points.",items:{type:ze.OBJECT,properties:{emoji:{type:ze.STRING,description:"A single relevant emoji for the item (e.g., '✨', '🌿')."},title:{type:ze.STRING,description:"A short title for the item (2-4 words)."},description:{type:ze.STRING,description:"A brief description of the item (10-20 words)."}},required:["emoji","title","description"]},minItems:3,maxItems:4}},required:["title","subtitle","items"]},{name:r,niche:s,description:i,targetAudience:o,style:l}=t,c=r||"Our Store";let u=`Generate content for "The ${c} Way" section of an online store. This section highlights the store's core values and what makes it unique.
Store Name: ${c}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of quality products."}
Target Audience: ${o||"General consumers"}
Style/Vibe: ${l||"Modern and customer-focused"}

The content should include:
1.  A main title (e.g., "The ${c} Way"). This title should dynamically incorporate the actual store name.
2.  A short subtitle (1-2 sentences) that is specific and engaging for this store.
3.  3 to 4 items, each with:
    *   A unique and highly relevant emoji that visually represents the item's theme and is specific to this store's niche/style/keywords. This emoji is mandatory and must not be a generic placeholder. For example, if the store sells coffee, an emoji like ☕ or 🌿 (for organic beans) would be appropriate. If it's a tech store, 💡 or 🚀.
    *   A short, catchy title for the item (2-4 words, e.g., "Artisanal Roasts", "Cutting-Edge Tech"). This title must be specific to the store's theme.
    *   A brief description (10-20 words) elaborating on the item's title, specific to the store's values and offerings.

Return this content as a JSON object matching the schema. Ensure all text content and emojis are distinct, creative, and directly reflect the store's unique characteristics and offerings. Do not use generic examples in the output.`;try{const d=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:u}]}],config:{responseMimeType:"application/json",responseSchema:n}}),h=d.text;if(typeof h!="string"||h.trim()==="")throw console.error("Model did not return a text response for store way content. Response:",JSON.stringify(d)),new Error("Model response for store way content was empty or not a string.");try{const f=JSON.parse(h);return f&&typeof f.title=="string"&&typeof f.subtitle=="string"&&Array.isArray(f.items)&&f.items.length>=3&&f.items.length<=4&&f.items.every(m=>typeof m.emoji=="string"&&m.emoji.length>0&&typeof m.title=="string"&&typeof m.description=="string")?(f.title=`The ${c} Way`,f):(console.error("Parsed store way content is not in the expected format:",f),{error:"AI response was not in the expected format for store way content.",rawResponse:h})}catch(f){return console.error("Failed to parse JSON response for store way content:",h,"ParseError:",f),{error:"Failed to parse store way content from AI.",rawResponse:h}}}catch(d){return console.error("Error generating store way content:",d),{error:`Error generating store way content: ${d.message}`}}}async function I3(t){const e=[{iconName:"Truck",title:"Fast Shipping",description:"Get your orders delivered quickly and reliably."},{iconName:"ShieldCheck",title:"Secure Payments",description:"Shop with confidence using our secure payment gateways."},{iconName:"MessageSquare",title:"24/7 Support",description:"Our dedicated team is here to help you around the clock."},{iconName:"Repeat",title:"Easy Returns",description:"Hassle-free return and exchange policy if you're not satisfied."},{iconName:"Award",title:"Quality Guaranteed",description:"We stand by the quality of our products."},{iconName:"Gift",title:"Gift Options",description:"Special gift wrapping and messaging available."}],n=[{iconName:"Users",number:"10K+",label:"Active Users"},{iconName:"Star",number:"4.8",label:"Avg. Rating"},{iconName:"PackageCheck",number:"20K+",label:"Orders Shipped"},{iconName:"ShieldCheck",number:"100%",label:"Secure Checkout"},{iconName:"ThumbsUp",number:"95%",label:"Positive Feedback"},{iconName:"Globe",number:"Worldwide",label:"Shipping"}],r=new ar({apiKey:ic}),s={type:ze.OBJECT,properties:{title:{type:ze.STRING,description:"Main title for the features/experience section (e.g., 'An Exceptional Experience')."},subtitle:{type:ze.STRING,description:"Engaging subtitle for the features section (1-2 sentences)."},items:{type:ze.ARRAY,description:"An array of 3 to 4 feature items highlighting key store benefits.",items:{type:ze.OBJECT,properties:{emoji:{type:ze.STRING,description:"A single relevant emoji for the feature (e.g., '🛡️', '🌍', '💎')."},title:{type:ze.STRING,description:"Short title for the feature (2-4 words, e.g., 'Secure Payments', 'Global Reach')."},description:{type:ze.STRING,description:"Brief description of the feature (10-20 words)."}},required:["emoji","title","description"]},minItems:3,maxItems:4},secondaryItems:{type:ze.ARRAY,description:"An array of up to 4 secondary feature items highlighting broader store benefits or values. The function will ensure 4 items are present by adding defaults if needed.",items:{type:ze.OBJECT,properties:{iconName:{type:ze.STRING,description:"Name of a Lucide icon (e.g., 'GlobeIcon', 'AwardIcon', 'UsersIcon', 'HeartIcon') for the secondary feature."},title:{type:ze.STRING,description:"Short title for the secondary feature (2-4 words, e.g., 'Global Shipping', 'Quality Assured')."},description:{type:ze.STRING,description:"Brief description of the secondary feature (10-15 words)."}},required:["iconName","title","description"]},minItems:0,maxItems:4},statsItems:{type:ze.ARRAY,description:"An array of exactly 4 stat items highlighting key metrics or achievements.",items:{type:ze.OBJECT,properties:{iconName:{type:ze.STRING,description:"Name of a Lucide icon for the stat (e.g., 'UsersIcon', 'StarIcon', 'ZapIcon')."},number:{type:ze.STRING,description:"The statistic value (e.g., '50K+', '99.9%', '4.9')."},label:{type:ze.STRING,description:"The label for the statistic (e.g., 'Happy Customers', 'Uptime', 'Average Rating')."}},required:["iconName","number","label"]},minItems:4,maxItems:4}},required:["title","subtitle","items","secondaryItems","statsItems"]},{name:i,niche:o,description:l,targetAudience:c,style:u}=t,d=i||"Our Store";let h=`Generate content for a store features section, often titled "An Exceptional Experience" or similar, for an online store named "${d}".
This section should highlight key benefits and unique selling propositions.
Store Name: ${d}
Niche: ${o||"General E-commerce"}
Description/Keywords: ${l||"A variety of quality products."}
Target Audience: ${c||"General consumers"}
Style/Vibe: ${u||"Modern and customer-focused"}

The content should include:
1.  A main title for the section (e.g., "Why Choose Us?", "Our Commitment to You", "An Exceptional Experience").
2.  A short, engaging subtitle (1-2 sentences).
3.  3 to 4 feature items, each with:
    *   A unique and highly relevant emoji that visually represents the feature (e.g., ✨ for innovation,  for eco-friendly,  for smart tech). This emoji is mandatory and must be specific to the feature's theme.
    *   A short, catchy, and descriptive title for the feature (2-5 words, e.g., "Innovative Designs", "Sustainable Materials", "Smart Home Solutions"). This title will be used to search for a relevant background video, so make it evocative.
    *   A brief description (10-20 words) explaining the benefit of the feature.
4.  Up to 4 secondary feature items (the system will ensure 4 by adding defaults if fewer are provided by AI), each with:
    *   An \`iconName\` string representing a Lucide icon (e.g., "GlobeIcon", "AwardIcon", "UsersIcon", "HeartIcon"). Choose an icon name that best fits the feature. Examples: GlobeIcon, AwardIcon, UsersIcon, HeartIcon, PackageIcon, ShieldIcon, ZapIcon.
    *   A short title for the secondary feature (2-4 words, e.g., "Global Shipping", "Quality Assured", "Community Love", "Eco-Friendly Focus").
    *   A brief description (10-15 words) for the secondary feature. These should highlight broader store values or benefits.
5.  Exactly 4 stat items, each with:
    *   An \`iconName\` string for a Lucide icon (e.g., "UsersIcon", "StarIcon", "ZapIcon", "PackageIcon").
    *   A \`number\` or key metric (e.g., "50K+", "99.9%", "4.9", "1M+"). Avoid including symbols like ★ in the number string itself.
    *   A descriptive \`label\` (e.g., "Happy Customers", "Uptime Guarantee", "Average Rating", "Units Sold").

Return this content as a JSON object matching the schema. Ensure all text content, emojis, and iconNames are distinct, creative, and directly reflect positive attributes of a store like "${d}". Do not use generic examples in the output. Examples of main features could be related to payment security, shipping, product quality, customer service. Secondary features could be about global reach, quality assurance, community, sustainability etc. Stats should reflect plausible achievements or service levels for a store selling "${o||"various items"}".`;try{const f=await r.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:h}]}],config:{responseMimeType:"application/json",responseSchema:s}}),m=f.text;if(typeof m!="string"||m.trim()==="")throw console.error("Model did not return a text response for store features content. Response:",JSON.stringify(f)),new Error("Model response for store features content was empty or not a string.");try{const g=JSON.parse(m);if(g&&typeof g.title=="string"&&typeof g.subtitle=="string"&&Array.isArray(g.items)&&g.items.length>=3&&g.items.length<=4&&g.items.every(x=>typeof x.emoji=="string"&&x.emoji.length>0&&typeof x.title=="string"&&typeof x.description=="string")){let x=[];g.secondaryItems&&Array.isArray(g.secondaryItems)&&(x=g.secondaryItems.filter(S=>S&&typeof S.iconName=="string"&&S.iconName.length>0&&typeof S.title=="string"&&S.title.length>0&&typeof S.description=="string"&&S.description.length>0).slice(0,4));const E=4-x.length;if(E>0){const S=new Set(x.map(M=>M.title)),I=e.filter(M=>!S.has(M.title)).slice(0,E);x.push(...I)}g.secondaryItems=x.slice(0,4);let v=[];g.statsItems&&Array.isArray(g.statsItems)&&(v=g.statsItems.filter(S=>S&&typeof S.iconName=="string"&&S.iconName.length>0&&typeof S.number=="string"&&S.number.length>0&&typeof S.label=="string"&&S.label.length>0).slice(0,4));const _=4-v.length;if(_>0){const S=new Set(v.map(M=>M.label)),I=n.filter(M=>!S.has(M.label)).slice(0,_);v.push(...I)}return g.statsItems=v.slice(0,4),Array.isArray(g.secondaryItems)&&g.secondaryItems.every(S=>typeof S.iconName=="string"&&S.iconName.length>0&&typeof S.title=="string"&&typeof S.description=="string")&&Array.isArray(g.statsItems)&&g.statsItems.length===4&&g.statsItems.every(S=>typeof S.iconName=="string"&&S.iconName.length>0&&typeof S.number=="string"&&S.number.length>0&&typeof S.label=="string"&&S.label.length>0)?g:(console.error("Parsed store features content is not in the expected format after padding/validation:",g),(!g.statsItems||g.statsItems.length!==4)&&(console.warn("Stats items still not 4, forcing defaults for stats."),g.statsItems=n.slice(0,4)),(!g.secondaryItems||g.secondaryItems.length===0)&&(console.warn("Secondary items empty, forcing defaults for secondary."),g.secondaryItems=e.slice(0,Math.min(4,e.length))),g.title&&g.subtitle&&g.items?g:{error:"AI response format error after final processing.",rawResponse:m,processedContent:g})}else return console.error("Initial parsed store features content structure is invalid:",g),{error:"AI response (initial structure) was not in the expected format for store features content.",rawResponse:m}}catch(g){return console.error("Failed to parse JSON response for store features content:",m,"ParseError:",g),{error:"Failed to parse store features content from AI.",rawResponse:m}}}catch(f){return console.error("Error generating store features content:",f),{error:`Error generating store features content: ${f.message}`}}}async function N3(t){const e=new ar({apiKey:ic}),n={type:ze.OBJECT,properties:{title:{type:ze.STRING,description:"Catchy title for a section highlighting craftsmanship/quality (e.g., 'Our Commitment to Quality')."},subtitle:{type:ze.STRING,description:"Engaging subtitle (1-2 sentences) related to the title."},text:{type:ze.STRING,description:"Main descriptive text (2-3 sentences) about the store's dedication to quality, materials, or process."},listItems:{type:ze.ARRAY,description:"An array of 3-4 short bullet points (3-5 words each) highlighting key aspects (e.g., 'Premium Materials', 'Expert Craftsmanship').",items:{type:ze.STRING},minItems:3,maxItems:4},ctaText:{type:ze.STRING,description:"Call to action button text (e.g., 'Explore Our Process', 'Learn More')."}},required:["title","subtitle","text","listItems","ctaText"]},{name:r,niche:s,description:i}=t,o=t.productExamples?`Key products include: ${t.productExamples}.`:"The store offers a range of specialized gear.",l=`Generate content for a website section for a store with a "sharp" and "tactical" aesthetic. This section has an image on the right and text on the left, emphasizing the store's precision, quality, craftsmanship, or unique process.
Store Name: "${r||"Our Store"}"
Niche/Type: "${s||"high-performance gear"}"
Store Description: "${i||"A store dedicated to excellence and precision."}"
${o}
Generate a title, subtitle, main text (2-3 sentences), 3-4 list items (3-5 words each), and a CTA button text.
The tone should be bold, confident, and precise, fitting a high-tech or tactical brand.
Focus on aspects like durability, advanced technology, expert design, or mission-readiness.
Return as a JSON object matching the schema.`;try{const u=(await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:l}]}],config:{responseMimeType:"application/json",responseSchema:n}})).text;if(!(u!=null&&u.trim()))throw new Error("Empty response from AI.");const d=JSON.parse(u);return d.title&&d.subtitle&&d.text&&Array.isArray(d.listItems)&&d.listItems.length>=3&&d.ctaText?d:(console.error("Invalid structure from AI for ImageRightSection:",d),{error:"AI response format error for ImageRightSection.",rawResponse:u})}catch(c){return console.error("Error generating ImageRightSection content:",c),{error:`Error generating ImageRightSection content: ${c.message}`}}}async function P3(t){const e=new ar({apiKey:ic}),n={type:ze.OBJECT,properties:{title:{type:ze.STRING,description:"Catchy title for a section showcasing a product or brand story via video (e.g., 'Experience the Difference')."},subtitle:{type:ze.STRING,description:"Engaging subtitle (1-2 sentences) related to the video's theme."},text:{type:ze.STRING,description:"Main descriptive text (2-3 sentences) complementing the video."},listItems:{type:ze.ARRAY,description:"An array of 2-3 short bullet points (3-5 words each) highlighting key takeaways or features shown in a video.",items:{type:ze.STRING},minItems:2,maxItems:3},ctaText:{type:ze.STRING,description:"Call to action button text (e.g., 'Watch Now', 'See It In Action')."}},required:["title","subtitle","text","listItems","ctaText"]},{name:r,niche:s,description:i}=t,o=t.productExamples?`The video might showcase products like: ${t.productExamples}.`:"The video showcases our innovative products.",l=`Generate content for a website section for a store with a "sharp" and "tactical" aesthetic. This section has a video on the left and text on the right, aiming to engage users with a dynamic visual story or product demonstration.
Store Name: "${r||"Our Store"}"
Niche/Type: "${s||"cutting-edge solutions"}"
Store Description: "${i||"A store focused on performance and innovation."}"
${o}
Generate a title, subtitle, main text (2-3 sentences), 2-3 list items (3-5 words each highlighting video takeaways), and a CTA button text.
The tone should be energetic, impactful, and forward-thinking, suitable for a high-performance brand.
Focus on action, benefits, or the experience the video portrays.
Return as a JSON object matching the schema.`;try{const u=(await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:l}]}],config:{responseMimeType:"application/json",responseSchema:n}})).text;if(!(u!=null&&u.trim()))throw new Error("Empty response from AI.");const d=JSON.parse(u);return d.title&&d.subtitle&&d.text&&Array.isArray(d.listItems)&&d.listItems.length>=2&&d.ctaText?d:(console.error("Invalid structure from AI for VideoLeftSection:",d),{error:"AI response format error for VideoLeftSection.",rawResponse:u})}catch(c){return console.error("Error generating VideoLeftSection content:",c),{error:`Error generating VideoLeftSection content: ${c.message}`}}}const Ln=ct.forwardRef(({className:t,...e},n)=>a.jsx("textarea",{className:bt("flex min-h-[80px] w-full rounded-xl bg-zinc-100 dark:bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-zinc-400 dark:placeholder:text-zinc-600 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));Ln.displayName="Textarea";var Ioe="Label",A3=p.forwardRef((t,e)=>a.jsx(Kt.label,{...t,ref:e,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));A3.displayName=Ioe;var R3=A3;const Re=ct.forwardRef(({className:t,...e},n)=>a.jsx(R3,{ref:n,className:bt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...e}));Re.displayName=R3.displayName;var Noe=p.createContext(void 0);function a0(t){const e=p.useContext(Noe);return t||e||"ltr"}var Eb="rovingFocusGroup.onEntryFocus",Poe={bubbles:!1,cancelable:!0},Kp="RovingFocusGroup",[YE,k3,Aoe]=D1(Kp),[Roe,l0]=Si(Kp,[Aoe]),[koe,joe]=Roe(Kp),j3=p.forwardRef((t,e)=>a.jsx(YE.Provider,{scope:t.__scopeRovingFocusGroup,children:a.jsx(YE.Slot,{scope:t.__scopeRovingFocusGroup,children:a.jsx(Doe,{...t,ref:e})})}));j3.displayName=Kp;var Doe=p.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=t,f=p.useRef(null),m=bn(e,f),g=a0(i),[x,E]=Pu({prop:o,defaultProp:l??null,onChange:c,caller:Kp}),[v,_]=p.useState(!1),S=Cr(u),I=k3(n),M=p.useRef(!1),[j,C]=p.useState(0);return p.useEffect(()=>{const T=f.current;if(T)return T.addEventListener(Eb,S),()=>T.removeEventListener(Eb,S)},[S]),a.jsx(koe,{scope:n,orientation:r,dir:g,loop:s,currentTabStopId:x,onItemFocus:p.useCallback(T=>E(T),[E]),onItemShiftTab:p.useCallback(()=>_(!0),[]),onFocusableItemAdd:p.useCallback(()=>C(T=>T+1),[]),onFocusableItemRemove:p.useCallback(()=>C(T=>T-1),[]),children:a.jsx(Kt.div,{tabIndex:v||j===0?-1:0,"data-orientation":r,...h,ref:m,style:{outline:"none",...t.style},onMouseDown:wt(t.onMouseDown,()=>{M.current=!0}),onFocus:wt(t.onFocus,T=>{const P=!M.current;if(T.target===T.currentTarget&&P&&!v){const A=new CustomEvent(Eb,Poe);if(T.currentTarget.dispatchEvent(A),!A.defaultPrevented){const D=I().filter(K=>K.focusable),R=D.find(K=>K.active),k=D.find(K=>K.id===x),B=[R,k,...D].filter(Boolean).map(K=>K.ref.current);L3(B,d)}}M.current=!1}),onBlur:wt(t.onBlur,()=>_(!1))})})}),D3="RovingFocusGroupItem",M3=p.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:o,...l}=t,c=Xc(),u=i||c,d=joe(D3,n),h=d.currentTabStopId===u,f=k3(n),{onFocusableItemAdd:m,onFocusableItemRemove:g,currentTabStopId:x}=d;return p.useEffect(()=>{if(r)return m(),()=>g()},[r,m,g]),a.jsx(YE.ItemSlot,{scope:n,id:u,focusable:r,active:s,children:a.jsx(Kt.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...l,ref:e,onMouseDown:wt(t.onMouseDown,E=>{r?d.onItemFocus(u):E.preventDefault()}),onFocus:wt(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:wt(t.onKeyDown,E=>{if(E.key==="Tab"&&E.shiftKey){d.onItemShiftTab();return}if(E.target!==E.currentTarget)return;const v=Foe(E,d.orientation,d.dir);if(v!==void 0){if(E.metaKey||E.ctrlKey||E.altKey||E.shiftKey)return;E.preventDefault();let S=f().filter(I=>I.focusable).map(I=>I.ref.current);if(v==="last")S.reverse();else if(v==="prev"||v==="next"){v==="prev"&&S.reverse();const I=S.indexOf(E.currentTarget);S=d.loop?Ooe(S,I+1):S.slice(I+1)}setTimeout(()=>L3(S))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:x!=null}):o})})});M3.displayName=D3;var Moe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Loe(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Foe(t,e,n){const r=Loe(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Moe[r]}function L3(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function Ooe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var F3=j3,O3=M3,c0="Tabs",[Voe,_ke]=Si(c0,[l0]),V3=l0(),[$oe,tI]=Voe(c0),$3=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...u}=t,d=a0(l),[h,f]=Pu({prop:r,onChange:s,defaultProp:i??"",caller:c0});return a.jsx($oe,{scope:n,baseId:Xc(),value:h,onValueChange:f,orientation:o,dir:d,activationMode:c,children:a.jsx(Kt.div,{dir:d,"data-orientation":o,...u,ref:e})})});$3.displayName=c0;var U3="TabsList",B3=p.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...s}=t,i=tI(U3,n),o=V3(n);return a.jsx(F3,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:r,children:a.jsx(Kt.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});B3.displayName=U3;var z3="TabsTrigger",G3=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=t,o=tI(z3,n),l=V3(n),c=q3(o.baseId,r),u=K3(o.baseId,r),d=r===o.value;return a.jsx(O3,{asChild:!0,...l,focusable:!s,active:d,children:a.jsx(Kt.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...i,ref:e,onMouseDown:wt(t.onMouseDown,h=>{!s&&h.button===0&&h.ctrlKey===!1?o.onValueChange(r):h.preventDefault()}),onKeyDown:wt(t.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(r)}),onFocus:wt(t.onFocus,()=>{const h=o.activationMode!=="manual";!d&&!s&&h&&o.onValueChange(r)})})})});G3.displayName=z3;var H3="TabsContent",W3=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...o}=t,l=tI(H3,n),c=q3(l.baseId,r),u=K3(l.baseId,r),d=r===l.value,h=p.useRef(d);return p.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),a.jsx(Ms,{present:s||d,children:({present:f})=>a.jsx(Kt.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:u,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});W3.displayName=H3;function q3(t,e){return`${t}-trigger-${e}`}function K3(t,e){return`${t}-content-${e}`}var Uoe=$3,Y3=B3,J3=G3,X3=W3;const Ei=Uoe,Qs=ct.forwardRef(({className:t,...e},n)=>a.jsx(Y3,{ref:n,className:bt("inline-flex h-10 items-center justify-center rounded-xl bg-zinc-100 dark:bg-custom-dark-grey p-1 text-muted-foreground",t),...e}));Qs.displayName=Y3.displayName;const Bt=ct.forwardRef(({className:t,...e},n)=>a.jsx(J3,{ref:n,className:bt("inline-flex items-center justify-center whitespace-nowrap rounded-xl px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-zinc-200 data-[state=active]:dark:bg-zinc-700 data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));Bt.displayName=J3.displayName;const zt=ct.forwardRef(({className:t,...e},n)=>a.jsx(X3,{ref:n,className:bt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));zt.displayName=X3.displayName;var Boe="Separator",zj="horizontal",zoe=["horizontal","vertical"],Q3=p.forwardRef((t,e)=>{const{decorative:n,orientation:r=zj,...s}=t,i=Goe(r)?r:zj,l=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return a.jsx(Kt.div,{"data-orientation":i,...l,...s,ref:e})});Q3.displayName=Boe;function Goe(t){return zoe.includes(t)}var Z3=Q3;const Sa=ct.forwardRef(({className:t,orientation:e="horizontal",decorative:n=!0,...r},s)=>a.jsx(Z3,{ref:s,decorative:n,orientation:e,className:bt("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...r}));Sa.displayName=Z3.displayName;const eU="AIzaSyBcpnUVVBDNaBLG7Rj_cEmE0J4zNlHmg7o";console.log("[geminiImageGeneration Module] VITE_GEMINI_API_KEY loaded:",`"${eU.substring(0,5)}..."`);const tU="YsU4YZtXedeyLPn6bQaNT8PD";console.log("[geminiImageGeneration Module] VITE_REMOVE_BG_API_KEY loaded:",`"${tU.substring(0,5)}..."`);const oc=eU,nI=tU,Go=[{category:Ur.HARM_CATEGORY_HARASSMENT,threshold:Br.BLOCK_NONE},{category:Ur.HARM_CATEGORY_HATE_SPEECH,threshold:Br.BLOCK_NONE},{category:Ur.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Br.BLOCK_NONE},{category:Ur.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Br.BLOCK_NONE}];async function Hoe(t,e,n){var r;try{const s=[{inlineData:{mimeType:e,data:t}},{text:"Describe the main colors of this logo. Is it primarily black, white, or colorful? If black or white, state which. If colorful, list the dominant colors."}],i=await n.models.generateContent({model:"gemini-2.0-flash",contents:s,safetySettings:Go,config:{responseModalities:[Rn.TEXT]}}),o=((r=i==null?void 0:i.text)==null?void 0:r.toLowerCase())||"";return console.log("[getLogoColorType] Gemini color description:",o),o.includes("primarily black")||o.includes("black logo")?"black":o.includes("primarily white")||o.includes("white logo")?"white":(o.includes("colorful")||o.includes("multiple colors")||o.includes("various colors")||console.warn("[getLogoColorType] Could not clearly determine logo color type. Defaulting to 'colored'. Desc:",o),"colored")}catch(s){return console.error("[getLogoColorType] Error analyzing logo color:",s),"colored"}}async function Yp(t,e=(n,r)=>console.log(`Logo Progress: ${n}%, Message: ${r||""}`)){var l,c,u,d;if(!t)throw new Error("Store name is required.");const n=new ar({apiKey:oc}),r=`Create a modern, clean, and professional logo for an e-commerce store named "${t}". The logo should be suitable for a website header. Avoid text in the logo itself, or if text is present, ensure it is "${t}" and highly legible. Focus on an iconic and memorable design. Generate a square image. The main subject of the logo should be prominent.`;let s="",i=null,o=null;try{console.log("[generateLogoWithGemini] Generating initial logo for:",t),e(void 0,`Generating initial logo for ${t}...`);const h=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Go,config:{responseModalities:[Rn.TEXT,Rn.IMAGE]}});if((u=(c=(l=h.candidates)==null?void 0:l[0])==null?void 0:c.content)!=null&&u.parts){for(const _ of h.candidates[0].content.parts)if(_.text)s+=_.text;else if((d=_.inlineData)!=null&&d.data){i=_.inlineData.data,o=_.inlineData.mimeType;break}}if(!i)throw new Error("Failed to generate initial image data. "+(s||"No text explanation."));console.log("[generateLogoWithGemini] Initial logo generated. MimeType:",o);let f=null,m=null,g=i,x=o;if(nI)try{console.log("[generateLogoWithGemini] Removing background."),e(void 0,"Removing logo background..."),g=await nU(i,o),x="image/png",console.log("[generateLogoWithGemini] Background removed."),e(void 0,"Background removed.")}catch(_){console.warn("[generateLogoWithGemini] BG removal failed, using original:",_.message),e(void 0,"Background removal failed.")}const E=await Hoe(g,x,n),v=`data:${x};base64,${g}`;if(E==="black"){m=v;try{const _=await $l(g,x,"Convert this black logo to a white logo, maintaining transparency and all details precisely. Output only the modified image.");if(_.editedImageData)f=`data:${_.newMimeType};base64,${_.editedImageData}`;else throw new Error("Inversion to white failed.")}catch(_){console.warn("[generateLogoWithGemini] Failed to make white version:",_.message),f=v}}else if(E==="white"){f=v;try{const _=await $l(g,x,"Convert this white logo to a black logo, maintaining transparency and all details precisely. Output only the modified image.");if(_.editedImageData)m=`data:${_.newMimeType};base64,${_.editedImageData}`;else throw new Error("Inversion to black failed.")}catch(_){console.warn("[generateLogoWithGemini] Failed to make black version:",_.message),m=v}}else f=v,m=v;return{logoUrlLight:f,logoUrlDark:m,textResponse:s}}catch(h){throw console.error("[generateLogoWithGemini] Main error:",h.message,h.stack),new Error(`Logo generation failed: ${h.message||"Unknown error"}`)}}async function kd(t,e,n){if(!t||!e)throw new Error("Image data and MIME type required for caption.");const r=new ar({apiKey:oc}),s={type:ze.ARRAY,items:{type:ze.STRING},description:"Array of 3 distinct caption options."};let o=n||"Generate 3 distinct, short, punchy social media reel style captions for this product image. No emojis/hashtags. Clean strings. E.g., 'Fresh drop! Cop yours now.'";n&&!n.toLowerCase().includes("3 options")&&!n.toLowerCase().includes("array of captions")&&(o=`Generate an array of 3 distinct caption options based on: "${n}". Style: social media reel. No emojis/hashtags.`);try{const l=[{inlineData:{mimeType:e,data:t}},{text:o}],u=(await r.models.generateContent({model:"gemini-2.0-flash",contents:l,safetySettings:Go,config:{responseMimeType:"application/json",responseSchema:s}})).text;if(typeof u!="string"||!u.trim())throw new Error("Model response empty or not string.");const d=JSON.parse(u);if(Array.isArray(d)&&d.every(h=>typeof h=="string")){const h=d.map(f=>f.trim().replace(/\*/g,"")).filter(f=>f.length>0);return h.length>0?h:["Generated image description."]}throw new Error("Parsed JSON not array of strings.")}catch(l){return console.error("[generateCaptionForImageData] Error:",l.message),[l.message.substring(0,100)||"Could not generate caption."]}}function Woe(t,e){const n=atob(t),r=new Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return new Blob([new Uint8Array(r)],{type:e})}async function nU(t,e){const n=Woe(t,e),r=new FormData;r.append("size","auto"),r.append("image_file",n,"logo_temp"+(e.startsWith("image/")?"."+e.substring(6):".bin")),r.append("format","png");try{const s=await fetch("https://api.remove.bg/v1.0/removebg",{method:"POST",headers:{"X-Api-Key":nI},body:r});if(!s.ok){const o=await s.text();throw new Error(`Remove.bg API Error ${s.status}: ${o}`)}const i=await s.arrayBuffer();return btoa(new Uint8Array(i).reduce((o,l)=>o+String.fromCharCode(l),""))}catch(s){throw console.error("[removeBackgroundFromLogo] Error:",s.message),s}}async function $l(t,e,n){var i,o,l,c;if(!t||!e||!n)throw new Error("Image data, MIME type, and prompt required.");const r=new ar({apiKey:oc}),s=[{text:n},{inlineData:{mimeType:e,data:t}}];try{const u=await r.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:s,safetySettings:Go,config:{responseModalities:[Rn.TEXT,Rn.IMAGE]}});let d=null,h="",f=e;if((l=(o=(i=u.candidates)==null?void 0:i[0])==null?void 0:o.content)!=null&&l.parts){for(const m of u.candidates[0].content.parts)if(m.text)h+=m.text;else if((c=m.inlineData)!=null&&c.data){d=m.inlineData.data,f=m.inlineData.mimeType||e;break}}if(!d)throw new Error("Failed to edit image. "+(h||"No text explanation."));return{editedImageData:d,newMimeType:f,editTextResponse:h}}catch(u){throw console.error("[editImageWithGemini] Error:",u.message),new Error(`Image editing failed: ${u.message||"Unknown error"}`)}}async function rU(t,e){var s,i,o,l;if(!t)throw new Error("Product name required.");const n=new ar({apiKey:oc});let r=`Generate a clean, commercial-style product image for "${t}".`;e&&(r+=` Description: "${e}".`),r+=" Main focus on product, simple/neutral/white background for e-commerce. Square image.";try{const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Go,config:{responseModalities:[Rn.TEXT,Rn.IMAGE]}});let u=null,d="",h="image/png";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const f of c.candidates[0].content.parts)if(f.text)d+=f.text;else if((l=f.inlineData)!=null&&l.data){u=f.inlineData.data,h=f.inlineData.mimeType||"image/png";break}}if(!u)throw new Error("Failed to generate product image. "+(d||"No text explanation."));if(nI)try{return{imageData:await nU(u,h),textResponse:d}}catch(f){console.warn("[generateGenericProductImageWithGemini] BG removal failed, using original:",f.message)}return{imageData:u,textResponse:d}}catch(c){throw console.error("[generateGenericProductImageWithGemini] Error:",c.message),new Error(`Product image generation failed: ${c.message||"Unknown error"}`)}}async function sU({prompt:t,referenceImage:e}){var i,o,l,c;if(!t)throw new Error("Prompt required.");const n=new ar({apiKey:oc});let r;const s=`Generate visually appealing image for: "${t}". Suitable for merchandise (t-shirts, mugs). Clear subject, good contrast. Square image.`;e!=null&&e.base64Data&&(e!=null&&e.mimeType)?r=[{text:`Using provided image as reference, ${t}. Output for print-on-demand. Square image.`},{inlineData:{mimeType:e.mimeType,data:e.base64Data}}]:r=s;try{const u=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Go,config:{responseModalities:[Rn.TEXT,Rn.IMAGE]}});let d=null,h=null,f="";if((l=(o=(i=u.candidates)==null?void 0:i[0])==null?void 0:o.content)!=null&&l.parts){for(const m of u.candidates[0].content.parts)if(m.text)f+=m.text;else if((c=m.inlineData)!=null&&c.data){d=m.inlineData.data,h=m.inlineData.mimeType;break}}if(!d)throw new Error("Failed to generate image from prompt. "+(f||"No text explanation."));return{imageData:d,imageMimeType:h,textResponse:f}}catch(u){throw console.error("[generateImageFromPromptForPod] Error:",u.message),new Error(`Image generation for POD failed: ${u.message||"Unknown error"}`)}}async function iU(t,e,n,r,s){var h,f,m,g;if(!t||!n||!r||!s)throw new Error("All params required for visualization.");const i=new ar({apiKey:oc});let o,l;try{const x=await fetch(n);if(!x.ok)throw new Error(`Failed to fetch base product image: ${x.statusText}`);l=(await x.blob()).type,o=await new Promise((v,_)=>{const S=new FileReader;S.onloadend=()=>v(S.result.split(",")[1]),S.onerror=_})}catch(x){throw new Error(`Could not load base product image: ${x.message}`)}const c=`Take this generated image (Image 1 from prompt "${r}"), and realistically superimpose it onto this base product image (Image 2, a ${s}). Output only the combined image.`,u=`For a ${s} with design from prompt "${r}", generate: 1. Title (max 60 chars). 2. Price (float). 3. Description (2-3 sentences, max 200 chars).`,d={type:ze.OBJECT,properties:{title:{type:ze.STRING},price:{type:ze.NUMBER},description:{type:ze.STRING}},required:["title","price","description"]};try{const x=[{text:c},{inlineData:{mimeType:e,data:t}},{inlineData:{mimeType:l,data:o}}],E=await i.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:x,safetySettings:Go,config:{responseModalities:[Rn.TEXT,Rn.IMAGE]}});let v=null,_=null;if((m=(f=(h=E.candidates)==null?void 0:h[0])==null?void 0:f.content)!=null&&m.parts){for(const M of E.candidates[0].content.parts)if((g=M.inlineData)!=null&&g.data){v=M.inlineData.data,_=M.inlineData.mimeType;break}}if(!v)throw new Error("Failed to generate visualized product image.");const S=await i.models.generateContent({model:"gemini-2.0-flash",contents:[{text:u}],safetySettings:Go,config:{responseMimeType:"application/json",responseSchema:d}});let I=JSON.parse(S.text||"{}");return I.title||(I={title:`Custom ${s}`,price:24.99,description:`Unique ${s} with design: "${r}".`}),{visualizedImageData:v,visualizedImageMimeType:_,productDetails:I}}catch(x){throw console.error("[visualizeImageOnProductWithGemini] Error:",x.message),new Error(`Product visualization failed: ${x.message||"Unknown error"}`)}}async function rI(t,e,n){var o,l,c,u;if(!t||!e||!n)throw new Error("Image data, MIME type, and product name required.");const r=new ar({apiKey:oc}),s=[`Show this product, "${n}", from a slightly high front-left angle. Maintain product integrity.`,`Show this product, "${n}", from a direct side view. Maintain product integrity.`,`Show this product, "${n}", from a top-down perspective. Maintain product integrity.`],i=[];try{for(const d of s){const h=[{text:d},{inlineData:{mimeType:e,data:t}}],f=await r.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:h,safetySettings:Go,config:{responseModalities:[Rn.TEXT,Rn.IMAGE]}});let m=null;if((c=(l=(o=f.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const g of f.candidates[0].content.parts)if((u=g.inlineData)!=null&&u.data){m=`data:${g.inlineData.mimeType};base64,${g.inlineData.data}`,i.push(m);break}}m||console.warn("[generateDifferentAnglesFromImage] No image data for one angle.")}if(i.length===0)throw new Error("Failed to generate any additional angle images.");return i}catch(d){throw console.error("[generateDifferentAnglesFromImage] Error:",d.message),new Error(`Generating different angles failed: ${d.message||"Unknown error"}`)}}async function oU(t,e){var s,i,o,l;if(!t)throw new Error("Collection name is required to generate an image.");const n=new ar({apiKey:oc});let r=`Generate a visually appealing banner image for an e-commerce collection named "${t}".`;e&&(r+=` The collection is described as: "${e}".`),r+=" The image should be thematic or abstract, suitable for a collection header or card. It should evoke the essence of the collection. Consider a wide aspect ratio like 16:9 or a square image if more appropriate for a card.";try{console.log(`[generateCollectionImageWithGemini] Generating image for collection: ${t}`);const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:[{role:"user",parts:[{text:r}]}],safetySettings:Go,config:{responseModalities:[Rn.TEXT,Rn.IMAGE]}});let u=null,d="image/png",h="";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const f of c.candidates[0].content.parts)if(f.text)h+=f.text;else if((l=f.inlineData)!=null&&l.data){u=f.inlineData.data,d=f.inlineData.mimeType||d;break}}if(!u)throw new Error("Failed to generate image data for the collection. "+(h||"No text explanation from AI."));return{imageData:u,imageMimeType:d,textResponse:h}}catch(c){throw console.error(`[generateCollectionImageWithGemini] Error generating image for collection "${t}":`,c),new Error(`Collection image generation failed for "${t}": ${c.message||"Unknown error"}`)}}const qoe=Object.freeze(Object.defineProperty({__proto__:null,editImageWithGemini:$l,generateCaptionForImageData:kd,generateCollectionImageWithGemini:oU,generateDifferentAnglesFromImage:rI,generateGenericProductImageWithGemini:rU,generateImageFromPromptForPod:sU,generateLogoWithGemini:Yp,visualizeImageOnProductWithGemini:iU},Symbol.toStringTag,{value:"Module"})),sI="AIzaSyBcpnUVVBDNaBLG7Rj_cEmE0J4zNlHmg7o",Cv=new ar({apiKey:sI}),Koe=async(t,e={})=>{var n,r,s;if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required.");console.log(`Starting video generation with prompt: "${t}"`);try{let i=await Cv.models.generateVideos({model:"veo-2.0-generate-001",prompt:t,config:{personGeneration:"dont_allow",aspectRatio:"16:9",numberOfVideos:1,durationSeconds:6,...e}});for(console.log("Video generation operation started:",i.name);!i.done;)console.log(`Polling operation ${i.name}, current status: ${((n=i.metadata)==null?void 0:n.state)||"UNKNOWN"}`),await new Promise(l=>setTimeout(l,1e4)),i=await Cv.operations.getVideosOperation({operation:i});if(console.log("Video generation operation completed:",i.name,"Done:",i.done),i.error)throw console.error("Error during video generation operation:",i.error),new Error(`Video generation failed: ${i.error.message||"Unknown error"}`);const o=(r=i.response)==null?void 0:r.generatedVideos;if(o&&o.length>0&&((s=o[0].video)!=null&&s.uri)){const c=`${o[0].video.uri}&key=${sI}`;return console.log("Generated video URI (with key appended):",c),c}else throw console.error("No video URI found in the response:",i.response),new Error("Video generation completed, but no video URI was returned.")}catch(i){throw console.error("Failed to generate video with Veo:",i),i.message&&i.message.includes("Quota")?new Error("Video generation failed due to quota limits. Please check your Google Cloud project quotas."):i.message&&i.message.includes("API key not valid")?new Error("Video generation failed due to an invalid API key. Please check your VITE_GEMINI_API_KEY."):i}},aU=async(t,e,n,r={})=>{var s,i,o;if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required.");if(!e||typeof e!="string")throw new Error("Valid base64 image data string is required.");if(!n||typeof n!="string")throw new Error("Valid image MIME type string is required.");console.log(`Starting image-to-video generation with prompt: "${t}" and image (mimeType: ${n})`);try{const l={model:"veo-2.0-generate-001",prompt:t,image:{imageBytes:e,mimeType:n},config:{personGeneration:"dont_allow",aspectRatio:"16:9",numberOfVideos:1,durationSeconds:6,...r}};console.log("Veo image-to-video payload (excluding imageBytes):",{...l,image:{mimeType:l.image.mimeType,imageBytes:"..."}});let c=await Cv.models.generateVideos(l);for(console.log("Image-to-video generation operation started:",c.name);!c.done;)console.log(`Polling operation ${c.name}, current status: ${((s=c.metadata)==null?void 0:s.state)||"UNKNOWN"}`),await new Promise(d=>setTimeout(d,1e4)),c=await Cv.operations.getVideosOperation({operation:c});if(console.log("Image-to-video generation operation completed:",c.name,"Done:",c.done),c.error)throw console.error("Error during image-to-video generation operation:",c.error),new Error(`Image-to-video generation failed: ${c.error.message||"Unknown error"}`);const u=(i=c.response)==null?void 0:i.generatedVideos;if(u&&u.length>0&&((o=u[0].video)!=null&&o.uri)){const h=`${u[0].video.uri}&key=${sI}`;return console.log("Generated image-to-video URI (with key appended):",h),h}else throw console.error("No video URI found in the image-to-video response:",c.response),new Error("Image-to-video generation completed, but no video URI was returned.")}catch(l){throw console.error("Failed to generate image-to-video with Veo:",l),l.message&&l.message.includes("Quota")?new Error("Image-to-video generation failed due to quota limits."):l.message&&l.message.includes("API key not valid")?new Error("Image-to-video generation failed due to an invalid API key."):l}},iI=p.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),u0=p.createContext({}),d0=p.createContext(null),h0=typeof document<"u",Jp=h0?p.useLayoutEffect:p.useEffect,lU=p.createContext({strict:!1}),oI=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Yoe="framerAppearId",cU="data-"+oI(Yoe);function Joe(t,e,n,r){const{visualElement:s}=p.useContext(u0),i=p.useContext(lU),o=p.useContext(d0),l=p.useContext(iI).reducedMotion,c=p.useRef();r=r||i.renderer,!c.current&&r&&(c.current=r(t,{visualState:e,parent:s,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current;p.useInsertionEffect(()=>{u&&u.update(n,o)});const d=p.useRef(!!(n[cU]&&!window.HandoffComplete));return Jp(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),p.useEffect(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,window.HandoffComplete=!0))}),u}function jd(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Xoe(t,e,n){return p.useCallback(r=>{r&&t.mount&&t.mount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):jd(n)&&(n.current=r))},[e])}function hp(t){return typeof t=="string"||Array.isArray(t)}function f0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const aI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],lI=["initial",...aI];function m0(t){return f0(t.animate)||lI.some(e=>hp(t[e]))}function uU(t){return!!(m0(t)||t.variants)}function Qoe(t,e){if(m0(t)){const{initial:n,animate:r}=t;return{initial:n===!1||hp(n)?n:void 0,animate:hp(r)?r:void 0}}return t.inherit!==!1?e:{}}function Zoe(t){const{initial:e,animate:n}=Qoe(t,p.useContext(u0));return p.useMemo(()=>({initial:e,animate:n}),[Gj(e),Gj(n)])}function Gj(t){return Array.isArray(t)?t.join(" "):t}const Hj={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},fp={};for(const t in Hj)fp[t]={isEnabled:e=>Hj[t].some(n=>!!e[n])};function eae(t){for(const e in t)fp[e]={...fp[e],...t[e]}}const cI=p.createContext({}),dU=p.createContext({}),tae=Symbol.for("motionComponentSymbol");function nae({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:s}){t&&eae(t);function i(l,c){let u;const d={...p.useContext(iI),...l,layoutId:rae(l)},{isStatic:h}=d,f=Zoe(l),m=r(l,h);if(!h&&h0){f.visualElement=Joe(s,m,d,e);const g=p.useContext(dU),x=p.useContext(lU).strict;f.visualElement&&(u=f.visualElement.loadFeatures(d,x,t,g))}return p.createElement(u0.Provider,{value:f},u&&f.visualElement?p.createElement(u,{visualElement:f.visualElement,...d}):null,n(s,l,Xoe(m,f.visualElement,c),m,h,f.visualElement))}const o=p.forwardRef(i);return o[tae]=s,o}function rae({layoutId:t}){const e=p.useContext(cI).id;return e&&t!==void 0?e+"-"+t:t}function sae(t){function e(r,s={}){return nae(t(r,s))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(r,s)=>(n.has(s)||n.set(s,e(s)),n.get(s))})}const iae=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function uI(t){return typeof t!="string"||t.includes("-")?!1:!!(iae.indexOf(t)>-1||/[A-Z]/.test(t))}const Tv={};function oae(t){Object.assign(Tv,t)}const Xp=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Au=new Set(Xp);function hU(t,{layout:e,layoutId:n}){return Au.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Tv[t]||t==="opacity")}const Xs=t=>!!(t&&t.getVelocity),aae={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},lae=Xp.length;function cae(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},r,s){let i="";for(let o=0;o<lae;o++){const l=Xp[o];if(t[l]!==void 0){const c=aae[l]||l;i+=`${c}(${t[l]}) `}}return e&&!t.z&&(i+="translateZ(0)"),i=i.trim(),s?i=s(t,r?"":i):n&&r&&(i="none"),i}const fU=t=>e=>typeof e=="string"&&e.startsWith(t),mU=fU("--"),JE=fU("var(--"),uae=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,dae=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Ul=(t,e,n)=>Math.min(Math.max(n,t),e),Ru={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},wm={...Ru,transform:t=>Ul(0,1,t)},gy={...Ru,default:1},_m=t=>Math.round(t*1e5)/1e5,p0=/(-)?([\d]*\.?[\d])+/g,pU=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,hae=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Qp(t){return typeof t=="string"}const Zp=t=>({test:e=>Qp(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Za=Zp("deg"),Oo=Zp("%"),Dt=Zp("px"),fae=Zp("vh"),mae=Zp("vw"),Wj={...Oo,parse:t=>Oo.parse(t)/100,transform:t=>Oo.transform(t*100)},qj={...Ru,transform:Math.round},gU={borderWidth:Dt,borderTopWidth:Dt,borderRightWidth:Dt,borderBottomWidth:Dt,borderLeftWidth:Dt,borderRadius:Dt,radius:Dt,borderTopLeftRadius:Dt,borderTopRightRadius:Dt,borderBottomRightRadius:Dt,borderBottomLeftRadius:Dt,width:Dt,maxWidth:Dt,height:Dt,maxHeight:Dt,size:Dt,top:Dt,right:Dt,bottom:Dt,left:Dt,padding:Dt,paddingTop:Dt,paddingRight:Dt,paddingBottom:Dt,paddingLeft:Dt,margin:Dt,marginTop:Dt,marginRight:Dt,marginBottom:Dt,marginLeft:Dt,rotate:Za,rotateX:Za,rotateY:Za,rotateZ:Za,scale:gy,scaleX:gy,scaleY:gy,scaleZ:gy,skew:Za,skewX:Za,skewY:Za,distance:Dt,translateX:Dt,translateY:Dt,translateZ:Dt,x:Dt,y:Dt,z:Dt,perspective:Dt,transformPerspective:Dt,opacity:wm,originX:Wj,originY:Wj,originZ:Dt,zIndex:qj,fillOpacity:wm,strokeOpacity:wm,numOctaves:qj};function dI(t,e,n,r){const{style:s,vars:i,transform:o,transformOrigin:l}=t;let c=!1,u=!1,d=!0;for(const h in e){const f=e[h];if(mU(h)){i[h]=f;continue}const m=gU[h],g=dae(f,m);if(Au.has(h)){if(c=!0,o[h]=g,!d)continue;f!==(m.default||0)&&(d=!1)}else h.startsWith("origin")?(u=!0,l[h]=g):s[h]=g}if(e.transform||(c||r?s.transform=cae(t.transform,n,d,r):s.transform&&(s.transform="none")),u){const{originX:h="50%",originY:f="50%",originZ:m=0}=l;s.transformOrigin=`${h} ${f} ${m}`}}const hI=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function yU(t,e,n){for(const r in e)!Xs(e[r])&&!hU(r,n)&&(t[r]=e[r])}function pae({transformTemplate:t},e,n){return p.useMemo(()=>{const r=hI();return dI(r,e,{enableHardwareAcceleration:!n},t),Object.assign({},r.vars,r.style)},[e])}function gae(t,e,n){const r=t.style||{},s={};return yU(s,r,t),Object.assign(s,pae(t,e,n)),t.transformValues?t.transformValues(s):s}function yae(t,e,n){const r={},s=gae(t,e,n);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=s,r}const xae=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Iv(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||xae.has(t)}let xU=t=>!Iv(t);function vae(t){t&&(xU=e=>e.startsWith("on")?!Iv(e):t(e))}try{vae(require("@emotion/is-prop-valid").default)}catch{}function wae(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(xU(s)||n===!0&&Iv(s)||!e&&!Iv(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}function Kj(t,e,n){return typeof t=="string"?t:Dt.transform(e+n*t)}function _ae(t,e,n){const r=Kj(e,t.x,t.width),s=Kj(n,t.y,t.height);return`${r} ${s}`}const bae={offset:"stroke-dashoffset",array:"stroke-dasharray"},Sae={offset:"strokeDashoffset",array:"strokeDasharray"};function Eae(t,e,n=1,r=0,s=!0){t.pathLength=1;const i=s?bae:Sae;t[i.offset]=Dt.transform(-r);const o=Dt.transform(e),l=Dt.transform(n);t[i.array]=`${o} ${l}`}function fI(t,{attrX:e,attrY:n,attrScale:r,originX:s,originY:i,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...u},d,h,f){if(dI(t,u,d,f),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:g,dimensions:x}=t;m.transform&&(x&&(g.transform=m.transform),delete m.transform),x&&(s!==void 0||i!==void 0||g.transform)&&(g.transformOrigin=_ae(x,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(m.x=e),n!==void 0&&(m.y=n),r!==void 0&&(m.scale=r),o!==void 0&&Eae(m,o,l,c,!1)}const vU=()=>({...hI(),attrs:{}}),mI=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Cae(t,e,n,r){const s=p.useMemo(()=>{const i=vU();return fI(i,e,{enableHardwareAcceleration:!1},mI(r),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};yU(i,t.style,t),s.style={...i,...s.style}}return s}function Tae(t=!1){return(n,r,s,{latestValues:i},o)=>{const c=(uI(n)?Cae:yae)(r,i,o,n),d={...wae(r,typeof n=="string",t),...c,ref:s},{children:h}=r,f=p.useMemo(()=>Xs(h)?h.get():h,[h]);return p.createElement(n,{...d,children:f})}}function wU(t,{style:e,vars:n},r,s){Object.assign(t.style,e,s&&s.getProjectionStyles(r));for(const i in n)t.style.setProperty(i,n[i])}const _U=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function bU(t,e,n,r){wU(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(_U.has(s)?s:oI(s),e.attrs[s])}function pI(t,e){const{style:n}=t,r={};for(const s in n)(Xs(n[s])||e.style&&Xs(e.style[s])||hU(s,t))&&(r[s]=n[s]);return r}function SU(t,e){const n=pI(t,e);for(const r in t)if(Xs(t[r])||Xs(e[r])){const s=Xp.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[s]=t[r]}return n}function gI(t,e,n,r={},s={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),e}function eg(t){const e=p.useRef(null);return e.current===null&&(e.current=t()),e.current}const Nv=t=>Array.isArray(t),Iae=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),Nae=t=>Nv(t)?t[t.length-1]||0:t;function hx(t){const e=Xs(t)?t.get():t;return Iae(e)?e.toValue():e}function Pae({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},r,s,i){const o={latestValues:Aae(r,s,i,t),renderState:e()};return n&&(o.mount=l=>n(r,l,o)),o}const EU=t=>(e,n)=>{const r=p.useContext(u0),s=p.useContext(d0),i=()=>Pae(t,e,r,s);return n?i():eg(i)};function Aae(t,e,n,r){const s={},i=r(t,{});for(const f in i)s[f]=hx(i[f]);let{initial:o,animate:l}=t;const c=m0(t),u=uU(t);e&&u&&!c&&t.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let d=n?n.initial===!1:!1;d=d||o===!1;const h=d?l:o;return h&&typeof h!="boolean"&&!f0(h)&&(Array.isArray(h)?h:[h]).forEach(m=>{const g=gI(t,m);if(!g)return;const{transitionEnd:x,transition:E,...v}=g;for(const _ in v){let S=v[_];if(Array.isArray(S)){const I=d?S.length-1:0;S=S[I]}S!==null&&(s[_]=S)}for(const _ in x)s[_]=x[_]}),s}const hr=t=>t;class Yj{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function Rae(t){let e=new Yj,n=new Yj,r=0,s=!1,i=!1;const o=new WeakSet,l={schedule:(c,u=!1,d=!1)=>{const h=d&&s,f=h?e:n;return u&&o.add(c),f.add(c)&&h&&s&&(r=e.order.length),c},cancel:c=>{n.remove(c),o.delete(c)},process:c=>{if(s){i=!0;return}if(s=!0,[e,n]=[n,e],n.clear(),r=e.order.length,r)for(let u=0;u<r;u++){const d=e.order[u];d(c),o.has(d)&&(l.schedule(d),t())}s=!1,i&&(i=!1,l.process(c))}};return l}const yy=["prepare","read","update","preRender","render","postRender"],kae=40;function jae(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=yy.reduce((h,f)=>(h[f]=Rae(()=>n=!0),h),{}),o=h=>i[h].process(s),l=()=>{const h=performance.now();n=!1,s.delta=r?1e3/60:Math.max(Math.min(h-s.timestamp,kae),1),s.timestamp=h,s.isProcessing=!0,yy.forEach(o),s.isProcessing=!1,n&&e&&(r=!1,t(l))},c=()=>{n=!0,r=!0,s.isProcessing||t(l)};return{schedule:yy.reduce((h,f)=>{const m=i[f];return h[f]=(g,x=!1,E=!1)=>(n||c(),m.schedule(g,x,E)),h},{}),cancel:h=>yy.forEach(f=>i[f].cancel(h)),state:s,steps:i}}const{schedule:_n,cancel:fo,state:qr,steps:Cb}=jae(typeof requestAnimationFrame<"u"?requestAnimationFrame:hr,!0),Dae={useVisualState:EU({scrapeMotionValuesFromProps:SU,createRenderState:vU,onMount:(t,e,{renderState:n,latestValues:r})=>{_n.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),_n.render(()=>{fI(n,r,{enableHardwareAcceleration:!1},mI(e.tagName),t.transformTemplate),bU(e,n)})}})},Mae={useVisualState:EU({scrapeMotionValuesFromProps:pI,createRenderState:hI})};function Lae(t,{forwardMotionProps:e=!1},n,r){return{...uI(t)?Dae:Mae,preloadedFeatures:n,useRender:Tae(e),createVisualElement:r,Component:t}}function ia(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const CU=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function g0(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const Fae=t=>e=>CU(e)&&t(e,g0(e));function da(t,e,n,r){return ia(t,e,Fae(n),r)}const Oae=(t,e)=>n=>e(t(n)),Tl=(...t)=>t.reduce(Oae);function TU(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const Jj=TU("dragHorizontal"),Xj=TU("dragVertical");function IU(t){let e=!1;if(t==="y")e=Xj();else if(t==="x")e=Jj();else{const n=Jj(),r=Xj();n&&r?e=()=>{n(),r()}:(n&&n(),r&&r())}return e}function NU(){const t=IU(!0);return t?(t(),!1):!0}class ac{constructor(e){this.isMounted=!1,this.node=e}update(){}}function Qj(t,e){const n="pointer"+(e?"enter":"leave"),r="onHover"+(e?"Start":"End"),s=(i,o)=>{if(i.pointerType==="touch"||NU())return;const l=t.getProps();t.animationState&&l.whileHover&&t.animationState.setActive("whileHover",e),l[r]&&_n.update(()=>l[r](i,o))};return da(t.current,n,s,{passive:!t.getProps()[r]})}class Vae extends ac{mount(){this.unmount=Tl(Qj(this.node,!0),Qj(this.node,!1))}unmount(){}}class $ae extends ac{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Tl(ia(this.node.current,"focus",()=>this.onFocus()),ia(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const PU=(t,e)=>e?t===e?!0:PU(t,e.parentElement):!1;function Tb(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,g0(n))}class Uae extends ac{constructor(){super(...arguments),this.removeStartListeners=hr,this.removeEndListeners=hr,this.removeAccessibleListeners=hr,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const r=this.node.getProps(),i=da(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:d,globalTapTarget:h}=this.node.getProps();_n.update(()=>{!h&&!PU(this.node.current,l.target)?d&&d(l,c):u&&u(l,c)})},{passive:!(r.onTap||r.onPointerUp)}),o=da(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=Tl(i,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=l=>{l.key!=="Enter"||!this.checkPressEnd()||Tb("up",(c,u)=>{const{onTap:d}=this.node.getProps();d&&_n.update(()=>d(c,u))})};this.removeEndListeners(),this.removeEndListeners=ia(this.node.current,"keyup",o),Tb("down",(l,c)=>{this.startPress(l,c)})},n=ia(this.node.current,"keydown",e),r=()=>{this.isPressing&&Tb("cancel",(i,o)=>this.cancelPress(i,o))},s=ia(this.node.current,"blur",r);this.removeAccessibleListeners=Tl(n,s)}}startPress(e,n){this.isPressing=!0;const{onTapStart:r,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&_n.update(()=>r(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!NU()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&_n.update(()=>r(e,n))}mount(){const e=this.node.getProps(),n=da(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),r=ia(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Tl(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const XE=new WeakMap,Ib=new WeakMap,Bae=t=>{const e=XE.get(t.target);e&&e(t)},zae=t=>{t.forEach(Bae)};function Gae({root:t,...e}){const n=t||document;Ib.has(n)||Ib.set(n,{});const r=Ib.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(zae,{root:t,...e})),r[s]}function Hae(t,e,n){const r=Gae(e);return XE.set(t,n),r.observe(t),()=>{XE.delete(t),r.unobserve(t)}}const Wae={some:0,all:1};class qae extends ac{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:Wae[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:h}=this.node.getProps(),f=u?d:h;f&&f(c)};return Hae(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Kae(e,n))&&this.startObserver()}unmount(){}}function Kae({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const Yae={inView:{Feature:qae},tap:{Feature:Uae},focus:{Feature:$ae},hover:{Feature:Vae}};function AU(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function Jae(t){const e={};return t.values.forEach((n,r)=>e[r]=n.get()),e}function Xae(t){const e={};return t.values.forEach((n,r)=>e[r]=n.getVelocity()),e}function y0(t,e,n){const r=t.getProps();return gI(r,e,n!==void 0?n:r.custom,Jae(t),Xae(t))}let RU=hr,x0=hr;const Il=t=>t*1e3,ha=t=>t/1e3,Qae={current:!1},kU=t=>Array.isArray(t)&&typeof t[0]=="number";function jU(t){return!!(!t||typeof t=="string"&&DU[t]||kU(t)||Array.isArray(t)&&t.every(jU))}const qf=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,DU={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:qf([0,.65,.55,1]),circOut:qf([.55,0,1,.45]),backIn:qf([.31,.01,.66,-.59]),backOut:qf([.33,1.53,.69,.99])};function MU(t){if(t)return kU(t)?qf(t):Array.isArray(t)?t.map(MU):DU[t]}function Zae(t,e,n,{delay:r=0,duration:s,repeat:i=0,repeatType:o="loop",ease:l,times:c}={}){const u={[e]:n};c&&(u.offset=c);const d=MU(l);return Array.isArray(d)&&(u.easing=d),t.animate(u,{delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function ele(t,{repeat:e,repeatType:n="loop"}){const r=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[r]}const LU=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,tle=1e-7,nle=12;function rle(t,e,n,r,s){let i,o,l=0;do o=e+(n-e)/2,i=LU(o,r,s)-t,i>0?n=o:e=o;while(Math.abs(i)>tle&&++l<nle);return o}function tg(t,e,n,r){if(t===e&&n===r)return hr;const s=i=>rle(i,0,1,t,n);return i=>i===0||i===1?i:LU(s(i),e,r)}const sle=tg(.42,0,1,1),ile=tg(0,0,.58,1),FU=tg(.42,0,.58,1),ole=t=>Array.isArray(t)&&typeof t[0]!="number",OU=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,VU=t=>e=>1-t(1-e),yI=t=>1-Math.sin(Math.acos(t)),$U=VU(yI),ale=OU(yI),UU=tg(.33,1.53,.69,.99),xI=VU(UU),lle=OU(xI),cle=t=>(t*=2)<1?.5*xI(t):.5*(2-Math.pow(2,-10*(t-1))),ule={linear:hr,easeIn:sle,easeInOut:FU,easeOut:ile,circIn:yI,circInOut:ale,circOut:$U,backIn:xI,backInOut:lle,backOut:UU,anticipate:cle},Zj=t=>{if(Array.isArray(t)){x0(t.length===4);const[e,n,r,s]=t;return tg(e,n,r,s)}else if(typeof t=="string")return ule[t];return t},vI=(t,e)=>n=>!!(Qp(n)&&hae.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),BU=(t,e,n)=>r=>{if(!Qp(r))return r;const[s,i,o,l]=r.match(p0);return{[t]:parseFloat(s),[e]:parseFloat(i),[n]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},dle=t=>Ul(0,255,t),Nb={...Ru,transform:t=>Math.round(dle(t))},Hc={test:vI("rgb","red"),parse:BU("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+Nb.transform(t)+", "+Nb.transform(e)+", "+Nb.transform(n)+", "+_m(wm.transform(r))+")"};function hle(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const QE={test:vI("#"),parse:hle,transform:Hc.transform},Dd={test:vI("hsl","hue"),parse:BU("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Oo.transform(_m(e))+", "+Oo.transform(_m(n))+", "+_m(wm.transform(r))+")"},Cs={test:t=>Hc.test(t)||QE.test(t)||Dd.test(t),parse:t=>Hc.test(t)?Hc.parse(t):Dd.test(t)?Dd.parse(t):QE.parse(t),transform:t=>Qp(t)?t:t.hasOwnProperty("red")?Hc.transform(t):Dd.transform(t)},nr=(t,e,n)=>-n*t+n*e+t;function Pb(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function fle({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,i=0,o=0;if(!e)s=i=o=n;else{const l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;s=Pb(c,l,t+1/3),i=Pb(c,l,t),o=Pb(c,l,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}const Ab=(t,e,n)=>{const r=t*t;return Math.sqrt(Math.max(0,n*(e*e-r)+r))},mle=[QE,Hc,Dd],ple=t=>mle.find(e=>e.test(t));function e2(t){const e=ple(t);let n=e.parse(t);return e===Dd&&(n=fle(n)),n}const zU=(t,e)=>{const n=e2(t),r=e2(e),s={...n};return i=>(s.red=Ab(n.red,r.red,i),s.green=Ab(n.green,r.green,i),s.blue=Ab(n.blue,r.blue,i),s.alpha=nr(n.alpha,r.alpha,i),Hc.transform(s))};function gle(t){var e,n;return isNaN(t)&&Qp(t)&&(((e=t.match(p0))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(pU))===null||n===void 0?void 0:n.length)||0)>0}const GU={regex:uae,countKey:"Vars",token:"${v}",parse:hr},HU={regex:pU,countKey:"Colors",token:"${c}",parse:Cs.parse},WU={regex:p0,countKey:"Numbers",token:"${n}",parse:Ru.parse};function Rb(t,{regex:e,countKey:n,token:r,parse:s}){const i=t.tokenised.match(e);i&&(t["num"+n]=i.length,t.tokenised=t.tokenised.replace(e,r),t.values.push(...i.map(s)))}function Pv(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&Rb(n,GU),Rb(n,HU),Rb(n,WU),n}function qU(t){return Pv(t).values}function KU(t){const{values:e,numColors:n,numVars:r,tokenised:s}=Pv(t),i=e.length;return o=>{let l=s;for(let c=0;c<i;c++)c<r?l=l.replace(GU.token,o[c]):c<r+n?l=l.replace(HU.token,Cs.transform(o[c])):l=l.replace(WU.token,_m(o[c]));return l}}const yle=t=>typeof t=="number"?0:t;function xle(t){const e=qU(t);return KU(t)(e.map(yle))}const Bl={test:gle,parse:qU,createTransformer:KU,getAnimatableNone:xle},YU=(t,e)=>n=>`${n>0?e:t}`;function JU(t,e){return typeof t=="number"?n=>nr(t,e,n):Cs.test(t)?zU(t,e):t.startsWith("var(")?YU(t,e):QU(t,e)}const XU=(t,e)=>{const n=[...t],r=n.length,s=t.map((i,o)=>JU(i,e[o]));return i=>{for(let o=0;o<r;o++)n[o]=s[o](i);return n}},vle=(t,e)=>{const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=JU(t[s],e[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}},QU=(t,e)=>{const n=Bl.createTransformer(e),r=Pv(t),s=Pv(e);return r.numVars===s.numVars&&r.numColors===s.numColors&&r.numNumbers>=s.numNumbers?Tl(XU(r.values,s.values),n):YU(t,e)},vh=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},t2=(t,e)=>n=>nr(t,e,n);function wle(t){return typeof t=="number"?t2:typeof t=="string"?Cs.test(t)?zU:QU:Array.isArray(t)?XU:typeof t=="object"?vle:t2}function _le(t,e,n){const r=[],s=n||wle(t[0]),i=t.length-1;for(let o=0;o<i;o++){let l=s(t[o],t[o+1]);if(e){const c=Array.isArray(e)?e[o]||hr:e;l=Tl(c,l)}r.push(l)}return r}function v0(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const i=t.length;if(x0(i===e.length),i===1)return()=>e[0];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=_le(e,r,s),l=o.length,c=u=>{let d=0;if(l>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const h=vh(t[d],t[d+1],u);return o[d](h)};return n?u=>c(Ul(t[0],t[i-1],u)):c}function ble(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=vh(0,e,r);t.push(nr(n,1,s))}}function ZU(t){const e=[0];return ble(e,t.length-1),e}function Sle(t,e){return t.map(n=>n*e)}function Ele(t,e){return t.map(()=>e||FU).splice(0,t.length-1)}function Av({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=ole(r)?r.map(Zj):Zj(r),i={done:!1,value:e[0]},o=Sle(n&&n.length===e.length?n:ZU(e),t),l=v0(o,e,{ease:Array.isArray(s)?s:Ele(e,s)});return{calculatedDuration:t,next:c=>(i.value=l(c),i.done=c>=t,i)}}function wI(t,e){return e?t*(1e3/e):0}const Cle=5;function e5(t,e,n){const r=Math.max(e-Cle,0);return wI(n-t(r),e-r)}const kb=.001,Tle=.01,n2=10,Ile=.05,Nle=1;function Ple({duration:t=800,bounce:e=.25,velocity:n=0,mass:r=1}){let s,i;RU(t<=Il(n2));let o=1-e;o=Ul(Ile,Nle,o),t=Ul(Tle,n2,ha(t)),o<1?(s=u=>{const d=u*o,h=d*t,f=d-n,m=ZE(u,o),g=Math.exp(-h);return kb-f/m*g},i=u=>{const h=u*o*t,f=h*n+n,m=Math.pow(o,2)*Math.pow(u,2)*t,g=Math.exp(-h),x=ZE(Math.pow(u,2),o);return(-s(u)+kb>0?-1:1)*((f-m)*g)/x}):(s=u=>{const d=Math.exp(-u*t),h=(u-n)*t+1;return-kb+d*h},i=u=>{const d=Math.exp(-u*t),h=(n-u)*(t*t);return d*h});const l=5/t,c=Rle(s,i,l);if(t=Il(t),isNaN(c))return{stiffness:100,damping:10,duration:t};{const u=Math.pow(c,2)*r;return{stiffness:u,damping:o*2*Math.sqrt(r*u),duration:t}}}const Ale=12;function Rle(t,e,n){let r=n;for(let s=1;s<Ale;s++)r=r-t(r)/e(r);return r}function ZE(t,e){return t*Math.sqrt(1-e*e)}const kle=["duration","bounce"],jle=["stiffness","damping","mass"];function r2(t,e){return e.some(n=>t[n]!==void 0)}function Dle(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!r2(t,jle)&&r2(t,kle)){const n=Ple(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function t5({keyframes:t,restDelta:e,restSpeed:n,...r}){const s=t[0],i=t[t.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:f}=Dle({...r,velocity:-ha(r.velocity||0)}),m=h||0,g=c/(2*Math.sqrt(l*u)),x=i-s,E=ha(Math.sqrt(l/u)),v=Math.abs(x)<5;n||(n=v?.01:2),e||(e=v?.005:.5);let _;if(g<1){const S=ZE(E,g);_=I=>{const M=Math.exp(-g*E*I);return i-M*((m+g*E*x)/S*Math.sin(S*I)+x*Math.cos(S*I))}}else if(g===1)_=S=>i-Math.exp(-E*S)*(x+(m+E*x)*S);else{const S=E*Math.sqrt(g*g-1);_=I=>{const M=Math.exp(-g*E*I),j=Math.min(S*I,300);return i-M*((m+g*E*x)*Math.sinh(j)+S*x*Math.cosh(j))/S}}return{calculatedDuration:f&&d||null,next:S=>{const I=_(S);if(f)o.done=S>=d;else{let M=m;S!==0&&(g<1?M=e5(_,S,I):M=0);const j=Math.abs(M)<=n,C=Math.abs(i-I)<=e;o.done=j&&C}return o.value=o.done?i:I,o}}}function s2({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:c,restDelta:u=.5,restSpeed:d}){const h=t[0],f={done:!1,value:h},m=T=>l!==void 0&&T<l||c!==void 0&&T>c,g=T=>l===void 0?c:c===void 0||Math.abs(l-T)<Math.abs(c-T)?l:c;let x=n*e;const E=h+x,v=o===void 0?E:o(E);v!==E&&(x=v-h);const _=T=>-x*Math.exp(-T/r),S=T=>v+_(T),I=T=>{const P=_(T),A=S(T);f.done=Math.abs(P)<=u,f.value=f.done?v:A};let M,j;const C=T=>{m(f.value)&&(M=T,j=t5({keyframes:[f.value,g(f.value)],velocity:e5(S,T,f.value),damping:s,stiffness:i,restDelta:u,restSpeed:d}))};return C(0),{calculatedDuration:null,next:T=>{let P=!1;return!j&&M===void 0&&(P=!0,I(T),C(T)),M!==void 0&&T>M?j.next(T-M):(!P&&I(T),f)}}}const Mle=t=>{const e=({timestamp:n})=>t(n);return{start:()=>_n.update(e,!0),stop:()=>fo(e),now:()=>qr.isProcessing?qr.timestamp:performance.now()}},i2=2e4;function o2(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<i2;)e+=n,r=t.next(e);return e>=i2?1/0:e}const Lle={decay:s2,inertia:s2,tween:Av,keyframes:Av,spring:t5};function Rv({autoplay:t=!0,delay:e=0,driver:n=Mle,keyframes:r,type:s="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:l="loop",onPlay:c,onStop:u,onComplete:d,onUpdate:h,...f}){let m=1,g=!1,x,E;const v=()=>{E=new Promise(z=>{x=z})};v();let _;const S=Lle[s]||Av;let I;S!==Av&&typeof r[0]!="number"&&(I=v0([0,100],r,{clamp:!1}),r=[0,100]);const M=S({...f,keyframes:r});let j;l==="mirror"&&(j=S({...f,keyframes:[...r].reverse(),velocity:-(f.velocity||0)}));let C="idle",T=null,P=null,A=null;M.calculatedDuration===null&&i&&(M.calculatedDuration=o2(M));const{calculatedDuration:D}=M;let R=1/0,k=1/0;D!==null&&(R=D+o,k=R*(i+1)-o);let U=0;const B=z=>{if(P===null)return;m>0&&(P=Math.min(P,z)),m<0&&(P=Math.min(z-k/m,P)),T!==null?U=T:U=Math.round(z-P)*m;const Y=U-e*(m>=0?1:-1),F=m>=0?Y<0:Y>k;U=Math.max(Y,0),C==="finished"&&T===null&&(U=k);let ye=U,Se=M;if(i){const Ye=Math.min(U,k)/R;let qe=Math.floor(Ye),et=Ye%1;!et&&Ye>=1&&(et=1),et===1&&qe--,qe=Math.min(qe,i+1),!!(qe%2)&&(l==="reverse"?(et=1-et,o&&(et-=o/R)):l==="mirror"&&(Se=j)),ye=Ul(0,1,et)*R}const De=F?{done:!1,value:r[0]}:Se.next(ye);I&&(De.value=I(De.value));let{done:xe}=De;!F&&D!==null&&(xe=m>=0?U>=k:U<=0);const Me=T===null&&(C==="finished"||C==="running"&&xe);return h&&h(De.value),Me&&H(),De},K=()=>{_&&_.stop(),_=void 0},ee=()=>{C="idle",K(),x(),v(),P=A=null},H=()=>{C="finished",d&&d(),K(),x()},X=()=>{if(g)return;_||(_=n(B));const z=_.now();c&&c(),T!==null?P=z-T:(!P||C==="finished")&&(P=z),C==="finished"&&v(),A=P,T=null,C="running",_.start()};t&&X();const O={then(z,Y){return E.then(z,Y)},get time(){return ha(U)},set time(z){z=Il(z),U=z,T!==null||!_||m===0?T=z:P=_.now()-z/m},get duration(){const z=M.calculatedDuration===null?o2(M):M.calculatedDuration;return ha(z)},get speed(){return m},set speed(z){z===m||!_||(m=z,O.time=ha(U))},get state(){return C},play:X,pause:()=>{C="paused",T=U},stop:()=>{g=!0,C!=="idle"&&(C="idle",u&&u(),ee())},cancel:()=>{A!==null&&B(A),ee()},complete:()=>{C="finished"},sample:z=>(P=0,B(z))};return O}function Fle(t){let e;return()=>(e===void 0&&(e=t()),e)}const Ole=Fle(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Vle=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),xy=10,$le=2e4,Ule=(t,e)=>e.type==="spring"||t==="backgroundColor"||!jU(e.ease);function Ble(t,e,{onUpdate:n,onComplete:r,...s}){if(!(Ole()&&Vle.has(e)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let o=!1,l,c,u=!1;const d=()=>{c=new Promise(S=>{l=S})};d();let{keyframes:h,duration:f=300,ease:m,times:g}=s;if(Ule(e,s)){const S=Rv({...s,repeat:0,delay:0});let I={done:!1,value:h[0]};const M=[];let j=0;for(;!I.done&&j<$le;)I=S.sample(j),M.push(I.value),j+=xy;g=void 0,h=M,f=j-xy,m="linear"}const x=Zae(t.owner.current,e,h,{...s,duration:f,ease:m,times:g}),E=()=>{u=!1,x.cancel()},v=()=>{u=!0,_n.update(E),l(),d()};return x.onfinish=()=>{u||(t.set(ele(h,s)),r&&r(),v())},{then(S,I){return c.then(S,I)},attachTimeline(S){return x.timeline=S,x.onfinish=null,hr},get time(){return ha(x.currentTime||0)},set time(S){x.currentTime=Il(S)},get speed(){return x.playbackRate},set speed(S){x.playbackRate=S},get duration(){return ha(f)},play:()=>{o||(x.play(),fo(E))},pause:()=>x.pause(),stop:()=>{if(o=!0,x.playState==="idle")return;const{currentTime:S}=x;if(S){const I=Rv({...s,autoplay:!1});t.setWithVelocity(I.sample(S-xy).value,I.sample(S).value,xy)}v()},complete:()=>{u||x.finish()},cancel:v}}function zle({keyframes:t,delay:e,onUpdate:n,onComplete:r}){const s=()=>(n&&n(t[t.length-1]),r&&r(),{time:0,speed:1,duration:0,play:hr,pause:hr,stop:hr,then:i=>(i(),Promise.resolve()),cancel:hr,complete:hr});return e?Rv({keyframes:[0,1],duration:0,delay:e,onComplete:s}):s()}const Gle={type:"spring",stiffness:500,damping:25,restSpeed:10},Hle=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Wle={type:"keyframes",duration:.8},qle={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Kle=(t,{keyframes:e})=>e.length>2?Wle:Au.has(t)?t.startsWith("scale")?Hle(e[1]):Gle:qle,eC=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Bl.test(e)||e==="0")&&!e.startsWith("url(")),Yle=new Set(["brightness","contrast","saturate","opacity"]);function Jle(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(p0)||[];if(!r)return t;const s=n.replace(r,"");let i=Yle.has(e)?1:0;return r!==n&&(i*=100),e+"("+i+s+")"}const Xle=/([a-z-]*)\(.*?\)/g,tC={...Bl,getAnimatableNone:t=>{const e=t.match(Xle);return e?e.map(Jle).join(" "):t}},Qle={...gU,color:Cs,backgroundColor:Cs,outlineColor:Cs,fill:Cs,stroke:Cs,borderColor:Cs,borderTopColor:Cs,borderRightColor:Cs,borderBottomColor:Cs,borderLeftColor:Cs,filter:tC,WebkitFilter:tC},_I=t=>Qle[t];function n5(t,e){let n=_I(t);return n!==tC&&(n=Bl),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const r5=t=>/^0[^.\s]+$/.test(t);function Zle(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||r5(t)}function ece(t,e,n,r){const s=eC(e,n);let i;Array.isArray(n)?i=[...n]:i=[null,n];const o=r.from!==void 0?r.from:t.get();let l;const c=[];for(let u=0;u<i.length;u++)i[u]===null&&(i[u]=u===0?o:i[u-1]),Zle(i[u])&&c.push(u),typeof i[u]=="string"&&i[u]!=="none"&&i[u]!=="0"&&(l=i[u]);if(s&&c.length&&l)for(let u=0;u<c.length;u++){const d=c[u];i[d]=n5(e,l)}return i}function tce({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}function bI(t,e){return t[e]||t.default||t}const nce={skipAnimations:!1},SI=(t,e,n,r={})=>s=>{const i=bI(r,t)||{},o=i.delay||r.delay||0;let{elapsed:l=0}=r;l=l-Il(o);const c=ece(e,t,n,i),u=c[0],d=c[c.length-1],h=eC(t,u),f=eC(t,d);let m={keyframes:c,velocity:e.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:g=>{e.set(g),i.onUpdate&&i.onUpdate(g)},onComplete:()=>{s(),i.onComplete&&i.onComplete()}};if(tce(i)||(m={...m,...Kle(t,m)}),m.duration&&(m.duration=Il(m.duration)),m.repeatDelay&&(m.repeatDelay=Il(m.repeatDelay)),!h||!f||Qae.current||i.type===!1||nce.skipAnimations)return zle(m);if(!r.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const g=Ble(e,t,m);if(g)return g}return Rv(m)};function kv(t){return!!(Xs(t)&&t.add)}const s5=t=>/^\-?\d*\.?\d+$/.test(t);function EI(t,e){t.indexOf(e)===-1&&t.push(e)}function CI(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class TI{constructor(){this.subscriptions=[]}add(e){return EI(this.subscriptions,e),()=>CI(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const rce=t=>!isNaN(parseFloat(t)),bm={current:void 0};class sce{constructor(e,n={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(r,s=!0)=>{this.prev=this.current,this.current=r;const{delta:i,timestamp:o}=qr;this.lastUpdated!==o&&(this.timeDelta=i,this.lastUpdated=o,_n.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>_n.postRender(this.velocityCheck),this.velocityCheck=({timestamp:r})=>{r!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=rce(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new TI);const r=this.events[e].add(n);return e==="change"?()=>{r(),_n.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=e,this.timeDelta=r}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return bm.current&&bm.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?wI(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function io(t,e){return new sce(t,e)}const i5=t=>e=>e.test(t),ice={test:t=>t==="auto",parse:t=>t},o5=[Ru,Dt,Oo,Za,mae,fae,ice],If=t=>o5.find(i5(t)),oce=[...o5,Cs,Bl],ace=t=>oce.find(i5(t));function lce(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,io(n))}function cce(t,e){const n=y0(t,e);let{transitionEnd:r={},transition:s={},...i}=n?t.makeTargetAnimatable(n,!1):{};i={...i,...r};for(const o in i){const l=Nae(i[o]);lce(t,o,l)}}function uce(t,e,n){var r,s;const i=Object.keys(e).filter(l=>!t.hasValue(l)),o=i.length;if(o)for(let l=0;l<o;l++){const c=i[l],u=e[c];let d=null;Array.isArray(u)&&(d=u[0]),d===null&&(d=(s=(r=n[c])!==null&&r!==void 0?r:t.readValue(c))!==null&&s!==void 0?s:e[c]),d!=null&&(typeof d=="string"&&(s5(d)||r5(d))?d=parseFloat(d):!ace(d)&&Bl.test(u)&&(d=n5(c,u)),t.addValue(c,io(d,{owner:t})),n[c]===void 0&&(n[c]=d),d!==null&&t.setBaseTarget(c,d))}}function dce(t,e){return e?(e[t]||e.default||e).from:void 0}function hce(t,e,n){const r={};for(const s in t){const i=dce(s,e);if(i!==void 0)r[s]=i;else{const o=n.getValue(s);o&&(r[s]=o.get())}}return r}function fce({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function mce(t,e){const n=t.get();if(Array.isArray(e)){for(let r=0;r<e.length;r++)if(e[r]!==n)return!0}else return n!==e}function a5(t,e,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...l}=t.makeTargetAnimatable(e);const c=t.getValue("willChange");r&&(i=r);const u=[],d=s&&t.animationState&&t.animationState.getState()[s];for(const h in l){const f=t.getValue(h),m=l[h];if(!f||m===void 0||d&&fce(d,h))continue;const g={delay:n,elapsed:0,...bI(i||{},h)};if(window.HandoffAppearAnimations){const v=t.getProps()[cU];if(v){const _=window.HandoffAppearAnimations(v,h,f,_n);_!==null&&(g.elapsed=_,g.isHandoff=!0)}}let x=!g.isHandoff&&!mce(f,m);if(g.type==="spring"&&(f.getVelocity()||g.velocity)&&(x=!1),f.animation&&(x=!1),x)continue;f.start(SI(h,f,m,t.shouldReduceMotion&&Au.has(h)?{type:!1}:g));const E=f.animation;kv(c)&&(c.add(h),E.then(()=>c.remove(h))),u.push(E)}return o&&Promise.all(u).then(()=>{o&&cce(t,o)}),u}function nC(t,e,n={}){const r=y0(t,e,n.custom);let{transition:s=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(a5(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return pce(t,e,u+c,d,h,n)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(n.delay)])}function pce(t,e,n=0,r=0,s=1,i){const o=[],l=(t.variantChildren.size-1)*r,c=s===1?(u=0)=>u*r:(u=0)=>l-u*r;return Array.from(t.variantChildren).sort(gce).forEach((u,d)=>{u.notify("AnimationStart",e),o.push(nC(u,e,{...i,delay:n+c(d)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(o)}function gce(t,e){return t.sortNodePosition(e)}function yce(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>nC(t,i,n));r=Promise.all(s)}else if(typeof e=="string")r=nC(t,e,n);else{const s=typeof e=="function"?y0(t,e,n.custom):e;r=Promise.all(a5(t,s,n))}return r.then(()=>t.notify("AnimationComplete",e))}const xce=[...aI].reverse(),vce=aI.length;function wce(t){return e=>Promise.all(e.map(({animation:n,options:r})=>yce(t,n,r)))}function _ce(t){let e=wce(t);const n=Sce();let r=!0;const s=(c,u)=>{const d=y0(t,u);if(d){const{transition:h,transitionEnd:f,...m}=d;c={...c,...m,...f}}return c};function i(c){e=c(t)}function o(c,u){const d=t.getProps(),h=t.getVariantContext(!0)||{},f=[],m=new Set;let g={},x=1/0;for(let v=0;v<vce;v++){const _=xce[v],S=n[_],I=d[_]!==void 0?d[_]:h[_],M=hp(I),j=_===u?S.isActive:null;j===!1&&(x=v);let C=I===h[_]&&I!==d[_]&&M;if(C&&r&&t.manuallyAnimateOnMount&&(C=!1),S.protectedKeys={...g},!S.isActive&&j===null||!I&&!S.prevProp||f0(I)||typeof I=="boolean")continue;let P=bce(S.prevProp,I)||_===u&&S.isActive&&!C&&M||v>x&&M,A=!1;const D=Array.isArray(I)?I:[I];let R=D.reduce(s,{});j===!1&&(R={});const{prevResolvedValues:k={}}=S,U={...k,...R},B=K=>{P=!0,m.has(K)&&(A=!0,m.delete(K)),S.needsAnimating[K]=!0};for(const K in U){const ee=R[K],H=k[K];if(g.hasOwnProperty(K))continue;let X=!1;Nv(ee)&&Nv(H)?X=!AU(ee,H):X=ee!==H,X?ee!==void 0?B(K):m.add(K):ee!==void 0&&m.has(K)?B(K):S.protectedKeys[K]=!0}S.prevProp=I,S.prevResolvedValues=R,S.isActive&&(g={...g,...R}),r&&t.blockInitialAnimation&&(P=!1),P&&(!C||A)&&f.push(...D.map(K=>({animation:K,options:{type:_,...c}})))}if(m.size){const v={};m.forEach(_=>{const S=t.getBaseTarget(_);S!==void 0&&(v[_]=S)}),f.push({animation:v})}let E=!!f.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(E=!1),r=!1,E?e(f):Promise.resolve()}function l(c,u,d){var h;if(n[c].isActive===u)return Promise.resolve();(h=t.variantChildren)===null||h===void 0||h.forEach(m=>{var g;return(g=m.animationState)===null||g===void 0?void 0:g.setActive(c,u)}),n[c].isActive=u;const f=o(d,c);for(const m in n)n[m].protectedKeys={};return f}return{animateChanges:o,setActive:l,setAnimateFunction:i,getState:()=>n}}function bce(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!AU(e,t):!1}function xc(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Sce(){return{animate:xc(!0),whileInView:xc(),whileHover:xc(),whileTap:xc(),whileDrag:xc(),whileFocus:xc(),exit:xc()}}class Ece extends ac{constructor(e){super(e),e.animationState||(e.animationState=_ce(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),f0(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let Cce=0;class Tce extends ac{constructor(){super(...arguments),this.id=Cce++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e,{custom:r??this.node.getProps().custom});n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Ice={animation:{Feature:Ece},exit:{Feature:Tce}},a2=(t,e)=>Math.abs(t-e);function Nce(t,e){const n=a2(t.x,e.x),r=a2(t.y,e.y);return Math.sqrt(n**2+r**2)}class l5{constructor(e,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Db(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,m=Nce(h.offset,{x:0,y:0})>=3;if(!f&&!m)return;const{point:g}=h,{timestamp:x}=qr;this.history.push({...g,timestamp:x});const{onStart:E,onMove:v}=this.handlers;f||(E&&E(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=jb(f,this.transformPagePoint),_n.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:m,onSessionEnd:g,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=Db(h.type==="pointercancel"?this.lastMoveEventInfo:jb(f,this.transformPagePoint),this.history);this.startEvent&&m&&m(h,E),g&&g(h,E)},!CU(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const o=g0(e),l=jb(o,this.transformPagePoint),{point:c}=l,{timestamp:u}=qr;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=n;d&&d(e,Db(l,this.history)),this.removeListeners=Tl(da(this.contextWindow,"pointermove",this.handlePointerMove),da(this.contextWindow,"pointerup",this.handlePointerUp),da(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),fo(this.updatePoint)}}function jb(t,e){return e?{point:e(t.point)}:t}function l2(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Db({point:t},e){return{point:t,delta:l2(t,c5(e)),offset:l2(t,Pce(e)),velocity:Ace(e,.1)}}function Pce(t){return t[0]}function c5(t){return t[t.length-1]}function Ace(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=c5(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>Il(e)));)n--;if(!r)return{x:0,y:0};const i=ha(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function xi(t){return t.max-t.min}function rC(t,e=0,n=.01){return Math.abs(t-e)<=n}function c2(t,e,n,r=.5){t.origin=r,t.originPoint=nr(e.min,e.max,t.origin),t.scale=xi(n)/xi(e),(rC(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=nr(n.min,n.max,t.origin)-t.originPoint,(rC(t.translate)||isNaN(t.translate))&&(t.translate=0)}function Sm(t,e,n,r){c2(t.x,e.x,n.x,r?r.originX:void 0),c2(t.y,e.y,n.y,r?r.originY:void 0)}function u2(t,e,n){t.min=n.min+e.min,t.max=t.min+xi(e)}function Rce(t,e,n){u2(t.x,e.x,n.x),u2(t.y,e.y,n.y)}function d2(t,e,n){t.min=e.min-n.min,t.max=t.min+xi(e)}function Em(t,e,n){d2(t.x,e.x,n.x),d2(t.y,e.y,n.y)}function kce(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?nr(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?nr(n,t,r.max):Math.min(t,n)),t}function h2(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function jce(t,{top:e,left:n,bottom:r,right:s}){return{x:h2(t.x,n,s),y:h2(t.y,e,r)}}function f2(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function Dce(t,e){return{x:f2(t.x,e.x),y:f2(t.y,e.y)}}function Mce(t,e){let n=.5;const r=xi(t),s=xi(e);return s>r?n=vh(e.min,e.max-r,t.min):r>s&&(n=vh(t.min,t.max-s,e.min)),Ul(0,1,n)}function Lce(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const sC=.35;function Fce(t=sC){return t===!1?t=0:t===!0&&(t=sC),{x:m2(t,"left","right"),y:m2(t,"top","bottom")}}function m2(t,e,n){return{min:p2(t,e),max:p2(t,n)}}function p2(t,e){return typeof t=="number"?t:t[e]||0}const g2=()=>({translate:0,scale:1,origin:0,originPoint:0}),Md=()=>({x:g2(),y:g2()}),y2=()=>({min:0,max:0}),br=()=>({x:y2(),y:y2()});function Ni(t){return[t("x"),t("y")]}function u5({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function Oce({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Vce(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function Mb(t){return t===void 0||t===1}function iC({scale:t,scaleX:e,scaleY:n}){return!Mb(t)||!Mb(e)||!Mb(n)}function Sc(t){return iC(t)||d5(t)||t.z||t.rotate||t.rotateX||t.rotateY}function d5(t){return x2(t.x)||x2(t.y)}function x2(t){return t&&t!=="0%"}function jv(t,e,n){const r=t-n,s=e*r;return n+s}function v2(t,e,n,r,s){return s!==void 0&&(t=jv(t,s,r)),jv(t,n,r)+e}function oC(t,e=0,n=1,r,s){t.min=v2(t.min,e,n,r,s),t.max=v2(t.max,e,n,r,s)}function h5(t,{x:e,y:n}){oC(t.x,e.translate,e.scale,e.originPoint),oC(t.y,n.translate,n.scale,n.originPoint)}function $ce(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let i,o;for(let l=0;l<s;l++){i=n[l],o=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Ld(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,h5(t,o)),r&&Sc(i.latestValues)&&Ld(t,i.latestValues))}e.x=w2(e.x),e.y=w2(e.y)}function w2(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function sl(t,e){t.min=t.min+e,t.max=t.max+e}function _2(t,e,[n,r,s]){const i=e[s]!==void 0?e[s]:.5,o=nr(t.min,t.max,i);oC(t,e[n],e[r],o,e.scale)}const Uce=["x","scaleX","originX"],Bce=["y","scaleY","originY"];function Ld(t,e){_2(t.x,e,Uce),_2(t.y,e,Bce)}function f5(t,e){return u5(Vce(t.getBoundingClientRect(),e))}function zce(t,e,n){const r=f5(t,n),{scroll:s}=e;return s&&(sl(r.x,s.offset.x),sl(r.y,s.offset.y)),r}const m5=({current:t})=>t?t.ownerDocument.defaultView:null,Gce=new WeakMap;class Hce{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=br(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(g0(d,"page").point)},i=(d,h)=>{const{drag:f,dragPropagation:m,onDragStart:g}=this.getProps();if(f&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=IU(f),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ni(E=>{let v=this.getAxisMotionValue(E).get()||0;if(Oo.test(v)){const{projection:_}=this.visualElement;if(_&&_.layout){const S=_.layout.layoutBox[E];S&&(v=xi(S)*(parseFloat(v)/100))}}this.originPoint[E]=v}),g&&_n.update(()=>g(d,h),!1,!0);const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(d,h)=>{const{dragPropagation:f,dragDirectionLock:m,onDirectionLock:g,onDrag:x}=this.getProps();if(!f&&!this.openGlobalLock)return;const{offset:E}=h;if(m&&this.currentDirection===null){this.currentDirection=Wce(E),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",h.point,E),this.updateAxis("y",h.point,E),this.visualElement.render(),x&&x(d,h)},l=(d,h)=>this.stop(d,h),c=()=>Ni(d=>{var h;return this.getAnimationState(d)==="paused"&&((h=this.getAxisMotionValue(d).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new l5(e,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:m5(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&_n.update(()=>i(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!vy(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=kce(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&jd(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=jce(s.layoutBox,n):this.constraints=!1,this.elastic=Fce(r),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Ni(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=Lce(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!jd(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=zce(r,s.root,this.visualElement.getTransformPagePoint());let o=Dce(s.layout.layoutBox,i);if(n){const l=n(Oce(o));this.hasMutatedConstraints=!!l,l&&(o=u5(l))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=Ni(d=>{if(!vy(d,n,this.currentDirection))return;let h=c&&c[d]||{};o&&(h={min:0,max:0});const f=s?200:1e6,m=s?40:1e7,g={type:"inertia",velocity:r?e[d]:0,bounceStiffness:f,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(d,g)});return Promise.all(u).then(l)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return r.start(SI(e,r,0,n))}stopAnimation(){Ni(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ni(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Ni(n=>{const{drag:r}=this.getProps();if(!vy(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[n];i.set(e[n]-nr(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!jd(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Ni(o=>{const l=this.getAxisMotionValue(o);if(l){const c=l.get();s[o]=Mce({min:c,max:c},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ni(o=>{if(!vy(o,e,null))return;const l=this.getAxisMotionValue(o),{min:c,max:u}=this.constraints[o];l.set(nr(c,u,s[o]))})}addListeners(){if(!this.visualElement.current)return;Gce.set(this.visualElement,this);const e=this.visualElement.current,n=da(e,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),r=()=>{const{dragConstraints:c}=this.getProps();jd(c)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),r();const o=ia(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(Ni(d=>{const h=this.getAxisMotionValue(d);h&&(this.originPoint[d]+=c[d].translate,h.set(h.get()+c[d].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=sC,dragMomentum:l=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:l}}}function vy(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function Wce(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class qce extends ac{constructor(e){super(e),this.removeGroupControls=hr,this.removeListeners=hr,this.controls=new Hce(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||hr}unmount(){this.removeGroupControls(),this.removeListeners()}}const b2=t=>(e,n)=>{t&&_n.update(()=>t(e,n))};class Kce extends ac{constructor(){super(...arguments),this.removePointerDownListener=hr}onPointerDown(e){this.session=new l5(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:m5(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:b2(e),onStart:b2(n),onMove:r,onEnd:(i,o)=>{delete this.session,s&&_n.update(()=>s(i,o))}}}mount(){this.removePointerDownListener=da(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Yce(){const t=p.useContext(d0);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:r}=t,s=p.useId();return p.useEffect(()=>r(s),[]),!e&&n?[!1,()=>n&&n(s)]:[!0]}const fx={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function S2(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Nf={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Dt.test(t))t=parseFloat(t);else return t;const n=S2(t,e.target.x),r=S2(t,e.target.y);return`${n}% ${r}%`}},Jce={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=Bl.parse(t);if(s.length>5)return r;const i=Bl.createTransformer(t),o=typeof s[0]!="number"?1:0,l=n.x.scale*e.x,c=n.y.scale*e.y;s[0+o]/=l,s[1+o]/=c;const u=nr(l,c,.5);return typeof s[2+o]=="number"&&(s[2+o]/=u),typeof s[3+o]=="number"&&(s[3+o]/=u),i(s)}};class Xce extends ct.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;oae(Qce),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),fx.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,o=r.projection;return o&&(o.isPresent=i,s||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||_n.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function p5(t){const[e,n]=Yce(),r=p.useContext(cI);return ct.createElement(Xce,{...t,layoutGroup:r,switchLayoutGroup:p.useContext(dU),isPresent:e,safeToRemove:n})}const Qce={borderRadius:{...Nf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Nf,borderTopRightRadius:Nf,borderBottomLeftRadius:Nf,borderBottomRightRadius:Nf,boxShadow:Jce},g5=["TopLeft","TopRight","BottomLeft","BottomRight"],Zce=g5.length,E2=t=>typeof t=="string"?parseFloat(t):t,C2=t=>typeof t=="number"||Dt.test(t);function eue(t,e,n,r,s,i){s?(t.opacity=nr(0,n.opacity!==void 0?n.opacity:1,tue(r)),t.opacityExit=nr(e.opacity!==void 0?e.opacity:1,0,nue(r))):i&&(t.opacity=nr(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<Zce;o++){const l=`border${g5[o]}Radius`;let c=T2(e,l),u=T2(n,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||C2(c)===C2(u)?(t[l]=Math.max(nr(E2(c),E2(u),r),0),(Oo.test(u)||Oo.test(c))&&(t[l]+="%")):t[l]=u}(e.rotate||n.rotate)&&(t.rotate=nr(e.rotate||0,n.rotate||0,r))}function T2(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const tue=y5(0,.5,$U),nue=y5(.5,.95,hr);function y5(t,e,n){return r=>r<t?0:r>e?1:n(vh(t,e,r))}function I2(t,e){t.min=e.min,t.max=e.max}function Ii(t,e){I2(t.x,e.x),I2(t.y,e.y)}function N2(t,e,n,r,s){return t-=e,t=jv(t,1/n,r),s!==void 0&&(t=jv(t,1/s,r)),t}function rue(t,e=0,n=1,r=.5,s,i=t,o=t){if(Oo.test(e)&&(e=parseFloat(e),e=nr(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=nr(i.min,i.max,r);t===i&&(l-=e),t.min=N2(t.min,e,n,l,s),t.max=N2(t.max,e,n,l,s)}function P2(t,e,[n,r,s],i,o){rue(t,e[n],e[r],e[s],e.scale,i,o)}const sue=["x","scaleX","originX"],iue=["y","scaleY","originY"];function A2(t,e,n,r){P2(t.x,e,sue,n?n.x:void 0,r?r.x:void 0),P2(t.y,e,iue,n?n.y:void 0,r?r.y:void 0)}function R2(t){return t.translate===0&&t.scale===1}function x5(t){return R2(t.x)&&R2(t.y)}function oue(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function v5(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function k2(t){return xi(t.x)/xi(t.y)}class aue{constructor(){this.members=[]}add(e){EI(this.members,e),e.scheduleRender()}remove(e){if(CI(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function j2(t,e,n){let r="";const s=t.x.translate/e.x,i=t.y.translate/e.y;if((s||i)&&(r=`translate3d(${s}px, ${i}px, 0) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:c,rotateX:u,rotateY:d}=n;c&&(r+=`rotate(${c}deg) `),u&&(r+=`rotateX(${u}deg) `),d&&(r+=`rotateY(${d}deg) `)}const o=t.x.scale*e.x,l=t.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const lue=(t,e)=>t.depth-e.depth;class cue{constructor(){this.children=[],this.isDirty=!1}add(e){EI(this.children,e),this.isDirty=!0}remove(e){CI(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(lue),this.isDirty=!1,this.children.forEach(e)}}function uue(t,e){const n=performance.now(),r=({timestamp:s})=>{const i=s-n;i>=e&&(fo(r),t(i-e))};return _n.read(r,!0),()=>fo(r)}function due(t){window.MotionDebug&&window.MotionDebug.record(t)}function hue(t){return t instanceof SVGElement&&t.tagName!=="svg"}function fue(t,e,n){const r=Xs(t)?t:io(t);return r.start(SI("",r,e,n)),r.animation}const D2=["","X","Y","Z"],mue={visibility:"hidden"},M2=1e3;let pue=0;const Ec={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function w5({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(o={},l=e==null?void 0:e()){this.id=pue++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Ec.totalNodes=Ec.resolvedTargetDeltas=Ec.recalculatedProjection=0,this.nodes.forEach(xue),this.nodes.forEach(Sue),this.nodes.forEach(Eue),this.nodes.forEach(vue),due(Ec)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new cue)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new TI),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=hue(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(u||c)&&(this.isLayoutDirty=!0),t){let h;const f=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=uue(f,250),fx.hasAnimatedSinceResize&&(fx.hasAnimatedSinceResize=!1,this.nodes.forEach(F2))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeTargetChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||d.getDefaultTransition()||Pue,{onLayoutAnimationStart:E,onLayoutAnimationComplete:v}=d.getProps(),_=!this.targetLayout||!v5(this.targetLayout,g)||m,S=!f&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||S||f&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,S);const I={...bI(x,"layout"),onPlay:E,onComplete:v};(d.shouldReduceMotion||this.options.layoutRoot)&&(I.delay=0,I.type=!1),this.startAnimation(I)}else f||F2(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,fo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Cue),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const h=this.path[d];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(L2);return}this.isUpdating||this.nodes.forEach(_ue),this.isUpdating=!1,this.nodes.forEach(bue),this.nodes.forEach(gue),this.nodes.forEach(yue),this.clearAllSnapshots();const l=performance.now();qr.delta=Ul(0,1e3/60,l-qr.timestamp),qr.timestamp=l,qr.isProcessing=!0,Cb.update.process(qr),Cb.preRender.process(qr),Cb.render.process(qr),qr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(wue),this.sharedNodes.forEach(Tue)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,_n.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){_n.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=br(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:r(this.instance),offset:n(this.instance)})}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!x5(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;o&&(l||Sc(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),Aue(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return br();const l=o.measureViewportBox(),{scroll:c}=this.root;return c&&(sl(l.x,c.offset.x),sl(l.y,c.offset.y)),l}removeElementScroll(o){const l=br();Ii(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;if(u!==this.root&&d&&h.layoutScroll){if(d.isRoot){Ii(l,o);const{scroll:f}=this.root;f&&(sl(l.x,-f.offset.x),sl(l.y,-f.offset.y))}sl(l.x,d.offset.x),sl(l.y,d.offset.y)}}return l}applyTransform(o,l=!1){const c=br();Ii(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Ld(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Sc(d.latestValues)&&Ld(c,d.latestValues)}return Sc(this.latestValues)&&Ld(c,this.latestValues),c}removeTransform(o){const l=br();Ii(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Sc(u.latestValues))continue;iC(u.latestValues)&&u.updateSnapshot();const d=br(),h=u.measurePageBox();Ii(d,h),A2(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Sc(this.latestValues)&&A2(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==qr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:f}=this.options;if(!(!this.layout||!(h||f))){if(this.resolvedRelativeTargetAt=qr.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=br(),this.relativeTargetOrigin=br(),Em(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Ii(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=br(),this.targetWithTransforms=br()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Rce(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ii(this.target,this.layout.layoutBox),h5(this.target,this.targetDelta)):Ii(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=br(),this.relativeTargetOrigin=br(),Em(this.relativeTargetOrigin,this.target,m.target),Ii(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Ec.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||iC(this.parent.latestValues)||d5(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===qr.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;Ii(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;$ce(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:g}=l;if(!g){this.projectionTransform&&(this.projectionDelta=Md(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Md(),this.projectionDeltaWithTransform=Md());const x=this.projectionTransform;Sm(this.projectionDelta,this.layoutCorrected,g,this.latestValues),this.projectionTransform=j2(this.projectionDelta,this.treeScale),(this.projectionTransform!==x||this.treeScale.x!==f||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),Ec.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},h=Md();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const f=br(),m=c?c.source:void 0,g=this.layout?this.layout.source:void 0,x=m!==g,E=this.getStack(),v=!E||E.members.length<=1,_=!!(x&&!v&&this.options.crossfade===!0&&!this.path.some(Nue));this.animationProgress=0;let S;this.mixTargetDelta=I=>{const M=I/1e3;O2(h.x,o.x,M),O2(h.y,o.y,M),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Em(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Iue(this.relativeTarget,this.relativeTargetOrigin,f,M),S&&oue(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=br()),Ii(S,this.relativeTarget)),x&&(this.animationValues=d,eue(d,u,this.latestValues,M,_,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=M},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(fo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=_n.update(()=>{fx.hasAnimatedSinceResize=!0,this.currentAnimation=fue(0,M2,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(M2),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=o;if(!(!l||!c||!u)){if(this!==o&&this.layout&&u&&_5(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||br();const h=xi(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+h;const f=xi(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+f}Ii(l,c),Ld(l,d),Sm(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new aue),this.sharedNodes.get(o).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const u={};for(let d=0;d<D2.length;d++){const h="rotate"+D2[d];c[h]&&(u[h]=c[h],o.setStaticValue(h,0))}o.render();for(const d in u)o.setStaticValue(d,u[d]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return mue;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=hx(o==null?void 0:o.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=hx(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Sc(this.latestValues)&&(x.transform=d?d({},""):"none",this.hasProjected=!1),x}const f=h.animationValues||h.latestValues;this.applyTransformsToTarget(),u.transform=j2(this.projectionDeltaWithTransform,this.treeScale,f),d&&(u.transform=d(f,u.transform));const{x:m,y:g}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,h.animationValues?u.opacity=h===this?(c=(l=f.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:u.opacity=h===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const x in Tv){if(f[x]===void 0)continue;const{correct:E,applyTo:v}=Tv[x],_=u.transform==="none"?f[x]:E(f[x],h);if(v){const S=v.length;for(let I=0;I<S;I++)u[v[I]]=_}else u[x]=_}return this.options.layoutId&&(u.pointerEvents=h===this?hx(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(L2),this.root.sharedNodes.clear()}}}function gue(t){t.updateLayout()}function yue(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;i==="size"?Ni(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],m=xi(f);f.min=r[h].min,f.max=f.min+m}):_5(i,n.layoutBox,r)&&Ni(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],m=xi(r[h]);f.max=f.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+m)});const l=Md();Sm(l,r,n.layoutBox);const c=Md();o?Sm(c,t.applyTransform(s,!0),n.measuredBox):Sm(c,r,n.layoutBox);const u=!x5(l);let d=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:m}=h;if(f&&m){const g=br();Em(g,n.layoutBox,f.layoutBox);const x=br();Em(x,r,m.layoutBox),v5(g,x)||(d=!0),h.options.layoutRoot&&(t.relativeTarget=x,t.relativeTargetOrigin=g,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function xue(t){Ec.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function vue(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function wue(t){t.clearSnapshot()}function L2(t){t.clearMeasurements()}function _ue(t){t.isLayoutDirty=!1}function bue(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function F2(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Sue(t){t.resolveTargetDelta()}function Eue(t){t.calcProjection()}function Cue(t){t.resetRotation()}function Tue(t){t.removeLeadSnapshot()}function O2(t,e,n){t.translate=nr(e.translate,0,n),t.scale=nr(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function V2(t,e,n,r){t.min=nr(e.min,n.min,r),t.max=nr(e.max,n.max,r)}function Iue(t,e,n,r){V2(t.x,e.x,n.x,r),V2(t.y,e.y,n.y,r)}function Nue(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Pue={duration:.45,ease:[.4,0,.1,1]},$2=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),U2=$2("applewebkit/")&&!$2("chrome/")?Math.round:hr;function B2(t){t.min=U2(t.min),t.max=U2(t.max)}function Aue(t){B2(t.x),B2(t.y)}function _5(t,e,n){return t==="position"||t==="preserve-aspect"&&!rC(k2(e),k2(n),.2)}const Rue=w5({attachResizeListener:(t,e)=>ia(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Lb={current:void 0},b5=w5({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Lb.current){const t=new Rue({});t.mount(window),t.setOptions({layoutScroll:!0}),Lb.current=t}return Lb.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),kue={pan:{Feature:Kce},drag:{Feature:qce,ProjectionNode:b5,MeasureLayout:p5}},jue=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Due(t){const e=jue.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]}function aC(t,e,n=1){const[r,s]=Due(t);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const o=i.trim();return s5(o)?parseFloat(o):o}else return JE(s)?aC(s,e,n+1):s}function Mue(t,{...e},n){const r=t.current;if(!(r instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(s=>{const i=s.get();if(!JE(i))return;const o=aC(i,r);o&&s.set(o)});for(const s in e){const i=e[s];if(!JE(i))continue;const o=aC(i,r);o&&(e[s]=o,n||(n={}),n[s]===void 0&&(n[s]=i))}return{target:e,transitionEnd:n}}const Lue=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),S5=t=>Lue.has(t),Fue=t=>Object.keys(t).some(S5),z2=t=>t===Ru||t===Dt,G2=(t,e)=>parseFloat(t.split(", ")[e]),H2=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/);if(s)return G2(s[1],e);{const i=r.match(/^matrix\((.+)\)$/);return i?G2(i[1],t):0}},Oue=new Set(["x","y","z"]),Vue=Xp.filter(t=>!Oue.has(t));function $ue(t){const e=[];return Vue.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const wh={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:H2(4,13),y:H2(5,14)};wh.translateX=wh.x;wh.translateY=wh.y;const Uue=(t,e,n)=>{const r=e.measureViewportBox(),s=e.current,i=getComputedStyle(s),{display:o}=i,l={};o==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(u=>{l[u]=wh[u](r,i)}),e.render();const c=e.measureViewportBox();return n.forEach(u=>{const d=e.getValue(u);d&&d.jump(l[u]),t[u]=wh[u](c,i)}),t},Bue=(t,e,n={},r={})=>{e={...e},r={...r};const s=Object.keys(e).filter(S5);let i=[],o=!1;const l=[];if(s.forEach(c=>{const u=t.getValue(c);if(!t.hasValue(c))return;let d=n[c],h=If(d);const f=e[c];let m;if(Nv(f)){const g=f.length,x=f[0]===null?1:0;d=f[x],h=If(d);for(let E=x;E<g&&f[E]!==null;E++)m?x0(If(f[E])===m):m=If(f[E])}else m=If(f);if(h!==m)if(z2(h)&&z2(m)){const g=u.get();typeof g=="string"&&u.set(parseFloat(g)),typeof f=="string"?e[c]=parseFloat(f):Array.isArray(f)&&m===Dt&&(e[c]=f.map(parseFloat))}else h!=null&&h.transform&&(m!=null&&m.transform)&&(d===0||f===0)?d===0?u.set(m.transform(d)):e[c]=h.transform(f):(o||(i=$ue(t),o=!0),l.push(c),r[c]=r[c]!==void 0?r[c]:e[c],u.jump(f))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,u=Uue(e,t,l);return i.length&&i.forEach(([d,h])=>{t.getValue(d).set(h)}),t.render(),h0&&c!==null&&window.scrollTo({top:c}),{target:u,transitionEnd:r}}else return{target:e,transitionEnd:r}};function zue(t,e,n,r){return Fue(e)?Bue(t,e,n,r):{target:e,transitionEnd:r}}const Gue=(t,e,n,r)=>{const s=Mue(t,e,r);return e=s.target,r=s.transitionEnd,zue(t,e,n,r)},lC={current:null},E5={current:!1};function Hue(){if(E5.current=!0,!!h0)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>lC.current=t.matches;t.addListener(e),e()}else lC.current=!1}function Wue(t,e,n){const{willChange:r}=e;for(const s in e){const i=e[s],o=n[s];if(Xs(i))t.addValue(s,i),kv(r)&&r.add(s);else if(Xs(o))t.addValue(s,io(i,{owner:t})),kv(r)&&r.remove(s);else if(o!==i)if(t.hasValue(s)){const l=t.getValue(s);!l.hasAnimated&&l.set(i)}else{const l=t.getStaticValue(s);t.addValue(s,io(l!==void 0?l:i,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const W2=new WeakMap,C5=Object.keys(fp),que=C5.length,q2=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Kue=lI.length;class Yue{constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>_n.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.isControllingVariants=m0(n),this.isVariantNode=uU(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{});for(const h in d){const f=d[h];l[h]!==void 0&&Xs(f)&&(f.set(l[h],!1),kv(u)&&u.add(h))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,W2.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),E5.current||Hue(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:lC.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){W2.delete(this.current),this.projection&&this.projection.unmount(),fo(this.notifyUpdate),fo(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const r=Au.has(e),s=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&_n.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{s(),i()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},r,s,i){let o,l;for(let c=0;c<que;c++){const u=C5[c],{isEnabled:d,Feature:h,ProjectionNode:f,MeasureLayout:m}=fp[u];f&&(o=f),d(n)&&(!this.features[u]&&h&&(this.features[u]=new h(this)),m&&(l=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:d,dragConstraints:h,layoutScroll:f,layoutRoot:m}=n;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||h&&jd(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:i,layoutScroll:f,layoutRoot:m})}return l}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):br()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<q2.length;r++){const s=q2[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i=e["on"+s];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=Wue(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const n={};for(let r=0;r<Kue;r++){const s=lI[r],i=this.props[s];(hp(i)||i===!1)&&(n[s]=i)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=io(n,{owner:this}),this.addValue(e,r)),r}readValue(e){var n;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props,s=typeof r=="string"||typeof r=="object"?(n=gI(this.props,r))===null||n===void 0?void 0:n[e]:void 0;if(r&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Xs(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new TI),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class T5 extends Yue{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...r},{transformValues:s},i){let o=hce(r,e||{},this);if(s&&(n&&(n=s(n)),r&&(r=s(r)),o&&(o=s(o))),i){uce(this,r,o);const l=Gue(this,r,o,n);n=l.transitionEnd,r=l.target}return{transition:e,transitionEnd:n,...r}}}function Jue(t){return window.getComputedStyle(t)}class Xue extends T5{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,n){if(Au.has(n)){const r=_I(n);return r&&r.default||0}else{const r=Jue(e),s=(mU(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return f5(e,n)}build(e,n,r,s){dI(e,n,r,s.transformTemplate)}scrapeMotionValuesFromProps(e,n){return pI(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Xs(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,r,s){wU(e,n,r,s)}}class Que extends T5{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Au.has(n)){const r=_I(n);return r&&r.default||0}return n=_U.has(n)?n:oI(n),e.getAttribute(n)}measureInstanceViewportBox(){return br()}scrapeMotionValuesFromProps(e,n){return SU(e,n)}build(e,n,r,s){fI(e,n,r,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,r,s){bU(e,n,r,s)}mount(e){this.isSVGTag=mI(e.tagName),super.mount(e)}}const Zue=(t,e)=>uI(t)?new Que(e,{enableHardwareAcceleration:!1}):new Xue(e,{enableHardwareAcceleration:!0}),ede={layout:{ProjectionNode:b5,MeasureLayout:p5}},tde={...Ice,...Yae,...kue,...ede},Ct=sae((t,e)=>Lae(t,e,tde,Zue));function I5(){const t=p.useRef(!1);return Jp(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function nde(){const t=I5(),[e,n]=p.useState(0),r=p.useCallback(()=>{t.current&&n(e+1)},[e]);return[p.useCallback(()=>_n.postRender(r),[r]),e]}class rde extends p.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function sde({children:t,isPresent:e}){const n=p.useId(),r=p.useRef(null),s=p.useRef({width:0,height:0,top:0,left:0});return p.useInsertionEffect(()=>{const{width:i,height:o,top:l,left:c}=s.current;if(e||!r.current||!i||!o)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),p.createElement(rde,{isPresent:e,childRef:r,sizeRef:s},p.cloneElement(t,{ref:r}))}const Fb=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:o})=>{const l=eg(ide),c=p.useId(),u=p.useMemo(()=>({id:c,initial:e,isPresent:n,custom:s,onExitComplete:d=>{l.set(d,!0);for(const h of l.values())if(!h)return;r&&r()},register:d=>(l.set(d,!1),()=>l.delete(d))}),i?void 0:[n]);return p.useMemo(()=>{l.forEach((d,h)=>l.set(h,!1))},[n]),p.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),o==="popLayout"&&(t=p.createElement(sde,{isPresent:n},t)),p.createElement(d0.Provider,{value:u},t)};function ide(){return new Map}function ode(t){return p.useEffect(()=>()=>t(),[])}const Cc=t=>t.key||"";function ade(t,e){t.forEach(n=>{const r=Cc(n);e.set(r,n)})}function lde(t){const e=[];return p.Children.forEach(t,n=>{p.isValidElement(n)&&e.push(n)}),e}const _h=({children:t,custom:e,initial:n=!0,onExitComplete:r,exitBeforeEnter:s,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const l=p.useContext(cI).forceRender||nde()[0],c=I5(),u=lde(t);let d=u;const h=p.useRef(new Map).current,f=p.useRef(d),m=p.useRef(new Map).current,g=p.useRef(!0);if(Jp(()=>{g.current=!1,ade(u,m),f.current=d}),ode(()=>{g.current=!0,m.clear(),h.clear()}),g.current)return p.createElement(p.Fragment,null,d.map(_=>p.createElement(Fb,{key:Cc(_),isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:i,mode:o},_)));d=[...d];const x=f.current.map(Cc),E=u.map(Cc),v=x.length;for(let _=0;_<v;_++){const S=x[_];E.indexOf(S)===-1&&!h.has(S)&&h.set(S,void 0)}return o==="wait"&&h.size&&(d=[]),h.forEach((_,S)=>{if(E.indexOf(S)!==-1)return;const I=m.get(S);if(!I)return;const M=x.indexOf(S);let j=_;if(!j){const C=()=>{h.delete(S);const T=Array.from(m.keys()).filter(P=>!E.includes(P));if(T.forEach(P=>m.delete(P)),f.current=u.filter(P=>{const A=Cc(P);return A===S||T.includes(A)}),!h.size){if(c.current===!1)return;l(),r&&r()}};j=p.createElement(Fb,{key:Cc(I),isPresent:!1,onExitComplete:C,custom:e,presenceAffectsLayout:i,mode:o},I),h.set(S,j)}d.splice(M,0,j)}),d=d.map(_=>{const S=_.key;return h.has(S)?_:p.createElement(Fb,{key:Cc(_),isPresent:!0,presenceAffectsLayout:i,mode:o},_)}),p.createElement(p.Fragment,null,h.size?d:d.map(_=>p.cloneElement(_)))};function cde(t){const e=eg(()=>io(t)),{isStatic:n}=p.useContext(iI);if(n){const[,r]=p.useState(t);p.useEffect(()=>e.on("change",r),[])}return e}const ude=t=>t&&typeof t=="object"&&t.mix,dde=t=>ude(t)?t.mix:void 0;function hde(...t){const e=!Array.isArray(t[0]),n=e?0:-1,r=t[0+n],s=t[1+n],i=t[2+n],o=t[3+n],l=v0(s,i,{mixer:dde(i[0]),...o});return e?l(r):l}function N5(t,e){const n=cde(e()),r=()=>n.set(e());return r(),Jp(()=>{const s=()=>_n.update(r,!1,!0),i=t.map(o=>o.on("change",s));return()=>{i.forEach(o=>o()),fo(r)}}),n}function fde(t){bm.current=[],t();const e=N5(bm.current,t);return bm.current=void 0,e}function Ob(t,e,n,r){if(typeof t=="function")return fde(t);const s=typeof e=="function"?e:hde(e,n,r);return Array.isArray(t)?K2(t,s):K2([t],([i])=>s(i))}function K2(t,e){const n=eg(()=>[]);return N5(t,()=>{n.length=0;const r=t.length;for(let s=0;s<r;s++)n[s]=t[s].get();return e(n)})}function P5(t,e,n){var r;if(typeof t=="string"){let s=document;e&&(x0(!!e.current),s=e.current),n?((r=n[t])!==null&&r!==void 0||(n[t]=s.querySelectorAll(t)),t=n[t]):t=s.querySelectorAll(t)}else t instanceof Element&&(t=[t]);return Array.from(t||[])}const mx=new WeakMap;let el;function mde(t,e){if(e){const{inlineSize:n,blockSize:r}=e[0];return{width:n,height:r}}else return t instanceof SVGElement&&"getBBox"in t?t.getBBox():{width:t.offsetWidth,height:t.offsetHeight}}function pde({target:t,contentRect:e,borderBoxSize:n}){var r;(r=mx.get(t))===null||r===void 0||r.forEach(s=>{s({target:t,contentSize:e,get size(){return mde(t,n)}})})}function gde(t){t.forEach(pde)}function yde(){typeof ResizeObserver>"u"||(el=new ResizeObserver(gde))}function xde(t,e){el||yde();const n=P5(t);return n.forEach(r=>{let s=mx.get(r);s||(s=new Set,mx.set(r,s)),s.add(e),el==null||el.observe(r)}),()=>{n.forEach(r=>{const s=mx.get(r);s==null||s.delete(e),s!=null&&s.size||el==null||el.unobserve(r)})}}const px=new Set;let Cm;function vde(){Cm=()=>{const t={width:window.innerWidth,height:window.innerHeight},e={target:window,size:t,contentSize:t};px.forEach(n=>n(e))},window.addEventListener("resize",Cm)}function wde(t){return px.add(t),Cm||vde(),()=>{px.delete(t),!px.size&&Cm&&(Cm=void 0)}}function _de(t,e){return typeof t=="function"?wde(t):xde(t,e)}const bde=50,Y2=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),Sde=()=>({time:0,x:Y2(),y:Y2()}),Ede={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function J2(t,e,n,r){const s=n[e],{length:i,position:o}=Ede[e],l=s.current,c=n.time;s.current=t["scroll"+o],s.scrollLength=t["scroll"+i]-t["client"+i],s.offset.length=0,s.offset[0]=0,s.offset[1]=s.scrollLength,s.progress=vh(0,s.scrollLength,s.current);const u=r-c;s.velocity=u>bde?0:wI(s.current-l,u)}function Cde(t,e,n){J2(t,"x",e,n),J2(t,"y",e,n),e.time=n}function Tde(t,e){const n={x:0,y:0};let r=t;for(;r&&r!==e;)if(r instanceof HTMLElement)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;else if(r.tagName==="svg"){const s=r.getBoundingClientRect();r=r.parentElement;const i=r.getBoundingClientRect();n.x+=s.left-i.left,n.y+=s.top-i.top}else if(r instanceof SVGGraphicsElement){const{x:s,y:i}=r.getBBox();n.x+=s,n.y+=i;let o=null,l=r.parentNode;for(;!o;)l.tagName==="svg"&&(o=l),l=r.parentNode;r=o}else break;return n}const Ide={Enter:[[0,1],[1,1]],Exit:[[0,0],[1,0]],Any:[[1,0],[0,1]],All:[[0,0],[1,1]]},cC={start:0,center:.5,end:1};function X2(t,e,n=0){let r=0;if(cC[t]!==void 0&&(t=cC[t]),typeof t=="string"){const s=parseFloat(t);t.endsWith("px")?r=s:t.endsWith("%")?t=s/100:t.endsWith("vw")?r=s/100*document.documentElement.clientWidth:t.endsWith("vh")?r=s/100*document.documentElement.clientHeight:t=s}return typeof t=="number"&&(r=e*t),n+r}const Nde=[0,0];function Pde(t,e,n,r){let s=Array.isArray(t)?t:Nde,i=0,o=0;return typeof t=="number"?s=[t,t]:typeof t=="string"&&(t=t.trim(),t.includes(" ")?s=t.split(" "):s=[t,cC[t]?t:"0"]),i=X2(s[0],n,r),o=X2(s[1],e),i-o}const Ade={x:0,y:0};function Rde(t){return"getBBox"in t&&t.tagName!=="svg"?t.getBBox():{width:t.clientWidth,height:t.clientHeight}}function kde(t,e,n){let{offset:r=Ide.All}=n;const{target:s=t,axis:i="y"}=n,o=i==="y"?"height":"width",l=s!==t?Tde(s,t):Ade,c=s===t?{width:t.scrollWidth,height:t.scrollHeight}:Rde(s),u={width:t.clientWidth,height:t.clientHeight};e[i].offset.length=0;let d=!e[i].interpolate;const h=r.length;for(let f=0;f<h;f++){const m=Pde(r[f],u[o],c[o],l[i]);!d&&m!==e[i].interpolatorOffsets[f]&&(d=!0),e[i].offset[f]=m}d&&(e[i].interpolate=v0(e[i].offset,ZU(r)),e[i].interpolatorOffsets=[...e[i].offset]),e[i].progress=e[i].interpolate(e[i].current)}function jde(t,e=t,n){if(n.x.targetOffset=0,n.y.targetOffset=0,e!==t){let r=e;for(;r&&r!==t;)n.x.targetOffset+=r.offsetLeft,n.y.targetOffset+=r.offsetTop,r=r.offsetParent}n.x.targetLength=e===t?e.scrollWidth:e.clientWidth,n.y.targetLength=e===t?e.scrollHeight:e.clientHeight,n.x.containerLength=t.clientWidth,n.y.containerLength=t.clientHeight}function Dde(t,e,n,r={}){return{measure:()=>jde(t,r.target,n),update:s=>{Cde(t,n,s),(r.offset||r.target)&&kde(t,n,r)},notify:()=>e(n)}}const Pf=new WeakMap,Q2=new WeakMap,Vb=new WeakMap,Z2=t=>t===document.documentElement?window:t;function Mde(t,{container:e=document.documentElement,...n}={}){let r=Vb.get(e);r||(r=new Set,Vb.set(e,r));const s=Sde(),i=Dde(e,t,s,n);if(r.add(i),!Pf.has(e)){const l=()=>{for(const f of r)f.measure()},c=()=>{for(const f of r)f.update(qr.timestamp)},u=()=>{for(const f of r)f.notify()},d=()=>{_n.read(l,!1,!0),_n.read(c,!1,!0),_n.update(u,!1,!0)};Pf.set(e,d);const h=Z2(e);window.addEventListener("resize",d,{passive:!0}),e!==document.documentElement&&Q2.set(e,_de(e,d)),h.addEventListener("scroll",d,{passive:!0})}const o=Pf.get(e);return _n.read(o,!1,!0),()=>{var l;fo(o);const c=Vb.get(e);if(!c||(c.delete(i),c.size))return;const u=Pf.get(e);Pf.delete(e),u&&(Z2(e).removeEventListener("scroll",u),(l=Q2.get(e))===null||l===void 0||l(),window.removeEventListener("resize",u))}}function eD(t,e){RU(!!(!e||e.current))}const Lde=()=>({scrollX:io(0),scrollY:io(0),scrollXProgress:io(0),scrollYProgress:io(0)});function Fde({container:t,target:e,layoutEffect:n=!0,...r}={}){const s=eg(Lde);return(n?Jp:p.useEffect)(()=>(eD("target",e),eD("container",t),Mde(({x:o,y:l})=>{s.scrollX.set(o.current),s.scrollXProgress.set(o.progress),s.scrollY.set(l.current),s.scrollYProgress.set(l.progress)},{...r,container:(t==null?void 0:t.current)||void 0,target:(e==null?void 0:e.current)||void 0})),[t,e,JSON.stringify(r.offset)]),s}const Ode={some:0,all:1};function Vde(t,e,{root:n,margin:r,amount:s="some"}={}){const i=P5(t),o=new WeakMap,l=u=>{u.forEach(d=>{const h=o.get(d.target);if(d.isIntersecting!==!!h)if(d.isIntersecting){const f=e(d);typeof f=="function"?o.set(d.target,f):c.unobserve(d.target)}else h&&(h(d),o.delete(d.target))})},c=new IntersectionObserver(l,{root:n,rootMargin:r,threshold:typeof s=="number"?s:Ode[s]});return i.forEach(u=>c.observe(u)),()=>c.disconnect()}function $de(t,{root:e,margin:n,amount:r,once:s=!1}={}){const[i,o]=p.useState(!1);return p.useEffect(()=>{if(!t.current||s&&i)return;const l=()=>(o(!0),s?void 0:()=>o(!1)),c={root:e&&e.current||void 0,margin:n,amount:r};return Vde(t.current,l,c)},[e,t,n,s,r]),i}function Ude(t,[e,n]){return Math.min(n,Math.max(e,t))}function Bde(t,e){return p.useReducer((n,r)=>e[n][r]??n,t)}var II="ScrollArea",[A5,Ske]=Si(II),[zde,Wi]=A5(II),R5=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...o}=t,[l,c]=p.useState(null),[u,d]=p.useState(null),[h,f]=p.useState(null),[m,g]=p.useState(null),[x,E]=p.useState(null),[v,_]=p.useState(0),[S,I]=p.useState(0),[M,j]=p.useState(!1),[C,T]=p.useState(!1),P=bn(e,D=>c(D)),A=a0(s);return a.jsx(zde,{scope:n,type:r,dir:A,scrollHideDelay:i,scrollArea:l,viewport:u,onViewportChange:d,content:h,onContentChange:f,scrollbarX:m,onScrollbarXChange:g,scrollbarXEnabled:M,onScrollbarXEnabledChange:j,scrollbarY:x,onScrollbarYChange:E,scrollbarYEnabled:C,onScrollbarYEnabledChange:T,onCornerWidthChange:_,onCornerHeightChange:I,children:a.jsx(Kt.div,{dir:A,...o,ref:P,style:{position:"relative","--radix-scroll-area-corner-width":v+"px","--radix-scroll-area-corner-height":S+"px",...t.style}})})});R5.displayName=II;var k5="ScrollAreaViewport",j5=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=t,o=Wi(k5,n),l=p.useRef(null),c=bn(e,l,o.onViewportChange);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),a.jsx(Kt.div,{"data-radix-scroll-area-viewport":"",...i,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...t.style},children:a.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});j5.displayName=k5;var Yo="ScrollAreaScrollbar",NI=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=Wi(Yo,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=s,l=t.orientation==="horizontal";return p.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),s.type==="hover"?a.jsx(Gde,{...r,ref:e,forceMount:n}):s.type==="scroll"?a.jsx(Hde,{...r,ref:e,forceMount:n}):s.type==="auto"?a.jsx(D5,{...r,ref:e,forceMount:n}):s.type==="always"?a.jsx(PI,{...r,ref:e}):null});NI.displayName=Yo;var Gde=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=Wi(Yo,t.__scopeScrollArea),[i,o]=p.useState(!1);return p.useEffect(()=>{const l=s.scrollArea;let c=0;if(l){const u=()=>{window.clearTimeout(c),o(!0)},d=()=>{c=window.setTimeout(()=>o(!1),s.scrollHideDelay)};return l.addEventListener("pointerenter",u),l.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",u),l.removeEventListener("pointerleave",d)}}},[s.scrollArea,s.scrollHideDelay]),a.jsx(Ms,{present:n||i,children:a.jsx(D5,{"data-state":i?"visible":"hidden",...r,ref:e})})}),Hde=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=Wi(Yo,t.__scopeScrollArea),i=t.orientation==="horizontal",o=_0(()=>c("SCROLL_END"),100),[l,c]=Bde("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return p.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>c("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,s.scrollHideDelay,c]),p.useEffect(()=>{const u=s.viewport,d=i?"scrollLeft":"scrollTop";if(u){let h=u[d];const f=()=>{const m=u[d];h!==m&&(c("SCROLL"),o()),h=m};return u.addEventListener("scroll",f),()=>u.removeEventListener("scroll",f)}},[s.viewport,i,c,o]),a.jsx(Ms,{present:n||l!=="hidden",children:a.jsx(PI,{"data-state":l==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:wt(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:wt(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),D5=p.forwardRef((t,e)=>{const n=Wi(Yo,t.__scopeScrollArea),{forceMount:r,...s}=t,[i,o]=p.useState(!1),l=t.orientation==="horizontal",c=_0(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,d=n.viewport.offsetHeight<n.viewport.scrollHeight;o(l?u:d)}},10);return bh(n.viewport,c),bh(n.content,c),a.jsx(Ms,{present:r||i,children:a.jsx(PI,{"data-state":i?"visible":"hidden",...s,ref:e})})}),PI=p.forwardRef((t,e)=>{const{orientation:n="vertical",...r}=t,s=Wi(Yo,t.__scopeScrollArea),i=p.useRef(null),o=p.useRef(0),[l,c]=p.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=V5(l.viewport,l.content),d={...r,sizes:l,onSizesChange:c,hasThumb:u>0&&u<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function h(f,m){return Xde(f,o.current,l,m)}return n==="horizontal"?a.jsx(Wde,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollLeft,m=tD(f,l,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollLeft=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollLeft=h(f,s.dir))}}):n==="vertical"?a.jsx(qde,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollTop,m=tD(f,l);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollTop=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollTop=h(f))}}):null}),Wde=p.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=Wi(Yo,t.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=bn(e,c,i.onScrollbarXChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(L5,{"data-orientation":"horizontal",...s,ref:u,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":w0(n)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.x),onDragScroll:d=>t.onDragScroll(d.x),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+d.deltaX;t.onWheelScroll(f),U5(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:Mv(o.paddingLeft),paddingEnd:Mv(o.paddingRight)}})}})}),qde=p.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=Wi(Yo,t.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=bn(e,c,i.onScrollbarYChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(L5,{"data-orientation":"vertical",...s,ref:u,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":w0(n)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.y),onDragScroll:d=>t.onDragScroll(d.y),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollTop+d.deltaY;t.onWheelScroll(f),U5(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:Mv(o.paddingTop),paddingEnd:Mv(o.paddingBottom)}})}})}),[Kde,M5]=A5(Yo),L5=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:d,onResize:h,...f}=t,m=Wi(Yo,n),[g,x]=p.useState(null),E=bn(e,P=>x(P)),v=p.useRef(null),_=p.useRef(""),S=m.viewport,I=r.content-r.viewport,M=Cr(d),j=Cr(c),C=_0(h,10);function T(P){if(v.current){const A=P.clientX-v.current.left,D=P.clientY-v.current.top;u({x:A,y:D})}}return p.useEffect(()=>{const P=A=>{const D=A.target;(g==null?void 0:g.contains(D))&&M(A,I)};return document.addEventListener("wheel",P,{passive:!1}),()=>document.removeEventListener("wheel",P,{passive:!1})},[S,g,I,M]),p.useEffect(j,[r,j]),bh(g,C),bh(m.content,C),a.jsx(Kde,{scope:n,scrollbar:g,hasThumb:s,onThumbChange:Cr(i),onThumbPointerUp:Cr(o),onThumbPositionChange:j,onThumbPointerDown:Cr(l),children:a.jsx(Kt.div,{...f,ref:E,style:{position:"absolute",...f.style},onPointerDown:wt(t.onPointerDown,P=>{P.button===0&&(P.target.setPointerCapture(P.pointerId),v.current=g.getBoundingClientRect(),_.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),T(P))}),onPointerMove:wt(t.onPointerMove,T),onPointerUp:wt(t.onPointerUp,P=>{const A=P.target;A.hasPointerCapture(P.pointerId)&&A.releasePointerCapture(P.pointerId),document.body.style.webkitUserSelect=_.current,m.viewport&&(m.viewport.style.scrollBehavior=""),v.current=null})})})}),Dv="ScrollAreaThumb",F5=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=M5(Dv,t.__scopeScrollArea);return a.jsx(Ms,{present:n||s.hasThumb,children:a.jsx(Yde,{ref:e,...r})})}),Yde=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:r,...s}=t,i=Wi(Dv,n),o=M5(Dv,n),{onThumbPositionChange:l}=o,c=bn(e,h=>o.onThumbChange(h)),u=p.useRef(void 0),d=_0(()=>{u.current&&(u.current(),u.current=void 0)},100);return p.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(d(),!u.current){const m=Qde(h,l);u.current=m,l()}};return l(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,d,l]),a.jsx(Kt.div,{"data-state":o.hasThumb?"visible":"hidden",...s,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:wt(t.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),g=h.clientX-m.left,x=h.clientY-m.top;o.onThumbPointerDown({x:g,y:x})}),onPointerUp:wt(t.onPointerUp,o.onThumbPointerUp)})});F5.displayName=Dv;var AI="ScrollAreaCorner",O5=p.forwardRef((t,e)=>{const n=Wi(AI,t.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?a.jsx(Jde,{...t,ref:e}):null});O5.displayName=AI;var Jde=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,...r}=t,s=Wi(AI,n),[i,o]=p.useState(0),[l,c]=p.useState(0),u=!!(i&&l);return bh(s.scrollbarX,()=>{var h;const d=((h=s.scrollbarX)==null?void 0:h.offsetHeight)||0;s.onCornerHeightChange(d),c(d)}),bh(s.scrollbarY,()=>{var h;const d=((h=s.scrollbarY)==null?void 0:h.offsetWidth)||0;s.onCornerWidthChange(d),o(d)}),u?a.jsx(Kt.div,{...r,ref:e,style:{width:i,height:l,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function Mv(t){return t?parseInt(t,10):0}function V5(t,e){const n=t/e;return isNaN(n)?0:n}function w0(t){const e=V5(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-n)*e;return Math.max(r,18)}function Xde(t,e,n,r="ltr"){const s=w0(n),i=s/2,o=e||i,l=s-o,c=n.scrollbar.paddingStart+o,u=n.scrollbar.size-n.scrollbar.paddingEnd-l,d=n.content-n.viewport,h=r==="ltr"?[0,d]:[d*-1,0];return $5([c,u],h)(t)}function tD(t,e,n="ltr"){const r=w0(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-s,o=e.content-e.viewport,l=i-r,c=n==="ltr"?[0,o]:[o*-1,0],u=Ude(t,c);return $5([0,o],[0,l])(u)}function $5(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function U5(t,e){return t>0&&t<e}var Qde=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},r=0;return function s(){const i={left:t.scrollLeft,top:t.scrollTop},o=n.left!==i.left,l=n.top!==i.top;(o||l)&&e(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function _0(t,e){const n=Cr(t),r=p.useRef(0);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),p.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,e)},[n,e])}function bh(t,e){const n=Cr(e);Bo(()=>{let r=0;if(t){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(t),()=>{window.cancelAnimationFrame(r),s.unobserve(t)}}},[t,n])}var B5=R5,Zde=j5,ehe=O5;const Gi=ct.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(B5,{ref:r,className:bt("relative overflow-hidden",t),...n,children:[a.jsx(Zde,{className:"h-full w-full rounded-[inherit]",children:e}),a.jsx(z5,{}),a.jsx(ehe,{})]}));Gi.displayName=B5.displayName;const z5=ct.forwardRef(({className:t,orientation:e="vertical",...n},r)=>a.jsx(NI,{ref:r,orientation:e,className:bt("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:a.jsx(F5,{className:"relative flex-1 rounded-full bg-border"})}));z5.displayName=NI.displayName;const uC="RFC3986",dC={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},the="RFC1738",nhe=Array.isArray,bo=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),$b=1024,rhe=(t,e,n,r,s)=>{if(t.length===0)return t;let i=t;if(typeof t=="symbol"?i=Symbol.prototype.toString.call(t):typeof t!="string"&&(i=String(t)),n==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let o="";for(let l=0;l<i.length;l+=$b){const c=i.length>=$b?i.slice(l,l+$b):i,u=[];for(let d=0;d<c.length;++d){let h=c.charCodeAt(d);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||s===the&&(h===40||h===41)){u[u.length]=c.charAt(d);continue}if(h<128){u[u.length]=bo[h];continue}if(h<2048){u[u.length]=bo[192|h>>6]+bo[128|h&63];continue}if(h<55296||h>=57344){u[u.length]=bo[224|h>>12]+bo[128|h>>6&63]+bo[128|h&63];continue}d+=1,h=65536+((h&1023)<<10|c.charCodeAt(d)&1023),u[u.length]=bo[240|h>>18]+bo[128|h>>12&63]+bo[128|h>>6&63]+bo[128|h&63]}o+=u.join("")}return o};function she(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function nD(t,e){if(nhe(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const ihe=Object.prototype.hasOwnProperty,G5={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},Co=Array.isArray,ohe=Array.prototype.push,H5=function(t,e){ohe.apply(t,Co(e)?e:[e])},ahe=Date.prototype.toISOString,Rr={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:rhe,encodeValuesOnly:!1,format:uC,formatter:dC[uC],indices:!1,serializeDate(t){return ahe.call(t)},skipNulls:!1,strictNullHandling:!1};function lhe(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const Ub={};function W5(t,e,n,r,s,i,o,l,c,u,d,h,f,m,g,x,E,v){let _=t,S=v,I=0,M=!1;for(;(S=S.get(Ub))!==void 0&&!M;){const A=S.get(t);if(I+=1,typeof A<"u"){if(A===I)throw new RangeError("Cyclic object value");M=!0}typeof S.get(Ub)>"u"&&(I=0)}if(typeof u=="function"?_=u(e,_):_ instanceof Date?_=f==null?void 0:f(_):n==="comma"&&Co(_)&&(_=nD(_,function(A){return A instanceof Date?f==null?void 0:f(A):A})),_===null){if(i)return c&&!x?c(e,Rr.encoder,E,"key",m):e;_=""}if(lhe(_)||she(_)){if(c){const A=x?e:c(e,Rr.encoder,E,"key",m);return[(g==null?void 0:g(A))+"="+(g==null?void 0:g(c(_,Rr.encoder,E,"value",m)))]}return[(g==null?void 0:g(e))+"="+(g==null?void 0:g(String(_)))]}const j=[];if(typeof _>"u")return j;let C;if(n==="comma"&&Co(_))x&&c&&(_=nD(_,c)),C=[{value:_.length>0?_.join(",")||null:void 0}];else if(Co(u))C=u;else{const A=Object.keys(_);C=d?A.sort(d):A}const T=l?String(e).replace(/\./g,"%2E"):String(e),P=r&&Co(_)&&_.length===1?T+"[]":T;if(s&&Co(_)&&_.length===0)return P+"[]";for(let A=0;A<C.length;++A){const D=C[A],R=typeof D=="object"&&typeof D.value<"u"?D.value:_[D];if(o&&R===null)continue;const k=h&&l?D.replace(/\./g,"%2E"):D,U=Co(_)?typeof n=="function"?n(P,k):P:P+(h?"."+k:"["+k+"]");v.set(t,I);const B=new WeakMap;B.set(Ub,v),H5(j,W5(R,U,n,r,s,i,o,l,n==="comma"&&x&&Co(_)?null:c,u,d,h,f,m,g,x,E,B))}return j}function che(t=Rr){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Rr.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=uC;if(typeof t.format<"u"){if(!ihe.call(dC,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=dC[n];let s=Rr.filter;(typeof t.filter=="function"||Co(t.filter))&&(s=t.filter);let i;if(t.arrayFormat&&t.arrayFormat in G5?i=t.arrayFormat:"indices"in t?i=t.indices?"indices":"repeat":i=Rr.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Rr.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Rr.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Rr.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Rr.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Rr.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Rr.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Rr.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Rr.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Rr.encodeValuesOnly,filter:s,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Rr.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Rr.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Rr.strictNullHandling}}function uhe(t,e={}){let n=t;const r=che(e);let s,i;typeof r.filter=="function"?(i=r.filter,n=i("",n)):Co(r.filter)&&(i=r.filter,s=i);const o=[];if(typeof n!="object"||n===null)return"";const l=G5[r.arrayFormat],c=l==="comma"&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const u=new WeakMap;for(let f=0;f<s.length;++f){const m=s[f];r.skipNulls&&n[m]===null||H5(o,W5(n[m],m,l,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}const d=o.join(r.delimiter);let h=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),d.length>0?h+d:""}const ud="4.103.0";let rD=!1,Tm,q5,K5,hC,Y5,J5,X5,Q5,Z5;function dhe(t,e={auto:!1}){if(rD)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(Tm)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${Tm}'\``);rD=e.auto,Tm=t.kind,q5=t.fetch,t.Request,t.Response,t.Headers,K5=t.FormData,t.Blob,hC=t.File,Y5=t.ReadableStream,J5=t.getMultipartRequestOptions,X5=t.getDefaultAgent,Q5=t.fileFromPath,Z5=t.isFsReadStream}class hhe{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function fhe({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new hhe(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}const e6=()=>{Tm||dhe(fhe(),{auto:!0})};e6();class Mt extends Error{}class rs extends Mt{constructor(e,n,r,s){super(`${rs.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=n;const i=n;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e||!s)return new b0({message:r,cause:mC(n)});const i=n==null?void 0:n.error;return e===400?new t6(e,i,r,s):e===401?new n6(e,i,r,s):e===403?new r6(e,i,r,s):e===404?new s6(e,i,r,s):e===409?new i6(e,i,r,s):e===422?new o6(e,i,r,s):e===429?new a6(e,i,r,s):e>=500?new l6(e,i,r,s):new rs(e,i,r,s)}}class Mi extends rs{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class b0 extends rs{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class RI extends b0{constructor({message:e}={}){super({message:e??"Request timed out."})}}class t6 extends rs{}class n6 extends rs{}class r6 extends rs{}class s6 extends rs{}class i6 extends rs{}class o6 extends rs{}class a6 extends rs{}class l6 extends rs{}class c6 extends Mt{constructor(){super("Could not parse response content as the length limit was reached")}}class u6 extends Mt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var wy=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},vc=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},ri;class S0{constructor(){ri.set(this,void 0),this.buffer=new Uint8Array,wy(this,ri,null,"f")}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+n.length);r.set(this.buffer),r.set(n,this.buffer.length),this.buffer=r;const s=[];let i;for(;(i=mhe(this.buffer,vc(this,ri,"f")))!=null;){if(i.carriage&&vc(this,ri,"f")==null){wy(this,ri,i.index,"f");continue}if(vc(this,ri,"f")!=null&&(i.index!==vc(this,ri,"f")+1||i.carriage)){s.push(this.decodeText(this.buffer.slice(0,vc(this,ri,"f")-1))),this.buffer=this.buffer.slice(vc(this,ri,"f")),wy(this,ri,null,"f");continue}const o=vc(this,ri,"f")!==null?i.preceding-1:i.preceding,l=this.decodeText(this.buffer.slice(0,o));s.push(l),this.buffer=this.buffer.slice(i.index),wy(this,ri,null,"f")}return s}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Mt(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Mt(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Mt("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}ri=new WeakMap;S0.NEWLINE_CHARS=new Set([`
`,"\r"]);S0.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function mhe(t,e){for(let s=e??0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function phe(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}function d6(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class Ao{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const o of ghe(e,n))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null||o.event.startsWith("response.")||o.event.startsWith("transcript.")){let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(l&&l.error)throw new rs(void 0,l.error,void 0,x6(e.headers));yield l}else{let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(o.event=="error")throw new rs(void 0,l.error,l.message,void 0);yield{event:o.event,data:l}}}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||n.abort()}}return new Ao(s,n)}static fromReadableStream(e,n){let r=!1;async function*s(){const o=new S0,l=d6(e);for await(const c of l)for(const u of o.decode(c))yield u;for(const c of o.flush())yield c}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const l of s())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||n.abort()}}return new Ao(i,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),n.push(o)}return i.shift()}});return[new Ao(()=>s(e),this.controller),new Ao(()=>s(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new Y5({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:o}=await n.next();if(o)return s.close();const l=r.encode(JSON.stringify(i)+`
`);s.enqueue(l)}catch(i){s.error(i)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*ghe(t,e){if(!t.body)throw e.abort(),new Mt("Attempted to iterate over a response with no body");const n=new xhe,r=new S0,s=d6(t.body);for await(const i of yhe(s))for(const o of r.decode(i)){const l=n.decode(o);l&&(yield l)}for(const i of r.flush()){const o=n.decode(i);o&&(yield o)}}async function*yhe(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=phe(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class xhe{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=vhe(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function vhe(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}const h6=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",f6=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&E0(t),E0=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",whe=t=>f6(t)||h6(t)||Z5(t);async function m6(t,e,n){var s;if(t=await t,f6(t))return t;if(h6(t)){const i=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=E0(i)?[await i.arrayBuffer()]:[i];return new hC(o,e,n)}const r=await _he(t);if(e||(e=She(t)??"unknown_file"),!(n!=null&&n.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(n={...n,type:i})}return new hC(r,e,n)}async function _he(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(E0(t))e.push(await t.arrayBuffer());else if(Ehe(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(n=t==null?void 0:t.constructor)==null?void 0:n.name}; props: ${bhe(t)}`);return e}function bhe(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function She(t){var e;return Bb(t.name)||Bb(t.filename)||((e=Bb(t.path))==null?void 0:e.split(/[\\/]/).pop())}const Bb=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},Ehe=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",sD=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",hu=async t=>{const e=await Che(t.body);return J5(e,t)},Che=async t=>{const e=new K5;return await Promise.all(Object.entries(t||{}).map(([n,r])=>fC(e,n,r))),e},fC=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(whe(n)){const r=await m6(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>fC(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>fC(t,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var The=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Ihe=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},_y;e6();async function p6(t){var o;const{response:e}=t;if(t.options.stream)return Nl("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):Ao.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type"),r=(o=n==null?void 0:n.split(";")[0])==null?void 0:o.trim();if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.endsWith("+json"))){const l=await e.json();return Nl("response",e.status,e.url,e.headers,l),g6(l,e)}const i=await e.text();return Nl("response",e.status,e.url,e.headers,i),i}function g6(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class C0 extends Promise{constructor(e,n=p6){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new C0(this.responsePromise,async n=>g6(e(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Nhe{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=zb("maxRetries",n),this.timeout=zb("timeout",r),this.httpAgent=s,this.fetch=i??q5}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...jhe(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${Fhe()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&E0(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:n,...s,body:i}}))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:n=0}={}){var x;const r={...e},{method:s,path:i,query:o,headers:l={}}=r,c=ArrayBuffer.isView(r.body)||r.__binaryRequest&&typeof r.body=="string"?r.body:sD(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,u=this.calculateContentLength(c),d=this.buildURL(i,o);"timeout"in r&&zb("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const h=r.httpAgent??this.httpAgent??X5(d),f=r.timeout+1e3;typeof((x=h==null?void 0:h.options)==null?void 0:x.timeout)=="number"&&f>(h.options.timeout??0)&&(h.options.timeout=f),this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:r,headers:l,contentLength:u,retryCount:n});return{req:{method:s,...c&&{body:c},headers:m,...h&&{agent:h},signal:r.signal??null},url:d,timeout:r.timeout}}buildHeaders({options:e,headers:n,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const o=this.defaultHeaders(e);return lD(i,o),lD(i,n),sD(e.body)&&Tm!=="node"&&delete i["content-type"],Sy(o,"x-stainless-retry-count")===void 0&&Sy(n,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),Sy(o,"x-stainless-timeout")===void 0&&Sy(n,"x-stainless-timeout")===void 0&&e.timeout&&(i["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(i,n),i}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,s){return rs.generate(e,n,r,s)}request(e,n=null){return new C0(this.makeRequest(e,n))}async makeRequest(e,n){var h,f;const r=await e,s=r.maxRetries??this.maxRetries;n==null&&(n=s),await this.prepareOptions(r);const{req:i,url:o,timeout:l}=this.buildRequest(r,{retryCount:s-n});if(await this.prepareRequest(i,{url:o,options:r}),Nl("request",o,r,i.headers),(h=r.signal)!=null&&h.aborted)throw new Mi;const c=new AbortController,u=await this.fetchWithTimeout(o,i,l,c).catch(mC);if(u instanceof Error){if((f=r.signal)!=null&&f.aborted)throw new Mi;if(n)return this.retryRequest(r,n);throw u.name==="AbortError"?new RI:new b0({cause:u})}const d=x6(u.headers);if(!u.ok){if(n&&this.shouldRetry(u)){const _=`retrying, ${n} attempts remaining`;return Nl(`response (error; ${_})`,u.status,o,d),this.retryRequest(r,n,d)}const m=await u.text().catch(_=>mC(_).message),g=Dhe(m),x=g?void 0:m;throw Nl(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,u.status,o,d,x),this.makeStatusError(u.status,g,x,d)}return{response:u,options:r,controller:c}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new Phe(this,r,e)}buildURL(e,n){const r=Lhe(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return v6(s)||(n={...s,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new Mt(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,s){const{signal:i,...o}=n||{};i&&i.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),r),c={signal:s.signal,...o};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,e,c).finally(()=>{clearTimeout(l)})}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const l=parseFloat(i);Number.isNaN(l)||(s=l)}const o=r==null?void 0:r["retry-after"];if(o&&!s){const l=parseFloat(o);Number.isNaN(l)?s=Date.parse(o)-Date.now():s=l*1e3}if(!(s&&0<=s&&s<60*1e3)){const l=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,l)}return await ng(s),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,o=Math.min(.5*Math.pow(2,i),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${ud}`}}class y6{constructor(e,n,r,s){_y.set(this,void 0),The(this,_y,e,"f"),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Mt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);n.query=void 0,n.path=e.url.toString()}return await Ihe(this,_y,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(_y=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class Phe extends C0{constructor(e,n,r){super(n,async s=>new r(e,s.response,await p6(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const x6=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),Ahe={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Xn=t=>typeof t=="object"&&t!==null&&!v6(t)&&Object.keys(t).every(e=>w6(Ahe,e)),Rhe=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ud,"X-Stainless-OS":oD(Deno.build.os),"X-Stainless-Arch":iD(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ud,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ud,"X-Stainless-OS":oD(process.platform),"X-Stainless-Arch":iD(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=khe();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ud,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ud,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function khe(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${s}.${i}.${o}`}}}return null}const iD=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",oD=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let aD;const jhe=()=>aD??(aD=Rhe()),Dhe=t=>{try{return JSON.parse(t)}catch{return}},Mhe=/^[a-z][a-z0-9+.-]*:/i,Lhe=t=>Mhe.test(t),ng=t=>new Promise(e=>setTimeout(e,t)),zb=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Mt(`${t} must be an integer`);if(e<0)throw new Mt(`${t} must be a positive integer`);return e},mC=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},by=t=>{var e,n,r,s,i;if(typeof process<"u")return((n=(e=process.env)==null?void 0:e[t])==null?void 0:n.trim())??void 0;if(typeof Deno<"u")return(i=(s=(r=Deno.env)==null?void 0:r.get)==null?void 0:s.call(r,t))==null?void 0:i.trim()};function v6(t){if(!t)return!0;for(const e in t)return!1;return!0}function w6(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function lD(t,e){for(const n in e){if(!w6(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];s===null?delete t[r]:s!==void 0&&(t[r]=s)}}const cD=new Set(["authorization","api-key"]);function Nl(t,...e){var n;if(typeof process<"u"&&((n=process==null?void 0:process.env)==null?void 0:n.DEBUG)==="true"){const r=e.map(s=>{if(!s)return s;if(s.headers){const o={...s,headers:{...s.headers}};for(const l in s.headers)cD.has(l.toLowerCase())&&(o.headers[l]="REDACTED");return o}let i=null;for(const o in s)cD.has(o.toLowerCase())&&(i??(i={...s}),i[o]="REDACTED");return i??s});console.log(`OpenAI:DEBUG:${t}`,...r)}}const Fhe=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),Ohe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Vhe=t=>typeof(t==null?void 0:t.get)=="function",Sy=(t,e)=>{var r;const n=e.toLowerCase();if(Vhe(t)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,o,l)=>o+l.toUpperCase());for(const i of[e,n,e.toUpperCase(),s]){const o=t.get(i);if(o)return o}}for(const[s,i]of Object.entries(t))if(s.toLowerCase()===n)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i},$he=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=e.charCodeAt(s);return Array.from(new Float32Array(r.buffer))}};function Gb(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class T0 extends y6{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Mr extends y6{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const n=(r=e[e.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class Vt{constructor(e){this._client=e}}let _6=class extends Vt{list(e,n={},r){return Xn(n)?this.list(e,{},n):this._client.getAPIList(`/chat/completions/${e}/messages`,Uhe,{query:n,...r})}},I0=class extends Vt{constructor(){super(...arguments),this.messages=new _6(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(`/chat/completions/${e}`,n)}update(e,n,r){return this._client.post(`/chat/completions/${e}`,{body:n,...r})}list(e={},n){return Xn(e)?this.list({},e):this._client.getAPIList("/chat/completions",N0,{query:e,...n})}del(e,n){return this._client.delete(`/chat/completions/${e}`,n)}};class N0 extends Mr{}class Uhe extends Mr{}I0.ChatCompletionsPage=N0;I0.Messages=_6;let P0=class extends Vt{constructor(){super(...arguments),this.completions=new I0(this._client)}};P0.Completions=I0;P0.ChatCompletionsPage=N0;class b6 extends Vt{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}class S6 extends Vt{create(e,n){return this._client.post("/audio/transcriptions",hu({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}}))}}class E6 extends Vt{create(e,n){return this._client.post("/audio/translations",hu({body:e,...n,__metadata:{model:e.model}}))}}class rg extends Vt{constructor(){super(...arguments),this.transcriptions=new S6(this._client),this.translations=new E6(this._client),this.speech=new b6(this._client)}}rg.Transcriptions=S6;rg.Translations=E6;rg.Speech=b6;class kI extends Vt{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return Xn(e)?this.list({},e):this._client.getAPIList("/batches",jI,{query:e,...n})}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}}class jI extends Mr{}kI.BatchesPage=jI;var Xi=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Zn=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},pC,gx,yx,Kf,Yf,xx,Jf,Zo,Xf,Lv,Fv,dd,C6;class DI{constructor(){pC.add(this),this.controller=new AbortController,gx.set(this,void 0),yx.set(this,()=>{}),Kf.set(this,()=>{}),Yf.set(this,void 0),xx.set(this,()=>{}),Jf.set(this,()=>{}),Zo.set(this,{}),Xf.set(this,!1),Lv.set(this,!1),Fv.set(this,!1),dd.set(this,!1),Xi(this,gx,new Promise((e,n)=>{Xi(this,yx,e,"f"),Xi(this,Kf,n,"f")}),"f"),Xi(this,Yf,new Promise((e,n)=>{Xi(this,xx,e,"f"),Xi(this,Jf,n,"f")}),"f"),Zn(this,gx,"f").catch(()=>{}),Zn(this,Yf,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},Zn(this,pC,"m",C6).bind(this))},0)}_connected(){this.ended||(Zn(this,yx,"f").call(this),this._emit("connect"))}get ended(){return Zn(this,Xf,"f")}get errored(){return Zn(this,Lv,"f")}get aborted(){return Zn(this,Fv,"f")}abort(){this.controller.abort()}on(e,n){return(Zn(this,Zo,"f")[e]||(Zn(this,Zo,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=Zn(this,Zo,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(Zn(this,Zo,"f")[e]||(Zn(this,Zo,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{Xi(this,dd,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){Xi(this,dd,!0,"f"),await Zn(this,Yf,"f")}_emit(e,...n){if(Zn(this,Xf,"f"))return;e==="end"&&(Xi(this,Xf,!0,"f"),Zn(this,xx,"f").call(this));const r=Zn(this,Zo,"f")[e];if(r&&(Zn(this,Zo,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!Zn(this,dd,"f")&&!(r!=null&&r.length)&&Promise.reject(s),Zn(this,Kf,"f").call(this,s),Zn(this,Jf,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!Zn(this,dd,"f")&&!(r!=null&&r.length)&&Promise.reject(s),Zn(this,Kf,"f").call(this,s),Zn(this,Jf,"f").call(this,s),this._emit("end")}}_emitFinal(){}}gx=new WeakMap,yx=new WeakMap,Kf=new WeakMap,Yf=new WeakMap,xx=new WeakMap,Jf=new WeakMap,Zo=new WeakMap,Xf=new WeakMap,Lv=new WeakMap,Fv=new WeakMap,dd=new WeakMap,pC=new WeakSet,C6=function(e){if(Xi(this,Lv,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Mi),e instanceof Mi)return Xi(this,Fv,!0,"f"),this._emit("abort",e);if(e instanceof Mt)return this._emit("error",e);if(e instanceof Error){const n=new Mt(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new Mt(String(e)))};var It=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},ni=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Kr,gC,To,vx,Zi,Wc,Fd,Dc,Ov,ii,wx,_x,Im,Qf,Zf,uD,dD,hD,fD,mD,pD,gD;class oo extends DI{constructor(){super(...arguments),Kr.add(this),gC.set(this,[]),To.set(this,{}),vx.set(this,{}),Zi.set(this,void 0),Wc.set(this,void 0),Fd.set(this,void 0),Dc.set(this,void 0),Ov.set(this,void 0),ii.set(this,void 0),wx.set(this,void 0),_x.set(this,void 0),Im.set(this,void 0)}[(gC=new WeakMap,To=new WeakMap,vx=new WeakMap,Zi=new WeakMap,Wc=new WeakMap,Fd=new WeakMap,Dc=new WeakMap,Ov=new WeakMap,ii=new WeakMap,wx=new WeakMap,_x=new WeakMap,Im=new WeakMap,Kr=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new oo;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=Ao.fromReadableStream(e,this.controller);for await(const o of s)It(this,Kr,"m",Qf).call(this,o);if((i=s.controller.signal)!=null&&i.aborted)throw new Mi;return this._addRun(It(this,Kr,"m",Zf).call(this))}toReadableStream(){return new Ao(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,s,i){const o=new oo;return o._run(()=>o._runToolAssistantStream(e,n,r,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,n,r,s,i){var u;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...s,stream:!0},c=await e.submitToolOutputs(n,r,l,{...i,signal:this.controller.signal});this._connected();for await(const d of c)It(this,Kr,"m",Qf).call(this,d);if((u=c.controller.signal)!=null&&u.aborted)throw new Mi;return this._addRun(It(this,Kr,"m",Zf).call(this))}static createThreadAssistantStream(e,n,r){const s=new oo;return s._run(()=>s._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,n,r,s){const i=new oo;return i._run(()=>i._runAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return It(this,wx,"f")}currentRun(){return It(this,_x,"f")}currentMessageSnapshot(){return It(this,Zi,"f")}currentRunStepSnapshot(){return It(this,Im,"f")}async finalRunSteps(){return await this.done(),Object.values(It(this,To,"f"))}async finalMessages(){return await this.done(),Object.values(It(this,vx,"f"))}async finalRun(){if(await this.done(),!It(this,Wc,"f"))throw Error("Final run was not received.");return It(this,Wc,"f")}async _createThreadAssistantStream(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const c of o)It(this,Kr,"m",Qf).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new Mi;return this._addRun(It(this,Kr,"m",Zf).call(this))}async _createAssistantStream(e,n,r,s){var c;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},l=await e.create(n,o,{...s,signal:this.controller.signal});this._connected();for await(const u of l)It(this,Kr,"m",Qf).call(this,u);if((c=l.controller.signal)!=null&&c.aborted)throw new Mi;return this._addRun(It(this,Kr,"m",Zf).call(this))}static accumulateDelta(e,n){for(const[r,s]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(Gb(i)&&Gb(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...s);continue}for(const o of s){if(!Gb(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const l=o.index;if(l==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const c=i[l];c==null?i.push(o):i[l]=this.accumulateDelta(c,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,s){return await this._createAssistantStream(n,e,r,s)}async _runToolAssistantStream(e,n,r,s,i){return await this._createToolAssistantStream(r,e,n,s,i)}}Qf=function(e){if(!this.ended)switch(ni(this,wx,e,"f"),It(this,Kr,"m",hD).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":It(this,Kr,"m",gD).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":It(this,Kr,"m",dD).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":It(this,Kr,"m",uD).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Zf=function(){if(this.ended)throw new Mt("stream has ended, this shouldn't happen");if(!It(this,Wc,"f"))throw Error("Final run has not been received");return It(this,Wc,"f")},uD=function(e){const[n,r]=It(this,Kr,"m",mD).call(this,e,It(this,Zi,"f"));ni(this,Zi,n,"f"),It(this,vx,"f")[n.id]=n;for(const s of r){const i=n.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,o=n.content[s.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=It(this,Fd,"f")){if(It(this,Dc,"f"))switch(It(this,Dc,"f").type){case"text":this._emit("textDone",It(this,Dc,"f").text,It(this,Zi,"f"));break;case"image_file":this._emit("imageFileDone",It(this,Dc,"f").image_file,It(this,Zi,"f"));break}ni(this,Fd,s.index,"f")}ni(this,Dc,n.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(It(this,Fd,"f")!==void 0){const s=e.data.content[It(this,Fd,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,It(this,Zi,"f"));break;case"text":this._emit("textDone",s.text,It(this,Zi,"f"));break}}It(this,Zi,"f")&&this._emit("messageDone",e.data),ni(this,Zi,void 0,"f")}},dD=function(e){const n=It(this,Kr,"m",fD).call(this,e);switch(ni(this,Im,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==It(this,Ov,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(It(this,ii,"f")&&this._emit("toolCallDone",It(this,ii,"f")),ni(this,Ov,i.index,"f"),ni(this,ii,n.step_details.tool_calls[i.index],"f"),It(this,ii,"f")&&this._emit("toolCallCreated",It(this,ii,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ni(this,Im,void 0,"f"),e.data.step_details.type=="tool_calls"&&It(this,ii,"f")&&(this._emit("toolCallDone",It(this,ii,"f")),ni(this,ii,void 0,"f")),this._emit("runStepDone",e.data,n);break}},hD=function(e){It(this,gC,"f").push(e),this._emit("event",e)},fD=function(e){switch(e.event){case"thread.run.step.created":return It(this,To,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=It(this,To,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=oo.accumulateDelta(n,r.delta);It(this,To,"f")[e.data.id]=s}return It(this,To,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":It(this,To,"f")[e.data.id]=e.data;break}if(It(this,To,"f")[e.data.id])return It(this,To,"f")[e.data.id];throw new Error("No snapshot available")},mD=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in n.content){let o=n.content[i.index];n.content[i.index]=It(this,Kr,"m",pD).call(this,i,o)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},pD=function(e,n){return oo.accumulateDelta(n,e)},gD=function(e){switch(ni(this,_x,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":ni(this,Wc,e.data,"f"),It(this,ii,"f")&&(this._emit("toolCallDone",It(this,ii,"f")),ni(this,ii,void 0,"f"));break}};class MI extends Vt{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/assistants/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return Xn(e)?this.list({},e):this._client.getAPIList("/assistants",LI,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class LI extends Mr{}MI.AssistantsPage=LI;function yD(t){return typeof t.parse=="function"}const Qd=t=>(t==null?void 0:t.role)==="assistant",T6=t=>(t==null?void 0:t.role)==="function",I6=t=>(t==null?void 0:t.role)==="tool";function FI(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function sg(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function Bhe(t,e){return!e||!N6(e)?{...t,choices:t.choices.map(n=>({...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:OI(t,e)}function OI(t,e){const n=t.choices.map(r=>{var s;if(r.finish_reason==="length")throw new c6;if(r.finish_reason==="content_filter")throw new u6;return{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(i=>Ghe(e,i)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?zhe(e,r.message.content):null}}});return{...t,choices:n}}function zhe(t,e){var n,r;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=t.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function Ghe(t,e){var r;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:sg(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function Hhe(t,e){var r;if(!t)return!1;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return sg(n)||(n==null?void 0:n.function.strict)||!1}function N6(t){var e;return FI(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>sg(n)||n.type==="function"&&n.function.strict===!0))??!1}function Whe(t){for(const e of t??[]){if(e.type!=="function")throw new Mt(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new Mt(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Os=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},cs,yC,Vv,xC,vC,wC,P6,_C;const xD=10;class A6 extends DI{constructor(){super(...arguments),cs.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(T6(e)||I6(e))&&e.content)this._emit("functionCallResult",e.content);else if(Qd(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Qd(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new Mt("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),Os(this,cs,"m",yC).call(this)}async finalMessage(){return await this.done(),Os(this,cs,"m",Vv).call(this)}async finalFunctionCall(){return await this.done(),Os(this,cs,"m",xC).call(this)}async finalFunctionCallResult(){return await this.done(),Os(this,cs,"m",vC).call(this)}async totalUsage(){return await this.done(),Os(this,cs,"m",wC).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=Os(this,cs,"m",Vv).call(this);n&&this._emit("finalMessage",n);const r=Os(this,cs,"m",yC).call(this);r&&this._emit("finalContent",r);const s=Os(this,cs,"m",xC).call(this);s&&this._emit("finalFunctionCall",s);const i=Os(this,cs,"m",vC).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",Os(this,cs,"m",wC).call(this))}async _createChatCompletion(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Os(this,cs,"m",P6).call(this,n);const i=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(OI(i,n))}async _runChatCompletion(e,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,n,r)}async _runFunctions(e,n,r){var f;const s="function",{function_call:i="auto",stream:o,...l}=n,c=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:u=xD}=r||{},d={};for(const m of n.functions)d[m.name||m.function.name]=m;const h=n.functions.map(m=>({name:m.name||m.function.name,parameters:m.parameters,description:m.description}));for(const m of n.messages)this._addMessage(m,!1);for(let m=0;m<u;++m){const x=(f=(await this._createChatCompletion(e,{...l,function_call:i,functions:h,messages:[...this.messages]},r)).choices[0])==null?void 0:f.message;if(!x)throw new Mt("missing message in ChatCompletion response");if(!x.function_call)return;const{name:E,arguments:v}=x.function_call,_=d[E];if(_){if(c&&c!==E){const j=`Invalid function_call: ${JSON.stringify(E)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,name:E,content:j});continue}}else{const j=`Invalid function_call: ${JSON.stringify(E)}. Available options are: ${h.map(C=>JSON.stringify(C.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:E,content:j});continue}let S;try{S=yD(_)?await _.parse(v):v}catch(j){this._addMessage({role:s,name:E,content:j instanceof Error?j.message:String(j)});continue}const I=await _.function(S,this),M=Os(this,cs,"m",_C).call(this,I);if(this._addMessage({role:s,name:E,content:M}),c)return}}async _runTools(e,n,r){var m,g,x;const s="tool",{tool_choice:i="auto",stream:o,...l}=n,c=typeof i!="string"&&((m=i==null?void 0:i.function)==null?void 0:m.name),{maxChatCompletions:u=xD}=r||{},d=n.tools.map(E=>{if(sg(E)){if(!E.$callback)throw new Mt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:E.$callback,name:E.function.name,description:E.function.description||"",parameters:E.function.parameters,parse:E.$parseRaw,strict:!0}}}return E}),h={};for(const E of d)E.type==="function"&&(h[E.function.name||E.function.function.name]=E.function);const f="tools"in n?d.map(E=>E.type==="function"?{type:"function",function:{name:E.function.name||E.function.function.name,parameters:E.function.parameters,description:E.function.description,strict:E.function.strict}}:E):void 0;for(const E of n.messages)this._addMessage(E,!1);for(let E=0;E<u;++E){const _=(g=(await this._createChatCompletion(e,{...l,tool_choice:i,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:g.message;if(!_)throw new Mt("missing message in ChatCompletion response");if(!((x=_.tool_calls)!=null&&x.length))return;for(const S of _.tool_calls){if(S.type!=="function")continue;const I=S.id,{name:M,arguments:j}=S.function,C=h[M];if(C){if(c&&c!==M){const D=`Invalid tool_call: ${JSON.stringify(M)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,tool_call_id:I,content:D});continue}}else{const D=`Invalid tool_call: ${JSON.stringify(M)}. Available options are: ${Object.keys(h).map(R=>JSON.stringify(R)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:I,content:D});continue}let T;try{T=yD(C)?await C.parse(j):j}catch(D){const R=D instanceof Error?D.message:String(D);this._addMessage({role:s,tool_call_id:I,content:R});continue}const P=await C.function(T,this),A=Os(this,cs,"m",_C).call(this,P);if(this._addMessage({role:s,tool_call_id:I,content:A}),c)return}}}}cs=new WeakSet,yC=function(){return Os(this,cs,"m",Vv).call(this).content??null},Vv=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Qd(n)){const{function_call:r,...s}=n,i={...s,content:n.content??null,refusal:n.refusal??null};return r&&(i.function_call=r),i}}throw new Mt("stream ended without producing a ChatCompletionMessage with role=assistant")},xC=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Qd(s)&&(s!=null&&s.function_call))return s.function_call;if(Qd(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(n=s.tool_calls.at(-1))==null?void 0:n.function}},vC=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(T6(n)&&n.content!=null||I6(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},wC=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},P6=function(e){if(e.n!=null&&e.n>1)throw new Mt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},_C=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class mp extends A6{static runFunctions(e,n,r){const s=new mp,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new mp,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}_addMessage(e,n=!0){super._addMessage(e,n),Qd(e)&&e.content&&this._emit("content",e.content)}}const R6=1,k6=2,j6=4,D6=8,M6=16,L6=32,F6=64,O6=128,V6=256,$6=O6|V6,U6=M6|L6|$6|F6,B6=R6|k6|U6,z6=j6|D6,qhe=B6|z6,Fr={STR:R6,NUM:k6,ARR:j6,OBJ:D6,NULL:M6,BOOL:L6,NAN:F6,INFINITY:O6,MINUS_INFINITY:V6,INF:$6,SPECIAL:U6,ATOM:B6,COLLECTION:z6,ALL:qhe};class Khe extends Error{}class Yhe extends Error{}function Jhe(t,e=Fr.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return Xhe(t.trim(),e)}const Xhe=(t,e)=>{const n=t.length;let r=0;const s=f=>{throw new Khe(`${f} at position ${r}`)},i=f=>{throw new Yhe(`${f} at position ${r}`)},o=()=>(h(),r>=n&&s("Unexpected end of input"),t[r]==='"'?l():t[r]==="{"?c():t[r]==="["?u():t.substring(r,r+4)==="null"||Fr.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||Fr.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||Fr.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||Fr.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||Fr.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||Fr.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):d()),l=()=>{const f=r;let m=!1;for(r++;r<n&&(t[r]!=='"'||m&&t[r-1]==="\\");)m=t[r]==="\\"?!m:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(f,++r-Number(m)))}catch(g){i(String(g))}else if(Fr.STR&e)try{return JSON.parse(t.substring(f,r-Number(m))+'"')}catch{return JSON.parse(t.substring(f,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{r++,h();const f={};try{for(;t[r]!=="}";){if(h(),r>=n&&Fr.OBJ&e)return f;const m=l();h(),r++;try{const g=o();Object.defineProperty(f,m,{value:g,writable:!0,enumerable:!0,configurable:!0})}catch(g){if(Fr.OBJ&e)return f;throw g}h(),t[r]===","&&r++}}catch{if(Fr.OBJ&e)return f;s("Expected '}' at end of object")}return r++,f},u=()=>{r++;const f=[];try{for(;t[r]!=="]";)f.push(o()),h(),t[r]===","&&r++}catch{if(Fr.ARR&e)return f;s("Expected ']' at end of array")}return r++,f},d=()=>{if(r===0){t==="-"&&Fr.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(m){if(Fr.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}i(String(m))}}const f=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(Fr.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(t.substring(f,r))}catch{t.substring(f,r)==="-"&&Fr.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(f,t.lastIndexOf("e")))}catch(g){i(String(g))}}},h=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return o()},vD=t=>Jhe(t,Fr.ALL^Fr.NUM);var Ju=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},An=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Pr,Qo,Xu,za,Hb,Ey,Wb,qb,Kb,Cy,Yb,wD;class pp extends A6{constructor(e){super(),Pr.add(this),Qo.set(this,void 0),Xu.set(this,void 0),za.set(this,void 0),Ju(this,Qo,e,"f"),Ju(this,Xu,[],"f")}get currentChatCompletionSnapshot(){return An(this,za,"f")}static fromReadableStream(e){const n=new pp(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const s=new pp(n);return s._run(()=>s._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,n,r){var o;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),An(this,Pr,"m",Hb).call(this);const i=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const l of i)An(this,Pr,"m",Wb).call(this,l);if((o=i.controller.signal)!=null&&o.aborted)throw new Mi;return this._addChatCompletion(An(this,Pr,"m",Cy).call(this))}async _fromReadableStream(e,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),An(this,Pr,"m",Hb).call(this),this._connected();const s=Ao.fromReadableStream(e,this.controller);let i;for await(const l of s)i&&i!==l.id&&this._addChatCompletion(An(this,Pr,"m",Cy).call(this)),An(this,Pr,"m",Wb).call(this,l),i=l.id;if((o=s.controller.signal)!=null&&o.aborted)throw new Mi;return this._addChatCompletion(An(this,Pr,"m",Cy).call(this))}[(Qo=new WeakMap,Xu=new WeakMap,za=new WeakMap,Pr=new WeakSet,Hb=function(){this.ended||Ju(this,za,void 0,"f")},Ey=function(n){let r=An(this,Xu,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},An(this,Xu,"f")[n.index]=r,r)},Wb=function(n){var s,i,o,l,c,u,d,h,f,m,g,x,E,v,_;if(this.ended)return;const r=An(this,Pr,"m",wD).call(this,n);this._emit("chunk",n,r);for(const S of n.choices){const I=r.choices[S.index];S.delta.content!=null&&((s=I.message)==null?void 0:s.role)==="assistant"&&((i=I.message)!=null&&i.content)&&(this._emit("content",S.delta.content,I.message.content),this._emit("content.delta",{delta:S.delta.content,snapshot:I.message.content,parsed:I.message.parsed})),S.delta.refusal!=null&&((o=I.message)==null?void 0:o.role)==="assistant"&&((l=I.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:S.delta.refusal,snapshot:I.message.refusal}),((c=S.logprobs)==null?void 0:c.content)!=null&&((u=I.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(d=S.logprobs)==null?void 0:d.content,snapshot:((h=I.logprobs)==null?void 0:h.content)??[]}),((f=S.logprobs)==null?void 0:f.refusal)!=null&&((m=I.message)==null?void 0:m.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(g=S.logprobs)==null?void 0:g.refusal,snapshot:((x=I.logprobs)==null?void 0:x.refusal)??[]});const M=An(this,Pr,"m",Ey).call(this,I);I.finish_reason&&(An(this,Pr,"m",Kb).call(this,I),M.current_tool_call_index!=null&&An(this,Pr,"m",qb).call(this,I,M.current_tool_call_index));for(const j of S.delta.tool_calls??[])M.current_tool_call_index!==j.index&&(An(this,Pr,"m",Kb).call(this,I),M.current_tool_call_index!=null&&An(this,Pr,"m",qb).call(this,I,M.current_tool_call_index)),M.current_tool_call_index=j.index;for(const j of S.delta.tool_calls??[]){const C=(E=I.message.tool_calls)==null?void 0:E[j.index];C!=null&&C.type&&((C==null?void 0:C.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=C.function)==null?void 0:v.name,index:j.index,arguments:C.function.arguments,parsed_arguments:C.function.parsed_arguments,arguments_delta:((_=j.function)==null?void 0:_.arguments)??""}):(C==null||C.type,void 0))}}},qb=function(n,r){var o,l,c;if(An(this,Pr,"m",Ey).call(this,n).done_tool_calls.has(r))return;const i=(o=n.message.tool_calls)==null?void 0:o[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const u=(c=(l=An(this,Qo,"f"))==null?void 0:l.tools)==null?void 0:c.find(d=>d.type==="function"&&d.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:sg(u)?u.$parseRaw(i.function.arguments):u!=null&&u.function.strict?JSON.parse(i.function.arguments):null})}else i.type},Kb=function(n){var s,i;const r=An(this,Pr,"m",Ey).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const o=An(this,Pr,"m",Yb).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(s=n.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(i=n.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},Cy=function(){if(this.ended)throw new Mt("stream has ended, this shouldn't happen");const n=An(this,za,"f");if(!n)throw new Mt("request ended without sending any chunks");return Ju(this,za,void 0,"f"),Ju(this,Xu,[],"f"),Qhe(n,An(this,Qo,"f"))},Yb=function(){var r;const n=(r=An(this,Qo,"f"))==null?void 0:r.response_format;return FI(n)?n:null},wD=function(n){var r,s,i,o;let l=An(this,za,"f");const{choices:c,...u}=n;l?Object.assign(l,u):l=Ju(this,za,{...u,choices:[]},"f");for(const{delta:d,finish_reason:h,index:f,logprobs:m=null,...g}of n.choices){let x=l.choices[f];if(x||(x=l.choices[f]={finish_reason:h,index:f,message:{},logprobs:m,...g}),m)if(!x.logprobs)x.logprobs=Object.assign({},m);else{const{content:j,refusal:C,...T}=m;Object.assign(x.logprobs,T),j&&((r=x.logprobs).content??(r.content=[]),x.logprobs.content.push(...j)),C&&((s=x.logprobs).refusal??(s.refusal=[]),x.logprobs.refusal.push(...C))}if(h&&(x.finish_reason=h,An(this,Qo,"f")&&N6(An(this,Qo,"f")))){if(h==="length")throw new c6;if(h==="content_filter")throw new u6}if(Object.assign(x,g),!d)continue;const{content:E,refusal:v,function_call:_,role:S,tool_calls:I,...M}=d;if(Object.assign(x.message,M),v&&(x.message.refusal=(x.message.refusal||"")+v),S&&(x.message.role=S),_&&(x.message.function_call?(_.name&&(x.message.function_call.name=_.name),_.arguments&&((i=x.message.function_call).arguments??(i.arguments=""),x.message.function_call.arguments+=_.arguments)):x.message.function_call=_),E&&(x.message.content=(x.message.content||"")+E,!x.message.refusal&&An(this,Pr,"m",Yb).call(this)&&(x.message.parsed=vD(x.message.content))),I){x.message.tool_calls||(x.message.tool_calls=[]);for(const{index:j,id:C,type:T,function:P,...A}of I){const D=(o=x.message.tool_calls)[j]??(o[j]={});Object.assign(D,A),C&&(D.id=C),T&&(D.type=T),P&&(D.function??(D.function={name:P.name??"",arguments:""})),P!=null&&P.name&&(D.function.name=P.name),P!=null&&P.arguments&&(D.function.arguments+=P.arguments,Hhe(An(this,Qo,"f"),D)&&(D.function.parsed_arguments=vD(D.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Ao(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Qhe(t,e){const{id:n,choices:r,created:s,model:i,system_fingerprint:o,...l}=t,c={...l,id:n,choices:r.map(({message:u,finish_reason:d,index:h,logprobs:f,...m})=>{if(!d)throw new Mt(`missing finish_reason for choice ${h}`);const{content:g=null,function_call:x,tool_calls:E,...v}=u,_=u.role;if(!_)throw new Mt(`missing role for choice ${h}`);if(x){const{arguments:S,name:I}=x;if(S==null)throw new Mt(`missing function_call.arguments for choice ${h}`);if(!I)throw new Mt(`missing function_call.name for choice ${h}`);return{...m,message:{content:g,function_call:{arguments:S,name:I},role:_,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}return E?{...m,index:h,finish_reason:d,logprobs:f,message:{...v,role:_,content:g,refusal:u.refusal??null,tool_calls:E.map((S,I)=>{const{function:M,type:j,id:C,...T}=S,{arguments:P,name:A,...D}=M||{};if(C==null)throw new Mt(`missing choices[${h}].tool_calls[${I}].id
${Ty(t)}`);if(j==null)throw new Mt(`missing choices[${h}].tool_calls[${I}].type
${Ty(t)}`);if(A==null)throw new Mt(`missing choices[${h}].tool_calls[${I}].function.name
${Ty(t)}`);if(P==null)throw new Mt(`missing choices[${h}].tool_calls[${I}].function.arguments
${Ty(t)}`);return{...T,id:C,type:j,function:{...D,name:A,arguments:P}}})}}:{...m,message:{...v,content:g,role:_,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}),created:s,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return Bhe(c,e)}function Ty(t){return JSON.stringify(t)}class Zd extends pp{static fromReadableStream(e){const n=new Zd(null);return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,r){const s=new Zd(null),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Zd(n),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}}let G6=class extends Vt{parse(e,n){return Whe(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>OI(r,e))}runFunctions(e,n){return e.stream?Zd.runFunctions(this._client,e,n):mp.runFunctions(this._client,e,n)}runTools(e,n){return e.stream?Zd.runTools(this._client,e,n):mp.runTools(this._client,e,n)}stream(e,n){return pp.createChatCompletion(this._client,e,n)}};class bC extends Vt{constructor(){super(...arguments),this.completions=new G6(this._client)}}(function(t){t.Completions=G6})(bC||(bC={}));class H6 extends Vt{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class W6 extends Vt{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class A0 extends Vt{constructor(){super(...arguments),this.sessions=new H6(this._client),this.transcriptionSessions=new W6(this._client)}}A0.Sessions=H6;A0.TranscriptionSessions=W6;class VI extends Vt{create(e,n,r){return this._client.post(`/threads/${e}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/messages/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return Xn(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,$I,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class $I extends Mr{}VI.MessagesPage=$I;class UI extends Vt{retrieve(e,n,r,s={},i){return Xn(s)?this.retrieve(e,n,r,{},s):this._client.get(`/threads/${e}/runs/${n}/steps/${r}`,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,n,r={},s){return Xn(r)?this.list(e,n,{},r):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,BI,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class BI extends Mr{}UI.RunStepsPage=BI;let ig=class extends Vt{constructor(){super(...arguments),this.steps=new UI(this._client)}create(e,n,r){const{include:s,...i}=n;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:i,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(e,n,r){return this._client.get(`/threads/${e}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return Xn(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,zI,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}createAndStream(e,n,r){return oo.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await ng(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,n,r){return oo.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,n,r,s){const i=await this.submitToolOutputs(e,n,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,n,r,s){return oo.createToolAssistantStream(e,n,this._client.beta.threads.runs,r,s)}};class zI extends Mr{}ig.RunsPage=zI;ig.Steps=UI;ig.RunStepsPage=BI;class qh extends Vt{constructor(){super(...arguments),this.runs=new ig(this._client),this.messages=new VI(this._client)}create(e={},n){return Xn(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/threads/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(e,n){return oo.createThreadAssistantStream(e,this._client.beta.threads,n)}}qh.Runs=ig;qh.RunsPage=zI;qh.Messages=VI;qh.MessagesPage=$I;class Kh extends Vt{constructor(){super(...arguments),this.realtime=new A0(this._client),this.chat=new bC(this._client),this.assistants=new MI(this._client),this.threads=new qh(this._client)}}Kh.Realtime=A0;Kh.Assistants=MI;Kh.AssistantsPage=LI;Kh.Threads=qh;class q6 extends Vt{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}let K6=class extends Vt{retrieve(e,n,r){return this._client.get(`/containers/${e}/files/${n}/content`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}},R0=class extends Vt{constructor(){super(...arguments),this.content=new K6(this._client)}create(e,n,r){return this._client.post(`/containers/${e}/files`,hu({body:n,...r}))}retrieve(e,n,r){return this._client.get(`/containers/${e}/files/${n}`,r)}list(e,n={},r){return Xn(n)?this.list(e,{},n):this._client.getAPIList(`/containers/${e}/files`,GI,{query:n,...r})}del(e,n,r){return this._client.delete(`/containers/${e}/files/${n}`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}};class GI extends Mr{}R0.FileListResponsesPage=GI;R0.Content=K6;class og extends Vt{constructor(){super(...arguments),this.files=new R0(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(`/containers/${e}`,n)}list(e={},n){return Xn(e)?this.list({},e):this._client.getAPIList("/containers",HI,{query:e,...n})}del(e,n){return this._client.delete(`/containers/${e}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}}class HI extends Mr{}og.ContainerListResponsesPage=HI;og.Files=R0;og.FileListResponsesPage=GI;class Y6 extends Vt{create(e,n){const r=!!e.encoding_format;let s=r?e.encoding_format:"base64";r&&Nl("Request","User defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:s},...n});return r?i:(Nl("response","Decoding base64 embeddings to float32 array"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(l=>{const c=l.embedding;l.embedding=$he(c)}),o)))}}class WI extends Vt{retrieve(e,n,r,s){return this._client.get(`/evals/${e}/runs/${n}/output_items/${r}`,s)}list(e,n,r={},s){return Xn(r)?this.list(e,n,{},r):this._client.getAPIList(`/evals/${e}/runs/${n}/output_items`,qI,{query:r,...s})}}class qI extends Mr{}WI.OutputItemListResponsesPage=qI;class ag extends Vt{constructor(){super(...arguments),this.outputItems=new WI(this._client)}create(e,n,r){return this._client.post(`/evals/${e}/runs`,{body:n,...r})}retrieve(e,n,r){return this._client.get(`/evals/${e}/runs/${n}`,r)}list(e,n={},r){return Xn(n)?this.list(e,{},n):this._client.getAPIList(`/evals/${e}/runs`,KI,{query:n,...r})}del(e,n,r){return this._client.delete(`/evals/${e}/runs/${n}`,r)}cancel(e,n,r){return this._client.post(`/evals/${e}/runs/${n}`,r)}}class KI extends Mr{}ag.RunListResponsesPage=KI;ag.OutputItems=WI;ag.OutputItemListResponsesPage=qI;class lg extends Vt{constructor(){super(...arguments),this.runs=new ag(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(`/evals/${e}`,n)}update(e,n,r){return this._client.post(`/evals/${e}`,{body:n,...r})}list(e={},n){return Xn(e)?this.list({},e):this._client.getAPIList("/evals",YI,{query:e,...n})}del(e,n){return this._client.delete(`/evals/${e}`,n)}}class YI extends Mr{}lg.EvalListResponsesPage=YI;lg.Runs=ag;lg.RunListResponsesPage=KI;let JI=class extends Vt{create(e,n){return this._client.post("/files",hu({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return Xn(e)?this.list({},e):this._client.getAPIList("/files",XI,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,n)}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!s.has(o.status);)if(await ng(n),o=await this.retrieve(e),Date.now()-i>r)throw new RI({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}};class XI extends Mr{}JI.FileObjectsPage=XI;class J6 extends Vt{}let X6=class extends Vt{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class QI extends Vt{constructor(){super(...arguments),this.graders=new X6(this._client)}}QI.Graders=X6;class ZI extends Vt{create(e,n,r){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,eN,{body:n,method:"post",...r})}retrieve(e,n={},r){return Xn(n)?this.retrieve(e,{},n):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...r})}del(e,n,r){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${n}`,r)}}class eN extends T0{}ZI.PermissionCreateResponsesPage=eN;let k0=class extends Vt{constructor(){super(...arguments),this.permissions=new ZI(this._client)}};k0.Permissions=ZI;k0.PermissionCreateResponsesPage=eN;class tN extends Vt{list(e,n={},r){return Xn(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,nN,{query:n,...r})}}class nN extends Mr{}tN.FineTuningJobCheckpointsPage=nN;class Yh extends Vt{constructor(){super(...arguments),this.checkpoints=new tN(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return Xn(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",rN,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return Xn(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,sN,{query:n,...r})}pause(e,n){return this._client.post(`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(`/fine_tuning/jobs/${e}/resume`,n)}}class rN extends Mr{}class sN extends Mr{}Yh.FineTuningJobsPage=rN;Yh.FineTuningJobEventsPage=sN;Yh.Checkpoints=tN;Yh.FineTuningJobCheckpointsPage=nN;class lc extends Vt{constructor(){super(...arguments),this.methods=new J6(this._client),this.jobs=new Yh(this._client),this.checkpoints=new k0(this._client),this.alpha=new QI(this._client)}}lc.Methods=J6;lc.Jobs=Yh;lc.FineTuningJobsPage=rN;lc.FineTuningJobEventsPage=sN;lc.Checkpoints=k0;lc.Alpha=QI;class Q6 extends Vt{}class iN extends Vt{constructor(){super(...arguments),this.graderModels=new Q6(this._client)}}iN.GraderModels=Q6;class Z6 extends Vt{createVariation(e,n){return this._client.post("/images/variations",hu({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",hu({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}class oN extends Vt{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",aN,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class aN extends T0{}oN.ModelsPage=aN;class eB extends Vt{create(e,n){return this._client.post("/moderations",{body:e,...n})}}function Zhe(t,e){return!e||!tfe(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(r=>({...r,parsed:null}))}:n)}:tB(t,e)}function tB(t,e){const n=t.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:sfe(e,s)};if(s.type==="message"){const i=s.content.map(o=>o.type==="output_text"?{...o,parsed:efe(e,o.text)}:o);return{...s,content:i}}return s}),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||SC(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const s of r.output)if(s.type==="message"){for(const i of s.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),r}function efe(t,e){var n,r,s,i;return((r=(n=t.text)==null?void 0:n.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((s=t.text)==null?void 0:s.format)?((i=t.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function tfe(t){var e;return!!FI((e=t.text)==null?void 0:e.format)}function nfe(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function rfe(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function sfe(t,e){const n=rfe(t.tools??[],e.name);return{...e,...e,parsed_arguments:nfe(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function SC(t){const e=[];for(const n of t.output)if(n.type==="message")for(const r of n.content)r.type==="output_text"&&e.push(r.text);t.output_text=e.join("")}class nB extends Vt{list(e,n={},r){return Xn(n)?this.list(e,{},n):this._client.getAPIList(`/responses/${e}/input_items`,ofe,{query:n,...r})}}var Qu=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Ga=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Zu,Iy,Ha,Ny,_D,bD,SD,ED;class lN extends DI{constructor(e){super(),Zu.add(this),Iy.set(this,void 0),Ha.set(this,void 0),Ny.set(this,void 0),Qu(this,Iy,e,"f")}static createResponse(e,n,r){const s=new lN(n);return s._run(()=>s._createOrRetrieveResponse(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createOrRetrieveResponse(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Ga(this,Zu,"m",_D).call(this);let i,o=null;"response_id"in n?(i=await e.responses.retrieve(n.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),o=n.starting_after??null):i=await e.responses.create({...n,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const c of i)Ga(this,Zu,"m",bD).call(this,c,o);if((l=i.controller.signal)!=null&&l.aborted)throw new Mi;return Ga(this,Zu,"m",SD).call(this)}[(Iy=new WeakMap,Ha=new WeakMap,Ny=new WeakMap,Zu=new WeakSet,_D=function(){this.ended||Qu(this,Ha,void 0,"f")},bD=function(n,r){if(this.ended)return;const s=(o,l)=>{(r==null||l.sequence_number>r)&&this._emit(o,l)},i=Ga(this,Zu,"m",ED).call(this,n);switch(s("event",n),n.type){case"response.output_text.delta":{const o=i.output[n.output_index];if(!o)throw new Mt(`missing output at index ${n.output_index}`);if(o.type==="message"){const l=o.content[n.content_index];if(!l)throw new Mt(`missing content at index ${n.content_index}`);if(l.type!=="output_text")throw new Mt(`expected content to be 'output_text', got ${l.type}`);s("response.output_text.delta",{...n,snapshot:l.text})}break}case"response.function_call_arguments.delta":{const o=i.output[n.output_index];if(!o)throw new Mt(`missing output at index ${n.output_index}`);o.type==="function_call"&&s("response.function_call_arguments.delta",{...n,snapshot:o.arguments});break}default:s(n.type,n);break}},SD=function(){if(this.ended)throw new Mt("stream has ended, this shouldn't happen");const n=Ga(this,Ha,"f");if(!n)throw new Mt("request ended without sending any events");Qu(this,Ha,void 0,"f");const r=ife(n,Ga(this,Iy,"f"));return Qu(this,Ny,r,"f"),r},ED=function(n){let r=Ga(this,Ha,"f");if(!r){if(n.type!=="response.created")throw new Mt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return r=Qu(this,Ha,n.response,"f"),r}switch(n.type){case"response.output_item.added":{r.output.push(n.item);break}case"response.content_part.added":{const s=r.output[n.output_index];if(!s)throw new Mt(`missing output at index ${n.output_index}`);s.type==="message"&&s.content.push(n.part);break}case"response.output_text.delta":{const s=r.output[n.output_index];if(!s)throw new Mt(`missing output at index ${n.output_index}`);if(s.type==="message"){const i=s.content[n.content_index];if(!i)throw new Mt(`missing content at index ${n.content_index}`);if(i.type!=="output_text")throw new Mt(`expected content to be 'output_text', got ${i.type}`);i.text+=n.delta}break}case"response.function_call_arguments.delta":{const s=r.output[n.output_index];if(!s)throw new Mt(`missing output at index ${n.output_index}`);s.type==="function_call"&&(s.arguments+=n.delta);break}case"response.completed":{Qu(this,Ha,n.response,"f");break}}return r},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=Ga(this,Ny,"f");if(!e)throw new Mt("stream ended without producing a ChatCompletion");return e}}function ife(t,e){return Zhe(t,e)}class cN extends Vt{constructor(){super(...arguments),this.inputItems=new nB(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&SC(r),r))}retrieve(e,n={},r){return Xn(n)&&r===void 0?this.retrieve(e,{},n):this._client.get(`/responses/${e}`,{query:n,...r,stream:n.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&SC(s),s))}del(e,n){return this._client.delete(`/responses/${e}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(r=>tB(r,e))}stream(e,n){return lN.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(`/responses/${e}/cancel`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}}class ofe extends Mr{}cN.InputItems=nB;class rB extends Vt{create(e,n,r){return this._client.post(`/uploads/${e}/parts`,hu({body:n,...r}))}}class uN extends Vt{constructor(){super(...arguments),this.parts=new rB(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(`/uploads/${e}/complete`,{body:n,...r})}}uN.Parts=rB;const afe=async t=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};class j0 extends Vt{create(e,n,r){return this._client.post(`/vector_stores/${e}/files`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/vector_stores/${e}/files/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return Xn(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,D0,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,n,{...r,headers:s}).withResponse(),o=i.data;switch(o.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=i.response.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await ng(l);break;case"failed":case"completed":return o}}}async upload(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,n,r){const s=await this.upload(e,n,r);return await this.poll(e,s.id,r)}content(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/files/${n}/content`,dN,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class D0 extends Mr{}class dN extends T0{}j0.VectorStoreFilesPage=D0;j0.FileContentResponsesPage=dN;class sB extends Vt{create(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n);return await this.poll(e,s.id,r)}listFiles(e,n,r={},s){return Xn(r)?this.listFiles(e,n,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,D0,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await ng(l);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},s){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(s==null?void 0:s.maxConcurrency)??5,o=Math.min(i,n.length),l=this._client,c=n.values(),u=[...r];async function d(f){for(let m of f){const g=await l.files.create({file:m,purpose:"assistants"},s);u.push(g.id)}}const h=Array(o).fill(c).map(d);return await afe(h),await this.createAndPoll(e,{file_ids:u})}}class cc extends Vt{constructor(){super(...arguments),this.files=new j0(this._client),this.fileBatches=new sB(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/vector_stores/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return Xn(e)?this.list({},e):this._client.getAPIList("/vector_stores",hN,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}search(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/search`,fN,{body:n,method:"post",...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class hN extends Mr{}class fN extends T0{}cc.VectorStoresPage=hN;cc.VectorStoreSearchResponsesPage=fN;cc.Files=j0;cc.VectorStoreFilesPage=D0;cc.FileContentResponsesPage=dN;cc.FileBatches=sB;var iB;class Jt extends Nhe{constructor({baseURL:e=by("OPENAI_BASE_URL"),apiKey:n=by("OPENAI_API_KEY"),organization:r=by("OPENAI_ORG_ID")??null,project:s=by("OPENAI_PROJECT_ID")??null,...i}={}){if(n===void 0)throw new Mt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:n,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&Ohe())throw new Mt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new q6(this),this.chat=new P0(this),this.embeddings=new Y6(this),this.files=new JI(this),this.images=new Z6(this),this.audio=new rg(this),this.moderations=new eB(this),this.models=new oN(this),this.fineTuning=new lc(this),this.graders=new iN(this),this.vectorStores=new cc(this),this.beta=new Kh(this),this.batches=new kI(this),this.uploads=new uN(this),this.responses=new cN(this),this.evals=new lg(this),this.containers=new og(this),this._options=o,this.apiKey=n,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return uhe(e,{arrayFormat:"brackets"})}}iB=Jt;Jt.OpenAI=iB;Jt.DEFAULT_TIMEOUT=6e5;Jt.OpenAIError=Mt;Jt.APIError=rs;Jt.APIConnectionError=b0;Jt.APIConnectionTimeoutError=RI;Jt.APIUserAbortError=Mi;Jt.NotFoundError=s6;Jt.ConflictError=i6;Jt.RateLimitError=a6;Jt.BadRequestError=t6;Jt.AuthenticationError=n6;Jt.InternalServerError=l6;Jt.PermissionDeniedError=r6;Jt.UnprocessableEntityError=o6;Jt.toFile=m6;Jt.fileFromPath=Q5;Jt.Completions=q6;Jt.Chat=P0;Jt.ChatCompletionsPage=N0;Jt.Embeddings=Y6;Jt.Files=JI;Jt.FileObjectsPage=XI;Jt.Images=Z6;Jt.Audio=rg;Jt.Moderations=eB;Jt.Models=oN;Jt.ModelsPage=aN;Jt.FineTuning=lc;Jt.Graders=iN;Jt.VectorStores=cc;Jt.VectorStoresPage=hN;Jt.VectorStoreSearchResponsesPage=fN;Jt.Beta=Kh;Jt.Batches=kI;Jt.BatchesPage=jI;Jt.Uploads=uN;Jt.Responses=cN;Jt.Evals=lg;Jt.EvalListResponsesPage=YI;Jt.Containers=og;Jt.ContainerListResponsesPage=HI;const lfe=Jt,cfe="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",ufe=new lfe({apiKey:cfe,dangerouslyAllowBrowser:!0});async function dfe(t,e={}){if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required for OpenAI image generation.");console.log(`[OpenAI] Generating image with prompt: "${t}"`);try{const n=await ufe.images.generate({model:"gpt-image-1",prompt:t,n:e.n||1,size:e.size||"1024x1024",quality:e.quality||"auto",response_format:"b64_json"});if(console.log("[OpenAI] Image generation response:",n),n.data&&n.data.length>0&&n.data[0].b64_json)return{b64_json:n.data[0].b64_json,alt:`OpenAI generated image for: ${t.substring(0,50)}`,revised_prompt:n.data[0].revised_prompt};throw new Error("No image data found in OpenAI response.")}catch(n){throw console.error("[OpenAI] Error generating image:",n),n.response&&n.response.data&&n.response.data.error?new Error(`OpenAI API Error: ${n.response.data.error.message}`):n}}const hfe=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oB=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},ffe=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},aB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,h=(i&3)<<4|l>>4;let f=(l&15)<<2|u>>6,m=u&63;c||(m=64,o||(f=64)),r.push(n[d],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(oB(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ffe(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||h==null)throw new mfe;const f=i<<2|l>>4;if(r.push(f),u!==64){const m=l<<4&240|u>>2;if(r.push(m),h!==64){const g=u<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class mfe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const pfe=function(t){const e=oB(t);return aB.encodeByteArray(e,!0)},$v=function(t){return pfe(t).replace(/\./g,"")},lB=function(t){try{return aB.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cB(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gfe=()=>cB().__FIREBASE_DEFAULTS__,yfe=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},xfe=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&lB(t[1]);return e&&JSON.parse(e)},M0=()=>{try{return hfe()||gfe()||yfe()||xfe()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},uB=t=>{var e,n;return(n=(e=M0())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},mN=t=>{const e=uB(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},dB=()=>{var t;return(t=M0())===null||t===void 0?void 0:t.config},hB=t=>{var e;return(e=M0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vfe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uc(t){return t.endsWith(".cloudworkstations.dev")}async function L0(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fB(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[$v(JSON.stringify(n)),$v(JSON.stringify(o)),l].join(".")}const Nm={};function wfe(){const t={prod:[],emulator:[]};for(const e of Object.keys(Nm))Nm[e]?t.emulator.push(e):t.prod.push(e);return t}function _fe(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let CD=!1;function F0(t,e){if(typeof window>"u"||typeof document>"u"||!uc(window.location.host)||Nm[t]===e||Nm[t]||CD)return;Nm[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=wfe().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function l(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,m){f.setAttribute("width","24"),f.setAttribute("id",m),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function u(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{CD=!0,o()},f}function d(f,m){f.setAttribute("id",m),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=_fe(r),m=n("text"),g=document.getElementById(m)||document.createElement("span"),x=n("learnmore"),E=document.getElementById(x)||document.createElement("a"),v=n("preprendIcon"),_=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const S=f.element;l(S),d(E,x);const I=u();c(_,v),S.append(_,g,E,I),document.body.appendChild(S)}i?(g.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function bfe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Dr())}function mB(){var t;const e=(t=M0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Sfe(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Efe(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Cfe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Tfe(){const t=Dr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function pB(){return!mB()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function gB(){return!mB()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function yB(){try{return typeof indexedDB=="object"}catch{return!1}}function Ife(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nfe="FirebaseError";class vo extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Nfe,Object.setPrototypeOf(this,vo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,cg.prototype.create)}}class cg{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Pfe(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new vo(s,l,r)}}function Pfe(t,e){return t.replace(Afe,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Afe=/\{\$([^}]+)}/g;function Rfe(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function fu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(TD(i)&&TD(o)){if(!fu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function TD(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ug(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function em(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function tm(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function kfe(t,e){const n=new jfe(t,e);return n.subscribe.bind(n)}class jfe{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Dfe(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Jb),s.error===void 0&&(s.error=Jb),s.complete===void 0&&(s.complete=Jb);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Dfe(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Jb(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vn(t){return t&&t._delegate?t._delegate:t}class Ea{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mfe{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new vfe;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ffe(e))try{this.getOrInitializeService({instanceIdentifier:Tc})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Tc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Tc){return this.instances.has(e)}getOptions(e=Tc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Lfe(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Tc){return this.component?this.component.multipleInstances?e:Tc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Lfe(t){return t===Tc?void 0:t}function Ffe(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ofe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Mfe(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(dn||(dn={}));const Vfe={debug:dn.DEBUG,verbose:dn.VERBOSE,info:dn.INFO,warn:dn.WARN,error:dn.ERROR,silent:dn.SILENT},$fe=dn.INFO,Ufe={[dn.DEBUG]:"log",[dn.VERBOSE]:"log",[dn.INFO]:"info",[dn.WARN]:"warn",[dn.ERROR]:"error"},Bfe=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Ufe[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class pN{constructor(e){this.name=e,this._logLevel=$fe,this._logHandler=Bfe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Vfe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,dn.DEBUG,...e),this._logHandler(this,dn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,dn.VERBOSE,...e),this._logHandler(this,dn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,dn.INFO,...e),this._logHandler(this,dn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,dn.WARN,...e),this._logHandler(this,dn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,dn.ERROR,...e),this._logHandler(this,dn.ERROR,...e)}}const zfe=(t,e)=>e.some(n=>t instanceof n);let ID,ND;function Gfe(){return ID||(ID=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Hfe(){return ND||(ND=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xB=new WeakMap,EC=new WeakMap,vB=new WeakMap,Xb=new WeakMap,gN=new WeakMap;function Wfe(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Pl(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&xB.set(n,t)}).catch(()=>{}),gN.set(e,t),e}function qfe(t){if(EC.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});EC.set(t,e)}let CC={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return EC.get(t);if(e==="objectStoreNames")return t.objectStoreNames||vB.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Pl(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Kfe(t){CC=t(CC)}function Yfe(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Qb(this),e,...n);return vB.set(r,e.sort?e.sort():[e]),Pl(r)}:Hfe().includes(t)?function(...e){return t.apply(Qb(this),e),Pl(xB.get(this))}:function(...e){return Pl(t.apply(Qb(this),e))}}function Jfe(t){return typeof t=="function"?Yfe(t):(t instanceof IDBTransaction&&qfe(t),zfe(t,Gfe())?new Proxy(t,CC):t)}function Pl(t){if(t instanceof IDBRequest)return Wfe(t);if(Xb.has(t))return Xb.get(t);const e=Jfe(t);return e!==t&&(Xb.set(t,e),gN.set(e,t)),e}const Qb=t=>gN.get(t);function Xfe(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Pl(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Pl(o.result),c.oldVersion,c.newVersion,Pl(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const Qfe=["get","getKey","getAll","getAllKeys","count"],Zfe=["put","add","delete","clear"],Zb=new Map;function PD(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Zb.get(e))return Zb.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Zfe.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Qfe.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return Zb.set(e,i),i}Kfe(t=>({...t,get:(e,n,r)=>PD(e,n)||t.get(e,n,r),has:(e,n)=>!!PD(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eme{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(tme(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function tme(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const TC="@firebase/app",AD="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca=new pN("@firebase/app"),nme="@firebase/app-compat",rme="@firebase/analytics-compat",sme="@firebase/analytics",ime="@firebase/app-check-compat",ome="@firebase/app-check",ame="@firebase/auth",lme="@firebase/auth-compat",cme="@firebase/database",ume="@firebase/data-connect",dme="@firebase/database-compat",hme="@firebase/functions",fme="@firebase/functions-compat",mme="@firebase/installations",pme="@firebase/installations-compat",gme="@firebase/messaging",yme="@firebase/messaging-compat",xme="@firebase/performance",vme="@firebase/performance-compat",wme="@firebase/remote-config",_me="@firebase/remote-config-compat",bme="@firebase/storage",Sme="@firebase/storage-compat",Eme="@firebase/firestore",Cme="@firebase/ai",Tme="@firebase/firestore-compat",Ime="firebase",Nme="11.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IC="[DEFAULT]",Pme={[TC]:"fire-core",[nme]:"fire-core-compat",[sme]:"fire-analytics",[rme]:"fire-analytics-compat",[ome]:"fire-app-check",[ime]:"fire-app-check-compat",[ame]:"fire-auth",[lme]:"fire-auth-compat",[cme]:"fire-rtdb",[ume]:"fire-data-connect",[dme]:"fire-rtdb-compat",[hme]:"fire-fn",[fme]:"fire-fn-compat",[mme]:"fire-iid",[pme]:"fire-iid-compat",[gme]:"fire-fcm",[yme]:"fire-fcm-compat",[xme]:"fire-perf",[vme]:"fire-perf-compat",[wme]:"fire-rc",[_me]:"fire-rc-compat",[bme]:"fire-gcs",[Sme]:"fire-gcs-compat",[Eme]:"fire-fst",[Tme]:"fire-fst-compat",[Cme]:"fire-vertex","fire-js":"fire-js",[Ime]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uv=new Map,Ame=new Map,NC=new Map;function RD(t,e){try{t.container.addComponent(e)}catch(n){Ca.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function zl(t){const e=t.name;if(NC.has(e))return Ca.debug(`There were multiple attempts to register component ${e}.`),!1;NC.set(e,t);for(const n of Uv.values())RD(n,t);for(const n of Ame.values())RD(n,t);return!0}function dg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Bs(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rme={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Al=new cg("app","Firebase",Rme);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kme{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ea("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Al.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ku=Nme;function wB(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:IC,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw Al.create("bad-app-name",{appName:String(s)});if(n||(n=dB()),!n)throw Al.create("no-options");const i=Uv.get(s);if(i){if(fu(n,i.options)&&fu(r,i.config))return i;throw Al.create("duplicate-app",{appName:s})}const o=new Ofe(s);for(const c of NC.values())o.addComponent(c);const l=new kme(n,r,o);return Uv.set(s,l),l}function O0(t=IC){const e=Uv.get(t);if(!e&&t===IC&&dB())return wB();if(!e)throw Al.create("no-app",{appName:t});return e}function Oi(t,e,n){var r;let s=(r=Pme[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ca.warn(l.join(" "));return}zl(new Ea(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jme="firebase-heartbeat-database",Dme=1,gp="firebase-heartbeat-store";let eS=null;function _B(){return eS||(eS=Xfe(jme,Dme,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(gp)}catch(n){console.warn(n)}}}}).catch(t=>{throw Al.create("idb-open",{originalErrorMessage:t.message})})),eS}async function Mme(t){try{const n=(await _B()).transaction(gp),r=await n.objectStore(gp).get(bB(t));return await n.done,r}catch(e){if(e instanceof vo)Ca.warn(e.message);else{const n=Al.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ca.warn(n.message)}}}async function kD(t,e){try{const r=(await _B()).transaction(gp,"readwrite");await r.objectStore(gp).put(e,bB(t)),await r.done}catch(n){if(n instanceof vo)Ca.warn(n.message);else{const r=Al.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ca.warn(r.message)}}}function bB(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lme=1024,Fme=30;class Ome{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new $me(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=jD();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>Fme){const o=Ume(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Ca.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=jD(),{heartbeatsToSend:r,unsentEntries:s}=Vme(this._heartbeatsCache.heartbeats),i=$v(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Ca.warn(n),""}}}function jD(){return new Date().toISOString().substring(0,10)}function Vme(t,e=Lme){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),DD(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),DD(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class $me{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return yB()?Ife().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Mme(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return kD(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return kD(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function DD(t){return $v(JSON.stringify({version:2,heartbeats:t})).length}function Ume(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bme(t){zl(new Ea("platform-logger",e=>new eme(e),"PRIVATE")),zl(new Ea("heartbeat",e=>new Ome(e),"PRIVATE")),Oi(TC,AD,t),Oi(TC,AD,"esm2017"),Oi("fire-js","")}Bme("");var zme="firebase",Gme="11.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Oi(zme,Gme,"app");function SB(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Hme=SB,EB=new cg("auth","Firebase",SB());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bv=new pN("@firebase/auth");function Wme(t,...e){Bv.logLevel<=dn.WARN&&Bv.warn(`Auth (${ku}): ${t}`,...e)}function bx(t,...e){Bv.logLevel<=dn.ERROR&&Bv.error(`Auth (${ku}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mo(t,...e){throw yN(t,...e)}function Vo(t,...e){return yN(t,...e)}function CB(t,e,n){const r=Object.assign(Object.assign({},Hme()),{[e]:n});return new cg("auth","Firebase",r).create(e,{appName:t.name})}function fa(t){return CB(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function yN(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return EB.create(t,...e)}function Lt(t,e,...n){if(!t)throw yN(e,...n)}function oa(t){const e="INTERNAL ASSERTION FAILED: "+t;throw bx(e),new Error(e)}function Ta(t,e){t||oa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PC(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function qme(){return MD()==="http:"||MD()==="https:"}function MD(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kme(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qme()||Efe()||"connection"in navigator)?navigator.onLine:!0}function Yme(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ta(n>e,"Short delay should be less than long delay!"),this.isMobile=bfe()||Cfe()}get(){return Kme()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xN(t,e){Ta(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TB{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jme={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xme=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Qme=new hg(3e4,6e4);function dc(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function hc(t,e,n,r,s={}){return IB(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=ug(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return Sfe()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&uc(t.emulatorConfig.host)&&(u.credentials="include"),TB.fetch()(await NB(t,t.config.apiHost,n,l),u)})}async function IB(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Jme),e);try{const s=new epe(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Py(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Py(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Py(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Py(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw CB(t,d,u);mo(t,d)}}catch(s){if(s instanceof vo)throw s;mo(t,"network-request-failed",{message:String(s)})}}async function fg(t,e,n,r,s={}){const i=await hc(t,e,n,r,s);return"mfaPendingCredential"in i&&mo(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function NB(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?xN(t.config,s):`${t.config.apiScheme}://${s}`;return Xme.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function Zme(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class epe{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Vo(this.auth,"network-request-failed")),Qme.get())})}}function Py(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Vo(t,e,r);return s.customData._tokenResponse=n,s}function LD(t){return t!==void 0&&t.enterprise!==void 0}class tpe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Zme(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function npe(t,e){return hc(t,"GET","/v2/recaptchaConfig",dc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rpe(t,e){return hc(t,"POST","/v1/accounts:delete",e)}async function zv(t,e){return hc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function spe(t,e=!1){const n=Vn(t),r=await n.getIdToken(e),s=vN(r);Lt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Pm(tS(s.auth_time)),issuedAtTime:Pm(tS(s.iat)),expirationTime:Pm(tS(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function tS(t){return Number(t)*1e3}function vN(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return bx("JWT malformed, contained fewer than 3 sections"),null;try{const s=lB(n);return s?JSON.parse(s):(bx("Failed to decode base64 JWT payload"),null)}catch(s){return bx("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function FD(t){const e=vN(t);return Lt(e,"internal-error"),Lt(typeof e.exp<"u","internal-error"),Lt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yp(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof vo&&ipe(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function ipe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ope{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Pm(this.lastLoginAt),this.creationTime=Pm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gv(t){var e;const n=t.auth,r=await t.getIdToken(),s=await yp(t,zv(n,{idToken:r}));Lt(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?PB(i.providerUserInfo):[],l=lpe(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new AC(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function ape(t){const e=Vn(t);await Gv(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function lpe(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function PB(t){return t.map(e=>{var{providerId:n}=e,r=Wh(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cpe(t,e){const n=await IB(t,{},async()=>{const r=ug({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await NB(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",TB.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function upe(t,e){return hc(t,"POST","/v2/accounts:revokeToken",dc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Lt(e.idToken,"internal-error"),Lt(typeof e.idToken<"u","internal-error"),Lt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):FD(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Lt(e.length!==0,"internal-error");const n=FD(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Lt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await cpe(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new eh;return r&&(Lt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(Lt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(Lt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new eh,this.toJSON())}_performRefresh(){return oa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wa(t,e){Lt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ao{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Wh(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ope(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new AC(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await yp(this,this.stsTokenManager.getToken(this.auth,e));return Lt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return spe(this,e)}reload(){return ape(this)}_assign(e){this!==e&&(Lt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ao(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Lt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Gv(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Bs(this.auth.app))return Promise.reject(fa(this.auth));const e=await this.getIdToken();return await yp(this,rpe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,u,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(s=n.email)!==null&&s!==void 0?s:void 0,m=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,g=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(l=n.tenantId)!==null&&l!==void 0?l:void 0,E=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,v=(u=n.createdAt)!==null&&u!==void 0?u:void 0,_=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:S,emailVerified:I,isAnonymous:M,providerData:j,stsTokenManager:C}=n;Lt(S&&C,e,"internal-error");const T=eh.fromJSON(this.name,C);Lt(typeof S=="string",e,"internal-error"),Wa(h,e.name),Wa(f,e.name),Lt(typeof I=="boolean",e,"internal-error"),Lt(typeof M=="boolean",e,"internal-error"),Wa(m,e.name),Wa(g,e.name),Wa(x,e.name),Wa(E,e.name),Wa(v,e.name),Wa(_,e.name);const P=new ao({uid:S,auth:e,email:f,emailVerified:I,displayName:h,isAnonymous:M,photoURL:g,phoneNumber:m,tenantId:x,stsTokenManager:T,createdAt:v,lastLoginAt:_});return j&&Array.isArray(j)&&(P.providerData=j.map(A=>Object.assign({},A))),E&&(P._redirectEventId=E),P}static async _fromIdTokenResponse(e,n,r=!1){const s=new eh;s.updateFromServerResponse(n);const i=new ao({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Gv(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Lt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?PB(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new eh;l.updateFromIdToken(r);const c=new ao({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new AC(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD=new Map;function aa(t){Ta(t instanceof Function,"Expected a class definition");let e=OD.get(t);return e?(Ta(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,OD.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AB{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}AB.type="NONE";const VD=AB;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sx(t,e,n){return`firebase:${t}:${e}:${n}`}class th{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Sx(this.userKey,s.apiKey,i),this.fullPersistenceKey=Sx("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await zv(this.auth,{idToken:e}).catch(()=>{});return n?ao._fromGetAccountInfoResponse(this.auth,n,e):null}return ao._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new th(aa(VD),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||aa(VD);const o=Sx(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){let h;if(typeof d=="string"){const f=await zv(e,{idToken:d}).catch(()=>{});if(!f)break;h=await ao._fromGetAccountInfoResponse(e,f,d)}else h=ao._fromJSON(e,d);u!==i&&(l=h),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new th(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new th(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $D(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(DB(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(RB(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(LB(e))return"Blackberry";if(FB(e))return"Webos";if(kB(e))return"Safari";if((e.includes("chrome/")||jB(e))&&!e.includes("edge/"))return"Chrome";if(MB(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function RB(t=Dr()){return/firefox\//i.test(t)}function kB(t=Dr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function jB(t=Dr()){return/crios\//i.test(t)}function DB(t=Dr()){return/iemobile/i.test(t)}function MB(t=Dr()){return/android/i.test(t)}function LB(t=Dr()){return/blackberry/i.test(t)}function FB(t=Dr()){return/webos/i.test(t)}function wN(t=Dr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function dpe(t=Dr()){var e;return wN(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function hpe(){return Tfe()&&document.documentMode===10}function OB(t=Dr()){return wN(t)||MB(t)||FB(t)||LB(t)||/windows phone/i.test(t)||DB(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VB(t,e=[]){let n;switch(t){case"Browser":n=$D(Dr());break;case"Worker":n=`${$D(Dr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ku}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fpe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mpe(t,e={}){return hc(t,"GET","/v2/passwordPolicy",dc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ppe=6;class gpe{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:ppe,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ype{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new UD(this),this.idTokenSubscription=new UD(this),this.beforeStateQueue=new fpe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=EB,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=aa(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await th.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await zv(this,{idToken:e}),r=await ao._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Bs(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Lt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Gv(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Yme()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Bs(this.app))return Promise.reject(fa(this));const n=e?Vn(e):null;return n&&Lt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Lt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Bs(this.app)?Promise.reject(fa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Bs(this.app)?Promise.reject(fa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(aa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await mpe(this),n=new gpe(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new cg("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await upe(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&aa(e)||this._popupRedirectResolver;Lt(n,this,"argument-error"),this.redirectPersistenceManager=await th.create(this,[aa(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Lt(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Lt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=VB(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if(Bs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Wme(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function ju(t){return Vn(t)}class UD{constructor(e){this.auth=e,this.observer=null,this.addObserver=kfe(n=>this.observer=n)}get next(){return Lt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let V0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function xpe(t){V0=t}function $B(t){return V0.loadJS(t)}function vpe(){return V0.recaptchaEnterpriseScript}function wpe(){return V0.gapiScript}function _pe(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class bpe{constructor(){this.enterprise=new Spe}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Spe{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const Epe="recaptcha-enterprise",UB="NO_RECAPTCHA";class Cpe{constructor(e){this.type=Epe,this.auth=ju(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{npe(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new tpe(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;LD(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(UB)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new bpe().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&LD(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=vpe();c.length!==0&&(c+=l),$B(c).then(()=>{s(l,i,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function Af(t,e,n,r=!1,s=!1){const i=new Cpe(t);let o;if(s)o=UB;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const l=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function RC(t,e,n,r,s){var i,o;if(s==="EMAIL_PASSWORD_PROVIDER")if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await Af(t,e,n,n==="getOobCode");return r(t,l)}else return r(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await Af(t,e,n,n==="getOobCode");return r(t,c)}else return Promise.reject(l)});else if(s==="PHONE_PROVIDER")if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){const l=await Af(t,e,n);return r(t,l).catch(async c=>{var u;if(((u=t._getRecaptchaConfig())===null||u===void 0?void 0:u.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const d=await Af(t,e,n,!1,!0);return r(t,d)}return Promise.reject(c)})}else{const l=await Af(t,e,n,!1,!0);return r(t,l)}else return Promise.reject(s+" provider is not supported.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tpe(t,e){const n=dg(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(fu(i,e??{}))return s;mo(s,"already-initialized")}return n.initialize({options:e})}function Ipe(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(aa);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Npe(t,e,n){const r=ju(t);Lt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=BB(e),{host:o,port:l}=Ppe(e),c=l===null?"":`:${l}`,u={url:`${i}//${o}${c}/`},d=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Lt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Lt(fu(u,r.config.emulator)&&fu(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,uc(o)?(L0(`${i}//${o}${c}`),F0("Auth",!0)):s||Ape()}function BB(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Ppe(t){const e=BB(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:BD(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:BD(o)}}}function BD(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Ape(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return oa("not implemented")}_getIdTokenResponse(e){return oa("not implemented")}_linkToIdToken(e,n){return oa("not implemented")}_getReauthenticationResolver(e){return oa("not implemented")}}async function Rpe(t,e){return hc(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kpe(t,e){return fg(t,"POST","/v1/accounts:signInWithPassword",dc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jpe(t,e){return fg(t,"POST","/v1/accounts:signInWithEmailLink",dc(t,e))}async function Dpe(t,e){return fg(t,"POST","/v1/accounts:signInWithEmailLink",dc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp extends _N{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new xp(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new xp(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return RC(e,n,"signInWithPassword",kpe,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return jpe(e,{email:this._email,oobCode:this._password});default:mo(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return RC(e,r,"signUpPassword",Rpe,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Dpe(e,{idToken:n,email:this._email,oobCode:this._password});default:mo(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nh(t,e){return fg(t,"POST","/v1/accounts:signInWithIdp",dc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mpe="http://localhost";class mu extends _N{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new mu(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):mo("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Wh(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new mu(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return nh(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,nh(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,nh(e,n)}buildRequest(){const e={requestUri:Mpe,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ug(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lpe(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Fpe(t){const e=em(tm(t)).link,n=e?em(tm(e)).deep_link_id:null,r=em(tm(t)).deep_link_id;return(r?em(tm(r)).link:null)||r||n||e||t}class bN{constructor(e){var n,r,s,i,o,l;const c=em(tm(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=Lpe((s=c.mode)!==null&&s!==void 0?s:null);Lt(u&&d&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=d,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.lang)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=Fpe(e);try{return new bN(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(){this.providerId=Jh.PROVIDER_ID}static credential(e,n){return xp._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=bN.parseLink(n);return Lt(r,"argument-error"),xp._fromEmailAndCode(e,r.code,r.tenantId)}}Jh.PROVIDER_ID="password";Jh.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Jh.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg extends zB{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al extends mg{constructor(){super("facebook.com")}static credential(e){return mu._fromParams({providerId:al.PROVIDER_ID,signInMethod:al.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return al.credentialFromTaggedObject(e)}static credentialFromError(e){return al.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return al.credential(e.oauthAccessToken)}catch{return null}}}al.FACEBOOK_SIGN_IN_METHOD="facebook.com";al.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll extends mg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return mu._fromParams({providerId:ll.PROVIDER_ID,signInMethod:ll.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ll.credentialFromTaggedObject(e)}static credentialFromError(e){return ll.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return ll.credential(n,r)}catch{return null}}}ll.GOOGLE_SIGN_IN_METHOD="google.com";ll.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl extends mg{constructor(){super("github.com")}static credential(e){return mu._fromParams({providerId:cl.PROVIDER_ID,signInMethod:cl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cl.credentialFromTaggedObject(e)}static credentialFromError(e){return cl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return cl.credential(e.oauthAccessToken)}catch{return null}}}cl.GITHUB_SIGN_IN_METHOD="github.com";cl.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul extends mg{constructor(){super("twitter.com")}static credential(e,n){return mu._fromParams({providerId:ul.PROVIDER_ID,signInMethod:ul.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ul.credentialFromTaggedObject(e)}static credentialFromError(e){return ul.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ul.credential(n,r)}catch{return null}}}ul.TWITTER_SIGN_IN_METHOD="twitter.com";ul.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ope(t,e){return fg(t,"POST","/v1/accounts:signUp",dc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await ao._fromIdTokenResponse(e,r,s),o=zD(r);return new pu({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=zD(r);return new pu({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function zD(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv extends vo{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Hv.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Hv(e,n,r,s)}}function GB(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Hv._fromErrorAndOperation(t,i,e,r):i})}async function Vpe(t,e,n=!1){const r=await yp(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return pu._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $pe(t,e,n=!1){const{auth:r}=t;if(Bs(r.app))return Promise.reject(fa(r));const s="reauthenticate";try{const i=await yp(t,GB(r,s,e,t),n);Lt(i.idToken,r,"internal-error");const o=vN(i.idToken);Lt(o,r,"internal-error");const{sub:l}=o;return Lt(t.uid===l,r,"user-mismatch"),pu._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&mo(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HB(t,e,n=!1){if(Bs(t.app))return Promise.reject(fa(t));const r="signIn",s=await GB(t,r,e),i=await pu._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Upe(t,e){return HB(ju(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WB(t){const e=ju(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Bpe(t,e,n){if(Bs(t.app))return Promise.reject(fa(t));const r=ju(t),o=await RC(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ope,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&WB(t),c}),l=await pu._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function zpe(t,e,n){return Bs(t.app)?Promise.reject(fa(t)):Upe(Vn(t),Jh.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&WB(t),r})}function Gpe(t,e,n,r){return Vn(t).onIdTokenChanged(e,n,r)}function Hpe(t,e,n){return Vn(t).beforeAuthStateChanged(e,n)}function Wpe(t,e,n,r){return Vn(t).onAuthStateChanged(e,n,r)}function qpe(t){return Vn(t).signOut()}const Wv="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qB{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Wv,"1"),this.storage.removeItem(Wv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kpe=1e3,Ype=10;class KB extends qB{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=OB(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);hpe()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Ype):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Kpe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}KB.type="LOCAL";const Jpe=KB;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YB extends qB{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}YB.type="SESSION";const JB=YB;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xpe(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new $0(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await Xpe(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}$0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SN(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qpe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=SN("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(f.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $o(){return window}function Zpe(t){$o().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XB(){return typeof $o().WorkerGlobalScope<"u"&&typeof $o().importScripts=="function"}async function ege(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function tge(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function nge(){return XB()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QB="firebaseLocalStorageDb",rge=1,qv="firebaseLocalStorage",ZB="fbase_key";class pg{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function U0(t,e){return t.transaction([qv],e?"readwrite":"readonly").objectStore(qv)}function sge(){const t=indexedDB.deleteDatabase(QB);return new pg(t).toPromise()}function kC(){const t=indexedDB.open(QB,rge);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(qv,{keyPath:ZB})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(qv)?e(r):(r.close(),await sge(),e(await kC()))})})}async function GD(t,e,n){const r=U0(t,!0).put({[ZB]:e,value:n});return new pg(r).toPromise()}async function ige(t,e){const n=U0(t,!1).get(e),r=await new pg(n).toPromise();return r===void 0?null:r.value}function HD(t,e){const n=U0(t,!0).delete(e);return new pg(n).toPromise()}const oge=800,age=3;class ez{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await kC(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>age)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return XB()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=$0._getInstance(nge()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await ege(),!this.activeServiceWorker)return;this.sender=new Qpe(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||tge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await kC();return await GD(e,Wv,"1"),await HD(e,Wv),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>GD(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>ige(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>HD(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=U0(s,!1).getAll();return new pg(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),oge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ez.type="LOCAL";const lge=ez;new hg(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cge(t,e){return e?aa(e):(Lt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EN extends _N{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return nh(e,this._buildIdpRequest())}_linkToIdToken(e,n){return nh(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return nh(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function uge(t){return HB(t.auth,new EN(t),t.bypassAuthState)}function dge(t){const{auth:e,user:n}=t;return Lt(n,e,"internal-error"),$pe(n,new EN(t),t.bypassAuthState)}async function hge(t){const{auth:e,user:n}=t;return Lt(n,e,"internal-error"),Vpe(n,new EN(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return uge;case"linkViaPopup":case"linkViaRedirect":return hge;case"reauthViaPopup":case"reauthViaRedirect":return dge;default:mo(this.auth,"internal-error")}}resolve(e){Ta(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ta(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fge=new hg(2e3,1e4);class Od extends tz{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Od.currentPopupAction&&Od.currentPopupAction.cancel(),Od.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Lt(e,this.auth,"internal-error"),e}async onExecution(){Ta(this.filter.length===1,"Popup operations only handle one event");const e=SN();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Vo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Vo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Od.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Vo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,fge.get())};e()}}Od.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mge="pendingRedirect",Ex=new Map;class pge extends tz{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ex.get(this.auth._key());if(!e){try{const r=await gge(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ex.set(this.auth._key(),e)}return this.bypassAuthState||Ex.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function gge(t,e){const n=vge(e),r=xge(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function yge(t,e){Ex.set(t._key(),e)}function xge(t){return aa(t._redirectPersistence)}function vge(t){return Sx(mge,t.config.apiKey,t.name)}async function wge(t,e,n=!1){if(Bs(t.app))return Promise.reject(fa(t));const r=ju(t),s=cge(r,e),o=await new pge(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _ge=10*60*1e3;class bge{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Sge(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!nz(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Vo(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_ge&&this.cachedEventUids.clear(),this.cachedEventUids.has(WD(e))}saveEventToCache(e){this.cachedEventUids.add(WD(e)),this.lastProcessedEventTime=Date.now()}}function WD(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function nz({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Sge(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nz(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ege(t,e={}){return hc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cge=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Tge=/^https?/;async function Ige(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Ege(t);for(const n of e)try{if(Nge(n))return}catch{}mo(t,"unauthorized-domain")}function Nge(t){const e=PC(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Tge.test(n))return!1;if(Cge.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pge=new hg(3e4,6e4);function qD(){const t=$o().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Age(t){return new Promise((e,n)=>{var r,s,i;function o(){qD(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{qD(),n(Vo(t,"network-request-failed"))},timeout:Pge.get()})}if(!((s=(r=$o().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=$o().gapi)===null||i===void 0)&&i.load)o();else{const l=_pe("iframefcb");return $o()[l]=()=>{gapi.load?o():n(Vo(t,"network-request-failed"))},$B(`${wpe()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw Cx=null,e})}let Cx=null;function Rge(t){return Cx=Cx||Age(t),Cx}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kge=new hg(5e3,15e3),jge="__/auth/iframe",Dge="emulator/auth/iframe",Mge={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Lge=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fge(t){const e=t.config;Lt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?xN(e,Dge):`https://${t.config.authDomain}/${jge}`,r={apiKey:e.apiKey,appName:t.name,v:ku},s=Lge.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${ug(r).slice(1)}`}async function Oge(t){const e=await Rge(t),n=$o().gapi;return Lt(n,t,"internal-error"),e.open({where:document.body,url:Fge(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Mge,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Vo(t,"network-request-failed"),l=$o().setTimeout(()=>{i(o)},kge.get());function c(){$o().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vge={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$ge=500,Uge=600,Bge="_blank",zge="http://localhost";class KD{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Gge(t,e,n,r=$ge,s=Uge){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},Vge),{width:r.toString(),height:s.toString(),top:i,left:o}),u=Dr().toLowerCase();n&&(l=jB(u)?Bge:n),RB(u)&&(e=e||zge,c.scrollbars="yes");const d=Object.entries(c).reduce((f,[m,g])=>`${f}${m}=${g},`,"");if(dpe(u)&&l!=="_self")return Hge(e||"",l),new KD(null);const h=window.open(e||"",l,d);Lt(h,t,"popup-blocked");try{h.focus()}catch{}return new KD(h)}function Hge(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wge="__/auth/handler",qge="emulator/auth/handler",Kge=encodeURIComponent("fac");async function YD(t,e,n,r,s,i){Lt(t.config.authDomain,t,"auth-domain-config-required"),Lt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ku,eventId:s};if(e instanceof zB){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Rfe(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries(i||{}))o[d]=h}if(e instanceof mg){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${Kge}=${encodeURIComponent(c)}`:"";return`${Yge(t)}?${ug(l).slice(1)}${u}`}function Yge({config:t}){return t.emulator?xN(t,qge):`https://${t.authDomain}/${Wge}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS="webStorageSupport";class Jge{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=JB,this._completeRedirectFn=wge,this._overrideRedirectResult=yge}async _openPopup(e,n,r,s){var i;Ta((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await YD(e,n,r,PC(),s);return Gge(e,o,SN())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await YD(e,n,r,PC(),s);return Zpe(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Ta(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Oge(e),r=new bge(e);return n.register("authEvent",s=>(Lt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(nS,{type:nS},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[nS];o!==void 0&&n(!!o),mo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Ige(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return OB()||kB()||wN()}}const Xge=Jge;var JD="@firebase/auth",XD="1.10.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qge{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Lt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zge(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function eye(t){zl(new Ea("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;Lt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:VB(t)},u=new ype(r,s,i,c);return Ipe(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),zl(new Ea("auth-internal",e=>{const n=ju(e.getProvider("auth").getImmediate());return(r=>new Qge(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Oi(JD,XD,Zge(t)),Oi(JD,XD,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tye=5*60,nye=hB("authIdTokenMaxAge")||tye;let QD=null;const rye=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>nye)return;const s=n==null?void 0:n.token;QD!==s&&(QD=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function sye(t=O0()){const e=dg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Tpe(t,{popupRedirectResolver:Xge,persistence:[lge,Jpe,JB]}),r=hB("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=rye(i.toString());Hpe(n,o,()=>o(n.currentUser)),Gpe(n,l=>o(l))}}const s=uB("auth");return s&&Npe(n,`http://${s}`),n}function iye(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}xpe({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Vo("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",iye().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});eye("Browser");var ZD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Rl,rz;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,T){function P(){}P.prototype=T.prototype,C.D=T.prototype,C.prototype=new P,C.prototype.constructor=C,C.C=function(A,D,R){for(var k=Array(arguments.length-2),U=2;U<arguments.length;U++)k[U-2]=arguments[U];return T.prototype[D].apply(A,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(C,T,P){P||(P=0);var A=Array(16);if(typeof T=="string")for(var D=0;16>D;++D)A[D]=T.charCodeAt(P++)|T.charCodeAt(P++)<<8|T.charCodeAt(P++)<<16|T.charCodeAt(P++)<<24;else for(D=0;16>D;++D)A[D]=T[P++]|T[P++]<<8|T[P++]<<16|T[P++]<<24;T=C.g[0],P=C.g[1],D=C.g[2];var R=C.g[3],k=T+(R^P&(D^R))+A[0]+3614090360&4294967295;T=P+(k<<7&4294967295|k>>>25),k=R+(D^T&(P^D))+A[1]+3905402710&4294967295,R=T+(k<<12&4294967295|k>>>20),k=D+(P^R&(T^P))+A[2]+606105819&4294967295,D=R+(k<<17&4294967295|k>>>15),k=P+(T^D&(R^T))+A[3]+3250441966&4294967295,P=D+(k<<22&4294967295|k>>>10),k=T+(R^P&(D^R))+A[4]+4118548399&4294967295,T=P+(k<<7&4294967295|k>>>25),k=R+(D^T&(P^D))+A[5]+1200080426&4294967295,R=T+(k<<12&4294967295|k>>>20),k=D+(P^R&(T^P))+A[6]+2821735955&4294967295,D=R+(k<<17&4294967295|k>>>15),k=P+(T^D&(R^T))+A[7]+4249261313&4294967295,P=D+(k<<22&4294967295|k>>>10),k=T+(R^P&(D^R))+A[8]+1770035416&4294967295,T=P+(k<<7&4294967295|k>>>25),k=R+(D^T&(P^D))+A[9]+2336552879&4294967295,R=T+(k<<12&4294967295|k>>>20),k=D+(P^R&(T^P))+A[10]+4294925233&4294967295,D=R+(k<<17&4294967295|k>>>15),k=P+(T^D&(R^T))+A[11]+2304563134&4294967295,P=D+(k<<22&4294967295|k>>>10),k=T+(R^P&(D^R))+A[12]+1804603682&4294967295,T=P+(k<<7&4294967295|k>>>25),k=R+(D^T&(P^D))+A[13]+4254626195&4294967295,R=T+(k<<12&4294967295|k>>>20),k=D+(P^R&(T^P))+A[14]+2792965006&4294967295,D=R+(k<<17&4294967295|k>>>15),k=P+(T^D&(R^T))+A[15]+1236535329&4294967295,P=D+(k<<22&4294967295|k>>>10),k=T+(D^R&(P^D))+A[1]+4129170786&4294967295,T=P+(k<<5&4294967295|k>>>27),k=R+(P^D&(T^P))+A[6]+3225465664&4294967295,R=T+(k<<9&4294967295|k>>>23),k=D+(T^P&(R^T))+A[11]+643717713&4294967295,D=R+(k<<14&4294967295|k>>>18),k=P+(R^T&(D^R))+A[0]+3921069994&4294967295,P=D+(k<<20&4294967295|k>>>12),k=T+(D^R&(P^D))+A[5]+3593408605&4294967295,T=P+(k<<5&4294967295|k>>>27),k=R+(P^D&(T^P))+A[10]+38016083&4294967295,R=T+(k<<9&4294967295|k>>>23),k=D+(T^P&(R^T))+A[15]+3634488961&4294967295,D=R+(k<<14&4294967295|k>>>18),k=P+(R^T&(D^R))+A[4]+3889429448&4294967295,P=D+(k<<20&4294967295|k>>>12),k=T+(D^R&(P^D))+A[9]+568446438&4294967295,T=P+(k<<5&4294967295|k>>>27),k=R+(P^D&(T^P))+A[14]+3275163606&4294967295,R=T+(k<<9&4294967295|k>>>23),k=D+(T^P&(R^T))+A[3]+4107603335&4294967295,D=R+(k<<14&4294967295|k>>>18),k=P+(R^T&(D^R))+A[8]+1163531501&4294967295,P=D+(k<<20&4294967295|k>>>12),k=T+(D^R&(P^D))+A[13]+2850285829&4294967295,T=P+(k<<5&4294967295|k>>>27),k=R+(P^D&(T^P))+A[2]+4243563512&4294967295,R=T+(k<<9&4294967295|k>>>23),k=D+(T^P&(R^T))+A[7]+1735328473&4294967295,D=R+(k<<14&4294967295|k>>>18),k=P+(R^T&(D^R))+A[12]+2368359562&4294967295,P=D+(k<<20&4294967295|k>>>12),k=T+(P^D^R)+A[5]+4294588738&4294967295,T=P+(k<<4&4294967295|k>>>28),k=R+(T^P^D)+A[8]+2272392833&4294967295,R=T+(k<<11&4294967295|k>>>21),k=D+(R^T^P)+A[11]+1839030562&4294967295,D=R+(k<<16&4294967295|k>>>16),k=P+(D^R^T)+A[14]+4259657740&4294967295,P=D+(k<<23&4294967295|k>>>9),k=T+(P^D^R)+A[1]+2763975236&4294967295,T=P+(k<<4&4294967295|k>>>28),k=R+(T^P^D)+A[4]+1272893353&4294967295,R=T+(k<<11&4294967295|k>>>21),k=D+(R^T^P)+A[7]+4139469664&4294967295,D=R+(k<<16&4294967295|k>>>16),k=P+(D^R^T)+A[10]+3200236656&4294967295,P=D+(k<<23&4294967295|k>>>9),k=T+(P^D^R)+A[13]+681279174&4294967295,T=P+(k<<4&4294967295|k>>>28),k=R+(T^P^D)+A[0]+3936430074&4294967295,R=T+(k<<11&4294967295|k>>>21),k=D+(R^T^P)+A[3]+3572445317&4294967295,D=R+(k<<16&4294967295|k>>>16),k=P+(D^R^T)+A[6]+76029189&4294967295,P=D+(k<<23&4294967295|k>>>9),k=T+(P^D^R)+A[9]+3654602809&4294967295,T=P+(k<<4&4294967295|k>>>28),k=R+(T^P^D)+A[12]+3873151461&4294967295,R=T+(k<<11&4294967295|k>>>21),k=D+(R^T^P)+A[15]+530742520&4294967295,D=R+(k<<16&4294967295|k>>>16),k=P+(D^R^T)+A[2]+3299628645&4294967295,P=D+(k<<23&4294967295|k>>>9),k=T+(D^(P|~R))+A[0]+4096336452&4294967295,T=P+(k<<6&4294967295|k>>>26),k=R+(P^(T|~D))+A[7]+1126891415&4294967295,R=T+(k<<10&4294967295|k>>>22),k=D+(T^(R|~P))+A[14]+2878612391&4294967295,D=R+(k<<15&4294967295|k>>>17),k=P+(R^(D|~T))+A[5]+4237533241&4294967295,P=D+(k<<21&4294967295|k>>>11),k=T+(D^(P|~R))+A[12]+1700485571&4294967295,T=P+(k<<6&4294967295|k>>>26),k=R+(P^(T|~D))+A[3]+2399980690&4294967295,R=T+(k<<10&4294967295|k>>>22),k=D+(T^(R|~P))+A[10]+4293915773&4294967295,D=R+(k<<15&4294967295|k>>>17),k=P+(R^(D|~T))+A[1]+2240044497&4294967295,P=D+(k<<21&4294967295|k>>>11),k=T+(D^(P|~R))+A[8]+1873313359&4294967295,T=P+(k<<6&4294967295|k>>>26),k=R+(P^(T|~D))+A[15]+4264355552&4294967295,R=T+(k<<10&4294967295|k>>>22),k=D+(T^(R|~P))+A[6]+2734768916&4294967295,D=R+(k<<15&4294967295|k>>>17),k=P+(R^(D|~T))+A[13]+1309151649&4294967295,P=D+(k<<21&4294967295|k>>>11),k=T+(D^(P|~R))+A[4]+4149444226&4294967295,T=P+(k<<6&4294967295|k>>>26),k=R+(P^(T|~D))+A[11]+3174756917&4294967295,R=T+(k<<10&4294967295|k>>>22),k=D+(T^(R|~P))+A[2]+718787259&4294967295,D=R+(k<<15&4294967295|k>>>17),k=P+(R^(D|~T))+A[9]+3951481745&4294967295,C.g[0]=C.g[0]+T&4294967295,C.g[1]=C.g[1]+(D+(k<<21&4294967295|k>>>11))&4294967295,C.g[2]=C.g[2]+D&4294967295,C.g[3]=C.g[3]+R&4294967295}r.prototype.u=function(C,T){T===void 0&&(T=C.length);for(var P=T-this.blockSize,A=this.B,D=this.h,R=0;R<T;){if(D==0)for(;R<=P;)s(this,C,R),R+=this.blockSize;if(typeof C=="string"){for(;R<T;)if(A[D++]=C.charCodeAt(R++),D==this.blockSize){s(this,A),D=0;break}}else for(;R<T;)if(A[D++]=C[R++],D==this.blockSize){s(this,A),D=0;break}}this.h=D,this.o+=T},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var T=1;T<C.length-8;++T)C[T]=0;var P=8*this.o;for(T=C.length-8;T<C.length;++T)C[T]=P&255,P/=256;for(this.u(C),C=Array(16),T=P=0;4>T;++T)for(var A=0;32>A;A+=8)C[P++]=this.g[T]>>>A&255;return C};function i(C,T){var P=l;return Object.prototype.hasOwnProperty.call(P,C)?P[C]:P[C]=T(C)}function o(C,T){this.h=T;for(var P=[],A=!0,D=C.length-1;0<=D;D--){var R=C[D]|0;A&&R==T||(P[D]=R,A=!1)}this.g=P}var l={};function c(C){return-128<=C&&128>C?i(C,function(T){return new o([T|0],0>T?-1:0)}):new o([C|0],0>C?-1:0)}function u(C){if(isNaN(C)||!isFinite(C))return h;if(0>C)return E(u(-C));for(var T=[],P=1,A=0;C>=P;A++)T[A]=C/P|0,P*=4294967296;return new o(T,0)}function d(C,T){if(C.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(C.charAt(0)=="-")return E(d(C.substring(1),T));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=u(Math.pow(T,8)),A=h,D=0;D<C.length;D+=8){var R=Math.min(8,C.length-D),k=parseInt(C.substring(D,D+R),T);8>R?(R=u(Math.pow(T,R)),A=A.j(R).add(u(k))):(A=A.j(P),A=A.add(u(k)))}return A}var h=c(0),f=c(1),m=c(16777216);t=o.prototype,t.m=function(){if(x(this))return-E(this).m();for(var C=0,T=1,P=0;P<this.g.length;P++){var A=this.i(P);C+=(0<=A?A:4294967296+A)*T,T*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(g(this))return"0";if(x(this))return"-"+E(this).toString(C);for(var T=u(Math.pow(C,6)),P=this,A="";;){var D=I(P,T).g;P=v(P,D.j(T));var R=((0<P.g.length?P.g[0]:P.h)>>>0).toString(C);if(P=D,g(P))return R+A;for(;6>R.length;)R="0"+R;A=R+A}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function g(C){if(C.h!=0)return!1;for(var T=0;T<C.g.length;T++)if(C.g[T]!=0)return!1;return!0}function x(C){return C.h==-1}t.l=function(C){return C=v(this,C),x(C)?-1:g(C)?0:1};function E(C){for(var T=C.g.length,P=[],A=0;A<T;A++)P[A]=~C.g[A];return new o(P,~C.h).add(f)}t.abs=function(){return x(this)?E(this):this},t.add=function(C){for(var T=Math.max(this.g.length,C.g.length),P=[],A=0,D=0;D<=T;D++){var R=A+(this.i(D)&65535)+(C.i(D)&65535),k=(R>>>16)+(this.i(D)>>>16)+(C.i(D)>>>16);A=k>>>16,R&=65535,k&=65535,P[D]=k<<16|R}return new o(P,P[P.length-1]&-2147483648?-1:0)};function v(C,T){return C.add(E(T))}t.j=function(C){if(g(this)||g(C))return h;if(x(this))return x(C)?E(this).j(E(C)):E(E(this).j(C));if(x(C))return E(this.j(E(C)));if(0>this.l(m)&&0>C.l(m))return u(this.m()*C.m());for(var T=this.g.length+C.g.length,P=[],A=0;A<2*T;A++)P[A]=0;for(A=0;A<this.g.length;A++)for(var D=0;D<C.g.length;D++){var R=this.i(A)>>>16,k=this.i(A)&65535,U=C.i(D)>>>16,B=C.i(D)&65535;P[2*A+2*D]+=k*B,_(P,2*A+2*D),P[2*A+2*D+1]+=R*B,_(P,2*A+2*D+1),P[2*A+2*D+1]+=k*U,_(P,2*A+2*D+1),P[2*A+2*D+2]+=R*U,_(P,2*A+2*D+2)}for(A=0;A<T;A++)P[A]=P[2*A+1]<<16|P[2*A];for(A=T;A<2*T;A++)P[A]=0;return new o(P,0)};function _(C,T){for(;(C[T]&65535)!=C[T];)C[T+1]+=C[T]>>>16,C[T]&=65535,T++}function S(C,T){this.g=C,this.h=T}function I(C,T){if(g(T))throw Error("division by zero");if(g(C))return new S(h,h);if(x(C))return T=I(E(C),T),new S(E(T.g),E(T.h));if(x(T))return T=I(C,E(T)),new S(E(T.g),T.h);if(30<C.g.length){if(x(C)||x(T))throw Error("slowDivide_ only works with positive integers.");for(var P=f,A=T;0>=A.l(C);)P=M(P),A=M(A);var D=j(P,1),R=j(A,1);for(A=j(A,2),P=j(P,2);!g(A);){var k=R.add(A);0>=k.l(C)&&(D=D.add(P),R=k),A=j(A,1),P=j(P,1)}return T=v(C,D.j(T)),new S(D,T)}for(D=h;0<=C.l(T);){for(P=Math.max(1,Math.floor(C.m()/T.m())),A=Math.ceil(Math.log(P)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),R=u(P),k=R.j(T);x(k)||0<k.l(C);)P-=A,R=u(P),k=R.j(T);g(R)&&(R=f),D=D.add(R),C=v(C,k)}return new S(D,C)}t.A=function(C){return I(this,C).h},t.and=function(C){for(var T=Math.max(this.g.length,C.g.length),P=[],A=0;A<T;A++)P[A]=this.i(A)&C.i(A);return new o(P,this.h&C.h)},t.or=function(C){for(var T=Math.max(this.g.length,C.g.length),P=[],A=0;A<T;A++)P[A]=this.i(A)|C.i(A);return new o(P,this.h|C.h)},t.xor=function(C){for(var T=Math.max(this.g.length,C.g.length),P=[],A=0;A<T;A++)P[A]=this.i(A)^C.i(A);return new o(P,this.h^C.h)};function M(C){for(var T=C.g.length+1,P=[],A=0;A<T;A++)P[A]=C.i(A)<<1|C.i(A-1)>>>31;return new o(P,C.h)}function j(C,T){var P=T>>5;T%=32;for(var A=C.g.length-P,D=[],R=0;R<A;R++)D[R]=0<T?C.i(R+P)>>>T|C.i(R+P+1)<<32-T:C.i(R+P);return new o(D,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,rz=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Rl=o}).apply(typeof ZD<"u"?ZD:typeof self<"u"?self:typeof window<"u"?window:{});var Ay=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var sz,nm,iz,Tx,jC,oz,az,lz;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,N,L){return y==Array.prototype||y==Object.prototype||(y[N]=L.value),y};function n(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ay=="object"&&Ay];for(var N=0;N<y.length;++N){var L=y[N];if(L&&L.Math==Math)return L}throw Error("Cannot find global object")}var r=n(this);function s(y,N){if(N)e:{var L=r;y=y.split(".");for(var $=0;$<y.length-1;$++){var ie=y[$];if(!(ie in L))break e;L=L[ie]}y=y[y.length-1],$=L[y],N=N($),N!=$&&N!=null&&e(L,y,{configurable:!0,writable:!0,value:N})}}function i(y,N){y instanceof String&&(y+="");var L=0,$=!1,ie={next:function(){if(!$&&L<y.length){var pe=L++;return{value:N(pe,y[pe]),done:!1}}return $=!0,{done:!0,value:void 0}}};return ie[Symbol.iterator]=function(){return ie},ie}s("Array.prototype.values",function(y){return y||function(){return i(this,function(N,L){return L})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(y){var N=typeof y;return N=N!="object"?N:y?Array.isArray(y)?"array":N:"null",N=="array"||N=="object"&&typeof y.length=="number"}function u(y){var N=typeof y;return N=="object"&&y!=null||N=="function"}function d(y,N,L){return y.call.apply(y.bind,arguments)}function h(y,N,L){if(!y)throw Error();if(2<arguments.length){var $=Array.prototype.slice.call(arguments,2);return function(){var ie=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ie,$),y.apply(N,ie)}}return function(){return y.apply(N,arguments)}}function f(y,N,L){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,f.apply(null,arguments)}function m(y,N){var L=Array.prototype.slice.call(arguments,1);return function(){var $=L.slice();return $.push.apply($,arguments),y.apply(this,$)}}function g(y,N){function L(){}L.prototype=N.prototype,y.aa=N.prototype,y.prototype=new L,y.prototype.constructor=y,y.Qb=function($,ie,pe){for(var tt=Array(arguments.length-2),jn=2;jn<arguments.length;jn++)tt[jn-2]=arguments[jn];return N.prototype[ie].apply($,tt)}}function x(y){const N=y.length;if(0<N){const L=Array(N);for(let $=0;$<N;$++)L[$]=y[$];return L}return[]}function E(y,N){for(let L=1;L<arguments.length;L++){const $=arguments[L];if(c($)){const ie=y.length||0,pe=$.length||0;y.length=ie+pe;for(let tt=0;tt<pe;tt++)y[ie+tt]=$[tt]}else y.push($)}}class v{constructor(N,L){this.i=N,this.j=L,this.h=0,this.g=null}get(){let N;return 0<this.h?(this.h--,N=this.g,this.g=N.next,N.next=null):N=this.i(),N}}function _(y){return/^[\s\xa0]*$/.test(y)}function S(){var y=l.navigator;return y&&(y=y.userAgent)?y:""}function I(y){return I[" "](y),y}I[" "]=function(){};var M=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function j(y,N,L){for(const $ in y)N.call(L,y[$],$,y)}function C(y,N){for(const L in y)N.call(void 0,y[L],L,y)}function T(y){const N={};for(const L in y)N[L]=y[L];return N}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(y,N){let L,$;for(let ie=1;ie<arguments.length;ie++){$=arguments[ie];for(L in $)y[L]=$[L];for(let pe=0;pe<P.length;pe++)L=P[pe],Object.prototype.hasOwnProperty.call($,L)&&(y[L]=$[L])}}function D(y){var N=1;y=y.split(":");const L=[];for(;0<N&&y.length;)L.push(y.shift()),N--;return y.length&&L.push(y.join(":")),L}function R(y){l.setTimeout(()=>{throw y},0)}function k(){var y=X;let N=null;return y.g&&(N=y.g,y.g=y.g.next,y.g||(y.h=null),N.next=null),N}class U{constructor(){this.h=this.g=null}add(N,L){const $=B.get();$.set(N,L),this.h?this.h.next=$:this.g=$,this.h=$}}var B=new v(()=>new K,y=>y.reset());class K{constructor(){this.next=this.g=this.h=null}set(N,L){this.h=N,this.g=L,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,H=!1,X=new U,O=()=>{const y=l.Promise.resolve(void 0);ee=()=>{y.then(z)}};var z=()=>{for(var y;y=k();){try{y.h.call(y.g)}catch(L){R(L)}var N=B;N.j(y),100>N.h&&(N.h++,y.next=N.g,N.g=y)}H=!1};function Y(){this.s=this.s,this.C=this.C}Y.prototype.s=!1,Y.prototype.ma=function(){this.s||(this.s=!0,this.N())},Y.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(y,N){this.type=y,this.g=this.target=N,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var ye=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var y=!1,N=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const L=()=>{};l.addEventListener("test",L,N),l.removeEventListener("test",L,N)}catch{}return y}();function Se(y,N){if(F.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y){var L=this.type=y.type,$=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;if(this.target=y.target||y.srcElement,this.g=N,N=y.relatedTarget){if(M){e:{try{I(N.nodeName);var ie=!0;break e}catch{}ie=!1}ie||(N=null)}}else L=="mouseover"?N=y.fromElement:L=="mouseout"&&(N=y.toElement);this.relatedTarget=N,$?(this.clientX=$.clientX!==void 0?$.clientX:$.pageX,this.clientY=$.clientY!==void 0?$.clientY:$.pageY,this.screenX=$.screenX||0,this.screenY=$.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=typeof y.pointerType=="string"?y.pointerType:De[y.pointerType]||"",this.state=y.state,this.i=y,y.defaultPrevented&&Se.aa.h.call(this)}}g(Se,F);var De={2:"touch",3:"pen",4:"mouse"};Se.prototype.h=function(){Se.aa.h.call(this);var y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var xe="closure_listenable_"+(1e6*Math.random()|0),Me=0;function Ye(y,N,L,$,ie){this.listener=y,this.proxy=null,this.src=N,this.type=L,this.capture=!!$,this.ha=ie,this.key=++Me,this.da=this.fa=!1}function qe(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function et(y){this.src=y,this.g={},this.h=0}et.prototype.add=function(y,N,L,$,ie){var pe=y.toString();y=this.g[pe],y||(y=this.g[pe]=[],this.h++);var tt=mt(y,N,$,ie);return-1<tt?(N=y[tt],L||(N.fa=!1)):(N=new Ye(N,this.src,pe,!!$,ie),N.fa=L,y.push(N)),N};function We(y,N){var L=N.type;if(L in y.g){var $=y.g[L],ie=Array.prototype.indexOf.call($,N,void 0),pe;(pe=0<=ie)&&Array.prototype.splice.call($,ie,1),pe&&(qe(N),y.g[L].length==0&&(delete y.g[L],y.h--))}}function mt(y,N,L,$){for(var ie=0;ie<y.length;++ie){var pe=y[ie];if(!pe.da&&pe.listener==N&&pe.capture==!!L&&pe.ha==$)return ie}return-1}var Le="closure_lm_"+(1e6*Math.random()|0),ve={};function Je(y,N,L,$,ie){if($&&$.once)return Gt(y,N,L,$,ie);if(Array.isArray(N)){for(var pe=0;pe<N.length;pe++)Je(y,N[pe],L,$,ie);return null}return L=ne(L),y&&y[xe]?y.K(N,L,u($)?!!$.capture:!!$,ie):Xe(y,N,L,!1,$,ie)}function Xe(y,N,L,$,ie,pe){if(!N)throw Error("Invalid event type");var tt=u(ie)?!!ie.capture:!!ie,jn=fe(y);if(jn||(y[Le]=jn=new et(y)),L=jn.add(N,L,$,tt,pe),L.proxy)return L;if($=kt(),L.proxy=$,$.src=y,$.listener=L,y.addEventListener)ye||(ie=tt),ie===void 0&&(ie=!1),y.addEventListener(N.toString(),$,ie);else if(y.attachEvent)y.attachEvent(ae(N.toString()),$);else if(y.addListener&&y.removeListener)y.addListener($);else throw Error("addEventListener and attachEvent are unavailable.");return L}function kt(){function y(L){return N.call(y.src,y.listener,L)}const N=me;return y}function Gt(y,N,L,$,ie){if(Array.isArray(N)){for(var pe=0;pe<N.length;pe++)Gt(y,N[pe],L,$,ie);return null}return L=ne(L),y&&y[xe]?y.L(N,L,u($)?!!$.capture:!!$,ie):Xe(y,N,L,!0,$,ie)}function fn(y,N,L,$,ie){if(Array.isArray(N))for(var pe=0;pe<N.length;pe++)fn(y,N[pe],L,$,ie);else $=u($)?!!$.capture:!!$,L=ne(L),y&&y[xe]?(y=y.i,N=String(N).toString(),N in y.g&&(pe=y.g[N],L=mt(pe,L,$,ie),-1<L&&(qe(pe[L]),Array.prototype.splice.call(pe,L,1),pe.length==0&&(delete y.g[N],y.h--)))):y&&(y=fe(y))&&(N=y.g[N.toString()],y=-1,N&&(y=mt(N,L,$,ie)),(L=-1<y?N[y]:null)&&sn(L))}function sn(y){if(typeof y!="number"&&y&&!y.da){var N=y.src;if(N&&N[xe])We(N.i,y);else{var L=y.type,$=y.proxy;N.removeEventListener?N.removeEventListener(L,$,y.capture):N.detachEvent?N.detachEvent(ae(L),$):N.addListener&&N.removeListener&&N.removeListener($),(L=fe(N))?(We(L,y),L.h==0&&(L.src=null,N[Le]=null)):qe(y)}}}function ae(y){return y in ve?ve[y]:ve[y]="on"+y}function me(y,N){if(y.da)y=!0;else{N=new Se(N,this);var L=y.listener,$=y.ha||y.src;y.fa&&sn(y),y=L.call($,N)}return y}function fe(y){return y=y[Le],y instanceof et?y:null}var Ne="__closure_events_fn_"+(1e9*Math.random()>>>0);function ne(y){return typeof y=="function"?y:(y[Ne]||(y[Ne]=function(N){return y.handleEvent(N)}),y[Ne])}function de(){Y.call(this),this.i=new et(this),this.M=this,this.F=null}g(de,Y),de.prototype[xe]=!0,de.prototype.removeEventListener=function(y,N,L,$){fn(this,y,N,L,$)};function Ee(y,N){var L,$=y.F;if($)for(L=[];$;$=$.F)L.push($);if(y=y.M,$=N.type||N,typeof N=="string")N=new F(N,y);else if(N instanceof F)N.target=N.target||y;else{var ie=N;N=new F($,y),A(N,ie)}if(ie=!0,L)for(var pe=L.length-1;0<=pe;pe--){var tt=N.g=L[pe];ie=Qe(tt,$,!0,N)&&ie}if(tt=N.g=y,ie=Qe(tt,$,!0,N)&&ie,ie=Qe(tt,$,!1,N)&&ie,L)for(pe=0;pe<L.length;pe++)tt=N.g=L[pe],ie=Qe(tt,$,!1,N)&&ie}de.prototype.N=function(){if(de.aa.N.call(this),this.i){var y=this.i,N;for(N in y.g){for(var L=y.g[N],$=0;$<L.length;$++)qe(L[$]);delete y.g[N],y.h--}}this.F=null},de.prototype.K=function(y,N,L,$){return this.i.add(String(y),N,!1,L,$)},de.prototype.L=function(y,N,L,$){return this.i.add(String(y),N,!0,L,$)};function Qe(y,N,L,$){if(N=y.i.g[String(N)],!N)return!0;N=N.concat();for(var ie=!0,pe=0;pe<N.length;++pe){var tt=N[pe];if(tt&&!tt.da&&tt.capture==L){var jn=tt.listener,Gr=tt.ha||tt.src;tt.fa&&We(y.i,tt),ie=jn.call(Gr,$)!==!1&&ie}}return ie&&!$.defaultPrevented}function re(y,N,L){if(typeof y=="function")L&&(y=f(y,L));else if(y&&typeof y.handleEvent=="function")y=f(y.handleEvent,y);else throw Error("Invalid listener argument");return 2147483647<Number(N)?-1:l.setTimeout(y,N||0)}function Ve(y){y.g=re(()=>{y.g=null,y.i&&(y.i=!1,Ve(y))},y.l);const N=y.h;y.h=null,y.m.apply(null,N)}class Te extends Y{constructor(N,L){super(),this.m=N,this.l=L,this.h=null,this.i=!1,this.g=null}j(N){this.h=arguments,this.g?this.i=!0:Ve(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ut(y){Y.call(this),this.h=y,this.g={}}g(ut,Y);var pt=[];function he(y){j(y.g,function(N,L){this.g.hasOwnProperty(L)&&sn(N)},y),y.g={}}ut.prototype.N=function(){ut.aa.N.call(this),he(this)},ut.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var be=l.JSON.stringify,Fe=l.JSON.parse,Pe=class{stringify(y){return l.JSON.stringify(y,void 0)}parse(y){return l.JSON.parse(y,void 0)}};function Yt(){}Yt.prototype.h=null;function Ht(y){return y.h||(y.h=y.i())}function Tt(){}var yt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ft(){F.call(this,"d")}g(Ft,F);function Sn(){F.call(this,"c")}g(Sn,F);var mn={},xr=null;function Un(){return xr=xr||new de}mn.La="serverreachability";function Xt(y){F.call(this,mn.La,y)}g(Xt,F);function nn(y){const N=Un();Ee(N,new Xt(N))}mn.STAT_EVENT="statevent";function Bn(y,N){F.call(this,mn.STAT_EVENT,y),this.stat=N}g(Bn,F);function q(y){const N=Un();Ee(N,new Bn(N,y))}mn.Ma="timingevent";function te(y,N){F.call(this,mn.Ma,y),this.size=N}g(te,F);function le(y,N){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){y()},N)}function Ie(){this.g=!0}Ie.prototype.xa=function(){this.g=!1};function Oe(y,N,L,$,ie,pe){y.info(function(){if(y.g)if(pe)for(var tt="",jn=pe.split("&"),Gr=0;Gr<jn.length;Gr++){var xn=jn[Gr].split("=");if(1<xn.length){var ss=xn[0];xn=xn[1];var is=ss.split("_");tt=2<=is.length&&is[1]=="type"?tt+(ss+"="+xn+"&"):tt+(ss+"=redacted&")}}else tt=null;else tt=pe;return"XMLHTTP REQ ("+$+") [attempt "+ie+"]: "+N+`
`+L+`
`+tt})}function ht(y,N,L,$,ie,pe,tt){y.info(function(){return"XMLHTTP RESP ("+$+") [ attempt "+ie+"]: "+N+`
`+L+`
`+pe+" "+tt})}function dt(y,N,L,$){y.info(function(){return"XMLHTTP TEXT ("+N+"): "+J(y,L)+($?" "+$:"")})}function W(y,N){y.info(function(){return"TIMEOUT: "+N})}Ie.prototype.info=function(){};function J(y,N){if(!y.g)return N;if(!N)return null;try{var L=JSON.parse(N);if(L){for(y=0;y<L.length;y++)if(Array.isArray(L[y])){var $=L[y];if(!(2>$.length)){var ie=$[1];if(Array.isArray(ie)&&!(1>ie.length)){var pe=ie[0];if(pe!="noop"&&pe!="stop"&&pe!="close")for(var tt=1;tt<ie.length;tt++)ie[tt]=""}}}}return be(L)}catch{return N}}var se={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},G={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},oe;function we(){}g(we,Yt),we.prototype.g=function(){return new XMLHttpRequest},we.prototype.i=function(){return{}},oe=new we;function ke(y,N,L,$){this.j=y,this.i=N,this.l=L,this.R=$||1,this.U=new ut(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ue}function Ue(){this.i=null,this.g="",this.h=!1}var _e={},Q={};function Z(y,N,L){y.L=1,y.v=Ag(ei(N)),y.m=L,y.P=!0,ue(y,null)}function ue(y,N){y.F=Date.now(),je(y),y.A=ei(y.v);var L=y.A,$=y.R;Array.isArray($)||($=[String($)]),pA(L.i,"t",$),y.C=0,L=y.j.J,y.h=new Ue,y.g=jA(y.j,L?N:null,!y.m),0<y.O&&(y.M=new Te(f(y.Y,y,y.g),y.O)),N=y.U,L=y.g,$=y.ca;var ie="readystatechange";Array.isArray(ie)||(ie&&(pt[0]=ie.toString()),ie=pt);for(var pe=0;pe<ie.length;pe++){var tt=Je(L,ie[pe],$||N.handleEvent,!1,N.h||N);if(!tt)break;N.g[tt.key]=tt}N=y.H?T(y.H):{},y.m?(y.u||(y.u="POST"),N["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.A,y.u,y.m,N)):(y.u="GET",y.g.ea(y.A,y.u,null,N)),nn(),Oe(y.i,y.u,y.A,y.l,y.R,y.m)}ke.prototype.ca=function(y){y=y.target;const N=this.M;N&&Xo(y)==3?N.j():this.Y(y)},ke.prototype.Y=function(y){try{if(y==this.g)e:{const is=Xo(this.g);var N=this.g.Ba();const Gu=this.g.Z();if(!(3>is)&&(is!=3||this.g&&(this.h.h||this.g.oa()||bA(this.g)))){this.J||is!=4||N==7||(N==8||0>=Gu?nn(3):nn(2)),ot(this);var L=this.g.Z();this.X=L;t:if(ge(this)){var $=bA(this.g);y="";var ie=$.length,pe=Xo(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Qt(this),Nt(this);var tt="";break t}this.h.i=new l.TextDecoder}for(N=0;N<ie;N++)this.h.h=!0,y+=this.h.i.decode($[N],{stream:!(pe&&N==ie-1)});$.length=0,this.h.g+=y,this.C=0,tt=this.h.g}else tt=this.g.oa();if(this.o=L==200,ht(this.i,this.u,this.A,this.l,this.R,is,L),this.o){if(this.T&&!this.K){t:{if(this.g){var jn,Gr=this.g;if((jn=Gr.g?Gr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(jn)){var xn=jn;break t}}xn=null}if(L=xn)dt(this.i,this.l,L,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,vt(this,L);else{this.o=!1,this.s=3,q(12),Qt(this),Nt(this);break e}}if(this.P){L=!0;let Ki;for(;!this.J&&this.C<tt.length;)if(Ki=Ae(this,tt),Ki==Q){is==4&&(this.s=4,q(14),L=!1),dt(this.i,this.l,null,"[Incomplete Response]");break}else if(Ki==_e){this.s=4,q(15),dt(this.i,this.l,tt,"[Invalid Chunk]"),L=!1;break}else dt(this.i,this.l,Ki,null),vt(this,Ki);if(ge(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),is!=4||tt.length!=0||this.h.h||(this.s=1,q(16),L=!1),this.o=this.o&&L,!L)dt(this.i,this.l,tt,"[Invalid Chunked Response]"),Qt(this),Nt(this);else if(0<tt.length&&!this.W){this.W=!0;var ss=this.j;ss.g==this&&ss.ba&&!ss.M&&(ss.j.info("Great, no buffering proxy detected. Bytes received: "+tt.length),M_(ss),ss.M=!0,q(11))}}else dt(this.i,this.l,tt,null),vt(this,tt);is==4&&Qt(this),this.o&&!this.J&&(is==4?PA(this.j,this):(this.o=!1,je(this)))}else XW(this.g),L==400&&0<tt.indexOf("Unknown SID")?(this.s=3,q(12)):(this.s=0,q(13)),Qt(this),Nt(this)}}}catch{}finally{}};function ge(y){return y.g?y.u=="GET"&&y.L!=2&&y.j.Ca:!1}function Ae(y,N){var L=y.C,$=N.indexOf(`
`,L);return $==-1?Q:(L=Number(N.substring(L,$)),isNaN(L)?_e:($+=1,$+L>N.length?Q:(N=N.slice($,$+L),y.C=$+L,N)))}ke.prototype.cancel=function(){this.J=!0,Qt(this)};function je(y){y.S=Date.now()+y.I,it(y,y.I)}function it(y,N){if(y.B!=null)throw Error("WatchDog timer not null");y.B=le(f(y.ba,y),N)}function ot(y){y.B&&(l.clearTimeout(y.B),y.B=null)}ke.prototype.ba=function(){this.B=null;const y=Date.now();0<=y-this.S?(W(this.i,this.A),this.L!=2&&(nn(),q(17)),Qt(this),this.s=2,Nt(this)):it(this,this.S-y)};function Nt(y){y.j.G==0||y.J||PA(y.j,y)}function Qt(y){ot(y);var N=y.M;N&&typeof N.ma=="function"&&N.ma(),y.M=null,he(y.U),y.g&&(N=y.g,y.g=null,N.abort(),N.ma())}function vt(y,N){try{var L=y.j;if(L.G!=0&&(L.g==y||lr(L.h,y))){if(!y.K&&lr(L.h,y)&&L.G==3){try{var $=L.Da.g.parse(N)}catch{$=null}if(Array.isArray($)&&$.length==3){var ie=$;if(ie[0]==0){e:if(!L.u){if(L.g)if(L.g.F+3e3<y.F)Lg(L),Dg(L);else break e;D_(L),q(18)}}else L.za=ie[1],0<L.za-L.T&&37500>ie[2]&&L.F&&L.v==0&&!L.C&&(L.C=le(f(L.Za,L),6e3));if(1>=an(L.h)&&L.ca){try{L.ca()}catch{}L.ca=void 0}}else yc(L,11)}else if((y.K||L.g==y)&&Lg(L),!_(N))for(ie=L.Da.g.parse(N),N=0;N<ie.length;N++){let xn=ie[N];if(L.T=xn[0],xn=xn[1],L.G==2)if(xn[0]=="c"){L.K=xn[1],L.ia=xn[2];const ss=xn[3];ss!=null&&(L.la=ss,L.j.info("VER="+L.la));const is=xn[4];is!=null&&(L.Aa=is,L.j.info("SVER="+L.Aa));const Gu=xn[5];Gu!=null&&typeof Gu=="number"&&0<Gu&&($=1.5*Gu,L.L=$,L.j.info("backChannelRequestTimeoutMs_="+$)),$=L;const Ki=y.g;if(Ki){const Og=Ki.g?Ki.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Og){var pe=$.h;pe.g||Og.indexOf("spdy")==-1&&Og.indexOf("quic")==-1&&Og.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(_s(pe,pe.h),pe.h=null))}if($.D){const L_=Ki.g?Ki.g.getResponseHeader("X-HTTP-Session-Id"):null;L_&&($.ya=L_,Pn($.I,$.D,L_))}}L.G=3,L.l&&L.l.ua(),L.ba&&(L.R=Date.now()-y.F,L.j.info("Handshake RTT: "+L.R+"ms")),$=L;var tt=y;if($.qa=kA($,$.J?$.ia:null,$.W),tt.K){ft($.h,tt);var jn=tt,Gr=$.L;Gr&&(jn.I=Gr),jn.B&&(ot(jn),je(jn)),$.g=tt}else IA($);0<L.i.length&&Mg(L)}else xn[0]!="stop"&&xn[0]!="close"||yc(L,7);else L.G==3&&(xn[0]=="stop"||xn[0]=="close"?xn[0]=="stop"?yc(L,7):j_(L):xn[0]!="noop"&&L.l&&L.l.ta(xn),L.v=0)}}nn(4)}catch{}}var on=class{constructor(y,N){this.g=y,this.map=N}};function Nr(y){this.l=y||10,l.PerformanceNavigationTiming?(y=l.performance.getEntriesByType("navigation"),y=0<y.length&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Pt(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function an(y){return y.h?1:y.g?y.g.size:0}function lr(y,N){return y.h?y.h==N:y.g?y.g.has(N):!1}function _s(y,N){y.g?y.g.add(N):y.h=N}function ft(y,N){y.h&&y.h==N?y.h=null:y.g&&y.g.has(N)&&y.g.delete(N)}Nr.prototype.cancel=function(){if(this.i=vn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function vn(y){if(y.h!=null)return y.i.concat(y.h.D);if(y.g!=null&&y.g.size!==0){let N=y.i;for(const L of y.g.values())N=N.concat(L.D);return N}return x(y.i)}function bs(y){if(y.V&&typeof y.V=="function")return y.V();if(typeof Map<"u"&&y instanceof Map||typeof Set<"u"&&y instanceof Set)return Array.from(y.values());if(typeof y=="string")return y.split("");if(c(y)){for(var N=[],L=y.length,$=0;$<L;$++)N.push(y[$]);return N}N=[],L=0;for($ in y)N[L++]=y[$];return N}function vr(y){if(y.na&&typeof y.na=="function")return y.na();if(!y.V||typeof y.V!="function"){if(typeof Map<"u"&&y instanceof Map)return Array.from(y.keys());if(!(typeof Set<"u"&&y instanceof Set)){if(c(y)||typeof y=="string"){var N=[];y=y.length;for(var L=0;L<y;L++)N.push(L);return N}N=[],L=0;for(const $ in y)N[L++]=$;return N}}}function At(y,N){if(y.forEach&&typeof y.forEach=="function")y.forEach(N,void 0);else if(c(y)||typeof y=="string")Array.prototype.forEach.call(y,N,void 0);else for(var L=vr(y),$=bs(y),ie=$.length,pe=0;pe<ie;pe++)N.call(void 0,$[pe],L&&L[pe],y)}var _t=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ln(y,N){if(y){y=y.split("&");for(var L=0;L<y.length;L++){var $=y[L].indexOf("="),ie=null;if(0<=$){var pe=y[L].substring(0,$);ie=y[L].substring($+1)}else pe=y[L];N(pe,ie?decodeURIComponent(ie.replace(/\+/g," ")):"")}}}function kn(y){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,y instanceof kn){this.h=y.h,wo(this,y.j),this.o=y.o,this.g=y.g,Ci(this,y.s),this.l=y.l;var N=y.i,L=new lf;L.i=N.i,N.g&&(L.g=new Map(N.g),L.h=N.h),Ti(this,L),this.m=y.m}else y&&(N=String(y).match(_t))?(this.h=!1,wo(this,N[1]||"",!0),this.o=of(N[2]||""),this.g=of(N[3]||"",!0),Ci(this,N[4]),this.l=of(N[5]||"",!0),Ti(this,N[6]||"",!0),this.m=of(N[7]||"")):(this.h=!1,this.i=new lf(null,this.h))}kn.prototype.toString=function(){var y=[],N=this.j;N&&y.push(af(N,hA,!0),":");var L=this.g;return(L||N=="file")&&(y.push("//"),(N=this.o)&&y.push(af(N,hA,!0),"@"),y.push(encodeURIComponent(String(L)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L=this.s,L!=null&&y.push(":",String(L))),(L=this.l)&&(this.g&&L.charAt(0)!="/"&&y.push("/"),y.push(af(L,L.charAt(0)=="/"?UW:$W,!0))),(L=this.i.toString())&&y.push("?",L),(L=this.m)&&y.push("#",af(L,zW)),y.join("")};function ei(y){return new kn(y)}function wo(y,N,L){y.j=L?of(N,!0):N,y.j&&(y.j=y.j.replace(/:$/,""))}function Ci(y,N){if(N){if(N=Number(N),isNaN(N)||0>N)throw Error("Bad port number "+N);y.s=N}else y.s=null}function Ti(y,N,L){N instanceof lf?(y.i=N,GW(y.i,y.h)):(L||(N=af(N,BW)),y.i=new lf(N,y.h))}function Pn(y,N,L){y.i.set(N,L)}function Ag(y){return Pn(y,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),y}function of(y,N){return y?N?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function af(y,N,L){return typeof y=="string"?(y=encodeURI(y).replace(N,VW),L&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function VW(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var hA=/[#\/\?@]/g,$W=/[#\?:]/g,UW=/[#\?]/g,BW=/[#\?@]/g,zW=/#/g;function lf(y,N){this.h=this.g=null,this.i=y||null,this.j=!!N}function Va(y){y.g||(y.g=new Map,y.h=0,y.i&&ln(y.i,function(N,L){y.add(decodeURIComponent(N.replace(/\+/g," ")),L)}))}t=lf.prototype,t.add=function(y,N){Va(this),this.i=null,y=Bu(this,y);var L=this.g.get(y);return L||this.g.set(y,L=[]),L.push(N),this.h+=1,this};function fA(y,N){Va(y),N=Bu(y,N),y.g.has(N)&&(y.i=null,y.h-=y.g.get(N).length,y.g.delete(N))}function mA(y,N){return Va(y),N=Bu(y,N),y.g.has(N)}t.forEach=function(y,N){Va(this),this.g.forEach(function(L,$){L.forEach(function(ie){y.call(N,ie,$,this)},this)},this)},t.na=function(){Va(this);const y=Array.from(this.g.values()),N=Array.from(this.g.keys()),L=[];for(let $=0;$<N.length;$++){const ie=y[$];for(let pe=0;pe<ie.length;pe++)L.push(N[$])}return L},t.V=function(y){Va(this);let N=[];if(typeof y=="string")mA(this,y)&&(N=N.concat(this.g.get(Bu(this,y))));else{y=Array.from(this.g.values());for(let L=0;L<y.length;L++)N=N.concat(y[L])}return N},t.set=function(y,N){return Va(this),this.i=null,y=Bu(this,y),mA(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[N]),this.h+=1,this},t.get=function(y,N){return y?(y=this.V(y),0<y.length?String(y[0]):N):N};function pA(y,N,L){fA(y,N),0<L.length&&(y.i=null,y.g.set(Bu(y,N),x(L)),y.h+=L.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],N=Array.from(this.g.keys());for(var L=0;L<N.length;L++){var $=N[L];const pe=encodeURIComponent(String($)),tt=this.V($);for($=0;$<tt.length;$++){var ie=pe;tt[$]!==""&&(ie+="="+encodeURIComponent(String(tt[$]))),y.push(ie)}}return this.i=y.join("&")};function Bu(y,N){return N=String(N),y.j&&(N=N.toLowerCase()),N}function GW(y,N){N&&!y.j&&(Va(y),y.i=null,y.g.forEach(function(L,$){var ie=$.toLowerCase();$!=ie&&(fA(this,$),pA(this,ie,L))},y)),y.j=N}function HW(y,N){const L=new Ie;if(l.Image){const $=new Image;$.onload=m($a,L,"TestLoadImage: loaded",!0,N,$),$.onerror=m($a,L,"TestLoadImage: error",!1,N,$),$.onabort=m($a,L,"TestLoadImage: abort",!1,N,$),$.ontimeout=m($a,L,"TestLoadImage: timeout",!1,N,$),l.setTimeout(function(){$.ontimeout&&$.ontimeout()},1e4),$.src=y}else N(!1)}function WW(y,N){const L=new Ie,$=new AbortController,ie=setTimeout(()=>{$.abort(),$a(L,"TestPingServer: timeout",!1,N)},1e4);fetch(y,{signal:$.signal}).then(pe=>{clearTimeout(ie),pe.ok?$a(L,"TestPingServer: ok",!0,N):$a(L,"TestPingServer: server error",!1,N)}).catch(()=>{clearTimeout(ie),$a(L,"TestPingServer: error",!1,N)})}function $a(y,N,L,$,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),$(L)}catch{}}function qW(){this.g=new Pe}function KW(y,N,L){const $=L||"";try{At(y,function(ie,pe){let tt=ie;u(ie)&&(tt=be(ie)),N.push($+pe+"="+encodeURIComponent(tt))})}catch(ie){throw N.push($+"type="+encodeURIComponent("_badmap")),ie}}function Rg(y){this.l=y.Ub||null,this.j=y.eb||!1}g(Rg,Yt),Rg.prototype.g=function(){return new kg(this.l,this.j)},Rg.prototype.i=function(y){return function(){return y}}({});function kg(y,N){de.call(this),this.D=y,this.o=N,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(kg,de),t=kg.prototype,t.open=function(y,N){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=y,this.A=N,this.readyState=1,uf(this)},t.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const N={headers:this.u,method:this.B,credentials:this.m,cache:void 0};y&&(N.body=y),(this.D||l).fetch(new Request(this.A,N)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,cf(this)),this.readyState=0},t.Sa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,uf(this)),this.g&&(this.readyState=3,uf(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;gA(this)}else y.text().then(this.Ra.bind(this),this.ga.bind(this))};function gA(y){y.j.read().then(y.Pa.bind(y)).catch(y.ga.bind(y))}t.Pa=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var N=y.value?y.value:new Uint8Array(0);(N=this.v.decode(N,{stream:!y.done}))&&(this.response=this.responseText+=N)}y.done?cf(this):uf(this),this.readyState==3&&gA(this)}},t.Ra=function(y){this.g&&(this.response=this.responseText=y,cf(this))},t.Qa=function(y){this.g&&(this.response=y,cf(this))},t.ga=function(){this.g&&cf(this)};function cf(y){y.readyState=4,y.l=null,y.j=null,y.v=null,uf(y)}t.setRequestHeader=function(y,N){this.u.append(y,N)},t.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],N=this.h.entries();for(var L=N.next();!L.done;)L=L.value,y.push(L[0]+": "+L[1]),L=N.next();return y.join(`\r
`)};function uf(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(kg.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function yA(y){let N="";return j(y,function(L,$){N+=$,N+=":",N+=L,N+=`\r
`}),N}function k_(y,N,L){e:{for($ in L){var $=!1;break e}$=!0}$||(L=yA(L),typeof y=="string"?L!=null&&encodeURIComponent(String(L)):Pn(y,N,L))}function cr(y){de.call(this),this.headers=new Map,this.o=y||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(cr,de);var YW=/^https?$/i,JW=["POST","PUT"];t=cr.prototype,t.Ha=function(y){this.J=y},t.ea=function(y,N,L,$){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);N=N?N.toUpperCase():"GET",this.D=y,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():oe.g(),this.v=this.o?Ht(this.o):Ht(oe),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(N,String(y),!0),this.B=!1}catch(pe){xA(this,pe);return}if(y=L||"",L=new Map(this.headers),$)if(Object.getPrototypeOf($)===Object.prototype)for(var ie in $)L.set(ie,$[ie]);else if(typeof $.keys=="function"&&typeof $.get=="function")for(const pe of $.keys())L.set(pe,$.get(pe));else throw Error("Unknown input type for opt_headers: "+String($));$=Array.from(L.keys()).find(pe=>pe.toLowerCase()=="content-type"),ie=l.FormData&&y instanceof l.FormData,!(0<=Array.prototype.indexOf.call(JW,N,void 0))||$||ie||L.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,tt]of L)this.g.setRequestHeader(pe,tt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{_A(this),this.u=!0,this.g.send(y),this.u=!1}catch(pe){xA(this,pe)}};function xA(y,N){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=N,y.m=5,vA(y),jg(y)}function vA(y){y.A||(y.A=!0,Ee(y,"complete"),Ee(y,"error"))}t.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=y||7,Ee(this,"complete"),Ee(this,"abort"),jg(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),jg(this,!0)),cr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?wA(this):this.bb())},t.bb=function(){wA(this)};function wA(y){if(y.h&&typeof o<"u"&&(!y.v[1]||Xo(y)!=4||y.Z()!=2)){if(y.u&&Xo(y)==4)re(y.Ea,0,y);else if(Ee(y,"readystatechange"),Xo(y)==4){y.h=!1;try{const tt=y.Z();e:switch(tt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var N=!0;break e;default:N=!1}var L;if(!(L=N)){var $;if($=tt===0){var ie=String(y.D).match(_t)[1]||null;!ie&&l.self&&l.self.location&&(ie=l.self.location.protocol.slice(0,-1)),$=!YW.test(ie?ie.toLowerCase():"")}L=$}if(L)Ee(y,"complete"),Ee(y,"success");else{y.m=6;try{var pe=2<Xo(y)?y.g.statusText:""}catch{pe=""}y.l=pe+" ["+y.Z()+"]",vA(y)}}finally{jg(y)}}}}function jg(y,N){if(y.g){_A(y);const L=y.g,$=y.v[0]?()=>{}:null;y.g=null,y.v=null,N||Ee(y,"ready");try{L.onreadystatechange=$}catch{}}}function _A(y){y.I&&(l.clearTimeout(y.I),y.I=null)}t.isActive=function(){return!!this.g};function Xo(y){return y.g?y.g.readyState:0}t.Z=function(){try{return 2<Xo(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(y){if(this.g){var N=this.g.responseText;return y&&N.indexOf(y)==0&&(N=N.substring(y.length)),Fe(N)}};function bA(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.H){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function XW(y){const N={};y=(y.g&&2<=Xo(y)&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let $=0;$<y.length;$++){if(_(y[$]))continue;var L=D(y[$]);const ie=L[0];if(L=L[1],typeof L!="string")continue;L=L.trim();const pe=N[ie]||[];N[ie]=pe,pe.push(L)}C(N,function($){return $.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function df(y,N,L){return L&&L.internalChannelParams&&L.internalChannelParams[y]||N}function SA(y){this.Aa=0,this.i=[],this.j=new Ie,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=df("failFast",!1,y),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=df("baseRetryDelayMs",5e3,y),this.cb=df("retryDelaySeedMs",1e4,y),this.Wa=df("forwardChannelMaxRetries",2,y),this.wa=df("forwardChannelRequestTimeoutMs",2e4,y),this.pa=y&&y.xmlHttpFactory||void 0,this.Xa=y&&y.Tb||void 0,this.Ca=y&&y.useFetchStreams||!1,this.L=void 0,this.J=y&&y.supportsCrossDomainXhr||!1,this.K="",this.h=new Nr(y&&y.concurrentRequestLimit),this.Da=new qW,this.P=y&&y.fastHandshake||!1,this.O=y&&y.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=y&&y.Rb||!1,y&&y.xa&&this.j.xa(),y&&y.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&y&&y.detectBufferingProxy||!1,this.ja=void 0,y&&y.longPollingTimeout&&0<y.longPollingTimeout&&(this.ja=y.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=SA.prototype,t.la=8,t.G=1,t.connect=function(y,N,L,$){q(0),this.W=y,this.H=N||{},L&&$!==void 0&&(this.H.OSID=L,this.H.OAID=$),this.F=this.X,this.I=kA(this,null,this.W),Mg(this)};function j_(y){if(EA(y),y.G==3){var N=y.U++,L=ei(y.I);if(Pn(L,"SID",y.K),Pn(L,"RID",N),Pn(L,"TYPE","terminate"),hf(y,L),N=new ke(y,y.j,N),N.L=2,N.v=Ag(ei(L)),L=!1,l.navigator&&l.navigator.sendBeacon)try{L=l.navigator.sendBeacon(N.v.toString(),"")}catch{}!L&&l.Image&&(new Image().src=N.v,L=!0),L||(N.g=jA(N.j,null),N.g.ea(N.v)),N.F=Date.now(),je(N)}RA(y)}function Dg(y){y.g&&(M_(y),y.g.cancel(),y.g=null)}function EA(y){Dg(y),y.u&&(l.clearTimeout(y.u),y.u=null),Lg(y),y.h.cancel(),y.s&&(typeof y.s=="number"&&l.clearTimeout(y.s),y.s=null)}function Mg(y){if(!Pt(y.h)&&!y.s){y.s=!0;var N=y.Ga;ee||O(),H||(ee(),H=!0),X.add(N,y),y.B=0}}function QW(y,N){return an(y.h)>=y.h.j-(y.s?1:0)?!1:y.s?(y.i=N.D.concat(y.i),!0):y.G==1||y.G==2||y.B>=(y.Va?0:y.Wa)?!1:(y.s=le(f(y.Ga,y,N),AA(y,y.B)),y.B++,!0)}t.Ga=function(y){if(this.s)if(this.s=null,this.G==1){if(!y){this.U=Math.floor(1e5*Math.random()),y=this.U++;const ie=new ke(this,this.j,y);let pe=this.o;if(this.S&&(pe?(pe=T(pe),A(pe,this.S)):pe=this.S),this.m!==null||this.O||(ie.H=pe,pe=null),this.P)e:{for(var N=0,L=0;L<this.i.length;L++){t:{var $=this.i[L];if("__data__"in $.map&&($=$.map.__data__,typeof $=="string")){$=$.length;break t}$=void 0}if($===void 0)break;if(N+=$,4096<N){N=L;break e}if(N===4096||L===this.i.length-1){N=L+1;break e}}N=1e3}else N=1e3;N=TA(this,ie,N),L=ei(this.I),Pn(L,"RID",y),Pn(L,"CVER",22),this.D&&Pn(L,"X-HTTP-Session-Id",this.D),hf(this,L),pe&&(this.O?N="headers="+encodeURIComponent(String(yA(pe)))+"&"+N:this.m&&k_(L,this.m,pe)),_s(this.h,ie),this.Ua&&Pn(L,"TYPE","init"),this.P?(Pn(L,"$req",N),Pn(L,"SID","null"),ie.T=!0,Z(ie,L,null)):Z(ie,L,N),this.G=2}}else this.G==3&&(y?CA(this,y):this.i.length==0||Pt(this.h)||CA(this))};function CA(y,N){var L;N?L=N.l:L=y.U++;const $=ei(y.I);Pn($,"SID",y.K),Pn($,"RID",L),Pn($,"AID",y.T),hf(y,$),y.m&&y.o&&k_($,y.m,y.o),L=new ke(y,y.j,L,y.B+1),y.m===null&&(L.H=y.o),N&&(y.i=N.D.concat(y.i)),N=TA(y,L,1e3),L.I=Math.round(.5*y.wa)+Math.round(.5*y.wa*Math.random()),_s(y.h,L),Z(L,$,N)}function hf(y,N){y.H&&j(y.H,function(L,$){Pn(N,$,L)}),y.l&&At({},function(L,$){Pn(N,$,L)})}function TA(y,N,L){L=Math.min(y.i.length,L);var $=y.l?f(y.l.Na,y.l,y):null;e:{var ie=y.i;let pe=-1;for(;;){const tt=["count="+L];pe==-1?0<L?(pe=ie[0].g,tt.push("ofs="+pe)):pe=0:tt.push("ofs="+pe);let jn=!0;for(let Gr=0;Gr<L;Gr++){let xn=ie[Gr].g;const ss=ie[Gr].map;if(xn-=pe,0>xn)pe=Math.max(0,ie[Gr].g-100),jn=!1;else try{KW(ss,tt,"req"+xn+"_")}catch{$&&$(ss)}}if(jn){$=tt.join("&");break e}}}return y=y.i.splice(0,L),N.D=y,$}function IA(y){if(!y.g&&!y.u){y.Y=1;var N=y.Fa;ee||O(),H||(ee(),H=!0),X.add(N,y),y.v=0}}function D_(y){return y.g||y.u||3<=y.v?!1:(y.Y++,y.u=le(f(y.Fa,y),AA(y,y.v)),y.v++,!0)}t.Fa=function(){if(this.u=null,NA(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var y=2*this.R;this.j.info("BP detection timer enabled: "+y),this.A=le(f(this.ab,this),y)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,q(10),Dg(this),NA(this))};function M_(y){y.A!=null&&(l.clearTimeout(y.A),y.A=null)}function NA(y){y.g=new ke(y,y.j,"rpc",y.Y),y.m===null&&(y.g.H=y.o),y.g.O=0;var N=ei(y.qa);Pn(N,"RID","rpc"),Pn(N,"SID",y.K),Pn(N,"AID",y.T),Pn(N,"CI",y.F?"0":"1"),!y.F&&y.ja&&Pn(N,"TO",y.ja),Pn(N,"TYPE","xmlhttp"),hf(y,N),y.m&&y.o&&k_(N,y.m,y.o),y.L&&(y.g.I=y.L);var L=y.g;y=y.ia,L.L=1,L.v=Ag(ei(N)),L.m=null,L.P=!0,ue(L,y)}t.Za=function(){this.C!=null&&(this.C=null,Dg(this),D_(this),q(19))};function Lg(y){y.C!=null&&(l.clearTimeout(y.C),y.C=null)}function PA(y,N){var L=null;if(y.g==N){Lg(y),M_(y),y.g=null;var $=2}else if(lr(y.h,N))L=N.D,ft(y.h,N),$=1;else return;if(y.G!=0){if(N.o)if($==1){L=N.m?N.m.length:0,N=Date.now()-N.F;var ie=y.B;$=Un(),Ee($,new te($,L)),Mg(y)}else IA(y);else if(ie=N.s,ie==3||ie==0&&0<N.X||!($==1&&QW(y,N)||$==2&&D_(y)))switch(L&&0<L.length&&(N=y.h,N.i=N.i.concat(L)),ie){case 1:yc(y,5);break;case 4:yc(y,10);break;case 3:yc(y,6);break;default:yc(y,2)}}}function AA(y,N){let L=y.Ta+Math.floor(Math.random()*y.cb);return y.isActive()||(L*=2),L*N}function yc(y,N){if(y.j.info("Error code "+N),N==2){var L=f(y.fb,y),$=y.Xa;const ie=!$;$=new kn($||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||wo($,"https"),Ag($),ie?HW($.toString(),L):WW($.toString(),L)}else q(2);y.G=0,y.l&&y.l.sa(N),RA(y),EA(y)}t.fb=function(y){y?(this.j.info("Successfully pinged google.com"),q(2)):(this.j.info("Failed to ping google.com"),q(1))};function RA(y){if(y.G=0,y.ka=[],y.l){const N=vn(y.h);(N.length!=0||y.i.length!=0)&&(E(y.ka,N),E(y.ka,y.i),y.h.i.length=0,x(y.i),y.i.length=0),y.l.ra()}}function kA(y,N,L){var $=L instanceof kn?ei(L):new kn(L);if($.g!="")N&&($.g=N+"."+$.g),Ci($,$.s);else{var ie=l.location;$=ie.protocol,N=N?N+"."+ie.hostname:ie.hostname,ie=+ie.port;var pe=new kn(null);$&&wo(pe,$),N&&(pe.g=N),ie&&Ci(pe,ie),L&&(pe.l=L),$=pe}return L=y.D,N=y.ya,L&&N&&Pn($,L,N),Pn($,"VER",y.la),hf(y,$),$}function jA(y,N,L){if(N&&!y.J)throw Error("Can't create secondary domain capable XhrIo object.");return N=y.Ca&&!y.pa?new cr(new Rg({eb:L})):new cr(y.pa),N.Ha(y.J),N}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function DA(){}t=DA.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Fg(){}Fg.prototype.g=function(y,N){return new ti(y,N)};function ti(y,N){de.call(this),this.g=new SA(N),this.l=y,this.h=N&&N.messageUrlParams||null,y=N&&N.messageHeaders||null,N&&N.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=N&&N.initMessageHeaders||null,N&&N.messageContentType&&(y?y["X-WebChannel-Content-Type"]=N.messageContentType:y={"X-WebChannel-Content-Type":N.messageContentType}),N&&N.va&&(y?y["X-WebChannel-Client-Profile"]=N.va:y={"X-WebChannel-Client-Profile":N.va}),this.g.S=y,(y=N&&N.Sb)&&!_(y)&&(this.g.m=y),this.v=N&&N.supportsCrossDomainXhr||!1,this.u=N&&N.sendRawJson||!1,(N=N&&N.httpSessionIdParam)&&!_(N)&&(this.g.D=N,y=this.h,y!==null&&N in y&&(y=this.h,N in y&&delete y[N])),this.j=new zu(this)}g(ti,de),ti.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ti.prototype.close=function(){j_(this.g)},ti.prototype.o=function(y){var N=this.g;if(typeof y=="string"){var L={};L.__data__=y,y=L}else this.u&&(L={},L.__data__=be(y),y=L);N.i.push(new on(N.Ya++,y)),N.G==3&&Mg(N)},ti.prototype.N=function(){this.g.l=null,delete this.j,j_(this.g),delete this.g,ti.aa.N.call(this)};function MA(y){Ft.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var N=y.__sm__;if(N){e:{for(const L in N){y=L;break e}y=void 0}(this.i=y)&&(y=this.i,N=N!==null&&y in N?N[y]:void 0),this.data=N}else this.data=y}g(MA,Ft);function LA(){Sn.call(this),this.status=1}g(LA,Sn);function zu(y){this.g=y}g(zu,DA),zu.prototype.ua=function(){Ee(this.g,"a")},zu.prototype.ta=function(y){Ee(this.g,new MA(y))},zu.prototype.sa=function(y){Ee(this.g,new LA)},zu.prototype.ra=function(){Ee(this.g,"b")},Fg.prototype.createWebChannel=Fg.prototype.g,ti.prototype.send=ti.prototype.o,ti.prototype.open=ti.prototype.m,ti.prototype.close=ti.prototype.close,lz=function(){return new Fg},az=function(){return Un()},oz=mn,jC={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},se.NO_ERROR=0,se.TIMEOUT=8,se.HTTP_ERROR=6,Tx=se,G.COMPLETE="complete",iz=G,Tt.EventType=yt,yt.OPEN="a",yt.CLOSE="b",yt.ERROR="c",yt.MESSAGE="d",de.prototype.listen=de.prototype.K,nm=Tt,cr.prototype.listenOnce=cr.prototype.L,cr.prototype.getLastError=cr.prototype.Ka,cr.prototype.getLastErrorCode=cr.prototype.Ba,cr.prototype.getStatus=cr.prototype.Z,cr.prototype.getResponseJson=cr.prototype.Oa,cr.prototype.getResponseText=cr.prototype.oa,cr.prototype.send=cr.prototype.ea,cr.prototype.setWithCredentials=cr.prototype.Ha,sz=cr}).apply(typeof Ay<"u"?Ay:typeof self<"u"?self:typeof window<"u"?window:{});const eM="@firebase/firestore",tM="4.7.16";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Yr.UNAUTHENTICATED=new Yr(null),Yr.GOOGLE_CREDENTIALS=new Yr("google-credentials-uid"),Yr.FIRST_PARTY=new Yr("first-party-uid"),Yr.MOCK_USER=new Yr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xh="11.8.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gu=new pN("@firebase/firestore");function hd(){return gu.logLevel}function Be(t,...e){if(gu.logLevel<=dn.DEBUG){const n=e.map(CN);gu.debug(`Firestore (${Xh}): ${t}`,...n)}}function Is(t,...e){if(gu.logLevel<=dn.ERROR){const n=e.map(CN);gu.error(`Firestore (${Xh}): ${t}`,...n)}}function yu(t,...e){if(gu.logLevel<=dn.WARN){const n=e.map(CN);gu.warn(`Firestore (${Xh}): ${t}`,...n)}}function CN(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,cz(t,r,n)}function cz(t,e,n){let r=`FIRESTORE (${Xh}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Is(r),new Error(r)}function Et(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||cz(e,s,r)}function qt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class at extends vo{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uz{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class oye{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Yr.UNAUTHENTICATED))}shutdown(){}}class aye{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class lye{constructor(e){this.t=e,this.currentUser=Yr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Et(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new ma;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ma,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Be("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ma)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Et(typeof r.accessToken=="string",31837,{l:r}),new uz(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Et(e===null||typeof e=="string",2055,{h:e}),new Yr(e)}}class cye{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Yr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class uye{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new cye(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Yr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class nM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dye{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Bs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Et(this.o===void 0,3512);const r=i=>{i.error!=null&&Be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Be("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new nM(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Et(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new nM(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hye(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dz(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hz{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=hye(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Ot(t,e){return t<e?-1:t>e?1:0}function DC(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return Ot(r,s);{const i=dz(),o=fye(i.encode(rM(t,n)),i.encode(rM(e,n)));return o!==0?o:Ot(r,s)}}n+=r>65535?2:1}return Ot(t.length,e.length)}function rM(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function fye(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return Ot(t[n],e[n]);return Ot(t.length,e.length)}function Sh(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function fz(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sM=-62135596800,iM=1e6;class ir{static now(){return ir.fromMillis(Date.now())}static fromDate(e){return ir.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*iM);return new ir(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new at(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new at(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<sM)throw new at(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new at(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/iM}_compareTo(e){return this.seconds===e.seconds?Ot(this.nanoseconds,e.nanoseconds):Ot(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-sM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{static fromTimestamp(e){return new Rt(e)}static min(){return new Rt(new ir(0,0))}static max(){return new Rt(new ir(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oM="__name__";class Io{constructor(e,n,r){n===void 0?n=0:n>e.length&&xt(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&xt(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Io.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Io?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Io.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Ot(e.length,n.length)}static compareSegments(e,n){const r=Io.isNumericId(e),s=Io.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Io.extractNumericId(e).compare(Io.extractNumericId(n)):DC(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Rl.fromString(e.substring(4,e.length-2))}}class En extends Io{construct(e,n,r){return new En(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new at(Ce.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new En(n)}static emptyPath(){return new En([])}}const mye=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rr extends Io{construct(e,n,r){return new rr(e,n,r)}static isValidIdentifier(e){return mye.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===oM}static keyField(){return new rr([oM])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new at(Ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new at(Ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new at(Ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new at(Ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new rr(n)}static emptyPath(){return new rr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e){this.path=e}static fromPath(e){return new lt(En.fromString(e))}static fromName(e){return new lt(En.fromString(e).popFirst(5))}static empty(){return new lt(En.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&En.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return En.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new lt(new En(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp=-1;class Kv{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function MC(t){return t.fields.find(e=>e.kind===2)}function Ic(t){return t.fields.filter(e=>e.kind!==2)}Kv.UNKNOWN_ID=-1;class Ix{constructor(e,n){this.fieldPath=e,this.kind=n}}class wp{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new wp(0,vi.min())}}function pye(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Rt.fromTimestamp(r===1e9?new ir(n+1,0):new ir(n,r));return new vi(s,lt.empty(),e)}function mz(t){return new vi(t.readTime,t.key,vp)}class vi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new vi(Rt.min(),lt.empty(),vp)}static max(){return new vi(Rt.max(),lt.empty(),vp)}}function TN(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=lt.comparator(t.documentKey,e.documentKey),n!==0?n:Ot(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pz="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gz{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Du(t){if(t.code!==Ce.FAILED_PRECONDITION||t.message!==pz)throw t;Be("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&xt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ce((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ce?n:ce.resolve(n)}catch(n){return ce.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ce.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ce.reject(n)}static resolve(e){return new ce((n,r)=>{n(e)})}static reject(e){return new ce((n,r)=>{r(e)})}static waitFor(e){return new ce((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=ce.resolve(!1);for(const r of e)n=n.next(s=>s?ce.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new ce((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new ce((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li="SimpleDb";class B0{static open(e,n,r,s){try{return new B0(n,e.transaction(s,r))}catch(i){throw new Am(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new ma,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Am(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=IN(r.target.error);this.S.reject(new Am(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Be(li,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new yye(n)}}class kl{static delete(e){return Be(li,"Removing database:",e),Mc(cB().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!yB())return!1;if(kl.F())return!0;const e=Dr(),n=kl.M(e),r=0<n&&n<10,s=yz(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.B=r,this.L=null,kl.M(Dr())===12.2&&Is("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(Be(li,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Am(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new at(Ce.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new at(Ce.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Am(e,o))},s.onupgradeneeded=i=>{Be(li,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;if(this.L!==null&&this.L!==i.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${i.oldVersion}, event.newVersion=${i.newVersion}, db.version=${o.version}`);this.B.q(o,s.transaction,i.oldVersion,this.version).next(()=>{Be(li,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",n=>{const r=n.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=n=>this.$(n)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const l=B0.open(this.db,e,i?"readonly":"readwrite",r),c=s(l).next(u=>(l.v(),u)).catch(u=>(l.abort(u),ce.reject(u))).toPromise();return c.catch(()=>{}),await l.D,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(Be(li,"Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function yz(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class gye{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return Mc(this.K.delete())}}class Am extends at{constructor(e,n){super(Ce.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function fc(t){return t.name==="IndexedDbTransactionError"}class yye{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Be(li,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(Be(li,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Mc(r)}add(e){return Be(li,"ADD",this.store.name,e,e),Mc(this.store.add(e))}get(e){return Mc(this.store.get(e)).next(n=>(n===void 0&&(n=null),Be(li,"GET",this.store.name,e,n),n))}delete(e){return Be(li,"DELETE",this.store.name,e),Mc(this.store.delete(e))}count(){return Be(li,"COUNT",this.store.name),Mc(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new ce((o,l)=>{i.onerror=c=>{l(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.Y(i,(l,c)=>{o.push(c)}).next(()=>o)}}Z(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new ce((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}X(e,n){Be(li,"DELETE ALL",this.store.name);const r=this.options(e,n);r.ee=!1;const s=this.cursor(r);return this.Y(s,(i,o,l)=>l.delete())}te(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.Y(s,n)}ne(e){const n=this.cursor({});return new ce((r,s)=>{n.onerror=i=>{const o=IN(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():r()}):r()}})}Y(e,n){const r=[];return new ce((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const c=new gye(l),u=n(l.primaryKey,l.value,c);if(u instanceof ce){const d=u.catch(h=>(c.done(),ce.reject(h)));r.push(d)}c.isDone?s():c.j===null?l.continue():l.continue(c.j)}}).next(()=>ce.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Mc(t){return new ce((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=IN(r.target.error);n(s)}})}let aM=!1;function IN(t){const e=kl.M(Dr());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new at("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return aM||(aM=!0,setTimeout(()=>{throw r},0)),r}}return t}const Rm="IndexBackfiller";class xye{constructor(e,n){this.asyncQueue=e,this.re=n,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){Be(Rm,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.re.se();Be(Rm,`Documents written: ${n}`)}catch(n){fc(n)?Be(Rm,"Ignoring IndexedDB error during index backfill: ",n):await Du(n)}await this.ie(6e4)})}}class vye{constructor(e,n){this.localStore=e,this.persistence=n}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.oe(n,e))}oe(e,n){const r=new Set;let s=n,i=!0;return ce.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Be(Rm,`Processing collection: ${o}`),this._e(e,o,s).next(l=>{s-=l,r.add(o)});i=!1})).next(()=>n-s)}_e(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ae(s,i)).next(l=>(Be(Rm,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,n,l))).next(()=>o.size)}))}ae(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=mz(i);TN(o,r)>0&&(r=o)}),new vi(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>n.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Li.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qc=-1;function z0(t){return t==null}function _p(t){return t===0&&1/t==-1/0}function wye(t){return typeof t=="number"&&Number.isInteger(t)&&!_p(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yv="";function ps(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=lM(e)),e=_ye(t.get(n),e);return lM(e)}function _ye(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Yv:n+="";break;default:n+=i}}return n}function lM(t){return t+Yv+""}function Ro(t){const e=t.length;if(Et(e>=2,64408,{path:t}),e===2)return Et(t.charAt(0)===Yv&&t.charAt(1)==="",56145,{path:t}),En.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(Yv,i);switch((o<0||o>n)&&xt(50515,{path:t}),t.charAt(o+1)){case"":const l=t.substring(i,o);let c;s.length===0?c=l:(s+=l,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:xt(61167,{path:t})}i=o+2}return new En(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc="remoteDocuments",gg="owner",ed="owner",bp="mutationQueues",bye="userId",no="mutations",cM="batchId",qc="userMutationsIndex",uM=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nx(t,e){return[t,ps(e)]}function xz(t,e,n){return[t,ps(e),n]}const Sye={},Eh="documentMutations",Jv="remoteDocumentsV14",Eye=["prefixPath","collectionGroup","readTime","documentId"],Px="documentKeyIndex",Cye=["prefixPath","collectionGroup","documentId"],vz="collectionGroupIndex",Tye=["collectionGroup","readTime","prefixPath","documentId"],Sp="remoteDocumentGlobal",LC="remoteDocumentGlobalKey",Ch="targets",wz="queryTargetsIndex",Iye=["canonicalId","targetId"],Th="targetDocuments",Nye=["targetId","path"],NN="documentTargetsIndex",Pye=["path","targetId"],Xv="targetGlobalKey",Zc="targetGlobal",Ep="collectionParents",Aye=["collectionId","parent"],Ih="clientMetadata",Rye="clientId",G0="bundles",kye="bundleId",H0="namedQueries",jye="name",PN="indexConfiguration",Dye="indexId",FC="collectionGroupIndex",Mye="collectionGroup",km="indexState",Lye=["indexId","uid"],_z="sequenceNumberIndex",Fye=["uid","sequenceNumber"],jm="indexEntries",Oye=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],bz="documentKeyIndex",Vye=["indexId","uid","orderedDocumentKey"],W0="documentOverlays",$ye=["userId","collectionPath","documentId"],OC="collectionPathOverlayIndex",Uye=["userId","collectionPath","largestBatchId"],Sz="collectionGroupOverlayIndex",Bye=["userId","collectionGroup","largestBatchId"],AN="globals",zye="name",Ez=[bp,no,Eh,Nc,Ch,gg,Zc,Th,Ih,Sp,Ep,G0,H0],Gye=[...Ez,W0],Cz=[bp,no,Eh,Jv,Ch,gg,Zc,Th,Ih,Sp,Ep,G0,H0,W0],Tz=Cz,RN=[...Tz,PN,km,jm],Hye=RN,Iz=[...RN,AN],Wye=Iz;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC extends gz{constructor(e,n){super(),this.he=e,this.currentSequenceNumber=n}}function Lr(t,e){const n=qt(t);return kl.N(n.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dM(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function mc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Nz(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e,n){this.comparator=e,this.root=n||Jr.EMPTY}insert(e,n){return new Qn(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Jr.BLACK,null,null))}remove(e){return new Qn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Jr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ry(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ry(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ry(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ry(this.root,e,this.comparator,!0)}}class Ry{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Jr{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Jr.RED,this.left=s??Jr.EMPTY,this.right=i??Jr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Jr(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Jr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Jr.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Jr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Jr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw xt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw xt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw xt(27949);return e+(this.isRed()?0:1)}}Jr.EMPTY=null,Jr.RED=!0,Jr.BLACK=!1;Jr.EMPTY=new class{constructor(){this.size=0}get key(){throw xt(57766)}get value(){throw xt(16141)}get color(){throw xt(16727)}get left(){throw xt(29726)}get right(){throw xt(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Jr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.comparator=e,this.data=new Qn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new hM(this.data.getIterator())}getIteratorFrom(e){return new hM(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Nn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Nn(this.comparator);return n.data=e,n}}class hM{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function td(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e){this.fields=e,e.sort(rr.comparator)}static empty(){return new Hs([])}unionWith(e){let n=new Nn(rr.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Hs(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Sh(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pz extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Pz("Invalid base64 string: "+i):i}}(e);return new Ir(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Ir(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ot(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ir.EMPTY_BYTE_STRING=new Ir("");const qye=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ia(t){if(Et(!!t,39018),typeof t=="string"){let e=0;const n=qye.exec(t);if(Et(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Kn(t.seconds),nanos:Kn(t.nanos)}}function Kn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Na(t){return typeof t=="string"?Ir.fromBase64String(t):Ir.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Az="server_timestamp",Rz="__type__",kz="__previous_value__",jz="__local_write_time__";function kN(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[Rz])===null||n===void 0?void 0:n.stringValue)===Az}function q0(t){const e=t.mapValue.fields[kz];return kN(e)?q0(e):e}function Cp(t){const e=Ia(t.mapValue.fields[jz].timestampValue);return new ir(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kye{constructor(e,n,r,s,i,o,l,c,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=d}}const Qv="(default)";class xu{constructor(e,n){this.projectId=e,this.database=n||Qv}static empty(){return new xu("","")}get isDefaultDatabase(){return this.database===Qv}isEqual(e){return e instanceof xu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jN="__type__",Dz="__max__",gl={mapValue:{fields:{__type__:{stringValue:Dz}}}},DN="__vector__",Nh="value",Ax={nullValue:"NULL_VALUE"};function Gl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?kN(t)?4:Mz(t)?9007199254740991:K0(t)?10:11:xt(28295,{value:t})}function Ho(t,e){if(t===e)return!0;const n=Gl(t);if(n!==Gl(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Cp(t).isEqual(Cp(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ia(s.timestampValue),l=Ia(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Na(s.bytesValue).isEqual(Na(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Kn(s.geoPointValue.latitude)===Kn(i.geoPointValue.latitude)&&Kn(s.geoPointValue.longitude)===Kn(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Kn(s.integerValue)===Kn(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Kn(s.doubleValue),l=Kn(i.doubleValue);return o===l?_p(o)===_p(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Sh(t.arrayValue.values||[],e.arrayValue.values||[],Ho);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(dM(o)!==dM(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Ho(o[c],l[c])))return!1;return!0}(t,e);default:return xt(52216,{left:t})}}function Tp(t,e){return(t.values||[]).find(n=>Ho(n,e))!==void 0}function Hl(t,e){if(t===e)return 0;const n=Gl(t),r=Gl(e);if(n!==r)return Ot(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ot(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Kn(i.integerValue||i.doubleValue),c=Kn(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return fM(t.timestampValue,e.timestampValue);case 4:return fM(Cp(t),Cp(e));case 5:return DC(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Na(i),c=Na(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Ot(l[u],c[u]);if(d!==0)return d}return Ot(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Ot(Kn(i.latitude),Kn(o.latitude));return l!==0?l:Ot(Kn(i.longitude),Kn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return mM(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const h=i.fields||{},f=o.fields||{},m=(l=h[Nh])===null||l===void 0?void 0:l.arrayValue,g=(c=f[Nh])===null||c===void 0?void 0:c.arrayValue,x=Ot(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((d=g==null?void 0:g.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:mM(m,g)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===gl.mapValue&&o===gl.mapValue)return 0;if(i===gl.mapValue)return 1;if(o===gl.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){const f=DC(c[h],d[h]);if(f!==0)return f;const m=Hl(l[c[h]],u[d[h]]);if(m!==0)return m}return Ot(c.length,d.length)}(t.mapValue,e.mapValue);default:throw xt(23264,{Pe:n})}}function fM(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ot(t,e);const n=Ia(t),r=Ia(e),s=Ot(n.seconds,r.seconds);return s!==0?s:Ot(n.nanos,r.nanos)}function mM(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Hl(n[s],r[s]);if(i)return i}return Ot(n.length,r.length)}function Ph(t){return $C(t)}function $C(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ia(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Na(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return lt.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=$C(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${$C(n.fields[o])}`;return s+"}"}(t.mapValue):xt(61005,{value:t})}function Rx(t){switch(Gl(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=q0(t);return e?16+Rx(e):16;case 5:return 2*t.stringValue.length;case 6:return Na(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Rx(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return mc(r.fields,(i,o)=>{s+=i.length+Rx(o)}),s}(t.mapValue);default:throw xt(13486,{value:t})}}function Ip(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function UC(t){return!!t&&"integerValue"in t}function Np(t){return!!t&&"arrayValue"in t}function pM(t){return!!t&&"nullValue"in t}function gM(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function kx(t){return!!t&&"mapValue"in t}function K0(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[jN])===null||n===void 0?void 0:n.stringValue)===DN}function Dm(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return mc(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Dm(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Dm(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Mz(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Dz}const Lz={mapValue:{fields:{[jN]:{stringValue:DN},[Nh]:{arrayValue:{}}}}};function Yye(t){return"nullValue"in t?Ax:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Ip(xu.empty(),lt.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?K0(t)?Lz:{mapValue:{}}:xt(35942,{value:t})}function Jye(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Ip(xu.empty(),lt.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?Lz:"mapValue"in t?K0(t)?{mapValue:{}}:gl:xt(61959,{value:t})}function yM(t,e){const n=Hl(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function xM(t,e){const n=Hl(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e){this.value=e}static empty(){return new ms({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!kx(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dm(n)}setAll(e){let n=rr.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Dm(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());kx(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ho(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];kx(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){mc(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new ms(Dm(this.value))}}function Fz(t){const e=[];return mc(t.fields,(n,r)=>{const s=new rr([n]);if(kx(r)){const i=Fz(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Hs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new dr(e,0,Rt.min(),Rt.min(),Rt.min(),ms.empty(),0)}static newFoundDocument(e,n,r,s){return new dr(e,1,n,Rt.min(),r,s,0)}static newNoDocument(e,n){return new dr(e,2,n,Rt.min(),Rt.min(),ms.empty(),0)}static newUnknownDocument(e,n){return new dr(e,3,n,Rt.min(),Rt.min(),ms.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Rt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ms.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ms.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Rt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof dr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new dr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e,n){this.position=e,this.inclusive=n}}function vM(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=lt.comparator(lt.fromName(o.referenceValue),n.key):r=Hl(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function wM(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ho(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(e,n="asc"){this.field=e,this.dir=n}}function Xye(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oz{}class hn extends Oz{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Qye(e,n,r):n==="array-contains"?new txe(e,r):n==="in"?new Gz(e,r):n==="not-in"?new nxe(e,r):n==="array-contains-any"?new rxe(e,r):new hn(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Zye(e,r):new exe(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Hl(n,this.value)):n!==null&&Gl(this.value)===Gl(n)&&this.matchesComparison(Hl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return xt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Tn extends Oz{constructor(e,n){super(),this.filters=e,this.op=n,this.Te=null}static create(e,n){return new Tn(e,n)}matches(e){return Rh(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function Rh(t){return t.op==="and"}function BC(t){return t.op==="or"}function MN(t){return Vz(t)&&Rh(t)}function Vz(t){for(const e of t.filters)if(e instanceof Tn)return!1;return!0}function zC(t){if(t instanceof hn)return t.field.canonicalString()+t.op.toString()+Ph(t.value);if(MN(t))return t.filters.map(e=>zC(e)).join(",");{const e=t.filters.map(n=>zC(n)).join(",");return`${t.op}(${e})`}}function $z(t,e){return t instanceof hn?function(r,s){return s instanceof hn&&r.op===s.op&&r.field.isEqual(s.field)&&Ho(r.value,s.value)}(t,e):t instanceof Tn?function(r,s){return s instanceof Tn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&$z(o,s.filters[l]),!0):!1}(t,e):void xt(19439)}function Uz(t,e){const n=t.filters.concat(e);return Tn.create(n,t.op)}function Bz(t){return t instanceof hn?function(n){return`${n.field.canonicalString()} ${n.op} ${Ph(n.value)}`}(t):t instanceof Tn?function(n){return n.op.toString()+" {"+n.getFilters().map(Bz).join(" ,")+"}"}(t):"Filter"}class Qye extends hn{constructor(e,n,r){super(e,n,r),this.key=lt.fromName(r.referenceValue)}matches(e){const n=lt.comparator(e.key,this.key);return this.matchesComparison(n)}}class Zye extends hn{constructor(e,n){super(e,"in",n),this.keys=zz("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class exe extends hn{constructor(e,n){super(e,"not-in",n),this.keys=zz("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function zz(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>lt.fromName(r.referenceValue))}class txe extends hn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Np(n)&&Tp(n.arrayValue,this.value)}}class Gz extends hn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Tp(this.value.arrayValue,n)}}class nxe extends hn{constructor(e,n){super(e,"not-in",n)}matches(e){if(Tp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Tp(this.value.arrayValue,n)}}class rxe extends hn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Np(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Tp(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sxe{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Ie=null}}function GC(t,e=null,n=[],r=[],s=null,i=null,o=null){return new sxe(t,e,n,r,s,i,o)}function vu(t){const e=qt(t);if(e.Ie===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>zC(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),z0(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ph(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ph(r)).join(",")),e.Ie=n}return e.Ie}function yg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Xye(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!$z(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!wM(t.startAt,e.startAt)&&wM(t.endAt,e.endAt)}function ew(t){return lt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function tw(t,e){return t.filters.filter(n=>n instanceof hn&&n.field.isEqual(e))}function _M(t,e,n){let r=Ax,s=!0;for(const i of tw(t,e)){let o=Ax,l=!0;switch(i.op){case"<":case"<=":o=Yye(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=Ax}yM({value:r,inclusive:s},{value:o,inclusive:l})<0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];yM({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function bM(t,e,n){let r=gl,s=!0;for(const i of tw(t,e)){let o=gl,l=!0;switch(i.op){case">=":case">":o=Jye(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=gl}xM({value:r,inclusive:s},{value:o,inclusive:l})>0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];xM({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function ixe(t,e,n,r,s,i,o,l){return new xg(t,e,n,r,s,i,o,l)}function Y0(t){return new xg(t)}function SM(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Hz(t){return t.collectionGroup!==null}function Mm(t){const e=qt(t);if(e.Ee===null){e.Ee=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ee.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Nn(rr.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ee.push(new Zv(i,r))}),n.has(rr.keyField().canonicalString())||e.Ee.push(new Zv(rr.keyField(),r))}return e.Ee}function Vi(t){const e=qt(t);return e.de||(e.de=oxe(e,Mm(t))),e.de}function oxe(t,e){if(t.limitType==="F")return GC(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Zv(s.field,i)});const n=t.endAt?new Ah(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ah(t.startAt.position,t.startAt.inclusive):null;return GC(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function HC(t,e){const n=t.filters.concat([e]);return new xg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function nw(t,e,n){return new xg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function J0(t,e){return yg(Vi(t),Vi(e))&&t.limitType===e.limitType}function Wz(t){return`${vu(Vi(t))}|lt:${t.limitType}`}function fd(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Bz(s)).join(", ")}]`),z0(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Ph(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Ph(s)).join(",")),`Target(${r})`}(Vi(t))}; limitType=${t.limitType})`}function vg(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):lt.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Mm(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=vM(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,Mm(r),s)||r.endAt&&!function(o,l,c){const u=vM(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,Mm(r),s))}(t,e)}function axe(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function qz(t){return(e,n)=>{let r=!1;for(const s of Mm(t)){const i=lxe(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function lxe(t,e,n){const r=t.field.isKeyField()?lt.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Hl(c,u):xt(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return xt(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){mc(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Nz(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cxe=new Qn(lt.comparator);function hi(){return cxe}const Kz=new Qn(lt.comparator);function rm(...t){let e=Kz;for(const n of t)e=e.insert(n.key,n);return e}function Yz(t){let e=Kz;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ko(){return Lm()}function Jz(){return Lm()}function Lm(){return new La(t=>t.toString(),(t,e)=>t.isEqual(e))}const uxe=new Qn(lt.comparator),dxe=new Nn(lt.comparator);function tn(...t){let e=dxe;for(const n of t)e=e.add(n);return e}const hxe=new Nn(Ot);function fxe(){return hxe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LN(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_p(e)?"-0":e}}function Xz(t){return{integerValue:""+t}}function mxe(t,e){return wye(e)?Xz(e):LN(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(){this._=void 0}}function pxe(t,e,n){return t instanceof Pp?function(s,i){const o={fields:{[Rz]:{stringValue:Az},[jz]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&kN(i)&&(i=q0(i)),i&&(o.fields[kz]=i),{mapValue:o}}(n,e):t instanceof kh?Zz(t,e):t instanceof jh?e9(t,e):function(s,i){const o=Qz(s,i),l=EM(o)+EM(s.Re);return UC(o)&&UC(s.Re)?Xz(l):LN(s.serializer,l)}(t,e)}function gxe(t,e,n){return t instanceof kh?Zz(t,e):t instanceof jh?e9(t,e):n}function Qz(t,e){return t instanceof Ap?function(r){return UC(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Pp extends X0{}class kh extends X0{constructor(e){super(),this.elements=e}}function Zz(t,e){const n=t9(e);for(const r of t.elements)n.some(s=>Ho(s,r))||n.push(r);return{arrayValue:{values:n}}}class jh extends X0{constructor(e){super(),this.elements=e}}function e9(t,e){let n=t9(e);for(const r of t.elements)n=n.filter(s=>!Ho(s,r));return{arrayValue:{values:n}}}class Ap extends X0{constructor(e,n){super(),this.serializer=e,this.Re=n}}function EM(t){return Kn(t.integerValue||t.doubleValue)}function t9(t){return Np(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yxe{constructor(e,n){this.field=e,this.transform=n}}function xxe(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof kh&&s instanceof kh||r instanceof jh&&s instanceof jh?Sh(r.elements,s.elements,Ho):r instanceof Ap&&s instanceof Ap?Ho(r.Re,s.Re):r instanceof Pp&&s instanceof Pp}(t.transform,e.transform)}class vxe{constructor(e,n){this.version=e,this.transformResults=n}}class Ps{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ps}static exists(e){return new Ps(void 0,e)}static updateTime(e){return new Ps(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function jx(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Q0{}function n9(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Z0(t.key,Ps.none()):new Qh(t.key,t.data,Ps.none());{const n=t.data,r=ms.empty();let s=new Nn(rr.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Fa(t.key,r,new Hs(s.toArray()),Ps.none())}}function wxe(t,e,n){t instanceof Qh?function(s,i,o){const l=s.value.clone(),c=TM(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Fa?function(s,i,o){if(!jx(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=TM(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(r9(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Fm(t,e,n,r){return t instanceof Qh?function(i,o,l,c){if(!jx(i.precondition,o))return l;const u=i.value.clone(),d=IM(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Fa?function(i,o,l,c){if(!jx(i.precondition,o))return l;const u=IM(i.fieldTransforms,c,o),d=o.data;return d.setAll(r9(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,o,l){return jx(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function _xe(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Qz(r.transform,s||null);i!=null&&(n===null&&(n=ms.empty()),n.set(r.field,i))}return n||null}function CM(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Sh(r,s,(i,o)=>xxe(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Qh extends Q0{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Fa extends Q0{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function r9(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function TM(t,e,n){const r=new Map;Et(t.length===n.length,32656,{Ve:n.length,me:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,gxe(o,l,n[s]))}return r}function IM(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,pxe(i,o,e))}return r}class Z0 extends Q0{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class s9 extends Q0{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&wxe(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Fm(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Fm(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Jz();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=n9(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(Rt.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),tn())}isEqual(e){return this.batchId===e.batchId&&Sh(this.mutations,e.mutations,(n,r)=>CM(n,r))&&Sh(this.baseMutations,e.baseMutations,(n,r)=>CM(n,r))}}class ON{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Et(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let s=function(){return uxe}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new ON(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bxe{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wr,pn;function Sxe(t){switch(t){case Ce.OK:return xt(64938);case Ce.CANCELLED:case Ce.UNKNOWN:case Ce.DEADLINE_EXCEEDED:case Ce.RESOURCE_EXHAUSTED:case Ce.INTERNAL:case Ce.UNAVAILABLE:case Ce.UNAUTHENTICATED:return!1;case Ce.INVALID_ARGUMENT:case Ce.NOT_FOUND:case Ce.ALREADY_EXISTS:case Ce.PERMISSION_DENIED:case Ce.FAILED_PRECONDITION:case Ce.ABORTED:case Ce.OUT_OF_RANGE:case Ce.UNIMPLEMENTED:case Ce.DATA_LOSS:return!0;default:return xt(15467,{code:t})}}function i9(t){if(t===void 0)return Is("GRPC error has no .code"),Ce.UNKNOWN;switch(t){case wr.OK:return Ce.OK;case wr.CANCELLED:return Ce.CANCELLED;case wr.UNKNOWN:return Ce.UNKNOWN;case wr.DEADLINE_EXCEEDED:return Ce.DEADLINE_EXCEEDED;case wr.RESOURCE_EXHAUSTED:return Ce.RESOURCE_EXHAUSTED;case wr.INTERNAL:return Ce.INTERNAL;case wr.UNAVAILABLE:return Ce.UNAVAILABLE;case wr.UNAUTHENTICATED:return Ce.UNAUTHENTICATED;case wr.INVALID_ARGUMENT:return Ce.INVALID_ARGUMENT;case wr.NOT_FOUND:return Ce.NOT_FOUND;case wr.ALREADY_EXISTS:return Ce.ALREADY_EXISTS;case wr.PERMISSION_DENIED:return Ce.PERMISSION_DENIED;case wr.FAILED_PRECONDITION:return Ce.FAILED_PRECONDITION;case wr.ABORTED:return Ce.ABORTED;case wr.OUT_OF_RANGE:return Ce.OUT_OF_RANGE;case wr.UNIMPLEMENTED:return Ce.UNIMPLEMENTED;case wr.DATA_LOSS:return Ce.DATA_LOSS;default:return xt(39323,{code:t})}}(pn=wr||(wr={}))[pn.OK=0]="OK",pn[pn.CANCELLED=1]="CANCELLED",pn[pn.UNKNOWN=2]="UNKNOWN",pn[pn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pn[pn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pn[pn.NOT_FOUND=5]="NOT_FOUND",pn[pn.ALREADY_EXISTS=6]="ALREADY_EXISTS",pn[pn.PERMISSION_DENIED=7]="PERMISSION_DENIED",pn[pn.UNAUTHENTICATED=16]="UNAUTHENTICATED",pn[pn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pn[pn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pn[pn.ABORTED=10]="ABORTED",pn[pn.OUT_OF_RANGE=11]="OUT_OF_RANGE",pn[pn.UNIMPLEMENTED=12]="UNIMPLEMENTED",pn[pn.INTERNAL=13]="INTERNAL",pn[pn.UNAVAILABLE=14]="UNAVAILABLE",pn[pn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Exe=new Rl([4294967295,4294967295],0);function NM(t){const e=dz().encode(t),n=new rz;return n.update(e),new Uint8Array(n.digest())}function PM(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Rl([n,r],0),new Rl([s,i],0)]}class $N{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new sm(`Invalid padding: ${n}`);if(r<0)throw new sm(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new sm(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new sm(`Invalid padding when bitmap length is 0: ${n}`);this.pe=8*e.length-n,this.ye=Rl.fromNumber(this.pe)}we(e,n,r){let s=e.add(n.multiply(Rl.fromNumber(r)));return s.compare(Exe)===1&&(s=new Rl([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}Se(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const n=NM(e),[r,s]=PM(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);if(!this.Se(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new $N(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.pe===0)return;const n=NM(e),[r,s]=PM(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class sm extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,wg.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new e_(Rt.min(),s,new Qn(Ot),hi(),tn())}}class wg{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new wg(r,n,tn(),tn(),tn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(e,n,r,s){this.De=e,this.removedTargetIds=n,this.key=r,this.ve=s}}class o9{constructor(e,n){this.targetId=e,this.Ce=n}}class a9{constructor(e,n,r=Ir.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class AM{constructor(){this.Fe=0,this.Me=RM(),this.xe=Ir.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=tn(),n=tn(),r=tn();return this.Me.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:xt(38017,{changeType:i})}}),new wg(this.xe,this.Oe,e,n,r)}Qe(){this.Ne=!1,this.Me=RM()}$e(e,n){this.Ne=!0,this.Me=this.Me.insert(e,n)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Et(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class Cxe{constructor(e){this.ze=e,this.je=new Map,this.He=hi(),this.Je=ky(),this.Ye=ky(),this.Ze=new Qn(Ot)}Xe(e){for(const n of e.De)e.ve&&e.ve.isFoundDocument()?this.et(n,e.ve):this.tt(n,e.key,e.ve);for(const n of e.removedTargetIds)this.tt(n,e.key,e.ve)}nt(e){this.forEachTarget(e,n=>{const r=this.rt(n);switch(e.state){case 0:this.it(n)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(n);break;case 3:this.it(n)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(n)&&(this.st(n),r.ke(e.resumeToken));break;default:xt(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.je.forEach((r,s)=>{this.it(s)&&n(s)})}ot(e){const n=e.targetId,r=e.Ce.count,s=this._t(n);if(s){const i=s.target;if(ew(i))if(r===0){const o=new lt(i.path);this.tt(n,o,dr.newNoDocument(o,Rt.min()))}else Et(r===1,20013,{expectedCount:r});else{const o=this.ut(n);if(o!==r){const l=this.ct(e),c=l?this.lt(l,e,o):1;if(c!==0){this.st(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,u)}}}}}ct(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=Na(r).toUint8Array()}catch(c){if(c instanceof Pz)return yu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new $N(o,s,i)}catch(c){return yu(c instanceof sm?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.pe===0?null:l}lt(e,n,r){return n.Ce.count===r-this.Tt(e,n.targetId)?0:2}Tt(e,n){const r=this.ze.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.ze.Pt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.tt(n,i,null),s++)}),s}It(e){const n=new Map;this.je.forEach((i,o)=>{const l=this._t(o);if(l){if(i.current&&ew(l.target)){const c=new lt(l.target.path);this.Et(c).has(o)||this.dt(o,c)||this.tt(o,c,dr.newNoDocument(c,e))}i.Le&&(n.set(o,i.qe()),i.Qe())}});let r=tn();this.Ye.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this._t(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.He.forEach((i,o)=>o.setReadTime(e));const s=new e_(e,n,this.Ze,this.He,r);return this.He=hi(),this.Je=ky(),this.Ye=ky(),this.Ze=new Qn(Ot),s}et(e,n){if(!this.it(e))return;const r=this.dt(e,n.key)?2:0;this.rt(e).$e(n.key,r),this.He=this.He.insert(n.key,n),this.Je=this.Je.insert(n.key,this.Et(n.key).add(e)),this.Ye=this.Ye.insert(n.key,this.At(n.key).add(e))}tt(e,n,r){if(!this.it(e))return;const s=this.rt(e);this.dt(e,n)?s.$e(n,1):s.Ue(n),this.Ye=this.Ye.insert(n,this.At(n).delete(e)),this.Ye=this.Ye.insert(n,this.At(n).add(e)),r&&(this.He=this.He.insert(n,r))}removeTarget(e){this.je.delete(e)}ut(e){const n=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let n=this.je.get(e);return n||(n=new AM,this.je.set(e,n)),n}At(e){let n=this.Ye.get(e);return n||(n=new Nn(Ot),this.Ye=this.Ye.insert(e,n)),n}Et(e){let n=this.Je.get(e);return n||(n=new Nn(Ot),this.Je=this.Je.insert(e,n)),n}it(e){const n=this._t(e)!==null;return n||Be("WatchChangeAggregator","Detected inactive target",e),n}_t(e){const n=this.je.get(e);return n&&n.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new AM),this.ze.getRemoteKeysForTarget(e).forEach(n=>{this.tt(e,n,null)})}dt(e,n){return this.ze.getRemoteKeysForTarget(e).has(n)}}function ky(){return new Qn(lt.comparator)}function RM(){return new Qn(lt.comparator)}const Txe=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Ixe=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Nxe=(()=>({and:"AND",or:"OR"}))();class Pxe{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function WC(t,e){return t.useProto3Json||z0(e)?e:{value:e}}function Dh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function l9(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Axe(t,e){return Dh(t,e.toTimestamp())}function Rs(t){return Et(!!t,49232),Rt.fromTimestamp(function(n){const r=Ia(n);return new ir(r.seconds,r.nanos)}(t))}function UN(t,e){return qC(t,e).canonicalString()}function qC(t,e){const n=function(s){return new En(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function c9(t){const e=En.fromString(t);return Et(x9(e),10190,{key:e.toString()}),e}function rw(t,e){return UN(t.databaseId,e.path)}function eu(t,e){const n=c9(e);if(n.get(1)!==t.databaseId.projectId)throw new at(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new at(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new lt(h9(n))}function u9(t,e){return UN(t.databaseId,e)}function d9(t){const e=c9(t);return e.length===4?En.emptyPath():h9(e)}function KC(t){return new En(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function h9(t){return Et(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function kM(t,e,n){return{name:rw(t,e),fields:n.value.mapValue.fields}}function Rxe(t,e,n){const r=eu(t,e.name),s=Rs(e.updateTime),i=e.createTime?Rs(e.createTime):Rt.min(),o=new ms({mapValue:{fields:e.fields}}),l=dr.newFoundDocument(r,s,i,o);return n&&l.setHasCommittedMutations(),n?l.setHasCommittedMutations():l}function kxe(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:xt(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Et(d===void 0||typeof d=="string",58123),Ir.fromBase64String(d||"")):(Et(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ir.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?Ce.UNKNOWN:i9(u.code);return new at(d,u.message||"")}(o);n=new a9(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=eu(t,r.document.name),i=Rs(r.document.updateTime),o=r.document.createTime?Rs(r.document.createTime):Rt.min(),l=new ms({mapValue:{fields:r.document.fields}}),c=dr.newFoundDocument(s,i,o,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Dx(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=eu(t,r.document),i=r.readTime?Rs(r.readTime):Rt.min(),o=dr.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Dx([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=eu(t,r.document),i=r.removedTargetIds||[];n=new Dx([],i,s,null)}else{if(!("filter"in e))return xt(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new bxe(s,i),l=r.targetId;n=new o9(l,o)}}return n}function sw(t,e){let n;if(e instanceof Qh)n={update:kM(t,e.key,e.value)};else if(e instanceof Z0)n={delete:rw(t,e.key)};else if(e instanceof Fa)n={update:kM(t,e.key,e.data),updateMask:Oxe(e.fieldMask)};else{if(!(e instanceof s9))return xt(16599,{ft:e.type});n={verify:rw(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Pp)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof kh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof jh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ap)return{fieldPath:o.field.canonicalString(),increment:l.Re};throw xt(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Axe(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:xt(27497)}(t,e.precondition)),n}function YC(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Ps.updateTime(Rs(i.updateTime)):i.exists!==void 0?Ps.exists(i.exists):Ps.none()}(e.currentDocument):Ps.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,l){let c=null;if("setToServerValue"in l)Et(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),c=new Pp;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new kh(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new jh(d)}else"increment"in l?c=new Ap(o,l.increment):xt(16584,{proto:l});const u=rr.fromServerFormat(l.fieldPath);return new yxe(u,c)}(t,s)):[];if(e.update){e.update.name;const s=eu(t,e.update.name),i=new ms({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new Hs(u.map(d=>rr.fromServerFormat(d)))}(e.updateMask);return new Fa(s,i,o,n,r)}return new Qh(s,i,n,r)}if(e.delete){const s=eu(t,e.delete);return new Z0(s,n)}if(e.verify){const s=eu(t,e.verify);return new s9(s,n)}return xt(1463,{proto:e})}function jxe(t,e){return t&&t.length>0?(Et(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Rs(s.updateTime):Rs(i);return o.isEqual(Rt.min())&&(o=Rs(i)),new vxe(o,s.transformResults||[])}(n,e))):[]}function f9(t,e){return{documents:[u9(t,e.path)]}}function m9(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=u9(t,s);const i=function(u){if(u.length!==0)return y9(Tn.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(f){return{field:md(f.field),direction:Mxe(f.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=WC(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{gt:n,parent:s}}function p9(t){let e=d9(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Et(r===1,65062);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(h){const f=g9(h);return f instanceof Tn&&MN(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(g){return new Zv(pd(g.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(f))}(n.orderBy));let l=null;n.limit&&(l=function(h){let f;return f=typeof h=="object"?h.value:h,z0(f)?null:f}(n.limit));let c=null;n.startAt&&(c=function(h){const f=!!h.before,m=h.values||[];return new Ah(m,f)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const f=!h.before,m=h.values||[];return new Ah(m,f)}(n.endAt)),ixe(e,s,o,i,l,"F",c,u)}function Dxe(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xt(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function g9(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=pd(n.unaryFilter.field);return hn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=pd(n.unaryFilter.field);return hn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=pd(n.unaryFilter.field);return hn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=pd(n.unaryFilter.field);return hn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return xt(61313);default:return xt(60726)}}(t):t.fieldFilter!==void 0?function(n){return hn.create(pd(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return xt(58110);default:return xt(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Tn.create(n.compositeFilter.filters.map(r=>g9(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return xt(1026)}}(n.compositeFilter.op))}(t):xt(30097,{filter:t})}function Mxe(t){return Txe[t]}function Lxe(t){return Ixe[t]}function Fxe(t){return Nxe[t]}function md(t){return{fieldPath:t.canonicalString()}}function pd(t){return rr.fromServerFormat(t.fieldPath)}function y9(t){return t instanceof hn?function(n){if(n.op==="=="){if(gM(n.value))return{unaryFilter:{field:md(n.field),op:"IS_NAN"}};if(pM(n.value))return{unaryFilter:{field:md(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(gM(n.value))return{unaryFilter:{field:md(n.field),op:"IS_NOT_NAN"}};if(pM(n.value))return{unaryFilter:{field:md(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:md(n.field),op:Lxe(n.op),value:n.value}}}(t):t instanceof Tn?function(n){const r=n.getFilters().map(s=>y9(s));return r.length===1?r[0]:{compositeFilter:{op:Fxe(n.op),filters:r}}}(t):xt(54877,{filter:t})}function Oxe(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function x9(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(e,n,r,s,i=Rt.min(),o=Rt.min(),l=Ir.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new la(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new la(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new la(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new la(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v9{constructor(e){this.wt=e}}function Vxe(t,e){let n;if(e.document)n=Rxe(t.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=lt.fromSegments(e.noDocument.path),s=_u(e.noDocument.readTime);n=dr.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return xt(56709);{const r=lt.fromSegments(e.unknownDocument.path),s=_u(e.unknownDocument.version);n=dr.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new ir(s[0],s[1]);return Rt.fromTimestamp(i)}(e.readTime)),n}function jM(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:iw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:rw(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Dh(i,o.version.toTimestamp()),createTime:Dh(i,o.createTime.toTimestamp())}}(t.wt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:wu(e.version)};else{if(!e.isUnknownDocument())return xt(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:wu(e.version)}}return r}function iw(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function wu(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function _u(t){const e=new ir(t.seconds,t.nanoseconds);return Rt.fromTimestamp(e)}function Lc(t,e){const n=(e.baseMutations||[]).map(i=>YC(t.wt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>YC(t.wt,i)),s=ir.fromMillis(e.localWriteTimeMs);return new FN(e.batchId,s,n,r)}function im(t){const e=_u(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?_u(t.lastLimboFreeSnapshotVersion):Rt.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return Et(o===1,1966,{count:o}),Vi(Y0(d9(i.documents[0])))}(t.query):function(i){return Vi(p9(i))}(t.query),new la(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Ir.fromBase64String(t.resumeToken))}function w9(t,e){const n=wu(e.snapshotVersion),r=wu(e.lastLimboFreeSnapshotVersion);let s;s=ew(e.target)?f9(t.wt,e.target):m9(t.wt,e.target).gt;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:vu(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function _9(t){const e=p9({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?nw(e,e.limit,"L"):e}function rS(t,e){return new VN(e.largestBatchId,YC(t.wt,e.overlayMutation))}function DM(t,e){const n=e.path.lastSegment();return[t,ps(e.path.popLast()),n]}function MM(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:wu(r.readTime),documentKey:ps(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $xe{getBundleMetadata(e,n){return LM(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:_u(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return LM(e).put(function(s){return{bundleId:s.id,createTime:wu(Rs(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return FM(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:_9(i.bundledQuery),readTime:_u(i.readTime)}}(r)})}saveNamedQuery(e,n){return FM(e).put(function(s){return{name:s.name,readTime:wu(Rs(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function LM(t){return Lr(t,G0)}function FM(t){return Lr(t,H0)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(e,n){this.serializer=e,this.userId=n}static St(e,n){const r=n.uid||"";return new t_(e,r)}getOverlay(e,n){return Rf(e).get(DM(this.userId,n)).next(r=>r?rS(this.serializer,r):null)}getOverlays(e,n){const r=ko();return ce.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const l=new VN(n,o);s.push(this.bt(e,l))}),ce.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(ps(o.getCollectionPath())));const i=[];return s.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Rf(e).X(OC,l))}),ce.waitFor(i)}getOverlaysForCollection(e,n,r){const s=ko(),i=ps(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Rf(e).J(OC,o).next(l=>{for(const c of l){const u=rS(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=ko();let o;const l=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Rf(e).te({index:Sz,range:l},(c,u,d)=>{const h=rS(this.serializer,u);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>i)}bt(e,n){return Rf(e).put(function(s,i,o){const[l,c,u]=DM(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:sw(s.wt,o.mutation)}}(this.serializer,this.userId,n))}}function Rf(t){return Lr(t,W0)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uxe{Dt(e){return Lr(e,AN)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Ir.fromUint8Array(r):Ir.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Dt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(){}vt(e,n){this.Ct(e,n),n.Ft()}Ct(e,n){if("nullValue"in e)this.Mt(n,5);else if("booleanValue"in e)this.Mt(n,10),n.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(n,15),n.xt(Kn(e.integerValue));else if("doubleValue"in e){const r=Kn(e.doubleValue);isNaN(r)?this.Mt(n,13):(this.Mt(n,15),_p(r)?n.xt(0):n.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(n,20),typeof r=="string"&&(r=Ia(r)),n.Ot(`${r.seconds||""}`),n.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,n),this.Bt(n);else if("bytesValue"in e)this.Mt(n,30),n.Lt(Na(e.bytesValue)),this.Bt(n);else if("referenceValue"in e)this.kt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Mt(n,45),n.xt(r.latitude||0),n.xt(r.longitude||0)}else"mapValue"in e?Mz(e)?this.Mt(n,Number.MAX_SAFE_INTEGER):K0(e)?this.qt(e.mapValue,n):(this.Qt(e.mapValue,n),this.Bt(n)):"arrayValue"in e?(this.$t(e.arrayValue,n),this.Bt(n)):xt(19022,{Ut:e})}Nt(e,n){this.Mt(n,25),this.Kt(e,n)}Kt(e,n){n.Ot(e)}Qt(e,n){const r=e.fields||{};this.Mt(n,55);for(const s of Object.keys(r))this.Nt(s,n),this.Ct(r[s],n)}qt(e,n){var r,s;const i=e.fields||{};this.Mt(n,53);const o=Nh,l=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Mt(n,15),n.xt(Kn(l)),this.Nt(o,n),this.Ct(i[o],n)}$t(e,n){const r=e.values||[];this.Mt(n,50);for(const s of r)this.Ct(s,n)}kt(e,n){this.Mt(n,37),lt.fromName(e).path.forEach(r=>{this.Mt(n,60),this.Kt(r,n)})}Mt(e,n){e.xt(n)}Bt(e){e.xt(2)}}Fc.Wt=new Fc;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nd=255;function Bxe(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function OM(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=Bxe(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class zxe{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.zt(r.value),r=n.next();this.jt()}Ht(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Yt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{const s=n.codePointAt(0);this.zt(240|s>>>18),this.zt(128|63&s>>>12),this.zt(128|63&s>>>6),this.zt(128|63&s)}}this.jt()}Xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Yt()}en(e){const n=this.tn(e),r=OM(n);this.nn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}rn(e){const n=this.tn(e),r=OM(n);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}sn(){this._n(nd),this._n(255)}an(){this.un(nd),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}zt(e){const n=255&e;n===0?(this._n(0),this._n(255)):n===nd?(this._n(nd),this._n(0)):this._n(n)}Jt(e){const n=255&e;n===0?(this.un(0),this.un(255)):n===nd?(this.un(nd),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class Gxe{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class Hxe{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class kf{constructor(){this.ln=new zxe,this.hn=new Gxe(this.ln),this.Pn=new Hxe(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(e,n,r,s){this.In=e,this.En=n,this.dn=r,this.An=s}Rn(){const e=this.An.length,n=e===0||this.An[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.An,0),n!==e?r.set([0],this.An.length):++r[r.length-1],new Oc(this.In,this.En,this.dn,r)}Vn(e,n,r){return{indexId:this.In,uid:e,arrayValue:Mx(this.dn),directionalValue:Mx(this.An),orderedDocumentKey:Mx(n),documentKey:r.path.toArray()}}mn(e,n,r){const s=this.Vn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function qa(t,e){let n=t.In-e.In;return n!==0?n:(n=VM(t.dn,e.dn),n!==0?n:(n=VM(t.An,e.An),n!==0?n:lt.comparator(t.En,e.En)))}function VM(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Mx(t){return gB()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function $M(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class UM{constructor(e){this.fn=new Nn((n,r)=>rr.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const n of e.filters){const r=n;r.isInequality()?this.fn=this.fn.add(r):this.pn.push(r)}}get yn(){return this.fn.size>1}wn(e){if(Et(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const n=MC(e);if(n!==void 0&&!this.Sn(n))return!1;const r=Ic(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.Sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.fn.size>0){const l=this.fn.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=r[i];if(!this.bn(l,c)||!this.Dn(this.gn[o++],c))return!1}++i}for(;i<r.length;++i){const l=r[i];if(o>=this.gn.length||!this.Dn(this.gn[o++],l))return!1}return!0}vn(){if(this.yn)return null;let e=new Nn(rr.comparator);const n=[];for(const r of this.pn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Ix(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Ix(r.field,0))}for(const r of this.gn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Ix(r.field,r.dir==="asc"?0:1)));return new Kv(Kv.UNKNOWN_ID,this.collectionId,n,wp.empty())}Sn(e){for(const n of this.pn)if(this.bn(n,e))return!0;return!1}bn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}Dn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b9(t){var e,n;if(Et(t instanceof hn||t instanceof Tn,20012),t instanceof hn){if(t instanceof Gz){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>hn.create(t.field,"==",i)))||[];return Tn.create(s,"or")}return t}const r=t.filters.map(s=>b9(s));return Tn.create(r,t.op)}function Wxe(t){if(t.getFilters().length===0)return[];const e=QC(b9(t));return Et(S9(e),7391),JC(e)||XC(e)?[e]:e.getFilters()}function JC(t){return t instanceof hn}function XC(t){return t instanceof Tn&&MN(t)}function S9(t){return JC(t)||XC(t)||function(n){if(n instanceof Tn&&BC(n)){for(const r of n.getFilters())if(!JC(r)&&!XC(r))return!1;return!0}return!1}(t)}function QC(t){if(Et(t instanceof hn||t instanceof Tn,34018),t instanceof hn)return t;if(t.filters.length===1)return QC(t.filters[0]);const e=t.filters.map(r=>QC(r));let n=Tn.create(e,t.op);return n=ow(n),S9(n)?n:(Et(n instanceof Tn,64498),Et(Rh(n),40251),Et(n.filters.length>1,57927),n.filters.reduce((r,s)=>BN(r,s)))}function BN(t,e){let n;return Et(t instanceof hn||t instanceof Tn,38388),Et(e instanceof hn||e instanceof Tn,25473),n=t instanceof hn?e instanceof hn?function(s,i){return Tn.create([s,i],"and")}(t,e):BM(t,e):e instanceof hn?BM(e,t):function(s,i){if(Et(s.filters.length>0&&i.filters.length>0,48005),Rh(s)&&Rh(i))return Uz(s,i.getFilters());const o=BC(s)?s:i,l=BC(s)?i:s,c=o.filters.map(u=>BN(u,l));return Tn.create(c,"or")}(t,e),ow(n)}function BM(t,e){if(Rh(e))return Uz(e,t.getFilters());{const n=e.filters.map(r=>BN(t,r));return Tn.create(n,"or")}}function ow(t){if(Et(t instanceof hn||t instanceof Tn,11850),t instanceof hn)return t;const e=t.getFilters();if(e.length===1)return ow(e[0]);if(Vz(t))return t;const n=e.map(s=>ow(s)),r=[];return n.forEach(s=>{s instanceof hn?r.push(s):s instanceof Tn&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Tn.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qxe{constructor(){this.Cn=new zN}addToCollectionParentIndex(e,n){return this.Cn.add(n),ce.resolve()}getCollectionParents(e,n){return ce.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ce.resolve()}deleteFieldIndex(e,n){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,n){return ce.resolve()}getDocumentsMatchingTarget(e,n){return ce.resolve(null)}getIndexType(e,n){return ce.resolve(0)}getFieldIndexes(e,n){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,n){return ce.resolve(vi.min())}getMinOffsetFromCollectionGroup(e,n){return ce.resolve(vi.min())}updateCollectionGroup(e,n,r){return ce.resolve()}updateIndexEntries(e,n){return ce.resolve()}}class zN{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Nn(En.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Nn(En.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zM="IndexedDbIndexManager",jy=new Uint8Array(0);class Kxe{constructor(e,n){this.databaseId=n,this.Fn=new zN,this.Mn=new La(r=>vu(r),(r,s)=>yg(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Fn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.Fn.add(n)});const i={collectionId:r,parent:ps(s)};return GM(e).put(i)}return ce.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[fz(n),""],!1,!0);return GM(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Ro(o.parent))}return r})}addFieldIndex(e,n){const r=jf(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=sd(e);return i.next(l=>{o.put(MM(l,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=jf(e),s=sd(e),i=rd(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=jf(e),r=rd(e),s=sd(e);return n.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,n){return ce.forEach(this.xn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new UM(r).vn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=rd(e);let s=!0;const i=new Map;return ce.forEach(this.xn(n),o=>this.On(e,o).next(l=>{s&&(s=!!l),i.set(o,l)})).next(()=>{if(s){let o=tn();const l=[];return ce.forEach(i,(c,u)=>{Be(zM,`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(I=>`${I.fieldPath}:${I.kind}`).join(",")}`}(c)} to execute ${vu(n)}`);const d=function(S,I){const M=MC(I);if(M===void 0)return null;for(const j of tw(S,M.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null}(u,c),h=function(S,I){const M=new Map;for(const j of Ic(I))for(const C of tw(S,j.fieldPath))switch(C.op){case"==":case"in":M.set(j.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return M.set(j.fieldPath.canonicalString(),C.value),Array.from(M.values())}return null}(u,c),f=function(S,I){const M=[];let j=!0;for(const C of Ic(I)){const T=C.kind===0?_M(S,C.fieldPath,S.startAt):bM(S,C.fieldPath,S.startAt);M.push(T.value),j&&(j=T.inclusive)}return new Ah(M,j)}(u,c),m=function(S,I){const M=[];let j=!0;for(const C of Ic(I)){const T=C.kind===0?bM(S,C.fieldPath,S.endAt):_M(S,C.fieldPath,S.endAt);M.push(T.value),j&&(j=T.inclusive)}return new Ah(M,j)}(u,c),g=this.Nn(c,u,f),x=this.Nn(c,u,m),E=this.Bn(c,u,h),v=this.Ln(c.indexId,d,g,f.inclusive,x,m.inclusive,E);return ce.forEach(v,_=>r.Z(_,n.limit).next(S=>{S.forEach(I=>{const M=lt.fromSegments(I.documentKey);o.has(M)||(o=o.add(M),l.push(M))})}))}).next(()=>l)}return ce.resolve(null)})}xn(e){let n=this.Mn.get(e);return n||(e.filters.length===0?n=[e]:n=Wxe(Tn.create(e.filters,"and")).map(r=>GC(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,n),n)}Ln(e,n,r,s,i,o,l){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),u=c/(n!=null?n.length:1),d=[];for(let h=0;h<c;++h){const f=n?this.kn(n[h/u]):jy,m=this.qn(e,f,r[h%u],s),g=this.Qn(e,f,i[h%u],o),x=l.map(E=>this.qn(e,f,E,!0));d.push(...this.createRange(m,g,x))}return d}qn(e,n,r,s){const i=new Oc(e,lt.empty(),n,r);return s?i:i.Rn()}Qn(e,n,r,s){const i=new Oc(e,lt.empty(),n,r);return s?i.Rn():i}On(e,n){const r=new UM(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const l of i)r.wn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,n){let r=2;const s=this.xn(n);return ce.forEach(s,i=>this.On(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new Nn(rr.comparator),d=!1;for(const h of c.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?d=!0:u=u.add(f.field));for(const h of c.orderBy)h.field.isKeyField()||(u=u.add(h.field));return u.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}$n(e,n){const r=new kf;for(const s of Ic(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Tn(s.kind);Fc.Wt.vt(i,o)}return r.cn()}kn(e){const n=new kf;return Fc.Wt.vt(e,n.Tn(0)),n.cn()}Un(e,n){const r=new kf;return Fc.Wt.vt(Ip(this.databaseId,n),r.Tn(function(i){const o=Ic(i);return o.length===0?0:o[o.length-1].kind}(e))),r.cn()}Bn(e,n,r){if(r===null)return[];let s=[];s.push(new kf);let i=0;for(const o of Ic(e)){const l=r[i++];for(const c of s)if(this.Kn(n,o.fieldPath)&&Np(l))s=this.Wn(s,o,l);else{const u=c.Tn(o.kind);Fc.Wt.vt(l,u)}}return this.Gn(s)}Nn(e,n,r){return this.Bn(e,n,r.position)}Gn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].cn();return n}Wn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const l of s){const c=new kf;c.seed(l.cn()),Fc.Wt.vt(o,c.Tn(n.kind)),i.push(c)}return i}Kn(e,n){return!!e.filters.find(r=>r instanceof hn&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=jf(e),s=sd(e);return(n?r.J(FC,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return ce.forEach(i,l=>s.get([l.indexId,this.uid]).next(c=>{o.push(function(d,h){const f=h?new wp(h.sequenceNumber,new vi(_u(h.readTime),new lt(Ro(h.documentKey)),h.largestBatchId)):wp.empty(),m=d.fields.map(([g,x])=>new Ix(rr.fromServerFormat(g),x));return new Kv(d.indexId,d.collectionGroup,m,f)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Ot(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=jf(e),i=sd(e);return this.zn(e).next(o=>s.J(FC,IDBKeyRange.bound(n,n)).next(l=>ce.forEach(l,c=>i.put(MM(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return ce.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?ce.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(r.set(s.collectionGroup,l),ce.forEach(l,c=>this.jn(e,s,c).next(u=>{const d=this.Hn(i,c);return u.isEqual(d)?ce.resolve():this.Jn(e,i,c,u,d)}))))})}Yn(e,n,r,s){return rd(e).put(s.Vn(this.uid,this.Un(r,n.key),n.key))}Zn(e,n,r,s){return rd(e).delete(s.mn(this.uid,this.Un(r,n.key),n.key))}jn(e,n,r){const s=rd(e);let i=new Nn(qa);return s.te({index:bz,range:IDBKeyRange.only([r.indexId,this.uid,Mx(this.Un(r,n))])},(o,l)=>{i=i.add(new Oc(r.indexId,n,$M(l.arrayValue),$M(l.directionalValue)))}).next(()=>i)}Hn(e,n){let r=new Nn(qa);const s=this.$n(n,e);if(s==null)return r;const i=MC(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Np(o))for(const l of o.arrayValue.values||[])r=r.add(new Oc(n.indexId,e.key,this.kn(l),s))}else r=r.add(new Oc(n.indexId,e.key,jy,s));return r}Jn(e,n,r,s,i){Be(zM,"Updating index entries for document '%s'",n.key);const o=[];return function(c,u,d,h,f){const m=c.getIterator(),g=u.getIterator();let x=td(m),E=td(g);for(;x||E;){let v=!1,_=!1;if(x&&E){const S=d(x,E);S<0?_=!0:S>0&&(v=!0)}else x!=null?_=!0:v=!0;v?(h(E),E=td(g)):_?(f(x),x=td(m)):(x=td(m),E=td(g))}}(s,i,qa,l=>{o.push(this.Yn(e,n,r,l))},l=>{o.push(this.Zn(e,n,r,l))}),ce.waitFor(o)}zn(e){let n=1;return sd(e).te({index:_z,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,l)=>qa(o,l)).filter((o,l,c)=>!l||qa(o,c[l-1])!==0);const s=[];s.push(e);for(const o of r){const l=qa(o,e),c=qa(o,n);if(l===0)s[0]=e.Rn();else if(l>0&&c<0)s.push(o),s.push(o.Rn());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Xn(s[o],s[o+1]))return[];const l=s[o].mn(this.uid,jy,lt.empty()),c=s[o+1].mn(this.uid,jy,lt.empty());i.push(IDBKeyRange.bound(l,c))}return i}Xn(e,n){return qa(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(HM)}getMinOffset(e,n){return ce.mapArray(this.xn(n),r=>this.On(e,r).next(s=>s||xt(44426))).next(HM)}}function GM(t){return Lr(t,Ep)}function rd(t){return Lr(t,jm)}function jf(t){return Lr(t,PN)}function sd(t){return Lr(t,km)}function HM(t){Et(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;TN(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new vi(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WM={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},E9=41943040;class ds{static withCacheSize(e){return new ds(e,ds.DEFAULT_COLLECTION_PERCENTILE,ds.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C9(t,e,n){const r=t.store(no),s=t.store(Eh),i=[],o=IDBKeyRange.only(n.batchId);let l=0;const c=r.te({range:o},(d,h,f)=>(l++,f.delete()));i.push(c.next(()=>{Et(l===1,47070,{batchId:n.batchId})}));const u=[];for(const d of n.mutations){const h=xz(e,d.key.path,n.batchId);i.push(s.delete(h)),u.push(d.key)}return ce.waitFor(i).next(()=>u)}function aw(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw xt(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ds.DEFAULT_COLLECTION_PERCENTILE=10,ds.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ds.DEFAULT=new ds(E9,ds.DEFAULT_COLLECTION_PERCENTILE,ds.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ds.DISABLED=new ds(-1,0,0);class n_{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.er={}}static St(e,n,r,s){Et(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new n_(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ka(e).te({index:qc,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=gd(e),o=Ka(e);return o.add({}).next(l=>{Et(typeof l=="number",49019);const c=new FN(l,n,r,s),u=function(m,g,x){const E=x.baseMutations.map(_=>sw(m.wt,_)),v=x.mutations.map(_=>sw(m.wt,_));return{userId:g,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:E,mutations:v}}(this.serializer,this.userId,c),d=[];let h=new Nn((f,m)=>Ot(f.canonicalString(),m.canonicalString()));for(const f of s){const m=xz(this.userId,f.key.path,l);h=h.add(f.key.path.popLast()),d.push(o.put(u)),d.push(i.put(m,Sye))}return h.forEach(f=>{d.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.er[l]=c.keys()}),ce.waitFor(d).next(()=>c)})}lookupMutationBatch(e,n){return Ka(e).get(n).next(r=>r?(Et(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Lc(this.serializer,r)):null)}tr(e,n){return this.er[n]?ce.resolve(this.er[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.er[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Ka(e).te({index:qc,range:s},(o,l,c)=>{l.userId===this.userId&&(Et(l.batchId>=r,47524,{nr:r}),i=Lc(this.serializer,l)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Qc;return Ka(e).te({index:qc,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Qc],[this.userId,Number.POSITIVE_INFINITY]);return Ka(e).J(qc,n).next(r=>r.map(s=>Lc(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Nx(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return gd(e).te({range:s},(o,l,c)=>{const[u,d,h]=o,f=Ro(d);if(u===this.userId&&n.path.isEqual(f))return Ka(e).get(h).next(m=>{if(!m)throw xt(61480,{rr:o,batchId:h});Et(m.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:m.userId,batchId:h}),i.push(Lc(this.serializer,m))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Nn(Ot);const s=[];return n.forEach(i=>{const o=Nx(this.userId,i.path),l=IDBKeyRange.lowerBound(o),c=gd(e).te({range:l},(u,d,h)=>{const[f,m,g]=u,x=Ro(m);f===this.userId&&i.path.isEqual(x)?r=r.add(g):h.done()});s.push(c)}),ce.waitFor(s).next(()=>this.ir(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Nx(this.userId,r),o=IDBKeyRange.lowerBound(i);let l=new Nn(Ot);return gd(e).te({range:o},(c,u,d)=>{const[h,f,m]=c,g=Ro(f);h===this.userId&&r.isPrefixOf(g)?g.length===s&&(l=l.add(m)):d.done()}).next(()=>this.ir(e,l))}ir(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Ka(e).get(i).next(o=>{if(o===null)throw xt(35274,{batchId:i});Et(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(Lc(this.serializer,o))}))}),ce.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return C9(e.he,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.sr(n.batchId)}),ce.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return ce.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return gd(e).te({range:r},(i,o,l)=>{if(i[0]===this.userId){const c=Ro(i[1]);s.push(c)}else l.done()}).next(()=>{Et(s.length===0,56720,{_r:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return T9(e,this.userId,n)}ar(e){return I9(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Qc,lastStreamToken:""})}}function T9(t,e,n){const r=Nx(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return gd(t).te({range:i,ee:!0},(l,c,u)=>{const[d,h,f]=l;d===e&&h===s&&(o=!0),u.done()}).next(()=>o)}function Ka(t){return Lr(t,no)}function gd(t){return Lr(t,Eh)}function I9(t){return Lr(t,bp)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new bu(0)}static lr(){return new bu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yxe{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.hr(e).next(n=>{const r=new bu(n.highestTargetId);return n.highestTargetId=r.next(),this.Pr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(n=>Rt.fromTimestamp(new ir(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.hr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Pr(e,s)))}addTargetData(e,n){return this.Tr(e,n).next(()=>this.hr(e).next(r=>(r.targetCount+=1,this.Ir(n,r),this.Pr(e,r))))}updateTargetData(e,n){return this.Tr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>id(e).delete(n.targetId)).next(()=>this.hr(e)).next(r=>(Et(r.targetCount>0,8065),r.targetCount-=1,this.Pr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return id(e).te((o,l)=>{const c=im(l);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>ce.waitFor(i)).next(()=>s)}forEachTarget(e,n){return id(e).te((r,s)=>{const i=im(s);n(i)})}hr(e){return qM(e).get(Xv).next(n=>(Et(n!==null,2888),n))}Pr(e,n){return qM(e).put(Xv,n)}Tr(e,n){return id(e).put(w9(this.serializer,n))}Ir(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.hr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=vu(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return id(e).te({range:s,index:wz},(o,l,c)=>{const u=im(l);yg(n,u.target)&&(i=u,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=dl(e);return n.forEach(o=>{const l=ps(o.path);s.push(i.put({targetId:r,path:l})),s.push(this.referenceDelegate.addReference(e,r,o))}),ce.waitFor(s)}removeMatchingKeys(e,n,r){const s=dl(e);return ce.forEach(n,i=>{const o=ps(i.path);return ce.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=dl(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=dl(e);let i=tn();return s.te({range:r,ee:!0},(o,l,c)=>{const u=Ro(o[1]),d=new lt(u);i=i.add(d)}).next(()=>i)}containsKey(e,n){const r=ps(n.path),s=IDBKeyRange.bound([r],[fz(r)],!1,!0);let i=0;return dl(e).te({index:NN,ee:!0,range:s},([o,l],c,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}Rt(e,n){return id(e).get(n).next(r=>r?im(r):null)}}function id(t){return Lr(t,Ch)}function qM(t){return Lr(t,Zc)}function dl(t){return Lr(t,Th)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM="LruGarbageCollector",Jxe=1048576;function YM([t,e],[n,r]){const s=Ot(t,n);return s===0?Ot(e,r):s}class Xxe{constructor(e){this.Er=e,this.buffer=new Nn(YM),this.dr=0}Ar(){return++this.dr}Rr(e){const n=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();YM(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class N9{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Be(KM,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){fc(n)?Be(KM,"Ignoring IndexedDB error during garbage collection: ",n):await Du(n)}await this.mr(3e5)})}}class Qxe{constructor(e,n){this.gr=e,this.params=n}calculateTargetCount(e,n){return this.gr.pr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return ce.resolve(Li.le);const r=new Xxe(n);return this.gr.forEachTarget(e,s=>r.Rr(s.sequenceNumber)).next(()=>this.gr.yr(e,s=>r.Rr(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.gr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.gr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Be("LruGarbageCollector","Garbage collection skipped; disabled"),ce.resolve(WM)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Be("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),WM):this.wr(e,n))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,n){let r,s,i,o,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Be("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,l=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),hd()<=dn.DEBUG&&Be("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),ce.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function P9(t,e){return new Qxe(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zxe{constructor(e,n){this.db=e,this.garbageCollector=P9(this,n)}pr(e){const n=this.Sr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Sr(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}yr(e,n){return this.br(e,(r,s)=>n(s))}addReference(e,n,r){return Dy(e,r)}removeReference(e,n,r){return Dy(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Dy(e,n)}Dr(e,n){return function(s,i){let o=!1;return I9(s).ne(l=>T9(s,l,i).next(c=>(c&&(o=!0),ce.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.br(e,(o,l)=>{if(l<=n){const c=this.Dr(e,o).next(u=>{if(!u)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Rt.min()),dl(e).delete(function(h){return[0,ps(h.path)]}(o))))});s.push(c)}}).next(()=>ce.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Dy(e,n)}br(e,n){const r=dl(e);let s,i=Li.le;return r.te({index:NN},([o,l],{path:c,sequenceNumber:u})=>{o===0?(i!==Li.le&&n(new lt(Ro(s)),i),i=u,s=c):i=Li.le}).next(()=>{i!==Li.le&&n(new lt(Ro(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Dy(t,e){return dl(t).put(function(r,s){return{targetId:0,path:ps(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A9{constructor(){this.changes=new La(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,dr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ce.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eve{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return wc(e).put(r)}removeEntry(e,n,r){return wc(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],iw(o),l[l.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.vr(e,r)))}getEntry(e,n){let r=dr.newInvalidDocument(n);return wc(e).te({index:Px,range:IDBKeyRange.only(Df(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}Fr(e,n){let r={size:0,document:dr.newInvalidDocument(n)};return wc(e).te({index:Px,range:IDBKeyRange.only(Df(n))},(s,i)=>{r={document:this.Cr(n,i),size:aw(i)}}).next(()=>r)}getEntries(e,n){let r=hi();return this.Mr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Or(e,n){let r=hi(),s=new Qn(lt.comparator);return this.Mr(e,n,(i,o)=>{const l=this.Cr(i,o);r=r.insert(i,l),s=s.insert(i,aw(o))}).next(()=>({documents:r,Nr:s}))}Mr(e,n,r){if(n.isEmpty())return ce.resolve();let s=new Nn(QM);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(Df(s.first()),Df(s.last())),o=s.getIterator();let l=o.getNext();return wc(e).te({index:Px,range:i},(c,u,d)=>{const h=lt.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&QM(l,h)<0;)r(l,null),l=o.getNext();l&&l.isEqual(h)&&(r(l,u),l=o.hasNext()?o.getNext():null),l?d.H(Df(l)):d.done()}).next(()=>{for(;l;)r(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,l=[o.popLast().toArray(),o.lastSegment(),iw(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return wc(e).J(IDBKeyRange.bound(l,c,!0)).next(u=>{i==null||i.incrementDocumentReadCount(u.length);let d=hi();for(const h of u){const f=this.Cr(lt.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(vg(n,f)||s.has(f.key))&&(d=d.insert(f.key,f))}return d})}getAllFromCollectionGroup(e,n,r,s){let i=hi();const o=XM(n,r),l=XM(n,vi.max());return wc(e).te({index:vz,range:IDBKeyRange.bound(o,l,!0)},(c,u,d)=>{const h=this.Cr(lt.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(h.key,h),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new tve(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return JM(e).get(LC).next(n=>(Et(!!n,20021),n))}vr(e,n){return JM(e).put(LC,n)}Cr(e,n){if(n){const r=Vxe(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Rt.min())))return r}return dr.newInvalidDocument(e)}}function R9(t){return new eve(t)}class tve extends A9{constructor(e,n){super(),this.Br=e,this.trackRemovals=n,this.Lr=new La(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Nn((i,o)=>Ot(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.Lr.get(i);if(n.push(this.Br.removeEntry(e,i,l.readTime)),o.isValidDocument()){const c=jM(this.Br.serializer,o);s=s.add(i.path.popLast());const u=aw(c);r+=u-l.size,n.push(this.Br.addEntry(e,i,c))}else if(r-=l.size,this.trackRemovals){const c=jM(this.Br.serializer,o.convertToNoDocument(Rt.min()));n.push(this.Br.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.Br.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Br.updateMetadata(e,r)),ce.waitFor(n)}getFromCache(e,n){return this.Br.Fr(e,n).next(r=>(this.Lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Br.Or(e,n).next(({documents:r,Nr:s})=>(s.forEach((i,o)=>{this.Lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function JM(t){return Lr(t,Sp)}function wc(t){return Lr(t,Jv)}function Df(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function XM(t,e){const n=e.documentKey.path.toArray();return[t,iw(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function QM(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=Ot(n[i],r[i]),s)return s;return s=Ot(n.length,r.length),s||(s=Ot(n[n.length-2],r[r.length-2]),s||Ot(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nve{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k9{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Fm(r.mutation,s,Hs.empty(),ir.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,tn()).next(()=>r))}getLocalViewOfDocuments(e,n,r=tn()){const s=ko();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=rm();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ko();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,tn()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=hi();const o=Lm(),l=function(){return Lm()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof Fa)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Fm(d.mutation,u,d.mutation.getFieldMask(),ir.now())):o.set(u.key,Hs.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var h;return l.set(u,new nve(d,(h=o.get(u))!==null&&h!==void 0?h:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Lm();let s=new Qn((o,l)=>o-l),i=tn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||Hs.empty();d=l.applyToLocalView(u,d),r.set(c,d);const h=(s.get(l.batchId)||tn()).add(c);s=s.insert(l.batchId,h)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,h=Jz();d.forEach(f=>{if(!i.has(f)){const m=n9(n.get(f),r.get(f));m!==null&&h.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return ce.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return lt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Hz(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):ce.resolve(ko());let l=vp,c=i;return o.next(u=>ce.forEach(u,(d,h)=>(l<h.largestBatchId&&(l=h.largestBatchId),i.get(d)?ce.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{c=c.insert(d,f)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,tn())).next(d=>({batchId:l,changes:Yz(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new lt(n)).next(r=>{let s=rm();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=rm();return this.indexManager.getCollectionParents(e,i).next(l=>ce.forEach(l,c=>{const u=function(h,f){return new xg(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,dr.newInvalidDocument(d)))});let l=rm();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&Fm(d.mutation,u,Hs.empty(),ir.now()),vg(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rve{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,n){return ce.resolve(this.kr.get(n))}saveBundleMetadata(e,n){return this.kr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Rs(s.createTime)}}(n)),ce.resolve()}getNamedQuery(e,n){return ce.resolve(this.qr.get(n))}saveNamedQuery(e,n){return this.qr.set(n.name,function(s){return{name:s.name,query:_9(s.bundledQuery),readTime:Rs(s.readTime)}}(n)),ce.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sve{constructor(){this.overlays=new Qn(lt.comparator),this.Qr=new Map}getOverlay(e,n){return ce.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ko();return ce.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.bt(e,n,i)}),ce.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Qr.delete(r)),ce.resolve()}getOverlaysForCollection(e,n,r){const s=ko(),i=n.length+1,o=new lt(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return ce.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Qn((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=ko(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=ko(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return ce.resolve(l)}bt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Qr.get(s.largestBatchId).delete(r.key);this.Qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new VN(n,r));let i=this.Qr.get(n);i===void 0&&(i=tn(),this.Qr.set(n,i)),this.Qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ive{constructor(){this.sessionToken=Ir.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ce.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(){this.$r=new Nn(Or.Ur),this.Kr=new Nn(Or.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,n){const r=new Or(e,n);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.zr(new Or(e,n))}jr(e,n){e.forEach(r=>this.removeReference(r,n))}Hr(e){const n=new lt(new En([])),r=new Or(n,e),s=new Or(n,e+1),i=[];return this.Kr.forEachInRange([r,s],o=>{this.zr(o),i.push(o.key)}),i}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const n=new lt(new En([])),r=new Or(n,e),s=new Or(n,e+1);let i=tn();return this.Kr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Or(e,0),r=this.$r.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Or{constructor(e,n){this.key=e,this.Zr=n}static Ur(e,n){return lt.comparator(e.key,n.key)||Ot(e.Zr,n.Zr)}static Wr(e,n){return Ot(e.Zr,n.Zr)||lt.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ove{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.nr=1,this.Xr=new Nn(Or.Ur)}checkEmpty(e){return ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new FN(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Xr=this.Xr.add(new Or(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ce.resolve(o)}lookupMutationBatch(e,n){return ce.resolve(this.ei(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ti(r),i=s<0?0:s;return ce.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(this.mutationQueue.length===0?Qc:this.nr-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Or(n,0),s=new Or(n,Number.POSITIVE_INFINITY),i=[];return this.Xr.forEachInRange([r,s],o=>{const l=this.ei(o.Zr);i.push(l)}),ce.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Nn(Ot);return n.forEach(s=>{const i=new Or(s,0),o=new Or(s,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([i,o],l=>{r=r.add(l.Zr)})}),ce.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;lt.isDocumentKey(i)||(i=i.child(""));const o=new Or(new lt(i),0);let l=new Nn(Ot);return this.Xr.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.Zr)),!0)},o),ce.resolve(this.ni(l))}ni(e){const n=[];return e.forEach(r=>{const s=this.ei(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Et(this.ri(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return ce.forEach(n.mutations,s=>{const i=new Or(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,n){const r=new Or(n,0),s=this.Xr.firstAfterOrEqual(r);return ce.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}ri(e,n){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const n=this.ti(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ave{constructor(e){this.ii=e,this.docs=function(){return new Qn(lt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ii(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ce.resolve(r?r.document.mutableCopy():dr.newInvalidDocument(n))}getEntries(e,n){let r=hi();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():dr.newInvalidDocument(s))}),ce.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=hi();const o=n.path,l=new lt(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||TN(mz(d),r)<=0||(s.has(d.key)||vg(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return ce.resolve(i)}getAllFromCollectionGroup(e,n,r,s){xt(9500)}si(e,n){return ce.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new lve(this)}getSize(e){return ce.resolve(this.size)}}class lve extends A9{constructor(e){super(),this.Br=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Br.addEntry(e,s)):this.Br.removeEntry(r)}),ce.waitFor(n)}getFromCache(e,n){return this.Br.getEntry(e,n)}getAllFromCache(e,n){return this.Br.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cve{constructor(e){this.persistence=e,this.oi=new La(n=>vu(n),yg),this.lastRemoteSnapshotVersion=Rt.min(),this.highestTargetId=0,this._i=0,this.ai=new GN,this.targetCount=0,this.ui=bu.cr()}forEachTarget(e,n){return this.oi.forEach((r,s)=>n(s)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this._i&&(this._i=n),ce.resolve()}Tr(e){this.oi.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ui=new bu(n),this.highestTargetId=n),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,n){return this.Tr(n),this.targetCount+=1,ce.resolve()}updateTargetData(e,n){return this.Tr(n),ce.resolve()}removeTargetData(e,n){return this.oi.delete(n.target),this.ai.Hr(n.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.oi.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.oi.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),ce.waitFor(i).next(()=>s)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,n){const r=this.oi.get(n)||null;return ce.resolve(r)}addMatchingKeys(e,n,r){return this.ai.Gr(n,r),ce.resolve()}removeMatchingKeys(e,n,r){this.ai.jr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),ce.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.ai.Hr(n),ce.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ai.Yr(n);return ce.resolve(r)}containsKey(e,n){return ce.resolve(this.ai.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(e,n){this.ci={},this.overlays={},this.li=new Li(0),this.hi=!1,this.hi=!0,this.Pi=new ive,this.referenceDelegate=e(this),this.Ti=new cve(this),this.indexManager=new qxe,this.remoteDocumentCache=function(s){return new ave(s)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new v9(n),this.Ei=new rve(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new sve,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ci[e.toKey()];return r||(r=new ove(n,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,n,r){Be("MemoryPersistence","Starting transaction:",e);const s=new uve(this.li.next());return this.referenceDelegate.di(),r(s).next(i=>this.referenceDelegate.Ai(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ri(e,n){return ce.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,n)))}}class uve extends gz{constructor(e){super(),this.currentSequenceNumber=e}}class r_{constructor(e){this.persistence=e,this.Vi=new GN,this.mi=null}static fi(e){return new r_(e)}get gi(){if(this.mi)return this.mi;throw xt(60996)}addReference(e,n,r){return this.Vi.addReference(r,n),this.gi.delete(r.toString()),ce.resolve()}removeReference(e,n,r){return this.Vi.removeReference(r,n),this.gi.add(r.toString()),ce.resolve()}markPotentiallyOrphaned(e,n){return this.gi.add(n.toString()),ce.resolve()}removeTarget(e,n){this.Vi.Hr(n.targetId).forEach(s=>this.gi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.gi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}di(){this.mi=new Set}Ai(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.gi,r=>{const s=lt.fromPath(r);return this.pi(e,s).next(i=>{i||n.removeEntry(s,Rt.min())})}).next(()=>(this.mi=null,n.apply(e)))}updateLimboDocument(e,n){return this.pi(e,n).next(r=>{r?this.gi.delete(n.toString()):this.gi.add(n.toString())})}Ii(e){return 0}pi(e,n){return ce.or([()=>ce.resolve(this.Vi.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ri(e,n)])}}class lw{constructor(e,n){this.persistence=e,this.yi=new La(r=>ps(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=P9(this,n)}static fi(e,n){return new lw(e,n)}di(){}Ai(e){return ce.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}pr(e){const n=this.Sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Sr(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}yr(e,n){return ce.forEach(this.yi,(r,s)=>this.Dr(e,r,s).next(i=>i?ce.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.si(e,o=>this.Dr(e,o,n).next(l=>{l||(r++,i.removeEntry(o,Rt.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.yi.set(n,e.currentSequenceNumber),ce.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),ce.resolve()}removeReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),ce.resolve()}updateLimboDocument(e,n){return this.yi.set(n,e.currentSequenceNumber),ce.resolve()}Ii(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Rx(e.data.value)),n}Dr(e,n,r){return ce.or([()=>this.persistence.Ri(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.yi.get(n);return ce.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dve{constructor(e){this.serializer=e}q(e,n,r,s){const i=new B0("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore(gg)}(e),function(c){c.createObjectStore(bp,{keyPath:bye}),c.createObjectStore(no,{keyPath:cM,autoIncrement:!0}).createIndex(qc,uM,{unique:!0}),c.createObjectStore(Eh)}(e),ZM(e),function(c){c.createObjectStore(Nc)}(e));let o=ce.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore(Th),c.deleteObjectStore(Ch),c.deleteObjectStore(Zc)}(e),ZM(e)),o=o.next(()=>function(c){const u=c.store(Zc),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Rt.min().toTimestamp(),targetCount:0};return u.put(Xv,d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store(no).J().next(h=>{c.deleteObjectStore(no),c.createObjectStore(no,{keyPath:cM,autoIncrement:!0}).createIndex(qc,uM,{unique:!0});const f=u.store(no),m=h.map(g=>f.put(g));return ce.waitFor(m)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore(Ih,{keyPath:Rye})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.wi(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore(Sp)}(e),this.Si(i)))),r<7&&s>=7&&(o=o.next(()=>this.bi(i))),r<8&&s>=8&&(o=o.next(()=>this.Di(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Ci(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(G0,{keyPath:kye})})(e),function(c){c.createObjectStore(H0,{keyPath:jye})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore(W0,{keyPath:$ye});u.createIndex(OC,Uye,{unique:!1}),u.createIndex(Sz,Bye,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore(Jv,{keyPath:Eye});u.createIndex(Px,Cye),u.createIndex(vz,Tye)}(e)).next(()=>this.Fi(e,i)).next(()=>e.deleteObjectStore(Nc))),r<14&&s>=14&&(o=o.next(()=>this.Mi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore(PN,{keyPath:Dye,autoIncrement:!0}).createIndex(FC,Mye,{unique:!1}),c.createObjectStore(km,{keyPath:Lye}).createIndex(_z,Fye,{unique:!1}),c.createObjectStore(jm,{keyPath:Oye}).createIndex(bz,Vye,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(km).clear()}).next(()=>{n.objectStore(jm).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(AN,{keyPath:zye})})(e)})),r<18&&s>=18&&gB()&&(o=o.next(()=>{n.objectStore(km).clear()}).next(()=>{n.objectStore(jm).clear()})),o}Si(e){let n=0;return e.store(Nc).te((r,s)=>{n+=aw(s)}).next(()=>{const r={byteSize:n};return e.store(Sp).put(LC,r)})}wi(e){const n=e.store(bp),r=e.store(no);return n.J().next(s=>ce.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,Qc],[i.userId,i.lastAcknowledgedBatchId]);return r.J(qc,o).next(l=>ce.forEach(l,c=>{Et(c.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const u=Lc(this.serializer,c);return C9(e,i.userId,u).next(()=>{})}))}))}bi(e){const n=e.store(Th),r=e.store(Nc);return e.store(Zc).get(Xv).next(s=>{const i=[];return r.te((o,l)=>{const c=new En(o),u=function(h){return[0,ps(h)]}(c);i.push(n.get(u).next(d=>d?ce.resolve():(h=>n.put({targetId:0,path:ps(h),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>ce.waitFor(i))})}Di(e,n){e.createObjectStore(Ep,{keyPath:Aye});const r=n.store(Ep),s=new zN,i=o=>{if(s.add(o)){const l=o.lastSegment(),c=o.popLast();return r.put({collectionId:l,parent:ps(c)})}};return n.store(Nc).te({ee:!0},(o,l)=>{const c=new En(o);return i(c.popLast())}).next(()=>n.store(Eh).te({ee:!0},([o,l,c],u)=>{const d=Ro(l);return i(d.popLast())}))}Ci(e){const n=e.store(Ch);return n.te((r,s)=>{const i=im(s),o=w9(this.serializer,i);return n.put(o)})}Fi(e,n){const r=n.store(Nc),s=[];return r.te((i,o)=>{const l=n.store(Jv),c=function(h){return h.document?new lt(En.fromString(h.document.name).popFirst(5)):h.noDocument?lt.fromSegments(h.noDocument.path):h.unknownDocument?lt.fromSegments(h.unknownDocument.path):xt(36783)}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(l.put(u))}).next(()=>ce.waitFor(s))}Mi(e,n){const r=n.store(no),s=R9(this.serializer),i=new HN(r_.fi,this.serializer.wt);return r.J().next(o=>{const l=new Map;return o.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:tn();Lc(this.serializer,c).keys().forEach(h=>d=d.add(h)),l.set(c.userId,d)}),ce.forEach(l,(c,u)=>{const d=new Yr(u),h=t_.St(this.serializer,d),f=i.getIndexManager(d),m=n_.St(d,this.serializer,f,i.referenceDelegate);return new k9(s,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new VC(n,Li.le),c).next()})})}}function ZM(t){t.createObjectStore(Th,{keyPath:Nye}).createIndex(NN,Pye,{unique:!0}),t.createObjectStore(Ch,{keyPath:"targetId"}).createIndex(wz,Iye,{unique:!0}),t.createObjectStore(Zc)}const Ya="IndexedDbPersistence",sS=18e5,iS=5e3,oS="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",hve="main";class WN{constructor(e,n,r,s,i,o,l,c,u,d,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.xi=i,this.window=o,this.document=l,this.Oi=u,this.Ni=d,this.Bi=h,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=f=>Promise.resolve(),!WN.C())throw new at(Ce.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Zxe(this,s),this.Ui=n+hve,this.serializer=new v9(c),this.Ki=new kl(this.Ui,this.Bi,new dve(this.serializer)),this.Pi=new Uxe,this.Ti=new Yxe(this.referenceDelegate,this.serializer),this.remoteDocumentCache=R9(this.serializer),this.Ei=new $xe,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,d===!1&&Is(Ya,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new at(Ce.FAILED_PRECONDITION,oS);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new Li(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>My(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(n=>{n||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(n=>this.isPrimary&&!n?this.Xi(e).next(()=>!1):!!n&&this.es(e).next(()=>!0))).catch(e=>{if(fc(e))return Be(Ya,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Be(Ya,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return Mf(e).get(ed).next(n=>ce.resolve(this.ts(n)))}ns(e){return My(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,sS)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Lr(n,Ih);return r.J().next(s=>{const i=this._s(s,sS),o=s.filter(l=>i.indexOf(l)===-1);return ce.forEach(o,l=>r.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Wi)for(const n of e)this.Wi.removeItem(this.us(n.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?ce.resolve(!0):Mf(e).get(ed).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,iS)&&!this.cs(n.ownerId)){if(this.ts(n)&&this.networkEnabled)return!0;if(!this.ts(n)){if(!n.allowTabSynchronization)throw new at(Ce.FAILED_PRECONDITION,oS);return!1}}return!(!this.networkEnabled||!this.inForeground)||My(e).J().next(r=>this._s(r,iS).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&Be(Ya,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[gg,Ih],e=>{const n=new VC(e,Li.le);return this.Xi(n).next(()=>this.ns(n))}),this.Ki.close(),this.Ts()}_s(e,n){return e.filter(r=>this.ss(r.updateTimeMs,n)&&!this.cs(r.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>My(e).J().next(n=>this._s(n,sS).map(r=>r.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,n){return n_.St(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Kxe(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return t_.St(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,n,r){Be(Ya,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===18?Wye:c===17?Iz:c===16?Hye:c===15?RN:c===14?Tz:c===13?Cz:c===12?Gye:c===11?Ez:void xt(60245)}(this.Bi);let o;return this.Ki.runTransaction(e,s,i,l=>(o=new VC(l,this.li?this.li.next():Li.le),n==="readwrite-primary"?this.Yi(o).next(c=>!!c||this.Zi(o)).next(c=>{if(!c)throw Is(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new at(Ce.FAILED_PRECONDITION,pz);return r(o)}).next(c=>this.es(o).next(()=>c)):this.Es(o).next(()=>r(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Es(e){return Mf(e).get(ed).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,iS)&&!this.cs(n.ownerId)&&!this.ts(n)&&!(this.Ni||this.allowTabSynchronization&&n.allowTabSynchronization))throw new at(Ce.FAILED_PRECONDITION,oS)})}es(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Mf(e).put(ed,n)}static C(){return kl.C()}Xi(e){const n=Mf(e);return n.get(ed).next(r=>this.ts(r)?(Be(Ya,"Releasing primary lease."),n.delete(ed)):ce.resolve())}ss(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Is(`Detected an update time that is in the future: ${e} > ${r}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const n=/(?:Version|Mobile)\/1[456]/;pB()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var n;try{const r=((n=this.Wi)===null||n===void 0?void 0:n.getItem(this.us(e)))!==null;return Be(Ya,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Is(Ya,"Failed to get zombied client id.",r),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){Is("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Mf(t){return Lr(t,gg)}function My(t){return Lr(t,Ih)}function fve(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qN{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.ds=r,this.As=s}static Rs(e,n){let r=tn(),s=tn();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new qN(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mve{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j9{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return pB()?8:yz(Dr())>0?6:4}()}initialize(e,n){this.ys=e,this.indexManager=n,this.Vs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ws(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Ss(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new mve;return this.bs(e,n,o).next(l=>{if(i.result=l,this.fs)return this.Ds(e,n,o,l.size)})}).next(()=>i.result)}Ds(e,n,r,s){return r.documentReadCount<this.gs?(hd()<=dn.DEBUG&&Be("QueryEngine","SDK will not create cache indexes for query:",fd(n),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),ce.resolve()):(hd()<=dn.DEBUG&&Be("QueryEngine","Query:",fd(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ps*s?(hd()<=dn.DEBUG&&Be("QueryEngine","The SDK decides to create cache indexes for query:",fd(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vi(n))):ce.resolve())}ws(e,n){if(SM(n))return ce.resolve(null);let r=Vi(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=nw(n,null,"F"),r=Vi(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=tn(...i);return this.ys.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.vs(n,l);return this.Cs(n,u,o,c.readTime)?this.ws(e,nw(n,null,"F")):this.Fs(e,u,n,c)}))})))}Ss(e,n,r,s){return SM(n)||s.isEqual(Rt.min())?ce.resolve(null):this.ys.getDocuments(e,r).next(i=>{const o=this.vs(n,i);return this.Cs(n,o,r,s)?ce.resolve(null):(hd()<=dn.DEBUG&&Be("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),fd(n)),this.Fs(e,o,n,pye(s,vp)).next(l=>l))})}vs(e,n){let r=new Nn(qz(e));return n.forEach((s,i)=>{vg(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}bs(e,n,r){return hd()<=dn.DEBUG&&Be("QueryEngine","Using full collection scan to execute query:",fd(n)),this.ys.getDocumentsMatchingQuery(e,n,vi.min(),r)}Fs(e,n,r,s){return this.ys.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KN="LocalStore",pve=3e8;class gve{constructor(e,n,r,s){this.persistence=e,this.Ms=n,this.serializer=s,this.xs=new Qn(Ot),this.Os=new La(i=>vu(i),yg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new k9(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.xs))}}function D9(t,e,n,r){return new gve(t,e,n,r)}async function M9(t,e){const n=qt(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=tn();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({ks:u,removedBatchIds:o,addedBatchIds:l}))})})}function yve(t,e){const n=qt(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Bs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const h=u.batch,f=h.keys();let m=ce.resolve();return f.forEach(g=>{m=m.next(()=>d.getEntry(c,g)).next(x=>{const E=u.docVersions.get(g);Et(E!==null,48541),x.version.compareTo(E)<0&&(h.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),d.addEntry(x)))})}),m.next(()=>l.mutationQueue.removeMutationBatch(c,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=tn();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function L9(t){const e=qt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ti.getLastRemoteSnapshotVersion(n))}function xve(t,e){const n=qt(t),r=e.snapshotVersion;let s=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Bs.newChangeBuffer({trackRemovals:!0});s=n.xs;const l=[];e.targetChanges.forEach((d,h)=>{const f=s.get(h);if(!f)return;l.push(n.Ti.removeMatchingKeys(i,d.removedDocuments,h).next(()=>n.Ti.addMatchingKeys(i,d.addedDocuments,h)));let m=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(Ir.EMPTY_BYTE_STRING,Rt.min()).withLastLimboFreeSnapshotVersion(Rt.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),s=s.insert(h,m),function(x,E,v){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=pve?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(f,m,d)&&l.push(n.Ti.updateTargetData(i,m))});let c=hi(),u=tn();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(vve(i,o,e.documentUpdates).next(d=>{c=d.qs,u=d.Qs})),!r.isEqual(Rt.min())){const d=n.Ti.getLastRemoteSnapshotVersion(i).next(h=>n.Ti.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return ce.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.xs=s,i))}function vve(t,e,n){let r=tn(),s=tn();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=hi();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(Rt.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Be(KN,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{qs:o,Qs:s}})}function wve(t,e){const n=qt(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Qc),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function _ve(t,e){const n=qt(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ti.getTargetData(r,e).next(i=>i?(s=i,ce.resolve(s)):n.Ti.allocateTargetId(r).next(o=>(s=new la(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ti.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.xs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.xs=n.xs.insert(r.targetId,r),n.Os.set(e,r.targetId)),r})}async function ZC(t,e,n){const r=qt(t),s=r.xs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!fc(o))throw o;Be(KN,`Failed to update sequence numbers for target ${e}: ${o}`)}r.xs=r.xs.remove(e),r.Os.delete(s.target)}function e4(t,e,n){const r=qt(t);let s=Rt.min(),i=tn();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const h=qt(c),f=h.Os.get(d);return f!==void 0?ce.resolve(h.xs.get(f)):h.Ti.getTargetData(u,d)}(r,o,Vi(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.Ms.getDocumentsMatchingQuery(o,e,n?s:Rt.min(),n?i:tn())).next(l=>(bve(r,axe(e),l),{documents:l,$s:i})))}function bve(t,e,n){let r=t.Ns.get(e)||Rt.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ns.set(e,r)}class t4{constructor(){this.activeTargetIds=fxe()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class F9{constructor(){this.xo=new t4,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,n,r){this.Oo[e]=n}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new t4,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sve{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4="ConnectivityMonitor";class r4{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Be(n4,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Be(n4,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ly=null;function eT(){return Ly===null?Ly=function(){return 268435456+Math.round(2147483648*Math.random())}():Ly++,"0x"+Ly.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS="RestConnection",Eve={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Cve{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ko=n+"://"+e.host,this.Wo=`projects/${r}/databases/${s}`,this.Go=this.databaseId.database===Qv?`project_id=${r}`:`project_id=${r}&database_id=${s}`}zo(e,n,r,s,i){const o=eT(),l=this.jo(e,n.toUriEncodedString());Be(aS,`Sending RPC '${e}' ${o}:`,l,r);const c={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(c,s,i);const{host:u}=new URL(l),d=uc(u);return this.Jo(e,l,c,r,d).then(h=>(Be(aS,`Received RPC '${e}' ${o}: `,h),h),h=>{throw yu(aS,`RPC '${e}' ${o} failed with error: `,h,"url: ",l,"request:",r),h})}Yo(e,n,r,s,i,o){return this.zo(e,n,r,s,i)}Ho(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Xh}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}jo(e,n){const r=Eve[e];return`${this.Ko}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tve{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ls="WebChannelConnection";class Ive extends Cve{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=eT();return new Promise((l,c)=>{const u=new sz;u.setWithCredentials(!0),u.listenOnce(iz.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Tx.NO_ERROR:const h=u.getResponseJson();Be(ls,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),l(h);break;case Tx.TIMEOUT:Be(ls,`RPC '${e}' ${o} timed out`),c(new at(Ce.DEADLINE_EXCEEDED,"Request time out"));break;case Tx.HTTP_ERROR:const f=u.getStatus();if(Be(ls,`RPC '${e}' ${o} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const x=function(v){const _=v.toLowerCase().replace(/_/g,"-");return Object.values(Ce).indexOf(_)>=0?_:Ce.UNKNOWN}(g.status);c(new at(x,g.message))}else c(new at(Ce.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new at(Ce.UNAVAILABLE,"Connection failed."));break;default:xt(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Be(ls,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);Be(ls,`RPC '${e}' ${o} sending request:`,s),u.send(n,"POST",d,r,15)})}T_(e,n,r){const s=eT(),i=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=lz(),l=az(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Ho(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");Be(ls,`Creating RPC '${e}' stream ${s}: ${d}`,c);const h=o.createWebChannel(d,c);let f=!1,m=!1;const g=new Tve({Zo:E=>{m?Be(ls,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(f||(Be(ls,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),Be(ls,`RPC '${e}' stream ${s} sending:`,E),h.send(E))},Xo:()=>h.close()}),x=(E,v,_)=>{E.listen(v,S=>{try{_(S)}catch(I){setTimeout(()=>{throw I},0)}})};return x(h,nm.EventType.OPEN,()=>{m||(Be(ls,`RPC '${e}' stream ${s} transport opened.`),g.__())}),x(h,nm.EventType.CLOSE,()=>{m||(m=!0,Be(ls,`RPC '${e}' stream ${s} transport closed`),g.u_())}),x(h,nm.EventType.ERROR,E=>{m||(m=!0,yu(ls,`RPC '${e}' stream ${s} transport errored. Name:`,E.name,"Message:",E.message),g.u_(new at(Ce.UNAVAILABLE,"The operation could not be completed")))}),x(h,nm.EventType.MESSAGE,E=>{var v;if(!m){const _=E.data[0];Et(!!_,16349);const S=_,I=(S==null?void 0:S.error)||((v=S[0])===null||v===void 0?void 0:v.error);if(I){Be(ls,`RPC '${e}' stream ${s} received error:`,I);const M=I.status;let j=function(P){const A=wr[P];if(A!==void 0)return i9(A)}(M),C=I.message;j===void 0&&(j=Ce.INTERNAL,C="Unknown error status: "+M+" with message "+I.message),m=!0,g.u_(new at(j,C)),h.close()}else Be(ls,`RPC '${e}' stream ${s} received:`,_),g.c_(_)}}),x(l,oz.STAT_EVENT,E=>{E.stat===jC.PROXY?Be(ls,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===jC.NOPROXY&&Be(ls,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.a_()},0),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nve(){return typeof window<"u"?window:null}function Lx(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s_(t){return new Pxe(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O9{constructor(e,n,r=1e3,s=1.5,i=6e4){this.xi=e,this.timerId=n,this.I_=r,this.E_=s,this.d_=i,this.A_=0,this.R_=null,this.V_=Date.now(),this.reset()}reset(){this.A_=0}m_(){this.A_=this.d_}f_(e){this.cancel();const n=Math.floor(this.A_+this.g_()),r=Math.max(0,Date.now()-this.V_),s=Math.max(0,n-r);s>0&&Be("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.A_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.R_=this.xi.enqueueAfterDelay(this.timerId,s,()=>(this.V_=Date.now(),e())),this.A_*=this.E_,this.A_<this.I_&&(this.A_=this.I_),this.A_>this.d_&&(this.A_=this.d_)}p_(){this.R_!==null&&(this.R_.skipDelay(),this.R_=null)}cancel(){this.R_!==null&&(this.R_.cancel(),this.R_=null)}g_(){return(Math.random()-.5)*this.A_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4="PersistentStream";class V9{constructor(e,n,r,s,i,o,l,c){this.xi=e,this.y_=r,this.w_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.S_=0,this.b_=null,this.D_=null,this.stream=null,this.v_=0,this.C_=new O9(e,n)}F_(){return this.state===1||this.state===5||this.M_()}M_(){return this.state===2||this.state===3}start(){this.v_=0,this.state!==4?this.auth():this.x_()}async stop(){this.F_()&&await this.close(0)}O_(){this.state=0,this.C_.reset()}N_(){this.M_()&&this.b_===null&&(this.b_=this.xi.enqueueAfterDelay(this.y_,6e4,()=>this.B_()))}L_(e){this.k_(),this.stream.send(e)}async B_(){if(this.M_())return this.close(0)}k_(){this.b_&&(this.b_.cancel(),this.b_=null)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}async close(e,n){this.k_(),this.q_(),this.C_.cancel(),this.S_++,e!==4?this.C_.reset():n&&n.code===Ce.RESOURCE_EXHAUSTED?(Is(n.toString()),Is("Using maximum backoff delay to prevent overloading the backend."),this.C_.m_()):n&&n.code===Ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Q_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(n)}Q_(){}auth(){this.state=1;const e=this.U_(this.S_),n=this.S_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.S_===n&&this.K_(r,s)},r=>{e(()=>{const s=new at(Ce.UNKNOWN,"Fetching auth token failed: "+r.message);return this.W_(s)})})}K_(e,n){const r=this.U_(this.S_);this.stream=this.G_(e,n),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.D_=this.xi.enqueueAfterDelay(this.w_,1e4,()=>(this.M_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(s=>{r(()=>this.W_(s))}),this.stream.onMessage(s=>{r(()=>++this.v_==1?this.z_(s):this.onNext(s))})}x_(){this.state=5,this.C_.f_(async()=>{this.state=0,this.start()})}W_(e){return Be(s4,`close with error: ${e}`),this.stream=null,this.close(4,e)}U_(e){return n=>{this.xi.enqueueAndForget(()=>this.S_===e?n():(Be(s4,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Pve extends V9{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}G_(e,n){return this.connection.T_("Listen",e,n)}z_(e){return this.onNext(e)}onNext(e){this.C_.reset();const n=kxe(this.serializer,e),r=function(i){if(!("targetChange"in i))return Rt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Rt.min():o.readTime?Rs(o.readTime):Rt.min()}(e);return this.listener.j_(n,r)}H_(e){const n={};n.database=KC(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=ew(c)?{documents:f9(i,c)}:{query:m9(i,c).gt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=l9(i,o.resumeToken);const u=WC(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(Rt.min())>0){l.readTime=Dh(i,o.snapshotVersion.toTimestamp());const u=WC(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=Dxe(this.serializer,e);r&&(n.labels=r),this.L_(n)}J_(e){const n={};n.database=KC(this.serializer),n.removeTarget=e,this.L_(n)}}class Ave extends V9{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Y_(){return this.v_>0}start(){this.lastStreamToken=void 0,super.start()}Q_(){this.Y_&&this.Z_([])}G_(e,n){return this.connection.T_("Write",e,n)}z_(e){return Et(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Et(!e.writeResults||e.writeResults.length===0,55816),this.listener.X_()}onNext(e){Et(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.C_.reset();const n=jxe(e.writeResults,e.commitTime),r=Rs(e.commitTime);return this.listener.ea(r,n)}ta(){const e={};e.database=KC(this.serializer),this.L_(e)}Z_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>sw(this.serializer,r))};this.L_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rve{}class kve extends Rve{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.na=!1}ra(){if(this.na)throw new at(Ce.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,n,r,s){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.zo(e,qC(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new at(Ce.UNKNOWN,i.toString())})}Yo(e,n,r,s,i){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Yo(e,qC(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new at(Ce.UNKNOWN,o.toString())})}terminate(){this.na=!0,this.connection.terminate()}}class jve{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.ia=0,this.sa=null,this.oa=!0}_a(){this.ia===0&&(this.aa("Unknown"),this.sa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.sa=null,this.ua("Backend didn't respond within 10 seconds."),this.aa("Offline"),Promise.resolve())))}ca(e){this.state==="Online"?this.aa("Unknown"):(this.ia++,this.ia>=1&&(this.la(),this.ua(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.aa("Offline")))}set(e){this.la(),this.ia=0,e==="Online"&&(this.oa=!1),this.aa(e)}aa(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ua(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.oa?(Is(n),this.oa=!1):Be("OnlineStateTracker",n)}la(){this.sa!==null&&(this.sa.cancel(),this.sa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Su="RemoteStore";class Dve{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.ha=[],this.Pa=new Map,this.Ta=new Set,this.Ia=[],this.Ea=i,this.Ea.No(o=>{r.enqueueAndForget(async()=>{Mu(this)&&(Be(Su,"Restarting streams for network reachability change."),await async function(c){const u=qt(c);u.Ta.add(4),await _g(u),u.da.set("Unknown"),u.Ta.delete(4),await i_(u)}(this))})}),this.da=new jve(r,s)}}async function i_(t){if(Mu(t))for(const e of t.Ia)await e(!0)}async function _g(t){for(const e of t.Ia)await e(!1)}function $9(t,e){const n=qt(t);n.Pa.has(e.targetId)||(n.Pa.set(e.targetId,e),QN(n)?XN(n):Zh(n).M_()&&JN(n,e))}function YN(t,e){const n=qt(t),r=Zh(n);n.Pa.delete(e),r.M_()&&U9(n,e),n.Pa.size===0&&(r.M_()?r.N_():Mu(n)&&n.da.set("Unknown"))}function JN(t,e){if(t.Aa.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Rt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Zh(t).H_(e)}function U9(t,e){t.Aa.Ke(e),Zh(t).J_(e)}function XN(t){t.Aa=new Cxe({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Pa.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),Zh(t).start(),t.da._a()}function QN(t){return Mu(t)&&!Zh(t).F_()&&t.Pa.size>0}function Mu(t){return qt(t).Ta.size===0}function B9(t){t.Aa=void 0}async function Mve(t){t.da.set("Online")}async function Lve(t){t.Pa.forEach((e,n)=>{JN(t,e)})}async function Fve(t,e){B9(t),QN(t)?(t.da.ca(e),XN(t)):t.da.set("Unknown")}async function Ove(t,e,n){if(t.da.set("Online"),e instanceof a9&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Pa.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Pa.delete(l),s.Aa.removeTarget(l))}(t,e)}catch(r){Be(Su,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await cw(t,r)}else if(e instanceof Dx?t.Aa.Xe(e):e instanceof o9?t.Aa.ot(e):t.Aa.nt(e),!n.isEqual(Rt.min()))try{const r=await L9(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Aa.It(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.Pa.get(u);d&&i.Pa.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.Pa.get(c);if(!d)return;i.Pa.set(c,d.withResumeToken(Ir.EMPTY_BYTE_STRING,d.snapshotVersion)),U9(i,c);const h=new la(d.target,c,u,d.sequenceNumber);JN(i,h)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Be(Su,"Failed to raise snapshot:",r),await cw(t,r)}}async function cw(t,e,n){if(!fc(e))throw e;t.Ta.add(1),await _g(t),t.da.set("Offline"),n||(n=()=>L9(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Be(Su,"Retrying IndexedDB access"),await n(),t.Ta.delete(1),await i_(t)})}function z9(t,e){return e().catch(n=>cw(t,n,e))}async function bg(t){const e=qt(t),n=Wl(e);let r=e.ha.length>0?e.ha[e.ha.length-1].batchId:Qc;for(;Vve(e);)try{const s=await wve(e.localStore,r);if(s===null){e.ha.length===0&&n.N_();break}r=s.batchId,$ve(e,s)}catch(s){await cw(e,s)}G9(e)&&H9(e)}function Vve(t){return Mu(t)&&t.ha.length<10}function $ve(t,e){t.ha.push(e);const n=Wl(t);n.M_()&&n.Y_&&n.Z_(e.mutations)}function G9(t){return Mu(t)&&!Wl(t).F_()&&t.ha.length>0}function H9(t){Wl(t).start()}async function Uve(t){Wl(t).ta()}async function Bve(t){const e=Wl(t);for(const n of t.ha)e.Z_(n.mutations)}async function zve(t,e,n){const r=t.ha.shift(),s=ON.from(r,e,n);await z9(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await bg(t)}async function Gve(t,e){e&&Wl(t).Y_&&await async function(r,s){if(function(o){return Sxe(o)&&o!==Ce.ABORTED}(s.code)){const i=r.ha.shift();Wl(r).O_(),await z9(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await bg(r)}}(t,e),G9(t)&&H9(t)}async function i4(t,e){const n=qt(t);n.asyncQueue.verifyOperationInProgress(),Be(Su,"RemoteStore received new credentials");const r=Mu(n);n.Ta.add(3),await _g(n),r&&n.da.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ta.delete(3),await i_(n)}async function Hve(t,e){const n=qt(t);e?(n.Ta.delete(2),await i_(n)):e||(n.Ta.add(2),await _g(n),n.da.set("Unknown"))}function Zh(t){return t.Ra||(t.Ra=function(n,r,s){const i=qt(n);return i.ra(),new Pve(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:Mve.bind(null,t),n_:Lve.bind(null,t),i_:Fve.bind(null,t),j_:Ove.bind(null,t)}),t.Ia.push(async e=>{e?(t.Ra.O_(),QN(t)?XN(t):t.da.set("Unknown")):(await t.Ra.stop(),B9(t))})),t.Ra}function Wl(t){return t.Va||(t.Va=function(n,r,s){const i=qt(n);return i.ra(),new Ave(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:Uve.bind(null,t),i_:Gve.bind(null,t),X_:Bve.bind(null,t),ea:zve.bind(null,t)}),t.Ia.push(async e=>{e?(t.Va.O_(),await bg(t)):(await t.Va.stop(),t.ha.length>0&&(Be(Su,`Stopping write stream with ${t.ha.length} pending writes`),t.ha=[]))})),t.Va}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ma,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new ZN(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new at(Ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function eP(t,e){if(Is("AsyncQueue",`${e}: ${t}`),fc(t))return new at(Ce.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{static emptySet(e){return new rh(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||lt.comparator(n.key,r.key):(n,r)=>lt.comparator(n.key,r.key),this.keyedMap=rm(),this.sortedSet=new Qn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof rh)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new rh;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{constructor(){this.ma=new Qn(lt.comparator)}track(e){const n=e.doc.key,r=this.ma.get(n);r?e.type!==0&&r.type===3?this.ma=this.ma.insert(n,e):e.type===3&&r.type!==1?this.ma=this.ma.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ma=this.ma.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ma=this.ma.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ma=this.ma.remove(n):e.type===1&&r.type===2?this.ma=this.ma.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ma=this.ma.insert(n,{type:2,doc:e.doc}):xt(63341,{Vt:e,fa:r}):this.ma=this.ma.insert(n,e)}ga(){const e=[];return this.ma.inorderTraversal((n,r)=>{e.push(r)}),e}}class Mh{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Mh(e,n,rh.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&J0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wve{constructor(){this.pa=void 0,this.ya=[]}wa(){return this.ya.some(e=>e.Sa())}}class qve{constructor(){this.queries=a4(),this.onlineState="Unknown",this.ba=new Set}terminate(){(function(n,r){const s=qt(n),i=s.queries;s.queries=a4(),i.forEach((o,l)=>{for(const c of l.ya)c.onError(r)})})(this,new at(Ce.ABORTED,"Firestore shutting down"))}}function a4(){return new La(t=>Wz(t),J0)}async function W9(t,e){const n=qt(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.wa()&&e.Sa()&&(r=2):(i=new Wve,r=e.Sa()?0:1);try{switch(r){case 0:i.pa=await n.onListen(s,!0);break;case 1:i.pa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=eP(o,`Initialization of query '${fd(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.ya.push(e),e.Da(n.onlineState),i.pa&&e.va(i.pa)&&tP(n)}async function q9(t,e){const n=qt(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ya.indexOf(e);o>=0&&(i.ya.splice(o,1),i.ya.length===0?s=e.Sa()?0:1:!i.wa()&&e.Sa()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Kve(t,e){const n=qt(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.ya)l.va(s)&&(r=!0);o.pa=s}}r&&tP(n)}function Yve(t,e,n){const r=qt(t),s=r.queries.get(e);if(s)for(const i of s.ya)i.onError(n);r.queries.delete(e)}function tP(t){t.ba.forEach(e=>{e.next()})}var tT,l4;(l4=tT||(tT={})).Ca="default",l4.Cache="cache";class K9{constructor(e,n,r){this.query=e,this.Fa=n,this.Ma=!1,this.xa=null,this.onlineState="Unknown",this.options=r||{}}va(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Mh(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Ma?this.Oa(e)&&(this.Fa.next(e),n=!0):this.Na(e,this.onlineState)&&(this.Ba(e),n=!0),this.xa=e,n}onError(e){this.Fa.error(e)}Da(e){this.onlineState=e;let n=!1;return this.xa&&!this.Ma&&this.Na(this.xa,e)&&(this.Ba(this.xa),n=!0),n}Na(e,n){if(!e.fromCache||!this.Sa())return!0;const r=n!=="Offline";return(!this.options.La||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Oa(e){if(e.docChanges.length>0)return!0;const n=this.xa&&this.xa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Ba(e){e=Mh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Ma=!0,this.Fa.next(e)}Sa(){return this.options.source!==tT.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y9{constructor(e){this.key=e}}class J9{constructor(e){this.key=e}}class Jve{constructor(e,n){this.query=e,this.Ga=n,this.za=null,this.hasCachedResults=!1,this.current=!1,this.ja=tn(),this.mutatedKeys=tn(),this.Ha=qz(e),this.Ja=new rh(this.Ha)}get Ya(){return this.Ga}Za(e,n){const r=n?n.Xa:new o4,s=n?n.Ja:this.Ja;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,h)=>{const f=s.get(d),m=vg(this.query,h)?h:null,g=!!f&&this.mutatedKeys.has(f.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let E=!1;f&&m?f.data.isEqual(m.data)?g!==x&&(r.track({type:3,doc:m}),E=!0):this.eu(f,m)||(r.track({type:2,doc:m}),E=!0,(c&&this.Ha(m,c)>0||u&&this.Ha(m,u)<0)&&(l=!0)):!f&&m?(r.track({type:0,doc:m}),E=!0):f&&!m&&(r.track({type:1,doc:f}),E=!0,(c||u)&&(l=!0)),E&&(m?(o=o.add(m),i=x?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ja:o,Xa:r,Cs:l,mutatedKeys:i}}eu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ja;this.Ja=e.Ja,this.mutatedKeys=e.mutatedKeys;const o=e.Xa.ga();o.sort((d,h)=>function(m,g){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xt(20277,{Vt:E})}};return x(m)-x(g)}(d.type,h.type)||this.Ha(d.doc,h.doc)),this.tu(r),s=s!=null&&s;const l=n&&!s?this.nu():[],c=this.ja.size===0&&this.current&&!s?1:0,u=c!==this.za;return this.za=c,o.length!==0||u?{snapshot:new Mh(this.query,e.Ja,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),ru:l}:{ru:l}}Da(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ja:this.Ja,Xa:new o4,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ru:[]}}iu(e){return!this.Ga.has(e)&&!!this.Ja.has(e)&&!this.Ja.get(e).hasLocalMutations}tu(e){e&&(e.addedDocuments.forEach(n=>this.Ga=this.Ga.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ga=this.Ga.delete(n)),this.current=e.current)}nu(){if(!this.current)return[];const e=this.ja;this.ja=tn(),this.Ja.forEach(r=>{this.iu(r.key)&&(this.ja=this.ja.add(r.key))});const n=[];return e.forEach(r=>{this.ja.has(r)||n.push(new J9(r))}),this.ja.forEach(r=>{e.has(r)||n.push(new Y9(r))}),n}su(e){this.Ga=e.$s,this.ja=tn();const n=this.Za(e.documents);return this.applyChanges(n,!0)}ou(){return Mh.fromInitialDocuments(this.query,this.Ja,this.mutatedKeys,this.za===0,this.hasCachedResults)}}const nP="SyncEngine";class Xve{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Qve{constructor(e){this.key=e,this._u=!1}}class Zve{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.au={},this.uu=new La(l=>Wz(l),J0),this.cu=new Map,this.lu=new Set,this.hu=new Qn(lt.comparator),this.Pu=new Map,this.Tu=new GN,this.Iu={},this.Eu=new Map,this.du=bu.lr(),this.onlineState="Unknown",this.Au=void 0}get isPrimaryClient(){return this.Au===!0}}async function ewe(t,e,n=!0){const r=nG(t);let s;const i=r.uu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.ou()):s=await X9(r,e,n,!0),s}async function twe(t,e){const n=nG(t);await X9(n,e,!0,!1)}async function X9(t,e,n,r){const s=await _ve(t.localStore,Vi(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await nwe(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&$9(t.remoteStore,s),l}async function nwe(t,e,n,r,s){t.Ru=(h,f,m)=>async function(x,E,v,_){let S=E.view.Za(v);S.Cs&&(S=await e4(x.localStore,E.query,!1).then(({documents:C})=>E.view.Za(C,S)));const I=_&&_.targetChanges.get(E.targetId),M=_&&_.targetMismatches.get(E.targetId)!=null,j=E.view.applyChanges(S,x.isPrimaryClient,I,M);return u4(x,E.targetId,j.ru),j.snapshot}(t,h,f,m);const i=await e4(t.localStore,e,!0),o=new Jve(e,i.$s),l=o.Za(i.documents),c=wg.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);u4(t,n,u.ru);const d=new Xve(e,n,o);return t.uu.set(e,d),t.cu.has(n)?t.cu.get(n).push(e):t.cu.set(n,[e]),u.snapshot}async function rwe(t,e,n){const r=qt(t),s=r.uu.get(e),i=r.cu.get(s.targetId);if(i.length>1)return r.cu.set(s.targetId,i.filter(o=>!J0(o,e))),void r.uu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ZC(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&YN(r.remoteStore,s.targetId),nT(r,s.targetId)}).catch(Du)):(nT(r,s.targetId),await ZC(r.localStore,s.targetId,!0))}async function swe(t,e){const n=qt(t),r=n.uu.get(e),s=n.cu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),YN(n.remoteStore,r.targetId))}async function iwe(t,e,n){const r=rG(t);try{const s=await function(o,l){const c=qt(o),u=ir.now(),d=l.reduce((m,g)=>m.add(g.key),tn());let h,f;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=hi(),x=tn();return c.Bs.getEntries(m,d).next(E=>{g=E,g.forEach((v,_)=>{_.isValidDocument()||(x=x.add(v))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,g)).next(E=>{h=E;const v=[];for(const _ of l){const S=_xe(_,h.get(_.key).overlayedDocument);S!=null&&v.push(new Fa(_.key,S,Fz(S.value.mapValue),Ps.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,v,l)}).next(E=>{f=E;const v=E.applyToLocalDocumentSet(h,x);return c.documentOverlayCache.saveOverlays(m,E.batchId,v)})}).then(()=>({batchId:f.batchId,changes:Yz(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Iu[o.currentUser.toKey()];u||(u=new Qn(Ot)),u=u.insert(l,c),o.Iu[o.currentUser.toKey()]=u}(r,s.batchId,n),await Sg(r,s.changes),await bg(r.remoteStore)}catch(s){const i=eP(s,"Failed to persist write");n.reject(i)}}async function Q9(t,e){const n=qt(t);try{const r=await xve(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Pu.get(i);o&&(Et(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o._u=!0:s.modifiedDocuments.size>0?Et(o._u,14607):s.removedDocuments.size>0&&(Et(o._u,42227),o._u=!1))}),await Sg(n,r,e)}catch(r){await Du(r)}}function c4(t,e,n){const r=qt(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.uu.forEach((i,o)=>{const l=o.view.Da(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=qt(o);c.onlineState=l;let u=!1;c.queries.forEach((d,h)=>{for(const f of h.ya)f.Da(l)&&(u=!0)}),u&&tP(c)}(r.eventManager,e),s.length&&r.au.j_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function owe(t,e,n){const r=qt(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Pu.get(e),i=s&&s.key;if(i){let o=new Qn(lt.comparator);o=o.insert(i,dr.newNoDocument(i,Rt.min()));const l=tn().add(i),c=new e_(Rt.min(),new Map,new Qn(Ot),o,l);await Q9(r,c),r.hu=r.hu.remove(i),r.Pu.delete(e),rP(r)}else await ZC(r.localStore,e,!1).then(()=>nT(r,e,n)).catch(Du)}async function awe(t,e){const n=qt(t),r=e.batch.batchId;try{const s=await yve(n.localStore,e);eG(n,r,null),Z9(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Sg(n,s)}catch(s){await Du(s)}}async function lwe(t,e,n){const r=qt(t);try{const s=await function(o,l){const c=qt(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(h=>(Et(h!==null,37113),d=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);eG(r,e,n),Z9(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Sg(r,s)}catch(s){await Du(s)}}function Z9(t,e){(t.Eu.get(e)||[]).forEach(n=>{n.resolve()}),t.Eu.delete(e)}function eG(t,e,n){const r=qt(t);let s=r.Iu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Iu[r.currentUser.toKey()]=s}}function nT(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.cu.get(e))t.uu.delete(r),n&&t.au.Vu(r,n);t.cu.delete(e),t.isPrimaryClient&&t.Tu.Hr(e).forEach(r=>{t.Tu.containsKey(r)||tG(t,r)})}function tG(t,e){t.lu.delete(e.path.canonicalString());const n=t.hu.get(e);n!==null&&(YN(t.remoteStore,n),t.hu=t.hu.remove(e),t.Pu.delete(n),rP(t))}function u4(t,e,n){for(const r of n)r instanceof Y9?(t.Tu.addReference(r.key,e),cwe(t,r)):r instanceof J9?(Be(nP,"Document no longer in limbo: "+r.key),t.Tu.removeReference(r.key,e),t.Tu.containsKey(r.key)||tG(t,r.key)):xt(19791,{mu:r})}function cwe(t,e){const n=e.key,r=n.path.canonicalString();t.hu.get(n)||t.lu.has(r)||(Be(nP,"New document in limbo: "+n),t.lu.add(r),rP(t))}function rP(t){for(;t.lu.size>0&&t.hu.size<t.maxConcurrentLimboResolutions;){const e=t.lu.values().next().value;t.lu.delete(e);const n=new lt(En.fromString(e)),r=t.du.next();t.Pu.set(r,new Qve(n)),t.hu=t.hu.insert(n,r),$9(t.remoteStore,new la(Vi(Y0(n.path)),r,"TargetPurposeLimboResolution",Li.le))}}async function Sg(t,e,n){const r=qt(t),s=[],i=[],o=[];r.uu.isEmpty()||(r.uu.forEach((l,c)=>{o.push(r.Ru(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const h=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){s.push(u);const h=qN.Rs(c.targetId,u);i.push(h)}}))}),await Promise.all(o),r.au.j_(s),await async function(c,u){const d=qt(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ce.forEach(u,f=>ce.forEach(f.ds,m=>d.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>ce.forEach(f.As,m=>d.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!fc(h))throw h;Be(KN,"Failed to update sequence numbers: "+h)}for(const h of u){const f=h.targetId;if(!h.fromCache){const m=d.xs.get(f),g=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(g);d.xs=d.xs.insert(f,x)}}}(r.localStore,i))}async function uwe(t,e){const n=qt(t);if(!n.currentUser.isEqual(e)){Be(nP,"User change. New user:",e.toKey());const r=await M9(n.localStore,e);n.currentUser=e,function(i,o){i.Eu.forEach(l=>{l.forEach(c=>{c.reject(new at(Ce.CANCELLED,o))})}),i.Eu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Sg(n,r.ks)}}function dwe(t,e){const n=qt(t),r=n.Pu.get(e);if(r&&r._u)return tn().add(r.key);{let s=tn();const i=n.cu.get(e);if(!i)return s;for(const o of i){const l=n.uu.get(o);s=s.unionWith(l.view.Ya)}return s}}function nG(t){const e=qt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Q9.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=dwe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=owe.bind(null,e),e.au.j_=Kve.bind(null,e.eventManager),e.au.Vu=Yve.bind(null,e.eventManager),e}function rG(t){const e=qt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=awe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lwe.bind(null,e),e}class Rp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=s_(e.databaseInfo.databaseId),this.sharedClientState=this.pu(e),this.persistence=this.yu(e),await this.persistence.start(),this.localStore=this.wu(e),this.gcScheduler=this.Su(e,this.localStore),this.indexBackfillerScheduler=this.bu(e,this.localStore)}Su(e,n){return null}bu(e,n){return null}wu(e){return D9(this.persistence,new j9,e.initialUser,this.serializer)}yu(e){return new HN(r_.fi,this.serializer)}pu(e){return new F9}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Rp.provider={build:()=>new Rp};class hwe extends Rp{constructor(e){super(),this.cacheSizeBytes=e}Su(e,n){Et(this.persistence.referenceDelegate instanceof lw,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new N9(r,e.asyncQueue,n)}yu(e){const n=this.cacheSizeBytes!==void 0?ds.withCacheSize(this.cacheSizeBytes):ds.DEFAULT;return new HN(r=>lw.fi(r,n),this.serializer)}}class fwe extends Rp{constructor(e,n,r){super(),this.Du=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Du.initialize(this,e),await rG(this.Du.syncEngine),await bg(this.Du.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}wu(e){return D9(this.persistence,new j9,e.initialUser,this.serializer)}Su(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new N9(r,e.asyncQueue,n)}bu(e,n){const r=new vye(n,this.persistence);return new xye(e.asyncQueue,r)}yu(e){const n=fve(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?ds.withCacheSize(this.cacheSizeBytes):ds.DEFAULT;return new WN(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Nve(),Lx(),this.serializer,this.sharedClientState,!!this.forceOwnership)}pu(e){return new F9}}class uw{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>c4(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=uwe.bind(null,this.syncEngine),await Hve(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new qve}()}createDatastore(e){const n=s_(e.databaseInfo.databaseId),r=function(i){return new Ive(i)}(e.databaseInfo);return function(i,o,l,c){return new kve(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new Dve(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>c4(this.syncEngine,n,0),function(){return r4.C()?new r4:new Sve}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,d){const h=new Zve(s,i,o,l,c,u);return d&&(h.Au=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=qt(s);Be(Su,"RemoteStore shutting down."),i.Ta.add(5),await _g(i),i.Ea.shutdown(),i.da.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}uw.provider={build:()=>new uw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sG{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.vu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.vu(this.observer.error,e):Is("Uncaught Error in snapshot listener:",e.toString()))}Cu(){this.muted=!0}vu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ql="FirestoreClient";class mwe{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Yr.UNAUTHENTICATED,this.clientId=hz.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Be(ql,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Be(ql,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ma;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=eP(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function lS(t,e){t.asyncQueue.verifyOperationInProgress(),Be(ql,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await M9(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function d4(t,e){t.asyncQueue.verifyOperationInProgress();const n=await pwe(t);Be(ql,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>i4(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>i4(e.remoteStore,s)),t._onlineComponents=e}async function pwe(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Be(ql,"Using user provided OfflineComponentProvider");try{await lS(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===Ce.FAILED_PRECONDITION||s.code===Ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;yu("Error using user provided cache. Falling back to memory cache: "+n),await lS(t,new Rp)}}else Be(ql,"Using default OfflineComponentProvider"),await lS(t,new hwe(void 0));return t._offlineComponents}async function iG(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Be(ql,"Using user provided OnlineComponentProvider"),await d4(t,t._uninitializedComponentsProvider._online)):(Be(ql,"Using default OnlineComponentProvider"),await d4(t,new uw))),t._onlineComponents}function gwe(t){return iG(t).then(e=>e.syncEngine)}async function rT(t){const e=await iG(t),n=e.eventManager;return n.onListen=ewe.bind(null,e.syncEngine),n.onUnlisten=rwe.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=twe.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=swe.bind(null,e.syncEngine),n}function ywe(t,e,n={}){const r=new ma;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new sG({next:f=>{d.Cu(),o.enqueueAndForget(()=>q9(i,h)),f.fromCache&&c.source==="server"?u.reject(new at(Ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new K9(l,d,{includeMetadataChanges:!0,La:!0});return W9(i,h)}(await rT(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oG(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aG(t,e,n){if(!n)throw new at(Ce.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function xwe(t,e,n,r){if(e===!0&&r===!0)throw new at(Ce.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function f4(t){if(!lt.isDocumentKey(t))throw new at(Ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function m4(t){if(lt.isDocumentKey(t))throw new at(Ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function o_(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":xt(12329,{type:typeof t})}function $i(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new at(Ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=o_(t);throw new at(Ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function vwe(t,e){if(e<=0)throw new at(Ce.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lG="firestore.googleapis.com",p4=!0;class g4{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new at(Ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=lG,this.ssl=p4}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:p4;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=E9;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Jxe)throw new at(Ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}xwe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=oG((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new at(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new at(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new at(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class a_{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new g4({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new at(Ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new at(Ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new g4(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new oye;switch(r.type){case"firstParty":return new uye(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new at(Ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=h4.get(n);r&&(Be("ComponentProvider","Removing Datastore"),h4.delete(n),r.terminate())}(this),Promise.resolve()}}function wwe(t,e,n,r={}){var s;t=$i(t,a_);const i=uc(e),o=t._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),c=`${e}:${n}`;i&&(L0(`https://${c}`),F0("Firestore",!0)),o.host!==lG&&o.host!==c&&yu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},o),{host:c,ssl:i,emulatorOptions:r});if(!fu(u,l)&&(t._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=Yr.MOCK_USER;else{d=fB(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new at(Ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Yr(f)}t._authCredentials=new aye(new uz(d,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new pc(this.firestore,e,this._query)}}class ks{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new jl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ks(this.firestore,e,this._key)}}class jl extends pc{constructor(e,n,r){super(e,n,Y0(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ks(this.firestore,null,new lt(e))}withConverter(e){return new jl(this.firestore,e,this._path)}}function Pc(t,e,...n){if(t=Vn(t),aG("collection","path",e),t instanceof a_){const r=En.fromString(e,...n);return m4(r),new jl(t,null,r)}{if(!(t instanceof ks||t instanceof jl))throw new at(Ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(En.fromString(e,...n));return m4(r),new jl(t.firestore,null,r)}}function Pi(t,e,...n){if(t=Vn(t),arguments.length===1&&(e=hz.newId()),aG("doc","path",e),t instanceof a_){const r=En.fromString(e,...n);return f4(r),new ks(t,null,new lt(r))}{if(!(t instanceof ks||t instanceof jl))throw new at(Ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(En.fromString(e,...n));return f4(r),new ks(t.firestore,t instanceof jl?t.converter:null,new lt(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4="AsyncQueue";class x4{constructor(e=Promise.resolve()){this.zu=[],this.ju=!1,this.Hu=[],this.Ju=null,this.Yu=!1,this.Zu=!1,this.Xu=[],this.C_=new O9(this,"async_queue_retry"),this.ec=()=>{const r=Lx();r&&Be(y4,"Visibility state changed to "+r.visibilityState),this.C_.p_()},this.tc=e;const n=Lx();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.ec)}get isShuttingDown(){return this.ju}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nc(),this.rc(e)}enterRestrictedMode(e){if(!this.ju){this.ju=!0,this.Zu=e||!1;const n=Lx();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.ec)}}enqueue(e){if(this.nc(),this.ju)return new Promise(()=>{});const n=new ma;return this.rc(()=>this.ju&&this.Zu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.zu.push(e),this.sc()))}async sc(){if(this.zu.length!==0){try{await this.zu[0](),this.zu.shift(),this.C_.reset()}catch(e){if(!fc(e))throw e;Be(y4,"Operation failed with retryable error: "+e)}this.zu.length>0&&this.C_.f_(()=>this.sc())}}rc(e){const n=this.tc.then(()=>(this.Yu=!0,e().catch(r=>{throw this.Ju=r,this.Yu=!1,Is("INTERNAL UNHANDLED ERROR: ",v4(r)),r}).then(r=>(this.Yu=!1,r))));return this.tc=n,n}enqueueAfterDelay(e,n,r){this.nc(),this.Xu.indexOf(e)>-1&&(n=0);const s=ZN.createAndSchedule(this,e,n,r,i=>this.oc(i));return this.Hu.push(s),s}nc(){this.Ju&&xt(47125,{_c:v4(this.Ju)})}verifyOperationInProgress(){}async ac(){let e;do e=this.tc,await e;while(e!==this.tc)}uc(e){for(const n of this.Hu)if(n.timerId===e)return!0;return!1}cc(e){return this.ac().then(()=>{this.Hu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Hu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.ac()})}lc(e){this.Xu.push(e)}oc(e){const n=this.Hu.indexOf(e);this.Hu.splice(n,1)}}function v4(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w4(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _we=-1;class Kl extends a_{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new x4,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new x4(e),this._firestoreClient=void 0,await e}}}function bwe(t,e){const n=typeof t=="object"?t:O0(),r=typeof t=="string"?t:e||Qv,s=dg(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=mN("firestore");i&&wwe(s,...i)}return s}function sP(t){if(t._terminated)throw new at(Ce.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||cG(t),t._firestoreClient}function cG(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new Kye(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,oG(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new mwe(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function Swe(t,e){yu("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return Ewe(t,uw.provider,{build:r=>new fwe(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function Ewe(t,e,n){if((t=$i(t,Kl))._firestoreClient||t._terminated)throw new at(Ce.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new at(Ce.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},cG(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Lh(Ir.fromBase64String(e))}catch(n){throw new at(Ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Lh(Ir.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new at(Ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new rr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new at(Ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new at(Ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ot(this._lat,e._lat)||Ot(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cwe=/^__.*__$/;class Twe{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Fa(e,this.data,this.fieldMask,n,this.fieldTransforms):new Qh(e,this.data,n,this.fieldTransforms)}}class uG{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Fa(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function dG(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xt(40011,{hc:t})}}class lP{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Pc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get hc(){return this.settings.hc}Tc(e){return new lP(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ic(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tc({path:r,Ec:!1});return s.dc(e),s}Ac(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tc({path:r,Ec:!1});return s.Pc(),s}Rc(e){return this.Tc({path:void 0,Ec:!0})}Vc(e){return dw(e,this.settings.methodName,this.settings.mc||!1,this.path,this.settings.fc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pc(){if(this.path)for(let e=0;e<this.path.length;e++)this.dc(this.path.get(e))}dc(e){if(e.length===0)throw this.Vc("Document fields must not be empty");if(dG(this.hc)&&Cwe.test(e))throw this.Vc('Document fields cannot begin and end with "__"')}}class Iwe{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||s_(e)}gc(e,n,r,s=!1){return new lP({hc:e,methodName:n,fc:r,path:rr.emptyPath(),Ec:!1,mc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function cP(t){const e=t._freezeSettings(),n=s_(t._databaseId);return new Iwe(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Nwe(t,e,n,r,s,i={}){const o=t.gc(i.merge||i.mergeFields?2:0,e,n,s);uP("Data must be an object, but it was:",o,r);const l=hG(r,o);let c,u;if(i.merge)c=new Hs(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const f=sT(e,h,n);if(!o.contains(f))throw new at(Ce.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);mG(d,f)||d.push(f)}c=new Hs(d),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new Twe(new ms(l),c,u)}class c_ extends iP{_toFieldTransform(e){if(e.hc!==2)throw e.hc===1?e.Vc(`${this._methodName}() can only appear at the top level of your update data`):e.Vc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof c_}}function Pwe(t,e,n,r){const s=t.gc(1,e,n);uP("Data must be an object, but it was:",s,r);const i=[],o=ms.empty();mc(r,(c,u)=>{const d=dP(e,c,n);u=Vn(u);const h=s.Ac(d);if(u instanceof c_)i.push(d);else{const f=Eg(u,h);f!=null&&(i.push(d),o.set(d,f))}});const l=new Hs(i);return new uG(o,l,s.fieldTransforms)}function Awe(t,e,n,r,s,i){const o=t.gc(1,e,n),l=[sT(e,r,n)],c=[s];if(i.length%2!=0)throw new at(Ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)l.push(sT(e,i[f])),c.push(i[f+1]);const u=[],d=ms.empty();for(let f=l.length-1;f>=0;--f)if(!mG(u,l[f])){const m=l[f];let g=c[f];g=Vn(g);const x=o.Ac(m);if(g instanceof c_)u.push(m);else{const E=Eg(g,x);E!=null&&(u.push(m),d.set(m,E))}}const h=new Hs(u);return new uG(d,h,o.fieldTransforms)}function Rwe(t,e,n,r=!1){return Eg(n,t.gc(r?4:3,e))}function Eg(t,e){if(fG(t=Vn(t)))return uP("Unsupported field value:",e,t),hG(t,e);if(t instanceof iP)return function(r,s){if(!dG(s.hc))throw s.Vc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Vc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Ec&&e.hc!==4)throw e.Vc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=Eg(l,s.Rc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Vn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return mxe(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ir.fromDate(r);return{timestampValue:Dh(s.serializer,i)}}if(r instanceof ir){const i=new ir(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Dh(s.serializer,i)}}if(r instanceof oP)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Lh)return{bytesValue:l9(s.serializer,r._byteString)};if(r instanceof ks){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Vc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:UN(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof aP)return function(o,l){return{mapValue:{fields:{[jN]:{stringValue:DN},[Nh]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Vc("VectorValues must only contain numeric values.");return LN(l.serializer,u)})}}}}}}(r,s);throw s.Vc(`Unsupported field value: ${o_(r)}`)}(t,e)}function hG(t,e){const n={};return Nz(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):mc(t,(r,s)=>{const i=Eg(s,e.Ic(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function fG(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ir||t instanceof oP||t instanceof Lh||t instanceof ks||t instanceof iP||t instanceof aP)}function uP(t,e,n){if(!fG(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=o_(n);throw r==="an object"?e.Vc(t+" a custom object"):e.Vc(t+" "+r)}}function sT(t,e,n){if((e=Vn(e))instanceof l_)return e._internalPath;if(typeof e=="string")return dP(t,e);throw dw("Field path arguments must be of type string or ",t,!1,void 0,n)}const kwe=new RegExp("[~\\*/\\[\\]]");function dP(t,e,n){if(e.search(kwe)>=0)throw dw(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new l_(...e.split("."))._internalPath}catch{throw dw(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function dw(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new at(Ce.INVALID_ARGUMENT,l+t+c)}function mG(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pG{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ks(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new jwe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(hP("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class jwe extends pG{data(){return super.data()}}function hP(t,e){return typeof e=="string"?dP(t,e):e instanceof l_?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gG(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new at(Ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class fP{}class yG extends fP{}function iT(t,e,...n){let r=[];e instanceof fP&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof mP).length,l=i.filter(c=>c instanceof u_).length;if(o>1||o>0&&l>0)throw new at(Ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class u_ extends yG{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new u_(e,n,r)}_apply(e){const n=this._parse(e);return xG(e._query,n),new pc(e.firestore,e.converter,HC(e._query,n))}_parse(e){const n=cP(e.firestore);return function(i,o,l,c,u,d,h){let f;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new at(Ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){b4(h,d);const g=[];for(const x of h)g.push(_4(c,i,x));f={arrayValue:{values:g}}}else f=_4(c,i,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||b4(h,d),f=Rwe(l,o,h,d==="in"||d==="not-in");return hn.create(u,d,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function oT(t,e,n){const r=e,s=hP("where",t);return u_._create(s,r,n)}class mP extends fP{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new mP(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Tn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)xG(o,c),o=HC(o,c)}(e._query,n),new pc(e.firestore,e.converter,HC(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class pP extends yG{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new pP(e,n,r)}_apply(e){return new pc(e.firestore,e.converter,nw(e._query,this._limit,this._limitType))}}function Dwe(t){return vwe("limit",t),pP._create("limit",t,"F")}function _4(t,e,n){if(typeof(n=Vn(n))=="string"){if(n==="")throw new at(Ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Hz(e)&&n.indexOf("/")!==-1)throw new at(Ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(En.fromString(n));if(!lt.isDocumentKey(r))throw new at(Ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ip(t,new lt(r))}if(n instanceof ks)return Ip(t,n._key);throw new at(Ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${o_(n)}.`)}function b4(t,e){if(!Array.isArray(t)||t.length===0)throw new at(Ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function xG(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new at(Ce.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new at(Ce.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Mwe{convertValue(e,n="none"){switch(Gl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Kn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Na(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw xt(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return mc(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[Nh].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Kn(o.doubleValue));return new aP(i)}convertGeoPoint(e){return new oP(Kn(e.latitude),Kn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=q0(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Cp(e));default:return null}}convertTimestamp(e){const n=Ia(e);return new ir(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=En.fromString(e);Et(x9(r),9688,{name:e});const s=new xu(r.get(1),r.get(3)),i=new lt(r.popFirst(5));return s.isEqual(n)||Is(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lwe(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class vG extends pG{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Fx(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(hP("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Fx extends vG{data(e={}){return super.data(e)}}class wG{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new om(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Fx(this._firestore,this._userDataWriter,r.key,r,new om(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new at(Ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new Fx(s._firestore,s._userDataWriter,l.doc.key,l.doc,new om(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new Fx(s._firestore,s._userDataWriter,l.doc.key,l.doc,new om(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:Fwe(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function Fwe(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xt(61501,{type:t})}}class gP extends Mwe{constructor(e){super(),this.firestore=e}convertBytes(e){return new Lh(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ks(this.firestore,null,n)}}function Ac(t){t=$i(t,pc);const e=$i(t.firestore,Kl),n=sP(e),r=new gP(e);return gG(t._query),ywe(n,t._query).then(s=>new wG(e,r,t,s))}function Ox(t,e,n){t=$i(t,ks);const r=$i(t.firestore,Kl),s=Lwe(t.converter,e,n);return yP(r,[Nwe(cP(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Ps.none())])}function Fy(t,e,n,...r){t=$i(t,ks);const s=$i(t.firestore,Kl),i=cP(s);let o;return o=typeof(e=Vn(e))=="string"||e instanceof l_?Awe(i,"updateDoc",t._key,e,n,r):Pwe(i,"updateDoc",t._key,e),yP(s,[o.toMutation(t._key,Ps.exists(!0))])}function cS(t){return yP($i(t.firestore,Kl),[new Z0(t._key,Ps.none())])}function Owe(t,...e){var n,r,s;t=Vn(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||w4(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(w4(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let c,u,d;if(t instanceof ks)u=$i(t.firestore,Kl),d=Y0(t._key.path),c={next:h=>{e[o]&&e[o](Vwe(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=$i(t,pc);u=$i(h.firestore,Kl),d=h._query;const f=new gP(u);c={next:m=>{e[o]&&e[o](new wG(u,f,h,m))},error:e[o+1],complete:e[o+2]},gG(t._query)}return function(f,m,g,x){const E=new sG(x),v=new K9(m,E,g);return f.asyncQueue.enqueueAndForget(async()=>W9(await rT(f),v)),()=>{E.Cu(),f.asyncQueue.enqueueAndForget(async()=>q9(await rT(f),v))}}(sP(u),d,l,c)}function yP(t,e){return function(r,s){const i=new ma;return r.asyncQueue.enqueueAndForget(async()=>iwe(await gwe(r),s,i)),i.promise}(sP(t),e)}function Vwe(t,e,n){const r=n.docs.get(e._key),s=new gP(t);return new vG(t,s,e._key,r,new om(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){Xh=s})(ku),zl(new Ea("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new Kl(new lye(r.getProvider("auth-internal")),new dye(o,r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new at(Ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xu(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Oi(eM,tM,e),Oi(eM,tM,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _G="firebasestorage.googleapis.com",bG="storageBucket",$we=2*60*1e3,Uwe=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr extends vo{constructor(e,n,r=0){super(uS(e),`Firebase Storage: ${n} (${uS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,mr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return uS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var fr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(fr||(fr={}));function uS(t){return"storage/"+t}function xP(){const t="An unknown error occurred, please check the error payload for server response.";return new mr(fr.UNKNOWN,t)}function Bwe(t){return new mr(fr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function zwe(t){return new mr(fr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Gwe(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new mr(fr.UNAUTHENTICATED,t)}function Hwe(){return new mr(fr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Wwe(t){return new mr(fr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function qwe(){return new mr(fr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Kwe(){return new mr(fr.CANCELED,"User canceled the upload/download.")}function Ywe(t){return new mr(fr.INVALID_URL,"Invalid URL '"+t+"'.")}function Jwe(t){return new mr(fr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Xwe(){return new mr(fr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+bG+"' property when initializing the app?")}function Qwe(){return new mr(fr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Zwe(){return new mr(fr.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function e0e(t){return new mr(fr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function aT(t){return new mr(fr.INVALID_ARGUMENT,t)}function SG(){return new mr(fr.APP_DELETED,"The Firebase app was deleted.")}function t0e(t){return new mr(fr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Om(t,e){return new mr(fr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Lf(t){throw new mr(fr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=fi.makeFromUrl(e,n)}catch{return new fi(e,"")}if(r.path==="")return r;throw Jwe(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function u(I){I.path_=decodeURIComponent(I.path)}const d="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${d}/b/${s}/o${f}`,"i"),g={bucket:1,path:3},x=n===_G?"(?:storage.googleapis.com|storage.cloud.google.com)":n,E="([^?#]*)",v=new RegExp(`^https?://${x}/${s}/${E}`,"i"),S=[{regex:l,indices:c,postModify:i},{regex:m,indices:g,postModify:u},{regex:v,indices:{bucket:1,path:2},postModify:u}];for(let I=0;I<S.length;I++){const M=S[I],j=M.regex.exec(e);if(j){const C=j[M.indices.bucket];let T=j[M.indices.path];T||(T=""),r=new fi(C,T),M.postModify(r);break}}if(r==null)throw Ywe(e);return r}}class n0e{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r0e(t,e,n){let r=1,s=null,i=null,o=!1,l=0;function c(){return l===2}let u=!1;function d(...E){u||(u=!0,e.apply(null,E))}function h(E){s=setTimeout(()=>{s=null,t(m,c())},E)}function f(){i&&clearTimeout(i)}function m(E,...v){if(u){f();return}if(E){f(),d.call(null,E,...v);return}if(c()||o){f(),d.call(null,E,...v);return}r<64&&(r*=2);let S;l===1?(l=2,S=0):S=(r+Math.random())*1e3,h(S)}let g=!1;function x(E){g||(g=!0,f(),!u&&(s!==null?(E||(l=2),clearTimeout(s),h(0)):E||(l=1)))}return h(0),i=setTimeout(()=>{o=!0,x(!0)},n),x}function s0e(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i0e(t){return t!==void 0}function o0e(t){return typeof t=="object"&&!Array.isArray(t)}function vP(t){return typeof t=="string"||t instanceof String}function S4(t){return wP()&&t instanceof Blob}function wP(){return typeof Blob<"u"}function E4(t,e,n,r){if(r<e)throw aT(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw aT(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _P(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function EG(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var tu;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(tu||(tu={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a0e(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0e{constructor(e,n,r,s,i,o,l,c,u,d,h,f=!0,m=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,x)=>{this.resolve_=g,this.reject_=x,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Oy(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===tu.NO_ERROR,c=i.getStatus();if(!l||a0e(c,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===tu.ABORT;r(!1,new Oy(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new Oy(u,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());i0e(c)?i(c):i()}catch(c){o(c)}else if(l!==null){const c=xP();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(s.canceled){const c=this.appDelete_?SG():Kwe();o(c)}else{const c=qwe();o(c)}};this.canceled_?n(!1,new Oy(!1,null,!0)):this.backoffId_=r0e(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&s0e(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Oy{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function c0e(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function u0e(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function d0e(t,e){e&&(t["X-Firebase-GMPID"]=e)}function h0e(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function f0e(t,e,n,r,s,i,o=!0,l=!1){const c=EG(t.urlParams),u=t.url+c,d=Object.assign({},t.headers);return d0e(d,e),c0e(d,n),u0e(d,i),h0e(d,r),new l0e(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0e(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function p0e(...t){const e=m0e();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(wP())return new Blob(t);throw new mr(fr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function g0e(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0e(t){if(typeof atob>"u")throw e0e("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jo={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class dS{constructor(e,n){this.data=e,this.contentType=n||null}}function x0e(t,e){switch(t){case jo.RAW:return new dS(CG(e));case jo.BASE64:case jo.BASE64URL:return new dS(TG(t,e));case jo.DATA_URL:return new dS(w0e(e),_0e(e))}throw xP()}function CG(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function v0e(t){let e;try{e=decodeURIComponent(t)}catch{throw Om(jo.DATA_URL,"Malformed data URL.")}return CG(e)}function TG(t,e){switch(t){case jo.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Om(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case jo.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Om(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=y0e(e)}catch(s){throw s.message.includes("polyfill")?s:Om(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class IG{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Om(jo.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=b0e(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function w0e(t){const e=new IG(t);return e.base64?TG(jo.BASE64,e.rest):v0e(e.rest)}function _0e(t){return new IG(t).contentType}function b0e(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e,n){let r=0,s="";S4(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(S4(this.data_)){const r=this.data_,s=g0e(r,e,n);return s===null?null:new hl(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new hl(r,!0)}}static getBlob(...e){if(wP()){const n=e.map(r=>r instanceof hl?r.data_:r);return new hl(p0e.apply(null,n))}else{const n=e.map(o=>vP(o)?x0e(jo.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new hl(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NG(t){let e;try{e=JSON.parse(t)}catch{return null}return o0e(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0e(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function E0e(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function PG(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C0e(t,e){return e}class Ss{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||C0e}}let Vy=null;function T0e(t){return!vP(t)||t.length<2?t:PG(t)}function AG(){if(Vy)return Vy;const t=[];t.push(new Ss("bucket")),t.push(new Ss("generation")),t.push(new Ss("metageneration")),t.push(new Ss("name","fullPath",!0));function e(i,o){return T0e(o)}const n=new Ss("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new Ss("size");return s.xform=r,t.push(s),t.push(new Ss("timeCreated")),t.push(new Ss("updated")),t.push(new Ss("md5Hash",null,!0)),t.push(new Ss("cacheControl",null,!0)),t.push(new Ss("contentDisposition",null,!0)),t.push(new Ss("contentEncoding",null,!0)),t.push(new Ss("contentLanguage",null,!0)),t.push(new Ss("contentType",null,!0)),t.push(new Ss("metadata","customMetadata",!0)),Vy=t,Vy}function I0e(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new fi(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function N0e(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return I0e(r,t),r}function RG(t,e,n){const r=NG(e);return r===null?null:N0e(t,r,n)}function P0e(t,e,n,r){const s=NG(e);if(s===null||!vP(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,h=t.fullPath,f="/b/"+o(d)+"/o/"+o(h),m=_P(f,n,r),g=EG({alt:"media",token:u});return m+g})[0]}function A0e(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class kG{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jG(t){if(!t)throw xP()}function R0e(t,e){function n(r,s){const i=RG(t,s,e);return jG(i!==null),i}return n}function k0e(t,e){function n(r,s){const i=RG(t,s,e);return jG(i!==null),P0e(i,s,t.host,t._protocol)}return n}function DG(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=Hwe():s=Gwe():n.getStatus()===402?s=zwe(t.bucket):n.getStatus()===403?s=Wwe(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function j0e(t){const e=DG(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=Bwe(t.path)),i.serverResponse=s.serverResponse,i}return n}function D0e(t,e,n){const r=e.fullServerUrl(),s=_P(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new kG(s,i,k0e(t,n),o);return l.errorHandler=j0e(e),l}function M0e(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function L0e(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=M0e(null,e)),r}function F0e(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let S="";for(let I=0;I<2;I++)S=S+Math.random().toString().slice(2);return S}const c=l();o["Content-Type"]="multipart/related; boundary="+c;const u=L0e(e,r,s),d=A0e(u,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,f=`\r
--`+c+"--",m=hl.getBlob(h,r,f);if(m===null)throw Qwe();const g={name:u.fullPath},x=_P(i,t.host,t._protocol),E="POST",v=t.maxUploadRetryTime,_=new kG(x,E,R0e(t,n),v);return _.urlParams=g,_.headers=o,_.body=m.uploadData(),_.errorHandler=DG(e),_}class O0e{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=tu.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=tu.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=tu.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw Lf("cannot .send() more than once");if(uc(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Lf("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Lf("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Lf("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Lf("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class V0e extends O0e{initXhr(){this.xhr_.responseType="text"}}function MG(){return new V0e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(e,n){this._service=e,n instanceof fi?this._location=n:this._location=fi.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Eu(e,n)}get root(){const e=new fi(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return PG(this._location.path)}get storage(){return this._service}get parent(){const e=S0e(this._location.path);if(e===null)return null;const n=new fi(this._location.bucket,e);return new Eu(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw t0e(e)}}function $0e(t,e,n){t._throwIfRoot("uploadBytes");const r=F0e(t.storage,t._location,AG(),new hl(e,!0),n);return t.storage.makeRequestWithTokens(r,MG).then(s=>({metadata:s,ref:t}))}function U0e(t){t._throwIfRoot("getDownloadURL");const e=D0e(t.storage,t._location,AG());return t.storage.makeRequestWithTokens(e,MG).then(n=>{if(n===null)throw Zwe();return n})}function B0e(t,e){const n=E0e(t._location.path,e),r=new fi(t._location.bucket,n);return new Eu(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z0e(t){return/^[A-Za-z]+:\/\//.test(t)}function G0e(t,e){return new Eu(t,e)}function LG(t,e){if(t instanceof bP){const n=t;if(n._bucket==null)throw Xwe();const r=new Eu(n,n._bucket);return e!=null?LG(r,e):r}else return e!==void 0?B0e(t,e):t}function H0e(t,e){if(e&&z0e(e)){if(t instanceof bP)return G0e(t,e);throw aT("To use ref(service, url), the first argument must be a Storage instance.")}else return LG(t,e)}function C4(t,e){const n=e==null?void 0:e[bG];return n==null?null:fi.makeFromBucketSpec(n,t)}function W0e(t,e,n,r={}){t.host=`${e}:${n}`;const s=uc(e);s&&(L0(`https://${t.host}`),F0("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:fB(i,t.app.options.projectId))}class bP{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=_G,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=$we,this._maxUploadRetryTime=Uwe,this._requests=new Set,s!=null?this._bucket=fi.makeFromBucketSpec(s,this._host):this._bucket=C4(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=fi.makeFromBucketSpec(this._url,e):this._bucket=C4(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){E4("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){E4("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Bs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Eu(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new n0e(SG());{const o=f0e(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const T4="@firebase/storage",I4="0.13.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FG="storage";function Vd(t,e,n){return t=Vn(t),$0e(t,e,n)}function $d(t){return t=Vn(t),U0e(t)}function Ud(t,e){return t=Vn(t),H0e(t,e)}function q0e(t=O0(),e){t=Vn(t);const r=dg(t,FG).getImmediate({identifier:e}),s=mN("storage");return s&&K0e(r,...s),r}function K0e(t,e,n,r={}){W0e(t,e,n,r)}function Y0e(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new bP(n,r,s,e,ku)}function J0e(){zl(new Ea(FG,Y0e,"PUBLIC").setMultipleInstances(!0)),Oi(T4,I4,""),Oi(T4,I4,"esm2017")}J0e();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0e="type.googleapis.com/google.protobuf.Int64Value",Q0e="type.googleapis.com/google.protobuf.UInt64Value";function OG(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function hw(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>hw(e));if(typeof t=="function"||typeof t=="object")return OG(t,e=>hw(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Fh(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case X0e:case Q0e:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Fh(e)):typeof t=="function"||typeof t=="object"?OG(t,e=>Fh(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SP="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N4={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ws extends vo{constructor(e,n,r){super(`${SP}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,Ws.prototype)}}function Z0e(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function fw(t,e){let n=Z0e(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!N4[o])return new Ws("internal","internal");n=N4[o],r=o}const l=i.message;typeof l=="string"&&(r=l),s=i.details,s!==void 0&&(s=Fh(s))}}catch{}return n==="ok"?null:new Ws(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_e{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Bs(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT="us-central1",t_e=/^data: (.*?)(?:\n|$)/;function n_e(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new Ws("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class r_e{constructor(e,n,r,s,i=lT,o=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new e_e(e,n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=lT}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function s_e(t,e,n){const r=uc(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(L0(t.emulatorOrigin),F0("Functions",!0))}function i_e(t,e,n){const r=s=>a_e(t,e,s,n||{});return r.stream=(s,i)=>c_e(t,e,s,i),r}async function o_e(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}async function VG(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function a_e(t,e,n,r){const s=t._url(e);return l_e(t,s,n,r)}async function l_e(t,e,n,r){n=hw(n);const s={data:n},i=await VG(t,r),o=r.timeout||7e4,l=n_e(o),c=await Promise.race([o_e(e,s,i,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!c)throw new Ws("cancelled","Firebase Functions instance was deleted.");const u=fw(c.status,c.json);if(u)throw u;if(!c.json)throw new Ws("internal","Response is not valid JSON object.");let d=c.json.data;if(typeof d>"u"&&(d=c.json.result),typeof d>"u")throw new Ws("internal","Response is missing data field.");return{data:Fh(d)}}function c_e(t,e,n,r){const s=t._url(e);return u_e(t,s,n,r||{})}async function u_e(t,e,n,r){var s;n=hw(n);const i={data:n},o=await VG(t,r);o["Content-Type"]="application/json",o.Accept="text/event-stream";let l;try{l=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(i),headers:o,signal:r==null?void 0:r.signal})}catch(m){if(m instanceof Error&&m.name==="AbortError"){const x=new Ws("cancelled","Request was cancelled.");return{data:Promise.reject(x),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(x)}}}}}}const g=fw(0,null);return{data:Promise.reject(g),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(g)}}}}}}let c,u;const d=new Promise((m,g)=>{c=m,u=g});(s=r==null?void 0:r.signal)===null||s===void 0||s.addEventListener("abort",()=>{const m=new Ws("cancelled","Request was cancelled.");u(m)});const h=l.body.getReader(),f=d_e(h,c,u,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const m=f.getReader();return{async next(){const{value:g,done:x}=await m.read();return{value:g,done:x}},async return(){return await m.cancel(),{done:!0,value:void 0}}}}},data:d}}function d_e(t,e,n,r){const s=(o,l)=>{const c=o.match(t_e);if(!c)return;const u=c[1];try{const d=JSON.parse(u);if("result"in d){e(Fh(d.result));return}if("message"in d){l.enqueue(Fh(d.message));return}if("error"in d){const h=fw(0,d);l.error(h),n(h);return}}catch(d){if(d instanceof Ws){l.error(d),n(d);return}}},i=new TextDecoder;return new ReadableStream({start(o){let l="";return c();async function c(){if(r!=null&&r.aborted){const u=new Ws("cancelled","Request was cancelled");return o.error(u),n(u),Promise.resolve()}try{const{value:u,done:d}=await t.read();if(d){l.trim()&&s(l.trim(),o),o.close();return}if(r!=null&&r.aborted){const f=new Ws("cancelled","Request was cancelled");o.error(f),n(f),await t.cancel();return}l+=i.decode(u,{stream:!0});const h=l.split(`
`);l=h.pop()||"";for(const f of h)f.trim()&&s(f.trim(),o);return c()}catch(u){const d=u instanceof Ws?u:fw(0,null);o.error(d),n(d)}}},cancel(){return t.cancel()}})}const P4="@firebase/functions",A4="0.12.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h_e="auth-internal",f_e="app-check-internal",m_e="messaging-internal";function p_e(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(h_e),o=n.getProvider(m_e),l=n.getProvider(f_e);return new r_e(s,i,o,l,r)};zl(new Ea(SP,e,"PUBLIC").setMultipleInstances(!0)),Oi(P4,A4,t),Oi(P4,A4,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d_(t=O0(),e=lT){const r=dg(Vn(t),SP).getImmediate({identifier:e}),s=mN("functions");return s&&g_e(r,...s),r}function g_e(t,e,n){s_e(Vn(t),e,n)}function sh(t,e,n){return i_e(Vn(t),e,n)}p_e();function nu(t){return t?t.toLowerCase().replace(/\s+/g,"-"):""}const y_e={apiKey:"AIzaSyDI2pWJOx7_ACgr25-m5Jj6x6_2z_qRRPc",authDomain:"themeforge-hui99.firebaseapp.com",projectId:"themeforge-hui99",storageBucket:"themeforge-hui99.firebasestorage.app",messagingSenderId:"485239718484",appId:"1:485239718484:web:20d2f6aedc04d993f3e3c1"},h_=wB(y_e),mw=sye(h_),$G=bwe(h_),Bd=q0e(h_),hS=d_(h_);try{Swe($G,{cacheSizeBytes:_we}).then(()=>{console.log("Firestore offline persistence enabled.")}).catch(t=>{t.code=="failed-precondition"?console.warn("Firestore offline persistence failed: Multiple tabs open or other precondition failed.",t):t.code=="unimplemented"?console.warn("Firestore offline persistence failed: Browser does not support required features.",t):console.error("Firestore offline persistence failed with error: ",t)})}catch(t){console.error("Error enabling Firestore offline persistence: ",t)}const _r=$G;async function UG(t){if(!t||typeof t!="string"||t.trim()==="")return!1;const e=nu(t.trim());try{const n=Pc(_r,"stores"),r=iT(n,oT("urlSlug","==",e),Dwe(1));return!(await Ac(r)).empty}catch(n){throw console.error("Error checking store name availability in Firestore:",n),new Error("Failed to check store name availability due to a database error.")}}const BG=p.createContext(),x_e=({children:t})=>{const[e,n]=p.useState(null),[r,s]=p.useState(null),[i,o]=p.useState(null),[l,c]=p.useState(!0),[u,d]=p.useState(null);p.useEffect(()=>{let g=()=>{};const x=Wpe(mw,async E=>{if(c(!0),n(E),s(E),g(),E){const v=Pi(_r,"profiles",E.uid);g=Owe(v,_=>{if(_.exists()){const S=_.data();o(S),d((S==null?void 0:S.role)||"store_owner"),console.log("AuthContext: Profile updated from snapshot:",S)}else console.warn("AuthContext: No profile found for user:",E.uid),o(null),d("store_owner");c(!1)},_=>{console.error("AuthContext: Error listening to profile:",_.message),o(null),d(null),c(!1)})}else o(null),d(null),c(!1)});return()=>{x(),g()}},[]);const m={user:e,session:r,profile:i,isAuthenticated:!!r&&!!e,userRole:u,loadingRole:l,logout:async()=>{try{await qpe(mw),console.log("User signed out successfully.")}catch(g){console.error("Error signing out: ",g)}},subscriptionStatus:"active"};return a.jsx(BG.Provider,{value:m,children:t})},qi=()=>{const t=p.useContext(BG);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},v_e="AIzaSyBcpnUVVBDNaBLG7Rj_cEmE0J4zNlHmg7o",w_e=[{category:Ur.HARM_CATEGORY_HARASSMENT,threshold:Br.BLOCK_MEDIUM_AND_ABOVE},{category:Ur.HARM_CATEGORY_HATE_SPEECH,threshold:Br.BLOCK_MEDIUM_AND_ABOVE},{category:Ur.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Br.BLOCK_MEDIUM_AND_ABOVE},{category:Ur.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Br.BLOCK_MEDIUM_AND_ABOVE}],__e=t=>{if(!t)return null;const e=t.split(",");if(e.length<2)return null;const n=e[0].match(/:(.*?);/);if(!n||n.length<2)return null;const r=n[1],s=atob(e[1]);let i=s.length;const o=new Uint8Array(i);for(;i--;)o[i]=s.charCodeAt(i);return new Blob([o],{type:r})};async function zG(t,e,n=null,r="image/png",s=[],i=(u,d)=>console.log(`ProductGen Progress: ${u}%, Message: ${d||""}`),o=0,l=5,c=""){if(!t||!e)throw new Error("Product type and store name are required to generate a product.");const u=new ar({apiKey:v_e});let d=`You are an expert product creator for e-commerce stores.
Generate a product for a store named "${e}" that sells ${t}.
The overall theme and request for the store is: "${c}". Use this full prompt to ensure the product aligns well with the user's vision.

The product should include:
1. A catchy title.
2. A brief description (15-25 words).
3. A realistic price (e.g., 29.99, 45.00).
4. Relevant product options/variants (e.g., for a shirt: Size [S, M, L, XL], Color [White, Black, Blue]; for a shoe: Size [8, 9, 10], Color [Red, Grey]). Generate 1 to 2 variant types, each with 2 to 5 option values. If no variants are typically applicable for the product type, return an empty array for "variants".
5. A visually appealing product image.

Return the text details (title, description, price, variants) as a single JSON object in the text part of your response.
Your entire text response MUST be ONLY longed JSON object. Do not include any other words, phrases, or conversational text before or after the JSON object.
The JSON object should strictly follow this format:
{
  "title": "Example Product Title",
  "description": "This is a fantastic example product, perfect for your needs and desires.",
  "price": "19.99",
  "variants": [
    { "name": "Size", "values": ["S", "M", "L", "XL"] },
    { "name": "Color", "values": ["White", "Black", "Blue"] }
  ]
}
Or, if no variants apply:
{
  "title": "Example Product Title",
  "description": "This is a fantastic example product, perfect for your needs and desires.",
  "price": "19.99",
  "variants": []
}


Generate an image for this product in the image part of your response.`,h=d;if(s&&s.length>0&&(h+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),n){let _=d;s&&s.length>0&&(_+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),n&&(_+=`

A logo image is also provided. Subtly incorporate this logo onto the product, its packaging, or in the scene if appropriate. For example, it could be a small brand mark on the item or a logo in the background if it's a lifestyle shot. Ensure the product remains the main focus.`),console.log(n?`[geminiProductGeneration Function] Generating product with logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`:`[geminiProductGeneration Function] Generating product without logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`)}else{let _=d;s&&s.length>0&&(_+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),console.log(`[geminiProductGeneration Function] Generating product without logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`)}let f=null,m=null,g="",x=0;const E=3;let v=[];for(;x<E;){x++,console.log(`[geminiProductGeneration Function] Attempt ${x} to generate content...`);const _=o+(x-1)/E*(l*.2);i(_,`Generating product (attempt ${x}/${E})...`);let S=d;s&&s.length>0&&(S+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),v.length>0&&(S+=`

ADDITIONALLY IMPORTANT: Avoid re-generating the following titles which were duplicates in previous attempts of THIS request: "${v.join('", "')}". Ensure the new title is truly novel and not similar to these.`),n&&(S+=`

A logo image is also provided. Subtly incorporate this logo onto the product, its packaging, or in the scene if appropriate. For example, it could be a small brand mark on the item or a logo in the background if it's a lifestyle shot. Ensure the product remains the main focus.`);const I=[{text:S}];if(n&&I.push({inlineData:{data:n,mimeType:r}}),x===1){const M=[...s,...v];console.log(`[geminiProductGeneration Function] Generating product for type: ${t}, store: ${e}. Initial exclusions (if any): ${M.join(", ")||"None"}. Logo: ${n?"Yes":"No"}`)}try{const M=await u.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:I,safetySettings:w_e,config:{responseModalities:[Rn.TEXT,Rn.IMAGE]}});f=null,m=null;let j="";if(M.candidates&&M.candidates.length>0&&M.candidates[0].content&&M.candidates[0].content.parts)for(const C of M.candidates[0].content.parts)if(C.text){j+=C.text;try{const T=C.text.trim();let P=null;const A=T.match(/```json\s*([\s\S]*?)\s*```/);if(A&&A[1])P=A[1],console.log(`[geminiProductGeneration Function] Attempt ${x}: Found JSON in markdown block.`);else{const D=T.indexOf("{"),R=T.lastIndexOf("}");D!==-1&&R>D&&(P=T.substring(D,R+1),console.log(`[geminiProductGeneration Function] Attempt ${x}: Extracted potential JSON between first '{' and last '}'.`))}P?(f=JSON.parse(P),console.log(`[geminiProductGeneration Function] Attempt ${x}: Successfully parsed JSON.`)):C.text&&(C.text.includes("{")||C.text.includes("}"))?console.warn(`[geminiProductGeneration Function] Attempt ${x}: Text part contained braces but simple extraction failed. Text:`,C.text):C.text&&console.warn(`[geminiProductGeneration Function] Attempt ${x}: No JSON structure (markdown or simple braces) found in text part:`,C.text)}catch(T){console.warn(`[geminiProductGeneration Function] Attempt ${x}: Error parsing JSON. Attempted to parse: "${typeof jsonStringToParse=="string"?jsonStringToParse:"[jsonStringToParse was not a string or was null]"}". Original text from part:`,C.text,"Error:",T.message),f=null}}else C.inlineData&&C.inlineData.data&&(m=C.inlineData.data,console.log(`[geminiProductGeneration Function] Attempt ${x}: Image data found.`));if(g+=(g?`
---
Attempt `+x+`:
`:"Attempt "+x+`:
`)+j,f&&f.title){const C=f.title.toLowerCase();i(o+l*.8,`Validating product details for "${f.title}"...`);const T=s.some(A=>A.toLowerCase()===C),P=v.some(A=>A.toLowerCase()===C);if(T||P)console.warn(`[geminiProductGeneration Function] Attempt ${x}: Generated title "${f.title}" is a duplicate. Adding to exclusion list for next attempt.`),v.push(f.title),f=null;else if(!f.price||typeof f.price!="string"&&typeof f.price!="number"||String(f.price).trim()==="")console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" is unique, but price is missing or invalid. Price:`,f.price),f=null;else if(!f.variants||!Array.isArray(f.variants))console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" is unique and price is valid, but variants are missing or not an array. Variants:`,f.variants),f=null;else for(const A of f.variants)if(!A.name||typeof A.name!="string"||!Array.isArray(A.values)||!A.values.every(D=>typeof D=="string")){console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" has malformed variant entry. Variant:`,A),f=null;break}}if(f&&f.title&&(f.price||f.price===0)&&f.variants&&m){console.log(`[geminiProductGeneration Function] Successfully generated complete and unique product data (including variants) on attempt ${x}.`);break}else m||console.warn(`[geminiProductGeneration Function] Attempt ${x} missing image data.`),f?(f.title||console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing title.`),!f.price&&f.price!==0&&console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing price.`),f.variants||console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing variants or variants malformed.`)):console.warn(`[geminiProductGeneration Function] Attempt ${x} missing text details (or title was duplicate/price missing/variants malformed).`)}catch(M){console.error(`[geminiProductGeneration Function] Error during attempt ${x}:`,M.message,M.stack),g+=(g?`
---
`:"")+`Attempt ${x} Error: ${M.message}`}x>=E&&(!f||!m)&&console.error(`[geminiProductGeneration Function] Exhausted ${E} attempts. Product generation failed.`)}if(!f||!m){let _=`Failed to generate complete and unique product data after ${E} attempts. `;throw f||(_+="Text details (or unique title) missing. "),m||(_+="Image data missing. "),console.error(_,"Accumulated raw text responses:",g),new Error(_+`Last raw text (if any): ${g}`)}if(typeof f.title!="string"||typeof f.description!="string"||typeof f.price!="string"&&typeof f.price!="number"||!Array.isArray(f.variants)||!f.variants.every(_=>typeof _.name=="string"&&Array.isArray(_.values)&&_.values.every(S=>typeof S=="string")))throw console.error("[geminiProductGeneration Function] Parsed product details are not in the expected format:",f),new Error("AI response for product details was not in the expected format (title, description, price, variants).");if(f.price=String(f.price),console.log("[geminiProductGeneration Function] Successfully generated product details (including variants) and image data."),m){const _=`data:image/png;base64,${m}`,S=__e(_);if(S){const I=en(),j=`product_images_generated/${`${e.replace(/\s+/g,"_").toLowerCase()}_${f.title.replace(/\s+/g,"_").toLowerCase().substring(0,20)}_${I}.png`}`,C=Ud(Bd,j);try{i(o+l*.9,`Uploading image for "${f.title}"...`),await Vd(C,S);const T=await $d(C);return console.log(`[geminiProductGeneration Function] Image uploaded to Firebase Storage: ${T}`),i(o+l,`Product "${f.title}" generated successfully.`),{...f,images:[T]}}catch(T){throw console.error("[geminiProductGeneration Function] Error uploading image to Firebase Storage:",T),new Error(`Failed to upload generated image to Firebase Storage: ${T.message}`)}}else throw console.error("[geminiProductGeneration Function] Failed to convert base64 image data to Blob."),new Error("Failed to process generated image data for upload.")}else return i(o+l,`Product "${f.title}" generated (no image).`),{...f,images:[]}}const b_e="AIzaSyBcpnUVVBDNaBLG7Rj_cEmE0J4zNlHmg7o",R4=new ar({apiKey:b_e});async function GG(t,e,n,r=[],s=(l,c)=>console.log(`CollectionGen Progress: ${l}%, Message: ${c||""}`),i=0,o=5){const l=()=>{let h=[];return n&&n.length>0&&(h=n.map(f=>f.name).filter(f=>typeof f=="string"&&f.trim()!=="").slice(0,4)),h.length===0?{name:"Our Special Collection",description:"Discover a range of our finest products, specially selected for you.",imageData:null,product_ids:[],isPlaceholder:!0}:{name:`${t?t.charAt(0).toUpperCase()+t.slice(1):"Featured"} Selection`,description:`A curated selection of our popular ${t||"items"}. Explore customer favorites and top picks.`,imageData:null,product_ids:h,isPlaceholder:!0}},c=n&&n.length>0?n.map(h=>h.name).filter(h=>h).join(", "):"various items",u=r.length>0?`Do NOT use any of the following names: ${r.join(", ")}.`:"",d=`
    You are an AI assistant for an e-commerce store named "${e}" that sells "${t}".
    Based on the following products: ${c}, suggest a compelling and UNIQUE collection name and a short, engaging description (max 2 sentences) for a new collection.
    The collection should group related products or highlight a specific theme.
    ${u}
    Provide the output in a JSON format like this:
    {
      "name": "Collection Name",
      "description": "Collection Description",
      "product_names": ["Product Name 1", "Product Name 2"]
    }
    Ensure the collection name is concise, unique from the provided list (if any), and the description is appealing.
    The "product_names" array should contain a selection of 2 to 4 relevant product names from the provided product list that fit well within this new collection.
  `;s(i+o*.1,"Generating collection details...");try{const h=await R4.models.generateContent({model:"gemini-2.0-flash",contents:[{text:d}],config:{responseModalities:[Rn.TEXT]}});let f="";if(h&&h.candidates&&h.candidates.length>0&&h.candidates[0].content&&h.candidates[0].content.parts&&h.candidates[0].content.parts.length>0)for(const _ of h.candidates[0].content.parts)_.text&&(f+=_.text);if(!f)return console.error("Gemini text generation did not return any text content. Full response:",h),console.warn("Returning fallback collection due to no text from AI."),l();let m;try{const _=f.match(/```json\n([\s\S]*?)\n```/);if(_&&_[1])m=JSON.parse(_[1]);else try{m=JSON.parse(f)}catch{console.warn("Failed to parse Gemini response as JSON directly, trying to extract from text:",f);const I=f.indexOf("{"),M=f.lastIndexOf("}");if(I!==-1&&M!==-1&&M>I){const j=f.substring(I,M+1);try{m=JSON.parse(j)}catch(C){throw console.error("Final attempt to parse extracted JSON failed:",j,C),C}}else throw new Error("No valid JSON structure found in response.")}}catch(_){return console.error("Failed to parse Gemini response as JSON:",f,_),console.warn("Returning fallback collection due to JSON parsing error."),l()}if(!m||!m.name||!m.description||!Array.isArray(m.product_names)||m.product_names.length===0)return console.error("AI did not return valid collection data (name, description, or non-empty product_names array):",m),console.warn("Returning fallback collection due to invalid/incomplete AI data."),s(i+o*.5,"Failed to get valid collection details."),l();s(i+o*.5,`Collection details "${m.name}" received.`);const g=_=>{if(typeof _!="string")return"";let S=_.toLowerCase();return S=S.replace(/\b(a|an|the)\b/g,""),S.endsWith("s")&&S.length>3&&(S=S.slice(0,-1)),S=S.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),S},x=[];m.product_names&&n&&m.product_names.forEach(_=>{const S=g(_);if(!S){console.warn(`AI product name "${_}" normalized to an empty string. Skipping.`);return}let I=null;I=n.find(M=>g(M.name)===S),I||(I=n.find(M=>{const j=g(M.name);return j.includes(S)||S.includes(j)})),I&&I.name?(x.push(I.name),console.log(`Matched AI product "${_}" (normalized: "${S}") to existing product "${I.name}" (using name as ID)`)):console.warn(`Product name "${_}" (normalized: "${S}") from AI response not found in provided product list or missing name after normalization and fallback search.`)});const E=`A vibrant and appealing e-commerce collection image for "${m.name}", described as "${m.description}", suitable for a store selling ${t}.`;let v=null;s(i+o*.6,`Generating image for collection "${m.name}"...`);try{const _=[{text:E}],S=await R4.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:_,config:{responseModalities:[Rn.TEXT,Rn.IMAGE]}});if(S&&S.candidates&&S.candidates.length>0&&S.candidates[0].content&&S.candidates[0].content.parts&&S.candidates[0].content.parts.length>0){for(const I of S.candidates[0].content.parts)if(I.inlineData&&I.inlineData.data){v=I.inlineData.data;break}}v?s(void 0,`Image generated for collection "${m.name}".`):(console.warn(`Gemini image generation did not return image data for collection: "${m.name}". Full Response:`,S),s(void 0,`Image generation failed for collection "${m.name}".`))}catch(_){console.error(`Error generating image for collection "${m.name}" with Gemini:`,_),s(void 0,`Error generating image for collection "${m.name}".`)}return s(i+o,`Collection "${m.name}" processing complete.`),{name:m.name,description:m.description,imageData:v,product_ids:x}}catch(h){return console.error("Error generating collection with Gemini:",h),console.warn("Returning fallback collection due to an unexpected error in generation process."),s(i+o,"Collection generation failed (unexpected error)."),l()}}const S_e="2025-04",f_=async(t,e,n,r={})=>{var l,c;if(!t||t==="your-shop-name.myshopify.com"||!e||e==="YOUR_SHOPIFY_STOREFRONT_ACCESS_TOKEN")throw new Error("Shopify domain or access token is not configured or is using placeholder values.");let s=t.trim().replace(/^(https?:\/\/)/,"").replace(/\/$/,"");s.includes(".")?!s.endsWith(".myshopify.com")&&s.includes("."):s=`${s}.myshopify.com`,s.includes(".")||(s=`${s}.myshopify.com`);let i=t.trim().replace(/^(https?:\/\/)/,"").replace(/\/$/,"");i.includes(".")||(i=`${i}.myshopify.com`);const o=`https://${i}/api/${S_e}/graphql.json`;try{const u=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":e},body:JSON.stringify({query:n,variables:r})});if(!u.ok){let h;try{h=await u.json()}catch{}const f=((c=(l=h==null?void 0:h.errors)==null?void 0:l[0])==null?void 0:c.message)||`Shopify API request failed: ${u.status} ${u.statusText}`;throw console.error("Shopify API Error:",h||u.statusText),new Error(f)}const d=await u.json();if(d.errors)throw console.error("Shopify GraphQL Errors:",d.errors),new Error(d.errors.map(h=>h.message).join(", "));return d.data}catch(u){throw console.error("Error fetching from Shopify Storefront API:",u),u}},E_e=`
  query GetShopMetadata {
    shop {
      name
      description 
      primaryDomain {
        host
        url
      }
      brand {
        logo {
          image { # Reverted to use image field
            url
            altText
          }
        }
        squareLogo { # Added, assuming similar structure
          image {
            url
            altText # Assuming altText is available, can be removed if not
          }
        }
        coverImage {
          image { # Reverted to use image field
            url
            altText
          }
        }
        slogan
        shortDescription # Added
        colors {
          primary {
            background
            foreground
          }
          secondary {
            background
            foreground
          }
        }
      }
    }
  }
`,C_e=`
  query GetProducts($first: Int = 10, $cursor: String) {
    products(first: $first, after: $cursor) {
      edges {
        node {
          id
          title
          description # Changed from descriptionHtml
          handle
          tags
          images(first: 5) { # Changed from first: 1
            edges {
              node {
                url
                altText
              }
            }
          }
          variants(first: 5) { # Changed from first: 1
            edges {
              node {
                id # Added for variants
                title # Added for variants
                availableForSale # Added
                sku # Added from debug guide example
                price: priceV2 { # Changed from priceRange.minVariantPrice to priceV2, aliased to price
                    amount
                    currencyCode
                }
                image {
                   url
                   altText
                }
              }
            }
          }
        }
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
`,T_e=`
  query GetCollections($first: Int = 10, $cursor: String) {
    collections(first: $first, after: $cursor) {
      edges {
        node {
          id
          title
          description
          handle
          products(first: 5) { # Example: fetch first 5 products in each collection
            edges {
              node {
                id
                title
              }
            }
          }
        }
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
`,I_e=`
  query GetLocalizationInfo @inContext(country: "US") { # Defaulting to US, can be parameterized
    localization {
      availableCountries {
        isoCode
        name
        currency {
          isoCode
          name
          symbol
        }
      }
      availableLanguages {
        isoCode
        name
        endonymName
      }
    }
  }
`,Yl=()=>["#3B82F6","#8B5CF6","#EC4899","#10B981","#F59E0B","#EF4444","#6366F1","#14B8A6","#F97316"][Math.floor(Math.random()*9)],m_=()=>["Inter","Roboto","Poppins","Montserrat","Open Sans"][Math.floor(Math.random()*5)],p_=()=>["grid","list"][Math.floor(Math.random()*2)],N_e=async(t,e,n,r,{fetchPexelsImages:s=wa,generateId:i=en}={})=>{const o=[],l={fashion:{min:20,max:200},electronics:{min:50,max:1300},food:{min:5,max:50},jewelry:{min:100,max:1e3},general:{min:10,max:300}},c=l[t]||l.general,u={fashion:["Classic Tee","Urban Jeans","Silk Scarf","Leather Boots","Summer Dress","Knit Sweater"],electronics:["HD Webcam","Noise-Cancelling Buds","Smart Display","Gaming Pad","Portable Drive","VR Headset"],food:["Artisan Bread","Gourmet Cheese","Organic Berries","Craft Coffee","Spiced Nuts","Dark Chocolate Bar"],jewelry:["Pearl Necklace","Sapphire Ring","Gold Hoops","Charm Bracelet","Silver Cufflinks","Diamond Studs"],general:["Utility Tool","Desk Organizer","Travel Mug","Yoga Mat","Scented Candle","Board Game"]},h=[...u[t]||u.general].sort(()=>.5-Math.random()).slice(0,e),f=h.map(g=>`${t} ${g} product shot`),m=await s(f.join(";"),e,"square");for(let g=0;g<e;g++){const x=h[g],E=m[g];let v;if(E&&E.src&&E.src.medium&&r)try{console.log(`[generateAIProductsData] Overlaying logo on Pexels image: ${E.src.medium}`),v=await overlayLogoOnProductImage(E.src.medium,r)}catch(_){console.error(`[generateAIProductsData] Failed to overlay logo on ${E.src.medium}, using original.`,_),v=E.src.medium}else E&&E.src&&E.src.medium?v=E.src.medium:v=`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(x)}`;o.push({id:`product-ai-${i()}`,name:x,price:parseFloat((Math.random()*(c.max-c.min)+c.min).toFixed(2)),description:Vre(t,x),rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,image:{id:E&&E.id||i(),src:{medium:v},alt:E&&E.alt||`Product image for ${x}`},storeName:n})}return o},P_e=async(t,{fetchPexelsImages:e=wa,generateId:n=en}={})=>{var S,I,M,j,C,T,P,A,D,R,k,U;const r=`store-wizard-${n()}`,{productType:s,storeName:i,logoUrl:o,products:l,prompt:c}=t;let u=[];(l.source==="ai"||l.source==="printOnDemand"||l.source==="manual")&&(u=l.items.map(B=>({id:`product-wizard-${n()}`,name:B.name,price:parseFloat(B.price)||0,description:B.description||"",images:B.images&&B.images.length>0?B.images:[`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(B.name||"Product")}`],image:{id:n(),src:{medium:B.images&&B.images.length>0?B.images[0]:`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(B.name||"Product")}`},alt:B.name||"Product Image"},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,isPrintOnDemand:B.isPrintOnDemand||!1,podDetails:B.podDetails||null,variants:B.variants||[]})));const d=3,h=await e(`${s} ${i} hero slideshow ${c}`,d,"landscape"),f=h.length>0?h[0]:{src:{large:"https://via.placeholder.com/1200x800.png?text=Hero+Image"},alt:"Placeholder Hero Image"},m=await jc(`${s} ${i} store ambiance ${c}`,1,"landscape"),g=Xw(s,i),x=await e(`${i} ${s} abstract background`,1,"landscape"),E=((I=(S=x[0])==null?void 0:S.src)==null?void 0:I.large)||((j=(M=x[0])==null?void 0:M.src)==null?void 0:j.original)||"",v="v1";let _={...g,heroSlideshowImages:h.map(B=>({src:B.src.large,alt:B.alt||i+" hero image"})),...((C=t.content)==null?void 0:C.hero)&&{heroTitle:t.content.hero.heroTitle||g.heroTitle,heroDescription:t.content.hero.heroDescription||g.heroDescription},...((T=t.content)==null?void 0:T.storeWay)&&{storeWay:t.content.storeWay},imageRightSection:null,videoLeftSection:null};if(t.template_version==="sharp"){u.slice(0,3).map(H=>H.name).join(", ");const B={name:i,niche:s,description:c||`A ${s} store called ${i}`},K=await N3(B);if(K&&!K.error){const H=K.title||`${i} craftsmanship`,X=await e(H,1,"landscape");_.imageRightSection={...K,imageUrl:((A=(P=X[0])==null?void 0:P.src)==null?void 0:A.large)||"https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}}const ee=await P3(B);if(ee&&!ee.error){const H=ee.title||`${i} product action`,X=await jc(H,1,"landscape");_.videoLeftSection={...ee,videoUrl:((D=X[0])==null?void 0:D.url)||null,videoPosterUrl:((R=X[0])==null?void 0:R.image)||null}}}return{id:r,name:i,template_version:v,type:s,description:_.heroDescription||g.heroDescription,prompt:c||`A ${s} store called ${i}`,products:u,collections:t.collections.items.map(B=>({id:`collection-wizard-${n()}`,name:B.name,description:B.description,imageUrl:B.imageUrl,product_ids:B.product_ids||[]})),hero_image:f,content:_,hero_video_url:((k=m[0])==null?void 0:k.url)||null,hero_video_poster_url:((U=m[0])==null?void 0:U.image)||null,logo_url:t.logoUrlDark||t.logoUrlLight||`https://via.placeholder.com/100x100.png?text=${i.substring(0,1)}`,logo_url_light:t.logoUrlLight||null,logo_url_dark:t.logoUrlDark||null,theme:{primaryColor:Yl(),secondaryColor:Yl(),fontFamily:m_(),layout:p_()},data_source:"wizard",card_background_url:E}},A_e=async(t,{storeNameOverride:e=null,nicheDetails:n=null,fetchPexelsImages:r=wa,generateId:s=en}={},i=(o,l)=>{console.log(`Progress: ${o}%, Message: ${l||"(no message)"}`)})=>{var De,xe,Me,Ye,qe,et,We,mt,Le,ve,Je,Xe,kt,Gt,fn,sn;i(0,"Initializing store generation...");const o=`store-ai-${s()}`,l=t.toLowerCase().split(" ");let c="general";n&&n.name?c=n.name.toLowerCase().replace(/ /g,"-")||"general":l.some(ae=>["clothing","fashion","apparel","wear"].includes(ae))?c="fashion":l.some(ae=>["tech","electronics","gadget","digital"].includes(ae))?c="electronics":l.some(ae=>["food","grocery","meal","organic"].includes(ae))?c="food":l.some(ae=>["jewelry","accessory","watch","luxury"].includes(ae))&&(c="jewelry");let u=e,d=null;if(!u)try{d=await Toe(t),d&&(u=d,console.log(`[generateStoreFromPromptData] Extracted store name via Gemini Function Calling: "${u}" (Raw response: "${d}")`))}catch(ae){console.error("[generateStoreFromPromptData] Error during Gemini function call for name extraction:",ae)}if(!u)try{console.log(`[generateStoreFromPromptData] No name from override or function call. Attempting AI name suggestion using prompt: "${t}"`);const ae=await E3(t);if(ae&&ae.suggestions&&ae.suggestions.length>0)u=ae.suggestions[0],console.log(`[generateStoreFromPromptData] AI generated store name: ${u}`);else{console.warn("[generateStoreFromPromptData] AI name generation yielded no suggestions. Falling back to heuristic.");const me=t.split(" ").filter(fe=>fe.charAt(0)===fe.charAt(0).toUpperCase()&&fe.length>2);me.length>0&&(u=me[0])}}catch(ae){console.error("[generateStoreFromPromptData] Error during AI store name generation:",ae);const me=t.split(" ").filter(fe=>fe.charAt(0)===fe.charAt(0).toUpperCase()&&fe.length>2);me.length>0&&(u=me[0])}u||(u=`${c.charAt(0).toUpperCase()+c.slice(1)} Emporium ${s().substring(0,4)}`,console.log(`[generateStoreFromPromptData] Using final fallback store name: ${u}`)),u&&u.length>50&&(u=u.substring(0,50));let h=null,f=null,m=null,g=`https://via.placeholder.com/100x100.png?text=${u.substring(0,1)}`;try{console.log(`[generateStoreFromPromptData] Generating logo for: ${u}`),i(5,`Generating logo for ${u}...`);const ae=await Yp(u,i);if(ae){f=ae.logoUrlLight,m=ae.logoUrlDark,m?g=m:f&&(g=f);const me=f||m;if(me&&me.startsWith("data:image/")){const fe=me.split(",");fe.length===2&&(h=fe[1])}console.log(`[generateStoreFromPromptData] Logos generated for ${u}. Light: ${!!f}, Dark: ${!!m}`),i(20,`${u} logo generated.`)}else console.warn(`[generateStoreFromPromptData] Logo generation did not return expected result for ${u}.`),i(20,`Logo generation issue for ${u}.`)}catch(ae){console.error(`[generateStoreFromPromptData] Error generating logo for ${u}:`,ae),i(20,`Error generating logo for ${u}.`)}i(25,`Generating ${c} products...`);const x=[],E=[],v=6,_=v*2;let S=0;const I=25,M=45;for(console.log(`[generateStoreFromPromptData] Attempting to generate ${v} unique products for ${u} (type: ${c}).`);x.length<v&&S<_;){S++;const ae=I+Math.floor(x.length/v*M);i(ae,`Generating product ${x.length+1}/${v}...`);try{console.log(`[generateStoreFromPromptData] Generating product attempt ${S} (aiming for ${x.length+1}/${v} unique products)... Excluding titles: ${E.join(", ")}`);const me=await zG(c,u,h,"image/png",E,i,ae,M/v,t);if(me&&me.images&&me.images.length>0&&me.title&&me.title.trim()!==""&&typeof me.price=="string"&&typeof me.description=="string"){const fe=me.title.toLowerCase().trim();if(E.includes(fe))console.warn(`[generateStoreFromPromptData] Duplicate product title generated and skipped: "${me.title}". Attempt ${S}/${_}.`);else{let Ne=me.variants||[];if(c==="fashion"){const ne=Ne.some(Ee=>Ee.name.toLowerCase()==="size"),de=Ne.some(Ee=>Ee.name.toLowerCase()==="color");ne||Ne.push({name:"Size",values:["S","M","L","XL"]}),de||Ne.push({name:"Color",values:["White","Black","Blue","Red"]})}x.push({id:`product-gemini-${s()}`,name:me.title,price:parseFloat(me.price)||0,description:me.description,images:me.images,image:{id:s(),src:{medium:me.images[0]},alt:me.title},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,variants:Ne}),E.push(fe),console.log(`[generateStoreFromPromptData] Product "${me.title}" generated successfully and is unique. (${x.length}/${v})`),i(I+Math.floor(x.length/v*M),`Product "${me.title}" generated.`)}}else console.warn(`[generateStoreFromPromptData] Failed to generate complete data (or image) for product attempt ${S}. Data:`,me)}catch(me){console.error(`[generateStoreFromPromptData] Error during product generation attempt ${S}:`,me)}}i(I+M,`${x.length} products generated.`),x.length<v&&console.warn(`[generateStoreFromPromptData] Could only generate ${x.length} unique products after ${_} total attempts.`),x.length===0&&v>0&&console.warn("[generateStoreFromPromptData] No products were generated successfully. The store will be created with an empty product list.");const j=70,C=20,T=3,P=await r(`${c} ${u} hero slideshow ${t}`,T,"landscape"),A=P.length>0?P[0]:{src:{large:"https://via.placeholder.com/1200x800.png?text=Hero+Image"},alt:"Placeholder Hero Image"},D=await jc(`${c} ${u} store ambiance ${t}`,1,"landscape"),R=await jc(`${u} ${c} product showcase`,1,"landscape");await jc(`${u} ${c} craftsmanship process`,1,"landscape");const k={name:u,niche:c,description:t},U=await C3(k),B=await T3(k),K=await I3(k),ee=Xw(c,u),H=await r(`${u} ${c} store background`,1,"landscape"),X=((xe=(De=H[0])==null?void 0:De.src)==null?void 0:xe.large)||((Ye=(Me=H[0])==null?void 0:Me.src)==null?void 0:Ye.original)||"";let O="fresh";if(n&&n.templates&&n.templates.length>0){const ae=n.templates.some(me=>me.toLowerCase()==="sharp");if(c==="technology"&&ae)O="sharp";else{const me=n.templates[0].toLowerCase();["classic","modern","v1"].includes(me)?O="v1":me==="premium"?O="premium":me==="sharp"?O="sharp":me==="sleek"&&(O="sleek")}}else t.toLowerCase().includes("modern")?O="v1":t.toLowerCase().includes("premium")?O="premium":t.toLowerCase().includes("sharp")?O="sharp":t.toLowerCase().includes("sleek")&&(O="sleek");O==="modern"&&(O="v1");let z={url:null,poster:null};if(O==="v2"){const ae=await jc(`${u} ${c} customer experience why choose us`,1,"landscape");z.url=((qe=ae[0])==null?void 0:qe.url)||null,z.poster=((et=ae[0])==null?void 0:et.image)||null}const Y=[],F=3,ye=[];if(x.length>0){i(j,`Generating collections for products: ${E.slice(0,3).join(", ")}...`),console.log(`[generateStoreFromPromptData] Attempting to generate ${F} collections for ${u}.`);for(let ae=0;ae<F;ae++){const me=j+Math.floor((ae+1)/F*C);i(me,`Generating collection ${ae+1}/${F}...`);try{console.log(`[generateStoreFromPromptData] Generating collection ${ae+1}/${F}...`);const fe=await GG(c,u,x,ye,i,me,C/F);if(fe&&!fe.error&&fe.name){let Ne="";if(fe.imageData)Ne=`data:image/png;base64,${fe.imageData}`,console.log(`[generateStoreFromPromptData] Using Gemini-generated image for collection "${fe.name}".`);else{console.warn(`[generateStoreFromPromptData] Gemini image generation failed for collection "${fe.name}". Attempting Pexels fallback.`);const ne=`${fe.name} ${c} collection banner`;try{const de=await r(ne,1,"landscape");de&&de.length>0&&((We=de[0].src)!=null&&We.large)?(Ne=de[0].src.large,console.log(`[generateStoreFromPromptData] Using Pexels fallback image for collection "${fe.name}": ${Ne}`)):(Ne=`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(fe.name||"Collection")}`,console.warn(`[generateStoreFromPromptData] Pexels fallback also failed for collection "${fe.name}". Using placeholder.`))}catch(de){console.error(`[generateStoreFromPromptData] Error fetching Pexels image for collection "${fe.name}":`,de),Ne=`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(fe.name||"Collection")}`}}Y.push({id:`collection-gemini-${s()}`,name:fe.name,description:fe.description,imageUrl:Ne,product_ids:fe.product_ids||[]}),ye.push(fe.name),console.log(`[generateStoreFromPromptData] Collection "${fe.name}" generated with ${((mt=fe.product_ids)==null?void 0:mt.length)||0} products.`),i(me,`Collection "${fe.name}" generated.`)}else console.warn(`[generateStoreFromPromptData] Failed to generate complete data for collection ${ae+1}. Error: ${fe==null?void 0:fe.error}`)}catch(fe){console.error(`[generateStoreFromPromptData] Error during collection generation attempt ${ae+1}:`,fe)}}i(j+C,`${Y.length} collections generated.`)}else console.warn(`[generateStoreFromPromptData] Skipping collection generation as no products were generated for ${u}.`),i(j+C,"Skipped collection generation (no products).");i(95,"Loading storefront...");let Se={id:o,name:u,template_version:O,type:c,description:U&&!U.error?U.heroDescription:ee.heroDescription,prompt:t,products:x,collections:Y,hero_image:A,hero_video_url:((Le=D[0])==null?void 0:Le.url)||null,hero_video_poster_url:((ve=D[0])==null?void 0:ve.image)||null,logo_url:g,logo_url_light:f,logo_url_dark:m,theme:{primaryColor:(n==null?void 0:n.primaryColor)||Yl(),secondaryColor:(n==null?void 0:n.secondaryColor)||Yl(),fontFamily:m_(),layout:p_()},content:{...ee,...U&&!U.error&&{heroTitle:U.heroTitle||ee.heroTitle,heroDescription:U.heroDescription||ee.heroDescription},...B&&!B.error&&{storeWay:B},...K&&!K.error&&{storeFeatures:K},heroSlideshowImages:P.map(ae=>({src:ae.src.large,alt:ae.alt||u+" hero image"})),imageRightSection:null,videoLeftSection:null},data_source:"ai",card_background_url:X};if(O==="sharp"){x.slice(0,3).map(fe=>fe.name).join(", ");const ae=await N3(k);if(ae&&!ae.error){const fe=ae.title||`${u} craftsmanship`,Ne=await r(fe,1,"landscape");Se.content.imageRightSection={...ae,imageUrl:((Xe=(Je=Ne[0])==null?void 0:Je.src)==null?void 0:Xe.large)||"https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}}const me=await P3(k);if(me&&!me.error){const fe=me.title||`${u} product action`,Ne=await jc(fe,1,"landscape");Se.content.videoLeftSection={...me,videoUrl:((kt=Ne[0])==null?void 0:kt.url)||null,videoPosterUrl:((Gt=Ne[0])==null?void 0:Gt.image)||null}}Se.content.heroFollowUpVideoUrl=((fn=R[0])==null?void 0:fn.url)||null,Se.content.heroFollowUpVideoPosterUrl=((sn=R[0])==null?void 0:sn.image)||null}else O==="fresh"&&(Se.content.featuresVideoUrl=z.url,Se.content.featuresVideoPosterUrl=z.poster);return O!=="sharp"&&(Se.content.heroFollowUpVideoUrl=null,Se.content.heroFollowUpVideoPosterUrl=null),O!=="fresh"&&(Se.content.featuresVideoUrl=null,Se.content.featuresVideoPosterUrl=null),Se},R_e=async(t,e)=>(await f_(t,e,E_e)).shop,k_e=async(t,e,n=10,r=null)=>(await f_(t,e,T_e,{first:n,cursor:r})).collections,j_e=async(t,e,n=10,r=null)=>(await f_(t,e,C_e,{first:n,cursor:r})).products,D_e=async(t,e,n="US",r="EN")=>(await f_(t,e,I_e,{})).localization,M_e=async(t,e,n,r,{generateId:s=en}={},i=null)=>{var E,v,_,S,I,M,j,C,T,P,A,D,R,k,U,B,K,ee,H,X,O,z,Y,F,ye,Se,De,xe,Me,Ye,qe,et,We,mt,Le;const o=e.map(ve=>{var sn,ae,me,fe,Ne,ne;const Je=(ae=(sn=ve.variants)==null?void 0:sn.edges[0])==null?void 0:ae.node,Xe=(fe=(me=ve.images)==null?void 0:me.edges[0])==null?void 0:fe.node,kt=Je==null?void 0:Je.image,Gt=(Xe==null?void 0:Xe.url)||(kt==null?void 0:kt.url)||`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(ve.title||"Product")}`,fn=(Xe==null?void 0:Xe.altText)||(kt==null?void 0:kt.altText)||ve.title||"Product image";return{id:ve.id,name:ve.title||"Untitled Product",description:ve.description?ve.description.substring(0,500)+(ve.description.length>500?"...":""):"No description available.",price:parseFloat(((Ne=Je==null?void 0:Je.price)==null?void 0:Ne.amount)||0),currencyCode:((ne=Je==null?void 0:Je.price)==null?void 0:ne.currencyCode)||"USD",image:{id:(Xe==null?void 0:Xe.id)||(kt==null?void 0:kt.id)||s(),src:{medium:Gt},alt:fn},tags:ve.tags||[],availableForSale:(Je==null?void 0:Je.availableForSale)||!1,rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*100)+10}}),l=n.map(ve=>{var Je,Xe;return{id:ve.id,name:ve.title||"Untitled Collection",description:ve.description||"",handle:ve.handle,product_ids:((Xe=(Je=ve.products)==null?void 0:Je.edges)==null?void 0:Xe.map(kt=>kt.node.id))||[]}}),c=((_=(v=(E=t.brand)==null?void 0:E.colors)==null?void 0:v.primary)==null?void 0:_.background)||Yl();(M=(I=(S=t.brand)==null?void 0:S.colors)==null?void 0:I.primary)==null||M.foreground;const u=((T=(C=(j=t.brand)==null?void 0:j.colors)==null?void 0:C.secondary)==null?void 0:T.background)||Yl();(D=(A=(P=t.brand)==null?void 0:P.colors)==null?void 0:A.secondary)==null||D.foreground;const d={id:s(),src:{large:((U=(k=(R=t.brand)==null?void 0:R.coverImage)==null?void 0:k.image)==null?void 0:U.url)||`https://via.placeholder.com/1200x800.png?text=${encodeURIComponent(t.name||"Store")}`},alt:((ee=(K=(B=t.brand)==null?void 0:B.coverImage)==null?void 0:K.image)==null?void 0:ee.altText)||t.name||"Store Cover Image"},h=((O=(X=(H=t.brand)==null?void 0:H.logo)==null?void 0:X.image)==null?void 0:O.url)||((F=(Y=(z=t.brand)==null?void 0:z.squareLogo)==null?void 0:Y.image)==null?void 0:F.url),f=i||h||`https://via.placeholder.com/100x100.png?text=${(t.name||"S").substring(0,1)}`,m=Xw("general",t.name||"Imported Store"),g=await wa(`${t.name||"store"} background`,1,"landscape"),x=((Se=(ye=g[0])==null?void 0:ye.src)==null?void 0:Se.large)||((xe=(De=g[0])==null?void 0:De.src)==null?void 0:xe.original)||"";return{id:`store-shopify-${(((Me=t.primaryDomain)==null?void 0:Me.host)||r||s()).replace(/\./g,"-")}-${s()}`,name:t.name||"Imported Shopify Store",type:"shopify-imported",description:t.description||((Ye=t.brand)==null?void 0:Ye.shortDescription)||((qe=t.brand)==null?void 0:qe.slogan)||m.heroDescription,products:o,collections:l,hero_image:d,logo_url:f,theme:{primaryColor:c,secondaryColor:u,fontFamily:m_(),layout:p_()},content:{...m,heroTitle:`Welcome to ${t.name||"Our Store"}`,heroDescription:t.description||((et=t.brand)==null?void 0:et.shortDescription)||((We=t.brand)==null?void 0:We.slogan)||m.heroDescription,brandSlogan:(mt=t.brand)==null?void 0:mt.slogan,brandShortDescription:(Le=t.brand)==null?void 0:Le.shortDescription},data_source:"shopify",card_background_url:x}},L_e=async(t,e,n,{generateId:r=en}={},s=null)=>{var d,h,f,m,g,x,E,v,_,S;console.log("Mapping BigCommerce Data:",{bcStoreSettings:t,bcProducts:e,domain:n,generatedLogoDataUrl:s});const i=e.map(I=>{var M,j,C,T,P,A,D;return{id:((M=I.entityId)==null?void 0:M.toString())||`bc-product-${r()}`,name:I.name||"Unnamed Product",description:I.description||`Product: ${I.name||"Unnamed Product"}`,price:parseFloat(((C=(j=I.prices)==null?void 0:j.price)==null?void 0:C.value)||0),currencyCode:((P=(T=I.prices)==null?void 0:T.price)==null?void 0:P.currencyCode)||"USD",image:{id:`bc-img-${r()}`,src:{medium:((A=I.defaultImage)==null?void 0:A.url)||`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(I.name||"Product")}`},alt:((D=I.defaultImage)==null?void 0:D.altText)||I.name||"Product Image"},sku:I.sku||"",rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*100)+10}}),o=s||((h=(d=t.logo)==null?void 0:d.image)==null?void 0:h.url)||`https://via.placeholder.com/100x100.png?text=${(t.storeName||"S").substring(0,1)}`,l=Xw("general",t.storeName||"My BigCommerce Store"),c=await wa(`${t.storeName||"store"} background`,1,"landscape"),u=((m=(f=c[0])==null?void 0:f.src)==null?void 0:m.large)||((x=(g=c[0])==null?void 0:g.src)==null?void 0:x.original)||"";return{id:`store-bc-${(t.storeHash||n).replace(/[\.\/\:]/g,"-")}-${r()}`,name:t.storeName||"My BigCommerce Store",type:"bigcommerce-imported",description:t.description||`Store imported from ${n}`||l.heroDescription,products:i,hero_image:{id:r(),src:{large:((v=(E=t.logo)==null?void 0:E.image)==null?void 0:v.url)||`https://via.placeholder.com/1200x800.png?text=${encodeURIComponent(t.storeName||"Store")}`},alt:((S=(_=t.logo)==null?void 0:_.image)==null?void 0:S.altText)||t.storeName||"Store Hero"},logo_url:o,theme:{primaryColor:Yl(),secondaryColor:Yl(),fontFamily:m_(),layout:p_()},content:{...l,heroTitle:`Welcome to ${t.storeName||"Our Store"}`,heroDescription:t.description||l.heroDescription},data_source:"bigcommerce",card_background_url:u}};async function F_e(t,e){const n=`
    query StoreSettings {
      site {
        settings {
          storeName
          storeHash
          status
          logo {
            title
            image {
              url(width: 500)
              altText
            }
          }
        }
      }
    }
  `;if(typeof t!="string"||!t.trim()){const i=new TypeError("Invalid or empty storeDomain provided to fetchStoreSettings.");throw console.error(i.message,{storeDomain:t}),i}if(typeof e!="string"||!e.trim()){const i=new TypeError("Invalid or empty token provided to fetchStoreSettings.");throw console.error(i.message,{tokenProvided:typeof e=="string"&&e.length>0?"Yes":"No"}),i}const r=`https://${t}/graphql`,s={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:n})};console.log(`[fetchStoreSettings] Attempting to fetch: ${r}`,{domain:t,tokenProvided:!!e,queryLength:n.length});try{let i;try{i=await fetch(r,s)}catch(l){console.error(`[fetchStoreSettings] Initial fetch to ${r} failed:`,l);let c=`Initial fetch to ${r} failed.`;throw l.name==="TypeError"?c+=` This is often due to a CORS misconfiguration (check 'allowed_cors_origins' for your BigCommerce Storefront API token), a DNS issue, or the server not being reachable. Please check the browser's Network DevTools for more specific error messages. Original error: ${l.message}`:c+=` Error: ${l.message||"Unknown network error"}`,new Error(c)}if(console.log(`[fetchStoreSettings] Response from ${r} - Status: ${i.status}, Complexity: ${i.headers.get("X-Bc-GraphQL-Complexity")}`),!i.ok){let l=`Could not retrieve error body (status: ${i.status}).`;try{l=await i.text()}catch(c){console.warn("Failed to read error response body:",c)}throw new Error(`HTTP error ${i.status} for ${r}: ${l}`)}let o;try{o=await i.json()}catch(l){let c="Could not retrieve raw response text after JSON parse failure.";try{c=await(await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:n})})).text()}catch(u){console.warn("Failed to re-fetch for raw text:",u)}throw console.error("Failed to parse JSON response from BigCommerce.",l,{graphqlUrl:r,rawTextPreview:c.substring(0,500)}),new Error(`Failed to parse JSON response from ${r}. Preview: ${c.substring(0,200)}...`)}if(o.errors)throw console.error("BigCommerce GraphQL errors (fetchStoreSettings):",o.errors,{graphqlUrl:r}),new Error(`GraphQL error: ${o.errors.map(l=>l.message).join(", ")}`);if(!o.data||!o.data.site||!o.data.site.settings)throw console.error("Invalid data structure in BigCommerce response (fetchStoreSettings):",o.data,{graphqlUrl:r}),new Error("Invalid data structure received from BigCommerce API for store settings.");return o.data.site.settings}catch(i){throw i.message.startsWith("Invalid or empty storeDomain")||i.message.startsWith("Invalid or empty token")||i.message.startsWith("HTTP error")||i.message.startsWith("GraphQL error")||i.message.startsWith("Failed to parse JSON")||i.message.startsWith("Network error")||console.error(`[fetchStoreSettings] Unexpected error for ${r}:`,i.name,i.message,i.stack,i),i}}async function O_e(t,e){var l,c;let n=[],r=null,s=!0;if(typeof t!="string"||!t.trim()){const u=new TypeError("Invalid or empty storeDomain provided to fetchAllProducts.");throw console.error(u.message,{storeDomain:t}),u}if(typeof e!="string"||!e.trim()){const u=new TypeError("Invalid or empty token provided to fetchAllProducts.");throw console.error(u.message,{tokenProvided:typeof e=="string"&&e.length>0?"Yes":"No"}),u}const i=`https://${t}/graphql`,o=`
    query ProductsPage($first: Int!, $after: String) {
      site {
        products(first: $first, after: $after) {
          pageInfo {
            hasNextPage
            endCursor
          }
          edges {
            node {
              entityId
              name
              sku
              defaultImage {
                url(width: 800)
                altText
              }
              prices {
                price { value currencyCode }
                retailPrice { value currencyCode }
              }
            }
          }
        }
      }
    }
  `;console.log(`[fetchAllProducts] Starting to fetch products from: ${i}`,{domain:t,tokenProvided:!!e});try{let u=1;for(;s;){const d={first:50,after:r},h={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:o,variables:d})};let f;try{f=await fetch(i,h)}catch(x){console.error(`[fetchAllProducts] Initial fetch (Page ${u}) to ${i} failed:`,x);let E=`Initial fetch (Page ${u}) to ${i} failed.`;throw x.name==="TypeError"?E+=` This is often due to a CORS misconfiguration (check 'allowed_cors_origins' for your BigCommerce Storefront API token), a DNS issue, or the server not being reachable. Please check the browser's Network DevTools for more specific error messages. Original error: ${x.message}`:E+=` Error: ${x.message||"Unknown network error"}`,new Error(E)}if(console.log(`[fetchAllProducts] Response (Page ${u}) from ${i} - Status: ${f.status}, Complexity: ${f.headers.get("X-Bc-GraphQL-Complexity")}`),u++,!f.ok){let x=`Could not retrieve error body (status: ${f.status}).`;try{x=await f.text()}catch(E){console.warn("[fetchAllProducts] Failed to read error response body:",E)}throw new Error(`HTTP error ${f.status} for ${i} (products): ${x}`)}let m;try{m=await f.json()}catch(x){let E="Could not retrieve raw response text after JSON parse failure (fetchAllProducts).";try{E=await(await fetch(i,h)).text()}catch{}throw console.error("[fetchAllProducts] Failed to parse JSON response from BigCommerce.",x,{graphqlUrl:i,rawTextPreview:E.substring(0,500)}),new Error(`Failed to parse JSON response from ${i} (products). Preview: ${E.substring(0,200)}...`)}if(m.errors)throw console.error("[fetchAllProducts] BigCommerce GraphQL errors:",m.errors,{graphqlUrl:i}),new Error(`GraphQL error (products): ${m.errors.map(x=>x.message).join(", ")}`);const g=(c=(l=m.data)==null?void 0:l.site)==null?void 0:c.products;if(!g||!g.edges||!g.pageInfo)throw console.error("[fetchAllProducts] Invalid data structure in BigCommerce response:",m.data,{graphqlUrl:i}),new Error("Invalid data structure received from BigCommerce API for products.");g.edges.forEach(x=>n.push(x.node)),s=g.pageInfo.hasNextPage,r=g.pageInfo.endCursor}return n}catch(u){throw u.message.startsWith("Invalid or empty storeDomain")||u.message.startsWith("Invalid or empty token")||u.message.startsWith("HTTP error")||u.message.startsWith("GraphQL error")||u.message.startsWith("Failed to parse JSON")||u.message.startsWith("Network error")||console.error(`[fetchAllProducts] Unexpected error for ${i}:`,u.name,u.message,u.stack,u),u}}const Ge=ct.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("rounded-xl border bg-card text-card-foreground shadow-sm",t),...e}));Ge.displayName="Card";const rt=ct.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("flex flex-col space-y-1.5 p-6",t),...e}));rt.displayName="CardHeader";const st=ct.forwardRef(({className:t,...e},n)=>a.jsx("h3",{ref:n,className:bt("text-2xl font-semibold leading-none tracking-tight",t),...e}));st.displayName="CardTitle";const Wt=ct.forwardRef(({className:t,...e},n)=>a.jsx("p",{ref:n,className:bt("text-sm text-muted-foreground",t),...e}));Wt.displayName="CardDescription";const Ze=ct.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("p-6 pt-0",t),...e}));Ze.displayName="CardContent";const Lu=ct.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("flex items-center p-6 pt-0",t),...e}));Lu.displayName="CardFooter";const V_e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),$_e=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{const c=s.toDataURL("image/png").split(",")[1];e({base64ImageData:c,mimeType:"image/png"})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed, possibly due to CORS or tainted canvas."))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),U_e=({isOpen:t,onClose:e,products:n,onFinalize:r})=>{const[s,i]=p.useState([]),[o,l]=p.useState(!1),[c,u]=p.useState({}),[d,h]=p.useState(null),[f,m]=p.useState(!1),{toast:g}=Ls();p.useEffect(()=>{n&&i(n.map(R=>{var k,U;return{...R,images:Array.isArray(R.images)?[...R.images]:(U=(k=R.image)==null?void 0:k.src)!=null&&U.medium?[R.image.src.medium]:[],variants:Array.isArray(R.variants)?R.variants.map(B=>({...B,values:Array.isArray(B.values)?[...B.values]:[]})):[]}}))},[n]);const x=(R,k,U)=>{i(B=>{const K=[...B];return K[R]={...K[R],[k]:U},K})},E=async(R,k)=>{if(k)try{const U=await V_e(k);i(B=>{const K=[...B],ee=Array.isArray(K[R].images)?K[R].images:[];return K[R].images=[...ee,U],K})}catch(U){console.error("Error converting file to base64:",U),g({title:"Image Upload Error",description:"Could not process image.",variant:"destructive"})}},v=(R,k)=>{i(U=>{const B=[...U];return B[R].images=B[R].images.filter((K,ee)=>ee!==k),B})},_=async R=>{g({title:"Image Generation",description:"AI Image generation for this product is not yet implemented in this modal."}),console.log("Attempting to generate image for product at index:",R,s[R].name)},S=async R=>{const k=s[R];if(!k||!k.name){g({title:"Missing Product Info",description:"Product name is required to generate visuals.",variant:"destructive"});return}const U=k.images&&k.images.length>0?k.images[0]:null;if(!U){g({title:"Missing Base Image",description:"At least one image is required to generate more visuals.",variant:"destructive"});return}u(B=>({...B,[R]:!0}));try{const{base64ImageData:B,mimeType:K}=await $_e(U),ee=k.name;let H=[];try{const O=await rI(B,K,ee);O&&O.length>0&&H.push(...O.slice(0,2)),g({title:"Angles Generated",description:`${Math.min(2,(O==null?void 0:O.length)||0)} angle images generated.`,variant:"success"})}catch(O){console.error("Error generating angles:",O),g({title:"Angle Generation Failed",description:O.message,variant:"destructive"})}const X=[`Place this product, "${ee}", in a realistic home setting where it might be used or displayed. Focus on a natural context.`,`Show this product, "${ee}", in an outdoor lifestyle setting, highlighting its use case or appeal.`];for(const O of X)try{const z=await $l(B,K,O);z&&z.editedImageData&&H.push(`data:${z.newMimeType};base64,${z.editedImageData}`)}catch(z){console.error(`Error generating context image with prompt "${O}":`,z),g({title:"Context Image Failed",description:`Failed for: ${O.substring(0,30)}...`,variant:"destructive"})}g({title:"Context Images Attempted",description:`Attempted to generate ${X.length} context images.`,variant:"success"}),H.length>0?(i(O=>{const z=[...O],Y=Array.isArray(z[R].images)?z[R].images:[];return z[R].images=[...Y,...H],z}),g({title:"Visuals Added",description:`${H.length} new images added to the product.`,variant:"success"})):g({title:"No New Visuals",description:"Could not generate additional visuals.",variant:"default"})}catch(B){console.error("Error in handleGenerateMoreVisuals:",B),g({title:"Visual Generation Error",description:B.message,variant:"destructive"})}finally{u(B=>({...B,[R]:!1}))}},I=(R,k,U)=>{i(B=>{const K=[...B],ee={...K[R]};return ee.variants=[...ee.variants||[]],ee.variants[k]={...ee.variants[k],name:U},K[R]=ee,K})},M=(R,k,U,B)=>{i(K=>{const ee=[...K],H={...ee[R]};H.variants=[...H.variants||[]];const X={...H.variants[k]};return X.values=[...X.values||[]],X.values[U]=B,H.variants[k]=X,ee[R]=H,ee})},j=(R,k)=>{i(U=>{const B=[...U],K={...B[R]};K.variants=[...K.variants||[]];const ee={...K.variants[k]};return ee.values=[...ee.values||[],""],K.variants[k]=ee,B[R]=K,B})},C=(R,k,U)=>{i(B=>{const K=[...B],ee={...K[R]};ee.variants=[...ee.variants||[]];const H={...ee.variants[k]};return H.values=(H.values||[]).filter((X,O)=>O!==U),ee.variants[k]=H,K[R]=ee,K})},T=R=>{i(k=>{const U=[...k],B={...U[R]};return B.variants=[...B.variants||[],{name:"",values:[""]}],U[R]=B,U})},P=(R,k)=>{i(U=>{const B=[...U],K={...B[R]};return K.variants=(K.variants||[]).filter((ee,H)=>H!==k),B[R]=K,B})},A=()=>{if(l(!0),!s.every(k=>k.name&&k.name.trim()!==""&&(k.price||k.price===0)&&String(k.price).trim()!=="")){g({title:"Missing Information",description:"Please ensure all products have a name and a valid price.",variant:"destructive"}),l(!1);return}r(s),l(!1)},D=R=>{h(R),m(!0)};return t?a.jsxs(a.Fragment,{children:[a.jsx(ys,{open:t,onOpenChange:R=>!R&&e(),children:a.jsxs(es,{className:"max-w-3xl",children:[a.jsxs(ts,{children:[a.jsx(ns,{children:"Finalize Your Products"}),a.jsx(xo,{children:"Review and edit the AI-generated products before creating your store."})]}),a.jsx(Gi,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"space-y-6 pr-4",children:s.map((R,k)=>a.jsxs(Ge,{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`productName-${k}`,children:"Product Name"}),a.jsx(nt,{id:`productName-${k}`,value:R.name,onChange:U=>x(k,"name",U.target.value),placeholder:"Product Name"})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`productPrice-${k}`,children:"Price (USD)"}),a.jsx(nt,{id:`productPrice-${k}`,type:"number",value:R.price,onChange:U=>x(k,"price",U.target.value),placeholder:"0.00"})]})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`productDescription-${k}`,children:"Description"}),a.jsx(Ln,{id:`productDescription-${k}`,value:R.description,onChange:U=>x(k,"description",U.target.value),placeholder:"Product Description",rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{children:"Product Images"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(R.images||[]).map((U,B)=>a.jsxs("div",{className:"relative group w-24 h-24 cursor-pointer",onClick:()=>D(U),children:[a.jsx("img",{src:U,alt:`Product ${k+1} image ${B+1}`,className:"w-full h-full object-contain rounded-md border"}),a.jsx(V,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>v(k,B),children:a.jsx(er,{className:"h-3 w-3"})})]},B))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(V,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`productImageUpload-${k}`).click(),children:[a.jsx(Fo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsx(nt,{id:`productImageUpload-${k}`,type:"file",accept:"image/*",className:"hidden",onChange:U=>E(k,U.target.files[0])}),a.jsxs(V,{type:"button",variant:"outline",size:"sm",onClick:()=>_(k),disabled:o||!R.name,children:[o?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Xr,{className:"mr-2 h-4 w-4"}),"Generate Image"]}),a.jsxs(V,{type:"button",variant:"outline",size:"sm",onClick:()=>S(k),disabled:o||c[k]||!R.name||!R.images||R.images.length===0,children:[c[k]?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Xr,{className:"mr-2 h-4 w-4"}),"More Angles/Context"]})]})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(R.variants||[]).map((U,B)=>a.jsxs(Ge,{className:"p-2 space-y-2 bg-muted/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Re,{htmlFor:`variantName-${k}-${B}`,className:"text-xs",children:"Option Name"}),a.jsx(V,{variant:"ghost",size:"icon",onClick:()=>P(k,B),className:"h-6 w-6",children:a.jsx(er,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(nt,{id:`variantName-${k}-${B}`,value:U.name||"",onChange:K=>I(k,B,K.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(Re,{className:"text-xs",children:"Option Values (comma-separated or add one by one)"}),(U.values||[]).map((K,ee)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(nt,{value:K||"",onChange:H=>M(k,B,ee,H.target.value),placeholder:"e.g., Red",className:"text-sm h-8"}),a.jsx(V,{variant:"ghost",size:"icon",onClick:()=>C(k,B,ee),className:"h-6 w-6",children:a.jsx(er,{className:"h-3 w-3 text-destructive"})})]},ee)),a.jsxs(V,{variant:"outline",size:"sm",onClick:()=>j(k,B),className:"text-xs h-7",children:[a.jsx(so,{className:"mr-1 h-3 w-3"})," Add Value"]})]},B)),a.jsxs(V,{variant:"outline",onClick:()=>T(k),className:"w-full text-sm h-8",children:[a.jsx(so,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]},R.id||k))})}),a.jsxs(Tr,{children:[a.jsx(ba,{asChild:!0,children:a.jsx(V,{type:"button",variant:"outline",onClick:e,children:"Cancel"})}),a.jsxs(V,{type:"button",onClick:A,disabled:o,children:[o?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Finalize and Create Store"]})]})]})}),f&&d&&a.jsx(ys,{open:f,onOpenChange:m,children:a.jsxs(es,{className:"max-w-xl max-h-[80vh]",children:[a.jsxs(ts,{children:[a.jsx(ns,{children:"Enlarged Image"}),a.jsx(ba,{asChild:!0,children:a.jsxs(V,{variant:"ghost",size:"icon",className:"absolute top-4 right-4",onClick:()=>m(!1),children:[a.jsx(so,{className:"h-4 w-4 rotate-45"})," "]})})]}),a.jsx("div",{className:"flex justify-center items-center p-4",children:a.jsx("img",{src:d,alt:"Enlarged product",className:"max-w-full max-h-[70vh] object-contain"})})]})})]}):null},Ar="/placeholder-image.png",HG=p.createContext(null),$n=()=>{const t=p.useContext(HG);if(!t)throw new Error("useStore must be used within a StoreProvider");return t},k4="ecommerce-cart",B_e=({children:t})=>{const[e,n]=p.useState([]),[r,s]=p.useState(null),[i,o]=p.useState(!1),[l,c]=p.useState(0),[u,d]=p.useState(""),[h,f]=p.useState(!1),[m,g]=p.useState([]),[x,E]=p.useState("published"),{toast:v}=Ls(),_=bi(),{user:S,session:I,profile:M}=qi(),j=Q=>{Q==="published"||Q==="edit"?E(Q):(console.warn(`Invalid view mode: ${Q}. Defaulting to 'published'.`),E("published"))},[C,T]=p.useState(0),[P,A]=p.useState(""),[D,R]=p.useState(""),[k,U]=p.useState(null),[B,K]=p.useState({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[ee,H]=p.useState({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[X,O]=p.useState(null),[z,Y]=p.useState(!1),[F,ye]=p.useState(null),[Se,De]=p.useState(null),[xe,Me]=p.useState(!1),[Ye,qe]=p.useState(null),[et,We]=p.useState(!1),[mt,Le]=p.useState([]),[ve,Je]=p.useState(null),[Xe,kt]=p.useState(0),[Gt,fn]=p.useState(""),[sn,ae]=p.useState(""),[me,fe]=p.useState(null),[Ne,ne]=p.useState({items:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[de,Ee]=p.useState(!1),[Qe,re]=p.useState(null),Ve=async(Q,Z)=>{if(!Q||!Z)return console.error("Missing base64 string or path for Firebase Storage upload."),null;const ue=Q.split(",")[1];if(!ue)return console.error("Invalid base64 string provided for upload."),null;const ge=Ud(Bd,Z),Ae={contentType:"image/png"};try{const je=atob(ue),it=new Array(je.length);for(let vt=0;vt<je.length;vt++)it[vt]=je.charCodeAt(vt);const ot=new Uint8Array(it),Nt=await Vd(ge,ot,Ae),Qt=await $d(Nt.ref);return console.log(`Uploaded ${Z} to Firebase Storage. URL: ${Qt}`),Qt}catch(je){throw console.error(`Error uploading ${Z} to Firebase Storage:`,je),je}},Te=Q=>Q?Q.map(Z=>{const ue={...Z};if(ue.logo_url&&ue.logo_url.startsWith("data:image/")&&ue.logo_url.length>2048&&(ue.logo_url=`${ue.logo_url.substring(0,30)}...[truncated]`),ue.hero_image&&ue.hero_image.src){const ge={...ue.hero_image.src};ge.large&&ge.large.startsWith("data:image/")&&ge.large.length>2048&&(ge.large=`${ge.large.substring(0,30)}...[truncated]`),ge.medium&&ge.medium.startsWith("data:image/")&&ge.medium.length>2048&&(ge.medium=`${ge.medium.substring(0,30)}...[truncated]`),ue.hero_image={...ue.hero_image,src:ge}}return ue.products&&Array.isArray(ue.products)&&(ue.products=ue.products.map(ge=>{const Ae={...ge};if(Ae.image&&Ae.image.src){const je={...Ae.image.src};je.medium&&je.medium.startsWith("data:image/")&&je.medium.length>2048&&(je.medium=`${je.medium.substring(0,30)}...[truncated]`),je.large&&je.large.startsWith("data:image/")&&je.large.length>2048&&(je.large=`${je.large.substring(0,30)}...[truncated]`),Ae.image={...Ae.image,src:je}}return Ae})),ue}):[],ut=p.useCallback(async Q=>{f(!0),console.log(`[StoreContext] loadStores called for userId: ${Q||"Guest"}`);let Z=[],ue=[];const ge=localStorage.getItem("ecommerce-stores");if(ge)try{Z=JSON.parse(ge),console.log(`[StoreContext] Loaded ${Z.length} stores from localStorage.`)}catch(Ae){console.error("[StoreContext] Failed to parse localStorage stores:",Ae),v({title:"Local Cache Error",description:"Failed to load stores from local cache.",variant:"warning"}),Z=[]}if(n(Z),Q){console.log(`[StoreContext] Fetching cloud stores for userId: ${Q}`);try{const je=Pc(_r,"stores"),it=iT(je,oT("merchant_id","==",Q)),ot=await Ac(it);if(ot.empty)console.log("[StoreContext] No cloud stores found for this user.");else{console.log(`[StoreContext] Fetched ${ot.size} stores from Firestore. Processing details...`);const Nt=ot.docs.map(vt=>({id:vt.id,...vt.data()}));ue=await Promise.all(Nt.map(async vt=>{var on,Nr;try{const Pt=Pc(_r,"stores",vt.id,"products"),_s=(await Ac(Pt)).docs.map(_t=>({id:_t.id,..._t.data()})).map(_t=>{let ln={src:{large:"",medium:""}};return _t.images&&Array.isArray(_t.images)&&_t.images.length>0&&(ln.src.large=_t.images[0],ln.src.medium=_t.images[0]),{..._t,price:_t.priceAmount,image:ln,variants:_t.variants||[]}}),ft={...vt,createdAt:((Nr=(on=vt.created_at)==null?void 0:on.toDate())==null?void 0:Nr.toISOString())||new Date().toISOString()};let vn=[];const bs=Pc(_r,"stores",vt.id,"collections"),At=(await Ac(bs)).docs.map(_t=>({id:_t.id,..._t.data()}));return At&&At.length>0&&(vn=await Promise.all(At.map(async _t=>{let ln=[];return _t.product_ids&&_t.product_ids.length>0&&(ln=_s.filter(kn=>_t.product_ids.includes(kn.id))),{..._t,image:{src:_t.image_url||""},products:ln}}))),{...ft,products:_s,collections:vn}}catch(Pt){return console.error(`[StoreContext] Critical error processing details for store ${vt.id}:`,Pt),{...vt,products:[],collections:[]}}})),console.log(`[StoreContext] Finished processing details for ${ue.length} cloud stores.`)}}catch(je){console.error("[StoreContext] Overall critical error in fetching cloud stores:",je),v({title:"Cloud Loading Error",description:"A critical error occurred while fetching cloud store data.",variant:"destructive"})}const Ae=[...Z];ue.forEach(je=>{const it=Ae.findIndex(ot=>ot.id===je.id);it>-1?Ae[it]=je:Ae.push(je)}),Ae.sort((je,it)=>new Date(it.createdAt||it.created_at)-new Date(je.createdAt||je.created_at)),n(Ae);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Te(Ae))),console.log("[StoreContext] Updated localStorage with merged stores.")}catch(je){console.error("[StoreContext] Failed to save merged stores to localStorage:",je),v({title:"Local Cache Update Failed",description:"Could not update the local cache after cloud sync.",variant:"warning",duration:7e3})}}else console.log("[StoreContext] No user logged in. Displaying local stores only.");f(!1),console.log(`[StoreContext] loadStores finished. isLoadingStores: false. Final stores count: ${e.length}`)},[v,_r,Te]),pt=p.useCallback(async(Q,Z)=>{var Ae,je;const ue=e.find(it=>it.id===Q);if(!ue){console.warn(`[StoreContext] updateStore: Store with ID ${Q} not found in current state.`),v({title:"Update Failed",description:"Store not found for update.",variant:"destructive"});return}const ge={...ue,...Z};if(console.log(`[StoreContext] updateStore: updatedLocalStore for store ${Q} - Products: ${((Ae=ge.products)==null?void 0:Ae.length)||0}, Collections: ${((je=ge.collections)==null?void 0:je.length)||0}`),n(it=>{const ot=it.map(Nt=>Nt.id===Q?ge:Nt);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Te(ot))),console.log(`[StoreContext] updateStore: Saved ${ot.length} stores to localStorage.`)}catch(Nt){console.error("Failed to save stores to localStorage during update:",Nt),v({title:"Local Cache Update Failed",description:"Could not update the local cache for the store.",variant:"warning",duration:7e3})}return ot}),r&&r.id===Q&&(s(ge),console.log(`[StoreContext] updateStore: currentStore updated for store ${Q}.`)),v({title:"Store Updated (Locally)",description:"Changes saved locally."}),S){f(!0);try{const{settings:it,products:ot,collections:Nt,user_id:Qt,...vt}=Z,on=Pi(_r,"stores",Q);await Fy(on,vt),console.log(`Store ${Q} synced to Firestore asynchronously.`)}catch(it){console.error("Unexpected error during async Firestore updateStore:",it),v({title:"Cloud Sync Error",description:"An unexpected error occurred during cloud sync.",variant:"destructive"})}finally{f(!1)}}},[e,S,v,r,s,n,f,Te]),he=p.useCallback(async(Q,Z)=>{if(!r||!r.id){v({title:"Error",description:"No current store selected to update.",variant:"destructive"});return}if(typeof Q!="string"||Q.trim()===""){v({title:"Error",description:"Invalid identifier for text content.",variant:"destructive"});return}const ue=r.id,ge=typeof r.content=="object"&&r.content!==null?r.content:{};let Ae=JSON.parse(JSON.stringify(ge));const je=Q.split(".");let it=Ae;for(let ot=0;ot<je.length-1;ot++){const Nt=je[ot];(!it[Nt]||typeof it[Nt]!="object")&&(it[Nt]={}),it=it[Nt]}it[je[je.length-1]]=Z,await pt(ue,{content:Ae})},[r,pt,v]);p.useEffect(()=>{localStorage.setItem(k4,JSON.stringify(m))},[m]),p.useEffect(()=>{const Q=localStorage.getItem(k4);if(Q)try{g(JSON.parse(Q))}catch(Z){console.error("Failed to parse stored cart:",Z)}},[]);const be=async Q=>{let Z={...Q};const ue=Z.name||`Store-${en().substring(0,6)}`;Z.name||(Z.name=ue);const ge=await Fe(ue);if(!ge.available){const Pt=ge.error===!0?`Failed to verify store name "${ue}". Please try again.`:`The store name "${ue}" or a similar URL is already in use. Please choose a different name.`;throw v({title:"Store Name Unavailable",description:Pt,variant:"destructive"}),new Error(Pt)}Z.urlSlug=ge.slug,Z.template_version||(Z.template_version="v1");const Ae=Z.id||en(),je={...Z,id:Ae,createdAt:new Date().toISOString()};let it=je.products||[];const ot=new Map;let Nt=[];if(it=it.map(Pt=>({...Pt,id:Pt.id||en()})),it.forEach(Pt=>{ot.set(Pt.name,Pt.id)}),S&&S.uid)try{const{id:Pt,settings:an,products:lr,collections:_s,user_id:ft,...vn}=je,bs=Pi(_r,"stores",Pt);let vr=vn.logo_url;if(vr&&vr.startsWith("data:image/"))try{const _t=`store_logos/${Pt}/logo_${en()}.png`;vr=await Ve(vr,_t)}catch(_t){console.error("Error uploading store logo to Firebase Storage:",_t),v({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),vr=Ar}else vr||(vr=Ar);const At={...vn,merchant_id:S.uid,created_at:new Date,logo_url:vr||Ar,urlSlug:je.urlSlug};if(await Ox(bs,At),console.log(`Store ${Pt} saved to Firestore asynchronously.`),je.products&&je.products.length>0){const _t=[];for(const ln of je.products){let kn=[];if(ln.images&&Array.isArray(ln.images))for(const Ci of ln.images)if(Ci.startsWith("data:image/"))try{const Ti=`store_products/${Pt}/${ln.id||en()}/${en()}.png`,Pn=await Ve(Ci,Ti);Pn?kn.push(Pn):kn.push(Ar)}catch(Ti){console.error(`Error uploading product image for ${ln.name}:`,Ti),v({title:"Product Image Upload Failed",description:`Could not upload image for ${ln.name}.`,variant:"warning"}),kn.push(Ar)}else Ci?kn.push(Ci):kn.push(Ar);kn.length===0&&kn.push(Ar);const ei={store_id:Pt,name:ln.name||`Product ${en().substring(0,8)}`,description:ln.description||"No description available.",images:kn,priceAmount:Number(ln.price)>=0?Number(ln.price):0,currency:"usd",variants:ln.variants||[],created_at:new Date},wo=Pi(_r,"stores",Pt,"products",ln.id||en());_t.push(Ox(wo,ei)),ot.set(ln.name,wo.id)}await Promise.all(_t)}if(je.collections&&je.collections.length>0){const _t=[];for(const ln of je.collections){let kn=ln.imageUrl;if(kn&&kn.startsWith("data:image/"))try{const Ti=`store_collections/${Pt}/${ln.id||en()}/${en()}.png`;kn=await Ve(kn,Ti)}catch(Ti){console.error("Error uploading collection image to Firebase Storage:",Ti),v({title:"Collection Image Upload Failed",description:"Could not upload collection image.",variant:"warning"}),kn=Ar}else kn||(kn=Ar);const ei=(ln.product_ids||[]).map(Ti=>ot.get(Ti)).filter(Boolean),wo={store_id:Pt,name:ln.name,description:ln.description,image_url:kn||Ar,product_ids:ei,created_at:new Date},Ci=Pi(_r,"stores",Pt,"collections",ln.id||en());_t.push(Ox(Ci,wo)),Nt.push({id:Ci.id,...wo})}await Promise.all(_t)}}catch(Pt){console.error("Overall async Firestore store creation error. Code:",Pt.code,"Message:",Pt.message,"Full Error:",Pt),setTimeout(()=>{v({title:"Cloud Sync Error",description:`Firestore error (${Pt.code||"Unknown Code"}): ${Pt.message}`,variant:"destructive"})},0)}else S&&!S.uid&&(console.error("Firestore save skipped: User object is present but user.uid is undefined."),setTimeout(()=>{v({title:"User UID Missing",description:"Cannot save to cloud: User UID is missing. Please try logging out and back in.",variant:"destructive"})},0));let Qt=[];const vt=je.collections||[],on=it;vt.length>0&&(Qt=vt.map(Pt=>{let an={};if(S&&Nt&&Nt.length>0){const ft=Nt.find(vn=>vn.name===Pt.name);ft&&(an=ft)}let lr=[];Pt.product_ids&&Pt.product_ids.length>0&&Pt.product_ids.forEach(ft=>{const vn=ot.get(ft);let bs=null;vn?(bs=on.find(vr=>vr.id===vn),bs||ft!==vn&&(bs=on.find(vr=>vr.id===ft))):bs=on.find(vr=>vr.id===ft),bs&&lr.push(bs)});const _s=(an==null?void 0:an.image_url)||Pt.imageUrl||"";return{...Pt,...an,image:{src:_s},products:lr}}));const Nr={...je,products:on,collections:Qt};return n(Pt=>{const an=[Nr,...Pt.filter(lr=>lr.id!==Nr.id)];try{localStorage.setItem("ecommerce-stores",JSON.stringify(Te(an)))}catch(lr){console.error("Failed to save stores to localStorage during store creation:",lr),v({title:"Local Cache Update Failed",description:"Could not update the local cache after creating the store.",variant:"warning",duration:7e3})}return an}),s(Nr),Nr},Fe=async Q=>{if(!Q||typeof Q!="string"||Q.trim()==="")return{available:!0,slug:"",error:"Name cannot be empty."};const Z=nu(Q.trim());if(!Z)return{available:!0,slug:"",error:"Invalid name for URL generation."};try{const ue=Pc(_r,"stores"),ge=iT(ue,oT("urlSlug","==",Z));return{available:(await Ac(ge)).empty,slug:Z}}catch(ue){return console.error("Error checking store name availability:",ue),v({title:"Name Check Failed",description:"Could not verify store name uniqueness.",variant:"destructive"}),{available:!1,slug:Z,error:!0}}},Pe=async Q=>{var Z,ue;o(!0),c(0),d("Initializing wizard-based store generation...");try{const ge=await P_e(Q,{fetchPexelsImages:wa,generateId:en}),Ae=await be(ge);return c(100),d("Store generation complete!"),Ae}catch(ge){return console.error("Error generating store from wizard:",ge),!((Z=ge.message)!=null&&Z.includes("already in use"))&&!((ue=ge.message)!=null&&ue.includes("Failed to verify store name"))&&v({title:"Wizard Generation Failed",description:ge.message||"Failed to generate store.",variant:"destructive"}),c(0),d("Generation failed."),null}finally{o(!1)}},Yt=async(Q,Z=null,ue=null)=>{o(!0),c(0),d("Initializing generation...");try{const Ae=await A_e(Q,{storeNameOverride:Z,productTypeOverride:ue,fetchPexelsImages:wa,generateId:en},(je,it)=>{c(je),it&&d(it)});return Le(Ae.products||[]),Je(Ae),We(!0),d("Products generated. Please review and finalize."),c(90),null}catch(ge){return console.error("Error generating store from prompt:",ge),ge.message&&ge.message.toLowerCase().includes("name taken")?v({title:"Store Name Taken",description:ge.message,variant:"destructive"}):v({title:"Generation Failed",description:ge.message||"Failed to generate store.",variant:"destructive"}),c(0),d("Generation failed."),null}finally{o(!1)}},Ht=()=>{T(0),A(""),R(""),U(null),K({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),H({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),O(null),Y(!1),ye(null),De(null),Me(!1),qe(null)},Tt=async(Q,Z)=>{A(Q),R(Z),Y(!0),ye(null),U(null);try{v({title:"Connecting to Shopify...",description:"Fetching store information."});const ue=await R_e(Q,Z);if(!ue)throw new Error("Failed to fetch Shopify store metadata. The store might not exist or the token might be invalid.");return U(ue),T(2),!0}catch(ue){return console.error("Error starting Shopify import wizard (fetching metadata):",ue),ye(ue.message||"Failed to connect to Shopify and fetch store information."),v({title:"Connection Failed",description:ue.message||"Could not fetch store information.",variant:"destructive"}),!1}finally{Y(!1)}},yt=()=>{kt(0),fn(""),ae(""),fe(null),ne({items:[],pageInfo:{hasNextPage:!1,endCursor:null}}),Ee(!1),re(null)},Ft=async(Q,Z)=>{fn(Q),ae(Z),kt(2),await Sn(Q,Z)},Sn=async(Q,Z)=>{const ue=Q||Gt,ge=Z||sn;if(!ue||!ge){re("Domain or token missing for fetching BigCommerce settings.");return}Y(!0),re(null);try{const Ae=await F_e(ue,ge);fe(Ae)}catch(Ae){console.error("Error fetching BigCommerce settings for wizard:",Ae),re(Ae.message||"Failed to fetch store settings."),v({title:"BigCommerce Settings Fetch Failed",description:Ae.message,variant:"destructive"})}finally{Y(!1)}},mn=async(Q=10)=>{if(!Gt||!sn){re("Domain or token missing for fetching BigCommerce products.");return}Ee(!0),re(null);try{const Z=`
      query ProductsPreview($first: Int!) {
        site {
          products(first: $first) {
            edges {
              node {
                entityId name sku defaultImage { url(width: 200) altText }
                prices { price { value currencyCode } }
              }
            }
          }
        }
      }
    `,ue={first:Q},Ae=await(await fetch(`https://${Gt}/graphql`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sn}`},body:JSON.stringify({query:Z,variables:ue})})).json();if(Ae.errors)throw new Error(Ae.errors.map(je=>je.message).join(", "));ne({items:Ae.data.site.products.edges.map(je=>je.node),pageInfo:{hasNextPage:!1,endCursor:null}})}catch(Z){console.error("Error fetching BigCommerce products for wizard:",Z),re(Z.message||"Failed to fetch products."),v({title:"BigCommerce Product Fetch Failed",description:Z.message,variant:"destructive"})}finally{Ee(!1)}},xr=async()=>{if(!me||!Gt||!sn)return v({title:"Import Error",description:"Missing BigCommerce data to finalize import.",variant:"destructive"}),!1;o(!0),re(null);try{const Q=await O_e(Gt,sn),Z=L_e(me,Q,Gt,{generateId:en},null);return await be(Z)?(yt(),!0):!1}catch(Q){return console.error("Error finalizing BigCommerce import from wizard:",Q),re(Q.message||"Failed to finalize BigCommerce import."),v({title:"BigCommerce Import Failed",description:Q.message,variant:"destructive"}),!1}finally{o(!1)}},Un=async(Q=10,Z=null)=>{if(!P||!D){ye("Domain or token missing for fetching products.");return}Y(!0),ye(null);try{const ue=await j_e(P,D,Q,Z);K(ge=>({edges:Z?[...ge.edges,...ue.edges]:ue.edges,pageInfo:ue.pageInfo}))}catch(ue){console.error("Error fetching Shopify products for wizard:",ue),ye(ue.message||"Failed to fetch products."),v({title:"Product Fetch Failed",description:ue.message,variant:"destructive"})}finally{Y(!1)}},Xt=async(Q=10,Z=null)=>{if(!P||!D){ye("Domain or token missing for fetching collections.");return}Y(!0),ye(null);try{const ue=await k_e(P,D,Q,Z);H(ge=>({edges:Z?[...ge.edges,...ue.edges]:ue.edges,pageInfo:ue.pageInfo}))}catch(ue){console.error("Error fetching Shopify collections for wizard:",ue),ye(ue.message||"Failed to fetch collections."),v({title:"Collection Fetch Failed",description:ue.message,variant:"destructive"})}finally{Y(!1)}},nn=async(Q="US",Z="EN")=>{if(!P||!D){ye("Domain or token missing for fetching localization.");return}Y(!0),ye(null);try{const ue=await D_e(P,D,Q,Z);O(ue)}catch(ue){console.error("Error fetching Shopify localization for wizard:",ue),ye(ue.message||"Failed to fetch localization info."),v({title:"Localization Info Fetch Failed",description:ue.message,variant:"default"})}finally{Y(!1)}},Bn=async()=>{if(console.log("[StoreContext] Attempting to generate Shopify store logo..."),!k||!k.name){console.warn("[StoreContext] Cannot generate logo: Shopify preview metadata or store name is missing.",k),qe("Store name is not available to generate a logo."),v({title:"Logo Generation Error",description:"Store name missing. Ensure Shopify store details were fetched correctly.",variant:"destructive"});return}const Q=k.name;console.log(`[StoreContext] Generating logo for store name: "${Q}"`),Me(!0),qe(null),De(null);try{console.log("[StoreContext] Calling generateLogoWithGemini...");const{imageData:Z,textResponse:ue}=await Yp(Q);if(console.log("[StoreContext] generateLogoWithGemini response:",{imageData:Z?"imageData received (see next log)":"no imageData",textResponse:ue}),Z)console.log("[StoreContext] imageData (first 50 chars):",Z.substring(0,50)),De(`data:image/png;base64,${Z}`),v({title:"Logo Generated!",description:"A new logo has been generated successfully."}),console.log("[StoreContext] Logo generated and state updated.");else throw console.error("[StoreContext] generateLogoWithGemini returned no imageData. Text response:",ue),new Error(ue||"Gemini did not return image data.")}catch(Z){console.error("[StoreContext] Error during Shopify store logo generation:",Z.message,Z.stack),qe(Z.message||"Failed to generate logo."),v({title:"Logo Generation Failed",description:`Error: ${Z.message}`,variant:"destructive"})}finally{Me(!1),console.log("[StoreContext] Finished logo generation attempt.")}},q=async()=>{if(!k||!P||!D)return v({title:"Import Error",description:"Missing essential Shopify data to finalize import.",variant:"destructive"}),!1;o(!0),ye(null);try{const Q=B.edges.map(Ae=>Ae.node),Z=ee.edges.map(Ae=>Ae.node),ue=M_e(k,Q,Z,P,{generateId:en},Se);return await be(ue)?(Ht(),!0):!1}catch(Q){return console.error("Error finalizing Shopify import from wizard:",Q),ye(Q.message||"Failed to finalize Shopify import."),v({title:"Import Failed",description:Q.message||"Could not complete Shopify store import.",variant:"destructive"}),!1}finally{o(!1)}},te=Q=>e.find(Z=>Z.id===Q)||null,le=Q=>e.find(Z=>nu(Z.name)===Q)||null,Ie=(Q,Z)=>{const ue=te(Q);return(ue==null?void 0:ue.products.find(ge=>ge.id===Z))||null},Oe=async(Q,Z)=>{if(!S){v({title:"Authentication Required",description:"Please log in to set a pass key.",variant:"destructive"});return}f(!0);try{const ue=Pi(_r,"stores",Q);await Fy(ue,{pass_key:Z}),n(ge=>{const Ae=ge.map(je=>je.id===Q?{...je,pass_key:Z}:je);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Te(Ae)))}catch(je){console.error("Failed to save stores to localStorage after pass key update:",je),v({title:"Local Cache Update Failed",description:"Could not update the local cache after pass key update.",variant:"warning",duration:7e3})}return Ae}),r&&r.id===Q&&s(ge=>ge?{...ge,pass_key:Z}:null),v({title:"Store Pass Key Set",description:"The pass key for the store has been updated."})}catch(ue){console.error("Unexpected error in updateStorePassKey:",ue),v({title:"Pass Key Update Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{f(!1)}},ht=async(Q,Z)=>{if(!S){v({title:"Authentication Required",description:"Please log in to assign a manager.",variant:"destructive"});return}if(!Q||!Z){v({title:"Missing Information",description:"Store ID and Manager Email are required.",variant:"destructive"});return}f(!0);try{console.warn("Assign Store Manager functionality needs to be migrated to a Firebase Cloud Function or direct Firestore logic."),v({title:"Manager Assignment (Placeholder)",description:"Functionality needs Firebase Cloud Function implementation.",variant:"info"}),v({title:"Store Manager Assigned",description:`Manager ${Z} assigned to store.`})}catch(ue){console.error("Unexpected error in assignStoreManager:",ue),v({title:"Manager Assignment Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{f(!1)}},dt=async(Q,Z,ue)=>{if(!S){v({title:"Authentication Required",description:"Please log in to update product images.",variant:"destructive"});return}const ge=e.find(it=>it.id===Q);if(!ge){console.warn(`[StoreContext] updateProductImage: Store with ID ${Q} not found.`),v({title:"Update Failed",description:"Store not found for updating product image.",variant:"destructive"});return}let Ae=ue.src.large;if(Ae&&Ae.startsWith("data:image/"))try{const it=`store_products/${Q}/${Z}/image_${en()}.png`,ot=await Ve(Ae,it);ot?Ae=ot:(Ae=Ae.startsWith("data:image/")?Ar:Ae,v({title:"Image Upload Failed",description:"Could not upload new product image. Using placeholder or existing.",variant:"warning"}))}catch(it){console.error(`Error uploading new product image for ${Z}:`,it),v({title:"Image Upload Failed",description:"Could not upload new product image.",variant:"destructive"}),Ae=Ar}else Ae||(Ae=Ar);const je=ge.products.map(it=>it.id===Z?{...it,image:{...it.image,src:{large:Ae,medium:Ae}},images:it.images?[...it.images.filter(ot=>ot!==it.image.src.large),Ae]:[Ae]}:it);try{const it=Pi(_r,"stores",Q,"products",Z);await Fy(it,{images:je.find(ot=>ot.id===Z).images,image:{src:{large:Ae,medium:Ae}}}),v({title:"Product Image Updated",description:"The product image has been changed."})}catch(it){console.error("Error updating product image in Firestore:",it),v({title:"Cloud Sync Failed",description:`Failed to save product image to cloud: ${it.message}`,variant:"destructive"});return}n(it=>{const ot=it.map(Nt=>Nt.id===Q?{...Nt,products:je}:Nt);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Te(ot)))}catch(Nt){console.error("Failed to save stores to localStorage during product image update:",Nt),v({title:"Local Cache Update Failed",description:"Could not update the local cache for product image.",variant:"warning",duration:7e3})}return ot}),r&&r.id===Q&&s(it=>it?{...it,products:je}:null)},W=async Q=>{if(!S){v({title:"Authentication Required",description:"Please log in to delete a store.",variant:"destructive"});return}const Z=[...e];n(ue=>{const ge=ue.filter(Ae=>Ae.id!==Q);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Te(ge)))}catch(Ae){console.error("Failed to save stores to localStorage during optimistic delete:",Ae),v({title:"Local Cache Update Issue",description:"Could not update the local cache during store deletion. Cloud operation will proceed.",variant:"warning",duration:7e3})}return ge}),r&&r.id===Q&&s(null);try{const ue=Pc(_r,"stores",Q,"products"),ge=await Ac(ue),Ae=[];for(const Qt of ge.docs)Ae.push(cS(Pi(_r,"stores",Q,"products",Qt.id)));await Promise.all(Ae),console.log(`Deleted ${ge.size} products for store ${Q}.`);const je=Pc(_r,"stores",Q,"collections"),it=await Ac(je),ot=[];for(const Qt of it.docs)ot.push(cS(Pi(_r,"stores",Q,"collections",Qt.id)));await Promise.all(ot),console.log(`Deleted ${it.size} collections for store ${Q}.`);const Nt=Pi(_r,"stores",Q);await cS(Nt),console.log(`Store ${Q} deleted from Firestore.`),v({title:"Store Deleted",description:"Your store has been deleted."})}catch(ue){console.error("Error deleting store from Firestore:",ue),v({title:"Deletion Failed",description:ue.message,variant:"destructive"}),n(Z);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Te(Z)))}catch(ge){console.error("Failed to save stores to localStorage during delete rollback:",ge),v({title:"Local Cache Revert Failed",description:"Could not revert local cache changes after a failed deletion.",variant:"error",duration:8e3})}Z.find(ge=>ge.id===Q)&&s(Z.find(ge=>ge.id===Q)||null);return}},J=async(Q,Z,ue)=>{if(!S){v({title:"Authentication Required",description:"Please log in to update product images.",variant:"destructive"});return}const ge=e.find(ot=>ot.id===Q);if(!ge){console.warn(`[StoreContext] updateProductImagesArray: Store with ID ${Q} not found.`),v({title:"Update Failed",description:"Store not found for updating product images.",variant:"destructive"});return}let Ae=!1,je=[];for(const ot of ue)if(typeof ot=="string"&&ot.startsWith("data:image/"))try{const Nt=`store_products/${Q}/${Z}/gallery_${en()}.png`,Qt=await Ve(ot,Nt);Qt?je.push(Qt):je.push(Ar)}catch(Nt){console.error(`Error uploading gallery image for product ${Z}:`,Nt),v({title:"Image Upload Failed",description:"Could not upload one or more product gallery images.",variant:"destructive"}),je.push(Ar)}else typeof ot=="string"&&ot?je.push(ot):(console.warn(`[StoreContext] updateProductImagesArray: Invalid or empty image in newImagesArray for product ${Z}`,ot),je.push(Ar));je.length===0&&ue.length>0&&je.push(Ar);const it=ge.products.map(ot=>{var Nt,Qt;if(ot.id===Z){Ae=!0;const vt=je.length>0?je[0]:((Qt=(Nt=ot.image)==null?void 0:Nt.src)==null?void 0:Qt.medium)||Ar;return{...ot,images:je.length>0?je:[Ar],image:{...ot.image||{id:en(),alt:ot.name||"Product Image"},src:{medium:vt,large:vt}}}}return ot});if(!Ae){console.warn(`[StoreContext] updateProductImagesArray: Product with ID ${Z} not found in store ${Q}.`),v({title:"Update Failed",description:"Product not found for updating images.",variant:"destructive"});return}try{const ot=Pi(_r,"stores",Q,"products",Z),Nt=it.find(Qt=>Qt.id===Z);if(Nt)await Fy(ot,{images:Nt.images,image:Nt.image}),v({title:"Product Images Updated",description:"The product's image gallery has been updated."});else throw new Error("Updated product data not found for Firestore update.")}catch(ot){console.error("Error updating product images array in Firestore:",ot),v({title:"Cloud Sync Failed",description:`Failed to save product images to cloud: ${ot.message}`,variant:"destructive"});return}n(ot=>{const Nt=ot.map(Qt=>Qt.id===Q?{...Qt,products:it}:Qt);try{localStorage.setItem("ecommerce-stores",JSON.stringify(Te(Nt)))}catch(Qt){console.error("Failed to save stores to localStorage during product images array update:",Qt),v({title:"Local Cache Update Failed",description:"Could not update the local cache for product images array.",variant:"warning",duration:7e3})}return Nt}),r&&r.id===Q&&s(ot=>ot?{...ot,products:it}:null)},se=(Q,Z)=>{g(ue=>ue.find(Ae=>Ae.id===Q.id&&Ae.storeId===Z)?ue.map(Ae=>Ae.id===Q.id&&Ae.storeId===Z?{...Ae,quantity:Ae.quantity+1}:Ae):[...ue,{...Q,quantity:1,storeId:Z}]),v({title:"Added to Cart",description:`${Q.name} has been added to your cart.`})},G=(Q,Z)=>{g(ue=>ue.filter(ge=>!(ge.id===Q&&ge.storeId===Z))),v({title:"Removed from Cart",description:"Item removed from your cart.",variant:"destructive"})},oe=(Q,Z,ue)=>{if(ue<1){G(Q,Z);return}g(ge=>ge.map(Ae=>Ae.id===Q&&Ae.storeId===Z?{...Ae,quantity:ue}:Ae))},we=()=>{g([]),v({title:"Cart Cleared",description:"Your shopping cart is now empty."})},ke=p.useCallback((Q,Z)=>{const ue=e.find(je=>je.id===Q);if(!ue)return console.warn(`[getUpdatesForVersion] Store with ID ${Q} not found.`),{template_version:Z};let ge={template_version:Z};const Ae=ue.theme||{};return ue.template_version,Z==="v1"?["Montserrat","PremiumMain","SharpFont","FreshFont","SleekFont"].includes(Ae.fontFamily)||!Ae.fontFamily?ge.theme={...Ae,fontFamily:"Inter"}:ge.theme={...Ae}:Z==="premium"&&(ge.theme={...Ae,fontFamily:"PremiumMain"}),ge},[e]),_e={stores:e,currentStore:r,isGenerating:i,isLoadingStores:h,cart:m,user:S,progress:l,statusMessage:u,loadStores:ut,generateStore:Yt,updateStoreTextContent:he,checkStoreNameAvailability:Fe,getStoreById:te,getStoreByName:le,updateStore:pt,deleteStore:W,setCurrentStore:s,updateStorePassKey:Oe,assignStoreManager:ht,updateStoreTemplateVersion:async(Q,Z)=>{if(!Q||!Z){v({title:"Error",description:"Store ID and new template version are required.",variant:"destructive"});return}const ue=ke(Q,Z);await pt(Q,ue);let ge=Z;Z==="v1"?ge="Modern":Z==="premium"?ge="Premium":Z==="sharp"?ge="Sharp":Z==="fresh"?ge="Fresh":Z==="sleek"?ge="Sleek":ge=Z.charAt(0).toUpperCase()+Z.slice(1),v({title:"Template Updated",description:`Store template is now ${ge}.`})},getProductById:Ie,updateProductImage:dt,generateStoreFromWizard:Pe,addToCart:se,removeFromCart:G,updateQuantity:oe,clearCart:we,generateAIProducts:N_e,updateProductImagesArray:J,viewMode:x,setViewMode:j,shopifyWizardStep:C,setShopifyWizardStep:T,shopifyDomain:P,setShopifyDomain:A,shopifyToken:D,setShopifyToken:R,shopifyPreviewMetadata:k,shopifyPreviewProducts:B,shopifyPreviewCollections:ee,shopifyLocalization:X,isFetchingShopifyPreviewData:z,shopifyImportError:F,generatedLogoImage:Se,isGeneratingLogo:xe,logoGenerationError:Ye,startShopifyImportWizard:Tt,fetchShopifyWizardProducts:Un,fetchShopifyWizardCollections:Xt,fetchShopifyWizardLocalization:nn,generateShopifyStoreLogo:Bn,finalizeShopifyImportFromWizard:q,resetShopifyWizardState:Ht,updateShopifyPreviewProduct:Q=>{K(Z=>{const ue=Z.edges.map(ge=>ge.node.id===Q.id?{...ge,node:Q}:ge);return{...Z,edges:ue}})},updateShopifyPreviewCollection:Q=>{H(Z=>{const ue=Z.edges.map(ge=>ge.node.id===Q.id?{...ge,node:Q}:ge);return{...Z,edges:ue}})},bigCommerceWizardStep:Xe,setBigCommerceWizardStep:kt,bigCommerceStoreDomain:Gt,bigCommerceApiToken:sn,bigCommercePreviewSettings:me,bigCommercePreviewProducts:Ne,isFetchingBigCommercePreviewData:de,bigCommerceImportError:Qe,startBigCommerceImportWizard:Ft,fetchBigCommerceWizardSettings:Sn,fetchBigCommerceWizardProducts:mn,finalizeBigCommerceImportFromWizard:xr,resetBigCommerceWizardState:yt,openProductFinalizationModal:(Q,Z)=>{Le(Q),Je(Z),We(!0)},closeProductFinalizationModal:()=>{We(!1),Le([]),Je(null),o(!1),c(0),d("")},handleFinalizeProducts:async Q=>{if(!ve){v({title:"Error",description:"Store data for finalization is missing.",variant:"destructive"}),We(!1),o(!1);return}o(!0),d("Finalizing store creation..."),c(95);const Z={...ve,products:Q};try{const ue=await be(Z);if(ue)c(100),d("Store generation complete!"),v({title:"Store Created!",description:`Store "${ue.name}" has been created.`}),_(`/${ue.urlSlug||nu(ue.name)}`);else throw new Error("Store creation returned no result after finalization.")}catch(ue){console.error("Error during final store creation after product finalization:",ue),v({title:"Finalization Failed",description:ue.message||"Failed to create store after finalization.",variant:"destructive"}),c(0),d("Finalization failed.")}finally{We(!1),Le([]),Je(null),o(!1)}}};return a.jsxs(HG.Provider,{value:_e,children:[t,a.jsx(U_e,{isOpen:et,onClose:_e.closeProductFinalizationModal,products:mt,onFinalize:_e.handleFinalizeProducts})]})},Ff=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),z_e=({product:t,storeId:e,onContentCreated:n})=>{var Ee,Qe;const{toast:r}=Ls(),{storeName:s}=Ww(),i=Ma(),o=(Ee=i.state)==null?void 0:Ee.product,l=(Qe=i.state)==null?void 0:Qe.storeData,c=t||o,{getStoreById:u,getStoreByName:d}=$n(),[h,f]=p.useState("text-to-image"),[m,g]=p.useState(""),[x,E]=p.useState(""),[v,_]=p.useState(!1),[S,I]=p.useState(!1),[M,j]=p.useState(null),[C,T]=p.useState([]),[P,A]=p.useState(!1),[D,R]=p.useState(""),[k,U]=p.useState(null),[B,K]=p.useState(!1),[ee,H]=p.useState(null),[X,O]=p.useState([]),[z,Y]=p.useState(""),[F,ye]=p.useState(!1),[Se,De]=p.useState(null),[xe,Me]=p.useState(!1),[Ye,qe]=p.useState([]),[et,We]=p.useState(!1),[mt,Le]=p.useState(!1),[ve,Je]=p.useState(null),Xe=async()=>{var re,Ve;if(!(!ve||!ve.url))try{const Te=document.createElement("a");let ut="download";if(ve.url.startsWith("data:")){const pt=ve.url.match(/:(.*?);/),be=(pt?pt[1]:"application/octet-stream").split("/")[1]||"bin";ut=`${((re=ve.caption)==null?void 0:re.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${be}`,Te.href=ve.url}else{const he=await(await fetch(ve.url)).blob();Te.href=URL.createObjectURL(he);const be=ve.url.substring(ve.url.lastIndexOf("/")+1).split("?")[0],Fe=be.includes(".")?be.substring(be.lastIndexOf(".")+1):"",Pe=ve.type==="video"?"mp4":"png";ut=be||`${((Ve=ve.caption)==null?void 0:Ve.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${Fe||Pe}`}Te.download=ut,document.body.appendChild(Te),Te.click(),document.body.removeChild(Te),ve.url.startsWith("data:")||URL.revokeObjectURL(Te.href),r({title:"Download Started",description:`Downloading ${ut}`})}catch(Te){console.error("Error downloading media:",Te),r({title:"Download Failed",description:Te.message,variant:"destructive"})}};p.useEffect(()=>{let re=l;if(re||(s?re=d(s):e?re=u(e):c&&c.store_id&&(re=u(c.store_id))),re&&re.products){We(!0);const Ve=re.products.map(Te=>{var ut,pt,he;return{id:Te.id,name:Te.name,image:{src:{medium:((pt=(ut=Te.image)==null?void 0:ut.src)==null?void 0:pt.medium)||`https://via.placeholder.com/100x100.png?text=${encodeURIComponent(((he=Te.name)==null?void 0:he.substring(0,10))||"P")}`}}}});qe(Ve),We(!1)}else console.warn("[ContentCreationPage] No current store products found. Falling back to sample product catalog."),qe([{id:"sample_prod_1",name:"Sample Product Alpha",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Alpha"}}},{id:"sample_prod_2",name:"Sample Product Beta",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Beta"}}},{id:"sample_prod_3",name:"Sample Product Gamma",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Gamma"}}}]),We(!1);c&&c.name&&(g(`A captivating image of ${c.name}`),(async()=>{A(!0);try{const Te={name:c.name,description:c.description||"",niche:(re==null?void 0:re.type)||c.niche||"",storeName:(re==null?void 0:re.name)||c.storeName||""},ut=await Coe(Te);ut.suggestions&&ut.suggestions.length>0?T(ut.suggestions):ut.error&&console.warn("Could not fetch prompt suggestions:",ut.error)}catch(Te){console.error("Error fetching prompt suggestions:",Te)}finally{A(!1)}})())},[c,l,s,e,u,d]);const kt=async()=>{if(!m.trim()){r({title:"Error",description:"Please enter a prompt for image generation",variant:"destructive"});return}_(!0),j(null),Y("");try{const re=await j1(m);let Ve=re.alt?[re.alt]:[`Image for: ${m.substring(0,30)}`];if(re.url)try{const{base64ImageData:Te,mimeType:ut}=await Ff(re.url);Ve=await kd(Te,ut,`Image of ${m}`)}catch(Te){console.error("Error generating caption for Gemini image:",Te),Ve=[`Failed to generate caption for: ${m.substring(0,30)}`]}j({url:re.url,captions:Ve,sourceApi:"gemini"}),Ve&&Ve.length>0&&Y(Ve[0])}catch(re){console.error("Error generating image with Gemini:",re),r({title:"Image Generation Failed",description:re.message,variant:"destructive"})}finally{_(!1)}},Gt=async()=>{if(!x.trim()){r({title:"Error",description:"Please enter a prompt for OpenAI image generation",variant:"destructive"});return}I(!0),j(null),Y("");try{const re=await dfe(x),Ve=`data:image/png;base64,${re.b64_json}`;let Te=re.alt?[re.alt]:[`OpenAI image for: ${x.substring(0,30)}`];try{const{base64ImageData:ut,mimeType:pt}=await Ff(Ve);Te=await kd(ut,pt,`OpenAI-generated image of ${x}`)}catch(ut){console.error("Error generating caption for OpenAI image:",ut),Te=[`Failed to generate caption for: ${x.substring(0,30)}`]}j({url:Ve,captions:Te,sourceApi:"openai"}),Te&&Te.length>0&&Y(Te[0]),r({title:"Image Generated (OpenAI)",description:"Image successfully generated using OpenAI."})}catch(re){console.error("Error generating image with OpenAI:",re),r({title:"OpenAI Image Generation Failed",description:re.message,variant:"destructive"})}finally{I(!1)}},fn=async(re,Ve)=>{if(!re||!re.url){r({title:"Error",description:"No image selected to edit with Gemini.",variant:"destructive"});return}if(!Ve.trim()){r({title:"Error",description:"Please enter an edit prompt for Gemini.",variant:"destructive"});return}K(!0),H(null),Y("");try{const{base64ImageData:Te,mimeType:ut}=await Ff(re.url),pt=await $l(Te,ut,Ve);if(pt&&pt.editedImageData){const he=`data:${pt.newMimeType};base64,${pt.editedImageData}`;let be=pt.editTextResponse?[pt.editTextResponse]:[`Edited with Gemini: ${re.caption||re.id}`];try{be=await kd(pt.editedImageData,pt.newMimeType,`Edited image based on: ${Ve}`)}catch(Fe){console.error("Error generating caption for Gemini edited image:",Fe)}H({url:he,captions:be,sourceApi:"gemini"}),be&&be.length>0&&Y(be[0]),r({title:"Image Edited (Gemini)",description:"Image successfully edited with Gemini."})}else throw new Error("Gemini image edit did not return image data.")}catch(Te){console.error("Error editing image with Gemini:",Te),r({title:"Gemini Edit Failed",description:Te.message,variant:"destructive"})}finally{K(!1)}},sn=async re=>{const Ve=re.target.files[0];if(Ve){Me(!0),De(null),Y("");try{const Te=new FileReader;Te.onload=async ut=>{const pt=ut.target.result,he=Ve.type.startsWith("video/")?"video":"image";let be=[Ve.name];if(he==="image")try{const{base64ImageData:Fe,mimeType:Pe}=await Ff(pt);be=await kd(Fe,Pe,"Uploaded image caption")}catch(Fe){console.error("Error generating caption for uploaded image:",Fe)}else be=[`Uploaded video: ${Ve.name}`];De({url:pt,captions:be,type:he}),be&&be.length>0&&Y(be[0]),Me(!1)},Te.onerror=()=>{r({title:"Upload Failed",description:"Failed to read the selected file",variant:"destructive"}),Me(!1)},Te.readAsDataURL(Ve)}catch(Te){console.error("Error processing uploaded file:",Te),r({title:"Upload Failed",description:Te.message,variant:"destructive"}),Me(!1)}}},ae=(re,Ve,Te="image")=>{if(!re){r({title:"Cannot Add",description:"Item URL is missing.",variant:"destructive"});return}const ut={id:en(),type:Te,url:re,caption:Ve||`Item ${X.length+1}`,isVideo:Te==="video"};O(pt=>[...pt,ut]),r({title:"Added to Timeline",description:`${Te==="video"?"Video":"Image"} added to your content timeline.`}),j(null),H(null),De(null),U(null),Y("")},me=(re,Ve)=>{const Te=[...X],ut=Te[re],pt=re+Ve;pt<0||pt>=Te.length||(Te.splice(re,1),Te.splice(pt,0,ut),O(Te))},fe=re=>{O(Ve=>Ve.filter(Te=>Te.id!==re)),r({title:"Removed from Timeline",description:"Item removed."})},Ne=async(re,Ve)=>{if(re.isVideo){r({title:"Already a Video",description:"This item is already a video."});return}ye(!0);try{const{base64ImageData:Te,mimeType:ut}=await Ff(re.url),pt=re.caption||`Create a short video from this image: ${c?c.name:"product showcase"}`,he=await aU(pt,Te,ut),be=[...X];be[Ve]={...re,url:he,isVideo:!0,type:"video",caption:re.caption+" (Veo Video)"},O(be),r({title:"Veo Video Generated",description:"Image converted to video using Veo."})}catch(Te){console.error("Error converting to Veo video:",Te),r({title:"Veo Conversion Failed",description:Te.message,variant:"destructive"})}finally{ye(!1)}},ne=re=>{const Ve=X.find(ut=>ut.id===re);if(!Ve)return;const Te=prompt("Edit caption:",Ve.caption);Te!==null&&Te.trim()!==Ve.caption&&(O(ut=>ut.map(pt=>pt.id===re?{...pt,caption:Te.trim()}:pt)),r({title:"Caption Updated"}))},de=re=>{if(re.image&&re.image.src&&re.image.src.medium){const Ve=`Product: ${re.name}`;ae(re.image.src.medium,Ve,"image")}else r({title:"No Image",description:`Product ${re.name} has no image.`,variant:"destructive"});Le(!1)};return a.jsxs("div",{className:"container mx-auto p-4 md:p-6 lg:p-8 space-y-8 bg-background",children:[" ",a.jsxs("header",{className:"relative text-center pb-4",children:[a.jsx(Ns,{to:"/",className:"absolute left-0 top-0",children:a.jsxs(V,{variant:"outline",size:"icon",children:[a.jsx(Vl,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Back to Home"})]})}),a.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight",children:"AI Content Creation Studio"}),a.jsx("p",{className:"text-muted-foreground mt-2 text-lg",children:"Generate images, edit them, create videos, and build your content sequence."})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 xl:gap-8",children:[a.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[a.jsxs(Ei,{value:h,onValueChange:f,className:"w-full",children:[a.jsxs(Qs,{className:"grid w-full grid-cols-3",children:[a.jsxs(Bt,{value:"text-to-image",children:[a.jsx(Cl,{className:"mr-1 h-4 w-4 inline-block"}),"Gen Image"]}),a.jsxs(Bt,{value:"image-edit",children:[a.jsx(Rj,{className:"mr-1 h-4 w-4 inline-block"}),"Edit Image"]}),a.jsxs(Bt,{value:"upload",children:[a.jsx(fie,{className:"mr-1 h-4 w-4 inline-block"}),"Upload"]})]}),a.jsxs(zt,{value:"text-to-image",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(Re,{htmlFor:"text-prompt-model1",className:"text-lg font-semibold",children:"Text-to-Image (Quick)"}),a.jsx(Ln,{id:"text-prompt-model1",placeholder:"e.g., 'A futuristic cityscape at sunset'",value:m,onChange:re=>g(re.target.value),rows:3,className:"mt-2",disabled:v||S}),P&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Loading prompt suggestions..."}),C.length>0&&!P&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx(Re,{className:"text-xs text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:C.map((re,Ve)=>a.jsx(V,{variant:"outline",size:"xs",onClick:()=>g(re),className:"text-xs",children:re.length>40?re.substring(0,37)+"...":re},Ve))})]}),a.jsxs(V,{onClick:kt,disabled:v||S||!m.trim(),className:"w-full mt-3",children:[v?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Cl,{className:"mr-2 h-4 w-4"}),"Generate with Quick"]}),a.jsx(Sa,{className:"my-4"}),a.jsx(Re,{htmlFor:"text-prompt-model2",className:"text-lg font-semibold",children:"Text-to-Image (Quality)"}),a.jsx(Ln,{id:"text-prompt-model2",placeholder:"e.g., 'A photorealistic cat astronaut'",value:x,onChange:re=>E(re.target.value),rows:3,className:"mt-2",disabled:v||S}),a.jsxs(V,{onClick:Gt,disabled:v||S||!x.trim(),className:"w-full mt-3",children:[S?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Gse,{className:"mr-2 h-4 w-4"}),"Generate with Quality"]}),M&&M.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:M.url,alt:`Generated by ${M.sourceApi==="gemini"?"Quick":M.sourceApi==="openai"?"Quality":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",M.sourceApi==="gemini"?"Quick":M.sourceApi==="openai"?"Quality":"AI"]}),a.jsx(Re,{className:"text-sm font-medium",children:"Choose a caption:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(M.captions||[]).map((re,Ve)=>a.jsx(V,{variant:z===re?"default":"outline",size:"sm",onClick:()=>Y(re),className:"text-xs",children:re},Ve))}),a.jsxs(V,{onClick:()=>ae(M.url,z),size:"sm",className:"w-full mt-2",disabled:!z,children:[a.jsx(uy,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]}),a.jsxs(zt,{value:"image-edit",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(Re,{className:"text-lg font-semibold",children:"Image Editing"}),!k&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select an image from the timeline to enable editing."}),k&&a.jsxs("div",{className:"mt-2 space-y-3",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Editing: ",a.jsx("span",{className:"text-primary truncate",children:k.caption})]}),a.jsx("img",{src:k.url,alt:"Selected for editing",className:"w-full rounded-md object-contain max-h-48 border"}),a.jsx(Re,{htmlFor:"edit-prompt-model1",children:"Edit with Quick"}),a.jsx(Ln,{id:"edit-prompt-model1",placeholder:"Describe edits (e.g., 'change background to a beach')",value:D,onChange:re=>R(re.target.value),rows:2,disabled:B}),a.jsxs(V,{onClick:()=>fn(k,D),disabled:B||!D.trim(),className:"w-full",children:[B?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Cl,{className:"mr-2 h-4 w-4"}),"Edit with Quick"]})]}),ee&&ee.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:ee.url,alt:`Edited by ${ee.sourceApi==="gemini"?"Quick":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",ee.sourceApi==="gemini"?"Quick":"AI"]}),a.jsx(Re,{className:"text-sm font-medium",children:"Choose a caption for the edited image:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(ee.captions||[]).map((re,Ve)=>a.jsx(V,{variant:z===re?"default":"outline",size:"sm",onClick:()=>Y(re),className:"text-xs",children:re},Ve))}),a.jsxs(V,{onClick:()=>ae(ee.url,z),size:"sm",className:"w-full mt-2",disabled:!z,children:[a.jsx(uy,{className:"mr-2 h-4 w-4"})," Add Edited to Timeline"]})]})]}),a.jsxs(zt,{value:"upload",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(Re,{htmlFor:"file-upload",className:"text-lg font-semibold",children:"Upload Image or Video"}),a.jsx(nt,{id:"file-upload",type:"file",accept:"image/*,video/*",onChange:sn,className:"mt-2",disabled:xe}),xe&&a.jsxs("div",{className:"mt-2 flex items-center text-sm text-muted-foreground",children:[a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"})," Processing..."]}),Se&&Se.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[Se.type==="image"?a.jsx("img",{src:Se.url,alt:"Uploaded content",className:"w-full rounded-md object-contain max-h-96"}):a.jsx("video",{src:Se.url,controls:!0,className:"w-full rounded-md max-h-96",children:"Your browser does not support the video tag."}),a.jsx(Re,{className:"text-sm font-medium",children:"Choose a caption for the uploaded content:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(Se.captions||[]).map((re,Ve)=>a.jsx(V,{variant:z===re?"default":"outline",size:"sm",onClick:()=>Y(re),className:"text-xs",children:re},Ve))}),a.jsxs(V,{onClick:()=>ae(Se.url,z,Se.type),size:"sm",className:"w-full mt-2",disabled:!z,children:[a.jsx(uy,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Product Catalog"}),a.jsxs(V,{variant:"outline",size:"sm",onClick:()=>Le(!mt),children:[mt?"Hide":"Show"," Products ",a.jsx(Ose,{className:"ml-2 h-4 w-4"})]})]}),mt&&a.jsx(Gi,{className:"mt-2 h-48 border rounded-md p-2",children:a.jsx("div",{className:"space-y-2",children:Ye.map(re=>{var Ve,Te;return a.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md hover:bg-muted cursor-pointer",onClick:()=>de(re),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:(Te=(Ve=re.image)==null?void 0:Ve.src)==null?void 0:Te.medium,alt:re.name,className:"w-10 h-10 object-cover rounded"}),a.jsx("span",{className:"text-sm",children:re.name})]}),a.jsx(V,{size:"xs",variant:"ghost",children:a.jsx(uy,{className:"h-4 w-4"})})]},re.id)})})})]})]}),a.jsx("div",{className:"lg:col-span-2 space-y-6",children:a.jsxs("div",{className:"p-4 md:p-6 border rounded-lg bg-card shadow min-h-[400px]",children:[a.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Content Timeline"}),a.jsx(Gi,{className:"h-[calc(100vh-350px)] min-h-[300px] pr-3",children:X.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[a.jsx(Bse,{className:"h-12 w-12 mb-3"}),a.jsx("p",{children:"Your timeline is empty."}),a.jsx("p",{className:"text-sm",children:"Generate or upload content to get started."})]}):a.jsx(_h,{children:X.map((re,Ve)=>a.jsxs(Ct.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-50},transition:{type:"spring",stiffness:300,damping:30},className:"mb-3 p-3 border rounded-md flex items-start gap-3 hover:shadow-md transition-shadow bg-background cursor-pointer",onClick:()=>Je(re),children:[a.jsxs("div",{className:"w-24 h-24 flex-shrink-0 relative rounded overflow-hidden group bg-muted",children:[re.isVideo?a.jsx("video",{src:re.url,className:"w-full h-full object-cover",controls:!1,muted:!0,loop:!0,onMouseOver:Te=>Te.target.play(),onMouseOut:Te=>Te.target.pause()}):a.jsx("img",{src:re.url,alt:re.caption,className:"w-full h-full object-cover"}),!re.isVideo&&a.jsx(V,{size:"icon",variant:"secondary",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Te=>{Te.stopPropagation(),Ne(re,Ve)},disabled:F,title:"Convert to Veo Video",children:F?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(j$,{className:"h-4 w-4"})}),a.jsx(V,{size:"icon",variant:"outline",className:"absolute bottom-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Te=>{Te.stopPropagation(),U(re),f("image-edit")},disabled:re.isVideo,title:"Edit this image",children:a.jsx(Rj,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:`text-xs font-semibold px-1.5 py-0.5 rounded-sm ${re.isVideo?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:[re.isVideo?"Video":"Image"," ",Ve+1]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(V,{size:"icon",variant:"ghost",onClick:Te=>{Te.stopPropagation(),me(Ve,-1)},disabled:Ve===0,className:"h-7 w-7",children:a.jsx(eie,{className:"h-4 w-4"})}),a.jsx(V,{size:"icon",variant:"ghost",onClick:Te=>{Te.stopPropagation(),me(Ve,1)},disabled:Ve===X.length-1,className:"h-7 w-7",children:a.jsx(Zse,{className:"h-4 w-4"})}),a.jsx(V,{size:"icon",variant:"ghost",onClick:Te=>{Te.stopPropagation(),ne(re.id)},className:"h-7 w-7",children:a.jsx(nie,{className:"h-4 w-4"})}),a.jsx(V,{size:"icon",variant:"ghost",onClick:Te=>{Te.stopPropagation(),fe(re.id)},className:"h-7 w-7 text-destructive",children:a.jsx(er,{className:"h-4 w-4"})})]})]}),a.jsx("p",{className:"text-sm mt-1 text-muted-foreground line-clamp-3",title:re.caption,children:re.caption})]})]},re.id))})}),X.length>0&&a.jsx(Sa,{className:"my-4"}),ve&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Media Viewer"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(V,{variant:"outline",size:"sm",onClick:Xe,children:[a.jsx(P$,{className:"mr-2 h-4 w-4"}),"Download"]}),a.jsx(V,{variant:"ghost",size:"icon",onClick:()=>Je(null),children:a.jsx(zo,{className:"h-5 w-5"})})]})]}),ve.type==="image"||!ve.isVideo?a.jsx("img",{src:ve.url,alt:ve.caption||"Viewing media",className:"w-full max-h-[60vh] rounded-md object-contain border"}):a.jsx("video",{src:ve.url,controls:!0,className:"w-full max-h-[60vh] rounded-md border bg-black",children:"Your browser does not support the video tag."}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:ve.caption})]})]})})]})]})};function WG(t){const e=p.useRef({value:t,previous:t});return p.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}function EP(t){const[e,n]=p.useState(void 0);return Bo(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var g_="Switch",[G_e,Vke]=Si(g_),[H_e,W_e]=G_e(g_),qG=p.forwardRef((t,e)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:u,form:d,...h}=t,[f,m]=p.useState(null),g=bn(e,S=>m(S)),x=p.useRef(!1),E=f?d||!!f.closest("form"):!0,[v,_]=Pu({prop:s,defaultProp:i??!1,onChange:u,caller:g_});return a.jsxs(H_e,{scope:n,checked:v,disabled:l,children:[a.jsx(Kt.button,{type:"button",role:"switch","aria-checked":v,"aria-required":o,"data-state":XG(v),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:g,onClick:wt(t.onClick,S=>{_(I=>!I),E&&(x.current=S.isPropagationStopped(),x.current||S.stopPropagation())})}),E&&a.jsx(JG,{control:f,bubbles:!x.current,name:r,value:c,checked:v,required:o,disabled:l,form:d,style:{transform:"translateX(-100%)"}})]})});qG.displayName=g_;var KG="SwitchThumb",YG=p.forwardRef((t,e)=>{const{__scopeSwitch:n,...r}=t,s=W_e(KG,n);return a.jsx(Kt.span,{"data-state":XG(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:e})});YG.displayName=KG;var q_e="SwitchBubbleInput",JG=p.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:r=!0,...s},i)=>{const o=p.useRef(null),l=bn(o,i),c=WG(n),u=EP(e);return p.useEffect(()=>{const d=o.current;if(!d)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(c!==n&&m){const g=new Event("click",{bubbles:r});m.call(d,n),d.dispatchEvent(g)}},[c,n,r]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:l,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});JG.displayName=q_e;function XG(t){return t?"checked":"unchecked"}var QG=qG,K_e=YG;const Do=ct.forwardRef(({className:t,...e},n)=>a.jsx(QG,{className:bt("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...e,ref:n,children:a.jsx(K_e,{className:bt("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Do.displayName=QG.displayName;const Y_e=["top","right","bottom","left"],Jl=Math.min,ci=Math.max,pw=Math.round,$y=Math.floor,Uo=t=>({x:t,y:t}),J_e={left:"right",right:"left",bottom:"top",top:"bottom"},X_e={start:"end",end:"start"};function cT(t,e,n){return ci(t,Jl(e,n))}function Pa(t,e){return typeof t=="function"?t(e):t}function Aa(t){return t.split("-")[0]}function ef(t){return t.split("-")[1]}function CP(t){return t==="x"?"y":"x"}function TP(t){return t==="y"?"height":"width"}function pa(t){return["top","bottom"].includes(Aa(t))?"y":"x"}function IP(t){return CP(pa(t))}function Q_e(t,e,n){n===void 0&&(n=!1);const r=ef(t),s=IP(t),i=TP(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=gw(o)),[o,gw(o)]}function Z_e(t){const e=gw(t);return[uT(t),e,uT(e)]}function uT(t){return t.replace(/start|end/g,e=>X_e[e])}function ebe(t,e,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?s:r:e?r:s;case"left":case"right":return e?i:o;default:return[]}}function tbe(t,e,n,r){const s=ef(t);let i=ebe(Aa(t),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(uT)))),i}function gw(t){return t.replace(/left|right|bottom|top/g,e=>J_e[e])}function nbe(t){return{top:0,right:0,bottom:0,left:0,...t}}function ZG(t){return typeof t!="number"?nbe(t):{top:t,right:t,bottom:t,left:t}}function yw(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function j4(t,e,n){let{reference:r,floating:s}=t;const i=pa(e),o=IP(e),l=TP(o),c=Aa(e),u=i==="y",d=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,f=r[l]/2-s[l]/2;let m;switch(c){case"top":m={x:d,y:r.y-s.height};break;case"bottom":m={x:d,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:h};break;case"left":m={x:r.x-s.width,y:h};break;default:m={x:r.x,y:r.y}}switch(ef(e)){case"start":m[o]-=f*(n&&u?-1:1);break;case"end":m[o]+=f*(n&&u?-1:1);break}return m}const rbe=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:d,y:h}=j4(u,r,c),f=r,m={},g=0;for(let x=0;x<l.length;x++){const{name:E,fn:v}=l[x],{x:_,y:S,data:I,reset:M}=await v({x:d,y:h,initialPlacement:r,placement:f,strategy:s,middlewareData:m,rects:u,platform:o,elements:{reference:t,floating:e}});d=_??d,h=S??h,m={...m,[E]:{...m[E],...I}},M&&g<=50&&(g++,typeof M=="object"&&(M.placement&&(f=M.placement),M.rects&&(u=M.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):M.rects),{x:d,y:h}=j4(u,f,c)),x=-1)}return{x:d,y:h,placement:f,strategy:s,middlewareData:m}};async function kp(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:l,strategy:c}=t,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:m=0}=Pa(e,t),g=ZG(m),E=l[f?h==="floating"?"reference":"floating":h],v=yw(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(E)))==null||n?E:E.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),_=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),I=await(i.isElement==null?void 0:i.isElement(S))?await(i.getScale==null?void 0:i.getScale(S))||{x:1,y:1}:{x:1,y:1},M=yw(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:_,offsetParent:S,strategy:c}):_);return{top:(v.top-M.top+g.top)/I.y,bottom:(M.bottom-v.bottom+g.bottom)/I.y,left:(v.left-M.left+g.left)/I.x,right:(M.right-v.right+g.right)/I.x}}const sbe=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:o,elements:l,middlewareData:c}=e,{element:u,padding:d=0}=Pa(t,e)||{};if(u==null)return{};const h=ZG(d),f={x:n,y:r},m=IP(s),g=TP(m),x=await o.getDimensions(u),E=m==="y",v=E?"top":"left",_=E?"bottom":"right",S=E?"clientHeight":"clientWidth",I=i.reference[g]+i.reference[m]-f[m]-i.floating[g],M=f[m]-i.reference[m],j=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let C=j?j[S]:0;(!C||!await(o.isElement==null?void 0:o.isElement(j)))&&(C=l.floating[S]||i.floating[g]);const T=I/2-M/2,P=C/2-x[g]/2-1,A=Jl(h[v],P),D=Jl(h[_],P),R=A,k=C-x[g]-D,U=C/2-x[g]/2+T,B=cT(R,U,k),K=!c.arrow&&ef(s)!=null&&U!==B&&i.reference[g]/2-(U<R?A:D)-x[g]/2<0,ee=K?U<R?U-R:U-k:0;return{[m]:f[m]+ee,data:{[m]:B,centerOffset:U-B-ee,...K&&{alignmentOffset:ee}},reset:K}}}),ibe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:x=!0,...E}=Pa(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const v=Aa(s),_=pa(l),S=Aa(l)===l,I=await(c.isRTL==null?void 0:c.isRTL(u.floating)),M=f||(S||!x?[gw(l)]:Z_e(l)),j=g!=="none";!f&&j&&M.push(...tbe(l,x,g,I));const C=[l,...M],T=await kp(e,E),P=[];let A=((r=i.flip)==null?void 0:r.overflows)||[];if(d&&P.push(T[v]),h){const B=Q_e(s,o,I);P.push(T[B[0]],T[B[1]])}if(A=[...A,{placement:s,overflows:P}],!P.every(B=>B<=0)){var D,R;const B=(((D=i.flip)==null?void 0:D.index)||0)+1,K=C[B];if(K){var k;const H=h==="alignment"?_!==pa(K):!1,X=((k=A[0])==null?void 0:k.overflows[0])>0;if(!H||X)return{data:{index:B,overflows:A},reset:{placement:K}}}let ee=(R=A.filter(H=>H.overflows[0]<=0).sort((H,X)=>H.overflows[1]-X.overflows[1])[0])==null?void 0:R.placement;if(!ee)switch(m){case"bestFit":{var U;const H=(U=A.filter(X=>{if(j){const O=pa(X.placement);return O===_||O==="y"}return!0}).map(X=>[X.placement,X.overflows.filter(O=>O>0).reduce((O,z)=>O+z,0)]).sort((X,O)=>X[1]-O[1])[0])==null?void 0:U[0];H&&(ee=H);break}case"initialPlacement":ee=l;break}if(s!==ee)return{reset:{placement:ee}}}return{}}}};function D4(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function M4(t){return Y_e.some(e=>t[e]>=0)}const obe=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=Pa(t,e);switch(r){case"referenceHidden":{const i=await kp(e,{...s,elementContext:"reference"}),o=D4(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:M4(o)}}}case"escaped":{const i=await kp(e,{...s,altBoundary:!0}),o=D4(i,n.floating);return{data:{escapedOffsets:o,escaped:M4(o)}}}default:return{}}}}};async function abe(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=Aa(n),l=ef(n),c=pa(n)==="y",u=["left","top"].includes(o)?-1:1,d=i&&c?-1:1,h=Pa(e,t);let{mainAxis:f,crossAxis:m,alignmentAxis:g}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof g=="number"&&(m=l==="end"?g*-1:g),c?{x:m*d,y:f*u}:{x:f*u,y:m*d}}const lbe=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:o,middlewareData:l}=e,c=await abe(e,t);return o===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:o}}}}},cbe=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:E=>{let{x:v,y:_}=E;return{x:v,y:_}}},...c}=Pa(t,e),u={x:n,y:r},d=await kp(e,c),h=pa(Aa(s)),f=CP(h);let m=u[f],g=u[h];if(i){const E=f==="y"?"top":"left",v=f==="y"?"bottom":"right",_=m+d[E],S=m-d[v];m=cT(_,m,S)}if(o){const E=h==="y"?"top":"left",v=h==="y"?"bottom":"right",_=g+d[E],S=g-d[v];g=cT(_,g,S)}const x=l.fn({...e,[f]:m,[h]:g});return{...x,data:{x:x.x-n,y:x.y-r,enabled:{[f]:i,[h]:o}}}}}},ube=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=Pa(t,e),d={x:n,y:r},h=pa(s),f=CP(h);let m=d[f],g=d[h];const x=Pa(l,e),E=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(c){const S=f==="y"?"height":"width",I=i.reference[f]-i.floating[S]+E.mainAxis,M=i.reference[f]+i.reference[S]-E.mainAxis;m<I?m=I:m>M&&(m=M)}if(u){var v,_;const S=f==="y"?"width":"height",I=["top","left"].includes(Aa(s)),M=i.reference[h]-i.floating[S]+(I&&((v=o.offset)==null?void 0:v[h])||0)+(I?0:E.crossAxis),j=i.reference[h]+i.reference[S]+(I?0:((_=o.offset)==null?void 0:_[h])||0)-(I?E.crossAxis:0);g<M?g=M:g>j&&(g=j)}return{[f]:m,[h]:g}}}},dbe=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:s,rects:i,platform:o,elements:l}=e,{apply:c=()=>{},...u}=Pa(t,e),d=await kp(e,u),h=Aa(s),f=ef(s),m=pa(s)==="y",{width:g,height:x}=i.floating;let E,v;h==="top"||h==="bottom"?(E=h,v=f===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(v=h,E=f==="end"?"top":"bottom");const _=x-d.top-d.bottom,S=g-d.left-d.right,I=Jl(x-d[E],_),M=Jl(g-d[v],S),j=!e.middlewareData.shift;let C=I,T=M;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(T=S),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(C=_),j&&!f){const A=ci(d.left,0),D=ci(d.right,0),R=ci(d.top,0),k=ci(d.bottom,0);m?T=g-2*(A!==0||D!==0?A+D:ci(d.left,d.right)):C=x-2*(R!==0||k!==0?R+k:ci(d.top,d.bottom))}await c({...e,availableWidth:T,availableHeight:C});const P=await o.getDimensions(l.floating);return g!==P.width||x!==P.height?{reset:{rects:!0}}:{}}}};function y_(){return typeof window<"u"}function tf(t){return e8(t)?(t.nodeName||"").toLowerCase():"#document"}function gi(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Jo(t){var e;return(e=(e8(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function e8(t){return y_()?t instanceof Node||t instanceof gi(t).Node:!1}function po(t){return y_()?t instanceof Element||t instanceof gi(t).Element:!1}function Wo(t){return y_()?t instanceof HTMLElement||t instanceof gi(t).HTMLElement:!1}function L4(t){return!y_()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof gi(t).ShadowRoot}function Cg(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=go(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(s)}function hbe(t){return["table","td","th"].includes(tf(t))}function x_(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function NP(t){const e=PP(),n=po(t)?go(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function fbe(t){let e=Xl(t);for(;Wo(e)&&!Oh(e);){if(NP(e))return e;if(x_(e))return null;e=Xl(e)}return null}function PP(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Oh(t){return["html","body","#document"].includes(tf(t))}function go(t){return gi(t).getComputedStyle(t)}function v_(t){return po(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Xl(t){if(tf(t)==="html")return t;const e=t.assignedSlot||t.parentNode||L4(t)&&t.host||Jo(t);return L4(e)?e.host:e}function t8(t){const e=Xl(t);return Oh(e)?t.ownerDocument?t.ownerDocument.body:t.body:Wo(e)&&Cg(e)?e:t8(e)}function jp(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=t8(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),o=gi(s);if(i){const l=dT(o);return e.concat(o,o.visualViewport||[],Cg(s)?s:[],l&&n?jp(l):[])}return e.concat(s,jp(s,[],n))}function dT(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function n8(t){const e=go(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=Wo(t),i=s?t.offsetWidth:n,o=s?t.offsetHeight:r,l=pw(n)!==i||pw(r)!==o;return l&&(n=i,r=o),{width:n,height:r,$:l}}function AP(t){return po(t)?t:t.contextElement}function ih(t){const e=AP(t);if(!Wo(e))return Uo(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=n8(e);let o=(i?pw(n.width):n.width)/r,l=(i?pw(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const mbe=Uo(0);function r8(t){const e=gi(t);return!PP()||!e.visualViewport?mbe:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function pbe(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==gi(t)?!1:e}function Cu(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=AP(t);let o=Uo(1);e&&(r?po(r)&&(o=ih(r)):o=ih(t));const l=pbe(i,n,r)?r8(i):Uo(0);let c=(s.left+l.x)/o.x,u=(s.top+l.y)/o.y,d=s.width/o.x,h=s.height/o.y;if(i){const f=gi(i),m=r&&po(r)?gi(r):r;let g=f,x=dT(g);for(;x&&r&&m!==g;){const E=ih(x),v=x.getBoundingClientRect(),_=go(x),S=v.left+(x.clientLeft+parseFloat(_.paddingLeft))*E.x,I=v.top+(x.clientTop+parseFloat(_.paddingTop))*E.y;c*=E.x,u*=E.y,d*=E.x,h*=E.y,c+=S,u+=I,g=gi(x),x=dT(g)}}return yw({width:d,height:h,x:c,y:u})}function RP(t,e){const n=v_(t).scrollLeft;return e?e.left+n:Cu(Jo(t)).left+n}function s8(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=r.left+e.scrollLeft-(n?0:RP(t,r)),i=r.top+e.scrollTop;return{x:s,y:i}}function gbe(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",o=Jo(r),l=e?x_(e.floating):!1;if(r===o||l&&i)return n;let c={scrollLeft:0,scrollTop:0},u=Uo(1);const d=Uo(0),h=Wo(r);if((h||!h&&!i)&&((tf(r)!=="body"||Cg(o))&&(c=v_(r)),Wo(r))){const m=Cu(r);u=ih(r),d.x=m.x+r.clientLeft,d.y=m.y+r.clientTop}const f=o&&!h&&!i?s8(o,c,!0):Uo(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-c.scrollLeft*u.x+d.x+f.x,y:n.y*u.y-c.scrollTop*u.y+d.y+f.y}}function ybe(t){return Array.from(t.getClientRects())}function xbe(t){const e=Jo(t),n=v_(t),r=t.ownerDocument.body,s=ci(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=ci(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+RP(t);const l=-n.scrollTop;return go(r).direction==="rtl"&&(o+=ci(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:l}}function vbe(t,e){const n=gi(t),r=Jo(t),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,l=0,c=0;if(s){i=s.width,o=s.height;const u=PP();(!u||u&&e==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:i,height:o,x:l,y:c}}function wbe(t,e){const n=Cu(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=Wo(t)?ih(t):Uo(1),o=t.clientWidth*i.x,l=t.clientHeight*i.y,c=s*i.x,u=r*i.y;return{width:o,height:l,x:c,y:u}}function F4(t,e,n){let r;if(e==="viewport")r=vbe(t,n);else if(e==="document")r=xbe(Jo(t));else if(po(e))r=wbe(e,n);else{const s=r8(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return yw(r)}function i8(t,e){const n=Xl(t);return n===e||!po(n)||Oh(n)?!1:go(n).position==="fixed"||i8(n,e)}function _be(t,e){const n=e.get(t);if(n)return n;let r=jp(t,[],!1).filter(l=>po(l)&&tf(l)!=="body"),s=null;const i=go(t).position==="fixed";let o=i?Xl(t):t;for(;po(o)&&!Oh(o);){const l=go(o),c=NP(o);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||Cg(o)&&!c&&i8(t,o))?r=r.filter(d=>d!==o):s=l,o=Xl(o)}return e.set(t,r),r}function bbe(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?x_(e)?[]:_be(e,this._c):[].concat(n),r],l=o[0],c=o.reduce((u,d)=>{const h=F4(e,d,s);return u.top=ci(h.top,u.top),u.right=Jl(h.right,u.right),u.bottom=Jl(h.bottom,u.bottom),u.left=ci(h.left,u.left),u},F4(e,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function Sbe(t){const{width:e,height:n}=n8(t);return{width:e,height:n}}function Ebe(t,e,n){const r=Wo(e),s=Jo(e),i=n==="fixed",o=Cu(t,!0,i,e);let l={scrollLeft:0,scrollTop:0};const c=Uo(0);function u(){c.x=RP(s)}if(r||!r&&!i)if((tf(e)!=="body"||Cg(s))&&(l=v_(e)),r){const m=Cu(e,!0,i,e);c.x=m.x+e.clientLeft,c.y=m.y+e.clientTop}else s&&u();i&&!r&&s&&u();const d=s&&!r&&!i?s8(s,l):Uo(0),h=o.left+l.scrollLeft-c.x-d.x,f=o.top+l.scrollTop-c.y-d.y;return{x:h,y:f,width:o.width,height:o.height}}function fS(t){return go(t).position==="static"}function O4(t,e){if(!Wo(t)||go(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Jo(t)===n&&(n=n.ownerDocument.body),n}function o8(t,e){const n=gi(t);if(x_(t))return n;if(!Wo(t)){let s=Xl(t);for(;s&&!Oh(s);){if(po(s)&&!fS(s))return s;s=Xl(s)}return n}let r=O4(t,e);for(;r&&hbe(r)&&fS(r);)r=O4(r,e);return r&&Oh(r)&&fS(r)&&!NP(r)?n:r||fbe(t)||n}const Cbe=async function(t){const e=this.getOffsetParent||o8,n=this.getDimensions,r=await n(t.floating);return{reference:Ebe(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Tbe(t){return go(t).direction==="rtl"}const Ibe={convertOffsetParentRelativeRectToViewportRelativeRect:gbe,getDocumentElement:Jo,getClippingRect:bbe,getOffsetParent:o8,getElementRects:Cbe,getClientRects:ybe,getDimensions:Sbe,getScale:ih,isElement:po,isRTL:Tbe};function a8(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Nbe(t,e){let n=null,r;const s=Jo(t);function i(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const u=t.getBoundingClientRect(),{left:d,top:h,width:f,height:m}=u;if(l||e(),!f||!m)return;const g=$y(h),x=$y(s.clientWidth-(d+f)),E=$y(s.clientHeight-(h+m)),v=$y(d),S={rootMargin:-g+"px "+-x+"px "+-E+"px "+-v+"px",threshold:ci(0,Jl(1,c))||1};let I=!0;function M(j){const C=j[0].intersectionRatio;if(C!==c){if(!I)return o();C?o(!1,C):r=setTimeout(()=>{o(!1,1e-7)},1e3)}C===1&&!a8(u,t.getBoundingClientRect())&&o(),I=!1}try{n=new IntersectionObserver(M,{...S,root:s.ownerDocument})}catch{n=new IntersectionObserver(M,S)}n.observe(t)}return o(!0),i}function l8(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,u=AP(t),d=s||i?[...u?jp(u):[],...jp(e)]:[];d.forEach(v=>{s&&v.addEventListener("scroll",n,{passive:!0}),i&&v.addEventListener("resize",n)});const h=u&&l?Nbe(u,n):null;let f=-1,m=null;o&&(m=new ResizeObserver(v=>{let[_]=v;_&&_.target===u&&m&&(m.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var S;(S=m)==null||S.observe(e)})),n()}),u&&!c&&m.observe(u),m.observe(e));let g,x=c?Cu(t):null;c&&E();function E(){const v=Cu(t);x&&!a8(x,v)&&n(),x=v,g=requestAnimationFrame(E)}return n(),()=>{var v;d.forEach(_=>{s&&_.removeEventListener("scroll",n),i&&_.removeEventListener("resize",n)}),h==null||h(),(v=m)==null||v.disconnect(),m=null,c&&cancelAnimationFrame(g)}}const Pbe=lbe,Abe=cbe,Rbe=ibe,kbe=dbe,jbe=obe,V4=sbe,Dbe=ube,Mbe=(t,e,n)=>{const r=new Map,s={platform:Ibe,...n},i={...s.platform,_c:r};return rbe(t,e,{...s,platform:i})};var Vx=typeof document<"u"?p.useLayoutEffect:p.useEffect;function xw(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!xw(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!xw(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function c8(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function $4(t,e){const n=c8(t);return Math.round(e*n)/n}function mS(t){const e=p.useRef(t);return Vx(()=>{e.current=t}),e}function u8(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=t,[d,h]=p.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,m]=p.useState(r);xw(f,r)||m(r);const[g,x]=p.useState(null),[E,v]=p.useState(null),_=p.useCallback(H=>{H!==j.current&&(j.current=H,x(H))},[]),S=p.useCallback(H=>{H!==C.current&&(C.current=H,v(H))},[]),I=i||g,M=o||E,j=p.useRef(null),C=p.useRef(null),T=p.useRef(d),P=c!=null,A=mS(c),D=mS(s),R=mS(u),k=p.useCallback(()=>{if(!j.current||!C.current)return;const H={placement:e,strategy:n,middleware:f};D.current&&(H.platform=D.current),Mbe(j.current,C.current,H).then(X=>{const O={...X,isPositioned:R.current!==!1};U.current&&!xw(T.current,O)&&(T.current=O,ja.flushSync(()=>{h(O)}))})},[f,e,n,D,R]);Vx(()=>{u===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,h(H=>({...H,isPositioned:!1})))},[u]);const U=p.useRef(!1);Vx(()=>(U.current=!0,()=>{U.current=!1}),[]),Vx(()=>{if(I&&(j.current=I),M&&(C.current=M),I&&M){if(A.current)return A.current(I,M,k);k()}},[I,M,k,A,P]);const B=p.useMemo(()=>({reference:j,floating:C,setReference:_,setFloating:S}),[_,S]),K=p.useMemo(()=>({reference:I,floating:M}),[I,M]),ee=p.useMemo(()=>{const H={position:n,left:0,top:0};if(!K.floating)return H;const X=$4(K.floating,d.x),O=$4(K.floating,d.y);return l?{...H,transform:"translate("+X+"px, "+O+"px)",...c8(K.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:X,top:O}},[n,l,K.floating,d.x,d.y]);return p.useMemo(()=>({...d,update:k,refs:B,elements:K,floatingStyles:ee}),[d,k,B,K,ee])}const Lbe=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?V4({element:r.current,padding:s}).fn(n):{}:r?V4({element:r,padding:s}).fn(n):{}}}},d8=(t,e)=>({...Pbe(t),options:[t,e]}),h8=(t,e)=>({...Abe(t),options:[t,e]}),f8=(t,e)=>({...Dbe(t),options:[t,e]}),m8=(t,e)=>({...Rbe(t),options:[t,e]}),p8=(t,e)=>({...kbe(t),options:[t,e]}),g8=(t,e)=>({...jbe(t),options:[t,e]}),y8=(t,e)=>({...Lbe(t),options:[t,e]});var Fbe="Arrow",x8=p.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return a.jsx(Kt.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});x8.displayName=Fbe;var Obe=x8,kP="Popper",[v8,w8]=Si(kP),[Vbe,_8]=v8(kP),b8=t=>{const{__scopePopper:e,children:n}=t,[r,s]=p.useState(null);return a.jsx(Vbe,{scope:e,anchor:r,onAnchorChange:s,children:n})};b8.displayName=kP;var S8="PopperAnchor",E8=p.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=_8(S8,n),o=p.useRef(null),l=bn(e,o);return p.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:a.jsx(Kt.div,{...s,ref:l})});E8.displayName=S8;var jP="PopperContent",[$be,Ube]=v8(jP),C8=p.forwardRef((t,e)=>{var xe,Me,Ye,qe,et,We;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:m="optimized",onPlaced:g,...x}=t,E=_8(jP,n),[v,_]=p.useState(null),S=bn(e,mt=>_(mt)),[I,M]=p.useState(null),j=EP(I),C=(j==null?void 0:j.width)??0,T=(j==null?void 0:j.height)??0,P=r+(i!=="center"?"-"+i:""),A=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},D=Array.isArray(u)?u:[u],R=D.length>0,k={padding:A,boundary:D.filter(zbe),altBoundary:R},{refs:U,floatingStyles:B,placement:K,isPositioned:ee,middlewareData:H}=u8({strategy:"fixed",placement:P,whileElementsMounted:(...mt)=>l8(...mt,{animationFrame:m==="always"}),elements:{reference:E.anchor},middleware:[d8({mainAxis:s+T,alignmentAxis:o}),c&&h8({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?f8():void 0,...k}),c&&m8({...k}),p8({...k,apply:({elements:mt,rects:Le,availableWidth:ve,availableHeight:Je})=>{const{width:Xe,height:kt}=Le.reference,Gt=mt.floating.style;Gt.setProperty("--radix-popper-available-width",`${ve}px`),Gt.setProperty("--radix-popper-available-height",`${Je}px`),Gt.setProperty("--radix-popper-anchor-width",`${Xe}px`),Gt.setProperty("--radix-popper-anchor-height",`${kt}px`)}}),I&&y8({element:I,padding:l}),Gbe({arrowWidth:C,arrowHeight:T}),f&&g8({strategy:"referenceHidden",...k})]}),[X,O]=N8(K),z=Cr(g);Bo(()=>{ee&&(z==null||z())},[ee,z]);const Y=(xe=H.arrow)==null?void 0:xe.x,F=(Me=H.arrow)==null?void 0:Me.y,ye=((Ye=H.arrow)==null?void 0:Ye.centerOffset)!==0,[Se,De]=p.useState();return Bo(()=>{v&&De(window.getComputedStyle(v).zIndex)},[v]),a.jsx("div",{ref:U.setFloating,"data-radix-popper-content-wrapper":"",style:{...B,transform:ee?B.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Se,"--radix-popper-transform-origin":[(qe=H.transformOrigin)==null?void 0:qe.x,(et=H.transformOrigin)==null?void 0:et.y].join(" "),...((We=H.hide)==null?void 0:We.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:a.jsx($be,{scope:n,placedSide:X,onArrowChange:M,arrowX:Y,arrowY:F,shouldHideArrow:ye,children:a.jsx(Kt.div,{"data-side":X,"data-align":O,...x,ref:S,style:{...x.style,animation:ee?void 0:"none"}})})})});C8.displayName=jP;var T8="PopperArrow",Bbe={top:"bottom",right:"left",bottom:"top",left:"right"},I8=p.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=Ube(T8,r),o=Bbe[i.placedSide];return a.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:a.jsx(Obe,{...s,ref:n,style:{...s.style,display:"block"}})})});I8.displayName=T8;function zbe(t){return t!==null}var Gbe=t=>({name:"transformOrigin",options:t,fn(e){var E,v,_;const{placement:n,rects:r,middlewareData:s}=e,o=((E=s.arrow)==null?void 0:E.centerOffset)!==0,l=o?0:t.arrowWidth,c=o?0:t.arrowHeight,[u,d]=N8(n),h={start:"0%",center:"50%",end:"100%"}[d],f=(((v=s.arrow)==null?void 0:v.x)??0)+l/2,m=(((_=s.arrow)==null?void 0:_.y)??0)+c/2;let g="",x="";return u==="bottom"?(g=o?h:`${f}px`,x=`${-c}px`):u==="top"?(g=o?h:`${f}px`,x=`${r.floating.height+c}px`):u==="right"?(g=`${-c}px`,x=o?h:`${m}px`):u==="left"&&(g=`${r.floating.width+c}px`,x=o?h:`${m}px`),{data:{x:g,y:x}}}});function N8(t){const[e,n="center"]=t.split("-");return[e,n]}var Hbe=b8,Wbe=E8,qbe=C8,Kbe=I8,hT=["Enter"," "],Ybe=["ArrowDown","PageUp","Home"],P8=["ArrowUp","PageDown","End"],Jbe=[...Ybe,...P8],Xbe={ltr:[...hT,"ArrowRight"],rtl:[...hT,"ArrowLeft"]},Qbe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Tg="Menu",[Dp,Zbe,eSe]=D1(Tg),[Fu,A8]=Si(Tg,[eSe,w8,l0]),w_=w8(),R8=l0(),[tSe,Ou]=Fu(Tg),[nSe,Ig]=Fu(Tg),k8=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:s,onOpenChange:i,modal:o=!0}=t,l=w_(e),[c,u]=p.useState(null),d=p.useRef(!1),h=Cr(i),f=a0(s);return p.useEffect(()=>{const m=()=>{d.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>d.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),a.jsx(Hbe,{...l,children:a.jsx(tSe,{scope:e,open:n,onOpenChange:h,content:c,onContentChange:u,children:a.jsx(nSe,{scope:e,onClose:p.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:f,modal:o,children:r})})})};k8.displayName=Tg;var rSe="MenuAnchor",DP=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=w_(n);return a.jsx(Wbe,{...s,...r,ref:e})});DP.displayName=rSe;var MP="MenuPortal",[sSe,j8]=Fu(MP,{forceMount:void 0}),D8=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:s}=t,i=Ou(MP,e);return a.jsx(sSe,{scope:e,forceMount:n,children:a.jsx(Ms,{present:n||i.open,children:a.jsx(e0,{asChild:!0,container:s,children:r})})})};D8.displayName=MP;var Ui="MenuContent",[iSe,LP]=Fu(Ui),M8=p.forwardRef((t,e)=>{const n=j8(Ui,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=Ou(Ui,t.__scopeMenu),o=Ig(Ui,t.__scopeMenu);return a.jsx(Dp.Provider,{scope:t.__scopeMenu,children:a.jsx(Ms,{present:r||i.open,children:a.jsx(Dp.Slot,{scope:t.__scopeMenu,children:o.modal?a.jsx(oSe,{...s,ref:e}):a.jsx(aSe,{...s,ref:e})})})})}),oSe=p.forwardRef((t,e)=>{const n=Ou(Ui,t.__scopeMenu),r=p.useRef(null),s=bn(e,r);return p.useEffect(()=>{const i=r.current;if(i)return W1(i)},[]),a.jsx(FP,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:wt(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),aSe=p.forwardRef((t,e)=>{const n=Ou(Ui,t.__scopeMenu);return a.jsx(FP,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),lSe=xh("MenuContent.ScrollLock"),FP=p.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,disableOutsideScroll:g,...x}=t,E=Ou(Ui,n),v=Ig(Ui,n),_=w_(n),S=R8(n),I=Zbe(n),[M,j]=p.useState(null),C=p.useRef(null),T=bn(e,C,E.onContentChange),P=p.useRef(0),A=p.useRef(""),D=p.useRef(0),R=p.useRef(null),k=p.useRef("right"),U=p.useRef(0),B=g?n3:p.Fragment,K=g?{as:lSe,allowPinchZoom:!0}:void 0,ee=X=>{var xe,Me;const O=A.current+X,z=I().filter(Ye=>!Ye.disabled),Y=document.activeElement,F=(xe=z.find(Ye=>Ye.ref.current===Y))==null?void 0:xe.textValue,ye=z.map(Ye=>Ye.textValue),Se=wSe(ye,O,F),De=(Me=z.find(Ye=>Ye.textValue===Se))==null?void 0:Me.ref.current;(function Ye(qe){A.current=qe,window.clearTimeout(P.current),qe!==""&&(P.current=window.setTimeout(()=>Ye(""),1e3))})(O),De&&setTimeout(()=>De.focus())};p.useEffect(()=>()=>window.clearTimeout(P.current),[]),G$();const H=p.useCallback(X=>{var z,Y;return k.current===((z=R.current)==null?void 0:z.side)&&bSe(X,(Y=R.current)==null?void 0:Y.area)},[]);return a.jsx(iSe,{scope:n,searchRef:A,onItemEnter:p.useCallback(X=>{H(X)&&X.preventDefault()},[H]),onItemLeave:p.useCallback(X=>{var O;H(X)||((O=C.current)==null||O.focus(),j(null))},[H]),onTriggerLeave:p.useCallback(X=>{H(X)&&X.preventDefault()},[H]),pointerGraceTimerRef:D,onPointerGraceIntentChange:p.useCallback(X=>{R.current=X},[]),children:a.jsx(B,{...K,children:a.jsx(G1,{asChild:!0,trapped:s,onMountAutoFocus:wt(i,X=>{var O;X.preventDefault(),(O=C.current)==null||O.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:a.jsx(Zw,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,children:a.jsx(F3,{asChild:!0,...S,dir:v.dir,orientation:"vertical",loop:r,currentTabStopId:M,onCurrentTabStopIdChange:j,onEntryFocus:wt(c,X=>{v.isUsingKeyboardRef.current||X.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(qbe,{role:"menu","aria-orientation":"vertical","data-state":X8(E.open),"data-radix-menu-content":"",dir:v.dir,..._,...x,ref:T,style:{outline:"none",...x.style},onKeyDown:wt(x.onKeyDown,X=>{const z=X.target.closest("[data-radix-menu-content]")===X.currentTarget,Y=X.ctrlKey||X.altKey||X.metaKey,F=X.key.length===1;z&&(X.key==="Tab"&&X.preventDefault(),!Y&&F&&ee(X.key));const ye=C.current;if(X.target!==ye||!Jbe.includes(X.key))return;X.preventDefault();const De=I().filter(xe=>!xe.disabled).map(xe=>xe.ref.current);P8.includes(X.key)&&De.reverse(),xSe(De)}),onBlur:wt(t.onBlur,X=>{X.currentTarget.contains(X.target)||(window.clearTimeout(P.current),A.current="")}),onPointerMove:wt(t.onPointerMove,Mp(X=>{const O=X.target,z=U.current!==X.clientX;if(X.currentTarget.contains(O)&&z){const Y=X.clientX>U.current?"right":"left";k.current=Y,U.current=X.clientX}}))})})})})})})});M8.displayName=Ui;var cSe="MenuGroup",OP=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Kt.div,{role:"group",...r,ref:e})});OP.displayName=cSe;var uSe="MenuLabel",L8=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Kt.div,{...r,ref:e})});L8.displayName=uSe;var vw="MenuItem",U4="menu.itemSelect",__=p.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...s}=t,i=p.useRef(null),o=Ig(vw,t.__scopeMenu),l=LP(vw,t.__scopeMenu),c=bn(e,i),u=p.useRef(!1),d=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent(U4,{bubbles:!0,cancelable:!0});h.addEventListener(U4,m=>r==null?void 0:r(m),{once:!0}),M1(h,f),f.defaultPrevented?u.current=!1:o.onClose()}};return a.jsx(F8,{...s,ref:c,disabled:n,onClick:wt(t.onClick,d),onPointerDown:h=>{var f;(f=t.onPointerDown)==null||f.call(t,h),u.current=!0},onPointerUp:wt(t.onPointerUp,h=>{var f;u.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:wt(t.onKeyDown,h=>{const f=l.searchRef.current!=="";n||f&&h.key===" "||hT.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});__.displayName=vw;var F8=p.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=t,o=LP(vw,n),l=R8(n),c=p.useRef(null),u=bn(e,c),[d,h]=p.useState(!1),[f,m]=p.useState("");return p.useEffect(()=>{const g=c.current;g&&m((g.textContent??"").trim())},[i.children]),a.jsx(Dp.ItemSlot,{scope:n,disabled:r,textValue:s??f,children:a.jsx(O3,{asChild:!0,...l,focusable:!r,children:a.jsx(Kt.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:u,onPointerMove:wt(t.onPointerMove,Mp(g=>{r?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:wt(t.onPointerLeave,Mp(g=>o.onItemLeave(g))),onFocus:wt(t.onFocus,()=>h(!0)),onBlur:wt(t.onBlur,()=>h(!1))})})})}),dSe="MenuCheckboxItem",O8=p.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...s}=t;return a.jsx(z8,{scope:t.__scopeMenu,checked:n,children:a.jsx(__,{role:"menuitemcheckbox","aria-checked":ww(n)?"mixed":n,...s,ref:e,"data-state":$P(n),onSelect:wt(s.onSelect,()=>r==null?void 0:r(ww(n)?!0:!n),{checkForDefaultPrevented:!1})})})});O8.displayName=dSe;var V8="MenuRadioGroup",[hSe,fSe]=Fu(V8,{value:void 0,onValueChange:()=>{}}),$8=p.forwardRef((t,e)=>{const{value:n,onValueChange:r,...s}=t,i=Cr(r);return a.jsx(hSe,{scope:t.__scopeMenu,value:n,onValueChange:i,children:a.jsx(OP,{...s,ref:e})})});$8.displayName=V8;var U8="MenuRadioItem",B8=p.forwardRef((t,e)=>{const{value:n,...r}=t,s=fSe(U8,t.__scopeMenu),i=n===s.value;return a.jsx(z8,{scope:t.__scopeMenu,checked:i,children:a.jsx(__,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":$P(i),onSelect:wt(r.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,n)},{checkForDefaultPrevented:!1})})})});B8.displayName=U8;var VP="MenuItemIndicator",[z8,mSe]=Fu(VP,{checked:!1}),G8=p.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...s}=t,i=mSe(VP,n);return a.jsx(Ms,{present:r||ww(i.checked)||i.checked===!0,children:a.jsx(Kt.span,{...s,ref:e,"data-state":$P(i.checked)})})});G8.displayName=VP;var pSe="MenuSeparator",H8=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Kt.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});H8.displayName=pSe;var gSe="MenuArrow",W8=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=w_(n);return a.jsx(Kbe,{...s,...r,ref:e})});W8.displayName=gSe;var ySe="MenuSub",[$ke,q8]=Fu(ySe),am="MenuSubTrigger",K8=p.forwardRef((t,e)=>{const n=Ou(am,t.__scopeMenu),r=Ig(am,t.__scopeMenu),s=q8(am,t.__scopeMenu),i=LP(am,t.__scopeMenu),o=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,u={__scopeMenu:t.__scopeMenu},d=p.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return p.useEffect(()=>d,[d]),p.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),a.jsx(DP,{asChild:!0,...u,children:a.jsx(F8,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":X8(n.open),...t,ref:Qw(e,s.onTriggerChange),onClick:h=>{var f;(f=t.onClick)==null||f.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:wt(t.onPointerMove,Mp(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:wt(t.onPointerLeave,Mp(h=>{var m,g;d();const f=(m=n.content)==null?void 0:m.getBoundingClientRect();if(f){const x=(g=n.content)==null?void 0:g.dataset.side,E=x==="right",v=E?-5:5,_=f[E?"left":"right"],S=f[E?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+v,y:h.clientY},{x:_,y:f.top},{x:S,y:f.top},{x:S,y:f.bottom},{x:_,y:f.bottom}],side:x}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:wt(t.onKeyDown,h=>{var m;const f=i.searchRef.current!=="";t.disabled||f&&h.key===" "||Xbe[r.dir].includes(h.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),h.preventDefault())})})})});K8.displayName=am;var Y8="MenuSubContent",J8=p.forwardRef((t,e)=>{const n=j8(Ui,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=Ou(Ui,t.__scopeMenu),o=Ig(Ui,t.__scopeMenu),l=q8(Y8,t.__scopeMenu),c=p.useRef(null),u=bn(e,c);return a.jsx(Dp.Provider,{scope:t.__scopeMenu,children:a.jsx(Ms,{present:r||i.open,children:a.jsx(Dp.Slot,{scope:t.__scopeMenu,children:a.jsx(FP,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;o.isUsingKeyboardRef.current&&((h=c.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:wt(t.onFocusOutside,d=>{d.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:wt(t.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:wt(t.onKeyDown,d=>{var m;const h=d.currentTarget.contains(d.target),f=Qbe[o.dir].includes(d.key);h&&f&&(i.onOpenChange(!1),(m=l.trigger)==null||m.focus(),d.preventDefault())})})})})})});J8.displayName=Y8;function X8(t){return t?"open":"closed"}function ww(t){return t==="indeterminate"}function $P(t){return ww(t)?"indeterminate":t?"checked":"unchecked"}function xSe(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function vSe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function wSe(t,e,n){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=vSe(t,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function _Se(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const l=e[i],c=e[o],u=l.x,d=l.y,h=c.x,f=c.y;d>r!=f>r&&n<(h-u)*(r-d)/(f-d)+u&&(s=!s)}return s}function bSe(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return _Se(n,e)}function Mp(t){return e=>e.pointerType==="mouse"?t(e):void 0}var SSe=k8,ESe=DP,CSe=D8,TSe=M8,ISe=OP,NSe=L8,PSe=__,ASe=O8,RSe=$8,kSe=B8,jSe=G8,DSe=H8,MSe=W8,LSe=K8,FSe=J8,b_="DropdownMenu",[OSe,Uke]=Si(b_,[A8]),Fs=A8(),[VSe,Q8]=OSe(b_),Z8=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:o,modal:l=!0}=t,c=Fs(e),u=p.useRef(null),[d,h]=Pu({prop:s,defaultProp:i??!1,onChange:o,caller:b_});return a.jsx(VSe,{scope:e,triggerId:Xc(),triggerRef:u,contentId:Xc(),open:d,onOpenChange:h,onOpenToggle:p.useCallback(()=>h(f=>!f),[h]),modal:l,children:a.jsx(SSe,{...c,open:d,onOpenChange:h,dir:r,modal:l,children:n})})};Z8.displayName=b_;var e7="DropdownMenuTrigger",t7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=t,i=Q8(e7,n),o=Fs(n);return a.jsx(ESe,{asChild:!0,...o,children:a.jsx(Kt.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:Qw(e,i.triggerRef),onPointerDown:wt(t.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:wt(t.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});t7.displayName=e7;var $Se="DropdownMenuPortal",n7=t=>{const{__scopeDropdownMenu:e,...n}=t,r=Fs(e);return a.jsx(CSe,{...r,...n})};n7.displayName=$Se;var r7="DropdownMenuContent",s7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Q8(r7,n),i=Fs(n),o=p.useRef(!1);return a.jsx(TSe,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:e,onCloseAutoFocus:wt(t.onCloseAutoFocus,l=>{var c;o.current||(c=s.triggerRef.current)==null||c.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:wt(t.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,d=c.button===2||u;(!s.modal||d)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});s7.displayName=r7;var USe="DropdownMenuGroup",BSe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Fs(n);return a.jsx(ISe,{...s,...r,ref:e})});BSe.displayName=USe;var zSe="DropdownMenuLabel",i7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Fs(n);return a.jsx(NSe,{...s,...r,ref:e})});i7.displayName=zSe;var GSe="DropdownMenuItem",o7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Fs(n);return a.jsx(PSe,{...s,...r,ref:e})});o7.displayName=GSe;var HSe="DropdownMenuCheckboxItem",a7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Fs(n);return a.jsx(ASe,{...s,...r,ref:e})});a7.displayName=HSe;var WSe="DropdownMenuRadioGroup",qSe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Fs(n);return a.jsx(RSe,{...s,...r,ref:e})});qSe.displayName=WSe;var KSe="DropdownMenuRadioItem",l7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Fs(n);return a.jsx(kSe,{...s,...r,ref:e})});l7.displayName=KSe;var YSe="DropdownMenuItemIndicator",c7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Fs(n);return a.jsx(jSe,{...s,...r,ref:e})});c7.displayName=YSe;var JSe="DropdownMenuSeparator",u7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Fs(n);return a.jsx(DSe,{...s,...r,ref:e})});u7.displayName=JSe;var XSe="DropdownMenuArrow",QSe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Fs(n);return a.jsx(MSe,{...s,...r,ref:e})});QSe.displayName=XSe;var ZSe="DropdownMenuSubTrigger",d7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Fs(n);return a.jsx(LSe,{...s,...r,ref:e})});d7.displayName=ZSe;var eEe="DropdownMenuSubContent",h7=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Fs(n);return a.jsx(FSe,{...s,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});h7.displayName=eEe;var tEe=Z8,nEe=t7,rEe=n7,f7=s7,m7=i7,p7=o7,g7=a7,y7=l7,x7=c7,v7=u7,w7=d7,_7=h7;const sEe=tEe,iEe=nEe,oEe=p.forwardRef(({className:t,inset:e,children:n,...r},s)=>a.jsxs(w7,{ref:s,className:bt("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...r,children:[n,a.jsx(Fse,{className:"ml-auto"})]}));oEe.displayName=w7.displayName;const aEe=p.forwardRef(({className:t,...e},n)=>a.jsx(_7,{ref:n,className:bt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...e}));aEe.displayName=_7.displayName;const b7=p.forwardRef(({className:t,sideOffset:e=4,...n},r)=>a.jsx(rEe,{children:a.jsx(f7,{ref:r,sideOffset:e,className:bt("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n})}));b7.displayName=f7.displayName;const yd=p.forwardRef(({className:t,inset:e,...n},r)=>a.jsx(p7,{ref:r,className:bt("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",e&&"pl-8",t),...n}));yd.displayName=p7.displayName;const lEe=p.forwardRef(({className:t,children:e,checked:n,...r},s)=>a.jsxs(g7,{ref:s,className:bt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(x7,{children:a.jsx(qp,{className:"h-4 w-4"})})}),e]}));lEe.displayName=g7.displayName;const cEe=p.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(y7,{ref:r,className:bt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(x7,{children:a.jsx(Vse,{className:"h-2 w-2 fill-current"})})}),e]}));cEe.displayName=y7.displayName;const S7=p.forwardRef(({className:t,inset:e,...n},r)=>a.jsx(m7,{ref:r,className:bt("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));S7.displayName=m7.displayName;const E7=p.forwardRef(({className:t,...e},n)=>a.jsx(v7,{ref:n,className:bt("-mx-1 my-1 h-px bg-muted",t),...e}));E7.displayName=v7.displayName;var C7="basil",uEe=function(e){return e===3?"v3":e},T7="https://js.stripe.com",dEe="".concat(T7,"/").concat(C7,"/stripe.js"),hEe=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,fEe=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,B4="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",mEe=function(e){return hEe.test(e)||fEe.test(e)},pEe=function(){for(var e=document.querySelectorAll('script[src^="'.concat(T7,'"]')),n=0;n<e.length;n++){var r=e[n];if(mEe(r.src))return r}return null},z4=function(e){var n=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(dEe).concat(n);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(r),r},gEe=function(e,n){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"7.3.0",startTime:n})},Of=null,Uy=null,By=null,yEe=function(e){return function(n){e(new Error("Failed to load Stripe.js",{cause:n}))}},xEe=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},vEe=function(e){return Of!==null?Of:(Of=new Promise(function(n,r){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe&&e&&console.warn(B4),window.Stripe){n(window.Stripe);return}try{var s=pEe();if(s&&e)console.warn(B4);else if(!s)s=z4(e);else if(s&&By!==null&&Uy!==null){var i;s.removeEventListener("load",By),s.removeEventListener("error",Uy),(i=s.parentNode)===null||i===void 0||i.removeChild(s),s=z4(e)}By=xEe(n,r),Uy=yEe(r),s.addEventListener("load",By),s.addEventListener("error",Uy)}catch(o){r(o);return}}),Of.catch(function(n){return Of=null,Promise.reject(n)}))},wEe=function(e,n,r){if(e===null)return null;var s=n[0],i=s.match(/^pk_test/),o=uEe(e.version),l=C7;i&&o!==l&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("7.3.0"," expected Stripe.js@").concat(l,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var c=e.apply(void 0,n);return gEe(c,r),c},Vf,I7=!1,N7=function(){return Vf||(Vf=vEe(null).catch(function(e){return Vf=null,Promise.reject(e)}),Vf)};Promise.resolve().then(function(){return N7()}).catch(function(t){I7||console.warn(t)});var UP=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];I7=!0;var s=Date.now();return N7().then(function(i){return wEe(i,n,s)})};const _Ee="pk_live_51NAoUjDktew9heHOJD5Px4jn9IaolhvVvqoE6NukJV7MxZa8PhIVSwcOVWXdQx6MFNgIGmEYeg64lFUGlYfAyVqu004n16tAdG",bEe=UP(_Ee),SEe={}.VITE_STRIPE_PRO_PLAN_PRICE_ID||"price_1RPDinDktew9heHOLkkL3ZDv",fT=({onSubscribed:t,className:e=""})=>{const{user:n,isAuthenticated:r}=qi(),[s,i]=p.useState(!1),[o,l]=p.useState(null),c=async()=>{if(!r||!n){l("You must be logged in to subscribe.");return}i(!0),l(null);try{const u=d_(),d=sh(u,"createStripeCheckoutSession"),h=`${window.location.origin}/dashboard?subscription_success=true`,f=`${window.location.origin}/pricing`,m={priceId:SEe,quantity:1,successUrl:h,cancelUrl:f};console.log("Calling createStripeCheckoutSession with payload:",m);const g=await d(m),{sessionId:x,error:E}=g.data;if(E)throw console.error("Firebase function error:",E),new Error(E.message||"Failed to create subscription session via Firebase function.");if(!x)throw console.error("No sessionId returned from Firebase function"),new Error("Failed to retrieve a session ID from the server.");console.log("Received sessionId:",x);const v=await bEe,{error:_}=await v.redirectToCheckout({sessionId:x});_?(console.error("Stripe redirect error:",_),l(_.message)):t&&t()}catch(u){console.error("Subscription error:",u.message,u),l(u.message)}finally{i(!1)}};return a.jsxs("div",{children:[a.jsx(V,{onClick:c,disabled:s,className:`bg-gradient-to-r from-[#77B8B8] to-[#3B82F6] hover:from-[#6AB0B0] hover:to-[#2F73E0] text-white ${e}`,children:s?"Processing...":"Subscribe to Pro"}),o&&a.jsxs("p",{style:{color:"red",marginTop:"10px",fontSize:"0.8rem"},children:["Error: ",o]})," "]})},BP=()=>{const{isAuthenticated:t,user:e,logout:n,session:r,subscriptionStatus:s,loadingProfile:i,profile:o}=qi(),l=bi(),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),[g,x]=p.useState(null),[E,v]=p.useState(!1),[_,S]=p.useState(!1),I=s==="active",M=(o==null?void 0:o.stripe_account_id)&&(o==null?void 0:o.stripe_account_details_submitted);p.useEffect(()=>{const D=localStorage.getItem("theme"),R=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;D==="dark"||!D&&R?(document.documentElement.classList.add("dark"),v(!0)):(document.documentElement.classList.remove("dark"),v(!1))},[]);const j=()=>{E?(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")),v(!E)},C=async()=>{try{await n(),l("/auth")}catch(D){console.error("Error logging out:",D)}},T=async()=>{if(!e){h("Authentication required. Please log in again.");return}u(!0),h(null);try{const k=(await sh(hS,"stripeCreatePortalSession")()).data;if(k&&k.url)window.location.href=k.url;else throw new Error(k.error||"Failed to create portal session URL.")}catch(D){console.error("Portal session error:",D),h(D.message||"An unexpected error occurred.")}finally{u(!1)}},P=async()=>{if(!e){x("Authentication required.");return}m(!0),x(null);try{const k=(await sh(hS,"stripeCreateConnectAccount")({email:e.email})).data;if(k&&k.accountLinkUrl)window.location.href=k.accountLinkUrl;else throw new Error(k.error||"Failed to create Stripe Connect account link.")}catch(D){console.error("Stripe Connect account creation error:",D),x(D.message||"An unexpected error occurred.")}finally{m(!1)}},A=async()=>{if(!e||!(o!=null&&o.stripe_account_id)){x("Stripe account not connected or user not authenticated.");return}m(!0),x(null);try{const k=(await sh(hS,"stripeCreateLoginLink")({stripeAccountId:o.stripe_account_id})).data;if(k&&k.loginLinkUrl)window.location.href=k.loginLinkUrl;else throw new Error(k.error||"Failed to create Stripe login link.")}catch(D){console.error("Stripe login link error:",D),x(D.message||"An unexpected error occurred.")}finally{m(!1)}};return a.jsxs(a.Fragment,{children:[!i&&t&&!M&&a.jsxs("div",{className:"bg-foreground text-background py-2 px-4 text-center text-sm dark:bg-blue-700 dark:text-white",children:[a.jsx("button",{onClick:P,disabled:f,className:"hover:underline focus:outline-none",children:f?"Processing...":"Create A Business to Activate Checkout"}),g&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:g})]}),a.jsxs(Ct.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full py-4 px-6 flex justify-between items-center sticky top-0 z-50 bg-background/80 backdrop-blur-md border-b",children:[a.jsxs(Ns,{to:"/",className:"flex items-center gap-2",children:[a.jsx("img",{src:E?"https://firebasestorage.googleapis.com/v0/b/themeforge-hui99.firebasestorage.app/o/ffwhite.png?alt=media&token=a2ebe18b-109c-4c55-b9e1-ec226a788632":"https://firebasestorage.googleapis.com/v0/b/themeforge-hui99.firebasestorage.app/o/Ffblack%20(1).png?alt=media&token=cd13601d-6e44-41b9-9e25-35b6f510f99a",alt:"FreshFront Logo",className:"h-10 sm:h-[60px] w-auto transition-all"}),a.jsx("span",{className:"font-bold text-lg sm:text-xl transition-all",children:"FreshFront"})]}),a.jsxs("nav",{className:"hidden md:flex items-center gap-3",children:[t&&!i&&a.jsxs(a.Fragment,{children:[a.jsx(fT,{className:"px-3 py-1.5 rounded-full text-sm font-medium",showIcon:!0}),a.jsxs(sEe,{children:[a.jsx(iEe,{asChild:!0,children:a.jsxs(V,{variant:"outline",size:"sm",className:"rounded-full px-3 py-1.5 text-sm font-medium",children:[a.jsx(Lse,{className:"mr-2 h-4 w-4"})," Business ",a.jsx(n0,{className:"ml-1 h-4 w-4"})]})}),a.jsxs(b7,{align:"end",children:[a.jsx(S7,{children:"Stripe Connect"}),a.jsx(E7,{}),M?a.jsxs(yd,{onClick:A,disabled:f,children:[a.jsx(Ad,{className:"mr-2 h-4 w-4"})," ",f?"Processing...":"Dashboard"]}):a.jsxs(yd,{onClick:P,disabled:f,children:[a.jsx(Ad,{className:"mr-2 h-4 w-4"}),f?"Processing...":"Create Business Account"]}),I&&a.jsxs(yd,{onClick:T,disabled:c,children:[a.jsx(up,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Billing"]}),g&&a.jsx(yd,{disabled:!0,children:a.jsx("p",{className:"text-xs text-destructive",children:g})}),d&&a.jsx(yd,{disabled:!0,children:a.jsx("p",{className:"text-xs text-destructive",children:d})})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Do,{id:"theme-switcher-desktop",checked:E,onCheckedChange:j,"aria-label":"Toggle dark mode"}),E?a.jsx(WE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(qE,{className:"h-5 w-5 text-muted-foreground"})]}),t?a.jsxs(a.Fragment,{children:[(e==null?void 0:e.photoURL)&&a.jsx("img",{src:e.photoURL,alt:"User avatar",className:"h-6 w-6 rounded-full"}),a.jsxs("span",{className:"text-sm text-muted-foreground hidden lg:inline",children:[" ",e==null?void 0:e.email]}),a.jsxs(V,{variant:"outline",size:"sm",onClick:C,children:[a.jsx(Pj,{className:"mr-2 h-4 w-4"})," Logout"]})]}):a.jsx(Ns,{to:"/auth",children:a.jsxs(V,{variant:"outline",size:"sm",children:[a.jsx(Nj,{className:"mr-2 h-4 w-4"})," Login"]})})]}),a.jsx("div",{className:"md:hidden",children:a.jsx(V,{variant:"ghost",size:"icon",onClick:()=>S(!_),children:_?a.jsx(zo,{className:"h-6 w-6"}):a.jsx(k$,{className:"h-6 w-6"})})})]}),a.jsx(_h,{children:_&&a.jsx(Ct.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"md:hidden fixed inset-x-0 top-[117px] z-40 bg-background/95 backdrop-blur-sm p-6 border-b shadow-lg",children:a.jsxs("nav",{className:"flex flex-col gap-4",children:[t&&!i&&a.jsxs(a.Fragment,{children:[a.jsx(fT,{className:"w-full justify-start px-3 py-2 text-base",showIcon:!0}),M?a.jsxs(V,{variant:"outline",onClick:A,disabled:f,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(Ad,{className:"mr-2 h-4 w-4"})," ",f?"Processing...":"Dashboard"]}):a.jsxs(V,{variant:"outline",onClick:P,disabled:f,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(Ad,{className:"mr-2 h-4 w-4"}),f?"Processing...":"Create Business Account"]}),I&&a.jsxs(V,{variant:"outline",onClick:T,disabled:c,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(up,{className:"mr-2 h-4 w-4"})," ",c?"Loading...":"Manage Billing"]}),g&&a.jsx("p",{className:"text-xs text-destructive px-3 py-1",children:g}),d&&a.jsx("p",{className:"text-xs text-destructive px-3 py-1",children:d})]}),a.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[a.jsx("span",{className:"text-base",children:"Dark Mode"}),a.jsx(Do,{id:"theme-switcher-mobile",checked:E,onCheckedChange:j,"aria-label":"Toggle dark mode"})]}),t?a.jsxs(a.Fragment,{children:[(e==null?void 0:e.photoURL)&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",children:[a.jsx("img",{src:e.photoURL,alt:"User avatar",className:"h-8 w-8 rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:e==null?void 0:e.email})]}),a.jsxs(V,{variant:"outline",onClick:C,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(Pj,{className:"mr-2 h-4 w-4"})," Logout"]})]}):a.jsx(Ns,{to:"/auth",className:"w-full",children:a.jsxs(V,{variant:"outline",className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(Nj,{className:"mr-2 h-4 w-4"})," Login"]})})]})})})]})},G4=["Create a luxury jewelry store called 'Elegance' with diamond rings and gold necklaces, featuring a dark, sophisticated theme.","Build a tech gadget store named 'FutureTech' with the latest smartphones and accessories, using a futuristic blue and silver color scheme.","Design an organic food market 'GreenHarvest' with fresh produce and healthy snacks, emphasizing natural textures and earthy tones.","Make a trendy fashion boutique 'Urban Threads' with summer dresses and casual wear, aiming for a bright, minimalist aesthetic."],pS={"Healthy Food":{keywords:["healthy food","organic food","greenharvest","fresh produce","natural food","health store"],primaryColor:"green",secondaryColor:"orange",templates:["Classic","Fresh","Sleek"]},"Fast Food":{keywords:["fast food","burgers","fries","pizza","takeaway","quick serve"],primaryColor:"red",secondaryColor:"orange",templates:["Premium","Modern","Classic","Fresh","Sleek"]},Technology:{keywords:["tech","gadget","electronics","software","computer","phone","futuretech"],primaryColor:"blue",secondaryColor:"purple",templates:["Classic","Fresh","Sleek","Sharp","Premium","Modern"]},"General Store":{keywords:["general store","variety store","convenience store","department store"],primaryColor:"navy",secondaryColor:"grey",templates:["Classic","Fresh","Sleek","Premium","Modern"]},"Female Fashion/Beauty":{keywords:["female fashion","beauty","cosmetics","makeup","women's clothing","boutique","urban threads"],primaryColor:"peach",secondaryColor:"purple",templates:["Classic","Fresh","Sleek"]},Jewelry:{keywords:["jewelry","rings","necklaces","earrings","diamonds","gold","elegance"],primaryColor:"grey",secondaryColor:"darkpurple",templates:["Classic","Fresh","Sleek","Premium","Modern"]},Fashion:{keywords:["fashion","clothing","apparel","style","wear"],primaryColor:"navyblue",secondaryColor:"mediumred",templates:["Classic","Fresh","Sleek","Premium","Modern"]},Furniture:{keywords:["furniture","home decor","sofa","table","chair","furnishings"],primaryColor:"brown",secondaryColor:"darkgrey",templates:["Classic","Fresh","Sleek"]},Default:{keywords:[],primaryColor:"blue",secondaryColor:"gray",templates:["Fresh","Classic","Sleek","Modern"]}},EEe=t=>{const e=t.toLowerCase();for(const n in pS){if(n==="Default")continue;const r=pS[n];if(r.keywords.some(s=>e.includes(s.toLowerCase())))return{...r,name:n}}return{...pS.Default,name:"General Store"}},CEe=()=>{const[t,e]=p.useState(""),[n,r]=p.useState(""),[s,i]=p.useState(null),{generateStore:o,isGenerating:l}=$n(),[c,u]=p.useState(!1),[d,h]=p.useState(null),f=E=>{e(E.target.value),h(null)},m=p.useCallback(async E=>{const v=E||t;if(!v.trim())return h({status:"error",message:"Store name cannot be empty."}),!1;u(!0),h(null);try{return await UG(v.trim())?(h({status:"claimed",message:"Not available"}),!1):(h({status:"available",message:"Available"}),!0)}catch(_){return console.error("Store name availability check failed in StoreGenerator:",_),h({status:"error",message:_.message||"Failed to check name. Please try again."}),!1}finally{u(!1)}},[t]),g=E=>{i(E);const v=G4[E],_=v.match(/(?:store called|store named|market|boutique) '([^']+)'/i),S=_&&_[1]?_[1]:"";e(S),r(v),h(null),S&&setTimeout(()=>m(S),0)},x=async E=>{E.preventDefault();let v=!1;if(d&&d.status==="available"?v=!0:t.trim()?v=await m(t):h({status:"error",message:"Store name cannot be empty."}),!v)return;if(!n.trim()){alert("Please provide a description for your store.");return}if(l||c)return;const _=EEe(n);await o(n,t,_)};return a.jsx(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full",children:a.jsxs("form",{onSubmit:x,className:"space-y-6",children:[" ",a.jsxs("div",{children:[a.jsx("label",{htmlFor:"storeName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Store Name"}),a.jsxs("div",{className:"relative flex items-center",children:[a.jsx(nt,{id:"storeName",type:"text",placeholder:"ex. Future Furniture",className:bt("text-base flex-grow",(d==null?void 0:d.status)==="claimed"&&"border-red-500 focus:border-red-500 dark:border-red-500 dark:focus:border-red-500",(d==null?void 0:d.status)==="error"&&"border-yellow-500 focus:border-yellow-500 dark:border-yellow-500 dark:focus:border-yellow-500",(d==null?void 0:d.status)==="available"&&"border-green-500 focus:border-green-500 dark:border-green-500 dark:focus:border-green-500","pr-24"),value:t,onChange:f,disabled:l||c}),a.jsxs(V,{type:"button",variant:"ghost",size:"sm",onClick:()=>m(),disabled:!t.trim()||c,className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 px-2 z-10",children:[c?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(uo,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-1 hidden sm:inline",children:"Check"})]})]}),a.jsxs("div",{className:"h-5 mt-1",children:[" ",c&&t.trim()&&a.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[a.jsx(St,{className:"h-4 w-4 animate-spin mr-2"})," Checking..."]}),d&&t.trim()&&!c&&a.jsxs("p",{className:`text-sm font-medium flex items-center ${d.status==="available"?"text-green-600":d.status==="claimed"?"text-red-600":d.status==="error"?"text-yellow-600":"text-muted-foreground"}`,children:[d.status==="available"&&a.jsx(uo,{className:"h-4 w-4 mr-1"}),d.status==="claimed"&&a.jsx(Cj,{className:"h-4 w-4 mr-1"}),d.status==="error"&&a.jsx(Cj,{className:"h-4 w-4 mr-1"}),d.message]})]})]}),a.jsxs("div",{className:"-mt-[15px]",children:[a.jsx("label",{htmlFor:"storePrompt",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),a.jsx(Ln,{id:"storePrompt",placeholder:"e.g., 'A modern furniture store specializing in sustainable and innovative designs for the contemporary home. Focus on minimalist aesthetics and smart functionality.'",className:"min-h-[120px] text-base resize-none",value:n,onChange:E=>r(E.target.value),disabled:l})]})," ",a.jsx(V,{type:"submit",disabled:!t.trim()||!n.trim()||l||c||d&&d.status!=="available",className:"w-full bg-gradient-to-r from-green-600 to-cyan-600 hover:from-green-700 hover:to-cyan-700 text-white mt-6",size:"lg",children:l?a.jsxs(a.Fragment,{children:[a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Store..."]}):a.jsxs(a.Fragment,{children:[a.jsx(_a,{className:"mr-2 h-4 w-4"}),"Generate Store"]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Or try one of these examples for inspiration:"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:G4.map((E,v)=>a.jsx(V,{type:"button",variant:s===v?"default":"outline",className:"h-auto py-2 px-3 justify-start text-left text-sm font-normal",onClick:()=>g(v),disabled:l,children:E},v))})]})]})})};var P7="AlertDialog",[TEe,Bke]=Si(P7,[i3]),Oa=i3(),A7=t=>{const{__scopeAlertDialog:e,...n}=t,r=Oa(e);return a.jsx(_3,{...r,...n,modal:!0})};A7.displayName=P7;var IEe="AlertDialogTrigger",R7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Oa(n);return a.jsx(Soe,{...s,...r,ref:e})});R7.displayName=IEe;var NEe="AlertDialogPortal",k7=t=>{const{__scopeAlertDialog:e,...n}=t,r=Oa(e);return a.jsx(b3,{...r,...n})};k7.displayName=NEe;var PEe="AlertDialogOverlay",j7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Oa(n);return a.jsx(J1,{...s,...r,ref:e})});j7.displayName=PEe;var oh="AlertDialogContent",[AEe,REe]=TEe(oh),kEe=Gre("AlertDialogContent"),D7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,children:r,...s}=t,i=Oa(n),o=p.useRef(null),l=bn(e,o),c=p.useRef(null);return a.jsx(voe,{contentName:oh,titleName:M7,docsSlug:"alert-dialog",children:a.jsx(AEe,{scope:n,cancelRef:c,children:a.jsxs(X1,{role:"alertdialog",...i,...s,ref:l,onOpenAutoFocus:wt(s.onOpenAutoFocus,u=>{var d;u.preventDefault(),(d=c.current)==null||d.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[a.jsx(kEe,{children:r}),a.jsx(DEe,{contentRef:o})]})})})});D7.displayName=oh;var M7="AlertDialogTitle",L7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Oa(n);return a.jsx(Q1,{...s,...r,ref:e})});L7.displayName=M7;var F7="AlertDialogDescription",O7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Oa(n);return a.jsx(Z1,{...s,...r,ref:e})});O7.displayName=F7;var jEe="AlertDialogAction",V7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Oa(n);return a.jsx(o0,{...s,...r,ref:e})});V7.displayName=jEe;var $7="AlertDialogCancel",U7=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,{cancelRef:s}=REe($7,n),i=Oa(n),o=bn(e,s);return a.jsx(o0,{...i,...r,ref:o})});U7.displayName=$7;var DEe=({contentRef:t})=>{const e=`\`${oh}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${oh}\` by passing a \`${F7}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${oh}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{var r;document.getElementById((r=t.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(e)},[e,t]),null},MEe=A7,LEe=R7,FEe=k7,B7=j7,z7=D7,G7=V7,H7=U7,W7=L7,q7=O7;const OEe=MEe,VEe=LEe,$Ee=FEe,K7=ct.forwardRef(({className:t,...e},n)=>a.jsx(B7,{className:bt("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:n}));K7.displayName=B7.displayName;const Y7=ct.forwardRef(({className:t,...e},n)=>a.jsxs($Ee,{children:[a.jsx(K7,{}),a.jsx(z7,{ref:n,className:bt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e})]}));Y7.displayName=z7.displayName;const J7=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col space-y-2 text-center sm:text-left",t),...e});J7.displayName="AlertDialogHeader";const X7=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});X7.displayName="AlertDialogFooter";const Q7=ct.forwardRef(({className:t,...e},n)=>a.jsx(W7,{ref:n,className:bt("text-lg font-semibold",t),...e}));Q7.displayName=W7.displayName;const Z7=ct.forwardRef(({className:t,...e},n)=>a.jsx(q7,{ref:n,className:bt("text-sm text-muted-foreground",t),...e}));Z7.displayName=q7.displayName;const eH=ct.forwardRef(({className:t,...e},n)=>a.jsx(G7,{ref:n,className:bt(eI(),t),...e}));eH.displayName=G7.displayName;const tH=ct.forwardRef(({className:t,...e},n)=>a.jsx(H7,{ref:n,className:bt(eI({variant:"outline"}),"mt-2 sm:mt-0",t),...e}));tH.displayName=H7.displayName;const UEe=({store:t})=>{const e=bi(),{deleteStore:n,updateStorePassKey:r,assignStoreManager:s,updateStoreTemplateVersion:i}=$n(),[o,l]=ct.useState(""),[c,u]=ct.useState(""),[d,h]=ct.useState(!1),f=()=>{r&&o&&t.id&&r(t.id,o)},m=()=>{s&&c&&t.id&&s(t.id,c)},g=E=>{if(!E)return"N/A";try{const v=new Date(E);return isNaN(v.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(v)}catch(v){return console.error("Error formatting date:",E,v),"Error Date"}},x=E=>{switch(E){case"fashion":return a.jsx(D$,{className:"h-5 w-5 text-pink-500"});case"electronics":return a.jsx(dy,{className:"h-5 w-5 text-blue-500"});case"food":return a.jsx(dy,{className:"h-5 w-5 text-green-500"});case"jewelry":return a.jsx(dy,{className:"h-5 w-5 text-amber-500"});default:return a.jsx(dy,{className:"h-5 w-5 text-gray-500"})}};return a.jsx(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"store-preview relative bg-cover bg-center rounded-[15px] overflow-hidden",style:t.card_background_url?{backgroundImage:`url(${t.card_background_url})`}:{backgroundColor:"#374151"},children:a.jsxs(Ge,{className:"h-full overflow-hidden border-2 border-white/20 hover:border-primary/50 transition-all duration-300 bg-black/30 backdrop-blur-sm text-white rounded-[15px]",children:[" ",a.jsxs("div",{className:"relative z-10 p-1 rounded-[15px]",children:[" ",a.jsxs(rt,{className:"pb-2",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[t.logo_url?a.jsx("img",{src:t.logo_url,alt:`${t.name} logo`,className:"h-6 w-6 rounded-sm object-contain bg-white/30 p-0.5"}):x(t.type),a.jsx(st,{className:"text-xl text-white drop-shadow-md",children:t.name})]}),a.jsx("span",{className:"px-2 py-1 bg-white/10 text-gray-200 text-xs rounded-full backdrop-blur-xs",children:t.type.charAt(0).toUpperCase()+t.type.slice(1)})]}),a.jsx(Wt,{className:"line-clamp-2 mt-1 text-gray-300 drop-shadow-sm",children:t.description})]}),a.jsxs(Ze,{className:"pb-2",children:[a.jsxs("div",{className:"flex items-center text-sm text-gray-300 drop-shadow-sm gap-1 mb-3",children:[a.jsx(U1,{className:"h-3.5 w-3.5 mr-1 text-gray-400"}),"Created on ",g(t.created_at||t.createdAt)]}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:t&&t.products&&Array.isArray(t.products)&&t.products.length>0?t.products.slice(0,4).map(E=>a.jsxs("div",{className:"bg-white/10 p-2 rounded-md text-xs flex flex-col backdrop-blur-xs",children:[a.jsx("span",{className:"font-medium truncate text-gray-200",children:E.name||"Unnamed Product"}),a.jsxs("span",{className:"text-sky-300",children:[" ",typeof E.price=="number"?`$${E.price.toFixed(2)}`:"Price N/A"]})]},E.id)):a.jsx("p",{className:"text-xs text-gray-400 col-span-2",children:t&&t.products&&t.products.length===0?"No products yet.":"Product data unavailable."})})]}),a.jsxs(Lu,{className:"flex flex-col items-start gap-2 pt-2",children:[a.jsxs("div",{className:"flex w-full justify-between items-center",children:[a.jsx(V,{variant:"outline",size:"sm",className:"bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:()=>{t&&t.name?e(`/${nu(t.name)}`):console.error("Store name is missing, cannot navigate to preview.")},children:"Preview"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(V,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-300 hover:text-white hover:bg-white/10",onClick:()=>t&&t.name&&e(`/${nu(t.name)}?edit=true`),children:[a.jsx(_v,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Edit"})]}),a.jsxs(OEe,{children:[a.jsx(VEe,{asChild:!0,children:a.jsxs(V,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-400 hover:text-red-300 hover:bg-red-500/10",children:[a.jsx(er,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Delete"})]})}),a.jsxs(Y7,{children:[a.jsxs(J7,{children:[a.jsx(Q7,{children:"Are you sure?"}),a.jsxs(Z7,{children:['This will permanently delete the "',t.name,'" store and all its data. This action cannot be undone.']})]}),a.jsxs(X7,{children:[a.jsx(tH,{children:"Cancel"}),a.jsx(eH,{className:"bg-red-500 text-white hover:bg-red-600",onClick:()=>n(t.id),children:"Delete"})]})]})]})]})]}),a.jsxs("div",{className:"flex w-full items-center gap-2 mt-2",children:[a.jsx(nt,{type:"password",placeholder:"Set Pass Key",value:o,onChange:E=>l(E.target.value),className:"h-8 text-xs flex-grow bg-neutral-700/60 dark:bg-neutral-800/60 border-neutral-500 dark:border-neutral-600 placeholder-zinc-400 text-white focus:outline-none"}),a.jsxs(V,{variant:"outline",size:"icon",className:"h-8 w-8 bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:f,disabled:!o.trim(),children:[a.jsx(R$,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Set Pass Key"})]})]}),a.jsxs("div",{className:"w-full mt-2",children:[a.jsx(V,{variant:"outline",size:"sm",className:"w-full bg-white/10 hover:bg-white/20 text-gray-200 border-gray-500 hover:border-gray-400",onClick:()=>h(!d),children:d?"Cancel Assignment":"Assign Manager"}),d&&a.jsxs("div",{className:"flex w-full items-center gap-2 mt-2",children:[a.jsx(nt,{type:"email",placeholder:"Manager Email",value:c,onChange:E=>u(E.target.value),className:"h-8 text-xs flex-grow bg-neutral-700/60 dark:bg-neutral-800/60 border-neutral-500 dark:border-neutral-600 placeholder-zinc-400 text-white focus:outline-none"}),a.jsxs(V,{variant:"outline",size:"icon",className:"h-8 w-8 bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:()=>{m()},disabled:!c.trim(),children:[a.jsx(mie,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Confirm Assign Manager"})]})]})]})]})]})]})})},BEe=()=>{const{stores:t,loadStores:e,isLoadingStores:n}=$n(),{user:r}=qi(),s=()=>{console.log("[StoreList] handleRefreshStores called. User:",r),r&&r.uid?(console.log(`[StoreList] Calling loadStores for user UID: ${r.uid}`),e(r.uid)):console.warn("[StoreList] handleRefreshStores: No user or user.uid found, cannot refresh stores.")};return a.jsxs(Ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},className:"w-full max-w-6xl mx-auto mt-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Your Stores"}),a.jsxs(V,{onClick:s,variant:"outline",disabled:!r||n,children:[a.jsx(bv,{className:`mr-2 h-4 w-4 ${n?"animate-spin":""}`}),n?"Loading...":"Load Stores"]})]}),n&&t.length===0&&a.jsx("div",{className:"text-center py-10",children:a.jsx("p",{className:"text-muted-foreground",children:"Loading your stores..."})}),!n&&t.length===0&&a.jsx("div",{className:"text-center py-10",children:a.jsx("p",{className:"text-muted-foreground",children:"You haven't created any stores yet. Get started by generating a new store!"})}),t.length>0&&a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(i=>a.jsx(UEe,{store:i},i.id))})]})},zEe=({open:t,onOpenChange:e,onSuccessfulConnect:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState(""),{startShopifyImportWizard:l,isFetchingShopifyPreviewData:c,shopifyImportError:u,setShopifyWizardStep:d}=$n(),h=async f=>{if(f.preventDefault(),!r||!i){alert("Please enter both Shopify domain and access token.");return}await l(r,i)&&n&&n()};return a.jsx(ys,{open:t,onOpenChange:f=>{e(f)},children:a.jsxs(es,{className:"sm:max-w-[425px] sm:rounded-xl",children:[" ",a.jsxs(ts,{children:[a.jsx(ns,{children:"Connect to Shopify"}),a.jsxs(xo,{className:"text-slate-500 dark:text-slate-400",children:[" ","Enter your Shopify store domain and Storefront Access Token to begin importing."]})]}),a.jsxs("form",{onSubmit:h,className:"grid gap-4 py-4",children:[u&&a.jsx("div",{className:"col-span-4 p-2 text-sm text-red-600 bg-red-100 border border-red-300 rounded",children:u}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"domain",className:"text-right",children:"Domain"}),a.jsx(nt,{id:"domain",value:r,onChange:f=>s(f.target.value),placeholder:Ore,className:"col-span-3",disabled:c})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"token",className:"text-right",children:"Token"}),a.jsx(nt,{id:"token",type:"password",value:i,onChange:f=>o(f.target.value),placeholder:"Storefront Access Token",className:"col-span-3",disabled:c})]}),a.jsxs(Tr,{children:[a.jsx(V,{type:"button",variant:"outline",disabled:c,onClick:()=>e(!1),children:"Cancel"}),a.jsx(V,{type:"submit",disabled:c||!r||!i,children:c?a.jsxs(a.Fragment,{children:[a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}),"Connecting..."]}):"Connect & Fetch Info"})]})]})]})})},GEe=({open:t,onOpenChange:e,onSuccessfulConnect:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState("");p.useState(!1),p.useState(null),p.useState("");const{startBigCommerceImportWizard:l,bigCommerceImportError:c,isFetchingBigCommercePreviewData:u}=$n(),d=async h=>{if(h.preventDefault(),!r||!i){alert("Both Store Domain and API Token are required.");return}await l(r,i),n&&n({storeDomain:r,apiToken:i})};return t?a.jsx("div",{className:"w-full",children:a.jsxs("form",{onSubmit:d,children:[a.jsxs(Ze,{className:"space-y-4 pt-6",children:[" ",a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"bc-store-domain",children:"Store Domain"}),a.jsx(nt,{id:"bc-store-domain",type:"text",placeholder:"e.g., mystore.mybigcommerce.com",value:r,onChange:h=>s(h.target.value.trim()),disabled:u})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"bc-api-token",children:"Storefront API Token"}),a.jsx(nt,{id:"bc-api-token",type:"password",placeholder:"Enter your Storefront API Token",value:i,onChange:h=>o(h.target.value.trim()),disabled:u})]}),c&&a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(z1,{className:"mr-2 h-4 w-4"})," ",c]})]}),a.jsx(Lu,{className:"flex flex-col space-y-2",children:a.jsxs(V,{type:"submit",className:"w-full",disabled:u,children:[u?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(uo,{className:"mr-2 h-4 w-4"}),u?"Connecting...":"Connect to BigCommerce"]})})]})}):null},HEe=({isOpen:t,onClose:e,product:n,onSave:r})=>{const[s,i]=p.useState(null);if(p.useEffect(()=>{var d,h,f,m,g,x,E;if(n){const v=(h=(d=n.variants)==null?void 0:d.edges[0])==null?void 0:h.node;i({...n,name:n.title||"",price:((f=v==null?void 0:v.price)==null?void 0:f.amount)||0,currencyCode:((m=v==null?void 0:v.price)==null?void 0:m.currencyCode)||"USD",imageUrl:((E=(x=(g=n.images)==null?void 0:g.edges[0])==null?void 0:x.node)==null?void 0:E.url)||""})}else i(null)},[n]),!t||!s)return null;const o=d=>{const{name:h,value:f}=d.target;i(m=>({...m,[h]:f}))},l=d=>{const{value:h}=d.target;i(f=>({...f,price:parseFloat(h)||0}))},c=d=>{const{value:h}=d.target;i(f=>({...f,imageUrl:h}))},u=()=>{var h,f,m,g;const d={...s,title:s.name,images:{edges:[{node:{url:s.imageUrl,altText:s.name}}]},variants:{...s.variants,edges:[{node:{...((f=(h=s.variants)==null?void 0:h.edges[0])==null?void 0:f.node)||{},price:{amount:s.price,currencyCode:s.currencyCode}}},...((g=(m=s.variants)==null?void 0:m.edges)==null?void 0:g.slice(1))||[]]}};r(d),e()};return a.jsx(ys,{open:t,onOpenChange:e,children:a.jsxs(es,{className:"sm:max-w-lg",children:[a.jsxs(ts,{children:[a.jsxs(ns,{children:["Edit Product: ",n.title]}),a.jsx(xo,{children:"Make changes to the product details below."})]}),a.jsx(Gi,{className:"max-h-[60vh] p-1",children:a.jsxs("div",{className:"grid gap-4 py-4 pr-3",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"name",className:"text-right",children:"Name"}),a.jsx(nt,{id:"name",name:"name",value:s.name,onChange:o,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"description",className:"text-right",children:"Description"}),a.jsx(Ln,{id:"description",name:"description",value:s.description,onChange:o,className:"col-span-3",rows:4})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"price",className:"text-right",children:"Price"}),a.jsx(nt,{id:"price",name:"price",type:"number",value:s.price,onChange:l,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"imageUrl",className:"text-right",children:"Image URL"}),a.jsx(nt,{id:"imageUrl",name:"imageUrl",value:s.imageUrl,onChange:c,className:"col-span-3"})]})]})}),a.jsxs(Tr,{children:[a.jsx(V,{type:"button",variant:"outline",onClick:e,children:"Cancel"}),a.jsx(V,{type:"button",onClick:u,children:"Save Changes"})]})]})})},WEe=({isOpen:t,onClose:e,collection:n,onSave:r})=>{const[s,i]=p.useState(null);if(p.useEffect(()=>{i(n?{...n,name:n.title||""}:null)},[n]),!t||!s)return null;const o=c=>{const{name:u,value:d}=c.target;i(h=>({...h,[u]:d}))},l=()=>{const c={...s,title:s.name};r(c),e()};return a.jsx(ys,{open:t,onOpenChange:e,children:a.jsxs(es,{className:"sm:max-w-lg",children:[a.jsxs(ts,{children:[a.jsxs(ns,{children:["Edit Collection: ",n.title]}),a.jsx(xo,{children:"Make changes to the collection details below."})]}),a.jsx(Gi,{className:"max-h-[60vh] p-1",children:a.jsxs("div",{className:"grid gap-4 py-4 pr-3",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"name",className:"text-right",children:"Name"}),a.jsx(nt,{id:"name",name:"name",value:s.name,onChange:o,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"description",className:"text-right",children:"Description"}),a.jsx(Ln,{id:"description",name:"description",value:s.description||"",onChange:o,className:"col-span-3",rows:4})]})]})}),a.jsxs(Tr,{children:[a.jsx(V,{type:"button",variant:"outline",onClick:e,children:"Cancel"}),a.jsx(V,{type:"button",onClick:l,children:"Save Changes"})]})]})})},qEe=()=>{var c,u,d,h,f,m,g;const{shopifyPreviewMetadata:t,isFetchingShopifyPreviewData:e,shopifyImportError:n}=$n();if(e&&!t)return a.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[a.jsx(St,{className:"h-12 w-12 animate-spin text-primary mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Fetching store information..."})]});if(n&&!t)return a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-destructive",children:[a.jsx(Wp,{className:"h-12 w-12 mb-4"}),a.jsx("p",{className:"font-semibold",children:"Error Fetching Store Info"}),a.jsx("p",{className:"text-sm text-center",children:n})]});if(!t)return a.jsx("div",{className:"text-center text-muted-foreground",children:"No store metadata to display."});const{name:r,description:s,primaryDomain:i,brand:o}=t,l=((u=(c=o==null?void 0:o.logo)==null?void 0:c.image)==null?void 0:u.url)||((h=(d=o==null?void 0:o.squareLogo)==null?void 0:d.image)==null?void 0:h.url);return a.jsxs("div",{className:"w-full p-4",children:[a.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Store Preview"}),a.jsxs(Ge,{className:"mb-4",children:[a.jsx(rt,{children:a.jsxs("div",{className:"flex items-center space-x-4",children:[l?a.jsx("img",{src:l,alt:`${r} logo`,className:"h-16 w-16 object-contain rounded border"}):a.jsx("div",{className:"h-16 w-16 bg-muted rounded border flex items-center justify-center text-muted-foreground",children:a.jsx(HE,{size:32})}),a.jsxs("div",{children:[a.jsx(st,{children:r||"N/A"}),(i==null?void 0:i.host)&&a.jsx(Wt,{children:i.host})]})]})}),a.jsxs(Ze,{children:[a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[a.jsx("strong",{children:"Slogan:"})," ",(o==null?void 0:o.slogan)||"N/A"]}),a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[a.jsx("strong",{children:"Description:"})," ",s||(o==null?void 0:o.shortDescription)||"N/A"]}),((f=o==null?void 0:o.coverImage)==null?void 0:f.url)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-sm font-medium mb-1",children:"Cover Image:"}),a.jsx("img",{src:o.coverImage.url,alt:"Store cover",className:"rounded max-h-40 w-auto mx-auto border"})]})]})]}),(o==null?void 0:o.colors)&&a.jsxs(Ge,{className:"mt-4",children:[a.jsx(rt,{children:a.jsx(st,{className:"text-lg",children:"Brand Colors"})}),a.jsxs(Ze,{className:"flex space-x-4",children:[((m=o.colors.primary)==null?void 0:m.background)&&a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 rounded border mb-1",style:{backgroundColor:o.colors.primary.background},title:`Primary Background: ${o.colors.primary.background}`}),a.jsx("p",{className:"text-xs",children:"Primary BG"}),o.colors.primary.foreground&&a.jsx("div",{className:"w-16 h-8 rounded border mt-1",style:{backgroundColor:o.colors.primary.foreground},title:`Primary Foreground: ${o.colors.primary.foreground}`}),o.colors.primary.foreground&&a.jsx("p",{className:"text-xs mt-1",children:"Primary FG"})]}),((g=o.colors.secondary)==null?void 0:g.background)&&a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 rounded border mb-1",style:{backgroundColor:o.colors.secondary.background},title:`Secondary Background: ${o.colors.secondary.background}`}),a.jsx("p",{className:"text-xs",children:"Secondary BG"}),o.colors.secondary.foreground&&a.jsx("div",{className:"w-16 h-8 rounded border mt-1",style:{backgroundColor:o.colors.secondary.foreground},title:`Secondary Foreground: ${o.colors.secondary.foreground}`}),o.colors.secondary.foreground&&a.jsx("p",{className:"text-xs mt-1",children:"Secondary FG"})]})]})]})]})},KEe=()=>{var B,K,ee,H,X,O;const{shopifyPreviewProducts:t,shopifyPreviewCollections:e,fetchShopifyWizardProducts:n,fetchShopifyWizardCollections:r,isFetchingShopifyPreviewData:s,shopifyImportError:i,shopifyPreviewMetadata:o,generatedLogoImage:l,isGeneratingLogo:c,logoGenerationError:u,generateShopifyStoreLogo:d,updateShopifyPreviewProduct:h,updateShopifyPreviewCollection:f}=$n(),[m,g]=p.useState(!1),[x,E]=p.useState(null),[v,_]=p.useState(!1),[S,I]=p.useState(null),M=z=>{E(z),g(!0)},j=()=>{g(!1),E(null)},C=z=>{h(z)},T=z=>{I(z),_(!0)},P=()=>{_(!1),I(null)},A=z=>{f(z)},D=()=>{t.pageInfo.hasNextPage&&n(10,t.pageInfo.endCursor)},R=()=>{e.pageInfo.hasNextPage&&r(10,e.pageInfo.endCursor)},k=(o==null?void 0:o.name)||"Your Store",U=((ee=(K=(B=o==null?void 0:o.brand)==null?void 0:B.logo)==null?void 0:K.image)==null?void 0:ee.url)||((O=(X=(H=o==null?void 0:o.brand)==null?void 0:H.squareLogo)==null?void 0:X.image)==null?void 0:O.url);return a.jsxs("div",{className:"w-full p-4 space-y-6",children:[a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Generate Store Logo"}),a.jsxs(Wt,{children:['Optionally, generate a new logo for "',k,'" using AI. The generated logo will be used for your new store if you proceed.']})]}),a.jsxs(Ze,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Current Shopify Logo (if any):"}),U?a.jsx("img",{src:U,alt:`${k} current logo`,className:"h-48 w-auto object-contain"}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No logo found in Shopify data."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Generated Logo Preview:"}),c&&a.jsxs("div",{className:"h-48 w-full flex items-center justify-center",children:[a.jsx(St,{className:"h-12 w-12 animate-spin text-primary"})," "]}),!c&&l&&a.jsx("div",{className:"h-48 w-auto flex items-center justify-center",children:a.jsx("img",{src:l,alt:`${k} AI generated logo`,className:"h-full w-auto object-contain"})}),!c&&!l&&a.jsxs("div",{className:"h-48 w-full flex items-center justify-center text-muted-foreground",children:[a.jsx(HE,{className:"h-12 w-12 mr-2"})," ",a.jsx("span",{children:"Logo will appear here"})]})]})]}),a.jsxs(V,{onClick:d,disabled:c||!(o!=null&&o.name),className:"w-full md:w-auto",children:[c?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Xr,{className:"mr-2 h-4 w-4"}),"Generate New Logo with AI"]}),u&&a.jsxs("p",{className:"text-sm text-destructive text-center mt-2",children:[a.jsx(Wp,{className:"inline h-4 w-4 mr-1"}),u]}),!(o!=null&&o.name)&&a.jsx("p",{className:"text-sm text-amber-600 text-center mt-2",children:"Store name from Shopify is required to generate a logo."})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Products (",t.edges.length," loaded)"]}),i&&i.includes("products")&&a.jsx("p",{className:"text-destructive text-sm mb-2",children:i}),a.jsxs(Gi,{className:"h-60 border rounded p-2",children:[t.edges.length===0&&!s&&a.jsx("p",{className:"text-muted-foreground text-sm p-2",children:"No products loaded yet or none found."}),t.edges.map(({node:z})=>{var Y,F,ye,Se,De,xe,Me,Ye,qe;return a.jsx("div",{className:"p-3 border-b last:border-b-0",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[((ye=(F=(Y=z.images)==null?void 0:Y.edges[0])==null?void 0:F.node)==null?void 0:ye.url)&&a.jsx("img",{src:z.images.edges[0].node.url,alt:z.title,className:"h-16 w-16 rounded object-cover border"}),!((xe=(De=(Se=z.images)==null?void 0:Se.edges[0])==null?void 0:De.node)!=null&&xe.url)&&a.jsx("div",{className:"h-16 w-16 bg-muted rounded border flex items-center justify-center text-muted-foreground",children:a.jsx(HE,{size:24})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm",children:z.title}),((qe=(Ye=(Me=z.variants)==null?void 0:Me.edges[0])==null?void 0:Ye.node)==null?void 0:qe.price)&&a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Price: ",z.variants.edges[0].node.price.amount," ",z.variants.edges[0].node.price.currencyCode]}),z.description&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1 truncate",title:z.description,children:["Desc: ",z.description.substring(0,50),z.description.length>50?"...":""]}),z.tags&&z.tags.length>0&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Tags: ",z.tags.join(", ")]})]}),a.jsx(V,{variant:"ghost",size:"sm",onClick:()=>M(z),className:"ml-auto",children:a.jsx(wv,{className:"h-4 w-4"})})]})},z.id)}),s&&t.pageInfo.hasNextPage&&a.jsx("div",{className:"flex justify-center py-2",children:a.jsx(St,{className:"h-5 w-5 animate-spin"})})]}),t.pageInfo.hasNextPage&&a.jsx(V,{onClick:D,disabled:s,className:"mt-2 w-full",children:s?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):"Load More Products"}),!t.pageInfo.hasNextPage&&t.edges.length>0&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"All products loaded."})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Collections (",e.edges.length," loaded)"]}),i&&i.includes("collections")&&a.jsx("p",{className:"text-destructive text-sm mb-2",children:i}),a.jsxs(Gi,{className:"h-60 border rounded p-2",children:[e.edges.length===0&&!s&&a.jsx("p",{className:"text-muted-foreground text-sm p-2",children:"No collections loaded yet or none found."}),e.edges.map(({node:z})=>a.jsxs("div",{className:"p-2 border-b text-sm flex justify-between items-center",children:[a.jsx("span",{children:z.title}),a.jsx(V,{variant:"ghost",size:"sm",onClick:()=>T(z),children:a.jsx(wv,{className:"h-4 w-4"})})]},z.id)),s&&e.pageInfo.hasNextPage&&a.jsx("div",{className:"flex justify-center py-2",children:a.jsx(St,{className:"h-5 w-5 animate-spin"})})]}),e.pageInfo.hasNextPage&&a.jsx(V,{onClick:R,disabled:s,className:"mt-2 w-full",children:s?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):"Load More Collections"}),!e.pageInfo.hasNextPage&&e.edges.length>0&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"All collections loaded."})]})]}),x&&a.jsx(HEe,{isOpen:m,onClose:j,product:x,onSave:C}),S&&a.jsx(WEe,{isOpen:v,onClose:P,collection:S,onSave:A})]})},YEe=()=>{var r,s;const{bigCommercePreviewSettings:t,isFetchingBigCommercePreviewData:e,bigCommerceImportError:n}=$n();return e&&!t?a.jsxs("div",{className:"flex items-center justify-center p-8",children:[a.jsx(St,{className:"h-8 w-8 animate-spin"})," ",a.jsx("span",{className:"ml-2",children:"Fetching store settings..."})]}):n&&!t?a.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error: ",n]}):t?a.jsxs(Ge,{className:"w-full",children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Store Settings Preview (BigCommerce)"}),a.jsx(Wt,{children:"Review your BigCommerce store's basic information."})]}),a.jsxs(Ze,{className:"space-y-2",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Store Name:"})," ",t.storeName||"N/A"]}),((s=(r=t.logo)==null?void 0:r.image)==null?void 0:s.url)&&a.jsxs("div",{children:[a.jsx("strong",{children:"Logo:"}),a.jsx("img",{src:t.logo.image.url,alt:t.logo.image.altText||"Store Logo",className:"mt-2 max-w-xs max-h-24 object-contain border rounded"})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Store Hash:"})," ",t.storeHash||"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Status:"})," ",t.status||"N/A"]})]})]}):a.jsx("div",{className:"text-center p-4",children:"Connect to BigCommerce to see store settings, or settings are being fetched."})},JEe=()=>{const{bigCommercePreviewProducts:t,fetchBigCommerceWizardProducts:e,isFetchingBigCommercePreviewData:n,bigCommerceImportError:r}=$n(),s=(t==null?void 0:t.items)||[];return n&&s.length===0?a.jsxs("div",{className:"flex items-center justify-center p-8",children:[a.jsx(St,{className:"h-8 w-8 animate-spin"})," ",a.jsx("span",{className:"ml-2",children:"Fetching products..."})]}):r&&s.length===0?a.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error fetching products: ",r]}):s.length===0?a.jsxs("div",{className:"text-center p-4",children:[a.jsx("p",{className:"mb-4",children:"No products loaded yet for BigCommerce."}),a.jsxs(V,{onClick:()=>e(10),disabled:n,children:[n?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Load Products Preview"]})]}):a.jsxs(Ge,{className:"w-full",children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Products Preview (BigCommerce)"}),a.jsx(Wt,{children:"A sample of products from your BigCommerce store."})]}),a.jsxs(Ze,{children:[a.jsx("ul",{className:"space-y-2 max-h-96 overflow-y-auto",children:s.slice(0,10).map(i=>{var o,l,c,u,d;return a.jsxs("li",{className:"p-2 border rounded text-sm flex justify-between items-center",children:[a.jsxs("div",{children:[i.name," - ",(l=(o=i.prices)==null?void 0:o.price)==null?void 0:l.value," ",(u=(c=i.prices)==null?void 0:c.price)==null?void 0:u.currencyCode]}),((d=i.defaultImage)==null?void 0:d.url)&&a.jsx("img",{src:i.defaultImage.url,alt:i.defaultImage.altText||i.name,className:"w-12 h-12 object-cover rounded ml-2"})]},i.entityId)})}),s.length>10&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Showing 10 of ",s.length," products fetched for preview."]})]})]})},XEe=({isOpen:t,onClose:e,initialImportSource:n="shopify"})=>{const[r,s]=p.useState(n),i=$n(),o={shopify:{wizardStep:i.shopifyWizardStep,setWizardStep:i.setShopifyWizardStep,resetWizardState:i.resetShopifyWizardState,previewMetadata:i.shopifyPreviewMetadata,previewProducts:i.shopifyPreviewProducts,previewCollections:i.shopifyPreviewCollections,isFetchingPreviewData:i.isFetchingShopifyPreviewData,importError:i.shopifyImportError,fetchWizardProducts:i.fetchShopifyWizardProducts,fetchWizardCollections:i.fetchShopifyWizardCollections,finalizeImportFromWizard:i.finalizeShopifyImportFromWizard,ConnectFormComponent:zEe,MetadataPreviewComponent:qEe,ItemsPreviewComponent:KEe,totalSteps:4},bigcommerce:{wizardStep:i.bigCommerceWizardStep,setWizardStep:i.setBigCommerceWizardStep,resetWizardState:i.resetBigCommerceWizardState,previewMetadata:i.bigCommercePreviewSettings,previewProducts:i.bigCommercePreviewProducts,isFetchingPreviewData:i.isFetchingBigCommercePreviewData,importError:i.bigCommerceImportError,fetchWizardProducts:i.fetchBigCommerceWizardProducts,finalizeImportFromWizard:i.finalizeBigCommerceImportFromWizard,ConnectFormComponent:GEe,MetadataPreviewComponent:YEe,ItemsPreviewComponent:JEe,totalSteps:4}},l=o[r],{wizardStep:c,setWizardStep:u,resetWizardState:d,previewMetadata:h,previewProducts:f,previewCollections:m,isFetchingPreviewData:g,importError:x,fetchWizardProducts:E,fetchWizardCollections:v,finalizeImportFromWizard:_,ConnectFormComponent:S,MetadataPreviewComponent:I,ItemsPreviewComponent:M,totalSteps:j}=l,{isGenerating:C}=i;if(p.useEffect(()=>{s(n),n==="shopify"&&o.bigcommerce.resetWizardState(),n==="bigcommerce"&&o.shopify.resetWizardState()},[n]),p.useEffect(()=>{t&&c===0&&u(1),!t&&c!==0&&d()},[t,c,u,d]),!t||c===0)return null;const T=async()=>{c<j&&(r==="shopify"?c===2?((!f||f.edges.length===0)&&await E(10),(!m||m.edges.length===0)&&await v(10),u(3)):c===3&&await D():r==="bigcommerce"&&(c===1||(c===2?((!f||f.items.length===0)&&await E(10),u(3)):c===3&&await D())))},P=()=>{c>1&&u(c-1)},A=()=>{d(),e&&e()},D=async()=>{await _()&&e&&e()},R=()=>{switch(c){case 1:return a.jsx(S,{open:c===1,onOpenChange:U=>{U||A()},onSuccessfulConnect:U=>{r==="shopify"&&i.startShopifyImportWizard(U.domain,U.token)}});case 2:return a.jsx(I,{});case 3:return a.jsx(M,{});default:return c===j&&C?a.jsxs("div",{className:"flex flex-col items-center justify-center p-8",children:[a.jsx(St,{className:"h-8 w-8 animate-spin mb-4"})," ",a.jsx("p",{children:"Finalizing import, please wait..."})]}):a.jsxs("div",{children:["Invalid Wizard Step or Finalizing... (",c,")"]})}};if(c===1&&r==="shopify")return R();const k=r==="shopify"?"Import from Shopify":r==="bigcommerce"?"Import from BigCommerce":"Import Store Data";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs(Ge,{className:"w-full max-w-2xl mx-auto shadow-xl",children:[a.jsxs(rt,{children:[a.jsx(st,{className:"text-2xl font-bold",children:c===1&&r==="bigcommerce"?"Connect to BigCommerce":k}),a.jsx(Wt,{children:c===1&&r==="bigcommerce"?"Enter your store domain and API token.":`Step ${c} of ${j}`}),a.jsx("div",{className:"w-full bg-muted rounded-full h-2.5 mt-2",children:a.jsx(Ct.div,{className:"bg-primary h-2.5 rounded-full",initial:{width:"0%"},animate:{width:`${c/j*100}%`},transition:{duration:.5,ease:"easeInOut"}})})]}),a.jsx(Ze,{className:"min-h-[250px] flex items-center justify-center",children:R()}),a.jsxs(Lu,{className:"flex justify-between",children:[c>1&&a.jsxs(V,{variant:"outline",onClick:A,disabled:C||g,children:[a.jsx(z1,{className:"mr-2 h-4 w-4"})," Cancel"]}),a.jsxs("div",{children:[c>1&&c<j&&a.jsxs(V,{variant:"outline",onClick:P,disabled:C||g,className:"mr-2",children:[a.jsx(Vl,{className:"mr-2 h-4 w-4"})," Previous"]}),c===1&&r==="bigcommerce"&&a.jsxs(V,{onClick:T,disabled:C||g,children:["Next ",a.jsx(cp,{className:"ml-2 h-4 w-4"})]}),c===2&&a.jsxs(V,{onClick:T,disabled:C||g,children:["Next ",a.jsx(cp,{className:"ml-2 h-4 w-4"})]}),c===3&&a.jsxs(V,{onClick:D,disabled:C||g,children:[C?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(uo,{className:"mr-2 h-4 w-4"}),"Finalize Import"]}),c===j&&C&&a.jsxs(V,{disabled:!0,children:[a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]})]})]})]})})},QEe=({onSelectSource:t,onClose:e})=>a.jsxs(Ge,{className:"w-full max-w-md mx-auto relative",children:[" ",a.jsx(V,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 text-muted-foreground hover:text-foreground",onClick:e,children:a.jsx(zo,{className:"h-5 w-5"})}),a.jsxs(rt,{children:[a.jsx(st,{children:"Import Store Data"}),a.jsxs(Wt,{className:"text-slate-500 dark:text-slate-400",children:[" ","Select your e-commerce platform to begin importing your store and product data."]})]}),a.jsx(Ze,{children:a.jsxs(Ei,{defaultValue:"shopify",className:"w-full",children:[a.jsxs(Qs,{className:"grid w-full grid-cols-2",children:[a.jsx(Bt,{value:"shopify",children:"Shopify"}),a.jsx(Bt,{value:"bigcommerce",children:"BigCommerce"})]}),a.jsxs(zt,{value:"shopify",className:"mt-4",children:[a.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:[" ","Connect to your Shopify store to import your shop details, products, and collections."]}),a.jsx(V,{className:"w-full",onClick:()=>t("shopify"),children:"Connect Shopify"})]}),a.jsxs(zt,{value:"bigcommerce",className:"mt-4",children:[a.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:[" ","Connect to your BigCommerce store to import your store settings and product catalog."]}),a.jsx(V,{className:"w-full",onClick:()=>t("bigcommerce"),children:"Connect BigCommerce"})]})]})}),a.jsx(Lu,{children:a.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[" ","You will be guided through a few steps to connect and confirm the data to be imported."]})})]}),ZEe="modulepreload",eCe=function(t){return"/"+t},H4={},jt=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=eCe(i),i in H4)return;H4[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const h=s[d];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":ZEe,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};function yn(){return yn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yn.apply(null,arguments)}function W4(t,[e,n]){return Math.min(n,Math.max(e,t))}function $r(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function zP(t,e=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];function u(h){const{scope:f,children:m,...g}=h,x=(f==null?void 0:f[t][c])||l,E=p.useMemo(()=>g,Object.values(g));return p.createElement(x.Provider,{value:E},m)}function d(h,f){const m=(f==null?void 0:f[t][c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,d]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return p.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,tCe(s,...e)]}function tCe(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function nCe(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function nH(...t){return e=>t.forEach(n=>nCe(n,e))}function xs(...t){return p.useCallback(nH(...t),t)}const Lp=p.forwardRef((t,e)=>{const{children:n,...r}=t,s=p.Children.toArray(n),i=s.find(sCe);if(i){const o=i.props.children,l=s.map(c=>c===i?p.Children.count(o)>1?p.Children.only(null):p.isValidElement(o)?o.props.children:null:c);return p.createElement(mT,yn({},r,{ref:e}),p.isValidElement(o)?p.cloneElement(o,void 0,l):null)}return p.createElement(mT,yn({},r,{ref:e}),n)});Lp.displayName="Slot";const mT=p.forwardRef((t,e)=>{const{children:n,...r}=t;return p.isValidElement(n)?p.cloneElement(n,{...iCe(r,n.props),ref:e?nH(e,n.ref):n.ref}):p.Children.count(n)>1?p.Children.only(null):null});mT.displayName="SlotClone";const rCe=({children:t})=>p.createElement(p.Fragment,null,t);function sCe(t){return p.isValidElement(t)&&t.type===rCe}function iCe(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{i(...l),s(...l)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function oCe(t){const e=t+"CollectionProvider",[n,r]=zP(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=m=>{const{scope:g,children:x}=m,E=ct.useRef(null),v=ct.useRef(new Map).current;return ct.createElement(s,{scope:g,itemMap:v,collectionRef:E},x)},l=t+"CollectionSlot",c=ct.forwardRef((m,g)=>{const{scope:x,children:E}=m,v=i(l,x),_=xs(g,v.collectionRef);return ct.createElement(Lp,{ref:_},E)}),u=t+"CollectionItemSlot",d="data-radix-collection-item",h=ct.forwardRef((m,g)=>{const{scope:x,children:E,...v}=m,_=ct.useRef(null),S=xs(g,_),I=i(u,x);return ct.useEffect(()=>(I.itemMap.set(_,{ref:_,...v}),()=>void I.itemMap.delete(_))),ct.createElement(Lp,{[d]:"",ref:S},E)});function f(m){const g=i(t+"CollectionConsumer",m);return ct.useCallback(()=>{const E=g.collectionRef.current;if(!E)return[];const v=Array.from(E.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((I,M)=>v.indexOf(I.ref.current)-v.indexOf(M.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:o,Slot:c,ItemSlot:h},f,r]}const aCe=p.createContext(void 0);function lCe(t){const e=p.useContext(aCe);return t||e||"ltr"}const cCe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],vs=cCe.reduce((t,e)=>{const n=p.forwardRef((r,s)=>{const{asChild:i,...o}=r,l=i?Lp:e;return p.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),p.createElement(l,yn({},o,{ref:s}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function uCe(t,e){t&&ja.flushSync(()=>t.dispatchEvent(e))}function Ra(t){const e=p.useRef(t);return p.useEffect(()=>{e.current=t}),p.useMemo(()=>(...n)=>{var r;return(r=e.current)===null||r===void 0?void 0:r.call(e,...n)},[])}function dCe(t,e=globalThis==null?void 0:globalThis.document){const n=Ra(t);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r),()=>e.removeEventListener("keydown",r)},[n,e])}const pT="dismissableLayer.update",hCe="dismissableLayer.pointerDownOutside",fCe="dismissableLayer.focusOutside";let q4;const mCe=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),pCe=p.forwardRef((t,e)=>{var n;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:l,onDismiss:c,...u}=t,d=p.useContext(mCe),[h,f]=p.useState(null),m=(n=h==null?void 0:h.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,g]=p.useState({}),x=xs(e,T=>f(T)),E=Array.from(d.layers),[v]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),_=E.indexOf(v),S=h?E.indexOf(h):-1,I=d.layersWithOutsidePointerEventsDisabled.size>0,M=S>=_,j=gCe(T=>{const P=T.target,A=[...d.branches].some(D=>D.contains(P));!M||A||(i==null||i(T),l==null||l(T),T.defaultPrevented||c==null||c())},m),C=yCe(T=>{const P=T.target;[...d.branches].some(D=>D.contains(P))||(o==null||o(T),l==null||l(T),T.defaultPrevented||c==null||c())},m);return dCe(T=>{S===d.layers.size-1&&(s==null||s(T),!T.defaultPrevented&&c&&(T.preventDefault(),c()))},m),p.useEffect(()=>{if(h)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(q4=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(h)),d.layers.add(h),K4(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=q4)}},[h,m,r,d]),p.useEffect(()=>()=>{h&&(d.layers.delete(h),d.layersWithOutsidePointerEventsDisabled.delete(h),K4())},[h,d]),p.useEffect(()=>{const T=()=>g({});return document.addEventListener(pT,T),()=>document.removeEventListener(pT,T)},[]),p.createElement(vs.div,yn({},u,{ref:x,style:{pointerEvents:I?M?"auto":"none":void 0,...t.style},onFocusCapture:$r(t.onFocusCapture,C.onFocusCapture),onBlurCapture:$r(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:$r(t.onPointerDownCapture,j.onPointerDownCapture)}))});function gCe(t,e=globalThis==null?void 0:globalThis.document){const n=Ra(t),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let u=function(){rH(hCe,n,c,{discrete:!0})};const c={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=u,e.addEventListener("click",s.current,{once:!0})):u()}r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function yCe(t,e=globalThis==null?void 0:globalThis.document){const n=Ra(t),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&rH(fCe,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function K4(){const t=new CustomEvent(pT);document.dispatchEvent(t)}function rH(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?uCe(s,i):s.dispatchEvent(i)}let gS=0;function xCe(){p.useEffect(()=>{var t,e;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=n[0])!==null&&t!==void 0?t:Y4()),document.body.insertAdjacentElement("beforeend",(e=n[1])!==null&&e!==void 0?e:Y4()),gS++,()=>{gS===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),gS--}},[])}function Y4(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}const yS="focusScope.autoFocusOnMount",xS="focusScope.autoFocusOnUnmount",J4={bubbles:!1,cancelable:!0},vCe=p.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[l,c]=p.useState(null),u=Ra(s),d=Ra(i),h=p.useRef(null),f=xs(e,x=>c(x)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let x=function(S){if(m.paused||!l)return;const I=S.target;l.contains(I)?h.current=I:tl(h.current,{select:!0})},E=function(S){if(m.paused||!l)return;const I=S.relatedTarget;I!==null&&(l.contains(I)||tl(h.current,{select:!0}))},v=function(S){const I=document.activeElement;for(const M of S)M.removedNodes.length>0&&(l!=null&&l.contains(I)||tl(l))};document.addEventListener("focusin",x),document.addEventListener("focusout",E);const _=new MutationObserver(v);return l&&_.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",E),_.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){Q4.add(m);const x=document.activeElement;if(!l.contains(x)){const v=new CustomEvent(yS,J4);l.addEventListener(yS,u),l.dispatchEvent(v),v.defaultPrevented||(wCe(CCe(sH(l)),{select:!0}),document.activeElement===x&&tl(l))}return()=>{l.removeEventListener(yS,u),setTimeout(()=>{const v=new CustomEvent(xS,J4);l.addEventListener(xS,d),l.dispatchEvent(v),v.defaultPrevented||tl(x??document.body,{select:!0}),l.removeEventListener(xS,d),Q4.remove(m)},0)}}},[l,u,d,m]);const g=p.useCallback(x=>{if(!n&&!r||m.paused)return;const E=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,v=document.activeElement;if(E&&v){const _=x.currentTarget,[S,I]=_Ce(_);S&&I?!x.shiftKey&&v===I?(x.preventDefault(),n&&tl(S,{select:!0})):x.shiftKey&&v===S&&(x.preventDefault(),n&&tl(I,{select:!0})):v===_&&x.preventDefault()}},[n,r,m.paused]);return p.createElement(vs.div,yn({tabIndex:-1},o,{ref:f,onKeyDown:g}))});function wCe(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(tl(r,{select:e}),document.activeElement!==n)return}function _Ce(t){const e=sH(t),n=X4(e,t),r=X4(e.reverse(),t);return[n,r]}function sH(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function X4(t,e){for(const n of t)if(!bCe(n,{upTo:e}))return n}function bCe(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function SCe(t){return t instanceof HTMLInputElement&&"select"in t}function tl(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&SCe(t)&&e&&t.select()}}const Q4=ECe();function ECe(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=Z4(t,e),t.unshift(e)},remove(e){var n;t=Z4(t,e),(n=t[0])===null||n===void 0||n.resume()}}}function Z4(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function CCe(t){return t.filter(e=>e.tagName!=="A")}const Hi=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},TCe=Tw["useId".toString()]||(()=>{});let ICe=0;function iH(t){const[e,n]=p.useState(TCe());return Hi(()=>{t||n(r=>r??String(ICe++))},[t]),t||(e?`radix-${e}`:"")}function NCe(t){const[e,n]=p.useState(void 0);return Hi(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}const oH="Popper",[aH,lH]=zP(oH),[PCe,cH]=aH(oH),ACe=t=>{const{__scopePopper:e,children:n}=t,[r,s]=p.useState(null);return p.createElement(PCe,{scope:e,anchor:r,onAnchorChange:s},n)},RCe="PopperAnchor",kCe=p.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=cH(RCe,n),o=p.useRef(null),l=xs(e,o);return p.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:p.createElement(vs.div,yn({},s,{ref:l}))}),uH="PopperContent",[jCe,zke]=aH(uH),DCe=p.forwardRef((t,e)=>{var n,r,s,i,o,l,c,u;const{__scopePopper:d,side:h="bottom",sideOffset:f=0,align:m="center",alignOffset:g=0,arrowPadding:x=0,collisionBoundary:E=[],collisionPadding:v=0,sticky:_="partial",hideWhenDetached:S=!1,avoidCollisions:I=!0,onPlaced:M,...j}=t,C=cH(uH,d),[T,P]=p.useState(null),A=xs(e,Le=>P(Le)),[D,R]=p.useState(null),k=NCe(D),U=(n=k==null?void 0:k.width)!==null&&n!==void 0?n:0,B=(r=k==null?void 0:k.height)!==null&&r!==void 0?r:0,K=h+(m!=="center"?"-"+m:""),ee=typeof v=="number"?v:{top:0,right:0,bottom:0,left:0,...v},H=Array.isArray(E)?E:[E],X=H.length>0,O={padding:ee,boundary:H.filter(MCe),altBoundary:X},{refs:z,floatingStyles:Y,placement:F,isPositioned:ye,middlewareData:Se}=u8({strategy:"fixed",placement:K,whileElementsMounted:l8,elements:{reference:C.anchor},middleware:[d8({mainAxis:f+B,alignmentAxis:g}),I&&h8({mainAxis:!0,crossAxis:!1,limiter:_==="partial"?f8():void 0,...O}),I&&m8({...O}),p8({...O,apply:({elements:Le,rects:ve,availableWidth:Je,availableHeight:Xe})=>{const{width:kt,height:Gt}=ve.reference,fn=Le.floating.style;fn.setProperty("--radix-popper-available-width",`${Je}px`),fn.setProperty("--radix-popper-available-height",`${Xe}px`),fn.setProperty("--radix-popper-anchor-width",`${kt}px`),fn.setProperty("--radix-popper-anchor-height",`${Gt}px`)}}),D&&y8({element:D,padding:x}),LCe({arrowWidth:U,arrowHeight:B}),S&&g8({strategy:"referenceHidden"})]}),[De,xe]=dH(F),Me=Ra(M);Hi(()=>{ye&&(Me==null||Me())},[ye,Me]);const Ye=(s=Se.arrow)===null||s===void 0?void 0:s.x,qe=(i=Se.arrow)===null||i===void 0?void 0:i.y,et=((o=Se.arrow)===null||o===void 0?void 0:o.centerOffset)!==0,[We,mt]=p.useState();return Hi(()=>{T&&mt(window.getComputedStyle(T).zIndex)},[T]),p.createElement("div",{ref:z.setFloating,"data-radix-popper-content-wrapper":"",style:{...Y,transform:ye?Y.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:We,"--radix-popper-transform-origin":[(l=Se.transformOrigin)===null||l===void 0?void 0:l.x,(c=Se.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:t.dir},p.createElement(jCe,{scope:d,placedSide:De,onArrowChange:R,arrowX:Ye,arrowY:qe,shouldHideArrow:et},p.createElement(vs.div,yn({"data-side":De,"data-align":xe},j,{ref:A,style:{...j.style,animation:ye?void 0:"none",opacity:(u=Se.hide)!==null&&u!==void 0&&u.referenceHidden?0:void 0}}))))});function MCe(t){return t!==null}const LCe=t=>({name:"transformOrigin",options:t,fn(e){var n,r,s,i,o;const{placement:l,rects:c,middlewareData:u}=e,h=((n=u.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,f=h?0:t.arrowWidth,m=h?0:t.arrowHeight,[g,x]=dH(l),E={start:"0%",center:"50%",end:"100%"}[x],v=((r=(s=u.arrow)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:0)+f/2,_=((i=(o=u.arrow)===null||o===void 0?void 0:o.y)!==null&&i!==void 0?i:0)+m/2;let S="",I="";return g==="bottom"?(S=h?E:`${v}px`,I=`${-m}px`):g==="top"?(S=h?E:`${v}px`,I=`${c.floating.height+m}px`):g==="right"?(S=`${-m}px`,I=h?E:`${_}px`):g==="left"&&(S=`${c.floating.width+m}px`,I=h?E:`${_}px`),{data:{x:S,y:I}}}});function dH(t){const[e,n="center"]=t.split("-");return[e,n]}const FCe=ACe,OCe=kCe,VCe=DCe,$Ce=p.forwardRef((t,e)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...s}=t;return r?C1.createPortal(p.createElement(vs.div,yn({},s,{ref:e})),r):null});function eL({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=UCe({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,l=Ra(n),c=p.useCallback(u=>{if(i){const h=typeof u=="function"?u(t):u;h!==t&&l(h)}else s(u)},[i,t,s,l]);return[o,c]}function UCe({defaultProp:t,onChange:e}){const n=p.useState(t),[r]=n,s=p.useRef(r),i=Ra(e);return p.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}function BCe(t){const e=p.useRef({value:t,previous:t});return p.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}function zCe(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function GCe(...t){return e=>t.forEach(n=>zCe(n,e))}const hH=p.forwardRef((t,e)=>{const{children:n,...r}=t,s=p.Children.toArray(n),i=s.find(WCe);if(i){const o=i.props.children,l=s.map(c=>c===i?p.Children.count(o)>1?p.Children.only(null):p.isValidElement(o)?o.props.children:null:c);return p.createElement(gT,yn({},r,{ref:e}),p.isValidElement(o)?p.cloneElement(o,void 0,l):null)}return p.createElement(gT,yn({},r,{ref:e}),n)});hH.displayName="Slot";const gT=p.forwardRef((t,e)=>{const{children:n,...r}=t;return p.isValidElement(n)?p.cloneElement(n,{...qCe(r,n.props),ref:e?GCe(e,n.ref):n.ref}):p.Children.count(n)>1?p.Children.only(null):null});gT.displayName="SlotClone";const HCe=({children:t})=>p.createElement(p.Fragment,null,t);function WCe(t){return p.isValidElement(t)&&t.type===HCe}function qCe(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{i(...l),s(...l)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}const KCe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],YCe=KCe.reduce((t,e)=>{const n=p.forwardRef((r,s)=>{const{asChild:i,...o}=r,l=i?hH:e;return p.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),p.createElement(l,yn({},o,{ref:s}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{}),JCe=p.forwardRef((t,e)=>p.createElement(YCe.span,yn({},t,{ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}})));var fH=q$(),vS=function(){},S_=p.forwardRef(function(t,e){var n=p.useRef(null),r=p.useState({onScrollCapture:vS,onWheelCapture:vS,onTouchMoveCapture:vS}),s=r[0],i=r[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,m=t.noIsolation,g=t.inert,x=t.allowPinchZoom,E=t.as,v=E===void 0?"div":E,_=Wh(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),S=f,I=W$([n,e]),M=fs(fs({},_),s);return p.createElement(p.Fragment,null,d&&p.createElement(S,{sideCar:fH,removeScrollBar:u,shards:h,noIsolation:m,inert:g,setCallbacks:i,allowPinchZoom:!!x,lockRef:n}),o?p.cloneElement(p.Children.only(l),fs(fs({},M),{ref:I})):p.createElement(v,fs({},M,{className:c,ref:I}),l))});S_.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};S_.classNames={fullWidth:vm,zeroRight:xm};var yT=!1;if(typeof window<"u")try{var zy=Object.defineProperty({},"passive",{get:function(){return yT=!0,!0}});window.addEventListener("test",zy,zy),window.removeEventListener("test",zy,zy)}catch{yT=!1}var od=yT?{passive:!1}:!1,XCe=function(t){return t.tagName==="TEXTAREA"},mH=function(t,e){var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!XCe(t)&&n[e]==="visible")},QCe=function(t){return mH(t,"overflowY")},ZCe=function(t){return mH(t,"overflowX")},tL=function(t,e){var n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=pH(t,n);if(r){var s=gH(t,n),i=s[1],o=s[2];if(i>o)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},eTe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},tTe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},pH=function(t,e){return t==="v"?QCe(e):ZCe(e)},gH=function(t,e){return t==="v"?eTe(e):tTe(e)},nTe=function(t,e){return t==="h"&&e==="rtl"?-1:1},rTe=function(t,e,n,r,s){var i=nTe(t,window.getComputedStyle(e).direction),o=i*r,l=n.target,c=e.contains(l),u=!1,d=o>0,h=0,f=0;do{var m=gH(t,l),g=m[0],x=m[1],E=m[2],v=x-E-i*g;(g||v)&&pH(t,l)&&(h+=v,f+=g),l=l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&(s&&h===0||!s&&o>h)||!d&&(s&&f===0||!s&&-o>f))&&(u=!0),u},Gy=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},nL=function(t){return[t.deltaX,t.deltaY]},rL=function(t){return t&&"current"in t?t.current:t},sTe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},iTe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},oTe=0,ad=[];function aTe(t){var e=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(oTe++)[0],i=p.useState(function(){return H1()})[0],o=p.useRef(t);p.useEffect(function(){o.current=t},[t]),p.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var x=H$([t.lockRef.current],(t.shards||[]).map(rL),!0).filter(Boolean);return x.forEach(function(E){return E.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),x.forEach(function(E){return E.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=p.useCallback(function(x,E){if("touches"in x&&x.touches.length===2)return!o.current.allowPinchZoom;var v=Gy(x),_=n.current,S="deltaX"in x?x.deltaX:_[0]-v[0],I="deltaY"in x?x.deltaY:_[1]-v[1],M,j=x.target,C=Math.abs(S)>Math.abs(I)?"h":"v";if("touches"in x&&C==="h"&&j.type==="range")return!1;var T=tL(C,j);if(!T)return!0;if(T?M=C:(M=C==="v"?"h":"v",T=tL(C,j)),!T)return!1;if(!r.current&&"changedTouches"in x&&(S||I)&&(r.current=M),!M)return!0;var P=r.current||M;return rTe(P,E,x,P==="h"?S:I,!0)},[]),c=p.useCallback(function(x){var E=x;if(!(!ad.length||ad[ad.length-1]!==i)){var v="deltaY"in E?nL(E):Gy(E),_=e.current.filter(function(M){return M.name===E.type&&M.target===E.target&&sTe(M.delta,v)})[0];if(_&&_.should){E.cancelable&&E.preventDefault();return}if(!_){var S=(o.current.shards||[]).map(rL).filter(Boolean).filter(function(M){return M.contains(E.target)}),I=S.length>0?l(E,S[0]):!o.current.noIsolation;I&&E.cancelable&&E.preventDefault()}}},[]),u=p.useCallback(function(x,E,v,_){var S={name:x,delta:E,target:v,should:_};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(I){return I!==S})},1)},[]),d=p.useCallback(function(x){n.current=Gy(x),r.current=void 0},[]),h=p.useCallback(function(x){u(x.type,nL(x),x.target,l(x,t.lockRef.current))},[]),f=p.useCallback(function(x){u(x.type,Gy(x),x.target,l(x,t.lockRef.current))},[]);p.useEffect(function(){return ad.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,od),document.addEventListener("touchmove",c,od),document.addEventListener("touchstart",d,od),function(){ad=ad.filter(function(x){return x!==i}),document.removeEventListener("wheel",c,od),document.removeEventListener("touchmove",c,od),document.removeEventListener("touchstart",d,od)}},[]);var m=t.removeScrollBar,g=t.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:iTe(s)}):null,m?p.createElement(X$,{gapMode:"margin"}):null)}const lTe=Y$(fH,aTe);var yH=p.forwardRef(function(t,e){return p.createElement(S_,fs({},t,{ref:e,sideCar:lTe}))});yH.classNames=S_.classNames;const cTe=yH,uTe=[" ","Enter","ArrowUp","ArrowDown"],dTe=[" ","Enter"],E_="Select",[C_,T_,hTe]=oCe(E_),[nf,Gke]=zP(E_,[hTe,lH]),GP=lH(),[fTe,Vu]=nf(E_),[mTe,pTe]=nf(E_),gTe=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:s,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:u,name:d,autoComplete:h,disabled:f,required:m}=t,g=GP(e),[x,E]=p.useState(null),[v,_]=p.useState(null),[S,I]=p.useState(!1),M=lCe(u),[j=!1,C]=eL({prop:r,defaultProp:s,onChange:i}),[T,P]=eL({prop:o,defaultProp:l,onChange:c}),A=p.useRef(null),D=x?!!x.closest("form"):!0,[R,k]=p.useState(new Set),U=Array.from(R).map(B=>B.props.value).join(";");return p.createElement(FCe,g,p.createElement(fTe,{required:m,scope:e,trigger:x,onTriggerChange:E,valueNode:v,onValueNodeChange:_,valueNodeHasChildren:S,onValueNodeHasChildrenChange:I,contentId:iH(),value:T,onValueChange:P,open:j,onOpenChange:C,dir:M,triggerPointerDownPosRef:A,disabled:f},p.createElement(C_.Provider,{scope:e},p.createElement(mTe,{scope:t.__scopeSelect,onNativeOptionAdd:p.useCallback(B=>{k(K=>new Set(K).add(B))},[]),onNativeOptionRemove:p.useCallback(B=>{k(K=>{const ee=new Set(K);return ee.delete(B),ee})},[])},n)),D?p.createElement(_H,{key:U,"aria-hidden":!0,required:m,tabIndex:-1,name:d,autoComplete:h,value:T,onChange:B=>P(B.target.value),disabled:f},T===void 0?p.createElement("option",{value:""}):null,Array.from(R)):null))},yTe="SelectTrigger",xTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...s}=t,i=GP(n),o=Vu(yTe,n),l=o.disabled||r,c=xs(e,o.onTriggerChange),u=T_(n),[d,h,f]=bH(g=>{const x=u().filter(_=>!_.disabled),E=x.find(_=>_.value===o.value),v=SH(x,g,E);v!==void 0&&o.onValueChange(v.value)}),m=()=>{l||(o.onOpenChange(!0),f())};return p.createElement(OCe,yn({asChild:!0},i),p.createElement(vs.button,yn({type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":o.value===void 0?"":void 0},s,{ref:c,onClick:$r(s.onClick,g=>{g.currentTarget.focus()}),onPointerDown:$r(s.onPointerDown,g=>{const x=g.target;x.hasPointerCapture(g.pointerId)&&x.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&(m(),o.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)},g.preventDefault())}),onKeyDown:$r(s.onKeyDown,g=>{const x=d.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&h(g.key),!(x&&g.key===" ")&&uTe.includes(g.key)&&(m(),g.preventDefault())})})))}),vTe="SelectValue",wTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:o,...l}=t,c=Vu(vTe,n),{onValueNodeHasChildrenChange:u}=c,d=i!==void 0,h=xs(e,c.onValueNodeChange);return Hi(()=>{u(d)},[u,d]),p.createElement(vs.span,yn({},l,{ref:h,style:{pointerEvents:"none"}}),c.value===void 0&&o!==void 0?o:i)}),_Te=p.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...s}=t;return p.createElement(vs.span,yn({"aria-hidden":!0},s,{ref:e}),r||"▼")}),bTe=t=>p.createElement($Ce,yn({asChild:!0},t)),Vh="SelectContent",STe=p.forwardRef((t,e)=>{const n=Vu(Vh,t.__scopeSelect),[r,s]=p.useState();if(Hi(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?ja.createPortal(p.createElement(xH,{scope:t.__scopeSelect},p.createElement(C_.Slot,{scope:t.__scopeSelect},p.createElement("div",null,t.children))),i):null}return p.createElement(ETe,yn({},t,{ref:e}))}),ta=10,[xH,$u]=nf(Vh),ETe=p.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:x,avoidCollisions:E,...v}=t,_=Vu(Vh,n),[S,I]=p.useState(null),[M,j]=p.useState(null),C=xs(e,xe=>I(xe)),[T,P]=p.useState(null),[A,D]=p.useState(null),R=T_(n),[k,U]=p.useState(!1),B=p.useRef(!1);p.useEffect(()=>{if(S)return W1(S)},[S]),xCe();const K=p.useCallback(xe=>{const[Me,...Ye]=R().map(We=>We.ref.current),[qe]=Ye.slice(-1),et=document.activeElement;for(const We of xe)if(We===et||(We==null||We.scrollIntoView({block:"nearest"}),We===Me&&M&&(M.scrollTop=0),We===qe&&M&&(M.scrollTop=M.scrollHeight),We==null||We.focus(),document.activeElement!==et))return},[R,M]),ee=p.useCallback(()=>K([T,S]),[K,T,S]);p.useEffect(()=>{k&&ee()},[k,ee]);const{onOpenChange:H,triggerPointerDownPosRef:X}=_;p.useEffect(()=>{if(S){let xe={x:0,y:0};const Me=qe=>{var et,We,mt,Le;xe={x:Math.abs(Math.round(qe.pageX)-((et=(We=X.current)===null||We===void 0?void 0:We.x)!==null&&et!==void 0?et:0)),y:Math.abs(Math.round(qe.pageY)-((mt=(Le=X.current)===null||Le===void 0?void 0:Le.y)!==null&&mt!==void 0?mt:0))}},Ye=qe=>{xe.x<=10&&xe.y<=10?qe.preventDefault():S.contains(qe.target)||H(!1),document.removeEventListener("pointermove",Me),X.current=null};return X.current!==null&&(document.addEventListener("pointermove",Me),document.addEventListener("pointerup",Ye,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Me),document.removeEventListener("pointerup",Ye,{capture:!0})}}},[S,H,X]),p.useEffect(()=>{const xe=()=>H(!1);return window.addEventListener("blur",xe),window.addEventListener("resize",xe),()=>{window.removeEventListener("blur",xe),window.removeEventListener("resize",xe)}},[H]);const[O,z]=bH(xe=>{const Me=R().filter(et=>!et.disabled),Ye=Me.find(et=>et.ref.current===document.activeElement),qe=SH(Me,xe,Ye);qe&&setTimeout(()=>qe.ref.current.focus())}),Y=p.useCallback((xe,Me,Ye)=>{const qe=!B.current&&!Ye;(_.value!==void 0&&_.value===Me||qe)&&(P(xe),qe&&(B.current=!0))},[_.value]),F=p.useCallback(()=>S==null?void 0:S.focus(),[S]),ye=p.useCallback((xe,Me,Ye)=>{const qe=!B.current&&!Ye;(_.value!==void 0&&_.value===Me||qe)&&D(xe)},[_.value]),Se=r==="popper"?sL:CTe,De=Se===sL?{side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:x,avoidCollisions:E}:{};return p.createElement(xH,{scope:n,content:S,viewport:M,onViewportChange:j,itemRefCallback:Y,selectedItem:T,onItemLeave:F,itemTextRefCallback:ye,focusSelectedItem:ee,selectedItemText:A,position:r,isPositioned:k,searchRef:O},p.createElement(cTe,{as:Lp,allowPinchZoom:!0},p.createElement(vCe,{asChild:!0,trapped:_.open,onMountAutoFocus:xe=>{xe.preventDefault()},onUnmountAutoFocus:$r(s,xe=>{var Me;(Me=_.trigger)===null||Me===void 0||Me.focus({preventScroll:!0}),xe.preventDefault()})},p.createElement(pCe,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:xe=>xe.preventDefault(),onDismiss:()=>_.onOpenChange(!1)},p.createElement(Se,yn({role:"listbox",id:_.contentId,"data-state":_.open?"open":"closed",dir:_.dir,onContextMenu:xe=>xe.preventDefault()},v,De,{onPlaced:()=>U(!0),ref:C,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:$r(v.onKeyDown,xe=>{const Me=xe.ctrlKey||xe.altKey||xe.metaKey;if(xe.key==="Tab"&&xe.preventDefault(),!Me&&xe.key.length===1&&z(xe.key),["ArrowUp","ArrowDown","Home","End"].includes(xe.key)){let qe=R().filter(et=>!et.disabled).map(et=>et.ref.current);if(["ArrowUp","End"].includes(xe.key)&&(qe=qe.slice().reverse()),["ArrowUp","ArrowDown"].includes(xe.key)){const et=xe.target,We=qe.indexOf(et);qe=qe.slice(We+1)}setTimeout(()=>K(qe)),xe.preventDefault()}})}))))))}),CTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...s}=t,i=Vu(Vh,n),o=$u(Vh,n),[l,c]=p.useState(null),[u,d]=p.useState(null),h=xs(e,C=>d(C)),f=T_(n),m=p.useRef(!1),g=p.useRef(!0),{viewport:x,selectedItem:E,selectedItemText:v,focusSelectedItem:_}=o,S=p.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&u&&x&&E&&v){const C=i.trigger.getBoundingClientRect(),T=u.getBoundingClientRect(),P=i.valueNode.getBoundingClientRect(),A=v.getBoundingClientRect();if(i.dir!=="rtl"){const et=A.left-T.left,We=P.left-et,mt=C.left-We,Le=C.width+mt,ve=Math.max(Le,T.width),Je=window.innerWidth-ta,Xe=W4(We,[ta,Je-ve]);l.style.minWidth=Le+"px",l.style.left=Xe+"px"}else{const et=T.right-A.right,We=window.innerWidth-P.right-et,mt=window.innerWidth-C.right-We,Le=C.width+mt,ve=Math.max(Le,T.width),Je=window.innerWidth-ta,Xe=W4(We,[ta,Je-ve]);l.style.minWidth=Le+"px",l.style.right=Xe+"px"}const D=f(),R=window.innerHeight-ta*2,k=x.scrollHeight,U=window.getComputedStyle(u),B=parseInt(U.borderTopWidth,10),K=parseInt(U.paddingTop,10),ee=parseInt(U.borderBottomWidth,10),H=parseInt(U.paddingBottom,10),X=B+K+k+H+ee,O=Math.min(E.offsetHeight*5,X),z=window.getComputedStyle(x),Y=parseInt(z.paddingTop,10),F=parseInt(z.paddingBottom,10),ye=C.top+C.height/2-ta,Se=R-ye,De=E.offsetHeight/2,xe=E.offsetTop+De,Me=B+K+xe,Ye=X-Me;if(Me<=ye){const et=E===D[D.length-1].ref.current;l.style.bottom="0px";const We=u.clientHeight-x.offsetTop-x.offsetHeight,mt=Math.max(Se,De+(et?F:0)+We+ee),Le=Me+mt;l.style.height=Le+"px"}else{const et=E===D[0].ref.current;l.style.top="0px";const mt=Math.max(ye,B+x.offsetTop+(et?Y:0)+De)+Ye;l.style.height=mt+"px",x.scrollTop=Me-ye+x.offsetTop}l.style.margin=`${ta}px 0`,l.style.minHeight=O+"px",l.style.maxHeight=R+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[f,i.trigger,i.valueNode,l,u,x,E,v,i.dir,r]);Hi(()=>S(),[S]);const[I,M]=p.useState();Hi(()=>{u&&M(window.getComputedStyle(u).zIndex)},[u]);const j=p.useCallback(C=>{C&&g.current===!0&&(S(),_==null||_(),g.current=!1)},[S,_]);return p.createElement(TTe,{scope:n,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:j},p.createElement("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:I}},p.createElement(vs.div,yn({},s,{ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}}))))}),sL=p.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=ta,...i}=t,o=GP(n);return p.createElement(VCe,yn({},o,i,{ref:e,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[TTe,HP]=nf(Vh,{}),iL="SelectViewport",ITe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=$u(iL,n),i=HP(iL,n),o=xs(e,s.onViewportChange),l=p.useRef(0);return p.createElement(p.Fragment,null,p.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),p.createElement(C_.Slot,{scope:n},p.createElement(vs.div,yn({"data-radix-select-viewport":"",role:"presentation"},r,{ref:o,style:{position:"relative",flex:1,overflow:"auto",...r.style},onScroll:$r(r.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=i;if(h!=null&&h.current&&d){const f=Math.abs(l.current-u.scrollTop);if(f>0){const m=window.innerHeight-ta*2,g=parseFloat(d.style.minHeight),x=parseFloat(d.style.height),E=Math.max(g,x);if(E<m){const v=E+f,_=Math.min(m,v),S=v-_;d.style.height=_+"px",d.style.bottom==="0px"&&(u.scrollTop=S>0?S:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})}))))}),NTe="SelectGroup",[Hke,PTe]=nf(NTe),ATe="SelectLabel",RTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=PTe(ATe,n);return p.createElement(vs.div,yn({id:s.id},r,{ref:e}))}),xT="SelectItem",[kTe,vH]=nf(xT),jTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...o}=t,l=Vu(xT,n),c=$u(xT,n),u=l.value===r,[d,h]=p.useState(i??""),[f,m]=p.useState(!1),g=xs(e,v=>{var _;return(_=c.itemRefCallback)===null||_===void 0?void 0:_.call(c,v,r,s)}),x=iH(),E=()=>{s||(l.onValueChange(r),l.onOpenChange(!1))};return p.createElement(kTe,{scope:n,value:r,disabled:s,textId:x,isSelected:u,onItemTextChange:p.useCallback(v=>{h(_=>{var S;return _||((S=v==null?void 0:v.textContent)!==null&&S!==void 0?S:"").trim()})},[])},p.createElement(C_.ItemSlot,{scope:n,value:r,disabled:s,textValue:d},p.createElement(vs.div,yn({role:"option","aria-labelledby":x,"data-highlighted":f?"":void 0,"aria-selected":u&&f,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1},o,{ref:g,onFocus:$r(o.onFocus,()=>m(!0)),onBlur:$r(o.onBlur,()=>m(!1)),onPointerUp:$r(o.onPointerUp,E),onPointerMove:$r(o.onPointerMove,v=>{if(s){var _;(_=c.onItemLeave)===null||_===void 0||_.call(c)}else v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:$r(o.onPointerLeave,v=>{if(v.currentTarget===document.activeElement){var _;(_=c.onItemLeave)===null||_===void 0||_.call(c)}}),onKeyDown:$r(o.onKeyDown,v=>{var _;((_=c.searchRef)===null||_===void 0?void 0:_.current)!==""&&v.key===" "||(dTe.includes(v.key)&&E(),v.key===" "&&v.preventDefault())})}))))}),Hy="SelectItemText",DTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,...i}=t,o=Vu(Hy,n),l=$u(Hy,n),c=vH(Hy,n),u=pTe(Hy,n),[d,h]=p.useState(null),f=xs(e,v=>h(v),c.onItemTextChange,v=>{var _;return(_=l.itemTextRefCallback)===null||_===void 0?void 0:_.call(l,v,c.value,c.disabled)}),m=d==null?void 0:d.textContent,g=p.useMemo(()=>p.createElement("option",{key:c.value,value:c.value,disabled:c.disabled},m),[c.disabled,c.value,m]),{onNativeOptionAdd:x,onNativeOptionRemove:E}=u;return Hi(()=>(x(g),()=>E(g)),[x,E,g]),p.createElement(p.Fragment,null,p.createElement(vs.span,yn({id:c.textId},i,{ref:f})),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?ja.createPortal(i.children,o.valueNode):null)}),MTe="SelectItemIndicator",LTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return vH(MTe,n).isSelected?p.createElement(vs.span,yn({"aria-hidden":!0},r,{ref:e})):null}),oL="SelectScrollUpButton",FTe=p.forwardRef((t,e)=>{const n=$u(oL,t.__scopeSelect),r=HP(oL,t.__scopeSelect),[s,i]=p.useState(!1),o=xs(e,r.onScrollButtonChange);return Hi(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=l.scrollTop>0;i(u)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),s?p.createElement(wH,yn({},t,{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}})):null}),aL="SelectScrollDownButton",OTe=p.forwardRef((t,e)=>{const n=$u(aL,t.__scopeSelect),r=HP(aL,t.__scopeSelect),[s,i]=p.useState(!1),o=xs(e,r.onScrollButtonChange);return Hi(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=l.scrollHeight-l.clientHeight,d=Math.ceil(l.scrollTop)<u;i(d)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),s?p.createElement(wH,yn({},t,{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}})):null}),wH=p.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=t,i=$u("SelectScrollButton",n),o=p.useRef(null),l=T_(n),c=p.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),Hi(()=>{var u;const d=l().find(h=>h.ref.current===document.activeElement);d==null||(u=d.ref.current)===null||u===void 0||u.scrollIntoView({block:"nearest"})},[l]),p.createElement(vs.div,yn({"aria-hidden":!0},s,{ref:e,style:{flexShrink:0,...s.style},onPointerDown:$r(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:$r(s.onPointerMove,()=>{var u;(u=i.onItemLeave)===null||u===void 0||u.call(i),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:$r(s.onPointerLeave,()=>{c()})}))}),VTe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return p.createElement(vs.div,yn({"aria-hidden":!0},r,{ref:e}))}),_H=p.forwardRef((t,e)=>{const{value:n,...r}=t,s=p.useRef(null),i=xs(e,s),o=BCe(n);return p.useEffect(()=>{const l=s.current,c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==n&&d){const h=new Event("change",{bubbles:!0});d.call(l,n),l.dispatchEvent(h)}},[o,n]),p.createElement(JCe,{asChild:!0},p.createElement("select",yn({},r,{ref:i,defaultValue:n})))});_H.displayName="BubbleSelect";function bH(t){const e=Ra(t),n=p.useRef(""),r=p.useRef(0),s=p.useCallback(o=>{const l=n.current+o;e(l),function c(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(l)},[e]),i=p.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function SH(t,e,n){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=$Te(t,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function $Te(t,e){return t.map((n,r)=>t[(e+r)%t.length])}const UTe=gTe,EH=xTe,BTe=wTe,zTe=_Te,GTe=bTe,CH=STe,HTe=ITe,TH=RTe,IH=jTe,WTe=DTe,qTe=LTe,NH=FTe,PH=OTe,AH=VTe,ru=UTe,su=BTe,Dl=ct.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(EH,{ref:r,className:bt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,a.jsx(zTe,{asChild:!0,children:a.jsx(n0,{className:"h-4 w-4 opacity-50"})})]}));Dl.displayName=EH.displayName;const RH=ct.forwardRef(({className:t,...e},n)=>a.jsx(NH,{ref:n,className:bt("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(I$,{className:"h-4 w-4"})}));RH.displayName=NH.displayName;const kH=ct.forwardRef(({className:t,...e},n)=>a.jsx(PH,{ref:n,className:bt("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(n0,{className:"h-4 w-4"})}));kH.displayName=PH.displayName;const Ml=ct.forwardRef(({className:t,children:e,position:n="popper",...r},s)=>a.jsx(GTe,{children:a.jsxs(CH,{ref:s,className:bt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[a.jsx(RH,{}),a.jsx(HTe,{className:bt("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),a.jsx(kH,{})]})}));Ml.displayName=CH.displayName;const KTe=ct.forwardRef(({className:t,...e},n)=>a.jsx(TH,{ref:n,className:bt("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));KTe.displayName=TH.displayName;const Wn=ct.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(IH,{ref:r,className:bt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(qTe,{children:a.jsx(qp,{className:"h-4 w-4"})})}),a.jsx(WTe,{children:e})]}));Wn.displayName=IH.displayName;const YTe=ct.forwardRef(({className:t,...e},n)=>a.jsx(AH,{ref:n,className:bt("-mx-1 my-1 h-px bg-muted",t),...e}));YTe.displayName=AH.displayName;const JTe="AIzaSyBcpnUVVBDNaBLG7Rj_cEmE0J4zNlHmg7o",XTe=async t=>{var i,o;if(!t||t.length===0)return{error:"No images provided for analysis."};const e=new ar({apiKey:JTe}),n=t.map(l=>{if(!l.base64||!l.mimeType)throw console.error("Image object is missing base64 or mimeType:",l.name),new Error(`Image ${l.name} is missing data for AI processing.`);return{inlineData:{data:l.base64.startsWith("data:")?l.base64.split(",")[1]:l.base64,mimeType:l.mimeType}}}),r=`
    Analyze the following product images (${t.map(l=>l.name).join(", ")}). 
    Based on these images, provide the following details for setting up an e-commerce store.
    Please format your response as a single, valid JSON object with the exact keys specified below.

    1.  "productType": A concise category or niche for these products (e.g., "Handcrafted Leather Goods", "Vintage Streetwear", "Artisanal Coffee Beans").
    2.  "storeNameSuggestions": An array of 3-5 creative and relevant store name suggestions.
    3.  "logoDescription": A brief description of a suitable logo concept (e.g., "A minimalist line art of a coffee bean with earthy tones").
    4.  "products": An array of objects, one for each uploaded image. For each product, analyze its specific image content to generate the following:
        *   "originalImageName": The filename of the original image (use the names provided in this prompt, e.g., "${((i=t[0])==null?void 0:i.name)||"example_image.jpg"}").
        *   "name": A catchy and descriptive product name directly inspired by the visual details in THIS specific image.
        *   "price": A suggested retail price for THIS specific product, considering its appearance and likely category (e.g., "29.99"). Ensure this is a string representing a number.
        *   "description": A compelling product description (2-3 sentences) highlighting key visual features and benefits of THIS specific product shown in its image.
    5.  "collections": An array of 3 distinct collection suggestions, each with:
        *   "name": Collection name (e.g., "New Arrivals", "Essentials", "Gifts Under $50").
        *   "description": A brief description for the collection.
    6.  "storePrompt": A short paragraph describing the overall style, feel, and target audience for a store selling these products. This will be used as a base for further AI generation of store content.

    Example for a single product in the "products" array:
    {
      "originalImageName": "${((o=t[0])==null?void 0:o.name)||"example_image.jpg"}",
      "name": "Rustic Leather Wallet",
      "price": "45.00",
      "description": "Hand-stitched full-grain leather wallet with a timeless design. Perfect for everyday carry, offering both style and durability."
    }
  `,s={type:ze.OBJECT,properties:{productType:{type:ze.STRING},storeNameSuggestions:{type:ze.ARRAY,items:{type:ze.STRING}},logoDescription:{type:ze.STRING},products:{type:ze.ARRAY,items:{type:ze.OBJECT,properties:{originalImageName:{type:ze.STRING},name:{type:ze.STRING},price:{type:ze.STRING},description:{type:ze.STRING}},required:["originalImageName","name","price","description"]}},collections:{type:ze.ARRAY,items:{type:ze.OBJECT,properties:{name:{type:ze.STRING},description:{type:ze.STRING}},required:["name","description"]}},storePrompt:{type:ze.STRING}},required:["productType","storeNameSuggestions","logoDescription","products","collections","storePrompt"]};try{console.log("[geminiImageUnderstanding] Sending prompt to Gemini with images:",t.map(h=>h.name));const l=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:r},...n]}],config:{responseMimeType:"application/json",responseSchema:s}});if(console.log("[geminiImageUnderstanding] Full API call response object:",JSON.stringify(l,null,2)),!l||typeof l.text!="string"){let h="Invalid or missing response from API.";return l&&l.promptFeedback&&l.promptFeedback.blockReason?(h=`Request blocked: ${l.promptFeedback.blockReason}. ${l.promptFeedback.blockReasonMessage||""}`,console.error(`[geminiImageUnderstanding] Request blocked. Reason: ${l.promptFeedback.blockReason}, Message: ${l.promptFeedback.blockReasonMessage}`)):l&&l.candidates&&l.candidates.length>0&&l.candidates[0].finishReason!=="STOP"&&l.candidates[0].finishReason!=="MODEL_SPECIFIED_STOP"?(h=`Generation stopped for reason: ${l.candidates[0].finishReason}.`,console.error(`[geminiImageUnderstanding] Generation stopped. Reason: ${l.candidates[0].finishReason}`)):console.error("[geminiImageUnderstanding] API response is invalid or text property is missing/not a string. Full response:",l),{error:`AI analysis failed: ${h}`}}const c=l.text;if(c.trim()==="")return console.error("[geminiImageUnderstanding] Model did not return a text response (empty string). Full API Response:",JSON.stringify(l)),{error:"AI analysis failed: Model response was empty or not text."};let u;try{u=JSON.parse(c)}catch(h){return console.error("[geminiImageUnderstanding] Failed to parse Gemini JSON response:",c,"ParseError:",h),{error:"AI analysis failed: Could not understand the response from Gemini (invalid JSON)."}}if(!u.productType||!Array.isArray(u.storeNameSuggestions)||!Array.isArray(u.products)||!Array.isArray(u.collections)||!u.storePrompt)return console.error("[geminiImageUnderstanding] Gemini response missing required fields or incorrect types:",u),{error:"AI analysis failed: The response from Gemini was incomplete or malformed."};const d=u.products.map(h=>{let f=[],m="Untitled Product (AI)",g="0.00",x="No description provided by AI.",E=null;if(h&&typeof h=="object")if(m=h.name||m,g=h.price||g,x=h.description||x,E=h.originalImageName||null,typeof h.originalImageName=="string"){const v=t.find(_=>_&&_.name===h.originalImageName);v&&typeof v.base64=="string"?f=[v.base64]:console.warn(`[geminiImageUnderstanding] Original image or its base64 not found for product with AI-provided originalImageName: "${h.originalImageName}". AI Product Name: "${h.name}"`)}else console.warn("[geminiImageUnderstanding] Product item from AI is missing 'originalImageName' string or is invalid:",h);else console.warn("[geminiImageUnderstanding] Invalid product item received from AI (not an object):",h);return{...h&&typeof h=="object"?h:{},name:m,price:g,description:x,originalImageName:E,images:f}});return{productType:u.productType,storeNameSuggestions:u.storeNameSuggestions,logoDescription:u.logoDescription,products:d,collections:u.collections,storePrompt:u.storePrompt,error:null}}catch(l){return console.error("[geminiImageUnderstanding] Error calling Gemini API or processing response:",l),{error:`AI analysis API call failed: ${l.message}`}}},QTe=$1("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Fp({className:t,variant:e,...n}){return a.jsx("div",{className:bt(QTe({variant:e}),t),...n})}var I_="Checkbox",[ZTe,Wke]=Si(I_),[e1e,WP]=ZTe(I_);function t1e(t){const{__scopeCheckbox:e,checked:n,children:r,defaultChecked:s,disabled:i,form:o,name:l,onCheckedChange:c,required:u,value:d="on",internal_do_not_use_render:h}=t,[f,m]=Pu({prop:n,defaultProp:s??!1,onChange:c,caller:I_}),[g,x]=p.useState(null),[E,v]=p.useState(null),_=p.useRef(!1),S=g?!!o||!!g.closest("form"):!0,I={checked:f,disabled:i,setChecked:m,control:g,setControl:x,name:l,form:o,value:d,hasConsumerStoppedPropagationRef:_,required:u,defaultChecked:Ll(s)?!1:s,isFormControl:S,bubbleInput:E,setBubbleInput:v};return a.jsx(e1e,{scope:e,...I,children:n1e(h)?h(I):r})}var jH="CheckboxTrigger",DH=p.forwardRef(({__scopeCheckbox:t,onKeyDown:e,onClick:n,...r},s)=>{const{control:i,value:o,disabled:l,checked:c,required:u,setControl:d,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:m,bubbleInput:g}=WP(jH,t),x=bn(s,d),E=p.useRef(c);return p.useEffect(()=>{const v=i==null?void 0:i.form;if(v){const _=()=>h(E.current);return v.addEventListener("reset",_),()=>v.removeEventListener("reset",_)}},[i,h]),a.jsx(Kt.button,{type:"button",role:"checkbox","aria-checked":Ll(c)?"mixed":c,"aria-required":u,"data-state":VH(c),"data-disabled":l?"":void 0,disabled:l,value:o,...r,ref:x,onKeyDown:wt(e,v=>{v.key==="Enter"&&v.preventDefault()}),onClick:wt(n,v=>{h(_=>Ll(_)?!0:!_),g&&m&&(f.current=v.isPropagationStopped(),f.current||v.stopPropagation())})})});DH.displayName=jH;var qP=p.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c,onCheckedChange:u,form:d,...h}=t;return a.jsx(t1e,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:l,required:o,onCheckedChange:u,name:r,form:d,value:c,internal_do_not_use_render:({isFormControl:f})=>a.jsxs(a.Fragment,{children:[a.jsx(DH,{...h,ref:e,__scopeCheckbox:n}),f&&a.jsx(OH,{__scopeCheckbox:n})]})})});qP.displayName=I_;var MH="CheckboxIndicator",LH=p.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...s}=t,i=WP(MH,n);return a.jsx(Ms,{present:r||Ll(i.checked)||i.checked===!0,children:a.jsx(Kt.span,{"data-state":VH(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...t.style}})})});LH.displayName=MH;var FH="CheckboxBubbleInput",OH=p.forwardRef(({__scopeCheckbox:t,...e},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:o,required:l,disabled:c,name:u,value:d,form:h,bubbleInput:f,setBubbleInput:m}=WP(FH,t),g=bn(n,m),x=WG(i),E=EP(r);p.useEffect(()=>{const _=f;if(!_)return;const S=window.HTMLInputElement.prototype,M=Object.getOwnPropertyDescriptor(S,"checked").set,j=!s.current;if(x!==i&&M){const C=new Event("click",{bubbles:j});_.indeterminate=Ll(i),M.call(_,Ll(i)?!1:i),_.dispatchEvent(C)}},[f,x,i,s]);const v=p.useRef(Ll(i)?!1:i);return a.jsx(Kt.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??v.current,required:l,disabled:c,name:u,value:d,form:h,...e,tabIndex:-1,ref:g,style:{...e.style,...E,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});OH.displayName=FH;function n1e(t){return typeof t=="function"}function Ll(t){return t==="indeterminate"}function VH(t){return Ll(t)?"indeterminate":t?"checked":"unchecked"}const $H=p.forwardRef(({className:t,...e},n)=>a.jsx(qP,{ref:n,className:bt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:a.jsx(LH,{className:bt("flex items-center justify-center text-current"),children:a.jsx(qp,{className:"h-4 w-4"})})}));$H.displayName=qP.displayName;const r1e=({isOpen:t,onClose:e,collection:n,allProducts:r,onSave:s})=>{const[i,o]=p.useState([]),[l,c]=p.useState("");if(p.useEffect(()=>{n&&n.product_ids?o(n.product_ids):o([])},[n]),!n)return null;const u=h=>{o(f=>f.includes(h)?f.filter(m=>m!==h):[...f,h])},d=()=>{s(n.id??n.name,i),e()};return a.jsx(ys,{open:t,onOpenChange:e,children:a.jsxs(es,{className:"sm:max-w-[525px]",children:[a.jsxs(ts,{children:[a.jsxs(ns,{children:['Manage Products for "',n.name||"Unnamed Collection",'"']}),a.jsx(xo,{children:"Select or unselect products to include in this collection. Use the search bar to filter products."})]}),a.jsxs("div",{className:"py-4",children:[a.jsx(nt,{type:"text",placeholder:"Search products...",value:l,onChange:h=>c(h.target.value),className:"mb-4"}),r&&r.length>0?a.jsxs(Gi,{className:"h-[250px] pr-4",children:[" ",a.jsx("div",{className:"space-y-3",children:r.filter(h=>h.name.toLowerCase().includes(l.toLowerCase())).map(h=>a.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-md hover:bg-muted/50 transition-colors",children:[a.jsx($H,{id:`product-${n.id??n.name}-${h.id??h.name}`,checked:i.includes(h.id??h.name),onCheckedChange:()=>u(h.id??h.name)}),a.jsx(Re,{htmlFor:`product-${n.id??n.name}-${h.id??h.name}`,className:"flex-1 cursor-pointer",children:a.jsxs("div",{className:"flex items-center gap-3",children:[h.images&&h.images.length>0?a.jsx("img",{src:h.images[0],alt:h.name,className:"w-12 h-12 object-cover rounded-sm"}):a.jsx("div",{className:"w-12 h-12 bg-muted rounded-sm flex items-center justify-center text-xs text-muted-foreground",children:"No Img"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:h.name||"Untitled Product"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",h.price||"0.00"]})]})]})})]},h.id??h.name))})]}):a.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No products available to add to this collection. Please add products to your store first."})]}),a.jsxs(Tr,{children:[a.jsx(ba,{asChild:!0,children:a.jsx(V,{type:"button",variant:"outline",children:"Cancel"})}),a.jsx(V,{type:"button",onClick:d,disabled:!r||r.length===0,children:"Save Changes"})]})]})})},s1e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),i1e=({isOpen:t,onClose:e,product:n,onSave:r,onGenerateMainImage:s,onGenerateMoreAngles:i,productIndexInWizard:o,isGeneratingProductImage:l,isGeneratingAngles:c})=>{const[u,d]=p.useState(null),{toast:h}=Ls();p.useEffect(()=>{if(n){const P=n.variants?n.variants.map(R=>({...R,values:Array.isArray(R.values)?[...R.values]:typeof R.values=="string"?R.values.split(",").map(k=>k.trim()).filter(k=>k):[]})):[],A=Array.isArray(n.images)?[...n.images]:[],D={...n,variants:P,images:A};A.length===0&&n.imageUrl&&(D.images=[n.imageUrl]),d(D)}else d(null)},[n,t]);const f=P=>{const{name:A,value:D,type:R}=P.target;d(k=>({...k,[A]:R==="number"?parseFloat(D)||0:D}))},m=P=>{d(A=>({...A,images:P}))},g=async P=>{if(P.target.files&&P.target.files.length>0){const D=Array.from(P.target.files).map(R=>s1e(R));try{const R=await Promise.all(D);m([...u.images||[],...R])}catch{h({title:"Image Upload Error",description:"Could not process some images.",variant:"destructive"})}}},x=P=>{m((u.images||[]).filter((A,D)=>D!==P))},E=async()=>{s&&o!==null&&u&&await s(o,u)},v=async()=>{i&&o!==null&&u&&u.images&&u.images.length>0?await i(o,u):h({title:"Cannot Generate Angles",description:"A main image is required first.",variant:"warning"})},_=(P,A,D)=>{d(R=>{const k=[...R.variants||[]];return k[P]={...k[P],[A]:D},{...R,variants:k}})},S=(P,A,D)=>{d(R=>{const k=[...R.variants||[]],U=[...k[P].values];return U[A]=D,k[P]={...k[P],values:U},{...R,variants:k}})},I=P=>{d(A=>{const D=[...A.variants||[]],R=[...D[P].values,""];return D[P]={...D[P],values:R},{...A,variants:D}})},M=(P,A)=>{d(D=>{const R=[...D.variants||[]],k=R[P].values.filter((U,B)=>B!==A);return R[P]={...R[P],values:k},k.length===0&&h({title:"Info",description:`Variant option "${R[P].name}" has no values.`,variant:"default"}),{...D,variants:R}})},j=()=>{d(P=>({...P,variants:[...P.variants||[],{name:"",values:[""]}]}))},C=P=>{d(A=>({...A,variants:(A.variants||[]).filter((D,R)=>R!==P)}))},T=()=>{if(!u.name||u.name.trim()===""){h({title:"Validation Error",description:"Product name cannot be empty.",variant:"destructive"});return}if(u.price===void 0||u.price===null||isNaN(parseFloat(u.price))||parseFloat(u.price)<0){h({title:"Validation Error",description:"Product price must be a valid non-negative number.",variant:"destructive"});return}const P=u.variants?u.variants.map(A=>({...A,name:A.name.trim(),values:A.values.map(D=>D.trim()).filter(D=>D!=="")})).filter(A=>A.name!==""&&A.values.length>0):[];r({...u,variants:P}),e()};return!t||!u?null:a.jsx(ys,{open:t,onOpenChange:P=>{P||e()},children:a.jsxs(es,{className:"sm:max-w-2xl",children:[a.jsxs(ts,{children:[a.jsx(ns,{children:"Edit AI Generated Product"}),a.jsx(xo,{children:"Modify the details of the generated product below."})]}),a.jsx(Gi,{className:"max-h-[70vh] p-1 pr-3",children:a.jsxs("div",{className:"space-y-4 py-4 pr-2",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"name",children:"Product Name"}),a.jsx(nt,{id:"name",name:"name",value:u.name||"",onChange:f})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"price",children:"Price (USD)"}),a.jsx(nt,{id:"price",name:"price",type:"number",value:u.price||0,onChange:f})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"description",children:"Description"}),a.jsx(Ln,{id:"description",name:"description",value:u.description||"",onChange:f,rows:4})]}),a.jsxs("div",{className:"space-y-2 border p-3 rounded-md",children:[a.jsx(Re,{className:"text-md font-semibold",children:"Product Images"}),u.images&&u.images.length>0?a.jsx("div",{className:"overflow-x-auto py-2",children:a.jsx("div",{className:"flex flex-row gap-2 mb-2 min-w-max",children:u.images.map((P,A)=>a.jsxs("div",{className:"relative group flex-shrink-0",children:[a.jsx("img",{src:P,alt:`Product image ${A+1}`,className:"w-24 h-24 object-contain rounded-md border"}),a.jsx(V,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>x(A),children:a.jsx(er,{className:"h-3.5 w-3.5"})})]},`${P}-${A}`))})}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No images yet."}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[a.jsxs(V,{variant:"outline",size:"sm",onClick:()=>document.getElementById("editAiProductImageUpload").click(),children:[a.jsx(Fo,{className:"mr-2 h-4 w-4"})," Upload Images"]}),a.jsx(nt,{id:"editAiProductImageUpload",type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:g}),a.jsxs(V,{variant:"outline",size:"sm",onClick:E,disabled:l||!u.name,children:[l?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Xr,{className:"mr-2 h-4 w-4"}),u.images&&u.images.length>0?"Regenerate Main":"Generate Main"]}),u.images&&u.images.length>0&&a.jsxs(V,{variant:"outline",size:"sm",onClick:v,disabled:c,children:[c?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Xr,{className:"mr-2 h-4 w-4"}),"More Angles"]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-md font-semibold",children:"Variants"}),(u.variants||[]).map((P,A)=>a.jsxs(Ge,{className:"p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Re,{htmlFor:`variantName-${A}`,children:"Option Name"}),a.jsx(V,{variant:"ghost",size:"icon",onClick:()=>C(A),className:"h-7 w-7",children:a.jsx(er,{className:"h-4 w-4 text-destructive"})})]}),a.jsx(nt,{id:`variantName-${A}`,value:P.name||"",onChange:D=>_(A,"name",D.target.value),placeholder:"e.g., Color, Size"}),a.jsx(Re,{children:"Option Values"}),P.values.map((D,R)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nt,{value:D||"",onChange:k=>S(A,R,k.target.value),placeholder:"e.g., Red, Large"}),a.jsx(V,{variant:"ghost",size:"icon",onClick:()=>M(A,R),className:"h-7 w-7",children:a.jsx(er,{className:"h-4 w-4 text-destructive"})})]},R)),a.jsxs(V,{variant:"outline",size:"sm",onClick:()=>I(A),children:[a.jsx(so,{className:"mr-2 h-4 w-4"})," Add Value"]})]},A)),a.jsxs(V,{variant:"outline",onClick:j,className:"w-full",children:[a.jsx(so,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]})}),a.jsxs(Tr,{children:[a.jsx(ba,{asChild:!0,children:a.jsx(V,{type:"button",variant:"outline",onClick:e,children:"Cancel"})}),a.jsx(V,{type:"button",onClick:T,children:"Save Changes"})]})]})})},ld=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),lL=[{value:"fashion",label:"Fashion & Apparel"},{value:"electronics",label:"Electronics & Gadgets"},{value:"food",label:"Food & Beverage"},{value:"jewelry",label:"Jewelry & Accessories"},{value:"homedecor",label:"Home Decor & Furnishings"},{value:"beauty",label:"Beauty & Personal Care"},{value:"books",label:"Books & Media"},{value:"sports",label:"Sports & Outdoors"},{value:"toys",label:"Toys & Games"},{value:"general",label:"General Merchandise"}],o1e=(t,e)=>{const{formData:n,setFormData:r,handleInputChange:s,handleProductTypeChange:i,handleProductSourceChange:o,handleProductCountChange:l,handleManualProductChange:c,addManualProduct:u,removeManualProduct:d,suggestStoreName:h,generateLogo:f,generateAiProducts:m,generateAiCollections:g,handleGenerateManualProductImage:x,handleGenerateMoreAngles:E,isProcessing:v,isGeneratingProductImageForIndex:_,productImageGenerationError:S,isGeneratingAnglesForIndex:I,angleGenerationError:M,productTypeOptions:j,storeNameSuggestions:C,handleSuggestionClick:T,suggestionError:P,handleInitialImportMethodChange:A,handleProductPhotoUpload:D,uploadedProductPhotos:R,removeUploadedProductPhoto:k,isProcessingPhotos:U,handleGenerateCollectionImage:B,isGeneratingCollectionImageForIndex:K,collectionImageGenerationError:ee,isCheckingStoreName:H,storeNameAvailability:X,handleManualStoreNameCheck:O}=e,[z,Y]=p.useState(""),[F,ye]=p.useState(""),[Se,De]=p.useState(null),[xe,Me]=p.useState(null),[Ye,qe]=p.useState(""),[et,We]=p.useState(""),[mt,Le]=p.useState([]),[ve,Je]=p.useState([]);p.useState(null);const[Xe,kt]=p.useState([]),[Gt,fn]=p.useState(!1),[sn,ae]=p.useState(!1),[me,fe]=p.useState(""),{toast:Ne}=Ls(),[ne,de]=p.useState(!1),[Ee,Qe]=p.useState(null),[re,Ve]=p.useState(null),Te=(W,J,se)=>{r(G=>{const oe=[...G.products.items],we={...oe[W]};return we.variants=[...we.variants||[]],we.variants[J]={...we.variants[J],name:se},oe[W]=we,{...G,products:{...G.products,items:oe}}})},ut=(W,J,se,G)=>{r(oe=>{const we=[...oe.products.items],ke={...we[W]};ke.variants=[...ke.variants||[]];const Ue={...ke.variants[J]};return Ue.values=[...Ue.values||[]],Ue.values[se]=G,ke.variants[J]=Ue,we[W]=ke,{...oe,products:{...oe.products,items:we}}})},pt=(W,J)=>{r(se=>{const G=[...se.products.items],oe={...G[W]};oe.variants=[...oe.variants||[]];const we={...oe.variants[J]};return we.values=[...we.values||[],""],oe.variants[J]=we,G[W]=oe,{...se,products:{...se.products,items:G}}})},he=(W,J,se)=>{r(G=>{const oe=[...G.products.items],we={...oe[W]};we.variants=[...we.variants||[]];const ke={...we.variants[J]};return ke.values=(ke.values||[]).filter((Ue,_e)=>_e!==se),we.variants[J]=ke,ke.values.length===0&&Ne({title:"Info",description:`Variant option "${ke.name}" has no values. Consider removing the option or adding values.`,variant:"default"}),oe[W]=we,{...G,products:{...G.products,items:oe}}})},be=W=>{r(J=>{const se=[...J.products.items],G={...se[W]};return G.variants=[...G.variants||[],{name:"",values:[""]}],se[W]=G,{...J,products:{...J.products,items:se}}})},Fe=(W,J)=>{r(se=>{const G=[...se.products.items],oe={...G[W]};return oe.variants=(oe.variants||[]).filter((we,ke)=>ke!==J),G[W]=oe,{...se,products:{...se.products,items:G}}})},Pe=async W=>{const J=W.target.files[0];if(J){fe(""),De(J);try{const se=await ld(J);ye(se),Y(""),Ne({title:"Image Uploaded",description:"Your image is ready for visualization."})}catch(se){console.error("Error converting uploaded file to base64:",se),fe("Failed to load uploaded image. Please try again."),Ne({variant:"destructive",title:"Upload Failed",description:"Could not process the uploaded image."}),ye(""),De(null)}}},Yt=()=>{ye(""),De(null),Y(""),fe("");const W=document.getElementById("podImageUpload");W&&(W.value="")},Ht=async W=>{const J=W.target.files[0];if(J){fe(""),Me(J);try{const se=await ld(J);qe(se),Ne({title:"Reference Image Added",description:"This image will be used with your prompt for generation."})}catch(se){console.error("Error converting reference file to base64:",se),fe("Failed to load reference image. Please try again."),Ne({variant:"destructive",title:"Reference Image Load Failed",description:"Could not process the reference image."}),qe(""),Me(null)}}},Tt=()=>{qe(""),Me(null),fe("");const W=document.getElementById("podReferenceImageUpload");W&&(W.value="")},yt=[{name:"T-shirt",imageUrl:"https://uwbrgokfgelgxeonoqah.supabase.co/storage/v1/object/public/images//Shirt.webp"},{name:"Hoodie",imageUrl:"https://uwbrgokfgelgxeonoqah.supabase.co/storage/v1/object/public/images//Hoodie.jpeg"},{name:"Baseball Cap",imageUrl:"https://uwbrgokfgelgxeonoqah.supabase.co/storage/v1/object/public/images//Hat.jpeg"},{name:"Mug",imageUrl:"https://uwbrgokfgelgxeonoqah.supabase.co/storage/v1/object/public/images//Mug.png"},{name:"Pillow",imageUrl:"https://uwbrgokfgelgxeonoqah.supabase.co/storage/v1/object/public/images//Pillow.webp"},{name:"Blanket",imageUrl:"https://uwbrgokfgelgxeonoqah.supabase.co/storage/v1/object/public/images//Bl.webp"},{name:"Canvas",imageUrl:"https://uwbrgokfgelgxeonoqah.supabase.co/storage/v1/object/public/images//IMG_5933.jpeg"}],Ft=async()=>{if(!z){Ne({title:"Missing Prompt",description:"Please enter a prompt for image generation.",variant:"destructive"});return}if(Se){Ne({title:"Image Already Uploaded",description:"An image has already been uploaded. Clear it if you want to generate a new one.",variant:"warning"});return}fn(!0),fe(""),ye("");let W={prompt:z};if(xe&&Ye){const[J,se]=Ye.split(","),G=J.match(/:(.*?);/)[1];W.referenceImage={base64Data:se,mimeType:G,fileName:xe.name},console.log("Attempting to generate POD image preview with prompt and reference image:",z,xe.name)}else console.log("Attempting to generate POD image preview for prompt:",z);try{const J=await sU(W);if(J.imageData&&J.imageMimeType){const se=`data:${J.imageMimeType};base64,${J.imageData}`;ye(se),console.log("POD Image preview generated successfully.")}else throw new Error(J.textResponse||"Image data not returned from API.")}catch(J){console.error("Error generating POD image preview:",J);const se=J.message||"Failed to generate image preview.";fe(se),Ne({variant:"destructive",title:"Image Generation Failed",description:se})}finally{fn(!1)}},Sn=W=>{const J=W.target.value;We(J),Le(J?yt.filter(se=>se.name.toLowerCase().includes(J.toLowerCase())):[])},mn=W=>{Je(J=>J.some(G=>G.name===W.name)?J.filter(G=>G.name!==W.name):[...J,W])},xr=async()=>{if(!F||ve.length===0){Ne({title:"Missing Selections",description:"Please provide an image (generate or upload) and select at least one product type to visualize.",variant:"destructive"});return}let W;if(Se&&Se.name?W=`Uploaded: ${Se.name}`:z?W=z:W="Custom design",!Se&&!z){Ne({title:"Missing Prompt",description:"If not uploading an image, please enter a prompt to generate an image first.",variant:"destructive"});return}ae(!0),fe(""),kt([]);const[J,se]=F.split(","),G=J.match(/:(.*?);/)[1];let oe=!0;const we=[];for(const ke of ve)try{console.log("Attempting to visualize POD product:",ke.name);const Ue=await iU(se,G,ke.imageUrl,W,ke.name);if(Ue.visualizedImageData&&Ue.productDetails){const _e=`data:${Ue.visualizedImageMimeType};base64,${Ue.visualizedImageData}`;we.push({title:Ue.productDetails.title,price:parseFloat(Ue.productDetails.price).toFixed(2),description:Ue.productDetails.description,finalImageUrl:_e,baseProductName:ke.name,generatedImagePrompt:W,baseProductImageUrl:ke.imageUrl,sourceImageUsedForVisualization:F,tempId:`${ke.name}-${Date.now()}`}),console.log("POD Product visualized successfully:",ke.name)}else oe=!1,console.error("Visualization failed for product:",ke.name,Ue),fe(_e=>_e+`Visualization failed for ${ke.name}. `)}catch(Ue){oe=!1,console.error("Error visualizing POD product:",ke.name,Ue);const _e=Ue.message||`Failed to visualize ${ke.name}.`;fe(Q=>Q+_e+" ")}kt(we),oe?we.length>0&&Ne({title:"Visualization Complete",description:`${we.length} product(s) visualized. You can now add them to your store.`}):Ne({variant:"destructive",title:"Some Visualizations Failed",description:"Check errors below. Some products may not have visualized correctly."}),ae(!1)},Un=W=>{if(!W)return;const J={name:W.title,price:W.price,description:W.description,imageUrl:W.finalImageUrl,isPrintOnDemand:!0,podDetails:{...W}};delete J.podDetails.tempId,r(se=>({...se,products:{...se.products,items:[...se.products.items,J]}})),kt(se=>se.filter(G=>G.tempId!==W.tempId)),Xe.length===1&&Xe[0].tempId===W.tempId&&(Je([]),We("")),Ne({title:"Product Added",description:`"${J.name}" added to your store's products.`})},Xt=W=>{r(J=>({...J,products:{...J.products,items:J.products.items.filter((se,G)=>G!==W)}})),Ne({title:"Product Removed",description:"The Print on Demand product has been removed from your list.",variant:"destructive"})},[nn,Bn]=p.useState(!1),[q,te]=p.useState(null),le=(W,J,se)=>{r(G=>{const oe=[...G.collections.items];return oe[W][J]=se,{...G,collections:{...G.collections,items:oe}}})},Ie=()=>{r(W=>({...W,collections:{...W.collections,items:[...W.collections.items,{name:"",description:"",imageUrl:""}]}}))},Oe=W=>{r(J=>{const se=J.collections.items.filter((G,oe)=>oe!==W);return{...J,collections:{...J.collections,items:se}}})},ht=W=>{te(W),Bn(!0)},dt=(W,J)=>{r(se=>{const G=se.collections.items.map(oe=>oe.id&&oe.id===W||oe.name===W?{...oe,product_ids:J}:oe);return{...se,collections:{...se.collections,items:G}}}),Bn(!1),te(null)};switch(t){case 1:return a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"initialImportMethod",className:"text-lg font-semibold",children:"How would you like to start?"}),a.jsxs(ru,{onValueChange:A,value:n.initialImportMethod||"productType",children:[a.jsx(Dl,{id:"initialImportMethod",className:"mt-2",children:a.jsx(su,{placeholder:"Choose starting method..."})}),a.jsxs(Ml,{children:[a.jsx(Wn,{value:"productType",children:"Describe Product Type"}),a.jsx(Wn,{value:"photos",children:"Start from Product Photos"})]})]})]}),n.initialImportMethod==="productType"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(Re,{htmlFor:"productType",className:"text-md font-medium",children:"What kind of products will your store sell?"}),a.jsx(nt,{id:"productType",name:"productType",value:n.productType,onChange:W=>i(W.target.value),placeholder:"e.g., Fashion, Electronics, Home Decor",list:"productTypeSuggestions"}),a.jsx("datalist",{id:"productTypeSuggestions",children:j.map(W=>a.jsx("option",{value:W.label},W.value))}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This helps us tailor product suggestions and store design. Type to see suggestions."})]}),n.initialImportMethod==="photos"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(Re,{htmlFor:"productPhotosUpload",className:"text-md font-medium",children:"Upload Product Photos"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload multiple photos of your products. We'll use AI to understand them and pre-fill store details."}),a.jsx(nt,{id:"productPhotosUpload",type:"file",multiple:!0,accept:"image/*",onChange:D,className:`block w-full text-sm text-slate-500
                  file:mr-4 file:py-2 file:px-4
                  file:rounded-full file:border-0
                  file:text-sm file:font-semibold
                  file:bg-primary/10 file:text-primary
                  hover:file:bg-primary/20`,disabled:U}),U&&a.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing uploaded photos..."]}),R&&R.length>0&&a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Uploaded Photos (",R.length,"):"]}),a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3",children:R.map((W,J)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:W.previewUrl||W,alt:`Uploaded product ${J+1}`,className:"w-full aspect-square object-cover rounded-md border"}),a.jsx(V,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:()=>k(J),disabled:U,children:a.jsx(er,{className:"h-3.5 w-3.5"})})]},J))})]})]})]},"step1");case 2:return a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-4 w-full",children:[a.jsx(Re,{htmlFor:"storeName",className:"text-lg font-semibold",children:"What's your store name?"}),a.jsxs("div",{className:"relative flex items-center gap-2",children:[a.jsx(nt,{id:"storeName",name:"storeName",value:n.storeName,onChange:s,placeholder:"e.g., 'The Cozy Corner Bookstore'",className:"flex-grow pr-20"}),a.jsxs(V,{type:"button",variant:"ghost",size:"sm",onClick:O,disabled:!n.storeName||H,className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 px-2 z-10",children:[H?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(uo,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-1 hidden sm:inline",children:"Check"})]})]}),a.jsxs(V,{type:"button",variant:"outline",onClick:h,disabled:v||H||!n.productType,className:"w-full mt-2 sm:w-auto sm:mt-0",children:[v&&!H?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(Xr,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2",children:"Suggest Names"})]}),a.jsxs("div",{className:"h-5 mt-1",children:[" ",H&&n.storeName&&a.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[a.jsx(St,{className:"h-4 w-4 animate-spin mr-2"})," Checking..."]}),X&&n.storeName&&!H&&a.jsxs("p",{className:`text-sm font-medium ${X.status==="available"?"text-green-600":X.status==="claimed"?"text-red-600":X.status==="error"?"text-yellow-600":"text-muted-foreground"}`,children:[X.message==="Available"?a.jsx(uo,{className:"inline h-4 w-4 mr-1"}):"",X.message]})]}),!n.storeName&&!H&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:'Choose a catchy name or let us suggest one. Click "Check" to verify availability.'}),P&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:P}),C&&C.length>0&&a.jsxs("div",{className:"mt-3 space-y-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:C.map((W,J)=>a.jsx(V,{variant:"outline",size:"sm",onClick:()=>T(W),className:"bg-primary-foreground dark:bg-neutral-800 hover:bg-primary/10 dark:hover:bg-neutral-700",children:W},J))})]})]},"step2");case 3:return a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(Re,{className:"text-lg font-semibold",children:"Design a logo for your store"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center p-4 border rounded-md",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(Re,{className:"text-sm mb-2",children:"For Light Backgrounds"}),n.logoUrlDark?a.jsx("img",{src:n.logoUrlDark,alt:"Logo for light backgrounds",className:"w-48 h-48 object-contain rounded-md border bg-white"}):a.jsx("div",{className:"w-48 h-48 bg-gray-100 rounded-md flex items-center justify-center text-muted-foreground",children:"Light Bg Preview"})]}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(Re,{className:"text-sm mb-2",children:"For Dark Backgrounds"}),n.logoUrlLight?a.jsx("img",{src:n.logoUrlLight,alt:"Logo for dark backgrounds",className:"w-48 h-48 object-contain rounded-md border bg-gray-800"}):a.jsx("div",{className:"w-48 h-48 bg-gray-700 rounded-md flex items-center justify-center text-gray-400",children:"Dark Bg Preview"})]})]}),a.jsxs(V,{type:"button",onClick:f,disabled:v||!n.storeName,className:"w-full",children:[v?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(_a,{className:"mr-2 h-4 w-4"}),"Generate Logo with AI (Light & Dark Versions)"]}),a.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"AI will generate a logo, remove its background, and attempt to create light/dark mode versions."}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(Re,{className:"text-sm",children:"Manually set logos (optional):"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"logoUrlDarkUpload",className:"text-xs",children:"Logo for Light Background (e.g., black logo)"}),a.jsx(nt,{id:"logoUrlDarkUpload",type:"file",accept:"image/*",className:"mt-1 text-xs",onChange:async W=>{if(W.target.files&&W.target.files[0]){const J=W.target.files[0];try{const se=await ld(J);r(G=>({...G,logoUrlDark:se}))}catch(se){console.error("Error converting file for logoUrlDark:",se)}}}})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"logoUrlLightUpload",className:"text-xs",children:"Logo for Dark Background (e.g., white logo)"}),a.jsx(nt,{id:"logoUrlLightUpload",type:"file",accept:"image/*",className:"mt-1 text-xs",onChange:async W=>{if(W.target.files&&W.target.files[0]){const J=W.target.files[0];try{const se=await ld(J);r(G=>({...G,logoUrlLight:se}))}catch(se){console.error("Error converting file for logoUrlLight:",se)}}}})]})]})]}),(n.logoUrlLight||n.logoUrlDark)&&a.jsxs(V,{variant:"destructive",size:"sm",onClick:()=>r(W=>({...W,logoUrlLight:"",logoUrlDark:""})),className:"mt-4 w-full",children:[a.jsx(er,{className:"mr-2 h-4 w-4"})," Remove All Logos"]})]},"step3");case 4:return a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(Re,{className:"text-lg font-semibold",children:"How do you want to add products?"}),a.jsxs(ru,{onValueChange:o,value:n.products.source,children:[a.jsx(Dl,{children:a.jsx(su,{placeholder:"Choose product source..."})}),a.jsxs(Ml,{children:[a.jsx(Wn,{value:"ai",children:"Generate with AI"}),a.jsx(Wn,{value:"manual",children:"Add Manually"}),a.jsx(Wn,{value:"printOnDemand",children:"Print on Demand"}),a.jsx(Wn,{value:"csv",disabled:!0,children:"Upload CSV (Coming Soon)"})]})]}),n.products.source==="ai"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"productCount",children:"Number of AI Products to Generate"}),a.jsx(nt,{id:"productCount",type:"number",min:"1",max:"5",value:n.products.count,onChange:l})]}),a.jsxs(V,{type:"button",onClick:m,disabled:v||!n.productType||!n.storeName,className:"w-full",children:[v?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Xr,{className:"mr-2 h-4 w-4"}),"Generate Products with AI"]}),P&&n.products.source==="ai"&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:P}),n.products.items.length>0&&a.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2 mt-4",children:[" ",a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Generated Products:"}),n.products.items.map((W,J)=>a.jsxs(Ge,{className:"p-4 flex gap-4 items-start relative",children:[W.images&&W.images.length>0?a.jsx("img",{src:W.images[0],alt:W.name,className:"w-24 h-24 object-cover rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-md",children:W.name||"Untitled Product"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["$",W.price||"0.00"]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:W.description||"No description."}),W.variants&&W.variants.length>0&&a.jsx("div",{className:"mt-1.5",children:W.variants.map((se,G)=>a.jsxs("div",{className:"text-xs",children:[a.jsxs("span",{className:"font-medium text-muted-foreground",children:[se.name,": "]}),a.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:Array.isArray(se.values)?se.values.join(", "):se.values})]},G))})]}),a.jsx(V,{variant:"outline",size:"icon",className:"absolute top-2 right-2 h-8 w-8",onClick:()=>{Qe({...W}),Ve(J),de(!0)},children:a.jsx(wv,{className:"h-4 w-4"})})]},J))]})]}),ne&&re!==null&&n.products.items[re]&&a.jsx(i1e,{isOpen:ne,onClose:()=>{de(!1),Ve(null)},product:n.products.items[re],onSave:W=>{r(J=>{const se=[...J.products.items];return re!==null&&se[re]&&(se[re]=W),{...J,products:{...J.products,items:se}}}),de(!1),Qe(null),Ve(null),Ne({title:"Product Updated",description:`"${W.name}" has been updated.`})},onGenerateMainImage:x,onGenerateMoreAngles:E,productIndexInWizard:re,isGeneratingProductImage:_===re,isGeneratingAngles:I===re}),n.products.source==="manual"&&a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[" ",n.products.items.map((W,J)=>a.jsxs(Ge,{className:"p-4 space-y-3 relative",children:[a.jsx(V,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7",onClick:()=>d(J),disabled:n.products.items.length<=1,children:a.jsx(er,{className:"h-4 w-4 text-destructive"})}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`productName-${J}`,children:"Product Name"}),a.jsx(nt,{id:`productName-${J}`,value:W.name,onChange:se=>c(J,"name",se.target.value),placeholder:"e.g., 'Handmade Coffee Mug'"})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`productPrice-${J}`,children:"Price (USD)"}),a.jsx(nt,{id:`productPrice-${J}`,type:"number",value:W.price,onChange:se=>c(J,"price",se.target.value),placeholder:"e.g., '24.99'"})]})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`productDescription-${J}`,children:"Short Description (Optional)"}),a.jsx(Ln,{id:`productDescription-${J}`,value:W.description,onChange:se=>c(J,"description",se.target.value),placeholder:"e.g., 'Beautifully crafted ceramic mug, perfect for your morning coffee.'",rows:2})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 border rounded-md",children:[W.images&&W.images.length>0?a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:W.images.map((se,G)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:se,alt:`${W.name||"Product"} image ${G+1}`,className:"w-20 h-20 object-contain rounded-md border"}),a.jsx(V,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{const oe=W.images.filter((we,ke)=>ke!==G);c(J,"images",oe)},children:a.jsx(er,{className:"h-3 w-3"})})]},G))}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground mb-2",children:"No Images"}),a.jsx(Re,{htmlFor:`productImageUpload-${J}`,className:"text-sm sr-only",children:"Upload Product Images"}),a.jsx(nt,{id:`productImageUpload-${J}`,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:async se=>{if(se.target.files&&se.target.files.length>0){const oe=Array.from(se.target.files).map(we=>ld(we));try{const we=await Promise.all(oe),ke=[...W.images||[],...we];c(J,"images",ke)}catch(we){console.error("Error converting files to base64:",we),Ne({title:"Image Upload Error",description:"Could not process some images.",variant:"destructive"})}}}}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs(V,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`productImageUpload-${J}`).click(),children:[a.jsx(Fo,{className:"mr-2 h-4 w-4"})," Upload Images"]}),W.images&&W.images.length>0&&a.jsxs(V,{variant:"destructive",size:"sm",onClick:()=>c(J,"images",[]),children:[a.jsx(er,{className:"mr-2 h-4 w-4"})," Remove All"]}),a.jsxs(V,{type:"button",variant:"outline",size:"sm",onClick:()=>x(J),disabled:_===J||!W.name,children:[_===J?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Xr,{className:"mr-2 h-4 w-4"}),"Generate Main Image"]}),W.images&&W.images.length>0&&a.jsxs(V,{type:"button",variant:"outline",size:"sm",onClick:()=>E(J),disabled:I===J,children:[I===J?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Xr,{className:"mr-2 h-4 w-4"}),"Generate More Angles"]})]}),S&&_===J&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:S}),M&&I===J&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:M})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(W.variants||[]).map((se,G)=>a.jsxs(Ge,{className:"p-2 space-y-2 bg-muted/50",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Re,{htmlFor:`manualVariantName-${J}-${G}`,className:"text-xs",children:"Option Name"}),a.jsx(V,{variant:"ghost",size:"icon",onClick:()=>Fe(J,G),className:"h-6 w-6",children:a.jsx(er,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(nt,{id:`manualVariantName-${J}-${G}`,value:se.name||"",onChange:oe=>Te(J,G,oe.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(Re,{className:"text-xs",children:"Option Values"}),(se.values||[]).map((oe,we)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(nt,{value:oe||"",onChange:ke=>ut(J,G,we,ke.target.value),placeholder:"e.g., Red, Large",className:"text-sm h-8"}),a.jsx(V,{variant:"ghost",size:"icon",onClick:()=>he(J,G,we),className:"h-6 w-6",children:a.jsx(er,{className:"h-3 w-3 text-destructive"})})]},we)),a.jsxs(V,{variant:"outline",size:"sm",onClick:()=>pt(J,G),className:"text-xs h-7",children:[a.jsx(so,{className:"mr-1 h-3 w-3"})," Add Value"]})]},G)),a.jsxs(V,{variant:"outline",onClick:()=>be(J),className:"w-full text-sm h-8",children:[a.jsx(so,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]},J)),a.jsxs(V,{type:"button",variant:"outline",onClick:()=>{u()},className:"w-full",children:[a.jsx(so,{className:"mr-2 h-4 w-4"})," Add Another Product"]})]}),n.products.source==="printOnDemand"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-md font-semibold",children:"Configure Print on Demand Product"}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"podImagePrompt",children:"Image Generation Prompt"}),a.jsx(Ln,{id:"podImagePrompt",placeholder:"e.g., A majestic wolf howling at a vibrant aurora borealis",value:z,onChange:W=>Y(W.target.value),rows:2}),a.jsxs(V,{type:"button",onClick:Ft,disabled:v||Gt||!z||!!Se,className:"mt-2",variant:"outline",children:[Gt?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Xr,{className:"mr-2 h-4 w-4"}),"Generate Image"]}),a.jsxs(V,{type:"button",variant:"outline",className:"mt-2 ml-2",onClick:()=>document.getElementById("podReferenceImageUpload").click(),disabled:v||Gt||!!Se,children:[a.jsx(Fo,{className:"mr-2 h-4 w-4"})," Add Ref. Image"]}),a.jsx(nt,{id:"podReferenceImageUpload",type:"file",accept:"image/*",className:"hidden",onChange:Ht})]}),Ye&&a.jsxs("div",{className:"mt-2 flex flex-col items-start text-sm",children:[a.jsx(Re,{className:"mb-1",children:"Reference Image:"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:Ye,alt:"Reference preview",className:"w-16 h-16 object-contain rounded-md border bg-muted"}),a.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[150px]",children:xe==null?void 0:xe.name}),a.jsx(V,{type:"button",variant:"ghost",size:"icon",onClick:Tt,className:"h-7 w-7",children:a.jsx(er,{className:"h-4 w-4 text-destructive"})})]})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t",children:[a.jsx(Re,{htmlFor:"podImageUpload",children:"Or Upload Final Image for Product"}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(nt,{id:"podImageUpload",type:"file",accept:"image/*",onChange:Pe,className:"flex-grow",disabled:Gt}),F&&Se&&a.jsx(V,{type:"button",variant:"ghost",size:"icon",onClick:Yt,className:"h-9 w-9",children:a.jsx(er,{className:"h-4 w-4 text-destructive"})})]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"If you upload an image, it will be used instead of the generated one."})]}),me&&a.jsxs("div",{className:"mt-2 p-2 bg-destructive/10 border border-destructive/50 rounded-md text-destructive text-sm flex items-center gap-2",children:[a.jsx(Wp,{className:"h-5 w-5"}),a.jsx("p",{children:me})]}),F&&a.jsxs("div",{className:"mt-2 flex flex-col items-center",children:[a.jsx(Re,{className:"mb-1",children:"Image Preview:"}),a.jsx("img",{src:F,alt:"Generated preview",className:"w-40 h-40 object-contain rounded-md border bg-muted"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Re,{htmlFor:"podProductSearch",children:"Search Print on Demand Products"}),a.jsx(nt,{id:"podProductSearch",placeholder:"e.g., T-shirt, Mug",value:et,onChange:Sn,disabled:!F}),mt.length>0&&a.jsx(Ge,{className:"absolute z-10 w-full mt-1 max-h-48 overflow-y-auto border bg-background shadow-lg",children:mt.map(W=>{const J=ve.some(se=>se.name===W.name);return a.jsxs("div",{className:`p-2 hover:bg-muted cursor-pointer flex items-center gap-2 ${J?"bg-primary/10":""}`,onClick:()=>mn(W),children:[a.jsx("img",{src:W.imageUrl,alt:W.name,className:"w-8 h-8 object-contain rounded-sm"}),a.jsx("span",{children:W.name}),J&&a.jsx(uo,{className:"h-4 w-4 text-primary ml-auto"})]},W.name)})})]}),ve.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsx(Re,{className:"text-sm mb-1 block",children:"Selected Product Types:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ve.map(W=>a.jsxs(Fp,{variant:"secondary",className:"flex items-center gap-1.5 pr-1",children:[W.name,a.jsx(V,{variant:"ghost",size:"icon",className:"h-5 w-5 hover:bg-destructive/20",onClick:()=>mn(W),children:a.jsx(zo,{className:"h-3 w-3 text-destructive"})})]},W.name))})]}),a.jsxs(V,{type:"button",onClick:xr,disabled:v||sn||!F||ve.length===0,className:"w-full mt-2",children:[sn?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(_a,{className:"mr-2 h-4 w-4"}),`Visualize Design on ${ve.length} Product(s)`]}),Xe.length>0&&a.jsxs("div",{className:"mt-4 space-y-3",children:[a.jsx("h4",{className:"font-semibold text-md",children:"Visualized Products:"}),Xe.map(W=>a.jsxs(Ge,{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"flex gap-4 items-start",children:[a.jsx("img",{src:W.finalImageUrl,alt:W.title,className:"w-24 h-24 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("p",{className:"font-semibold",children:W.title}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Base: ",W.baseProductName]}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Price: $",W.price]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-3",children:W.description})]})]}),a.jsxs(V,{type:"button",onClick:()=>Un(W),className:"w-full bg-green-600 hover:bg-green-700",disabled:v,children:[a.jsx(so,{className:"mr-2 h-4 w-4"}),"Add This Product to Store"]})]},W.tempId))]}),n.products.items.filter(W=>W.isPrintOnDemand).length>0&&a.jsxs("div",{className:"mt-6 space-y-3",children:[a.jsx("p",{className:"text-md font-semibold",children:"Added Print on Demand Products:"}),a.jsxs("div",{className:"max-h-96 overflow-y-auto pr-2 space-y-3",children:[" ",n.products.items.map((W,J)=>W.isPrintOnDemand?a.jsxs(Ge,{className:"p-3 flex gap-3 items-start relative",children:[a.jsx("img",{src:W.imageUrl,alt:W.name,className:"w-20 h-20 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-sm",children:W.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",W.price]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:W.description})]}),a.jsx(V,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-6 w-6",onClick:()=>Xt(J),children:a.jsx(er,{className:"h-4 w-4 text-destructive"})})]},`pod-item-${J}`):null)]})]})]})]},"step4");case 5:return a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(Re,{className:"text-lg font-semibold",children:"How do you want to add collections?"}),a.jsxs(ru,{onValueChange:W=>r(J=>({...J,collections:{...J.collections,source:W}})),value:n.collections.source,children:[a.jsx(Dl,{children:a.jsx(su,{placeholder:"Choose collection source..."})}),a.jsxs(Ml,{children:[a.jsx(Wn,{value:"ai",children:"Generate with AI"}),a.jsx(Wn,{value:"manual",children:"Add Manually"})]})]}),P&&n.collections.source==="ai"&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:P}),ee&&n.collections.source==="manual"&&K===null&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:ee}),n.collections.source==="ai"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"collectionCount",children:"Number of AI Collections to Generate"}),a.jsx(nt,{id:"collectionCount",type:"number",min:"1",max:"5",value:n.collections.count,onChange:W=>r(J=>({...J,collections:{...J.collections,count:parseInt(W.target.value)||1}}))})]}),a.jsxs(V,{type:"button",onClick:g,disabled:v||!n.productType||!n.storeName||n.products.items.length===0,className:"w-full",children:[v?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Xr,{className:"mr-2 h-4 w-4"}),"Generate Collections with AI"]}),n.collections.items.length>0&&a.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2 mt-4",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Generated Collections:"}),n.collections.items.map((W,J)=>a.jsxs(Ge,{className:"p-4 flex gap-4 items-start",children:[W.imageUrl?a.jsx("img",{src:W.imageUrl,alt:W.name,className:"w-24 h-24 object-cover rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-md",children:W.name||"Untitled Collection"}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:W.description||"No description."})]}),a.jsx("div",{className:"flex flex-col gap-1",children:a.jsx(V,{variant:"outline",size:"sm",className:"text-xs h-auto py-1 mt-2",onClick:()=>ht(W),children:"Manage Products"})})]},J))]}),q&&a.jsx(r1e,{isOpen:nn,onClose:()=>{Bn(!1),te(null)},collection:q,allProducts:n.products.items,onSave:dt})]}),n.collections.source==="manual"&&a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Your Collections:"}),n.collections.items.map((W,J)=>a.jsxs(Ge,{className:"p-4 space-y-3 relative",children:[a.jsx(V,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7",onClick:()=>Oe(J),disabled:n.collections.items.length<=1&&!W.name&&!W.description&&!W.imageUrl,children:a.jsx(er,{className:"h-4 w-4 text-destructive"})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`collectionName-${J}`,children:"Collection Name"}),a.jsx(nt,{id:`collectionName-${J}`,value:W.name,onChange:se=>le(J,"name",se.target.value),placeholder:"e.g., 'Summer Collection'"})]})}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`collectionDescription-${J}`,children:"Short Description (Optional)"}),a.jsx(Ln,{id:`collectionDescription-${J}`,value:W.description,onChange:se=>le(J,"description",se.target.value),placeholder:"e.g., 'A curated selection of products perfect for the summer season.'",rows:2})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 border rounded-md",children:[W.imageUrl?a.jsx("img",{src:W.imageUrl,alt:W.name||"Collection image",className:"w-24 h-24 object-contain rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsx(Re,{htmlFor:`collectionImageUpload-${J}`,className:"text-sm sr-only",children:"Upload Collection Image"}),a.jsx(nt,{id:`collectionImageUpload-${J}`,type:"file",accept:"image/*",className:"hidden",onChange:async se=>{if(se.target.files&&se.target.files[0]){const G=se.target.files[0];try{const oe=await ld(G);le(J,"imageUrl",oe)}catch(oe){console.error("Error converting file to base64:",oe)}}}}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs(V,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`collectionImageUpload-${J}`).click(),children:[a.jsx(Fo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsxs(V,{type:"button",variant:"outline",size:"sm",onClick:()=>B(J),disabled:K===J||!W.name,children:[K===J?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Xr,{className:"mr-2 h-4 w-4"}),"Generate"]}),W.imageUrl&&a.jsxs(V,{variant:"destructive",size:"sm",onClick:()=>le(J,"imageUrl",""),children:[a.jsx(er,{className:"mr-1 h-3 w-3"})," Remove Img"]})]})]}),ee&&K===J&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:ee})]},J)),a.jsxs(V,{type:"button",variant:"outline",onClick:Ie,className:"w-full",children:[a.jsx(so,{className:"mr-2 h-4 w-4"})," Add Another Collection"]})]})]},"step5");case 6:return a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-4 w-full",children:[a.jsx(Re,{htmlFor:"prompt",className:"text-lg font-semibold",children:"Describe your store's overall style and feel"}),a.jsx(Ln,{id:"prompt",name:"prompt",value:n.prompt,onChange:s,placeholder:"e.g., 'A minimalist and modern design with a focus on high-quality product imagery. Use a cool color palette.' OR 'A vibrant and playful store with bold colors and fun animations.'",className:"min-h-[100px]"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This will influence the theme, layout, and imagery. Your store name, logo, and products are already included. You can also pick from the examples below."}),a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsx(Re,{className:"text-md font-semibold",children:"AI Prompt Examples:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"elegance",displayName:"Elegance",storeName:"Elegant Finds",promptText:"A sophisticated and elegant store experience, focusing on timeless design and high-quality craftsmanship. The aesthetic is refined, with a clean layout and luxurious feel, using a palette of soft neutrals, gold accents, and rich textures."},{key:"futuretech",displayName:"FutureTech",storeName:"Nexus Innovations",promptText:"A cutting-edge, futuristic store specializing in the latest technology and gadgets. The design is sleek, minimalist, and dark-themed with neon blue or cyan accents, interactive elements, and a high-tech vibe."},{key:"greenharvest",displayName:"GreenHarvest",storeName:"Evergreen Market",promptText:"An eco-friendly and organic store focusing on sustainable and natural products. The design should feel earthy, warm, and inviting, using natural materials, green and brown tones, and imagery of nature."},{key:"urbanthreads",displayName:"UrbanThreads",storeName:"Metro Threads Co.",promptText:"A trendy, urban streetwear store with a gritty yet stylish aesthetic. Think industrial-chic, graffiti art influences, bold typography, and a dynamic, energetic feel. Muted colors with pops of vibrant color."}].map(W=>a.jsx(V,{variant:"outline",size:"sm",onClick:()=>{e.setFormData(J=>({...J,storeName:W.storeName,prompt:W.promptText}))},className:"bg-primary-foreground dark:bg-neutral-800 hover:bg-primary/10 dark:hover:bg-neutral-700",children:W.displayName},W.key))})]})]},"step6");default:return null}},a1e=(t,e,n)=>!!(t===1&&(e.initialImportMethod==="productType"&&!e.productType||e.initialImportMethod==="photos"&&(!n||n.length===0))||t===2&&!e.storeName||t===4&&(e.products.source==="manual"&&e.products.items.some(r=>!r.name||!r.price)||e.products.source==="ai"&&e.products.items.length===0&&e.products.count>0)||t===5&&(e.collections.source==="ai"&&e.collections.items.length===0&&e.collections.count>0||e.collections.source==="manual"&&e.collections.items.some(r=>!r.name))||t===6&&!e.prompt),l1e=()=>{const t=bi(),[e,n]=p.useState(1),[r,s]=p.useState([]),[i,o]=p.useState({initialImportMethod:"productType",productType:"",storeName:"",logoUrlLight:"",logoUrlDark:"",products:{source:"ai",count:3,items:[]},collections:{source:"ai",count:3,items:[]},prompt:""}),[l,c]=p.useState([]),[u,d]=p.useState(!1),[h,f]=p.useState(!1),[m,g]=p.useState(null),[x,E]=p.useState(null),[v,_]=p.useState(null),[S,I]=p.useState(null),[M,j]=p.useState(null),[C,T]=p.useState(null),[P,A]=p.useState(null),[D,R]=p.useState(!1),[k,U]=p.useState(null),{generateStoreFromWizard:B,isGenerating:K,checkStoreNameAvailability:ee}=$n(),H=async()=>{if(!i.storeName){U({status:"error",message:"Please enter a store name to check."});return}R(!0),U(null),g(null);try{const ae=await UG(i.storeName);U(ae?{status:"claimed",message:"Not available"}:{status:"available",message:"Available"})}catch(ae){console.error("Store name availability check failed:",ae),U({status:"error",message:ae.message||"Could not check store name. Please try again."})}finally{R(!1)}};p.useEffect(()=>{if(i.storeName&&m){const ae=m.toLowerCase();ae.includes("store name")&&(ae.includes("empty")||ae.includes("required"))&&g(null)}if(i.storeName&&e===2){const ae=setTimeout(async()=>{},750);return()=>{clearTimeout(ae)}}else!i.storeName&&e===2&&U(null)},[i.storeName,e,m]);const X=ae=>{o(me=>({...me,initialImportMethod:ae,productType:ae==="photos"?"":me.productType})),ae==="productType"&&c([])},O=ae=>new Promise((me,fe)=>{const Ne=new FileReader;Ne.onload=()=>me(Ne.result),Ne.onerror=fe,Ne.readAsDataURL(ae)}),z=async ae=>{const me=Array.from(ae.target.files);if(me.length===0)return;const fe=10;if(l.length+me.length>fe){g(`You can upload a maximum of ${fe} photos.`);return}g(null);const Ne=me.map(async de=>{try{const Ee=await O(de);return{file:de,previewUrl:URL.createObjectURL(de),base64:Ee,name:de.name,type:de.type}}catch(Ee){return console.error("Error processing file:",de.name,Ee),null}}),ne=(await Promise.all(Ne)).filter(Boolean);if(c(de=>{const Ee=[...de,...ne];return de.forEach(Qe=>{Qe.previewUrl&&Qe.previewUrl.startsWith("blob:")}),Ee}),i.initialImportMethod==="photos"&&ne.length>0){d(!0),g(null);try{const de=l.concat(ne).map(Qe=>({base64:Qe.base64,mimeType:Qe.type,name:Qe.name})),Ee=await XTe(de);Ee.error?g(Ee.error):(o(Qe=>({...Qe,productType:Ee.productType||Qe.productType,storeName:Ee.storeNameSuggestions&&Ee.storeNameSuggestions.length>0?Ee.storeNameSuggestions[0]:Qe.storeName,products:{source:"manual",count:Ee.products.length,items:Ee.products.map(re=>({name:re.name||"",price:re.price||"",description:re.description||"",images:re.images||[],variants:[],isFromPhotoAI:!0}))},collections:{source:"manual",count:Ee.collections.length,items:Ee.collections.map(re=>({name:re.name||"",description:re.description||"",imageUrl:"",product_ids:[],isFromPhotoAI:!0}))},prompt:Ee.storePrompt||Qe.prompt})),Ee.storeNameSuggestions&&Ee.storeNameSuggestions.length>0&&s(Ee.storeNameSuggestions),Ee.logoDescription&&console.log("AI Logo Description:",Ee.logoDescription))}catch(de){console.error("Error processing photos with AI:",de),g(`Failed to process images with AI: ${de.message}`)}finally{d(!1)}}},Y=ae=>{c(me=>{const fe=me[ae];return fe&&fe.previewUrl&&fe.previewUrl.startsWith("blob:")&&URL.revokeObjectURL(fe.previewUrl),me.filter((Ne,ne)=>ne!==ae)})},F=ae=>{const{name:me,value:fe}=ae.target;o(Ne=>({...Ne,[me]:fe}))},ye=ae=>{o(me=>({...me,productType:ae}))},Se=ae=>{o(me=>({...me,products:{...me.products,source:ae}}))},De=ae=>{o(me=>({...me,products:{...me.products,count:parseInt(ae.target.value)||1}}))},xe=(ae,me,fe)=>{const Ne=[...i.products.items];Ne[ae][me]=fe,o(ne=>({...ne,products:{...ne.products,items:Ne}}))},Me=()=>{o(ae=>({...ae,products:{...ae.products,items:[...ae.products.items,{name:"",price:"",description:"",images:[]}]}}))},Ye=ae=>{const me=i.products.items.filter((fe,Ne)=>Ne!==ae);o(fe=>({...fe,products:{...fe.products,items:me}}))},qe=async()=>{var ae;if(!i.productType){g("Please select a product type first.");return}f(!0),s([]),g(null);try{const me=((ae=lL.find(Ne=>Ne.value===i.productType))==null?void 0:ae.label)||i.productType,fe=await E3(me);fe.error?(console.error("Failed to suggest store names:",fe.error),g(fe.error),s([])):fe.suggestions&&fe.suggestions.length>0?s(fe.suggestions):(g("No suggestions received, or response was empty."),s([]))}catch(me){console.error("Error in suggestStoreNameHandler:",me),g(`An unexpected error occurred: ${me.message}`),s([])}f(!1)},et=ae=>{o(me=>({...me,storeName:ae})),s([])},We=async()=>{if(!i.storeName){console.warn("Store name is required to generate a logo."),g("Please ensure a store name is set before generating a logo.");return}f(!0),g(null);try{const ae=await Yp(i.storeName);ae&&(ae.logoUrlLight||ae.logoUrlDark)?(o(me=>({...me,logoUrlLight:ae.logoUrlLight||"",logoUrlDark:ae.logoUrlDark||""})),console.log("Logos generated and URLs set:",ae),ae.textResponse&&console.log("Gemini text response for logo generation:",ae.textResponse)):(console.error("Failed to generate logos: No image data received for either version."),g("Failed to generate logo. The AI did not return sufficient image data."))}catch(ae){console.error("Failed to generate logos:",ae),g(`Logo generation failed: ${ae.message}`)}f(!1)},mt=async()=>{if(!i.productType||!i.storeName){g("Please provide a product type and store name before generating AI products.");return}f(!0),g(null);const ae=[];try{let me=null,fe="image/png";const Ne=i.logoUrlLight||i.logoUrlDark;if(Ne&&Ne.startsWith("data:")){const ne=Ne.split(",");if(ne.length===2){const de=ne[0];me=ne[1];const Ee=de.match(/:(.*?);/);Ee&&Ee[1]&&(fe=Ee[1]),console.log(`[StoreWizard] Using primary logo (${Ne===i.logoUrlLight?"Light version":"Dark version"}) for product generation. MimeType: ${fe}`)}else console.warn("[StoreWizard] Primary logo URL is not a valid data URL format.")}for(let ne=0;ne<i.products.count;ne++){console.log(`Generating AI product ${ne+1} of ${i.products.count}...`);const de=await zG(i.productType,i.storeName,me,fe);de&&de.images&&de.images.length>0?ae.push({name:de.title,description:de.description,price:de.price,images:de.images,variants:de.variants||[]}):console.warn(`Failed to generate full data (including image) for product ${ne+1}. Skipping.`)}o(ne=>({...ne,products:{...ne.products,items:ae}})),ae.length===0&&i.products.count>0&&g("AI failed to generate any products. Please try again or adjust settings.")}catch(me){console.error("Error generating AI products:",me),g(`Failed to generate AI products: ${me.message}`)}f(!1)},Le=async()=>{if(!i.productType||!i.storeName||i.products.items.length===0){g("Please ensure product type, store name, and at least one product are set before generating AI collections.");return}f(!0),g(null);const ae=[],me=i.collections.items.map(fe=>fe.name);try{for(let fe=0;fe<i.collections.count;fe++){console.log(`Generating AI collection ${fe+1} of ${i.collections.count}...`);const Ne=await GG(i.productType,i.storeName,i.products.items,me);if(Ne&&!Ne.error&&Ne.name&&Ne.description&&Ne.product_ids){let ne=`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(Ne.name||"Collection")}`;Ne.imageData&&(ne=`data:image/png;base64,${Ne.imageData}`),ae.push({name:Ne.name,description:Ne.description,imageUrl:ne,product_ids:Ne.product_ids}),Ne.name&&me.push(Ne.name)}else console.warn(`Failed to generate full data for collection ${fe+1}. Skipping.`)}o(fe=>({...fe,collections:{...fe.collections,items:ae}})),ae.length===0&&i.collections.count>0&&g("AI failed to generate any collections. Please try again or adjust settings.")}catch(fe){console.error("Error generating AI collections:",fe),g(`Failed to generate AI collections: ${fe.message}`)}f(!1)},ve=async ae=>{const me=i.products.items[ae];if(!me||!me.name){_("Product name is required to generate an image.");return}E(ae),_(null);try{const fe=await rU(me.name,me.description);if(fe&&fe.imageData){const Ne=`data:image/png;base64,${fe.imageData}`,ne=[...i.products.items];ne[ae].images=[Ne],o(de=>({...de,products:{...de.products,items:ne}}))}else throw new Error(fe.textResponse||"Failed to generate product image data.")}catch(fe){console.error(`Error generating image for product ${ae}:`,fe),_(fe.message)}finally{E(null)}},Je=async ae=>{const me=i.products.items[ae];if(!me||!me.images||me.images.length===0){j("At least one image must be uploaded or generated first to create more angles.");return}const fe=me.images[0];I(ae),j(null);try{const{generateDifferentAnglesFromImage:Ne}=await jt(()=>Promise.resolve().then(()=>qoe),void 0),ne=fe.split(",");if(ne.length!==2)throw new Error("Invalid base image URL format for angle generation.");const de=ne[0],Ee=ne[1],Qe=de.match(/:(.*?);/);if(!Qe||!Qe[1])throw new Error("Could not determine mime type from base image URL.");const re=Qe[1],Ve=await Ne(Ee,re,me.name||"Product"),Te=[...i.products.items],ut=Te[ae].images||[];Te[ae].images=[...ut,...Ve.filter(pt=>!ut.includes(pt))],o(pt=>({...pt,products:{...pt.products,items:Te}}))}catch(Ne){console.error(`Error generating more angles for product ${ae}:`,Ne),j(Ne.message||"Failed to generate additional angles.")}finally{I(null)}},Xe=async ae=>{const me=i.collections.items[ae];if(!me||!me.name){A("Collection name is required to generate an image.");return}T(ae),A(null),g(null);try{const fe=await oU(me.name,me.description);if(fe&&fe.imageData&&fe.imageMimeType){const Ne=`data:${fe.imageMimeType};base64,${fe.imageData}`,ne=[...i.collections.items];ne[ae].imageUrl=Ne,o(de=>({...de,collections:{...de.collections,items:ne}}))}else throw new Error(fe.textResponse||"Failed to generate collection image data.")}catch(fe){console.error(`Error generating image for collection ${ae} ("${me.name}"):`,fe),A(fe.message||"Unknown error during collection image generation.");const Ne=[...i.collections.items];Ne[ae].imageUrl="",o(ne=>({...ne,collections:{...ne.collections,items:Ne}}))}finally{T(null)}},kt=()=>n(ae=>ae+1),Gt=()=>n(ae=>ae-1),fn=async()=>{f(!0),g(null);try{const ae={name:i.storeName,niche:i.productType,description:i.prompt},me=await C3(ae);me.error&&console.warn("Failed to generate hero content:",me.error);const fe=await T3(ae);fe.error&&console.warn("Failed to generate store way content:",fe.error);const Ne=await I3(ae);Ne.error&&console.warn("Failed to generate store features content:",Ne.error);const ne={...i,content:{...i.content||{},hero:me&&!me.error?me:void 0,storeWay:fe&&!fe.error?fe:void 0,storeFeatures:Ne&&!Ne.error?Ne:void 0}},de=await B(ne);if(de){const Ee=`/${de.urlSlug||nu(de.name)}`;t(Ee)}}catch(ae){console.error("Error during final store generation steps or navigation:",ae),g(`An error occurred during final store setup: ${ae.message}`)}finally{f(!1)}},sn={formData:i,setFormData:o,handleInputChange:F,handleProductTypeChange:ye,handleProductSourceChange:Se,handleProductCountChange:De,handleManualProductChange:xe,addManualProduct:Me,removeManualProduct:Ye,suggestStoreName:qe,generateLogo:We,generateAiProducts:mt,generateAiCollections:Le,handleGenerateManualProductImage:ve,handleGenerateMoreAngles:Je,isProcessing:h,isGeneratingProductImageForIndex:x,productImageGenerationError:v,isGeneratingAnglesForIndex:S,angleGenerationError:M,productTypeOptions:lL,storeNameSuggestions:r,handleSuggestionClick:et,suggestionError:m,handleInitialImportMethodChange:X,handleProductPhotoUpload:z,uploadedProductPhotos:l,removeUploadedProductPhoto:Y,isProcessingPhotos:u,handleGenerateCollectionImage:Xe,isGeneratingCollectionImageForIndex:C,collectionImageGenerationError:P,isCheckingStoreName:D,storeNameAvailability:k,handleManualStoreNameCheck:H};return a.jsxs("div",{className:"w-full max-w-2xl mx-auto",children:[" ",a.jsxs(rt,{children:[a.jsx(st,{className:"text-2xl font-bold",children:"Store Creation Wizard"}),a.jsxs(Wt,{children:["Step ",e," of 6: Let's build your online store together!"]}),a.jsx("div",{className:"w-full bg-green-200 dark:bg-green-800 rounded-full h-2.5 mt-2",children:a.jsx(Ct.div,{className:"bg-green-600 dark:bg-green-500 h-2.5 rounded-full",initial:{width:"0%"},animate:{width:`${e/6*100}%`},transition:{duration:.5,ease:"easeInOut"}})})]}),a.jsx(Ze,{className:"min-h-[250px] flex items-center",children:a.jsx(_h,{mode:"wait",children:o1e(e,sn)})}),a.jsxs(Lu,{className:"flex justify-between",children:[a.jsxs(V,{variant:"outline",onClick:Gt,disabled:e===1||K||u,children:[a.jsx(Vl,{className:"mr-2 h-4 w-4"})," Previous"]}),e<6?a.jsxs(V,{onClick:kt,disabled:a1e(e,i,l)||K||u,children:["Next ",a.jsx(cp,{className:"ml-2 h-4 w-4"})]}):a.jsxs(V,{onClick:fn,disabled:h||K||u||!i.prompt,children:[h||K?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(_a,{className:"mr-2 h-4 w-4"}),"Generate Store"]})]})]})},c1e=()=>{const[t,e]=p.useState(!1),[n,r]=p.useState(!1),[s,i]=p.useState(null),[o,l]=p.useState("ai-prompt");qi();const[c,u]=p.useState(!1);p.useState(!1),p.useState(null);const d=()=>{e(!0)},h=()=>{e(!1)},f=g=>{i(g),e(!1),r(!0)},m=()=>{r(!1),i(null)};return p.useEffect(()=>{let g,x;return g=setInterval(()=>{u(!0),x=setTimeout(()=>{u(!1)},2500)},5e3),()=>{clearInterval(g),clearTimeout(x)}},[]),a.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[" ",a.jsx(BP,{}),a.jsxs(Ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"flex-1 container mx-auto px-4 py-8",children:[a.jsxs(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-10",children:[a.jsx("h1",{className:`text-4xl md:text-5xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-gray-600 to-gray-200 dark:from-gray-500 dark:to-gray-300 ${c?"animate-shimmer bg-200%":"bg-auto"}`,children:"Start Fresh"}),a.jsxs("p",{className:"text-lg font-inter text-muted-foreground max-w-3xl mx-auto",children:["You can create a store 3 ways: ",a.jsx("br",{})," Prompt, Steps or Import."]})]}),a.jsxs(Ei,{value:o,onValueChange:l,className:"w-full max-w-3xl mx-auto mb-12",children:[a.jsxs(Qs,{className:"grid w-full grid-cols-2 md:grid-cols-3 mb-6",children:[a.jsxs(Bt,{value:"ai-prompt",children:[a.jsx("span",{className:"hidden sm:inline",children:"AI Prompt"}),a.jsx("span",{className:"sm:hidden",children:"AI Prompt"})]}),a.jsxs(Bt,{value:"wizard",children:[a.jsx("span",{className:"hidden sm:inline",children:"Step-by-Step"}),a.jsx("span",{className:"sm:hidden",children:"Steps"})]}),a.jsx(Bt,{value:"store-import",className:"hidden md:inline-flex",onClick:d,children:"Import Store"})]}),a.jsx(zt,{value:"ai-prompt",children:a.jsx(CEe,{})}),a.jsx(zt,{value:"wizard",children:a.jsx(l1e,{})}),a.jsxs(zt,{value:"store-import",className:"text-center py-8",children:[" ",a.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Import data from Shopify or BigCommerce."})," ",a.jsxs(V,{onClick:d,variant:"default",size:"lg",children:[a.jsx(Tj,{className:"mr-2 h-5 w-5"}),"Select Import Source"]})]})]}),a.jsxs("div",{className:"mb-8 flex justify-center md:hidden",children:[" ",a.jsxs(V,{onClick:d,variant:"outline",size:"lg",className:"w-full max-w-xs",children:[a.jsx(Tj,{className:"mr-2 h-5 w-5"}),"Import Store Data"]})]}),a.jsx(BEe,{})]}),a.jsx("footer",{className:"mt-auto py-6 text-center text-sm text-muted-foreground",children:a.jsxs("p",{children:["© ",new Date().getFullYear()," FreshFront. All rights reserved."]})}),t&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx(QEe,{onSelectSource:f,onClose:h})}),s&&a.jsx(XEe,{isOpen:n,onClose:m,initialImportSource:s})]})},u1e=()=>{const{user:t}=qi();return a.jsxs("div",{className:"min-h-screen flex flex-col",children:[a.jsx(BP,{}),a.jsxs("main",{className:"flex-1 container mx-auto px-4 py-8",children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Admin Dashboard"}),a.jsxs("p",{className:"mb-4",children:["Welcome, ",(t==null?void 0:t.email)||"Admin","!"]}),a.jsxs("div",{className:"bg-card p-6 rounded-lg shadow",children:[a.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Admin-Specific Content"}),a.jsx("p",{children:"This area is restricted to administrators. Here you can manage users, view all stores, access Stripe data, etc."}),a.jsx("div",{className:"mt-4 p-4 border border-dashed rounded",children:"Admin tools and data will be displayed here."})]})]}),a.jsx("footer",{className:"mt-auto py-6 text-center text-sm text-muted-foreground",children:a.jsxs("p",{children:["© ",new Date().getFullYear()," FreshFront - Admin Panel"]})})]})},d1e=({store:t,onEdit:e,currentTemplate:n,onTemplateChange:r,availableTemplates:s=[]})=>{const i=bi(),{toast:o}=Ls(),{viewMode:l,setViewMode:c,currentStore:u,updateStore:d,updateStoreTemplateVersion:h}=$n(),f=()=>{t&&t.name?(navigator.clipboard.writeText(`${window.location.origin}/${t.name}`),o({title:"Link Copied",description:"Store link has been copied to clipboard."})):o({title:"Error",description:"Could not copy link: Store name not available.",variant:"destructive"})},m=()=>{const _=l==="edit"?"published":"edit";c(_),o({title:`Switched to ${_==="published"?"Consumer View":"Admin View"}`,description:`Store is now in ${_==="published"?"consumer":"admin editing"} mode.`})},g=_=>{r&&r(_)},x=async _=>{let S=_;if(_==="classic"&&(S="v1"),t&&t.id&&S&&S!==t.template_version)try{await h(t.id,S),o({title:"Template Saved",description:`Store template successfully changed to ${_}.`,className:"bg-green-500 text-white"})}catch(I){console.error("Failed to save template:",I),o({title:"Save Failed",description:"Could not save the template change. Please try again.",variant:"destructive"})}else S===t.template_version&&o({title:"No Change",description:`Store is already using the ${_} template.`})},E=()=>{l!=="edit"&&c("edit"),e()},v=async()=>{if(t&&t.id)try{await d(t.id,{published_at:new Date().toISOString(),status:"published"}),o({title:"Store Published!",description:`${t.name} is now live.`,className:"bg-green-500 text-white"})}catch(_){console.error("Failed to publish store:",_),o({title:"Publish Failed",description:"Could not publish the store. Please try again.",variant:"destructive"})}};return l==="published"?a.jsx("button",{onClick:()=>c("edit"),className:"fixed bottom-4 left-4 p-2 z-50 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:"Open Admin Controls","aria-label":"Open Admin Controls",children:a.jsx(up,{className:"h-6 w-6 text-gray-500 opacity-50 hover:opacity-75 dark:text-gray-400"})}):a.jsx(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"fixed bottom-0 left-0 right-0 bg-background/80 backdrop-blur-md border-t z-50 py-3",children:a.jsxs("div",{className:"container mx-auto px-4 flex items-center justify-between",children:[a.jsxs(V,{variant:"outline",size:"icon",onClick:()=>i("/"),title:"Back",children:[a.jsx(Vl,{className:"h-4 w-4"})," "]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(V,{variant:"outline",size:"icon",onClick:f,title:"Copy Link",children:[a.jsx(N$,{className:"h-4 w-4"})," "]}),a.jsx(V,{asChild:!0,variant:"outline",size:"sm",disabled:!t||!t.name,children:a.jsx(Ns,{to:t&&t.name?`/${t.name}/dashboard`:"#",children:"Dashboard"})}),a.jsx(V,{asChild:!0,size:"sm",variant:"outline",disabled:!u||!u.name,children:a.jsxs(Ns,{to:u&&u.name?`/${u.name}/content-creation`:"#",state:{storeData:u},children:[a.jsx(Xr,{className:"mr-2 h-4 w-4"}),"Create"]})}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs(ru,{value:n||"",onValueChange:g,children:[a.jsxs(Dl,{className:"w-[180px] h-9 text-sm",children:[a.jsx(B1,{className:"mr-2 h-4 w-4"}),a.jsx(su,{placeholder:"Switch Template"})]}),a.jsx(Ml,{children:s.map(_=>a.jsx(Wn,{value:_,children:_.charAt(0).toUpperCase()+_.slice(1)},_))})]}),n&&n!==(t==null?void 0:t.template_version)&&a.jsx(V,{variant:"outline",size:"icon",className:"h-9 w-9 border-green-500 text-green-500 hover:bg-green-50 hover:text-green-600",onClick:()=>x(n),title:`Save ${n.charAt(0).toUpperCase()+n.slice(1)} Template`,children:a.jsx(qp,{className:"h-4 w-4"})})]}),a.jsxs(V,{size:"sm",onClick:E,children:[a.jsx(_v,{className:"mr-2 h-4 w-4"}),"Edit"]}),a.jsxs(V,{size:"sm",onClick:m,variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-50 hover:text-green-700",children:[a.jsx($se,{className:"mr-2 h-4 w-4"})," Customer"]}),a.jsxs(V,{size:"sm",onClick:v,className:"bg-green-500 hover:bg-green-600 text-white",children:[a.jsx(Fo,{className:"mr-2 h-4 w-4"}),"Publish"]})]})]})})},h1e=({store:t,open:e,onOpenChange:n})=>{var h;bi();const{updateStore:r,isLoadingStores:s}=$n(),[i,o]=p.useState({name:t.name,description:t.description,type:t.type,theme:{primaryColor:t.theme.primaryColor,secondaryColor:t.theme.secondaryColor,fontFamily:t.theme.fontFamily,layout:t.theme.layout},settings:{showThemeToggle:((h=t.settings)==null?void 0:h.showThemeToggle)??!0}}),l=f=>{const{name:m,value:g}=f.target;o(x=>({...x,[m]:g}))},c=(f,m)=>{o(g=>({...g,theme:{...g.theme,[f]:m}}))},u=(f,m)=>{o(g=>({...g,settings:{...g.settings,[f]:m}}))},d=f=>{f.preventDefault();const m={name:i.name,description:i.description,type:i.type,theme:i.theme,settings:i.settings};r(t.id,m),n(!1)};return a.jsx(ys,{open:e,onOpenChange:n,children:a.jsxs(es,{className:"sm:max-w-[600px]",children:[a.jsxs(ts,{children:[a.jsx(ns,{children:"Edit Store"}),a.jsx(xo,{children:"Customize your store's details and appearance."})]}),a.jsxs("form",{onSubmit:d,className:"space-y-6 py-4",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"name",children:"Store Name"}),a.jsx(nt,{id:"name",name:"name",value:i.name,onChange:l,required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"description",children:"Description"}),a.jsx(Ln,{id:"description",name:"description",value:i.description,onChange:l,rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"type",children:"Store Type"}),a.jsxs(ru,{value:i.type,onValueChange:f=>o(m=>({...m,type:f})),children:[a.jsx(Dl,{id:"type",children:a.jsx(su,{placeholder:"Select store type"})}),a.jsxs(Ml,{children:[a.jsx(Wn,{value:"fashion",children:"Fashion"}),a.jsx(Wn,{value:"electronics",children:"Electronics"}),a.jsx(Wn,{value:"food",children:"Food"}),a.jsx(Wn,{value:"jewelry",children:"Jewelry"}),a.jsx(Wn,{value:"general",children:"General"})]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-sm font-medium",children:"Theme Settings"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"primaryColor",children:"Primary Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(nt,{id:"primaryColor",name:"primaryColor",type:"color",value:i.theme.primaryColor,onChange:f=>c("primaryColor",f.target.value),className:"w-12 h-10 p-1"}),a.jsx(nt,{value:i.theme.primaryColor,onChange:f=>c("primaryColor",f.target.value),className:"flex-1"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"secondaryColor",children:"Secondary Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(nt,{id:"secondaryColor",name:"secondaryColor",type:"color",value:i.theme.secondaryColor,onChange:f=>c("secondaryColor",f.target.value),className:"w-12 h-10 p-1"}),a.jsx(nt,{value:i.theme.secondaryColor,onChange:f=>c("secondaryColor",f.target.value),className:"flex-1"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"fontFamily",children:"Font Family"}),a.jsxs(ru,{value:i.theme.fontFamily,onValueChange:f=>c("fontFamily",f),children:[a.jsx(Dl,{id:"fontFamily",children:a.jsx(su,{placeholder:"Select font"})}),a.jsxs(Ml,{children:[a.jsx(Wn,{value:"Inter",children:"Inter"}),a.jsx(Wn,{value:"Roboto",children:"Roboto"}),a.jsx(Wn,{value:"Poppins",children:"Poppins"}),a.jsx(Wn,{value:"Montserrat",children:"Montserrat"}),a.jsx(Wn,{value:"Open Sans",children:"Open Sans"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"layout",children:"Layout Style"}),a.jsxs(ru,{value:i.theme.layout,onValueChange:f=>c("layout",f),children:[a.jsx(Dl,{id:"layout",children:a.jsx(su,{placeholder:"Select layout"})}),a.jsxs(Ml,{children:[a.jsx(Wn,{value:"grid",children:"Grid"}),a.jsx(Wn,{value:"list",children:"List"}),a.jsx(Wn,{value:"masonry",children:"Masonry"}),a.jsx(Wn,{value:"carousel",children:"Carousel"})]})]})]}),a.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[a.jsx(Re,{htmlFor:"showThemeToggle",className:"flex items-center",children:"Show Light/Dark Mode Toggle in Store Header"}),a.jsx(Do,{id:"showThemeToggle",checked:i.settings.showThemeToggle,onCheckedChange:f=>u("showThemeToggle",f),disabled:s}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Allows customers to switch between light and dark themes on your store page."})]})]})]})]}),a.jsx(Tr,{children:a.jsx(V,{type:"submit",disabled:s,children:"Save Changes"})})]})]})})};function f1e(t,e){const n=e||{};return(t[t.length-1]===""?[...t,""]:t).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const m1e=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,p1e=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,g1e={};function cL(t,e){return((e||g1e).jsx?p1e:m1e).test(t)}const y1e=/[ \t\n\f\r]/g;function x1e(t){return typeof t=="object"?t.type==="text"?uL(t.value):!1:uL(t)}function uL(t){return t.replace(y1e,"")===""}class Ng{constructor(e,n,r){this.normal=n,this.property=e,r&&(this.space=r)}}Ng.prototype.normal={};Ng.prototype.property={};Ng.prototype.space=void 0;function UH(t,e){const n={},r={};for(const s of t)Object.assign(n,s.property),Object.assign(r,s.normal);return new Ng(n,r,e)}function vT(t){return t.toLowerCase()}class Zs{constructor(e,n){this.attribute=n,this.property=e}}Zs.prototype.attribute="";Zs.prototype.booleanish=!1;Zs.prototype.boolean=!1;Zs.prototype.commaOrSpaceSeparated=!1;Zs.prototype.commaSeparated=!1;Zs.prototype.defined=!1;Zs.prototype.mustUseProperty=!1;Zs.prototype.number=!1;Zs.prototype.overloadedBoolean=!1;Zs.prototype.property="";Zs.prototype.spaceSeparated=!1;Zs.prototype.space=void 0;let v1e=0;const Zt=Uu(),Sr=Uu(),wT=Uu(),Ke=Uu(),Dn=Uu(),ah=Uu(),si=Uu();function Uu(){return 2**++v1e}const _T=Object.freeze(Object.defineProperty({__proto__:null,boolean:Zt,booleanish:Sr,commaOrSpaceSeparated:si,commaSeparated:ah,number:Ke,overloadedBoolean:wT,spaceSeparated:Dn},Symbol.toStringTag,{value:"Module"})),wS=Object.keys(_T);class KP extends Zs{constructor(e,n,r,s){let i=-1;if(super(e,n),dL(this,"space",s),typeof r=="number")for(;++i<wS.length;){const o=wS[i];dL(this,wS[i],(r&_T[o])===_T[o])}}}KP.prototype.defined=!0;function dL(t,e,n){n&&(t[e]=n)}function rf(t){const e={},n={};for(const[r,s]of Object.entries(t.properties)){const i=new KP(r,t.transform(t.attributes||{},r),s,t.space);t.mustUseProperty&&t.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),e[r]=i,n[vT(r)]=r,n[vT(i.attribute)]=r}return new Ng(e,n,t.space)}const BH=rf({properties:{ariaActiveDescendant:null,ariaAtomic:Sr,ariaAutoComplete:null,ariaBusy:Sr,ariaChecked:Sr,ariaColCount:Ke,ariaColIndex:Ke,ariaColSpan:Ke,ariaControls:Dn,ariaCurrent:null,ariaDescribedBy:Dn,ariaDetails:null,ariaDisabled:Sr,ariaDropEffect:Dn,ariaErrorMessage:null,ariaExpanded:Sr,ariaFlowTo:Dn,ariaGrabbed:Sr,ariaHasPopup:null,ariaHidden:Sr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Dn,ariaLevel:Ke,ariaLive:null,ariaModal:Sr,ariaMultiLine:Sr,ariaMultiSelectable:Sr,ariaOrientation:null,ariaOwns:Dn,ariaPlaceholder:null,ariaPosInSet:Ke,ariaPressed:Sr,ariaReadOnly:Sr,ariaRelevant:null,ariaRequired:Sr,ariaRoleDescription:Dn,ariaRowCount:Ke,ariaRowIndex:Ke,ariaRowSpan:Ke,ariaSelected:Sr,ariaSetSize:Ke,ariaSort:null,ariaValueMax:Ke,ariaValueMin:Ke,ariaValueNow:Ke,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function zH(t,e){return e in t?t[e]:e}function GH(t,e){return zH(t,e.toLowerCase())}const w1e=rf({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:ah,acceptCharset:Dn,accessKey:Dn,action:null,allow:null,allowFullScreen:Zt,allowPaymentRequest:Zt,allowUserMedia:Zt,alt:null,as:null,async:Zt,autoCapitalize:null,autoComplete:Dn,autoFocus:Zt,autoPlay:Zt,blocking:Dn,capture:null,charSet:null,checked:Zt,cite:null,className:Dn,cols:Ke,colSpan:null,content:null,contentEditable:Sr,controls:Zt,controlsList:Dn,coords:Ke|ah,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Zt,defer:Zt,dir:null,dirName:null,disabled:Zt,download:wT,draggable:Sr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Zt,formTarget:null,headers:Dn,height:Ke,hidden:wT,high:Ke,href:null,hrefLang:null,htmlFor:Dn,httpEquiv:Dn,id:null,imageSizes:null,imageSrcSet:null,inert:Zt,inputMode:null,integrity:null,is:null,isMap:Zt,itemId:null,itemProp:Dn,itemRef:Dn,itemScope:Zt,itemType:Dn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Zt,low:Ke,manifest:null,max:null,maxLength:Ke,media:null,method:null,min:null,minLength:Ke,multiple:Zt,muted:Zt,name:null,nonce:null,noModule:Zt,noValidate:Zt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Zt,optimum:Ke,pattern:null,ping:Dn,placeholder:null,playsInline:Zt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Zt,referrerPolicy:null,rel:Dn,required:Zt,reversed:Zt,rows:Ke,rowSpan:Ke,sandbox:Dn,scope:null,scoped:Zt,seamless:Zt,selected:Zt,shadowRootClonable:Zt,shadowRootDelegatesFocus:Zt,shadowRootMode:null,shape:null,size:Ke,sizes:null,slot:null,span:Ke,spellCheck:Sr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Ke,step:null,style:null,tabIndex:Ke,target:null,title:null,translate:null,type:null,typeMustMatch:Zt,useMap:null,value:Sr,width:Ke,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Dn,axis:null,background:null,bgColor:null,border:Ke,borderColor:null,bottomMargin:Ke,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Zt,declare:Zt,event:null,face:null,frame:null,frameBorder:null,hSpace:Ke,leftMargin:Ke,link:null,longDesc:null,lowSrc:null,marginHeight:Ke,marginWidth:Ke,noResize:Zt,noHref:Zt,noShade:Zt,noWrap:Zt,object:null,profile:null,prompt:null,rev:null,rightMargin:Ke,rules:null,scheme:null,scrolling:Sr,standby:null,summary:null,text:null,topMargin:Ke,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Ke,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Zt,disableRemotePlayback:Zt,prefix:null,property:null,results:Ke,security:null,unselectable:null},space:"html",transform:GH}),_1e=rf({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:si,accentHeight:Ke,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Ke,amplitude:Ke,arabicForm:null,ascent:Ke,attributeName:null,attributeType:null,azimuth:Ke,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Ke,by:null,calcMode:null,capHeight:Ke,className:Dn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Ke,diffuseConstant:Ke,direction:null,display:null,dur:null,divisor:Ke,dominantBaseline:null,download:Zt,dx:null,dy:null,edgeMode:null,editable:null,elevation:Ke,enableBackground:null,end:null,event:null,exponent:Ke,externalResourcesRequired:null,fill:null,fillOpacity:Ke,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:ah,g2:ah,glyphName:ah,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Ke,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Ke,horizOriginX:Ke,horizOriginY:Ke,id:null,ideographic:Ke,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Ke,k:Ke,k1:Ke,k2:Ke,k3:Ke,k4:Ke,kernelMatrix:si,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Ke,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Ke,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Ke,overlineThickness:Ke,paintOrder:null,panose1:null,path:null,pathLength:Ke,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Dn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Ke,pointsAtY:Ke,pointsAtZ:Ke,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:si,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:si,rev:si,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:si,requiredFeatures:si,requiredFonts:si,requiredFormats:si,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Ke,specularExponent:Ke,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Ke,strikethroughThickness:Ke,string:null,stroke:null,strokeDashArray:si,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Ke,strokeOpacity:Ke,strokeWidth:null,style:null,surfaceScale:Ke,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:si,tabIndex:Ke,tableValues:null,target:null,targetX:Ke,targetY:Ke,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:si,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Ke,underlineThickness:Ke,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Ke,values:null,vAlphabetic:Ke,vMathematical:Ke,vectorEffect:null,vHanging:Ke,vIdeographic:Ke,version:null,vertAdvY:Ke,vertOriginX:Ke,vertOriginY:Ke,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Ke,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:zH}),HH=rf({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),WH=rf({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:GH}),qH=rf({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),b1e={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},S1e=/[A-Z]/g,hL=/-[a-z]/g,E1e=/^data[-\w.:]+$/i;function C1e(t,e){const n=vT(e);let r=e,s=Zs;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&E1e.test(e)){if(e.charAt(4)==="-"){const i=e.slice(5).replace(hL,I1e);r="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=e.slice(4);if(!hL.test(i)){let o=i.replace(S1e,T1e);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}s=KP}return new s(r,e)}function T1e(t){return"-"+t.toLowerCase()}function I1e(t){return t.charAt(1).toUpperCase()}const N1e=UH([BH,w1e,HH,WH,qH],"html"),YP=UH([BH,_1e,HH,WH,qH],"svg");function P1e(t){return t.join(" ").trim()}var JP={},fL=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,A1e=/\n/g,R1e=/^\s*/,k1e=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,j1e=/^:\s*/,D1e=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,M1e=/^[;\s]*/,L1e=/^\s+|\s+$/g,F1e=`
`,mL="/",pL="*",Vc="",O1e="comment",V1e="declaration",$1e=function(t,e){if(typeof t!="string")throw new TypeError("First argument must be a string");if(!t)return[];e=e||{};var n=1,r=1;function s(g){var x=g.match(A1e);x&&(n+=x.length);var E=g.lastIndexOf(F1e);r=~E?g.length-E:r+g.length}function i(){var g={line:n,column:r};return function(x){return x.position=new o(g),u(),x}}function o(g){this.start=g,this.end={line:n,column:r},this.source=e.source}o.prototype.content=t;function l(g){var x=new Error(e.source+":"+n+":"+r+": "+g);if(x.reason=g,x.filename=e.source,x.line=n,x.column=r,x.source=t,!e.silent)throw x}function c(g){var x=g.exec(t);if(x){var E=x[0];return s(E),t=t.slice(E.length),x}}function u(){c(R1e)}function d(g){var x;for(g=g||[];x=h();)x!==!1&&g.push(x);return g}function h(){var g=i();if(!(mL!=t.charAt(0)||pL!=t.charAt(1))){for(var x=2;Vc!=t.charAt(x)&&(pL!=t.charAt(x)||mL!=t.charAt(x+1));)++x;if(x+=2,Vc===t.charAt(x-1))return l("End of comment missing");var E=t.slice(2,x-2);return r+=2,s(E),t=t.slice(x),r+=2,g({type:O1e,comment:E})}}function f(){var g=i(),x=c(k1e);if(x){if(h(),!c(j1e))return l("property missing ':'");var E=c(D1e),v=g({type:V1e,property:gL(x[0].replace(fL,Vc)),value:E?gL(E[0].replace(fL,Vc)):Vc});return c(M1e),v}}function m(){var g=[];d(g);for(var x;x=f();)x!==!1&&(g.push(x),d(g));return g}return u(),m()};function gL(t){return t?t.replace(L1e,Vc):Vc}var U1e=zx&&zx.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(JP,"__esModule",{value:!0});JP.default=z1e;var B1e=U1e($1e);function z1e(t,e){var n=null;if(!t||typeof t!="string")return n;var r=(0,B1e.default)(t),s=typeof e=="function";return r.forEach(function(i){if(i.type==="declaration"){var o=i.property,l=i.value;s?e(o,l,i):l&&(n=n||{},n[o]=l)}}),n}var N_={};Object.defineProperty(N_,"__esModule",{value:!0});N_.camelCase=void 0;var G1e=/^--[a-zA-Z0-9_-]+$/,H1e=/-([a-z])/g,W1e=/^[^-]+$/,q1e=/^-(webkit|moz|ms|o|khtml)-/,K1e=/^-(ms)-/,Y1e=function(t){return!t||W1e.test(t)||G1e.test(t)},J1e=function(t,e){return e.toUpperCase()},yL=function(t,e){return"".concat(e,"-")},X1e=function(t,e){return e===void 0&&(e={}),Y1e(t)?t:(t=t.toLowerCase(),e.reactCompat?t=t.replace(K1e,yL):t=t.replace(q1e,yL),t.replace(H1e,J1e))};N_.camelCase=X1e;var Q1e=zx&&zx.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},Z1e=Q1e(JP),eIe=N_;function bT(t,e){var n={};return!t||typeof t!="string"||(0,Z1e.default)(t,function(r,s){r&&s&&(n[(0,eIe.camelCase)(r,e)]=s)}),n}bT.default=bT;var tIe=bT;const nIe=Ew(tIe),KH=YH("end"),XP=YH("start");function YH(t){return e;function e(n){const r=n&&n.position&&n.position[t]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function rIe(t){const e=XP(t),n=KH(t);if(e&&n)return{start:e,end:n}}function Vm(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?xL(t.position):"start"in t||"end"in t?xL(t):"line"in t||"column"in t?ST(t):""}function ST(t){return vL(t&&t.line)+":"+vL(t&&t.column)}function xL(t){return ST(t&&t.start)+"-"+ST(t&&t.end)}function vL(t){return t&&typeof t=="number"?t:1}class ws extends Error{constructor(e,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let s="",i={},o=!1;if(n&&("line"in n&&"column"in n?i={place:n}:"start"in n&&"end"in n?i={place:n}:"type"in n?i={ancestors:[n],place:n.position}:i={...n}),typeof e=="string"?s=e:!i.cause&&e&&(o=!0,s=e.message,i.cause=e),!i.ruleId&&!i.source&&typeof r=="string"){const c=r.indexOf(":");c===-1?i.ruleId=r:(i.source=r.slice(0,c),i.ruleId=r.slice(c+1))}if(!i.place&&i.ancestors&&i.ancestors){const c=i.ancestors[i.ancestors.length-1];c&&(i.place=c.position)}const l=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=l?l.line:void 0,this.name=Vm(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=o&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}ws.prototype.file="";ws.prototype.name="";ws.prototype.reason="";ws.prototype.message="";ws.prototype.stack="";ws.prototype.column=void 0;ws.prototype.line=void 0;ws.prototype.ancestors=void 0;ws.prototype.cause=void 0;ws.prototype.fatal=void 0;ws.prototype.place=void 0;ws.prototype.ruleId=void 0;ws.prototype.source=void 0;const QP={}.hasOwnProperty,sIe=new Map,iIe=/[A-Z]/g,oIe=new Set(["table","tbody","thead","tfoot","tr"]),aIe=new Set(["td","th"]),JH="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function lIe(t,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=gIe(n,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=pIe(n,e.jsx,e.jsxs)}const s={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?YP:N1e,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},i=XH(s,t,void 0);return i&&typeof i!="string"?i:s.create(t,s.Fragment,{children:i||void 0},void 0)}function XH(t,e,n){if(e.type==="element")return cIe(t,e,n);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return uIe(t,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return hIe(t,e,n);if(e.type==="mdxjsEsm")return dIe(t,e);if(e.type==="root")return fIe(t,e,n);if(e.type==="text")return mIe(t,e)}function cIe(t,e,n){const r=t.schema;let s=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(s=YP,t.schema=s),t.ancestors.push(e);const i=ZH(t,e.tagName,!1),o=yIe(t,e);let l=eA(t,e);return oIe.has(e.tagName)&&(l=l.filter(function(c){return typeof c=="string"?!x1e(c):!0})),QH(t,o,i,e),ZP(o,l),t.ancestors.pop(),t.schema=r,t.create(e,i,o,n)}function uIe(t,e){if(e.data&&e.data.estree&&t.evaluater){const r=e.data.estree.body[0];return r.type,t.evaluater.evaluateExpression(r.expression)}Op(t,e.position)}function dIe(t,e){if(e.data&&e.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(e.data.estree);Op(t,e.position)}function hIe(t,e,n){const r=t.schema;let s=r;e.name==="svg"&&r.space==="html"&&(s=YP,t.schema=s),t.ancestors.push(e);const i=e.name===null?t.Fragment:ZH(t,e.name,!0),o=xIe(t,e),l=eA(t,e);return QH(t,o,i,e),ZP(o,l),t.ancestors.pop(),t.schema=r,t.create(e,i,o,n)}function fIe(t,e,n){const r={};return ZP(r,eA(t,e)),t.create(e,t.Fragment,r,n)}function mIe(t,e){return e.value}function QH(t,e,n,r){typeof n!="string"&&n!==t.Fragment&&t.passNode&&(e.node=r)}function ZP(t,e){if(e.length>0){const n=e.length>1?e:e[0];n&&(t.children=n)}}function pIe(t,e,n){return r;function r(s,i,o,l){const u=Array.isArray(o.children)?n:e;return l?u(i,o,l):u(i,o)}}function gIe(t,e){return n;function n(r,s,i,o){const l=Array.isArray(i.children),c=XP(r);return e(s,i,o,l,{columnNumber:c?c.column-1:void 0,fileName:t,lineNumber:c?c.line:void 0},void 0)}}function yIe(t,e){const n={};let r,s;for(s in e.properties)if(s!=="children"&&QP.call(e.properties,s)){const i=vIe(t,s,e.properties[s]);if(i){const[o,l]=i;t.tableCellAlignToStyle&&o==="align"&&typeof l=="string"&&aIe.has(e.tagName)?r=l:n[o]=l}}if(r){const i=n.style||(n.style={});i[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function xIe(t,e){const n={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&t.evaluater){const i=r.data.estree.body[0];i.type;const o=i.expression;o.type;const l=o.properties[0];l.type,Object.assign(n,t.evaluater.evaluateExpression(l.argument))}else Op(t,e.position);else{const s=r.name;let i;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&t.evaluater){const l=r.value.data.estree.body[0];l.type,i=t.evaluater.evaluateExpression(l.expression)}else Op(t,e.position);else i=r.value===null?!0:r.value;n[s]=i}return n}function eA(t,e){const n=[];let r=-1;const s=t.passKeys?new Map:sIe;for(;++r<e.children.length;){const i=e.children[r];let o;if(t.passKeys){const c=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(c){const u=s.get(c)||0;o=c+"-"+u,s.set(c,u+1)}}const l=XH(t,i,o);l!==void 0&&n.push(l)}return n}function vIe(t,e,n){const r=C1e(t.schema,e);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?f1e(n):P1e(n)),r.property==="style"){let s=typeof n=="object"?n:wIe(t,String(n));return t.stylePropertyNameCase==="css"&&(s=_Ie(s)),["style",s]}return[t.elementAttributeNameCase==="react"&&r.space?b1e[r.property]||r.property:r.attribute,n]}}function wIe(t,e){try{return nIe(e,{reactCompat:!0})}catch(n){if(t.ignoreInvalidStyle)return{};const r=n,s=new ws("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw s.file=t.filePath||void 0,s.url=JH+"#cannot-parse-style-attribute",s}}function ZH(t,e,n){let r;if(!n)r={type:"Literal",value:e};else if(e.includes(".")){const s=e.split(".");let i=-1,o;for(;++i<s.length;){const l=cL(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};o=o?{type:"MemberExpression",object:o,property:l,computed:!!(i&&l.type==="Literal"),optional:!1}:l}r=o}else r=cL(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const s=r.value;return QP.call(t.components,s)?t.components[s]:s}if(t.evaluater)return t.evaluater.evaluateExpression(r);Op(t)}function Op(t,e){const n=new ws("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=t.filePath||void 0,n.url=JH+"#cannot-handle-mdx-estrees-without-createevaluater",n}function _Ie(t){const e={};let n;for(n in t)QP.call(t,n)&&(e[bIe(n)]=t[n]);return e}function bIe(t){let e=t.replace(iIe,SIe);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function SIe(t){return"-"+t.toLowerCase()}const _S={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},EIe={};function CIe(t,e){const n=e||EIe,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,s=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return eW(t,r,s)}function eW(t,e,n){if(TIe(t)){if("value"in t)return t.type==="html"&&!n?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return wL(t.children,e,n)}return Array.isArray(t)?wL(t,e,n):""}function wL(t,e,n){const r=[];let s=-1;for(;++s<t.length;)r[s]=eW(t[s],e,n);return r.join("")}function TIe(t){return!!(t&&typeof t=="object")}const _L=document.createElement("i");function tA(t){const e="&"+t+";";_L.innerHTML=e;const n=_L.textContent;return n.charCodeAt(n.length-1)===59&&t!=="semi"||n===e?!1:n}function qo(t,e,n,r){const s=t.length;let i=0,o;if(e<0?e=-e>s?0:s+e:e=e>s?s:e,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(e,n),t.splice(...o);else for(n&&t.splice(e,n);i<r.length;)o=r.slice(i,i+1e4),o.unshift(e,0),t.splice(...o),i+=1e4,e+=1e4}function ji(t,e){return t.length>0?(qo(t,t.length,0,e),t):e}const bL={}.hasOwnProperty;function IIe(t){const e={};let n=-1;for(;++n<t.length;)NIe(e,t[n]);return e}function NIe(t,e){let n;for(n in e){const s=(bL.call(t,n)?t[n]:void 0)||(t[n]={}),i=e[n];let o;if(i)for(o in i){bL.call(s,o)||(s[o]=[]);const l=i[o];PIe(s[o],Array.isArray(l)?l:l?[l]:[])}}}function PIe(t,e){let n=-1;const r=[];for(;++n<e.length;)(e[n].add==="after"?t:r).push(e[n]);qo(t,0,0,r)}function tW(t,e){const n=Number.parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"�":String.fromCodePoint(n)}function lh(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Po=gc(/[A-Za-z]/),mi=gc(/[\dA-Za-z]/),AIe=gc(/[#-'*+\--9=?A-Z^-~]/);function ET(t){return t!==null&&(t<32||t===127)}const CT=gc(/\d/),RIe=gc(/[\dA-Fa-f]/),kIe=gc(/[!-/:-@[-`{-~]/);function Ut(t){return t!==null&&t<-2}function Js(t){return t!==null&&(t<0||t===32)}function wn(t){return t===-2||t===-1||t===32}const jIe=gc(/\p{P}|\p{S}/u),DIe=gc(/\s/);function gc(t){return e;function e(n){return n!==null&&n>-1&&t.test(String.fromCharCode(n))}}function sf(t){const e=[];let n=-1,r=0,s=0;for(;++n<t.length;){const i=t.charCodeAt(n);let o="";if(i===37&&mi(t.charCodeAt(n+1))&&mi(t.charCodeAt(n+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(o=String.fromCharCode(i));else if(i>55295&&i<57344){const l=t.charCodeAt(n+1);i<56320&&l>56319&&l<57344?(o=String.fromCharCode(i,l),s=1):o="�"}else o=String.fromCharCode(i);o&&(e.push(t.slice(r,n),encodeURIComponent(o)),r=n+s+1,o=""),s&&(n+=s,s=0)}return e.join("")+t.slice(r)}function On(t,e,n,r){const s=r?r-1:Number.POSITIVE_INFINITY;let i=0;return o;function o(c){return wn(c)?(t.enter(n),l(c)):e(c)}function l(c){return wn(c)&&i++<s?(t.consume(c),l):(t.exit(n),e(c))}}const MIe={tokenize:LIe};function LIe(t){const e=t.attempt(this.parser.constructs.contentInitial,r,s);let n;return e;function r(l){if(l===null){t.consume(l);return}return t.enter("lineEnding"),t.consume(l),t.exit("lineEnding"),On(t,e,"linePrefix")}function s(l){return t.enter("paragraph"),i(l)}function i(l){const c=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=c),n=c,o(l)}function o(l){if(l===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(l);return}return Ut(l)?(t.consume(l),t.exit("chunkText"),i):(t.consume(l),o)}}const FIe={tokenize:OIe},SL={tokenize:VIe};function OIe(t){const e=this,n=[];let r=0,s,i,o;return l;function l(S){if(r<n.length){const I=n[r];return e.containerState=I[1],t.attempt(I[0].continuation,c,u)(S)}return u(S)}function c(S){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,s&&_();const I=e.events.length;let M=I,j;for(;M--;)if(e.events[M][0]==="exit"&&e.events[M][1].type==="chunkFlow"){j=e.events[M][1].end;break}v(r);let C=I;for(;C<e.events.length;)e.events[C][1].end={...j},C++;return qo(e.events,M+1,0,e.events.slice(I)),e.events.length=C,u(S)}return l(S)}function u(S){if(r===n.length){if(!s)return f(S);if(s.currentConstruct&&s.currentConstruct.concrete)return g(S);e.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(SL,d,h)(S)}function d(S){return s&&_(),v(r),f(S)}function h(S){return e.parser.lazy[e.now().line]=r!==n.length,o=e.now().offset,g(S)}function f(S){return e.containerState={},t.attempt(SL,m,g)(S)}function m(S){return r++,n.push([e.currentConstruct,e.containerState]),f(S)}function g(S){if(S===null){s&&_(),v(0),t.consume(S);return}return s=s||e.parser.flow(e.now()),t.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),x(S)}function x(S){if(S===null){E(t.exit("chunkFlow"),!0),v(0),t.consume(S);return}return Ut(S)?(t.consume(S),E(t.exit("chunkFlow")),r=0,e.interrupt=void 0,l):(t.consume(S),x)}function E(S,I){const M=e.sliceStream(S);if(I&&M.push(null),S.previous=i,i&&(i.next=S),i=S,s.defineSkip(S.start),s.write(M),e.parser.lazy[S.start.line]){let j=s.events.length;for(;j--;)if(s.events[j][1].start.offset<o&&(!s.events[j][1].end||s.events[j][1].end.offset>o))return;const C=e.events.length;let T=C,P,A;for(;T--;)if(e.events[T][0]==="exit"&&e.events[T][1].type==="chunkFlow"){if(P){A=e.events[T][1].end;break}P=!0}for(v(r),j=C;j<e.events.length;)e.events[j][1].end={...A},j++;qo(e.events,T+1,0,e.events.slice(C)),e.events.length=j}}function v(S){let I=n.length;for(;I-- >S;){const M=n[I];e.containerState=M[1],M[0].exit.call(e,t)}n.length=S}function _(){s.write([null]),i=void 0,s=void 0,e.containerState._closeFlow=void 0}}function VIe(t,e,n){return On(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function EL(t){if(t===null||Js(t)||DIe(t))return 1;if(jIe(t))return 2}function nA(t,e,n){const r=[];let s=-1;for(;++s<t.length;){const i=t[s].resolveAll;i&&!r.includes(i)&&(e=i(e,n),r.push(i))}return e}const TT={name:"attention",resolveAll:$Ie,tokenize:UIe};function $Ie(t,e){let n=-1,r,s,i,o,l,c,u,d;for(;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(r=n;r--;)if(t[r][0]==="exit"&&t[r][1].type==="attentionSequence"&&t[r][1]._open&&e.sliceSerialize(t[r][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[r][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[r][1].end.offset-t[r][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;c=t[r][1].end.offset-t[r][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1;const h={...t[r][1].end},f={...t[n][1].start};CL(h,-c),CL(f,c),o={type:c>1?"strongSequence":"emphasisSequence",start:h,end:{...t[r][1].end}},l={type:c>1?"strongSequence":"emphasisSequence",start:{...t[n][1].start},end:f},i={type:c>1?"strongText":"emphasisText",start:{...t[r][1].end},end:{...t[n][1].start}},s={type:c>1?"strong":"emphasis",start:{...o.start},end:{...l.end}},t[r][1].end={...o.start},t[n][1].start={...l.end},u=[],t[r][1].end.offset-t[r][1].start.offset&&(u=ji(u,[["enter",t[r][1],e],["exit",t[r][1],e]])),u=ji(u,[["enter",s,e],["enter",o,e],["exit",o,e],["enter",i,e]]),u=ji(u,nA(e.parser.constructs.insideSpan.null,t.slice(r+1,n),e)),u=ji(u,[["exit",i,e],["enter",l,e],["exit",l,e],["exit",s,e]]),t[n][1].end.offset-t[n][1].start.offset?(d=2,u=ji(u,[["enter",t[n][1],e],["exit",t[n][1],e]])):d=0,qo(t,r-1,n-r+3,u),n=r+u.length-d-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function UIe(t,e){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,s=EL(r);let i;return o;function o(c){return i=c,t.enter("attentionSequence"),l(c)}function l(c){if(c===i)return t.consume(c),l;const u=t.exit("attentionSequence"),d=EL(c),h=!d||d===2&&s||n.includes(c),f=!s||s===2&&d||n.includes(r);return u._open=!!(i===42?h:h&&(s||!f)),u._close=!!(i===42?f:f&&(d||!h)),e(c)}}function CL(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const BIe={name:"autolink",tokenize:zIe};function zIe(t,e,n){let r=0;return s;function s(m){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),i}function i(m){return Po(m)?(t.consume(m),o):m===64?n(m):u(m)}function o(m){return m===43||m===45||m===46||mi(m)?(r=1,l(m)):u(m)}function l(m){return m===58?(t.consume(m),r=0,c):(m===43||m===45||m===46||mi(m))&&r++<32?(t.consume(m),l):(r=0,u(m))}function c(m){return m===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):m===null||m===32||m===60||ET(m)?n(m):(t.consume(m),c)}function u(m){return m===64?(t.consume(m),d):AIe(m)?(t.consume(m),u):n(m)}function d(m){return mi(m)?h(m):n(m)}function h(m){return m===46?(t.consume(m),r=0,d):m===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):f(m)}function f(m){if((m===45||mi(m))&&r++<63){const g=m===45?f:h;return t.consume(m),g}return n(m)}}const P_={partial:!0,tokenize:GIe};function GIe(t,e,n){return r;function r(i){return wn(i)?On(t,s,"linePrefix")(i):s(i)}function s(i){return i===null||Ut(i)?e(i):n(i)}}const nW={continuation:{tokenize:WIe},exit:qIe,name:"blockQuote",tokenize:HIe};function HIe(t,e,n){const r=this;return s;function s(o){if(o===62){const l=r.containerState;return l.open||(t.enter("blockQuote",{_container:!0}),l.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(o),t.exit("blockQuoteMarker"),i}return n(o)}function i(o){return wn(o)?(t.enter("blockQuotePrefixWhitespace"),t.consume(o),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(o))}}function WIe(t,e,n){const r=this;return s;function s(o){return wn(o)?On(t,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):i(o)}function i(o){return t.attempt(nW,e,n)(o)}}function qIe(t){t.exit("blockQuote")}const rW={name:"characterEscape",tokenize:KIe};function KIe(t,e,n){return r;function r(i){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(i),t.exit("escapeMarker"),s}function s(i){return kIe(i)?(t.enter("characterEscapeValue"),t.consume(i),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(i)}}const sW={name:"characterReference",tokenize:YIe};function YIe(t,e,n){const r=this;let s=0,i,o;return l;function l(h){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),c}function c(h){return h===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(h),t.exit("characterReferenceMarkerNumeric"),u):(t.enter("characterReferenceValue"),i=31,o=mi,d(h))}function u(h){return h===88||h===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(h),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),i=6,o=RIe,d):(t.enter("characterReferenceValue"),i=7,o=CT,d(h))}function d(h){if(h===59&&s){const f=t.exit("characterReferenceValue");return o===mi&&!tA(r.sliceSerialize(f))?n(h):(t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return o(h)&&s++<i?(t.consume(h),d):n(h)}}const TL={partial:!0,tokenize:XIe},IL={concrete:!0,name:"codeFenced",tokenize:JIe};function JIe(t,e,n){const r=this,s={partial:!0,tokenize:M};let i=0,o=0,l;return c;function c(j){return u(j)}function u(j){const C=r.events[r.events.length-1];return i=C&&C[1].type==="linePrefix"?C[2].sliceSerialize(C[1],!0).length:0,l=j,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),d(j)}function d(j){return j===l?(o++,t.consume(j),d):o<3?n(j):(t.exit("codeFencedFenceSequence"),wn(j)?On(t,h,"whitespace")(j):h(j))}function h(j){return j===null||Ut(j)?(t.exit("codeFencedFence"),r.interrupt?e(j):t.check(TL,x,I)(j)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),f(j))}function f(j){return j===null||Ut(j)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),h(j)):wn(j)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),On(t,m,"whitespace")(j)):j===96&&j===l?n(j):(t.consume(j),f)}function m(j){return j===null||Ut(j)?h(j):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),g(j))}function g(j){return j===null||Ut(j)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),h(j)):j===96&&j===l?n(j):(t.consume(j),g)}function x(j){return t.attempt(s,I,E)(j)}function E(j){return t.enter("lineEnding"),t.consume(j),t.exit("lineEnding"),v}function v(j){return i>0&&wn(j)?On(t,_,"linePrefix",i+1)(j):_(j)}function _(j){return j===null||Ut(j)?t.check(TL,x,I)(j):(t.enter("codeFlowValue"),S(j))}function S(j){return j===null||Ut(j)?(t.exit("codeFlowValue"),_(j)):(t.consume(j),S)}function I(j){return t.exit("codeFenced"),e(j)}function M(j,C,T){let P=0;return A;function A(B){return j.enter("lineEnding"),j.consume(B),j.exit("lineEnding"),D}function D(B){return j.enter("codeFencedFence"),wn(B)?On(j,R,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(B):R(B)}function R(B){return B===l?(j.enter("codeFencedFenceSequence"),k(B)):T(B)}function k(B){return B===l?(P++,j.consume(B),k):P>=o?(j.exit("codeFencedFenceSequence"),wn(B)?On(j,U,"whitespace")(B):U(B)):T(B)}function U(B){return B===null||Ut(B)?(j.exit("codeFencedFence"),C(B)):T(B)}}}function XIe(t,e,n){const r=this;return s;function s(o){return o===null?n(o):(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i)}function i(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}const bS={name:"codeIndented",tokenize:ZIe},QIe={partial:!0,tokenize:eNe};function ZIe(t,e,n){const r=this;return s;function s(u){return t.enter("codeIndented"),On(t,i,"linePrefix",4+1)(u)}function i(u){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?o(u):n(u)}function o(u){return u===null?c(u):Ut(u)?t.attempt(QIe,o,c)(u):(t.enter("codeFlowValue"),l(u))}function l(u){return u===null||Ut(u)?(t.exit("codeFlowValue"),o(u)):(t.consume(u),l)}function c(u){return t.exit("codeIndented"),e(u)}}function eNe(t,e,n){const r=this;return s;function s(o){return r.parser.lazy[r.now().line]?n(o):Ut(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),s):On(t,i,"linePrefix",4+1)(o)}function i(o){const l=r.events[r.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(o):Ut(o)?s(o):n(o)}}const tNe={name:"codeText",previous:rNe,resolve:nNe,tokenize:sNe};function nNe(t){let e=t.length-4,n=3,r,s;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(r=n;++r<e;)if(t[r][1].type==="codeTextData"){t[n][1].type="codeTextPadding",t[e][1].type="codeTextPadding",n+=2,e-=2;break}}for(r=n-1,e++;++r<=e;)s===void 0?r!==e&&t[r][1].type!=="lineEnding"&&(s=r):(r===e||t[r][1].type==="lineEnding")&&(t[s][1].type="codeTextData",r!==s+2&&(t[s][1].end=t[r-1][1].end,t.splice(s+2,r-s-2),e-=r-s-2,r=s+2),s=void 0);return t}function rNe(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function sNe(t,e,n){let r=0,s,i;return o;function o(h){return t.enter("codeText"),t.enter("codeTextSequence"),l(h)}function l(h){return h===96?(t.consume(h),r++,l):(t.exit("codeTextSequence"),c(h))}function c(h){return h===null?n(h):h===32?(t.enter("space"),t.consume(h),t.exit("space"),c):h===96?(i=t.enter("codeTextSequence"),s=0,d(h)):Ut(h)?(t.enter("lineEnding"),t.consume(h),t.exit("lineEnding"),c):(t.enter("codeTextData"),u(h))}function u(h){return h===null||h===32||h===96||Ut(h)?(t.exit("codeTextData"),c(h)):(t.consume(h),u)}function d(h){return h===96?(t.consume(h),s++,d):s===r?(t.exit("codeTextSequence"),t.exit("codeText"),e(h)):(i.type="codeTextData",u(h))}}class iNe{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,n,r){const s=n||0;this.setCursor(Math.trunc(e));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return r&&$f(this.left,r),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),$f(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),$f(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const n=this.left.splice(e,Number.POSITIVE_INFINITY);$f(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);$f(this.left,n.reverse())}}}function $f(t,e){let n=0;if(e.length<1e4)t.push(...e);else for(;n<e.length;)t.push(...e.slice(n,n+1e4)),n+=1e4}function iW(t){const e={};let n=-1,r,s,i,o,l,c,u;const d=new iNe(t);for(;++n<d.length;){for(;n in e;)n=e[n];if(r=d.get(n),n&&r[1].type==="chunkFlow"&&d.get(n-1)[1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,i=0,i<c.length&&c[i][1].type==="lineEndingBlank"&&(i+=2),i<c.length&&c[i][1].type==="content"))for(;++i<c.length&&c[i][1].type!=="content";)c[i][1].type==="chunkText"&&(c[i][1]._isInFirstContentOfListItem=!0,i++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,oNe(d,n)),n=e[n],u=!0);else if(r[1]._container){for(i=n,s=void 0;i--;)if(o=d.get(i),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),o[1].type="lineEnding",s=i);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;s&&(r[1].end={...d.get(s)[1].start},l=d.slice(s,n),l.unshift(r),d.splice(s,n-s+1,l))}}return qo(t,0,Number.POSITIVE_INFINITY,d.slice(0)),!u}function oNe(t,e){const n=t.get(e)[1],r=t.get(e)[2];let s=e-1;const i=[];let o=n._tokenizer;o||(o=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const l=o.events,c=[],u={};let d,h,f=-1,m=n,g=0,x=0;const E=[x];for(;m;){for(;t.get(++s)[1]!==m;);i.push(s),m._tokenizer||(d=r.sliceStream(m),m.next||d.push(null),h&&o.defineSkip(m.start),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(d),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),h=m,m=m.next}for(m=n;++f<l.length;)l[f][0]==="exit"&&l[f-1][0]==="enter"&&l[f][1].type===l[f-1][1].type&&l[f][1].start.line!==l[f][1].end.line&&(x=f+1,E.push(x),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(o.events=[],m?(m._tokenizer=void 0,m.previous=void 0):E.pop(),f=E.length;f--;){const v=l.slice(E[f],E[f+1]),_=i.pop();c.push([_,_+v.length-1]),t.splice(_,2,v)}for(c.reverse(),f=-1;++f<c.length;)u[g+c[f][0]]=g+c[f][1],g+=c[f][1]-c[f][0]-1;return u}const aNe={resolve:cNe,tokenize:uNe},lNe={partial:!0,tokenize:dNe};function cNe(t){return iW(t),t}function uNe(t,e){let n;return r;function r(l){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),s(l)}function s(l){return l===null?i(l):Ut(l)?t.check(lNe,o,i)(l):(t.consume(l),s)}function i(l){return t.exit("chunkContent"),t.exit("content"),e(l)}function o(l){return t.consume(l),t.exit("chunkContent"),n.next=t.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,s}}function dNe(t,e,n){const r=this;return s;function s(o){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),On(t,i,"linePrefix")}function i(o){if(o===null||Ut(o))return n(o);const l=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(o):t.interrupt(r.parser.constructs.flow,n,e)(o)}}function oW(t,e,n,r,s,i,o,l,c){const u=c||Number.POSITIVE_INFINITY;let d=0;return h;function h(v){return v===60?(t.enter(r),t.enter(s),t.enter(i),t.consume(v),t.exit(i),f):v===null||v===32||v===41||ET(v)?n(v):(t.enter(r),t.enter(o),t.enter(l),t.enter("chunkString",{contentType:"string"}),x(v))}function f(v){return v===62?(t.enter(i),t.consume(v),t.exit(i),t.exit(s),t.exit(r),e):(t.enter(l),t.enter("chunkString",{contentType:"string"}),m(v))}function m(v){return v===62?(t.exit("chunkString"),t.exit(l),f(v)):v===null||v===60||Ut(v)?n(v):(t.consume(v),v===92?g:m)}function g(v){return v===60||v===62||v===92?(t.consume(v),m):m(v)}function x(v){return!d&&(v===null||v===41||Js(v))?(t.exit("chunkString"),t.exit(l),t.exit(o),t.exit(r),e(v)):d<u&&v===40?(t.consume(v),d++,x):v===41?(t.consume(v),d--,x):v===null||v===32||v===40||ET(v)?n(v):(t.consume(v),v===92?E:x)}function E(v){return v===40||v===41||v===92?(t.consume(v),x):x(v)}}function aW(t,e,n,r,s,i){const o=this;let l=0,c;return u;function u(m){return t.enter(r),t.enter(s),t.consume(m),t.exit(s),t.enter(i),d}function d(m){return l>999||m===null||m===91||m===93&&!c||m===94&&!l&&"_hiddenFootnoteSupport"in o.parser.constructs?n(m):m===93?(t.exit(i),t.enter(s),t.consume(m),t.exit(s),t.exit(r),e):Ut(m)?(t.enter("lineEnding"),t.consume(m),t.exit("lineEnding"),d):(t.enter("chunkString",{contentType:"string"}),h(m))}function h(m){return m===null||m===91||m===93||Ut(m)||l++>999?(t.exit("chunkString"),d(m)):(t.consume(m),c||(c=!wn(m)),m===92?f:h)}function f(m){return m===91||m===92||m===93?(t.consume(m),l++,h):h(m)}}function lW(t,e,n,r,s,i){let o;return l;function l(f){return f===34||f===39||f===40?(t.enter(r),t.enter(s),t.consume(f),t.exit(s),o=f===40?41:f,c):n(f)}function c(f){return f===o?(t.enter(s),t.consume(f),t.exit(s),t.exit(r),e):(t.enter(i),u(f))}function u(f){return f===o?(t.exit(i),c(o)):f===null?n(f):Ut(f)?(t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),On(t,u,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===o||f===null||Ut(f)?(t.exit("chunkString"),u(f)):(t.consume(f),f===92?h:d)}function h(f){return f===o||f===92?(t.consume(f),d):d(f)}}function $m(t,e){let n;return r;function r(s){return Ut(s)?(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),n=!0,r):wn(s)?On(t,r,n?"linePrefix":"lineSuffix")(s):e(s)}}const hNe={name:"definition",tokenize:mNe},fNe={partial:!0,tokenize:pNe};function mNe(t,e,n){const r=this;let s;return i;function i(m){return t.enter("definition"),o(m)}function o(m){return aW.call(r,t,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(m)}function l(m){return s=lh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),m===58?(t.enter("definitionMarker"),t.consume(m),t.exit("definitionMarker"),c):n(m)}function c(m){return Js(m)?$m(t,u)(m):u(m)}function u(m){return oW(t,d,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(m)}function d(m){return t.attempt(fNe,h,h)(m)}function h(m){return wn(m)?On(t,f,"whitespace")(m):f(m)}function f(m){return m===null||Ut(m)?(t.exit("definition"),r.parser.defined.push(s),e(m)):n(m)}}function pNe(t,e,n){return r;function r(l){return Js(l)?$m(t,s)(l):n(l)}function s(l){return lW(t,i,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function i(l){return wn(l)?On(t,o,"whitespace")(l):o(l)}function o(l){return l===null||Ut(l)?e(l):n(l)}}const gNe={name:"hardBreakEscape",tokenize:yNe};function yNe(t,e,n){return r;function r(i){return t.enter("hardBreakEscape"),t.consume(i),s}function s(i){return Ut(i)?(t.exit("hardBreakEscape"),e(i)):n(i)}}const xNe={name:"headingAtx",resolve:vNe,tokenize:wNe};function vNe(t,e){let n=t.length-2,r=3,s,i;return t[r][1].type==="whitespace"&&(r+=2),n-2>r&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&t[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(s={type:"atxHeadingText",start:t[r][1].start,end:t[n][1].end},i={type:"chunkText",start:t[r][1].start,end:t[n][1].end,contentType:"text"},qo(t,r,n-r+1,[["enter",s,e],["enter",i,e],["exit",i,e],["exit",s,e]])),t}function wNe(t,e,n){let r=0;return s;function s(d){return t.enter("atxHeading"),i(d)}function i(d){return t.enter("atxHeadingSequence"),o(d)}function o(d){return d===35&&r++<6?(t.consume(d),o):d===null||Js(d)?(t.exit("atxHeadingSequence"),l(d)):n(d)}function l(d){return d===35?(t.enter("atxHeadingSequence"),c(d)):d===null||Ut(d)?(t.exit("atxHeading"),e(d)):wn(d)?On(t,l,"whitespace")(d):(t.enter("atxHeadingText"),u(d))}function c(d){return d===35?(t.consume(d),c):(t.exit("atxHeadingSequence"),l(d))}function u(d){return d===null||d===35||Js(d)?(t.exit("atxHeadingText"),l(d)):(t.consume(d),u)}}const _Ne=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],NL=["pre","script","style","textarea"],bNe={concrete:!0,name:"htmlFlow",resolveTo:CNe,tokenize:TNe},SNe={partial:!0,tokenize:NNe},ENe={partial:!0,tokenize:INe};function CNe(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function TNe(t,e,n){const r=this;let s,i,o,l,c;return u;function u(F){return d(F)}function d(F){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(F),h}function h(F){return F===33?(t.consume(F),f):F===47?(t.consume(F),i=!0,x):F===63?(t.consume(F),s=3,r.interrupt?e:O):Po(F)?(t.consume(F),o=String.fromCharCode(F),E):n(F)}function f(F){return F===45?(t.consume(F),s=2,m):F===91?(t.consume(F),s=5,l=0,g):Po(F)?(t.consume(F),s=4,r.interrupt?e:O):n(F)}function m(F){return F===45?(t.consume(F),r.interrupt?e:O):n(F)}function g(F){const ye="CDATA[";return F===ye.charCodeAt(l++)?(t.consume(F),l===ye.length?r.interrupt?e:R:g):n(F)}function x(F){return Po(F)?(t.consume(F),o=String.fromCharCode(F),E):n(F)}function E(F){if(F===null||F===47||F===62||Js(F)){const ye=F===47,Se=o.toLowerCase();return!ye&&!i&&NL.includes(Se)?(s=1,r.interrupt?e(F):R(F)):_Ne.includes(o.toLowerCase())?(s=6,ye?(t.consume(F),v):r.interrupt?e(F):R(F)):(s=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(F):i?_(F):S(F))}return F===45||mi(F)?(t.consume(F),o+=String.fromCharCode(F),E):n(F)}function v(F){return F===62?(t.consume(F),r.interrupt?e:R):n(F)}function _(F){return wn(F)?(t.consume(F),_):A(F)}function S(F){return F===47?(t.consume(F),A):F===58||F===95||Po(F)?(t.consume(F),I):wn(F)?(t.consume(F),S):A(F)}function I(F){return F===45||F===46||F===58||F===95||mi(F)?(t.consume(F),I):M(F)}function M(F){return F===61?(t.consume(F),j):wn(F)?(t.consume(F),M):S(F)}function j(F){return F===null||F===60||F===61||F===62||F===96?n(F):F===34||F===39?(t.consume(F),c=F,C):wn(F)?(t.consume(F),j):T(F)}function C(F){return F===c?(t.consume(F),c=null,P):F===null||Ut(F)?n(F):(t.consume(F),C)}function T(F){return F===null||F===34||F===39||F===47||F===60||F===61||F===62||F===96||Js(F)?M(F):(t.consume(F),T)}function P(F){return F===47||F===62||wn(F)?S(F):n(F)}function A(F){return F===62?(t.consume(F),D):n(F)}function D(F){return F===null||Ut(F)?R(F):wn(F)?(t.consume(F),D):n(F)}function R(F){return F===45&&s===2?(t.consume(F),K):F===60&&s===1?(t.consume(F),ee):F===62&&s===4?(t.consume(F),z):F===63&&s===3?(t.consume(F),O):F===93&&s===5?(t.consume(F),X):Ut(F)&&(s===6||s===7)?(t.exit("htmlFlowData"),t.check(SNe,Y,k)(F)):F===null||Ut(F)?(t.exit("htmlFlowData"),k(F)):(t.consume(F),R)}function k(F){return t.check(ENe,U,Y)(F)}function U(F){return t.enter("lineEnding"),t.consume(F),t.exit("lineEnding"),B}function B(F){return F===null||Ut(F)?k(F):(t.enter("htmlFlowData"),R(F))}function K(F){return F===45?(t.consume(F),O):R(F)}function ee(F){return F===47?(t.consume(F),o="",H):R(F)}function H(F){if(F===62){const ye=o.toLowerCase();return NL.includes(ye)?(t.consume(F),z):R(F)}return Po(F)&&o.length<8?(t.consume(F),o+=String.fromCharCode(F),H):R(F)}function X(F){return F===93?(t.consume(F),O):R(F)}function O(F){return F===62?(t.consume(F),z):F===45&&s===2?(t.consume(F),O):R(F)}function z(F){return F===null||Ut(F)?(t.exit("htmlFlowData"),Y(F)):(t.consume(F),z)}function Y(F){return t.exit("htmlFlow"),e(F)}}function INe(t,e,n){const r=this;return s;function s(o){return Ut(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i):n(o)}function i(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}function NNe(t,e,n){return r;function r(s){return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),t.attempt(P_,e,n)}}const PNe={name:"htmlText",tokenize:ANe};function ANe(t,e,n){const r=this;let s,i,o;return l;function l(O){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(O),c}function c(O){return O===33?(t.consume(O),u):O===47?(t.consume(O),M):O===63?(t.consume(O),S):Po(O)?(t.consume(O),T):n(O)}function u(O){return O===45?(t.consume(O),d):O===91?(t.consume(O),i=0,g):Po(O)?(t.consume(O),_):n(O)}function d(O){return O===45?(t.consume(O),m):n(O)}function h(O){return O===null?n(O):O===45?(t.consume(O),f):Ut(O)?(o=h,ee(O)):(t.consume(O),h)}function f(O){return O===45?(t.consume(O),m):h(O)}function m(O){return O===62?K(O):O===45?f(O):h(O)}function g(O){const z="CDATA[";return O===z.charCodeAt(i++)?(t.consume(O),i===z.length?x:g):n(O)}function x(O){return O===null?n(O):O===93?(t.consume(O),E):Ut(O)?(o=x,ee(O)):(t.consume(O),x)}function E(O){return O===93?(t.consume(O),v):x(O)}function v(O){return O===62?K(O):O===93?(t.consume(O),v):x(O)}function _(O){return O===null||O===62?K(O):Ut(O)?(o=_,ee(O)):(t.consume(O),_)}function S(O){return O===null?n(O):O===63?(t.consume(O),I):Ut(O)?(o=S,ee(O)):(t.consume(O),S)}function I(O){return O===62?K(O):S(O)}function M(O){return Po(O)?(t.consume(O),j):n(O)}function j(O){return O===45||mi(O)?(t.consume(O),j):C(O)}function C(O){return Ut(O)?(o=C,ee(O)):wn(O)?(t.consume(O),C):K(O)}function T(O){return O===45||mi(O)?(t.consume(O),T):O===47||O===62||Js(O)?P(O):n(O)}function P(O){return O===47?(t.consume(O),K):O===58||O===95||Po(O)?(t.consume(O),A):Ut(O)?(o=P,ee(O)):wn(O)?(t.consume(O),P):K(O)}function A(O){return O===45||O===46||O===58||O===95||mi(O)?(t.consume(O),A):D(O)}function D(O){return O===61?(t.consume(O),R):Ut(O)?(o=D,ee(O)):wn(O)?(t.consume(O),D):P(O)}function R(O){return O===null||O===60||O===61||O===62||O===96?n(O):O===34||O===39?(t.consume(O),s=O,k):Ut(O)?(o=R,ee(O)):wn(O)?(t.consume(O),R):(t.consume(O),U)}function k(O){return O===s?(t.consume(O),s=void 0,B):O===null?n(O):Ut(O)?(o=k,ee(O)):(t.consume(O),k)}function U(O){return O===null||O===34||O===39||O===60||O===61||O===96?n(O):O===47||O===62||Js(O)?P(O):(t.consume(O),U)}function B(O){return O===47||O===62||Js(O)?P(O):n(O)}function K(O){return O===62?(t.consume(O),t.exit("htmlTextData"),t.exit("htmlText"),e):n(O)}function ee(O){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(O),t.exit("lineEnding"),H}function H(O){return wn(O)?On(t,X,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(O):X(O)}function X(O){return t.enter("htmlTextData"),o(O)}}const rA={name:"labelEnd",resolveAll:DNe,resolveTo:MNe,tokenize:LNe},RNe={tokenize:FNe},kNe={tokenize:ONe},jNe={tokenize:VNe};function DNe(t){let e=-1;const n=[];for(;++e<t.length;){const r=t[e][1];if(n.push(t[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const s=r.type==="labelImage"?4:2;r.type="data",e+=s}}return t.length!==n.length&&qo(t,0,t.length,n),t}function MNe(t,e){let n=t.length,r=0,s,i,o,l;for(;n--;)if(s=t[n][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;t[n][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(o){if(t[n][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=n,s.type!=="labelLink")){r=2;break}}else s.type==="labelEnd"&&(o=n);const c={type:t[i][1].type==="labelLink"?"link":"image",start:{...t[i][1].start},end:{...t[t.length-1][1].end}},u={type:"label",start:{...t[i][1].start},end:{...t[o][1].end}},d={type:"labelText",start:{...t[i+r+2][1].end},end:{...t[o-2][1].start}};return l=[["enter",c,e],["enter",u,e]],l=ji(l,t.slice(i+1,i+r+3)),l=ji(l,[["enter",d,e]]),l=ji(l,nA(e.parser.constructs.insideSpan.null,t.slice(i+r+4,o-3),e)),l=ji(l,[["exit",d,e],t[o-2],t[o-1],["exit",u,e]]),l=ji(l,t.slice(o+1)),l=ji(l,[["exit",c,e]]),qo(t,i,t.length,l),t}function LNe(t,e,n){const r=this;let s=r.events.length,i,o;for(;s--;)if((r.events[s][1].type==="labelImage"||r.events[s][1].type==="labelLink")&&!r.events[s][1]._balanced){i=r.events[s][1];break}return l;function l(f){return i?i._inactive?h(f):(o=r.parser.defined.includes(lh(r.sliceSerialize({start:i.end,end:r.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(f),t.exit("labelMarker"),t.exit("labelEnd"),c):n(f)}function c(f){return f===40?t.attempt(RNe,d,o?d:h)(f):f===91?t.attempt(kNe,d,o?u:h)(f):o?d(f):h(f)}function u(f){return t.attempt(jNe,d,h)(f)}function d(f){return e(f)}function h(f){return i._balanced=!0,n(f)}}function FNe(t,e,n){return r;function r(h){return t.enter("resource"),t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),s}function s(h){return Js(h)?$m(t,i)(h):i(h)}function i(h){return h===41?d(h):oW(t,o,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function o(h){return Js(h)?$m(t,c)(h):d(h)}function l(h){return n(h)}function c(h){return h===34||h===39||h===40?lW(t,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):d(h)}function u(h){return Js(h)?$m(t,d)(h):d(h)}function d(h){return h===41?(t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),t.exit("resource"),e):n(h)}}function ONe(t,e,n){const r=this;return s;function s(l){return aW.call(r,t,i,o,"reference","referenceMarker","referenceString")(l)}function i(l){return r.parser.defined.includes(lh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(l):n(l)}function o(l){return n(l)}}function VNe(t,e,n){return r;function r(i){return t.enter("reference"),t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),s}function s(i){return i===93?(t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),t.exit("reference"),e):n(i)}}const $Ne={name:"labelStartImage",resolveAll:rA.resolveAll,tokenize:UNe};function UNe(t,e,n){const r=this;return s;function s(l){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(l),t.exit("labelImageMarker"),i}function i(l){return l===91?(t.enter("labelMarker"),t.consume(l),t.exit("labelMarker"),t.exit("labelImage"),o):n(l)}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(l):e(l)}}const BNe={name:"labelStartLink",resolveAll:rA.resolveAll,tokenize:zNe};function zNe(t,e,n){const r=this;return s;function s(o){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(o),t.exit("labelMarker"),t.exit("labelLink"),i}function i(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):e(o)}}const SS={name:"lineEnding",tokenize:GNe};function GNe(t,e){return n;function n(r){return t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),On(t,e,"linePrefix")}}const $x={name:"thematicBreak",tokenize:HNe};function HNe(t,e,n){let r=0,s;return i;function i(u){return t.enter("thematicBreak"),o(u)}function o(u){return s=u,l(u)}function l(u){return u===s?(t.enter("thematicBreakSequence"),c(u)):r>=3&&(u===null||Ut(u))?(t.exit("thematicBreak"),e(u)):n(u)}function c(u){return u===s?(t.consume(u),r++,c):(t.exit("thematicBreakSequence"),wn(u)?On(t,l,"whitespace")(u):l(u))}}const Vs={continuation:{tokenize:YNe},exit:XNe,name:"list",tokenize:KNe},WNe={partial:!0,tokenize:QNe},qNe={partial:!0,tokenize:JNe};function KNe(t,e,n){const r=this,s=r.events[r.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,o=0;return l;function l(m){const g=r.containerState.type||(m===42||m===43||m===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!r.containerState.marker||m===r.containerState.marker:CT(m)){if(r.containerState.type||(r.containerState.type=g,t.enter(g,{_container:!0})),g==="listUnordered")return t.enter("listItemPrefix"),m===42||m===45?t.check($x,n,u)(m):u(m);if(!r.interrupt||m===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),c(m)}return n(m)}function c(m){return CT(m)&&++o<10?(t.consume(m),c):(!r.interrupt||o<2)&&(r.containerState.marker?m===r.containerState.marker:m===41||m===46)?(t.exit("listItemValue"),u(m)):n(m)}function u(m){return t.enter("listItemMarker"),t.consume(m),t.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||m,t.check(P_,r.interrupt?n:d,t.attempt(WNe,f,h))}function d(m){return r.containerState.initialBlankLine=!0,i++,f(m)}function h(m){return wn(m)?(t.enter("listItemPrefixWhitespace"),t.consume(m),t.exit("listItemPrefixWhitespace"),f):n(m)}function f(m){return r.containerState.size=i+r.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(m)}}function YNe(t,e,n){const r=this;return r.containerState._closeFlow=void 0,t.check(P_,s,i);function s(l){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,On(t,e,"listItemIndent",r.containerState.size+1)(l)}function i(l){return r.containerState.furtherBlankLines||!wn(l)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(l)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,t.attempt(qNe,e,o)(l))}function o(l){return r.containerState._closeFlow=!0,r.interrupt=void 0,On(t,t.attempt(Vs,e,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function JNe(t,e,n){const r=this;return On(t,s,"listItemIndent",r.containerState.size+1);function s(i){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?e(i):n(i)}}function XNe(t){t.exit(this.containerState.type)}function QNe(t,e,n){const r=this;return On(t,s,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4+1);function s(i){const o=r.events[r.events.length-1];return!wn(i)&&o&&o[1].type==="listItemPrefixWhitespace"?e(i):n(i)}}const PL={name:"setextUnderline",resolveTo:ZNe,tokenize:ePe};function ZNe(t,e){let n=t.length,r,s,i;for(;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){r=n;break}t[n][1].type==="paragraph"&&(s=n)}else t[n][1].type==="content"&&t.splice(n,1),!i&&t[n][1].type==="definition"&&(i=n);const o={type:"setextHeading",start:{...t[r][1].start},end:{...t[t.length-1][1].end}};return t[s][1].type="setextHeadingText",i?(t.splice(s,0,["enter",o,e]),t.splice(i+1,0,["exit",t[r][1],e]),t[r][1].end={...t[i][1].end}):t[r][1]=o,t.push(["exit",o,e]),t}function ePe(t,e,n){const r=this;let s;return i;function i(u){let d=r.events.length,h;for(;d--;)if(r.events[d][1].type!=="lineEnding"&&r.events[d][1].type!=="linePrefix"&&r.events[d][1].type!=="content"){h=r.events[d][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||h)?(t.enter("setextHeadingLine"),s=u,o(u)):n(u)}function o(u){return t.enter("setextHeadingLineSequence"),l(u)}function l(u){return u===s?(t.consume(u),l):(t.exit("setextHeadingLineSequence"),wn(u)?On(t,c,"lineSuffix")(u):c(u))}function c(u){return u===null||Ut(u)?(t.exit("setextHeadingLine"),e(u)):n(u)}}const tPe={tokenize:nPe};function nPe(t){const e=this,n=t.attempt(P_,r,t.attempt(this.parser.constructs.flowInitial,s,On(t,t.attempt(this.parser.constructs.flow,s,t.attempt(aNe,s)),"linePrefix")));return n;function r(i){if(i===null){t.consume(i);return}return t.enter("lineEndingBlank"),t.consume(i),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function s(i){if(i===null){t.consume(i);return}return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),e.currentConstruct=void 0,n}}const rPe={resolveAll:uW()},sPe=cW("string"),iPe=cW("text");function cW(t){return{resolveAll:uW(t==="text"?oPe:void 0),tokenize:e};function e(n){const r=this,s=this.parser.constructs[t],i=n.attempt(s,o,l);return o;function o(d){return u(d)?i(d):l(d)}function l(d){if(d===null){n.consume(d);return}return n.enter("data"),n.consume(d),c}function c(d){return u(d)?(n.exit("data"),i(d)):(n.consume(d),c)}function u(d){if(d===null)return!0;const h=s[d];let f=-1;if(h)for(;++f<h.length;){const m=h[f];if(!m.previous||m.previous.call(r,r.previous))return!0}return!1}}}function uW(t){return e;function e(n,r){let s=-1,i;for(;++s<=n.length;)i===void 0?n[s]&&n[s][1].type==="data"&&(i=s,s++):(!n[s]||n[s][1].type!=="data")&&(s!==i+2&&(n[i][1].end=n[s-1][1].end,n.splice(i+2,s-i-2),s=i+2),i=void 0);return t?t(n,r):n}}function oPe(t,e){let n=0;for(;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){const r=t[n-1][1],s=e.sliceStream(r);let i=s.length,o=-1,l=0,c;for(;i--;){const u=s[i];if(typeof u=="string"){for(o=u.length;u.charCodeAt(o-1)===32;)l++,o--;if(o)break;o=-1}else if(u===-2)c=!0,l++;else if(u!==-1){i++;break}}if(e._contentTypeTextTrailing&&n===t.length&&(l=0),l){const u={type:n===t.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?o:r.start._bufferIndex+o,_index:r.start._index+i,line:r.end.line,column:r.end.column-l,offset:r.end.offset-l},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(t.splice(n,0,["enter",u,e],["exit",u,e]),n+=2)}n++}return t}const aPe={42:Vs,43:Vs,45:Vs,48:Vs,49:Vs,50:Vs,51:Vs,52:Vs,53:Vs,54:Vs,55:Vs,56:Vs,57:Vs,62:nW},lPe={91:hNe},cPe={[-2]:bS,[-1]:bS,32:bS},uPe={35:xNe,42:$x,45:[PL,$x],60:bNe,61:PL,95:$x,96:IL,126:IL},dPe={38:sW,92:rW},hPe={[-5]:SS,[-4]:SS,[-3]:SS,33:$Ne,38:sW,42:TT,60:[BIe,PNe],91:BNe,92:[gNe,rW],93:rA,95:TT,96:tNe},fPe={null:[TT,rPe]},mPe={null:[42,95]},pPe={null:[]},gPe=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:mPe,contentInitial:lPe,disable:pPe,document:aPe,flow:uPe,flowInitial:cPe,insideSpan:fPe,string:dPe,text:hPe},Symbol.toStringTag,{value:"Module"}));function yPe(t,e,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const s={},i=[];let o=[],l=[];const c={attempt:C(M),check:C(j),consume:_,enter:S,exit:I,interrupt:C(j,{interrupt:!0})},u={code:null,containerState:{},defineSkip:x,events:[],now:g,parser:t,previous:null,sliceSerialize:f,sliceStream:m,write:h};let d=e.tokenize.call(u,c);return e.resolveAll&&i.push(e),u;function h(D){return o=ji(o,D),E(),o[o.length-1]!==null?[]:(T(e,0),u.events=nA(i,u.events,u),u.events)}function f(D,R){return vPe(m(D),R)}function m(D){return xPe(o,D)}function g(){const{_bufferIndex:D,_index:R,line:k,column:U,offset:B}=r;return{_bufferIndex:D,_index:R,line:k,column:U,offset:B}}function x(D){s[D.line]=D.column,A()}function E(){let D;for(;r._index<o.length;){const R=o[r._index];if(typeof R=="string")for(D=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===D&&r._bufferIndex<R.length;)v(R.charCodeAt(r._bufferIndex));else v(R)}}function v(D){d=d(D)}function _(D){Ut(D)?(r.line++,r.column=1,r.offset+=D===-3?2:1,A()):D!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=D}function S(D,R){const k=R||{};return k.type=D,k.start=g(),u.events.push(["enter",k,u]),l.push(k),k}function I(D){const R=l.pop();return R.end=g(),u.events.push(["exit",R,u]),R}function M(D,R){T(D,R.from)}function j(D,R){R.restore()}function C(D,R){return k;function k(U,B,K){let ee,H,X,O;return Array.isArray(U)?Y(U):"tokenize"in U?Y([U]):z(U);function z(De){return xe;function xe(Me){const Ye=Me!==null&&De[Me],qe=Me!==null&&De.null,et=[...Array.isArray(Ye)?Ye:Ye?[Ye]:[],...Array.isArray(qe)?qe:qe?[qe]:[]];return Y(et)(Me)}}function Y(De){return ee=De,H=0,De.length===0?K:F(De[H])}function F(De){return xe;function xe(Me){return O=P(),X=De,De.partial||(u.currentConstruct=De),De.name&&u.parser.constructs.disable.null.includes(De.name)?Se():De.tokenize.call(R?Object.assign(Object.create(u),R):u,c,ye,Se)(Me)}}function ye(De){return D(X,O),B}function Se(De){return O.restore(),++H<ee.length?F(ee[H]):K}}}function T(D,R){D.resolveAll&&!i.includes(D)&&i.push(D),D.resolve&&qo(u.events,R,u.events.length-R,D.resolve(u.events.slice(R),u)),D.resolveTo&&(u.events=D.resolveTo(u.events,u))}function P(){const D=g(),R=u.previous,k=u.currentConstruct,U=u.events.length,B=Array.from(l);return{from:U,restore:K};function K(){r=D,u.previous=R,u.currentConstruct=k,u.events.length=U,l=B,A()}}function A(){r.line in s&&r.column<2&&(r.column=s[r.line],r.offset+=s[r.line]-1)}}function xPe(t,e){const n=e.start._index,r=e.start._bufferIndex,s=e.end._index,i=e.end._bufferIndex;let o;if(n===s)o=[t[n].slice(r,i)];else{if(o=t.slice(n,s),r>-1){const l=o[0];typeof l=="string"?o[0]=l.slice(r):o.shift()}i>0&&o.push(t[s].slice(0,i))}return o}function vPe(t,e){let n=-1;const r=[];let s;for(;++n<t.length;){const i=t[n];let o;if(typeof i=="string")o=i;else switch(i){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=e?" ":"	";break}case-1:{if(!e&&s)continue;o=" ";break}default:o=String.fromCharCode(i)}s=i===-2,r.push(o)}return r.join("")}function wPe(t){const r={constructs:IIe([gPe,...(t||{}).extensions||[]]),content:s(MIe),defined:[],document:s(FIe),flow:s(tPe),lazy:{},string:s(sPe),text:s(iPe)};return r;function s(i){return o;function o(l){return yPe(r,i,l)}}}function _Pe(t){for(;!iW(t););return t}const AL=/[\0\t\n\r]/g;function bPe(){let t=1,e="",n=!0,r;return s;function s(i,o,l){const c=[];let u,d,h,f,m;for(i=e+(typeof i=="string"?i.toString():new TextDecoder(o||void 0).decode(i)),h=0,e="",n&&(i.charCodeAt(0)===65279&&h++,n=void 0);h<i.length;){if(AL.lastIndex=h,u=AL.exec(i),f=u&&u.index!==void 0?u.index:i.length,m=i.charCodeAt(f),!u){e=i.slice(h);break}if(m===10&&h===f&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),h<f&&(c.push(i.slice(h,f)),t+=f-h),m){case 0:{c.push(65533),t++;break}case 9:{for(d=Math.ceil(t/4)*4,c.push(-2);t++<d;)c.push(-1);break}case 10:{c.push(-4),t=1;break}default:r=!0,t=1}h=f+1}return l&&(r&&c.push(-5),e&&c.push(e),c.push(null)),c}}const SPe=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function EPe(t){return t.replace(SPe,CPe)}function CPe(t,e,n){if(e)return e;if(n.charCodeAt(0)===35){const s=n.charCodeAt(1),i=s===120||s===88;return tW(n.slice(i?2:1),i?16:10)}return tA(n)||t}const dW={}.hasOwnProperty;function TPe(t,e,n){return typeof e!="string"&&(n=e,e=void 0),IPe(n)(_Pe(wPe(n).document().write(bPe()(t,e,!0))))}function IPe(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(Gt),autolinkProtocol:P,autolinkEmail:P,atxHeading:i(ve),blockQuote:i(qe),characterEscape:P,characterReference:P,codeFenced:i(et),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:i(et,o),codeText:i(We,o),codeTextData:P,data:P,codeFlowValue:P,definition:i(mt),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:i(Le),hardBreakEscape:i(Je),hardBreakTrailing:i(Je),htmlFlow:i(Xe,o),htmlFlowData:P,htmlText:i(Xe,o),htmlTextData:P,image:i(kt),label:o,link:i(Gt),listItem:i(sn),listItemValue:f,listOrdered:i(fn,h),listUnordered:i(fn),paragraph:i(ae),reference:F,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:i(ve),strong:i(me),thematicBreak:i(Ne)},exit:{atxHeading:c(),atxHeadingSequence:M,autolink:c(),autolinkEmail:Ye,autolinkProtocol:Me,blockQuote:c(),characterEscapeValue:A,characterReferenceMarkerHexadecimal:Se,characterReferenceMarkerNumeric:Se,characterReferenceValue:De,characterReference:xe,codeFenced:c(E),codeFencedFence:x,codeFencedFenceInfo:m,codeFencedFenceMeta:g,codeFlowValue:A,codeIndented:c(v),codeText:c(B),codeTextData:A,data:A,definition:c(),definitionDestinationString:I,definitionLabelString:_,definitionTitleString:S,emphasis:c(),hardBreakEscape:c(R),hardBreakTrailing:c(R),htmlFlow:c(k),htmlFlowData:A,htmlText:c(U),htmlTextData:A,image:c(ee),label:X,labelText:H,lineEnding:D,link:c(K),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:ye,resourceDestinationString:O,resourceTitleString:z,resource:Y,setextHeading:c(T),setextHeadingLineSequence:C,setextHeadingText:j,strong:c(),thematicBreak:c()}};hW(e,(t||{}).mdastExtensions||[]);const n={};return r;function r(ne){let de={type:"root",children:[]};const Ee={stack:[de],tokenStack:[],config:e,enter:l,exit:u,buffer:o,resume:d,data:n},Qe=[];let re=-1;for(;++re<ne.length;)if(ne[re][1].type==="listOrdered"||ne[re][1].type==="listUnordered")if(ne[re][0]==="enter")Qe.push(re);else{const Ve=Qe.pop();re=s(ne,Ve,re)}for(re=-1;++re<ne.length;){const Ve=e[ne[re][0]];dW.call(Ve,ne[re][1].type)&&Ve[ne[re][1].type].call(Object.assign({sliceSerialize:ne[re][2].sliceSerialize},Ee),ne[re][1])}if(Ee.tokenStack.length>0){const Ve=Ee.tokenStack[Ee.tokenStack.length-1];(Ve[1]||RL).call(Ee,void 0,Ve[0])}for(de.position={start:Ja(ne.length>0?ne[0][1].start:{line:1,column:1,offset:0}),end:Ja(ne.length>0?ne[ne.length-2][1].end:{line:1,column:1,offset:0})},re=-1;++re<e.transforms.length;)de=e.transforms[re](de)||de;return de}function s(ne,de,Ee){let Qe=de-1,re=-1,Ve=!1,Te,ut,pt,he;for(;++Qe<=Ee;){const be=ne[Qe];switch(be[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{be[0]==="enter"?re++:re--,he=void 0;break}case"lineEndingBlank":{be[0]==="enter"&&(Te&&!he&&!re&&!pt&&(pt=Qe),he=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:he=void 0}if(!re&&be[0]==="enter"&&be[1].type==="listItemPrefix"||re===-1&&be[0]==="exit"&&(be[1].type==="listUnordered"||be[1].type==="listOrdered")){if(Te){let Fe=Qe;for(ut=void 0;Fe--;){const Pe=ne[Fe];if(Pe[1].type==="lineEnding"||Pe[1].type==="lineEndingBlank"){if(Pe[0]==="exit")continue;ut&&(ne[ut][1].type="lineEndingBlank",Ve=!0),Pe[1].type="lineEnding",ut=Fe}else if(!(Pe[1].type==="linePrefix"||Pe[1].type==="blockQuotePrefix"||Pe[1].type==="blockQuotePrefixWhitespace"||Pe[1].type==="blockQuoteMarker"||Pe[1].type==="listItemIndent"))break}pt&&(!ut||pt<ut)&&(Te._spread=!0),Te.end=Object.assign({},ut?ne[ut][1].start:be[1].end),ne.splice(ut||Qe,0,["exit",Te,be[2]]),Qe++,Ee++}if(be[1].type==="listItemPrefix"){const Fe={type:"listItem",_spread:!1,start:Object.assign({},be[1].start),end:void 0};Te=Fe,ne.splice(Qe,0,["enter",Fe,be[2]]),Qe++,Ee++,pt=void 0,he=!0}}}return ne[de][1]._spread=Ve,Ee}function i(ne,de){return Ee;function Ee(Qe){l.call(this,ne(Qe),Qe),de&&de.call(this,Qe)}}function o(){this.stack.push({type:"fragment",children:[]})}function l(ne,de,Ee){this.stack[this.stack.length-1].children.push(ne),this.stack.push(ne),this.tokenStack.push([de,Ee||void 0]),ne.position={start:Ja(de.start),end:void 0}}function c(ne){return de;function de(Ee){ne&&ne.call(this,Ee),u.call(this,Ee)}}function u(ne,de){const Ee=this.stack.pop(),Qe=this.tokenStack.pop();if(Qe)Qe[0].type!==ne.type&&(de?de.call(this,ne,Qe[0]):(Qe[1]||RL).call(this,ne,Qe[0]));else throw new Error("Cannot close `"+ne.type+"` ("+Vm({start:ne.start,end:ne.end})+"): it’s not open");Ee.position.end=Ja(ne.end)}function d(){return CIe(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function f(ne){if(this.data.expectingFirstListItemValue){const de=this.stack[this.stack.length-2];de.start=Number.parseInt(this.sliceSerialize(ne),10),this.data.expectingFirstListItemValue=void 0}}function m(){const ne=this.resume(),de=this.stack[this.stack.length-1];de.lang=ne}function g(){const ne=this.resume(),de=this.stack[this.stack.length-1];de.meta=ne}function x(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function E(){const ne=this.resume(),de=this.stack[this.stack.length-1];de.value=ne.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function v(){const ne=this.resume(),de=this.stack[this.stack.length-1];de.value=ne.replace(/(\r?\n|\r)$/g,"")}function _(ne){const de=this.resume(),Ee=this.stack[this.stack.length-1];Ee.label=de,Ee.identifier=lh(this.sliceSerialize(ne)).toLowerCase()}function S(){const ne=this.resume(),de=this.stack[this.stack.length-1];de.title=ne}function I(){const ne=this.resume(),de=this.stack[this.stack.length-1];de.url=ne}function M(ne){const de=this.stack[this.stack.length-1];if(!de.depth){const Ee=this.sliceSerialize(ne).length;de.depth=Ee}}function j(){this.data.setextHeadingSlurpLineEnding=!0}function C(ne){const de=this.stack[this.stack.length-1];de.depth=this.sliceSerialize(ne).codePointAt(0)===61?1:2}function T(){this.data.setextHeadingSlurpLineEnding=void 0}function P(ne){const Ee=this.stack[this.stack.length-1].children;let Qe=Ee[Ee.length-1];(!Qe||Qe.type!=="text")&&(Qe=fe(),Qe.position={start:Ja(ne.start),end:void 0},Ee.push(Qe)),this.stack.push(Qe)}function A(ne){const de=this.stack.pop();de.value+=this.sliceSerialize(ne),de.position.end=Ja(ne.end)}function D(ne){const de=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ee=de.children[de.children.length-1];Ee.position.end=Ja(ne.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(de.type)&&(P.call(this,ne),A.call(this,ne))}function R(){this.data.atHardBreak=!0}function k(){const ne=this.resume(),de=this.stack[this.stack.length-1];de.value=ne}function U(){const ne=this.resume(),de=this.stack[this.stack.length-1];de.value=ne}function B(){const ne=this.resume(),de=this.stack[this.stack.length-1];de.value=ne}function K(){const ne=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";ne.type+="Reference",ne.referenceType=de,delete ne.url,delete ne.title}else delete ne.identifier,delete ne.label;this.data.referenceType=void 0}function ee(){const ne=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";ne.type+="Reference",ne.referenceType=de,delete ne.url,delete ne.title}else delete ne.identifier,delete ne.label;this.data.referenceType=void 0}function H(ne){const de=this.sliceSerialize(ne),Ee=this.stack[this.stack.length-2];Ee.label=EPe(de),Ee.identifier=lh(de).toLowerCase()}function X(){const ne=this.stack[this.stack.length-1],de=this.resume(),Ee=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ee.type==="link"){const Qe=ne.children;Ee.children=Qe}else Ee.alt=de}function O(){const ne=this.resume(),de=this.stack[this.stack.length-1];de.url=ne}function z(){const ne=this.resume(),de=this.stack[this.stack.length-1];de.title=ne}function Y(){this.data.inReference=void 0}function F(){this.data.referenceType="collapsed"}function ye(ne){const de=this.resume(),Ee=this.stack[this.stack.length-1];Ee.label=de,Ee.identifier=lh(this.sliceSerialize(ne)).toLowerCase(),this.data.referenceType="full"}function Se(ne){this.data.characterReferenceType=ne.type}function De(ne){const de=this.sliceSerialize(ne),Ee=this.data.characterReferenceType;let Qe;Ee?(Qe=tW(de,Ee==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Qe=tA(de);const re=this.stack[this.stack.length-1];re.value+=Qe}function xe(ne){const de=this.stack.pop();de.position.end=Ja(ne.end)}function Me(ne){A.call(this,ne);const de=this.stack[this.stack.length-1];de.url=this.sliceSerialize(ne)}function Ye(ne){A.call(this,ne);const de=this.stack[this.stack.length-1];de.url="mailto:"+this.sliceSerialize(ne)}function qe(){return{type:"blockquote",children:[]}}function et(){return{type:"code",lang:null,meta:null,value:""}}function We(){return{type:"inlineCode",value:""}}function mt(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Le(){return{type:"emphasis",children:[]}}function ve(){return{type:"heading",depth:0,children:[]}}function Je(){return{type:"break"}}function Xe(){return{type:"html",value:""}}function kt(){return{type:"image",title:null,url:"",alt:null}}function Gt(){return{type:"link",title:null,url:"",children:[]}}function fn(ne){return{type:"list",ordered:ne.type==="listOrdered",start:null,spread:ne._spread,children:[]}}function sn(ne){return{type:"listItem",spread:ne._spread,checked:null,children:[]}}function ae(){return{type:"paragraph",children:[]}}function me(){return{type:"strong",children:[]}}function fe(){return{type:"text",value:""}}function Ne(){return{type:"thematicBreak"}}}function Ja(t){return{line:t.line,column:t.column,offset:t.offset}}function hW(t,e){let n=-1;for(;++n<e.length;){const r=e[n];Array.isArray(r)?hW(t,r):NPe(t,r)}}function NPe(t,e){let n;for(n in e)if(dW.call(e,n))switch(n){case"canContainEols":{const r=e[n];r&&t[n].push(...r);break}case"transforms":{const r=e[n];r&&t[n].push(...r);break}case"enter":case"exit":{const r=e[n];r&&Object.assign(t[n],r);break}}}function RL(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+Vm({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+Vm({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+Vm({start:e.start,end:e.end})+") is still open")}function PPe(t){const e=this;e.parser=n;function n(r){return TPe(r,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function APe(t,e){const n={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(e),!0)};return t.patch(e,n),t.applyData(e,n)}function RPe(t,e){const n={type:"element",tagName:"br",properties:{},children:[]};return t.patch(e,n),[t.applyData(e,n),{type:"text",value:`
`}]}function kPe(t,e){const n=e.value?e.value+`
`:"",r={};e.lang&&(r.className=["language-"+e.lang]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return e.meta&&(s.data={meta:e.meta}),t.patch(e,s),s=t.applyData(e,s),s={type:"element",tagName:"pre",properties:{},children:[s]},t.patch(e,s),s}function jPe(t,e){const n={type:"element",tagName:"del",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function DPe(t,e){const n={type:"element",tagName:"em",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function MPe(t,e){const n=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),s=sf(r.toLowerCase()),i=t.footnoteOrder.indexOf(r);let o,l=t.footnoteCounts.get(r);l===void 0?(l=0,t.footnoteOrder.push(r),o=t.footnoteOrder.length):o=i+1,l+=1,t.footnoteCounts.set(r,l);const c={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+s,id:n+"fnref-"+s+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};t.patch(e,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return t.patch(e,u),t.applyData(e,u)}function LPe(t,e){const n={type:"element",tagName:"h"+e.depth,properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function FPe(t,e){if(t.options.allowDangerousHtml){const n={type:"raw",value:e.value};return t.patch(e,n),t.applyData(e,n)}}function fW(t,e){const n=e.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const s=t.all(e),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const o=s[s.length-1];return o&&o.type==="text"?o.value+=r:s.push({type:"text",value:r}),s}function OPe(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return fW(t,e);const s={src:sf(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"img",properties:s,children:[]};return t.patch(e,i),t.applyData(e,i)}function VPe(t,e){const n={src:sf(e.url)};e.alt!==null&&e.alt!==void 0&&(n.alt=e.alt),e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"img",properties:n,children:[]};return t.patch(e,r),t.applyData(e,r)}function $Pe(t,e){const n={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};t.patch(e,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return t.patch(e,r),t.applyData(e,r)}function UPe(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return fW(t,e);const s={href:sf(r.url||"")};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"a",properties:s,children:t.all(e)};return t.patch(e,i),t.applyData(e,i)}function BPe(t,e){const n={href:sf(e.url)};e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"a",properties:n,children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function zPe(t,e,n){const r=t.all(e),s=n?GPe(n):mW(e),i={},o=[];if(typeof e.checked=="boolean"){const d=r[0];let h;d&&d.type==="element"&&d.tagName==="p"?h=d:(h={type:"element",tagName:"p",properties:{},children:[]},r.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let l=-1;for(;++l<r.length;){const d=r[l];(s||l!==0||d.type!=="element"||d.tagName!=="p")&&o.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?o.push(...d.children):o.push(d)}const c=r[r.length-1];c&&(s||c.type!=="element"||c.tagName!=="p")&&o.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:i,children:o};return t.patch(e,u),t.applyData(e,u)}function GPe(t){let e=!1;if(t.type==="list"){e=t.spread||!1;const n=t.children;let r=-1;for(;!e&&++r<n.length;)e=mW(n[r])}return e}function mW(t){const e=t.spread;return e??t.children.length>1}function HPe(t,e){const n={},r=t.all(e);let s=-1;for(typeof e.start=="number"&&e.start!==1&&(n.start=e.start);++s<r.length;){const o=r[s];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const i={type:"element",tagName:e.ordered?"ol":"ul",properties:n,children:t.wrap(r,!0)};return t.patch(e,i),t.applyData(e,i)}function WPe(t,e){const n={type:"element",tagName:"p",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function qPe(t,e){const n={type:"root",children:t.wrap(t.all(e))};return t.patch(e,n),t.applyData(e,n)}function KPe(t,e){const n={type:"element",tagName:"strong",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function YPe(t,e){const n=t.all(e),r=n.shift(),s=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:t.wrap([r],!0)};t.patch(e.children[0],o),s.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:t.wrap(n,!0)},l=XP(e.children[1]),c=KH(e.children[e.children.length-1]);l&&c&&(o.position={start:l,end:c}),s.push(o)}const i={type:"element",tagName:"table",properties:{},children:t.wrap(s,!0)};return t.patch(e,i),t.applyData(e,i)}function JPe(t,e,n){const r=n?n.children:void 0,i=(r?r.indexOf(e):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,l=o?o.length:e.children.length;let c=-1;const u=[];for(;++c<l;){const h=e.children[c],f={},m=o?o[c]:void 0;m&&(f.align=m);let g={type:"element",tagName:i,properties:f,children:[]};h&&(g.children=t.all(h),t.patch(h,g),g=t.applyData(h,g)),u.push(g)}const d={type:"element",tagName:"tr",properties:{},children:t.wrap(u,!0)};return t.patch(e,d),t.applyData(e,d)}function XPe(t,e){const n={type:"element",tagName:"td",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}const kL=9,jL=32;function QPe(t){const e=String(t),n=/\r?\n|\r/g;let r=n.exec(e),s=0;const i=[];for(;r;)i.push(DL(e.slice(s,r.index),s>0,!0),r[0]),s=r.index+r[0].length,r=n.exec(e);return i.push(DL(e.slice(s),s>0,!1)),i.join("")}function DL(t,e,n){let r=0,s=t.length;if(e){let i=t.codePointAt(r);for(;i===kL||i===jL;)r++,i=t.codePointAt(r)}if(n){let i=t.codePointAt(s-1);for(;i===kL||i===jL;)s--,i=t.codePointAt(s-1)}return s>r?t.slice(r,s):""}function ZPe(t,e){const n={type:"text",value:QPe(String(e.value))};return t.patch(e,n),t.applyData(e,n)}function eAe(t,e){const n={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(e,n),t.applyData(e,n)}const tAe={blockquote:APe,break:RPe,code:kPe,delete:jPe,emphasis:DPe,footnoteReference:MPe,heading:LPe,html:FPe,imageReference:OPe,image:VPe,inlineCode:$Pe,linkReference:UPe,link:BPe,listItem:zPe,list:HPe,paragraph:WPe,root:qPe,strong:KPe,table:YPe,tableCell:XPe,tableRow:JPe,text:ZPe,thematicBreak:eAe,toml:Wy,yaml:Wy,definition:Wy,footnoteDefinition:Wy};function Wy(){}const pW=-1,A_=0,Um=1,_w=2,sA=3,iA=4,oA=5,aA=6,gW=7,yW=8,ML=typeof self=="object"?self:globalThis,nAe=(t,e)=>{const n=(s,i)=>(t.set(i,s),s),r=s=>{if(t.has(s))return t.get(s);const[i,o]=e[s];switch(i){case A_:case pW:return n(o,s);case Um:{const l=n([],s);for(const c of o)l.push(r(c));return l}case _w:{const l=n({},s);for(const[c,u]of o)l[r(c)]=r(u);return l}case sA:return n(new Date(o),s);case iA:{const{source:l,flags:c}=o;return n(new RegExp(l,c),s)}case oA:{const l=n(new Map,s);for(const[c,u]of o)l.set(r(c),r(u));return l}case aA:{const l=n(new Set,s);for(const c of o)l.add(r(c));return l}case gW:{const{name:l,message:c}=o;return n(new ML[l](c),s)}case yW:return n(BigInt(o),s);case"BigInt":return n(Object(BigInt(o)),s);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:l}=new Uint8Array(o);return n(new DataView(l),o)}}return n(new ML[i](o),s)};return r},LL=t=>nAe(new Map,t)(0),cd="",{toString:rAe}={},{keys:sAe}=Object,Uf=t=>{const e=typeof t;if(e!=="object"||!t)return[A_,e];const n=rAe.call(t).slice(8,-1);switch(n){case"Array":return[Um,cd];case"Object":return[_w,cd];case"Date":return[sA,cd];case"RegExp":return[iA,cd];case"Map":return[oA,cd];case"Set":return[aA,cd];case"DataView":return[Um,n]}return n.includes("Array")?[Um,n]:n.includes("Error")?[gW,n]:[_w,n]},qy=([t,e])=>t===A_&&(e==="function"||e==="symbol"),iAe=(t,e,n,r)=>{const s=(o,l)=>{const c=r.push(o)-1;return n.set(l,c),c},i=o=>{if(n.has(o))return n.get(o);let[l,c]=Uf(o);switch(l){case A_:{let d=o;switch(c){case"bigint":l=yW,d=o.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+c);d=null;break;case"undefined":return s([pW],o)}return s([l,d],o)}case Um:{if(c){let f=o;return c==="DataView"?f=new Uint8Array(o.buffer):c==="ArrayBuffer"&&(f=new Uint8Array(o)),s([c,[...f]],o)}const d=[],h=s([l,d],o);for(const f of o)d.push(i(f));return h}case _w:{if(c)switch(c){case"BigInt":return s([c,o.toString()],o);case"Boolean":case"Number":case"String":return s([c,o.valueOf()],o)}if(e&&"toJSON"in o)return i(o.toJSON());const d=[],h=s([l,d],o);for(const f of sAe(o))(t||!qy(Uf(o[f])))&&d.push([i(f),i(o[f])]);return h}case sA:return s([l,o.toISOString()],o);case iA:{const{source:d,flags:h}=o;return s([l,{source:d,flags:h}],o)}case oA:{const d=[],h=s([l,d],o);for(const[f,m]of o)(t||!(qy(Uf(f))||qy(Uf(m))))&&d.push([i(f),i(m)]);return h}case aA:{const d=[],h=s([l,d],o);for(const f of o)(t||!qy(Uf(f)))&&d.push(i(f));return h}}const{message:u}=o;return s([l,{name:c,message:u}],o)};return i},FL=(t,{json:e,lossy:n}={})=>{const r=[];return iAe(!(e||n),!!e,new Map,r)(t),r},bw=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?LL(FL(t,e)):structuredClone(t):(t,e)=>LL(FL(t,e));function oAe(t,e){const n=[{type:"text",value:"↩"}];return e>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),n}function aAe(t,e){return"Back to reference "+(t+1)+(e>1?"-"+e:"")}function lAe(t){const e=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",n=t.options.footnoteBackContent||oAe,r=t.options.footnoteBackLabel||aAe,s=t.options.footnoteLabel||"Footnotes",i=t.options.footnoteLabelTagName||"h2",o=t.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<t.footnoteOrder.length;){const u=t.footnoteById.get(t.footnoteOrder[c]);if(!u)continue;const d=t.all(u),h=String(u.identifier).toUpperCase(),f=sf(h.toLowerCase());let m=0;const g=[],x=t.footnoteCounts.get(h);for(;x!==void 0&&++m<=x;){g.length>0&&g.push({type:"text",value:" "});let _=typeof n=="string"?n:n(c,m);typeof _=="string"&&(_={type:"text",value:_}),g.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+f+(m>1?"-"+m:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(c,m),className:["data-footnote-backref"]},children:Array.isArray(_)?_:[_]})}const E=d[d.length-1];if(E&&E.type==="element"&&E.tagName==="p"){const _=E.children[E.children.length-1];_&&_.type==="text"?_.value+=" ":E.children.push({type:"text",value:" "}),E.children.push(...g)}else d.push(...g);const v={type:"element",tagName:"li",properties:{id:e+"fn-"+f},children:t.wrap(d,!0)};t.patch(u,v),l.push(v)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...bw(o),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(l,!0)},{type:"text",value:`
`}]}}const xW=function(t){if(t==null)return hAe;if(typeof t=="function")return R_(t);if(typeof t=="object")return Array.isArray(t)?cAe(t):uAe(t);if(typeof t=="string")return dAe(t);throw new Error("Expected function, string, or object as test")};function cAe(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=xW(t[n]);return R_(r);function r(...s){let i=-1;for(;++i<e.length;)if(e[i].apply(this,s))return!0;return!1}}function uAe(t){const e=t;return R_(n);function n(r){const s=r;let i;for(i in t)if(s[i]!==e[i])return!1;return!0}}function dAe(t){return R_(e);function e(n){return n&&n.type===t}}function R_(t){return e;function e(n,r,s){return!!(fAe(n)&&t.call(this,n,typeof r=="number"?r:void 0,s||void 0))}}function hAe(){return!0}function fAe(t){return t!==null&&typeof t=="object"&&"type"in t}const vW=[],mAe=!0,OL=!1,pAe="skip";function gAe(t,e,n,r){let s;typeof e=="function"&&typeof n!="function"?(r=n,n=e):s=e;const i=xW(s),o=r?-1:1;l(t,void 0,[])();function l(c,u,d){const h=c&&typeof c=="object"?c:{};if(typeof h.type=="string"){const m=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(c.type+(m?"<"+m+">":""))+")"})}return f;function f(){let m=vW,g,x,E;if((!e||i(c,u,d[d.length-1]||void 0))&&(m=yAe(n(c,d)),m[0]===OL))return m;if("children"in c&&c.children){const v=c;if(v.children&&m[0]!==pAe)for(x=(r?v.children.length:-1)+o,E=d.concat(v);x>-1&&x<v.children.length;){const _=v.children[x];if(g=l(_,x,E)(),g[0]===OL)return g;x=typeof g[1]=="number"?g[1]:x+o}}return m}}}function yAe(t){return Array.isArray(t)?t:typeof t=="number"?[mAe,t]:t==null?vW:[t]}function wW(t,e,n,r){let s,i,o;typeof e=="function"&&typeof n!="function"?(i=void 0,o=e,s=n):(i=e,o=n,s=r),gAe(t,i,l,s);function l(c,u){const d=u[u.length-1],h=d?d.children.indexOf(c):void 0;return o(c,h,d)}}const IT={}.hasOwnProperty,xAe={};function vAe(t,e){const n=e||xAe,r=new Map,s=new Map,i=new Map,o={...tAe,...n.handlers},l={all:u,applyData:_Ae,definitionById:r,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:o,one:c,options:n,patch:wAe,wrap:SAe};return wW(t,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const h=d.type==="definition"?r:s,f=String(d.identifier).toUpperCase();h.has(f)||h.set(f,d)}}),l;function c(d,h){const f=d.type,m=l.handlers[f];if(IT.call(l.handlers,f)&&m)return m(l,d,h);if(l.options.passThrough&&l.options.passThrough.includes(f)){if("children"in d){const{children:x,...E}=d,v=bw(E);return v.children=l.all(d),v}return bw(d)}return(l.options.unknownHandler||bAe)(l,d,h)}function u(d){const h=[];if("children"in d){const f=d.children;let m=-1;for(;++m<f.length;){const g=l.one(f[m],d);if(g){if(m&&f[m-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=VL(g.value)),!Array.isArray(g)&&g.type==="element")){const x=g.children[0];x&&x.type==="text"&&(x.value=VL(x.value))}Array.isArray(g)?h.push(...g):h.push(g)}}}return h}}function wAe(t,e){t.position&&(e.position=rIe(t))}function _Ae(t,e){let n=e;if(t&&t.data){const r=t.data.hName,s=t.data.hChildren,i=t.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const o="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:o}}n.type==="element"&&i&&Object.assign(n.properties,bw(i)),"children"in n&&n.children&&s!==null&&s!==void 0&&(n.children=s)}return n}function bAe(t,e){const n=e.data||{},r="value"in e&&!(IT.call(n,"hProperties")||IT.call(n,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function SAe(t,e){const n=[];let r=-1;for(e&&n.push({type:"text",value:`
`});++r<t.length;)r&&n.push({type:"text",value:`
`}),n.push(t[r]);return e&&t.length>0&&n.push({type:"text",value:`
`}),n}function VL(t){let e=0,n=t.charCodeAt(e);for(;n===9||n===32;)e++,n=t.charCodeAt(e);return t.slice(e)}function $L(t,e){const n=vAe(t,e),r=n.one(t,void 0),s=lAe(n),i=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function EAe(t,e){return t&&"run"in t?async function(n,r){const s=$L(n,{file:r,...e});await t.run(s,r)}:function(n,r){return $L(n,{file:r,...t||e})}}function UL(t){if(t)throw t}var Ux=Object.prototype.hasOwnProperty,_W=Object.prototype.toString,BL=Object.defineProperty,zL=Object.getOwnPropertyDescriptor,GL=function(e){return typeof Array.isArray=="function"?Array.isArray(e):_W.call(e)==="[object Array]"},HL=function(e){if(!e||_W.call(e)!=="[object Object]")return!1;var n=Ux.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&Ux.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;var s;for(s in e);return typeof s>"u"||Ux.call(e,s)},WL=function(e,n){BL&&n.name==="__proto__"?BL(e,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):e[n.name]=n.newValue},qL=function(e,n){if(n==="__proto__")if(Ux.call(e,n)){if(zL)return zL(e,n).value}else return;return e[n]},CAe=function t(){var e,n,r,s,i,o,l=arguments[0],c=1,u=arguments.length,d=!1;for(typeof l=="boolean"&&(d=l,l=arguments[1]||{},c=2),(l==null||typeof l!="object"&&typeof l!="function")&&(l={});c<u;++c)if(e=arguments[c],e!=null)for(n in e)r=qL(l,n),s=qL(e,n),l!==s&&(d&&s&&(HL(s)||(i=GL(s)))?(i?(i=!1,o=r&&GL(r)?r:[]):o=r&&HL(r)?r:{},WL(l,{name:n,newValue:t(d,o,s)})):typeof s<"u"&&WL(l,{name:n,newValue:s}));return l};const ES=Ew(CAe);function NT(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function TAe(){const t=[],e={run:n,use:r};return e;function n(...s){let i=-1;const o=s.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);l(null,...s);function l(c,...u){const d=t[++i];let h=-1;if(c){o(c);return}for(;++h<s.length;)(u[h]===null||u[h]===void 0)&&(u[h]=s[h]);s=u,d?IAe(d,l)(...u):o(null,...u)}}function r(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return t.push(s),e}}function IAe(t,e){let n;return r;function r(...o){const l=t.length>o.length;let c;l&&o.push(s);try{c=t.apply(this,o)}catch(u){const d=u;if(l&&n)throw d;return s(d)}l||(c&&c.then&&typeof c.then=="function"?c.then(i,s):c instanceof Error?s(c):i(c))}function s(o,...l){n||(n=!0,e(o,...l))}function i(o){s(null,o)}}const Eo={basename:NAe,dirname:PAe,extname:AAe,join:RAe,sep:"/"};function NAe(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');Pg(t);let n=0,r=-1,s=t.length,i;if(e===void 0||e.length===0||e.length>t.length){for(;s--;)if(t.codePointAt(s)===47){if(i){n=s+1;break}}else r<0&&(i=!0,r=s+1);return r<0?"":t.slice(n,r)}if(e===t)return"";let o=-1,l=e.length-1;for(;s--;)if(t.codePointAt(s)===47){if(i){n=s+1;break}}else o<0&&(i=!0,o=s+1),l>-1&&(t.codePointAt(s)===e.codePointAt(l--)?l<0&&(r=s):(l=-1,r=o));return n===r?r=o:r<0&&(r=t.length),t.slice(n,r)}function PAe(t){if(Pg(t),t.length===0)return".";let e=-1,n=t.length,r;for(;--n;)if(t.codePointAt(n)===47){if(r){e=n;break}}else r||(r=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function AAe(t){Pg(t);let e=t.length,n=-1,r=0,s=-1,i=0,o;for(;e--;){const l=t.codePointAt(e);if(l===47){if(o){r=e+1;break}continue}n<0&&(o=!0,n=e+1),l===46?s<0?s=e:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||n<0||i===0||i===1&&s===n-1&&s===r+1?"":t.slice(s,n)}function RAe(...t){let e=-1,n;for(;++e<t.length;)Pg(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":kAe(n)}function kAe(t){Pg(t);const e=t.codePointAt(0)===47;let n=jAe(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.codePointAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function jAe(t,e){let n="",r=0,s=-1,i=0,o=-1,l,c;for(;++o<=t.length;){if(o<t.length)l=t.codePointAt(o);else{if(l===47)break;l=47}if(l===47){if(!(s===o-1||i===1))if(s!==o-1&&i===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(c=n.lastIndexOf("/"),c!==n.length-1){c<0?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}}else if(n.length>0){n="",r=0,s=o,i=0;continue}}e&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+t.slice(s+1,o):n=t.slice(s+1,o),r=o-s-1;s=o,i=0}else l===46&&i>-1?i++:i=-1}return n}function Pg(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const DAe={cwd:MAe};function MAe(){return"/"}function PT(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function LAe(t){if(typeof t=="string")t=new URL(t);else if(!PT(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return FAe(t)}function FAe(t){if(t.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.codePointAt(n)===37&&e.codePointAt(n+1)===50){const r=e.codePointAt(n+2);if(r===70||r===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(e)}const CS=["history","path","basename","stem","extname","dirname"];class bW{constructor(e){let n;e?PT(e)?n={path:e}:typeof e=="string"||OAe(e)?n={value:e}:n=e:n={},this.cwd="cwd"in n?"":DAe.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<CS.length;){const i=CS[r];i in n&&n[i]!==void 0&&n[i]!==null&&(this[i]=i==="history"?[...n[i]]:n[i])}let s;for(s in n)CS.includes(s)||(this[s]=n[s])}get basename(){return typeof this.path=="string"?Eo.basename(this.path):void 0}set basename(e){IS(e,"basename"),TS(e,"basename"),this.path=Eo.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?Eo.dirname(this.path):void 0}set dirname(e){KL(this.basename,"dirname"),this.path=Eo.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?Eo.extname(this.path):void 0}set extname(e){if(TS(e,"extname"),KL(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Eo.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){PT(e)&&(e=LAe(e)),IS(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?Eo.basename(this.path,this.extname):void 0}set stem(e){IS(e,"stem"),TS(e,"stem"),this.path=Eo.join(this.dirname||"",e+(this.extname||""))}fail(e,n,r){const s=this.message(e,n,r);throw s.fatal=!0,s}info(e,n,r){const s=this.message(e,n,r);return s.fatal=void 0,s}message(e,n,r){const s=new ws(e,n,r);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function TS(t,e){if(t&&t.includes(Eo.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+Eo.sep+"`")}function IS(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function KL(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function OAe(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const VAe=function(t){const r=this.constructor.prototype,s=r[t],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,r),i},$Ae={}.hasOwnProperty;class lA extends VAe{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=TAe()}copy(){const e=new lA;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];e.use(...r)}return e.data(ES(!0,{},this.namespace)),e}data(e,n){return typeof e=="string"?arguments.length===2?(AS("data",this.frozen),this.namespace[e]=n,this):$Ae.call(this.namespace,e)&&this.namespace[e]||void 0:e?(AS("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const s=n.call(e,...r);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const n=Ky(e),r=this.parser||this.Parser;return NS("parse",r),r(String(n),n)}process(e,n){const r=this;return this.freeze(),NS("process",this.parser||this.Parser),PS("process",this.compiler||this.Compiler),n?s(void 0,n):new Promise(s);function s(i,o){const l=Ky(e),c=r.parse(l);r.run(c,l,function(d,h,f){if(d||!h||!f)return u(d);const m=h,g=r.stringify(m,f);zAe(g)?f.value=g:f.result=g,u(d,f)});function u(d,h){d||!h?o(d):i?i(h):n(void 0,h)}}}processSync(e){let n=!1,r;return this.freeze(),NS("processSync",this.parser||this.Parser),PS("processSync",this.compiler||this.Compiler),this.process(e,s),JL("processSync","process",n),r;function s(i,o){n=!0,UL(i),r=o}}run(e,n,r){YL(e),this.freeze();const s=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?i(void 0,r):new Promise(i);function i(o,l){const c=Ky(n);s.run(e,c,u);function u(d,h,f){const m=h||e;d?l(d):o?o(m):r(void 0,m,f)}}}runSync(e,n){let r=!1,s;return this.run(e,n,i),JL("runSync","run",r),s;function i(o,l){UL(o),s=l,r=!0}}stringify(e,n){this.freeze();const r=Ky(n),s=this.compiler||this.Compiler;return PS("stringify",s),YL(e),s(e,r)}use(e,...n){const r=this.attachers,s=this.namespace;if(AS("use",this.frozen),e!=null)if(typeof e=="function")c(e,n);else if(typeof e=="object")Array.isArray(e)?l(e):o(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function i(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[d,...h]=u;c(d,h)}else o(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function o(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(u.plugins),u.settings&&(s.settings=ES(!0,s.settings,u.settings))}function l(u){let d=-1;if(u!=null)if(Array.isArray(u))for(;++d<u.length;){const h=u[d];i(h)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,d){let h=-1,f=-1;for(;++h<r.length;)if(r[h][0]===u){f=h;break}if(f===-1)r.push([u,...d]);else if(d.length>0){let[m,...g]=d;const x=r[f][1];NT(x)&&NT(m)&&(m=ES(!0,x,m)),r[f]=[u,m,...g]}}}}const UAe=new lA().freeze();function NS(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function PS(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function AS(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function YL(t){if(!NT(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function JL(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function Ky(t){return BAe(t)?t:new bW(t)}function BAe(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function zAe(t){return typeof t=="string"||GAe(t)}function GAe(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const HAe="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",XL=[],QL={allowDangerousHtml:!0},WAe=/^(https?|ircs?|mailto|xmpp)$/i,qAe=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function KAe(t){const e=YAe(t),n=JAe(t);return XAe(e.runSync(e.parse(n),n),t)}function YAe(t){const e=t.rehypePlugins||XL,n=t.remarkPlugins||XL,r=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...QL}:QL;return UAe().use(PPe).use(n).use(EAe,r).use(e)}function JAe(t){const e=t.children||"",n=new bW;return typeof e=="string"&&(n.value=e),n}function XAe(t,e){const n=e.allowedElements,r=e.allowElement,s=e.components,i=e.disallowedElements,o=e.skipHtml,l=e.unwrapDisallowed,c=e.urlTransform||QAe;for(const d of qAe)Object.hasOwn(e,d.from)&&(""+d.from+(d.to?"use `"+d.to+"` instead":"remove it")+HAe+d.id,void 0);return wW(t,u),lIe(t,{Fragment:a.Fragment,components:s,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function u(d,h,f){if(d.type==="raw"&&f&&typeof h=="number")return o?f.children.splice(h,1):f.children[h]={type:"text",value:d.value},h;if(d.type==="element"){let m;for(m in _S)if(Object.hasOwn(_S,m)&&Object.hasOwn(d.properties,m)){const g=d.properties[m],x=_S[m];(x===null||x.includes(d.tagName))&&(d.properties[m]=c(String(g||""),m,d))}}if(d.type==="element"){let m=n?!n.includes(d.tagName):i?i.includes(d.tagName):!1;if(!m&&r&&typeof h=="number"&&(m=!r(d,h,f)),m&&f&&typeof h=="number")return l&&d.children?f.children.splice(h,1,...d.children):f.children.splice(h,1),h}}}function QAe(t){const e=t.indexOf(":"),n=t.indexOf("?"),r=t.indexOf("#"),s=t.indexOf("/");return e===-1||s!==-1&&e>s||n!==-1&&e>n||r!==-1&&e>r||WAe.test(t.slice(0,e))?t:""}const ZAe=({productData:t,onViewDetails:e,onAddToCart:n,onBuyNow:r,onVisualize:s})=>{if(!t)return null;const{name:i,description:o,price:l,imageUrl:c,id:u}=t;return a.jsxs(Ge,{className:"mb-2 w-full max-w-xs sm:max-w-sm overflow-hidden shadow-md border border-border",children:[c&&a.jsx("div",{className:"w-full h-32 sm:h-40 overflow-hidden bg-muted",children:a.jsx("img",{src:c,alt:i||"Product image",className:"w-full h-full object-contain"})}),a.jsx(rt,{className:"p-3",children:i&&a.jsx(st,{className:"text-sm sm:text-base font-semibold leading-tight line-clamp-2",children:i})}),a.jsxs(Ze,{className:"p-3 pt-0 text-xs sm:text-sm",children:[o&&a.jsx(Wt,{className:"mb-2 line-clamp-2 sm:line-clamp-3 text-muted-foreground",children:o}),l&&a.jsx("p",{className:"font-semibold text-sm sm:text-base",children:typeof l=="number"?`$${l.toFixed(2)}`:l}),a.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row sm:space-x-2 space-y-2 sm:space-y-0",children:[e&&a.jsx(V,{size:"sm",variant:"outline",className:"flex-1 text-xs sm:text-sm",onClick:()=>e(u,i),children:"View"}),n&&a.jsx(V,{size:"sm",variant:"secondary",className:"flex-1 text-xs sm:text-sm",onClick:()=>n(u,i),children:"Add to Cart"}),r&&a.jsx(V,{size:"sm",variant:"default",className:"flex-1 text-xs sm:text-sm",onClick:()=>r(u,i),children:"Buy Now"})]}),s&&a.jsxs(V,{size:"sm",variant:"outline",className:"w-full mt-2 text-xs sm:text-sm",onClick:()=>s(u,i),children:[a.jsx(Xr,{className:"mr-2 h-4 w-4"}),"Visualize with Image"]})]})]})},eRe="AIzaSyBcpnUVVBDNaBLG7Rj_cEmE0J4zNlHmg7o",tRe=new ar({apiKey:eRe}),nRe="gemini-2.0-flash-preview-image-generation";async function RS(t,e){if(!t)throw new Error("Image source is undefined or null.");let n,r=e;if(typeof t=="string"&&(t.startsWith("http://")||t.startsWith("https://"))){console.log(`Fetching image from URL: ${t}`);const i=await fetch(t);if(!i.ok)throw new Error(`Failed to fetch image from ${t}: ${i.statusText}`);const o=await i.blob();r=o.type||r||"image/jpeg",n=await new Promise((l,c)=>{const u=new FileReader;u.onloadend=()=>{typeof u.result=="string"?l(u.result.split(",")[1]):c(new Error("FileReader did not return a string for URL image."))},u.onerror=d=>c(new Error(`FileReader failed for URL image: ${d}`)),u.readAsDataURL(o)})}else if(typeof t=="string"&&t.startsWith("data:")){console.log("Processing Data URL image.");try{const i=t.split(",");if(i.length<2)throw new Error("Invalid data URL structure.");const o=i[0];n=i[1];const l=o.match(/:(.*?);/);if(!l||!l[1])throw new Error("Could not parse MIME type from data URL.");r=l[1]}catch(i){throw console.error("Error parsing data URL:",t,i),new Error(`Invalid data URL format: ${i.message}`)}}else if(typeof File<"u"&&t instanceof File)console.log(`Processing File object: ${t.name}`),r=t.type,n=await new Promise((i,o)=>{const l=new FileReader;l.onloadend=()=>{typeof l.result=="string"?i(l.result.split(",")[1]):o(new Error("FileReader did not return a string for File object."))},l.onerror=c=>o(new Error(`FileReader failed for File object: ${c}`)),l.readAsDataURL(t)});else if(typeof t=="string"){console.warn(`Received string imageSource that is not a URL or Data URL: "${t}". This path is intended for Node.js file paths.`);try{console.log(`Attempting to read image from local path (Node.js context): ${t}`),n=(await(await jt(()=>import("./__vite-browser-external-b25bb000.js"),[])).readFile(t)).toString("base64");const c=(await jt(()=>import("./__vite-browser-external-b25bb000.js"),[])).extname(t).toLowerCase();if(!r)if(c===".png")r="image/png";else if(c===".jpg"||c===".jpeg")r="image/jpeg";else if(c===".webp")r="image/webp";else if(c===".gif")r="image/gif";else throw new Error(`Unsupported image extension or MIME type not provided for path: ${t}`)}catch(i){throw console.error("Failed to process string as Node.js file path (this is expected in browser):",i),new Error("Unsupported string imageSource in browser. Must be URL or Data URL, or provide a File object.")}}else throw new Error("Unsupported image source type. Provide a URL, Data URL, or File object.");if(!n)throw new Error("Could not obtain base64 image data.");r||(r="image/jpeg",console.warn("MIME type could not be determined, defaulting to image/jpeg."));const s=["image/png","image/jpeg","image/webp","image/heic","image/heif"];return s.includes(r)||console.warn(`MIME type ${r} may not be optimally supported. Supported types are: ${s.join(", ")}.`),{inlineData:{data:n,mimeType:r}}}async function SW({mainProduct:t,referenceSceneSource:e,additionalProducts:n=[],customInstructions:r=""}){var o,l,c,u,d,h,f,m;if(!t||!t.name||!t.imageSource)throw new Error("Main product with name and imageSource is required.");if(!e)throw new Error("Reference scene imageSource is required.");const s=[];let i=`Visually integrate the product named "${t.name}" into a scene inspired by the provided reference scene image.
The main product is described as: "${t.description||"Not specified"}".
The reference scene image sets the style, lighting, and overall environment.
Make the main product the primary focus, well-lit, and naturally fitting the scene's perspective.
`;n.length>0&&(i+=`
Also, incorporate the following additional products naturally into the scene:
`,n.forEach((g,x)=>{i+=`- Product ${x+1}: "${g.name}" (Description: "${g.description||"Not specified"}")
`})),r.trim()!==""&&(i+=`
Specific User Instructions: "${r.trim()}"
`),i+=`
Please generate a high-quality, photorealistic image based on these instructions and the provided images. Also provide a brief text commentary about the generated image or any challenges encountered.`,s.push({text:i});try{s.push(await RS(e)),s.push(await RS(t.imageSource));for(const g of n)if(g.imageSource)try{s.push(await RS(g.imageSource))}catch(x){console.warn(`Could not process image for additional product "${g.name}": ${x.message}. Skipping this image.`)}}catch(g){throw new Error(`Failed to process one or more input images: ${g.message}`)}console.log("Constructed prompt parts. Total parts:",s.length);try{const g=await tRe.models.generateContent({model:nRe,contents:[{role:"user",parts:s}],generationConfig:{temperature:.6,candidateCount:1},safetySettings:[{category:Ur.HARM_CATEGORY_HARASSMENT,threshold:Br.BLOCK_MEDIUM_AND_ABOVE},{category:Ur.HARM_CATEGORY_HATE_SPEECH,threshold:Br.BLOCK_MEDIUM_AND_ABOVE},{category:Ur.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Br.BLOCK_MEDIUM_AND_ABOVE},{category:Ur.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Br.BLOCK_MEDIUM_AND_ABOVE}],config:{responseModalities:[Rn.TEXT,Rn.IMAGE]}}),x=g;if(!x)throw console.error("Full API result from Gemini was undefined:",g),new Error("Invalid or empty response from Gemini API.");let E=null,v="No specific commentary from the model.";console.log("Full API response from Gemini:",JSON.stringify(x,null,2)),(o=x.promptFeedback)!=null&&o.blockReason&&(v=`Image generation may have been blocked. Reason: ${x.promptFeedback.blockReason}.`,console.warn(v));const _=(l=x.candidates)==null?void 0:l[0];if(_){if(_.finishReason&&_.finishReason!=="STOP"&&_.finishReason!=="MAX_TOKENS"){const S=`Generation stopped. Reason: ${_.finishReason}.`;v=v==="No specific commentary from the model."?S:`${v}. ${S}`,console.warn(S)}if(((u=(c=_.content)==null?void 0:c.parts)==null?void 0:u.length)>0)for(const S of _.content.parts)S.text?v=v==="No specific commentary from the model."||!v.includes(S.text)?v==="No specific commentary from the model."?S.text:v+" "+S.text:v:(h=(d=S.inlineData)==null?void 0:d.mimeType)!=null&&h.startsWith("image/")&&(E=`data:${S.inlineData.mimeType};base64,${S.inlineData.data}`,console.log(`Image generated successfully. MIME type: ${S.inlineData.mimeType}`))}else(f=x.promptFeedback)!=null&&f.blockReason||(v=v==="No specific commentary from the model."?"No candidates returned by the model.":`${v}. Also, no candidates were returned.`);return!E&&v==="No specific commentary from the model."&&(v="Image generation failed, and no specific reason or commentary was provided."),{imageUrl:E,commentary:v,promptUsed:i}}catch(g){console.error("Error during Gemini API call or response processing:",g);let x=g.message;throw(m=g.response)!=null&&m.message?x=g.response.message:g.response&&(x=JSON.stringify(g.response)),new Error(`Product visualization failed: ${x}`)}}UP("pk_live_51NAoUjDktew9heHOJD5Px4jn9IaolhvVvqoE6NukJV7MxZa8PhIVSwcOVWXdQx6MFNgIGmEYeg64lFUGlYfAyVqu004n16tAdG");const EW=()=>{var pt;const t=bi(),{currentStore:e,addToCart:n,getProductById:r,updateQuantity:s,viewMode:i}=$n(),{userRole:o}=qi(),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[h,f]=p.useState('You are a friendly and helpful AI assistant for an e-commerce store. Be concise and helpful. Always format your responses using Markdown. If a user asks you to find a product, your primary action should be to use the `find_and_open_product` function. **Only after the `find_and_open_product` function successfully returns product details (indicated by `product_found: true` in the function\'s result) should you then say something like "Here is the product I found for you:".** At that point, a product card will also be displayed by the UI. Following your acknowledgment, you MUST ask a relevant follow-up question, such as "Would you like to see more details, add it to your cart, or keep browsing?". If the function call indicates the product was not found (`product_found: false`), you should inform the user you could not find the product and offer to search again or help with something else. Do not repeat raw product data (like image URLs or full product objects) in your text response, as the card already displays this information.'),[m,g]=p.useState(""),[x,E]=p.useState([]),[v,_]=p.useState(null),[S,I]=p.useState(null),[M,j]=p.useState(!1),[C,T]=p.useState(null),P=p.useRef(null),A=p.useRef([]),D=p.useRef(null),R=p.useRef(null),[k,U]=p.useState(null),[B,K]=p.useState(!1),ee=p.useRef(!1),H={name:"find_and_open_product",description:"Finds a product based on a query (name, keywords, or ID) and returns its details for display. It does NOT navigate. After displaying, ask if the user wants to navigate or add to cart.",parameters:{type:ze.OBJECT,properties:{product_query:{type:ze.STRING,description:"The name, keywords, or ID of the product to find."}},required:["product_query"]}},X={name:"navigate_to_product_detail_page",description:"Navigates the user to the detailed page for a specific product, given its ID.",parameters:{type:ze.OBJECT,properties:{product_id:{type:ze.STRING,description:"The unique ID of the product."},product_name:{type:ze.STRING,description:"The name of the product (for confirmation)."}},required:["product_id"]}},O={name:"add_to_cart",description:"Adds a specified product to the user's shopping cart.",parameters:{type:ze.OBJECT,properties:{product_id:{type:ze.STRING,description:"The unique ID of the product to add."},product_name:{type:ze.STRING,description:"The name of the product (for confirmation)."},quantity:{type:ze.NUMBER,description:"The quantity to add. Defaults to 1 if not specified."}},required:["product_id"]}},z={name:"initiate_purchase",description:"Initiates the purchase process for a specified product, potentially by adding to cart and navigating to checkout or directly to a payment page.",parameters:{type:ze.OBJECT,properties:{product_id:{type:ze.STRING,description:"The unique ID of the product to purchase."},product_name:{type:ze.STRING,description:"The name of the product (for confirmation)."}},required:["product_id"]}},Y={name:"navigate_home",description:`Navigates the user to the application's home page (typically the root path "/").`,parameters:{type:ze.OBJECT,properties:{}}},F={name:"navigate_to_content_creation_page",description:"Navigates the user to the content creation page.",parameters:{type:ze.OBJECT,properties:{}}},ye={name:"navigate_to_store_dashboard",description:"Navigates the user to the store dashboard page.",parameters:{type:ze.OBJECT,properties:{}}},Se={name:"navigate_to_route",description:'Navigates the user to a specified route within the application. Use for requests like "go to a specific page". This is a generic navigation tool.',parameters:{type:ze.OBJECT,properties:{route:{type:ze.STRING,description:'The path to navigate to (e.g., "/", "/content-creation", "/dashboard").'}},required:["route"]}},De={name:"toggle_theme_mode",description:"Toggles the application's visual theme between light and dark mode.",parameters:{type:ze.OBJECT,properties:{}}},xe={name:"open_import_store_dialog",description:"Opens the dialog or interface for importing a store from another platform.",parameters:{type:ze.OBJECT,properties:{}}},Me={name:"go_to_cart",description:"Navigates the user to their shopping cart page.",parameters:{type:ze.OBJECT,properties:{}}},Ye=[H,X,O,z,Se,De,xe,Me,Y,F,ye],qe=()=>{var he;(he=D.current)==null||he.scrollIntoView({behavior:"smooth"})};p.useEffect(qe,[x]);const et=()=>c(!l),We=()=>d(!u),mt=()=>{d(!1)},Le=(he=null)=>{const be=typeof he=="string"?he:m;if(be.trim()==="")return;const Fe=`user-text-${Date.now()}`;E(Pe=>[...Pe,{id:Fe,role:"user",text:be}]),typeof he!="string"&&g(""),v==="gemini"&&S?ve(be):console.error("Error: Gemini chat not active. Cannot send message.")},ve=async he=>{if(!S){console.error("Gemini chat not initialized.");return}try{const be=await S.sendMessageStream({message:[{text:he}]}),Fe=`assistant-gemini-${Date.now()}`;E(Ht=>[...Ht,{id:Fe,role:"assistant",text:"",functionCallData:null}]);let Pe="",Yt=null;for await(const Ht of be){let Tt=null;Ht.functionCalls&&Ht.functionCalls.length>0?Tt=Ht.functionCalls[0]:Ht.functionCall&&(Tt=Ht.functionCall),Tt&&(Yt=Tt);const yt=Ht.text;yt&&(Pe+=yt,E(Ft=>Ft.map(Sn=>Sn.id===Fe?{...Sn,text:Pe}:Sn)))}Yt?(E(Ht=>Ht.map(Tt=>{if(Tt.id===Fe){let yt=`(Function call: ${Yt.name})`;Yt.name==="find_and_open_product"&&(yt="Searching for product…");const Ft=Pe.trim()===""?yt:`${Pe}
${yt}`;return{...Tt,text:Ft,functionCallData:Yt}}return Tt})),await fe(Yt,Fe)):Pe.trim()!==""||E(Ht=>Ht.map(Tt=>Tt.id===Fe?{...Tt,text:"(Assistant responded without text)"}:Tt))}catch(be){console.error("Error sending/receiving Gemini message:",be)}},Je=he=>{const be=he.route;if(be)try{return t(be),{success:!0,detail:`Successfully navigated to ${be}`}}catch(Fe){return console.error("Navigation error:",Fe),{success:!1,detail:`Failed to navigate: ${Fe.message}`}}return{success:!1,detail:"Route not provided in arguments."}},Xe=he=>({success:!0,detail:"Theme toggled (placeholder action)."}),kt=he=>({success:!0,detail:"Import store dialog would be shown (placeholder action)."}),Gt=he=>{try{return t("/cart"),{success:!0,detail:"Navigated to cart page."}}catch(be){return console.error("Navigation to cart error:",be),{success:!1,detail:`Failed to navigate to cart: ${be.message}`}}},fn=he=>{var Yt,Ht,Tt,yt,Ft,Sn,mn,xr,Un;const be=(Yt=he.product_query)==null?void 0:Yt.toLowerCase().trim();if(!be)return{success:!0,product_found:!1,detail:"Product query not provided."};if(!e||!e.products||e.products.length===0)return{success:!0,product_found:!1,detail:"No products available in the current store to search."};const Fe=e.products;let Pe=null;if(Pe=Fe.find(Xt=>{var nn;return((nn=Xt.name)==null?void 0:nn.toLowerCase())===be}),!Pe){const Xt=be.split(/\s+/).filter(nn=>nn.length>1);if(Xt.length>0){let nn=Fe.map(Bn=>{var Ie,Oe;const q=((Ie=Bn.name)==null?void 0:Ie.toLowerCase())||"",te=((Oe=Bn.description)==null?void 0:Oe.toLowerCase())||"";let le=0;return Xt.forEach(ht=>{q.includes(ht)&&(le+=2),te.includes(ht)&&(le+=1)}),q.includes(be)&&(le+=5),te.includes(be)&&(le+=2),{product:Bn,score:le}});nn=nn.filter(Bn=>Bn.score>0).sort((Bn,q)=>q.score-Bn.score),nn.length>0&&(Pe=nn[0].product)}}if(Pe||/^[a-zA-Z0-9-_]+$/.test(be)&&!be.includes(" ")&&(Pe=Fe.find(Xt=>{var nn;return((nn=Xt.id)==null?void 0:nn.toString())===be})),Pe){let Xt=null;return(Tt=(Ht=Pe.image)==null?void 0:Ht.src)!=null&&Tt.large&&typeof Pe.image.src.large=="string"?Xt=Pe.image.src.large:(Ft=(yt=Pe.image)==null?void 0:yt.src)!=null&&Ft.medium&&typeof Pe.image.src.medium=="string"?Xt=Pe.image.src.medium:(mn=(Sn=Pe.image)==null?void 0:Sn.src)!=null&&mn.small&&typeof Pe.image.src.small=="string"?Xt=Pe.image.src.small:Pe.image_url&&typeof Pe.image_url=="string"?Xt=Pe.image_url:Pe.imageUrl&&typeof Pe.imageUrl=="string"?Xt=Pe.imageUrl:Pe.image&&typeof Pe.image=="string"?Xt=Pe.image:Pe.images&&Array.isArray(Pe.images)&&Pe.images.length>0&&((xr=Pe.images[0])!=null&&xr.src)&&typeof Pe.images[0].src=="string"?Xt=Pe.images[0].src:(Un=Pe.featuredImage)!=null&&Un.url&&typeof Pe.featuredImage.url=="string"&&(Xt=Pe.featuredImage.url),Xt&&typeof Xt=="string"&&Xt.trim()!==""?Xt=Xt.trim():Xt=null,{success:!0,product_found:!0,product_data:{id:Pe.id,name:Pe.name,description:Pe.description||"No description available.",price:Pe.price||"Price not available.",imageUrl:Xt},detail:`Found product: ${Pe.name}`}}else return{success:!0,product_found:!1,detail:`Could not find a matching or relevant product for query: "${he.product_query}"`}},sn=he=>he.product_id&&e&&e.id?(t(`/store/${e.id}/product/${he.product_id}`),{success:!0,detail:`Navigated to product page for ID ${he.product_id} in store ${e.id}`}):!e||!e.id?{success:!1,detail:"Current store information is not available for navigation."}:{success:!1,detail:"Product ID not provided for navigation."},ae=he=>{if(!e||!e.id)return{success:!1,detail:"Current store not available for cart operation."};if(!he.product_id)return{success:!1,detail:"Product ID not provided to add to cart."};const be=r(e.id,he.product_id);if(be){const Fe=he.quantity||1;return n(be,e.id),Fe>1&&s(he.product_id,e.id,Fe),{success:!0,detail:`${he.product_name||be.name||"Product"} added/updated in cart with quantity ${Fe}.`}}else return{success:!1,detail:`Product with ID ${he.product_id} not found.`}},me=he=>{const{product_id:be,product_name:Fe}=he;if(!e||!e.id)return console.error("Buy Now: Current store not available."),{success:!1,detail:"Current store information is not available to initiate purchase."};if(!be)return console.error("Buy Now: Product ID not provided."),{success:!1,detail:"Product ID not provided."};const Pe=r(e.id,be);if(!Pe)return console.error(`Buy Now: Product with ID ${be} not found.`),{success:!1,detail:`Product with ID ${be} not found.`};try{return n(Pe,e.id),t("/checkout",{state:{action:"buyNow",productToAddId:Pe.id,storeId:e.id}}),{success:!0,detail:`Added ${Pe.name||"product"} to cart and navigated to checkout.`}}catch(Yt){return console.error("Error during Buy Now (add to cart & navigate) process:",Yt),{success:!1,detail:Yt.message||"Could not process Buy Now action."}}},fe=async(he,be)=>{let Fe,Pe=!1;switch(he.name){case"navigate_to_route":Fe=Je(he.args),Pe=Fe.success;break;case"toggle_theme_mode":Fe=Xe(he.args),Pe=Fe.success;break;case"open_import_store_dialog":Fe=kt(he.args),Pe=Fe.success;break;case"go_to_cart":Fe=Gt(he.args),Pe=Fe.success;break;case"navigate_home":Fe=Je({route:"/"}),Pe=Fe.success;break;case"navigate_to_content_creation_page":Fe=Je({route:"/content-creation"}),Pe=Fe.success;break;case"navigate_to_store_dashboard":Fe=Je({route:"/dashboard"}),Pe=Fe.success;break;case"find_and_open_product":Fe=fn(he.args),Pe=Fe.success;break;case"navigate_to_product_detail_page":Fe=sn(he.args),Pe=Fe.success;break;case"add_to_cart":Fe=ae(he.args),Pe=Fe.success;break;case"initiate_purchase":Fe=me(he.args),Pe=Fe.success;break;default:Fe={success:!1,detail:`Error: Unknown function ${he.name}`}}if(!Pe){console.error(`Function ${he.name} execution failed: ${Fe.detail}`),E(Ht=>Ht.map(Tt=>Tt.id===be?{...Tt,text:(Tt.text.replace(/\(Function call: .*\)/,"").trim()+`
(Function ${he.name} failed)`).trim(),functionCallData:null}:Tt));return}const Yt={message:[{functionResponse:{name:he.name,response:{result:Fe}}}]};try{const Ht=await S.sendMessageStream(Yt);let Tt="";E(yt=>yt.map(Ft=>Ft.id===be?{...Ft,text:"",functionCallData:null,productCardData:null}:Ft));for await(const yt of Ht){if(yt.functionCalls||yt.functionCall){console.error("Model attempted another function call immediately after a function response.");break}const Ft=yt.text;Ft&&(Tt+=Ft,E(Sn=>Sn.map(mn=>{if(mn.id===be){const xr={...mn,text:Tt};return he.name==="find_and_open_product"&&Fe.success&&Fe.product_found&&(xr.productCardData=Fe.product_data),xr}return mn})))}he.name==="find_and_open_product"&&Fe.success&&Fe.product_found&&E(yt=>yt.map(Ft=>Ft.id===be?{...Ft,productCardData:Fe.product_data}:Ft)),Tt.trim()===""&&(he.name==="find_and_open_product"&&Fe.product_found?E(yt=>yt.map(Ft=>Ft.id===be&&Ft.text.trim()===""?{...Ft,text:"Here is the product information:"}:Ft)):E(yt=>yt.map(Ft=>Ft.id===be&&Ft.text.trim()===""?{...Ft,text:"(Function processed)"}:Ft)))}catch(Ht){console.error("Error sending function response or getting final response from Gemini:",Ht),E(Tt=>Tt.map(yt=>yt.id===be?{...yt,text:(yt.text+`
(Error processing function result)`).trim(),functionCallData:null}:yt))}},Ne=async()=>{if(S||B)return;K(!0);const he="AIzaSyBcpnUVVBDNaBLG7Rj_cEmE0J4zNlHmg7o";try{const be=new ar({apiKey:he}),Pe=x.filter(Tt=>Tt.role==="user"||Tt.role==="assistant").map(Tt=>({role:Tt.role==="assistant"?"model":"user",parts:[{text:Tt.text||""}]})).filter(Tt=>Tt.parts.every(yt=>typeof yt.text=="string"&&yt.text.trim()!=="")),Yt={tools:[{functionDeclarations:Ye}],systemInstruction:h},Ht=be.chats.create({model:"gemini-2.0-flash",history:Pe,config:Yt,generationConfig:{}});if(!Ht)throw new Error("genAI.chats.create() returned a null or undefined chat instance.");I(Ht),_("gemini"),ee.current=!1}catch(be){console.error("Error initializing Gemini chat:",be),I(null),_(null)}finally{K(!1)}},ne=()=>{I(null),K(!1),_(null),ee.current=!1};p.useEffect(()=>(l?!S&&!B&&Ne():ne(),()=>ne()),[l]),p.useEffect(()=>{v==="gemini"?ee.current?h&&!B&&S&&(I(null),ee.current=!1,Ne()):ee.current=!0:ee.current=!1},[h,v,B,S]);const de=(he,be)=>{sn({product_id:he})},Ee=(he,be)=>{if(!e||!e.id){console.error("Cannot add to cart: current store not available.");return}const Fe=r(e.id,he);Fe?n(Fe,e.id):console.error(`Product with ID ${he} not found, cannot add to cart.`)},Qe=async(he,be)=>{const Fe=await me({product_id:he,product_name:be});Fe.success||console.error("Buy Now failed:",Fe.detail)},re=(he,be)=>{var Fe;U({id:he,name:be}),(Fe=R.current)==null||Fe.click()},Ve=he=>{var Fe,Pe,Yt,Ht,Tt,yt,Ft,Sn;if(!he)return null;let be=null;return(Pe=(Fe=he.image)==null?void 0:Fe.src)!=null&&Pe.large&&typeof he.image.src.large=="string"?be=he.image.src.large:(Ht=(Yt=he.image)==null?void 0:Yt.src)!=null&&Ht.medium&&typeof he.image.src.medium=="string"?be=he.image.src.medium:(yt=(Tt=he.image)==null?void 0:Tt.src)!=null&&yt.small&&typeof he.image.src.small=="string"?be=he.image.src.small:he.image_url&&typeof he.image_url=="string"?be=he.image_url:he.imageUrl&&typeof he.imageUrl=="string"?be=he.imageUrl:he.image&&typeof he.image=="string"?be=he.image:he.images&&Array.isArray(he.images)&&he.images.length>0&&((Ft=he.images[0])!=null&&Ft.src)?be=he.images[0].src:(Sn=he.featuredImage)!=null&&Sn.url&&(be=he.featuredImage.url),be&&typeof be=="string"&&be.trim()!==""?be.trim():null},Te=async he=>{var Fe;const be=(Fe=he.target.files)==null?void 0:Fe[0];if(!be||!k){U(null),R.current&&(R.current.value="");return}E(Pe=>[...Pe,{id:`system-visualizing-${Date.now()}`,role:"system",text:`Visualizing ${k.name} with your uploaded image. This may take a moment...`}]);try{console.log("[ChatViz] Getting product details for ID:",k.id);const Pe=r(e.id,k.id);if(!Pe)throw console.error("[ChatViz] Product not found for ID:",k.id),new Error("Product details not found for visualization.");console.log("[ChatViz] Product found:",Pe.name);const Yt=Ve(Pe);if(!Yt)throw console.error("[ChatViz] Product actual image URL is missing or invalid for product:",Pe.name,"Raw product data:",Pe),new Error("Product does not have a valid existing image to use for visualization context.");console.log("[ChatViz] Actual Product imageUrl to use:",Yt);const Ht={name:Pe.name,description:Pe.description,imageSource:Yt},Tt=`Visualize the product "${Pe.name}" in a new scene inspired by the provided reference image. Focus on a creative and appealing composition.`;console.log("[ChatViz] Calling generateProductVisualization...");const yt=await SW({mainProduct:Ht,referenceSceneSource:be,additionalProducts:[],customInstructions:Tt});if(console.log("[ChatViz] generateProductVisualization result:",yt),yt&&yt.imageUrl)E(Ft=>[...Ft,{id:`assistant-viz-${Date.now()}`,role:"assistant",text:yt.commentary||`Here's a new visualization for ${Pe.name}:`,imageDataUrl:yt.imageUrl}]);else throw console.error("[ChatViz] generateProductVisualization did not return an imageUrl. Commentary:",yt==null?void 0:yt.commentary),new Error((yt==null?void 0:yt.commentary)||"Visualization did not return an image.")}catch(Pe){console.error("Error during visualization in chat:",Pe.name,Pe.message,Pe.stack),E(Yt=>[...Yt,{id:`error-viz-${Date.now()}`,role:"system",text:`Sorry, I couldn't visualize the product. Error: ${Pe.name} - ${Pe.message}`}])}finally{U(null),R.current&&(R.current.value="")}},ut=async()=>{if(M)P.current&&P.current.state==="recording"&&P.current.stop(),j(!1);else try{const he=await navigator.mediaDevices.getUserMedia({audio:!0});P.current=new MediaRecorder(he),A.current=[],P.current.ondataavailable=be=>{A.current.push(be.data)},P.current.onstop=async()=>{const be=new Blob(A.current,{type:"audio/webm"});A.current=[],console.log("Audio recorded:",be),E(Fe=>[...Fe,{id:`user-audio-${Date.now()}`,role:"user",text:"[User sent audio]"}]),setTimeout(()=>{const Fe=`assistant-audio-${Date.now()}`;E(Pe=>[...Pe,{id:Fe,role:"assistant",text:"[Assistant audio response]"}])},2e3)},P.current.start(),j(!0),E(be=>[...be,{id:`system-rec-${Date.now()}`,role:"system",text:"Recording started..."}])}catch(he){console.error("Error accessing microphone:",he),E(be=>[...be,{id:`error-mic-${Date.now()}`,role:"system",text:"Error: Could not access microphone."}])}};return p.useEffect(()=>()=>{C&&C.context.state!=="closed"&&C.context.close(),P.current&&P.current.stream&&P.current.stream.getTracks().forEach(he=>he.stop())},[C]),a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"file",ref:R,style:{display:"none"},accept:"image/*",onChange:Te}),!l&&a.jsx(V,{onClick:et,className:"fixed bottom-[96px] right-0 py-4 pl-4 pr-1.5 shadow-lg z-50 rounded-tl-[20px] rounded-bl-[20px] rounded-tr-none rounded-br-none",size:"icon","aria-label":"Open Chatbot",style:{backgroundColor:((pt=e==null?void 0:e.theme)==null?void 0:pt.primaryColor)||"#007bff"},children:a.jsx(Xse,{size:20})}),l&&a.jsxs(Ge,{className:"fixed bottom-[96px] right-4 w-full max-w-md h-[70vh] max-h-[600px] shadow-xl z-[1000] flex flex-col bg-background border rounded-lg",children:[a.jsxs(rt,{className:"flex flex-row items-center justify-between p-3 border-b",children:[a.jsx(st,{className:"text-md font-semibold",children:"Gemini Assistant"}),a.jsxs("div",{className:"flex items-center gap-1",children:[(o==="admin"||i==="edit")&&a.jsx(V,{variant:"ghost",size:"icon",onClick:We,title:"Set Knowledge Base",children:a.jsx(lie,{size:18})}),a.jsx(V,{variant:"ghost",size:"icon",onClick:et,title:"Close Chat",children:a.jsx(zo,{size:18})})]})]}),u&&a.jsxs("div",{className:"p-3 border-b bg-muted/40",children:[a.jsx("label",{htmlFor:"knowledgeBaseInput",className:"text-xs font-medium mb-1 block text-muted-foreground",children:"Knowledge Base (Instructions for Gemini)"}),a.jsx(Ln,{id:"knowledgeBaseInput",placeholder:"Enter instructions for the assistant...",value:h,onChange:he=>f(he.target.value),className:"h-28 text-xs mb-2 rounded-md"}),a.jsx(V,{onClick:mt,size:"sm",className:"w-full",disabled:B||!S,children:"Save & Apply Instructions"})]}),a.jsxs(Ze,{className:"flex-grow p-3 overflow-y-auto space-y-3",children:[x.map(he=>(he.role==="user"||he.role==="assistant")&&a.jsx("div",{className:`flex flex-col ${he.role==="user"?"items-end":"items-start"}`,children:a.jsx("div",{className:`max-w-[80%] p-2.5 rounded-lg text-sm ${he.role==="user"?"bg-primary text-primary-foreground rounded-br-none":"bg-muted rounded-bl-none"}`,children:he.role==="assistant"?a.jsxs(a.Fragment,{children:[he.productCardData&&a.jsx(ZAe,{productData:he.productCardData,onViewDetails:de,onAddToCart:Ee,onBuyNow:Qe,onVisualize:he.productCardData.imageUrl&&typeof he.productCardData.imageUrl=="string"&&he.productCardData.imageUrl.trim()!==""?re:null}),he.imageDataUrl&&a.jsx("img",{src:he.imageDataUrl,alt:"Generated visualization",className:"max-w-full h-auto rounded-md my-2"}),he.text&&a.jsx("div",{className:`prose prose-sm max-w-none dark:prose-invert ${he.productCardData||he.imageDataUrl?"mt-2":""}`,children:a.jsx(KAe,{children:he.text})}),!he.productCardData&&!he.text&&!he.imageDataUrl&&a.jsx("p",{className:"whitespace-pre-wrap",children:"(Assistant message)"})]}):a.jsx("p",{className:"whitespace-pre-wrap",children:he.text})})},he.id)),a.jsx("div",{ref:D})]}),a.jsx(Lu,{className:"p-3 border-t",children:a.jsxs("div",{className:"flex w-full items-center gap-2",children:[a.jsx(V,{onClick:ut,size:"icon",variant:M?"destructive":"outline",title:M?"Stop Recording":"Start Recording",disabled:!v||B,className:"p-2",children:M?a.jsx(uie,{size:18}):a.jsx(Qse,{size:18})}),a.jsx(Ln,{placeholder:M?"Recording audio...":"Type a message or use microphone...",value:m,onChange:he=>g(he.target.value),onKeyPress:he=>{he.key==="Enter"&&!he.shiftKey&&(he.preventDefault(),Le())},className:"flex-grow resize-none text-sm p-2 rounded-md min-h-[40px] max-h-[100px]",rows:1,disabled:!v||B||M}),a.jsx(V,{onClick:()=>Le(),size:"icon",title:"Send Message",disabled:!m.trim()||!v||B||M,children:a.jsx(aie,{size:18})})]})})]})]})};function rRe({title:t,titleId:e,...n},r){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?p.createElement("title",{id:e},t):null,p.createElement("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"}))}const sRe=p.forwardRef(rRe),iRe=sRe;function oRe({title:t,titleId:e,...n},r){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?p.createElement("title",{id:e},t):null,p.createElement("path",{d:"M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z"}))}const aRe=p.forwardRef(oRe),lRe=aRe,Mn=({initialText:t,onSave:e,isAdmin:n,placeholder:r="Enter text...",as:s="span",className:i="",textClassName:o="",inputClassName:l="",useTextarea:c=!1})=>{const[u,d]=p.useState(!1),[h,f]=p.useState(t),m=p.useRef(null);p.useEffect(()=>{f(t)},[t]),p.useEffect(()=>{u&&m.current&&(m.current.focus(),m.current.select(),c&&(m.current.style.height="auto",m.current.style.height=`${m.current.scrollHeight}px`))},[u,c]);const g=()=>{e&&e(h),d(!1)},x=_=>{f(_.target.value),c&&m.current&&(m.current.style.height="auto",m.current.style.height=`${m.current.scrollHeight}px`)},E=_=>{_.key==="Enter"&&!c?g():_.key==="Escape"&&(f(t),d(!1))},v=s;return n?a.jsx(v,{className:`inline-text-edit-container relative group ${i} ${u?"w-full":""}`,children:u?a.jsxs("div",{className:"flex items-start space-x-1 w-full",children:[" ",c?a.jsx("textarea",{ref:m,value:h,onChange:x,onKeyDown:E,onBlur:g,className:`p-0 m-0 border-none focus:ring-0 focus:outline-none resize-none overflow-hidden bg-transparent text-inherit font-inherit w-full ${o} ${l}`,placeholder:r,rows:1}):a.jsx("input",{ref:m,type:"text",value:h,onChange:x,onKeyDown:E,onBlur:g,className:`p-0 m-0 border-none focus:ring-0 focus:outline-none bg-transparent text-inherit font-inherit w-full ${o} ${l}`,placeholder:r}),a.jsx("button",{onClick:g,className:"p-1 text-green-500 hover:text-green-700 flex-shrink-0",title:"Save",children:a.jsx(iRe,{className:"h-5 w-5"})})]}):a.jsxs("div",{className:`flex items-center space-x-1 cursor-pointer w-full ${o}`,onClick:()=>d(!0),role:"button",tabIndex:0,onKeyDown:_=>{_.key==="Enter"&&d(!0)},children:[a.jsx("span",{className:"flex-grow",children:h||r}),a.jsx(lRe,{className:"h-4 w-4 text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"})]})}):a.jsx(v,{className:o,children:h||r})},cRe=({store:t,isPublishedView:e=!1})=>{var h;const{updateStore:n}=$n(),r=(t==null?void 0:t.name)||"Our Store",s=t==null?void 0:t.id,i=!e,o={title:`The ${r} Way`,subtitle:"Discover the core values that make us unique.",items:[{emoji:"✨",icon:Xr,title:"Quality First",description:"We prioritize premium materials and craftsmanship in every product."},{emoji:"🌿",icon:qse,title:"Sustainable Practices",description:"Committed to eco-friendly sourcing and ethical production."},{emoji:"⚡️",icon:F$,title:"Innovative Design",description:"Blending timeless styles with modern, cutting-edge aesthetics."},{emoji:"💖",icon:A$,title:"Customer Love",description:"Our customers are at the heart of everything we do."}]},l=((h=t==null?void 0:t.content)==null?void 0:h.storeWay)||o,c=l.items&&l.items.length>0?l.items:o.items,u=async(f,m,g=null)=>{if(!s)return;let x={title:l.title,subtitle:l.subtitle,items:[...c].map(E=>({...E}))};g!==null&&x.items[g]?f==="itemTitle"?x.items[g].title=m:f==="itemDescription"?x.items[g].description=m:f==="itemEmoji"&&(x.items[g].emoji=m):f==="title"?x.title=m:f==="subtitle"&&(x.subtitle=m);try{await n(s,{content:{...t.content,storeWay:x}})}catch(E){console.error(`Failed to update store way content for ${f}:`,E)}},d=({item:f})=>{const m=f.icon||L$;return a.jsx(m,{className:"w-8 h-8 mb-4 text-[var(--theme-primary)]"})};return a.jsx("section",{className:"py-16 md:py-24 bg-background",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12 md:mb-16",children:[a.jsx("div",{className:"inline-flex items-center justify-center bg-[var(--theme-primary-10)] p-3 rounded-full mb-4",children:a.jsx(B1,{className:"h-8 w-8 text-[var(--theme-primary)]"})}),a.jsx(Mn,{initialText:l.title,onSave:f=>u("title",f),isAdmin:i,placeholder:"Section Title",as:"h2",textClassName:"text-4xl md:text-5xl font-bold tracking-tight text-foreground"}),a.jsx(Mn,{initialText:l.subtitle,onSave:f=>u("subtitle",f),isAdmin:i,placeholder:"Section Subtitle",as:"p",textClassName:"text-lg text-muted-foreground max-w-xl mx-auto mt-3"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:c.map((f,m)=>a.jsxs(Ct.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.4,delay:m*.1+.2},className:"bg-card p-6 rounded-xl shadow-lg text-center border border-border/50 hover:shadow-2xl transition-shadow",children:[a.jsxs("div",{className:"flex justify-center items-center mb-4",children:[i?a.jsx(Mn,{initialText:f.emoji,onSave:g=>u("itemEmoji",g,m),isAdmin:i,placeholder:"✨",textClassName:"text-4xl"}):a.jsx("span",{className:"text-4xl",children:f.emoji}),!f.emoji&&a.jsx(d,{item:f})]}),a.jsx("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:a.jsx(Mn,{initialText:f.title,onSave:g=>u("itemTitle",g,m),isAdmin:i,placeholder:"Item Title"})}),a.jsx("p",{className:"text-muted-foreground text-sm",children:a.jsx(Mn,{initialText:f.description,onSave:g=>u("itemDescription",g,m),isAdmin:i,placeholder:"Item Description",useTextarea:!0})})]},m))})]})})},CW="CEVWpXluVU77FgaVriTzqBCoN4FD3f0VL2Y8bXNPynNfqUg2DoUgPt8t",uRe="https://api.pexels.com/videos",dRe="https://api.pexels.com/v1";async function TW(t,e=9){if(!t||!t.trim())return{error:"Search query cannot be empty."};const n=`${uRe}/search?query=${encodeURIComponent(t)}&per_page=${e}`;try{const r=await fetch(n,{headers:{Authorization:CW}});if(!r.ok){const o=await r.json().catch(()=>({message:r.statusText}));return console.error("Pexels API error:",r.status,o),{error:`Pexels API error: ${o.message||r.statusText}`}}const s=await r.json();return{videos:s.videos.map(o=>{const l=o.video_files.find(c=>c.file_type==="video/mp4"&&(c.quality==="hd"||c.quality==="sd"))||o.video_files.find(c=>c.file_type==="video/mp4");return{id:o.id,width:o.width,height:o.height,duration:o.duration,imageUrl:o.image,videoUrl:l?l.link:o.video_files[0]?o.video_files[0].link:null,photographer:o.user.name,pexelsUrl:o.url}}).filter(o=>o.videoUrl),totalResults:s.total_results,page:s.page,perPage:s.per_page}}catch(r){return console.error("Error fetching from Pexels API:",r),{error:`Network error or other issue fetching Pexels videos: ${r.message}`}}}async function hRe(t,e=9){if(!t||!t.trim())return{error:"Search query cannot be empty."};const n=`${dRe}/search?query=${encodeURIComponent(t)}&per_page=${e}`;try{const r=await fetch(n,{headers:{Authorization:CW}});if(!r.ok){const o=await r.json().catch(()=>({message:r.statusText}));return console.error("Pexels API error:",r.status,o),{error:`Pexels API error: ${o.message||r.statusText}`}}const s=await r.json();return{photos:s.photos.map(o=>({id:o.id,width:o.width,height:o.height,src:o.src.medium,alt:o.alt,photographer:o.photographer,pexelsUrl:o.url})),totalResults:s.total_results,page:s.page,perPage:s.per_page}}catch(r){return console.error("Error fetching from Pexels API:",r),{error:`Network error or other issue fetching Pexels photos: ${r.message}`}}}const fRe=({open:t,onOpenChange:e,storeId:n,currentVideoUrl:r,onVideoReplaced:s})=>{const[i,o]=p.useState("ai"),[l,c]=p.useState(""),[u,d]=p.useState(!1),[h,f]=p.useState(null),[m,g]=p.useState(""),[x,E]=p.useState([]),[v,_]=p.useState(!1),[S,I]=p.useState(null),[M,j]=p.useState(null),[C,T]=p.useState(null),[P,A]=p.useState(!1);p.useEffect(()=>{t&&(c(""),d(!1),f(null),g(""),E([]),_(!1),I(null),j(null),T(null),A(!1))},[t]);const D=async()=>{if(!l.trim()){f("Please enter a prompt for the video.");return}d(!0),f(null);try{console.log(`Generating video for store ${n} with prompt: "${l}"`);const K=await Koe(l);s&&s(K),e(!1),c("")}catch(K){console.error("Error generating video with AI:",K),f(K.message||"Failed to generate video. Please try again.")}finally{d(!1)}},R=async()=>{if(!m.trim()){I("Please enter a search query for Pexels.");return}_(!0),I(null),E([]);try{const K=await TW(m);K.error?(I(K.error),E([])):(E(K.videos||[]),(K.videos||[]).length===0&&I("No videos found for your query."))}catch(K){console.error("Error searching Pexels videos:",K),I(K.message||"Failed to search Pexels. Please try again.")}finally{_(!1)}},k=K=>{s&&K?(s(K),e(!1)):I("Invalid video URL selected or replacement handler missing.")},U=K=>{const ee=K.target.files[0];if(ee){if(ee.size>50*1024*1024){T("File is too large. Please select a video under 50MB."),j(null);return}if(!ee.type.startsWith("video/")){T("Invalid file type. Please select a video file."),j(null);return}j(ee),T(null)}},B=()=>{if(M&&s){A(!0),T(null);const K=new FileReader;K.onloadend=()=>{s(K.result),e(!1),j(null),A(!1)},K.onerror=()=>{T("Failed to read video file for upload."),A(!1)},K.readAsDataURL(M)}else T("No video file selected or replacement handler missing.")};return a.jsx(ys,{open:t,onOpenChange:e,children:a.jsxs(es,{className:"sm:max-w-[672px]",children:[a.jsxs(ts,{className:"text-left",children:[a.jsx(ns,{children:"Replace Hero Video"}),a.jsxs(xo,{className:"text-left",children:["Current video: ",a.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline truncate block max-w-full",children:r||"No video set"})]})]}),a.jsxs(Ei,{value:i,onValueChange:o,className:"w-full",children:[a.jsxs(Qs,{className:"grid w-full grid-cols-3",children:[" ",a.jsx(Bt,{value:"ai",children:"AI Generation (Veo)"}),a.jsx(Bt,{value:"pexels",children:"Search Pexels"}),a.jsx(Bt,{value:"upload",children:"Upload Video"})," "]}),a.jsxs(zt,{value:"ai",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"aiPrompt",className:"text-left block mb-1",children:"AI Video Prompt"}),a.jsx(nt,{id:"aiPrompt",value:l,onChange:K=>c(K.target.value),placeholder:"e.g., A futuristic cityscape at sunset",disabled:u})]}),h&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:h}),a.jsxs(Tr,{className:"justify-start pt-4",children:[a.jsx(V,{variant:"outline",onClick:()=>e(!1),disabled:u,children:"Cancel"}),a.jsx(V,{onClick:D,disabled:u||!l.trim(),children:u?"Generating...":"Generate Video"})]})]}),a.jsxs(zt,{value:"pexels",className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(nt,{id:"pexelsQuery",value:m,onChange:K=>g(K.target.value),placeholder:"e.g., Nature, Business, Technology",disabled:v,className:"flex-grow"}),a.jsx(V,{onClick:R,disabled:v||!m.trim(),children:v?"Searching...":"Search"})]}),S&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:S}),v&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Loading Pexels videos..."}),!v&&x.length>0&&a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 max-h-[300px] overflow-y-auto pr-2",children:x.map(K=>a.jsxs("div",{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border hover:border-primary",onClick:()=>k(K.videoUrl),children:[a.jsx("img",{src:K.imageUrl,alt:`Pexels video by ${K.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),a.jsx("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:a.jsx("p",{className:"text-white text-xs text-center p-1 bg-black/50 rounded",children:"Use Video"})})]},K.id))}),a.jsx(Tr,{className:"justify-start pt-4",children:a.jsx(V,{variant:"outline",onClick:()=>e(!1),disabled:v,children:"Cancel"})})]}),a.jsxs(zt,{value:"upload",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"video-upload-input",className:"text-left block mb-1",children:"Select Video File"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(nt,{id:"video-upload-input",type:"file",accept:"video/*",onChange:U,className:"flex-grow",disabled:P})}),M&&a.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected: ",M.name," (",(M.size/1024/1024).toFixed(2)," MB)"]}),C&&a.jsx("p",{className:"text-sm text-red-500 text-center mt-2",children:C})]}),a.jsxs(Tr,{className:"justify-start pt-4",children:[a.jsx(V,{variant:"outline",onClick:()=>e(!1),disabled:P,children:"Cancel"}),a.jsx(V,{onClick:B,disabled:P||!M,children:P?"Uploading...":"Confirm Upload"})]})]})]})]})})},mRe=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),pRe=({isOpen:t,onOpenChange:e,currentImageUrl:n,onImageSelected:r,imageSearchContext:s="image",modalTitle:i="Change Image",storeName:o="your store"})=>{const{toast:l}=Ls(),[c,u]=p.useState("search"),[d,h]=p.useState(s),[f,m]=p.useState([]),[g,x]=p.useState(!1),[E,v]=p.useState(`A visually appealing ${s} for ${o}`),_=async()=>{if(d.trim()){x(!0),m([]);try{const j=await wa(d,9,"landscape");m(j.map(C=>({id:C.id.toString(),src:{medium:C.src.large,large:C.src.large},alt:C.alt||d,photographer:C.photographer})))}catch(j){l({title:"Pexels Search Failed",description:j.message,variant:"destructive"})}x(!1)}},S=async()=>{if(E.trim()){x(!0),m([]);try{const j=await j1(E);if(j&&j.url)m([{id:en(),src:{medium:j.url,large:j.url},alt:j.alt||E,photographer:"Generated by AI"}]),l({title:"AI Image Generated",description:"Select the image below or generate more."});else throw new Error("AI did not return an image URL.")}catch(j){l({title:"AI Image Generation Failed",description:j.message,variant:"destructive"})}x(!1)}},I=async j=>{const C=j.target.files[0];if(C){x(!0);try{const T=await mRe(C);r(T),l({title:"Image Uploaded",description:"Your image has been selected."}),e(!1)}catch{l({title:"Upload Failed",description:"Could not process the uploaded file.",variant:"destructive"})}x(!1)}},M=j=>{r(j),e(!1)};return p.useEffect(()=>{t&&(h(s||"abstract background"),v(`A visually appealing ${s||"image"} for ${o||"a store"}`),m([]),u("search"))},[t,s,o]),a.jsx(ys,{open:t,onOpenChange:e,children:a.jsxs(es,{className:"sm:max-w-2xl md:max-w-3xl lg:max-w-4xl",children:[a.jsx(ts,{children:a.jsx(ns,{children:i})}),a.jsxs("div",{className:"py-4",children:[a.jsxs(Ei,{value:c,onValueChange:u,className:"w-full",children:[a.jsxs(Qs,{className:"grid w-full grid-cols-3",children:[a.jsx(Bt,{value:"search",children:"Search Pexels"}),a.jsx(Bt,{value:"ai",children:"Generate with AI"}),a.jsx(Bt,{value:"upload",children:"Upload"})]}),a.jsx(zt,{value:"search",className:"mt-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(nt,{placeholder:"Search for images on Pexels...",value:d,onChange:j=>h(j.target.value),onKeyPress:j=>j.key==="Enter"&&_()}),a.jsxs(V,{onClick:_,disabled:g||!d.trim(),children:[g?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(Jd,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Search"})]})]})}),a.jsx(zt,{value:"ai",className:"mt-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(nt,{placeholder:"Describe the image you want AI to generate...",value:E,onChange:j=>v(j.target.value),onKeyPress:j=>j.key==="Enter"&&S()}),a.jsxs(V,{onClick:S,disabled:g||!E.trim(),children:[g?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(_a,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Generate"})]})]})}),a.jsxs(zt,{value:"upload",className:"mt-4",children:[a.jsx(Re,{htmlFor:"image-upload-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Upload your own image:"}),a.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-md",children:a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsx(Fo,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsxs("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:[a.jsxs("label",{htmlFor:"image-upload-input-file",className:"relative cursor-pointer bg-white dark:bg-gray-800 rounded-md font-medium text-primary hover:text-primary-focus focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary-ring",children:[a.jsx("span",{children:"Upload a file"}),a.jsx(nt,{id:"image-upload-input-file",name:"image-upload-input-file",type:"file",className:"sr-only",accept:"image/*",onChange:I})]}),a.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF up to 10MB"})]})})]})]}),g&&f.length===0&&a.jsxs("div",{className:"text-center py-10",children:[a.jsx(St,{className:"h-8 w-8 animate-spin mx-auto text-primary"}),a.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Fetching images..."})]}),f.length>0&&a.jsx(ScrollArea,{className:"mt-4 max-h-[50vh]",children:a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 p-1",children:f.map(j=>a.jsxs(Ct.div,{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border-2 border-transparent hover:border-primary transition-all",onClick:()=>M(j.src.large||j.src.medium),whileHover:{scale:1.03},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[a.jsx("img",{src:j.src.medium,alt:j.alt||"Search result",className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(gRe,{className:"h-10 w-10 text-white"})}),a.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] p-1 truncate text-center",children:j.photographer||j.alt||"Untitled"})]},j.id))})})]}),a.jsx(Tr,{children:a.jsx(ba,{asChild:!0,children:a.jsx(V,{type:"button",variant:"outline",children:"Cancel"})})})]})})},gRe=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),yRe=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");e({base64ImageData:i,mimeType:o[1]})}catch(r){n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o=s.toDataURL("image/png"),l="image/png";(!o||o.length<100)&&(o=s.toDataURL("image/jpeg"),l="image/jpeg");const c=o.split(",");e({base64ImageData:c[1],mimeType:l})}catch(o){n(new Error("Canvas toDataURL failed: "+o.message))}},r.onerror=()=>n(new Error("Failed to load image from URL for conversion.")),r.src=t}}),xRe=({isOpen:t,onOpenChange:e,currentImageUrl:n,onImageEdited:r,imageContext:s="image",modalTitle:i="Edit Image with AI"})=>{const{toast:o}=Ls(),[l,c]=p.useState(""),[u,d]=p.useState(!1),[h,f]=p.useState("");p.useEffect(()=>{t&&n&&(f(n),c(""))},[t,n]);const m=async()=>{if(!l.trim()||!h){o({title:"Missing data",description:"Image or edit prompt is missing.",variant:"destructive"});return}d(!0);try{const{base64ImageData:g,mimeType:x}=await yRe(h),E=await $l(g,x,l);if(E&&E.editedImageData&&E.newMimeType){const v=`data:${E.newMimeType};base64,${E.editedImageData}`;r(v),o({title:"Image Edited",description:"Image updated with AI edit."}),e(!1)}else throw new Error((E==null?void 0:E.textResponse)||"AI did not return an edited image.")}catch(g){console.error("Error editing image:",g),o({title:"Image Edit Failed",description:g.message,variant:"destructive"})}d(!1)};return a.jsx(ys,{open:t,onOpenChange:e,children:a.jsxs(es,{className:"sm:max-w-md",children:[a.jsx(ts,{children:a.jsx(ns,{children:i})}),a.jsxs("div",{className:"space-y-4 py-4",children:[h&&a.jsxs("div",{className:"flex flex-col items-center space-y-2 mb-4",children:[a.jsx("img",{src:h,alt:`Current ${s} to edit`,className:"max-h-48 w-auto object-contain rounded border"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Editing: Current ",s]})]}),a.jsx(Re,{htmlFor:"editPrompt",className:"text-left",children:"Edit Instruction:"}),a.jsx(Ln,{id:"editPrompt",placeholder:`e.g., 'make the background blue', 'add sparkles to the ${s}'`,value:l,onChange:g=>c(g.target.value),rows:3,className:"resize-none"})]}),a.jsxs(Tr,{children:[a.jsx(ba,{asChild:!0,children:a.jsx(V,{type:"button",variant:"outline",disabled:u,children:"Cancel"})}),a.jsxs(V,{onClick:m,disabled:u||!l.trim(),children:[u?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(_a,{className:"mr-2 h-4 w-4"}),"Apply Edit"]})]})]})})},IW=({store:t,isPublishedView:e=!1})=>{var F,ye,Se,De,xe,Me,Ye,qe,et,We,mt;const{updateStore:n,updateStoreTextContent:r}=$n(),[s,i]=p.useState(0),[o,l]=p.useState(null),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(!1),[g,x]=p.useState(!1),[E,v]=p.useState(null),_=p.useRef(null),S={Shield:cie,Truck:Sv,CreditCard:ki,Headphones:Ij,Star:M$,Zap:F$,GlobeIcon:Jc,AwardIcon:Dse,UsersIcon:r0,HeartIcon:A$,CheckCircle:uo,Sparkles:Xr,ArrowRight:cp,Play:j$,Pause:tie,Package:ui},I=$de(_,{once:!0,margin:"-100px"}),{scrollYProgress:M}=Fde({target:_,offset:["start end","end start"]}),j=Ob(M,[0,1],[100,-100]),C=Ob(M,[0,.2,.8,1],[0,1,1,0]),T=Ob(M,[0,.2,.8,1],[.8,1,1,.8]),P=((F=t==null?void 0:t.theme)==null?void 0:F.primaryColor)||"#6366F1",A=t==null?void 0:t.id,D=!e,R={title:"An Exceptional Experience",subtitle:"We're committed to providing you with the best shopping experience through our premium services and customer-first approach.",items:[{emoji:"",iconName:"Zap",title:"Smart Solutions",description:"Innovative products designed for modern living and efficiency.",color:"#007AFF",stats:"Future Ready",image:"https://images.pexels.com/photos/373543/pexels-photo-373543.jpeg?auto=compress&cs=tinysrgb&w=600&q=80",videoUrl:""},{emoji:"🚚",icon:Sv,title:"Fast Delivery",description:"Free shipping worldwide with express delivery options available.",color:"#3B82F6",stats:"2-3 Days",image:"https://images.unsplash.com/photo-1566576912321-d58ddd7a6088?w=600&q=80"},{emoji:"💳",icon:ki,title:"Easy Returns",description:"30-day hassle-free returns with full refund guarantee.",color:"#8B5CF6",stats:"30 Days",image:"https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=600&q=80"},{emoji:"🎧",icon:Ij,title:"24/7 Support",description:"Round-the-clock customer support via chat, email, and phone.",color:"#F59E0B",stats:"Always On",image:"https://images.unsplash.com/photo-1553484771-371a605b060b?w=600&q=80"}],secondaryItems:[{iconName:"GlobeIcon",title:"Global Reach",description:"Serving customers in 50+ countries"},{iconName:"AwardIcon",title:"Premium Quality",description:"Certified products with quality guarantee"},{iconName:"UsersIcon",title:"Community Driven",description:"Join 100K+ satisfied customers"},{iconName:"HeartIcon",title:"Eco-Conscious",description:"Sustainable packaging and practices"}],statsItems:[{iconName:"UsersIcon",number:"50K+",label:"Happy Customers"},{iconName:"ZapIcon",number:"99.9%",label:"Uptime"},{iconName:"HeadphonesIcon",number:"24/7",label:"Support"},{iconName:"StarIcon",number:"4.9★",label:"Rating"}]},k=(ye=t==null?void 0:t.content)!=null&&ye.storeFeatures?{...R,...t.content.storeFeatures,items:t.content.storeFeatures.items&&t.content.storeFeatures.items.length>0?t.content.storeFeatures.items:R.items,secondaryItems:t.content.storeFeatures.secondaryItems&&t.content.storeFeatures.secondaryItems.length>0?t.content.storeFeatures.secondaryItems:R.secondaryItems,statsItems:t.content.storeFeatures.statsItems&&t.content.storeFeatures.statsItems.length>0?t.content.storeFeatures.statsItems:R.statsItems}:R,U=k.items&&k.items.length>0?k.items:R.items;p.useEffect(()=>{const Le=async()=>{const ve=U[s];if(ve&&!ve.videoUrl){const Je=ve.title||ve.description||"modern abstract motion";try{console.log(`[Modern StoreFeatures] Fetching Pexels video for active feature "${Je}"`);const Xe=await TW(Je,1);Xe&&Xe.videos&&Xe.videos.length>0?(l(Xe.videos[0].videoUrl),u(Xe.videos[0].imageUrl)):(console.warn(`No Pexels video found for query: "${Je}". Clearing previous Pexels video.`),l(null),u(null))}catch(Xe){console.error(`Failed to fetch Pexels video for query "${Je}":`,Xe),l(null),u(null)}}else ve&&ve.videoUrl&&(l(null),u(null))};U&&U.length>0&&s<U.length&&Le()},[s,U]);const B=async(Le,ve)=>{!A||!D||console.log(`[ModernStoreFeatures] handleSaveText called with field: ${Le}, value: ${ve}. This might be redundant if InlineTextEdit is used.`)},K=Le=>{v(Le),m(!0)},ee=async Le=>{if(A==null||E==null||!Le)return;const ve=JSON.parse(JSON.stringify(k));if(ve.items&&ve.items[E])ve.items[E].image=Le,ve.items[E].videoUrl="";else{console.error("Cannot update feature image: active feature item not found."),m(!1);return}try{await n(A,{content:{...t.content,storeFeatures:ve}})}catch(Je){console.error("Failed to update store with new feature image URL:",Je)}m(!1),v(null)},H=()=>h(!0),X=async Le=>{if(!A||!D||s===null||!U[s])return;const ve=JSON.parse(JSON.stringify(k));if(ve.items&&ve.items[s])ve.items[s].videoUrl=Le,ve.items[s].image="",l(null),u(null);else{console.error("Cannot update video URL: active feature item not found."),h(!1);return}try{await n(A,{content:{...t.content,storeFeatures:ve}})}catch(Je){console.error("Failed to update store with new feature video URL:",Je)}h(!1)},O={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},z={hidden:{opacity:0,y:30},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.25,.46,.45,.94]}}},Y={hidden:{opacity:0,x:-50},visible:{opacity:1,x:0,transition:{duration:.8,ease:[.25,.46,.45,.94]}}};return a.jsxs("section",{ref:_,className:"relative py-20 gradient-bg overflow-hidden",id:`features-${A}`,children:[a.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[a.jsx(Ct.div,{className:"absolute top-20 left-20 w-96 h-96 bg-primary/5 blur-3xl rounded-full",style:{backgroundColor:`${P}10`,y:j}}),a.jsx(Ct.div,{className:"absolute bottom-20 right-20 w-80 h-80 bg-secondary/5 blur-3xl rounded-full",style:{y:j}}),a.jsx(Ct.div,{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-accent/5 blur-3xl rounded-full",animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},transition:{duration:8,repeat:1/0}})]}),a.jsxs(Ct.div,{className:"container mx-auto px-6 relative z-10",style:{opacity:C,scale:T},children:[a.jsxs(Ct.div,{variants:O,initial:"hidden",animate:I?"visible":"hidden",className:"text-center mb-20",children:[a.jsxs(Ct.div,{variants:z,className:"inline-flex items-center gap-2 px-4 py-2 bg-white/10 dark:bg-black/10 backdrop-blur-md border border-white/20 dark:border-white/10 rounded-full text-sm font-medium mb-6",style:{color:P,borderColor:`${P}30`},children:[a.jsx(Xr,{className:"w-4 h-4"}),a.jsx("span",{children:"Why Choose Us"})]}),a.jsx(Ct.h2,{variants:z,className:"text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 dark:text-white mb-6 tracking-tight",children:a.jsx(Mn,{initialText:k.title,onSave:Le=>B("title",Le),isAdmin:D,placeholder:"Section Title",as:"span",textClassName:"bg-gradient-to-r from-gray-900 via-primary to-gray-900 dark:from-white dark:via-primary dark:to-white bg-clip-text text-transparent",style:{backgroundImage:`linear-gradient(90deg, currentColor, ${P}, currentColor)`}})}),a.jsx(Ct.p,{variants:z,className:"text-xl text-muted-foreground max-w-3xl mx-auto leading-relaxed",children:a.jsx(Mn,{initialText:k.subtitle,onSave:Le=>B("subtitle",Le),isAdmin:D,placeholder:"Section Subtitle",as:"span"})})]}),a.jsxs(Ct.div,{variants:O,initial:"hidden",animate:I?"visible":"hidden",className:"grid lg:grid-cols-2 gap-16 mb-20",children:[a.jsx(Ct.div,{variants:Y,className:"space-y-6",children:U.map((Le,ve)=>{const Je=Le.icon||ui,Xe=s===ve;return a.jsx(Ct.div,{className:`p-6 rounded-3xl border transition-all duration-500 cursor-pointer ${Xe?"bg-white/20 dark:bg-black/20 border-white/30 dark:border-white/20 shadow-float-lg":"bg-white/10 dark:bg-black/10 border-white/20 dark:border-white/10 hover:bg-white/15 dark:hover:bg-black/15"}`,onClick:()=>i(ve),whileHover:{scale:1.02,y:-5},whileTap:{scale:.98},initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{delay:ve*.1},children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center shadow-lg text-3xl",style:{backgroundColor:Le.color||P+"30"},children:Le.emoji||a.jsx(Je,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a.jsx(Mn,{initialText:Le.title,onSave:kt=>B("itemTitle",kt),isAdmin:D,placeholder:"Feature Title"})}),Le.stats&&a.jsx(Fp,{variant:"secondary",className:"text-xs font-medium",style:{backgroundColor:`${Le.color||P}20`,color:Le.color||P},children:Le.stats})]}),a.jsx("p",{className:"text-muted-foreground leading-relaxed",children:a.jsx(Mn,{initialText:Le.description,onSave:kt=>B("itemDescription",kt),isAdmin:D,placeholder:"Feature Description",useTextarea:!0})}),Xe&&a.jsx(Ct.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t border-white/20 dark:border-white/10",children:a.jsxs(V,{variant:"outline",size:"sm",className:"group",style:{borderColor:Le.color||P,color:Le.color||P},children:["Learn More",a.jsx(cp,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})})]})]})},Le.title+ve)})}),U[s]&&a.jsxs(Ct.div,{variants:z,className:"relative aspect-square lg:aspect-[4/3] rounded-3xl overflow-hidden shadow-float-lg group",children:[!e&&U[s]&&a.jsx("div",{className:"absolute top-3 left-3 z-20 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(Se=U[s])!=null&&Se.videoUrl||o?a.jsxs(V,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:H,title:"Replace Feature Video",children:[a.jsx(Aj,{className:"h-4 w-4 mr-1"})," Replace Video"]}):a.jsxs(a.Fragment,{children:[a.jsxs(V,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:()=>K(s),title:"Change Feature Image",children:[a.jsx(Aj,{className:"h-4 w-4 mr-1"})," Change Image"]}),a.jsxs(V,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:()=>{v(s),x(!0)},title:"Edit Feature Image with AI",children:[a.jsx(_a,{className:"h-4 w-4 mr-1"})," Edit with AI"]})]})}),(De=U[s])!=null&&De.videoUrl?a.jsx("video",{src:U[s].videoUrl,poster:U[s].image||c||"",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"},`feat-video-${s}`):o?a.jsx("video",{src:o,poster:c||((xe=U[s])==null?void 0:xe.image)||"",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"},`current-pexels-video-${s}`):(Me=U[s])!=null&&Me.image?a.jsx(Ct.img,{src:U[s].image,alt:U[s].title||"Modern feature image",className:"absolute inset-0 w-full h-full object-cover",initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},transition:{duration:.8}},`feat-img-${s}`):a.jsx(Ct.img,{src:"https://images.pexels.com/photos/1571460/pexels-photo-1571460.jpeg?auto=compress&cs=tinysrgb&w=600",alt:"Default modern feature background",className:"absolute inset-0 w-full h-full object-cover",initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},transition:{duration:.8}},`fallback-img-${s}`),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent"}),a.jsx(Ct.div,{className:"absolute bottom-6 left-6 right-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:a.jsxs("div",{className:"bg-white/10 dark:bg-black/10 backdrop-blur-md border border-white/20 dark:border-white/10 rounded-2xl p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl",style:{backgroundColor:U[s].color||P+"30"},children:U[s].emoji||ct.createElement(U[s].icon||ui,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-bold text-white",children:U[s].title}),U[s].stats&&a.jsx("p",{className:"text-sm text-gray-200",children:U[s].stats})]})]}),a.jsx("p",{className:"text-gray-200 text-sm leading-relaxed",children:U[s].description})]})},`overlay-${s}`),a.jsx(Ct.div,{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/20 dark:bg-black/20 backdrop-blur-md rounded-2xl flex items-center justify-center border border-white/30 dark:border-white/20 z-10",animate:{y:[-8,8,-8],rotate:[0,10,0]},transition:{duration:6,repeat:1/0},children:a.jsx(uo,{className:"w-12 h-12 text-green-400"})})]})]}),a.jsx(Ct.div,{variants:O,initial:"hidden",animate:I?"visible":"hidden",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16",children:(k.secondaryItems||[]).map((Le,ve)=>{const Je=S[Le.iconName]||ui;return a.jsxs(Ct.div,{variants:z,className:"text-center p-6 bg-white/10 dark:bg-black/10 backdrop-blur-md rounded-3xl border border-white/20 dark:border-white/10 hover:bg-white/15 dark:hover:bg-black/15 transition-all duration-300",whileHover:{scale:1.05,y:-5},children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center shadow-lg",style:{backgroundColor:P},children:a.jsx(Je,{className:"w-8 h-8 text-white"})}),a.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:a.jsx(Mn,{initialText:Le.title,onSave:Xe=>B(`secondaryItemTitle.${ve}`,Xe),isAdmin:D,placeholder:"Feature Title"})}),a.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:a.jsx(Mn,{initialText:Le.description,onSave:Xe=>B(`secondaryItemDescription.${ve}`,Xe),isAdmin:D,placeholder:"Feature Description",useTextarea:!0})})]},Le.title+ve)})}),a.jsx(Ct.div,{variants:O,initial:"hidden",animate:I?"visible":"hidden",className:"grid grid-cols-2 md:grid-cols-4 gap-8 p-8 bg-white/10 dark:bg-black/10 backdrop-blur-md rounded-3xl border border-white/20 dark:border-white/10",children:(k.statsItems||[]).map((Le,ve)=>{const Je=S[Le.iconName]||ui;return a.jsxs(Ct.div,{variants:z,className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-xl flex items-center justify-center",style:{backgroundColor:`${P}20`},children:a.jsx(Je,{className:"w-6 h-6",style:{color:P}})}),a.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-1",children:a.jsx(Mn,{initialText:Le.number,onSave:Xe=>B("statsItemNumber",Xe),isAdmin:D,placeholder:"Stat Number"})}),a.jsx("div",{className:"text-sm text-muted-foreground",children:a.jsx(Mn,{initialText:Le.label,onSave:Xe=>B("statsItemLabel",Xe),isAdmin:D,placeholder:"Stat Label"})})]},Le.label+ve)})})]}),!e&&A&&a.jsx(fRe,{open:d,onOpenChange:h,storeId:A,currentVideoUrl:((Ye=U[s])==null?void 0:Ye.videoUrl)||o,onVideoReplaced:X}),!e&&A&&E!==null&&U[E]&&a.jsx(pRe,{isOpen:f,onOpenChange:m,currentImageUrl:(qe=U[E])==null?void 0:qe.image,onImageSelected:Le=>ee(Le),imageSearchContext:`feature image for ${((et=U[E])==null?void 0:et.title)||"section"}`,modalTitle:"Change Feature Image",storeName:t.name}),!e&&A&&E!==null&&U[E]&&a.jsx(xRe,{isOpen:g,onOpenChange:x,currentImageUrl:(We=U[E])==null?void 0:We.image,onImageEdited:Le=>ee(Le),imageContext:`feature image for "${((mt=U[E])==null?void 0:mt.title)||"section"}"`,modalTitle:"Edit Feature Image with AI"})]})},vRe=Object.freeze(Object.defineProperty({__proto__:null,default:IW},Symbol.toStringTag,{value:"Module"})),wRe=()=>{var bs,vr;console.log("[StorePreview] Component mounted.");const{storeName:t,productHandle:e}=Ww();console.log("[StorePreview] storeName from params:",t);const{getStoreByName:n,getStoreById:r,currentStore:s,setCurrentStore:i,updateStore:o,viewMode:l,isLoadingStores:c,user:u}=$n(),{toast:d}=Ls(),[h,f]=p.useState(null),[m,g]=p.useState(null),[x,E]=p.useState(null),[v,_]=p.useState(null),[S,I]=p.useState(null),[M,j]=p.useState(null),[C,T]=p.useState(null),[P,A]=p.useState(null),[D,R]=p.useState(null),[k,U]=p.useState(null),[B,K]=p.useState(null),[ee,H]=p.useState(null),[X,O]=p.useState(null),[z,Y]=p.useState(null),[F,ye]=p.useState(null),[Se,De]=p.useState(null),[xe,Me]=p.useState(null),[Ye,qe]=p.useState(null),[et,We]=p.useState(null),[mt,Le]=p.useState(null),[ve,Je]=p.useState(null),[Xe,kt]=p.useState(null),[Gt,fn]=p.useState(null),[sn,ae]=p.useState(null),[me,fe]=p.useState(null),[Ne,ne]=p.useState(null),[de,Ee]=p.useState(null),[Qe,re]=p.useState(null),[Ve,Te]=p.useState(null),[ut,pt]=p.useState(null),[he,be]=p.useState(null),[Fe,Pe]=p.useState(null),[Yt,Ht]=p.useState(null),[Tt,yt]=p.useState(null),[Ft,Sn]=p.useState(null),[mn,xr]=p.useState(null),[Un,Xt]=p.useState(null),[nn,Bn]=p.useState(null),[q,te]=p.useState(null),[le,Ie]=p.useState(null),[Oe,ht]=p.useState(null),[dt,W]=p.useState(null),[J,se]=p.useState(null),[G,oe]=p.useState(null),[we,ke]=p.useState(null),[Ue,_e]=p.useState(null),[Q,Z]=p.useState(null),[ue,ge]=p.useState(null),[Ae,je]=p.useState(null),[it,ot]=p.useState(null),[Nt,Qt]=p.useState(!1),[vt,on]=p.useState(""),[Nr,Pt]=p.useState(!1),[an,lr]=p.useState(!1);p.useEffect(()=>{console.log("[StorePreview] Sync effect triggered. isLoadingStores:",c,"storeName (slug from URL):",t,"contextCurrentStore ID:",s==null?void 0:s.id,"contextCurrentStore slug:",s==null?void 0:s.urlSlug);let At=null;if(s&&t&&s.urlSlug===t)At=s,console.log("[StorePreview] Using contextCurrentStore for local preview state (slug match). ID:",At.id);else if(t&&!c){const _t=n(t);if(_t)At=_t,console.log("[StorePreview] Fetched store by name (slug) for local preview state:",_t.name,"ID:",_t.id),(!s||s.id!==_t.id)&&(i(_t),console.log("[StorePreview] Updated global currentStore with fetched data (found by slug in stores list)."));else{console.log("[StorePreview] Store not found by getStoreByName for slug:",t,"and contextCurrentStore didn't match."),c||d({title:"Store Not Found",description:`Could not find store with slug: ${t}`,variant:"destructive"}),f(null),g(null),Pt(!1);return}}else{console.log("[StorePreview] Waiting for stores to load, or no storeName in URL, or contextCurrentStore does not match."),!c&&!t&&(f(null),g(null),Pt(!1));return}if(At){let _t=At.template_version||"v1";_t==="v1"&&(_t="classic"),console.log(`[StorePreview] Setting local store state for preview. DB Template: ${At.template_version}, UI Template: ${_t}, Store ID: ${At.id}`);const ln=At.template_version==="v1"||!At.template_version?"classic":At.template_version;f(At),(m===null||h&&h.id!==At.id)&&(console.log(`[StorePreview] Sync effect: Initializing/Resetting previewTemplateVersion to DB version: ${ln}`),g(ln)),(m===null||h&&h.id!==At.id||h&&h.id===At.id&&h.template_version!==At.template_version)&&(console.log(`[StorePreview] Sync effect: Initializing/Resetting previewTemplateVersion to DB version: ${ln} for store ${At.id}`),g(ln)),!At.pass_key||u&&At.merchant_id===u.id?(Pt(!0),console.log("[StorePreview] Authenticated (no passkey or user is owner).")):(Pt(!1),console.log("[StorePreview] Not authenticated (passkey required)."))}else console.log("[StorePreview] No sourceStoreData available after checks, clearing local store."),f(null),g(null),Pt(!1),!c&&t&&d({title:"Store Not Found",description:`Could not find store with slug: ${t}`,variant:"destructive"})},[t,n,i,d,c,u,s]),p.useEffect(()=>{const At=m||(h==null?void 0:h.template_version),_t=document.documentElement;h&&h.theme?(h.theme.primaryColor?_t.style.setProperty("--theme-primary-color",h.theme.primaryColor):_t.style.removeProperty("--theme-primary-color"),h.theme.secondaryColor?_t.style.setProperty("--theme-secondary-color",h.theme.secondaryColor):_t.style.removeProperty("--theme-secondary-color"),At==="premium"?(_t.style.setProperty("--premium-gradient-start-color",h.theme.primaryColor||"#667eea"),_t.style.setProperty("--premium-gradient-end-color",h.theme.secondaryColor||"#764ba2")):(_t.style.removeProperty("--premium-gradient-start-color"),_t.style.removeProperty("--premium-gradient-end-color"))):(_t.style.removeProperty("--theme-primary-color"),_t.style.removeProperty("--theme-secondary-color"),_t.style.removeProperty("--premium-gradient-start-color"),_t.style.removeProperty("--premium-gradient-end-color"));let ln=!1;return At==="sharp"&&(_t.classList.contains("dark")||(_t.classList.add("dark"),ln=!0)),()=>{ln&&At!=="sharp"&&_t.classList.contains("dark")}},[h==null?void 0:h.theme,h==null?void 0:h.template_version,m]),p.useEffect(()=>{if(h&&m){const At=m;console.log(`[StorePreview] Loading components for template: ${At}`),se(null),oe(null),ke(null),_e(null),Z(null),ge(null),je(null),ot(null),E(null),_(null),I(null),j(null),T(null),A(null),R(null),U(null),K(null),H(null),O(null),Y(null),ye(null),De(null),Me(null),qe(null),We(null),Le(null),Je(null),kt(null),fn(null),ae(null),fe(null),ne(null),Ee(null),re(null),Te(null),pt(null),be(null),Pe(null),Ht(null),yt(null),Sn(null),xr(null),Xt(null),Bn(null),te(null),Ie(null),ht(null),W(null),ht(()=>cRe),W(()=>IW),At==="classic"?(se(()=>p.lazy(()=>jt(()=>Promise.resolve().then(()=>bRe),void 0))),oe(()=>p.lazy(()=>jt(()=>import("./StoreHero-01f0ac35.js"),[]))),ke(()=>p.lazy(()=>jt(()=>import("./StoreCollections-2efdc88c.js"),["assets/StoreCollections-2efdc88c.js","assets/CollectionProductsDialog-f7d6d2e4.js"]))),_e(()=>p.lazy(()=>jt(()=>import("./ProductGrid-4bd5fd8b.js"),["assets/ProductGrid-4bd5fd8b.js","assets/ProductEditModal-3669a150.js","assets/filter-7f3c97a9.js"]))),Z(()=>p.lazy(()=>jt(()=>import("./StoreFeatures-621156f2.js"),["assets/StoreFeatures-621156f2.js","assets/shield-check-307127cf.js","assets/message-square-3c6f6c13.js"]))),ge(()=>p.lazy(()=>jt(()=>import("./StoreTestimonials-ed599837.js"),["assets/StoreTestimonials-ed599837.js","assets/user-circle-e5dfa8b1.js"]))),je(()=>p.lazy(()=>jt(()=>import("./StoreNewsletter-ff4c4042.js"),[]))),ot(()=>p.lazy(()=>jt(()=>Promise.resolve().then(()=>SRe),void 0)))):At==="modern"?(E(()=>p.lazy(()=>jt(()=>import("./StoreHeader-0486d362.js"),[]))),_(()=>p.lazy(()=>jt(()=>import("./StoreHero-c8bf5b05.js"),[]))),I(()=>p.lazy(()=>jt(()=>Promise.resolve().then(()=>vRe),void 0))),j(()=>p.lazy(()=>jt(()=>import("./StoreCollections-f32b7be8.js"),[]))),T(()=>p.lazy(()=>jt(()=>import("./ProductGrid-c508aff7.js"),["assets/ProductGrid-c508aff7.js","assets/ProductEditModal-3669a150.js","assets/minus-b98e8aea.js"]))),A(()=>p.lazy(()=>jt(()=>import("./Footer-3cc12a7e.js"),[])))):At==="premium"?(R(()=>p.lazy(()=>jt(()=>import("./Header-32141589.js"),[]))),U(()=>p.lazy(()=>jt(()=>import("./Hero-2836bcb2.js"),[]))),K(()=>p.lazy(()=>jt(()=>import("./FeaturedProducts-631bbce3.js"),["assets/FeaturedProducts-631bbce3.js","assets/ProductEditModal-3669a150.js","assets/minus-b98e8aea.js","assets/filter-7f3c97a9.js"]))),H(()=>p.lazy(()=>jt(()=>import("./CategoryShowcase-9563905a.js"),["assets/CategoryShowcase-9563905a.js","assets/CollectionProductsDialog-f7d6d2e4.js"]))),O(()=>p.lazy(()=>jt(()=>import("./SocialProof-26e0db0d.js"),[]))),Y(()=>p.lazy(()=>jt(()=>import("./Newsletter-47968e27.js"),[]))),ye(()=>p.lazy(()=>jt(()=>import("./Footer-5229d852.js"),[])))):At==="sharp"?(De(()=>p.lazy(()=>jt(()=>import("./StoreHeader-de49ea5d.js"),[]))),Me(()=>p.lazy(()=>jt(()=>import("./StoreHero-1216a9a0.js"),["assets/StoreHero-1216a9a0.js","assets/ReplaceVideoModal-b8eb0f63.js"]))),qe(()=>p.lazy(()=>jt(()=>import("./StoreFeatures-80e9d0fd.js"),[]))),We(()=>p.lazy(()=>jt(()=>import("./ProductGrid-e83cf27a.js"),["assets/ProductGrid-e83cf27a.js","assets/ProductEditModal-3669a150.js"]))),Le(()=>p.lazy(()=>jt(()=>import("./Testimonials-1bf88ea3.js"),["assets/Testimonials-1bf88ea3.js","assets/message-square-3c6f6c13.js","assets/user-circle-e5dfa8b1.js"]))),Je(()=>p.lazy(()=>jt(()=>import("./ImageRightSection-44729353.js"),[]))),kt(()=>p.lazy(()=>jt(()=>import("./VideoLeftSection-c7564a15.js"),["assets/VideoLeftSection-c7564a15.js","assets/ReplaceVideoModal-b8eb0f63.js"]))),fn(()=>p.lazy(()=>jt(()=>import("./HeroFollowUpVideo-93dd61b2.js"),["assets/HeroFollowUpVideo-93dd61b2.js","assets/ReplaceVideoModal-b8eb0f63.js"]))),ae(()=>p.lazy(()=>jt(()=>import("./Newsletter-ee575b8d.js"),[]))),fe(()=>p.lazy(()=>jt(()=>import("./Footer-b096c7f4.js"),[])))):At==="fresh"?(ne(()=>p.lazy(()=>jt(()=>import("./StoreHeader-121aa6f8.js"),[]))),Ee(()=>p.lazy(()=>jt(()=>import("./StoreHero-54ea820e.js"),[]))),re(()=>p.lazy(()=>jt(()=>import("./StoreFeatures-a119f76d.js"),[]))),Te(()=>p.lazy(()=>jt(()=>import("./ProductGrid-6594a41a.js"),["assets/ProductGrid-6594a41a.js","assets/ProductEditModal-3669a150.js"]))),pt(()=>p.lazy(()=>jt(()=>import("./StoreCollections-42c86002.js"),["assets/StoreCollections-42c86002.js","assets/CollectionProductsDialog-f7d6d2e4.js"]))),be(()=>p.lazy(()=>jt(()=>import("./Newsletter-3f9b987e.js"),[]))),Pe(()=>p.lazy(()=>jt(()=>import("./Footer-dd3e9aca.js"),["assets/Footer-dd3e9aca.js","assets/shield-check-307127cf.js"])))):At==="sleek"&&(Ht(()=>p.lazy(()=>jt(()=>import("./StoreHeader-97e8f6b3.js"),[]))),yt(()=>p.lazy(()=>jt(()=>import("./StoreHero-d9059e58.js"),[]))),Sn(()=>p.lazy(()=>jt(()=>import("./ProductGrid-bdcbd747.js"),["assets/ProductGrid-bdcbd747.js","assets/ProductEditModal-3669a150.js","assets/filter-7f3c97a9.js"]))),xr(()=>p.lazy(()=>jt(()=>import("./StoreFeatures-2839a3a2.js"),[]))),Xt(()=>p.lazy(()=>jt(()=>import("./Testimonials-e08c37f3.js"),["assets/Testimonials-e08c37f3.js","assets/user-circle-e5dfa8b1.js"]))),Bn(()=>p.lazy(()=>jt(()=>import("./Newsletter-60021b62.js"),[]))),te(()=>p.lazy(()=>jt(()=>import("./Footer-88ea2706.js"),[]))),Ie(()=>p.lazy(()=>jt(()=>import("./StoreCollections-fbe2fba4.js"),[]))))}},[h==null?void 0:h.id,m]);const _s=()=>{if(!h||!h.pass_key){Pt(!0);return}lr(!0),setTimeout(()=>{vt===h.pass_key?(Pt(!0),d({title:"Access Granted",description:"Welcome to the store!"})):(d({title:"Access Denied",description:"Incorrect pass key.",variant:"destructive"}),on("")),lr(!1)},500)};if(c)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading store..."})]})});if(!h)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("p",{className:"text-xl text-destructive",children:"Store not found."})});if(!Nr&&h.pass_key)return a.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 p-4",children:a.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-2xl w-full max-w-md text-center",children:[a.jsx(R$,{className:"h-16 w-16 text-primary mx-auto mb-6"}),a.jsx("h2",{className:"text-3xl font-bold text-card-foreground mb-3",children:"Protected Store"}),a.jsx("p",{className:"text-muted-foreground mb-8",children:"This store requires a pass key to view its content."}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx(nt,{type:"password",placeholder:"Enter Pass Key",value:vt,onChange:At=>on(At.target.value),className:"h-12 text-lg text-center bg-input border-border focus:ring-primary focus:border-primary",onKeyPress:At=>At.key==="Enter"&&_s()}),a.jsx(V,{onClick:_s,disabled:an||!vt.trim(),className:"h-12 text-lg w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:an?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-current"}):a.jsxs(a.Fragment,{children:[a.jsx(hie,{className:"mr-2 h-5 w-5"})," Access Store"]})})]})]})});const ft=l==="published";let vn=m;if(vn||(vn=(h==null?void 0:h.template_version)==="v1"||!(h!=null&&h.template_version)?"classic":h.template_version),console.log(`[StorePreview] Determined templateVersionToRender: ${vn}. (previewTemplateVersion: ${m}, store.template_version: ${h==null?void 0:h.template_version})`),console.log(`[StorePreview] Rendering template: ${vn}. Store products: ${((bs=h==null?void 0:h.products)==null?void 0:bs.length)||0}, collections: ${((vr=h==null?void 0:h.collections)==null?void 0:vr.length)||0}`),vn==="classic"){if(!J||!G||!we||!Ue||!Q||!ue||!Ae||!it)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Classic Template Components..."})]})})}else if(vn==="modern"){if(!x||!v||!S||!M||!C||!P)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Modern Template Components..."})]})})}else if(vn==="premium"){if(!D||!k||!B||!ee||!X||!z||!F)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Premium Template Components..."})]})})}else if(vn==="sharp"){if(!Se||!xe||!Gt||!Ye||!et||!mt||!ve||!Xe||!sn||!me)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Sharp Template Components..."})]})})}else if(vn==="sleek"){if(!Yt||!Tt||!Ft||!le||!mn||!Un||!nn||!q)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Sleek Template Components..."})]})})}else if(vn==="fresh"&&(!Ne||!de||!Qe||!Ve||!ut||!he||!Fe))return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Fresh Template Components..."})]})});return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx(p.Suspense,{fallback:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading Store Content..."}),children:vn==="classic"?a.jsxs(ct.Fragment,{children:[J&&a.jsx(J,{store:h,isPublishedView:ft}),G&&a.jsx(G,{store:h,isPublishedView:ft}),Ue&&a.jsx(Ue,{store:h,isPublishedView:ft}),we&&a.jsx(we,{store:h,isPublishedView:ft}),dt&&a.jsx(dt,{store:h,isPublishedView:ft}),Oe&&a.jsx(Oe,{store:h,isPublishedView:ft}),ue&&a.jsx(ue,{store:h,isPublishedView:ft}),Ae&&a.jsx(Ae,{store:h,isPublishedView:ft}),it&&a.jsx(it,{store:h,isPublishedView:ft})]},"classic"):vn==="modern"?a.jsx(ct.Fragment,{children:a.jsxs("div",{className:"min-h-screen flex flex-col",children:[a.jsxs("main",{className:"flex-1",children:[x&&a.jsx(x,{store:h,isPublishedView:ft}),v&&a.jsx(v,{store:h,isPublishedView:ft}),S?a.jsx(S,{store:h,isPublishedView:ft}):dt&&a.jsx(dt,{store:h,isPublishedView:ft}),C&&a.jsx(C,{store:h,products:(h==null?void 0:h.products)||[],isPublishedView:ft}),M&&a.jsx(M,{store:h,isPublishedView:ft}),Oe&&a.jsx(Oe,{store:h,isPublishedView:ft})]}),a.jsx("footer",{className:"mt-auto",children:P&&a.jsx(P,{store:h,isPublishedView:ft})})]})},"modern"):vn==="premium"?a.jsxs(ct.Fragment,{children:[D&&a.jsx(D,{store:h,isPublishedView:ft}),k&&a.jsx(k,{store:h,isPublishedView:ft}),B&&a.jsx(B,{store:h,isPublishedView:ft}),ee&&a.jsx(ee,{store:h,isPublishedView:ft}),dt&&a.jsx(dt,{store:h,isPublishedView:ft}),Oe&&a.jsx(Oe,{store:h,isPublishedView:ft}),X&&a.jsx(X,{store:h,isPublishedView:ft}),z&&a.jsx(z,{store:h,isPublishedView:ft}),F&&a.jsx(F,{store:h,isPublishedView:ft})]},"premium"):vn==="sharp"?a.jsxs(ct.Fragment,{children:[Se&&a.jsx(Se,{store:h,isPublishedView:ft}),xe&&a.jsx(xe,{store:h,isPublishedView:ft}),Gt&&a.jsx(Gt,{store:h}),et&&a.jsx(et,{store:h,isPublishedView:ft}),Ye?a.jsx(Ye,{store:h,isPublishedView:ft}):dt&&a.jsx(dt,{store:h,isPublishedView:ft}),Oe&&a.jsx(Oe,{store:h,isPublishedView:ft}),ve&&a.jsx(ve,{store:h,isPublishedView:ft}),Xe&&a.jsx(Xe,{store:h,isPublishedView:ft}),mt&&a.jsx(mt,{store:h,isPublishedView:ft}),sn&&a.jsx(sn,{store:h}),me&&a.jsx(me,{store:h})]},"sharp"):vn==="fresh"?a.jsxs(ct.Fragment,{children:[Ne&&a.jsx(Ne,{store:h,isPublishedView:ft}),de&&a.jsx(de,{store:h,isPublishedView:ft}),Ve&&a.jsx(Ve,{store:h,isPublishedView:ft})," ",ut&&a.jsx(ut,{store:h,isPublishedView:ft})," ",Qe?a.jsx(Qe,{store:h,isPublishedView:ft}):dt&&a.jsx(dt,{store:h,isPublishedView:ft}),Oe&&a.jsx(Oe,{store:h,isPublishedView:ft}),he&&a.jsx(he,{store:h}),Fe&&a.jsx(Fe,{store:h})]},"fresh"):vn==="sleek"?a.jsxs(ct.Fragment,{children:[Yt&&a.jsx(Yt,{store:h,isPublishedView:ft}),Tt&&a.jsx(Tt,{store:h,isPublishedView:ft}),Ft&&a.jsx(Ft,{store:h,isPublishedView:ft}),le&&a.jsx(le,{store:h,isPublishedView:ft}),mn?a.jsx(mn,{store:h,isPublishedView:ft}):dt&&a.jsx(dt,{store:h,isPublishedView:ft}),Oe&&a.jsx(Oe,{store:h,isPublishedView:ft}),Un&&a.jsx(Un,{store:h,isPublishedView:ft}),nn&&a.jsx(nn,{store:h,isPublishedView:ft}),q&&a.jsx(q,{store:h,isPublishedView:ft})]},"sleek"):null}),a.jsx(d1e,{store:h,onEdit:()=>Qt(!0),currentTemplate:m,onTemplateChange:g,availableTemplates:["classic","modern","premium","sharp","fresh","sleek"]}),!ft&&h&&a.jsx(h1e,{store:h,open:Nt,onOpenChange:Qt,onStoreUpdate:At=>{f(_t=>({..._t,...At})),At.template_version&&At.template_version!==m&&g(At.template_version),(h&&h.id===At.id||s&&s.id===At.id)&&o(At.id,At)}}),a.jsx(EW,{storeId:h==null?void 0:h.id})," "]})},_Re=({open:t,onOpenChange:e,storeId:n,storeName:r,currentLogoUrlLight:s,currentLogoUrlDark:i,onLogoReplaced:o})=>{const[l,c]=p.useState("ai"),[u,d]=p.useState(r||""),[h,f]=p.useState(!1),[m,g]=p.useState(null),[x,E]=p.useState({light:null,dark:null}),[v,_]=p.useState(""),[S,I]=p.useState([]),[M,j]=p.useState(!1),[C,T]=p.useState(null),[P,A]=p.useState(null),[D,R]=p.useState(null),[k,U]=p.useState(!1),[B,K]=p.useState(null);p.useEffect(()=>{t&&(d(r||""),f(!1),g(null),E({light:null,dark:null}),_(""),I([]),j(!1),T(null),A(null),R(null),U(!1),K(null))},[t,r]);const ee=async()=>{if(!r){g("Store name is required to generate a logo with AI.");return}f(!0),g(null),E({light:null,dark:null});try{console.log(`Generating light/dark logos for store ${r}`);const F=await Yp(r);F&&(F.logoUrlLight||F.logoUrlDark)?E({light:F.logoUrlLight,dark:F.logoUrlDark}):g(F.textResponse||"AI did not return sufficient image data for logos.")}catch(F){console.error("Error generating logos with AI:",F),g(F.message||"Failed to generate logos. Please try again.")}finally{f(!1)}},H=async()=>{if(!v.trim()){T("Please enter a search query for Pexels.");return}j(!0),T(null),I([]);try{const F=await hRe(v);F.error?(T(F.error),I([])):(I(F.photos||[]),(F.photos||[]).length===0&&T("No images found for your query."))}catch(F){console.error("Error searching Pexels images:",F),T(F.message||"Failed to search Pexels. Please try again.")}finally{j(!1)}},X=F=>{o&&F?(o({logoUrlLight:F,logoUrlDark:F}),e(!1)):T("Invalid image URL selected or replacement handler missing.")},O=F=>{const ye=F.target.files[0];if(ye){if(ye.size>10*1024*1024){R("File is too large. Please select an image under 10MB."),A(null),K(null);return}if(!ye.type.startsWith("image/")){R("Invalid file type. Please select an image file (e.g., PNG, JPG, GIF)."),A(null),K(null);return}A(ye),R(null);const Se=new FileReader;Se.onloadend=()=>{K(Se.result)},Se.readAsDataURL(ye)}},z=()=>{if(P&&o){U(!0),R(null);const F=new FileReader;F.onloadend=()=>{const ye=F.result;o({logoUrlLight:ye,logoUrlDark:ye}),e(!1),A(null),K(null),U(!1)},F.onerror=()=>{R("Failed to read image file for upload."),U(!1)},F.readAsDataURL(P)}else R("No image file selected or replacement handler missing.")},Y=()=>{x.light||x.dark?(o({logoUrlLight:x.light,logoUrlDark:x.dark}),e(!1)):g("No AI generated logos available to confirm.")};return a.jsx(ys,{open:t,onOpenChange:e,children:a.jsxs(es,{className:"sm:max-w-[728px]",children:[" ",a.jsxs(ts,{className:"text-left",children:[a.jsx(ns,{children:"Change Store Logo"}),a.jsxs(xo,{className:"text-left space-y-2",children:[a.jsx("p",{children:"Current Logos:"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx(Re,{className:"text-xs text-muted-foreground",children:"For Dark Backgrounds (Light Logo)"}),s?a.jsx("img",{src:s,alt:"Current light logo",className:"h-20 w-auto mx-auto max-w-full object-contain my-1 border rounded bg-gray-700 p-1"}):a.jsx("div",{className:"h-20 flex items-center justify-center text-xs text-muted-foreground bg-gray-200 dark:bg-gray-700 rounded my-1",children:"Not set"})]}),a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx(Re,{className:"text-xs text-muted-foreground",children:"For Light Backgrounds (Dark Logo)"}),i?a.jsx("img",{src:i,alt:"Current dark logo",className:"h-20 w-auto mx-auto max-w-full object-contain my-1 border rounded bg-white p-1"}):a.jsx("div",{className:"h-20 flex items-center justify-center text-xs text-muted-foreground bg-gray-200 dark:bg-gray-700 rounded my-1",children:"Not set"})]})]})]})]}),a.jsxs(Ei,{value:l,onValueChange:c,className:"w-full",children:[a.jsxs(Qs,{className:"grid w-full grid-cols-3",children:[a.jsx(Bt,{value:"ai",children:"Generate with AI"}),a.jsx(Bt,{value:"pexels",children:"Search Pexels"}),a.jsx(Bt,{value:"upload",children:"Upload Image"})]}),a.jsxs(zt,{value:"ai",className:"space-y-4 py-4",children:[a.jsxs("p",{className:"text-sm text-muted-foreground",children:["AI will generate a logo based on your store name: ",a.jsx("strong",{children:r}),"."]}),m&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:m}),h&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Generating logos..."}),(x.light||x.dark)&&!h&&a.jsxs("div",{className:"flex flex-col items-center gap-4 mt-3",children:[a.jsx("p",{className:"text-sm font-medium",children:"Generated Previews:"}),a.jsxs("div",{className:"flex gap-4",children:[x.dark&&a.jsxs("div",{className:"text-center",children:[a.jsx(Re,{className:"text-xs text-muted-foreground",children:"For Light BG"}),a.jsx("img",{src:x.dark,alt:"AI Generated Dark Logo",className:"h-24 w-24 object-contain border rounded-md bg-white p-1"})]}),x.light&&a.jsxs("div",{className:"text-center",children:[a.jsx(Re,{className:"text-xs text-muted-foreground",children:"For Dark BG"}),a.jsx("img",{src:x.light,alt:"AI Generated Light Logo",className:"h-24 w-24 object-contain border rounded-md bg-gray-700 p-1"})]})]})]}),a.jsxs(Tr,{className:"justify-start pt-4",children:[a.jsx(V,{variant:"outline",onClick:()=>e(!1),disabled:h,children:"Cancel"}),a.jsxs(V,{onClick:ee,disabled:h||!r,children:[a.jsx(B1,{className:"mr-2 h-4 w-4"}),h?"Generating...":x.light||x.dark?"Regenerate Logos":"Generate Logos"]}),(x.light||x.dark)&&a.jsx(V,{onClick:Y,disabled:h,children:"Use These Logos"})]})]}),a.jsxs(zt,{value:"pexels",className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(nt,{id:"pexelsQuery",value:v,onChange:F=>_(F.target.value),placeholder:"e.g., Abstract, Minimal, Tech",disabled:M,className:"flex-grow"}),a.jsx(V,{onClick:H,disabled:M||!v.trim(),children:M?"Searching...":"Search Images"})]}),C&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:C}),M&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Loading Pexels images..."}),!M&&S.length>0&&a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-3 max-h-[300px] overflow-y-auto pr-2",children:S.map(F=>a.jsxs("div",{className:"relative aspect-square rounded-md overflow-hidden cursor-pointer group border hover:border-primary",onClick:()=>X(F.src.large2x||F.src.large||F.src.original),children:[a.jsx("img",{src:F.src.medium,alt:F.alt||`Pexels image by ${F.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),a.jsx("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:a.jsx("p",{className:"text-white text-xs text-center p-1 bg-black/50 rounded",children:"Use Image"})})]},F.id))}),a.jsx(Tr,{className:"justify-start pt-4",children:a.jsx(V,{variant:"outline",onClick:()=>e(!1),disabled:M,children:"Cancel"})})]}),a.jsxs(zt,{value:"upload",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"image-upload-input",className:"text-left block mb-1",children:"Select Image File"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(nt,{id:"image-upload-input",type:"file",accept:"image/*",onChange:O,className:"flex-grow",disabled:k})}),B&&a.jsxs("div",{className:"mt-3 flex flex-col items-center",children:[a.jsx("p",{className:"text-sm font-medium mb-1",children:"Preview:"}),a.jsx("img",{src:B,alt:"Upload preview",className:"h-32 w-32 object-contain border rounded-md"})]}),P&&!B&&a.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected: ",P.name," (",(P.size/1024/1024).toFixed(2)," MB)"]}),D&&a.jsx("p",{className:"text-sm text-red-500 text-center mt-2",children:D})]}),a.jsxs(Tr,{className:"justify-start pt-4",children:[a.jsx(V,{variant:"outline",onClick:()=>e(!1),disabled:k,children:"Cancel"}),a.jsx(V,{onClick:z,disabled:k||!P,children:k?"Uploading...":"Confirm Upload"})]})]})]})]})})},NW=({store:t,isPublishedView:e=!1})=>{const{name:n,theme:r,logo_url_light:s,logo_url_dark:i,id:o,settings:l,content:c,template_version:u}=t,{cart:d,removeFromCart:h,updateQuantity:f,updateStore:m,updateStoreTemplateVersion:g}=$n(),[x,E]=p.useState(!1),[v,_]=p.useState(!1),[S,I]=p.useState(!1),M=!e,[j,C]=p.useState(!1),T=bi(),P=d.filter(Y=>Y.storeId===o),A=P.reduce((Y,F)=>Y+F.quantity,0),D=P.reduce((Y,F)=>Y+F.price*F.quantity,0);p.useEffect(()=>{const Y=localStorage.getItem("theme"),F=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;C(!!(Y==="dark"||!Y&&F))},[]);const R=async(Y,F,ye=null)=>{if(o)try{if(Y==="storeName")await m(o,{name:F});else if(Y==="navLink"&&ye!==null){const De=((c==null?void 0:c.navLinks)||X.map(xe=>({label:xe.label,href:xe.href}))).map((xe,Me)=>Me===ye?{...xe,label:F}:xe);await m(o,{content:{...c,navLinks:De}})}await k()}catch(Se){console.error(`Failed to update store ${Y} or refresh template:`,Se)}},k=async()=>{const Y=u||"v1";console.log(`Performing template refresh. Current version: ${Y}`),Y==="v1"?(await g(o,"v2"),await g(o,"v1"),console.log("Template refreshed: v1 -> v2 -> v1")):Y==="v2"&&(await g(o,"v1"),await g(o,"v2"),console.log("Template refreshed: v2 -> v1 -> v2"))},U=()=>{I(!0),console.log("Open change image dialog (placeholder)")},B=async Y=>{if(o&&Y)try{await m(o,{logo_url_light:Y.logoUrlLight||t.logo_url_light,logo_url_dark:Y.logoUrlDark||t.logo_url_dark}),console.log("Store logos updated successfully.")}catch(F){console.error("Failed to update store logos:",F)}},K=()=>{const Y=!j;C(Y),Y?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},ee=`/store/${o}`,H=[{href:ee,label:"Home"},{href:`#products-${o}`,label:"Products"},{href:`#features-${o}`,label:"Features"},{href:`#contact-${o}`,label:"Contact"}],X=c!=null&&c.navLinks&&c.navLinks.length===H.length?c.navLinks.map((Y,F)=>({...H[F],label:Y.label||H[F].label})):H,O=(Y,F)=>{if(Y.preventDefault(),E(!1),F.startsWith("/store/"))T(F);else{const ye=F.substring(1),Se=document.getElementById(ye);Se?Se.scrollIntoView({behavior:"smooth"}):T(ee)}},z=()=>{_(!1),T("/checkout",{state:{cart:P,storeName:n,storeId:o}})};return a.jsxs(a.Fragment,{children:[a.jsx(Ct.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"sticky top-0 z-40 w-full bg-background/90 backdrop-blur-md border-b",style:{borderColor:`${r.primaryColor}30`},children:a.jsxs("div",{className:"container mx-auto px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ns,{to:ee,className:"group",children:(j?s:i)?a.jsx("img",{src:j?s:i,alt:`${n} logo`,className:"h-16 w-16 object-contain group-hover:scale-105 transition-transform duration-200"}):s||i?a.jsx("img",{src:s||i,alt:`${n} logo (fallback)`,className:"h-16 w-16 object-contain group-hover:scale-105 transition-transform duration-200"}):null}),M&&(s||i)&&a.jsx(V,{variant:"outline",size:"icon",onClick:U,className:"h-8 w-8 p-0 -ml-2 relative z-10 bg-background hover:bg-muted",children:a.jsx(_v,{className:"h-4 w-4"})}),a.jsx(Ns,{to:ee,className:"group ml-2",children:a.jsx("span",{className:"font-bold text-xl tracking-tight group-hover:text-primary transition-colors",style:{color:r.primaryColor},children:a.jsx(Mn,{initialText:n,onSave:Y=>R("storeName",Y),isAdmin:M,placeholder:"Store Name"})})})]})," ",a.jsx("nav",{className:"hidden md:flex items-center gap-x-6",children:X.map((Y,F)=>a.jsx("a",{href:Y.href,onClick:ye=>O(ye,Y.href),className:"text-sm font-medium text-muted-foreground hover:text-primary transition-colors",style:{"--hover-color":r.primaryColor},children:a.jsx(Mn,{initialText:Y.label,onSave:ye=>R("navLink",ye,F),isAdmin:M,placeholder:`Link ${F+1}`})},Y.label+F))}),a.jsxs("div",{className:"flex items-center gap-2",children:[((l==null?void 0:l.showThemeToggle)??!0)&&a.jsxs("div",{className:"hidden md:flex items-center gap-2 mr-2",children:[a.jsx(Do,{id:`store-theme-switcher-${o}`,checked:j,onCheckedChange:K,"aria-label":"Toggle dark mode"}),j?a.jsx(WE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(qE,{className:"h-5 w-5 text-muted-foreground"})]}),a.jsx(V,{variant:"ghost",size:"icon",className:"hidden md:flex text-muted-foreground hover:text-primary",style:{"--hover-color":r.primaryColor},children:a.jsx(Jd,{className:"h-5 w-5"})}),a.jsxs(V,{variant:"outline",className:"relative",onClick:()=>_(!0),style:{borderColor:r.primaryColor,color:r.primaryColor},children:[a.jsx(dp,{className:"h-5 w-5"}),A>0&&a.jsx(Fp,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center text-xs",style:{backgroundColor:r.secondaryColor||"red"},children:A}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Cart"})]}),a.jsx(V,{variant:"ghost",size:"icon",className:"md:hidden text-muted-foreground hover:text-primary",onClick:()=>E(!0),style:{"--hover-color":r.primaryColor},children:a.jsx(k$,{className:"h-6 w-6"})})]})]})}),a.jsx(_h,{children:x&&a.jsxs(Ct.div,{initial:{opacity:0,x:"100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"100%"},transition:{type:"spring",stiffness:300,damping:30},className:"fixed inset-0 z-50 bg-background p-6 md:hidden",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ns,{to:ee,className:"group",onClick:()=>E(!1),children:(j?s:i)?a.jsx("img",{src:j?s:i,alt:`${n} logo`,className:"h-16 w-16 object-contain"}):s||i?a.jsx("img",{src:s||i,alt:`${n} logo (fallback)`,className:"h-16 w-16 object-contain"}):null}),M&&(s||i)&&a.jsx(V,{variant:"outline",size:"icon",onClick:()=>{U(),E(!1)},className:"h-8 w-8 p-0 -ml-2 relative z-10 bg-background hover:bg-muted",children:a.jsx(_v,{className:"h-4 w-4"})}),a.jsx(Ns,{to:ee,className:"group ml-2",onClick:()=>E(!1),children:a.jsx("span",{className:"font-bold text-xl",style:{color:r.primaryColor},children:a.jsx(Mn,{initialText:n,onSave:Y=>R("storeName",Y),isAdmin:M,placeholder:"Store Name"})})})]})," ",a.jsx(V,{variant:"ghost",size:"icon",onClick:()=>E(!1),children:a.jsx(zo,{className:"h-6 w-6"})})]}),a.jsxs("nav",{className:"flex flex-col gap-y-4",children:[X.map((Y,F)=>a.jsx("a",{href:Y.href,onClick:ye=>O(ye,Y.href),className:"text-lg font-medium text-foreground hover:text-primary transition-colors",style:{"--hover-color":r.primaryColor},children:a.jsx(Mn,{initialText:Y.label,onSave:ye=>R("navLink",ye,F),isAdmin:M,placeholder:`Link ${F+1}`})},Y.label+F)),((l==null?void 0:l.showThemeToggle)??!0)&&a.jsxs("div",{className:"flex items-center gap-2 mt-4 pt-4 border-t border-border",children:[a.jsx(Do,{id:`mobile-store-theme-switcher-${o}`,checked:j,onCheckedChange:K,"aria-label":"Toggle dark mode"}),j?a.jsx(WE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(qE,{className:"h-5 w-5 text-muted-foreground"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:j?"Dark Mode":"Light Mode"})]})]})]})}),a.jsx(_h,{children:v&&a.jsx(zd.Root,{open:v,onOpenChange:_,children:a.jsxs(zd.Portal,{children:[a.jsx(zd.Overlay,{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm"}),a.jsxs(zd.Content,{className:"fixed z-50 inset-y-0 right-0 h-full w-full max-w-md bg-background border-l shadow-xl flex flex-col",as:Ct.div,initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30},children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Your Cart"}),a.jsx(V,{variant:"ghost",size:"icon",onClick:()=>_(!1),children:a.jsx(zo,{className:"h-5 w-5"})})]}),P.length===0?a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 text-center",children:[a.jsx(dp,{className:"h-16 w-16 text-muted-foreground mb-4"}),a.jsx("p",{className:"text-lg font-medium",children:"Your cart is empty"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Looks like you haven't added anything yet."}),a.jsx(V,{onClick:()=>_(!1),className:"mt-6",style:{backgroundColor:r.primaryColor},children:"Continue Shopping"})]}):a.jsxs(a.Fragment,{children:[a.jsx(Gi,{className:"flex-1 p-6",children:a.jsx("div",{className:"space-y-4",children:P.map(Y=>{var F,ye,Se,De;return a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("img",{src:((ye=(F=Y.image)==null?void 0:F.src)==null?void 0:ye.tiny)||((De=(Se=Y.image)==null?void 0:Se.src)==null?void 0:De.medium)||`https://via.placeholder.com/80x80.png?text=${Y.name.substring(0,1)}`,alt:Y.name,className:"w-20 h-20 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-medium text-sm line-clamp-1",children:Y.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Price: $",Y.price.toFixed(2)]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(V,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>f(Y.id,o,Y.quantity-1),children:a.jsx("span",{className:"text-lg leading-none",children:"-"})}),a.jsx("span",{className:"text-sm w-4 text-center",children:Y.quantity}),a.jsx(V,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>f(Y.id,o,Y.quantity+1),children:a.jsx("span",{className:"text-lg leading-none",children:"+"})})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-semibold text-sm",children:["$",(Y.price*Y.quantity).toFixed(2)]}),a.jsx(V,{variant:"ghost",size:"icon",className:"h-7 w-7 mt-1 text-muted-foreground hover:text-destructive",onClick:()=>h(Y.id,o),children:a.jsx(er,{className:"h-4 w-4"})})]})]},Y.id)})})}),a.jsx(Sa,{}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex justify-between font-medium",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:["$",D.toFixed(2)]})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Shipping and taxes calculated at checkout."}),a.jsx(V,{className:"w-full",size:"lg",style:{backgroundColor:r.primaryColor},onClick:z,children:"Proceed to Checkout"})]})]})]})]})})}),M&&a.jsx(_Re,{open:S,onOpenChange:I,storeId:o,storeName:n,currentLogoUrl:i,currentLogoUrlLight:s,currentLogoUrlDark:i,onLogoReplaced:B})]})},zd={Root:({children:t,...e})=>a.jsx("div",{...e,children:t}),Portal:({children:t})=>a.jsx(a.Fragment,{children:t}),Overlay:ct.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("fixed inset-0 z-50",t),...e})),Content:ct.forwardRef(({className:t,children:e,...n},r)=>a.jsx("div",{ref:r,className:bt("fixed z-50",t),...n,children:e}))};zd.Overlay.displayName="DialogPrimitive.Overlay";zd.Content.displayName="DialogPrimitive.Content";const bRe=Object.freeze(Object.defineProperty({__proto__:null,default:NW},Symbol.toStringTag,{value:"Module"})),PW=({store:t,isPublishedView:e=!1})=>{const{name:n,theme:r,id:s,content:i}=t,{updateStore:o}=$n(),l=!e,c=new Date().getFullYear(),u=[{icon:Use,href:"#",label:"Facebook"},{icon:dx,href:"#",label:"Instagram"},{icon:die,href:"#",label:"Twitter"},{icon:Kse,href:"#",label:"LinkedIn"},{icon:gie,href:"#",label:"YouTube"}],h=[{href:`/store/${s}`,label:"Home"},{href:`#products-${s}`,label:"Products"},{href:"#",label:"About Us"},{href:"#",label:"Contact"},{href:"#",label:"FAQ"},{href:"#",label:"Privacy Policy"},{href:"#",label:"Terms of Service"},{href:"#",label:"Shipping Info"},{href:"#",label:"Returns"}],f=i!=null&&i.footerNavLinks&&Array.isArray(i.footerNavLinks)&&i.footerNavLinks.length>0?i.footerNavLinks.map((j,C)=>{var T,P;return{href:j.href||((T=h[C])==null?void 0:T.href)||"#",label:j.label||((P=h[C])==null?void 0:P.label)||`Link ${C+1}`}}):h,m=()=>{window.scrollTo({top:0,behavior:"smooth"})},g=async(j,C,T=null)=>{if(s)try{if(j.startsWith("content.footerNavLinks")){const P=f.map((A,D)=>D===T?{...A,label:C}:A);await o(s,{content:{...i,footerNavLinks:P}})}else{const P=j.split(".");P.length===2&&P[0]==="content"?await o(s,{content:{...i,[P[1]]:C}}):console.warn("Unsupported identifier for footer text save:",j)}}catch(P){console.error(`Failed to update store footer text for ${j}:`,P)}},x=(i==null?void 0:i.footerStoreInfo)||`Your favorite destination for ${t.type||"quality products"}. We are committed to bringing you the best experience with premium quality and exceptional service.`,E=(i==null?void 0:i.footerQuickLinksTitle)||"Quick Links",v=(i==null?void 0:i.footerCustomerServiceTitle)||"Customer Service",_=(i==null?void 0:i.footerContactUsTitle)||"Contact Us",S=(i==null?void 0:i.footerAddress)||"123 Store Street, Cityville, ST 12345",I=(i==null?void 0:i.footerPhoneNumber)||"(123) 456-7890",M=(i==null?void 0:i.footerCopyrightSuffix)||"All Rights Reserved. Powered by FreshFront.";return a.jsxs("footer",{className:"bg-muted dark:bg-slate-900 text-muted-foreground relative overflow-hidden",id:`contact-${s}`,children:[a.jsx(Ct.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},viewport:{once:!0},className:"pt-16 pb-8",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-xl font-bold text-foreground font-poppins",style:{color:r.primaryColor},children:n}),a.jsx("div",{className:"text-sm",children:a.jsx(Mn,{initialText:x,onSave:j=>g("content.footerStoreInfo",j),isAdmin:l,placeholder:"Store information paragraph",useTextarea:!0,textClassName:"text-sm"})}),a.jsx("div",{className:"flex space-x-3 pt-2",children:u.map(j=>a.jsx("a",{href:j.href,"aria-label":j.label,className:"p-2 rounded-full bg-background/50 hover:bg-primary/10 hover:scale-110 transition-all duration-300",style:{"--hover-bg-color":`${r.primaryColor}1A`,"--hover-text-color":r.primaryColor},children:a.jsx(j.icon,{className:"h-5 w-5"})},j.label))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(Mn,{initialText:E,onSave:j=>g("content.footerQuickLinksTitle",j),isAdmin:l,placeholder:"Quick Links Title",textClassName:"font-bold text-foreground"})}),a.jsx("ul",{className:"space-y-2",children:f.slice(0,5).map((j,C)=>a.jsx("li",{children:a.jsx("a",{href:j.href,className:"text-sm hover:text-primary transition-colors hover:translate-x-1 inline-block hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:a.jsx(Mn,{initialText:j.label,onSave:T=>g("content.footerNavLinks",T,C),isAdmin:l,placeholder:`Link ${C+1}`,textClassName:"text-sm"})})},j.label+C))})]}),a.jsxs(Ct.div,{variants:{hidden:{opacity:0,x:-30},visible:{opacity:1,x:0,transition:{duration:.5,ease:"easeOut",delay:.2}}},children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(Mn,{initialText:v,onSave:j=>g("content.footerCustomerServiceTitle",j),isAdmin:l,placeholder:"Customer Service Title",textClassName:"font-bold text-foreground"})}),a.jsx("ul",{className:"space-y-2",children:f.slice(5).map((j,C)=>a.jsx("li",{children:a.jsx("a",{href:j.href,className:"text-sm hover:text-primary transition-colors hover:translate-x-1 inline-block hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:a.jsx(Mn,{initialText:j.label,onSave:T=>g("content.footerNavLinks",T,C+5),isAdmin:l,placeholder:`Link ${C+6}`,textClassName:"text-sm"})})},j.label+C+5))})]}),a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(Mn,{initialText:_,onSave:j=>g("content.footerContactUsTitle",j),isAdmin:l,placeholder:"Contact Us Title",textClassName:"font-bold text-foreground"})}),a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(Yse,{className:"h-5 w-5 mt-0.5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsx(Mn,{initialText:S,onSave:j=>g("content.footerAddress",j),isAdmin:l,placeholder:"Store Address",useTextarea:!0,textClassName:"text-sm"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Rd,{className:"h-5 w-5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsxs("a",{href:`mailto:info@${n.toLowerCase().replace(/\s+/g,"")}.com`,className:"hover:text-primary hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:["info@",n.toLowerCase().replace(/\s+/g,""),".com"]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(rie,{className:"h-5 w-5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsx(Mn,{initialText:I,onSave:j=>g("content.footerPhoneNumber",j),isAdmin:l,placeholder:"Store Phone Number",textClassName:"text-sm hover:text-primary hover:underline decoration-primary/30 underline-offset-4"})]})]})]}),a.jsxs("div",{className:"border-t border-border/50 pt-6 flex flex-col md:flex-row justify-between items-center text-sm",children:[a.jsxs("p",{children:["© ",c," ",n,". ",a.jsx(Mn,{initialText:M,onSave:j=>g("content.footerCopyrightSuffix",j),isAdmin:l,placeholder:"Copyright suffix",textClassName:"text-sm",as:"span"})]}),a.jsx("div",{className:"flex items-center mt-4 md:mt-0",children:a.jsx(V,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-primary/10 transition-all duration-300",onClick:m,style:{"--hover-bg-color":`${r.primaryColor}1A`},children:a.jsx(jse,{className:"h-5 w-5",style:{color:r.primaryColor}})})})]})]})}),a.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary/5 rounded-full translate-x-1/2 -translate-y-1/2 blur-3xl"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-secondary/5 rounded-full -translate-x-1/3 translate-y-1/3 blur-3xl"})]})},SRe=Object.freeze(Object.defineProperty({__proto__:null,default:PW},Symbol.toStringTag,{value:"Module"})),ERe=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),CRe=({open:t,onOpenChange:e,product:n,onVideoGenerated:r})=>{var I,M,j,C;const[s,i]=p.useState(""),[o,l]=p.useState(null),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(!1),[g,x]=p.useState(null),{toast:E}=Ls(),v=((M=(I=n==null?void 0:n.image)==null?void 0:I.src)==null?void 0:M.large)||((C=(j=n==null?void 0:n.image)==null?void 0:j.src)==null?void 0:C.medium);p.useEffect(()=>{t&&v&&(x(null),i(""),l(null),u(null),ERe(v).then(T=>{l(T.base64ImageData),u(T.mimeType)}).catch(T=>{console.error("Error loading product image data:",T),x(`Failed to load product image: ${T.message}`),E({title:"Error",description:`Failed to load product image: ${T.message}`,variant:"destructive"})}))},[t,v,E]);const _=async()=>{if(!o||!c){E({title:"Error",description:"Product image data is not available to suggest a prompt.",variant:"destructive"});return}h(!0),x(null);try{const T=await kd(o,c);i(T)}catch(T){console.error("Error generating prompt suggestion:",T),x(`Failed to suggest prompt: ${T.message}`),E({title:"Suggestion Failed",description:`Could not suggest a prompt: ${T.message}`,variant:"destructive"})}finally{h(!1)}},S=async()=>{if(!s.trim()){x("Please enter a prompt for the video.");return}if(!o||!c){x("Product image data is not available.");return}m(!0),x(null);try{const T=await aU(s,o,c);r&&r(T),e(!1)}catch(T){console.error("Error generating product video:",T),x(T.message||"Failed to generate video. Please try again."),E({title:"Video Generation Failed",description:T.message,variant:"destructive"})}finally{m(!1)}};return n?a.jsx(ys,{open:t,onOpenChange:e,children:a.jsxs(es,{className:"sm:max-w-lg",children:[a.jsxs(ts,{children:[a.jsx(ns,{children:"Generate Product Video"}),a.jsxs(xo,{children:['Create a short video for "',n.name,'" using its image and a prompt.']})]}),a.jsxs("div",{className:"grid gap-4 py-4",children:[v&&a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx("img",{src:v,alt:n.name,className:"w-32 h-32 object-contain rounded border"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Using this image as the base."})]}),a.jsxs("div",{className:"grid w-full gap-1.5",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Re,{htmlFor:"video-prompt",children:"Video Prompt"}),a.jsxs(V,{variant:"outline",size:"sm",onClick:_,disabled:d||f||!o,children:[d?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Cl,{className:"mr-2 h-4 w-4"}),"Suggest"]})]}),a.jsx(Ln,{id:"video-prompt",value:s,onChange:T=>i(T.target.value),placeholder:"e.g., A dynamic shot of the product with vibrant background...",rows:4,disabled:d||f}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"AI will use the product image and this prompt to create a video."})]}),g&&a.jsx("p",{className:"text-sm text-red-500 col-span-4 text-center",children:g})]}),a.jsxs(Tr,{children:[a.jsx(ba,{asChild:!0,children:a.jsx(V,{variant:"outline",disabled:f,children:"Cancel"})}),a.jsxs(V,{onClick:S,disabled:d||f||!s.trim()||!o,children:[f?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Cl,{className:"mr-2 h-4 w-4"}),"Generate Video"]})]})]})}):null};var cA="Progress",uA=100,[TRe,qke]=Si(cA),[IRe,NRe]=TRe(cA),AW=p.forwardRef((t,e)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=PRe,...o}=t;(s||s===0)&&!ZL(s)&&console.error(ARe(`${s}`,"Progress"));const l=ZL(s)?s:uA;r!==null&&!eF(r,l)&&console.error(RRe(`${r}`,"Progress"));const c=eF(r,l)?r:null,u=Sw(c)?i(c,l):void 0;return a.jsx(IRe,{scope:n,value:c,max:l,children:a.jsx(Kt.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":Sw(c)?c:void 0,"aria-valuetext":u,role:"progressbar","data-state":jW(c,l),"data-value":c??void 0,"data-max":l,...o,ref:e})})});AW.displayName=cA;var RW="ProgressIndicator",kW=p.forwardRef((t,e)=>{const{__scopeProgress:n,...r}=t,s=NRe(RW,n);return a.jsx(Kt.div,{"data-state":jW(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:e})});kW.displayName=RW;function PRe(t,e){return`${Math.round(t/e*100)}%`}function jW(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function Sw(t){return typeof t=="number"}function ZL(t){return Sw(t)&&!isNaN(t)&&t>0}function eF(t,e){return Sw(t)&&!isNaN(t)&&t<=e&&t>=0}function ARe(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${uA}\`.`}function RRe(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${uA} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var DW=AW,kRe=kW;const dA=p.forwardRef(({className:t,value:e,...n},r)=>a.jsx(DW,{ref:r,className:bt("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:a.jsx(kRe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));dA.displayName=DW.displayName;const tF="msy_4wQeZBKbKsyGKmfCOGWk0Ux9F7zGIByWSgwC",nF="https://api.meshy.ai/openapi/v1",jRe=({open:t,onOpenChange:e,product:n,storeId:r,onModelGenerated:s})=>{const{toast:i}=Ls(),[o,l]=p.useState([]),[c,u]=p.useState(null),[d,h]=p.useState(0),[f,m]=p.useState(""),[g,x]=p.useState(""),[E,v]=p.useState(!1),[_,S]=p.useState(null),I=p.useCallback(()=>{var A,D,R,k,U,B,K;return n?(D=(A=n.image)==null?void 0:A.src)!=null&&D.large||(k=(R=n.image)==null?void 0:R.src)!=null&&k.medium?[{name:"Main Product Image",url:n.image.src.large||n.image.src.medium}]:((B=(U=n.images)==null?void 0:U.edges)==null?void 0:B.length)>0&&((K=n.images.edges[0].node)!=null&&K.url)?n.images.edges.map((ee,H)=>({name:`Product Image ${H+1}`,url:ee.node.url})).slice(0,4):[]:[]},[n]);p.useEffect(()=>{t&&n?(l(I().slice(0,1)),u(null),h(0),m(""),x(""),v(!1),_&&(clearInterval(_),S(null))):!t&&_&&(clearInterval(_),S(null))},[t,n,I,_]);const M=A=>{const D=Array.from(A.target.files);if(D.length===0)return;const R=[];let k=o.length;D.forEach(U=>{if(k>=4){i({title:"Limit Reached",description:"You can select up to 4 images.",variant:"warning"});return}const B=new FileReader;B.onload=K=>{R.push({name:U.name,url:K.target.result,file:U}),R.length===Math.min(D.length,4-o.length)&&l(ee=>[...ee,...R].slice(0,4))},B.readAsDataURL(U),k++})},j=A=>{l(D=>D.filter((R,k)=>k!==A))},C=async()=>{if(o.length===0){i({title:"No Image Selected",description:"Please select at least one image.",variant:"destructive"});return}v(!0),x(""),m("PENDING"),h(5);const A=o.length>1?"/multi-image-to-3d":"/image-to-3d",D=o.length>1?{image_urls:o.map(R=>R.url)}:{image_url:o[0].url};D.enable_pbr=!0,D.should_texture=!0,o.length===1&&(n!=null&&n.name);try{const R=await fetch(`${nF}${A}`,{method:"POST",headers:{Authorization:`Bearer ${tF}`,"Content-Type":"application/json"},body:JSON.stringify(D)}),k=await R.json();if(!R.ok)throw new Error(k.detail||k.message||`API Error: ${R.status}`);if(k.result){u(k.result),m("IN_PROGRESS"),h(10);const U=setInterval(()=>T(k.result,A),5e3);S(U)}else throw new Error("Task ID not found in response.")}catch(R){console.error("Error creating Meshy task:",R),x(`Error creating task: ${R.message}`),m("FAILED"),v(!1)}},T=async(A,D)=>{var R,k;try{const U=await fetch(`${nF}${D}/${A}`,{headers:{Authorization:`Bearer ${tF}`}}),B=await U.json();if(!U.ok){if(U.status===404&&d<30){h(K=>Math.min(K+5,30));return}throw new Error(B.detail||B.message||`API Error: ${U.status}`)}if(h(B.progress||d),m(B.status),B.status==="SUCCEEDED")if(_&&clearInterval(_),S(null),v(!1),(R=B.model_urls)!=null&&R.glb)s(B.model_urls.glb),i({title:"3D Model Generated!",description:"The model has been successfully created."}),e(!1);else throw new Error("GLB model URL not found in successful response.");else B.status==="FAILED"?(_&&clearInterval(_),S(null),x(((k=B.task_error)==null?void 0:k.message)||"Generation failed for an unknown reason."),v(!1)):(B.status==="PENDING"||B.status==="IN_PROGRESS")&&B.progress===100&&B.status==="IN_PROGRESS"&&h(99)}catch(U){console.error("Error polling Meshy task status:",U),x(`Error polling status: ${U.message}`),_&&clearInterval(_),S(null),m("FAILED"),v(!1)}},P=()=>{_&&(clearInterval(_),S(null)),e(!1)};return a.jsx(ys,{open:t,onOpenChange:P,children:a.jsxs(es,{className:"sm:max-w-lg",children:[a.jsx(ts,{children:a.jsxs(ns,{children:["Generate 3D Model for ",(n==null?void 0:n.name)||(n==null?void 0:n.title)||"Product"]})}),a.jsxs("div",{className:"py-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"image-upload",children:"Product Images (select 1-4)"}),a.jsxs("div",{className:"mt-2 grid grid-cols-2 sm:grid-cols-4 gap-2 mb-2",children:[o.map((A,D)=>a.jsxs("div",{className:"relative group aspect-square border rounded-md overflow-hidden",children:[a.jsx("img",{src:A.url,alt:A.name,className:"w-full h-full object-cover"}),a.jsx(V,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 opacity-50 group-hover:opacity-100",onClick:()=>j(D),disabled:E||f==="IN_PROGRESS",children:a.jsx(er,{size:14})})]},D)),o.length<4&&a.jsxs(Re,{htmlFor:"image-upload-input",className:"aspect-square border-2 border-dashed rounded-md flex flex-col items-center justify-center cursor-pointer hover:border-primary transition-colors text-muted-foreground",children:[a.jsx(Fo,{size:24,className:"mb-1"}),a.jsx("span",{className:"text-xs",children:"Add Image"})]})]}),a.jsx(nt,{id:"image-upload-input",type:"file",multiple:!0,accept:"image/png, image/jpeg, image/jpg",onChange:M,className:"hidden",disabled:E||f==="IN_PROGRESS"||o.length>=4}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Default is main product image. You can add up to 4 images (PNG, JPG). More images can improve quality."})]}),f&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs(Re,{children:["Status: ",f]}),f==="SUCCEEDED"&&a.jsx(uo,{className:"h-5 w-5 text-green-500"}),f==="FAILED"&&a.jsx(z1,{className:"h-5 w-5 text-red-500"}),(f==="PENDING"||f==="IN_PROGRESS")&&a.jsx(St,{className:"h-5 w-5 animate-spin"})]}),a.jsx(dA,{value:d,className:"w-full"}),g&&a.jsx("p",{className:"text-sm text-red-500",children:g})]})]}),a.jsxs(Tr,{children:[a.jsx(V,{type:"button",variant:"outline",onClick:P,disabled:E&&f==="IN_PROGRESS",children:"Cancel"}),a.jsxs(V,{type:"button",onClick:C,disabled:E||o.length===0||f==="IN_PROGRESS"||f==="SUCCEEDED",children:[E&&(f==="PENDING"||f==="IN_PROGRESS")?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):null,f==="IN_PROGRESS"?"Generating...":"Generate 3D Model"]})]})]})})},DRe=({modelUrl:t,thumbnailUrl:e,productName:n="Product",className:r="",height:s="400px",showControls:i=!0,autoRotate:o=!1,cameraControls:l=!0,ar:c=!0})=>{const u=p.useRef(null);p.useEffect(()=>{if(!window.customElements.get("model-viewer")){const m=document.createElement("script");m.type="module",m.src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js",document.head.appendChild(m)}},[]);const d=()=>{u.current&&(u.current.resetTurntableRotation(),u.current.jumpCameraToGoal())},h=()=>{u.current&&u.current.requestFullscreen&&u.current.requestFullscreen()},f=()=>{if(t){const m=document.createElement("a");m.href=t,m.download=`${n.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_3d_model.glb`,document.body.appendChild(m),m.click(),document.body.removeChild(m)}};return t?a.jsx(Ge,{className:r,children:a.jsxs(Ze,{className:"p-0 relative",children:[a.jsxs("model-viewer",{ref:u,src:t,poster:e,alt:`3D model of ${n}`,style:{width:"100%",height:s,backgroundColor:"#f8f9fa"},"camera-controls":l,"auto-rotate":o,ar:c,"ar-modes":"webxr scene-viewer quick-look","environment-image":"neutral","shadow-intensity":"1",exposure:"1","tone-mapping":"neutral",loading:"eager",children:[a.jsx("div",{slot:"progress-bar",className:"absolute inset-0 flex items-center justify-center bg-background/80",children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading 3D model..."})]})}),a.jsx("div",{slot:"error",className:"absolute inset-0 flex items-center justify-center bg-background",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-destructive mb-2",children:"Failed to load 3D model"}),a.jsx(V,{variant:"outline",size:"sm",onClick:()=>window.location.reload(),children:"Retry"})]})})]}),i&&a.jsxs("div",{className:"absolute top-2 right-2 flex flex-col space-y-1",children:[a.jsx(V,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:d,title:"Reset camera",children:a.jsx(oie,{className:"h-4 w-4"})}),a.jsx(V,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:h,title:"Fullscreen",children:a.jsx(Jse,{className:"h-4 w-4"})}),a.jsx(V,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:f,title:"Download model",children:a.jsx(P$,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"absolute bottom-2 right-2"})]})}):a.jsx(Ge,{className:r,children:a.jsx(Ze,{className:"flex items-center justify-center p-6",style:{height:s},children:a.jsx("p",{className:"text-muted-foreground",children:"No 3D model available"})})})},MRe=({product:t,storeId:e,isPublishedView:n=!1})=>{const{toast:r}=Ls(),{getStoreById:s}=$n(),[i,o]=p.useState(null),[l,c]=p.useState(null),[u,d]=p.useState(""),[h,f]=p.useState([]),[m,g]=p.useState([]),[x,E]=p.useState(null),[v,_]=p.useState(!1),[S,I]=p.useState(""),[M,j]=p.useState("#FFFFFF"),[C,T]=p.useState({}),[P,A]=p.useState(""),[D,R]=p.useState(""),[k,U]=p.useState(!1),[B,K]=p.useState(!1);p.useEffect(()=>{if(e){const z=s(e);o(z),z&&t&&f(z.products.filter(Y=>{var F,ye;return Y.id!==t.id&&((ye=(F=Y.image)==null?void 0:F.src)==null?void 0:ye.medium)}))}},[e,t,s]);const ee=z=>{const Y=z.target.files[0];if(Y){Y.size>5*1024*1024&&r({title:"File too large",description:"Reference image should ideally be under 5MB.",variant:"destructive"}),c(Y);const F=new FileReader;F.onloadend=()=>d(F.result),F.readAsDataURL(Y),E(null),A(""),R("")}},H=()=>{c(null),d(""),E(null),A(""),R("")},X=z=>{g(Y=>Y.find(F=>F.id===z.id)?Y.filter(F=>F.id!==z.id):[...Y,z]),E(null),A(""),R("")},O=async()=>{var F,ye,Se,De;if(!t||!l){r({title:"Missing inputs",description:"Main product and a reference image are required.",variant:"destructive"});return}_(!0),E(null),A(""),R("Generating visualization, please wait...");let z=S;M&&M!=="#FFFFFF"&&(z=`${z} The main product's color should be ${M}.`.trim());const Y=Object.entries(C);if(Y.length>0){const xe=Y.map(([Me,Ye])=>`${Me}: ${Ye}`).join(", ");z=`${z} Apply these product attributes: ${xe}.`.trim()}try{const xe={name:t.name,description:t.description,imageSource:((ye=(F=t.image)==null?void 0:F.src)==null?void 0:ye.large)||((De=(Se=t.image)==null?void 0:Se.src)==null?void 0:De.medium)},Me=m.map(qe=>{var et,We,mt,Le;return{name:qe.name,description:qe.description,imageSource:((We=(et=qe.image)==null?void 0:et.src)==null?void 0:We.large)||((Le=(mt=qe.image)==null?void 0:mt.src)==null?void 0:Le.medium)}}),Ye=await SW({mainProduct:xe,referenceSceneSource:l,additionalProducts:Me,customInstructions:z});A(Ye.promptUsed||"Prompt details not available."),R(Ye.commentary||"Processing complete."),Ye&&Ye.imageUrl?(E(Ye.imageUrl),r({title:"Visualization Generated!",description:Ye.commentary||"Image created."})):r({title:"Visualization Issue",description:Ye.commentary||"No image generated by AI.",variant:"default",duration:7e3})}catch(xe){console.error("Error in ProductVisualizer calling generateProductVisualization:",xe);const Me=xe.message||"An unknown error occurred during visualization.";R(`Error: ${Me}`),r({title:"Visualization Failed",description:Me,variant:"destructive",duration:1e4})}finally{_(!1)}};return!t||!i?a.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"Initializing Product Visualizer..."}):a.jsxs("div",{className:"my-8 border rounded-lg shadow-sm bg-card",children:[a.jsxs("div",{className:"p-4 md:p-6 cursor-pointer flex justify-between items-center",onClick:()=>K(!B),role:"button",tabIndex:0,onKeyDown:z=>(z.key==="Enter"||z.key===" ")&&K(!B),"aria-expanded":B,"aria-controls":"product-visualizer-content-area",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl md:text-2xl font-semibold",children:"Product Visualizer"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["See how ",a.jsx("span",{className:"font-medium text-primary",children:t.name})," looks in different settings."]})]}),a.jsx(V,{variant:"ghost",size:"icon","aria-label":B?"Collapse visualizer":"Expand visualizer",children:B?a.jsx(I$,{className:"h-6 w-6"}):a.jsx(n0,{className:"h-6 w-6"})})]}),B&&a.jsxs("div",{id:"product-visualizer-content-area",className:"p-4 md:p-6 border-t",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[a.jsxs("div",{className:"space-y-4 md:space-y-6",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"visualizer-reference-image-upload",className:"text-md font-medium block mb-1",children:"1. Upload Reference Scene"}),a.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"E.g., a room, a model. (Max ~5MB recommended)"}),u?a.jsxs("div",{className:"relative group aspect-video rounded-md border overflow-hidden bg-muted/20",children:[a.jsx("img",{src:u,alt:"Reference scene preview",className:"w-full h-full object-contain"}),a.jsx(V,{variant:"destructive",size:"icon",className:"absolute top-2 right-2 opacity-50 group-hover:opacity-100 transition-opacity",onClick:H,"aria-label":"Remove reference image",children:a.jsx(zo,{className:"h-4 w-4"})})]}):a.jsxs("label",{htmlFor:"visualizer-reference-image-input",className:"mt-1 flex flex-col justify-center items-center w-full h-40 md:h-48 px-6 py-5 border-2 border-dashed rounded-md cursor-pointer hover:border-primary transition-colors",children:[a.jsx(Fo,{className:"mx-auto h-8 md:h-10 w-8 md:w-10 text-muted-foreground mb-2"}),a.jsx("span",{className:"font-semibold text-primary text-sm",children:"Click to upload image"}),a.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG, GIF, WEBP"}),a.jsx(nt,{id:"visualizer-reference-image-input",type:"file",className:"sr-only",accept:"image/*",onChange:ee})]})]}),h.length>0&&a.jsxs("div",{children:[a.jsx(Re,{className:"text-md font-medium block mb-1",children:"2. Add Other Products (Optional)"}),a.jsx(Gi,{className:"h-32 md:h-40 border rounded-md p-2",children:a.jsx("div",{className:"space-y-1.5",children:h.map(z=>a.jsxs("div",{className:`flex items-center justify-between p-2 rounded-md cursor-pointer transition-all text-sm ${m.some(Y=>Y.id===z.id)?"bg-primary/10 ring-1 ring-primary":"hover:bg-muted/50"}`,onClick:()=>X(z),role:"checkbox","aria-checked":m.some(Y=>Y.id===z.id),tabIndex:0,onKeyDown:Y=>(Y.key==="Enter"||Y.key===" ")&&X(z),children:[a.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[a.jsx("img",{src:z.image.src.medium,alt:z.name,className:"w-8 h-8 object-cover rounded flex-shrink-0"}),a.jsx("span",{className:"truncate",title:z.name,children:z.name})]}),m.some(Y=>Y.id===z.id)&&a.jsx(uo,{className:"h-4 w-4 text-primary flex-shrink-0"})]},z.id))})})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"visualizer-product-color",className:"text-md font-medium block mb-1",children:"3. Main Product Color (Optional)"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nt,{type:"color",id:"visualizer-product-color",value:M,onChange:z=>j(z.target.value),className:"w-12 h-10 p-1"}),a.jsx(nt,{type:"text",value:M,onChange:z=>j(z.target.value),placeholder:"#FFFFFF",className:"flex-grow h-10 text-sm"})]})]}),t.variants&&t.variants.length>0&&a.jsxs("div",{children:[a.jsx(Re,{className:"text-md font-medium block mb-1",children:"3. Main Product Variants (Optional)"}),a.jsx("div",{className:"space-y-2",children:t.variants.map(z=>!z.name||!z.values||z.values.length===0?null:a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`visualizer-variant-${z.name}`,className:"text-sm text-muted-foreground",children:z.name}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:z.values.map(Y=>a.jsx(V,{variant:C[z.name]===Y?"default":"outline",size:"xs",onClick:()=>T(F=>({...F,[z.name]:Y})),className:"text-xs px-2 py-1 h-auto",children:Y},Y))})]},z.name))})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"visualizer-custom-prompt",className:"text-md font-medium block mb-1",children:t.variants&&t.variants.length>0?"5. Additional Custom Instructions (Optional)":"4. Custom Instructions (Optional)"}),a.jsx(Ln,{id:"visualizer-custom-prompt",placeholder:"e.g., 'place the sofa by the window', 'make it a sunny day'",value:S,onChange:z=>I(z.target.value),rows:2,className:"resize-none text-sm"})]}),a.jsxs(V,{onClick:O,disabled:v||!l,className:"w-full py-2.5 text-sm md:text-base",size:"lg",children:[v?a.jsx(St,{className:"mr-2 h-5 w-5 animate-spin"}):a.jsx(_a,{className:"mr-2 h-5 w-5"}),"Generate Visualization"]})]}),a.jsx("div",{className:"flex flex-col items-center justify-center border rounded-md p-2 md:p-4 bg-muted/30 min-h-[250px] md:min-h-[300px] lg:min-h-full relative",children:v?a.jsxs("div",{className:"text-center",children:[a.jsx(St,{className:"h-12 w-12 animate-spin text-primary mb-3"}),a.jsx("p",{className:"text-muted-foreground font-medium",children:D||"Generating your scene..."})]}):x?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:x,alt:"Generated Product Visualization",className:"max-w-full max-h-[calc(100%-40px)] object-contain rounded-md"}),D&&!D.toLowerCase().includes("error")&&a.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center max-w-xs mx-auto",children:D}),a.jsxs(V,{variant:"ghost",size:"sm",onClick:()=>U(!k),className:"absolute bottom-1 right-1 text-muted-foreground hover:text-primary h-auto p-1","aria-label":"Toggle prompt information",children:[a.jsx(Hse,{className:"h-4 w-4 mr-1"})," ",a.jsx("span",{className:"text-xs",children:"Info"})]})]}):a.jsxs("div",{className:"text-center text-muted-foreground p-4",children:[D&&a.jsx("p",{className:`text-sm mb-2 ${D.toLowerCase().includes("error")||D.toLowerCase().includes("failed")?"text-destructive":""}`,children:D}),a.jsx(_a,{className:"h-12 w-12 mx-auto mb-3"}),a.jsx("p",{className:"font-medium",children:"Your product visualization will appear here."}),!x&&a.jsx("p",{className:"text-xs mt-1",children:'Upload a reference scene and click "Generate".'})]})})]}),k&&P&&!n&&a.jsxs("div",{className:"mt-4 p-3 border rounded-md bg-muted/50",children:[a.jsx(Re,{className:"text-xs font-semibold text-muted-foreground",children:"Technical Prompt Sent to AI:"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1 whitespace-pre-wrap",children:P})]}),a.jsx(Sa,{className:"mt-6 md:mt-8 mb-0"})]})]})};var MW=p.forwardRef(({transition:t,...e},n)=>{let r={position:"absolute",top:0,left:0,width:"100%",height:"100%",transition:t?`clip-path ${t}`:void 0,userSelect:"none",willChange:"clip-path, transition",KhtmlUserSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none"};return a.jsx("div",{...e,style:r,"data-rcs":"clip-item",ref:n})});MW.displayName="ContainerClip";var LW=p.forwardRef(({children:t,disabled:e,portrait:n,position:r,transition:s},i)=>{let o={position:"absolute",top:0,width:n?"100%":void 0,height:n?void 0:"100%",background:"none",border:0,padding:0,pointerEvents:"all",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",outline:0,transform:n?"translate3d(0, -50% ,0)":"translate3d(-50%, 0, 0)",transition:s?`${n?"top":"left"} ${s}`:void 0};return a.jsx("button",{ref:i,"aria-label":"Drag to move or focus and use arrow keys","aria-orientation":n?"vertical":"horizontal","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":r,"data-rcs":"handle-container",disabled:e,role:"slider",style:o,children:t})});LW.displayName="ThisHandleContainer";var rF=({flip:t})=>a.jsx("div",{className:"__rcs-handle-arrow",style:{width:0,height:0,borderTop:"8px solid transparent",borderRight:"10px solid",borderBottom:"8px solid transparent",transform:t?"rotate(180deg)":void 0}}),LRe=({className:t="__rcs-handle-root",disabled:e,buttonStyle:n,linesStyle:r,portrait:s,style:i,...o})=>{let l={display:"flex",flexDirection:s?"row":"column",placeItems:"center",height:"100%",cursor:e?"not-allowed":s?"ns-resize":"ew-resize",pointerEvents:"none",color:"#fff",...i},c={flexGrow:1,height:s?2:"100%",width:s?"100%":2,backgroundColor:"currentColor",pointerEvents:"auto",boxShadow:"0 0 4px rgba(0,0,0,.5)",...r},u={display:"grid",gridAutoFlow:"column",gap:8,placeContent:"center",flexShrink:0,width:56,height:56,borderRadius:"50%",borderStyle:"solid",borderWidth:2,pointerEvents:"auto",backdropFilter:"blur(7px)",WebkitBackdropFilter:"blur(7px)",backgroundColor:"rgba(0, 0, 0, 0.125)",boxShadow:"0 0 4px rgba(0,0,0,.35)",transform:s?"rotate(90deg)":void 0,...n};return a.jsxs("div",{...o,className:t,style:l,children:[a.jsx("div",{className:"__rcs-handle-line",style:c}),a.jsxs("div",{className:"__rcs-handle-button",style:u,children:[a.jsx(rF,{}),a.jsx(rF,{flip:!0})]}),a.jsx("div",{className:"__rcs-handle-line",style:c})]})},FW=(t=>(t.ARROW_LEFT="ArrowLeft",t.ARROW_RIGHT="ArrowRight",t.ARROW_UP="ArrowUp",t.ARROW_DOWN="ArrowDown",t))(FW||{}),FRe=({boxSizing:t="border-box",objectFit:e="cover",objectPosition:n="center center",...r}={})=>({display:"block",width:"100%",height:"100%",maxWidth:"100%",boxSizing:t,objectFit:e,objectPosition:n,...r}),ORe=t=>{let e=p.useRef(t);return p.useEffect(()=>{e.current=t}),e.current},kS=(t,e,n,r)=>{let s=p.useRef();p.useEffect(()=>{s.current=e},[e]),p.useEffect(()=>{if(!(n&&n.addEventListener))return;let i=o=>s.current&&s.current(o);return n.addEventListener(t,i,r),()=>{n.removeEventListener(t,i,r)}},[t,n,r])},VRe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect,$Re=(t,e)=>{let n=p.useRef(),r=p.useCallback(()=>{t.current&&n.current&&n.current.observe(t.current)},[t]);VRe(()=>(n.current=new ResizeObserver(([s])=>e(s.contentRect)),r(),()=>{n.current&&n.current.disconnect()}),[e,r])},Yy={capture:!1,passive:!0},jS={capture:!0,passive:!1},URe=t=>{t.preventDefault(),t.currentTarget.focus()},OW=p.forwardRef(({boundsPadding:t=0,browsingContext:e=globalThis,changePositionOnHover:n=!1,disabled:r=!1,handle:s,itemOne:i,itemTwo:o,keyboardIncrement:l="5%",onlyHandleDraggable:c=!1,onPositionChange:u,portrait:d=!1,position:h=50,style:f,transition:m,...g},x)=>{let E=p.useRef(null),v=p.useRef(null),_=p.useRef(null),S=p.useRef(h),[I,M]=p.useState(!1),[j,C]=p.useState(!0),T=p.useRef(!1),[P,A]=p.useState(),D=ORe(h),R=p.useCallback(function({x:z,y:Y,isOffset:F}){let ye=E.current,Se=_.current,De=v.current,{width:xe,height:Me,left:Ye,top:qe}=ye.getBoundingClientRect();if(xe===0||Me===0)return;let et=d?F?Y-qe-e.scrollY:Y:F?z-Ye-e.scrollX:z,We=Math.min(Math.max(et/(d?Me:xe)*100,0),100),mt=d?Me/(ye.offsetHeight||1):xe/(ye.offsetWidth||1),Le=t*mt/(d?Me:xe)*100,ve=Math.min(Math.max(We,Le*mt),100-Le*mt);S.current=We,Se.setAttribute("aria-valuenow",`${Math.round(S.current)}`),Se.style.top=d?`${ve}%`:"0",Se.style.left=d?"0":`${ve}%`,De.style.clipPath=d?`inset(${ve}% 0 0 0)`:`inset(0 0 0 ${ve}%)`,u&&u(S.current)},[t,u,d,e]);p.useEffect(()=>{let{width:z,height:Y}=E.current.getBoundingClientRect(),F=h===D?S.current:h;R({x:z/100*F,y:Y/100*F})},[t,h,d,D,R]);let k=p.useCallback(z=>{z.preventDefault(),!(r||z.button!==0)&&(R({isOffset:!0,x:z.pageX,y:z.pageY}),M(!0),C(!0))},[r,R]),U=p.useCallback(function(z){R({isOffset:!0,x:z.pageX,y:z.pageY}),C(!1)},[R]),B=p.useCallback(()=>{M(!1),C(!0)},[]),K=p.useCallback(({width:z,height:Y})=>{let{width:F,height:ye}=E.current.getBoundingClientRect();R({x:z/100*S.current*F/z,y:Y/100*S.current*ye/Y})},[R]),ee=p.useCallback(z=>{if(!Object.values(FW).includes(z.key))return;z.preventDefault(),C(!0);let{top:Y,left:F}=_.current.getBoundingClientRect(),{width:ye,height:Se}=E.current.getBoundingClientRect(),De=typeof l=="string"?parseFloat(l):l/ye*100,xe=d?z.key==="ArrowLeft"||z.key==="ArrowDown":z.key==="ArrowRight"||z.key==="ArrowUp",Me=Math.min(Math.max(xe?S.current+De:S.current-De,0),100);R({x:d?F:ye*Me/100,y:d?Se*Me/100:Y})},[l,d,R]);p.useEffect(()=>{A(c?_.current:E.current)},[c]),p.useEffect(()=>{let z=E.current,Y=()=>{I||B()};return n&&(z.addEventListener("pointermove",U,Yy),z.addEventListener("pointerleave",Y,Yy)),()=>{z.removeEventListener("pointermove",U),z.removeEventListener("pointerleave",Y)}},[n,U,B,I]),p.useEffect(()=>(I&&!T.current&&(e.addEventListener("pointermove",U,Yy),e.addEventListener("pointerup",B,Yy),T.current=!0),()=>{T.current&&(e.removeEventListener("pointermove",U),e.removeEventListener("pointerup",B),T.current=!1)}),[U,B,I,e]),p.useImperativeHandle(x,()=>({rootContainer:E.current,handleContainer:_.current,setPosition(z){let{width:Y,height:F}=E.current.getBoundingClientRect();R({x:Y/100*z,y:F/100*z})}}),[R]),$Re(E,K),kS("keydown",ee,_.current,jS),kS("click",URe,_.current,jS),kS("pointerdown",k,P,jS);let H=s||a.jsx(LRe,{disabled:r,portrait:d}),X=j?m:void 0,O={position:"relative",display:"flex",overflow:"hidden",cursor:I?d?"ns-resize":"ew-resize":void 0,touchAction:"none",userSelect:"none",KhtmlUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",...f};return a.jsxs("div",{...g,ref:E,style:O,"data-rcs":"root",children:[i,a.jsx(MW,{ref:v,transition:X,children:o}),a.jsx(LW,{disabled:r,portrait:d,position:Math.round(S.current),ref:_,transition:X,children:H})]})});OW.displayName="ReactCompareSlider";var AT=p.forwardRef(({style:t,...e},n)=>{let r=FRe(t);return a.jsx("img",{ref:n,...e,style:r,"data-rcs":"image"})});AT.displayName="ReactCompareSliderImage";const BRe=()=>{var le,Ie,Oe,ht,dt,W,J,se;const t=Ww(),e=t.storeName,n=G=>{if(typeof G!="string"||G.includes("://"))return!1;try{return btoa(atob(G))===G}catch{return!1}};let r=t.productId,s=r;if(n(r))try{s=atob(r)}catch(G){console.error("Failed to decode Base64 productId:",r,G)}const i=s,{getStoreByName:o,getProductById:l,updateProductImage:c,updateStore:u,isLoadingStores:d,viewMode:h,updateProductImagesArray:f}=$n(),m=h==="published",{toast:g}=Ls(),x=bi(),E=d_(),[v,_]=p.useState(null),[S,I]=p.useState(null),[M,j]=p.useState(1),[C,T]=p.useState({}),[P,A]=p.useState(null),[D,R]=p.useState(!1),[k,U]=p.useState(""),[B,K]=p.useState([]),[ee,H]=p.useState(!1),[X,O]=p.useState(!1),[z,Y]=p.useState(""),[F,ye]=p.useState(!1),[Se,De]=p.useState(!1),[xe,Me]=p.useState(""),[Ye,qe]=p.useState(!1),[et,We]=p.useState(""),[mt,Le]=p.useState(""),[ve,Je]=p.useState(""),[Xe,kt]=p.useState([]),[Gt,fn]=p.useState(!1),[sn,ae]=p.useState(null),[me,fe]=p.useState(""),[Ne,ne]=p.useState(""),[de,Ee]=p.useState(!1),[Qe,re]=p.useState(!1),Ve=G=>{let oe=G.split(","),we=oe[0].match(/:(.*?);/)[1],ke=atob(oe[1]),Ue=ke.length,_e=new Uint8Array(Ue);for(;Ue--;)_e[Ue]=ke.charCodeAt(Ue);return new Blob([_e],{type:we})},Te=async()=>{if(!ve||!S||!v){g({title:"Missing data",description:"Cannot generate angles without an active image, product, or store context.",variant:"destructive"});return}Ee(!0);try{const{base64ImageData:G,mimeType:oe}=await pt(ve),we=await rI(G,oe,S.name||"Product");if(we&&we.length>0){const ke=[];for(const Z of we)if(Z.startsWith("data:")){const ue=Ve(Z),ge=`angle-${Date.now()}-${Math.random().toString(36).substring(2,15)}.png`,Ae=`products/${v.id}/${S.id}/angles/${ge}`,je=Ud(Bd,Ae);await Vd(je,ue);const it=await $d(je);ke.push(it)}else ke.push(Z);const Ue=ke.map((Z,ue)=>({id:`angle-${S.id}-${Xe.length+ue}-${en()}`,src:{medium:Z,large:Z},alt:`${S.name} - Angle ${Xe.length+ue+1}`})),_e=[...Xe,...Ue];kt(_e);const Q=_e.map(Z=>Z.src.large||Z.src.medium);await f(v.id,S.id,Q),g({title:"Angles Generated & Stored",description:`${ke.length} new angle images added to gallery and storage.`})}else g({title:"No Angles Generated",description:"The AI did not return any new angle images.",variant:"default"})}catch(G){console.error("Error generating or storing angles on detail page:",G),g({title:"Angle Generation/Storage Failed",description:G.message,variant:"destructive"})}Ee(!1)},ut=async G=>{var ke,Ue;if(!v||!S)return;const oe=Xe.filter(_e=>_e.id!==G);if(oe.length===0){const _e=`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(S.name||"Product")}`;kt([{id:`placeholder-${S.id}`,src:{medium:_e,large:_e},alt:S.name||"Product image"}]),Je(_e)}else kt(oe),(ve===((ke=Xe.find(_e=>_e.id===G))==null?void 0:ke.src.large)||ve===((Ue=Xe.find(_e=>_e.id===G))==null?void 0:Ue.src.medium))&&Je(oe[0].src.large||oe[0].src.medium);const we=oe.map(_e=>_e.src.large||_e.src.medium).filter(_e=>!_e.includes("via.placeholder.com"));await f(v.id,S.id,we),g({title:"Image Deleted",description:"Image removed from gallery.",variant:"destructive"})},pt=p.useCallback(G=>new Promise((oe,we)=>{if(!G)return we(new Error("Image source is undefined or null."));if(G.startsWith("data:"))try{const ke=G.split(",");if(ke.length<2)throw new Error("Invalid data URL structure.");const Ue=ke[0],_e=ke[1],Q=Ue.match(/:(.*?);/);if(!Q||!Q[1])throw new Error("Could not parse MIME type from data URL.");const Z=Q[1];oe({base64ImageData:_e,mimeType:Z})}catch(ke){console.error("Error parsing data URL:",G,ke),we(new Error(`Invalid data URL format: ${ke.message}`))}else{const ke=new Image;ke.crossOrigin="Anonymous",ke.onload=()=>{const Ue=document.createElement("canvas");Ue.width=ke.naturalWidth,Ue.height=ke.naturalHeight,Ue.getContext("2d").drawImage(ke,0,0);try{const ue=Ue.toDataURL("image/png").split(",")[1];oe({base64ImageData:ue,mimeType:"image/png"})}catch(Q){console.error("Canvas toDataURL failed:",Q),we(new Error("Canvas toDataURL failed, possibly due to CORS or tainted canvas. "+Q.message))}},ke.onerror=Ue=>{console.error("Failed to load image from URL for conversion:",G,Ue),we(new Error("Failed to load image from URL for conversion."))},ke.src=G}}),[]),he=p.useCallback(async()=>{if(!z.trim()||!ve||!S||!v){g({title:"Missing data",description:"Active image, edit prompt, product, or store context is missing.",variant:"destructive"});return}ye(!0);try{const{base64ImageData:G,mimeType:oe}=await pt(ve),we=await $l(G,oe,z);if(we&&we.editedImageData&&we.newMimeType){const ke=`data:${we.newMimeType};base64,${we.editedImageData}`,Ue=Ve(ke),_e=`edited-${Date.now()}.png`,Q=`products/${v.id}/${S.id}/images/${_e}`,Z=Ud(Bd,Q);await Vd(Z,Ue);const ue=await $d(Z),ge={id:en(),src:{medium:ue,large:ue},alt:`${S.name} (edited: ${z.substring(0,20)}...)`,photographer:"Edited with Gemini AI via Firebase Storage"};await c(v.id,i,ge);const Ae=Xe.map(je=>je.src.medium===ve||je.src.large===ve?ge:je);Xe.some(je=>je.src.medium===ve||je.src.large===ve)||Ae.push(ge),kt(Ae),Je(ue),g({title:"Image Edited & Stored",description:"Product image updated and saved to storage."}),O(!1),Y("")}else throw new Error("AI did not return valid edited image data.")}catch(G){console.error("Error editing image or uploading to storage:",G),g({title:"Image Edit Failed",description:G.message,variant:"destructive"})}ye(!1)},[ve,z,S,v,i,c,Xe,g,pt,Ve]);p.useEffect(()=>{var oe,we,ke,Ue;if(d)return;const G=o(e);if(G){_(G);const _e=l(G.id,i);if(_e){I(_e),U(_e.name),Me(_e.video_url||""),We(_e.model_3d_url||""),Le(_e.model_3d_thumbnail_url||"");let Q=[];_e.images&&Array.isArray(_e.images)&&_e.images.length>0?Q=_e.images.map((ue,ge)=>({id:`gallery-img-${_e.id}-${ge}-${en()}`,src:{medium:ue,large:ue},alt:`${_e.name||"Product"} image ${ge+1}`})):_e.image&&_e.image.src?Q=[{id:_e.image.id||`gallery-img-${_e.id}-0-${en()}`,src:_e.image.src,alt:_e.image.alt||`${_e.name||"Product"} image`}]:Q=[{id:`placeholder-${_e.id||en()}`,src:{medium:`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(_e.name||"Product")}`,large:`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(_e.name||"Product")}`},alt:_e.name||"Product image"}],kt(Q),Je(((we=(oe=Q[0])==null?void 0:oe.src)==null?void 0:we.large)||((Ue=(ke=Q[0])==null?void 0:ke.src)==null?void 0:Ue.medium)||"");let Z=[];if(_e.options&&Array.isArray(_e.options)?Z=_e.options:_e.variants&&Array.isArray(_e.variants)&&_e.variants.length>0&&_e.variants[0].name&&_e.variants[0].values&&(Z=_e.variants),Z.length>0){const ue={};Z.forEach(ge=>{ge.values&&ge.values.length>0&&(ue[ge.name]=ge.values[0])}),T(ue)}}else g({title:"Product not found",description:`Product ID ${i} not found in store ${G.name}.`,variant:"destructive"}),x(`/${e}`)}else g({title:"Store not found",description:`Could not find store: ${e}`,variant:"destructive"}),x("/")},[e,i,o,l,x,g,d]),p.useEffect(()=>{var G,oe,we,ke,Ue;if(S&&Object.keys(C).length>0){if(((oe=(G=S.variants)==null?void 0:G.edges)==null?void 0:oe.length)>0){const _e=(we=S.variants.edges.find(Q=>!Q.node||!Q.node.selectedOptions?!1:Q.node.selectedOptions.every(Z=>C[Z.name]===Z.value)))==null?void 0:we.node;if(_e){A(_e);return}}}else S&&((Ue=(ke=S.variants)==null?void 0:ke.edges)==null?void 0:Ue.length)>0&&Object.keys(C).length},[S,C]);const be=G=>{const oe=parseInt(G.target.value);oe>0&&j(oe)},Fe=async()=>{if(!v||!S||!mn||Un===void 0||!Xt){g({title:"Error",description:"Product or store data is incomplete for checkout.",variant:"destructive"});return}re(!0);try{const G=Xe.map(Z=>Z.src.large||Z.src.medium).filter(Z=>Z&&!Z.includes("via.placeholder.com")&&!Z.startsWith("data:")).slice(0,8),oe=`${window.location.origin}/${e}/product/${r}`,ke=await sh(E,"createStripeProductAndPrice")({productName:S.name,description:S.description||`High-quality ${S.name}`,images:G.length>0?G:mn&&!mn.includes("via.placeholder.com")&&!mn.startsWith("data:")?[mn]:[],unitAmount:Math.round(Un*100),currency:Xt.toLowerCase(),url:oe,metadata:{productId:S.id,storeId:v.id,storeName:v.name}}),{stripeProductId:Ue,stripePriceId:_e,error:Q}=ke.data;if(Q)throw new Error(Q.message||"Failed to create Stripe product/price.");if(!Ue||!_e)throw new Error("Stripe Product ID or Price ID not received.");x("/checkout",{state:{stripeProductId:Ue,stripePriceId:_e,productName:S.name,productImage:{src:{medium:mn.startsWith("data:")?null:mn}},quantity:M,unitAmount:Math.round(Un*100),currency:Xt.toLowerCase(),storeId:v.id,storeName:v.name}})}catch(G){console.error("Error creating Stripe product/price or navigating:",G),g({title:"Checkout Setup Failed",description:G.message||"Could not prepare for checkout.",variant:"destructive"})}finally{re(!1)}},Pe=async()=>{if(k.trim()){H(!0);try{const G=await wa(k,5,"square");K(G)}catch(G){g({title:"Image search failed",description:G.message,variant:"destructive"})}H(!1)}},Yt=async()=>{if(!k.trim()||!v||!S){g({title:"Missing context",description:"Store or product context is missing for image generation.",variant:"destructive"});return}H(!0);try{const G=`Product image for: ${k}, ${(S==null?void 0:S.type)||(v==null?void 0:v.type)||"item"}`,oe=await j1(G);if(!oe||!oe.url||!oe.url.startsWith("data:"))throw new Error("AI did not return a valid base64 image data URL.");const we=`gemini-${Date.now()}.png`,ke=`products/${v.id}/${S.id}/images/${we}`,Ue=Ud(Bd,ke),Q=await(await fetch(oe.url)).blob();await Vd(Ue,Q);const Z=await $d(Ue),ue={id:Date.now().toString(),src:{medium:Z,large:Z},alt:oe.alt||k,photographer:"Gemini AI via Firebase Storage"};K(ge=>[ue,...ge.slice(0,4)]),g({title:"Image Generated & Stored",description:"Gemini AI generated an image, and it has been uploaded to storage."})}catch(G){console.error("Gemini image generation or storage upload failed:",G),g({title:"Gemini Process Failed",description:G.message,variant:"destructive"})}H(!1)},Ht=G=>{const oe=G.target.files[0];if(oe&&v&&S){H(!0);const we=`uploaded-${Date.now()}-${oe.name}`,ke=`products/${v.id}/${S.id}/images/${we}`,Ue=Ud(Bd,ke);Vd(Ue,oe).then(()=>$d(Ue)).then(_e=>{const Q={id:en(),src:{medium:_e,large:_e},alt:oe.name,photographer:"Uploaded by user via Firebase Storage"};K(Z=>[Q,...Z.slice(0,4)]),g({title:"Image Uploaded & Stored",description:`${oe.name} uploaded. Select it from the results to use.`})}).catch(_e=>{console.error("Error uploading image to Firebase Storage:",_e),g({title:"Storage Upload Failed",description:_e.message,variant:"destructive"})}).finally(()=>{H(!1)})}else oe&&(g({title:"Missing context",description:"Store or product context is missing for image upload.",variant:"destructive"}),H(!1))},Tt=async G=>{if(!v||!S)return;const oe=v.products.map(we=>we.id===i?{...we,video_url:G}:we);try{v&&v.id?(await u(v.id,{products:oe}),Me(G),g({title:"Product Video Generated",description:"The video has been added to the product."})):g({title:"Error",description:"Store ID not available for video update.",variant:"destructive"})}catch(we){console.error("Failed to update store with product video:",we),g({title:"Update Failed",description:"Could not save the product video.",variant:"destructive"})}},yt=async G=>{if(!v||!S)return;const oe=v.products.map(we=>we.id===i?{...we,model_3d_url:G,model_3d_thumbnail_url:G}:we);try{v&&v.id?(await u(v.id,{products:oe}),We(G),Le(G),g({title:"3D Model Generated",description:"The 3D model has been added to the product."})):g({title:"Error",description:"Store ID not available for 3D model update.",variant:"destructive"})}catch(we){console.error("Failed to update store with 3D model:",we),g({title:"Update Failed",description:"Could not save the 3D model.",variant:"destructive"})}},Ft=G=>{if(v&&v.id&&S&&G&&G.src&&(G.src.medium||G.src.large)){const oe=G.src.large||G.src.medium;if(oe.startsWith("https://firebasestorage.googleapis.com")||oe.startsWith("http://localhost:")||oe.startsWith("https://images.pexels.com")){const we={id:G.id||en(),src:{medium:oe,large:oe},alt:G.alt||S.name,photographer:G.photographer||"User"};if(c(v.id,i,we),!Xe.find(Ue=>Ue.src.medium===oe||Ue.src.large===oe)){const Ue={...we,id:we.id||en()};kt(_e=>{const Q=_e.filter(Z=>!Z.src.medium.includes("via.placeholder.com"));return[Ue,...Q.filter(Z=>Z.src.medium!==oe)]})}Je(oe),g({title:"Image Selected",description:"Product image updated."})}else g({title:"Invalid Image URL",description:"Selected image does not have a valid storage or Pexels URL.",variant:"destructive"})}else g({title:"Error",description:"Cannot select image. Store, product, or image data missing.",variant:"destructive"});R(!1),K([])};if(d||!v||!S)return a.jsxs("div",{className:"min-h-screen flex items-center justify-center",children:[a.jsx(St,{className:"h-12 w-12 animate-spin text-primary"}),a.jsx("p",{className:"ml-4 text-muted-foreground",children:"Loading product details..."})]});const Sn=Xe.find(G=>G.src.large===ve||G.src.medium===ve),mn=ve||((Ie=(le=S.image)==null?void 0:le.src)==null?void 0:Ie.large)||((ht=(Oe=S.image)==null?void 0:Oe.src)==null?void 0:ht.medium)||`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(S.name)}`,xr=(Sn==null?void 0:Sn.alt)||((dt=S.image)==null?void 0:dt.alt)||S.name,Un=((W=P==null?void 0:P.price)==null?void 0:W.amount)!==void 0?parseFloat(P.price.amount):S.price,Xt=((J=P==null?void 0:P.price)==null?void 0:J.currencyCode)||S.currencyCode||"USD";let nn;S.inventory_count!==void 0?nn=S.inventory_count:S.stock!==void 0?nn=S.stock:nn=S.availableForSale?1:0;const Bn=((se=v==null?void 0:v.theme)==null?void 0:se.primaryColor)||"#000000";let q=[];S&&(S.options&&Array.isArray(S.options)?q=S.options.map(G=>({...G,name:G.name,values:G.values})):S.variants&&Array.isArray(S.variants)&&S.variants.length>0&&S.variants[0].name&&S.variants[0].values&&(q=S.variants.map(G=>({...G,name:G.name,values:G.values}))));const te=async()=>{if(!S||!ve||Object.keys(C).length===0){g({title:"Cannot Visualize",description:"Product data, main image, or selected variants missing.",variant:"destructive"});return}fn(!0),ae(null),ne(ve);try{const{base64ImageData:G,mimeType:oe}=await pt(ve);let we=[];for(const Q in C)we.push(`${Q}: ${C[Q]}`);const ke=we.join(", "),Ue=`Visualize the product "${S.name}" with the following attributes: ${ke}. Apply these changes to the provided image.`,_e=await $l(G,oe,Ue);if(_e&&_e.editedImageData&&_e.newMimeType&&typeof _e.newMimeType=="string"&&_e.newMimeType.includes("/")){const Q=`data:${_e.newMimeType};base64,${_e.editedImageData}`,Z={id:`visualized-${en()}`,src:{medium:Q,large:Q},alt:`${S.name} visualized with ${ke}`,photographer:"Variant Visualization by Gemini AI"};kt(ue=>[Z,...ue]),fe(Z.src.medium||Z.src.large),g({title:"Variant Visualized",description:"Comparison slider generated below."})}else{let Q="AI image generation failed: ";throw _e?_e.editedImageData?_e.newMimeType?Q+=`Invalid MIME type from AI ('${_e.newMimeType}').`:Q+="Missing MIME type from AI.":Q+="Missing image data from AI.":Q+="No result from AI.",new Error(Q)}}catch(G){console.error("Error visualizing variant:",G),ae(G.message),g({title:"Visualization Failed",description:G.message,variant:"destructive"})}fn(!1)};return a.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[a.jsx(NW,{store:v,isPublishedView:m}),a.jsxs(Ct.main,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"container mx-auto px-4 py-8 md:py-12 flex-grow",children:[a.jsxs(V,{variant:"outline",onClick:()=>x(`/${e}`),className:"mb-6",children:[a.jsx(Vl,{className:"mr-2 h-4 w-4"})," Back to Store"]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12",children:[a.jsxs(Ct.div,{initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},className:"flex flex-col items-center",children:[a.jsxs("div",{className:"relative group w-full",children:[a.jsx("img",{src:mn,alt:xr,className:"w-full h-auto aspect-square object-cover rounded-xl shadow-lg border"},ve),!m&&a.jsxs(a.Fragment,{children:[a.jsxs(V,{variant:"secondary",onClick:()=>R(!0),className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(iie,{className:"mr-2 h-4 w-4"})," Change Image"]}),a.jsxs(V,{variant:"outline",size:"sm",onClick:()=>O(!0),className:"absolute top-16 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(wv,{className:"mr-2 h-4 w-4"})," Edit Image"]}),a.jsxs(V,{variant:"outline",size:"sm",onClick:()=>De(!0),className:"absolute top-28 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(pie,{className:"mr-2 h-4 w-4"})," Gen Video"]}),a.jsxs(V,{variant:"outline",size:"sm",onClick:()=>qe(!0),className:"absolute top-40 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(Mse,{className:"mr-2 h-4 w-4"})," Gen 3D"]})]})]}),Xe.length>0&&a.jsxs(Ct.div,{className:"mt-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2,duration:.5},children:[a.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 gap-2",children:Xe.map((G,oe)=>a.jsxs(Ct.div,{className:"relative group",whileHover:{scale:1.05},children:[a.jsx("div",{className:`aspect-square rounded-md overflow-hidden cursor-pointer border-2 transition-all hover:opacity-80
                                    ${G.src.large===ve||G.src.medium===ve?"border-primary shadow-sm":"border-transparent"}`,onClick:()=>Je(G.src.large||G.src.medium),children:a.jsx("img",{src:G.src.medium||G.src.large,alt:G.alt||`Product image ${oe+1}`,className:"w-full h-full object-cover"})}),!m&&Xe.length>1&&!G.src.medium.includes("via.placeholder.com")&&a.jsx(V,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:we=>{we.stopPropagation(),ut(G.id)},"aria-label":"Delete image",children:a.jsx(er,{className:"h-3 w-3"})})]},G.id||`gallery-${oe}`))}),!m&&ve&&!ve.includes("via.placeholder.com")&&a.jsxs(V,{variant:"outline",size:"sm",className:"mt-3 w-full",onClick:Te,disabled:de,children:[de?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Wse,{className:"mr-2 h-4 w-4"}),"Generate More Angles from Active Image"]})]})]}),xe&&a.jsx(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"md:col-span-2 lg:col-span-1 aspect-video rounded-xl overflow-hidden shadow-lg border relative mt-4 md:mt-0",children:a.jsx("video",{src:xe,controls:!0,autoPlay:!1,loop:!0,playsInline:!0,className:"w-full h-full object-cover",poster:mn,children:"Your browser does not support the video tag."},xe)}),a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"space-y-6",children:[a.jsx("h1",{className:"text-3xl lg:text-4xl font-bold tracking-tight text-foreground",children:S.name}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"flex items-center",children:[...Array(5)].map((G,oe)=>a.jsx(M$,{className:`h-5 w-5 ${oe<Math.floor(S.rating)?"text-amber-400 fill-amber-400":"text-muted-foreground/30"}`},oe))}),a.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",S.rating," reviews)"]}),a.jsx(Sa,{orientation:"vertical",className:"h-5"}),a.jsx(Fp,{variant:"outline",style:{borderColor:v.theme.primaryColor,color:v.theme.primaryColor},children:nn>0?`In Stock (${nn})`:"Out of Stock"})]}),a.jsxs("p",{className:"text-2xl lg:text-3xl font-semibold",style:{color:v.theme.primaryColor},children:[Xt," ",Un.toFixed(2)]}),q.length>0&&a.jsxs("div",{className:"space-y-4 pt-4",children:[q.map(G=>a.jsxs("div",{children:[a.jsxs(Re,{className:"text-sm font-medium text-foreground",children:[G.name,":",a.jsx("span",{className:"text-muted-foreground font-normal ml-1",children:C[G.name]||""})]}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:G.values.map(oe=>a.jsx(V,{variant:C[G.name]===oe?"default":"outline",size:"sm",onClick:()=>{T(we=>({...we,[G.name]:oe}))},style:C[G.name]===oe?{backgroundColor:Bn,color:"white",borderColor:Bn}:{borderColor:v.theme.secondaryColor||"#cccccc",color:v.theme.secondaryColor||"#333333"},children:oe},oe))})]},G.name)),q.length>0&&Object.keys(C).length>0&&a.jsxs("div",{className:"mt-4 w-full",children:[me&&Ne&&a.jsx("div",{className:"mb-3 flex justify-center",children:a.jsx(OW,{itemOne:a.jsx(AT,{src:Ne,alt:"Original Image"}),itemTwo:a.jsx(AT,{src:me,alt:"Visualized Variant"}),className:"w-full max-w-md h-auto aspect-square rounded-md border shadow-md"})}),a.jsxs(V,{onClick:te,disabled:Gt,className:"w-full",variant:"outline",children:[Gt?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Cl,{className:"mr-2 h-4 w-4"}),"Visualize Variant"]}),sn&&a.jsx("p",{className:"text-red-500 text-xs mt-2",children:sn})]})]}),a.jsx("div",{className:"prose prose-sm sm:prose dark:prose-invert max-w-none text-muted-foreground pt-4",children:a.jsx("p",{children:S.description})}),S.tags&&S.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:S.tags.map(G=>a.jsx(Fp,{variant:"secondary",children:G},G))}),a.jsx(Sa,{className:"my-6"}),a.jsxs("div",{className:"flex items-end gap-4 pt-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Re,{htmlFor:"quantity",className:"text-sm",children:"Quantity"}),a.jsx(nt,{id:"quantity",type:"number",value:M,onChange:be,min:"1",max:nn,className:"w-20 h-10 text-center",disabled:nn===0})]}),a.jsxs(V,{size:"lg",onClick:Fe,className:"flex-1 h-10",style:{backgroundColor:Bn,color:"white"},disabled:nn===0,children:[a.jsx(dp,{className:"mr-2 h-5 w-5"}),Qe?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):null,nn===0?"Out of Stock":Qe?"Processing...":"Proceed to Checkout"]})]})]})]}),et&&a.jsxs(Ct.div,{className:"mt-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 text-foreground",children:"3D Model"}),a.jsx(DRe,{modelUrl:et,thumbnailUrl:mt,productName:S.name,height:"500px",className:"w-full"})]}),S&&v&&v.id&&a.jsx(Ct.div,{className:"mt-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.5},children:a.jsx(MRe,{product:S,storeId:v.id,isPublishedView:m})})]}),a.jsx(PW,{store:v,isPublishedView:m}),!m&&a.jsxs(a.Fragment,{children:[a.jsx(ys,{open:D,onOpenChange:R,children:a.jsxs(es,{className:"sm:max-w-2xl",children:[a.jsx(ts,{children:a.jsx(ns,{children:"Change Product Image"})}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(nt,{placeholder:"Search Pexels or describe for AI...",value:k,onChange:G=>U(G.target.value)}),a.jsxs(V,{onClick:Pe,disabled:ee||!k.trim(),children:[ee&&B.length===0?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(zse,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Pexels"})]}),a.jsxs(V,{onClick:Yt,variant:"outline",disabled:ee||!k.trim(),children:[ee&&B.length>0?a.jsx(St,{className:"h-4 w-4 animate-spin"}):a.jsx(Cl,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Gemini"})]}),a.jsxs(V,{variant:"outline",onClick:()=>{var G;return(G=document.getElementById("upload-image-input"))==null?void 0:G.click()},disabled:ee,children:[a.jsx(Fo,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Upload"})]}),a.jsx(nt,{type:"file",id:"upload-image-input",className:"hidden",accept:"image/*",onChange:Ht})]}),ee&&B.length===0&&a.jsx("p",{className:"text-center text-sm text-muted-foreground",children:"Searching for images or processing upload..."}),B.length>0&&a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-80 overflow-y-auto",children:B.map(G=>a.jsxs(Ct.div,{className:"relative aspect-square rounded-md overflow-hidden cursor-pointer group border-2 border-transparent hover:border-primary transition-all",onClick:()=>Ft(G),whileHover:{scale:1.05},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},children:[a.jsx("img",{src:G.src.medium,alt:G.alt||"Search result",className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(zRe,{className:"h-8 w-8 text-white"})}),a.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/70 text-white text-xs p-1 truncate",children:G.photographer||G.alt})]},G.id))})]}),a.jsx(Tr,{children:a.jsx(ba,{asChild:!0,children:a.jsx(V,{type:"button",variant:"outline",children:"Cancel"})})})]})}),a.jsx(ys,{open:X,onOpenChange:O,children:a.jsxs(es,{className:"sm:max-w-md",children:[a.jsx(ts,{children:a.jsx(ns,{children:"Edit Product Image"})}),a.jsxs("div",{className:"space-y-4 py-4",children:[S&&ve&&a.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[a.jsx("img",{src:ve,alt:"Current product to edit",className:"h-20 w-20 object-cover rounded border"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Editing: ",S.name]})]}),a.jsx(Re,{htmlFor:"editPrompt",className:"text-left",children:"Edit Instruction:"}),a.jsx(Ln,{id:"editPrompt",placeholder:"e.g., 'make the background blue', 'add sunglasses to the person'",value:z,onChange:G=>Y(G.target.value),rows:3,className:"resize-none"})]}),a.jsxs(Tr,{children:[a.jsx(ba,{asChild:!0,children:a.jsx(V,{type:"button",variant:"outline",disabled:F,children:"Cancel"})}),a.jsxs(V,{onClick:he,disabled:F||!z.trim(),children:[F?a.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Cl,{className:"mr-2 h-4 w-4"}),"Apply Edit"]})]})]})}),S&&a.jsx(CRe,{open:Se,onOpenChange:De,product:S,onVideoGenerated:Tt}),S&&a.jsx(jRe,{open:Ye,onOpenChange:qe,product:S,onModelGenerated:yt,storeId:v==null?void 0:v.id})]})]})},zRe=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),GRe=UP("pk_live_51NAoUjDktew9heHOJD5Px4jn9IaolhvVvqoE6NukJV7MxZa8PhIVSwcOVWXdQx6MFNgIGmEYeg64lFUGlYfAyVqu004n16tAdG"),HRe=()=>{var j,C,T,P,A,D;const t=Ma(),e=bi(),{getStoreById:n}=$n(),{toast:r}=Ls(),s=d_(),[i,o]=p.useState(null),[l,c]=p.useState("Your"),[u,d]=p.useState(null),[h,f]=p.useState(null),[m,g]=p.useState(!1),[x,E]=p.useState("");p.useEffect(()=>{const{stripePriceId:R,productName:k,productImage:U,quantity:B,unitAmount:K,currency:ee,storeId:H,storeName:X}=t.state||{};if(R&&k&&U&&B&&K&&ee&&H&&X){o({stripePriceId:R,name:k,image:U,quantity:parseInt(B,10),unitAmount:parseInt(K,10),currency:ee.toLowerCase()}),d(H),c(X);const O=n(H);f(O)}else r({title:"Checkout Error",description:"Missing product information for checkout. Redirecting...",variant:"destructive"}),e("/")},[t.state,e,r,n]);const v=i?i.unitAmount/100*i.quantity:0,_=v>0?5:0,S=v*.08,I=v+_+S,M=async R=>{if(R.preventDefault(),!i||!x.trim()){r({title:"Missing Information",description:"Please enter your email address.",variant:"destructive"});return}g(!0);try{const U=await sh(s,"createStripeCheckoutSession")({priceId:i.stripePriceId,quantity:i.quantity,customerEmail:x,successUrl:`${window.location.origin}/order-confirmation?session_id={CHECKOUT_SESSION_ID}&storeId=${u}`,cancelUrl:`${window.location.origin}/checkout?storeId=${u}&canceled=true`}),{sessionId:B,error:K}=U.data;if(K)throw new Error(K.message||"Failed to create checkout session.");if(!B)throw new Error("Checkout session ID not received.");const ee=await GRe,{error:H}=await ee.redirectToCheckout({sessionId:B});H&&(console.error("Stripe redirect error:",H),r({title:"Payment Error",description:H.message,variant:"destructive"}),g(!1))}catch(k){console.error("Error creating Stripe Checkout session:",k),r({title:"Checkout Failed",description:k.message||"Could not initiate payment.",variant:"destructive"}),g(!1)}};return!i&&!m?a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-900 dark:to-slate-900",children:[a.jsx(D$,{className:"h-24 w-24 text-primary mb-6"}),a.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Your Cart is Empty"}),a.jsx("p",{className:"text-muted-foreground mb-8",children:"There's nothing to check out yet."}),a.jsx(V,{asChild:!0,children:a.jsxs(Ns,{to:u?`/preview/${u}`:"/",children:[a.jsx(Vl,{className:"mr-2 h-4 w-4"})," Continue Shopping"]})})]}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-gray-800 dark:to-slate-800 py-8 px-4",children:a.jsxs(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"container mx-auto max-w-4xl",children:[a.jsxs(V,{variant:"ghost",onClick:()=>e(u?`/preview/${u}`:"/"),className:"mb-6 text-primary hover:text-primary/80",children:[a.jsx(Vl,{className:"mr-2 h-4 w-4"})," Back to ",l]}),a.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-center mb-8 text-gray-800 dark:text-gray-100",children:"Checkout"}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[a.jsxs(Ge,{className:"md:col-span-1 h-fit sticky top-8 shadow-lg",children:[a.jsxs(rt,{children:[a.jsx(st,{className:"text-xl",children:"Order Summary"}),a.jsxs(Wt,{children:["Review your item from ",l,"."]})]}),a.jsxs(Ze,{className:"space-y-4",children:[i&&a.jsxs("div",{className:"flex justify-between items-center text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:((C=(j=i.image)==null?void 0:j.src)==null?void 0:C.tiny)||((T=i.image)==null?void 0:T.medium)||((P=i.image)==null?void 0:P.large)||`https://via.placeholder.com/40x40.png?text=${(A=i.name)==null?void 0:A.substring(0,1)}`,alt:i.name,className:"w-10 h-10 rounded object-cover"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium line-clamp-1",children:i.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Qty: ",i.quantity]})]})]}),a.jsxs("p",{className:"font-medium",children:["$",(i.unitAmount/100*i.quantity).toFixed(2)]})]}),a.jsx(Sa,{}),a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Subtotal:"}),a.jsxs("span",{children:["$",v.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Shipping:"}),a.jsxs("span",{children:["$",_.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Taxes (est.):"}),a.jsxs("span",{children:["$",S.toFixed(2)]})]})]}),a.jsx(Sa,{}),a.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{children:["$",I.toFixed(2)]})]})]})]}),a.jsxs("form",{onSubmit:M,className:"md:col-span-2 space-y-6",children:[a.jsxs(Ge,{className:"shadow-lg",children:[a.jsx(rt,{children:a.jsx(st,{className:"text-xl",children:"Contact Information"})}),a.jsx(Ze,{className:"grid grid-cols-1 gap-4",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx(Re,{htmlFor:"email",children:"Email Address"}),a.jsx(nt,{id:"email",name:"email",type:"email",placeholder:"you@example.com",value:x,onChange:R=>E(R.target.value),required:!0})]})})]}),a.jsxs(V,{type:"submit",size:"lg",className:"w-full text-lg",disabled:m||!x.trim(),style:{backgroundColor:((D=h==null?void 0:h.theme)==null?void 0:D.primaryColor)||"#3B82F6"},children:[m?a.jsx(St,{className:"mr-2 h-5 w-5 animate-spin"}):a.jsx(ki,{className:"mr-2 h-5 w-5"}),m?"Processing Payment...":`Pay $${I.toFixed(2)}`]})]})]})]})})},WRe="https://firebasestorage.googleapis.com/v0/b/themeforge-hui99.firebasestorage.app/o/ffwhite.png?alt=media&token=a2ebe18b-109c-4c55-b9e1-ec226a788632",qRe="https://firebasestorage.googleapis.com/v0/b/themeforge-hui99.firebasestorage.app/o/Ffblack%20(1).png?alt=media&token=cd13601d-6e44-41b9-9e25-35b6f510f99a",KRe="https://firebasestorage.googleapis.com/v0/b/themeforge-hui99.firebasestorage.app/o/Freshbg.png?alt=media&token=49d21eaa-1fd6-42d7-ae66-43067fb1f536";function YRe(){const[t,e]=p.useState(!0),[n,r]=p.useState(""),[s,i]=p.useState(!1),o=p.useRef(),l=p.useRef(),c=bi();p.useEffect(()=>{const d=localStorage.getItem("theme"),h=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;d==="dark"||!d&&h?(document.documentElement.classList.add("dark"),i(!0)):(document.documentElement.classList.remove("dark"),i(!1))},[]);const u=async d=>{r("");const h=o.current.value,f=l.current.value;if(!h||!f){r("Please enter both email and password.");return}try{let m;d==="login"?m=await zpe(mw,h,f):(m=await Bpe(mw,h,f),await Ox(Pi(_r,"profiles",m.user.uid),{id:m.user.uid,email:m.user.email,role:"store_owner",created_at:new Date})),c("/")}catch(m){console.error("Authentication error:",m.message),r(m.message)}};return a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-cover bg-center bg-no-repeat p-4",style:{backgroundImage:`url(${KRe})`},children:a.jsxs("div",{className:`w-full max-w-md p-8 md:p-10 space-y-6
                   bg-white/10 dark:bg-black/30 backdrop-blur-lg
                   shadow-2xl rounded-xl border border-white/20 dark:border-black/20`,children:[a.jsx("div",{className:"flex justify-center mb-6",children:a.jsx("img",{src:s?WRe:qRe,alt:"FreshFront Logo",className:"h-12 w-auto"})}),a.jsx("h2",{className:"text-center text-3xl font-extrabold text-white mb-6",children:t?"Sign In":"Sign Up"}),n&&a.jsx("p",{className:"text-red-500 text-center",children:n}),a.jsxs("form",{onSubmit:d=>{d.preventDefault(),u(t?"login":"signup")},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-white mb-1",children:"Email"}),a.jsx("input",{type:"email",id:"email",ref:o,required:!0,className:"w-full p-3 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"you@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-white mb-1",children:"Password"}),a.jsx("input",{type:"password",id:"password",ref:l,required:!0,className:"w-full p-3 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"••••••••"})]}),a.jsx("button",{type:"submit",className:"w-full bg-primary text-primary-foreground py-3 rounded-md font-semibold hover:bg-primary/90 transition-colors",children:t?"Sign In":"Sign Up"})]}),a.jsxs("p",{className:"text-center text-sm text-white pt-6",children:[t?"Don't have an account?":"Already have an account?"," ",a.jsx("button",{onClick:()=>e(!t),className:"text-primary hover:underline font-medium",children:t?"Sign Up":"Sign In"})]})]})})}const JRe=()=>{const{isAuthenticated:t,user:e}=qi();return a.jsxs(a.Fragment,{children:[a.jsx(BP,{}),a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Our Plan"}),a.jsx("p",{children:"Get full access to all store creation and management features."}),a.jsxs("div",{style:{border:"1px solid #ccc",padding:"20px",margin:"20px auto",maxWidth:"400px",borderRadius:"8px"},children:[a.jsx("h2",{children:"Store Creator Plan"}),a.jsx("p",{style:{fontSize:"2em",fontWeight:"bold",margin:"10px 0"},children:"$24.99 / month"}),a.jsxs("ul",{children:[a.jsx("li",{children:"Full access to publishing"}),a.jsx("li",{children:"Accept payments for your store"}),a.jsx("li",{children:"Unlimited products"}),a.jsx("li",{children:"And more!"})]}),t?a.jsx(fT,{}):a.jsxs("p",{children:["Please ",a.jsx(Ns,{to:"/auth",children:"log in or sign up"})," to subscribe."]})]})]})]})};function XRe(){return new URLSearchParams(Ma().search)}const QRe=()=>{const e=XRe().get("session_id");p.useState(null);const[n,r]=p.useState(!0),[s,i]=p.useState(null);return p.useEffect(()=>{if(!e){i("No session ID found. Your order might still be processing."),r(!1);return}r(!1)},[e]),n?a.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"Loading order details..."}):s?a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Order Status"}),a.jsx("p",{style:{color:"red"},children:s}),a.jsx(Ns,{to:"/",children:"Go to Homepage"})]}):a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Thank You for Your Order!"}),a.jsx("p",{children:"Your payment was successful and your order is being processed."}),a.jsxs("p",{children:["Order (Session ID): ",e]}),a.jsx("p",{children:"You will receive an email confirmation shortly."}),a.jsx(Ns,{to:"/",children:"Continue Shopping"})]})},ZRe=()=>{const{isGenerating:t,progress:e,statusMessage:n}=$n();return a.jsx(_h,{children:t&&a.jsx(Ct.div,{initial:{y:"-100%",opacity:0},animate:{y:"20px",opacity:1},exit:{y:"-100%",opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"fixed top-0 left-0 right-0 flex justify-center z-[9999] p-4",children:a.jsxs(Ge,{className:"shadow-2xl rounded-xl overflow-hidden w-full max-w-md",children:[" ",a.jsxs(Ze,{className:"p-6 space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Store Generation"}),a.jsxs("p",{className:"text-sm font-semibold text-blue-600 dark:text-blue-400",children:[Math.floor(e),"%"]})]}),a.jsx(dA,{value:e,className:"w-full h-2 [&>div]:bg-blue-600"}),a.jsx("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 pt-1 min-h-[1.2em]",children:n||"Processing..."})]})]})})})},eke=()=>a.jsxs(B_e,{children:[a.jsx(ZRe,{})," ",a.jsxs("main",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-900 dark:to-slate-900",children:[a.jsx(OJ,{})," ",a.jsx(Sie,{}),a.jsx(EW,{})," "]})]});const tke=({children:t,activeTab:e,setActiveTab:n,storeId:r,storeName:s})=>{const[i,o]=p.useState(""),[l,c]=p.useState([]),u=[{id:"orders",label:"Orders",icon:a.jsx(dp,{className:"h-5 w-5"})},{id:"products",label:"Products",icon:a.jsx(ui,{className:"h-5 w-5"})},{id:"customers",label:"Customers",icon:a.jsx(r0,{className:"h-5 w-5"})},{id:"payments",label:"Payments",icon:a.jsx(ki,{className:"h-5 w-5"})},{id:"analytics",label:"Analytics",icon:a.jsx(vv,{className:"h-5 w-5"})},{id:"marketing",label:"Marketing",icon:a.jsx(Rd,{className:"h-5 w-5"})},{id:"shipping",label:"Shipping",icon:a.jsx(Sv,{className:"h-5 w-5"})},{id:"settings",label:"Settings",icon:a.jsx(up,{className:"h-5 w-5"})}],d=u.map(m=>({id:m.id,label:m.label,tab:m.id})),h=m=>{const g=m.target.value;if(o(g),g.trim()===""){c([]);return}const x=g.toLowerCase(),E=[];d.forEach(v=>{v.label.toLowerCase().includes(x)&&E.push({id:`${v.id}-main`,label:v.label,tab:v.tab}),v.subItems&&v.subItems.forEach(_=>{_.label.toLowerCase().includes(x)&&E.push({id:_.id,label:`${v.label} > ${_.label}`,tab:v.tab})})}),c(E)},f=m=>{n(m.tab),o(""),c([])};return a.jsxs("div",{className:"flex h-screen bg-muted/40",children:[" ",a.jsxs("div",{className:"w-64 bg-card border-r border-border flex flex-col",children:[" ",a.jsxs("div",{className:"p-4 border-b flex items-center gap-2",children:[" ",s&&a.jsx(V,{asChild:!0,variant:"outline",size:"icon",className:"flex-shrink-0",children:a.jsxs(Ns,{to:`/${s}`,children:[" ",a.jsx(Vl,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Back to Store"})]})}),a.jsxs("div",{className:"relative flex-grow",children:[" ",a.jsx(Jd,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),a.jsx(nt,{type:"text",placeholder:"Search dashboard...",className:"pl-9 w-full",value:i,onChange:h}),l.length>0&&a.jsxs(Ge,{className:"absolute mt-1 w-full z-50 max-h-64 overflow-y-auto shadow-lg",children:[" ",a.jsxs("div",{className:"p-1",children:[" ",l.map(m=>a.jsx("button",{className:"w-full text-left px-3 py-1.5 hover:bg-accent rounded-md text-sm",onClick:()=>f(m),children:m.label},m.id))]})]})]})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:[" ",u.map(m=>a.jsxs(V,{variant:e===m.id?"secondary":"ghost",className:"w-full justify-start text-left h-10 px-3",onClick:()=>n(m.id),children:[a.jsx("span",{className:"mr-3",children:m.icon})," ",m.label]},m.id))]}),a.jsx("div",{className:"p-4 border-t",children:a.jsx(V,{variant:"ghost",className:"w-full justify-start text-left",children:"Help & Support"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[" ",t]})]})},sF=()=>{const[t,e]=p.useState("all"),n=[{id:"ORD-1234",customer:"John Doe",date:"2023-05-15",total:"$129.99",status:"Fulfilled"},{id:"ORD-1235",customer:"Jane Smith",date:"2023-05-14",total:"$89.50",status:"Processing"},{id:"ORD-1236",customer:"Robert Johnson",date:"2023-05-13",total:"$210.75",status:"Pending"}],r=[{id:"CART-567",customer:"Emily Davis",date:"2023-05-15",items:3,total:"$78.45",timeSpent:"12m 30s"},{id:"CART-568",customer:"Michael Brown",date:"2023-05-14",items:2,total:"$45.99",timeSpent:"5m 15s"}],s=[{id:"RET-890",orderId:"ORD-1230",customer:"Sarah Wilson",date:"2023-05-10",amount:"$65.00",reason:"Wrong size"},{id:"RET-891",orderId:"ORD-1228",customer:"David Miller",date:"2023-05-09",amount:"$120.50",reason:"Damaged item"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Orders"}),a.jsxs(Ei,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(Qs,{className:"grid grid-cols-4 mb-6",children:[a.jsxs(Bt,{value:"all",children:[a.jsx(dp,{className:"mr-2 h-4 w-4"}),"All Orders"]}),a.jsxs(Bt,{value:"abandoned",children:[a.jsx(Wp,{className:"mr-2 h-4 w-4"}),"Abandoned Checkouts"]}),a.jsxs(Bt,{value:"returns",children:[a.jsx(bv,{className:"mr-2 h-4 w-4"}),"Returns & Refunds"]}),a.jsxs(Bt,{value:"fulfillment",children:[a.jsx(ui,{className:"mr-2 h-4 w-4"}),"Order Fulfillment"]})]}),a.jsx(zt,{value:"all",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"All Orders"}),a.jsx(Wt,{children:"View and manage all customer orders"})]}),a.jsx(Ze,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="Fulfilled"?"bg-green-100 text-green-800":i.status==="Processing"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:i.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(V,{variant:"outline",size:"sm",children:"View"})})]},i.id))})]})})})]})}),a.jsx(zt,{value:"abandoned",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Abandoned Checkouts"}),a.jsx(Wt,{children:"View details of abandoned shopping carts"})]}),a.jsx(Ze,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Cart ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Items"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Time Spent"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.items}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:i.timeSpent}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(V,{variant:"outline",size:"sm",children:"View Details"})})]},i.id))})]})})})]})}),a.jsx(zt,{value:"returns",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Returns & Refunds"}),a.jsx(Wt,{children:"Manage customer returns and process refunds"})]}),a.jsx(Ze,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Return ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.orderId}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.amount}),a.jsx("td",{className:"py-3 px-4",children:i.reason}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(V,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(V,{variant:"outline",size:"sm",children:"Process"})]})]},i.id))})]})})})]})}),a.jsx(zt,{value:"fulfillment",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Order Fulfillment"}),a.jsx(Wt,{children:"Manage and fulfill pending orders"})]}),a.jsx(Ze,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Fraud Risk"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer Score"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="Fulfilled"?"bg-green-100 text-green-800":i.status==="Processing"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:i.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Low"})}),a.jsxs("td",{className:"py-3 px-4",children:[Math.floor(Math.random()*100),"/100"]}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(V,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(V,{variant:"default",size:"sm",disabled:i.status==="Fulfilled",children:"Fulfill"})]})]},i.id))})]})})})]})})]})]})},nke=()=>{const[t,e]=p.useState("all"),n=[{id:"PRD-1234",name:"Premium T-Shirt",category:"Apparel",price:"$29.99",inventory:45,status:"Active"},{id:"PRD-1235",name:"Wireless Headphones",category:"Electronics",price:"$89.50",inventory:12,status:"Active"},{id:"PRD-1236",name:"Leather Wallet",category:"Accessories",price:"$49.99",inventory:0,status:"Out of Stock"}],r=[{id:"COL-567",name:"Summer Collection",products:12,type:"Manual",status:"Active"},{id:"COL-568",name:"Holiday Specials",products:8,type:"AI Generated",status:"Draft"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Products"}),a.jsxs(Ei,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(Qs,{className:"grid grid-cols-3 mb-6",children:[a.jsxs(Bt,{value:"all",children:[a.jsx(ui,{className:"mr-2 h-4 w-4"}),"All Products"]}),a.jsxs(Bt,{value:"inventory",children:[a.jsx(ym,{className:"mr-2 h-4 w-4"}),"Inventory"]}),a.jsxs(Bt,{value:"collections",children:[a.jsx(mb,{className:"mr-2 h-4 w-4"}),"Collections"]})]}),a.jsx(zt,{value:"all",children:a.jsxs(Ge,{children:[a.jsxs(rt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{children:"All Products"}),a.jsx(Wt,{children:"Manage your product catalog"})]}),a.jsxs(V,{children:[a.jsx(ui,{className:"mr-2 h-4 w-4"}),"Add Product"]})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"mb-4 flex items-center",children:[a.jsx(nt,{placeholder:"Search products...",className:"max-w-sm mr-2"}),a.jsx(V,{variant:"outline",children:"Search"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Category"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Price"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Inventory"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.category}),a.jsx("td",{className:"py-3 px-4",children:s.price}),a.jsx("td",{className:"py-3 px-4",children:s.inventory}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(V,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(V,{variant:"outline",size:"sm",children:"Delete"})]})]},s.id))})]})})]})]})}),a.jsx(zt,{value:"inventory",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Inventory Management"}),a.jsx(Wt,{children:"Track and update product inventory levels"})]}),a.jsx(Ze,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Current Stock"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Low Stock Alert"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.inventory}),a.jsx("td",{className:"py-3 px-4",children:"10"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.inventory>10?"bg-green-100 text-green-800":s.inventory>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.inventory>10?"In Stock":s.inventory>0?"Low Stock":"Out of Stock"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(V,{variant:"outline",size:"sm",children:"Update Stock"})})]},s.id))})]})})})]})}),a.jsx(zt,{value:"collections",children:a.jsxs(Ge,{children:[a.jsxs(rt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{children:"Collections"}),a.jsx(Wt,{children:"Organize products into collections"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(V,{variant:"outline",children:[a.jsx(mb,{className:"mr-2 h-4 w-4"}),"Create Manual Collection"]}),a.jsxs(V,{children:[a.jsx(mb,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]}),a.jsx(Ze,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Collection Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Products"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.products}),a.jsx("td",{className:"py-3 px-4",children:s.type}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(V,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(V,{variant:"outline",size:"sm",children:"Delete"})]})]},s.id))})]})})})]})})]})]})},rke=()=>{const t=[{id:"CUS-1234",name:"John Doe",email:"john.doe@example.com",orders:5,totalSpent:"$345.75",lastOrder:"2023-05-10",segment:"Loyal"},{id:"CUS-1235",name:"Jane Smith",email:"jane.smith@example.com",orders:2,totalSpent:"$129.50",lastOrder:"2023-04-22",segment:"New"},{id:"CUS-1236",name:"Robert Johnson",email:"robert.j@example.com",orders:8,totalSpent:"$780.25",lastOrder:"2023-05-15",segment:"VIP"}],e=[{id:"SEG-1",name:"New Customers",count:124,description:"Customers with 1-2 orders"},{id:"SEG-2",name:"Loyal Customers",count:86,description:"Customers with 3-7 orders"},{id:"SEG-3",name:"VIP Customers",count:32,description:"Customers with 8+ orders"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Customers"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:e.map(n=>a.jsxs(Ge,{children:[a.jsxs(rt,{className:"pb-2",children:[a.jsx(st,{className:"text-lg",children:n.name}),a.jsx(Wt,{children:n.description})]}),a.jsxs(Ze,{children:[a.jsx("div",{className:"text-3xl font-bold",children:n.count}),a.jsx(V,{variant:"link",className:"p-0",children:"View customers"})]})]},n.id))}),a.jsxs(Ge,{className:"mb-6",children:[a.jsxs(rt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{children:"Customer Insights"}),a.jsx(Wt,{children:"AI-generated insights about your customer base"})]}),a.jsxs(V,{variant:"outline",children:[a.jsx(sie,{className:"mr-2 h-4 w-4"}),"Generate New Insights"]})]}),a.jsx(Ze,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Demographics"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-card rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Demographics chart placeholder"})}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Your customer base is primarily 25-34 years old (45%), followed by 35-44 years old (30%). The gender distribution is 55% female and 45% male."})]}),a.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Geographic Distribution"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-card rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Geographic map placeholder"})}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Most of your customers are from California (25%), New York (18%), and Texas (12%). International customers make up 15% of your customer base."})]})]})})]}),a.jsxs(Ge,{children:[a.jsxs(rt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{children:"All Customers"}),a.jsx(Wt,{children:"View and manage your customer database"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(V,{variant:"outline",children:[a.jsx(ym,{className:"mr-2 h-4 w-4"}),"Add Tags"]}),a.jsxs(V,{children:[a.jsx(r0,{className:"mr-2 h-4 w-4"}),"Create Segment"]})]})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"mb-4 flex items-center",children:[a.jsx(nt,{placeholder:"Search customers...",className:"max-w-sm mr-2"}),a.jsx(V,{variant:"outline",children:"Search"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Email"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Orders"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total Spent"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Last Order"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Segment"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:t.map(n=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:n.id}),a.jsx("td",{className:"py-3 px-4",children:n.name}),a.jsx("td",{className:"py-3 px-4",children:n.email}),a.jsx("td",{className:"py-3 px-4",children:n.orders}),a.jsx("td",{className:"py-3 px-4",children:n.totalSpent}),a.jsx("td",{className:"py-3 px-4",children:n.lastOrder}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${n.segment==="VIP"?"bg-purple-100 text-purple-800":n.segment==="Loyal"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:n.segment})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(V,{variant:"outline",size:"sm",children:"View Profile"})})]},n.id))})]})})]})]})]})},ske=()=>{const[t,e]=p.useState("transactions"),{session:n,user:r}=qi(),[s,i]=p.useState(!1),[o,l]=p.useState(null),c=async()=>{if(!(n!=null&&n.access_token)||!r){l("Authentication token not found. Please log in again.");return}i(!0),l(null);try{const f=await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/create-stripe-connect-account",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n.access_token}`},body:JSON.stringify({record:{id:r.id,email:r.email}})}),m=await f.json();if(!f.ok){const g=m.error||m.data&&m.data.error||"Failed to create Stripe Connect account link.";throw new Error(g)}if(m.account_link_url)window.location.href=m.account_link_url;else if(m.url)window.location.href=m.url;else throw new Error("No URL returned from Stripe Connect account creation.")}catch(f){console.error("Stripe Connect account creation error:",f),l(f.message)}finally{i(!1)}},u=[{id:"TRX-1234",orderId:"ORD-1234",customer:"John Doe",date:"2023-05-15",amount:"$129.99",status:"Completed",method:"Credit Card"},{id:"TRX-1235",orderId:"ORD-1235",customer:"Jane Smith",date:"2023-05-14",amount:"$89.50",status:"Completed",method:"PayPal"},{id:"TRX-1236",orderId:"ORD-1236",customer:"Robert Johnson",date:"2023-05-13",amount:"$210.75",status:"Pending",method:"Credit Card"}],d=[{id:"PAY-567",date:"2023-05-15",amount:"$1,245.75",status:"Completed",destination:"Bank Account (****1234)"},{id:"PAY-568",date:"2023-05-01",amount:"$980.50",status:"Completed",destination:"Bank Account (****1234)"},{id:"PAY-569",scheduledDate:"2023-06-01",estimatedAmount:"$1,500.00",status:"Scheduled",destination:"Bank Account (****1234)"}],h=[{id:"DSP-890",transactionId:"TRX-1230",customer:"Sarah Wilson",date:"2023-05-10",amount:"$65.00",reason:"Item not received",status:"Under Review"},{id:"DSP-891",transactionId:"TRX-1228",customer:"David Miller",date:"2023-05-09",amount:"$120.50",reason:"Unauthorized charge",status:"Lost"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Payments & Payouts"}),a.jsxs(Ei,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(Qs,{className:"grid grid-cols-4 mb-6",children:[" ",a.jsxs(Bt,{value:"overview",children:[" ",a.jsx(Ad,{className:"mr-2 h-4 w-4"}),"Connect Account"]}),a.jsxs(Bt,{value:"transactions",children:[a.jsx(ki,{className:"mr-2 h-4 w-4"}),"Transactions"]}),a.jsxs(Bt,{value:"payouts",children:[a.jsx(U1,{className:"mr-2 h-4 w-4"}),"Payout Schedule"]}),a.jsxs(Bt,{value:"disputes",children:[a.jsx(Wp,{className:"mr-2 h-4 w-4"}),"Disputes & Chargebacks"]})]}),a.jsxs(zt,{value:"overview",children:[" ",a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Connect Stripe Account"}),a.jsx(Wt,{children:"Connect your Stripe account to start accepting payments and manage payouts."})]}),a.jsxs(Ze,{children:[a.jsxs(V,{onClick:c,disabled:s,children:[a.jsx(Ad,{className:"mr-2 h-4 w-4"}),s?"Connecting...":"Connect with Stripe"]}),o&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:o})]})]})]}),a.jsx(zt,{value:"transactions",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"All Transactions"}),a.jsx(Wt,{children:"View all payment transactions"})]}),a.jsx(Ze,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Transaction ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Method"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:u.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.orderId}),a.jsx("td",{className:"py-3 px-4",children:f.customer}),a.jsx("td",{className:"py-3 px-4",children:f.date}),a.jsx("td",{className:"py-3 px-4",children:f.amount}),a.jsx("td",{className:"py-3 px-4",children:f.method}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(V,{variant:"outline",size:"sm",children:"View Details"})})]},f.id))})]})})})]})}),a.jsx(zt,{value:"payouts",children:a.jsxs(Ge,{className:"mb-6",children:[a.jsxs(rt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{children:"Payout Schedule"}),a.jsx(Wt,{children:"Manage your payout schedule and instant transfers"})]}),a.jsxs(V,{children:[a.jsx(ki,{className:"mr-2 h-4 w-4"}),"Instant Transfer"]})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Current Balance"})}),a.jsxs(Ze,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$1,845.75"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Available for payout"})]})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Next Payout"})}),a.jsxs(Ze,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$1,500.00"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Scheduled for June 1, 2023"})]})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Payout Schedule"})}),a.jsxs(Ze,{children:[a.jsx("div",{className:"text-xl font-medium",children:"Monthly"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Every 1st of the month"}),a.jsx(V,{variant:"link",className:"p-0 mt-2",children:"Change schedule"})]})]})]}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Payout History"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Payout ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Destination"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:d.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.date||f.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:f.amount||f.estimatedAmount}),a.jsx("td",{className:"py-3 px-4",children:f.destination}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Completed"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(V,{variant:"outline",size:"sm",children:"View Details"})})]},f.id))})]})]})]})]})}),a.jsx(zt,{value:"disputes",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Disputes & Chargebacks"}),a.jsx(Wt,{children:"Manage payment disputes and chargebacks"})]}),a.jsx(Ze,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Dispute ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Transaction ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"AI Analysis"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:h.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.transactionId}),a.jsx("td",{className:"py-3 px-4",children:f.customer}),a.jsx("td",{className:"py-3 px-4",children:f.date}),a.jsx("td",{className:"py-3 px-4",children:f.amount}),a.jsx("td",{className:"py-3 px-4",children:f.reason}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Under Review"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:f.status==="Under Review"?a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"High chance of winning"}):a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"Insufficient evidence"})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(V,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),f.status==="Under Review"&&a.jsx(V,{variant:"default",size:"sm",children:"Respond"})]})]},f.id))})]})})})]})})]})]})},ike=()=>{const[t,e]=p.useState("sales");return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Analytics & Reports"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Total Sales"})}),a.jsxs(Ze,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$12,845.75"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(Tf,{className:"h-4 w-4 mr-1"})," +15% from last month"]})]})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Orders"})}),a.jsxs(Ze,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"156"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(Tf,{className:"h-4 w-4 mr-1"})," +8% from last month"]})]})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Conversion Rate"})}),a.jsxs(Ze,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"3.2%"}),a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(Tf,{className:"h-4 w-4 mr-1"})," -0.5% from last month"]})]})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Avg. Order Value"})}),a.jsxs(Ze,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$82.34"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(Tf,{className:"h-4 w-4 mr-1"})," +5% from last month"]})]})]})]}),a.jsxs(Ei,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(Qs,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(Bt,{value:"sales",children:[a.jsx(vv,{className:"mr-2 h-4 w-4"}),"Sales Reports"]}),a.jsxs(Bt,{value:"traffic",children:[a.jsx(Tf,{className:"mr-2 h-4 w-4"}),"Traffic & Conversion"]}),a.jsxs(Bt,{value:"customers",children:[a.jsx(r0,{className:"mr-2 h-4 w-4"}),"Customer Insights"]}),a.jsxs(Bt,{value:"marketing",children:[a.jsx(L$,{className:"mr-2 h-4 w-4"}),"Marketing Attribution"]}),a.jsxs(Bt,{value:"products",children:[a.jsx(ui,{className:"mr-2 h-4 w-4"}),"Product Performance"]})]}),a.jsx(zt,{value:"sales",children:a.jsxs(Ge,{children:[a.jsxs(rt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{children:"Sales Overview"}),a.jsx(Wt,{children:"Comprehensive sales data with AI summarization"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(V,{variant:"outline",children:"Export"}),a.jsx(V,{variant:"outline",children:"Print"})]})]}),a.jsxs(Ze,{children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"h-80 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Sales chart placeholder"})})}),a.jsxs(Ge,{className:"bg-muted/30",children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"AI Sales Summary"})}),a.jsxs(Ze,{children:[a.jsxs("p",{className:"text-sm",children:[a.jsx("strong",{children:"Key Insights:"}),' Your sales have increased by 15% compared to last month, with the highest growth in the "Electronics" category (+24%). Weekend sales are particularly strong, accounting for 45% of your weekly revenue. The average order value has increased by 5%, indicating customers are purchasing higher-value items.']}),a.jsxs("p",{className:"text-sm mt-2",children:[a.jsx("strong",{children:"Recommendations:"}),' Consider running promotions on weekdays to boost sales during slower periods. The "Apparel" category has seen a slight decline (-3%) and may benefit from new product additions or targeted marketing.']})]})]})]})]})}),a.jsx(zt,{value:"traffic",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Traffic & Conversion Analysis"}),a.jsx(Wt,{children:"Website traffic sources and conversion rates"})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Traffic Sources"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Traffic sources chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Conversion Funnel"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Conversion funnel chart placeholder"})})]})]}),a.jsxs(Ge,{className:"bg-muted/30",children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"AI Conversion Recommendations"})}),a.jsxs(Ze,{children:[a.jsx("p",{className:"text-sm",children:"Your current conversion rate of 3.2% is below the industry average of 4.5% for e-commerce stores in your category. The biggest drop-off occurs at the checkout page (45% abandonment rate)."}),a.jsx("p",{className:"text-sm mt-2",children:a.jsx("strong",{children:"Recommendations:"})}),a.jsxs("ul",{className:"text-sm list-disc pl-5 mt-1",children:[a.jsx("li",{children:"Simplify your checkout process by reducing the number of form fields"}),a.jsx("li",{children:"Add trust badges and security indicators near payment information"}),a.jsx("li",{children:"Implement exit-intent popups with discount offers to reduce cart abandonment"}),a.jsx("li",{children:"Optimize product page load times (currently averaging 3.2s, aim for under 2s)"})]})]})]})]})]})}),a.jsx(zt,{value:"customers",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Customer Insights"}),a.jsx(Wt,{children:"Detailed analysis of customer behavior and demographics"})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Customer Demographics"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Demographics chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Purchase Frequency"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Purchase frequency chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Customer Lifetime Value"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"CLV chart placeholder"})})]})]}),a.jsxs(Ge,{className:"bg-muted/30",children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Customer Personas"})}),a.jsx(Ze,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Tech-Savvy Millennials"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"25-34 years old, urban areas, high income"}),a.jsx("p",{className:"text-sm mt-2",children:"Prefer electronics and premium products, shop primarily on mobile devices"})]}),a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Budget-Conscious Families"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"35-44 years old, suburban areas, middle income"}),a.jsx("p",{className:"text-sm mt-2",children:"Focus on value, frequently use discount codes, buy in bulk"})]}),a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Luxury Shoppers"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"45-60 years old, various locations, high income"}),a.jsx("p",{className:"text-sm mt-2",children:"Purchase high-end products, less price sensitive, value quality and service"})]})]})})]})]})]})}),a.jsx(zt,{value:"marketing",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Marketing Attribution"}),a.jsx(Wt,{children:"Track the effectiveness of your marketing channels"})]}),a.jsxs(Ze,{children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"h-80 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Marketing attribution chart placeholder"})})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Channel"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Sessions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conversions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conv. Rate"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"ROAS"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Organic Search"}),a.jsx("td",{className:"py-3 px-4",children:"2,456"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:"4.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$7,845.00"}),a.jsx("td",{className:"py-3 px-4",children:"N/A"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Paid Search"}),a.jsx("td",{className:"py-3 px-4",children:"1,245"}),a.jsx("td",{className:"py-3 px-4",children:"62"}),a.jsx("td",{className:"py-3 px-4",children:"5.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$4,980.00"}),a.jsx("td",{className:"py-3 px-4",children:"3.2x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Social Media"}),a.jsx("td",{className:"py-3 px-4",children:"3,120"}),a.jsx("td",{className:"py-3 px-4",children:"78"}),a.jsx("td",{className:"py-3 px-4",children:"2.5%"}),a.jsx("td",{className:"py-3 px-4",children:"$5,460.00"}),a.jsx("td",{className:"py-3 px-4",children:"2.8x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Email Marketing"}),a.jsx("td",{className:"py-3 px-4",children:"980"}),a.jsx("td",{className:"py-3 px-4",children:"49"}),a.jsx("td",{className:"py-3 px-4",children:"5.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$3,920.00"}),a.jsx("td",{className:"py-3 px-4",children:"4.5x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Direct"}),a.jsx("td",{className:"py-3 px-4",children:"1,560"}),a.jsx("td",{className:"py-3 px-4",children:"47"}),a.jsx("td",{className:"py-3 px-4",children:"3.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$3,760.00"}),a.jsx("td",{className:"py-3 px-4",children:"N/A"})]})]})]})})]})]})}),a.jsx(zt,{value:"products",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Product Performance"}),a.jsx(Wt,{children:"Detailed analysis of product sales and performance"})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Top Selling Products"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Top products chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Product Category Performance"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Category performance chart placeholder"})})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Category"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Units Sold"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Profit Margin"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Return Rate"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Rating"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Premium T-Shirt"}),a.jsx("td",{className:"py-3 px-4",children:"Apparel"}),a.jsx("td",{className:"py-3 px-4",children:"245"}),a.jsx("td",{className:"py-3 px-4",children:"$7,345.55"}),a.jsx("td",{className:"py-3 px-4",children:"45%"}),a.jsx("td",{className:"py-3 px-4",children:"2.1%"}),a.jsx("td",{className:"py-3 px-4",children:"4.8/5"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Wireless Headphones"}),a.jsx("td",{className:"py-3 px-4",children:"Electronics"}),a.jsx("td",{className:"py-3 px-4",children:"124"}),a.jsx("td",{className:"py-3 px-4",children:"$11,098.00"}),a.jsx("td",{className:"py-3 px-4",children:"32%"}),a.jsx("td",{className:"py-3 px-4",children:"3.5%"}),a.jsx("td",{className:"py-3 px-4",children:"4.6/5"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Leather Wallet"}),a.jsx("td",{className:"py-3 px-4",children:"Accessories"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:"$4,899.02"}),a.jsx("td",{className:"py-3 px-4",children:"55%"}),a.jsx("td",{className:"py-3 px-4",children:"1.2%"}),a.jsx("td",{className:"py-3 px-4",children:"4.9/5"})]})]})]})})]})]})})]})]})},oke=()=>{const[t,e]=p.useState("email"),n=[{id:"EM-1234",name:"Summer Sale Announcement",status:"Sent",sentDate:"2023-05-15",opens:1245,clicks:356,conversions:28,revenue:"$2,450"},{id:"EM-1235",name:"New Product Launch",status:"Draft",lastEdited:"2023-05-14"},{id:"EM-1236",name:"Customer Feedback Request",status:"Scheduled",scheduledDate:"2023-05-20"},{id:"EM-1237",name:"Abandoned Cart Recovery",status:"Sent",sentDate:"2023-05-12",opens:876,clicks:234,conversions:15,revenue:"$1,280"}],r=[{id:"SM-567",platform:"Instagram",content:"Summer collection now available!",status:"Published",publishDate:"2023-05-15",engagement:245,likes:189,comments:32},{id:"SM-568",platform:"Facebook",content:"Limited time offer: 20% off all accessories",status:"Scheduled",scheduledDate:"2023-05-18"},{id:"SM-569",platform:"Twitter",content:"Flash sale today only! Use code FLASH25",status:"Published",publishDate:"2023-05-14",engagement:178,likes:45,comments:12},{id:"SM-570",platform:"TikTok",content:"Behind the scenes of our latest photoshoot",status:"Draft",lastEdited:"2023-05-16"}],s=[{id:"BLG-890",title:"10 Summer Fashion Trends",status:"Published",publishDate:"2023-05-10",views:1245,comments:23,shares:56},{id:"BLG-891",title:"How to Choose the Perfect Headphones",status:"Draft",lastEdited:"2023-05-14"},{id:"BLG-892",title:"Sustainable Fashion: Our Commitment",status:"Published",publishDate:"2023-05-05",views:980,comments:18,shares:42},{id:"BLG-893",title:"Gift Guide: Father's Day Edition",status:"Scheduled",scheduledDate:"2023-05-25"}],i=[{id:"PROMO-123",name:"Summer Sale",type:"Discount",value:"20% off",status:"Active",startDate:"2023-05-01",endDate:"2023-05-31",usageCount:245},{id:"PROMO-124",name:"Free Shipping",type:"Free Shipping",value:"Orders over $50",status:"Active",startDate:"2023-05-01",endDate:"2023-06-30",usageCount:189},{id:"PROMO-125",name:"WELCOME10",type:"Discount",value:"10% off first order",status:"Active",startDate:"2023-01-01",endDate:"2023-12-31",usageCount:567},{id:"PROMO-126",name:"Holiday Bundle",type:"Bundle",value:"Buy 2 Get 1 Free",status:"Draft",startDate:"2023-11-15",endDate:"2023-12-25"}];return a.jsxs("div",{className:"bg-background",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Marketing"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(V,{variant:"outline",size:"sm",children:[a.jsx(U1,{className:"h-4 w-4 mr-2"}),"Content Calendar"]}),a.jsxs(V,{size:"sm",children:[a.jsx(so,{className:"h-4 w-4 mr-2"}),"Create Campaign"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Email Performance"})}),a.jsxs(Ze,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"24.5%"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Average open rate"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+2.3% from last month"})]})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Social Engagement"})}),a.jsxs(Ze,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"1,245"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Total interactions"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+15% from last month"})]})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Blog Traffic"})}),a.jsxs(Ze,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"3,890"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Monthly page views"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+8% from last month"})]})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Promo Conversions"})}),a.jsxs(Ze,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"12.8%"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Conversion rate"}),a.jsx("p",{className:"text-sm text-red-600 mt-2",children:"-1.2% from last month"})]})]})]}),a.jsxs(Ei,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(Qs,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(Bt,{value:"email",children:[a.jsx(Rd,{className:"mr-2 h-4 w-4"}),"Email Campaigns"]}),a.jsxs(Bt,{value:"social",children:[a.jsx(dx,{className:"mr-2 h-4 w-4"}),"Social Media"]}),a.jsxs(Bt,{value:"seo",children:[a.jsx(Jd,{className:"mr-2 h-4 w-4"}),"SEO Tools"]}),a.jsxs(Bt,{value:"blog",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Blog"]}),a.jsxs(Bt,{value:"promotions",children:[a.jsx(ym,{className:"mr-2 h-4 w-4"}),"Promotions"]})]}),a.jsx(zt,{value:"email",children:a.jsxs(Ge,{children:[a.jsxs(rt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{children:"Email Campaigns"}),a.jsx(Wt,{children:"Create and manage email marketing campaigns"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(V,{variant:"outline",children:[a.jsx(Rd,{className:"mr-2 h-4 w-4"}),"Import Template"]}),a.jsxs(V,{children:[a.jsx(Rd,{className:"mr-2 h-4 w-4"}),"Create Campaign"]})]})]}),a.jsxs(Ze,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Campaign Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Opens"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Clicks"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conversions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Sent"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.sentDate||o.lastEdited||o.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:o.opens||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.clicks||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.conversions||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.revenue||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(V,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),o.status!=="Sent"&&a.jsx(V,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Email Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate professional marketing emails with AI, including copy and layout suggestions."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(V,{children:[a.jsx(Rd,{className:"mr-2 h-4 w-4"}),"Generate New Email"]}),a.jsxs(V,{variant:"outline",children:[a.jsx(vv,{className:"mr-2 h-4 w-4"}),"A/B Test Generator"]})]})]})]})]})}),a.jsx(zt,{value:"social",children:a.jsxs(Ge,{children:[a.jsxs(rt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{children:"Social Media Campaigns"}),a.jsx(Wt,{children:"Create and schedule social media content"})]}),a.jsxs(V,{children:[a.jsx(dx,{className:"mr-2 h-4 w-4"}),"Create Post"]})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Content Calendar"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Content calendar placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Platform Performance"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Performance chart placeholder"})})]})]}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Recent Posts"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Platform"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Content"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Engagement"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Likes"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Comments"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.platform}),a.jsx("td",{className:"py-3 px-4",children:o.content}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Published"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.publishDate||o.scheduledDate||o.lastEdited}),a.jsx("td",{className:"py-3 px-4",children:o.engagement||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.likes||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.comments||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(V,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),o.status!=="Published"&&a.jsx(V,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Content Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Transform product images into engaging social media content with AI."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(V,{children:[a.jsx(dx,{className:"mr-2 h-4 w-4"}),"Generate Social Media Images"]}),a.jsxs(V,{variant:"outline",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Generate Caption Ideas"]})]})]})]})]})}),a.jsx(zt,{value:"seo",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"SEO Tools"}),a.jsx(Wt,{children:"Optimize your store for search engines"})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Keyword Research"})}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"mb-4 flex gap-2",children:[a.jsx(nt,{placeholder:"Enter a keyword to research...",className:"flex-1"}),a.jsxs(V,{children:[a.jsx(Jd,{className:"mr-2 h-4 w-4"}),"Analyze"]})]}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Recent searches: wireless headphones, premium t-shirts, leather wallet"})]})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"SEO Performance"})}),a.jsx(Ze,{children:a.jsx("div",{className:"h-40 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"SEO performance chart placeholder"})})})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Top Keywords"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Keyword"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Search Volume"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Difficulty"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Current Ranking"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Traffic"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"wireless headphones"}),a.jsx("td",{className:"py-3 px-4",children:"12,400"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800",children:"Medium"})}),a.jsx("td",{className:"py-3 px-4",children:"#8"}),a.jsx("td",{className:"py-3 px-4",children:"245"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(V,{variant:"outline",size:"sm",children:"Optimize"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"premium t-shirts"}),a.jsx("td",{className:"py-3 px-4",children:"5,800"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Low"})}),a.jsx("td",{className:"py-3 px-4",children:"#3"}),a.jsx("td",{className:"py-3 px-4",children:"320"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(V,{variant:"outline",size:"sm",children:"Optimize"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"leather wallet men"}),a.jsx("td",{className:"py-3 px-4",children:"8,200"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"High"})}),a.jsx("td",{className:"py-3 px-4",children:"#15"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(V,{variant:"outline",size:"sm",children:"Optimize"})})]})]})]})})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Content Optimizer"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate SEO-optimized content for your product pages and blog posts."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(V,{children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Generate SEO Content"]}),a.jsxs(V,{variant:"outline",children:[a.jsx(Jd,{className:"mr-2 h-4 w-4"}),"Analyze Page SEO"]})]})]})]})]})}),a.jsx(zt,{value:"blog",children:a.jsxs(Ge,{children:[a.jsxs(rt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{children:"Blog"}),a.jsx(Wt,{children:"Create and manage blog content"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(V,{variant:"outline",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Import Article"]}),a.jsxs(V,{children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Create New Post"]})]})]}),a.jsxs(Ze,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Title"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Views"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Comments"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Shares"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.title}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Published"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.publishDate||o.lastEdited||o.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:o.views||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.comments||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.shares||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(V,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(V,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Blog Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate engaging blog content with AI based on your products and target audience."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(V,{children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Generate Blog Post"]}),a.jsxs(V,{variant:"outline",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Generate Topic Ideas"]})]})]})]})]})}),a.jsx(zt,{value:"promotions",children:a.jsxs(Ge,{children:[a.jsxs(rt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{children:"Promotions"}),a.jsx(Wt,{children:"Create and manage promotional campaigns"})]}),a.jsxs(V,{children:[a.jsx(ym,{className:"mr-2 h-4 w-4"}),"Create Promotion"]})]}),a.jsxs(Ze,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Value"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Start Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"End Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Usage"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:i.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.name}),a.jsx("td",{className:"py-3 px-4",children:o.type}),a.jsx("td",{className:"py-3 px-4",children:o.value}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.startDate}),a.jsx("td",{className:"py-3 px-4",children:o.endDate}),a.jsx("td",{className:"py-3 px-4",children:o.usageCount||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(V,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(V,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Promotion Optimizer"}),a.jsx("p",{className:"text-sm mb-4",children:"Get AI recommendations for optimal discount levels and promotion timing based on your sales data."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(V,{children:[a.jsx(ym,{className:"mr-2 h-4 w-4"}),"Generate Promotion Strategy"]}),a.jsxs(V,{variant:"outline",children:[a.jsx(vv,{className:"mr-2 h-4 w-4"}),"Analyze Past Promotions"]})]})]})]})]})})]})]})},ake=()=>{const[t,e]=p.useState("rates"),n=[{id:"ZONE-1",name:"Domestic",countries:["United States"],methods:[{name:"Standard",price:"$5.99",deliveryTime:"3-5 business days"},{name:"Express",price:"$12.99",deliveryTime:"1-2 business days"}]},{id:"ZONE-2",name:"Canada & Mexico",countries:["Canada","Mexico"],methods:[{name:"Standard",price:"$9.99",deliveryTime:"5-7 business days"},{name:"Express",price:"$19.99",deliveryTime:"2-3 business days"}]},{id:"ZONE-3",name:"International",countries:["Rest of World"],methods:[{name:"Standard",price:"$14.99",deliveryTime:"7-14 business days"},{name:"Express",price:"$29.99",deliveryTime:"3-5 business days"}]}],r=[{id:"SUP-1",name:"GlobalDropship Inc.",products:245,avgShippingTime:"4-7 days",status:"Connected"},{id:"SUP-2",name:"FastShip Solutions",products:189,avgShippingTime:"3-5 days",status:"Pending"},{id:"SUP-3",name:"EcoPackaging Co.",products:78,avgShippingTime:"5-8 days",status:"Connected"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Shipping & Delivery"}),a.jsxs(Ei,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(Qs,{className:"grid grid-cols-3 mb-6",children:[a.jsxs(Bt,{value:"rates",children:[a.jsx(Sv,{className:"mr-2 h-4 w-4"}),"Shipping Rates"]}),a.jsxs(Bt,{value:"dropshipping",children:[a.jsx(Jc,{className:"mr-2 h-4 w-4"}),"Dropshipping"]}),a.jsxs(Bt,{value:"policy",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Shipping Policy"]})]}),a.jsx(zt,{value:"rates",children:a.jsxs(Ge,{children:[a.jsxs(rt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{children:"Shipping Zones & Rates"}),a.jsx(Wt,{children:"Configure shipping rates by zone and package type"})]}),a.jsxs(V,{children:[a.jsx(Jc,{className:"mr-2 h-4 w-4"}),"Add Shipping Zone"]})]}),a.jsxs(Ze,{children:[n.map(s=>a.jsxs(Ge,{className:"mb-6",children:[a.jsxs(rt,{className:"pb-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(st,{className:"text-lg",children:s.name}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(V,{variant:"outline",size:"sm",children:"Edit"}),a.jsx(V,{variant:"outline",size:"sm",children:"Delete"})]})]}),a.jsxs(Wt,{children:["Countries: ",s.countries.join(", ")]})]}),a.jsxs(Ze,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Method"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Price"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Delivery Time"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.methods.map((i,o)=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.name}),a.jsx("td",{className:"py-3 px-4",children:i.price}),a.jsx("td",{className:"py-3 px-4",children:i.deliveryTime}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(V,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(V,{variant:"outline",size:"sm",children:"Delete"})]})]},o))})]})}),a.jsxs(V,{variant:"outline",size:"sm",className:"mt-4",children:[a.jsx(ui,{className:"mr-2 h-4 w-4"}),"Add Shipping Method"]})]})]},s.id)),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Package Types"}),a.jsx("p",{className:"text-sm mb-4",children:"Define standard package types to calculate shipping rates accurately."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Small Package"}),a.jsx(V,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 1 lb, 9" x 6" x 2"'})]}),a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Medium Package"}),a.jsx(V,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 5 lbs, 12" x 9" x 4"'})]}),a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Large Package"}),a.jsx(V,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 10 lbs, 18" x 12" x 6"'})]})]}),a.jsxs(V,{variant:"outline",size:"sm",children:[a.jsx(ui,{className:"mr-2 h-4 w-4"}),"Add Package Type"]})]})]})]})}),a.jsx(zt,{value:"dropshipping",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Dropshipping Integration"}),a.jsx(Wt,{children:"Connect with dropshipping suppliers and manage fulfillment"})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Fulfillment Mode"})}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(V,{variant:"outline",className:"flex-1",children:"Self-Fulfillment"}),a.jsx(V,{variant:"default",className:"flex-1",children:"Dropshipping"}),a.jsx(V,{variant:"outline",className:"flex-1",children:"Hybrid"})]}),a.jsxs("p",{className:"text-sm text-muted-foreground mt-4",children:["Current mode: ",a.jsx("strong",{children:"Dropshipping"}),". Products will be shipped directly from suppliers to customers."]})]})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Connect Supplier"})}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(nt,{placeholder:"Enter supplier API key or ID",className:"flex-1"}),a.jsxs(V,{children:[a.jsx(Jc,{className:"mr-2 h-4 w-4"}),"Connect"]})]}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"We support direct integration with AliExpress, Spocket, Oberlo, and more."})]})]})]}),a.jsx("h3",{className:"font-medium mb-3",children:"Connected Suppliers"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Supplier"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Products"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Avg. Shipping Time"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.products}),a.jsx("td",{className:"py-3 px-4",children:s.avgShippingTime}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Connected"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(V,{variant:"outline",size:"sm",className:"mr-2",children:"View Products"}),a.jsx(V,{variant:"outline",size:"sm",children:"Disconnect"})]})]},s.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Automatic Order Routing"}),a.jsx("p",{className:"text-sm mb-4",children:"Configure how orders are routed to different suppliers based on product, location, or other criteria."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(V,{children:[a.jsx(bv,{className:"mr-2 h-4 w-4"}),"Configure Routing Rules"]}),a.jsxs(V,{variant:"outline",children:[a.jsx(ui,{className:"mr-2 h-4 w-4"}),"View Order Queue"]})]})]})]})]})}),a.jsx(zt,{value:"policy",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Shipping Policy & Returns"}),a.jsx(Wt,{children:"Configure your shipping policy and return management settings"})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Shipping Policy"}),a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Shipping Policy"}),a.jsx("p",{children:"We ship to all 50 US states and select international destinations. Orders are typically processed within 1-2 business days."}),a.jsx("h5",{children:"Domestic Shipping"}),a.jsxs("p",{children:["Standard shipping (3-5 business days): $5.99",a.jsx("br",{}),"Express shipping (1-2 business days): $12.99"]}),a.jsx("h5",{children:"International Shipping"}),a.jsxs("p",{children:["Standard shipping (7-14 business days): $14.99",a.jsx("br",{}),"Express shipping (3-5 business days): $29.99"]}),a.jsx("p",{children:"Free shipping on all domestic orders over $50. Shipping times may vary during peak seasons and holidays."})]})}),a.jsxs(V,{className:"mt-4",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Edit Shipping Policy"]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Return Policy"}),a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Return Policy"}),a.jsx("p",{children:"We offer a 30-day return policy for most items. To be eligible for a return, your item must be unused and in the same condition that you received it."}),a.jsx("h5",{children:"Return Process"}),a.jsxs("p",{children:["1. Contact our customer service team",a.jsx("br",{}),"2. Receive a Return Merchandise Authorization (RMA) number",a.jsx("br",{}),"3. Ship the item back with the RMA number clearly marked",a.jsx("br",{}),"4. Once received, we will process your refund within 5-7 business days"]}),a.jsx("h5",{children:"Exceptions"}),a.jsxs("p",{children:["Certain items cannot be returned, including:",a.jsx("br",{}),"- Personalized or custom-made products",a.jsx("br",{}),"- Digital downloads",a.jsx("br",{}),"- Gift cards"]})]})}),a.jsxs(V,{className:"mt-4",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Edit Return Policy"]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Return Management"}),a.jsx("p",{className:"text-sm mb-4",children:"Configure how returns are processed and managed."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Return Window"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nt,{type:"number",defaultValue:"30",className:"w-20"}),a.jsx("span",{className:"text-sm",children:"days after delivery"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Restocking Fee"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nt,{type:"number",defaultValue:"10",className:"w-20"}),a.jsx("span",{className:"text-sm",children:"% of item price"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Return Labels"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(V,{variant:"outline",size:"sm",children:"Customer Pays"}),a.jsx(V,{variant:"default",size:"sm",children:"Store Provides"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Refund Method"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(V,{variant:"default",size:"sm",children:"Original Payment"}),a.jsx(V,{variant:"outline",size:"sm",children:"Store Credit"})]})]})]}),a.jsxs(V,{className:"mt-4",children:[a.jsx(bv,{className:"mr-2 h-4 w-4"}),"Save Return Settings"]})]})]})]})})]})]})},lke=({store:t})=>{var v,_,S,I;const[e,n]=p.useState("store"),{user:r,session:s,subscriptionStatus:i}=qi(),{updateStore:o,isLoadingStores:l}=$n(),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),g=i==="active",x=async()=>{if(!(s!=null&&s.access_token)){h("Authentication token not found. Please log in again.");return}u(!0),h(null);try{const M=await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/create-portal-session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`}}),j=await M.json();if(!M.ok)throw new Error(j.error||"Failed to create portal session.");window.location.href=j.url}catch(M){console.error("Portal session error:",M),h(M.message)}finally{u(!1)}},E=()=>{var j;const M=((j=r==null?void 0:r.store)==null?void 0:j.subdomain)||"your-store";navigator.clipboard.writeText(`${M}.storegen.app`),m(!0),setTimeout(()=>m(!1),2e3)};return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Settings"}),a.jsxs(Ei,{value:e,onValueChange:n,className:"w-full",children:[a.jsxs(Qs,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(Bt,{value:"store",children:[a.jsx(up,{className:"mr-2 h-4 w-4"}),"Store Details"]}),a.jsxs(Bt,{value:"billing",children:[a.jsx(ki,{className:"mr-2 h-4 w-4"}),"Billing"]}),a.jsxs(Bt,{value:"domain",children:[a.jsx(Jc,{className:"mr-2 h-4 w-4"}),"Domain Management"]}),a.jsxs(Bt,{value:"legal",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Legal Pages"]}),a.jsxs(Bt,{value:"footer",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Footer Editor"]})]}),a.jsx(zt,{value:"store",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Store Details"}),a.jsx(Wt,{children:"Update your store information and preferences"})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-name",children:"Store Name"}),a.jsx(nt,{id:"store-name",placeholder:"Your Store Name",defaultValue:"My Awesome Store"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-email",children:"Store Email"}),a.jsx(nt,{id:"store-email",type:"email",placeholder:"contact@yourstore.com",defaultValue:(r==null?void 0:r.email)||""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-phone",children:"Store Phone"}),a.jsx(nt,{id:"store-phone",placeholder:"+1 (555) 123-4567",defaultValue:"+1 (555) 123-4567"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-address",children:"Store Address"}),a.jsx(Ln,{id:"store-address",placeholder:"123 Main St, City, State, ZIP",defaultValue:"123 Main St\\nNew York, NY 10001\\nUnited States",rows:3})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-currency",children:"Currency"}),a.jsxs("select",{id:"store-currency",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",defaultValue:"USD",children:[a.jsx("option",{value:"USD",children:"USD ($)"}),a.jsx("option",{value:"EUR",children:"EUR (€)"}),a.jsx("option",{value:"GBP",children:"GBP (£)"}),a.jsx("option",{value:"CAD",children:"CAD ($)"}),a.jsx("option",{value:"AUD",children:"AUD ($)"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-timezone",children:"Timezone"}),a.jsxs("select",{id:"store-timezone",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",defaultValue:"America/New_York",children:[a.jsx("option",{value:"America/New_York",children:"Eastern Time (ET)"}),a.jsx("option",{value:"America/Chicago",children:"Central Time (CT)"}),a.jsx("option",{value:"America/Denver",children:"Mountain Time (MT)"}),a.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PT)"}),a.jsx("option",{value:"Europe/London",children:"London (GMT)"})]})]})]})]})]}),a.jsxs("div",{className:"mt-6 space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-description",children:"Store Description"}),a.jsx(Ln,{id:"store-description",placeholder:"Tell customers about your store...",defaultValue:"Welcome to My Awesome Store! We offer high-quality products at competitive prices. Our mission is to provide exceptional customer service and a seamless shopping experience.",rows:4})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Do,{id:"enable-reviews",defaultChecked:!0}),a.jsx(Re,{htmlFor:"enable-reviews",children:"Enable customer reviews"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Do,{id:"enable-inventory",defaultChecked:!0}),a.jsx(Re,{htmlFor:"enable-inventory",children:"Show inventory warnings on product pages"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Do,{id:"enable-tax",defaultChecked:!0}),a.jsx(Re,{htmlFor:"enable-tax",children:"Enable automatic tax calculation"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Do,{id:"enable-store-theme-toggle",checked:((v=t==null?void 0:t.settings)==null?void 0:v.showThemeToggle)??!0,onCheckedChange:M=>{t&&o&&o(t.id,{settings:{...t.settings,showThemeToggle:M}})},disabled:l||!t}),a.jsx(Re,{htmlFor:"enable-store-theme-toggle",children:"Show theme (light/dark) toggle in store header"})]})]}),a.jsxs(V,{className:"mt-6",disabled:l||!t,children:[a.jsx(pb,{className:"mr-2 h-4 w-4"}),"Save Store Details"]})]})]})}),a.jsx(zt,{value:"billing",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Billing Information"}),a.jsx(Wt,{children:"Manage your subscription and payment methods"})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Current Plan"})}),a.jsxs(Ze,{children:[a.jsx("div",{className:"text-xl font-medium",children:g?"Store Creator Plan":"Free Plan"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g?"$29.99/month, billed monthly":"Limited features"}),a.jsxs("div",{className:"mt-4",children:[g?a.jsxs(V,{onClick:x,disabled:c,children:[a.jsx(ki,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Subscription"]}):a.jsxs(V,{onClick:x,disabled:c,children:[" ",a.jsx(ki,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Upgrade to Pro"]}),d&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:d})]})]})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Payment Methods"})}),a.jsx(Ze,{children:g?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"bg-blue-100 p-2 rounded-md mr-3",children:a.jsx(ki,{className:"h-5 w-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Visa ending in 4242"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Expires 12/2025"})]})]}),a.jsx(V,{variant:"outline",size:"sm",onClick:x,disabled:c,children:"Edit"})]}),a.jsxs(V,{variant:"outline",onClick:x,disabled:c,children:[a.jsx(ki,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Add Payment Method"]})]}):a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsxs("p",{className:"text-muted-foreground",children:["No payment methods available.",a.jsx("br",{}),"Upgrade to add payment methods."]})})})]})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Billing History"})}),a.jsx(Ze,{children:g?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Description"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Invoice"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"May 1, 2023"}),a.jsx("td",{className:"py-3 px-4",children:"Store Creator Plan"}),a.jsx("td",{className:"py-3 px-4",children:"$29.99"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Paid"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(V,{variant:"outline",size:"sm",children:"Download"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Apr 1, 2023"}),a.jsx("td",{className:"py-3 px-4",children:"Store Creator Plan"}),a.jsx("td",{className:"py-3 px-4",children:"$29.99"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Paid"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(V,{variant:"outline",size:"sm",children:"Download"})})]})]})]})}):a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsxs("p",{className:"text-muted-foreground",children:["No billing history available.",a.jsx("br",{}),"Upgrade to view billing history."]})})})]})]})]})}),a.jsx(zt,{value:"domain",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Domain Management"}),a.jsx(Wt,{children:"Configure your store's domain and URL settings"})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Subdomain"})}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nt,{defaultValue:((_=r==null?void 0:r.store)==null?void 0:_.subdomain)||"your-store",className:"flex-grow"}),a.jsx("span",{className:"text-muted-foreground",children:".storegen.app"})]}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsxs(V,{children:[a.jsx(pb,{className:"mr-2 h-4 w-4"}),"Save Subdomain"]}),a.jsx(V,{variant:"outline",onClick:E,children:f?a.jsxs(a.Fragment,{children:[a.jsx(qp,{className:"mr-2 h-4 w-4"})," Copied"]}):a.jsxs(a.Fragment,{children:[a.jsx(N$,{className:"mr-2 h-4 w-4"})," Copy URL"]})})]})]})]}),a.jsxs(Ge,{children:[a.jsxs(rt,{className:"pb-2",children:[a.jsx(st,{className:"text-lg",children:"Custom Domain"}),!g&&a.jsx(Wt,{children:a.jsx("span",{className:"text-yellow-600",children:"Available on paid plans only"})})]}),a.jsx(Ze,{children:g?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nt,{placeholder:"yourdomain.com",className:"flex-grow"}),a.jsxs(V,{children:[a.jsx(Jc,{className:"mr-2 h-4 w-4"}),"Connect"]})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your domain name without http:// or www."})]}):a.jsxs("div",{className:"flex flex-col items-center justify-center h-32 space-y-4",children:[a.jsx("p",{className:"text-muted-foreground text-center",children:"Custom domains are available on paid plans only."}),a.jsxs(V,{onClick:x,disabled:c,children:[a.jsx(ki,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Upgrade to Pro"]})]})})]})]}),g&&a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"DNS Configuration"})}),a.jsx(Ze,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm",children:"To connect your custom domain, add these DNS records in your domain provider's dashboard:"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Value"}),a.jsx("th",{className:"text-left py-3 px-4",children:"TTL"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"CNAME"}),a.jsx("td",{className:"py-3 px-4",children:"@"}),a.jsxs("td",{className:"py-3 px-4",children:[((S=r==null?void 0:r.store)==null?void 0:S.subdomain)||"your-store",".storegen.app"]}),a.jsx("td",{className:"py-3 px-4",children:"3600"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"CNAME"}),a.jsx("td",{className:"py-3 px-4",children:"www"}),a.jsxs("td",{className:"py-3 px-4",children:[((I=r==null?void 0:r.store)==null?void 0:I.subdomain)||"your-store",".storegen.app"]}),a.jsx("td",{className:"py-3 px-4",children:"3600"})]})]})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(V,{variant:"outline",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"View DNS Guide"]}),a.jsxs(V,{children:[a.jsx(Jc,{className:"mr-2 h-4 w-4"}),"Verify DNS"]})]})]})})]})]})]})}),a.jsx(zt,{value:"legal",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Legal Pages"}),a.jsx(Wt,{children:"Configure your store's legal documents and policies"})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Privacy Policy"})}),a.jsx(Ze,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Privacy Policy"}),a.jsx("p",{children:"This Privacy Policy describes how your personal information is collected, used, and shared when you visit or make a purchase from our store."}),a.jsx("h5",{children:"Personal Information We Collect"}),a.jsx("p",{children:"When you visit the Site, we automatically collect certain information about your device, including information about your web browser, IP address, time zone, and some of the cookies that are installed on your device."}),a.jsx("p",{children:"Additionally, as you browse the Site, we collect information about the individual web pages or products that you view, what websites or search terms referred you to the Site, and information about how you interact with the Site."}),a.jsx("h5",{children:"How We Use Your Personal Information"}),a.jsx("p",{children:"We use the information that we collect generally to fulfill any orders placed through the Site (including processing your payment information, arranging for shipping, and providing you with invoices and/or order confirmations)."})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(V,{children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Edit Privacy Policy"]}),a.jsxs(V,{variant:"outline",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Terms of Service"})}),a.jsx(Ze,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Terms of Service"}),a.jsx("p",{children:"These Terms of Service govern your use of our website and the products and services provided by us."}),a.jsx("h5",{children:"Overview"}),a.jsx("p",{children:"By accessing our website, you agree to these Terms of Service. If you do not agree with any part of these terms, you may not access the website or use our services."}),a.jsx("h5",{children:"Products and Services"}),a.jsx("p",{children:"All products and services displayed on our website are subject to availability. We reserve the right to discontinue any product or service at any time."}),a.jsx("h5",{children:"Accuracy of Information"}),a.jsx("p",{children:"We make every effort to ensure that the information on our website is accurate and up-to-date. However, we do not warrant that product descriptions or other content is accurate, complete, reliable, current, or error-free."})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(V,{children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Edit Terms of Service"]}),a.jsxs(V,{variant:"outline",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Refund Policy"})}),a.jsx(Ze,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Refund Policy"}),a.jsx("p",{children:"We offer a 30-day return policy for most items. To be eligible for a return, your item must be unused and in the same condition that you received it."}),a.jsx("h5",{children:"Return Process"}),a.jsxs("p",{children:["1. Contact our customer service team",a.jsx("br",{}),"2. Receive a Return Merchandise Authorization (RMA) number",a.jsx("br",{}),"3. Ship the item back with the RMA number clearly marked",a.jsx("br",{}),"4. Once received, we will process your refund within 5-7 business days"]}),a.jsx("h5",{children:"Exceptions"}),a.jsxs("p",{children:["Certain items cannot be returned, including:",a.jsx("br",{}),"- Personalized or custom-made products",a.jsx("br",{}),"- Digital downloads",a.jsx("br",{}),"- Gift cards"]})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(V,{children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Edit Refund Policy"]}),a.jsxs(V,{variant:"outline",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Cookie Policy"})}),a.jsx(Ze,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Cookie Policy"}),a.jsx("p",{children:"This Cookie Policy explains how we use cookies and similar technologies to recognize you when you visit our website."}),a.jsx("h5",{children:"What are cookies?"}),a.jsx("p",{children:"Cookies are small data files that are placed on your computer or mobile device when you visit a website. Cookies are widely used by website owners in order to make their websites work, or to work more efficiently, as well as to provide reporting information."}),a.jsx("h5",{children:"How we use cookies"}),a.jsx("p",{children:'We use cookies for several reasons. Some cookies are required for technical reasons in order for our website to operate, and we refer to these as "essential" or "strictly necessary" cookies. Other cookies enable us to track and target the interests of our users to enhance the experience on our website.'})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(V,{children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Edit Cookie Policy"]}),a.jsxs(V,{variant:"outline",children:[a.jsx(gr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]})]})]})]})}),a.jsx(zt,{value:"footer",children:a.jsxs(Ge,{children:[a.jsxs(rt,{children:[a.jsx(st,{children:"Footer Editor"}),a.jsx(Wt,{children:"Customize your store's footer information"})]}),a.jsxs(Ze,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Contact Information"})}),a.jsx(Ze,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-email",children:"Email"}),a.jsx(nt,{id:"footer-email",type:"email",placeholder:"contact@yourstore.com",defaultValue:(r==null?void 0:r.email)||""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-phone",children:"Phone"}),a.jsx(nt,{id:"footer-phone",placeholder:"+1 (555) 123-4567",defaultValue:"+1 (555) 123-4567"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-address",children:"Address"}),a.jsx(Ln,{id:"footer-address",placeholder:"123 Main St, City, State, ZIP",defaultValue:"123 Main St\\nNew York, NY 10001\\nUnited States",rows:3})]})]})})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Business Hours"})}),a.jsx(Ze,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-hours",children:"Hours of Operation"}),a.jsx(Ln,{id:"footer-hours",placeholder:"Monday-Friday: 9am-5pm",defaultValue:"Monday-Friday: 9am-5pm\\nSaturday: 10am-4pm\\nSunday: Closed",rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-support",children:"Customer Support Hours"}),a.jsx(Ln,{id:"footer-support",placeholder:"Monday-Friday: 9am-5pm",defaultValue:"Monday-Friday: 9am-6pm\\nSaturday: 10am-2pm\\nSunday: Closed",rows:3})]})]})})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"Social Media"})}),a.jsx(Ze,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-facebook",children:"Facebook"}),a.jsx(nt,{id:"footer-facebook",placeholder:"https://facebook.com/yourstore",defaultValue:"https://facebook.com/yourstore"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-instagram",children:"Instagram"}),a.jsx(nt,{id:"footer-instagram",placeholder:"https://instagram.com/yourstore",defaultValue:"https://instagram.com/yourstore"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-twitter",children:"Twitter"}),a.jsx(nt,{id:"footer-twitter",placeholder:"https://twitter.com/yourstore",defaultValue:"https://twitter.com/yourstore"})]})]})})]})]}),a.jsxs(Ge,{children:[a.jsx(rt,{className:"pb-2",children:a.jsx(st,{className:"text-lg",children:"About Us"})}),a.jsx(Ze,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-about",children:"About Us Text"}),a.jsx(Ln,{id:"footer-about",placeholder:"Tell customers about your business...",defaultValue:"My Awesome Store was founded in 2023 with a mission to provide high-quality products at competitive prices. We are committed to exceptional customer service and a seamless shopping experience.",rows:4})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-copyright",children:"Copyright Text"}),a.jsx(nt,{id:"footer-copyright",placeholder:"© 2023 Your Store. All rights reserved.",defaultValue:`© ${new Date().getFullYear()} My Awesome Store. All rights reserved.`})]})]})})]}),a.jsx("div",{className:"mt-6",children:a.jsxs(V,{children:[a.jsx(pb,{className:"mr-2 h-4 w-4"}),"Save Footer Settings"]})})]})]})})]})]})},cke=()=>{const{storeName:t}=Ww(),e=Ma(),{getStoreById:n,getStoreByName:r,setCurrentStore:s,isLoadingStores:i}=$n(),o=new URLSearchParams(e.search),l=o.get("tab")||"orders",[c,u]=p.useState(l),[d,h]=p.useState(null);p.useEffect(()=>{if(!i&&t){const m=r(t);m?(h(m),s(m)):console.error(`Store with name ${t} not found.`)}},[t,r,s,i]),p.useEffect(()=>{const m=o.get("tab");m&&m!==c&&u(m)},[e.search]);const f=()=>{switch(c){case"orders":return a.jsx(sF,{store:d});case"products":return a.jsx(nke,{store:d});case"customers":return a.jsx(rke,{store:d});case"payments":return a.jsx(ske,{store:d});case"analytics":return a.jsx(ike,{store:d});case"marketing":return a.jsx(oke,{store:d});case"shipping":return a.jsx(ake,{store:d});case"settings":return a.jsx(lke,{store:d});default:return a.jsx(sF,{store:d})}};return i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading dashboard..."})]})}):!d&&!i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Store Not Found"}),a.jsxs("p",{className:"text-muted-foreground",children:["Could not load dashboard for store: ",t]})]})}):a.jsx(tke,{activeTab:c,setActiveTab:u,storeId:d==null?void 0:d.id,storeName:d==null?void 0:d.name,children:f()})},uke=()=>{const{isAuthenticated:t,userRole:e,loadingProfile:n}=qi();return n?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("p",{className:"text-xl",children:"Loading..."})}):t?e==="admin"?a.jsx(u1e,{}):a.jsx(c1e,{}):a.jsx(P1,{to:"/auth",replace:!0})},dke=()=>{const{isAuthenticated:t,loadingProfile:e}=qi();return e?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("p",{className:"text-xl",children:"Loading..."})}):t?a.jsx(P1,{to:"/",replace:!0}):a.jsx(YRe,{})},hke=[{element:a.jsxs(x_e,{children:[a.jsx(eke,{})," "]}),children:[{index:!0,element:a.jsx(uke,{})},{path:"auth",element:a.jsx(dke,{})},{path:"pricing",element:a.jsx(JRe,{})},{path:":storeName",element:a.jsx(wRe,{})},{path:":storeName/product/:productId",element:a.jsx(BRe,{})},{path:"checkout",element:a.jsx(HRe,{})},{path:"order-confirmation",element:a.jsx(QRe,{})},{path:":storeName/content-creation",element:a.jsx(z_e,{})},{path:":storeName/dashboard",element:a.jsx(cke,{})},{path:"*",element:a.jsx(P1,{to:"/",replace:!0})}]}],fke=!0,mke=!0,pke=WJ(hke,{future:{v7_startTransition:fke,v7_relativeSplatPath:mke}}),Bx=document.getElementById("root");Bx._reactRoot||(Bx._reactRoot=DS.createRoot(Bx));const iF=Bx._reactRoot;try{iF.render(a.jsx(ct.StrictMode,{children:a.jsx(tX,{router:pke})}))}catch(t){console.error("Application initialization failed:",t);let e="Application failed to load. Please check the console for details.";t.message.includes("VITE_")&&t.message.includes("is not set")&&(e=`Configuration Error: ${t.message}. Please ensure all required environment variables are correctly set in your .env file and the application is rebuilt if necessary.`),iF.render(a.jsx(ct.StrictMode,{children:a.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",fontFamily:"sans-serif"},children:[a.jsx("h1",{children:"Application Load Error"}),a.jsx("p",{children:e}),a.jsxs("p",{children:["Please check your ",a.jsx("code",{children:".env"})," file and ensure all necessary environment variables are configured."]})]})}))}export{uo as $,_h as A,V as B,Ge as C,Jc as D,$se as E,iI as F,mb as G,A$ as H,Mn as I,cde as J,Xs as K,Ns as L,Rd as M,Rv as N,qr as O,Aj as P,ha as Q,ct as R,Xr as S,Tf as T,Jp as U,Fp as V,D$ as W,zo as X,j$ as Y,F$ as Z,r0 as _,Fde as a,Jse as a0,uy as a1,rie as a2,Yse as a3,jse as a4,Use as a5,die as a6,dx as a7,gie as a8,Kse as a9,pRe as aA,xRe as aB,qp as aC,aie as aD,ba as aE,Ln as aF,Fo as aG,St as aH,so as aI,Bse as aJ,cie as aa,Ij as ab,bi as ac,WE as ad,qE as ae,Do as af,Gi as ag,er as ah,ys as ai,es as aj,ts as ak,ns as al,xo as am,Ei as an,Qs as ao,Bt as ap,zt as aq,Re as ar,Tr as as,Koe as at,TW as au,L$ as av,$de as aw,ui as ax,tie as ay,_a as az,Ob as b,M$ as c,cp as d,fRe as e,jc as f,Ze as g,Lu as h,dp as i,a as j,_v as k,Jd as l,Ct as m,nu as n,$e as o,Sv as p,ki as q,p as r,bEe as s,Dse as t,$n as u,hRe as v,bt as w,Ls as x,nt as y,k$ as z};
