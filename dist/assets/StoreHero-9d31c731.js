import{bm as ae,ai as ee,aj as r,am as e,aG as se,aH as le,aI as re,aJ as ie,aK as oe,bn as ne,bo as de,bp as W,aq as te,c4 as ce,c5 as ue,bq as O,br as K,b3 as Y,aQ as J,au as y,aA as xe,bs as me,bt as he,bu as pe,bv as fe,ak as ge,al as X,ao as be,ap as v,bE as Z,ax as ve,at as $,aw as ye,c6 as je}from"./index-15348b98.js";const we=({open:d,onOpenChange:i,storeId:M,currentVideoUrl:q,onVideoReplaced:u})=>{var n;const{user:s}=ae(),{store:x}=ee(),m=((n=x==null?void 0:x.theme)==null?void 0:n.primaryColor)||"#3B82F6",[j,k]=r.useState("ai"),[P,h]=r.useState(""),[C,S]=r.useState(!1),[T,w]=r.useState(null),[A,U]=r.useState(""),[F,E]=r.useState(null),[f,_]=r.useState(!1),[L,g]=r.useState(null),[N,I]=r.useState(null),[V,b]=r.useState(null),[o,c]=r.useState(!1);r.useEffect(()=>{d&&(h(""),S(!1),w(null),U(""),E(null),_(!1),g(null),I(null),b(null),c(!1))},[d]);const z=async()=>{if(!P.trim()){w("Please enter a prompt.");return}S(!0),w(null);try{if(!await me(s.uid,15)){w("You don't have enough credits to generate a video."),S(!1);return}const p=await he(P);u&&u(p),await pe(s.uid,15),i(!1),h("")}catch(t){w(t.message||"Failed to generate video.")}finally{S(!1)}},H=async()=>{if(!A.trim()){g("Please enter a search query.");return}_(!0),g(null),E(null);try{const t=await fe(A);t.error?g(t.error):t.video?E(t.video):g("No video found for your query.")}catch(t){g(t.message||"Failed to search Pexels.")}finally{_(!1)}},G=t=>{u&&t?(u(t),i(!1)):g("Invalid video URL or handler missing.")},Q=t=>{const p=t.target.files[0];if(p){if(p.size>50*1024*1024){b("Max 50MB."),I(null);return}if(!p.type.startsWith("video/")){b("Invalid file type."),I(null);return}I(p),b(null)}},R=()=>{if(N&&u){c(!0),b(null);const t=new FileReader;t.onloadend=()=>{u(t.result),i(!1),I(null),c(!1)},t.onerror=()=>{b("Failed to read file."),c(!1)},t.readAsDataURL(N)}else b("No file or handler missing.")},a="w-full pl-3 pr-4 py-2.5 text-sm bg-white/70 dark:bg-neutral-700/50 backdrop-blur-sm border-neutral-300/70 dark:border-neutral-600/70 rounded-xl focus:ring-primary/30 focus:border-primary/60 transition-colors text-neutral-700 dark:text-neutral-100 placeholder-neutral-500 dark:placeholder-neutral-400",l="rounded-lg px-5 py-2.5 text-sm font-medium transition-all duration-200 focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-background dark:focus-visible:ring-offset-neutral-800",D=`${l} text-white`,B=`${l} border border-neutral-300 dark:border-neutral-600 text-neutral-700 dark:text-neutral-200 hover:bg-neutral-100 dark:hover:bg-neutral-700`;return e.jsx(se,{open:d,onOpenChange:i,children:e.jsxs(le,{className:"sm:max-w-[672px] bg-neutral-50 dark:bg-neutral-800/90 border-neutral-200 dark:border-neutral-700/80 rounded-xl shadow-2xl p-0",children:[e.jsxs(re,{className:"px-6 pt-6 pb-4 border-b border-neutral-200 dark:border-neutral-700",children:[e.jsx(ie,{className:"text-xl font-semibold text-neutral-800 dark:text-white",children:"Replace Hero Media"}),e.jsxs(oe,{className:"text-sm text-neutral-500 dark:text-neutral-400 mt-1",children:["Current: ",e.jsx("a",{href:q,target:"_blank",rel:"noopener noreferrer",className:"underline truncate block max-w-full",style:{color:m},children:q||"No media set"})]})]}),e.jsxs(ne,{value:j,onValueChange:k,className:"w-full px-6 pt-2 pb-6",children:[e.jsxs(de,{className:"grid w-full grid-cols-3 bg-neutral-100 dark:bg-neutral-700/60 p-1 rounded-lg mb-4",children:[e.jsxs(W,{value:"ai",className:`flex items-center justify-center gap-2 text-xs sm:text-sm py-2 px-3 rounded-md transition-colors ${j==="ai"?"text-white shadow-sm":"text-neutral-600 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-700"}`,style:j==="ai"?{backgroundColor:m}:{},children:[e.jsx(te,{className:"w-4 h-4"})," AI Generate"]}),e.jsxs(W,{value:"pexels",className:`flex items-center justify-center gap-2 text-xs sm:text-sm py-2 px-3 rounded-md transition-colors ${j==="pexels"?"text-white shadow-sm":"text-neutral-600 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-700"}`,style:j==="pexels"?{backgroundColor:m}:{},children:[e.jsx(ce,{className:"w-4 h-4"})," Pexels Video"]}),e.jsxs(W,{value:"upload",className:`flex items-center justify-center gap-2 text-xs sm:text-sm py-2 px-3 rounded-md transition-colors ${j==="upload"?"text-white shadow-sm":"text-neutral-600 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-700"}`,style:j==="upload"?{backgroundColor:m}:{},children:[e.jsx(ue,{className:"w-4 h-4"})," Upload"]})]}),e.jsxs(O,{value:"ai",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(K,{htmlFor:"aiPrompt",className:"text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1.5 block",children:"AI Video Prompt"}),e.jsx(Y,{id:"aiPrompt",value:P,onChange:t=>h(t.target.value),placeholder:"e.g., Serene beach with calm waves",disabled:C,className:a})]}),T&&e.jsx("p",{className:"text-xs text-red-500 text-center",children:T}),e.jsxs(J,{className:"justify-start pt-2",children:[e.jsx(y,{className:B,onClick:()=>i(!1),disabled:C,children:"Cancel"}),e.jsx(y,{style:{backgroundColor:m},className:D,onClick:z,disabled:C||!P.trim(),children:C?"Generating...":"Generate Video"})]})]}),e.jsxs(O,{value:"pexels",className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Y,{id:"pexelsQuery",value:A,onChange:t=>U(t.target.value),placeholder:"e.g., Nature, Business",disabled:f,className:`${a} flex-grow`}),e.jsx(y,{style:{backgroundColor:m},className:`${D} h-10`,onClick:H,disabled:f||!A.trim(),children:f?"Searching...":e.jsx(xe,{className:"w-4 h-4"})})]}),L&&e.jsx("p",{className:"text-xs text-red-500 text-center",children:L}),f&&e.jsx("p",{className:"text-xs text-neutral-500 dark:text-neutral-400 text-center",children:"Loading video..."}),!f&&F&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border-2 border-transparent hover:border-primary transition-all w-full max-w-md",onClick:()=>G(F.videoUrl),style:{"--hover-border-color":m},children:[e.jsx("img",{src:F.imageUrl,alt:`Pexels video by ${F.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-black/20 group-hover:bg-black/40 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:e.jsx(Play,{className:"w-8 h-8 text-white"})})]})}),e.jsx(J,{className:"justify-start pt-2",children:e.jsx(y,{className:B,onClick:()=>i(!1),disabled:f,children:"Cancel"})})]}),e.jsxs(O,{value:"upload",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(K,{htmlFor:"video-upload-input",className:"text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1.5 block",children:"Select Video File (Max 50MB)"}),e.jsx(Y,{id:"video-upload-input",type:"file",accept:"video/*",onChange:Q,className:`${a} file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-primary/10 dark:file:bg-primary/20 file:text-primary dark:file:text-primary-light hover:file:bg-primary/20 dark:hover:file:bg-primary/30`,style:{"--file-text-color":m},disabled:o}),N&&e.jsxs("p",{className:"text-xs text-neutral-500 dark:text-neutral-400 mt-1.5",children:["Selected: ",N.name," (",(N.size/1024/1024).toFixed(2)," MB)"]}),V&&e.jsx("p",{className:"text-xs text-red-500 text-center mt-1.5",children:V})]}),e.jsxs(J,{className:"justify-start pt-2",children:[e.jsx(y,{className:B,onClick:()=>i(!1),disabled:o,children:"Cancel"}),e.jsx(y,{style:{backgroundColor:m},className:D,onClick:R,disabled:o||!N,children:o?"Uploading...":"Confirm Upload"})]})]})]})]})})},ke=({store:d,isPublishedView:i=!1})=>{var R;const{name:M,theme:q,heroImage:u,content:s,id:x,hero_video_url:m,hero_video_poster_url:j}=d,{updateStoreTextContent:k,updateStore:P,viewMode:h}=ee(),[C,S]=r.useState(0),[T,w]=r.useState([]),[A,U]=r.useState(!1),[F,E]=r.useState(!1),{scrollY:f}=ge(),_=X(f,[0,500],[0,100]),L=X(f,[0,300],[1,.9]),g=(s==null?void 0:s.heroTitle)||`Welcome to ${M}`,N=(s==null?void 0:s.heroDescription)||"Discover amazing products and experiences that will transform your lifestyle. Fresh ideas, delivered daily.",I=(s==null?void 0:s.heroPrimaryCtaText)||"Explore Collection",V=(s==null?void 0:s.heroSecondaryCtaText)||"Watch Our Story",b=(s==null?void 0:s.heroBadgeText)||"Fresh Arrivals Daily",o=d==null?void 0:d.hero_video_url,c=(d==null?void 0:d.hero_video_poster_url)||((R=u==null?void 0:u.src)==null?void 0:R.large)||"https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=1200&q=80";r.useEffect(()=>{(async()=>{if(o)w([]);else{let l=[];c&&l.push(c);const D=M||"lifestyle";try{const n=await je(D,3);if(n&&n.photos&&n.photos.length>0){const t=n.photos.map(p=>p.src).filter(p=>p!==c);l=[...new Set([...l,...t])]}}catch(n){console.error("Failed to fetch Pexels photos for slideshow:",n)}if(l.length<2){const n=["https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=1200&q=80","https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=1200&q=80","https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=1200&q=80"].filter(t=>!l.includes(t));l.push(...n.slice(0,3-l.length))}w(l.slice(0,4)),S(0);const B=setInterval(()=>{S(n=>(n+1)%(l.slice(0,4).length||1))},6e3);return()=>clearInterval(B)}})()},[o,M,c]);const z=()=>{U(!0)},H=async a=>{if(x)try{await P(x,{hero_video_url:a,hero_video_poster_url:a?"":c})}catch(l){console.error("Failed to update store with new hero video URL:",l)}},G=()=>{const a=document.getElementById(`products-${x}`);a&&a.scrollIntoView({behavior:"smooth"})},Q=()=>{const a=document.getElementById(`features-${x}`);a&&a.scrollIntoView({behavior:"smooth"})};return e.jsxs("section",{className:"relative min-h-[90vh] md:min-h-screen flex items-center justify-center overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0",children:[o?e.jsxs("div",{className:"relative w-full h-full group",children:[e.jsx("video",{src:o,poster:c,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",onPlay:()=>E(!0),onPause:()=>E(!1)},o),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-black/10"}),e.jsx(be,{children:!F&&e.jsx(v.div,{initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.7},className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center border border-white/30 shadow-xl",children:e.jsx(Z,{className:"w-6 h-6 text-white ml-0.5"})})})})]}):T.length>0&&T.map((a,l)=>e.jsx(v.div,{className:"absolute inset-0",initial:{opacity:0,scale:1.05},animate:{opacity:l===C?1:0,scale:l===C?1:1.05},transition:{duration:1.2,ease:[.42,0,.58,1]},children:e.jsx("img",{src:a,alt:"Hero background",className:"w-full h-full object-cover"})},a+"-"+l)),!o&&T.length===0&&e.jsx("div",{className:"absolute inset-0 bg-neutral-800 flex items-center justify-center",children:e.jsx("p",{className:"text-neutral-500",children:"Loading background..."})}),!o&&T.length>0&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/30 via-black/10 to-transparent"})]}),!i&&h==="edit"&&e.jsx(y,{variant:"outline",size:"icon",className:"absolute top-[76px] right-4 z-20 bg-black/50 hover:bg-black/70 text-white backdrop-blur-sm border-white/30 rounded-md shadow-md",onClick:z,title:"Replace Media",children:e.jsx(ve,{className:"h-4 w-4"})}),e.jsx(v.div,{className:"container mx-auto px-4 sm:px-6 relative z-10",style:{y:_,opacity:L},children:e.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.7,ease:"easeOut"},className:"inline-flex items-center gap-2 px-4 py-1.5 bg-white/15 backdrop-blur-md rounded-full text-white text-xs sm:text-sm font-medium mb-6 border border-white/25",children:[e.jsx(te,{className:"w-3.5 h-3.5 text-yellow-300"}),e.jsx($,{initialText:b,onSave:a=>k("heroBadgeText",a),isAdmin:!i&&h==="edit",as:"span",textClassName:"",inputClassName:"bg-transparent"})]}),e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.7,ease:"easeOut"},children:e.jsx($,{initialText:g,onSave:a=>k("heroTitle",a),isAdmin:!i&&h==="edit",as:"h1",textClassName:"text-4xl sm:text-5xl md:text-6xl font-bold leading-tight tracking-tight text-white mb-5",inputClassName:"text-4xl sm:text-5xl md:text-6xl font-bold leading-tight tracking-tight text-white mb-5 bg-transparent",className:"text-4xl sm:text-5xl md:text-6xl font-bold leading-tight tracking-tight text-white mb-5"})}),e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.7,ease:"easeOut"},className:"mb-5",children:e.jsx($,{initialText:N,onSave:a=>k("heroDescription",a),isAdmin:!i&&h==="edit",as:"p",textClassName:"text-lg sm:text-xl text-white/80 max-w-2xl mx-auto leading-relaxed",inputClassName:"text-lg sm:text-xl text-white/80 max-w-2xl mx-auto leading-relaxed bg-transparent",className:"text-lg sm:text-xl text-white/80 max-w-2xl mx-auto leading-relaxed",useTextarea:!0})}),e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.7,ease:"easeOut"},className:"flex flex-col sm:flex-row justify-center gap-3 sm:gap-4",children:[e.jsx(v.div,{whileHover:{scale:1.03},whileTap:{scale:.97},children:e.jsxs(y,{onClick:G,size:"lg",className:"group relative overflow-hidden bg-white text-neutral-900 hover:bg-neutral-50 border-0 rounded-xl px-7 py-3 text-base font-semibold shadow-lg hover:shadow-xl transition-all duration-300 w-full sm:w-auto",children:[e.jsx($,{initialText:I,onSave:a=>k("heroPrimaryCtaText",a),isAdmin:!i&&h==="edit",as:"span",textClassName:"",inputClassName:"bg-transparent"}),e.jsx(ye,{className:"w-4 h-4 ml-2 transition-transform group-hover:translate-x-1"})]})}),e.jsx(v.div,{whileHover:{scale:1.03},whileTap:{scale:.97},children:e.jsxs(y,{onClick:Q,variant:"outline",size:"lg",className:"group relative overflow-hidden bg-white/10 backdrop-blur-md text-white hover:bg-white/20 border-white/30 hover:border-white/40 rounded-xl px-7 py-3 text-base font-semibold transition-all duration-300 w-full sm:w-auto",children:[e.jsx($,{initialText:V,onSave:a=>k("heroSecondaryCtaText",a),isAdmin:!i&&h==="edit",as:"span",textClassName:"",inputClassName:"bg-transparent"}),e.jsx(Z,{className:"w-4 h-4 ml-2 group-hover:fill-white/20 transition-all"})]})})]})]})}),!i&&x&&e.jsx(we,{open:A,onOpenChange:U,storeId:x,currentVideoUrl:o,onVideoReplaced:H})]})};export{ke as default};
