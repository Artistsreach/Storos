import{ai as me,aj as n,am as e,ap as d,av as B,by as re,ar as oe,au as h,bi as ue,b$ as le,c0 as ne,ao as xe,bZ as pe,b7 as be,bA as he,bW as ge,bk as fe,at as y,aB as de,aA as ce,aC as ve,c1 as je}from"./index-72b1491b.js";const ye=({product:N,theme:a,index:o,storeName:w,storeId:i,isPublishedView:l=!1,displayMode:c="grid"})=>{var _,q,H,I,U,W,X,Z,J,R,V,Y,D,K,Q,ee,te,se,ae,ie;const{addToCart:m,updateStore:b,currentStore:x}=me(),[t,C]=n.useState(N);n.useEffect(()=>{C(N)},[N]);const[P,g]=n.useState(!1),[T,A]=n.useState(!1),[f,k]=n.useState(!1),E=!l,F=r=>typeof r=="string"&&r.startsWith("gid://shopify/"),v=t.id,S=F(v)?btoa(v):v,u=t.inventory_count,L=r=>{r.stopPropagation(),(t.inventory_count===void 0||t.inventory_count>0)&&m(t,i)};a!=null&&a.primaryColor;const M={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,delay:o*.05,type:"spring",stiffness:120,damping:14}}},z={hover:{scale:1.08,transition:{duration:.4,ease:"easeInOut"}},initial:{scale:1}},s={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.2,ease:"easeOut"}}},p=r=>{r.stopPropagation(),r.preventDefault(),k(!0)},G=()=>{k(!1)},$=async r=>{if(i&&v)try{if(await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/manage-product",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("supabase.auth.token")}`},body:JSON.stringify({store_id:i,product_id:v,...r})}),C(j=>({...j,...r})),x&&x.id===i&&x.products){const j=x.products.map(O=>O.id===v?{...O,...r}:O);b(i,{products:j})}else x&&x.id===i&&!x.products&&b(i,{products:[{...t,...r}]});k(!1)}catch(j){console.error("Failed to save product changes:",j)}};return c==="list"?e.jsxs(e.Fragment,{children:[e.jsxs(d.div,{variants:M,initial:"hidden",animate:"visible",className:"bg-slate-800/70 rounded-md overflow-hidden shadow-lg hover:shadow-blue-900/40 transition-all duration-300 border border-slate-700 hover:border-blue-600/70 group flex",onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:[e.jsxs(B,{to:`/${w}/product/${S}`,className:"w-1/3 block relative overflow-hidden bg-slate-700 aspect-[3/4]",children:[" ",(q=(_=t.image)==null?void 0:_.src)!=null&&q.medium||(I=(H=t.image)==null?void 0:H.src)!=null&&I.large||Array.isArray(t.images)&&t.images.length>0&&t.images[0]?e.jsx(d.img,{src:((W=(U=t.image)==null?void 0:U.src)==null?void 0:W.medium)||((Z=(X=t.image)==null?void 0:X.src)==null?void 0:Z.large)||t.images[0],alt:t.name,className:"w-full h-full object-cover",variants:z,initial:"initial",whileHover:"hover",onLoad:()=>A(!0),animate:T?"visible":"hidden"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-700 text-slate-500 text-3xl font-bold font-mono",children:((J=t.name)==null?void 0:J.charAt(0))||"X"})]}),e.jsxs("div",{className:"w-2/3 p-4 sm:p-5 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs(re,{variant:"outline",className:"mb-2 border-blue-600/50 text-blue-400 bg-blue-900/30 text-xs font-mono uppercase px-2 py-0.5",children:[e.jsx(oe,{className:"w-3 h-3 mr-1.5"})," Featured"]}),e.jsxs(B,{to:`/${w}/product/${S}`,children:[" ",e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-100 hover:text-blue-400 transition-colors mb-1 font-mono uppercase tracking-wide line-clamp-2",children:t.name})]}),e.jsx("p",{className:"text-slate-400 text-xs sm:text-sm mb-1 line-clamp-2 leading-snug",children:t.description})]}),e.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[e.jsxs("div",{className:"text-lg sm:text-xl font-bold text-blue-400 font-mono",children:["$",((R=t.price)==null?void 0:R.toFixed(2))||"N/A"]}),e.jsxs(h,{onClick:L,size:"sm",className:"bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white border-0 rounded-md px-3 py-1.5 sm:px-4 text-xs sm:text-sm font-mono uppercase tracking-wider",disabled:u!==void 0&&u<=0,children:[e.jsx(ue,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5"}),u!==void 0&&u<=0?"Out of Stock":"Add to Cart"]}),E&&e.jsxs(h,{onClick:p,size:"sm",variant:"outline",className:"border-blue-600/70 text-blue-400 hover:bg-blue-700/30 rounded-md px-3 py-1.5 sm:px-4 text-xs sm:text-sm font-mono uppercase tracking-wider ml-2",children:[e.jsx(le,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5"}),"Edit"]})]})]})]}),f&&e.jsx(ne,{product:t,isOpen:f,onClose:G,onSave:$,storeId:i,theme:a})]}):e.jsxs(e.Fragment,{children:[e.jsxs(d.div,{variants:M,initial:"hidden",animate:"visible",className:"bg-slate-800/70 rounded-lg overflow-hidden shadow-lg hover:shadow-blue-900/40 transition-all duration-300 border border-slate-700 hover:border-blue-600/70 group relative",onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),whileHover:{y:-5},children:[e.jsxs(B,{to:`/${w}/product/${S}`,className:"block",children:[" ",e.jsxs("div",{className:"aspect-square relative overflow-hidden bg-slate-700",children:[(Y=(V=t.image)==null?void 0:V.src)!=null&&Y.medium||(K=(D=t.image)==null?void 0:D.src)!=null&&K.large||Array.isArray(t.images)&&t.images.length>0&&t.images[0]?e.jsx(d.img,{src:((ee=(Q=t.image)==null?void 0:Q.src)==null?void 0:ee.medium)||((se=(te=t.image)==null?void 0:te.src)==null?void 0:se.large)||t.images[0],alt:t.name,className:"w-full h-full object-cover",variants:z,initial:"initial",whileHover:"hover",onLoad:()=>A(!0),animate:T?"visible":"hidden"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-700 text-slate-500 text-5xl font-bold font-mono",children:((ae=t.name)==null?void 0:ae.charAt(0))||"X"}),e.jsx(xe,{children:P&&!E&&e.jsxs(d.div,{variants:s,initial:"hidden",animate:"visible",exit:"hidden",className:"absolute top-2 right-2 flex flex-col gap-1.5 z-10",children:[e.jsx(h,{variant:"outline",size:"icon",className:"h-7 w-7 bg-slate-800/70 border-slate-600 text-slate-300 hover:text-blue-400 hover:border-blue-500/70 backdrop-blur-sm rounded-md",children:e.jsx(pe,{className:"h-3.5 w-3.5"})}),e.jsx(h,{variant:"outline",size:"icon",className:"h-7 w-7 bg-slate-800/70 border-slate-600 text-slate-300 hover:text-blue-400 hover:border-blue-500/70 backdrop-blur-sm rounded-md",children:e.jsx(be,{className:"h-3.5 w-3.5"})})]})}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsxs(re,{variant:"outline",className:"border-blue-600/50 text-blue-400 bg-blue-900/30 text-[10px] font-mono uppercase px-1.5 py-0.5",children:[e.jsx(he,{className:"w-2.5 h-2.5 mr-1"})," ","New"]})})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs(B,{to:`/${w}/product/${S}`,children:[" ",e.jsx("h3",{className:"text-md font-semibold text-slate-100 hover:text-blue-400 transition-colors mb-1 font-mono uppercase tracking-wide line-clamp-2",children:t.name})]}),e.jsx("p",{className:"text-slate-400 text-xs sm:text-sm mb-1 line-clamp-2 leading-snug",children:t.description}),e.jsx("div",{className:"flex items-center gap-1 mb-1",children:[...Array(5)].map((r,j)=>e.jsx(oe,{className:`w-3 h-3 ${j<(t.rating||4)?"fill-yellow-400 text-yellow-400":"fill-slate-600 text-slate-600"}`},j))}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-lg font-bold text-blue-400 font-mono",children:["$",((ie=t.price)==null?void 0:ie.toFixed(2))||"N/A"]}),e.jsxs(h,{onClick:L,size:"sm",className:"bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white border-0 rounded-md px-3 py-1.5 text-xs font-mono uppercase tracking-wider",disabled:u!==void 0&&u<=0,children:[e.jsx(ge,{className:"h-3.5 w-3.5 mr-1"}),u!==void 0&&u<=0?"Out of Stock":"Add"]})]}),E&&e.jsxs(h,{onClick:p,variant:"outline",size:"sm",className:"w-full mt-3 border-blue-600/70 text-blue-400 hover:bg-blue-700/30 rounded-md text-xs font-mono uppercase tracking-wider",children:[e.jsx(le,{className:"h-3.5 w-3.5 mr-1.5"}),"Edit Product"]})]})]}),f&&e.jsx(ne,{product:t,isOpen:f,onClose:G,onSave:$,storeId:i,theme:a})]})},Se=({store:N,isPublishedView:a=!1})=>{const{products:o=[],theme:w={},id:i,content:l={}}=N||{},{updateStoreTextContent:c,viewMode:m}=me(),[b,x]=n.useState("grid"),[t,C]=n.useState(""),[P,g]=n.useState(Array.isArray(o)?o:[]),[T,A]=n.useState(!0),f=l.productGridSectionTitle||"Our Products",k=l.productGridSectionSubtitle||"Explore our curated selection of high-quality items.",E=l.productGridBadgeText||"Featured Products",F=l.productGridSearchPlaceholder||"Search Arsenal...",v=l.productGridNoProductsTitle||"No Gear Found",S=l.productGridNoProductsSubtitle||'Your search for "{searchTerm}" yielded no results. Try a different term or clear search.',u=l.productGridClearSearchButtonText||"Clear Search",L=l.productGridEmptyStateTitle||f,M=l.productGridEmptyStateSubtitle||"No equipment listed at this time. Stand by for inventory updates.";n.useEffect(()=>{A(!0);const s=setTimeout(()=>{g(Array.isArray(o)?o:[]),A(!1)},500);return()=>clearTimeout(s)},[o]),n.useEffect(()=>{if(!Array.isArray(o)){g([]);return}let s=o;t.trim()!==""&&(s=s.filter(p=>{var G,$;return((G=p.name)==null?void 0:G.toLowerCase().includes(t.toLowerCase()))||(($=p.description)==null?void 0:$.toLowerCase().includes(t.toLowerCase()))})),g(s)},[t,o]);const z=()=>e.jsxs("div",{className:"bg-slate-800 rounded-lg overflow-hidden shadow-md border border-slate-700/50 animate-pulse",children:[e.jsx("div",{className:"aspect-square bg-slate-700"}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("div",{className:"h-4 bg-slate-700 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-slate-700 rounded w-1/2"}),e.jsx("div",{className:"h-5 bg-blue-700/50 rounded w-1/3 mt-2"})]})]});return!o&&!T?e.jsx("section",{id:`products-${i}`,className:"py-16 md:py-24 bg-slate-900 text-white",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 text-center",children:[e.jsx(fe,{className:"w-12 h-12 text-blue-500 mx-auto mb-4"}),e.jsx(y,{initialText:L,onSave:s=>c("productGridEmptyStateTitle",s),isAdmin:!a&&m==="edit",as:"h2",textClassName:"text-3xl font-bold mb-3 font-mono uppercase",inputClassName:"text-3xl font-bold mb-3 font-mono uppercase bg-transparent",className:"text-3xl font-bold mb-3 font-mono uppercase"}),e.jsx(y,{initialText:M,onSave:s=>c("productGridEmptyStateSubtitle",s),isAdmin:!a&&m==="edit",as:"p",textClassName:"text-slate-400 text-lg",inputClassName:"text-slate-400 text-lg bg-transparent",className:"text-slate-400 text-lg",useTextarea:!0})]})}):e.jsx("section",{id:`products-${i}`,className:"py-16 md:py-24 bg-slate-900 text-white",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6",children:[e.jsxs(d.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:{duration:.5},className:"text-center mb-10 md:mb-12",children:[e.jsxs(d.div,{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-blue-800/30 rounded-md text-xs font-semibold text-blue-300 mb-4 border border-blue-700/50 font-mono uppercase tracking-widest",initial:{scale:.9,opacity:0},whileInView:{scale:1,opacity:1},viewport:{once:!0},transition:{delay:.1,duration:.4},children:[e.jsx(de,{className:"w-3.5 h-3.5"})," ",e.jsx(y,{initialText:E,onSave:s=>c("productGridBadgeText",s),isAdmin:!a&&m==="edit",as:"span",textClassName:"",inputClassName:"bg-transparent"})]}),e.jsx(y,{initialText:f,onSave:s=>c("productGridSectionTitle",s),isAdmin:!a&&m==="edit",as:"h2",textClassName:"text-3xl md:text-5xl font-extrabold tracking-tight font-mono uppercase mb-3",inputClassName:"text-3xl md:text-5xl font-extrabold tracking-tight font-mono uppercase mb-3 bg-transparent",className:"text-3xl md:text-5xl font-extrabold tracking-tight font-mono uppercase mb-3",children:e.jsx("span",{className:"bg-gradient-to-r from-slate-100 via-blue-400 to-sky-400 bg-clip-text text-transparent",children:f})}),e.jsx(y,{initialText:k,onSave:s=>c("productGridSectionSubtitle",s),isAdmin:!a&&m==="edit",as:"p",textClassName:"text-slate-400 max-w-xl mx-auto text-md md:text-lg leading-relaxed",inputClassName:"text-slate-400 max-w-xl mx-auto text-md md:text-lg leading-relaxed bg-transparent",className:"text-slate-400 max-w-xl mx-auto text-md md:text-lg leading-relaxed",useTextarea:!0})]}),e.jsxs(d.div,{initial:{opacity:0,y:15},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.2,duration:.5},className:"flex flex-col md:flex-row justify-between items-center mb-8 md:mb-10 gap-4",children:[e.jsxs("div",{className:"relative w-full md:max-w-sm",children:[e.jsx(ce,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-500 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:F,className:"w-full pl-10 pr-4 py-2.5 text-sm border-2 border-slate-700 rounded-md focus:outline-none focus:border-blue-500/70 bg-slate-800 transition-colors text-slate-100 placeholder-slate-500 font-mono",value:t,onChange:s=>C(s.target.value)})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1 bg-slate-800 rounded-md p-0.5 border border-slate-700",children:[e.jsx(h,{variant:"ghost",size:"icon",className:`h-8 w-8 rounded-sm transition-all duration-200 ${b==="grid"?"bg-blue-600 text-white":"text-slate-400 hover:text-blue-400 hover:bg-slate-700/50"}`,onClick:()=>x("grid"),title:"Grid View",children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx(h,{variant:"ghost",size:"icon",className:`h-8 w-8 rounded-sm transition-all duration-200 ${b==="list"?"bg-blue-600 text-white":"text-slate-400 hover:text-blue-400 hover:bg-slate-700/50"}`,onClick:()=>x("list"),title:"List View",children:e.jsx(ve,{className:"h-4 w-4"})})]})})]}),e.jsx(xe,{mode:"wait",children:T?e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:b==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8":"space-y-6",children:Array(b==="grid"?8:3).fill(0).map((s,p)=>e.jsx(z,{},`skeleton-${p}`))},"loading-grid"):P.length>0?e.jsx(d.div,{variants:Ne,initial:"hidden",animate:"visible",className:b==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8":"space-y-6",children:P.map((s,p)=>e.jsx(ye,{product:s,theme:w,index:p,storeName:je(N.name),storeId:i,isPublishedView:a,displayMode:b},s.id||`product-${p}`))},"product-list"):e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[e.jsx(ce,{className:"w-10 h-10 text-slate-500 mx-auto mb-3"}),e.jsx(y,{initialText:v,onSave:s=>c("productGridNoProductsTitle",s),isAdmin:!a&&m==="edit",as:"h3",textClassName:"text-xl font-semibold text-white mb-2 font-mono",inputClassName:"text-xl font-semibold text-white mb-2 font-mono bg-transparent",className:"text-xl font-semibold text-white mb-2 font-mono"}),e.jsx(y,{initialText:S.replace("{searchTerm}",t),onSave:s=>c("productGridNoProductsSubtitle",s),isAdmin:!a&&m==="edit",as:"p",textClassName:"text-slate-400 font-mono text-sm",inputClassName:"text-slate-400 font-mono text-sm bg-transparent",className:"text-slate-400 font-mono text-sm",useTextarea:!0}),e.jsx(h,{variant:"link",onClick:()=>C(""),className:"text-blue-400 hover:text-blue-300 font-mono mt-3 text-sm",children:e.jsx(y,{initialText:u,onSave:s=>c("productGridClearSearchButtonText",s),isAdmin:!a&&m==="edit",as:"span",textClassName:"",inputClassName:"bg-transparent"})})]},"no-products")})]})})},Ne={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.07}}};export{Se as default};
