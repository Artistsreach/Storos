import{ai as I,aj as N,aF as R,aG as w,am as e,aH as F,aI as $,aJ as E,aK as U,aL as T,aM as k,aN as G,aO as K,aP as M,aQ as V,aR as B,aS as H,au as S,aT as L,aU as O,aV as z,aW as J,aX as Q,aw as W,aY as X,aZ as Y,a_ as Z,a$ as _}from"./index-72b1491b.js";const q=({product:s,isAdmin:t,onRemove:a,storeUrlSlug:l,onClose:m})=>{const b=L(),{attributes:h,listeners:g,setNodeRef:j,transform:x,transition:c}=O({id:s.id,disabled:!t}),n={transform:z.Transform.toString(x),transition:c},i=()=>{const f=encodeURIComponent(s.id);b(`/${l}/product/${f}`),m()},u=e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[t&&e.jsx("div",{...h,...g,className:"cursor-grab p-2",children:e.jsx(J,{className:"h-5 w-5 text-muted-foreground"})}),s.images&&s.images.length>0?e.jsx("img",{src:s.images[0],alt:s.name||"Product image",className:"w-16 h-16 object-cover rounded-md border"}):e.jsx("div",{className:"w-16 h-16 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.name||"Untitled Product"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.price?`$${parseFloat(s.price).toFixed(2)}`:"Price not available"})]})]});return e.jsx("div",{ref:j,style:n,className:"flex items-center justify-between p-3 border rounded-md hover:bg-muted/50 transition-colors",onClick:t?void 0:i,children:t?e.jsxs(e.Fragment,{children:[u,e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>a(s.id),children:e.jsx(Q,{className:"h-4 w-4 text-red-500"})})]}):e.jsxs(e.Fragment,{children:[u,e.jsx(W,{className:"h-5 w-5 text-muted-foreground"})]})})},ee=({isOpen:s,onClose:t,collection:a,store:l,storeId:m,isPublishedView:b})=>{const{updateStoreCollections:h,viewMode:g,user:j,currentStore:x}=I(),c=g==="edit",[n,i]=N.useState([]);N.useEffect(()=>{i(a.products||[])},[a]);const u=R(w(Z),w(Y,{coordinateGetter:X})),f=async()=>{if(!(a!=null&&a.id)||!m){console.error("Collection ID or Store ID is missing.");return}await h(m,a.id,n,j),t()},y=r=>{i(o=>o.filter(d=>d.id!==r))},D=r=>{const{active:o,over:d}=r;o.id!==d.id&&i(v=>{const P=v.findIndex(p=>p.id===o.id),C=v.findIndex(p=>p.id===d.id);return _(v,P,C)})};return a?e.jsx(F,{open:s,onOpenChange:t,children:e.jsxs($,{className:"sm:max-w-lg",children:[e.jsxs(E,{children:[e.jsx(U,{children:a.name||"Collection Products"}),e.jsx(T,{children:c?"Reorder or remove products in this collection.":`Browse products available in the "${a.name||"Unnamed"}" collection.`})]}),e.jsx(k,{className:"max-h-[60vh] p-1",children:e.jsx("div",{className:"py-4 space-y-3",children:n&&n.length>0?e.jsx(G,{sensors:u,collisionDetection:K,onDragEnd:D,children:e.jsx(M,{items:n.map(r=>r.id),strategy:V,children:n.map(r=>{var o,d;return e.jsx(q,{product:r,isAdmin:c,onRemove:y,storeUrlSlug:((o=x||l)==null?void 0:o.urlSlug)||((d=x||l)==null?void 0:d.name),onClose:t},r.id)})})}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No products found in this collection."})})}),e.jsxs(B,{className:"sm:justify-between",children:[e.jsx(H,{asChild:!0,children:e.jsx(S,{type:"button",variant:"outline",children:c?"Cancel":"Close"})}),c&&e.jsx(S,{type:"button",onClick:f,children:"Save Changes"})]})]})}):null};export{ee as C};
