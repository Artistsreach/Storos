import{r as a,j as e,ai as $,aj as z,ak as H,al as R,am as W,an as _,ao as J,ap as P,aq as S,ar as T,y as k,as as C,B as c,at as K,au as X}from"./index-eca7a0fb.js";const Z=({open:p,onOpenChange:s,storeId:I,currentVideoUrl:V,onVideoReplaced:r})=>{const[L,D]=a.useState("ai"),[d,j]=a.useState(""),[u,N]=a.useState(!1),[F,m]=a.useState(null),[f,U]=a.useState(""),[h,y]=a.useState(null),[i,w]=a.useState(!1),[E,l]=a.useState(null),[n,x]=a.useState(null),[A,o]=a.useState(null),[b,g]=a.useState(!1);a.useEffect(()=>{p&&(j(""),N(!1),m(null),U(""),y(null),w(!1),l(null),x(null),o(null),g(!1))},[p]);const G=async()=>{if(!d.trim()){m("Please enter a prompt for the video.");return}N(!0),m(null);try{console.log(`Generating video for store ${I} with prompt: "${d}"`);const t=await K(d);r&&r(t),s(!1),j("")}catch(t){console.error("Error generating video with AI:",t),m(t.message||"Failed to generate video. Please try again.")}finally{N(!1)}},M=async()=>{if(!f.trim()){l("Please enter a search query for Pexels.");return}w(!0),l(null),y(null);try{const t=await X(f);t.error?l(t.error):t.video?y(t.video):l("No video found for your query.")}catch(t){console.error("Error searching Pexels videos:",t),l(t.message||"Failed to search Pexels. Please try again.")}finally{w(!1)}},B=t=>{r&&t?(r(t),s(!1)):l("Invalid video URL selected or replacement handler missing.")},q=t=>{const v=t.target.files[0];if(v){if(v.size>50*1024*1024){o("File is too large. Please select a video under 50MB."),x(null);return}if(!v.type.startsWith("video/")){o("Invalid file type. Please select a video file."),x(null);return}x(v),o(null)}},Q=()=>{if(n&&r){g(!0),o(null);const t=new FileReader;t.onloadend=()=>{r(t.result),s(!1),x(null),g(!1)},t.onerror=()=>{o("Failed to read video file for upload."),g(!1)},t.readAsDataURL(n)}else o("No video file selected or replacement handler missing.")};return e.jsx($,{open:p,onOpenChange:s,children:e.jsxs(z,{className:"w-[90vw] sm:max-w-[672px] bg-slate-900 border-slate-700",children:[e.jsxs(H,{className:"text-left",children:[e.jsx(R,{className:"text-white font-mono uppercase tracking-wide",children:"Replace Hero Video"}),e.jsxs(W,{className:"text-left text-slate-400",children:["Current video:"," ",e.jsx("a",{href:V,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 underline truncate block max-w-full",children:V||"No video set"})]})]}),e.jsxs(_,{value:L,onValueChange:D,className:"w-full",children:[e.jsxs(J,{className:"grid w-full grid-cols-3 bg-slate-800 border-slate-700",children:[e.jsx(P,{value:"ai",className:"text-slate-300 data-[state=active]:bg-blue-600 data-[state=active]:text-white font-mono",children:"AI Generation (Veo)"}),e.jsx(P,{value:"pexels",className:"text-slate-300 data-[state=active]:bg-blue-600 data-[state=active]:text-white font-mono",children:"Search Pexels"}),e.jsx(P,{value:"upload",className:"text-slate-300 data-[state=active]:bg-blue-600 data-[state=active]:text-white font-mono",children:"Upload Video"})]}),e.jsxs(S,{value:"ai",className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"aiPrompt",className:"text-left block mb-1 text-slate-300 font-mono",children:"AI Video Prompt"}),e.jsx(k,{id:"aiPrompt",value:d,onChange:t=>j(t.target.value),placeholder:"e.g., Military tactical gear in action",disabled:u,className:"bg-slate-800 border-slate-600 text-white placeholder:text-slate-400 font-mono"})]}),F&&e.jsx("p",{className:"text-sm text-blue-400 text-center font-mono",children:F}),e.jsxs(C,{className:"justify-start pt-4",children:[e.jsx(c,{variant:"outline",onClick:()=>s(!1),disabled:u,className:"border-slate-600 text-slate-300 hover:bg-slate-800 font-mono",children:"Cancel"}),e.jsx(c,{onClick:G,disabled:u||!d.trim(),className:"bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white font-mono",children:u?"Generating...":"Generate Video"})]})]}),e.jsxs(S,{value:"pexels",className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{id:"pexelsQuery",value:f,onChange:t=>U(t.target.value),placeholder:"e.g., Military, Tactical, Combat",disabled:i,className:"flex-grow bg-slate-800 border-slate-600 text-white placeholder:text-slate-400 font-mono"}),e.jsx(c,{onClick:M,disabled:i||!f.trim(),className:"bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white font-mono",children:i?"Searching...":"Search"})]}),E&&e.jsx("p",{className:"text-sm text-blue-400 text-center font-mono",children:E}),i&&e.jsx("p",{className:"text-sm text-slate-400 text-center font-mono",children:"Loading Pexels video..."}),!i&&h&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border border-slate-700 hover:border-blue-600 w-full max-w-md",onClick:()=>B(h.videoUrl),children:[e.jsx("img",{src:h.imageUrl,alt:`Pexels video by ${h.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:e.jsx("p",{className:"text-white text-lg font-semibold text-center p-2 bg-black/50 rounded font-mono",children:"Use This Video"})})]})}),e.jsx(C,{className:"justify-start pt-4",children:e.jsx(c,{variant:"outline",onClick:()=>s(!1),disabled:i,className:"border-slate-600 text-slate-300 hover:bg-slate-800 font-mono",children:"Cancel"})})]}),e.jsxs(S,{value:"upload",className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"video-upload-input",className:"text-left block mb-1 text-slate-300 font-mono",children:"Select Video File"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(k,{id:"video-upload-input",type:"file",accept:"video/*",onChange:q,className:"flex-grow bg-slate-800 border-slate-600 text-white font-mono",disabled:b})}),n&&e.jsxs("p",{className:"text-sm text-slate-400 mt-2 font-mono",children:["Selected: ",n.name," (",(n.size/1024/1024).toFixed(2)," MB)"]}),A&&e.jsx("p",{className:"text-sm text-blue-400 text-center mt-2 font-mono",children:A})]}),e.jsxs(C,{className:"justify-start pt-4",children:[e.jsx(c,{variant:"outline",onClick:()=>s(!1),disabled:b,className:"border-slate-600 text-slate-300 hover:bg-slate-800 font-mono",children:"Cancel"}),e.jsx(c,{onClick:Q,disabled:b||!n,className:"bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white font-mono",children:b?"Uploading...":"Confirm Upload"})]})]})]})]})})};export{Z as R};
