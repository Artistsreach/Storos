import{r as d,u as ie,j as e,m as o,L as F,c as te,B as b,i as ne,k as ae,l as se,A as le,E as ce,H as xe,$ as me,S as de,z as pe,a0 as ue,I as k,n as re,y as he,G as ge,o as be}from"./index-8adc253b.js";import{L as ve}from"./list-dfd3e55d.js";const ye=({product:w,theme:i,index:p,storeName:u,storeId:l,isPublishedView:s=!1,displayMode:n="grid"})=>{var q,U,W,Y,D,J,R,V,K,Q,X,Z,ee;const[t,h]=d.useState(w);d.useEffect(()=>{h(w)},[w]);const{addToCart:P,updateStore:g,currentStore:c}=ie(),[z,v]=d.useState(!1),[T,A]=d.useState(!1),[j,M]=d.useState(!1),[N,$]=d.useState(!1),E=!s,O=r=>typeof r=="string"&&r.startsWith("gid://shopify/"),y=t.id,S=O(y)?btoa(y):y,x=t.inventory_count,B=r=>{r.stopPropagation(),P(t,l)},C=r=>{r.stopPropagation(),M(!j)},a=(i==null?void 0:i.primaryColor)||"#3B82F6",m={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,delay:p*.07,type:"spring",stiffness:100,damping:15}}},G={hover:{scale:1.05,transition:{duration:.35,ease:"circOut"}},initial:{scale:1}},L=r=>{r.stopPropagation(),r.preventDefault(),$(!0)},I=()=>{$(!1)},_=async r=>{if(l&&y)try{if(await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/manage-product",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("supabase.auth.token")}`},body:JSON.stringify({store_id:l,product_id:y,...r})}),h(f=>({...f,...r})),c&&c.id===l&&c.products){const f=c.products.map(H=>H.id===y?{...H,...r}:H);g(l,{products:f})}else c&&c.id===l&&!c.products&&g(l,{products:[{...t,...r}]});$(!1)}catch(f){console.error("Failed to save product changes:",f)}},oe={hidden:{opacity:0,y:8},visible:{opacity:1,y:0,transition:{duration:.25,ease:"easeOut"}}};return n==="list"?e.jsxs(e.Fragment,{children:[e.jsxs(o.div,{variants:m,initial:"hidden",animate:"visible",className:"group bg-white/70 dark:bg-slate-800/70 backdrop-blur-md rounded-2xl border border-slate-200/70 dark:border-slate-700/70 hover:border-primary/40 transition-all duration-300 shadow-sm hover:shadow-xl hover:shadow-primary/10 flex",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),children:[e.jsxs(F,{to:`/${u}/product/${S}`,className:"w-1/3 sm:w-40 md:w-48 block relative overflow-hidden rounded-l-2xl bg-slate-100 dark:bg-slate-700",children:[" ",(U=(q=t.image)==null?void 0:q.src)!=null&&U.medium||Array.isArray(t.images)&&t.images.length>0&&t.images[0]?e.jsx(o.img,{src:((Y=(W=t.image)==null?void 0:W.src)==null?void 0:Y.medium)||t.images[0],alt:t.name,className:"w-full h-full object-cover",variants:G,initial:"initial",whileHover:"hover",onLoad:()=>A(!0),animate:T?"visible":"hidden"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 dark:bg-slate-700 text-slate-400 dark:text-slate-500 text-3xl font-semibold",children:((D=t.name)==null?void 0:D.charAt(0))||"?"})]}),e.jsxs("div",{className:"w-2/3 p-4 sm:p-5 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs(F,{to:`/${u}/product/${S}`,children:[" ",e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-800 dark:text-white hover:text-primary dark:hover:text-primary-light transition-colors mb-1 line-clamp-2",children:t.name})]}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs sm:text-sm mb-2 line-clamp-2 leading-snug",children:t.description}),e.jsx("div",{className:"flex items-center gap-1 mb-1",children:[...Array(5)].map(r=>e.jsx(te,{className:`w-3.5 h-3.5 ${r<(t.rating||4)?"fill-yellow-400 text-yellow-400":"fill-slate-300 dark:fill-slate-600 text-slate-300 dark:text-slate-600"}`},r))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[e.jsxs("div",{className:"text-lg sm:text-xl font-bold",style:{color:a},children:["$",((J=t.price)==null?void 0:J.toFixed(2))||"0.00"]}),e.jsxs(b,{onClick:B,size:"sm",className:"bg-primary hover:bg-primary/90 text-white border-0 rounded-lg px-3 py-1.5 text-xs sm:text-sm",disabled:x!==void 0&&x<=0,children:[e.jsx(ne,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5"}),x!==void 0&&x<=0?"Out of Stock":"Add to Cart"]}),E&&e.jsxs(b,{onClick:L,size:"sm",variant:"outline",className:"border-primary/50 text-primary hover:bg-primary/10 rounded-lg px-3 py-1.5 text-xs sm:text-sm ml-2",children:[e.jsx(ae,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5"}),"Edit"]})]})]})]}),N&&e.jsx(se,{product:w,isOpen:N,onClose:I,onSave:_,storeId:l,theme:i})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o.div,{variants:m,initial:"hidden",animate:"visible",className:"group relative bg-white/70 dark:bg-slate-800/70 backdrop-blur-md rounded-2xl overflow-hidden border border-slate-200/70 dark:border-slate-700/70 hover:border-primary/40 transition-all duration-300 shadow-sm hover:shadow-xl hover:shadow-primary/10",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),whileHover:{y:-6},children:[e.jsxs(F,{to:`/${u}/product/${S}`,className:"block",children:[" ",e.jsxs("div",{className:"aspect-square relative overflow-hidden bg-slate-100 dark:bg-slate-700",children:[(V=(R=t.image)==null?void 0:R.src)!=null&&V.medium||Array.isArray(t.images)&&t.images.length>0&&t.images[0]?e.jsx(o.img,{src:((Q=(K=t.image)==null?void 0:K.src)==null?void 0:Q.medium)||t.images[0],alt:t.name,className:"w-full h-full object-cover",variants:G,initial:"initial",whileHover:"hover",onLoad:()=>A(!0),animate:T?"visible":"hidden"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 dark:bg-slate-700 text-slate-400 dark:text-slate-500 text-5xl font-semibold",children:((X=t.name)==null?void 0:X.charAt(0))||"?"}),e.jsx(le,{children:z&&!E&&e.jsxs(o.div,{variants:oe,initial:"hidden",animate:"visible",exit:"hidden",className:"absolute top-2.5 right-2.5 flex flex-col gap-1.5 z-10",children:[e.jsx(b,{variant:"outline",size:"icon",className:"h-8 w-8 bg-white/80 dark:bg-slate-800/80 border-slate-300/70 dark:border-slate-600/70 text-slate-600 dark:text-slate-300 hover:text-primary dark:hover:text-primary-light hover:border-primary/50 backdrop-blur-sm rounded-lg shadow-sm",children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsx(b,{variant:"outline",size:"icon",onClick:C,className:`h-8 w-8 bg-white/80 dark:bg-slate-800/80 border-slate-300/70 dark:border-slate-600/70 text-slate-600 dark:text-slate-300 hover:text-red-500 dark:hover:text-red-400 hover:border-red-500/50 backdrop-blur-sm rounded-lg shadow-sm ${j?"text-red-500 dark:text-red-400 border-red-500/50":""}`,children:e.jsx(xe,{className:`h-4 w-4 transition-colors ${j?"fill-red-500":""}`})})]})}),((Z=t.tags)==null?void 0:Z.includes("New"))&&e.jsxs(me,{variant:"default",className:"absolute top-2.5 left-2.5 bg-primary text-white text-[10px] px-1.5 py-0.5 rounded-full",children:[e.jsx(de,{className:"w-2.5 h-2.5 mr-1"})," NEW"]})]})]}),e.jsxs("div",{className:"p-4 sm:p-5",children:[e.jsxs(F,{to:`/${u}/product/${S}`,children:[" ",e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-slate-800 dark:text-white hover:text-primary dark:hover:text-primary-light transition-colors mb-1 line-clamp-2",children:t.name})]}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs sm:text-sm mb-2 line-clamp-2 leading-snug",children:t.description}),e.jsx("div",{className:"flex items-center gap-1 mb-1",children:[...Array(5)].map((r,f)=>e.jsx(te,{className:`w-3.5 h-3.5 ${f<(t.rating||4)?"fill-yellow-400 text-yellow-400":"fill-slate-300 dark:fill-slate-600 text-slate-300 dark:text-slate-600"}`},f))}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-base sm:text-lg font-bold",style:{color:a},children:["$",((ee=t.price)==null?void 0:ee.toFixed(2))||"N/A"]}),e.jsxs(b,{onClick:B,size:"sm",className:"bg-primary hover:bg-primary/90 text-white border-0 rounded-lg px-3 py-1.5 text-xs",disabled:x!==void 0&&x<=0,children:[e.jsx(pe,{className:"h-3.5 w-3.5 mr-1"}),x!==void 0&&x<=0?"Out of Stock":"Add"]})]}),E&&e.jsxs(b,{onClick:L,variant:"outline",size:"sm",className:"w-full mt-2 border-primary/50 text-primary hover:bg-primary/10 rounded-lg text-xs",children:[e.jsx(ae,{className:"h-3.5 w-3.5 mr-1.5"}),"Edit Product"]})]})]}),N&&e.jsx(se,{product:t,isOpen:N,onClose:I,onSave:_,storeId:l,theme:i})]})},je=({store:w,isPublishedView:i=!1})=>{const{products:p,theme:u,id:l,content:s}=w,{updateStoreTextContent:n,viewMode:t}=ie(),[h,P]=d.useState("grid"),[g,c]=d.useState(""),[z,v]=d.useState(p||[]),[T,A]=d.useState(!0),j=(s==null?void 0:s.productGridSectionTitle)||"Our Products",M=(s==null?void 0:s.productGridSectionSubtitle)||"Discover fresh arrivals and top picks, curated just for you.",N=(s==null?void 0:s.productGridBadgeText)||"Handpicked For You",$=(s==null?void 0:s.productGridSearchPlaceholder)||"Search products...",E=(s==null?void 0:s.productGridNoProductsTitle)||"No Products Found",O=(s==null?void 0:s.productGridNoProductsSubtitle)||'Your search for "{searchTerm}" did not match any products.',y=(s==null?void 0:s.productGridClearSearchButtonText)||"Clear Search",S=(s==null?void 0:s.productGridEmptyStateTitle)||j,x=(s==null?void 0:s.productGridEmptyStateSubtitle)||"Our product lineup is currently being updated. Please check back soon!";d.useEffect(()=>{A(!0);const a=setTimeout(()=>{v(p||[]),A(!1)},300);return()=>clearTimeout(a)},[p]),d.useEffect(()=>{if(!p){v([]);return}let a=p;g.trim()!==""&&(a=a.filter(m=>{var G,L;return((G=m.name)==null?void 0:G.toLowerCase().includes(g.toLowerCase()))||((L=m.description)==null?void 0:L.toLowerCase().includes(g.toLowerCase()))})),v(a)},[g,p]);const B=()=>e.jsxs("div",{className:"bg-white/60 dark:bg-slate-800/60 backdrop-blur-sm rounded-2xl overflow-hidden border border-slate-200/60 dark:border-slate-700/60 animate-pulse",children:[e.jsx("div",{className:"aspect-square bg-slate-200 dark:bg-slate-700"}),e.jsxs("div",{className:"p-5 space-y-2.5",children:[e.jsx("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded-lg w-4/5"}),e.jsx("div",{className:"h-3 bg-slate-200 dark:bg-slate-700 rounded-lg w-3/5"}),e.jsx("div",{className:"h-5 bg-primary/20 rounded-lg w-1/3 mt-3"})]})]}),C=(u==null?void 0:u.primaryColor)||"#3B82F6";return!p&&!T?e.jsx("section",{id:`products-${l}`,className:"py-16 md:py-24 bg-slate-50 dark:bg-slate-800/90",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 text-center",children:[e.jsx(ue,{className:"w-12 h-12 mx-auto mb-4",style:{color:C}}),e.jsx(k,{initialText:S,onSave:a=>n("productGridEmptyStateTitle",a),isAdmin:!i&&t==="edit",as:"h2",textClassName:"text-3xl font-bold mb-3 text-slate-800 dark:text-white",inputClassName:"text-3xl font-bold mb-3 text-slate-800 dark:text-white bg-transparent",className:"text-3xl font-bold mb-3 text-slate-800 dark:text-white"}),e.jsx(k,{initialText:x,onSave:a=>n("productGridEmptyStateSubtitle",a),isAdmin:!i&&t==="edit",as:"p",textClassName:"text-slate-600 dark:text-slate-400 text-lg",inputClassName:"text-slate-600 dark:text-slate-400 text-lg bg-transparent",className:"text-slate-600 dark:text-slate-400 text-lg",useTextarea:!0})]})}):e.jsxs("section",{id:`products-${l}`,className:"py-16 md:py-24 bg-slate-50 dark:bg-slate-800/90 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-1/4 left-0 w-1/2 h-1/2 bg-gradient-to-br from-primary/5 to-transparent rounded-full -translate-x-1/2 blur-3xl opacity-50 dark:opacity-30"}),e.jsx("div",{className:"absolute bottom-1/4 right-0 w-1/2 h-1/2 bg-gradient-to-tl from-primary/5 to-transparent rounded-full translate-x-1/2 blur-3xl opacity-50 dark:opacity-30"}),e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 relative z-10",children:[e.jsxs(o.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:{duration:.6},className:"text-center mb-10 md:mb-14",children:[e.jsxs(o.div,{className:"inline-flex items-center gap-2 px-4 py-1.5 rounded-full text-sm font-medium mb-4",style:{backgroundColor:`${C}1A`,color:C,border:`1px solid ${C}40`},initial:{scale:.9,opacity:0},whileInView:{scale:1,opacity:1},viewport:{once:!0},transition:{delay:.1,duration:.4},children:[e.jsx(de,{className:"w-4 h-4"}),e.jsx(k,{initialText:N,onSave:a=>n("productGridBadgeText",a),isAdmin:!i&&t==="edit",as:"span",textClassName:"",inputClassName:"bg-transparent"})]}),e.jsx(k,{initialText:j,onSave:a=>n("productGridSectionTitle",a),isAdmin:!i&&t==="edit",as:"h2",textClassName:"text-3xl md:text-5xl font-bold tracking-tight mb-3 text-slate-800 dark:text-white",inputClassName:"text-3xl md:text-5xl font-bold tracking-tight mb-3 text-slate-800 dark:text-white bg-transparent",className:"text-3xl md:text-5xl font-bold tracking-tight mb-3 text-slate-800 dark:text-white"}),e.jsx(k,{initialText:M,onSave:a=>n("productGridSectionSubtitle",a),isAdmin:!i&&t==="edit",as:"p",textClassName:"text-slate-600 dark:text-slate-300 max-w-xl mx-auto text-md md:text-lg leading-relaxed",inputClassName:"text-slate-600 dark:text-slate-300 max-w-xl mx-auto text-md md:text-lg leading-relaxed bg-transparent",className:"text-slate-600 dark:text-slate-300 max-w-xl mx-auto text-md md:text-lg leading-relaxed",useTextarea:!0})]}),e.jsxs(o.div,{initial:{opacity:0,y:15},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.2,duration:.5},className:"flex flex-col md:flex-row justify-between items-center mb-8 md:mb-10 gap-4",children:[e.jsxs("div",{className:"relative w-full md:max-w-xs",children:[e.jsx(re,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-slate-400 dark:text-slate-500 h-4 w-4"}),e.jsx(he,{type:"text",placeholder:$,className:"w-full pl-10 pr-4 py-2.5 text-sm bg-white/70 dark:bg-slate-800/70 backdrop-blur-sm border-slate-300/70 dark:border-slate-700/70 rounded-xl focus:ring-primary/30 focus:border-primary/60 transition-colors text-slate-700 dark:text-slate-200 placeholder-slate-500 dark:placeholder-slate-400",value:g,onChange:a=>c(a.target.value)})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1 bg-white/70 dark:bg-slate-800/70 backdrop-blur-sm rounded-xl p-1 border border-slate-300/70 dark:border-slate-700/70",children:[e.jsx(b,{variant:"ghost",size:"icon",className:`h-8 w-8 rounded-lg transition-all duration-200 ${h==="grid"?"bg-primary text-white":"text-slate-500 dark:text-slate-400 hover:text-primary dark:hover:text-primary-light hover:bg-slate-100 dark:hover:bg-slate-700/50"}`,onClick:()=>P("grid"),title:"Grid View",children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx(b,{variant:"ghost",size:"icon",className:`h-8 w-8 rounded-lg transition-all duration-200 ${h==="list"?"bg-primary text-white":"text-slate-500 dark:text-slate-400 hover:text-primary dark:hover:text-primary-light hover:bg-slate-100 dark:hover:bg-slate-700/50"}`,onClick:()=>P("list"),title:"List View",children:e.jsx(ve,{className:"h-4 w-4"})})]})})]}),e.jsx(le,{mode:"wait",children:T?e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:h==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8":"space-y-6",children:Array(h==="grid"?8:3).fill(0).map((a,m)=>e.jsx(B,{},`skeleton-fresh-${m}`))},"loading-grid-fresh"):z.length>0?e.jsx(o.div,{variants:fe,initial:"hidden",animate:"visible",className:h==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8":"space-y-6",children:z.map((a,m)=>e.jsx(ye,{product:a,theme:u,index:m,storeName:be(w.name),storeId:l,isPublishedView:i,displayMode:h},a.id||`product-fresh-${m}`))},"product-list-fresh"):e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[e.jsx(re,{className:"w-10 h-10 text-slate-400 dark:text-slate-500 mx-auto mb-3"}),e.jsx(k,{initialText:E,onSave:a=>n("productGridNoProductsTitle",a),isAdmin:!i&&t==="edit",as:"h3",textClassName:"text-xl font-semibold text-slate-700 dark:text-white mb-2",inputClassName:"text-xl font-semibold text-slate-700 dark:text-white mb-2 bg-transparent",className:"text-xl font-semibold text-slate-700 dark:text-white mb-2"}),e.jsx(k,{initialText:O.replace("{searchTerm}",g),onSave:a=>n("productGridNoProductsSubtitle",a),isAdmin:!i&&t==="edit",as:"p",textClassName:"text-slate-500 dark:text-slate-400 text-sm",inputClassName:"text-slate-500 dark:text-slate-400 text-sm bg-transparent",className:"text-slate-500 dark:text-slate-400 text-sm",useTextarea:!0}),e.jsx(b,{variant:"link",onClick:()=>c(""),className:"text-primary hover:text-primary/80 mt-3 text-sm",children:e.jsx(k,{initialText:y,onSave:a=>n("productGridClearSearchButtonText",a),isAdmin:!i&&t==="edit",as:"span",textClassName:"",inputClassName:"bg-transparent"})})]},"no-products-fresh")})]})]})},fe={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.06}}};export{je as default};
