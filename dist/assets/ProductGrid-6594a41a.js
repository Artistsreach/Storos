import{r as o,u as te,j as e,m as n,L as z,c as Q,B as b,i as ie,k as X,A as ae,E as le,H as de,V as oe,S as se,a1 as ne,W as ce,I as k,l as Z,y as xe,G as me,n as pe}from"./index-1e2a087c.js";import{P as ee,L as ue}from"./ProductEditModal-3669a150.js";const he=({product:j,theme:l,index:p,storeName:u,storeId:d,isPublishedView:s=!1,displayMode:c="grid"})=>{var q,W,U,V,Y,D,J,R,K;const[t,h]=o.useState(j);o.useEffect(()=>{h(j)},[j]);const{addToCart:L,updateStore:g,currentStore:x}=te(),[O,v]=o.useState(!1),[T,A]=o.useState(!1),[N,F]=o.useState(!1),[w,$]=o.useState(!1),E=!s,M=r=>typeof r=="string"&&r.startsWith("gid://shopify/"),y=t.id,S=M(y)?btoa(y):y,i=t.inventory_count,B=r=>{r.stopPropagation(),L(t,d)},C=r=>{r.stopPropagation(),F(!N)},a=(l==null?void 0:l.primaryColor)||"#3B82F6",m={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,delay:p*.07,type:"spring",stiffness:100,damping:15}}},G={hover:{scale:1.05,transition:{duration:.35,ease:"circOut"}},initial:{scale:1}},P=r=>{r.stopPropagation(),r.preventDefault(),$(!0)},I=()=>{$(!1)},_=async r=>{if(d&&y)try{if(await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/manage-product",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("supabase.auth.token")}`},body:JSON.stringify({store_id:d,product_id:y,...r})}),h(f=>({...f,...r})),x&&x.id===d&&x.products){const f=x.products.map(H=>H.id===y?{...H,...r}:H);g(d,{products:f})}else x&&x.id===d&&!x.products&&g(d,{products:[{...t,...r}]});$(!1)}catch(f){console.error("Failed to save product changes:",f)}},re={hidden:{opacity:0,y:8},visible:{opacity:1,y:0,transition:{duration:.25,ease:"easeOut"}}};return c==="list"?e.jsxs(e.Fragment,{children:[e.jsxs(n.div,{variants:m,initial:"hidden",animate:"visible",className:"group bg-white/70 dark:bg-slate-800/70 backdrop-blur-md rounded-2xl border border-slate-200/70 dark:border-slate-700/70 hover:border-primary/40 transition-all duration-300 shadow-sm hover:shadow-xl hover:shadow-primary/10 flex",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),children:[e.jsxs(z,{to:`/${u}/product/${S}`,className:"w-1/3 sm:w-40 md:w-48 block relative overflow-hidden rounded-l-2xl bg-slate-100 dark:bg-slate-700",children:[" ",(W=(q=t.image)==null?void 0:q.src)!=null&&W.medium?e.jsx(n.img,{src:t.image.src.medium,alt:t.name,className:"w-full h-full object-cover",variants:G,initial:"initial",whileHover:"hover",onLoad:()=>A(!0),animate:T?"visible":"hidden"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 dark:bg-slate-700 text-slate-400 dark:text-slate-500 text-3xl font-semibold",children:((U=t.name)==null?void 0:U.charAt(0))||"?"})]}),e.jsxs("div",{className:"w-2/3 p-4 sm:p-5 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs(z,{to:`/${u}/product/${S}`,children:[" ",e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-800 dark:text-white hover:text-primary dark:hover:text-primary-light transition-colors mb-1 line-clamp-2",children:t.name})]}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs sm:text-sm mb-2 line-clamp-2 leading-snug",children:t.description}),e.jsx("div",{className:"flex items-center gap-1 mb-1",children:[...Array(5)].map(r=>e.jsx(Q,{className:`w-3.5 h-3.5 ${r<(t.rating||4)?"fill-yellow-400 text-yellow-400":"fill-slate-300 dark:fill-slate-600 text-slate-300 dark:text-slate-600"}`},r))}),e.jsx("div",{className:"text-xs mt-1 mb-2",children:i!==void 0?i>0?e.jsxs("span",{className:"text-green-500 dark:text-green-400 font-medium",children:["In Stock (",i,")"]}):e.jsx("span",{className:"text-red-500 dark:text-red-400 font-medium",children:"Out of Stock"}):e.jsx("span",{className:"text-slate-400 dark:text-slate-500",children:"Stock N/A"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[e.jsxs("div",{className:"text-lg sm:text-xl font-bold",style:{color:a},children:["$",((V=t.price)==null?void 0:V.toFixed(2))||"0.00"]}),e.jsxs(b,{onClick:B,size:"sm",className:"bg-primary hover:bg-primary/90 text-white border-0 rounded-lg px-3 py-1.5 text-xs sm:text-sm",disabled:i!==void 0&&i<=0,children:[e.jsx(ie,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5"}),i!==void 0&&i<=0?"Out of Stock":"Add to Cart"]}),E&&e.jsxs(b,{onClick:P,size:"sm",variant:"outline",className:"border-primary/50 text-primary hover:bg-primary/10 rounded-lg px-3 py-1.5 text-xs sm:text-sm ml-2",children:[e.jsx(X,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5"}),"Edit"]})]})]})]}),w&&e.jsx(ee,{product:j,isOpen:w,onClose:I,onSave:_,storeId:d,theme:l})]}):e.jsxs(e.Fragment,{children:[e.jsxs(n.div,{variants:m,initial:"hidden",animate:"visible",className:"group relative bg-white/70 dark:bg-slate-800/70 backdrop-blur-md rounded-2xl overflow-hidden border border-slate-200/70 dark:border-slate-700/70 hover:border-primary/40 transition-all duration-300 shadow-sm hover:shadow-xl hover:shadow-primary/10",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),whileHover:{y:-6},children:[e.jsxs(z,{to:`/${u}/product/${S}`,className:"block",children:[" ",e.jsxs("div",{className:"aspect-square relative overflow-hidden bg-slate-100 dark:bg-slate-700",children:[(D=(Y=t.image)==null?void 0:Y.src)!=null&&D.medium?e.jsx(n.img,{src:t.image.src.medium,alt:t.name,className:"w-full h-full object-cover",variants:G,initial:"initial",whileHover:"hover",onLoad:()=>A(!0),animate:T?"visible":"hidden"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 dark:bg-slate-700 text-slate-400 dark:text-slate-500 text-5xl font-semibold",children:((J=t.name)==null?void 0:J.charAt(0))||"?"}),e.jsx(ae,{children:O&&!E&&e.jsxs(n.div,{variants:re,initial:"hidden",animate:"visible",exit:"hidden",className:"absolute top-2.5 right-2.5 flex flex-col gap-1.5 z-10",children:[e.jsx(b,{variant:"outline",size:"icon",className:"h-8 w-8 bg-white/80 dark:bg-slate-800/80 border-slate-300/70 dark:border-slate-600/70 text-slate-600 dark:text-slate-300 hover:text-primary dark:hover:text-primary-light hover:border-primary/50 backdrop-blur-sm rounded-lg shadow-sm",children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(b,{variant:"outline",size:"icon",onClick:C,className:`h-8 w-8 bg-white/80 dark:bg-slate-800/80 border-slate-300/70 dark:border-slate-600/70 text-slate-600 dark:text-slate-300 hover:text-red-500 dark:hover:text-red-400 hover:border-red-500/50 backdrop-blur-sm rounded-lg shadow-sm ${N?"text-red-500 dark:text-red-400 border-red-500/50":""}`,children:e.jsx(de,{className:`h-4 w-4 transition-colors ${N?"fill-red-500":""}`})})]})}),((R=t.tags)==null?void 0:R.includes("New"))&&e.jsxs(oe,{variant:"default",className:"absolute top-2.5 left-2.5 bg-primary text-white text-[10px] px-1.5 py-0.5 rounded-full",children:[e.jsx(se,{className:"w-2.5 h-2.5 mr-1"})," NEW"]})]})]}),e.jsxs("div",{className:"p-4 sm:p-5",children:[e.jsxs(z,{to:`/${u}/product/${S}`,children:[" ",e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-slate-800 dark:text-white hover:text-primary dark:hover:text-primary-light transition-colors mb-1 line-clamp-2",children:t.name})]}),e.jsx("div",{className:"flex items-center gap-1 mb-1",children:[...Array(5)].map((r,f)=>e.jsx(Q,{className:`w-3.5 h-3.5 ${f<(t.rating||4)?"fill-yellow-400 text-yellow-400":"fill-slate-300 dark:fill-slate-600 text-slate-300 dark:text-slate-600"}`},f))}),e.jsx("div",{className:"text-xs mt-1 mb-2",children:i!==void 0?i>0?e.jsxs("span",{className:"text-green-500 dark:text-green-400 font-medium",children:["In Stock (",i,")"]}):e.jsx("span",{className:"text-red-500 dark:text-red-400 font-medium",children:"Out of Stock"}):e.jsx("span",{className:"text-slate-400 dark:text-slate-500",children:"Stock N/A"})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-base sm:text-lg font-bold",style:{color:a},children:["$",((K=t.price)==null?void 0:K.toFixed(2))||"N/A"]}),e.jsxs(b,{onClick:B,size:"sm",className:"bg-primary hover:bg-primary/90 text-white border-0 rounded-lg px-3 py-1.5 text-xs",disabled:i!==void 0&&i<=0,children:[e.jsx(ne,{className:"h-3.5 w-3.5 mr-1"}),i!==void 0&&i<=0?"Out of Stock":"Add"]})]}),E&&e.jsxs(b,{onClick:P,variant:"outline",size:"sm",className:"w-full mt-2 border-primary/50 text-primary hover:bg-primary/10 rounded-lg text-xs",children:[e.jsx(X,{className:"h-3.5 w-3.5 mr-1.5"}),"Edit Product"]})]})]}),w&&e.jsx(ee,{product:t,isOpen:w,onClose:I,onSave:_,storeId:d,theme:l})]})},ye=({store:j,isPublishedView:l=!1})=>{const{products:p,theme:u,id:d,content:s}=j,{updateStoreTextContent:c,viewMode:t}=te(),[h,L]=o.useState("grid"),[g,x]=o.useState(""),[O,v]=o.useState(p||[]),[T,A]=o.useState(!0),N=(s==null?void 0:s.productGridSectionTitle)||"Our Products",F=(s==null?void 0:s.productGridSectionSubtitle)||"Discover fresh arrivals and top picks, curated just for you.",w=(s==null?void 0:s.productGridBadgeText)||"Handpicked For You",$=(s==null?void 0:s.productGridSearchPlaceholder)||"Search products...",E=(s==null?void 0:s.productGridNoProductsTitle)||"No Products Found",M=(s==null?void 0:s.productGridNoProductsSubtitle)||'Your search for "{searchTerm}" did not match any products.',y=(s==null?void 0:s.productGridClearSearchButtonText)||"Clear Search",S=(s==null?void 0:s.productGridEmptyStateTitle)||N,i=(s==null?void 0:s.productGridEmptyStateSubtitle)||"Our product lineup is currently being updated. Please check back soon!";o.useEffect(()=>{A(!0);const a=setTimeout(()=>{v(p||[]),A(!1)},300);return()=>clearTimeout(a)},[p]),o.useEffect(()=>{if(!p){v([]);return}let a=p;g.trim()!==""&&(a=a.filter(m=>{var G,P;return((G=m.name)==null?void 0:G.toLowerCase().includes(g.toLowerCase()))||((P=m.description)==null?void 0:P.toLowerCase().includes(g.toLowerCase()))})),v(a)},[g,p]);const B=()=>e.jsxs("div",{className:"bg-white/60 dark:bg-slate-800/60 backdrop-blur-sm rounded-2xl overflow-hidden border border-slate-200/60 dark:border-slate-700/60 animate-pulse",children:[e.jsx("div",{className:"aspect-square bg-slate-200 dark:bg-slate-700"}),e.jsxs("div",{className:"p-5 space-y-2.5",children:[e.jsx("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded-lg w-4/5"}),e.jsx("div",{className:"h-3 bg-slate-200 dark:bg-slate-700 rounded-lg w-3/5"}),e.jsx("div",{className:"h-5 bg-primary/20 rounded-lg w-1/3 mt-3"})]})]}),C=(u==null?void 0:u.primaryColor)||"#3B82F6";return!p&&!T?e.jsx("section",{id:`products-${d}`,className:"py-16 md:py-24 bg-slate-50 dark:bg-slate-800/90",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 text-center",children:[e.jsx(ce,{className:"w-12 h-12 mx-auto mb-4",style:{color:C}}),e.jsx(k,{initialText:S,onSave:a=>c("productGridEmptyStateTitle",a),isAdmin:!l&&t==="edit",as:"h2",textClassName:"text-3xl font-bold mb-3 text-slate-800 dark:text-white",inputClassName:"text-3xl font-bold mb-3 text-slate-800 dark:text-white bg-transparent",className:"text-3xl font-bold mb-3 text-slate-800 dark:text-white"}),e.jsx(k,{initialText:i,onSave:a=>c("productGridEmptyStateSubtitle",a),isAdmin:!l&&t==="edit",as:"p",textClassName:"text-slate-600 dark:text-slate-400 text-lg",inputClassName:"text-slate-600 dark:text-slate-400 text-lg bg-transparent",className:"text-slate-600 dark:text-slate-400 text-lg",useTextarea:!0})]})}):e.jsxs("section",{id:`products-${d}`,className:"py-16 md:py-24 bg-slate-50 dark:bg-slate-800/90 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-1/4 left-0 w-1/2 h-1/2 bg-gradient-to-br from-primary/5 to-transparent rounded-full -translate-x-1/2 blur-3xl opacity-50 dark:opacity-30"}),e.jsx("div",{className:"absolute bottom-1/4 right-0 w-1/2 h-1/2 bg-gradient-to-tl from-primary/5 to-transparent rounded-full translate-x-1/2 blur-3xl opacity-50 dark:opacity-30"}),e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 relative z-10",children:[e.jsxs(n.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:{duration:.6},className:"text-center mb-10 md:mb-14",children:[e.jsxs(n.div,{className:"inline-flex items-center gap-2 px-4 py-1.5 rounded-full text-sm font-medium mb-4",style:{backgroundColor:`${C}1A`,color:C,border:`1px solid ${C}40`},initial:{scale:.9,opacity:0},whileInView:{scale:1,opacity:1},viewport:{once:!0},transition:{delay:.1,duration:.4},children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx(k,{initialText:w,onSave:a=>c("productGridBadgeText",a),isAdmin:!l&&t==="edit",as:"span",textClassName:"",inputClassName:"bg-transparent"})]}),e.jsx(k,{initialText:N,onSave:a=>c("productGridSectionTitle",a),isAdmin:!l&&t==="edit",as:"h2",textClassName:"text-3xl md:text-5xl font-bold tracking-tight mb-3 text-slate-800 dark:text-white",inputClassName:"text-3xl md:text-5xl font-bold tracking-tight mb-3 text-slate-800 dark:text-white bg-transparent",className:"text-3xl md:text-5xl font-bold tracking-tight mb-3 text-slate-800 dark:text-white"}),e.jsx(k,{initialText:F,onSave:a=>c("productGridSectionSubtitle",a),isAdmin:!l&&t==="edit",as:"p",textClassName:"text-slate-600 dark:text-slate-300 max-w-xl mx-auto text-md md:text-lg leading-relaxed",inputClassName:"text-slate-600 dark:text-slate-300 max-w-xl mx-auto text-md md:text-lg leading-relaxed bg-transparent",className:"text-slate-600 dark:text-slate-300 max-w-xl mx-auto text-md md:text-lg leading-relaxed",useTextarea:!0})]}),e.jsxs(n.div,{initial:{opacity:0,y:15},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.2,duration:.5},className:"flex flex-col md:flex-row justify-between items-center mb-8 md:mb-10 gap-4",children:[e.jsxs("div",{className:"relative w-full md:max-w-xs",children:[e.jsx(Z,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-slate-400 dark:text-slate-500 h-4 w-4"}),e.jsx(xe,{type:"text",placeholder:$,className:"w-full pl-10 pr-4 py-2.5 text-sm bg-white/70 dark:bg-slate-800/70 backdrop-blur-sm border-slate-300/70 dark:border-slate-700/70 rounded-xl focus:ring-primary/30 focus:border-primary/60 transition-colors text-slate-700 dark:text-slate-200 placeholder-slate-500 dark:placeholder-slate-400",value:g,onChange:a=>x(a.target.value)})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1 bg-white/70 dark:bg-slate-800/70 backdrop-blur-sm rounded-xl p-1 border border-slate-300/70 dark:border-slate-700/70",children:[e.jsx(b,{variant:"ghost",size:"icon",className:`h-8 w-8 rounded-lg transition-all duration-200 ${h==="grid"?"bg-primary text-white":"text-slate-500 dark:text-slate-400 hover:text-primary dark:hover:text-primary-light hover:bg-slate-100 dark:hover:bg-slate-700/50"}`,onClick:()=>L("grid"),title:"Grid View",children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx(b,{variant:"ghost",size:"icon",className:`h-8 w-8 rounded-lg transition-all duration-200 ${h==="list"?"bg-primary text-white":"text-slate-500 dark:text-slate-400 hover:text-primary dark:hover:text-primary-light hover:bg-slate-100 dark:hover:bg-slate-700/50"}`,onClick:()=>L("list"),title:"List View",children:e.jsx(ue,{className:"h-4 w-4"})})]})})]}),e.jsx(ae,{mode:"wait",children:T?e.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:h==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8":"space-y-6",children:Array(h==="grid"?8:3).fill(0).map((a,m)=>e.jsx(B,{},`skeleton-fresh-${m}`))},"loading-grid-fresh"):O.length>0?e.jsx(n.div,{variants:ge,initial:"hidden",animate:"visible",className:h==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8":"space-y-6",children:O.map((a,m)=>e.jsx(he,{product:a,theme:u,index:m,storeName:pe(j.name),storeId:d,isPublishedView:l,displayMode:h},a.id||`product-fresh-${m}`))},"product-list-fresh"):e.jsxs(n.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[e.jsx(Z,{className:"w-10 h-10 text-slate-400 dark:text-slate-500 mx-auto mb-3"}),e.jsx(k,{initialText:E,onSave:a=>c("productGridNoProductsTitle",a),isAdmin:!l&&t==="edit",as:"h3",textClassName:"text-xl font-semibold text-slate-700 dark:text-white mb-2",inputClassName:"text-xl font-semibold text-slate-700 dark:text-white mb-2 bg-transparent",className:"text-xl font-semibold text-slate-700 dark:text-white mb-2"}),e.jsx(k,{initialText:M.replace("{searchTerm}",g),onSave:a=>c("productGridNoProductsSubtitle",a),isAdmin:!l&&t==="edit",as:"p",textClassName:"text-slate-500 dark:text-slate-400 text-sm",inputClassName:"text-slate-500 dark:text-slate-400 text-sm bg-transparent",className:"text-slate-500 dark:text-slate-400 text-sm",useTextarea:!0}),e.jsx(b,{variant:"link",onClick:()=>x(""),className:"text-primary hover:text-primary/80 mt-3 text-sm",children:e.jsx(k,{initialText:y,onSave:a=>c("productGridClearSearchButtonText",a),isAdmin:!l&&t==="edit",as:"span",textClassName:"",inputClassName:"bg-transparent"})})]},"no-products-fresh")})]})]})},ge={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.06}}};export{ye as default};
