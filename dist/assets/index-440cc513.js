function tO(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var _v=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function i0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var nO={exports:{}},o0={},rO={exports:{}},ln={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pg=Symbol.for("react.element"),Wq=Symbol.for("react.portal"),Hq=Symbol.for("react.fragment"),qq=Symbol.for("react.strict_mode"),Kq=Symbol.for("react.profiler"),Yq=Symbol.for("react.provider"),Jq=Symbol.for("react.context"),Qq=Symbol.for("react.forward_ref"),Xq=Symbol.for("react.suspense"),Zq=Symbol.for("react.memo"),eK=Symbol.for("react.lazy"),Ak=Symbol.iterator;function tK(t){return t===null||typeof t!="object"?null:(t=Ak&&t[Ak]||t["@@iterator"],typeof t=="function"?t:null)}var sO={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},iO=Object.assign,oO={};function pf(t,e,n){this.props=t,this.context=e,this.refs=oO,this.updater=n||sO}pf.prototype.isReactComponent={};pf.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};pf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function aO(){}aO.prototype=pf.prototype;function x1(t,e,n){this.props=t,this.context=e,this.refs=oO,this.updater=n||sO}var v1=x1.prototype=new aO;v1.constructor=x1;iO(v1,pf.prototype);v1.isPureReactComponent=!0;var kk=Array.isArray,lO=Object.prototype.hasOwnProperty,w1={current:null},cO={key:!0,ref:!0,__self:!0,__source:!0};function uO(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)lO.call(e,r)&&!cO.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:pg,type:t,key:i,ref:o,props:s,_owner:w1.current}}function nK(t,e){return{$$typeof:pg,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function b1(t){return typeof t=="object"&&t!==null&&t.$$typeof===pg}function rK(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var jk=/\/+/g;function y_(t,e){return typeof t=="object"&&t!==null&&t.key!=null?rK(""+t.key):e.toString(36)}function Ax(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case pg:case Wq:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+y_(o,0):r,kk(s)?(n="",t!=null&&(n=t.replace(jk,"$&/")+"/"),Ax(s,e,n,"",function(u){return u})):s!=null&&(b1(s)&&(s=nK(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(jk,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",kk(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+y_(i,l);o+=Ax(i,e,n,c,s)}else if(c=tK(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+y_(i,l++),o+=Ax(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function xy(t,e,n){if(t==null)return t;var r=[],s=0;return Ax(t,r,"","",function(i){return e.call(n,i,s++)}),r}function sK(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Zs={current:null},kx={transition:null},iK={ReactCurrentDispatcher:Zs,ReactCurrentBatchConfig:kx,ReactCurrentOwner:w1};function dO(){throw Error("act(...) is not supported in production builds of React.")}ln.Children={map:xy,forEach:function(t,e,n){xy(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return xy(t,function(){e++}),e},toArray:function(t){return xy(t,function(e){return e})||[]},only:function(t){if(!b1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ln.Component=pf;ln.Fragment=Hq;ln.Profiler=Kq;ln.PureComponent=x1;ln.StrictMode=qq;ln.Suspense=Xq;ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iK;ln.act=dO;ln.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=iO({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=w1.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)lO.call(e,c)&&!cO.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:pg,type:t.type,key:s,ref:i,props:r,_owner:o}};ln.createContext=function(t){return t={$$typeof:Jq,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Yq,_context:t},t.Consumer=t};ln.createElement=uO;ln.createFactory=function(t){var e=uO.bind(null,t);return e.type=t,e};ln.createRef=function(){return{current:null}};ln.forwardRef=function(t){return{$$typeof:Qq,render:t}};ln.isValidElement=b1;ln.lazy=function(t){return{$$typeof:eK,_payload:{_status:-1,_result:t},_init:sK}};ln.memo=function(t,e){return{$$typeof:Zq,type:t,compare:e===void 0?null:e}};ln.startTransition=function(t){var e=kx.transition;kx.transition={};try{t()}finally{kx.transition=e}};ln.unstable_act=dO;ln.useCallback=function(t,e){return Zs.current.useCallback(t,e)};ln.useContext=function(t){return Zs.current.useContext(t)};ln.useDebugValue=function(){};ln.useDeferredValue=function(t){return Zs.current.useDeferredValue(t)};ln.useEffect=function(t,e){return Zs.current.useEffect(t,e)};ln.useId=function(){return Zs.current.useId()};ln.useImperativeHandle=function(t,e,n){return Zs.current.useImperativeHandle(t,e,n)};ln.useInsertionEffect=function(t,e){return Zs.current.useInsertionEffect(t,e)};ln.useLayoutEffect=function(t,e){return Zs.current.useLayoutEffect(t,e)};ln.useMemo=function(t,e){return Zs.current.useMemo(t,e)};ln.useReducer=function(t,e,n){return Zs.current.useReducer(t,e,n)};ln.useRef=function(t){return Zs.current.useRef(t)};ln.useState=function(t){return Zs.current.useState(t)};ln.useSyncExternalStore=function(t,e,n){return Zs.current.useSyncExternalStore(t,e,n)};ln.useTransition=function(){return Zs.current.useTransition()};ln.version="18.3.1";rO.exports=ln;var p=rO.exports;const ht=i0(p),a0=tO({__proto__:null,default:ht},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oK=p,aK=Symbol.for("react.element"),lK=Symbol.for("react.fragment"),cK=Object.prototype.hasOwnProperty,uK=oK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dK={key:!0,ref:!0,__self:!0,__source:!0};function hO(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)cK.call(e,r)&&!dK.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:aK,type:t,key:i,ref:o,props:s,_owner:uK.current}}o0.Fragment=lK;o0.jsx=hO;o0.jsxs=hO;nO.exports=o0;var a=nO.exports,yC={},fO={exports:{}},Yi={},mO={exports:{}},pO={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,K){var $=H.length;H.push(K);e:for(;0<$;){var V=$-1>>>1,W=H[V];if(0<s(W,K))H[V]=K,H[$]=W,$=V;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var K=H[0],$=H.pop();if($!==K){H[0]=$;e:for(var V=0,W=H.length,F=W>>>1;V<F;){var Z=2*(V+1)-1,ce=H[Z],le=Z+1,he=H[le];if(0>s(ce,$))le<W&&0>s(he,ce)?(H[V]=he,H[le]=$,V=le):(H[V]=ce,H[Z]=$,V=Z);else if(le<W&&0>s(he,$))H[V]=he,H[le]=$,V=le;else break e}}return K}function s(H,K){var $=H.sortIndex-K.sortIndex;return $!==0?$:H.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,g=!1,x=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(H){for(var K=n(u);K!==null;){if(K.callback===null)r(u);else if(K.startTime<=H)r(u),K.sortIndex=K.expirationTime,e(c,K);else break;K=n(u)}}function T(H){if(x=!1,C(H),!g)if(n(c)!==null)g=!0,G(j);else{var K=n(u);K!==null&&Y(T,K.startTime-H)}}function j(H,K){g=!1,x&&(x=!1,w(I),I=-1),m=!0;var $=f;try{for(C(K),h=n(c);h!==null&&(!(h.expirationTime>K)||H&&!R());){var V=h.callback;if(typeof V=="function"){h.callback=null,f=h.priorityLevel;var W=V(h.expirationTime<=K);K=t.unstable_now(),typeof W=="function"?h.callback=W:h===n(c)&&r(c),C(K)}else r(c);h=n(c)}if(h!==null)var F=!0;else{var Z=n(u);Z!==null&&Y(T,Z.startTime-K),F=!1}return F}finally{h=null,f=$,m=!1}}var A=!1,E=null,I=-1,N=5,k=-1;function R(){return!(t.unstable_now()-k<N)}function D(){if(E!==null){var H=t.unstable_now();k=H;var K=!0;try{K=E(!0,H)}finally{K?M():(A=!1,E=null)}}else A=!1}var M;if(typeof _=="function")M=function(){_(D)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,B=z.port2;z.port1.onmessage=D,M=function(){B.postMessage(null)}}else M=function(){v(D,0)};function G(H){E=H,A||(A=!0,M())}function Y(H,K){I=v(function(){H(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,G(j))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(H){switch(f){case 1:case 2:case 3:var K=3;break;default:K=f}var $=f;f=K;try{return H()}finally{f=$}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,K){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var $=f;f=H;try{return K()}finally{f=$}},t.unstable_scheduleCallback=function(H,K,$){var V=t.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?V+$:V):$=V,H){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=$+W,H={id:d++,callback:K,priorityLevel:H,startTime:$,expirationTime:W,sortIndex:-1},$>V?(H.sortIndex=$,e(u,H),n(c)===null&&H===n(u)&&(x?(w(I),I=-1):x=!0,Y(T,$-V))):(H.sortIndex=W,e(c,H),g||m||(g=!0,G(j))),H},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(H){var K=f;return function(){var $=f;f=K;try{return H.apply(this,arguments)}finally{f=$}}}})(pO);mO.exports=pO;var hK=mO.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fK=p,Gi=hK;function Ze(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gO=new Set,yp={};function ad(t,e){Lh(t,e),Lh(t+"Capture",e)}function Lh(t,e){for(yp[t]=e,t=0;t<e.length;t++)gO.add(e[t])}var Za=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xC=Object.prototype.hasOwnProperty,mK=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Rk={},Dk={};function pK(t){return xC.call(Dk,t)?!0:xC.call(Rk,t)?!1:mK.test(t)?Dk[t]=!0:(Rk[t]=!0,!1)}function gK(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function yK(t,e,n,r){if(e===null||typeof e>"u"||gK(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ei(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ys={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ys[t]=new ei(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ys[e]=new ei(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ys[t]=new ei(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ys[t]=new ei(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ys[t]=new ei(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ys[t]=new ei(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ys[t]=new ei(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ys[t]=new ei(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ys[t]=new ei(t,5,!1,t.toLowerCase(),null,!1,!1)});var _1=/[\-:]([a-z])/g;function S1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(_1,S1);ys[e]=new ei(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(_1,S1);ys[e]=new ei(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(_1,S1);ys[e]=new ei(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ys[t]=new ei(t,1,!1,t.toLowerCase(),null,!1,!1)});ys.xlinkHref=new ei("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ys[t]=new ei(t,1,!1,t.toLowerCase(),null,!0,!0)});function C1(t,e,n,r){var s=ys.hasOwnProperty(e)?ys[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(yK(e,n,s,r)&&(n=null),r||s===null?pK(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var fl=fK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,vy=Symbol.for("react.element"),Yd=Symbol.for("react.portal"),Jd=Symbol.for("react.fragment"),E1=Symbol.for("react.strict_mode"),vC=Symbol.for("react.profiler"),yO=Symbol.for("react.provider"),xO=Symbol.for("react.context"),T1=Symbol.for("react.forward_ref"),wC=Symbol.for("react.suspense"),bC=Symbol.for("react.suspense_list"),I1=Symbol.for("react.memo"),Ll=Symbol.for("react.lazy"),vO=Symbol.for("react.offscreen"),Mk=Symbol.iterator;function Of(t){return t===null||typeof t!="object"?null:(t=Mk&&t[Mk]||t["@@iterator"],typeof t=="function"?t:null)}var yr=Object.assign,x_;function mm(t){if(x_===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);x_=e&&e[1]||""}return`
`+x_+t}var v_=!1;function w_(t,e){if(!t||v_)return"";v_=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{v_=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?mm(t):""}function xK(t){switch(t.tag){case 5:return mm(t.type);case 16:return mm("Lazy");case 13:return mm("Suspense");case 19:return mm("SuspenseList");case 0:case 2:case 15:return t=w_(t.type,!1),t;case 11:return t=w_(t.type.render,!1),t;case 1:return t=w_(t.type,!0),t;default:return""}}function _C(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Jd:return"Fragment";case Yd:return"Portal";case vC:return"Profiler";case E1:return"StrictMode";case wC:return"Suspense";case bC:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case xO:return(t.displayName||"Context")+".Consumer";case yO:return(t._context.displayName||"Context")+".Provider";case T1:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case I1:return e=t.displayName||null,e!==null?e:_C(t.type)||"Memo";case Ll:e=t._payload,t=t._init;try{return _C(t(e))}catch{}}return null}function vK(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _C(e);case 8:return e===E1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function vc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function wO(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wK(t){var e=wO(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function wy(t){t._valueTracker||(t._valueTracker=wK(t))}function bO(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=wO(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Sv(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function SC(t,e){var n=e.checked;return yr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Lk(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=vc(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function _O(t,e){e=e.checked,e!=null&&C1(t,"checked",e,!1)}function CC(t,e){_O(t,e);var n=vc(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?EC(t,e.type,n):e.hasOwnProperty("defaultValue")&&EC(t,e.type,vc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Fk(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function EC(t,e,n){(e!=="number"||Sv(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var pm=Array.isArray;function xh(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+vc(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function TC(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ze(91));return yr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ok(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Ze(92));if(pm(n)){if(1<n.length)throw Error(Ze(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:vc(n)}}function SO(t,e){var n=vc(e.value),r=vc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function $k(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function CO(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function IC(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?CO(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var by,EO=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(by=by||document.createElement("div"),by.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=by.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function xp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Mm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bK=["Webkit","ms","Moz","O"];Object.keys(Mm).forEach(function(t){bK.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Mm[e]=Mm[t]})});function TO(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Mm.hasOwnProperty(t)&&Mm[t]?(""+e).trim():e+"px"}function IO(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=TO(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var _K=yr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function NC(t,e){if(e){if(_K[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ze(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ze(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ze(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ze(62))}}function PC(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var AC=null;function N1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var kC=null,vh=null,wh=null;function Vk(t){if(t=xg(t)){if(typeof kC!="function")throw Error(Ze(280));var e=t.stateNode;e&&(e=h0(e),kC(t.stateNode,t.type,e))}}function NO(t){vh?wh?wh.push(t):wh=[t]:vh=t}function PO(){if(vh){var t=vh,e=wh;if(wh=vh=null,Vk(t),e)for(t=0;t<e.length;t++)Vk(e[t])}}function AO(t,e){return t(e)}function kO(){}var b_=!1;function jO(t,e,n){if(b_)return t(e,n);b_=!0;try{return AO(t,e,n)}finally{b_=!1,(vh!==null||wh!==null)&&(kO(),PO())}}function vp(t,e){var n=t.stateNode;if(n===null)return null;var r=h0(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Ze(231,e,typeof n));return n}var jC=!1;if(Za)try{var $f={};Object.defineProperty($f,"passive",{get:function(){jC=!0}}),window.addEventListener("test",$f,$f),window.removeEventListener("test",$f,$f)}catch{jC=!1}function SK(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Lm=!1,Cv=null,Ev=!1,RC=null,CK={onError:function(t){Lm=!0,Cv=t}};function EK(t,e,n,r,s,i,o,l,c){Lm=!1,Cv=null,SK.apply(CK,arguments)}function TK(t,e,n,r,s,i,o,l,c){if(EK.apply(this,arguments),Lm){if(Lm){var u=Cv;Lm=!1,Cv=null}else throw Error(Ze(198));Ev||(Ev=!0,RC=u)}}function ld(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function RO(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Uk(t){if(ld(t)!==t)throw Error(Ze(188))}function IK(t){var e=t.alternate;if(!e){if(e=ld(t),e===null)throw Error(Ze(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Uk(s),t;if(i===r)return Uk(s),e;i=i.sibling}throw Error(Ze(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(Ze(189))}}if(n.alternate!==r)throw Error(Ze(190))}if(n.tag!==3)throw Error(Ze(188));return n.stateNode.current===n?t:e}function DO(t){return t=IK(t),t!==null?MO(t):null}function MO(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=MO(t);if(e!==null)return e;t=t.sibling}return null}var LO=Gi.unstable_scheduleCallback,Bk=Gi.unstable_cancelCallback,NK=Gi.unstable_shouldYield,PK=Gi.unstable_requestPaint,Dr=Gi.unstable_now,AK=Gi.unstable_getCurrentPriorityLevel,P1=Gi.unstable_ImmediatePriority,FO=Gi.unstable_UserBlockingPriority,Tv=Gi.unstable_NormalPriority,kK=Gi.unstable_LowPriority,OO=Gi.unstable_IdlePriority,l0=null,ua=null;function jK(t){if(ua&&typeof ua.onCommitFiberRoot=="function")try{ua.onCommitFiberRoot(l0,t,void 0,(t.current.flags&128)===128)}catch{}}var Do=Math.clz32?Math.clz32:MK,RK=Math.log,DK=Math.LN2;function MK(t){return t>>>=0,t===0?32:31-(RK(t)/DK|0)|0}var _y=64,Sy=4194304;function gm(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Iv(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=gm(l):(i&=o,i!==0&&(r=gm(i)))}else o=n&~s,o!==0?r=gm(o):i!==0&&(r=gm(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Do(e),s=1<<n,r|=t[n],e&=~s;return r}function LK(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function FK(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Do(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=LK(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function DC(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function $O(){var t=_y;return _y<<=1,!(_y&4194240)&&(_y=64),t}function __(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function gg(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Do(e),t[e]=n}function OK(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Do(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function A1(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Do(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var kn=0;function VO(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var UO,k1,BO,zO,GO,MC=!1,Cy=[],Ql=null,Xl=null,Zl=null,wp=new Map,bp=new Map,$l=[],$K="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zk(t,e){switch(t){case"focusin":case"focusout":Ql=null;break;case"dragenter":case"dragleave":Xl=null;break;case"mouseover":case"mouseout":Zl=null;break;case"pointerover":case"pointerout":wp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":bp.delete(e.pointerId)}}function Vf(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=xg(e),e!==null&&k1(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function VK(t,e,n,r,s){switch(e){case"focusin":return Ql=Vf(Ql,t,e,n,r,s),!0;case"dragenter":return Xl=Vf(Xl,t,e,n,r,s),!0;case"mouseover":return Zl=Vf(Zl,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return wp.set(i,Vf(wp.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,bp.set(i,Vf(bp.get(i)||null,t,e,n,r,s)),!0}return!1}function WO(t){var e=vu(t.target);if(e!==null){var n=ld(e);if(n!==null){if(e=n.tag,e===13){if(e=RO(n),e!==null){t.blockedOn=e,GO(t.priority,function(){BO(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function jx(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=LC(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);AC=r,n.target.dispatchEvent(r),AC=null}else return e=xg(n),e!==null&&k1(e),t.blockedOn=n,!1;e.shift()}return!0}function Gk(t,e,n){jx(t)&&n.delete(e)}function UK(){MC=!1,Ql!==null&&jx(Ql)&&(Ql=null),Xl!==null&&jx(Xl)&&(Xl=null),Zl!==null&&jx(Zl)&&(Zl=null),wp.forEach(Gk),bp.forEach(Gk)}function Uf(t,e){t.blockedOn===e&&(t.blockedOn=null,MC||(MC=!0,Gi.unstable_scheduleCallback(Gi.unstable_NormalPriority,UK)))}function _p(t){function e(s){return Uf(s,t)}if(0<Cy.length){Uf(Cy[0],t);for(var n=1;n<Cy.length;n++){var r=Cy[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ql!==null&&Uf(Ql,t),Xl!==null&&Uf(Xl,t),Zl!==null&&Uf(Zl,t),wp.forEach(e),bp.forEach(e),n=0;n<$l.length;n++)r=$l[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<$l.length&&(n=$l[0],n.blockedOn===null);)WO(n),n.blockedOn===null&&$l.shift()}var bh=fl.ReactCurrentBatchConfig,Nv=!0;function BK(t,e,n,r){var s=kn,i=bh.transition;bh.transition=null;try{kn=1,j1(t,e,n,r)}finally{kn=s,bh.transition=i}}function zK(t,e,n,r){var s=kn,i=bh.transition;bh.transition=null;try{kn=4,j1(t,e,n,r)}finally{kn=s,bh.transition=i}}function j1(t,e,n,r){if(Nv){var s=LC(t,e,n,r);if(s===null)j_(t,e,r,Pv,n),zk(t,r);else if(VK(s,t,e,n,r))r.stopPropagation();else if(zk(t,r),e&4&&-1<$K.indexOf(t)){for(;s!==null;){var i=xg(s);if(i!==null&&UO(i),i=LC(t,e,n,r),i===null&&j_(t,e,r,Pv,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else j_(t,e,r,null,n)}}var Pv=null;function LC(t,e,n,r){if(Pv=null,t=N1(r),t=vu(t),t!==null)if(e=ld(t),e===null)t=null;else if(n=e.tag,n===13){if(t=RO(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Pv=t,null}function HO(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(AK()){case P1:return 1;case FO:return 4;case Tv:case kK:return 16;case OO:return 536870912;default:return 16}default:return 16}}var Hl=null,R1=null,Rx=null;function qO(){if(Rx)return Rx;var t,e=R1,n=e.length,r,s="value"in Hl?Hl.value:Hl.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Rx=s.slice(t,1<r?1-r:void 0)}function Dx(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ey(){return!0}function Wk(){return!1}function Ji(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ey:Wk,this.isPropagationStopped=Wk,this}return yr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ey)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ey)},persist:function(){},isPersistent:Ey}),e}var gf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},D1=Ji(gf),yg=yr({},gf,{view:0,detail:0}),GK=Ji(yg),S_,C_,Bf,c0=yr({},yg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:M1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bf&&(Bf&&t.type==="mousemove"?(S_=t.screenX-Bf.screenX,C_=t.screenY-Bf.screenY):C_=S_=0,Bf=t),S_)},movementY:function(t){return"movementY"in t?t.movementY:C_}}),Hk=Ji(c0),WK=yr({},c0,{dataTransfer:0}),HK=Ji(WK),qK=yr({},yg,{relatedTarget:0}),E_=Ji(qK),KK=yr({},gf,{animationName:0,elapsedTime:0,pseudoElement:0}),YK=Ji(KK),JK=yr({},gf,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),QK=Ji(JK),XK=yr({},gf,{data:0}),qk=Ji(XK),ZK={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eY={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tY={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nY(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=tY[t])?!!e[t]:!1}function M1(){return nY}var rY=yr({},yg,{key:function(t){if(t.key){var e=ZK[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Dx(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?eY[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:M1,charCode:function(t){return t.type==="keypress"?Dx(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Dx(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sY=Ji(rY),iY=yr({},c0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kk=Ji(iY),oY=yr({},yg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:M1}),aY=Ji(oY),lY=yr({},gf,{propertyName:0,elapsedTime:0,pseudoElement:0}),cY=Ji(lY),uY=yr({},c0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),dY=Ji(uY),hY=[9,13,27,32],L1=Za&&"CompositionEvent"in window,Fm=null;Za&&"documentMode"in document&&(Fm=document.documentMode);var fY=Za&&"TextEvent"in window&&!Fm,KO=Za&&(!L1||Fm&&8<Fm&&11>=Fm),Yk=String.fromCharCode(32),Jk=!1;function YO(t,e){switch(t){case"keyup":return hY.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function JO(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qd=!1;function mY(t,e){switch(t){case"compositionend":return JO(e);case"keypress":return e.which!==32?null:(Jk=!0,Yk);case"textInput":return t=e.data,t===Yk&&Jk?null:t;default:return null}}function pY(t,e){if(Qd)return t==="compositionend"||!L1&&YO(t,e)?(t=qO(),Rx=R1=Hl=null,Qd=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return KO&&e.locale!=="ko"?null:e.data;default:return null}}var gY={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!gY[t.type]:e==="textarea"}function QO(t,e,n,r){NO(r),e=Av(e,"onChange"),0<e.length&&(n=new D1("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Om=null,Sp=null;function yY(t){l$(t,0)}function u0(t){var e=eh(t);if(bO(e))return t}function xY(t,e){if(t==="change")return e}var XO=!1;if(Za){var T_;if(Za){var I_="oninput"in document;if(!I_){var Xk=document.createElement("div");Xk.setAttribute("oninput","return;"),I_=typeof Xk.oninput=="function"}T_=I_}else T_=!1;XO=T_&&(!document.documentMode||9<document.documentMode)}function Zk(){Om&&(Om.detachEvent("onpropertychange",ZO),Sp=Om=null)}function ZO(t){if(t.propertyName==="value"&&u0(Sp)){var e=[];QO(e,Sp,t,N1(t)),jO(yY,e)}}function vY(t,e,n){t==="focusin"?(Zk(),Om=e,Sp=n,Om.attachEvent("onpropertychange",ZO)):t==="focusout"&&Zk()}function wY(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return u0(Sp)}function bY(t,e){if(t==="click")return u0(e)}function _Y(t,e){if(t==="input"||t==="change")return u0(e)}function SY(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Oo=typeof Object.is=="function"?Object.is:SY;function Cp(t,e){if(Oo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!xC.call(e,s)||!Oo(t[s],e[s]))return!1}return!0}function ej(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function tj(t,e){var n=ej(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ej(n)}}function e$(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?e$(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function t$(){for(var t=window,e=Sv();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Sv(t.document)}return e}function F1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function CY(t){var e=t$(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&e$(n.ownerDocument.documentElement,n)){if(r!==null&&F1(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=tj(n,i);var o=tj(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var EY=Za&&"documentMode"in document&&11>=document.documentMode,Xd=null,FC=null,$m=null,OC=!1;function nj(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;OC||Xd==null||Xd!==Sv(r)||(r=Xd,"selectionStart"in r&&F1(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$m&&Cp($m,r)||($m=r,r=Av(FC,"onSelect"),0<r.length&&(e=new D1("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xd)))}function Ty(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Zd={animationend:Ty("Animation","AnimationEnd"),animationiteration:Ty("Animation","AnimationIteration"),animationstart:Ty("Animation","AnimationStart"),transitionend:Ty("Transition","TransitionEnd")},N_={},n$={};Za&&(n$=document.createElement("div").style,"AnimationEvent"in window||(delete Zd.animationend.animation,delete Zd.animationiteration.animation,delete Zd.animationstart.animation),"TransitionEvent"in window||delete Zd.transitionend.transition);function d0(t){if(N_[t])return N_[t];if(!Zd[t])return t;var e=Zd[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in n$)return N_[t]=e[n];return t}var r$=d0("animationend"),s$=d0("animationiteration"),i$=d0("animationstart"),o$=d0("transitionend"),a$=new Map,rj="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kc(t,e){a$.set(t,e),ad(e,[t])}for(var P_=0;P_<rj.length;P_++){var A_=rj[P_],TY=A_.toLowerCase(),IY=A_[0].toUpperCase()+A_.slice(1);kc(TY,"on"+IY)}kc(r$,"onAnimationEnd");kc(s$,"onAnimationIteration");kc(i$,"onAnimationStart");kc("dblclick","onDoubleClick");kc("focusin","onFocus");kc("focusout","onBlur");kc(o$,"onTransitionEnd");Lh("onMouseEnter",["mouseout","mouseover"]);Lh("onMouseLeave",["mouseout","mouseover"]);Lh("onPointerEnter",["pointerout","pointerover"]);Lh("onPointerLeave",["pointerout","pointerover"]);ad("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ad("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ad("onBeforeInput",["compositionend","keypress","textInput","paste"]);ad("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ad("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ad("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ym="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NY=new Set("cancel close invalid load scroll toggle".split(" ").concat(ym));function sj(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,TK(r,e,void 0,t),t.currentTarget=null}function l$(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;sj(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;sj(s,l,u),i=c}}}if(Ev)throw t=RC,Ev=!1,RC=null,t}function Jn(t,e){var n=e[zC];n===void 0&&(n=e[zC]=new Set);var r=t+"__bubble";n.has(r)||(c$(e,t,2,!1),n.add(r))}function k_(t,e,n){var r=0;e&&(r|=4),c$(n,t,r,e)}var Iy="_reactListening"+Math.random().toString(36).slice(2);function Ep(t){if(!t[Iy]){t[Iy]=!0,gO.forEach(function(n){n!=="selectionchange"&&(NY.has(n)||k_(n,!1,t),k_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Iy]||(e[Iy]=!0,k_("selectionchange",!1,e))}}function c$(t,e,n,r){switch(HO(e)){case 1:var s=BK;break;case 4:s=zK;break;default:s=j1}n=s.bind(null,e,n,t),s=void 0,!jC||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function j_(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=vu(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}jO(function(){var u=i,d=N1(n),h=[];e:{var f=a$.get(t);if(f!==void 0){var m=D1,g=t;switch(t){case"keypress":if(Dx(n)===0)break e;case"keydown":case"keyup":m=sY;break;case"focusin":g="focus",m=E_;break;case"focusout":g="blur",m=E_;break;case"beforeblur":case"afterblur":m=E_;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Hk;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=HK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=aY;break;case r$:case s$:case i$:m=YK;break;case o$:m=cY;break;case"scroll":m=GK;break;case"wheel":m=dY;break;case"copy":case"cut":case"paste":m=QK;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Kk}var x=(e&4)!==0,v=!x&&t==="scroll",w=x?f!==null?f+"Capture":null:f;x=[];for(var _=u,C;_!==null;){C=_;var T=C.stateNode;if(C.tag===5&&T!==null&&(C=T,w!==null&&(T=vp(_,w),T!=null&&x.push(Tp(_,T,C)))),v)break;_=_.return}0<x.length&&(f=new m(f,g,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==AC&&(g=n.relatedTarget||n.fromElement)&&(vu(g)||g[el]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(g=n.relatedTarget||n.toElement,m=u,g=g?vu(g):null,g!==null&&(v=ld(g),g!==v||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(x=Hk,T="onMouseLeave",w="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(x=Kk,T="onPointerLeave",w="onPointerEnter",_="pointer"),v=m==null?f:eh(m),C=g==null?f:eh(g),f=new x(T,_+"leave",m,n,d),f.target=v,f.relatedTarget=C,T=null,vu(d)===u&&(x=new x(w,_+"enter",g,n,d),x.target=C,x.relatedTarget=v,T=x),v=T,m&&g)t:{for(x=m,w=g,_=0,C=x;C;C=Sd(C))_++;for(C=0,T=w;T;T=Sd(T))C++;for(;0<_-C;)x=Sd(x),_--;for(;0<C-_;)w=Sd(w),C--;for(;_--;){if(x===w||w!==null&&x===w.alternate)break t;x=Sd(x),w=Sd(w)}x=null}else x=null;m!==null&&ij(h,f,m,x,!1),g!==null&&v!==null&&ij(h,v,g,x,!0)}}e:{if(f=u?eh(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var j=xY;else if(Qk(f))if(XO)j=_Y;else{j=wY;var A=vY}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(j=bY);if(j&&(j=j(t,u))){QO(h,j,n,d);break e}A&&A(t,f,u),t==="focusout"&&(A=f._wrapperState)&&A.controlled&&f.type==="number"&&EC(f,"number",f.value)}switch(A=u?eh(u):window,t){case"focusin":(Qk(A)||A.contentEditable==="true")&&(Xd=A,FC=u,$m=null);break;case"focusout":$m=FC=Xd=null;break;case"mousedown":OC=!0;break;case"contextmenu":case"mouseup":case"dragend":OC=!1,nj(h,n,d);break;case"selectionchange":if(EY)break;case"keydown":case"keyup":nj(h,n,d)}var E;if(L1)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Qd?YO(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(KO&&n.locale!=="ko"&&(Qd||I!=="onCompositionStart"?I==="onCompositionEnd"&&Qd&&(E=qO()):(Hl=d,R1="value"in Hl?Hl.value:Hl.textContent,Qd=!0)),A=Av(u,I),0<A.length&&(I=new qk(I,t,null,n,d),h.push({event:I,listeners:A}),E?I.data=E:(E=JO(n),E!==null&&(I.data=E)))),(E=fY?mY(t,n):pY(t,n))&&(u=Av(u,"onBeforeInput"),0<u.length&&(d=new qk("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=E))}l$(h,e)})}function Tp(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Av(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=vp(t,n),i!=null&&r.unshift(Tp(t,i,s)),i=vp(t,e),i!=null&&r.push(Tp(t,i,s))),t=t.return}return r}function Sd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ij(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=vp(n,i),c!=null&&o.unshift(Tp(n,c,l))):s||(c=vp(n,i),c!=null&&o.push(Tp(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var PY=/\r\n?/g,AY=/\u0000|\uFFFD/g;function oj(t){return(typeof t=="string"?t:""+t).replace(PY,`
`).replace(AY,"")}function Ny(t,e,n){if(e=oj(e),oj(t)!==e&&n)throw Error(Ze(425))}function kv(){}var $C=null,VC=null;function UC(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var BC=typeof setTimeout=="function"?setTimeout:void 0,kY=typeof clearTimeout=="function"?clearTimeout:void 0,aj=typeof Promise=="function"?Promise:void 0,jY=typeof queueMicrotask=="function"?queueMicrotask:typeof aj<"u"?function(t){return aj.resolve(null).then(t).catch(RY)}:BC;function RY(t){setTimeout(function(){throw t})}function R_(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),_p(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);_p(e)}function ec(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function lj(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var yf=Math.random().toString(36).slice(2),na="__reactFiber$"+yf,Ip="__reactProps$"+yf,el="__reactContainer$"+yf,zC="__reactEvents$"+yf,DY="__reactListeners$"+yf,MY="__reactHandles$"+yf;function vu(t){var e=t[na];if(e)return e;for(var n=t.parentNode;n;){if(e=n[el]||n[na]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=lj(t);t!==null;){if(n=t[na])return n;t=lj(t)}return e}t=n,n=t.parentNode}return null}function xg(t){return t=t[na]||t[el],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function eh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ze(33))}function h0(t){return t[Ip]||null}var GC=[],th=-1;function jc(t){return{current:t}}function Xn(t){0>th||(t.current=GC[th],GC[th]=null,th--)}function Wn(t,e){th++,GC[th]=t.current,t.current=e}var wc={},Ls=jc(wc),pi=jc(!1),$u=wc;function Fh(t,e){var n=t.type.contextTypes;if(!n)return wc;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function gi(t){return t=t.childContextTypes,t!=null}function jv(){Xn(pi),Xn(Ls)}function cj(t,e,n){if(Ls.current!==wc)throw Error(Ze(168));Wn(Ls,e),Wn(pi,n)}function u$(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Ze(108,vK(t)||"Unknown",s));return yr({},n,r)}function Rv(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||wc,$u=Ls.current,Wn(Ls,t),Wn(pi,pi.current),!0}function uj(t,e,n){var r=t.stateNode;if(!r)throw Error(Ze(169));n?(t=u$(t,e,$u),r.__reactInternalMemoizedMergedChildContext=t,Xn(pi),Xn(Ls),Wn(Ls,t)):Xn(pi),Wn(pi,n)}var La=null,f0=!1,D_=!1;function d$(t){La===null?La=[t]:La.push(t)}function LY(t){f0=!0,d$(t)}function Rc(){if(!D_&&La!==null){D_=!0;var t=0,e=kn;try{var n=La;for(kn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}La=null,f0=!1}catch(s){throw La!==null&&(La=La.slice(t+1)),LO(P1,Rc),s}finally{kn=e,D_=!1}}return null}var nh=[],rh=0,Dv=null,Mv=0,to=[],no=0,Vu=null,Va=1,Ua="";function ru(t,e){nh[rh++]=Mv,nh[rh++]=Dv,Dv=t,Mv=e}function h$(t,e,n){to[no++]=Va,to[no++]=Ua,to[no++]=Vu,Vu=t;var r=Va;t=Ua;var s=32-Do(r)-1;r&=~(1<<s),n+=1;var i=32-Do(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Va=1<<32-Do(e)+s|n<<s|r,Ua=i+t}else Va=1<<i|n<<s|r,Ua=t}function O1(t){t.return!==null&&(ru(t,1),h$(t,1,0))}function $1(t){for(;t===Dv;)Dv=nh[--rh],nh[rh]=null,Mv=nh[--rh],nh[rh]=null;for(;t===Vu;)Vu=to[--no],to[no]=null,Ua=to[--no],to[no]=null,Va=to[--no],to[no]=null}var Bi=null,Oi=null,ir=!1,Po=null;function f$(t,e){var n=oo(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function dj(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Bi=t,Oi=ec(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Bi=t,Oi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Vu!==null?{id:Va,overflow:Ua}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=oo(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Bi=t,Oi=null,!0):!1;default:return!1}}function WC(t){return(t.mode&1)!==0&&(t.flags&128)===0}function HC(t){if(ir){var e=Oi;if(e){var n=e;if(!dj(t,e)){if(WC(t))throw Error(Ze(418));e=ec(n.nextSibling);var r=Bi;e&&dj(t,e)?f$(r,n):(t.flags=t.flags&-4097|2,ir=!1,Bi=t)}}else{if(WC(t))throw Error(Ze(418));t.flags=t.flags&-4097|2,ir=!1,Bi=t}}}function hj(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Bi=t}function Py(t){if(t!==Bi)return!1;if(!ir)return hj(t),ir=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!UC(t.type,t.memoizedProps)),e&&(e=Oi)){if(WC(t))throw m$(),Error(Ze(418));for(;e;)f$(t,e),e=ec(e.nextSibling)}if(hj(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ze(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Oi=ec(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Oi=null}}else Oi=Bi?ec(t.stateNode.nextSibling):null;return!0}function m$(){for(var t=Oi;t;)t=ec(t.nextSibling)}function Oh(){Oi=Bi=null,ir=!1}function V1(t){Po===null?Po=[t]:Po.push(t)}var FY=fl.ReactCurrentBatchConfig;function zf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Ze(309));var r=n.stateNode}if(!r)throw Error(Ze(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Ze(284));if(!n._owner)throw Error(Ze(290,t))}return t}function Ay(t,e){throw t=Object.prototype.toString.call(e),Error(Ze(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function fj(t){var e=t._init;return e(t._payload)}function p$(t){function e(w,_){if(t){var C=w.deletions;C===null?(w.deletions=[_],w.flags|=16):C.push(_)}}function n(w,_){if(!t)return null;for(;_!==null;)e(w,_),_=_.sibling;return null}function r(w,_){for(w=new Map;_!==null;)_.key!==null?w.set(_.key,_):w.set(_.index,_),_=_.sibling;return w}function s(w,_){return w=sc(w,_),w.index=0,w.sibling=null,w}function i(w,_,C){return w.index=C,t?(C=w.alternate,C!==null?(C=C.index,C<_?(w.flags|=2,_):C):(w.flags|=2,_)):(w.flags|=1048576,_)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function l(w,_,C,T){return _===null||_.tag!==6?(_=U_(C,w.mode,T),_.return=w,_):(_=s(_,C),_.return=w,_)}function c(w,_,C,T){var j=C.type;return j===Jd?d(w,_,C.props.children,T,C.key):_!==null&&(_.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Ll&&fj(j)===_.type)?(T=s(_,C.props),T.ref=zf(w,_,C),T.return=w,T):(T=Ux(C.type,C.key,C.props,null,w.mode,T),T.ref=zf(w,_,C),T.return=w,T)}function u(w,_,C,T){return _===null||_.tag!==4||_.stateNode.containerInfo!==C.containerInfo||_.stateNode.implementation!==C.implementation?(_=B_(C,w.mode,T),_.return=w,_):(_=s(_,C.children||[]),_.return=w,_)}function d(w,_,C,T,j){return _===null||_.tag!==7?(_=ku(C,w.mode,T,j),_.return=w,_):(_=s(_,C),_.return=w,_)}function h(w,_,C){if(typeof _=="string"&&_!==""||typeof _=="number")return _=U_(""+_,w.mode,C),_.return=w,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case vy:return C=Ux(_.type,_.key,_.props,null,w.mode,C),C.ref=zf(w,null,_),C.return=w,C;case Yd:return _=B_(_,w.mode,C),_.return=w,_;case Ll:var T=_._init;return h(w,T(_._payload),C)}if(pm(_)||Of(_))return _=ku(_,w.mode,C,null),_.return=w,_;Ay(w,_)}return null}function f(w,_,C,T){var j=_!==null?_.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return j!==null?null:l(w,_,""+C,T);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case vy:return C.key===j?c(w,_,C,T):null;case Yd:return C.key===j?u(w,_,C,T):null;case Ll:return j=C._init,f(w,_,j(C._payload),T)}if(pm(C)||Of(C))return j!==null?null:d(w,_,C,T,null);Ay(w,C)}return null}function m(w,_,C,T,j){if(typeof T=="string"&&T!==""||typeof T=="number")return w=w.get(C)||null,l(_,w,""+T,j);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case vy:return w=w.get(T.key===null?C:T.key)||null,c(_,w,T,j);case Yd:return w=w.get(T.key===null?C:T.key)||null,u(_,w,T,j);case Ll:var A=T._init;return m(w,_,C,A(T._payload),j)}if(pm(T)||Of(T))return w=w.get(C)||null,d(_,w,T,j,null);Ay(_,T)}return null}function g(w,_,C,T){for(var j=null,A=null,E=_,I=_=0,N=null;E!==null&&I<C.length;I++){E.index>I?(N=E,E=null):N=E.sibling;var k=f(w,E,C[I],T);if(k===null){E===null&&(E=N);break}t&&E&&k.alternate===null&&e(w,E),_=i(k,_,I),A===null?j=k:A.sibling=k,A=k,E=N}if(I===C.length)return n(w,E),ir&&ru(w,I),j;if(E===null){for(;I<C.length;I++)E=h(w,C[I],T),E!==null&&(_=i(E,_,I),A===null?j=E:A.sibling=E,A=E);return ir&&ru(w,I),j}for(E=r(w,E);I<C.length;I++)N=m(E,w,I,C[I],T),N!==null&&(t&&N.alternate!==null&&E.delete(N.key===null?I:N.key),_=i(N,_,I),A===null?j=N:A.sibling=N,A=N);return t&&E.forEach(function(R){return e(w,R)}),ir&&ru(w,I),j}function x(w,_,C,T){var j=Of(C);if(typeof j!="function")throw Error(Ze(150));if(C=j.call(C),C==null)throw Error(Ze(151));for(var A=j=null,E=_,I=_=0,N=null,k=C.next();E!==null&&!k.done;I++,k=C.next()){E.index>I?(N=E,E=null):N=E.sibling;var R=f(w,E,k.value,T);if(R===null){E===null&&(E=N);break}t&&E&&R.alternate===null&&e(w,E),_=i(R,_,I),A===null?j=R:A.sibling=R,A=R,E=N}if(k.done)return n(w,E),ir&&ru(w,I),j;if(E===null){for(;!k.done;I++,k=C.next())k=h(w,k.value,T),k!==null&&(_=i(k,_,I),A===null?j=k:A.sibling=k,A=k);return ir&&ru(w,I),j}for(E=r(w,E);!k.done;I++,k=C.next())k=m(E,w,I,k.value,T),k!==null&&(t&&k.alternate!==null&&E.delete(k.key===null?I:k.key),_=i(k,_,I),A===null?j=k:A.sibling=k,A=k);return t&&E.forEach(function(D){return e(w,D)}),ir&&ru(w,I),j}function v(w,_,C,T){if(typeof C=="object"&&C!==null&&C.type===Jd&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case vy:e:{for(var j=C.key,A=_;A!==null;){if(A.key===j){if(j=C.type,j===Jd){if(A.tag===7){n(w,A.sibling),_=s(A,C.props.children),_.return=w,w=_;break e}}else if(A.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Ll&&fj(j)===A.type){n(w,A.sibling),_=s(A,C.props),_.ref=zf(w,A,C),_.return=w,w=_;break e}n(w,A);break}else e(w,A);A=A.sibling}C.type===Jd?(_=ku(C.props.children,w.mode,T,C.key),_.return=w,w=_):(T=Ux(C.type,C.key,C.props,null,w.mode,T),T.ref=zf(w,_,C),T.return=w,w=T)}return o(w);case Yd:e:{for(A=C.key;_!==null;){if(_.key===A)if(_.tag===4&&_.stateNode.containerInfo===C.containerInfo&&_.stateNode.implementation===C.implementation){n(w,_.sibling),_=s(_,C.children||[]),_.return=w,w=_;break e}else{n(w,_);break}else e(w,_);_=_.sibling}_=B_(C,w.mode,T),_.return=w,w=_}return o(w);case Ll:return A=C._init,v(w,_,A(C._payload),T)}if(pm(C))return g(w,_,C,T);if(Of(C))return x(w,_,C,T);Ay(w,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,_!==null&&_.tag===6?(n(w,_.sibling),_=s(_,C),_.return=w,w=_):(n(w,_),_=U_(C,w.mode,T),_.return=w,w=_),o(w)):n(w,_)}return v}var $h=p$(!0),g$=p$(!1),Lv=jc(null),Fv=null,sh=null,U1=null;function B1(){U1=sh=Fv=null}function z1(t){var e=Lv.current;Xn(Lv),t._currentValue=e}function qC(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function _h(t,e){Fv=t,U1=sh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(di=!0),t.firstContext=null)}function mo(t){var e=t._currentValue;if(U1!==t)if(t={context:t,memoizedValue:e,next:null},sh===null){if(Fv===null)throw Error(Ze(308));sh=t,Fv.dependencies={lanes:0,firstContext:t}}else sh=sh.next=t;return e}var wu=null;function G1(t){wu===null?wu=[t]:wu.push(t)}function y$(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,G1(e)):(n.next=s.next,s.next=n),e.interleaved=n,tl(t,r)}function tl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Fl=!1;function W1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function x$(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ha(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function tc(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,gn&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,tl(t,n)}return s=r.interleaved,s===null?(e.next=e,G1(r)):(e.next=s.next,s.next=e),r.interleaved=e,tl(t,n)}function Mx(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,A1(t,n)}}function mj(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ov(t,e,n,r){var s=t.updateQueue;Fl=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,m=l.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=t,x=l;switch(f=e,m=n,x.tag){case 1:if(g=x.payload,typeof g=="function"){h=g.call(m,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,f=typeof g=="function"?g.call(m,h,f):g,f==null)break e;h=yr({},h,f);break e;case 2:Fl=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(1);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Bu|=o,t.lanes=o,t.memoizedState=h}}function pj(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Ze(191,s));s.call(r)}}}var vg={},da=jc(vg),Np=jc(vg),Pp=jc(vg);function bu(t){if(t===vg)throw Error(Ze(174));return t}function H1(t,e){switch(Wn(Pp,e),Wn(Np,t),Wn(da,vg),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:IC(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=IC(e,t)}Xn(da),Wn(da,e)}function Vh(){Xn(da),Xn(Np),Xn(Pp)}function v$(t){bu(Pp.current);var e=bu(da.current),n=IC(e,t.type);e!==n&&(Wn(Np,t),Wn(da,n))}function q1(t){Np.current===t&&(Xn(da),Xn(Np))}var hr=jc(0);function $v(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var M_=[];function K1(){for(var t=0;t<M_.length;t++)M_[t]._workInProgressVersionPrimary=null;M_.length=0}var Lx=fl.ReactCurrentDispatcher,L_=fl.ReactCurrentBatchConfig,Uu=0,pr=null,qr=null,ss=null,Vv=!1,Vm=!1,Ap=0,OY=0;function Cs(){throw Error(Ze(321))}function Y1(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Oo(t[n],e[n]))return!1;return!0}function J1(t,e,n,r,s,i){if(Uu=i,pr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Lx.current=t===null||t.memoizedState===null?BY:zY,t=n(r,s),Vm){i=0;do{if(Vm=!1,Ap=0,25<=i)throw Error(Ze(301));i+=1,ss=qr=null,e.updateQueue=null,Lx.current=GY,t=n(r,s)}while(Vm)}if(Lx.current=Uv,e=qr!==null&&qr.next!==null,Uu=0,ss=qr=pr=null,Vv=!1,e)throw Error(Ze(300));return t}function Q1(){var t=Ap!==0;return Ap=0,t}function Qo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ss===null?pr.memoizedState=ss=t:ss=ss.next=t,ss}function po(){if(qr===null){var t=pr.alternate;t=t!==null?t.memoizedState:null}else t=qr.next;var e=ss===null?pr.memoizedState:ss.next;if(e!==null)ss=e,qr=t;else{if(t===null)throw Error(Ze(310));qr=t,t={memoizedState:qr.memoizedState,baseState:qr.baseState,baseQueue:qr.baseQueue,queue:qr.queue,next:null},ss===null?pr.memoizedState=ss=t:ss=ss.next=t}return ss}function kp(t,e){return typeof e=="function"?e(t):e}function F_(t){var e=po(),n=e.queue;if(n===null)throw Error(Ze(311));n.lastRenderedReducer=t;var r=qr,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((Uu&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,pr.lanes|=d,Bu|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,Oo(r,e.memoizedState)||(di=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,pr.lanes|=i,Bu|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function O_(t){var e=po(),n=e.queue;if(n===null)throw Error(Ze(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Oo(i,e.memoizedState)||(di=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function w$(){}function b$(t,e){var n=pr,r=po(),s=e(),i=!Oo(r.memoizedState,s);if(i&&(r.memoizedState=s,di=!0),r=r.queue,X1(C$.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||ss!==null&&ss.memoizedState.tag&1){if(n.flags|=2048,jp(9,S$.bind(null,n,r,s,e),void 0,null),os===null)throw Error(Ze(349));Uu&30||_$(n,e,s)}return s}function _$(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=pr.updateQueue,e===null?(e={lastEffect:null,stores:null},pr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function S$(t,e,n,r){e.value=n,e.getSnapshot=r,E$(e)&&T$(t)}function C$(t,e,n){return n(function(){E$(e)&&T$(t)})}function E$(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Oo(t,n)}catch{return!0}}function T$(t){var e=tl(t,1);e!==null&&Mo(e,t,1,-1)}function gj(t){var e=Qo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kp,lastRenderedState:t},e.queue=t,t=t.dispatch=UY.bind(null,pr,t),[e.memoizedState,t]}function jp(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=pr.updateQueue,e===null?(e={lastEffect:null,stores:null},pr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function I$(){return po().memoizedState}function Fx(t,e,n,r){var s=Qo();pr.flags|=t,s.memoizedState=jp(1|e,n,void 0,r===void 0?null:r)}function m0(t,e,n,r){var s=po();r=r===void 0?null:r;var i=void 0;if(qr!==null){var o=qr.memoizedState;if(i=o.destroy,r!==null&&Y1(r,o.deps)){s.memoizedState=jp(e,n,i,r);return}}pr.flags|=t,s.memoizedState=jp(1|e,n,i,r)}function yj(t,e){return Fx(8390656,8,t,e)}function X1(t,e){return m0(2048,8,t,e)}function N$(t,e){return m0(4,2,t,e)}function P$(t,e){return m0(4,4,t,e)}function A$(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function k$(t,e,n){return n=n!=null?n.concat([t]):null,m0(4,4,A$.bind(null,e,t),n)}function Z1(){}function j$(t,e){var n=po();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Y1(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function R$(t,e){var n=po();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Y1(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function D$(t,e,n){return Uu&21?(Oo(n,e)||(n=$O(),pr.lanes|=n,Bu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,di=!0),t.memoizedState=n)}function $Y(t,e){var n=kn;kn=n!==0&&4>n?n:4,t(!0);var r=L_.transition;L_.transition={};try{t(!1),e()}finally{kn=n,L_.transition=r}}function M$(){return po().memoizedState}function VY(t,e,n){var r=rc(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},L$(t))F$(e,n);else if(n=y$(t,e,n,r),n!==null){var s=Qs();Mo(n,t,r,s),O$(n,e,r)}}function UY(t,e,n){var r=rc(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(L$(t))F$(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Oo(l,o)){var c=e.interleaved;c===null?(s.next=s,G1(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=y$(t,e,s,r),n!==null&&(s=Qs(),Mo(n,t,r,s),O$(n,e,r))}}function L$(t){var e=t.alternate;return t===pr||e!==null&&e===pr}function F$(t,e){Vm=Vv=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function O$(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,A1(t,n)}}var Uv={readContext:mo,useCallback:Cs,useContext:Cs,useEffect:Cs,useImperativeHandle:Cs,useInsertionEffect:Cs,useLayoutEffect:Cs,useMemo:Cs,useReducer:Cs,useRef:Cs,useState:Cs,useDebugValue:Cs,useDeferredValue:Cs,useTransition:Cs,useMutableSource:Cs,useSyncExternalStore:Cs,useId:Cs,unstable_isNewReconciler:!1},BY={readContext:mo,useCallback:function(t,e){return Qo().memoizedState=[t,e===void 0?null:e],t},useContext:mo,useEffect:yj,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Fx(4194308,4,A$.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Fx(4194308,4,t,e)},useInsertionEffect:function(t,e){return Fx(4,2,t,e)},useMemo:function(t,e){var n=Qo();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Qo();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=VY.bind(null,pr,t),[r.memoizedState,t]},useRef:function(t){var e=Qo();return t={current:t},e.memoizedState=t},useState:gj,useDebugValue:Z1,useDeferredValue:function(t){return Qo().memoizedState=t},useTransition:function(){var t=gj(!1),e=t[0];return t=$Y.bind(null,t[1]),Qo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=pr,s=Qo();if(ir){if(n===void 0)throw Error(Ze(407));n=n()}else{if(n=e(),os===null)throw Error(Ze(349));Uu&30||_$(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,yj(C$.bind(null,r,i,t),[t]),r.flags|=2048,jp(9,S$.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Qo(),e=os.identifierPrefix;if(ir){var n=Ua,r=Va;n=(r&~(1<<32-Do(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ap++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=OY++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},zY={readContext:mo,useCallback:j$,useContext:mo,useEffect:X1,useImperativeHandle:k$,useInsertionEffect:N$,useLayoutEffect:P$,useMemo:R$,useReducer:F_,useRef:I$,useState:function(){return F_(kp)},useDebugValue:Z1,useDeferredValue:function(t){var e=po();return D$(e,qr.memoizedState,t)},useTransition:function(){var t=F_(kp)[0],e=po().memoizedState;return[t,e]},useMutableSource:w$,useSyncExternalStore:b$,useId:M$,unstable_isNewReconciler:!1},GY={readContext:mo,useCallback:j$,useContext:mo,useEffect:X1,useImperativeHandle:k$,useInsertionEffect:N$,useLayoutEffect:P$,useMemo:R$,useReducer:O_,useRef:I$,useState:function(){return O_(kp)},useDebugValue:Z1,useDeferredValue:function(t){var e=po();return qr===null?e.memoizedState=t:D$(e,qr.memoizedState,t)},useTransition:function(){var t=O_(kp)[0],e=po().memoizedState;return[t,e]},useMutableSource:w$,useSyncExternalStore:b$,useId:M$,unstable_isNewReconciler:!1};function Co(t,e){if(t&&t.defaultProps){e=yr({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function KC(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:yr({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var p0={isMounted:function(t){return(t=t._reactInternals)?ld(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Qs(),s=rc(t),i=Ha(r,s);i.payload=e,n!=null&&(i.callback=n),e=tc(t,i,s),e!==null&&(Mo(e,t,s,r),Mx(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Qs(),s=rc(t),i=Ha(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=tc(t,i,s),e!==null&&(Mo(e,t,s,r),Mx(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Qs(),r=rc(t),s=Ha(n,r);s.tag=2,e!=null&&(s.callback=e),e=tc(t,s,r),e!==null&&(Mo(e,t,r,n),Mx(e,t,r))}};function xj(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Cp(n,r)||!Cp(s,i):!0}function $$(t,e,n){var r=!1,s=wc,i=e.contextType;return typeof i=="object"&&i!==null?i=mo(i):(s=gi(e)?$u:Ls.current,r=e.contextTypes,i=(r=r!=null)?Fh(t,s):wc),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=p0,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function vj(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&p0.enqueueReplaceState(e,e.state,null)}function YC(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},W1(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=mo(i):(i=gi(e)?$u:Ls.current,s.context=Fh(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(KC(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&p0.enqueueReplaceState(s,s.state,null),Ov(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Uh(t,e){try{var n="",r=e;do n+=xK(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function $_(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function JC(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var WY=typeof WeakMap=="function"?WeakMap:Map;function V$(t,e,n){n=Ha(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){zv||(zv=!0,oE=r),JC(t,e)},n}function U$(t,e,n){n=Ha(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){JC(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){JC(t,e),typeof r!="function"&&(nc===null?nc=new Set([this]):nc.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function wj(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new WY;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=iJ.bind(null,t,e,n),e.then(t,t))}function bj(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function _j(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ha(-1,1),e.tag=2,tc(n,e,1))),n.lanes|=1),t)}var HY=fl.ReactCurrentOwner,di=!1;function Hs(t,e,n,r){e.child=t===null?g$(e,null,n,r):$h(e,t.child,n,r)}function Sj(t,e,n,r,s){n=n.render;var i=e.ref;return _h(e,s),r=J1(t,e,n,r,i,s),n=Q1(),t!==null&&!di?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nl(t,e,s)):(ir&&n&&O1(e),e.flags|=1,Hs(t,e,r,s),e.child)}function Cj(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!aI(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,B$(t,e,i,r,s)):(t=Ux(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Cp,n(o,r)&&t.ref===e.ref)return nl(t,e,s)}return e.flags|=1,t=sc(i,r),t.ref=e.ref,t.return=e,e.child=t}function B$(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Cp(i,r)&&t.ref===e.ref)if(di=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(di=!0);else return e.lanes=t.lanes,nl(t,e,s)}return QC(t,e,n,r,s)}function z$(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wn(oh,ji),ji|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Wn(oh,ji),ji|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Wn(oh,ji),ji|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Wn(oh,ji),ji|=r;return Hs(t,e,s,n),e.child}function G$(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function QC(t,e,n,r,s){var i=gi(n)?$u:Ls.current;return i=Fh(e,i),_h(e,s),n=J1(t,e,n,r,i,s),r=Q1(),t!==null&&!di?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nl(t,e,s)):(ir&&r&&O1(e),e.flags|=1,Hs(t,e,n,s),e.child)}function Ej(t,e,n,r,s){if(gi(n)){var i=!0;Rv(e)}else i=!1;if(_h(e,s),e.stateNode===null)Ox(t,e),$$(e,n,r),YC(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=mo(u):(u=gi(n)?$u:Ls.current,u=Fh(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&vj(e,o,r,u),Fl=!1;var f=e.memoizedState;o.state=f,Ov(e,r,o,s),c=e.memoizedState,l!==r||f!==c||pi.current||Fl?(typeof d=="function"&&(KC(e,n,d,r),c=e.memoizedState),(l=Fl||xj(e,n,l,r,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,x$(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Co(e.type,l),o.props=u,h=e.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=mo(c):(c=gi(n)?$u:Ls.current,c=Fh(e,c));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&vj(e,o,r,c),Fl=!1,f=e.memoizedState,o.state=f,Ov(e,r,o,s);var g=e.memoizedState;l!==h||f!==g||pi.current||Fl?(typeof m=="function"&&(KC(e,n,m,r),g=e.memoizedState),(u=Fl||xj(e,n,u,r,f,g,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return XC(t,e,n,r,i,s)}function XC(t,e,n,r,s,i){G$(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&uj(e,n,!1),nl(t,e,i);r=e.stateNode,HY.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=$h(e,t.child,null,i),e.child=$h(e,null,l,i)):Hs(t,e,l,i),e.memoizedState=r.state,s&&uj(e,n,!0),e.child}function W$(t){var e=t.stateNode;e.pendingContext?cj(t,e.pendingContext,e.pendingContext!==e.context):e.context&&cj(t,e.context,!1),H1(t,e.containerInfo)}function Tj(t,e,n,r,s){return Oh(),V1(s),e.flags|=256,Hs(t,e,n,r),e.child}var ZC={dehydrated:null,treeContext:null,retryLane:0};function eE(t){return{baseLanes:t,cachePool:null,transitions:null}}function H$(t,e,n){var r=e.pendingProps,s=hr.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Wn(hr,s&1),t===null)return HC(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=x0(o,r,0,null),t=ku(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=eE(n),e.memoizedState=ZC,t):eI(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return qY(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=sc(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=sc(l,i):(i=ku(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?eE(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=ZC,r}return i=t.child,t=i.sibling,r=sc(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function eI(t,e){return e=x0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ky(t,e,n,r){return r!==null&&V1(r),$h(e,t.child,null,n),t=eI(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function qY(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=$_(Error(Ze(422))),ky(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=x0({mode:"visible",children:r.children},s,0,null),i=ku(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&$h(e,t.child,null,o),e.child.memoizedState=eE(o),e.memoizedState=ZC,i);if(!(e.mode&1))return ky(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(Ze(419)),r=$_(i,r,void 0),ky(t,e,o,r)}if(l=(o&t.childLanes)!==0,di||l){if(r=os,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,tl(t,s),Mo(r,t,s,-1))}return oI(),r=$_(Error(Ze(421))),ky(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=oJ.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Oi=ec(s.nextSibling),Bi=e,ir=!0,Po=null,t!==null&&(to[no++]=Va,to[no++]=Ua,to[no++]=Vu,Va=t.id,Ua=t.overflow,Vu=e),e=eI(e,r.children),e.flags|=4096,e)}function Ij(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),qC(t.return,e,n)}function V_(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function q$(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Hs(t,e,r.children,n),r=hr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ij(t,n,e);else if(t.tag===19)Ij(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Wn(hr,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&$v(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),V_(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&$v(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}V_(e,!0,n,null,i);break;case"together":V_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ox(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function nl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Bu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Ze(153));if(e.child!==null){for(t=e.child,n=sc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=sc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function KY(t,e,n){switch(e.tag){case 3:W$(e),Oh();break;case 5:v$(e);break;case 1:gi(e.type)&&Rv(e);break;case 4:H1(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Wn(Lv,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Wn(hr,hr.current&1),e.flags|=128,null):n&e.child.childLanes?H$(t,e,n):(Wn(hr,hr.current&1),t=nl(t,e,n),t!==null?t.sibling:null);Wn(hr,hr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return q$(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Wn(hr,hr.current),r)break;return null;case 22:case 23:return e.lanes=0,z$(t,e,n)}return nl(t,e,n)}var K$,tE,Y$,J$;K$=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};tE=function(){};Y$=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,bu(da.current);var i=null;switch(n){case"input":s=SC(t,s),r=SC(t,r),i=[];break;case"select":s=yr({},s,{value:void 0}),r=yr({},r,{value:void 0}),i=[];break;case"textarea":s=TC(t,s),r=TC(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=kv)}NC(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(yp.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(yp.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Jn("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};J$=function(t,e,n,r){n!==r&&(e.flags|=4)};function Gf(t,e){if(!ir)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Es(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function YY(t,e,n){var r=e.pendingProps;switch($1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Es(e),null;case 1:return gi(e.type)&&jv(),Es(e),null;case 3:return r=e.stateNode,Vh(),Xn(pi),Xn(Ls),K1(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Py(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Po!==null&&(cE(Po),Po=null))),tE(t,e),Es(e),null;case 5:q1(e);var s=bu(Pp.current);if(n=e.type,t!==null&&e.stateNode!=null)Y$(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Ze(166));return Es(e),null}if(t=bu(da.current),Py(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[na]=e,r[Ip]=i,t=(e.mode&1)!==0,n){case"dialog":Jn("cancel",r),Jn("close",r);break;case"iframe":case"object":case"embed":Jn("load",r);break;case"video":case"audio":for(s=0;s<ym.length;s++)Jn(ym[s],r);break;case"source":Jn("error",r);break;case"img":case"image":case"link":Jn("error",r),Jn("load",r);break;case"details":Jn("toggle",r);break;case"input":Lk(r,i),Jn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Jn("invalid",r);break;case"textarea":Ok(r,i),Jn("invalid",r)}NC(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ny(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ny(r.textContent,l,t),s=["children",""+l]):yp.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Jn("scroll",r)}switch(n){case"input":wy(r),Fk(r,i,!0);break;case"textarea":wy(r),$k(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=kv)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=CO(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[na]=e,t[Ip]=r,K$(t,e,!1,!1),e.stateNode=t;e:{switch(o=PC(n,r),n){case"dialog":Jn("cancel",t),Jn("close",t),s=r;break;case"iframe":case"object":case"embed":Jn("load",t),s=r;break;case"video":case"audio":for(s=0;s<ym.length;s++)Jn(ym[s],t);s=r;break;case"source":Jn("error",t),s=r;break;case"img":case"image":case"link":Jn("error",t),Jn("load",t),s=r;break;case"details":Jn("toggle",t),s=r;break;case"input":Lk(t,r),s=SC(t,r),Jn("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=yr({},r,{value:void 0}),Jn("invalid",t);break;case"textarea":Ok(t,r),s=TC(t,r),Jn("invalid",t);break;default:s=r}NC(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?IO(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&EO(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&xp(t,c):typeof c=="number"&&xp(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(yp.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Jn("scroll",t):c!=null&&C1(t,i,c,o))}switch(n){case"input":wy(t),Fk(t,r,!1);break;case"textarea":wy(t),$k(t);break;case"option":r.value!=null&&t.setAttribute("value",""+vc(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?xh(t,!!r.multiple,i,!1):r.defaultValue!=null&&xh(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=kv)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Es(e),null;case 6:if(t&&e.stateNode!=null)J$(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Ze(166));if(n=bu(Pp.current),bu(da.current),Py(e)){if(r=e.stateNode,n=e.memoizedProps,r[na]=e,(i=r.nodeValue!==n)&&(t=Bi,t!==null))switch(t.tag){case 3:Ny(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ny(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[na]=e,e.stateNode=r}return Es(e),null;case 13:if(Xn(hr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ir&&Oi!==null&&e.mode&1&&!(e.flags&128))m$(),Oh(),e.flags|=98560,i=!1;else if(i=Py(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Ze(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ze(317));i[na]=e}else Oh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Es(e),i=!1}else Po!==null&&(cE(Po),Po=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||hr.current&1?Kr===0&&(Kr=3):oI())),e.updateQueue!==null&&(e.flags|=4),Es(e),null);case 4:return Vh(),tE(t,e),t===null&&Ep(e.stateNode.containerInfo),Es(e),null;case 10:return z1(e.type._context),Es(e),null;case 17:return gi(e.type)&&jv(),Es(e),null;case 19:if(Xn(hr),i=e.memoizedState,i===null)return Es(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Gf(i,!1);else{if(Kr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=$v(t),o!==null){for(e.flags|=128,Gf(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Wn(hr,hr.current&1|2),e.child}t=t.sibling}i.tail!==null&&Dr()>Bh&&(e.flags|=128,r=!0,Gf(i,!1),e.lanes=4194304)}else{if(!r)if(t=$v(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Gf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ir)return Es(e),null}else 2*Dr()-i.renderingStartTime>Bh&&n!==1073741824&&(e.flags|=128,r=!0,Gf(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Dr(),e.sibling=null,n=hr.current,Wn(hr,r?n&1|2:n&1),e):(Es(e),null);case 22:case 23:return iI(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ji&1073741824&&(Es(e),e.subtreeFlags&6&&(e.flags|=8192)):Es(e),null;case 24:return null;case 25:return null}throw Error(Ze(156,e.tag))}function JY(t,e){switch($1(e),e.tag){case 1:return gi(e.type)&&jv(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Vh(),Xn(pi),Xn(Ls),K1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return q1(e),null;case 13:if(Xn(hr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Ze(340));Oh()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Xn(hr),null;case 4:return Vh(),null;case 10:return z1(e.type._context),null;case 22:case 23:return iI(),null;case 24:return null;default:return null}}var jy=!1,ks=!1,QY=typeof WeakSet=="function"?WeakSet:Set,vt=null;function ih(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Cr(t,e,r)}else n.current=null}function nE(t,e,n){try{n()}catch(r){Cr(t,e,r)}}var Nj=!1;function XY(t,e){if($C=Nv,t=t$(),F1(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++u===s&&(l=o),f===i&&++d===r&&(c=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(VC={focusedElem:t,selectionRange:n},Nv=!1,vt=e;vt!==null;)if(e=vt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,vt=t;else for(;vt!==null;){e=vt;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,v=g.memoizedState,w=e.stateNode,_=w.getSnapshotBeforeUpdate(e.elementType===e.type?x:Co(e.type,x),v);w.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ze(163))}}catch(T){Cr(e,e.return,T)}if(t=e.sibling,t!==null){t.return=e.return,vt=t;break}vt=e.return}return g=Nj,Nj=!1,g}function Um(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&nE(e,n,i)}s=s.next}while(s!==r)}}function g0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function rE(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Q$(t){var e=t.alternate;e!==null&&(t.alternate=null,Q$(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[na],delete e[Ip],delete e[zC],delete e[DY],delete e[MY])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function X$(t){return t.tag===5||t.tag===3||t.tag===4}function Pj(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||X$(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function sE(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=kv));else if(r!==4&&(t=t.child,t!==null))for(sE(t,e,n),t=t.sibling;t!==null;)sE(t,e,n),t=t.sibling}function iE(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(iE(t,e,n),t=t.sibling;t!==null;)iE(t,e,n),t=t.sibling}var ds=null,To=!1;function bl(t,e,n){for(n=n.child;n!==null;)Z$(t,e,n),n=n.sibling}function Z$(t,e,n){if(ua&&typeof ua.onCommitFiberUnmount=="function")try{ua.onCommitFiberUnmount(l0,n)}catch{}switch(n.tag){case 5:ks||ih(n,e);case 6:var r=ds,s=To;ds=null,bl(t,e,n),ds=r,To=s,ds!==null&&(To?(t=ds,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ds.removeChild(n.stateNode));break;case 18:ds!==null&&(To?(t=ds,n=n.stateNode,t.nodeType===8?R_(t.parentNode,n):t.nodeType===1&&R_(t,n),_p(t)):R_(ds,n.stateNode));break;case 4:r=ds,s=To,ds=n.stateNode.containerInfo,To=!0,bl(t,e,n),ds=r,To=s;break;case 0:case 11:case 14:case 15:if(!ks&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&nE(n,e,o),s=s.next}while(s!==r)}bl(t,e,n);break;case 1:if(!ks&&(ih(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Cr(n,e,l)}bl(t,e,n);break;case 21:bl(t,e,n);break;case 22:n.mode&1?(ks=(r=ks)||n.memoizedState!==null,bl(t,e,n),ks=r):bl(t,e,n);break;default:bl(t,e,n)}}function Aj(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new QY),e.forEach(function(r){var s=aJ.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function bo(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:ds=l.stateNode,To=!1;break e;case 3:ds=l.stateNode.containerInfo,To=!0;break e;case 4:ds=l.stateNode.containerInfo,To=!0;break e}l=l.return}if(ds===null)throw Error(Ze(160));Z$(i,o,s),ds=null,To=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Cr(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)eV(e,t),e=e.sibling}function eV(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(bo(e,t),qo(t),r&4){try{Um(3,t,t.return),g0(3,t)}catch(x){Cr(t,t.return,x)}try{Um(5,t,t.return)}catch(x){Cr(t,t.return,x)}}break;case 1:bo(e,t),qo(t),r&512&&n!==null&&ih(n,n.return);break;case 5:if(bo(e,t),qo(t),r&512&&n!==null&&ih(n,n.return),t.flags&32){var s=t.stateNode;try{xp(s,"")}catch(x){Cr(t,t.return,x)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&_O(s,i),PC(l,o);var u=PC(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?IO(s,h):d==="dangerouslySetInnerHTML"?EO(s,h):d==="children"?xp(s,h):C1(s,d,h,u)}switch(l){case"input":CC(s,i);break;case"textarea":SO(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?xh(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?xh(s,!!i.multiple,i.defaultValue,!0):xh(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ip]=i}catch(x){Cr(t,t.return,x)}}break;case 6:if(bo(e,t),qo(t),r&4){if(t.stateNode===null)throw Error(Ze(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(x){Cr(t,t.return,x)}}break;case 3:if(bo(e,t),qo(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{_p(e.containerInfo)}catch(x){Cr(t,t.return,x)}break;case 4:bo(e,t),qo(t);break;case 13:bo(e,t),qo(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(rI=Dr())),r&4&&Aj(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(ks=(u=ks)||d,bo(e,t),ks=u):bo(e,t),qo(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(vt=t,d=t.child;d!==null;){for(h=vt=d;vt!==null;){switch(f=vt,m=f.child,f.tag){case 0:case 11:case 14:case 15:Um(4,f,f.return);break;case 1:ih(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(x){Cr(r,n,x)}}break;case 5:ih(f,f.return);break;case 22:if(f.memoizedState!==null){jj(h);continue}}m!==null?(m.return=f,vt=m):jj(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=TO("display",o))}catch(x){Cr(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){Cr(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:bo(e,t),qo(t),r&4&&Aj(t);break;case 21:break;default:bo(e,t),qo(t)}}function qo(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(X$(n)){var r=n;break e}n=n.return}throw Error(Ze(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(xp(s,""),r.flags&=-33);var i=Pj(t);iE(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Pj(t);sE(t,l,o);break;default:throw Error(Ze(161))}}catch(c){Cr(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ZY(t,e,n){vt=t,tV(t)}function tV(t,e,n){for(var r=(t.mode&1)!==0;vt!==null;){var s=vt,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||jy;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||ks;l=jy;var u=ks;if(jy=o,(ks=c)&&!u)for(vt=s;vt!==null;)o=vt,c=o.child,o.tag===22&&o.memoizedState!==null?Rj(s):c!==null?(c.return=o,vt=c):Rj(s);for(;i!==null;)vt=i,tV(i),i=i.sibling;vt=s,jy=l,ks=u}kj(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,vt=i):kj(t)}}function kj(t){for(;vt!==null;){var e=vt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ks||g0(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ks)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Co(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&pj(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}pj(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&_p(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ze(163))}ks||e.flags&512&&rE(e)}catch(f){Cr(e,e.return,f)}}if(e===t){vt=null;break}if(n=e.sibling,n!==null){n.return=e.return,vt=n;break}vt=e.return}}function jj(t){for(;vt!==null;){var e=vt;if(e===t){vt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,vt=n;break}vt=e.return}}function Rj(t){for(;vt!==null;){var e=vt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{g0(4,e)}catch(c){Cr(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Cr(e,s,c)}}var i=e.return;try{rE(e)}catch(c){Cr(e,i,c)}break;case 5:var o=e.return;try{rE(e)}catch(c){Cr(e,o,c)}}}catch(c){Cr(e,e.return,c)}if(e===t){vt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,vt=l;break}vt=e.return}}var eJ=Math.ceil,Bv=fl.ReactCurrentDispatcher,tI=fl.ReactCurrentOwner,co=fl.ReactCurrentBatchConfig,gn=0,os=null,Or=null,gs=0,ji=0,oh=jc(0),Kr=0,Rp=null,Bu=0,y0=0,nI=0,Bm=null,ui=null,rI=0,Bh=1/0,Da=null,zv=!1,oE=null,nc=null,Ry=!1,ql=null,Gv=0,zm=0,aE=null,$x=-1,Vx=0;function Qs(){return gn&6?Dr():$x!==-1?$x:$x=Dr()}function rc(t){return t.mode&1?gn&2&&gs!==0?gs&-gs:FY.transition!==null?(Vx===0&&(Vx=$O()),Vx):(t=kn,t!==0||(t=window.event,t=t===void 0?16:HO(t.type)),t):1}function Mo(t,e,n,r){if(50<zm)throw zm=0,aE=null,Error(Ze(185));gg(t,n,r),(!(gn&2)||t!==os)&&(t===os&&(!(gn&2)&&(y0|=n),Kr===4&&Vl(t,gs)),yi(t,r),n===1&&gn===0&&!(e.mode&1)&&(Bh=Dr()+500,f0&&Rc()))}function yi(t,e){var n=t.callbackNode;FK(t,e);var r=Iv(t,t===os?gs:0);if(r===0)n!==null&&Bk(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Bk(n),e===1)t.tag===0?LY(Dj.bind(null,t)):d$(Dj.bind(null,t)),jY(function(){!(gn&6)&&Rc()}),n=null;else{switch(VO(r)){case 1:n=P1;break;case 4:n=FO;break;case 16:n=Tv;break;case 536870912:n=OO;break;default:n=Tv}n=cV(n,nV.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function nV(t,e){if($x=-1,Vx=0,gn&6)throw Error(Ze(327));var n=t.callbackNode;if(Sh()&&t.callbackNode!==n)return null;var r=Iv(t,t===os?gs:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Wv(t,r);else{e=r;var s=gn;gn|=2;var i=sV();(os!==t||gs!==e)&&(Da=null,Bh=Dr()+500,Au(t,e));do try{rJ();break}catch(l){rV(t,l)}while(1);B1(),Bv.current=i,gn=s,Or!==null?e=0:(os=null,gs=0,e=Kr)}if(e!==0){if(e===2&&(s=DC(t),s!==0&&(r=s,e=lE(t,s))),e===1)throw n=Rp,Au(t,0),Vl(t,r),yi(t,Dr()),n;if(e===6)Vl(t,r);else{if(s=t.current.alternate,!(r&30)&&!tJ(s)&&(e=Wv(t,r),e===2&&(i=DC(t),i!==0&&(r=i,e=lE(t,i))),e===1))throw n=Rp,Au(t,0),Vl(t,r),yi(t,Dr()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(Ze(345));case 2:su(t,ui,Da);break;case 3:if(Vl(t,r),(r&130023424)===r&&(e=rI+500-Dr(),10<e)){if(Iv(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Qs(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=BC(su.bind(null,t,ui,Da),e);break}su(t,ui,Da);break;case 4:if(Vl(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Do(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Dr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*eJ(r/1960))-r,10<r){t.timeoutHandle=BC(su.bind(null,t,ui,Da),r);break}su(t,ui,Da);break;case 5:su(t,ui,Da);break;default:throw Error(Ze(329))}}}return yi(t,Dr()),t.callbackNode===n?nV.bind(null,t):null}function lE(t,e){var n=Bm;return t.current.memoizedState.isDehydrated&&(Au(t,e).flags|=256),t=Wv(t,e),t!==2&&(e=ui,ui=n,e!==null&&cE(e)),t}function cE(t){ui===null?ui=t:ui.push.apply(ui,t)}function tJ(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Oo(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Vl(t,e){for(e&=~nI,e&=~y0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Do(e),r=1<<n;t[n]=-1,e&=~r}}function Dj(t){if(gn&6)throw Error(Ze(327));Sh();var e=Iv(t,0);if(!(e&1))return yi(t,Dr()),null;var n=Wv(t,e);if(t.tag!==0&&n===2){var r=DC(t);r!==0&&(e=r,n=lE(t,r))}if(n===1)throw n=Rp,Au(t,0),Vl(t,e),yi(t,Dr()),n;if(n===6)throw Error(Ze(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,su(t,ui,Da),yi(t,Dr()),null}function sI(t,e){var n=gn;gn|=1;try{return t(e)}finally{gn=n,gn===0&&(Bh=Dr()+500,f0&&Rc())}}function zu(t){ql!==null&&ql.tag===0&&!(gn&6)&&Sh();var e=gn;gn|=1;var n=co.transition,r=kn;try{if(co.transition=null,kn=1,t)return t()}finally{kn=r,co.transition=n,gn=e,!(gn&6)&&Rc()}}function iI(){ji=oh.current,Xn(oh)}function Au(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,kY(n)),Or!==null)for(n=Or.return;n!==null;){var r=n;switch($1(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&jv();break;case 3:Vh(),Xn(pi),Xn(Ls),K1();break;case 5:q1(r);break;case 4:Vh();break;case 13:Xn(hr);break;case 19:Xn(hr);break;case 10:z1(r.type._context);break;case 22:case 23:iI()}n=n.return}if(os=t,Or=t=sc(t.current,null),gs=ji=e,Kr=0,Rp=null,nI=y0=Bu=0,ui=Bm=null,wu!==null){for(e=0;e<wu.length;e++)if(n=wu[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}wu=null}return t}function rV(t,e){do{var n=Or;try{if(B1(),Lx.current=Uv,Vv){for(var r=pr.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Vv=!1}if(Uu=0,ss=qr=pr=null,Vm=!1,Ap=0,tI.current=null,n===null||n.return===null){Kr=1,Rp=e,Or=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=gs,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=bj(o);if(m!==null){m.flags&=-257,_j(m,o,l,i,e),m.mode&1&&wj(i,u,e),e=m,c=u;var g=e.updateQueue;if(g===null){var x=new Set;x.add(c),e.updateQueue=x}else g.add(c);break e}else{if(!(e&1)){wj(i,u,e),oI();break e}c=Error(Ze(426))}}else if(ir&&l.mode&1){var v=bj(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),_j(v,o,l,i,e),V1(Uh(c,l));break e}}i=c=Uh(c,l),Kr!==4&&(Kr=2),Bm===null?Bm=[i]:Bm.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=V$(i,c,e);mj(i,w);break e;case 1:l=c;var _=i.type,C=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(nc===null||!nc.has(C)))){i.flags|=65536,e&=-e,i.lanes|=e;var T=U$(i,l,e);mj(i,T);break e}}i=i.return}while(i!==null)}oV(n)}catch(j){e=j,Or===n&&n!==null&&(Or=n=n.return);continue}break}while(1)}function sV(){var t=Bv.current;return Bv.current=Uv,t===null?Uv:t}function oI(){(Kr===0||Kr===3||Kr===2)&&(Kr=4),os===null||!(Bu&268435455)&&!(y0&268435455)||Vl(os,gs)}function Wv(t,e){var n=gn;gn|=2;var r=sV();(os!==t||gs!==e)&&(Da=null,Au(t,e));do try{nJ();break}catch(s){rV(t,s)}while(1);if(B1(),gn=n,Bv.current=r,Or!==null)throw Error(Ze(261));return os=null,gs=0,Kr}function nJ(){for(;Or!==null;)iV(Or)}function rJ(){for(;Or!==null&&!NK();)iV(Or)}function iV(t){var e=lV(t.alternate,t,ji);t.memoizedProps=t.pendingProps,e===null?oV(t):Or=e,tI.current=null}function oV(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=JY(n,e),n!==null){n.flags&=32767,Or=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Kr=6,Or=null;return}}else if(n=YY(n,e,ji),n!==null){Or=n;return}if(e=e.sibling,e!==null){Or=e;return}Or=e=t}while(e!==null);Kr===0&&(Kr=5)}function su(t,e,n){var r=kn,s=co.transition;try{co.transition=null,kn=1,sJ(t,e,n,r)}finally{co.transition=s,kn=r}return null}function sJ(t,e,n,r){do Sh();while(ql!==null);if(gn&6)throw Error(Ze(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Ze(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(OK(t,i),t===os&&(Or=os=null,gs=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ry||(Ry=!0,cV(Tv,function(){return Sh(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=co.transition,co.transition=null;var o=kn;kn=1;var l=gn;gn|=4,tI.current=null,XY(t,n),eV(n,t),CY(VC),Nv=!!$C,VC=$C=null,t.current=n,ZY(n),PK(),gn=l,kn=o,co.transition=i}else t.current=n;if(Ry&&(Ry=!1,ql=t,Gv=s),i=t.pendingLanes,i===0&&(nc=null),jK(n.stateNode),yi(t,Dr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(zv)throw zv=!1,t=oE,oE=null,t;return Gv&1&&t.tag!==0&&Sh(),i=t.pendingLanes,i&1?t===aE?zm++:(zm=0,aE=t):zm=0,Rc(),null}function Sh(){if(ql!==null){var t=VO(Gv),e=co.transition,n=kn;try{if(co.transition=null,kn=16>t?16:t,ql===null)var r=!1;else{if(t=ql,ql=null,Gv=0,gn&6)throw Error(Ze(331));var s=gn;for(gn|=4,vt=t.current;vt!==null;){var i=vt,o=i.child;if(vt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(vt=u;vt!==null;){var d=vt;switch(d.tag){case 0:case 11:case 15:Um(8,d,i)}var h=d.child;if(h!==null)h.return=d,vt=h;else for(;vt!==null;){d=vt;var f=d.sibling,m=d.return;if(Q$(d),d===u){vt=null;break}if(f!==null){f.return=m,vt=f;break}vt=m}}}var g=i.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var v=x.sibling;x.sibling=null,x=v}while(x!==null)}}vt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,vt=o;else e:for(;vt!==null;){if(i=vt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Um(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,vt=w;break e}vt=i.return}}var _=t.current;for(vt=_;vt!==null;){o=vt;var C=o.child;if(o.subtreeFlags&2064&&C!==null)C.return=o,vt=C;else e:for(o=_;vt!==null;){if(l=vt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:g0(9,l)}}catch(j){Cr(l,l.return,j)}if(l===o){vt=null;break e}var T=l.sibling;if(T!==null){T.return=l.return,vt=T;break e}vt=l.return}}if(gn=s,Rc(),ua&&typeof ua.onPostCommitFiberRoot=="function")try{ua.onPostCommitFiberRoot(l0,t)}catch{}r=!0}return r}finally{kn=n,co.transition=e}}return!1}function Mj(t,e,n){e=Uh(n,e),e=V$(t,e,1),t=tc(t,e,1),e=Qs(),t!==null&&(gg(t,1,e),yi(t,e))}function Cr(t,e,n){if(t.tag===3)Mj(t,t,n);else for(;e!==null;){if(e.tag===3){Mj(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(nc===null||!nc.has(r))){t=Uh(n,t),t=U$(e,t,1),e=tc(e,t,1),t=Qs(),e!==null&&(gg(e,1,t),yi(e,t));break}}e=e.return}}function iJ(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Qs(),t.pingedLanes|=t.suspendedLanes&n,os===t&&(gs&n)===n&&(Kr===4||Kr===3&&(gs&130023424)===gs&&500>Dr()-rI?Au(t,0):nI|=n),yi(t,e)}function aV(t,e){e===0&&(t.mode&1?(e=Sy,Sy<<=1,!(Sy&130023424)&&(Sy=4194304)):e=1);var n=Qs();t=tl(t,e),t!==null&&(gg(t,e,n),yi(t,n))}function oJ(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),aV(t,n)}function aJ(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Ze(314))}r!==null&&r.delete(e),aV(t,n)}var lV;lV=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||pi.current)di=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return di=!1,KY(t,e,n);di=!!(t.flags&131072)}else di=!1,ir&&e.flags&1048576&&h$(e,Mv,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ox(t,e),t=e.pendingProps;var s=Fh(e,Ls.current);_h(e,n),s=J1(null,e,r,t,s,n);var i=Q1();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,gi(r)?(i=!0,Rv(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,W1(e),s.updater=p0,e.stateNode=s,s._reactInternals=e,YC(e,r,t,n),e=XC(null,e,r,!0,i,n)):(e.tag=0,ir&&i&&O1(e),Hs(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ox(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=cJ(r),t=Co(r,t),s){case 0:e=QC(null,e,r,t,n);break e;case 1:e=Ej(null,e,r,t,n);break e;case 11:e=Sj(null,e,r,t,n);break e;case 14:e=Cj(null,e,r,Co(r.type,t),n);break e}throw Error(Ze(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Co(r,s),QC(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Co(r,s),Ej(t,e,r,s,n);case 3:e:{if(W$(e),t===null)throw Error(Ze(387));r=e.pendingProps,i=e.memoizedState,s=i.element,x$(t,e),Ov(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Uh(Error(Ze(423)),e),e=Tj(t,e,r,n,s);break e}else if(r!==s){s=Uh(Error(Ze(424)),e),e=Tj(t,e,r,n,s);break e}else for(Oi=ec(e.stateNode.containerInfo.firstChild),Bi=e,ir=!0,Po=null,n=g$(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Oh(),r===s){e=nl(t,e,n);break e}Hs(t,e,r,n)}e=e.child}return e;case 5:return v$(e),t===null&&HC(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,UC(r,s)?o=null:i!==null&&UC(r,i)&&(e.flags|=32),G$(t,e),Hs(t,e,o,n),e.child;case 6:return t===null&&HC(e),null;case 13:return H$(t,e,n);case 4:return H1(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=$h(e,null,r,n):Hs(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Co(r,s),Sj(t,e,r,s,n);case 7:return Hs(t,e,e.pendingProps,n),e.child;case 8:return Hs(t,e,e.pendingProps.children,n),e.child;case 12:return Hs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Wn(Lv,r._currentValue),r._currentValue=o,i!==null)if(Oo(i.value,o)){if(i.children===s.children&&!pi.current){e=nl(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Ha(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),qC(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Ze(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),qC(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Hs(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,_h(e,n),s=mo(s),r=r(s),e.flags|=1,Hs(t,e,r,n),e.child;case 14:return r=e.type,s=Co(r,e.pendingProps),s=Co(r.type,s),Cj(t,e,r,s,n);case 15:return B$(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Co(r,s),Ox(t,e),e.tag=1,gi(r)?(t=!0,Rv(e)):t=!1,_h(e,n),$$(e,r,s),YC(e,r,s,n),XC(null,e,r,!0,t,n);case 19:return q$(t,e,n);case 22:return z$(t,e,n)}throw Error(Ze(156,e.tag))};function cV(t,e){return LO(t,e)}function lJ(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oo(t,e,n,r){return new lJ(t,e,n,r)}function aI(t){return t=t.prototype,!(!t||!t.isReactComponent)}function cJ(t){if(typeof t=="function")return aI(t)?1:0;if(t!=null){if(t=t.$$typeof,t===T1)return 11;if(t===I1)return 14}return 2}function sc(t,e){var n=t.alternate;return n===null?(n=oo(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ux(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")aI(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Jd:return ku(n.children,s,i,e);case E1:o=8,s|=8;break;case vC:return t=oo(12,n,e,s|2),t.elementType=vC,t.lanes=i,t;case wC:return t=oo(13,n,e,s),t.elementType=wC,t.lanes=i,t;case bC:return t=oo(19,n,e,s),t.elementType=bC,t.lanes=i,t;case vO:return x0(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case yO:o=10;break e;case xO:o=9;break e;case T1:o=11;break e;case I1:o=14;break e;case Ll:o=16,r=null;break e}throw Error(Ze(130,t==null?t:typeof t,""))}return e=oo(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ku(t,e,n,r){return t=oo(7,t,r,e),t.lanes=n,t}function x0(t,e,n,r){return t=oo(22,t,r,e),t.elementType=vO,t.lanes=n,t.stateNode={isHidden:!1},t}function U_(t,e,n){return t=oo(6,t,null,e),t.lanes=n,t}function B_(t,e,n){return e=oo(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function uJ(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=__(0),this.expirationTimes=__(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=__(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function lI(t,e,n,r,s,i,o,l,c){return t=new uJ(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=oo(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},W1(i),t}function dJ(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Yd,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function uV(t){if(!t)return wc;t=t._reactInternals;e:{if(ld(t)!==t||t.tag!==1)throw Error(Ze(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(gi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ze(171))}if(t.tag===1){var n=t.type;if(gi(n))return u$(t,n,e)}return e}function dV(t,e,n,r,s,i,o,l,c){return t=lI(n,r,!0,t,s,i,o,l,c),t.context=uV(null),n=t.current,r=Qs(),s=rc(n),i=Ha(r,s),i.callback=e??null,tc(n,i,s),t.current.lanes=s,gg(t,s,r),yi(t,r),t}function v0(t,e,n,r){var s=e.current,i=Qs(),o=rc(s);return n=uV(n),e.context===null?e.context=n:e.pendingContext=n,e=Ha(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=tc(s,e,o),t!==null&&(Mo(t,s,o,i),Mx(t,s,o)),o}function Hv(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Lj(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function cI(t,e){Lj(t,e),(t=t.alternate)&&Lj(t,e)}function hJ(){return null}var hV=typeof reportError=="function"?reportError:function(t){console.error(t)};function uI(t){this._internalRoot=t}w0.prototype.render=uI.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Ze(409));v0(t,e,null,null)};w0.prototype.unmount=uI.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;zu(function(){v0(null,t,null,null)}),e[el]=null}};function w0(t){this._internalRoot=t}w0.prototype.unstable_scheduleHydration=function(t){if(t){var e=zO();t={blockedOn:null,target:t,priority:e};for(var n=0;n<$l.length&&e!==0&&e<$l[n].priority;n++);$l.splice(n,0,t),n===0&&WO(t)}};function dI(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function b0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Fj(){}function fJ(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Hv(o);i.call(u)}}var o=dV(e,r,t,0,null,!1,!1,"",Fj);return t._reactRootContainer=o,t[el]=o.current,Ep(t.nodeType===8?t.parentNode:t),zu(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Hv(c);l.call(u)}}var c=lI(t,0,!1,null,null,!1,!1,"",Fj);return t._reactRootContainer=c,t[el]=c.current,Ep(t.nodeType===8?t.parentNode:t),zu(function(){v0(e,c,n,r)}),c}function _0(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Hv(o);l.call(c)}}v0(e,o,t,s)}else o=fJ(n,e,t,s,r);return Hv(o)}UO=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=gm(e.pendingLanes);n!==0&&(A1(e,n|1),yi(e,Dr()),!(gn&6)&&(Bh=Dr()+500,Rc()))}break;case 13:zu(function(){var r=tl(t,1);if(r!==null){var s=Qs();Mo(r,t,1,s)}}),cI(t,1)}};k1=function(t){if(t.tag===13){var e=tl(t,134217728);if(e!==null){var n=Qs();Mo(e,t,134217728,n)}cI(t,134217728)}};BO=function(t){if(t.tag===13){var e=rc(t),n=tl(t,e);if(n!==null){var r=Qs();Mo(n,t,e,r)}cI(t,e)}};zO=function(){return kn};GO=function(t,e){var n=kn;try{return kn=t,e()}finally{kn=n}};kC=function(t,e,n){switch(e){case"input":if(CC(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=h0(r);if(!s)throw Error(Ze(90));bO(r),CC(r,s)}}}break;case"textarea":SO(t,n);break;case"select":e=n.value,e!=null&&xh(t,!!n.multiple,e,!1)}};AO=sI;kO=zu;var mJ={usingClientEntryPoint:!1,Events:[xg,eh,h0,NO,PO,sI]},Wf={findFiberByHostInstance:vu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pJ={bundleType:Wf.bundleType,version:Wf.version,rendererPackageName:Wf.rendererPackageName,rendererConfig:Wf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=DO(t),t===null?null:t.stateNode},findFiberByHostInstance:Wf.findFiberByHostInstance||hJ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dy.isDisabled&&Dy.supportsFiber)try{l0=Dy.inject(pJ),ua=Dy}catch{}}Yi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mJ;Yi.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dI(e))throw Error(Ze(200));return dJ(t,e,null,n)};Yi.createRoot=function(t,e){if(!dI(t))throw Error(Ze(299));var n=!1,r="",s=hV;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=lI(t,1,!1,null,null,n,!1,r,s),t[el]=e.current,Ep(t.nodeType===8?t.parentNode:t),new uI(e)};Yi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Ze(188)):(t=Object.keys(t).join(","),Error(Ze(268,t)));return t=DO(e),t=t===null?null:t.stateNode,t};Yi.flushSync=function(t){return zu(t)};Yi.hydrate=function(t,e,n){if(!b0(e))throw Error(Ze(200));return _0(null,t,e,!0,n)};Yi.hydrateRoot=function(t,e,n){if(!dI(t))throw Error(Ze(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=hV;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=dV(e,null,t,1,n??null,s,!1,i,o),t[el]=e.current,Ep(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new w0(e)};Yi.render=function(t,e,n){if(!b0(e))throw Error(Ze(200));return _0(null,t,e,!1,n)};Yi.unmountComponentAtNode=function(t){if(!b0(t))throw Error(Ze(40));return t._reactRootContainer?(zu(function(){_0(null,null,t,!1,function(){t._reactRootContainer=null,t[el]=null})}),!0):!1};Yi.unstable_batchedUpdates=sI;Yi.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!b0(n))throw Error(Ze(200));if(t==null||t._reactInternals===void 0)throw Error(Ze(38));return _0(t,e,n,!1,r)};Yi.version="18.3.1-next-f1338f8080-20240426";function fV(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fV)}catch(t){console.error(t)}}fV(),fO.exports=Yi;var ml=fO.exports;const hI=i0(ml),gJ=tO({__proto__:null,default:hI},[ml]);var Oj=ml;yC.createRoot=Oj.createRoot,yC.hydrateRoot=Oj.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rr(){return rr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rr.apply(this,arguments)}var Rr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Rr||(Rr={}));const $j="popstate";function yJ(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Dp("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Gu(s)}return vJ(e,n,null,t)}function an(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function zh(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function xJ(){return Math.random().toString(36).substr(2,8)}function Vj(t,e){return{usr:t.state,key:t.key,idx:e}}function Dp(t,e,n,r){return n===void 0&&(n=null),rr({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?pl(e):e,{state:n,key:e&&e.key||r||xJ()})}function Gu(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function pl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function vJ(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=Rr.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(rr({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){l=Rr.Pop;let v=d(),w=v==null?null:v-u;u=v,c&&c({action:l,location:x.location,delta:w})}function f(v,w){l=Rr.Push;let _=Dp(x.location,v,w);n&&n(_,v),u=d()+1;let C=Vj(_,u),T=x.createHref(_);try{o.pushState(C,"",T)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;s.location.assign(T)}i&&c&&c({action:l,location:x.location,delta:1})}function m(v,w){l=Rr.Replace;let _=Dp(x.location,v,w);n&&n(_,v),u=d();let C=Vj(_,u),T=x.createHref(_);o.replaceState(C,"",T),i&&c&&c({action:l,location:x.location,delta:0})}function g(v){let w=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof v=="string"?v:Gu(v);return _=_.replace(/ $/,"%20"),an(w,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,w)}let x={get action(){return l},get location(){return t(s,o)},listen(v){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener($j,h),c=v,()=>{s.removeEventListener($j,h),c=null}},createHref(v){return e(s,v)},createURL:g,encodeLocation(v){let w=g(v);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:f,replace:m,go(v){return o.go(v)}};return x}var Pn;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Pn||(Pn={}));const wJ=new Set(["lazy","caseSensitive","path","id","index","children"]);function bJ(t){return t.index===!0}function qv(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,i)=>{let o=[...n,String(i)],l=typeof s.id=="string"?s.id:o.join("-");if(an(s.index!==!0||!s.children,"Cannot specify children on an index route"),an(!r[l],'Found a route id collision on id "'+l+`".  Route id's must be globally unique within Data Router usages`),bJ(s)){let c=rr({},s,e(s),{id:l});return r[l]=c,c}else{let c=rr({},s,e(s),{id:l,children:void 0});return r[l]=c,s.children&&(c.children=qv(s.children,e,o,r)),c}})}function du(t,e,n){return n===void 0&&(n="/"),Bx(t,e,n,!1)}function Bx(t,e,n,r){let s=typeof e=="string"?pl(e):e,i=xf(s.pathname||"/",n);if(i==null)return null;let o=mV(t);SJ(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=DJ(i);l=jJ(o[c],u,r)}return l}function _J(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function mV(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(an(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=qa([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(an(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),mV(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:AJ(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of pV(i.path))s(i,o,c)}),e}function pV(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=pV(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function SJ(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:kJ(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const CJ=/^:[\w-]+$/,EJ=3,TJ=2,IJ=1,NJ=10,PJ=-2,Uj=t=>t==="*";function AJ(t,e){let n=t.split("/"),r=n.length;return n.some(Uj)&&(r+=PJ),e&&(r+=TJ),n.filter(s=>!Uj(s)).reduce((s,i)=>s+(CJ.test(i)?EJ:i===""?IJ:NJ),r)}function kJ(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function jJ(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=Bj({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h&&u&&n&&!r[r.length-1].route.index&&(h=Bj({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:qa([i,h.pathname]),pathnameBase:FJ(qa([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=qa([i,h.pathnameBase]))}return o}function Bj(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=RJ(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,h)=>{let{paramName:f,isOptional:m}=d;if(f==="*"){let x=l[h]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const g=l[h];return m&&!g?u[f]=void 0:u[f]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function RJ(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),zh(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function DJ(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zh(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function xf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function MJ(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?pl(t):t;return{pathname:n?n.startsWith("/")?n:LJ(n,e):e,search:OJ(r),hash:$J(s)}}function LJ(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function z_(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function gV(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function S0(t,e){let n=gV(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function C0(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=pl(t):(s=rr({},t),an(!s.pathname||!s.pathname.includes("?"),z_("?","pathname","search",s)),an(!s.pathname||!s.pathname.includes("#"),z_("#","pathname","hash",s)),an(!s.search||!s.search.includes("#"),z_("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let h=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}l=h>=0?e[h]:"/"}let c=MJ(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const qa=t=>t.join("/").replace(/\/\/+/g,"/"),FJ=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),OJ=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,$J=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Kv{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function Mp(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const yV=["post","put","patch","delete"],VJ=new Set(yV),UJ=["get",...yV],BJ=new Set(UJ),zJ=new Set([301,302,303,307,308]),GJ=new Set([307,308]),G_={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},WJ={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Hf={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},fI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,HJ=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),xV="remix-router-transitions";function qJ(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;an(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let J=t.detectErrorBoundary;s=re=>({hasErrorBoundary:J(re)})}else s=HJ;let i={},o=qv(t.routes,s,void 0,i),l,c=t.basename||"/",u=t.dataStrategy||QJ,d=t.patchRoutesOnNavigation,h=rr({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,m=new Set,g=null,x=null,v=null,w=t.hydrationData!=null,_=du(o,t.history.location,c),C=!1,T=null;if(_==null&&!d){let J=ci(404,{pathname:t.history.location.pathname}),{matches:re,route:ge}=Zj(o);_=re,T={[ge.id]:J}}_&&!t.hydrationData&&sn(_,o,t.history.location.pathname).active&&(_=null);let j;if(_)if(_.some(J=>J.route.lazy))j=!1;else if(!_.some(J=>J.route.loader))j=!0;else if(h.v7_partialHydration){let J=t.hydrationData?t.hydrationData.loaderData:null,re=t.hydrationData?t.hydrationData.errors:null;if(re){let ge=_.findIndex(Oe=>re[Oe.route.id]!==void 0);j=_.slice(0,ge+1).every(Oe=>!dE(Oe.route,J,re))}else j=_.every(ge=>!dE(ge.route,J,re))}else j=t.hydrationData!=null;else if(j=!1,_=[],h.v7_partialHydration){let J=sn(null,o,t.history.location.pathname);J.active&&J.matches&&(C=!0,_=J.matches)}let A,E={historyAction:t.history.action,location:t.history.location,matches:_,initialized:j,navigation:G_,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||T,fetchers:new Map,blockers:new Map},I=Rr.Pop,N=!1,k,R=!1,D=new Map,M=null,z=!1,B=!1,G=[],Y=new Set,H=new Map,K=0,$=-1,V=new Map,W=new Set,F=new Map,Z=new Map,ce=new Set,le=new Map,he=new Map,Le;function Ve(){if(f=t.history.listen(J=>{let{action:re,location:ge,delta:Oe}=J;if(Le){Le(),Le=void 0;return}zh(he.size===0||Oe!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let tt=wt({currentLocation:E.location,nextLocation:ge,historyAction:re});if(tt&&Oe!=null){let Q=new Promise(te=>{Le=te});t.history.go(Oe*-1),Tt(tt,{state:"blocked",location:ge,proceed(){Tt(tt,{state:"proceeding",proceed:void 0,reset:void 0,location:ge}),Q.then(()=>t.history.go(Oe))},reset(){let te=new Map(E.blockers);te.set(tt,Hf),Ce({blockers:te})}});return}return Me(re,ge)}),n){dQ(e,D);let J=()=>hQ(e,D);e.addEventListener("pagehide",J),M=()=>e.removeEventListener("pagehide",J)}return E.initialized||Me(Rr.Pop,E.location,{initialHydration:!0}),A}function Be(){f&&f(),M&&M(),m.clear(),k&&k.abort(),E.fetchers.forEach((J,re)=>Pe(re)),E.blockers.forEach((J,re)=>Te(re))}function ue(J){return m.add(J),()=>m.delete(J)}function Ce(J,re){re===void 0&&(re={}),E=rr({},E,J);let ge=[],Oe=[];h.v7_fetcherPersist&&E.fetchers.forEach((tt,Q)=>{tt.state==="idle"&&(ce.has(Q)?Oe.push(Q):ge.push(Q))}),ce.forEach(tt=>{!E.fetchers.has(tt)&&!H.has(tt)&&Oe.push(tt)}),[...m].forEach(tt=>tt(E,{deletedFetchers:Oe,viewTransitionOpts:re.viewTransitionOpts,flushSync:re.flushSync===!0})),h.v7_fetcherPersist?(ge.forEach(tt=>E.fetchers.delete(tt)),Oe.forEach(tt=>Pe(tt))):Oe.forEach(tt=>ce.delete(tt))}function Ie(J,re,ge){var Oe,tt;let{flushSync:Q}=ge===void 0?{}:ge,te=E.actionData!=null&&E.navigation.formMethod!=null&&Io(E.navigation.formMethod)&&E.navigation.state==="loading"&&((Oe=J.state)==null?void 0:Oe._isRedirect)!==!0,me;re.actionData?Object.keys(re.actionData).length>0?me=re.actionData:me=null:te?me=E.actionData:me=null;let q=re.loaderData?Qj(E.loaderData,re.loaderData,re.matches||[],re.errors):E.loaderData,ne=E.blockers;ne.size>0&&(ne=new Map(ne),ne.forEach((Ge,Se)=>ne.set(Se,Hf)));let be=N===!0||E.navigation.formMethod!=null&&Io(E.navigation.formMethod)&&((tt=J.state)==null?void 0:tt._isRedirect)!==!0;l&&(o=l,l=void 0),z||I===Rr.Pop||(I===Rr.Push?t.history.push(J,J.state):I===Rr.Replace&&t.history.replace(J,J.state));let Ne;if(I===Rr.Pop){let Ge=D.get(E.location.pathname);Ge&&Ge.has(J.pathname)?Ne={currentLocation:E.location,nextLocation:J}:D.has(J.pathname)&&(Ne={currentLocation:J,nextLocation:E.location})}else if(R){let Ge=D.get(E.location.pathname);Ge?Ge.add(J.pathname):(Ge=new Set([J.pathname]),D.set(E.location.pathname,Ge)),Ne={currentLocation:E.location,nextLocation:J}}Ce(rr({},re,{actionData:me,loaderData:q,historyAction:I,location:J,initialized:!0,navigation:G_,revalidation:"idle",restoreScrollPosition:cr(J,re.matches||E.matches),preventScrollReset:be,blockers:ne}),{viewTransitionOpts:Ne,flushSync:Q===!0}),I=Rr.Pop,N=!1,R=!1,z=!1,B=!1,G=[]}async function ve(J,re){if(typeof J=="number"){t.history.go(J);return}let ge=uE(E.location,E.matches,c,h.v7_prependBasename,J,h.v7_relativeSplatPath,re==null?void 0:re.fromRouteId,re==null?void 0:re.relative),{path:Oe,submission:tt,error:Q}=zj(h.v7_normalizeFormMethod,!1,ge,re),te=E.location,me=Dp(E.location,Oe,re&&re.state);me=rr({},me,t.history.encodeLocation(me));let q=re&&re.replace!=null?re.replace:void 0,ne=Rr.Push;q===!0?ne=Rr.Replace:q===!1||tt!=null&&Io(tt.formMethod)&&tt.formAction===E.location.pathname+E.location.search&&(ne=Rr.Replace);let be=re&&"preventScrollReset"in re?re.preventScrollReset===!0:void 0,Ne=(re&&re.flushSync)===!0,Ge=wt({currentLocation:te,nextLocation:me,historyAction:ne});if(Ge){Tt(Ge,{state:"blocked",location:me,proceed(){Tt(Ge,{state:"proceeding",proceed:void 0,reset:void 0,location:me}),ve(J,re)},reset(){let Se=new Map(E.blockers);Se.set(Ge,Hf),Ce({blockers:Se})}});return}return await Me(ne,me,{submission:tt,pendingError:Q,preventScrollReset:be,replace:re&&re.replace,enableViewTransition:re&&re.viewTransition,flushSync:Ne})}function ie(){if(De(),Ce({revalidation:"loading"}),E.navigation.state!=="submitting"){if(E.navigation.state==="idle"){Me(E.historyAction,E.location,{startUninterruptedRevalidation:!0});return}Me(I||E.historyAction,E.navigation.location,{overrideNavigation:E.navigation,enableViewTransition:R===!0})}}async function Me(J,re,ge){k&&k.abort(),k=null,I=J,z=(ge&&ge.startUninterruptedRevalidation)===!0,Sn(E.location,E.matches),N=(ge&&ge.preventScrollReset)===!0,R=(ge&&ge.enableViewTransition)===!0;let Oe=l||o,tt=ge&&ge.overrideNavigation,Q=ge!=null&&ge.initialHydration&&E.matches&&E.matches.length>0&&!C?E.matches:du(Oe,re,c),te=(ge&&ge.flushSync)===!0;if(Q&&E.initialized&&!B&&rQ(E.location,re)&&!(ge&&ge.submission&&Io(ge.submission.formMethod))){Ie(re,{matches:Q},{flushSync:te});return}let me=sn(Q,Oe,re.pathname);if(me.active&&me.matches&&(Q=me.matches),!Q){let{error:ot,notFoundMatches:st,route:Mt}=xt(re.pathname);Ie(re,{matches:st,loaderData:{},errors:{[Mt.id]:ot}},{flushSync:te});return}k=new AbortController;let q=Cd(t.history,re,k.signal,ge&&ge.submission),ne;if(ge&&ge.pendingError)ne=[hu(Q).route.id,{type:Pn.error,error:ge.pendingError}];else if(ge&&ge.submission&&Io(ge.submission.formMethod)){let ot=await He(q,re,ge.submission,Q,me.active,{replace:ge.replace,flushSync:te});if(ot.shortCircuited)return;if(ot.pendingActionResult){let[st,Mt]=ot.pendingActionResult;if(Ri(Mt)&&Mp(Mt.error)&&Mt.error.status===404){k=null,Ie(re,{matches:ot.matches,loaderData:{},errors:{[st]:Mt.error}});return}}Q=ot.matches||Q,ne=ot.pendingActionResult,tt=W_(re,ge.submission),te=!1,me.active=!1,q=Cd(t.history,q.url,q.signal)}let{shortCircuited:be,matches:Ne,loaderData:Ge,errors:Se}=await yt(q,re,Q,me.active,tt,ge&&ge.submission,ge&&ge.fetcherSubmission,ge&&ge.replace,ge&&ge.initialHydration===!0,te,ne);be||(k=null,Ie(re,rr({matches:Ne||Q},Xj(ne),{loaderData:Ge,errors:Se})))}async function He(J,re,ge,Oe,tt,Q){Q===void 0&&(Q={}),De();let te=cQ(re,ge);if(Ce({navigation:te},{flushSync:Q.flushSync===!0}),tt){let ne=await $t(Oe,re.pathname,J.signal);if(ne.type==="aborted")return{shortCircuited:!0};if(ne.type==="error"){let be=hu(ne.partialMatches).route.id;return{matches:ne.partialMatches,pendingActionResult:[be,{type:Pn.error,error:ne.error}]}}else if(ne.matches)Oe=ne.matches;else{let{notFoundMatches:be,error:Ne,route:Ge}=xt(re.pathname);return{matches:be,pendingActionResult:[Ge.id,{type:Pn.error,error:Ne}]}}}let me,q=xm(Oe,re);if(!q.route.action&&!q.route.lazy)me={type:Pn.error,error:ci(405,{method:J.method,pathname:re.pathname,routeId:q.route.id})};else if(me=(await Et("action",E,J,[q],Oe,null))[q.route.id],J.signal.aborted)return{shortCircuited:!0};if(_u(me)){let ne;return Q&&Q.replace!=null?ne=Q.replace:ne=Kj(me.response.headers.get("Location"),new URL(J.url),c)===E.location.pathname+E.location.search,await Ue(J,me,!0,{submission:ge,replace:ne}),{shortCircuited:!0}}if(Kl(me))throw ci(400,{type:"defer-action"});if(Ri(me)){let ne=hu(Oe,q.route.id);return(Q&&Q.replace)!==!0&&(I=Rr.Push),{matches:Oe,pendingActionResult:[ne.route.id,me]}}return{matches:Oe,pendingActionResult:[q.route.id,me]}}async function yt(J,re,ge,Oe,tt,Q,te,me,q,ne,be){let Ne=tt||W_(re,Q),Ge=Q||te||tR(Ne),Se=!z&&(!h.v7_partialHydration||!q);if(Oe){if(Se){let Cn=kt(be);Ce(rr({navigation:Ne},Cn!==void 0?{actionData:Cn}:{}),{flushSync:ne})}let nn=await $t(ge,re.pathname,J.signal);if(nn.type==="aborted")return{shortCircuited:!0};if(nn.type==="error"){let Cn=hu(nn.partialMatches).route.id;return{matches:nn.partialMatches,loaderData:{},errors:{[Cn]:nn.error}}}else if(nn.matches)ge=nn.matches;else{let{error:Cn,notFoundMatches:si,route:ii}=xt(re.pathname);return{matches:si,loaderData:{},errors:{[ii.id]:Cn}}}}let ot=l||o,[st,Mt]=Wj(t.history,E,ge,Ge,re,h.v7_partialHydration&&q===!0,h.v7_skipActionErrorRevalidation,B,G,Y,ce,F,W,ot,c,be);if(pt(nn=>!(ge&&ge.some(Cn=>Cn.route.id===nn))||st&&st.some(Cn=>Cn.route.id===nn)),$=++K,st.length===0&&Mt.length===0){let nn=oe();return Ie(re,rr({matches:ge,loaderData:{},errors:be&&Ri(be[1])?{[be[0]]:be[1].error}:null},Xj(be),nn?{fetchers:new Map(E.fetchers)}:{}),{flushSync:ne}),{shortCircuited:!0}}if(Se){let nn={};if(!Oe){nn.navigation=Ne;let Cn=kt(be);Cn!==void 0&&(nn.actionData=Cn)}Mt.length>0&&(nn.fetchers=en(Mt)),Ce(nn,{flushSync:ne})}Mt.forEach(nn=>{$e(nn.key),nn.controller&&H.set(nn.key,nn.controller)});let xn=()=>Mt.forEach(nn=>$e(nn.key));k&&k.signal.addEventListener("abort",xn);let{loaderResults:Zr,fetcherResults:Dn}=await de(E,ge,st,Mt,J);if(J.signal.aborted)return{shortCircuited:!0};k&&k.signal.removeEventListener("abort",xn),Mt.forEach(nn=>H.delete(nn.key));let Gr=My(Zr);if(Gr)return await Ue(J,Gr.result,!0,{replace:me}),{shortCircuited:!0};if(Gr=My(Dn),Gr)return W.add(Gr.key),await Ue(J,Gr.result,!0,{replace:me}),{shortCircuited:!0};let{loaderData:bs,errors:Ci}=Jj(E,ge,Zr,be,Mt,Dn,le);le.forEach((nn,Cn)=>{nn.subscribe(si=>{(si||nn.done)&&le.delete(Cn)})}),h.v7_partialHydration&&q&&E.errors&&(Ci=rr({},E.errors,Ci));let Vs=oe(),Us=_e($),es=Vs||Us||Mt.length>0;return rr({matches:ge,loaderData:bs,errors:Ci},es?{fetchers:new Map(E.fetchers)}:{})}function kt(J){if(J&&!Ri(J[1]))return{[J[0]]:J[1].data};if(E.actionData)return Object.keys(E.actionData).length===0?null:E.actionData}function en(J){return J.forEach(re=>{let ge=E.fetchers.get(re.key),Oe=qf(void 0,ge?ge.data:void 0);E.fetchers.set(re.key,Oe)}),new Map(E.fetchers)}function mn(J,re,ge,Oe){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");$e(J);let tt=(Oe&&Oe.flushSync)===!0,Q=l||o,te=uE(E.location,E.matches,c,h.v7_prependBasename,ge,h.v7_relativeSplatPath,re,Oe==null?void 0:Oe.relative),me=du(Q,te,c),q=sn(me,Q,te);if(q.active&&q.matches&&(me=q.matches),!me){ae(J,re,ci(404,{pathname:te}),{flushSync:tt});return}let{path:ne,submission:be,error:Ne}=zj(h.v7_normalizeFormMethod,!0,te,Oe);if(Ne){ae(J,re,Ne,{flushSync:tt});return}let Ge=xm(me,ne),Se=(Oe&&Oe.preventScrollReset)===!0;if(be&&Io(be.formMethod)){cn(J,re,ne,Ge,me,q.active,tt,Se,be);return}F.set(J,{routeId:re,path:ne}),fn(J,re,ne,Ge,me,q.active,tt,Se,be)}async function cn(J,re,ge,Oe,tt,Q,te,me,q){De(),F.delete(J);function ne(Mn){if(!Mn.route.action&&!Mn.route.lazy){let Bs=ci(405,{method:q.formMethod,pathname:ge,routeId:re});return ae(J,re,Bs,{flushSync:te}),!0}return!1}if(!Q&&ne(Oe))return;let be=E.fetchers.get(J);ee(J,uQ(q,be),{flushSync:te});let Ne=new AbortController,Ge=Cd(t.history,ge,Ne.signal,q);if(Q){let Mn=await $t(tt,new URL(Ge.url).pathname,Ge.signal,J);if(Mn.type==="aborted")return;if(Mn.type==="error"){ae(J,re,Mn.error,{flushSync:te});return}else if(Mn.matches){if(tt=Mn.matches,Oe=xm(tt,ge),ne(Oe))return}else{ae(J,re,ci(404,{pathname:ge}),{flushSync:te});return}}H.set(J,Ne);let Se=K,st=(await Et("action",E,Ge,[Oe],tt,J))[Oe.route.id];if(Ge.signal.aborted){H.get(J)===Ne&&H.delete(J);return}if(h.v7_fetcherPersist&&ce.has(J)){if(_u(st)||Ri(st)){ee(J,kl(void 0));return}}else{if(_u(st))if(H.delete(J),$>Se){ee(J,kl(void 0));return}else return W.add(J),ee(J,qf(q)),Ue(Ge,st,!1,{fetcherSubmission:q,preventScrollReset:me});if(Ri(st)){ae(J,re,st.error);return}}if(Kl(st))throw ci(400,{type:"defer-action"});let Mt=E.navigation.location||E.location,xn=Cd(t.history,Mt,Ne.signal),Zr=l||o,Dn=E.navigation.state!=="idle"?du(Zr,E.navigation.location,c):E.matches;an(Dn,"Didn't find any matches after fetcher action");let Gr=++K;V.set(J,Gr);let bs=qf(q,st.data);E.fetchers.set(J,bs);let[Ci,Vs]=Wj(t.history,E,Dn,q,Mt,!1,h.v7_skipActionErrorRevalidation,B,G,Y,ce,F,W,Zr,c,[Oe.route.id,st]);Vs.filter(Mn=>Mn.key!==J).forEach(Mn=>{let Bs=Mn.key,vo=E.fetchers.get(Bs),Wo=qf(void 0,vo?vo.data:void 0);E.fetchers.set(Bs,Wo),$e(Bs),Mn.controller&&H.set(Bs,Mn.controller)}),Ce({fetchers:new Map(E.fetchers)});let Us=()=>Vs.forEach(Mn=>$e(Mn.key));Ne.signal.addEventListener("abort",Us);let{loaderResults:es,fetcherResults:nn}=await de(E,Dn,Ci,Vs,xn);if(Ne.signal.aborted)return;Ne.signal.removeEventListener("abort",Us),V.delete(J),H.delete(J),Vs.forEach(Mn=>H.delete(Mn.key));let Cn=My(es);if(Cn)return Ue(xn,Cn.result,!1,{preventScrollReset:me});if(Cn=My(nn),Cn)return W.add(Cn.key),Ue(xn,Cn.result,!1,{preventScrollReset:me});let{loaderData:si,errors:ii}=Jj(E,Dn,es,void 0,Vs,nn,le);if(E.fetchers.has(J)){let Mn=kl(st.data);E.fetchers.set(J,Mn)}_e(Gr),E.navigation.state==="loading"&&Gr>$?(an(I,"Expected pending action"),k&&k.abort(),Ie(E.navigation.location,{matches:Dn,loaderData:si,errors:ii,fetchers:new Map(E.fetchers)})):(Ce({errors:ii,loaderData:Qj(E.loaderData,si,Dn,ii),fetchers:new Map(E.fetchers)}),B=!1)}async function fn(J,re,ge,Oe,tt,Q,te,me,q){let ne=E.fetchers.get(J);ee(J,qf(q,ne?ne.data:void 0),{flushSync:te});let be=new AbortController,Ne=Cd(t.history,ge,be.signal);if(Q){let st=await $t(tt,new URL(Ne.url).pathname,Ne.signal,J);if(st.type==="aborted")return;if(st.type==="error"){ae(J,re,st.error,{flushSync:te});return}else if(st.matches)tt=st.matches,Oe=xm(tt,ge);else{ae(J,re,ci(404,{pathname:ge}),{flushSync:te});return}}H.set(J,be);let Ge=K,ot=(await Et("loader",E,Ne,[Oe],tt,J))[Oe.route.id];if(Kl(ot)&&(ot=await mI(ot,Ne.signal,!0)||ot),H.get(J)===be&&H.delete(J),!Ne.signal.aborted){if(ce.has(J)){ee(J,kl(void 0));return}if(_u(ot))if($>Ge){ee(J,kl(void 0));return}else{W.add(J),await Ue(Ne,ot,!1,{preventScrollReset:me});return}if(Ri(ot)){ae(J,re,ot.error);return}an(!Kl(ot),"Unhandled fetcher deferred data"),ee(J,kl(ot.data))}}async function Ue(J,re,ge,Oe){let{submission:tt,fetcherSubmission:Q,preventScrollReset:te,replace:me}=Oe===void 0?{}:Oe;re.response.headers.has("X-Remix-Revalidate")&&(B=!0);let q=re.response.headers.get("Location");an(q,"Expected a Location header on the redirect Response"),q=Kj(q,new URL(J.url),c);let ne=Dp(E.location,q,{_isRedirect:!0});if(n){let st=!1;if(re.response.headers.has("X-Remix-Reload-Document"))st=!0;else if(fI.test(q)){const Mt=t.history.createURL(q);st=Mt.origin!==e.location.origin||xf(Mt.pathname,c)==null}if(st){me?e.location.replace(q):e.location.assign(q);return}}k=null;let be=me===!0||re.response.headers.has("X-Remix-Replace")?Rr.Replace:Rr.Push,{formMethod:Ne,formAction:Ge,formEncType:Se}=E.navigation;!tt&&!Q&&Ne&&Ge&&Se&&(tt=tR(E.navigation));let ot=tt||Q;if(GJ.has(re.response.status)&&ot&&Io(ot.formMethod))await Me(be,ne,{submission:rr({},ot,{formAction:q}),preventScrollReset:te||N,enableViewTransition:ge?R:void 0});else{let st=W_(ne,tt);await Me(be,ne,{overrideNavigation:st,fetcherSubmission:Q,preventScrollReset:te||N,enableViewTransition:ge?R:void 0})}}async function Et(J,re,ge,Oe,tt,Q){let te,me={};try{te=await XJ(u,J,re,ge,Oe,tt,Q,i,s)}catch(q){return Oe.forEach(ne=>{me[ne.route.id]={type:Pn.error,error:q}}),me}for(let[q,ne]of Object.entries(te))if(sQ(ne)){let be=ne.result;me[q]={type:Pn.redirect,response:tQ(be,ge,q,tt,c,h.v7_relativeSplatPath)}}else me[q]=await eQ(ne);return me}async function de(J,re,ge,Oe,tt){let Q=J.matches,te=Et("loader",J,tt,ge,re,null),me=Promise.all(Oe.map(async be=>{if(be.matches&&be.match&&be.controller){let Ge=(await Et("loader",J,Cd(t.history,be.path,be.controller.signal),[be.match],be.matches,be.key))[be.match.route.id];return{[be.key]:Ge}}else return Promise.resolve({[be.key]:{type:Pn.error,error:ci(404,{pathname:be.path})}})})),q=await te,ne=(await me).reduce((be,Ne)=>Object.assign(be,Ne),{});return await Promise.all([aQ(re,q,tt.signal,Q,J.loaderData),lQ(re,ne,Oe)]),{loaderResults:q,fetcherResults:ne}}function De(){B=!0,G.push(...pt()),F.forEach((J,re)=>{H.has(re)&&Y.add(re),$e(re)})}function ee(J,re,ge){ge===void 0&&(ge={}),E.fetchers.set(J,re),Ce({fetchers:new Map(E.fetchers)},{flushSync:(ge&&ge.flushSync)===!0})}function ae(J,re,ge,Oe){Oe===void 0&&(Oe={});let tt=hu(E.matches,re);Pe(J),Ce({errors:{[tt.route.id]:ge},fetchers:new Map(E.fetchers)},{flushSync:(Oe&&Oe.flushSync)===!0})}function X(J){return Z.set(J,(Z.get(J)||0)+1),ce.has(J)&&ce.delete(J),E.fetchers.get(J)||WJ}function Pe(J){let re=E.fetchers.get(J);H.has(J)&&!(re&&re.state==="loading"&&V.has(J))&&$e(J),F.delete(J),V.delete(J),W.delete(J),h.v7_fetcherPersist&&ce.delete(J),Y.delete(J),E.fetchers.delete(J)}function Ae(J){let re=(Z.get(J)||0)-1;re<=0?(Z.delete(J),ce.add(J),h.v7_fetcherPersist||Pe(J)):Z.set(J,re),Ce({fetchers:new Map(E.fetchers)})}function $e(J){let re=H.get(J);re&&(re.abort(),H.delete(J))}function qe(J){for(let re of J){let ge=X(re),Oe=kl(ge.data);E.fetchers.set(re,Oe)}}function oe(){let J=[],re=!1;for(let ge of W){let Oe=E.fetchers.get(ge);an(Oe,"Expected fetcher: "+ge),Oe.state==="loading"&&(W.delete(ge),J.push(ge),re=!0)}return qe(J),re}function _e(J){let re=[];for(let[ge,Oe]of V)if(Oe<J){let tt=E.fetchers.get(ge);an(tt,"Expected fetcher: "+ge),tt.state==="loading"&&($e(ge),V.delete(ge),re.push(ge))}return qe(re),re.length>0}function ze(J,re){let ge=E.blockers.get(J)||Hf;return he.get(J)!==re&&he.set(J,re),ge}function Te(J){E.blockers.delete(J),he.delete(J)}function Tt(J,re){let ge=E.blockers.get(J)||Hf;an(ge.state==="unblocked"&&re.state==="blocked"||ge.state==="blocked"&&re.state==="blocked"||ge.state==="blocked"&&re.state==="proceeding"||ge.state==="blocked"&&re.state==="unblocked"||ge.state==="proceeding"&&re.state==="unblocked","Invalid blocker state transition: "+ge.state+" -> "+re.state);let Oe=new Map(E.blockers);Oe.set(J,re),Ce({blockers:Oe})}function wt(J){let{currentLocation:re,nextLocation:ge,historyAction:Oe}=J;if(he.size===0)return;he.size>1&&zh(!1,"A router only supports one blocker at a time");let tt=Array.from(he.entries()),[Q,te]=tt[tt.length-1],me=E.blockers.get(Q);if(!(me&&me.state==="proceeding")&&te({currentLocation:re,nextLocation:ge,historyAction:Oe}))return Q}function xt(J){let re=ci(404,{pathname:J}),ge=l||o,{matches:Oe,route:tt}=Zj(ge);return pt(),{notFoundMatches:Oe,route:tt,error:re}}function pt(J){let re=[];return le.forEach((ge,Oe)=>{(!J||J(Oe))&&(ge.cancel(),re.push(Oe),le.delete(Oe))}),re}function Pt(J,re,ge){if(g=J,v=re,x=ge||null,!w&&E.navigation===G_){w=!0;let Oe=cr(E.location,E.matches);Oe!=null&&Ce({restoreScrollPosition:Oe})}return()=>{g=null,v=null,x=null}}function Rn(J,re){return x&&x(J,re.map(Oe=>_J(Oe,E.loaderData)))||J.key}function Sn(J,re){if(g&&v){let ge=Rn(J,re);g[ge]=v()}}function cr(J,re){if(g){let ge=Rn(J,re),Oe=g[ge];if(typeof Oe=="number")return Oe}return null}function sn(J,re,ge){if(d)if(J){if(Object.keys(J[0].params).length>0)return{active:!0,matches:Bx(re,ge,c,!0)}}else return{active:!0,matches:Bx(re,ge,c,!0)||[]};return{active:!1,matches:null}}async function $t(J,re,ge,Oe){if(!d)return{type:"success",matches:J};let tt=J;for(;;){let Q=l==null,te=l||o,me=i;try{await d({signal:ge,path:re,matches:tt,fetcherKey:Oe,patch:(be,Ne)=>{ge.aborted||qj(be,Ne,te,me,s)}})}catch(be){return{type:"error",error:be,partialMatches:tt}}finally{Q&&!ge.aborted&&(o=[...o])}if(ge.aborted)return{type:"aborted"};let q=du(te,re,c);if(q)return{type:"success",matches:q};let ne=Bx(te,re,c,!0);if(!ne||tt.length===ne.length&&tt.every((be,Ne)=>be.route.id===ne[Ne].route.id))return{type:"success",matches:null};tt=ne}}function tn(J){i={},l=qv(J,s,void 0,i)}function Zn(J,re){let ge=l==null;qj(J,re,l||o,i,s),ge&&(o=[...o],Ce({}))}return A={get basename(){return c},get future(){return h},get state(){return E},get routes(){return o},get window(){return e},initialize:Ve,subscribe:ue,enableScrollRestoration:Pt,navigate:ve,fetch:mn,revalidate:ie,createHref:J=>t.history.createHref(J),encodeLocation:J=>t.history.encodeLocation(J),getFetcher:X,deleteFetcher:Ae,dispose:Be,getBlocker:ze,deleteBlocker:Te,patchRoutes:Zn,_internalFetchControllers:H,_internalActiveDeferreds:le,_internalSetRoutes:tn},A}function KJ(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function uE(t,e,n,r,s,i,o,l){let c,u;if(o){c=[];for(let h of e)if(c.push(h),h.route.id===o){u=h;break}}else c=e,u=e[e.length-1];let d=C0(s||".",S0(c,i),xf(t.pathname,n)||t.pathname,l==="path");if(s==null&&(d.search=t.search,d.hash=t.hash),(s==null||s===""||s===".")&&u){let h=pI(d.search);if(u.route.index&&!h)d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index";else if(!u.route.index&&h){let f=new URLSearchParams(d.search),m=f.getAll("index");f.delete("index"),m.filter(x=>x).forEach(x=>f.append("index",x));let g=f.toString();d.search=g?"?"+g:""}}return r&&n!=="/"&&(d.pathname=d.pathname==="/"?n:qa([n,d.pathname])),Gu(d)}function zj(t,e,n,r){if(!r||!KJ(r))return{path:n};if(r.formMethod&&!oQ(r.formMethod))return{path:n,error:ci(405,{method:r.formMethod})};let s=()=>({path:n,error:ci(400,{type:"invalid-body"})}),i=r.formMethod||"get",o=t?i.toUpperCase():i.toLowerCase(),l=bV(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Io(o))return s();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((m,g)=>{let[x,v]=g;return""+m+x+"="+v+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!Io(o))return s();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return s()}}}an(typeof FormData=="function","FormData is not available in this environment");let c,u;if(r.formData)c=hE(r.formData),u=r.formData;else if(r.body instanceof FormData)c=hE(r.body),u=r.body;else if(r.body instanceof URLSearchParams)c=r.body,u=Yj(c);else if(r.body==null)c=new URLSearchParams,u=new FormData;else try{c=new URLSearchParams(r.body),u=Yj(c)}catch{return s()}let d={formMethod:o,formAction:l,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(Io(d.formMethod))return{path:n,submission:d};let h=pl(n);return e&&h.search&&pI(h.search)&&c.append("index",""),h.search="?"+c,{path:Gu(h),submission:d}}function Gj(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(s=>s.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function Wj(t,e,n,r,s,i,o,l,c,u,d,h,f,m,g,x){let v=x?Ri(x[1])?x[1].error:x[1].data:void 0,w=t.createURL(e.location),_=t.createURL(s),C=n;i&&e.errors?C=Gj(n,Object.keys(e.errors)[0],!0):x&&Ri(x[1])&&(C=Gj(n,x[0]));let T=x?x[1].statusCode:void 0,j=o&&T&&T>=400,A=C.filter((I,N)=>{let{route:k}=I;if(k.lazy)return!0;if(k.loader==null)return!1;if(i)return dE(k,e.loaderData,e.errors);if(YJ(e.loaderData,e.matches[N],I)||c.some(M=>M===I.route.id))return!0;let R=e.matches[N],D=I;return Hj(I,rr({currentUrl:w,currentParams:R.params,nextUrl:_,nextParams:D.params},r,{actionResult:v,actionStatus:T,defaultShouldRevalidate:j?!1:l||w.pathname+w.search===_.pathname+_.search||w.search!==_.search||vV(R,D)}))}),E=[];return h.forEach((I,N)=>{if(i||!n.some(z=>z.route.id===I.routeId)||d.has(N))return;let k=du(m,I.path,g);if(!k){E.push({key:N,routeId:I.routeId,path:I.path,matches:null,match:null,controller:null});return}let R=e.fetchers.get(N),D=xm(k,I.path),M=!1;f.has(N)?M=!1:u.has(N)?(u.delete(N),M=!0):R&&R.state!=="idle"&&R.data===void 0?M=l:M=Hj(D,rr({currentUrl:w,currentParams:e.matches[e.matches.length-1].params,nextUrl:_,nextParams:n[n.length-1].params},r,{actionResult:v,actionStatus:T,defaultShouldRevalidate:j?!1:l})),M&&E.push({key:N,routeId:I.routeId,path:I.path,matches:k,match:D,controller:new AbortController})}),[A,E]}function dE(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,s=n!=null&&n[t.id]!==void 0;return!r&&s?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!s}function YJ(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function vV(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function Hj(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function qj(t,e,n,r,s){var i;let o;if(t){let u=r[t];an(u,"No route found to patch children into: routeId = "+t),u.children||(u.children=[]),o=u.children}else o=n;let l=e.filter(u=>!o.some(d=>wV(u,d))),c=qv(l,s,[t||"_","patch",String(((i=o)==null?void 0:i.length)||"0")],r);o.push(...c)}function wV(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var s;return(s=e.children)==null?void 0:s.some(i=>wV(n,i))}):!1}async function JJ(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];an(s,"No route found in manifest");let i={};for(let o in r){let c=s[o]!==void 0&&o!=="hasErrorBoundary";zh(!c,'Route "'+s.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!c&&!wJ.has(o)&&(i[o]=r[o])}Object.assign(s,i),Object.assign(s,rr({},e(s),{lazy:void 0}))}async function QJ(t){let{matches:e}=t,n=e.filter(s=>s.shouldLoad);return(await Promise.all(n.map(s=>s.resolve()))).reduce((s,i,o)=>Object.assign(s,{[n[o].route.id]:i}),{})}async function XJ(t,e,n,r,s,i,o,l,c,u){let d=i.map(m=>m.route.lazy?JJ(m.route,c,l):void 0),h=i.map((m,g)=>{let x=d[g],v=s.some(_=>_.route.id===m.route.id);return rr({},m,{shouldLoad:v,resolve:async _=>(_&&r.method==="GET"&&(m.route.lazy||m.route.loader)&&(v=!0),v?ZJ(e,r,m,x,_,u):Promise.resolve({type:Pn.data,result:void 0}))})}),f=await t({matches:h,request:r,params:i[0].params,fetcherKey:o,context:u});try{await Promise.all(d)}catch{}return f}async function ZJ(t,e,n,r,s,i){let o,l,c=u=>{let d,h=new Promise((g,x)=>d=x);l=()=>d(),e.signal.addEventListener("abort",l);let f=g=>typeof u!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):u({request:e,params:n.params,context:i},...g!==void 0?[g]:[]),m=(async()=>{try{return{type:"data",result:await(s?s(x=>f(x)):f())}}catch(g){return{type:"error",result:g}}})();return Promise.race([m,h])};try{let u=n.route[t];if(r)if(u){let d,[h]=await Promise.all([c(u).catch(f=>{d=f}),r]);if(d!==void 0)throw d;o=h}else if(await r,u=n.route[t],u)o=await c(u);else if(t==="action"){let d=new URL(e.url),h=d.pathname+d.search;throw ci(405,{method:e.method,pathname:h,routeId:n.route.id})}else return{type:Pn.data,result:void 0};else if(u)o=await c(u);else{let d=new URL(e.url),h=d.pathname+d.search;throw ci(404,{pathname:h})}an(o.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(u){return{type:Pn.error,result:u}}finally{l&&e.signal.removeEventListener("abort",l)}return o}async function eQ(t){let{result:e,type:n}=t;if(_V(e)){let h;try{let f=e.headers.get("Content-Type");f&&/\bapplication\/json\b/.test(f)?e.body==null?h=null:h=await e.json():h=await e.text()}catch(f){return{type:Pn.error,error:f}}return n===Pn.error?{type:Pn.error,error:new Kv(e.status,e.statusText,h),statusCode:e.status,headers:e.headers}:{type:Pn.data,data:h,statusCode:e.status,headers:e.headers}}if(n===Pn.error){if(eR(e)){var r,s;if(e.data instanceof Error){var i,o;return{type:Pn.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}}return{type:Pn.error,error:new Kv(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:Mp(e)?e.status:void 0,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:Pn.error,error:e,statusCode:Mp(e)?e.status:void 0}}if(iQ(e)){var l,c;return{type:Pn.deferred,deferredData:e,statusCode:(l=e.init)==null?void 0:l.status,headers:((c=e.init)==null?void 0:c.headers)&&new Headers(e.init.headers)}}if(eR(e)){var u,d;return{type:Pn.data,data:e.data,statusCode:(u=e.init)==null?void 0:u.status,headers:(d=e.init)!=null&&d.headers?new Headers(e.init.headers):void 0}}return{type:Pn.data,data:e}}function tQ(t,e,n,r,s,i){let o=t.headers.get("Location");if(an(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!fI.test(o)){let l=r.slice(0,r.findIndex(c=>c.route.id===n)+1);o=uE(new URL(e.url),l,s,!0,o,i),t.headers.set("Location",o)}return t}function Kj(t,e,n){if(fI.test(t)){let r=t,s=r.startsWith("//")?new URL(e.protocol+r):new URL(r),i=xf(s.pathname,n)!=null;if(s.origin===e.origin&&i)return s.pathname+s.search+s.hash}return t}function Cd(t,e,n,r){let s=t.createURL(bV(e)).toString(),i={signal:n};if(r&&Io(r.formMethod)){let{formMethod:o,formEncType:l}=r;i.method=o.toUpperCase(),l==="application/json"?(i.headers=new Headers({"Content-Type":l}),i.body=JSON.stringify(r.json)):l==="text/plain"?i.body=r.text:l==="application/x-www-form-urlencoded"&&r.formData?i.body=hE(r.formData):i.body=r.formData}return new Request(s,i)}function hE(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function Yj(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function nQ(t,e,n,r,s){let i={},o=null,l,c=!1,u={},d=n&&Ri(n[1])?n[1].error:void 0;return t.forEach(h=>{if(!(h.route.id in e))return;let f=h.route.id,m=e[f];if(an(!_u(m),"Cannot handle redirect results in processLoaderData"),Ri(m)){let g=m.error;if(d!==void 0&&(g=d,d=void 0),o=o||{},s)o[f]=g;else{let x=hu(t,f);o[x.route.id]==null&&(o[x.route.id]=g)}i[f]=void 0,c||(c=!0,l=Mp(m.error)?m.error.status:500),m.headers&&(u[f]=m.headers)}else Kl(m)?(r.set(f,m.deferredData),i[f]=m.deferredData.data,m.statusCode!=null&&m.statusCode!==200&&!c&&(l=m.statusCode),m.headers&&(u[f]=m.headers)):(i[f]=m.data,m.statusCode&&m.statusCode!==200&&!c&&(l=m.statusCode),m.headers&&(u[f]=m.headers))}),d!==void 0&&n&&(o={[n[0]]:d},i[n[0]]=void 0),{loaderData:i,errors:o,statusCode:l||200,loaderHeaders:u}}function Jj(t,e,n,r,s,i,o){let{loaderData:l,errors:c}=nQ(e,n,r,o,!1);return s.forEach(u=>{let{key:d,match:h,controller:f}=u,m=i[d];if(an(m,"Did not find corresponding fetcher result"),!(f&&f.signal.aborted))if(Ri(m)){let g=hu(t.matches,h==null?void 0:h.route.id);c&&c[g.route.id]||(c=rr({},c,{[g.route.id]:m.error})),t.fetchers.delete(d)}else if(_u(m))an(!1,"Unhandled fetcher revalidation redirect");else if(Kl(m))an(!1,"Unhandled fetcher deferred data");else{let g=kl(m.data);t.fetchers.set(d,g)}}),{loaderData:l,errors:c}}function Qj(t,e,n,r){let s=rr({},e);for(let i of n){let o=i.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(s[o]=e[o]):t[o]!==void 0&&i.route.loader&&(s[o]=t[o]),r&&r.hasOwnProperty(o))break}return s}function Xj(t){return t?Ri(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function hu(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function Zj(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function ci(t,e){let{pathname:n,routeId:r,method:s,type:i,message:o}=e===void 0?{}:e,l="Unknown Server Error",c="Unknown @remix-run/router error";return t===400?(l="Bad Request",s&&n&&r?c="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?c="defer() is not supported in actions":i==="invalid-body"&&(c="Unable to encode submission body")):t===403?(l="Forbidden",c='Route "'+r+'" does not match URL "'+n+'"'):t===404?(l="Not Found",c='No route matches URL "'+n+'"'):t===405&&(l="Method Not Allowed",s&&n&&r?c="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(c='Invalid request method "'+s.toUpperCase()+'"')),new Kv(t||500,l,new Error(c),!0)}function My(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,s]=e[n];if(_u(s))return{key:r,result:s}}}function bV(t){let e=typeof t=="string"?pl(t):t;return Gu(rr({},e,{hash:""}))}function rQ(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function sQ(t){return _V(t.result)&&zJ.has(t.result.status)}function Kl(t){return t.type===Pn.deferred}function Ri(t){return t.type===Pn.error}function _u(t){return(t&&t.type)===Pn.redirect}function eR(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function iQ(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function _V(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function oQ(t){return BJ.has(t.toLowerCase())}function Io(t){return VJ.has(t.toLowerCase())}async function aQ(t,e,n,r,s){let i=Object.entries(e);for(let o=0;o<i.length;o++){let[l,c]=i[o],u=t.find(f=>(f==null?void 0:f.route.id)===l);if(!u)continue;let d=r.find(f=>f.route.id===u.route.id),h=d!=null&&!vV(d,u)&&(s&&s[u.route.id])!==void 0;Kl(c)&&h&&await mI(c,n,!1).then(f=>{f&&(e[l]=f)})}}async function lQ(t,e,n){for(let r=0;r<n.length;r++){let{key:s,routeId:i,controller:o}=n[r],l=e[s];t.find(u=>(u==null?void 0:u.route.id)===i)&&Kl(l)&&(an(o,"Expected an AbortController for revalidating fetcher deferred result"),await mI(l,o.signal,!0).then(u=>{u&&(e[s]=u)}))}}async function mI(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Pn.data,data:t.deferredData.unwrappedData}}catch(s){return{type:Pn.error,error:s}}return{type:Pn.data,data:t.deferredData.data}}}function pI(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function xm(t,e){let n=typeof e=="string"?pl(e).search:e.search;if(t[t.length-1].route.index&&pI(n||""))return t[t.length-1];let r=gV(t);return r[r.length-1]}function tR(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:i,json:o}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function W_(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function cQ(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function qf(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function uQ(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function kl(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function dQ(t,e){try{let n=t.sessionStorage.getItem(xV);if(n){let r=JSON.parse(n);for(let[s,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function hQ(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(xV,JSON.stringify(n))}catch(r){zh(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Lp(){return Lp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Lp.apply(this,arguments)}const E0=p.createContext(null),SV=p.createContext(null),Dc=p.createContext(null),T0=p.createContext(null),Sa=p.createContext({outlet:null,matches:[],isDataRoute:!1}),CV=p.createContext(null);function fQ(t,e){let{relative:n}=e===void 0?{}:e;vf()||an(!1);let{basename:r,navigator:s}=p.useContext(Dc),{hash:i,pathname:o,search:l}=TV(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:qa([r,o])),s.createHref({pathname:c,search:l,hash:i})}function vf(){return p.useContext(T0)!=null}function Ca(){return vf()||an(!1),p.useContext(T0).location}function EV(t){p.useContext(Dc).static||p.useLayoutEffect(t)}function ti(){let{isDataRoute:t}=p.useContext(Sa);return t?IQ():mQ()}function mQ(){vf()||an(!1);let t=p.useContext(E0),{basename:e,future:n,navigator:r}=p.useContext(Dc),{matches:s}=p.useContext(Sa),{pathname:i}=Ca(),o=JSON.stringify(S0(s,n.v7_relativeSplatPath)),l=p.useRef(!1);return EV(()=>{l.current=!0}),p.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let h=C0(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:qa([e,h.pathname])),(d.replace?r.replace:r.push)(h,d.state,d)},[e,r,o,i,t])}const pQ=p.createContext(null);function gQ(t){let e=p.useContext(Sa).outlet;return e&&p.createElement(pQ.Provider,{value:t},e)}function I0(){let{matches:t}=p.useContext(Sa),e=t[t.length-1];return e?e.params:{}}function TV(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=p.useContext(Dc),{matches:s}=p.useContext(Sa),{pathname:i}=Ca(),o=JSON.stringify(S0(s,r.v7_relativeSplatPath));return p.useMemo(()=>C0(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function yQ(t,e,n,r){vf()||an(!1);let{navigator:s}=p.useContext(Dc),{matches:i}=p.useContext(Sa),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=Ca(),d;if(e){var h;let v=typeof e=="string"?pl(e):e;c==="/"||(h=v.pathname)!=null&&h.startsWith(c)||an(!1),d=v}else d=u;let f=d.pathname||"/",m=f;if(c!=="/"){let v=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let g=du(t,{pathname:m}),x=_Q(g&&g.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:qa([c,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:qa([c,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,n,r);return e&&x?p.createElement(T0.Provider,{value:{location:Lp({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Rr.Pop}},x):x}function xQ(){let t=TQ(),e=Mp(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},e),n?p.createElement("pre",{style:s},n):null,i)}const vQ=p.createElement(xQ,null);class wQ extends p.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?p.createElement(Sa.Provider,{value:this.props.routeContext},p.createElement(CV.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function bQ(t){let{routeContext:e,match:n,children:r}=t,s=p.useContext(E0);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),p.createElement(Sa.Provider,{value:e},r)}function _Q(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let d=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||an(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:m}=n,g=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||g){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,f)=>{let m,g=!1,x=null,v=null;n&&(m=l&&h.route.id?l[h.route.id]:void 0,x=h.route.errorElement||vQ,c&&(u<0&&f===0?(NQ("route-fallback",!1),g=!0,v=null):u===f&&(g=!0,v=h.route.hydrateFallbackElement||null)));let w=e.concat(o.slice(0,f+1)),_=()=>{let C;return m?C=x:g?C=v:h.route.Component?C=p.createElement(h.route.Component,null):h.route.element?C=h.route.element:C=d,p.createElement(bQ,{match:h,routeContext:{outlet:d,matches:w,isDataRoute:n!=null},children:C})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?p.createElement(wQ,{location:n.location,revalidation:n.revalidation,component:x,error:m,children:_(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):_()},null)}var IV=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(IV||{}),Yv=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Yv||{});function SQ(t){let e=p.useContext(E0);return e||an(!1),e}function CQ(t){let e=p.useContext(SV);return e||an(!1),e}function EQ(t){let e=p.useContext(Sa);return e||an(!1),e}function NV(t){let e=EQ(),n=e.matches[e.matches.length-1];return n.route.id||an(!1),n.route.id}function TQ(){var t;let e=p.useContext(CV),n=CQ(Yv.UseRouteError),r=NV(Yv.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function IQ(){let{router:t}=SQ(IV.UseNavigateStable),e=NV(Yv.UseNavigateStable),n=p.useRef(!1);return EV(()=>{n.current=!0}),p.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Lp({fromRouteId:e},i)))},[t,e])}const nR={};function NQ(t,e,n){!e&&!nR[t]&&(nR[t]=!0)}function PQ(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function PV(t){let{to:e,replace:n,state:r,relative:s}=t;vf()||an(!1);let{future:i,static:o}=p.useContext(Dc),{matches:l}=p.useContext(Sa),{pathname:c}=Ca(),u=ti(),d=C0(e,S0(l,i.v7_relativeSplatPath),c,s==="path"),h=JSON.stringify(d);return p.useEffect(()=>u(JSON.parse(h),{replace:n,state:r,relative:s}),[u,h,s,n,r]),null}function AQ(t){return gQ(t.context)}function kQ(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Rr.Pop,navigator:i,static:o=!1,future:l}=t;vf()&&an(!1);let c=e.replace(/^\/*/,"/"),u=p.useMemo(()=>({basename:c,navigator:i,static:o,future:Lp({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=pl(r));let{pathname:d="/",search:h="",hash:f="",state:m=null,key:g="default"}=r,x=p.useMemo(()=>{let v=xf(d,c);return v==null?null:{location:{pathname:v,search:h,hash:f,state:m,key:g},navigationType:s}},[c,d,h,f,m,g,s]);return x==null?null:p.createElement(Dc.Provider,{value:u},p.createElement(T0.Provider,{children:n,value:x}))}new Promise(()=>{});function jQ(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:p.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:p.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:p.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fp(){return Fp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Fp.apply(this,arguments)}function RQ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function DQ(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function MQ(t,e){return t.button===0&&(!e||e==="_self")&&!DQ(t)}const LQ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],FQ="6";try{window.__reactRouterVersion=FQ}catch{}function OQ(t,e){return qJ({basename:e==null?void 0:e.basename,future:Fp({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:yJ({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||$Q(),routes:t,mapRouteProperties:jQ,dataStrategy:e==null?void 0:e.dataStrategy,patchRoutesOnNavigation:e==null?void 0:e.patchRoutesOnNavigation,window:e==null?void 0:e.window}).initialize()}function $Q(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=Fp({},e,{errors:VQ(e.errors)})),e}function VQ(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new Kv(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let o=new i(s.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let i=new Error(s.message);i.stack="",n[r]=i}}else n[r]=s;return n}const UQ=p.createContext({isTransitioning:!1}),BQ=p.createContext(new Map),zQ="startTransition",rR=a0[zQ],GQ="flushSync",sR=gJ[GQ];function WQ(t){rR?rR(t):t()}function Kf(t){sR?sR(t):t()}let HQ=class{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}};function qQ(t){let{fallbackElement:e,router:n,future:r}=t,[s,i]=p.useState(n.state),[o,l]=p.useState(),[c,u]=p.useState({isTransitioning:!1}),[d,h]=p.useState(),[f,m]=p.useState(),[g,x]=p.useState(),v=p.useRef(new Map),{v7_startTransition:w}=r||{},_=p.useCallback(I=>{w?WQ(I):I()},[w]),C=p.useCallback((I,N)=>{let{deletedFetchers:k,flushSync:R,viewTransitionOpts:D}=N;I.fetchers.forEach((z,B)=>{z.data!==void 0&&v.current.set(B,z.data)}),k.forEach(z=>v.current.delete(z));let M=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!D||M){R?Kf(()=>i(I)):_(()=>i(I));return}if(R){Kf(()=>{f&&(d&&d.resolve(),f.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:D.currentLocation,nextLocation:D.nextLocation})});let z=n.window.document.startViewTransition(()=>{Kf(()=>i(I))});z.finished.finally(()=>{Kf(()=>{h(void 0),m(void 0),l(void 0),u({isTransitioning:!1})})}),Kf(()=>m(z));return}f?(d&&d.resolve(),f.skipTransition(),x({state:I,currentLocation:D.currentLocation,nextLocation:D.nextLocation})):(l(I),u({isTransitioning:!0,flushSync:!1,currentLocation:D.currentLocation,nextLocation:D.nextLocation}))},[n.window,f,d,v,_]);p.useLayoutEffect(()=>n.subscribe(C),[n,C]),p.useEffect(()=>{c.isTransitioning&&!c.flushSync&&h(new HQ)},[c]),p.useEffect(()=>{if(d&&o&&n.window){let I=o,N=d.promise,k=n.window.document.startViewTransition(async()=>{_(()=>i(I)),await N});k.finished.finally(()=>{h(void 0),m(void 0),l(void 0),u({isTransitioning:!1})}),m(k)}},[_,o,d,n.window]),p.useEffect(()=>{d&&o&&s.location.key===o.location.key&&d.resolve()},[d,f,s.location,o]),p.useEffect(()=>{!c.isTransitioning&&g&&(l(g.state),u({isTransitioning:!0,flushSync:!1,currentLocation:g.currentLocation,nextLocation:g.nextLocation}),x(void 0))},[c.isTransitioning,g]),p.useEffect(()=>{},[]);let T=p.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:I=>n.navigate(I),push:(I,N,k)=>n.navigate(I,{state:N,preventScrollReset:k==null?void 0:k.preventScrollReset}),replace:(I,N,k)=>n.navigate(I,{replace:!0,state:N,preventScrollReset:k==null?void 0:k.preventScrollReset})}),[n]),j=n.basename||"/",A=p.useMemo(()=>({router:n,navigator:T,static:!1,basename:j}),[n,T,j]),E=p.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return p.useEffect(()=>PQ(r,n.future),[r,n.future]),p.createElement(p.Fragment,null,p.createElement(E0.Provider,{value:A},p.createElement(SV.Provider,{value:s},p.createElement(BQ.Provider,{value:v.current},p.createElement(UQ.Provider,{value:c},p.createElement(kQ,{basename:j,location:s.location,navigationType:s.historyAction,navigator:T,future:E},s.initialized||n.future.v7_partialHydration?p.createElement(KQ,{routes:n.routes,future:n.future,state:s}):e))))),null)}const KQ=p.memo(YQ);function YQ(t){let{routes:e,future:n,state:r}=t;return yQ(e,void 0,r,n)}const JQ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",QQ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zn=p.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h}=e,f=RQ(e,LQ),{basename:m}=p.useContext(Dc),g,x=!1;if(typeof u=="string"&&QQ.test(u)&&(g=u,JQ))try{let C=new URL(window.location.href),T=u.startsWith("//")?new URL(C.protocol+u):new URL(u),j=xf(T.pathname,m);T.origin===C.origin&&j!=null?u=j+T.search+T.hash:x=!0}catch{}let v=fQ(u,{relative:s}),w=XQ(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:h});function _(C){r&&r(C),C.defaultPrevented||w(C)}return p.createElement("a",Fp({},f,{href:g||v,onClick:x||i?r:_,ref:n,target:c}))});var iR;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(iR||(iR={}));var oR;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(oR||(oR={}));function XQ(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=ti(),u=Ca(),d=TV(t,{relative:o});return p.useCallback(h=>{if(MQ(h,n)){h.preventDefault();let f=r!==void 0?r:Gu(u)===Gu(d);c(t,{replace:f,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[u,c,d,r,s,n,t,i,o,l])}function AV(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=AV(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function kV(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=AV(t))&&(r&&(r+=" "),r+=e);return r}function ZQ(){for(var t=0,e,n,r="";t<arguments.length;)(e=arguments[t++])&&(n=jV(e))&&(r&&(r+=" "),r+=n);return r}function jV(t){if(typeof t=="string")return t;for(var e,n="",r=0;r<t.length;r++)t[r]&&(e=jV(t[r]))&&(n&&(n+=" "),n+=e);return n}var gI="-";function eX(t){var e=nX(t),n=t.conflictingClassGroups,r=t.conflictingClassGroupModifiers,s=r===void 0?{}:r;function i(l){var c=l.split(gI);return c[0]===""&&c.length!==1&&c.shift(),RV(c,e)||tX(l)}function o(l,c){var u=n[l]||[];return c&&s[l]?[].concat(u,s[l]):u}return{getClassGroupId:i,getConflictingClassGroupIds:o}}function RV(t,e){var o;if(t.length===0)return e.classGroupId;var n=t[0],r=e.nextPart.get(n),s=r?RV(t.slice(1),r):void 0;if(s)return s;if(e.validators.length!==0){var i=t.join(gI);return(o=e.validators.find(function(l){var c=l.validator;return c(i)}))==null?void 0:o.classGroupId}}var aR=/^\[(.+)\]$/;function tX(t){if(aR.test(t)){var e=aR.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}function nX(t){var e=t.theme,n=t.prefix,r={nextPart:new Map,validators:[]},s=sX(Object.entries(t.classGroups),n);return s.forEach(function(i){var o=i[0],l=i[1];fE(l,r,o,e)}),r}function fE(t,e,n,r){t.forEach(function(s){if(typeof s=="string"){var i=s===""?e:lR(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(rX(s)){fE(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(function(o){var l=o[0],c=o[1];fE(c,lR(e,l),n,r)})})}function lR(t,e){var n=t;return e.split(gI).forEach(function(r){n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n}function rX(t){return t.isThemeGetter}function sX(t,e){return e?t.map(function(n){var r=n[0],s=n[1],i=s.map(function(o){return typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(l){var c=l[0],u=l[1];return[e+c,u]})):o});return[r,i]}):t}function iX(t){if(t<1)return{get:function(){},set:function(){}};var e=0,n=new Map,r=new Map;function s(i,o){n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)}return{get:function(o){var l=n.get(o);if(l!==void 0)return l;if((l=r.get(o))!==void 0)return s(o,l),l},set:function(o,l){n.has(o)?n.set(o,l):s(o,l)}}}var DV="!";function oX(t){var e=t.separator||":",n=e.length===1,r=e[0],s=e.length;return function(o){for(var l=[],c=0,u=0,d,h=0;h<o.length;h++){var f=o[h];if(c===0){if(f===r&&(n||o.slice(h,h+s)===e)){l.push(o.slice(u,h)),u=h+s;continue}if(f==="/"){d=h;continue}}f==="["?c++:f==="]"&&c--}var m=l.length===0?o:o.substring(u),g=m.startsWith(DV),x=g?m.substring(1):m,v=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:g,baseClassName:x,maybePostfixModifierPosition:v}}}function aX(t){if(t.length<=1)return t;var e=[],n=[];return t.forEach(function(r){var s=r[0]==="[";s?(e.push.apply(e,n.sort().concat([r])),n=[]):n.push(r)}),e.push.apply(e,n.sort()),e}function lX(t){return{cache:iX(t.cacheSize),splitModifiers:oX(t),...eX(t)}}var cX=/\s+/;function uX(t,e){var n=e.splitModifiers,r=e.getClassGroupId,s=e.getConflictingClassGroupIds,i=new Set;return t.trim().split(cX).map(function(o){var l=n(o),c=l.modifiers,u=l.hasImportantModifier,d=l.baseClassName,h=l.maybePostfixModifierPosition,f=r(h?d.substring(0,h):d),m=!!h;if(!f){if(!h)return{isTailwindClass:!1,originalClassName:o};if(f=r(d),!f)return{isTailwindClass:!1,originalClassName:o};m=!1}var g=aX(c).join(":"),x=u?g+DV:g;return{isTailwindClass:!0,modifierId:x,classGroupId:f,originalClassName:o,hasPostfixModifier:m}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var l=o.modifierId,c=o.classGroupId,u=o.hasPostfixModifier,d=l+c;return i.has(d)?!1:(i.add(d),s(c,u).forEach(function(h){return i.add(l+h)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function dX(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,s,i,o=l;function l(u){var d=e[0],h=e.slice(1),f=h.reduce(function(m,g){return g(m)},d());return r=lX(f),s=r.cache.get,i=r.cache.set,o=c,c(u)}function c(u){var d=s(u);if(d)return d;var h=uX(u,r);return i(u,h),h}return function(){return o(ZQ.apply(null,arguments))}}function Yn(t){var e=function(r){return r[t]||[]};return e.isThemeGetter=!0,e}var MV=/^\[(?:([a-z-]+):)?(.+)\]$/i,hX=/^\d+\/\d+$/,fX=new Set(["px","full","screen"]),mX=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,pX=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,gX=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function _o(t){return Su(t)||fX.has(t)||hX.test(t)||mE(t)}function mE(t){return cd(t,"length",_X)}function yX(t){return cd(t,"size",LV)}function xX(t){return cd(t,"position",LV)}function vX(t){return cd(t,"url",SX)}function Ly(t){return cd(t,"number",Su)}function Su(t){return!Number.isNaN(Number(t))}function wX(t){return t.endsWith("%")&&Su(t.slice(0,-1))}function Yf(t){return cR(t)||cd(t,"number",cR)}function un(t){return MV.test(t)}function Jf(){return!0}function _l(t){return mX.test(t)}function bX(t){return cd(t,"",CX)}function cd(t,e,n){var r=MV.exec(t);return r?r[1]?r[1]===e:n(r[2]):!1}function _X(t){return pX.test(t)}function LV(){return!1}function SX(t){return t.startsWith("url(")}function cR(t){return Number.isInteger(Number(t))}function CX(t){return gX.test(t)}function EX(){var t=Yn("colors"),e=Yn("spacing"),n=Yn("blur"),r=Yn("brightness"),s=Yn("borderColor"),i=Yn("borderRadius"),o=Yn("borderSpacing"),l=Yn("borderWidth"),c=Yn("contrast"),u=Yn("grayscale"),d=Yn("hueRotate"),h=Yn("invert"),f=Yn("gap"),m=Yn("gradientColorStops"),g=Yn("gradientColorStopPositions"),x=Yn("inset"),v=Yn("margin"),w=Yn("opacity"),_=Yn("padding"),C=Yn("saturate"),T=Yn("scale"),j=Yn("sepia"),A=Yn("skew"),E=Yn("space"),I=Yn("translate"),N=function(){return["auto","contain","none"]},k=function(){return["auto","hidden","clip","visible","scroll"]},R=function(){return["auto",un,e]},D=function(){return[un,e]},M=function(){return["",_o]},z=function(){return["auto",Su,un]},B=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},G=function(){return["solid","dashed","dotted","double","none"]},Y=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},H=function(){return["start","end","center","between","around","evenly","stretch"]},K=function(){return["","0",un]},$=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},V=function(){return[Su,Ly]},W=function(){return[Su,un]};return{cacheSize:500,theme:{colors:[Jf],spacing:[_o],blur:["none","",_l,un],brightness:V(),borderColor:[t],borderRadius:["none","","full",_l,un],borderSpacing:D(),borderWidth:M(),contrast:V(),grayscale:K(),hueRotate:W(),invert:K(),gap:D(),gradientColorStops:[t],gradientColorStopPositions:[wX,mE],inset:R(),margin:R(),opacity:V(),padding:D(),saturate:V(),scale:V(),sepia:K(),skew:W(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",un]}],container:["container"],columns:[{columns:[_l]}],"break-after":[{"break-after":$()}],"break-before":[{"break-before":$()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(B(),[un])}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Yf]}],basis:[{basis:R()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",un]}],grow:[{grow:K()}],shrink:[{shrink:K()}],order:[{order:["first","last","none",Yf]}],"grid-cols":[{"grid-cols":[Jf]}],"col-start-end":[{col:["auto",{span:["full",Yf]},un]}],"col-start":[{"col-start":z()}],"col-end":[{"col-end":z()}],"grid-rows":[{"grid-rows":[Jf]}],"row-start-end":[{row:["auto",{span:[Yf]},un]}],"row-start":[{"row-start":z()}],"row-end":[{"row-end":z()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",un]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",un]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal"].concat(H())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(H(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(H(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",un,e]}],"min-w":[{"min-w":["min","max","fit",un,_o]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[_l]},_l,un]}],h:[{h:[un,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",un,_o]}],"max-h":[{"max-h":[un,e,"min","max","fit"]}],"font-size":[{text:["base",_l,mE]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ly]}],"font-family":[{font:[Jf]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",un]}],"line-clamp":[{"line-clamp":["none",Su,Ly]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",un,_o]}],"list-image":[{"list-image":["none",un]}],"list-style-type":[{list:["none","disc","decimal",un]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(G(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",_o]}],"underline-offset":[{"underline-offset":["auto",un,_o]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",un]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",un]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(B(),[xX])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",yX]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},vX]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[].concat(G(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:G()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(G())}],"outline-offset":[{"outline-offset":[un,_o]}],"outline-w":[{outline:[_o]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[_o]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",_l,bX]}],"shadow-color":[{shadow:[Jf]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":Y()}],"bg-blend":[{"bg-blend":Y()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",_l,un]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[C]}],sepia:[{sepia:[j]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[C]}],"backdrop-sepia":[{"backdrop-sepia":[j]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",un]}],duration:[{duration:W()}],ease:[{ease:["linear","in","out","in-out",un]}],delay:[{delay:W()}],animate:[{animate:["none","spin","ping","pulse","bounce",un]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[T]}],"scale-x":[{"scale-x":[T]}],"scale-y":[{"scale-y":[T]}],rotate:[{rotate:[Yf,un]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[A]}],"skew-y":[{"skew-y":[A]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",un]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",un]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",un]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[_o,Ly]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var TX=dX(EX);let Fy;const IX=new Uint8Array(16);function NX(){if(!Fy&&(Fy=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Fy))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Fy(IX)}const us=[];for(let t=0;t<256;++t)us.push((t+256).toString(16).slice(1));function PX(t,e=0){return us[t[e+0]]+us[t[e+1]]+us[t[e+2]]+us[t[e+3]]+"-"+us[t[e+4]]+us[t[e+5]]+"-"+us[t[e+6]]+us[t[e+7]]+"-"+us[t[e+8]]+us[t[e+9]]+"-"+us[t[e+10]]+us[t[e+11]]+us[t[e+12]]+us[t[e+13]]+us[t[e+14]]+us[t[e+15]]}const AX=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),uR={randomUUID:AX};function kX(t,e,n){if(uR.randomUUID&&!e&&!t)return uR.randomUUID();t=t||{};const r=t.random||(t.rng||NX)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=r[s];return e}return PX(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let jX,RX;function DX(){return{geminiUrl:jX,vertexUrl:RX}}function MX(t,e,n){var r,s,i;if(!(!((r=t.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=DX();return t.vertexai?(s=o.vertexUrl)!==null&&s!==void 0?s:e:(i=o.geminiUrl)!==null&&i!==void 0?i:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wg{}function qt(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const i=e[s];return i!=null?String(i):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function S(t,e,n){for(let i=0;i<e.length-1;i++){const o=e[i];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in t))if(Array.isArray(n))t[l]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[l])){const c=t[l];if(Array.isArray(n))for(let u=0;u<c.length;u++){const d=c[u];S(d,e.slice(i+1),n[u])}else for(const u of c)S(u,e.slice(i+1),n)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in t||(t[l]=[{}]);const c=t[l];S(c[0],e.slice(i+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],s=t[r];if(s!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===s)return;if(typeof s=="object"&&typeof n=="object"&&s!==null&&n!==null)Object.assign(s,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else t[r]=n}function b(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in t){const i=t[s];return Array.isArray(i)?i.map(o=>b(o,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function or(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function FV(t,e){const n=or(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function OV(t,e){return Array.isArray(e)?e.map(n=>Jv(t,n)):[Jv(t,e)]}function Jv(t,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function LX(t,e){const n=Jv(t,e);if(n.mimeType&&n.mimeType.startsWith("image/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function FX(t,e){const n=Jv(t,e);if(n.mimeType&&n.mimeType.startsWith("audio/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function dR(t,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function $V(t,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(n=>dR(t,n)):[dR(t,e)]}function pE(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function hR(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function fR(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function hi(t,e){if(e==null)throw new Error("ContentUnion is required");return pE(e)?e:{role:"user",parts:$V(t,e)}}function VV(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=hi(t,n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=hi(t,e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>hi(t,n)):[hi(t,e)]}function Mc(t,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(hR(e)||fR(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[hi(t,e)]}const n=[],r=[],s=pE(e[0]);for(const i of e){const o=pE(i);if(o!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)n.push(i);else{if(hR(i)||fR(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(i)}}return s||n.push({role:"user",parts:$V(t,r)}),n}function UV(t,e){return e}function BV(t,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function N0(t,e){return e}function P0(t,e){if(!Array.isArray(e))throw new Error("tool is required and must be an array of Tools");return e}function OX(t,e,n,r=1){const s=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:s?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:s?`${n}/${e}`:e}function Lc(t,e){if(typeof e!="string")throw new Error("name must be a string");return OX(t,e,"cachedContents")}function zV(t,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Fc(t,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function $X(t){return t!=null&&typeof t=="object"&&"name"in t}function VX(t){return t!=null&&typeof t=="object"&&"video"in t}function UX(t){return t!=null&&typeof t=="object"&&"uri"in t}function GV(t,e){var n;let r;if($X(e)&&(r=e.name),!(UX(e)&&(r=e.uri,r===void 0))&&!(VX(e)&&(r=(n=e.video)===null||n===void 0?void 0:n.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const i=r.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${r}`);r=i[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function WV(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function HV(t,e){for(const n of["models","tunedModels","publisherModels"])if(BX(e,n))return e[n];return[]}function BX(t,e){return t!==null&&typeof t=="object"&&e in t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zX(t,e){const n={};if(b(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function GX(t,e){const n={};if(b(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],zX(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function mR(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>GX(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function WX(){return{}}function HX(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function qX(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],HX(t,r)),n}function KX(t,e){const n={};if(b(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");b(e,["googleSearch"])!=null&&S(n,["googleSearch"],WX());const s=b(e,["googleSearchRetrieval"]);if(s!=null&&S(n,["googleSearchRetrieval"],qX(t,s)),b(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(b(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=b(e,["codeExecution"]);i!=null&&S(n,["codeExecution"],i);const o=b(e,["functionDeclarations"]);return o!=null&&S(n,["functionDeclarations"],o),n}function YX(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function JX(t,e){const n={},r=b(e,["functionCallingConfig"]);if(r!=null&&S(n,["functionCallingConfig"],YX(t,r)),b(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}function QX(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);n!==void 0&&i!=null&&S(n,["expireTime"],i);const o=b(e,["displayName"]);n!==void 0&&o!=null&&S(n,["displayName"],o);const l=b(e,["contents"]);if(n!==void 0&&l!=null){let h=Mc(t,l);Array.isArray(h)&&(h=h.map(f=>mR(t,f))),S(n,["contents"],h)}const c=b(e,["systemInstruction"]);n!==void 0&&c!=null&&S(n,["systemInstruction"],mR(t,hi(t,c)));const u=b(e,["tools"]);if(n!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(f=>KX(t,f))),S(n,["tools"],h)}const d=b(e,["toolConfig"]);return n!==void 0&&d!=null&&S(n,["toolConfig"],JX(t,d)),r}function XX(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["model"],FV(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],QX(t,s,n)),n}function ZX(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Lc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function eZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Lc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function tZ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);return n!==void 0&&i!=null&&S(n,["expireTime"],i),r}function nZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Lc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],tZ(t,s,n)),n}function rZ(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);return n!==void 0&&i!=null&&S(n,["_query","pageToken"],i),r}function sZ(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],rZ(t,r,n)),n}function iZ(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function oZ(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],iZ(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function pR(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>oZ(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function aZ(){return{}}function lZ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function cZ(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],lZ(t,r)),n}function uZ(){return{}}function dZ(t,e){const n={},r=b(e,["apiKeyString"]);return r!=null&&S(n,["apiKeyString"],r),n}function hZ(t,e){const n={},r=b(e,["apiKeyConfig"]);r!=null&&S(n,["apiKeyConfig"],dZ(t,r));const s=b(e,["authType"]);s!=null&&S(n,["authType"],s);const i=b(e,["googleServiceAccountConfig"]);i!=null&&S(n,["googleServiceAccountConfig"],i);const o=b(e,["httpBasicAuthConfig"]);o!=null&&S(n,["httpBasicAuthConfig"],o);const l=b(e,["oauthConfig"]);l!=null&&S(n,["oauthConfig"],l);const c=b(e,["oidcConfig"]);return c!=null&&S(n,["oidcConfig"],c),n}function fZ(t,e){const n={},r=b(e,["authConfig"]);return r!=null&&S(n,["authConfig"],hZ(t,r)),n}function mZ(t,e){const n={},r=b(e,["retrieval"]);r!=null&&S(n,["retrieval"],r),b(e,["googleSearch"])!=null&&S(n,["googleSearch"],aZ());const i=b(e,["googleSearchRetrieval"]);i!=null&&S(n,["googleSearchRetrieval"],cZ(t,i)),b(e,["enterpriseWebSearch"])!=null&&S(n,["enterpriseWebSearch"],uZ());const l=b(e,["googleMaps"]);l!=null&&S(n,["googleMaps"],fZ(t,l));const c=b(e,["codeExecution"]);c!=null&&S(n,["codeExecution"],c);const u=b(e,["functionDeclarations"]);return u!=null&&S(n,["functionDeclarations"],u),n}function pZ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function gZ(t,e){const n={},r=b(e,["latitude"]);r!=null&&S(n,["latitude"],r);const s=b(e,["longitude"]);return s!=null&&S(n,["longitude"],s),n}function yZ(t,e){const n={},r=b(e,["latLng"]);return r!=null&&S(n,["latLng"],gZ(t,r)),n}function xZ(t,e){const n={},r=b(e,["functionCallingConfig"]);r!=null&&S(n,["functionCallingConfig"],pZ(t,r));const s=b(e,["retrievalConfig"]);return s!=null&&S(n,["retrievalConfig"],yZ(t,s)),n}function vZ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);n!==void 0&&i!=null&&S(n,["expireTime"],i);const o=b(e,["displayName"]);n!==void 0&&o!=null&&S(n,["displayName"],o);const l=b(e,["contents"]);if(n!==void 0&&l!=null){let h=Mc(t,l);Array.isArray(h)&&(h=h.map(f=>pR(t,f))),S(n,["contents"],h)}const c=b(e,["systemInstruction"]);n!==void 0&&c!=null&&S(n,["systemInstruction"],pR(t,hi(t,c)));const u=b(e,["tools"]);if(n!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(f=>mZ(t,f))),S(n,["tools"],h)}const d=b(e,["toolConfig"]);return n!==void 0&&d!=null&&S(n,["toolConfig"],xZ(t,d)),r}function wZ(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["model"],FV(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],vZ(t,s,n)),n}function bZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Lc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function _Z(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Lc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function SZ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);return n!==void 0&&i!=null&&S(n,["expireTime"],i),r}function CZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Lc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],SZ(t,s,n)),n}function EZ(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);return n!==void 0&&i!=null&&S(n,["_query","pageToken"],i),r}function TZ(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],EZ(t,r,n)),n}function zx(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["model"]);i!=null&&S(n,["model"],i);const o=b(e,["createTime"]);o!=null&&S(n,["createTime"],o);const l=b(e,["updateTime"]);l!=null&&S(n,["updateTime"],l);const c=b(e,["expireTime"]);c!=null&&S(n,["expireTime"],c);const u=b(e,["usageMetadata"]);return u!=null&&S(n,["usageMetadata"],u),n}function IZ(){return{}}function NZ(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>zx(t,o))),S(n,["cachedContents"],i)}return n}function Gx(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["model"]);i!=null&&S(n,["model"],i);const o=b(e,["createTime"]);o!=null&&S(n,["createTime"],o);const l=b(e,["updateTime"]);l!=null&&S(n,["updateTime"],l);const c=b(e,["expireTime"]);c!=null&&S(n,["expireTime"],c);const u=b(e,["usageMetadata"]);return u!=null&&S(n,["usageMetadata"],u),n}function PZ(){return{}}function AZ(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>Gx(t,o))),S(n,["cachedContents"],i)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Gh;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Gh||(Gh={}));class A0{constructor(e,n,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,s)}init(e,n,r){var s,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(i=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var gR;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(gR||(gR={}));var yR;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(yR||(yR={}));var Nr;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Nr||(Nr={}));var xR;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(xR||(xR={}));var Pr;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Pr||(Pr={}));var vR;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(vR||(vR={}));var wR;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(wR||(wR={}));var rt;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT"})(rt||(rt={}));var bR;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY"})(bR||(bR={}));var _R;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(_R||(_R={}));var SR;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(SR||(SR={}));var CR;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(CR||(CR={}));var ER;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(ER||(ER={}));var wn;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(wn||(wn={}));var TR;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(TR||(TR={}));var gE;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(gE||(gE={}));var IR;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(IR||(IR={}));var NR;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(NR||(NR={}));var PR;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(PR||(PR={}));var AR;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(AR||(AR={}));var kR;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(kR||(kR={}));var jR;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(jR||(jR={}));var RR;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})(RR||(RR={}));var DR;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(DR||(DR={}));var MR;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(MR||(MR={}));var LR;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(LR||(LR={}));var FR;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(FR||(FR={}));var OR;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(OR||(OR={}));var $R;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})($R||($R={}));var VR;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(VR||(VR={}));var UR;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(UR||(UR={}));var BR;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(BR||(BR={}));var zR;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(zR||(zR={}));var GR;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(GR||(GR={}));class Oy{get text(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",d=!1;const h=[];for(const f of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[m,g]of Object.entries(f))m!=="text"&&m!=="thought"&&(g!==null||g!==void 0)&&h.push(m);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;d=!0,u+=f.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?u:void 0}get data(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const d=[];for(const h of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[f,m]of Object.entries(h))f!=="inlineData"&&(m!==null||m!==void 0)&&d.push(f);h.inlineData&&typeof h.inlineData.data=="string"&&(u+=atob(h.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,s,i,o,l,c,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,s,i,o,l,c,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.output}}class WR{}class HR{}class kZ{}class jZ{}class qR{}class KR{}class YR{}class RZ{}class JR{}class QR{}class XR{}class DZ{}class yE{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class MZ{}class LZ{}class FZ{get text(){var e,n,r;let s="",i=!1;const o=[];for(const l of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,u]of Object.entries(l))c!=="text"&&c!=="thought"&&u!==null&&o.push(c);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;i=!0,s+=l.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?s:void 0}get data(){var e,n,r;let s="";const i=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(o))l!=="inlineData"&&c!==null&&i.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class OZ extends wg{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new A0(Gh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=wZ(this.apiClient,e);return l=qt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>Gx(this.apiClient,d))}else{const u=XX(this.apiClient,e);return l=qt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>zx(this.apiClient,d))}}async get(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=bZ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>Gx(this.apiClient,d))}else{const u=ZX(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>zx(this.apiClient,d))}}async delete(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=_Z(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(()=>{const d=PZ(),h=new QR;return Object.assign(h,d),h})}else{const u=eZ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=IZ(),h=new QR;return Object.assign(h,d),h})}}async update(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=CZ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>Gx(this.apiClient,d))}else{const u=nZ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>zx(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=TZ(this.apiClient,e);return l=qt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=AZ(this.apiClient,d),f=new XR;return Object.assign(f,h),f})}else{const u=sZ(this.apiClient,e);return l=qt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=NZ(this.apiClient,d),f=new XR;return Object.assign(f,h),f})}}}function ZR(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ps(t){return this instanceof Ps?(this.v=t,this):new Ps(t)}function Qv(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(g){return Promise.resolve(g).then(m,h)}}function l(m,g){r[m]&&(s[m]=function(x){return new Promise(function(v,w){i.push([m,x,v,w])>1||c(m,x)})},g&&(s[m]=g(s[m])))}function c(m,g){try{u(r[m](g))}catch(x){f(i[0][3],x)}}function u(m){m.value instanceof Ps?Promise.resolve(m.value.v).then(d,h):f(i[0][2],m)}function d(m){c("next",m)}function h(m){c("throw",m)}function f(m,g){m(g),i.shift(),i.length&&c(i[0][0],i[0][1])}}function xE(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof ZR=="function"?ZR(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(l,c){o=t[i](o),s(l,c,o.done,o.value)})}}function s(i,o,l,c){Promise.resolve(c).then(function(u){i({value:u,done:l})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $Z(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:qV(n)}function qV(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||e.text!==void 0&&e.text==="")return!1;return!0}function VZ(t){if(t.length!==0){if(t[0].role!=="user")throw new Error("History must start with a user turn.");for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function UZ(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0,s=t[0];for(;r<n;)if(t[r].role==="user")s=t[r],r++;else{const i=[];let o=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),o&&!qV(t[r])&&(o=!1),r++;o&&(e.push(s),e.push(...i))}return e}class BZ{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new zZ(this.apiClient,this.modelsModule,e.model,e.config,e.history)}}let zZ=class{constructor(e,n,r,s={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=s,this.history=i,this.sendPromise=Promise.resolve(),VZ(i)}async sendMessage(e){var n;await this.sendPromise;const r=hi(this.apiClient,e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,o;const c=(o=(i=(await s).candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content,u=c?[c]:[];this.recordHistory(r,u)})(),await this.sendPromise,s}async sendMessageStream(e){var n;await this.sendPromise;const r=hi(this.apiClient,e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const i=await s;return this.processStreamResponse(i,r)}getHistory(e=!1){return e?UZ(this.history):this.history}processStreamResponse(e,n){var r,s;return Qv(this,arguments,function*(){var o,l,c,u;const d=[];try{for(var h=!0,f=xE(e),m;m=yield Ps(f.next()),o=m.done,!o;h=!0){u=m.value,h=!1;const g=u;if($Z(g)){const x=(s=(r=g.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content;x!==void 0&&d.push(x)}yield yield Ps(g)}}catch(g){l={error:g}}finally{try{!h&&!o&&(c=f.return)&&(yield Ps(c.call(f)))}finally{if(l)throw l.error}}this.recordHistory(n,d)})}recordHistory(e,n){let r=[];n.length>0&&n.every(s=>s.role==="model")?r=n:r.push({role:"model",parts:[]}),this.history.push(e),this.history.push(...r)}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function GZ(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);return n!==void 0&&i!=null&&S(n,["_query","pageToken"],i),r}function WZ(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],GZ(t,r,n)),n}function HZ(t,e){const n={},r=b(e,["details"]);r!=null&&S(n,["details"],r);const s=b(e,["message"]);s!=null&&S(n,["message"],s);const i=b(e,["code"]);return i!=null&&S(n,["code"],i),n}function qZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["mimeType"]);i!=null&&S(n,["mimeType"],i);const o=b(e,["sizeBytes"]);o!=null&&S(n,["sizeBytes"],o);const l=b(e,["createTime"]);l!=null&&S(n,["createTime"],l);const c=b(e,["expirationTime"]);c!=null&&S(n,["expirationTime"],c);const u=b(e,["updateTime"]);u!=null&&S(n,["updateTime"],u);const d=b(e,["sha256Hash"]);d!=null&&S(n,["sha256Hash"],d);const h=b(e,["uri"]);h!=null&&S(n,["uri"],h);const f=b(e,["downloadUri"]);f!=null&&S(n,["downloadUri"],f);const m=b(e,["state"]);m!=null&&S(n,["state"],m);const g=b(e,["source"]);g!=null&&S(n,["source"],g);const x=b(e,["videoMetadata"]);x!=null&&S(n,["videoMetadata"],x);const v=b(e,["error"]);return v!=null&&S(n,["error"],HZ(t,v)),n}function KZ(t,e){const n={},r=b(e,["file"]);r!=null&&S(n,["file"],qZ(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function YZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","file"],GV(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function JZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","file"],GV(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function QZ(t,e){const n={},r=b(e,["details"]);r!=null&&S(n,["details"],r);const s=b(e,["message"]);s!=null&&S(n,["message"],s);const i=b(e,["code"]);return i!=null&&S(n,["code"],i),n}function vE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["mimeType"]);i!=null&&S(n,["mimeType"],i);const o=b(e,["sizeBytes"]);o!=null&&S(n,["sizeBytes"],o);const l=b(e,["createTime"]);l!=null&&S(n,["createTime"],l);const c=b(e,["expirationTime"]);c!=null&&S(n,["expirationTime"],c);const u=b(e,["updateTime"]);u!=null&&S(n,["updateTime"],u);const d=b(e,["sha256Hash"]);d!=null&&S(n,["sha256Hash"],d);const h=b(e,["uri"]);h!=null&&S(n,["uri"],h);const f=b(e,["downloadUri"]);f!=null&&S(n,["downloadUri"],f);const m=b(e,["state"]);m!=null&&S(n,["state"],m);const g=b(e,["source"]);g!=null&&S(n,["source"],g);const x=b(e,["videoMetadata"]);x!=null&&S(n,["videoMetadata"],x);const v=b(e,["error"]);return v!=null&&S(n,["error"],QZ(t,v)),n}function XZ(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["files"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>vE(t,o))),S(n,["files"],i)}return n}function ZZ(){return{}}function eee(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let tee=class extends wg{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new A0(Gh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>vE(this.apiClient,n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=WZ(this.apiClient,e);return i=qt("files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=XZ(this.apiClient,c),d=new DZ;return Object.assign(d,u),d})}}async createInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=KZ(this.apiClient,e);return i=qt("upload/v1beta/files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=ZZ(),u=new MZ;return Object.assign(u,c),u})}}async get(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=YZ(this.apiClient,e);return i=qt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>vE(this.apiClient,c))}}async delete(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=JZ(this.apiClient,e);return i=qt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=eee(),u=new LZ;return Object.assign(u,c),u})}}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nee(t,e){const n={};if(b(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function ree(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function see(t,e){const n={};if(b(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],nee(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function iee(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],ree(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function oee(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>see(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function aee(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>iee(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function lee(){return{}}function cee(){return{}}function uee(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function dee(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function hee(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],uee(t,r)),n}function fee(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],dee(t,r)),n}function mee(){return{}}function pee(t,e){const n={},r=b(e,["apiKeyString"]);return r!=null&&S(n,["apiKeyString"],r),n}function gee(t,e){const n={},r=b(e,["apiKeyConfig"]);r!=null&&S(n,["apiKeyConfig"],pee(t,r));const s=b(e,["authType"]);s!=null&&S(n,["authType"],s);const i=b(e,["googleServiceAccountConfig"]);i!=null&&S(n,["googleServiceAccountConfig"],i);const o=b(e,["httpBasicAuthConfig"]);o!=null&&S(n,["httpBasicAuthConfig"],o);const l=b(e,["oauthConfig"]);l!=null&&S(n,["oauthConfig"],l);const c=b(e,["oidcConfig"]);return c!=null&&S(n,["oidcConfig"],c),n}function yee(t,e){const n={},r=b(e,["authConfig"]);return r!=null&&S(n,["authConfig"],gee(t,r)),n}function xee(t,e){const n={};if(b(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");b(e,["googleSearch"])!=null&&S(n,["googleSearch"],lee());const s=b(e,["googleSearchRetrieval"]);if(s!=null&&S(n,["googleSearchRetrieval"],hee(t,s)),b(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(b(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=b(e,["codeExecution"]);i!=null&&S(n,["codeExecution"],i);const o=b(e,["functionDeclarations"]);return o!=null&&S(n,["functionDeclarations"],o),n}function vee(t,e){const n={},r=b(e,["retrieval"]);r!=null&&S(n,["retrieval"],r),b(e,["googleSearch"])!=null&&S(n,["googleSearch"],cee());const i=b(e,["googleSearchRetrieval"]);i!=null&&S(n,["googleSearchRetrieval"],fee(t,i)),b(e,["enterpriseWebSearch"])!=null&&S(n,["enterpriseWebSearch"],mee());const l=b(e,["googleMaps"]);l!=null&&S(n,["googleMaps"],yee(t,l));const c=b(e,["codeExecution"]);c!=null&&S(n,["codeExecution"],c);const u=b(e,["functionDeclarations"]);return u!=null&&S(n,["functionDeclarations"],u),n}function wee(t,e){const n={},r=b(e,["handle"]);if(r!=null&&S(n,["handle"],r),b(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return n}function bee(t,e){const n={},r=b(e,["handle"]);r!=null&&S(n,["handle"],r);const s=b(e,["transparent"]);return s!=null&&S(n,["transparent"],s),n}function e2(){return{}}function t2(){return{}}function _ee(t,e){const n={},r=b(e,["disabled"]);r!=null&&S(n,["disabled"],r);const s=b(e,["startOfSpeechSensitivity"]);s!=null&&S(n,["startOfSpeechSensitivity"],s);const i=b(e,["endOfSpeechSensitivity"]);i!=null&&S(n,["endOfSpeechSensitivity"],i);const o=b(e,["prefixPaddingMs"]);o!=null&&S(n,["prefixPaddingMs"],o);const l=b(e,["silenceDurationMs"]);return l!=null&&S(n,["silenceDurationMs"],l),n}function See(t,e){const n={},r=b(e,["disabled"]);r!=null&&S(n,["disabled"],r);const s=b(e,["startOfSpeechSensitivity"]);s!=null&&S(n,["startOfSpeechSensitivity"],s);const i=b(e,["endOfSpeechSensitivity"]);i!=null&&S(n,["endOfSpeechSensitivity"],i);const o=b(e,["prefixPaddingMs"]);o!=null&&S(n,["prefixPaddingMs"],o);const l=b(e,["silenceDurationMs"]);return l!=null&&S(n,["silenceDurationMs"],l),n}function Cee(t,e){const n={},r=b(e,["automaticActivityDetection"]);r!=null&&S(n,["automaticActivityDetection"],_ee(t,r));const s=b(e,["activityHandling"]);s!=null&&S(n,["activityHandling"],s);const i=b(e,["turnCoverage"]);return i!=null&&S(n,["turnCoverage"],i),n}function Eee(t,e){const n={},r=b(e,["automaticActivityDetection"]);r!=null&&S(n,["automaticActivityDetection"],See(t,r));const s=b(e,["activityHandling"]);s!=null&&S(n,["activityHandling"],s);const i=b(e,["turnCoverage"]);return i!=null&&S(n,["turnCoverage"],i),n}function Tee(t,e){const n={},r=b(e,["targetTokens"]);return r!=null&&S(n,["targetTokens"],r),n}function Iee(t,e){const n={},r=b(e,["targetTokens"]);return r!=null&&S(n,["targetTokens"],r),n}function Nee(t,e){const n={},r=b(e,["triggerTokens"]);r!=null&&S(n,["triggerTokens"],r);const s=b(e,["slidingWindow"]);return s!=null&&S(n,["slidingWindow"],Tee(t,s)),n}function Pee(t,e){const n={},r=b(e,["triggerTokens"]);r!=null&&S(n,["triggerTokens"],r);const s=b(e,["slidingWindow"]);return s!=null&&S(n,["slidingWindow"],Iee(t,s)),n}function Aee(t,e,n){const r={},s=b(e,["generationConfig"]);n!==void 0&&s!=null&&S(n,["setup","generationConfig"],s);const i=b(e,["responseModalities"]);n!==void 0&&i!=null&&S(n,["setup","generationConfig","responseModalities"],i);const o=b(e,["temperature"]);n!==void 0&&o!=null&&S(n,["setup","generationConfig","temperature"],o);const l=b(e,["topP"]);n!==void 0&&l!=null&&S(n,["setup","generationConfig","topP"],l);const c=b(e,["topK"]);n!==void 0&&c!=null&&S(n,["setup","generationConfig","topK"],c);const u=b(e,["maxOutputTokens"]);n!==void 0&&u!=null&&S(n,["setup","generationConfig","maxOutputTokens"],u);const d=b(e,["mediaResolution"]);n!==void 0&&d!=null&&S(n,["setup","generationConfig","mediaResolution"],d);const h=b(e,["seed"]);n!==void 0&&h!=null&&S(n,["setup","generationConfig","seed"],h);const f=b(e,["speechConfig"]);n!==void 0&&f!=null&&S(n,["setup","generationConfig","speechConfig"],f);const m=b(e,["systemInstruction"]);n!==void 0&&m!=null&&S(n,["setup","systemInstruction"],oee(t,hi(t,m)));const g=b(e,["tools"]);if(n!==void 0&&g!=null){let T=P0(t,g);Array.isArray(T)&&(T=T.map(j=>xee(t,N0(t,j)))),S(n,["setup","tools"],T)}const x=b(e,["sessionResumption"]);n!==void 0&&x!=null&&S(n,["setup","sessionResumption"],wee(t,x));const v=b(e,["inputAudioTranscription"]);n!==void 0&&v!=null&&S(n,["setup","inputAudioTranscription"],e2());const w=b(e,["outputAudioTranscription"]);n!==void 0&&w!=null&&S(n,["setup","outputAudioTranscription"],e2());const _=b(e,["realtimeInputConfig"]);n!==void 0&&_!=null&&S(n,["setup","realtimeInputConfig"],Cee(t,_));const C=b(e,["contextWindowCompression"]);return n!==void 0&&C!=null&&S(n,["setup","contextWindowCompression"],Nee(t,C)),r}function kee(t,e,n){const r={},s=b(e,["generationConfig"]);n!==void 0&&s!=null&&S(n,["setup","generationConfig"],s);const i=b(e,["responseModalities"]);n!==void 0&&i!=null&&S(n,["setup","generationConfig","responseModalities"],i);const o=b(e,["temperature"]);n!==void 0&&o!=null&&S(n,["setup","generationConfig","temperature"],o);const l=b(e,["topP"]);n!==void 0&&l!=null&&S(n,["setup","generationConfig","topP"],l);const c=b(e,["topK"]);n!==void 0&&c!=null&&S(n,["setup","generationConfig","topK"],c);const u=b(e,["maxOutputTokens"]);n!==void 0&&u!=null&&S(n,["setup","generationConfig","maxOutputTokens"],u);const d=b(e,["mediaResolution"]);n!==void 0&&d!=null&&S(n,["setup","generationConfig","mediaResolution"],d);const h=b(e,["seed"]);n!==void 0&&h!=null&&S(n,["setup","generationConfig","seed"],h);const f=b(e,["speechConfig"]);n!==void 0&&f!=null&&S(n,["setup","generationConfig","speechConfig"],f);const m=b(e,["systemInstruction"]);n!==void 0&&m!=null&&S(n,["setup","systemInstruction"],aee(t,hi(t,m)));const g=b(e,["tools"]);if(n!==void 0&&g!=null){let T=P0(t,g);Array.isArray(T)&&(T=T.map(j=>vee(t,N0(t,j)))),S(n,["setup","tools"],T)}const x=b(e,["sessionResumption"]);n!==void 0&&x!=null&&S(n,["setup","sessionResumption"],bee(t,x));const v=b(e,["inputAudioTranscription"]);n!==void 0&&v!=null&&S(n,["setup","inputAudioTranscription"],t2());const w=b(e,["outputAudioTranscription"]);n!==void 0&&w!=null&&S(n,["setup","outputAudioTranscription"],t2());const _=b(e,["realtimeInputConfig"]);n!==void 0&&_!=null&&S(n,["setup","realtimeInputConfig"],Eee(t,_));const C=b(e,["contextWindowCompression"]);return n!==void 0&&C!=null&&S(n,["setup","contextWindowCompression"],Pee(t,C)),r}function jee(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["setup","model"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],Aee(t,s,n)),n}function Ree(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["setup","model"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],kee(t,s,n)),n}function Dee(){return{}}function Mee(){return{}}function Lee(){return{}}function Fee(){return{}}function Oee(t,e){const n={},r=b(e,["media"]);r!=null&&S(n,["mediaChunks"],OV(t,r));const s=b(e,["audio"]);s!=null&&S(n,["audio"],FX(t,s));const i=b(e,["audioStreamEnd"]);i!=null&&S(n,["audioStreamEnd"],i);const o=b(e,["video"]);o!=null&&S(n,["video"],LX(t,o));const l=b(e,["text"]);return l!=null&&S(n,["text"],l),b(e,["activityStart"])!=null&&S(n,["activityStart"],Dee()),b(e,["activityEnd"])!=null&&S(n,["activityEnd"],Lee()),n}function $ee(t,e){const n={},r=b(e,["media"]);if(r!=null&&S(n,["mediaChunks"],OV(t,r)),b(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const s=b(e,["audioStreamEnd"]);if(s!=null&&S(n,["audioStreamEnd"],s),b(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(b(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return b(e,["activityStart"])!=null&&S(n,["activityStart"],Mee()),b(e,["activityEnd"])!=null&&S(n,["activityEnd"],Fee()),n}function Vee(){return{}}function Uee(){return{}}function Bee(t,e){const n={},r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function zee(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function Gee(t,e){const n={},r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],Bee(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function Wee(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],zee(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function Hee(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Gee(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function qee(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Wee(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function n2(t,e){const n={},r=b(e,["text"]);r!=null&&S(n,["text"],r);const s=b(e,["finished"]);return s!=null&&S(n,["finished"],s),n}function r2(t,e){const n={},r=b(e,["text"]);r!=null&&S(n,["text"],r);const s=b(e,["finished"]);return s!=null&&S(n,["finished"],s),n}function Kee(t,e){const n={},r=b(e,["modelTurn"]);r!=null&&S(n,["modelTurn"],Hee(t,r));const s=b(e,["turnComplete"]);s!=null&&S(n,["turnComplete"],s);const i=b(e,["interrupted"]);i!=null&&S(n,["interrupted"],i);const o=b(e,["groundingMetadata"]);o!=null&&S(n,["groundingMetadata"],o);const l=b(e,["generationComplete"]);l!=null&&S(n,["generationComplete"],l);const c=b(e,["inputTranscription"]);c!=null&&S(n,["inputTranscription"],n2(t,c));const u=b(e,["outputTranscription"]);return u!=null&&S(n,["outputTranscription"],n2(t,u)),n}function Yee(t,e){const n={},r=b(e,["modelTurn"]);r!=null&&S(n,["modelTurn"],qee(t,r));const s=b(e,["turnComplete"]);s!=null&&S(n,["turnComplete"],s);const i=b(e,["interrupted"]);i!=null&&S(n,["interrupted"],i);const o=b(e,["groundingMetadata"]);o!=null&&S(n,["groundingMetadata"],o);const l=b(e,["generationComplete"]);l!=null&&S(n,["generationComplete"],l);const c=b(e,["inputTranscription"]);c!=null&&S(n,["inputTranscription"],r2(t,c));const u=b(e,["outputTranscription"]);return u!=null&&S(n,["outputTranscription"],r2(t,u)),n}function Jee(t,e){const n={},r=b(e,["id"]);r!=null&&S(n,["id"],r);const s=b(e,["args"]);s!=null&&S(n,["args"],s);const i=b(e,["name"]);return i!=null&&S(n,["name"],i),n}function Qee(t,e){const n={},r=b(e,["args"]);r!=null&&S(n,["args"],r);const s=b(e,["name"]);return s!=null&&S(n,["name"],s),n}function Xee(t,e){const n={},r=b(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>Jee(t,i))),S(n,["functionCalls"],s)}return n}function Zee(t,e){const n={},r=b(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>Qee(t,i))),S(n,["functionCalls"],s)}return n}function ete(t,e){const n={},r=b(e,["ids"]);return r!=null&&S(n,["ids"],r),n}function tte(t,e){const n={},r=b(e,["ids"]);return r!=null&&S(n,["ids"],r),n}function $y(t,e){const n={},r=b(e,["modality"]);r!=null&&S(n,["modality"],r);const s=b(e,["tokenCount"]);return s!=null&&S(n,["tokenCount"],s),n}function Vy(t,e){const n={},r=b(e,["modality"]);r!=null&&S(n,["modality"],r);const s=b(e,["tokenCount"]);return s!=null&&S(n,["tokenCount"],s),n}function nte(t,e){const n={},r=b(e,["promptTokenCount"]);r!=null&&S(n,["promptTokenCount"],r);const s=b(e,["cachedContentTokenCount"]);s!=null&&S(n,["cachedContentTokenCount"],s);const i=b(e,["responseTokenCount"]);i!=null&&S(n,["responseTokenCount"],i);const o=b(e,["toolUsePromptTokenCount"]);o!=null&&S(n,["toolUsePromptTokenCount"],o);const l=b(e,["thoughtsTokenCount"]);l!=null&&S(n,["thoughtsTokenCount"],l);const c=b(e,["totalTokenCount"]);c!=null&&S(n,["totalTokenCount"],c);const u=b(e,["promptTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(g=>$y(t,g))),S(n,["promptTokensDetails"],m)}const d=b(e,["cacheTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(g=>$y(t,g))),S(n,["cacheTokensDetails"],m)}const h=b(e,["responseTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>$y(t,g))),S(n,["responseTokensDetails"],m)}const f=b(e,["toolUsePromptTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>$y(t,g))),S(n,["toolUsePromptTokensDetails"],m)}return n}function rte(t,e){const n={},r=b(e,["promptTokenCount"]);r!=null&&S(n,["promptTokenCount"],r);const s=b(e,["cachedContentTokenCount"]);s!=null&&S(n,["cachedContentTokenCount"],s);const i=b(e,["candidatesTokenCount"]);i!=null&&S(n,["responseTokenCount"],i);const o=b(e,["toolUsePromptTokenCount"]);o!=null&&S(n,["toolUsePromptTokenCount"],o);const l=b(e,["thoughtsTokenCount"]);l!=null&&S(n,["thoughtsTokenCount"],l);const c=b(e,["totalTokenCount"]);c!=null&&S(n,["totalTokenCount"],c);const u=b(e,["promptTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(x=>Vy(t,x))),S(n,["promptTokensDetails"],g)}const d=b(e,["cacheTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(x=>Vy(t,x))),S(n,["cacheTokensDetails"],g)}const h=b(e,["candidatesTokensDetails"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(x=>Vy(t,x))),S(n,["responseTokensDetails"],g)}const f=b(e,["toolUsePromptTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(x=>Vy(t,x))),S(n,["toolUsePromptTokensDetails"],g)}const m=b(e,["trafficType"]);return m!=null&&S(n,["trafficType"],m),n}function ste(t,e){const n={},r=b(e,["timeLeft"]);return r!=null&&S(n,["timeLeft"],r),n}function ite(t,e){const n={},r=b(e,["timeLeft"]);return r!=null&&S(n,["timeLeft"],r),n}function ote(t,e){const n={},r=b(e,["newHandle"]);r!=null&&S(n,["newHandle"],r);const s=b(e,["resumable"]);s!=null&&S(n,["resumable"],s);const i=b(e,["lastConsumedClientMessageIndex"]);return i!=null&&S(n,["lastConsumedClientMessageIndex"],i),n}function ate(t,e){const n={},r=b(e,["newHandle"]);r!=null&&S(n,["newHandle"],r);const s=b(e,["resumable"]);s!=null&&S(n,["resumable"],s);const i=b(e,["lastConsumedClientMessageIndex"]);return i!=null&&S(n,["lastConsumedClientMessageIndex"],i),n}function lte(t,e){const n={};b(e,["setupComplete"])!=null&&S(n,["setupComplete"],Vee());const s=b(e,["serverContent"]);s!=null&&S(n,["serverContent"],Kee(t,s));const i=b(e,["toolCall"]);i!=null&&S(n,["toolCall"],Xee(t,i));const o=b(e,["toolCallCancellation"]);o!=null&&S(n,["toolCallCancellation"],ete(t,o));const l=b(e,["usageMetadata"]);l!=null&&S(n,["usageMetadata"],nte(t,l));const c=b(e,["goAway"]);c!=null&&S(n,["goAway"],ste(t,c));const u=b(e,["sessionResumptionUpdate"]);return u!=null&&S(n,["sessionResumptionUpdate"],ote(t,u)),n}function cte(t,e){const n={};b(e,["setupComplete"])!=null&&S(n,["setupComplete"],Uee());const s=b(e,["serverContent"]);s!=null&&S(n,["serverContent"],Yee(t,s));const i=b(e,["toolCall"]);i!=null&&S(n,["toolCall"],Zee(t,i));const o=b(e,["toolCallCancellation"]);o!=null&&S(n,["toolCallCancellation"],tte(t,o));const l=b(e,["usageMetadata"]);l!=null&&S(n,["usageMetadata"],rte(t,l));const c=b(e,["goAway"]);c!=null&&S(n,["goAway"],ite(t,c));const u=b(e,["sessionResumptionUpdate"]);return u!=null&&S(n,["sessionResumptionUpdate"],ate(t,u)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ute(t,e){const n={};if(b(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function dte(t,e){const n={};if(b(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],ute(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function k0(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>dte(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function hte(t,e){const n={};if(b(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=b(e,["category"]);r!=null&&S(n,["category"],r);const s=b(e,["threshold"]);return s!=null&&S(n,["threshold"],s),n}function fte(){return{}}function mte(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function pte(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],mte(t,r)),n}function gte(t,e){const n={};if(b(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");b(e,["googleSearch"])!=null&&S(n,["googleSearch"],fte());const s=b(e,["googleSearchRetrieval"]);if(s!=null&&S(n,["googleSearchRetrieval"],pte(t,s)),b(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(b(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=b(e,["codeExecution"]);i!=null&&S(n,["codeExecution"],i);const o=b(e,["functionDeclarations"]);return o!=null&&S(n,["functionDeclarations"],o),n}function yte(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function xte(t,e){const n={},r=b(e,["functionCallingConfig"]);if(r!=null&&S(n,["functionCallingConfig"],yte(t,r)),b(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}function vte(t,e){const n={},r=b(e,["voiceName"]);return r!=null&&S(n,["voiceName"],r),n}function wte(t,e){const n={},r=b(e,["prebuiltVoiceConfig"]);return r!=null&&S(n,["prebuiltVoiceConfig"],vte(t,r)),n}function bte(t,e){const n={},r=b(e,["voiceConfig"]);r!=null&&S(n,["voiceConfig"],wte(t,r));const s=b(e,["languageCode"]);return s!=null&&S(n,["languageCode"],s),n}function _te(t,e){const n={},r=b(e,["includeThoughts"]);r!=null&&S(n,["includeThoughts"],r);const s=b(e,["thinkingBudget"]);return s!=null&&S(n,["thinkingBudget"],s),n}function Ste(t,e,n){const r={},s=b(e,["systemInstruction"]);n!==void 0&&s!=null&&S(n,["systemInstruction"],k0(t,hi(t,s)));const i=b(e,["temperature"]);i!=null&&S(r,["temperature"],i);const o=b(e,["topP"]);o!=null&&S(r,["topP"],o);const l=b(e,["topK"]);l!=null&&S(r,["topK"],l);const c=b(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const u=b(e,["maxOutputTokens"]);u!=null&&S(r,["maxOutputTokens"],u);const d=b(e,["stopSequences"]);d!=null&&S(r,["stopSequences"],d);const h=b(e,["responseLogprobs"]);h!=null&&S(r,["responseLogprobs"],h);const f=b(e,["logprobs"]);f!=null&&S(r,["logprobs"],f);const m=b(e,["presencePenalty"]);m!=null&&S(r,["presencePenalty"],m);const g=b(e,["frequencyPenalty"]);g!=null&&S(r,["frequencyPenalty"],g);const x=b(e,["seed"]);x!=null&&S(r,["seed"],x);const v=b(e,["responseMimeType"]);v!=null&&S(r,["responseMimeType"],v);const w=b(e,["responseSchema"]);if(w!=null&&S(r,["responseSchema"],UV(t,w)),b(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(b(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=b(e,["safetySettings"]);if(n!==void 0&&_!=null){let k=_;Array.isArray(k)&&(k=k.map(R=>hte(t,R))),S(n,["safetySettings"],k)}const C=b(e,["tools"]);if(n!==void 0&&C!=null){let k=P0(t,C);Array.isArray(k)&&(k=k.map(R=>gte(t,N0(t,R)))),S(n,["tools"],k)}const T=b(e,["toolConfig"]);if(n!==void 0&&T!=null&&S(n,["toolConfig"],xte(t,T)),b(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const j=b(e,["cachedContent"]);n!==void 0&&j!=null&&S(n,["cachedContent"],Lc(t,j));const A=b(e,["responseModalities"]);A!=null&&S(r,["responseModalities"],A);const E=b(e,["mediaResolution"]);E!=null&&S(r,["mediaResolution"],E);const I=b(e,["speechConfig"]);if(I!=null&&S(r,["speechConfig"],bte(t,BV(t,I))),b(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=b(e,["thinkingConfig"]);return N!=null&&S(r,["thinkingConfig"],_te(t,N)),r}function s2(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);if(s!=null){let o=Mc(t,s);Array.isArray(o)&&(o=o.map(l=>k0(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["generationConfig"],Ste(t,i,n)),n}function Cte(t,e,n){const r={},s=b(e,["taskType"]);n!==void 0&&s!=null&&S(n,["requests[]","taskType"],s);const i=b(e,["title"]);n!==void 0&&i!=null&&S(n,["requests[]","title"],i);const o=b(e,["outputDimensionality"]);if(n!==void 0&&o!=null&&S(n,["requests[]","outputDimensionality"],o),b(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(b(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function Ete(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);s!=null&&S(n,["requests[]","content"],VV(t,s));const i=b(e,["config"]);i!=null&&S(n,["config"],Cte(t,i,n));const o=b(e,["model"]);return o!==void 0&&S(n,["requests[]","model"],or(t,o)),n}function Tte(t,e,n){const r={};if(b(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(b(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=b(e,["numberOfImages"]);n!==void 0&&s!=null&&S(n,["parameters","sampleCount"],s);const i=b(e,["aspectRatio"]);n!==void 0&&i!=null&&S(n,["parameters","aspectRatio"],i);const o=b(e,["guidanceScale"]);if(n!==void 0&&o!=null&&S(n,["parameters","guidanceScale"],o),b(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=b(e,["safetyFilterLevel"]);n!==void 0&&l!=null&&S(n,["parameters","safetySetting"],l);const c=b(e,["personGeneration"]);n!==void 0&&c!=null&&S(n,["parameters","personGeneration"],c);const u=b(e,["includeSafetyAttributes"]);n!==void 0&&u!=null&&S(n,["parameters","includeSafetyAttributes"],u);const d=b(e,["includeRaiReason"]);n!==void 0&&d!=null&&S(n,["parameters","includeRaiReason"],d);const h=b(e,["language"]);n!==void 0&&h!=null&&S(n,["parameters","language"],h);const f=b(e,["outputMimeType"]);n!==void 0&&f!=null&&S(n,["parameters","outputOptions","mimeType"],f);const m=b(e,["outputCompressionQuality"]);if(n!==void 0&&m!=null&&S(n,["parameters","outputOptions","compressionQuality"],m),b(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(b(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function Ite(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["config"]);return i!=null&&S(n,["config"],Tte(t,i,n)),n}function Nte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Pte(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);n!==void 0&&o!=null&&S(n,["_query","filter"],o);const l=b(e,["queryBase"]);return n!==void 0&&l!=null&&S(n,["_url","models_url"],WV(t,l)),r}function Ate(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],Pte(t,r,n)),n}function kte(t,e,n){const r={},s=b(e,["displayName"]);n!==void 0&&s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);n!==void 0&&i!=null&&S(n,["description"],i);const o=b(e,["defaultCheckpointId"]);return n!==void 0&&o!=null&&S(n,["defaultCheckpointId"],o),r}function jte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],kte(t,s,n)),n}function Rte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Dte(t,e){const n={};if(b(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(b(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(b(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return n}function Mte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);if(s!=null){let o=Mc(t,s);Array.isArray(o)&&(o=o.map(l=>k0(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["config"],Dte(t,i)),n}function Lte(t,e){const n={};if(b(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=b(e,["imageBytes"]);r!=null&&S(n,["bytesBase64Encoded"],Fc(t,r));const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function Fte(t,e,n){const r={},s=b(e,["numberOfVideos"]);if(n!==void 0&&s!=null&&S(n,["parameters","sampleCount"],s),b(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(b(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=b(e,["durationSeconds"]);if(n!==void 0&&i!=null&&S(n,["parameters","durationSeconds"],i),b(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=b(e,["aspectRatio"]);if(n!==void 0&&o!=null&&S(n,["parameters","aspectRatio"],o),b(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=b(e,["personGeneration"]);if(n!==void 0&&l!=null&&S(n,["parameters","personGeneration"],l),b(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=b(e,["negativePrompt"]);if(n!==void 0&&c!=null&&S(n,["parameters","negativePrompt"],c),b(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function Ote(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["image"]);i!=null&&S(n,["instances[0]","image"],Lte(t,i));const o=b(e,["config"]);return o!=null&&S(n,["config"],Fte(t,o,n)),n}function $te(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function Vte(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],$te(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function wf(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Vte(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function Ute(t,e){const n={},r=b(e,["featureSelectionPreference"]);return r!=null&&S(n,["featureSelectionPreference"],r),n}function Bte(t,e){const n={},r=b(e,["method"]);r!=null&&S(n,["method"],r);const s=b(e,["category"]);s!=null&&S(n,["category"],s);const i=b(e,["threshold"]);return i!=null&&S(n,["threshold"],i),n}function zte(){return{}}function Gte(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function Wte(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],Gte(t,r)),n}function Hte(){return{}}function qte(t,e){const n={},r=b(e,["apiKeyString"]);return r!=null&&S(n,["apiKeyString"],r),n}function Kte(t,e){const n={},r=b(e,["apiKeyConfig"]);r!=null&&S(n,["apiKeyConfig"],qte(t,r));const s=b(e,["authType"]);s!=null&&S(n,["authType"],s);const i=b(e,["googleServiceAccountConfig"]);i!=null&&S(n,["googleServiceAccountConfig"],i);const o=b(e,["httpBasicAuthConfig"]);o!=null&&S(n,["httpBasicAuthConfig"],o);const l=b(e,["oauthConfig"]);l!=null&&S(n,["oauthConfig"],l);const c=b(e,["oidcConfig"]);return c!=null&&S(n,["oidcConfig"],c),n}function Yte(t,e){const n={},r=b(e,["authConfig"]);return r!=null&&S(n,["authConfig"],Kte(t,r)),n}function KV(t,e){const n={},r=b(e,["retrieval"]);r!=null&&S(n,["retrieval"],r),b(e,["googleSearch"])!=null&&S(n,["googleSearch"],zte());const i=b(e,["googleSearchRetrieval"]);i!=null&&S(n,["googleSearchRetrieval"],Wte(t,i)),b(e,["enterpriseWebSearch"])!=null&&S(n,["enterpriseWebSearch"],Hte());const l=b(e,["googleMaps"]);l!=null&&S(n,["googleMaps"],Yte(t,l));const c=b(e,["codeExecution"]);c!=null&&S(n,["codeExecution"],c);const u=b(e,["functionDeclarations"]);return u!=null&&S(n,["functionDeclarations"],u),n}function Jte(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function Qte(t,e){const n={},r=b(e,["latitude"]);r!=null&&S(n,["latitude"],r);const s=b(e,["longitude"]);return s!=null&&S(n,["longitude"],s),n}function Xte(t,e){const n={},r=b(e,["latLng"]);return r!=null&&S(n,["latLng"],Qte(t,r)),n}function Zte(t,e){const n={},r=b(e,["functionCallingConfig"]);r!=null&&S(n,["functionCallingConfig"],Jte(t,r));const s=b(e,["retrievalConfig"]);return s!=null&&S(n,["retrievalConfig"],Xte(t,s)),n}function ene(t,e){const n={},r=b(e,["voiceName"]);return r!=null&&S(n,["voiceName"],r),n}function tne(t,e){const n={},r=b(e,["prebuiltVoiceConfig"]);return r!=null&&S(n,["prebuiltVoiceConfig"],ene(t,r)),n}function nne(t,e){const n={},r=b(e,["voiceConfig"]);r!=null&&S(n,["voiceConfig"],tne(t,r));const s=b(e,["languageCode"]);return s!=null&&S(n,["languageCode"],s),n}function rne(t,e){const n={},r=b(e,["includeThoughts"]);r!=null&&S(n,["includeThoughts"],r);const s=b(e,["thinkingBudget"]);return s!=null&&S(n,["thinkingBudget"],s),n}function sne(t,e,n){const r={},s=b(e,["systemInstruction"]);n!==void 0&&s!=null&&S(n,["systemInstruction"],wf(t,hi(t,s)));const i=b(e,["temperature"]);i!=null&&S(r,["temperature"],i);const o=b(e,["topP"]);o!=null&&S(r,["topP"],o);const l=b(e,["topK"]);l!=null&&S(r,["topK"],l);const c=b(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const u=b(e,["maxOutputTokens"]);u!=null&&S(r,["maxOutputTokens"],u);const d=b(e,["stopSequences"]);d!=null&&S(r,["stopSequences"],d);const h=b(e,["responseLogprobs"]);h!=null&&S(r,["responseLogprobs"],h);const f=b(e,["logprobs"]);f!=null&&S(r,["logprobs"],f);const m=b(e,["presencePenalty"]);m!=null&&S(r,["presencePenalty"],m);const g=b(e,["frequencyPenalty"]);g!=null&&S(r,["frequencyPenalty"],g);const x=b(e,["seed"]);x!=null&&S(r,["seed"],x);const v=b(e,["responseMimeType"]);v!=null&&S(r,["responseMimeType"],v);const w=b(e,["responseSchema"]);w!=null&&S(r,["responseSchema"],UV(t,w));const _=b(e,["routingConfig"]);_!=null&&S(r,["routingConfig"],_);const C=b(e,["modelSelectionConfig"]);C!=null&&S(r,["modelConfig"],Ute(t,C));const T=b(e,["safetySettings"]);if(n!==void 0&&T!=null){let z=T;Array.isArray(z)&&(z=z.map(B=>Bte(t,B))),S(n,["safetySettings"],z)}const j=b(e,["tools"]);if(n!==void 0&&j!=null){let z=P0(t,j);Array.isArray(z)&&(z=z.map(B=>KV(t,N0(t,B)))),S(n,["tools"],z)}const A=b(e,["toolConfig"]);n!==void 0&&A!=null&&S(n,["toolConfig"],Zte(t,A));const E=b(e,["labels"]);n!==void 0&&E!=null&&S(n,["labels"],E);const I=b(e,["cachedContent"]);n!==void 0&&I!=null&&S(n,["cachedContent"],Lc(t,I));const N=b(e,["responseModalities"]);N!=null&&S(r,["responseModalities"],N);const k=b(e,["mediaResolution"]);k!=null&&S(r,["mediaResolution"],k);const R=b(e,["speechConfig"]);R!=null&&S(r,["speechConfig"],nne(t,BV(t,R)));const D=b(e,["audioTimestamp"]);D!=null&&S(r,["audioTimestamp"],D);const M=b(e,["thinkingConfig"]);return M!=null&&S(r,["thinkingConfig"],rne(t,M)),r}function i2(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);if(s!=null){let o=Mc(t,s);Array.isArray(o)&&(o=o.map(l=>wf(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["generationConfig"],sne(t,i,n)),n}function ine(t,e,n){const r={},s=b(e,["taskType"]);n!==void 0&&s!=null&&S(n,["instances[]","task_type"],s);const i=b(e,["title"]);n!==void 0&&i!=null&&S(n,["instances[]","title"],i);const o=b(e,["outputDimensionality"]);n!==void 0&&o!=null&&S(n,["parameters","outputDimensionality"],o);const l=b(e,["mimeType"]);n!==void 0&&l!=null&&S(n,["instances[]","mimeType"],l);const c=b(e,["autoTruncate"]);return n!==void 0&&c!=null&&S(n,["parameters","autoTruncate"],c),r}function one(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);s!=null&&S(n,["instances[]","content"],VV(t,s));const i=b(e,["config"]);return i!=null&&S(n,["config"],ine(t,i,n)),n}function ane(t,e,n){const r={},s=b(e,["outputGcsUri"]);n!==void 0&&s!=null&&S(n,["parameters","storageUri"],s);const i=b(e,["negativePrompt"]);n!==void 0&&i!=null&&S(n,["parameters","negativePrompt"],i);const o=b(e,["numberOfImages"]);n!==void 0&&o!=null&&S(n,["parameters","sampleCount"],o);const l=b(e,["aspectRatio"]);n!==void 0&&l!=null&&S(n,["parameters","aspectRatio"],l);const c=b(e,["guidanceScale"]);n!==void 0&&c!=null&&S(n,["parameters","guidanceScale"],c);const u=b(e,["seed"]);n!==void 0&&u!=null&&S(n,["parameters","seed"],u);const d=b(e,["safetyFilterLevel"]);n!==void 0&&d!=null&&S(n,["parameters","safetySetting"],d);const h=b(e,["personGeneration"]);n!==void 0&&h!=null&&S(n,["parameters","personGeneration"],h);const f=b(e,["includeSafetyAttributes"]);n!==void 0&&f!=null&&S(n,["parameters","includeSafetyAttributes"],f);const m=b(e,["includeRaiReason"]);n!==void 0&&m!=null&&S(n,["parameters","includeRaiReason"],m);const g=b(e,["language"]);n!==void 0&&g!=null&&S(n,["parameters","language"],g);const x=b(e,["outputMimeType"]);n!==void 0&&x!=null&&S(n,["parameters","outputOptions","mimeType"],x);const v=b(e,["outputCompressionQuality"]);n!==void 0&&v!=null&&S(n,["parameters","outputOptions","compressionQuality"],v);const w=b(e,["addWatermark"]);n!==void 0&&w!=null&&S(n,["parameters","addWatermark"],w);const _=b(e,["enhancePrompt"]);return n!==void 0&&_!=null&&S(n,["parameters","enhancePrompt"],_),r}function lne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["config"]);return i!=null&&S(n,["config"],ane(t,i,n)),n}function yI(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["gcsUri"],r);const s=b(e,["imageBytes"]);s!=null&&S(n,["bytesBase64Encoded"],Fc(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function cne(t,e){const n={},r=b(e,["maskMode"]);r!=null&&S(n,["maskMode"],r);const s=b(e,["segmentationClasses"]);s!=null&&S(n,["maskClasses"],s);const i=b(e,["maskDilation"]);return i!=null&&S(n,["dilation"],i),n}function une(t,e){const n={},r=b(e,["controlType"]);r!=null&&S(n,["controlType"],r);const s=b(e,["enableControlImageComputation"]);return s!=null&&S(n,["computeControl"],s),n}function dne(t,e){const n={},r=b(e,["styleDescription"]);return r!=null&&S(n,["styleDescription"],r),n}function hne(t,e){const n={},r=b(e,["subjectType"]);r!=null&&S(n,["subjectType"],r);const s=b(e,["subjectDescription"]);return s!=null&&S(n,["subjectDescription"],s),n}function fne(t,e){const n={},r=b(e,["referenceImage"]);r!=null&&S(n,["referenceImage"],yI(t,r));const s=b(e,["referenceId"]);s!=null&&S(n,["referenceId"],s);const i=b(e,["referenceType"]);i!=null&&S(n,["referenceType"],i);const o=b(e,["maskImageConfig"]);o!=null&&S(n,["maskImageConfig"],cne(t,o));const l=b(e,["controlImageConfig"]);l!=null&&S(n,["controlImageConfig"],une(t,l));const c=b(e,["styleImageConfig"]);c!=null&&S(n,["styleImageConfig"],dne(t,c));const u=b(e,["subjectImageConfig"]);return u!=null&&S(n,["subjectImageConfig"],hne(t,u)),n}function mne(t,e,n){const r={},s=b(e,["outputGcsUri"]);n!==void 0&&s!=null&&S(n,["parameters","storageUri"],s);const i=b(e,["negativePrompt"]);n!==void 0&&i!=null&&S(n,["parameters","negativePrompt"],i);const o=b(e,["numberOfImages"]);n!==void 0&&o!=null&&S(n,["parameters","sampleCount"],o);const l=b(e,["aspectRatio"]);n!==void 0&&l!=null&&S(n,["parameters","aspectRatio"],l);const c=b(e,["guidanceScale"]);n!==void 0&&c!=null&&S(n,["parameters","guidanceScale"],c);const u=b(e,["seed"]);n!==void 0&&u!=null&&S(n,["parameters","seed"],u);const d=b(e,["safetyFilterLevel"]);n!==void 0&&d!=null&&S(n,["parameters","safetySetting"],d);const h=b(e,["personGeneration"]);n!==void 0&&h!=null&&S(n,["parameters","personGeneration"],h);const f=b(e,["includeSafetyAttributes"]);n!==void 0&&f!=null&&S(n,["parameters","includeSafetyAttributes"],f);const m=b(e,["includeRaiReason"]);n!==void 0&&m!=null&&S(n,["parameters","includeRaiReason"],m);const g=b(e,["language"]);n!==void 0&&g!=null&&S(n,["parameters","language"],g);const x=b(e,["outputMimeType"]);n!==void 0&&x!=null&&S(n,["parameters","outputOptions","mimeType"],x);const v=b(e,["outputCompressionQuality"]);n!==void 0&&v!=null&&S(n,["parameters","outputOptions","compressionQuality"],v);const w=b(e,["editMode"]);n!==void 0&&w!=null&&S(n,["parameters","editMode"],w);const _=b(e,["baseSteps"]);return n!==void 0&&_!=null&&S(n,["parameters","editConfig","baseSteps"],_),r}function pne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["referenceImages"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>fne(t,c))),S(n,["instances[0]","referenceImages"],l)}const o=b(e,["config"]);return o!=null&&S(n,["config"],mne(t,o,n)),n}function gne(t,e,n){const r={},s=b(e,["includeRaiReason"]);n!==void 0&&s!=null&&S(n,["parameters","includeRaiReason"],s);const i=b(e,["outputMimeType"]);n!==void 0&&i!=null&&S(n,["parameters","outputOptions","mimeType"],i);const o=b(e,["outputCompressionQuality"]);n!==void 0&&o!=null&&S(n,["parameters","outputOptions","compressionQuality"],o);const l=b(e,["numberOfImages"]);n!==void 0&&l!=null&&S(n,["parameters","sampleCount"],l);const c=b(e,["mode"]);return n!==void 0&&c!=null&&S(n,["parameters","mode"],c),r}function yne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["image"]);s!=null&&S(n,["instances[0]","image"],yI(t,s));const i=b(e,["upscaleFactor"]);i!=null&&S(n,["parameters","upscaleConfig","upscaleFactor"],i);const o=b(e,["config"]);return o!=null&&S(n,["config"],gne(t,o,n)),n}function xne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function vne(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);n!==void 0&&o!=null&&S(n,["_query","filter"],o);const l=b(e,["queryBase"]);return n!==void 0&&l!=null&&S(n,["_url","models_url"],WV(t,l)),r}function wne(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],vne(t,r,n)),n}function bne(t,e,n){const r={},s=b(e,["displayName"]);n!==void 0&&s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);n!==void 0&&i!=null&&S(n,["description"],i);const o=b(e,["defaultCheckpointId"]);return n!==void 0&&o!=null&&S(n,["defaultCheckpointId"],o),r}function _ne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],bne(t,s,n)),n}function Sne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Cne(t,e,n){const r={},s=b(e,["systemInstruction"]);n!==void 0&&s!=null&&S(n,["systemInstruction"],wf(t,hi(t,s)));const i=b(e,["tools"]);if(n!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>KV(t,c))),S(n,["tools"],l)}const o=b(e,["generationConfig"]);return n!==void 0&&o!=null&&S(n,["generationConfig"],o),r}function Ene(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);if(s!=null){let o=Mc(t,s);Array.isArray(o)&&(o=o.map(l=>wf(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["config"],Cne(t,i,n)),n}function Tne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);if(s!=null){let o=Mc(t,s);Array.isArray(o)&&(o=o.map(l=>wf(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["config"],i),n}function Ine(t,e,n){const r={},s=b(e,["numberOfVideos"]);n!==void 0&&s!=null&&S(n,["parameters","sampleCount"],s);const i=b(e,["outputGcsUri"]);n!==void 0&&i!=null&&S(n,["parameters","storageUri"],i);const o=b(e,["fps"]);n!==void 0&&o!=null&&S(n,["parameters","fps"],o);const l=b(e,["durationSeconds"]);n!==void 0&&l!=null&&S(n,["parameters","durationSeconds"],l);const c=b(e,["seed"]);n!==void 0&&c!=null&&S(n,["parameters","seed"],c);const u=b(e,["aspectRatio"]);n!==void 0&&u!=null&&S(n,["parameters","aspectRatio"],u);const d=b(e,["resolution"]);n!==void 0&&d!=null&&S(n,["parameters","resolution"],d);const h=b(e,["personGeneration"]);n!==void 0&&h!=null&&S(n,["parameters","personGeneration"],h);const f=b(e,["pubsubTopic"]);n!==void 0&&f!=null&&S(n,["parameters","pubsubTopic"],f);const m=b(e,["negativePrompt"]);n!==void 0&&m!=null&&S(n,["parameters","negativePrompt"],m);const g=b(e,["enhancePrompt"]);return n!==void 0&&g!=null&&S(n,["parameters","enhancePrompt"],g),r}function Nne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["image"]);i!=null&&S(n,["instances[0]","image"],yI(t,i));const o=b(e,["config"]);return o!=null&&S(n,["config"],Ine(t,o,n)),n}function Pne(t,e){const n={},r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function Ane(t,e){const n={},r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],Pne(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function kne(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Ane(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function jne(t,e){const n={},r=b(e,["citationSources"]);return r!=null&&S(n,["citations"],r),n}function Rne(t,e){const n={},r=b(e,["content"]);r!=null&&S(n,["content"],kne(t,r));const s=b(e,["citationMetadata"]);s!=null&&S(n,["citationMetadata"],jne(t,s));const i=b(e,["tokenCount"]);i!=null&&S(n,["tokenCount"],i);const o=b(e,["finishReason"]);o!=null&&S(n,["finishReason"],o);const l=b(e,["avgLogprobs"]);l!=null&&S(n,["avgLogprobs"],l);const c=b(e,["groundingMetadata"]);c!=null&&S(n,["groundingMetadata"],c);const u=b(e,["index"]);u!=null&&S(n,["index"],u);const d=b(e,["logprobsResult"]);d!=null&&S(n,["logprobsResult"],d);const h=b(e,["safetyRatings"]);return h!=null&&S(n,["safetyRatings"],h),n}function o2(t,e){const n={},r=b(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>Rne(t,c))),S(n,["candidates"],l)}const s=b(e,["modelVersion"]);s!=null&&S(n,["modelVersion"],s);const i=b(e,["promptFeedback"]);i!=null&&S(n,["promptFeedback"],i);const o=b(e,["usageMetadata"]);return o!=null&&S(n,["usageMetadata"],o),n}function Dne(t,e){const n={},r=b(e,["values"]);return r!=null&&S(n,["values"],r),n}function Mne(){return{}}function Lne(t,e){const n={},r=b(e,["embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Dne(t,o))),S(n,["embeddings"],i)}return b(e,["metadata"])!=null&&S(n,["metadata"],Mne()),n}function Fne(t,e){const n={},r=b(e,["bytesBase64Encoded"]);r!=null&&S(n,["imageBytes"],Fc(t,r));const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function YV(t,e){const n={},r=b(e,["safetyAttributes","categories"]);r!=null&&S(n,["categories"],r);const s=b(e,["safetyAttributes","scores"]);s!=null&&S(n,["scores"],s);const i=b(e,["contentType"]);return i!=null&&S(n,["contentType"],i),n}function One(t,e){const n={},r=b(e,["_self"]);r!=null&&S(n,["image"],Fne(t,r));const s=b(e,["raiFilteredReason"]);s!=null&&S(n,["raiFilteredReason"],s);const i=b(e,["_self"]);return i!=null&&S(n,["safetyAttributes"],YV(t,i)),n}function $ne(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>One(t,o))),S(n,["generatedImages"],i)}const s=b(e,["positivePromptSafetyAttributes"]);return s!=null&&S(n,["positivePromptSafetyAttributes"],YV(t,s)),n}function Vne(t,e){const n={},r=b(e,["baseModel"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["createTime"]);s!=null&&S(n,["createTime"],s);const i=b(e,["updateTime"]);return i!=null&&S(n,["updateTime"],i),n}function wE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);i!=null&&S(n,["description"],i);const o=b(e,["version"]);o!=null&&S(n,["version"],o);const l=b(e,["_self"]);l!=null&&S(n,["tunedModelInfo"],Vne(t,l));const c=b(e,["inputTokenLimit"]);c!=null&&S(n,["inputTokenLimit"],c);const u=b(e,["outputTokenLimit"]);u!=null&&S(n,["outputTokenLimit"],u);const d=b(e,["supportedGenerationMethods"]);return d!=null&&S(n,["supportedActions"],d),n}function Une(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["_self"]);if(s!=null){let i=HV(t,s);Array.isArray(i)&&(i=i.map(o=>wE(t,o))),S(n,["models"],i)}return n}function Bne(){return{}}function zne(t,e){const n={},r=b(e,["totalTokens"]);r!=null&&S(n,["totalTokens"],r);const s=b(e,["cachedContentTokenCount"]);return s!=null&&S(n,["cachedContentTokenCount"],s),n}function Gne(t,e){const n={},r=b(e,["video","uri"]);r!=null&&S(n,["uri"],r);const s=b(e,["video","encodedVideo"]);s!=null&&S(n,["videoBytes"],Fc(t,s));const i=b(e,["encoding"]);return i!=null&&S(n,["mimeType"],i),n}function Wne(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],Gne(t,r)),n}function Hne(t,e){const n={},r=b(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Wne(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function qne(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response","generateVideoResponse"]);return l!=null&&S(n,["response"],Hne(t,l)),n}function Kne(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function Yne(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],Kne(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function Jne(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Yne(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function Qne(t,e){const n={},r=b(e,["citations"]);return r!=null&&S(n,["citations"],r),n}function Xne(t,e){const n={},r=b(e,["content"]);r!=null&&S(n,["content"],Jne(t,r));const s=b(e,["citationMetadata"]);s!=null&&S(n,["citationMetadata"],Qne(t,s));const i=b(e,["finishMessage"]);i!=null&&S(n,["finishMessage"],i);const o=b(e,["finishReason"]);o!=null&&S(n,["finishReason"],o);const l=b(e,["avgLogprobs"]);l!=null&&S(n,["avgLogprobs"],l);const c=b(e,["groundingMetadata"]);c!=null&&S(n,["groundingMetadata"],c);const u=b(e,["index"]);u!=null&&S(n,["index"],u);const d=b(e,["logprobsResult"]);d!=null&&S(n,["logprobsResult"],d);const h=b(e,["safetyRatings"]);return h!=null&&S(n,["safetyRatings"],h),n}function a2(t,e){const n={},r=b(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>Xne(t,d))),S(n,["candidates"],u)}const s=b(e,["createTime"]);s!=null&&S(n,["createTime"],s);const i=b(e,["responseId"]);i!=null&&S(n,["responseId"],i);const o=b(e,["modelVersion"]);o!=null&&S(n,["modelVersion"],o);const l=b(e,["promptFeedback"]);l!=null&&S(n,["promptFeedback"],l);const c=b(e,["usageMetadata"]);return c!=null&&S(n,["usageMetadata"],c),n}function Zne(t,e){const n={},r=b(e,["truncated"]);r!=null&&S(n,["truncated"],r);const s=b(e,["token_count"]);return s!=null&&S(n,["tokenCount"],s),n}function ere(t,e){const n={},r=b(e,["values"]);r!=null&&S(n,["values"],r);const s=b(e,["statistics"]);return s!=null&&S(n,["statistics"],Zne(t,s)),n}function tre(t,e){const n={},r=b(e,["billableCharacterCount"]);return r!=null&&S(n,["billableCharacterCount"],r),n}function nre(t,e){const n={},r=b(e,["predictions[]","embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>ere(t,o))),S(n,["embeddings"],i)}const s=b(e,["metadata"]);return s!=null&&S(n,["metadata"],tre(t,s)),n}function rre(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["gcsUri"],r);const s=b(e,["bytesBase64Encoded"]);s!=null&&S(n,["imageBytes"],Fc(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function JV(t,e){const n={},r=b(e,["safetyAttributes","categories"]);r!=null&&S(n,["categories"],r);const s=b(e,["safetyAttributes","scores"]);s!=null&&S(n,["scores"],s);const i=b(e,["contentType"]);return i!=null&&S(n,["contentType"],i),n}function xI(t,e){const n={},r=b(e,["_self"]);r!=null&&S(n,["image"],rre(t,r));const s=b(e,["raiFilteredReason"]);s!=null&&S(n,["raiFilteredReason"],s);const i=b(e,["_self"]);i!=null&&S(n,["safetyAttributes"],JV(t,i));const o=b(e,["prompt"]);return o!=null&&S(n,["enhancedPrompt"],o),n}function sre(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>xI(t,o))),S(n,["generatedImages"],i)}const s=b(e,["positivePromptSafetyAttributes"]);return s!=null&&S(n,["positivePromptSafetyAttributes"],JV(t,s)),n}function ire(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>xI(t,i))),S(n,["generatedImages"],s)}return n}function ore(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>xI(t,i))),S(n,["generatedImages"],s)}return n}function are(t,e){const n={},r=b(e,["endpoint"]);r!=null&&S(n,["name"],r);const s=b(e,["deployedModelId"]);return s!=null&&S(n,["deployedModelId"],s),n}function lre(t,e){const n={},r=b(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["createTime"]);s!=null&&S(n,["createTime"],s);const i=b(e,["updateTime"]);return i!=null&&S(n,["updateTime"],i),n}function cre(t,e){const n={},r=b(e,["checkpointId"]);r!=null&&S(n,["checkpointId"],r);const s=b(e,["epoch"]);s!=null&&S(n,["epoch"],s);const i=b(e,["step"]);return i!=null&&S(n,["step"],i),n}function bE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);i!=null&&S(n,["description"],i);const o=b(e,["versionId"]);o!=null&&S(n,["version"],o);const l=b(e,["deployedModels"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(m=>are(t,m))),S(n,["endpoints"],f)}const c=b(e,["labels"]);c!=null&&S(n,["labels"],c);const u=b(e,["_self"]);u!=null&&S(n,["tunedModelInfo"],lre(t,u));const d=b(e,["defaultCheckpointId"]);d!=null&&S(n,["defaultCheckpointId"],d);const h=b(e,["checkpoints"]);if(h!=null){let f=h;Array.isArray(f)&&(f=f.map(m=>cre(t,m))),S(n,["checkpoints"],f)}return n}function ure(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["_self"]);if(s!=null){let i=HV(t,s);Array.isArray(i)&&(i=i.map(o=>bE(t,o))),S(n,["models"],i)}return n}function dre(){return{}}function hre(t,e){const n={},r=b(e,["totalTokens"]);return r!=null&&S(n,["totalTokens"],r),n}function fre(t,e){const n={},r=b(e,["tokensInfo"]);return r!=null&&S(n,["tokensInfo"],r),n}function mre(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["uri"],r);const s=b(e,["bytesBase64Encoded"]);s!=null&&S(n,["videoBytes"],Fc(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function pre(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],mre(t,r)),n}function gre(t,e){const n={},r=b(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>pre(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function yre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response"]);return l!=null&&S(n,["response"],gre(t,l)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xre="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function vre(t,e,n){const r=new FZ;let s;if(n.data instanceof Blob?s=JSON.parse(await n.data.text()):s=JSON.parse(n.data),t.isVertexAI()){const i=cte(t,s);Object.assign(r,i)}else{const i=lte(t,s);Object.assign(r,i)}e(r)}class wre{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r,s,i;const o=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion();let c;const u=Cre(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())c=`${o}/ws/google.cloud.aiplatform.${l}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const T=this.apiClient.getApiKey();c=`${o}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateContent?key=${T}`}let d=()=>{};const h=new Promise(T=>{d=T}),f=e.callbacks,m=function(){var T;(T=f==null?void 0:f.onopen)===null||T===void 0||T.call(f),d({})},g=this.apiClient,x={onopen:m,onmessage:T=>{vre(g,f.onmessage,T)},onerror:(n=f==null?void 0:f.onerror)!==null&&n!==void 0?n:function(T){},onclose:(r=f==null?void 0:f.onclose)!==null&&r!==void 0?r:function(T){}},v=this.webSocketFactory.create(c,Sre(u),x);v.connect(),await h;let w=or(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&w.startsWith("publishers/")){const T=this.apiClient.getProject(),j=this.apiClient.getLocation();w=`projects/${T}/locations/${j}/`+w}let _={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[wn.AUDIO]}:e.config.responseModalities=[wn.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const C={model:w,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?_=Ree(this.apiClient,C):_=jee(this.apiClient,C),delete _.config,v.send(JSON.stringify(_)),new _re(v,this.apiClient)}}const bre={turnComplete:!0};class _re{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Mc(e,n.turns),e.isVertexAI()?r=r.map(s=>wf(e,s)):r=r.map(s=>k0(e,s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(xre)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},bre),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:$ee(this.apiClient,e)}:n={realtimeInput:Oee(this.apiClient,e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function Sre(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function Cre(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Ere=class extends wg{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>await this.generateContentInternal(n),this.generateContentStream=async n=>await this.generateContentStreamInternal(n),this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var s;let i;const o=[];if(r!=null&&r.generatedImages)for(const c of r.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((s=c==null?void 0:c.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?i=c==null?void 0:c.safetyAttributes:o.push(c);let l;return i?l={generatedImages:o,positivePromptSafetyAttributes:i}:l={generatedImages:o},l}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new A0(Gh.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const s={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(s)}}async generateContentInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=i2(this.apiClient,e);return l=qt("{model}:generateContent",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=a2(this.apiClient,d),f=new Oy;return Object.assign(f,h),f})}else{const u=s2(this.apiClient,e);return l=qt("{model}:generateContent",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=o2(this.apiClient,d),f=new Oy;return Object.assign(f,h),f})}}async generateContentStreamInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=i2(this.apiClient,e);l=qt("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const d=this.apiClient;return o=d.requestStream({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(h){return Qv(this,arguments,function*(){var f,m,g,x;try{for(var v=!0,w=xE(h),_;_=yield Ps(w.next()),f=_.done,!f;v=!0){x=_.value,v=!1;const T=a2(d,yield Ps(x.json())),j=new Oy;Object.assign(j,T),yield yield Ps(j)}}catch(C){m={error:C}}finally{try{!v&&!f&&(g=w.return)&&(yield Ps(g.call(w)))}finally{if(m)throw m.error}}})})}else{const u=s2(this.apiClient,e);l=qt("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const d=this.apiClient;return o=d.requestStream({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(h){return Qv(this,arguments,function*(){var f,m,g,x;try{for(var v=!0,w=xE(h),_;_=yield Ps(w.next()),f=_.done,!f;v=!0){x=_.value,v=!1;const T=o2(d,yield Ps(x.json())),j=new Oy;Object.assign(j,T),yield yield Ps(j)}}catch(C){m={error:C}}finally{try{!v&&!f&&(g=w.return)&&(yield Ps(g.call(w)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=one(this.apiClient,e);return l=qt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=nre(this.apiClient,d),f=new WR;return Object.assign(f,h),f})}else{const u=Ete(this.apiClient,e);return l=qt("{model}:batchEmbedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Lne(this.apiClient,d),f=new WR;return Object.assign(f,h),f})}}async generateImagesInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=lne(this.apiClient,e);return l=qt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=sre(this.apiClient,d),f=new HR;return Object.assign(f,h),f})}else{const u=Ite(this.apiClient,e);return l=qt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=$ne(this.apiClient,d),f=new HR;return Object.assign(f,h),f})}}async editImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=pne(this.apiClient,e);return i=qt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=ire(this.apiClient,c),d=new kZ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=yne(this.apiClient,e);return i=qt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=ore(this.apiClient,c),d=new jZ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=xne(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>bE(this.apiClient,d))}else{const u=Nte(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>wE(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=wne(this.apiClient,e);return l=qt("{models_url}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=ure(this.apiClient,d),f=new qR;return Object.assign(f,h),f})}else{const u=Ate(this.apiClient,e);return l=qt("{models_url}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Une(this.apiClient,d),f=new qR;return Object.assign(f,h),f})}}async update(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=_ne(this.apiClient,e);return l=qt("{model}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>bE(this.apiClient,d))}else{const u=jte(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>wE(this.apiClient,d))}}async delete(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Sne(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(()=>{const d=dre(),h=new KR;return Object.assign(h,d),h})}else{const u=Rte(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=Bne(),h=new KR;return Object.assign(h,d),h})}}async countTokens(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Ene(this.apiClient,e);return l=qt("{model}:countTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=hre(this.apiClient,d),f=new YR;return Object.assign(f,h),f})}else{const u=Mte(this.apiClient,e);return l=qt("{model}:countTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=zne(this.apiClient,d),f=new YR;return Object.assign(f,h),f})}}async computeTokens(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Tne(this.apiClient,e);return i=qt("{model}:computeTokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=fre(this.apiClient,c),d=new RZ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Nne(this.apiClient,e);return l=qt("{model}:predictLongRunning",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>yre(this.apiClient,d))}else{const u=Ote(this.apiClient,e);return l=qt("{model}:predictLongRunning",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>qne(this.apiClient,d))}}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Tre(t,e){const n={},r=b(e,["operationName"]);r!=null&&S(n,["_url","operationName"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Ire(t,e){const n={},r=b(e,["operationName"]);r!=null&&S(n,["_url","operationName"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Nre(t,e){const n={},r=b(e,["operationName"]);r!=null&&S(n,["operationName"],r);const s=b(e,["resourceName"]);s!=null&&S(n,["_url","resourceName"],s);const i=b(e,["config"]);return i!=null&&S(n,["config"],i),n}function Pre(t,e){const n={},r=b(e,["video","uri"]);r!=null&&S(n,["uri"],r);const s=b(e,["video","encodedVideo"]);s!=null&&S(n,["videoBytes"],Fc(t,s));const i=b(e,["encoding"]);return i!=null&&S(n,["mimeType"],i),n}function Are(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],Pre(t,r)),n}function kre(t,e){const n={},r=b(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Are(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function jre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response","generateVideoResponse"]);return l!=null&&S(n,["response"],kre(t,l)),n}function Rre(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["uri"],r);const s=b(e,["bytesBase64Encoded"]);s!=null&&S(n,["videoBytes"],Fc(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function Dre(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],Rre(t,r)),n}function Mre(t,e){const n={},r=b(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Dre(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function l2(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response"]);return l!=null&&S(n,["response"],Mre(t,l)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Lre extends wg{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let i;return r&&"httpOptions"in r&&(i=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Ire(this.apiClient,e);return l=qt("{operationName}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>l2(this.apiClient,d))}else{const u=Tre(this.apiClient,e);return l=qt("{operationName}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>jre(this.apiClient,d))}}async fetchPredictVideosOperationInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Nre(this.apiClient,e);return i=qt("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>l2(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Fre="Content-Type",Ore="X-Server-Timeout",$re="User-Agent",Vre="x-goog-api-client",Ure="0.14.1",Bre=`google-genai-sdk/${Ure}`,zre="v1beta1",Gre="v1beta",c2=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class QV extends Error{constructor(e,n){n?super(e,{cause:n}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class _E extends Error{constructor(e,n){n?super(e,{cause:n}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class Wre{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:zre,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:Gre,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const s=[this.getRequestUrlInternal(n)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))s.searchParams.append(o,String(l));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.unaryApiCall(s,i,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[s,i]of Object.entries(n))typeof i=="object"?r[s]=Object.assign(Object.assign({},r[s]),i):i!==void 0&&(r[s]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.streamApiCall(s,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const s=new AbortController,i=s.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>s.abort(),n.timeout),r&&r.addEventListener("abort",()=>{s.abort()}),e.signal=i}return e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await u2(s),new yE(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await u2(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var n;return Qv(this,arguments,function*(){const s=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),i=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:c}=yield Ps(s.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=i.decode(c);try{const h=JSON.parse(u);if("error"in h){const f=JSON.parse(JSON.stringify(h.error)),m=f.status,g=f.code,x=`got status: ${m}. ${JSON.stringify(h)}`;if(g>=400&&g<500)throw new QV(x);if(g>=500&&g<600)throw new _E(x)}}catch(h){const f=h;if(f.name==="ClientError"||f.name==="ServerError")throw h}o+=u;let d=o.match(c2);for(;d;){const h=d[1];try{const f=new Response(h,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Ps(new yE(f)),o=o.slice(d[0].length),d=o.match(c2)}catch(f){throw new Error(`exception parsing stream chunk ${h}. ${f}`)}}}}finally{s.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=Bre+" "+this.clientOptions.userAgentExtra;return e[$re]=n,e[Vre]=n,e[Fre]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,s]of Object.entries(e.headers))n.append(r,s);e.timeout&&e.timeout>0&&n.append(Ore,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const i=this.clientOptions.uploader,o=await i.stat(e);s.sizeBytes=String(o.size);const l=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;const c=await this.fetchUploadUrl(s,n);return i.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let s={};n!=null&&n.httpOptions?s=n.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const i={file:e},o=await this.request({path:qt("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:s});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function u2(t){var e;if(t===void 0)throw new _E("response is undefined");if(!t.ok){const n=t.status,r=t.statusText;let s;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await t.json():s={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=`got status: ${n} ${r}. ${JSON.stringify(s)}`;throw n>=400&&n<500?new QV(i):n>=500&&n<600?new _E(i):new Error(i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Hre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function qre(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);return n!==void 0&&o!=null&&S(n,["_query","filter"],o),r}function Kre(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],qre(t,r,n)),n}function Yre(t,e){const n={},r=b(e,["textInput"]);r!=null&&S(n,["textInput"],r);const s=b(e,["output"]);return s!=null&&S(n,["output"],s),n}function Jre(t,e){const n={};if(b(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=b(e,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>Yre(t,i))),S(n,["examples","examples"],s)}return n}function Qre(t,e,n){const r={};if(b(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=b(e,["tunedModelDisplayName"]);if(n!==void 0&&s!=null&&S(n,["displayName"],s),b(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=b(e,["epochCount"]);n!==void 0&&i!=null&&S(n,["tuningTask","hyperparameters","epochCount"],i);const o=b(e,["learningRateMultiplier"]);if(o!=null&&S(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),b(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(b(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=b(e,["batchSize"]);n!==void 0&&l!=null&&S(n,["tuningTask","hyperparameters","batchSize"],l);const c=b(e,["learningRate"]);return n!==void 0&&c!=null&&S(n,["tuningTask","hyperparameters","learningRate"],c),r}function Xre(t,e){const n={},r=b(e,["baseModel"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["trainingDataset"]);s!=null&&S(n,["tuningTask","trainingData"],Jre(t,s));const i=b(e,["config"]);return i!=null&&S(n,["config"],Qre(t,i,n)),n}function Zre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function ese(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);return n!==void 0&&o!=null&&S(n,["_query","filter"],o),r}function tse(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],ese(t,r,n)),n}function nse(t,e,n){const r={},s=b(e,["gcsUri"]);if(n!==void 0&&s!=null&&S(n,["supervisedTuningSpec","trainingDatasetUri"],s),b(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function rse(t,e){const n={},r=b(e,["gcsUri"]);return r!=null&&S(n,["validationDatasetUri"],r),n}function sse(t,e,n){const r={},s=b(e,["validationDataset"]);n!==void 0&&s!=null&&S(n,["supervisedTuningSpec"],rse(t,s));const i=b(e,["tunedModelDisplayName"]);n!==void 0&&i!=null&&S(n,["tunedModelDisplayName"],i);const o=b(e,["description"]);n!==void 0&&o!=null&&S(n,["description"],o);const l=b(e,["epochCount"]);n!==void 0&&l!=null&&S(n,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=b(e,["learningRateMultiplier"]);n!==void 0&&c!=null&&S(n,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const u=b(e,["exportLastCheckpointOnly"]);n!==void 0&&u!=null&&S(n,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const d=b(e,["adapterSize"]);if(n!==void 0&&d!=null&&S(n,["supervisedTuningSpec","hyperParameters","adapterSize"],d),b(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(b(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function ise(t,e){const n={},r=b(e,["baseModel"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["trainingDataset"]);s!=null&&S(n,["supervisedTuningSpec","trainingDatasetUri"],nse(t,s,n));const i=b(e,["config"]);return i!=null&&S(n,["config"],sse(t,i,n)),n}function ose(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["model"],r);const s=b(e,["name"]);return s!=null&&S(n,["endpoint"],s),n}function XV(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["state"]);s!=null&&S(n,["state"],zV(t,s));const i=b(e,["createTime"]);i!=null&&S(n,["createTime"],i);const o=b(e,["tuningTask","startTime"]);o!=null&&S(n,["startTime"],o);const l=b(e,["tuningTask","completeTime"]);l!=null&&S(n,["endTime"],l);const c=b(e,["updateTime"]);c!=null&&S(n,["updateTime"],c);const u=b(e,["description"]);u!=null&&S(n,["description"],u);const d=b(e,["baseModel"]);d!=null&&S(n,["baseModel"],d);const h=b(e,["_self"]);h!=null&&S(n,["tunedModel"],ose(t,h));const f=b(e,["distillationSpec"]);f!=null&&S(n,["distillationSpec"],f);const m=b(e,["experiment"]);m!=null&&S(n,["experiment"],m);const g=b(e,["labels"]);g!=null&&S(n,["labels"],g);const x=b(e,["pipelineJob"]);x!=null&&S(n,["pipelineJob"],x);const v=b(e,["tunedModelDisplayName"]);return v!=null&&S(n,["tunedModelDisplayName"],v),n}function ase(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["tunedModels"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>XV(t,o))),S(n,["tuningJobs"],i)}return n}function lse(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);return o!=null&&S(n,["error"],o),n}function cse(t,e){const n={},r=b(e,["checkpointId"]);r!=null&&S(n,["checkpointId"],r);const s=b(e,["epoch"]);s!=null&&S(n,["epoch"],s);const i=b(e,["step"]);i!=null&&S(n,["step"],i);const o=b(e,["endpoint"]);return o!=null&&S(n,["endpoint"],o),n}function use(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["model"],r);const s=b(e,["endpoint"]);s!=null&&S(n,["endpoint"],s);const i=b(e,["checkpoints"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>cse(t,l))),S(n,["checkpoints"],o)}return n}function SE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["state"]);s!=null&&S(n,["state"],zV(t,s));const i=b(e,["createTime"]);i!=null&&S(n,["createTime"],i);const o=b(e,["startTime"]);o!=null&&S(n,["startTime"],o);const l=b(e,["endTime"]);l!=null&&S(n,["endTime"],l);const c=b(e,["updateTime"]);c!=null&&S(n,["updateTime"],c);const u=b(e,["error"]);u!=null&&S(n,["error"],u);const d=b(e,["description"]);d!=null&&S(n,["description"],d);const h=b(e,["baseModel"]);h!=null&&S(n,["baseModel"],h);const f=b(e,["tunedModel"]);f!=null&&S(n,["tunedModel"],use(t,f));const m=b(e,["supervisedTuningSpec"]);m!=null&&S(n,["supervisedTuningSpec"],m);const g=b(e,["tuningDataStats"]);g!=null&&S(n,["tuningDataStats"],g);const x=b(e,["encryptionSpec"]);x!=null&&S(n,["encryptionSpec"],x);const v=b(e,["partnerModelTuningSpec"]);v!=null&&S(n,["partnerModelTuningSpec"],v);const w=b(e,["distillationSpec"]);w!=null&&S(n,["distillationSpec"],w);const _=b(e,["experiment"]);_!=null&&S(n,["experiment"],_);const C=b(e,["labels"]);C!=null&&S(n,["labels"],C);const T=b(e,["pipelineJob"]);T!=null&&S(n,["pipelineJob"],T);const j=b(e,["tunedModelDisplayName"]);return j!=null&&S(n,["tunedModelDisplayName"],j),n}function dse(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["tuningJobs"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>SE(t,o))),S(n,["tuningJobs"],i)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hse extends wg{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new A0(Gh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let s="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?s=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(s=r.name.split("/operations/")[0]),{name:s,state:gE.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Zre(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>SE(this.apiClient,d))}else{const u=Hre(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>XV(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=tse(this.apiClient,e);return l=qt("tuningJobs",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=dse(this.apiClient,d),f=new JR;return Object.assign(f,h),f})}else{const u=Kre(this.apiClient,e);return l=qt("tunedModels",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=ase(this.apiClient,d),f=new JR;return Object.assign(f,h),f})}}async tuneInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=ise(this.apiClient,e);return i=qt("tuningJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>SE(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=Xre(this.apiClient,e);return i=qt("tunedModels",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>lse(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fse{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const mse=1024*1024*8,pse=3,gse=1e3,yse=2,H_="x-goog-upload-status";async function xse(t,e,n){var r,s,i;let o=0,l=0,c=new yE(new Response),u="upload";for(o=t.size;l<o;){const h=Math.min(mse,o-l),f=t.slice(l,l+h);l+h>=o&&(u+=", finalize");let m=0,g=gse;for(;m<pse&&(c=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(l),"Content-Length":String(h)}}}),!(!((r=c==null?void 0:c.headers)===null||r===void 0)&&r[H_]));)m++,await wse(g),g=g*yse;if(l+=h,((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s[H_])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const d=await(c==null?void 0:c.json());if(((i=c==null?void 0:c.headers)===null||i===void 0?void 0:i[H_])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return d.file}async function vse(t){return{size:t.size,type:t.type}}function wse(t){return new Promise(e=>setTimeout(e,t))}class bse{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await xse(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await vse(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _se{create(e,n,r){return new Sse(e,n,r)}}class Sse{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const d2="x-goog-api-key";class Cse{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(d2)===null&&e.append(d2,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ese="gl-node/";class On{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=MX(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const s=new Cse(this.apiKey);this.apiClient=new Wre({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:Ese+"web",uploader:new bse,downloader:new fse}),this.models=new Ere(this.apiClient),this.live=new wre(this.apiClient,s,new _se),this.chats=new BZ(this.models,this.apiClient),this.caches=new OZ(this.apiClient),this.files=new tee(this.apiClient),this.operations=new Lre(this.apiClient),this.tunings=new hse(this.apiClient)}}const gl="AIzaSyCWUzTb8AC8d6CvHm4_MLgXSeufRQcHQAE";async function vI(t){const e=new On({apiKey:gl}),n={type:rt.ARRAY,items:{type:rt.STRING},description:"An array of 3 creative and catchy store name suggestions."};try{const r=`Suggest 3 creative and catchy store name options based on the following store name: "${t}". The suggestions should be relevant and similar. Return exactly 3 suggestions.`,s=await e.models.generateContent({model:"gemini-2.0-flash-lite-preview-02-05",contents:[{role:"user",parts:[{text:r}]}],config:{responseMimeType:"application/json",responseSchema:n}}),i=s.text;if(typeof i!="string"||i.trim()==="")throw console.error("Model did not return a text response for store name suggestions. Response:",JSON.stringify(s)),new Error("Model response for store name suggestions was empty or not a string.");try{const o=JSON.parse(i);return Array.isArray(o)&&o.every(l=>typeof l=="string")?{suggestions:o.slice(0,3).map(l=>l.trim()).filter(l=>l.length>0)}:(console.error("Parsed store name suggestions are not an array of strings:",o),{error:"AI response was not in the expected format (array of strings).",rawResponse:i})}catch(o){return console.error("Failed to parse JSON response for store names:",i,"ParseError:",o),{error:"Failed to parse store name suggestions from AI.",rawResponse:i}}}catch(r){return console.error("Error generating store name suggestions:",r),{error:`Error generating suggestions: ${r.message}`}}}async function ZV(t){const e=new On({apiKey:gl}),n={type:rt.OBJECT,properties:{heroTitle:{type:rt.STRING,description:"The catchy hero title for the store."},heroDescription:{type:rt.STRING,description:"A short (1-2 sentences) engaging hero description."}},required:["heroTitle","heroDescription"]},{name:r,niche:s,description:i,targetAudience:o,style:l}=t;let c=`Generate a compelling hero title and a short, engaging hero description for an online store.
Store Name: ${r||"N/A"}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of products."}
Target Audience: ${o||"General consumers"}
Style/Vibe: ${l||"Modern and friendly"}

Return the hero title and description as a JSON object matching the schema.`;try{const u=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:c}]}],config:{responseMimeType:"application/json",responseSchema:n}}),d=u.text;if(typeof d!="string"||d.trim()==="")throw console.error("Model did not return a text response for hero content. Response:",JSON.stringify(u)),new Error("Model response for hero content was empty or not a string.");try{const h=JSON.parse(d);return h&&typeof h.heroTitle=="string"&&typeof h.heroDescription=="string"?{heroTitle:h.heroTitle,heroDescription:h.heroDescription}:(console.error("Parsed hero content is not in the expected format:",h),{error:"AI response was not in the expected format for hero content.",rawResponse:d})}catch(h){return console.error("Failed to parse JSON response for hero content:",d,"ParseError:",h),{error:"Failed to parse hero content from AI.",rawResponse:d}}}catch(u){return console.error("Error generating hero content:",u),{error:`Error generating hero content: ${u.message}`}}}async function Tse(t){if(!t||!t.name)return console.error("Product information (at least name) is required for image prompt suggestions."),{error:"Product information required."};const e=new On({apiKey:gl}),{name:n,description:r,niche:s,storeName:i}=t,o={type:rt.ARRAY,items:{type:rt.STRING},description:"An array of 6 diverse and creative text prompts for AI image generation related to a product."};let l=`product named "${n}"`;r&&(l+=` with description "${r}"`),i&&(l+=` from a store called "${i}"`),s&&(l+=` in the "${s}" niche`);const c=`Based on a ${l}, generate 6 diverse and creative text prompts suitable for AI image generation. These prompts should aim to create visually appealing images for marketing this product. Examples: "A dynamic shot of [product name] on a clean, modern background with soft lighting", "Lifestyle image of [product name] being used by a happy customer in a [relevant setting]", "Close-up detail of [product name]'s unique feature with artistic blur". Return exactly 6 prompt suggestions.`;try{const u=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:c}]}],config:{responseMimeType:"application/json",responseSchema:o}}),d=u.text;if(typeof d!="string"||d.trim()==="")throw console.error("Model did not return a text response for image prompt suggestions. Response:",JSON.stringify(u)),new Error("Model response for image prompt suggestions was empty or not a string.");try{const h=JSON.parse(d);return Array.isArray(h)&&h.every(f=>typeof f=="string")?{suggestions:h.slice(0,6).map(f=>f.trim()).filter(f=>f.length>0)}:(console.error("Parsed image prompt suggestions are not an array of strings:",h),{error:"AI response was not in the expected format for image prompts (array of strings).",rawResponse:d})}catch(h){return console.error("Failed to parse JSON response for image prompt suggestions:",d,"ParseError:",h),{error:"Failed to parse image prompt suggestions from AI.",rawResponse:d}}}catch(u){return console.error("Error generating image prompt suggestions:",u),{error:`Error generating image prompt suggestions: ${u.message}`}}}async function Ise(t){const e=new On({apiKey:gl}),n={name:"extract_store_name",description:`Extracts the desired store name if explicitly mentioned in the prompt using phrases like "store called 'My Store'", "named 'My Store'", or "store 'My Store'". The name should be the direct object of such phrases.`,parameters:{type:rt.OBJECT,properties:{storeName:{type:rt.STRING,description:"The explicitly mentioned name of the store."}},required:["storeName"]}};try{const i=(await e.getGenerativeModel({model:"gemini-pro"}).generateContent({contents:[{role:"user",parts:[{text:t}]}],tools:[{functionDeclarations:[n]}]})).response.functionCalls();return i&&i.length>0&&i[0].name==="extract_store_name"&&i[0].args&&i[0].args.storeName?(console.log(`[extractExplicitStoreName] Gemini identified store name: ${i[0].args.storeName}`),i[0].args.storeName):(console.log("[extractExplicitStoreName] Gemini did not identify an explicit store name via function call."),null)}catch(r){return console.error("Error during Gemini store name extraction:",r),null}}async function e3(t){const e=new On({apiKey:gl}),n={type:rt.OBJECT,properties:{title:{type:rt.STRING,description:"The main title for 'The [StoreName] Way' section (e.g., 'The AwesomeStore Way')."},subtitle:{type:rt.STRING,description:"A short, engaging subtitle for this section (1-2 sentences)."},items:{type:rt.ARRAY,description:"An array of 3 to 4 items representing the store's core values or unique selling points.",items:{type:rt.OBJECT,properties:{emoji:{type:rt.STRING,description:"A single relevant emoji for the item (e.g., '✨', '🌿')."},title:{type:rt.STRING,description:"A short title for the item (2-4 words)."},description:{type:rt.STRING,description:"A brief description of the item (10-20 words)."}},required:["emoji","title","description"]},minItems:3,maxItems:4}},required:["title","subtitle","items"]},{name:r,niche:s,description:i,targetAudience:o,style:l}=t,c=r||"Our Store";let u=`Generate content for "The ${c} Way" section of an online store. This section highlights the store's core values and what makes it unique.
Store Name: ${c}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of quality products."}
Target Audience: ${o||"General consumers"}
Style/Vibe: ${l||"Modern and customer-focused"}

The content should include:
1.  A main title (e.g., "The ${c} Way"). This title should dynamically incorporate the actual store name.
2.  A short subtitle (1-2 sentences) that is specific and engaging for this store.
3.  3 to 4 items, each with:
    *   A unique and highly relevant emoji that visually represents the item's theme and is specific to this store's niche/style/keywords. This emoji is mandatory and must not be a generic placeholder. For example, if the store sells coffee, an emoji like ☕ or 🌿 (for organic beans) would be appropriate. If it's a tech store, 💡 or 🚀.
    *   A short, catchy title for the item (2-4 words, e.g., "Artisanal Roasts", "Cutting-Edge Tech"). This title must be specific to the store's theme.
    *   A brief description (10-20 words) elaborating on the item's title, specific to the store's values and offerings.

Return this content as a JSON object matching the schema. Ensure all text content and emojis are distinct, creative, and directly reflect the store's unique characteristics and offerings. Do not use generic examples in the output.`;try{const d=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:u}]}],config:{responseMimeType:"application/json",responseSchema:n}}),h=d.text;if(typeof h!="string"||h.trim()==="")throw console.error("Model did not return a text response for store way content. Response:",JSON.stringify(d)),new Error("Model response for store way content was empty or not a string.");try{const f=JSON.parse(h);return f&&typeof f.title=="string"&&typeof f.subtitle=="string"&&Array.isArray(f.items)&&f.items.length>=3&&f.items.length<=4&&f.items.every(m=>typeof m.emoji=="string"&&m.emoji.length>0&&typeof m.title=="string"&&typeof m.description=="string")?(f.title=`The ${c} Way`,f):(console.error("Parsed store way content is not in the expected format:",f),{error:"AI response was not in the expected format for store way content.",rawResponse:h})}catch(f){return console.error("Failed to parse JSON response for store way content:",h,"ParseError:",f),{error:"Failed to parse store way content from AI.",rawResponse:h}}}catch(d){return console.error("Error generating store way content:",d),{error:`Error generating store way content: ${d.message}`}}}async function wI(t){const e=[{iconName:"Truck",title:"Fast Shipping",description:"Get your orders delivered quickly and reliably."},{iconName:"ShieldCheck",title:"Secure Payments",description:"Shop with confidence using our secure payment gateways."},{iconName:"MessageSquare",title:"24/7 Support",description:"Our dedicated team is here to help you around the clock."},{iconName:"Repeat",title:"Easy Returns",description:"Hassle-free return and exchange policy if you're not satisfied."},{iconName:"Award",title:"Quality Guaranteed",description:"We stand by the quality of our products."},{iconName:"Gift",title:"Gift Options",description:"Special gift wrapping and messaging available."}],n=[{iconName:"Users",number:"10K+",label:"Active Users"},{iconName:"Star",number:"4.8",label:"Avg. Rating"},{iconName:"PackageCheck",number:"20K+",label:"Orders Shipped"},{iconName:"ShieldCheck",number:"100%",label:"Secure Checkout"},{iconName:"ThumbsUp",number:"95%",label:"Positive Feedback"},{iconName:"Globe",number:"Worldwide",label:"Shipping"}],r=new On({apiKey:gl}),s={type:rt.OBJECT,properties:{title:{type:rt.STRING,description:"Main title for the features/experience section (e.g., 'An Exceptional Experience')."},subtitle:{type:rt.STRING,description:"Engaging subtitle for the features section (1-2 sentences)."},items:{type:rt.ARRAY,description:"An array of 3 to 4 feature items highlighting key store benefits.",items:{type:rt.OBJECT,properties:{emoji:{type:rt.STRING,description:"A single relevant emoji for the feature (e.g., '🛡️', '🌍', '💎')."},title:{type:rt.STRING,description:"Short title for the feature (2-4 words, e.g., 'Secure Payments', 'Global Reach')."},description:{type:rt.STRING,description:"Brief description of the feature (10-20 words)."}},required:["emoji","title","description"]},minItems:3,maxItems:4},secondaryItems:{type:rt.ARRAY,description:"An array of up to 4 secondary feature items highlighting broader store benefits or values. The function will ensure 4 items are present by adding defaults if needed.",items:{type:rt.OBJECT,properties:{iconName:{type:rt.STRING,description:"Name of a Lucide icon (e.g., 'GlobeIcon', 'AwardIcon', 'UsersIcon', 'HeartIcon') for the secondary feature."},title:{type:rt.STRING,description:"Short title for the secondary feature (2-4 words, e.g., 'Global Shipping', 'Quality Assured')."},description:{type:rt.STRING,description:"Brief description of the secondary feature (10-15 words)."}},required:["iconName","title","description"]},minItems:0,maxItems:4},statsItems:{type:rt.ARRAY,description:"An array of exactly 4 stat items highlighting key metrics or achievements.",items:{type:rt.OBJECT,properties:{iconName:{type:rt.STRING,description:"Name of a Lucide icon for the stat (e.g., 'UsersIcon', 'StarIcon', 'ZapIcon')."},number:{type:rt.STRING,description:"The statistic value (e.g., '50K+', '99.9%', '4.9')."},label:{type:rt.STRING,description:"The label for the statistic (e.g., 'Happy Customers', 'Uptime', 'Average Rating')."}},required:["iconName","number","label"]},minItems:4,maxItems:4}},required:["title","subtitle","items","secondaryItems","statsItems"]},{name:i,niche:o,description:l,targetAudience:c,style:u}=t,d=i||"Our Store";let h=`Generate content for a store features section, often titled "An Exceptional Experience" or similar, for an online store named "${d}".
This section should highlight key benefits and unique selling propositions.
Store Name: ${d}
Niche: ${o||"General E-commerce"}
Description/Keywords: ${l||"A variety of quality products."}
Target Audience: ${c||"General consumers"}
Style/Vibe: ${u||"Modern and customer-focused"}

The content should include:
1.  A main title for the section (e.g., "Why Choose Us?", "Our Commitment to You", "An Exceptional Experience").
2.  A short, engaging subtitle (1-2 sentences).
3.  3 to 4 feature items, each with:
    *   A unique and highly relevant emoji that visually represents the feature (e.g., ✨ for innovation,  for eco-friendly,  for smart tech). This emoji is mandatory and must be specific to the feature's theme.
    *   A short, catchy, and descriptive title for the feature (2-5 words, e.g., "Innovative Designs", "Sustainable Materials", "Smart Home Solutions"). This title will be used to search for a relevant background video, so make it evocative.
    *   A brief description (10-20 words) explaining the benefit of the feature.
4.  Up to 4 secondary feature items (the system will ensure 4 by adding defaults if fewer are provided by AI), each with:
    *   An \`iconName\` string representing a Lucide icon (e.g., "GlobeIcon", "AwardIcon", "UsersIcon", "HeartIcon"). Choose an icon name that best fits the feature. Examples: GlobeIcon, AwardIcon, UsersIcon, HeartIcon, PackageIcon, ShieldIcon, ZapIcon.
    *   A short title for the secondary feature (2-4 words, e.g., "Global Shipping", "Quality Assured", "Community Love", "Eco-Friendly Focus").
    *   A brief description (10-15 words) for the secondary feature. These should highlight broader store values or benefits.
5.  Exactly 4 stat items, each with:
    *   An \`iconName\` string for a Lucide icon (e.g., "UsersIcon", "StarIcon", "ZapIcon", "PackageIcon").
    *   A \`number\` or key metric (e.g., "50K+", "99.9%", "4.9", "1M+"). Avoid including symbols like ★ in the number string itself.
    *   A descriptive \`label\` (e.g., "Happy Customers", "Uptime Guarantee", "Average Rating", "Units Sold").

Return this content as a JSON object matching the schema. Ensure all text content, emojis, and iconNames are distinct, creative, and directly reflect positive attributes of a store like "${d}". Do not use generic examples in the output. Examples of main features could be related to payment security, shipping, product quality, customer service. Secondary features could be about global reach, quality assurance, community, sustainability etc. Stats should reflect plausible achievements or service levels for a store selling "${o||"various items"}".`;try{const f=await r.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:h}]}],config:{responseMimeType:"application/json",responseSchema:s}}),m=f.text;if(typeof m!="string"||m.trim()==="")throw console.error("Model did not return a text response for store features content. Response:",JSON.stringify(f)),new Error("Model response for store features content was empty or not a string.");try{const g=JSON.parse(m);if(g&&typeof g.title=="string"&&typeof g.subtitle=="string"&&Array.isArray(g.items)&&g.items.length>=3&&g.items.length<=4&&g.items.every(x=>typeof x.emoji=="string"&&x.emoji.length>0&&typeof x.title=="string"&&typeof x.description=="string")){let x=[];g.secondaryItems&&Array.isArray(g.secondaryItems)&&(x=g.secondaryItems.filter(C=>C&&typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.title=="string"&&C.title.length>0&&typeof C.description=="string"&&C.description.length>0).slice(0,4));const v=4-x.length;if(v>0){const C=new Set(x.map(j=>j.title)),T=e.filter(j=>!C.has(j.title)).slice(0,v);x.push(...T)}g.secondaryItems=x.slice(0,4);let w=[];g.statsItems&&Array.isArray(g.statsItems)&&(w=g.statsItems.filter(C=>C&&typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.number=="string"&&C.number.length>0&&typeof C.label=="string"&&C.label.length>0).slice(0,4));const _=4-w.length;if(_>0){const C=new Set(w.map(j=>j.label)),T=n.filter(j=>!C.has(j.label)).slice(0,_);w.push(...T)}return g.statsItems=w.slice(0,4),Array.isArray(g.secondaryItems)&&g.secondaryItems.every(C=>typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.title=="string"&&typeof C.description=="string")&&Array.isArray(g.statsItems)&&g.statsItems.length===4&&g.statsItems.every(C=>typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.number=="string"&&C.number.length>0&&typeof C.label=="string"&&C.label.length>0)?g:(console.error("Parsed store features content is not in the expected format after padding/validation:",g),(!g.statsItems||g.statsItems.length!==4)&&(console.warn("Stats items still not 4, forcing defaults for stats."),g.statsItems=n.slice(0,4)),(!g.secondaryItems||g.secondaryItems.length===0)&&(console.warn("Secondary items empty, forcing defaults for secondary."),g.secondaryItems=e.slice(0,Math.min(4,e.length))),g.title&&g.subtitle&&g.items?g:{error:"AI response format error after final processing.",rawResponse:m,processedContent:g})}else return console.error("Initial parsed store features content structure is invalid:",g),{error:"AI response (initial structure) was not in the expected format for store features content.",rawResponse:m}}catch(g){return console.error("Failed to parse JSON response for store features content:",m,"ParseError:",g),{error:"Failed to parse store features content from AI.",rawResponse:m}}}catch(f){return console.error("Error generating store features content:",f),{error:`Error generating store features content: ${f.message}`}}}async function t3(t){const e=new On({apiKey:gl}),n={type:rt.OBJECT,properties:{title:{type:rt.STRING,description:"Catchy title for a section highlighting craftsmanship/quality (e.g., 'Our Commitment to Quality')."},subtitle:{type:rt.STRING,description:"Engaging subtitle (1-2 sentences) related to the title."},text:{type:rt.STRING,description:"Main descriptive text (2-3 sentences) about the store's dedication to quality, materials, or process."},listItems:{type:rt.ARRAY,description:"An array of 3-4 short bullet points (3-5 words each) highlighting key aspects (e.g., 'Premium Materials', 'Expert Craftsmanship').",items:{type:rt.STRING},minItems:3,maxItems:4},ctaText:{type:rt.STRING,description:"Call to action button text (e.g., 'Explore Our Process', 'Learn More')."}},required:["title","subtitle","text","listItems","ctaText"]},{name:r,niche:s,description:i}=t,o=t.productExamples?`Key products include: ${t.productExamples}.`:"The store offers a range of specialized gear.",l=`Generate content for a website section for a store with a "sharp" and "tactical" aesthetic. This section has an image on the right and text on the left, emphasizing the store's precision, quality, craftsmanship, or unique process.
Store Name: "${r||"Our Store"}"
Niche/Type: "${s||"high-performance gear"}"
Store Description: "${i||"A store dedicated to excellence and precision."}"
${o}
Generate a title, subtitle, main text (2-3 sentences), 3-4 list items (3-5 words each), and a CTA button text.
The tone should be bold, confident, and precise, fitting a high-tech or tactical brand.
Focus on aspects like durability, advanced technology, expert design, or mission-readiness.
Return as a JSON object matching the schema.`;try{const u=(await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:l}]}],config:{responseMimeType:"application/json",responseSchema:n}})).text;if(!(u!=null&&u.trim()))throw new Error("Empty response from AI.");const d=JSON.parse(u);return d.title&&d.subtitle&&d.text&&Array.isArray(d.listItems)&&d.listItems.length>=3&&d.ctaText?d:(console.error("Invalid structure from AI for ImageRightSection:",d),{error:"AI response format error for ImageRightSection.",rawResponse:u})}catch(c){return console.error("Error generating ImageRightSection content:",c),{error:`Error generating ImageRightSection content: ${c.message}`}}}async function n3(t){const e=new On({apiKey:gl}),n={type:rt.OBJECT,properties:{title:{type:rt.STRING,description:"Catchy title for a section showcasing a product or brand story via video (e.g., 'Experience the Difference')."},subtitle:{type:rt.STRING,description:"Engaging subtitle (1-2 sentences) related to the video's theme."},text:{type:rt.STRING,description:"Main descriptive text (2-3 sentences) complementing the video."},listItems:{type:rt.ARRAY,description:"An array of 2-3 short bullet points (3-5 words each) highlighting key takeaways or features shown in a video.",items:{type:rt.STRING},minItems:2,maxItems:3},ctaText:{type:rt.STRING,description:"Call to action button text (e.g., 'Watch Now', 'See It In Action')."}},required:["title","subtitle","text","listItems","ctaText"]},{name:r,niche:s,description:i}=t,o=t.productExamples?`The video might showcase products like: ${t.productExamples}.`:"The video showcases our innovative products.",l=`Generate content for a website section for a store with a "sharp" and "tactical" aesthetic. This section has a video on the left and text on the right, aiming to engage users with a dynamic visual story or product demonstration.
Store Name: "${r||"Our Store"}"
Niche/Type: "${s||"cutting-edge solutions"}"
Store Description: "${i||"A store focused on performance and innovation."}"
${o}
Generate a title, subtitle, main text (2-3 sentences), 2-3 list items (3-5 words each highlighting video takeaways), and a CTA button text.
The tone should be energetic, impactful, and forward-thinking, suitable for a high-performance brand.
Focus on action, benefits, or the experience the video portrays.
Return as a JSON object matching the schema.`;try{const u=(await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:l}]}],config:{responseMimeType:"application/json",responseSchema:n}})).text;if(!(u!=null&&u.trim()))throw new Error("Empty response from AI.");const d=JSON.parse(u);return d.title&&d.subtitle&&d.text&&Array.isArray(d.listItems)&&d.listItems.length>=2&&d.ctaText?d:(console.error("Invalid structure from AI for VideoLeftSection:",d),{error:"AI response format error for VideoLeftSection.",rawResponse:u})}catch(c){return console.error("Error generating VideoLeftSection content:",c),{error:`Error generating VideoLeftSection content: ${c.message}`}}}async function Nse(t,e){const n=new On({apiKey:gl}),r={type:rt.OBJECT,properties:{description:{type:rt.STRING,description:"A compelling and SEO-friendly product description."}},required:["description"]},{name:s,description:i}=t,{name:o,niche:l,targetAudience:c,style:u}=e;let d=`Generate a compelling, engaging, and SEO-friendly product description.
Store Name: ${o||"N/A"}
Store Niche: ${l||"General E-commerce"}
Store Style: ${u||"Modern and friendly"}
Target Audience: ${c||"General consumers"}

Product Name: "${s}"
${i?`Existing Description (for context, improve upon it): "${i}"`:""}

The new description should be persuasive, highlight key benefits, and be written in a tone that matches the store's style. It should be between 50 and 150 words.
Return the description as a JSON object matching the schema.`;try{const h=await n.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:d}]}],config:{responseMimeType:"application/json",responseSchema:r}}),f=h.text;if(typeof f!="string"||f.trim()==="")throw console.error("Model did not return a text response for product description. Response:",JSON.stringify(h)),new Error("Model response for product description was empty or not a string.");try{const m=JSON.parse(f);return m&&typeof m.description=="string"?{description:m.description}:(console.error("Parsed product description is not in the expected format:",m),{error:"AI response was not in the expected format for product description.",rawResponse:f})}catch(m){return console.error("Failed to parse JSON response for product description:",f,"ParseError:",m),{error:"Failed to parse product description from AI.",rawResponse:f}}}catch(h){return console.error("Error generating product description:",h),{error:`Error generating product description: ${h.message}`}}}function bt(...t){return TX(kV(t))}function Ft(){return kX()}const Pse="CEVWpXluVU77FgaVriTzqBCoN4FD3f0VL2Y8bXNPynNfqUg2DoUgPt8t";console.log("[utils.jsx] VITE_PEXELS_API_KEY loaded:","Exists");const r3=Pse,Ase="https://api.pexels.com/v1",kse="AIzaSyCWUzTb8AC8d6CvHm4_MLgXSeufRQcHQAE";console.log("[utils.jsx] VITE_GEMINI_API_KEY loaded:","Exists");const jse=kse,Rse="your-shop-name.myshopify.com",io=async(t,e=1,n="landscape")=>{const r=`${Ase}/search?query=${encodeURIComponent(t)}&per_page=${e}&orientation=${n}`;try{const s=await fetch(r,{headers:{Authorization:r3}});if(!s.ok){const o=await s.json();throw console.error("Pexels API error:",o),new Error(`Pexels API request failed: ${s.statusText}`)}const i=await s.json();if(!i.photos||i.photos.length===0){console.warn(`No Pexels images found for query: "${t}". Attempting fallback.`);const o=(l,c,u)=>`https://via.placeholder.com/${l}x${c}.png?text=NoImage:${encodeURIComponent(u)}`;return Array(e).fill(null).map((l,c)=>({id:Ft(),src:{large:o(1200,800,`${t} ${c+1}`),medium:o(800,600,`${t} ${c+1}`),original:o(1920,1280,`${t} ${c+1}`),square:o(400,400,`${t} ${c+1}`),landscape:o(1200,800,`${t} ${c+1}`),portrait:o(800,1200,`${t} ${c+1}`),small:o(400,260,`${t} ${c+1}`),tiny:o(200,130,`${t} ${c+1}`)},photographer:"N/A",alt:`No image found for ${t} ${c+1}`}))}return i.photos.map(o=>({id:o.id,src:o.src,photographer:o.photographer,alt:o.alt||`Photo by ${o.photographer} of ${t}`}))}catch(s){console.error("Error fetching Pexels images:",s);const i=(o,l,c)=>`https://via.placeholder.com/${o}x${l}.png?text=${encodeURIComponent(c)}`;return Array(e).fill(null).map((o,l)=>({id:Ft(),src:{large:i(1200,800,`Error ${t} ${l+1}`),medium:i(800,600,`Error ${t} ${l+1}`),original:i(1920,1280,`Error ${t} ${l+1}`),square:i(400,400,`Error ${t} ${l+1}`),landscape:i(1200,800,`Error ${t} ${l+1}`),portrait:i(800,1200,`Error ${t} ${l+1}`),small:i(400,260,`Error ${t} ${l+1}`),tiny:i(200,130,`Error ${t} ${l+1}`)},photographer:"Placeholder Error",alt:`Placeholder Error for ${t} ${l+1}`}))}},Fa=async(t,e=1,n="landscape")=>{const r=`https://api.pexels.com/videos/search?query=${encodeURIComponent(t)}&per_page=${e}&orientation=${n}`;try{const s=await fetch(r,{headers:{Authorization:r3}});if(!s.ok){const o=await s.json();throw console.error("Pexels Videos API error:",o),new Error(`Pexels Videos API request failed: ${s.statusText}`)}const i=await s.json();return!i.videos||i.videos.length===0?(console.warn(`No Pexels videos found for query: "${t}".`),Array(e).fill(null).map((o,l)=>({id:Ft(),url:`https://videos.pexels.com/videos/no-video-${l+1}.mp4`,image:`https://via.placeholder.com/1280x720.png?text=No+Video+Found+${encodeURIComponent(t)}`,alt:`No video found for ${t} ${l+1}`}))):i.videos.map(o=>{var c,u;const l=o.video_files.find(d=>d.quality==="hd"&&d.file_type==="video/mp4")||o.video_files.find(d=>d.file_type==="video/mp4")||o.video_files[0];return{id:o.id,url:l?l.link:null,image:((c=o.video_pictures[0])==null?void 0:c.picture)||`https://via.placeholder.com/1280x720.png?text=${encodeURIComponent(o.url||t)}`,duration:o.duration,user:o.user,alt:`Video of ${t} by ${((u=o.user)==null?void 0:u.name)||"Pexels Contributor"}`}})}catch(s){return console.error("Error fetching Pexels videos:",s),Array(e).fill(null).map((i,o)=>({id:Ft(),url:`https://videos.pexels.com/videos/error-video-${o+1}.mp4`,image:`https://via.placeholder.com/1280x720.png?text=Video+Error+${encodeURIComponent(t)}`,alt:`Error fetching video for ${t} ${o+1}`}))}},j0=async t=>{try{const e=new On({apiKey:jse}),n=[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE}];console.log(`[utils.jsx/generateImageWithGemini] Calling Gemini with prompt: "${t}"`);const r=await e.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:[{text:t}],safetySettings:n,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let s=null,i="image/png";if(r.candidates&&r.candidates.length>0&&r.candidates[0].content&&r.candidates[0].content.parts){for(const o of r.candidates[0].content.parts)if(o.inlineData&&o.inlineData.data){s=o.inlineData.data,i=o.inlineData.mimeType||"image/png",console.log(`[utils.jsx/generateImageWithGemini] Image generated. MimeType: ${i}`);break}}if(s)return{url:`data:${i};base64,${s}`,alt:`AI Generated Image for: ${t}`};throw new Error("No image data found in Gemini response.")}catch(e){return console.error("[utils.jsx/generateImageWithGemini] Error generating image with Gemini:",e),{url:`https://via.placeholder.com/512x512.png?text=Error:${encodeURIComponent(t.substring(0,20))}`,alt:`Error generating image for: ${t}`}}},Dse=(t,e)=>{const n={fashion:[`Elevate your style with our ${e}. Crafted for comfort and a modern look.`,`The ${e} is a must-have for any fashion-forward wardrobe. Versatile and chic.`,`Discover the perfect blend of quality and design in our ${e}. Ideal for any occasion.`],electronics:[`Experience next-level technology with the ${e}. Packed with features for modern life.`,`The ${e} offers superior performance and sleek design. Upgrade your tech today.`,`Unleash innovation with the ${e}. Reliable, powerful, and built to last.`],food:[`Savor the rich flavors of our ${e}. Made with the freshest, high-quality ingredients.`,`Our ${e} is a delicious treat for any time of day. Wholesome and satisfying.`,`Indulge in the authentic taste of ${e}. Perfect for sharing or enjoying solo.`],jewelry:[`Adorn yourself with the exquisite ${e}. A timeless piece that radiates elegance.`,`The ${e} is a symbol of sophistication and luxury. Crafted with precision.`,`Make a statement with our stunning ${e}. Perfect for special moments.`],general:[`Discover the quality and utility of the ${e}. A great addition to your collection.`,`The ${e} is designed for excellence and everyday use. You'll love it.`,`Enhance your life with the versatile ${e}. Built for performance and style.`]},r=n[t]||n.general;return r[Math.floor(Math.random()*r.length)]},bI=async(t,e,n="")=>{const r={niche:t,name:e,description:n};let s={heroTitle:`Welcome to ${e}`,heroDescription:`Discover amazing products at ${e}.`,featuresSectionTitle:"Why Shop With Us?",featuresSectionSubtitle:"We are committed to providing you with the best shopping experience.",featureTitles:["Fast Worldwide Shipping","Secure Online Payments","24/7 Customer Support","Easy Returns & Exchanges"],featureDescriptions:["Get your orders delivered quickly and reliably, no matter where you are.","Shop with confidence using our encrypted and secure payment gateways.","Our dedicated team is here to help you around the clock with any queries.","Not satisfied? We offer a hassle-free return and exchange policy."],featuresVideoQuery:`${t} abstract`,newsletterHeading:`Join the ${e} Family`,newsletterText:"Sign up for our newsletter to receive exclusive offers, new product alerts, and style tips directly to your inbox. Don't miss out!"};try{const l=await wI(r);l&&!l.error&&l.items&&(s.featuresSectionTitle=l.title,s.featuresSectionSubtitle=l.subtitle,s.featureTitles=l.items.map(c=>c.title),s.featureDescriptions=l.items.map(c=>c.description),s.featureTitles.length>0&&(s.featuresVideoQuery=`${e} ${t} ${s.featureTitles[0]}`))}catch(l){console.error("Failed to generate dynamic features content, using fallback.",l)}const i={fashion:`Step Into Style at ${e}`,electronics:`${e}: Your Tech Universe`,food:`Taste the Difference with ${e}`,jewelry:`Shine Bright with ${e}`,general:`Welcome to ${e} - Quality Finds!`},o={fashion:`Explore the latest trends and timeless classics. ${e} offers curated fashion for every individual. Express yourself with our unique collection.`,electronics:`Discover cutting-edge gadgets and essential electronics at ${e}. We bring you innovation, performance, and value, all in one place.`,food:`From farm-fresh produce to gourmet delights, ${e} is your source for delicious and wholesome food. Quality ingredients for a healthier life.`,jewelry:`Find exquisite pieces that tell your story. ${e} presents a stunning collection of fine jewelry, perfect for gifting or treating yourself.`,general:`Your one-stop shop for amazing products. ${e} offers a diverse range of quality items to meet your everyday needs and special desires.`};return s.heroTitle=i[t]||i.general,s.heroDescription=o[t]||o.general,s};function Mse(t,e){const[n,r]=p.useState(t);return p.useEffect(()=>{const s=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(s)}},[t,e]),n}function gt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function h2(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function R0(...t){return e=>{let n=!1;const r=t.map(s=>{const i=h2(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():h2(t[s],null)}}}}function yn(...t){return p.useCallback(R0(...t),t)}function Lse(t,e){const n=p.createContext(e),r=i=>{const{children:o,...l}=i,c=p.useMemo(()=>l,Object.values(l));return a.jsx(n.Provider,{value:c,children:o})};r.displayName=t+"Provider";function s(i){const o=p.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,s]}function bi(t,e=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];const u=h=>{var w;const{scope:f,children:m,...g}=h,x=((w=f==null?void 0:f[t])==null?void 0:w[c])||l,v=p.useMemo(()=>g,Object.values(g));return a.jsx(x.Provider,{value:v,children:m})};u.displayName=i+"Provider";function d(h,f){var x;const m=((x=f==null?void 0:f[t])==null?void 0:x[c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return p.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,Fse(s,...e)]}function Fse(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function Wu(t){const e=$se(t),n=p.forwardRef((r,s)=>{const{children:i,...o}=r,l=p.Children.toArray(i),c=l.find(Use);if(c){const u=c.props.children,d=l.map(h=>h===c?p.Children.count(u)>1?p.Children.only(null):p.isValidElement(u)?u.props.children:null:h);return a.jsx(e,{...o,ref:s,children:p.isValidElement(u)?p.cloneElement(u,void 0,d):null})}return a.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}var Ose=Wu("Slot");function $se(t){const e=p.forwardRef((n,r)=>{const{children:s,...i}=n;if(p.isValidElement(s)){const o=zse(s),l=Bse(i,s.props);return s.type!==p.Fragment&&(l.ref=r?R0(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var s3=Symbol("radix.slottable");function Vse(t){const e=({children:n})=>a.jsx(a.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=s3,e}function Use(t){return p.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===s3}function Bse(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function zse(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function _I(t){const e=t+"CollectionProvider",[n,r]=bi(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=x=>{const{scope:v,children:w}=x,_=ht.useRef(null),C=ht.useRef(new Map).current;return a.jsx(s,{scope:v,itemMap:C,collectionRef:_,children:w})};o.displayName=e;const l=t+"CollectionSlot",c=Wu(l),u=ht.forwardRef((x,v)=>{const{scope:w,children:_}=x,C=i(l,w),T=yn(v,C.collectionRef);return a.jsx(c,{ref:T,children:_})});u.displayName=l;const d=t+"CollectionItemSlot",h="data-radix-collection-item",f=Wu(d),m=ht.forwardRef((x,v)=>{const{scope:w,children:_,...C}=x,T=ht.useRef(null),j=yn(v,T),A=i(d,w);return ht.useEffect(()=>(A.itemMap.set(T,{ref:T,...C}),()=>void A.itemMap.delete(T))),a.jsx(f,{[h]:"",ref:j,children:_})});m.displayName=d;function g(x){const v=i(t+"CollectionConsumer",x);return ht.useCallback(()=>{const _=v.collectionRef.current;if(!_)return[];const C=Array.from(_.querySelectorAll(`[${h}]`));return Array.from(v.itemMap.values()).sort((A,E)=>C.indexOf(A.ref.current)-C.indexOf(E.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:u,ItemSlot:m},g,r]}var Gse=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Yt=Gse.reduce((t,e)=>{const n=Wu(`Primitive.${e}`),r=p.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function SI(t,e){t&&ml.flushSync(()=>t.dispatchEvent(e))}function $r(t){const e=p.useRef(t);return p.useEffect(()=>{e.current=t}),p.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function Wse(t,e=globalThis==null?void 0:globalThis.document){const n=$r(t);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var Hse="DismissableLayer",CE="dismissableLayer.update",qse="dismissableLayer.pointerDownOutside",Kse="dismissableLayer.focusOutside",f2,i3=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),bg=p.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=t,u=p.useContext(i3),[d,h]=p.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=p.useState({}),g=yn(e,E=>h(E)),x=Array.from(u.layers),[v]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),w=x.indexOf(v),_=d?x.indexOf(d):-1,C=u.layersWithOutsidePointerEventsDisabled.size>0,T=_>=w,j=Jse(E=>{const I=E.target,N=[...u.branches].some(k=>k.contains(I));!T||N||(s==null||s(E),o==null||o(E),E.defaultPrevented||l==null||l())},f),A=Qse(E=>{const I=E.target;[...u.branches].some(k=>k.contains(I))||(i==null||i(E),o==null||o(E),E.defaultPrevented||l==null||l())},f);return Wse(E=>{_===u.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&l&&(E.preventDefault(),l()))},f),p.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(f2=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),m2(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=f2)}},[d,f,n,u]),p.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),m2())},[d,u]),p.useEffect(()=>{const E=()=>m({});return document.addEventListener(CE,E),()=>document.removeEventListener(CE,E)},[]),a.jsx(Yt.div,{...c,ref:g,style:{pointerEvents:C?T?"auto":"none":void 0,...t.style},onFocusCapture:gt(t.onFocusCapture,A.onFocusCapture),onBlurCapture:gt(t.onBlurCapture,A.onBlurCapture),onPointerDownCapture:gt(t.onPointerDownCapture,j.onPointerDownCapture)})});bg.displayName=Hse;var Yse="DismissableLayerBranch",o3=p.forwardRef((t,e)=>{const n=p.useContext(i3),r=p.useRef(null),s=yn(e,r);return p.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),a.jsx(Yt.div,{...t,ref:s})});o3.displayName=Yse;function Jse(t,e=globalThis==null?void 0:globalThis.document){const n=$r(t),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let c=function(){a3(qse,n,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=c,e.addEventListener("click",s.current,{once:!0})):c()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function Qse(t,e=globalThis==null?void 0:globalThis.document){const n=$r(t),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&a3(Kse,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function m2(){const t=new CustomEvent(CE);document.dispatchEvent(t)}function a3(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?SI(s,i):s.dispatchEvent(i)}var Xse=bg,Zse=o3,xa=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},eie="Portal",_g=p.forwardRef((t,e)=>{var l;const{container:n,...r}=t,[s,i]=p.useState(!1);xa(()=>i(!0),[]);const o=n||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?hI.createPortal(a.jsx(Yt.div,{...r,ref:e}),o):null});_g.displayName=eie;function tie(t,e){return p.useReducer((n,r)=>e[n][r]??n,t)}var vs=t=>{const{present:e,children:n}=t,r=nie(e),s=typeof n=="function"?n({present:r.isPresent}):p.Children.only(n),i=yn(r.ref,rie(s));return typeof n=="function"||r.isPresent?p.cloneElement(s,{ref:i}):null};vs.displayName="Presence";function nie(t){const[e,n]=p.useState(),r=p.useRef(null),s=p.useRef(t),i=p.useRef("none"),o=t?"mounted":"unmounted",[l,c]=tie(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const u=Uy(r.current);i.current=l==="mounted"?u:"none"},[l]),xa(()=>{const u=r.current,d=s.current;if(d!==t){const f=i.current,m=Uy(u);t?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),xa(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=m=>{const x=Uy(r.current).includes(m.animationName);if(m.target===e&&x&&(c("ANIMATION_END"),!s.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},f=m=>{m.target===e&&(i.current=Uy(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(u=>{r.current=u?getComputedStyle(u):null,n(u)},[])}}function Uy(t){return(t==null?void 0:t.animationName)||"none"}function rie(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var sie=a0[" useInsertionEffect ".trim().toString()]||xa;function Oc({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[s,i,o]=iie({defaultProp:e,onChange:n}),l=t!==void 0,c=l?t:s;{const d=p.useRef(t!==void 0);p.useEffect(()=>{const h=d.current;h!==l&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,r])}const u=p.useCallback(d=>{var h;if(l){const f=oie(d)?d(t):d;f!==t&&((h=o.current)==null||h.call(o,f))}else i(d)},[l,t,i,o]);return[c,u]}function iie({defaultProp:t,onChange:e}){const[n,r]=p.useState(t),s=p.useRef(n),i=p.useRef(e);return sie(()=>{i.current=e},[e]),p.useEffect(()=>{var o;s.current!==n&&((o=i.current)==null||o.call(i,n),s.current=n)},[n,s]),[n,r,i]}function oie(t){return typeof t=="function"}var aie=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),lie="VisuallyHidden",CI=p.forwardRef((t,e)=>a.jsx(Yt.span,{...t,ref:e,style:{...aie,...t.style}}));CI.displayName=lie;var EI="ToastProvider",[TI,cie,uie]=_I("Toast"),[l3,_Re]=bi("Toast",[uie]),[die,D0]=l3(EI),c3=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=t,[l,c]=p.useState(null),[u,d]=p.useState(0),h=p.useRef(!1),f=p.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${EI}\`. Expected non-empty \`string\`.`),a.jsx(TI.Provider,{scope:e,children:a.jsx(die,{scope:e,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>d(m=>m+1),[]),onToastRemove:p.useCallback(()=>d(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};c3.displayName=EI;var u3="ToastViewport",hie=["F8"],EE="toast.viewportPause",TE="toast.viewportResume",d3=p.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=hie,label:s="Notifications ({hotkey})",...i}=t,o=D0(u3,n),l=cie(n),c=p.useRef(null),u=p.useRef(null),d=p.useRef(null),h=p.useRef(null),f=yn(e,h,o.onViewportChange),m=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=o.toastCount>0;p.useEffect(()=>{const v=w=>{var C;r.length!==0&&r.every(T=>w[T]||w.code===T)&&((C=h.current)==null||C.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[r]),p.useEffect(()=>{const v=c.current,w=h.current;if(g&&v&&w){const _=()=>{if(!o.isClosePausedRef.current){const A=new CustomEvent(EE);w.dispatchEvent(A),o.isClosePausedRef.current=!0}},C=()=>{if(o.isClosePausedRef.current){const A=new CustomEvent(TE);w.dispatchEvent(A),o.isClosePausedRef.current=!1}},T=A=>{!v.contains(A.relatedTarget)&&C()},j=()=>{v.contains(document.activeElement)||C()};return v.addEventListener("focusin",_),v.addEventListener("focusout",T),v.addEventListener("pointermove",_),v.addEventListener("pointerleave",j),window.addEventListener("blur",_),window.addEventListener("focus",C),()=>{v.removeEventListener("focusin",_),v.removeEventListener("focusout",T),v.removeEventListener("pointermove",_),v.removeEventListener("pointerleave",j),window.removeEventListener("blur",_),window.removeEventListener("focus",C)}}},[g,o.isClosePausedRef]);const x=p.useCallback(({tabbingDirection:v})=>{const _=l().map(C=>{const T=C.ref.current,j=[T,...Eie(T)];return v==="forwards"?j:j.reverse()});return(v==="forwards"?_.reverse():_).flat()},[l]);return p.useEffect(()=>{const v=h.current;if(v){const w=_=>{var j,A,E;const C=_.altKey||_.ctrlKey||_.metaKey;if(_.key==="Tab"&&!C){const I=document.activeElement,N=_.shiftKey;if(_.target===v&&N){(j=u.current)==null||j.focus();return}const D=x({tabbingDirection:N?"backwards":"forwards"}),M=D.findIndex(z=>z===I);q_(D.slice(M+1))?_.preventDefault():N?(A=u.current)==null||A.focus():(E=d.current)==null||E.focus()}};return v.addEventListener("keydown",w),()=>v.removeEventListener("keydown",w)}},[l,x]),a.jsxs(Zse,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&a.jsx(IE,{ref:u,onFocusFromOutsideViewport:()=>{const v=x({tabbingDirection:"forwards"});q_(v)}}),a.jsx(TI.Slot,{scope:n,children:a.jsx(Yt.ol,{tabIndex:-1,...i,ref:f})}),g&&a.jsx(IE,{ref:d,onFocusFromOutsideViewport:()=>{const v=x({tabbingDirection:"backwards"});q_(v)}})]})});d3.displayName=u3;var h3="ToastFocusProxy",IE=p.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=D0(h3,n);return a.jsx(CI,{"aria-hidden":!0,tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(l))&&r()}})});IE.displayName=h3;var Sg="Toast",fie="toast.swipeStart",mie="toast.swipeMove",pie="toast.swipeCancel",gie="toast.swipeEnd",f3=p.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=t,[l,c]=Oc({prop:r,defaultProp:s??!0,onChange:i,caller:Sg});return a.jsx(vs,{present:n||l,children:a.jsx(vie,{open:l,...o,ref:e,onClose:()=>c(!1),onPause:$r(t.onPause),onResume:$r(t.onResume),onSwipeStart:gt(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:gt(t.onSwipeMove,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:gt(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:gt(t.onSwipeEnd,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})})});f3.displayName=Sg;var[yie,xie]=l3(Sg,{onClose(){}}),vie=p.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:m,...g}=t,x=D0(Sg,n),[v,w]=p.useState(null),_=yn(e,z=>w(z)),C=p.useRef(null),T=p.useRef(null),j=s||x.duration,A=p.useRef(0),E=p.useRef(j),I=p.useRef(0),{onToastAdd:N,onToastRemove:k}=x,R=$r(()=>{var B;(v==null?void 0:v.contains(document.activeElement))&&((B=x.viewport)==null||B.focus()),o()}),D=p.useCallback(z=>{!z||z===1/0||(window.clearTimeout(I.current),A.current=new Date().getTime(),I.current=window.setTimeout(R,z))},[R]);p.useEffect(()=>{const z=x.viewport;if(z){const B=()=>{D(E.current),u==null||u()},G=()=>{const Y=new Date().getTime()-A.current;E.current=E.current-Y,window.clearTimeout(I.current),c==null||c()};return z.addEventListener(EE,G),z.addEventListener(TE,B),()=>{z.removeEventListener(EE,G),z.removeEventListener(TE,B)}}},[x.viewport,j,c,u,D]),p.useEffect(()=>{i&&!x.isClosePausedRef.current&&D(j)},[i,j,x.isClosePausedRef,D]),p.useEffect(()=>(N(),()=>k()),[N,k]);const M=p.useMemo(()=>v?w3(v):null,[v]);return x.viewport?a.jsxs(a.Fragment,{children:[M&&a.jsx(wie,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:M}),a.jsx(yie,{scope:n,onClose:R,children:ml.createPortal(a.jsx(TI.ItemSlot,{scope:n,children:a.jsx(Xse,{asChild:!0,onEscapeKeyDown:gt(l,()=>{x.isFocusedToastEscapeKeyDownRef.current||R(),x.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(Yt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":x.swipeDirection,...g,ref:_,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:gt(t.onKeyDown,z=>{z.key==="Escape"&&(l==null||l(z.nativeEvent),z.nativeEvent.defaultPrevented||(x.isFocusedToastEscapeKeyDownRef.current=!0,R()))}),onPointerDown:gt(t.onPointerDown,z=>{z.button===0&&(C.current={x:z.clientX,y:z.clientY})}),onPointerMove:gt(t.onPointerMove,z=>{if(!C.current)return;const B=z.clientX-C.current.x,G=z.clientY-C.current.y,Y=!!T.current,H=["left","right"].includes(x.swipeDirection),K=["left","up"].includes(x.swipeDirection)?Math.min:Math.max,$=H?K(0,B):0,V=H?0:K(0,G),W=z.pointerType==="touch"?10:2,F={x:$,y:V},Z={originalEvent:z,delta:F};Y?(T.current=F,By(mie,h,Z,{discrete:!1})):p2(F,x.swipeDirection,W)?(T.current=F,By(fie,d,Z,{discrete:!1}),z.target.setPointerCapture(z.pointerId)):(Math.abs(B)>W||Math.abs(G)>W)&&(C.current=null)}),onPointerUp:gt(t.onPointerUp,z=>{const B=T.current,G=z.target;if(G.hasPointerCapture(z.pointerId)&&G.releasePointerCapture(z.pointerId),T.current=null,C.current=null,B){const Y=z.currentTarget,H={originalEvent:z,delta:B};p2(B,x.swipeDirection,x.swipeThreshold)?By(gie,m,H,{discrete:!0}):By(pie,f,H,{discrete:!0}),Y.addEventListener("click",K=>K.preventDefault(),{once:!0})}})})})}),x.viewport)})]}):null}),wie=t=>{const{__scopeToast:e,children:n,...r}=t,s=D0(Sg,e),[i,o]=p.useState(!1),[l,c]=p.useState(!1);return Sie(()=>o(!0)),p.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:a.jsx(_g,{asChild:!0,children:a.jsx(CI,{...r,children:i&&a.jsxs(a.Fragment,{children:[s.label," ",n]})})})},bie="ToastTitle",m3=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Yt.div,{...r,ref:e})});m3.displayName=bie;var _ie="ToastDescription",p3=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Yt.div,{...r,ref:e})});p3.displayName=_ie;var g3="ToastAction",y3=p.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?a.jsx(v3,{altText:n,asChild:!0,children:a.jsx(II,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${g3}\`. Expected non-empty \`string\`.`),null)});y3.displayName=g3;var x3="ToastClose",II=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,s=xie(x3,n);return a.jsx(v3,{asChild:!0,children:a.jsx(Yt.button,{type:"button",...r,ref:e,onClick:gt(t.onClick,s.onClose)})})});II.displayName=x3;var v3=p.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...s}=t;return a.jsx(Yt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function w3(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),Cie(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...w3(r))}}),e}function By(t,e,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?SI(s,i):s.dispatchEvent(i)}var p2=(t,e,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return e==="left"||e==="right"?i&&r>n:!i&&s>n};function Sie(t=()=>{}){const e=$r(t);xa(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function Cie(t){return t.nodeType===t.ELEMENT_NODE}function Eie(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function q_(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var Tie=c3,b3=d3,_3=f3,S3=m3,C3=p3,E3=y3,T3=II;const g2=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,y2=kV,NI=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return y2(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const f=g2(d)||g2(h);return s[u][f]}),l=n&&Object.entries(n).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:h,className:f,...m}=d;return Object.entries(m).every(g=>{let[x,v]=g;return Array.isArray(v)?v.includes({...i,...l}[x]):{...i,...l}[x]===v})?[...u,h,f]:u},[]);return y2(t,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};var Iie={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Nie=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ke=(t,e)=>{const n=p.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:l,...c},u)=>p.createElement("svg",{ref:u,...Iie,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${Nie(t)}`,...c},[...e.map(([d,h])=>p.createElement(d,h)),...(Array.isArray(l)?l:[l])||[]]));return n.displayName=`${t}`,n},K_=Ke("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Cg=Ke("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Wi=Ke("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),ju=Ke("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Pie=Ke("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),Aie=Ke("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),Xv=Ke("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),kie=Ke("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),jie=Ke("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),PI=Ke("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),ha=Ke("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Eg=Ke("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Cu=Ke("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Rie=Ke("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),I3=Ke("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Die=Ke("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),Mie=Ke("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),AI=Ke("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),ro=Ke("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),x2=Ke("DownloadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m8 17 4 4 4-4",key:"1ul180"}]]),kI=Ke("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Yl=Ke("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),Lie=Ke("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Fie=Ke("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),Sr=Ke("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),N3=Ke("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]),Ru=Ke("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Y_=Ke("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),v2=Ke("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),P3=Ke("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Oie=Ke("ImageDown",[["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10.8",key:"sqts6f"}],["path",{d:"m21 15-3.1-3.1a2 2 0 0 0-2.814.014L6 21",key:"1h47z9"}],["path",{d:"m14 19.5 3 3v-6",key:"1x9jmo"}],["path",{d:"m17 22.5 3-3",key:"xzuz0n"}]]),A3=Ke("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),NE=Ke("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),$ie=Ke("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Wx=Ke("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),Vie=Ke("Layers3",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m6.08 9.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1e5n1m"}],["path",{d:"m6.08 14.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1iwflc"}]]),Uie=Ke("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),Bie=Ke("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),zie=Ke("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),ft=Ke("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),k3=Ke("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),w2=Ke("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ah=Ke("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Gie=Ke("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Wie=Ke("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),j3=Ke("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Hie=Ke("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),qie=Ke("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),PE=Ke("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),Kie=Ke("MousePointer2",[["path",{d:"m4 4 7.07 17 2.51-7.39L21 11.07z",key:"1vqm48"}]]),R3=Ke("MoveDown",[["path",{d:"M8 18L12 22L16 18",key:"cskvfv"}],["path",{d:"M12 2V22",key:"r89rzk"}]]),D3=Ke("MoveUp",[["path",{d:"M8 6L12 2L16 6",key:"1yvkyx"}],["path",{d:"M12 2V22",key:"r89rzk"}]]),Li=Ke("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Zv=Ke("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),Yie=Ke("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),Jie=Ke("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),ew=Ke("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),Op=Ke("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),b2=Ke("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),M3=Ke("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),Qie=Ke("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Xie=Ke("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),jI=Ke("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Fi=Ke("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),Eu=Ke("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),AE=Ke("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),L3=Ke("Replace",[["path",{d:"M14 4c0-1.1.9-2 2-2",key:"1mvvbw"}],["path",{d:"M20 2c1.1 0 2 .9 2 2",key:"1mj6oe"}],["path",{d:"M22 8c0 1.1-.9 2-2 2",key:"v1wql3"}],["path",{d:"M16 10c-1.1 0-2-.9-2-2",key:"821ux0"}],["path",{d:"m3 7 3 3 3-3",key:"x25e72"}],["path",{d:"M6 10V5c0-1.7 1.3-3 3-3h1",key:"13af7h"}],["rect",{width:"8",height:"8",x:"2",y:"14",rx:"2",key:"17ihk4"}]]),Zie=Ke("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),J_=Ke("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),tw=Ke("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]),Du=Ke("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),eoe=Ke("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),toe=Ke("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),Ch=Ke("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),noe=Ke("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),F3=Ke("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),$p=Ke("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Er=Ke("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),RI=Ke("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),roe=Ke("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]),zy=Ke("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),kE=Ke("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Gm=Ke("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),O3=Ke("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Fn=Ke("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Qf=Ke("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),nw=Ke("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),soe=Ke("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),ioe=Ke("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),Lo=Ke("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]),$3=Ke("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),ooe=Ke("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),M0=Ke("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),_2=Ke("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),va=Ke("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),fa=Ke("Wand",[["path",{d:"M15 4V2",key:"z1p9b7"}],["path",{d:"M15 16v-2",key:"px0unx"}],["path",{d:"M8 9h2",key:"1g203m"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M17.8 11.8 19 13",key:"yihg8r"}],["path",{d:"M15 9h0",key:"kg5t1u"}],["path",{d:"M17.8 6.2 19 5",key:"fd4us0"}],["path",{d:"m3 21 9-9",key:"1jfql5"}],["path",{d:"M12.2 6.2 11 5",key:"i3da3b"}]]),rw=Ke("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Hi=Ke("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),aoe=Ke("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),V3=Ke("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),loe=Tie,U3=ht.forwardRef(({className:t,...e},n)=>a.jsx(b3,{ref:n,className:bt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));U3.displayName=b3.displayName;const coe=NI("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),B3=ht.forwardRef(({className:t,variant:e,...n},r)=>a.jsx(_3,{ref:r,className:bt(coe({variant:e}),t),...n}));B3.displayName=_3.displayName;const uoe=ht.forwardRef(({className:t,...e},n)=>a.jsx(E3,{ref:n,className:bt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));uoe.displayName=E3.displayName;const z3=ht.forwardRef(({className:t,...e},n)=>a.jsx(T3,{ref:n,className:bt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:a.jsx(Hi,{className:"h-4 w-4"})}));z3.displayName=T3.displayName;const G3=ht.forwardRef(({className:t,...e},n)=>a.jsx(S3,{ref:n,className:bt("text-sm font-semibold",t),...e}));G3.displayName=S3.displayName;const W3=ht.forwardRef(({className:t,...e},n)=>a.jsx(C3,{ref:n,className:bt("text-sm opacity-90",t),...e}));W3.displayName=C3.displayName;const doe=1;let Q_=0;function hoe(){return Q_=(Q_+1)%Number.MAX_VALUE,Q_.toString()}const Gs={state:{toasts:[]},listeners:[],getState:()=>Gs.state,setState:t=>{typeof t=="function"?Gs.state=t(Gs.state):Gs.state={...Gs.state,...t},Gs.listeners.forEach(e=>e(Gs.state))},subscribe:t=>(Gs.listeners.push(t),()=>{Gs.listeners=Gs.listeners.filter(e=>e!==t)})},foe=({...t})=>{const e=hoe(),n=s=>Gs.setState(i=>({...i,toasts:i.toasts.map(o=>o.id===e?{...o,...s}:o)})),r=()=>Gs.setState(s=>({...s,toasts:s.toasts.filter(i=>i.id!==e)}));return Gs.setState(s=>({...s,toasts:[{...t,id:e,dismiss:r},...s.toasts].slice(0,doe)})),{id:e,dismiss:r,update:n}};function as(){const[t,e]=p.useState(Gs.getState());return p.useEffect(()=>Gs.subscribe(r=>{e(r)}),[]),p.useEffect(()=>{const n=[];return t.toasts.forEach(r=>{if(r.duration===1/0)return;const s=setTimeout(()=>{r.dismiss()},r.duration||5e3);n.push(s)}),()=>{n.forEach(r=>clearTimeout(r))}},[t.toasts]),{toast:foe,toasts:t.toasts}}function moe(){const{toasts:t}=as();return a.jsxs(loe,{children:[t.map(({id:e,title:n,description:r,action:s,dismiss:i,...o})=>a.jsxs(B3,{...o,children:[a.jsxs("div",{className:"grid gap-1",children:[n&&a.jsx(G3,{children:n}),r&&a.jsx(W3,{children:r})]}),s,a.jsx(z3,{})]},e)),a.jsx(U3,{})]})}var poe=a0[" useId ".trim().toString()]||(()=>{}),goe=0;function ic(t){const[e,n]=p.useState(poe());return xa(()=>{t||n(r=>r??String(goe++))},[t]),t||(e?`radix-${e}`:"")}var X_="focusScope.autoFocusOnMount",Z_="focusScope.autoFocusOnUnmount",S2={bubbles:!1,cancelable:!0},yoe="FocusScope",L0=p.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[l,c]=p.useState(null),u=$r(s),d=$r(i),h=p.useRef(null),f=yn(e,x=>c(x)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let x=function(C){if(m.paused||!l)return;const T=C.target;l.contains(T)?h.current=T:jl(h.current,{select:!0})},v=function(C){if(m.paused||!l)return;const T=C.relatedTarget;T!==null&&(l.contains(T)||jl(h.current,{select:!0}))},w=function(C){if(document.activeElement===document.body)for(const j of C)j.removedNodes.length>0&&jl(l)};document.addEventListener("focusin",x),document.addEventListener("focusout",v);const _=new MutationObserver(w);return l&&_.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",v),_.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){E2.add(m);const x=document.activeElement;if(!l.contains(x)){const w=new CustomEvent(X_,S2);l.addEventListener(X_,u),l.dispatchEvent(w),w.defaultPrevented||(xoe(Soe(H3(l)),{select:!0}),document.activeElement===x&&jl(l))}return()=>{l.removeEventListener(X_,u),setTimeout(()=>{const w=new CustomEvent(Z_,S2);l.addEventListener(Z_,d),l.dispatchEvent(w),w.defaultPrevented||jl(x??document.body,{select:!0}),l.removeEventListener(Z_,d),E2.remove(m)},0)}}},[l,u,d,m]);const g=p.useCallback(x=>{if(!n&&!r||m.paused)return;const v=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,w=document.activeElement;if(v&&w){const _=x.currentTarget,[C,T]=voe(_);C&&T?!x.shiftKey&&w===T?(x.preventDefault(),n&&jl(C,{select:!0})):x.shiftKey&&w===C&&(x.preventDefault(),n&&jl(T,{select:!0})):w===_&&x.preventDefault()}},[n,r,m.paused]);return a.jsx(Yt.div,{tabIndex:-1,...o,ref:f,onKeyDown:g})});L0.displayName=yoe;function xoe(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(jl(r,{select:e}),document.activeElement!==n)return}function voe(t){const e=H3(t),n=C2(e,t),r=C2(e.reverse(),t);return[n,r]}function H3(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function C2(t,e){for(const n of t)if(!woe(n,{upTo:e}))return n}function woe(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function boe(t){return t instanceof HTMLInputElement&&"select"in t}function jl(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&boe(t)&&e&&t.select()}}var E2=_oe();function _oe(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=T2(t,e),t.unshift(e)},remove(e){var n;t=T2(t,e),(n=t[0])==null||n.resume()}}}function T2(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function Soe(t){return t.filter(e=>e.tagName!=="A")}var eS=0;function DI(){p.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??I2()),document.body.insertAdjacentElement("beforeend",t[1]??I2()),eS++,()=>{eS===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),eS--}},[])}function I2(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var js=function(){return js=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},js.apply(this,arguments)};function bf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function q3(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var Wm="right-scroll-bar-position",Hm="width-before-scroll-bar",Coe="with-scroll-bars-hidden",Eoe="--removed-body-scroll-bar-size";function tS(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Toe(t,e){var n=p.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var Ioe=typeof window<"u"?p.useLayoutEffect:p.useEffect,N2=new WeakMap;function K3(t,e){var n=Toe(e||null,function(r){return t.forEach(function(s){return tS(s,r)})});return Ioe(function(){var r=N2.get(n);if(r){var s=new Set(r),i=new Set(t),o=n.current;s.forEach(function(l){i.has(l)||tS(l,null)}),i.forEach(function(l){s.has(l)||tS(l,o)})}N2.set(n,t)},[t]),n}function Noe(t){return t}function Poe(t,e){e===void 0&&(e=Noe);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(l){return i(l)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var l=n;n=[],l.forEach(i),o=n}var c=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),n={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),n}}}};return s}function Y3(t){t===void 0&&(t={});var e=Poe(null);return e.options=js({async:!0,ssr:!1},t),e}var J3=function(t){var e=t.sideCar,n=bf(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return p.createElement(r,js({},n))};J3.isSideCarExport=!0;function Q3(t,e){return t.useMedium(e),J3}var X3=Y3(),nS=function(){},F0=p.forwardRef(function(t,e){var n=p.useRef(null),r=p.useState({onScrollCapture:nS,onWheelCapture:nS,onTouchMoveCapture:nS}),s=r[0],i=r[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,m=t.noRelative,g=t.noIsolation,x=t.inert,v=t.allowPinchZoom,w=t.as,_=w===void 0?"div":w,C=t.gapMode,T=bf(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),j=f,A=K3([n,e]),E=js(js({},T),s);return p.createElement(p.Fragment,null,d&&p.createElement(j,{sideCar:X3,removeScrollBar:u,shards:h,noRelative:m,noIsolation:g,inert:x,setCallbacks:i,allowPinchZoom:!!v,lockRef:n,gapMode:C}),o?p.cloneElement(p.Children.only(l),js(js({},E),{ref:A})):p.createElement(_,js({},E,{className:c,ref:A}),l))});F0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};F0.classNames={fullWidth:Hm,zeroRight:Wm};var P2,Aoe=function(){if(P2)return P2;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function koe(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Aoe();return e&&t.setAttribute("nonce",e),t}function joe(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Roe(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Doe=function(){var t=0,e=null;return{add:function(n){t==0&&(e=koe())&&(joe(e,n),Roe(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Moe=function(){var t=Doe();return function(e,n){p.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},MI=function(){var t=Moe(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},Loe={left:0,top:0,right:0,gap:0},rS=function(t){return parseInt(t||"",10)||0},Foe=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[rS(n),rS(r),rS(s)]},Ooe=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Loe;var e=Foe(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},$oe=MI(),Eh="data-scroll-locked",Voe=function(t,e,n,r){var s=t.left,i=t.top,o=t.right,l=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(Coe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(Eh,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Wm,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Hm,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Wm," .").concat(Wm,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Hm," .").concat(Hm,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Eh,`] {
    `).concat(Eoe,": ").concat(l,`px;
  }
`)},A2=function(){var t=parseInt(document.body.getAttribute(Eh)||"0",10);return isFinite(t)?t:0},Uoe=function(){p.useEffect(function(){return document.body.setAttribute(Eh,(A2()+1).toString()),function(){var t=A2()-1;t<=0?document.body.removeAttribute(Eh):document.body.setAttribute(Eh,t.toString())}},[])},Z3=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;Uoe();var i=p.useMemo(function(){return Ooe(s)},[s]);return p.createElement($oe,{styles:Voe(i,!e,s,n?"":"!important")})},jE=!1;if(typeof window<"u")try{var Gy=Object.defineProperty({},"passive",{get:function(){return jE=!0,!0}});window.addEventListener("test",Gy,Gy),window.removeEventListener("test",Gy,Gy)}catch{jE=!1}var Ed=jE?{passive:!1}:!1,Boe=function(t){return t.tagName==="TEXTAREA"},eU=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!Boe(t)&&n[e]==="visible")},zoe=function(t){return eU(t,"overflowY")},Goe=function(t){return eU(t,"overflowX")},k2=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=tU(t,r);if(s){var i=nU(t,r),o=i[1],l=i[2];if(o>l)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Woe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},Hoe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},tU=function(t,e){return t==="v"?zoe(e):Goe(e)},nU=function(t,e){return t==="v"?Woe(e):Hoe(e)},qoe=function(t,e){return t==="h"&&e==="rtl"?-1:1},Koe=function(t,e,n,r,s){var i=qoe(t,window.getComputedStyle(e).direction),o=i*r,l=n.target,c=e.contains(l),u=!1,d=o>0,h=0,f=0;do{var m=nU(t,l),g=m[0],x=m[1],v=m[2],w=x-v-i*g;(g||w)&&tU(t,l)&&(h+=w,f+=g),l=l.parentNode.host||l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&(s&&Math.abs(h)<1||!s&&o>h)||!d&&(s&&Math.abs(f)<1||!s&&-o>f))&&(u=!0),u},Wy=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},j2=function(t){return[t.deltaX,t.deltaY]},R2=function(t){return t&&"current"in t?t.current:t},Yoe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Joe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Qoe=0,Td=[];function Xoe(t){var e=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(Qoe++)[0],i=p.useState(MI)[0],o=p.useRef(t);p.useEffect(function(){o.current=t},[t]),p.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var x=q3([t.lockRef.current],(t.shards||[]).map(R2),!0).filter(Boolean);return x.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),x.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=p.useCallback(function(x,v){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!o.current.allowPinchZoom;var w=Wy(x),_=n.current,C="deltaX"in x?x.deltaX:_[0]-w[0],T="deltaY"in x?x.deltaY:_[1]-w[1],j,A=x.target,E=Math.abs(C)>Math.abs(T)?"h":"v";if("touches"in x&&E==="h"&&A.type==="range")return!1;var I=k2(E,A);if(!I)return!0;if(I?j=E:(j=E==="v"?"h":"v",I=k2(E,A)),!I)return!1;if(!r.current&&"changedTouches"in x&&(C||T)&&(r.current=j),!j)return!0;var N=r.current||j;return Koe(N,v,x,N==="h"?C:T,!0)},[]),c=p.useCallback(function(x){var v=x;if(!(!Td.length||Td[Td.length-1]!==i)){var w="deltaY"in v?j2(v):Wy(v),_=e.current.filter(function(j){return j.name===v.type&&(j.target===v.target||v.target===j.shadowParent)&&Yoe(j.delta,w)})[0];if(_&&_.should){v.cancelable&&v.preventDefault();return}if(!_){var C=(o.current.shards||[]).map(R2).filter(Boolean).filter(function(j){return j.contains(v.target)}),T=C.length>0?l(v,C[0]):!o.current.noIsolation;T&&v.cancelable&&v.preventDefault()}}},[]),u=p.useCallback(function(x,v,w,_){var C={name:x,delta:v,target:w,should:_,shadowParent:Zoe(w)};e.current.push(C),setTimeout(function(){e.current=e.current.filter(function(T){return T!==C})},1)},[]),d=p.useCallback(function(x){n.current=Wy(x),r.current=void 0},[]),h=p.useCallback(function(x){u(x.type,j2(x),x.target,l(x,t.lockRef.current))},[]),f=p.useCallback(function(x){u(x.type,Wy(x),x.target,l(x,t.lockRef.current))},[]);p.useEffect(function(){return Td.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Ed),document.addEventListener("touchmove",c,Ed),document.addEventListener("touchstart",d,Ed),function(){Td=Td.filter(function(x){return x!==i}),document.removeEventListener("wheel",c,Ed),document.removeEventListener("touchmove",c,Ed),document.removeEventListener("touchstart",d,Ed)}},[]);var m=t.removeScrollBar,g=t.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:Joe(s)}):null,m?p.createElement(Z3,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function Zoe(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const eae=Q3(X3,Xoe);var rU=p.forwardRef(function(t,e){return p.createElement(F0,js({},t,{ref:e,sideCar:eae}))});rU.classNames=F0.classNames;const LI=rU;var tae=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Id=new WeakMap,Hy=new WeakMap,qy={},sS=0,sU=function(t){return t&&(t.host||sU(t.parentNode))},nae=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=sU(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},rae=function(t,e,n,r){var s=nae(e,Array.isArray(t)?t:[t]);qy[n]||(qy[n]=new WeakMap);var i=qy[n],o=[],l=new Set,c=new Set(s),u=function(h){!h||l.has(h)||(l.add(h),u(h.parentNode))};s.forEach(u);var d=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(f){if(l.has(f))d(f);else try{var m=f.getAttribute(r),g=m!==null&&m!=="false",x=(Id.get(f)||0)+1,v=(i.get(f)||0)+1;Id.set(f,x),i.set(f,v),o.push(f),x===1&&g&&Hy.set(f,!0),v===1&&f.setAttribute(n,"true"),g||f.setAttribute(r,"true")}catch(w){console.error("aria-hidden: cannot operate on ",f,w)}})};return d(e),l.clear(),sS++,function(){o.forEach(function(h){var f=Id.get(h)-1,m=i.get(h)-1;Id.set(h,f),i.set(h,m),f||(Hy.has(h)||h.removeAttribute(r),Hy.delete(h)),m||h.removeAttribute(n)}),sS--,sS||(Id=new WeakMap,Id=new WeakMap,Hy=new WeakMap,qy={})}},O0=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=e||tae(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),rae(r,s,n,"aria-hidden")):function(){return null}},$0="Dialog",[iU,oU]=bi($0),[sae,zo]=iU($0),aU=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,l=p.useRef(null),c=p.useRef(null),[u,d]=Oc({prop:r,defaultProp:s??!1,onChange:i,caller:$0});return a.jsx(sae,{scope:e,triggerRef:l,contentRef:c,contentId:ic(),titleId:ic(),descriptionId:ic(),open:u,onOpenChange:d,onOpenToggle:p.useCallback(()=>d(h=>!h),[d]),modal:o,children:n})};aU.displayName=$0;var lU="DialogTrigger",cU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=zo(lU,n),i=yn(e,s.triggerRef);return a.jsx(Yt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":$I(s.open),...r,ref:i,onClick:gt(t.onClick,s.onOpenToggle)})});cU.displayName=lU;var FI="DialogPortal",[iae,uU]=iU(FI,{forceMount:void 0}),dU=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:s}=t,i=zo(FI,e);return a.jsx(iae,{scope:e,forceMount:n,children:p.Children.map(r,o=>a.jsx(vs,{present:n||i.open,children:a.jsx(_g,{asChild:!0,container:s,children:o})}))})};dU.displayName=FI;var sw="DialogOverlay",hU=p.forwardRef((t,e)=>{const n=uU(sw,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=zo(sw,t.__scopeDialog);return i.modal?a.jsx(vs,{present:r||i.open,children:a.jsx(aae,{...s,ref:e})}):null});hU.displayName=sw;var oae=Wu("DialogOverlay.RemoveScroll"),aae=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=zo(sw,n);return a.jsx(LI,{as:oae,allowPinchZoom:!0,shards:[s.contentRef],children:a.jsx(Yt.div,{"data-state":$I(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Hu="DialogContent",fU=p.forwardRef((t,e)=>{const n=uU(Hu,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=zo(Hu,t.__scopeDialog);return a.jsx(vs,{present:r||i.open,children:i.modal?a.jsx(lae,{...s,ref:e}):a.jsx(cae,{...s,ref:e})})});fU.displayName=Hu;var lae=p.forwardRef((t,e)=>{const n=zo(Hu,t.__scopeDialog),r=p.useRef(null),s=yn(e,n.contentRef,r);return p.useEffect(()=>{const i=r.current;if(i)return O0(i)},[]),a.jsx(mU,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gt(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:gt(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:gt(t.onFocusOutside,i=>i.preventDefault())})}),cae=p.forwardRef((t,e)=>{const n=zo(Hu,t.__scopeDialog),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(mU,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),mU=p.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,l=zo(Hu,n),c=p.useRef(null),u=yn(e,c);return DI(),a.jsxs(a.Fragment,{children:[a.jsx(L0,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(bg,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":$I(l.open),...o,ref:u,onDismiss:()=>l.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(dae,{titleId:l.titleId}),a.jsx(fae,{contentRef:c,descriptionId:l.descriptionId})]})]})}),OI="DialogTitle",pU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=zo(OI,n);return a.jsx(Yt.h2,{id:s.titleId,...r,ref:e})});pU.displayName=OI;var gU="DialogDescription",yU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=zo(gU,n);return a.jsx(Yt.p,{id:s.descriptionId,...r,ref:e})});yU.displayName=gU;var xU="DialogClose",vU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=zo(xU,n);return a.jsx(Yt.button,{type:"button",...r,ref:e,onClick:gt(t.onClick,()=>s.onOpenChange(!1))})});vU.displayName=xU;function $I(t){return t?"open":"closed"}var wU="DialogTitleWarning",[uae,bU]=Lse(wU,{contentName:Hu,titleName:OI,docsSlug:"dialog"}),dae=({titleId:t})=>{const e=bU(wU),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return p.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},hae="DialogDescriptionWarning",fae=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${bU(hae).contentName}}.`;return p.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},_U=aU,mae=cU,SU=dU,VI=hU,UI=fU,BI=pU,zI=yU,V0=vU;const Yr=_U,pae=SU,rl=V0,CU=ht.forwardRef(({className:t,...e},n)=>a.jsx(VI,{ref:n,className:bt("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));CU.displayName=VI.displayName;const Vr=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(pae,{children:[a.jsx(CU,{}),a.jsxs(UI,{ref:r,className:bt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,a.jsxs(V0,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(Hi,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Vr.displayName=UI.displayName;const Ur=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});Ur.displayName="DialogHeader";const Ar=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});Ar.displayName="DialogFooter";const Br=ht.forwardRef(({className:t,...e},n)=>a.jsx(BI,{ref:n,className:bt("text-lg font-semibold leading-none tracking-tight",t),...e}));Br.displayName=BI.displayName;const Qi=ht.forwardRef(({className:t,...e},n)=>a.jsx(zI,{ref:n,className:bt("text-sm text-muted-foreground",t),...e}));Qi.displayName=zI.displayName;const GI=NI("inline-flex items-center justify-center rounded-xl text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-foreground text-primary-foreground hover:bg-foreground/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-xl px-3",lg:"h-11 rounded-xl px-8",icon:"h-10 w-10 rounded-xl"}},defaultVariants:{variant:"default",size:"default"}}),O=ht.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},i)=>{const o=r?Ose:"button";return a.jsx(o,{className:bt(GI({variant:e,size:n,className:t})),ref:i,...s})});O.displayName="Button";const Je=ht.forwardRef(({className:t,type:e,...n},r)=>a.jsx("input",{type:e,className:bt("flex h-10 w-full rounded-xl bg-white dark:bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-400 dark:placeholder:text-zinc-600 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n}));Je.displayName="Input";const En=ht.forwardRef(({className:t,...e},n)=>a.jsx("textarea",{className:bt("flex min-h-[80px] w-full rounded-xl bg-white dark:bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-zinc-400 dark:placeholder:text-zinc-600 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));En.displayName="Textarea";var gae="Label",EU=p.forwardRef((t,e)=>a.jsx(Yt.label,{...t,ref:e,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));EU.displayName=gae;var TU=EU;const je=ht.forwardRef(({className:t,...e},n)=>a.jsx(TU,{ref:n,className:bt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...e}));je.displayName=TU.displayName;var yae=p.createContext(void 0);function U0(t){const e=p.useContext(yae);return t||e||"ltr"}var iS="rovingFocusGroup.onEntryFocus",xae={bubbles:!1,cancelable:!0},Tg="RovingFocusGroup",[RE,IU,vae]=_I(Tg),[wae,B0]=bi(Tg,[vae]),[bae,_ae]=wae(Tg),NU=p.forwardRef((t,e)=>a.jsx(RE.Provider,{scope:t.__scopeRovingFocusGroup,children:a.jsx(RE.Slot,{scope:t.__scopeRovingFocusGroup,children:a.jsx(Sae,{...t,ref:e})})}));NU.displayName=Tg;var Sae=p.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=t,f=p.useRef(null),m=yn(e,f),g=U0(i),[x,v]=Oc({prop:o,defaultProp:l??null,onChange:c,caller:Tg}),[w,_]=p.useState(!1),C=$r(u),T=IU(n),j=p.useRef(!1),[A,E]=p.useState(0);return p.useEffect(()=>{const I=f.current;if(I)return I.addEventListener(iS,C),()=>I.removeEventListener(iS,C)},[C]),a.jsx(bae,{scope:n,orientation:r,dir:g,loop:s,currentTabStopId:x,onItemFocus:p.useCallback(I=>v(I),[v]),onItemShiftTab:p.useCallback(()=>_(!0),[]),onFocusableItemAdd:p.useCallback(()=>E(I=>I+1),[]),onFocusableItemRemove:p.useCallback(()=>E(I=>I-1),[]),children:a.jsx(Yt.div,{tabIndex:w||A===0?-1:0,"data-orientation":r,...h,ref:m,style:{outline:"none",...t.style},onMouseDown:gt(t.onMouseDown,()=>{j.current=!0}),onFocus:gt(t.onFocus,I=>{const N=!j.current;if(I.target===I.currentTarget&&N&&!w){const k=new CustomEvent(iS,xae);if(I.currentTarget.dispatchEvent(k),!k.defaultPrevented){const R=T().filter(G=>G.focusable),D=R.find(G=>G.active),M=R.find(G=>G.id===x),B=[D,M,...R].filter(Boolean).map(G=>G.ref.current);kU(B,d)}}j.current=!1}),onBlur:gt(t.onBlur,()=>_(!1))})})}),PU="RovingFocusGroupItem",AU=p.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:o,...l}=t,c=ic(),u=i||c,d=_ae(PU,n),h=d.currentTabStopId===u,f=IU(n),{onFocusableItemAdd:m,onFocusableItemRemove:g,currentTabStopId:x}=d;return p.useEffect(()=>{if(r)return m(),()=>g()},[r,m,g]),a.jsx(RE.ItemSlot,{scope:n,id:u,focusable:r,active:s,children:a.jsx(Yt.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...l,ref:e,onMouseDown:gt(t.onMouseDown,v=>{r?d.onItemFocus(u):v.preventDefault()}),onFocus:gt(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:gt(t.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){d.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const w=Tae(v,d.orientation,d.dir);if(w!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let C=f().filter(T=>T.focusable).map(T=>T.ref.current);if(w==="last")C.reverse();else if(w==="prev"||w==="next"){w==="prev"&&C.reverse();const T=C.indexOf(v.currentTarget);C=d.loop?Iae(C,T+1):C.slice(T+1)}setTimeout(()=>kU(C))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:x!=null}):o})})});AU.displayName=PU;var Cae={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Eae(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Tae(t,e,n){const r=Eae(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Cae[r]}function kU(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function Iae(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var jU=NU,RU=AU,z0="Tabs",[Nae,SRe]=bi(z0,[B0]),DU=B0(),[Pae,WI]=Nae(z0),MU=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...u}=t,d=U0(l),[h,f]=Oc({prop:r,onChange:s,defaultProp:i??"",caller:z0});return a.jsx(Pae,{scope:n,baseId:ic(),value:h,onValueChange:f,orientation:o,dir:d,activationMode:c,children:a.jsx(Yt.div,{dir:d,"data-orientation":o,...u,ref:e})})});MU.displayName=z0;var LU="TabsList",FU=p.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...s}=t,i=WI(LU,n),o=DU(n);return a.jsx(jU,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:r,children:a.jsx(Yt.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});FU.displayName=LU;var OU="TabsTrigger",$U=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=t,o=WI(OU,n),l=DU(n),c=BU(o.baseId,r),u=zU(o.baseId,r),d=r===o.value;return a.jsx(RU,{asChild:!0,...l,focusable:!s,active:d,children:a.jsx(Yt.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...i,ref:e,onMouseDown:gt(t.onMouseDown,h=>{!s&&h.button===0&&h.ctrlKey===!1?o.onValueChange(r):h.preventDefault()}),onKeyDown:gt(t.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(r)}),onFocus:gt(t.onFocus,()=>{const h=o.activationMode!=="manual";!d&&!s&&h&&o.onValueChange(r)})})})});$U.displayName=OU;var VU="TabsContent",UU=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...o}=t,l=WI(VU,n),c=BU(l.baseId,r),u=zU(l.baseId,r),d=r===l.value,h=p.useRef(d);return p.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),a.jsx(vs,{present:s||d,children:({present:f})=>a.jsx(Yt.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:u,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});UU.displayName=VU;function BU(t,e){return`${t}-trigger-${e}`}function zU(t,e){return`${t}-content-${e}`}var Aae=MU,GU=FU,WU=$U,HU=UU;const _i=Aae,ni=ht.forwardRef(({className:t,...e},n)=>a.jsx(GU,{ref:n,className:bt("inline-flex h-10 items-center justify-center rounded-[18px] bg-white dark:bg-[#1c1c1c] p-1 text-muted-foreground",t),...e}));ni.displayName=GU.displayName;const Vt=ht.forwardRef(({className:t,...e},n)=>a.jsx(WU,{ref:n,className:bt("inline-flex items-center justify-center whitespace-nowrap rounded-xl px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-gray-100 data-[state=active]:dark:bg-zinc-700 data-[state=active]:text-foreground data-[state=active]:shadow-sm data-[state=active]:border data-[state=active]:border-[#8d9499] data-[state=active]:relative data-[state=active]:-top-px",t),...e}));Vt.displayName=WU.displayName;const Ut=ht.forwardRef(({className:t,...e},n)=>a.jsx(HU,{ref:n,className:bt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));Ut.displayName=HU.displayName;var kae="Separator",D2="horizontal",jae=["horizontal","vertical"],qU=p.forwardRef((t,e)=>{const{decorative:n,orientation:r=D2,...s}=t,i=Rae(r)?r:D2,l=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return a.jsx(Yt.div,{"data-orientation":i,...l,...s,ref:e})});qU.displayName=kae;function Rae(t){return jae.includes(t)}var KU=qU;const Ys=ht.forwardRef(({className:t,orientation:e="horizontal",decorative:n=!0,...r},s)=>a.jsx(KU,{ref:s,decorative:n,orientation:e,className:bt("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...r}));Ys.displayName=KU.displayName;const YU="AIzaSyCWUzTb8AC8d6CvHm4_MLgXSeufRQcHQAE";console.log("[geminiImageGeneration Module] VITE_GEMINI_API_KEY loaded:",`"${YU.substring(0,5)}..."`);const JU="YsU4YZtXedeyLPn6bQaNT8PD";console.log("[geminiImageGeneration Module] VITE_REMOVE_BG_API_KEY loaded:",`"${JU.substring(0,5)}..."`);const yl=YU,HI=JU,Ea=[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_NONE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_NONE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_NONE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_NONE}];async function Dae(t,e,n){var r;try{const s=[{inlineData:{mimeType:e,data:t}},{text:"Describe the main colors of this logo. Is it primarily black, white, or colorful? If black or white, state which. If colorful, list the dominant colors."}],i=await n.models.generateContent({model:"gemini-2.0-flash",contents:s,safetySettings:Ea,config:{responseModalities:[wn.TEXT]}}),o=((r=i==null?void 0:i.text)==null?void 0:r.toLowerCase())||"";return console.log("[getLogoColorType] Gemini color description:",o),o.includes("primarily black")||o.includes("black logo")?"black":o.includes("primarily white")||o.includes("white logo")?"white":(o.includes("colorful")||o.includes("multiple colors")||o.includes("various colors")||console.warn("[getLogoColorType] Could not clearly determine logo color type. Defaulting to 'colored'. Desc:",o),"colored")}catch(s){return console.error("[getLogoColorType] Error analyzing logo color:",s),"colored"}}async function Ig(t,e=(n,r)=>console.log(`Logo Progress: ${n}%, Message: ${r||""}`)){var l,c,u,d;if(!t)throw new Error("Store name is required.");const n=new On({apiKey:yl}),r=`Create a modern, clean, and professional logo for an e-commerce store named "${t}". The logo should be suitable for a website header. Avoid text in the logo itself, or if text is present, ensure it is "${t}" and highly legible. Focus on an iconic and memorable design. Generate a square image. The main subject of the logo should be prominent.`;let s="",i=null,o=null;try{console.log("[generateLogoWithGemini] Generating initial logo for:",t),e(void 0,`Generating initial logo for ${t}...`);const h=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});if((u=(c=(l=h.candidates)==null?void 0:l[0])==null?void 0:c.content)!=null&&u.parts){for(const _ of h.candidates[0].content.parts)if(_.text)s+=_.text;else if((d=_.inlineData)!=null&&d.data){i=_.inlineData.data,o=_.inlineData.mimeType;break}}if(!i)throw new Error("Failed to generate initial image data. "+(s||"No text explanation."));console.log("[generateLogoWithGemini] Initial logo generated. MimeType:",o);let f=null,m=null,g=i,x=o;if(HI)try{console.log("[generateLogoWithGemini] Removing background."),e(void 0,"Removing logo background..."),g=await QU(i,o),x="image/png",console.log("[generateLogoWithGemini] Background removed."),e(void 0,"Background removed.")}catch(_){console.warn("[generateLogoWithGemini] BG removal failed, using original:",_.message),e(void 0,"Background removal failed.")}const v=await Dae(g,x,n),w=`data:${x};base64,${g}`;if(v==="black"){m=w;try{const _=await $o(g,x,"Convert this black logo to a white logo, maintaining transparency and all details precisely. Output only the modified image.");if(_.editedImageData)f=`data:${_.newMimeType};base64,${_.editedImageData}`;else throw new Error("Inversion to white failed.")}catch(_){console.warn("[generateLogoWithGemini] Failed to make white version:",_.message),f=w}}else if(v==="white"){f=w;try{const _=await $o(g,x,"Convert this white logo to a black logo, maintaining transparency and all details precisely. Output only the modified image.");if(_.editedImageData)m=`data:${_.newMimeType};base64,${_.editedImageData}`;else throw new Error("Inversion to black failed.")}catch(_){console.warn("[generateLogoWithGemini] Failed to make black version:",_.message),m=w}}else f=w,m=w;return{logoUrlLight:f,logoUrlDark:m,textResponse:s}}catch(h){throw console.error("[generateLogoWithGemini] Main error:",h.message,h.stack),new Error(`Logo generation failed: ${h.message||"Unknown error"}`)}}async function sa(t,e,n){return console.warn("Skipping image caption generation due to environment limitations."),["Generated image description."]}function Mae(t,e){const n=atob(t),r=new Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return new Blob([new Uint8Array(r)],{type:e})}async function QU(t,e){const n=Mae(t,e),r=new FormData;r.append("size","auto"),r.append("image_file",n,"logo_temp"+(e.startsWith("image/")?"."+e.substring(6):".bin")),r.append("format","png");try{const s=await fetch("https://api.remove.bg/v1.0/removebg",{method:"POST",headers:{"X-Api-Key":HI},body:r});if(!s.ok){const o=await s.text();throw new Error(`Remove.bg API Error ${s.status}: ${o}`)}const i=await s.arrayBuffer();return btoa(new Uint8Array(i).reduce((o,l)=>o+String.fromCharCode(l),""))}catch(s){throw console.error("[removeBackgroundFromLogo] Error:",s.message),s}}async function $o(t,e,n){var i,o,l,c;if(!t||!e||!n)throw new Error("Image data, MIME type, and prompt required.");const r=new On({apiKey:yl}),s=[{text:n},{inlineData:{mimeType:e,data:t}}];try{const u=await r.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:s,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let d=null,h="",f=e;if((l=(o=(i=u.candidates)==null?void 0:i[0])==null?void 0:o.content)!=null&&l.parts){for(const m of u.candidates[0].content.parts)if(m.text)h+=m.text;else if((c=m.inlineData)!=null&&c.data){d=m.inlineData.data,f=m.inlineData.mimeType||e;break}}if(!d)throw new Error("Failed to edit image. "+(h||"No text explanation."));return{editedImageData:d,newMimeType:f,editTextResponse:h}}catch(u){throw console.error("[editImageWithGemini] Error:",u.message),new Error(`Image editing failed: ${u.message||"Unknown error"}`)}}async function XU(t,e){var s,i,o,l;if(!t)throw new Error("Product name required.");const n=new On({apiKey:yl});let r=`Generate a clean, commercial-style product image for "${t}".`;e&&(r+=` Description: "${e}".`),r+=" Main focus on product, simple/neutral/white background for e-commerce. Square image.";try{const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let u=null,d="",h="image/png";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const f of c.candidates[0].content.parts)if(f.text)d+=f.text;else if((l=f.inlineData)!=null&&l.data){u=f.inlineData.data,h=f.inlineData.mimeType||"image/png";break}}if(!u)throw new Error("Failed to generate product image. "+(d||"No text explanation."));if(HI)try{return{imageData:await QU(u,h),textResponse:d}}catch(f){console.warn("[generateGenericProductImageWithGemini] BG removal failed, using original:",f.message)}return{imageData:u,textResponse:d}}catch(c){throw console.error("[generateGenericProductImageWithGemini] Error:",c.message),new Error(`Product image generation failed: ${c.message||"Unknown error"}`)}}async function Ng({prompt:t,referenceImage:e}){var i,o,l,c;if(!t)throw new Error("Prompt required.");const n=new On({apiKey:yl});let r;const s=`Generate visually appealing image/print design to place on a product based on the following user prompt for a store generator: "${t}". Solely the image/design alone that is intended to go on products (canvas, t-shirts, mugs) not the products themselves. Square image.`;e!=null&&e.base64Data&&(e!=null&&e.mimeType)?r=[{text:`Using the provided image as a reference, generate a new image based on the following concept: "${t}". Ensure the output is suitable for print-on-demand merchandise and is a square image.`},{inlineData:{mimeType:e.mimeType,data:e.base64Data}}]:r=s;try{const u=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let d=null,h=null,f="";if((l=(o=(i=u.candidates)==null?void 0:i[0])==null?void 0:o.content)!=null&&l.parts){for(const m of u.candidates[0].content.parts)if(m.text)f+=m.text;else if((c=m.inlineData)!=null&&c.data){d=m.inlineData.data,h=m.inlineData.mimeType;break}}if(!d)throw new Error("Failed to generate image from prompt. "+(f||"No text explanation."));return{imageData:d,imageMimeType:h,textResponse:f}}catch(u){throw console.error("[generateImageFromPromptForPod] Error:",u.message),new Error(`Image generation for POD failed: ${u.message||"Unknown error"}`)}}async function Lae(t){try{const e=await fetch(t);if(!e.ok)throw console.warn(`Direct fetch for ${t} failed with status ${e.status}. Retrying without proxy for now.`),new Error(`Failed to fetch image ${t}: ${e.statusText}`);const n=await e.blob(),r=n.type;if(!r.startsWith("image/"))throw new Error(`Fetched content from ${t} is not an image. MIME type: ${r}`);const s=await n.arrayBuffer();return{base64Data:btoa(new Uint8Array(s).reduce((o,l)=>o+String.fromCharCode(l),"")),mimeType:r}}catch(e){throw console.error(`Error in fetchImageAsBase64 for ${t}:`,e),e}}async function Vp(t,e,n,r,s){var o,l,c,u;if(!t||!e||!n||!r||!s)throw console.error("[visualizeImageOnProductWithGemini] Missing required parameters."),new Error("Missing required parameters for product visualization.");const i=new On({apiKey:yl});try{console.log(`[visualizeImageOnProductWithGemini] Fetching base product image from: ${n}`);const{base64Data:d,mimeType:h}=await Lae(n);console.log(`[visualizeImageOnProductWithGemini] Fetched mockup: ${h}, length: ${d.length}`);const f={inlineData:{mimeType:e,data:t}},m={inlineData:{mimeType:h,data:d}},x=[{text:`You are an expert product visualization AI.
Task: Place the first provided image (the 'design') onto the second provided image (the '${s}' mockup).
Design Details: The design was conceptualized with the idea: "${r}".
Mockup: The mockup is a '${s}'.
Instructions:
1. Realistically superimpose the design onto the mockup.
2. Ensure the design conforms to the shape and texture of the mockup.
3. Maintain the original quality and details of both the design and the mockup where appropriate.
4. Output only the final visualized product image. Do not add any extra text or explanations in the image itself.
`},f,m];console.log(`[visualizeImageOnProductWithGemini] Calling Gemini API for ${s} with prompt: "${r}"`);const v=await i.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:x,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let w=null,_=null,C="";if((c=(l=(o=v.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const T of v.candidates[0].content.parts)if(T.text)C+=T.text;else if((u=T.inlineData)!=null&&u.data){w=T.inlineData.data,_=T.inlineData.mimeType;break}}if(console.log(`[visualizeImageOnProductWithGemini] API Text Response: ${C}`),!w)throw console.error("[visualizeImageOnProductWithGemini] Failed to get visualized image data from API.",C),new Error("Failed to visualize product. API did not return image data. "+(C||"No text explanation."));return console.log(`[visualizeImageOnProductWithGemini] Visualization successful for ${s}. MimeType: ${_}`),{visualizedImageData:w,visualizedImageMimeType:_,productDetails:{title:`Custom ${s} (Viz)`,price:24.99,description:`Unique ${s} featuring the design: "${r}".`},apiTextResponse:C}}catch(d){return console.error(`[visualizeImageOnProductWithGemini] Error visualizing ${s}:`,d),{visualizedImageData:null,visualizedImageMimeType:null,productDetails:{title:`Custom ${s}`,price:24.99,description:`Failed to visualize design on ${s}. Error: ${d.message}`},error:d.message}}}async function G0(t,e,n){var o,l,c,u;if(!t||!e||!n)throw new Error("Image data, MIME type, and product name required.");const r=new On({apiKey:yl}),s=[`Show this product, "${n}", from a slightly high front-left angle. Maintain product integrity.`,`Show this product, "${n}", from a direct side view. Maintain product integrity.`,`Show this product, "${n}", from a top-down perspective. Maintain product integrity.`],i=[];try{for(const d of s){const h=[{text:d},{inlineData:{mimeType:e,data:t}}],f=await r.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:h,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let m=null;if((c=(l=(o=f.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const g of f.candidates[0].content.parts)if((u=g.inlineData)!=null&&u.data){m=`data:${g.inlineData.mimeType};base64,${g.inlineData.data}`,i.push(m);break}}m||console.warn("[generateDifferentAnglesFromImage] No image data for one angle.")}if(i.length===0)throw new Error("Failed to generate any additional angle images.");return i}catch(d){throw console.error("[generateDifferentAnglesFromImage] Error:",d.message),new Error(`Generating different angles failed: ${d.message||"Unknown error"}`)}}async function ZU(t,e){var s,i,o,l;if(!t)throw new Error("Collection name is required to generate an image.");const n=new On({apiKey:yl});let r=`Generate a visually appealing banner image for an e-commerce collection named "${t}".`;e&&(r+=` The collection is described as: "${e}".`),r+=" The image should be thematic or abstract, suitable for a collection header or card. It should evoke the essence of the collection. Consider a wide aspect ratio like 16:9 or a square image if more appropriate for a card.";try{console.log(`[generateCollectionImageWithGemini] Generating image for collection: ${t}`);const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:[{role:"user",parts:[{text:r}]}],safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let u=null,d="image/png",h="";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const f of c.candidates[0].content.parts)if(f.text)h+=f.text;else if((l=f.inlineData)!=null&&l.data){u=f.inlineData.data,d=f.inlineData.mimeType||d;break}}if(!u)throw new Error("Failed to generate image data for the collection. "+(h||"No text explanation from AI."));return{imageData:u,imageMimeType:d,textResponse:h}}catch(c){throw console.error(`[generateCollectionImageWithGemini] Error generating image for collection "${t}":`,c),new Error(`Collection image generation failed for "${t}": ${c.message||"Unknown error"}`)}}async function e5(t,e=[]){var s,i,o,l;if(!t)throw new Error("Prompt is required.");const n=new On({apiKey:yl}),r=[{text:t}];e.forEach(c=>{r.push({inlineData:{mimeType:c.mimeType,data:c.data}})});try{const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let u=null,d="";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const h of c.candidates[0].content.parts)if(h.text)d+=h.text;else if((l=h.inlineData)!=null&&l.data){u=h.inlineData.data;break}}if(!u)throw new Error(d||"Failed to generate image. No image data returned.");return{imageData:u,text:d}}catch(c){throw console.error("[generateImage] Error:",c.message),new Error(`Image generation failed: ${c.message||"Unknown error"}`)}}async function DE(t,e,n,r=[]){var o,l,c,u;if(!t||!e||!n)throw new Error("Prompt, image data, and MIME type are required.");const s=new On({apiKey:yl}),i=[{text:t},{inlineData:{mimeType:n,data:e}}];r.forEach(d=>{i.push({inlineData:{mimeType:d.mimeType,data:d.data}})});try{const d=await s.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:i,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let h=null,f="";if((c=(l=(o=d.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const m of d.candidates[0].content.parts)if(m.text)f+=m.text;else if((u=m.inlineData)!=null&&u.data){h=m.inlineData.data;break}}if(!h)throw new Error(f||"Failed to edit image. No image data returned.");return{imageData:h,text:f}}catch(d){throw console.error("[editImage] Error:",d.message),new Error(`Image editing failed: ${d.message||"Unknown error"}`)}}const Fae=Object.freeze(Object.defineProperty({__proto__:null,editImage:DE,editImageWithGemini:$o,generateCaptionForImageData:sa,generateCollectionImageWithGemini:ZU,generateDifferentAnglesFromImage:G0,generateGenericProductImageWithGemini:XU,generateImage:e5,generateImageFromPromptForPod:Ng,generateLogoWithGemini:Ig,visualizeImageOnProductWithGemini:Vp},Symbol.toStringTag,{value:"Module"})),qI="AIzaSyCWUzTb8AC8d6CvHm4_MLgXSeufRQcHQAE",iw=new On({apiKey:qI}),Oae=async(t,e={})=>{var n,r,s;if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required.");console.log(`Starting video generation with prompt: "${t}"`);try{let i=await iw.models.generateVideos({model:"veo-2.0-generate-001",prompt:t,config:{personGeneration:"dont_allow",aspectRatio:"16:9",numberOfVideos:1,durationSeconds:6,...e}});for(console.log("Video generation operation started:",i.name);!i.done;)console.log(`Polling operation ${i.name}, current status: ${((n=i.metadata)==null?void 0:n.state)||"UNKNOWN"}`),await new Promise(l=>setTimeout(l,1e4)),i=await iw.operations.getVideosOperation({operation:i});if(console.log("Video generation operation completed:",i.name,"Done:",i.done),i.error)throw console.error("Error during video generation operation:",i.error),new Error(`Video generation failed: ${i.error.message||"Unknown error"}`);const o=(r=i.response)==null?void 0:r.generatedVideos;if(o&&o.length>0&&((s=o[0].video)!=null&&s.uri)){const c=`${o[0].video.uri}&key=${qI}`;return console.log("Generated video URI (with key appended):",c),c}else throw console.error("No video URI found in the response:",i.response),new Error("Video generation completed, but no video URI was returned.")}catch(i){throw console.error("Failed to generate video with Veo:",i),i.message&&i.message.includes("Quota")?new Error("Video generation failed due to quota limits. Please check your Google Cloud project quotas."):i.message&&i.message.includes("API key not valid")?new Error("Video generation failed due to an invalid API key. Please check your VITE_GEMINI_API_KEY."):i}},KI=async(t,e,n,r={})=>{var s,i,o;if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required.");if(!e||typeof e!="string")throw new Error("Valid base64 image data string is required.");if(!n||typeof n!="string")throw new Error("Valid image MIME type string is required.");console.log(`Starting image-to-video generation with prompt: "${t}" and image (mimeType: ${n})`);try{const l={model:"veo-2.0-generate-001",prompt:t,image:{imageBytes:e,mimeType:n},config:{personGeneration:"dont_allow",aspectRatio:"16:9",numberOfVideos:1,durationSeconds:6,...r}};console.log("Veo image-to-video payload (excluding imageBytes):",{...l,image:{mimeType:l.image.mimeType,imageBytes:"..."}});let c=await iw.models.generateVideos(l);for(console.log("Image-to-video generation operation started:",c.name);!c.done;)console.log(`Polling operation ${c.name}, current status: ${((s=c.metadata)==null?void 0:s.state)||"UNKNOWN"}`),await new Promise(d=>setTimeout(d,1e4)),c=await iw.operations.getVideosOperation({operation:c});if(console.log("Image-to-video generation operation completed:",c.name,"Done:",c.done),c.error)throw console.error("Error during image-to-video generation operation:",c.error),new Error(`Image-to-video generation failed: ${c.error.message||"Unknown error"}`);const u=(i=c.response)==null?void 0:i.generatedVideos;if(u&&u.length>0&&((o=u[0].video)!=null&&o.uri)){const h=`${u[0].video.uri}&key=${qI}`;return console.log("Generated image-to-video URI (with key appended):",h),h}else throw console.error("No video URI found in the image-to-video response:",c.response),new Error("Image-to-video generation completed, but no video URI was returned.")}catch(l){throw console.error("Failed to generate image-to-video with Veo:",l),l.message&&l.message.includes("Quota")?new Error("Image-to-video generation failed due to quota limits."):l.message&&l.message.includes("API key not valid")?new Error("Image-to-video generation failed due to an invalid API key."):l}},YI=p.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),W0=p.createContext({}),H0=p.createContext(null),q0=typeof document<"u",Pg=q0?p.useLayoutEffect:p.useEffect,t5=p.createContext({strict:!1}),JI=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),$ae="framerAppearId",n5="data-"+JI($ae);function Vae(t,e,n,r){const{visualElement:s}=p.useContext(W0),i=p.useContext(t5),o=p.useContext(H0),l=p.useContext(YI).reducedMotion,c=p.useRef();r=r||i.renderer,!c.current&&r&&(c.current=r(t,{visualState:e,parent:s,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current;p.useInsertionEffect(()=>{u&&u.update(n,o)});const d=p.useRef(!!(n[n5]&&!window.HandoffComplete));return Pg(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),p.useEffect(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,window.HandoffComplete=!0))}),u}function lh(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Uae(t,e,n){return p.useCallback(r=>{r&&t.mount&&t.mount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):lh(n)&&(n.current=r))},[e])}function Up(t){return typeof t=="string"||Array.isArray(t)}function K0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const QI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],XI=["initial",...QI];function Y0(t){return K0(t.animate)||XI.some(e=>Up(t[e]))}function r5(t){return!!(Y0(t)||t.variants)}function Bae(t,e){if(Y0(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Up(n)?n:void 0,animate:Up(r)?r:void 0}}return t.inherit!==!1?e:{}}function zae(t){const{initial:e,animate:n}=Bae(t,p.useContext(W0));return p.useMemo(()=>({initial:e,animate:n}),[M2(e),M2(n)])}function M2(t){return Array.isArray(t)?t.join(" "):t}const L2={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Bp={};for(const t in L2)Bp[t]={isEnabled:e=>L2[t].some(n=>!!e[n])};function Gae(t){for(const e in t)Bp[e]={...Bp[e],...t[e]}}const ZI=p.createContext({}),s5=p.createContext({}),Wae=Symbol.for("motionComponentSymbol");function Hae({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:s}){t&&Gae(t);function i(l,c){let u;const d={...p.useContext(YI),...l,layoutId:qae(l)},{isStatic:h}=d,f=zae(l),m=r(l,h);if(!h&&q0){f.visualElement=Vae(s,m,d,e);const g=p.useContext(s5),x=p.useContext(t5).strict;f.visualElement&&(u=f.visualElement.loadFeatures(d,x,t,g))}return p.createElement(W0.Provider,{value:f},u&&f.visualElement?p.createElement(u,{visualElement:f.visualElement,...d}):null,n(s,l,Uae(m,f.visualElement,c),m,h,f.visualElement))}const o=p.forwardRef(i);return o[Wae]=s,o}function qae({layoutId:t}){const e=p.useContext(ZI).id;return e&&t!==void 0?e+"-"+t:t}function Kae(t){function e(r,s={}){return Hae(t(r,s))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(r,s)=>(n.has(s)||n.set(s,e(s)),n.get(s))})}const Yae=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function eN(t){return typeof t!="string"||t.includes("-")?!1:!!(Yae.indexOf(t)>-1||/[A-Z]/.test(t))}const ow={};function Jae(t){Object.assign(ow,t)}const Ag=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ud=new Set(Ag);function i5(t,{layout:e,layoutId:n}){return ud.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!ow[t]||t==="opacity")}const wi=t=>!!(t&&t.getVelocity),Qae={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Xae=Ag.length;function Zae(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},r,s){let i="";for(let o=0;o<Xae;o++){const l=Ag[o];if(t[l]!==void 0){const c=Qae[l]||l;i+=`${c}(${t[l]}) `}}return e&&!t.z&&(i+="translateZ(0)"),i=i.trim(),s?i=s(t,r?"":i):n&&r&&(i="none"),i}const o5=t=>e=>typeof e=="string"&&e.startsWith(t),a5=o5("--"),ME=o5("var(--"),ele=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,tle=(t,e)=>e&&typeof t=="number"?e.transform(t):t,bc=(t,e,n)=>Math.min(Math.max(n,t),e),dd={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},qm={...dd,transform:t=>bc(0,1,t)},Ky={...dd,default:1},Km=t=>Math.round(t*1e5)/1e5,J0=/(-)?([\d]*\.?[\d])+/g,l5=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,nle=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function kg(t){return typeof t=="string"}const jg=t=>({test:e=>kg(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Rl=jg("deg"),ma=jg("%"),Bt=jg("px"),rle=jg("vh"),sle=jg("vw"),F2={...ma,parse:t=>ma.parse(t)/100,transform:t=>ma.transform(t*100)},O2={...dd,transform:Math.round},c5={borderWidth:Bt,borderTopWidth:Bt,borderRightWidth:Bt,borderBottomWidth:Bt,borderLeftWidth:Bt,borderRadius:Bt,radius:Bt,borderTopLeftRadius:Bt,borderTopRightRadius:Bt,borderBottomRightRadius:Bt,borderBottomLeftRadius:Bt,width:Bt,maxWidth:Bt,height:Bt,maxHeight:Bt,size:Bt,top:Bt,right:Bt,bottom:Bt,left:Bt,padding:Bt,paddingTop:Bt,paddingRight:Bt,paddingBottom:Bt,paddingLeft:Bt,margin:Bt,marginTop:Bt,marginRight:Bt,marginBottom:Bt,marginLeft:Bt,rotate:Rl,rotateX:Rl,rotateY:Rl,rotateZ:Rl,scale:Ky,scaleX:Ky,scaleY:Ky,scaleZ:Ky,skew:Rl,skewX:Rl,skewY:Rl,distance:Bt,translateX:Bt,translateY:Bt,translateZ:Bt,x:Bt,y:Bt,z:Bt,perspective:Bt,transformPerspective:Bt,opacity:qm,originX:F2,originY:F2,originZ:Bt,zIndex:O2,fillOpacity:qm,strokeOpacity:qm,numOctaves:O2};function tN(t,e,n,r){const{style:s,vars:i,transform:o,transformOrigin:l}=t;let c=!1,u=!1,d=!0;for(const h in e){const f=e[h];if(a5(h)){i[h]=f;continue}const m=c5[h],g=tle(f,m);if(ud.has(h)){if(c=!0,o[h]=g,!d)continue;f!==(m.default||0)&&(d=!1)}else h.startsWith("origin")?(u=!0,l[h]=g):s[h]=g}if(e.transform||(c||r?s.transform=Zae(t.transform,n,d,r):s.transform&&(s.transform="none")),u){const{originX:h="50%",originY:f="50%",originZ:m=0}=l;s.transformOrigin=`${h} ${f} ${m}`}}const nN=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function u5(t,e,n){for(const r in e)!wi(e[r])&&!i5(r,n)&&(t[r]=e[r])}function ile({transformTemplate:t},e,n){return p.useMemo(()=>{const r=nN();return tN(r,e,{enableHardwareAcceleration:!n},t),Object.assign({},r.vars,r.style)},[e])}function ole(t,e,n){const r=t.style||{},s={};return u5(s,r,t),Object.assign(s,ile(t,e,n)),t.transformValues?t.transformValues(s):s}function ale(t,e,n){const r={},s=ole(t,e,n);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=s,r}const lle=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function aw(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||lle.has(t)}let d5=t=>!aw(t);function cle(t){t&&(d5=e=>e.startsWith("on")?!aw(e):t(e))}try{cle(require("@emotion/is-prop-valid").default)}catch{}function ule(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(d5(s)||n===!0&&aw(s)||!e&&!aw(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}function $2(t,e,n){return typeof t=="string"?t:Bt.transform(e+n*t)}function dle(t,e,n){const r=$2(e,t.x,t.width),s=$2(n,t.y,t.height);return`${r} ${s}`}const hle={offset:"stroke-dashoffset",array:"stroke-dasharray"},fle={offset:"strokeDashoffset",array:"strokeDasharray"};function mle(t,e,n=1,r=0,s=!0){t.pathLength=1;const i=s?hle:fle;t[i.offset]=Bt.transform(-r);const o=Bt.transform(e),l=Bt.transform(n);t[i.array]=`${o} ${l}`}function rN(t,{attrX:e,attrY:n,attrScale:r,originX:s,originY:i,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...u},d,h,f){if(tN(t,u,d,f),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:g,dimensions:x}=t;m.transform&&(x&&(g.transform=m.transform),delete m.transform),x&&(s!==void 0||i!==void 0||g.transform)&&(g.transformOrigin=dle(x,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(m.x=e),n!==void 0&&(m.y=n),r!==void 0&&(m.scale=r),o!==void 0&&mle(m,o,l,c,!1)}const h5=()=>({...nN(),attrs:{}}),sN=t=>typeof t=="string"&&t.toLowerCase()==="svg";function ple(t,e,n,r){const s=p.useMemo(()=>{const i=h5();return rN(i,e,{enableHardwareAcceleration:!1},sN(r),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};u5(i,t.style,t),s.style={...i,...s.style}}return s}function gle(t=!1){return(n,r,s,{latestValues:i},o)=>{const c=(eN(n)?ple:ale)(r,i,o,n),d={...ule(r,typeof n=="string",t),...c,ref:s},{children:h}=r,f=p.useMemo(()=>wi(h)?h.get():h,[h]);return p.createElement(n,{...d,children:f})}}function f5(t,{style:e,vars:n},r,s){Object.assign(t.style,e,s&&s.getProjectionStyles(r));for(const i in n)t.style.setProperty(i,n[i])}const m5=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function p5(t,e,n,r){f5(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(m5.has(s)?s:JI(s),e.attrs[s])}function iN(t,e){const{style:n}=t,r={};for(const s in n)(wi(n[s])||e.style&&wi(e.style[s])||i5(s,t))&&(r[s]=n[s]);return r}function g5(t,e){const n=iN(t,e);for(const r in t)if(wi(t[r])||wi(e[r])){const s=Ag.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[s]=t[r]}return n}function oN(t,e,n,r={},s={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),e}function Rg(t){const e=p.useRef(null);return e.current===null&&(e.current=t()),e.current}const lw=t=>Array.isArray(t),yle=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),xle=t=>lw(t)?t[t.length-1]||0:t;function Hx(t){const e=wi(t)?t.get():t;return yle(e)?e.toValue():e}function vle({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},r,s,i){const o={latestValues:wle(r,s,i,t),renderState:e()};return n&&(o.mount=l=>n(r,l,o)),o}const y5=t=>(e,n)=>{const r=p.useContext(W0),s=p.useContext(H0),i=()=>vle(t,e,r,s);return n?i():Rg(i)};function wle(t,e,n,r){const s={},i=r(t,{});for(const f in i)s[f]=Hx(i[f]);let{initial:o,animate:l}=t;const c=Y0(t),u=r5(t);e&&u&&!c&&t.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let d=n?n.initial===!1:!1;d=d||o===!1;const h=d?l:o;return h&&typeof h!="boolean"&&!K0(h)&&(Array.isArray(h)?h:[h]).forEach(m=>{const g=oN(t,m);if(!g)return;const{transitionEnd:x,transition:v,...w}=g;for(const _ in w){let C=w[_];if(Array.isArray(C)){const T=d?C.length-1:0;C=C[T]}C!==null&&(s[_]=C)}for(const _ in x)s[_]=x[_]}),s}const Ir=t=>t;class V2{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function ble(t){let e=new V2,n=new V2,r=0,s=!1,i=!1;const o=new WeakSet,l={schedule:(c,u=!1,d=!1)=>{const h=d&&s,f=h?e:n;return u&&o.add(c),f.add(c)&&h&&s&&(r=e.order.length),c},cancel:c=>{n.remove(c),o.delete(c)},process:c=>{if(s){i=!0;return}if(s=!0,[e,n]=[n,e],n.clear(),r=e.order.length,r)for(let u=0;u<r;u++){const d=e.order[u];d(c),o.has(d)&&(l.schedule(d),t())}s=!1,i&&(i=!1,l.process(c))}};return l}const Yy=["prepare","read","update","preRender","render","postRender"],_le=40;function Sle(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=Yy.reduce((h,f)=>(h[f]=ble(()=>n=!0),h),{}),o=h=>i[h].process(s),l=()=>{const h=performance.now();n=!1,s.delta=r?1e3/60:Math.max(Math.min(h-s.timestamp,_le),1),s.timestamp=h,s.isProcessing=!0,Yy.forEach(o),s.isProcessing=!1,n&&e&&(r=!1,t(l))},c=()=>{n=!0,r=!0,s.isProcessing||t(l)};return{schedule:Yy.reduce((h,f)=>{const m=i[f];return h[f]=(g,x=!1,v=!1)=>(n||c(),m.schedule(g,x,v)),h},{}),cancel:h=>Yy.forEach(f=>i[f].cancel(h)),state:s,steps:i}}const{schedule:_n,cancel:Vo,state:hs,steps:oS}=Sle(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ir,!0),Cle={useVisualState:y5({scrapeMotionValuesFromProps:g5,createRenderState:h5,onMount:(t,e,{renderState:n,latestValues:r})=>{_n.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),_n.render(()=>{rN(n,r,{enableHardwareAcceleration:!1},sN(e.tagName),t.transformTemplate),p5(e,n)})}})},Ele={useVisualState:y5({scrapeMotionValuesFromProps:iN,createRenderState:nN})};function Tle(t,{forwardMotionProps:e=!1},n,r){return{...eN(t)?Cle:Ele,preloadedFeatures:n,useRender:gle(e),createVisualElement:r,Component:t}}function Ba(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const x5=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function Q0(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const Ile=t=>e=>x5(e)&&t(e,Q0(e));function Ka(t,e,n,r){return Ba(t,e,Ile(n),r)}const Nle=(t,e)=>n=>e(t(n)),oc=(...t)=>t.reduce(Nle);function v5(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const U2=v5("dragHorizontal"),B2=v5("dragVertical");function w5(t){let e=!1;if(t==="y")e=B2();else if(t==="x")e=U2();else{const n=U2(),r=B2();n&&r?e=()=>{n(),r()}:(n&&n(),r&&r())}return e}function b5(){const t=w5(!0);return t?(t(),!1):!0}class $c{constructor(e){this.isMounted=!1,this.node=e}update(){}}function z2(t,e){const n="pointer"+(e?"enter":"leave"),r="onHover"+(e?"Start":"End"),s=(i,o)=>{if(i.pointerType==="touch"||b5())return;const l=t.getProps();t.animationState&&l.whileHover&&t.animationState.setActive("whileHover",e),l[r]&&_n.update(()=>l[r](i,o))};return Ka(t.current,n,s,{passive:!t.getProps()[r]})}class Ple extends $c{mount(){this.unmount=oc(z2(this.node,!0),z2(this.node,!1))}unmount(){}}class Ale extends $c{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=oc(Ba(this.node.current,"focus",()=>this.onFocus()),Ba(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const _5=(t,e)=>e?t===e?!0:_5(t,e.parentElement):!1;function aS(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,Q0(n))}class kle extends $c{constructor(){super(...arguments),this.removeStartListeners=Ir,this.removeEndListeners=Ir,this.removeAccessibleListeners=Ir,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const r=this.node.getProps(),i=Ka(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:d,globalTapTarget:h}=this.node.getProps();_n.update(()=>{!h&&!_5(this.node.current,l.target)?d&&d(l,c):u&&u(l,c)})},{passive:!(r.onTap||r.onPointerUp)}),o=Ka(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=oc(i,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=l=>{l.key!=="Enter"||!this.checkPressEnd()||aS("up",(c,u)=>{const{onTap:d}=this.node.getProps();d&&_n.update(()=>d(c,u))})};this.removeEndListeners(),this.removeEndListeners=Ba(this.node.current,"keyup",o),aS("down",(l,c)=>{this.startPress(l,c)})},n=Ba(this.node.current,"keydown",e),r=()=>{this.isPressing&&aS("cancel",(i,o)=>this.cancelPress(i,o))},s=Ba(this.node.current,"blur",r);this.removeAccessibleListeners=oc(n,s)}}startPress(e,n){this.isPressing=!0;const{onTapStart:r,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&_n.update(()=>r(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!b5()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&_n.update(()=>r(e,n))}mount(){const e=this.node.getProps(),n=Ka(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),r=Ba(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=oc(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const LE=new WeakMap,lS=new WeakMap,jle=t=>{const e=LE.get(t.target);e&&e(t)},Rle=t=>{t.forEach(jle)};function Dle({root:t,...e}){const n=t||document;lS.has(n)||lS.set(n,{});const r=lS.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(Rle,{root:t,...e})),r[s]}function Mle(t,e,n){const r=Dle(e);return LE.set(t,n),r.observe(t),()=>{LE.delete(t),r.unobserve(t)}}const Lle={some:0,all:1};class Fle extends $c{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:Lle[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:h}=this.node.getProps(),f=u?d:h;f&&f(c)};return Mle(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Ole(e,n))&&this.startObserver()}unmount(){}}function Ole({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const $le={inView:{Feature:Fle},tap:{Feature:kle},focus:{Feature:Ale},hover:{Feature:Ple}};function S5(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function Vle(t){const e={};return t.values.forEach((n,r)=>e[r]=n.get()),e}function Ule(t){const e={};return t.values.forEach((n,r)=>e[r]=n.getVelocity()),e}function X0(t,e,n){const r=t.getProps();return oN(r,e,n!==void 0?n:r.custom,Vle(t),Ule(t))}let C5=Ir,Z0=Ir;const ac=t=>t*1e3,Ya=t=>t/1e3,Ble={current:!1},E5=t=>Array.isArray(t)&&typeof t[0]=="number";function T5(t){return!!(!t||typeof t=="string"&&I5[t]||E5(t)||Array.isArray(t)&&t.every(T5))}const vm=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,I5={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:vm([0,.65,.55,1]),circOut:vm([.55,0,1,.45]),backIn:vm([.31,.01,.66,-.59]),backOut:vm([.33,1.53,.69,.99])};function N5(t){if(t)return E5(t)?vm(t):Array.isArray(t)?t.map(N5):I5[t]}function zle(t,e,n,{delay:r=0,duration:s,repeat:i=0,repeatType:o="loop",ease:l,times:c}={}){const u={[e]:n};c&&(u.offset=c);const d=N5(l);return Array.isArray(d)&&(u.easing=d),t.animate(u,{delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function Gle(t,{repeat:e,repeatType:n="loop"}){const r=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[r]}const P5=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,Wle=1e-7,Hle=12;function qle(t,e,n,r,s){let i,o,l=0;do o=e+(n-e)/2,i=P5(o,r,s)-t,i>0?n=o:e=o;while(Math.abs(i)>Wle&&++l<Hle);return o}function Dg(t,e,n,r){if(t===e&&n===r)return Ir;const s=i=>qle(i,0,1,t,n);return i=>i===0||i===1?i:P5(s(i),e,r)}const Kle=Dg(.42,0,1,1),Yle=Dg(0,0,.58,1),A5=Dg(.42,0,.58,1),Jle=t=>Array.isArray(t)&&typeof t[0]!="number",k5=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,j5=t=>e=>1-t(1-e),aN=t=>1-Math.sin(Math.acos(t)),R5=j5(aN),Qle=k5(aN),D5=Dg(.33,1.53,.69,.99),lN=j5(D5),Xle=k5(lN),Zle=t=>(t*=2)<1?.5*lN(t):.5*(2-Math.pow(2,-10*(t-1))),ece={linear:Ir,easeIn:Kle,easeInOut:A5,easeOut:Yle,circIn:aN,circInOut:Qle,circOut:R5,backIn:lN,backInOut:Xle,backOut:D5,anticipate:Zle},G2=t=>{if(Array.isArray(t)){Z0(t.length===4);const[e,n,r,s]=t;return Dg(e,n,r,s)}else if(typeof t=="string")return ece[t];return t},cN=(t,e)=>n=>!!(kg(n)&&nle.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),M5=(t,e,n)=>r=>{if(!kg(r))return r;const[s,i,o,l]=r.match(J0);return{[t]:parseFloat(s),[e]:parseFloat(i),[n]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},tce=t=>bc(0,255,t),cS={...dd,transform:t=>Math.round(tce(t))},Tu={test:cN("rgb","red"),parse:M5("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+cS.transform(t)+", "+cS.transform(e)+", "+cS.transform(n)+", "+Km(qm.transform(r))+")"};function nce(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const FE={test:cN("#"),parse:nce,transform:Tu.transform},ch={test:cN("hsl","hue"),parse:M5("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+ma.transform(Km(e))+", "+ma.transform(Km(n))+", "+Km(qm.transform(r))+")"},Ws={test:t=>Tu.test(t)||FE.test(t)||ch.test(t),parse:t=>Tu.test(t)?Tu.parse(t):ch.test(t)?ch.parse(t):FE.parse(t),transform:t=>kg(t)?t:t.hasOwnProperty("red")?Tu.transform(t):ch.transform(t)},fr=(t,e,n)=>-n*t+n*e+t;function uS(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function rce({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,i=0,o=0;if(!e)s=i=o=n;else{const l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;s=uS(c,l,t+1/3),i=uS(c,l,t),o=uS(c,l,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}const dS=(t,e,n)=>{const r=t*t;return Math.sqrt(Math.max(0,n*(e*e-r)+r))},sce=[FE,Tu,ch],ice=t=>sce.find(e=>e.test(t));function W2(t){const e=ice(t);let n=e.parse(t);return e===ch&&(n=rce(n)),n}const L5=(t,e)=>{const n=W2(t),r=W2(e),s={...n};return i=>(s.red=dS(n.red,r.red,i),s.green=dS(n.green,r.green,i),s.blue=dS(n.blue,r.blue,i),s.alpha=fr(n.alpha,r.alpha,i),Tu.transform(s))};function oce(t){var e,n;return isNaN(t)&&kg(t)&&(((e=t.match(J0))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(l5))===null||n===void 0?void 0:n.length)||0)>0}const F5={regex:ele,countKey:"Vars",token:"${v}",parse:Ir},O5={regex:l5,countKey:"Colors",token:"${c}",parse:Ws.parse},$5={regex:J0,countKey:"Numbers",token:"${n}",parse:dd.parse};function hS(t,{regex:e,countKey:n,token:r,parse:s}){const i=t.tokenised.match(e);i&&(t["num"+n]=i.length,t.tokenised=t.tokenised.replace(e,r),t.values.push(...i.map(s)))}function cw(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&hS(n,F5),hS(n,O5),hS(n,$5),n}function V5(t){return cw(t).values}function U5(t){const{values:e,numColors:n,numVars:r,tokenised:s}=cw(t),i=e.length;return o=>{let l=s;for(let c=0;c<i;c++)c<r?l=l.replace(F5.token,o[c]):c<r+n?l=l.replace(O5.token,Ws.transform(o[c])):l=l.replace($5.token,Km(o[c]));return l}}const ace=t=>typeof t=="number"?0:t;function lce(t){const e=V5(t);return U5(t)(e.map(ace))}const _c={test:oce,parse:V5,createTransformer:U5,getAnimatableNone:lce},B5=(t,e)=>n=>`${n>0?e:t}`;function z5(t,e){return typeof t=="number"?n=>fr(t,e,n):Ws.test(t)?L5(t,e):t.startsWith("var(")?B5(t,e):W5(t,e)}const G5=(t,e)=>{const n=[...t],r=n.length,s=t.map((i,o)=>z5(i,e[o]));return i=>{for(let o=0;o<r;o++)n[o]=s[o](i);return n}},cce=(t,e)=>{const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=z5(t[s],e[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}},W5=(t,e)=>{const n=_c.createTransformer(e),r=cw(t),s=cw(e);return r.numVars===s.numVars&&r.numColors===s.numColors&&r.numNumbers>=s.numNumbers?oc(G5(r.values,s.values),n):B5(t,e)},Wh=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},H2=(t,e)=>n=>fr(t,e,n);function uce(t){return typeof t=="number"?H2:typeof t=="string"?Ws.test(t)?L5:W5:Array.isArray(t)?G5:typeof t=="object"?cce:H2}function dce(t,e,n){const r=[],s=n||uce(t[0]),i=t.length-1;for(let o=0;o<i;o++){let l=s(t[o],t[o+1]);if(e){const c=Array.isArray(e)?e[o]||Ir:e;l=oc(c,l)}r.push(l)}return r}function eb(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const i=t.length;if(Z0(i===e.length),i===1)return()=>e[0];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=dce(e,r,s),l=o.length,c=u=>{let d=0;if(l>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const h=Wh(t[d],t[d+1],u);return o[d](h)};return n?u=>c(bc(t[0],t[i-1],u)):c}function hce(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=Wh(0,e,r);t.push(fr(n,1,s))}}function H5(t){const e=[0];return hce(e,t.length-1),e}function fce(t,e){return t.map(n=>n*e)}function mce(t,e){return t.map(()=>e||A5).splice(0,t.length-1)}function uw({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=Jle(r)?r.map(G2):G2(r),i={done:!1,value:e[0]},o=fce(n&&n.length===e.length?n:H5(e),t),l=eb(o,e,{ease:Array.isArray(s)?s:mce(e,s)});return{calculatedDuration:t,next:c=>(i.value=l(c),i.done=c>=t,i)}}function uN(t,e){return e?t*(1e3/e):0}const pce=5;function q5(t,e,n){const r=Math.max(e-pce,0);return uN(n-t(r),e-r)}const fS=.001,gce=.01,q2=10,yce=.05,xce=1;function vce({duration:t=800,bounce:e=.25,velocity:n=0,mass:r=1}){let s,i;C5(t<=ac(q2));let o=1-e;o=bc(yce,xce,o),t=bc(gce,q2,Ya(t)),o<1?(s=u=>{const d=u*o,h=d*t,f=d-n,m=OE(u,o),g=Math.exp(-h);return fS-f/m*g},i=u=>{const h=u*o*t,f=h*n+n,m=Math.pow(o,2)*Math.pow(u,2)*t,g=Math.exp(-h),x=OE(Math.pow(u,2),o);return(-s(u)+fS>0?-1:1)*((f-m)*g)/x}):(s=u=>{const d=Math.exp(-u*t),h=(u-n)*t+1;return-fS+d*h},i=u=>{const d=Math.exp(-u*t),h=(n-u)*(t*t);return d*h});const l=5/t,c=bce(s,i,l);if(t=ac(t),isNaN(c))return{stiffness:100,damping:10,duration:t};{const u=Math.pow(c,2)*r;return{stiffness:u,damping:o*2*Math.sqrt(r*u),duration:t}}}const wce=12;function bce(t,e,n){let r=n;for(let s=1;s<wce;s++)r=r-t(r)/e(r);return r}function OE(t,e){return t*Math.sqrt(1-e*e)}const _ce=["duration","bounce"],Sce=["stiffness","damping","mass"];function K2(t,e){return e.some(n=>t[n]!==void 0)}function Cce(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!K2(t,Sce)&&K2(t,_ce)){const n=vce(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function K5({keyframes:t,restDelta:e,restSpeed:n,...r}){const s=t[0],i=t[t.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:f}=Cce({...r,velocity:-Ya(r.velocity||0)}),m=h||0,g=c/(2*Math.sqrt(l*u)),x=i-s,v=Ya(Math.sqrt(l/u)),w=Math.abs(x)<5;n||(n=w?.01:2),e||(e=w?.005:.5);let _;if(g<1){const C=OE(v,g);_=T=>{const j=Math.exp(-g*v*T);return i-j*((m+g*v*x)/C*Math.sin(C*T)+x*Math.cos(C*T))}}else if(g===1)_=C=>i-Math.exp(-v*C)*(x+(m+v*x)*C);else{const C=v*Math.sqrt(g*g-1);_=T=>{const j=Math.exp(-g*v*T),A=Math.min(C*T,300);return i-j*((m+g*v*x)*Math.sinh(A)+C*x*Math.cosh(A))/C}}return{calculatedDuration:f&&d||null,next:C=>{const T=_(C);if(f)o.done=C>=d;else{let j=m;C!==0&&(g<1?j=q5(_,C,T):j=0);const A=Math.abs(j)<=n,E=Math.abs(i-T)<=e;o.done=A&&E}return o.value=o.done?i:T,o}}}function Y2({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:c,restDelta:u=.5,restSpeed:d}){const h=t[0],f={done:!1,value:h},m=I=>l!==void 0&&I<l||c!==void 0&&I>c,g=I=>l===void 0?c:c===void 0||Math.abs(l-I)<Math.abs(c-I)?l:c;let x=n*e;const v=h+x,w=o===void 0?v:o(v);w!==v&&(x=w-h);const _=I=>-x*Math.exp(-I/r),C=I=>w+_(I),T=I=>{const N=_(I),k=C(I);f.done=Math.abs(N)<=u,f.value=f.done?w:k};let j,A;const E=I=>{m(f.value)&&(j=I,A=K5({keyframes:[f.value,g(f.value)],velocity:q5(C,I,f.value),damping:s,stiffness:i,restDelta:u,restSpeed:d}))};return E(0),{calculatedDuration:null,next:I=>{let N=!1;return!A&&j===void 0&&(N=!0,T(I),E(I)),j!==void 0&&I>j?A.next(I-j):(!N&&T(I),f)}}}const Ece=t=>{const e=({timestamp:n})=>t(n);return{start:()=>_n.update(e,!0),stop:()=>Vo(e),now:()=>hs.isProcessing?hs.timestamp:performance.now()}},J2=2e4;function Q2(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<J2;)e+=n,r=t.next(e);return e>=J2?1/0:e}const Tce={decay:Y2,inertia:Y2,tween:uw,keyframes:uw,spring:K5};function dw({autoplay:t=!0,delay:e=0,driver:n=Ece,keyframes:r,type:s="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:l="loop",onPlay:c,onStop:u,onComplete:d,onUpdate:h,...f}){let m=1,g=!1,x,v;const w=()=>{v=new Promise(V=>{x=V})};w();let _;const C=Tce[s]||uw;let T;C!==uw&&typeof r[0]!="number"&&(T=eb([0,100],r,{clamp:!1}),r=[0,100]);const j=C({...f,keyframes:r});let A;l==="mirror"&&(A=C({...f,keyframes:[...r].reverse(),velocity:-(f.velocity||0)}));let E="idle",I=null,N=null,k=null;j.calculatedDuration===null&&i&&(j.calculatedDuration=Q2(j));const{calculatedDuration:R}=j;let D=1/0,M=1/0;R!==null&&(D=R+o,M=D*(i+1)-o);let z=0;const B=V=>{if(N===null)return;m>0&&(N=Math.min(N,V)),m<0&&(N=Math.min(V-M/m,N)),I!==null?z=I:z=Math.round(V-N)*m;const W=z-e*(m>=0?1:-1),F=m>=0?W<0:W>M;z=Math.max(W,0),E==="finished"&&I===null&&(z=M);let Z=z,ce=j;if(i){const Ve=Math.min(z,M)/D;let Be=Math.floor(Ve),ue=Ve%1;!ue&&Ve>=1&&(ue=1),ue===1&&Be--,Be=Math.min(Be,i+1),!!(Be%2)&&(l==="reverse"?(ue=1-ue,o&&(ue-=o/D)):l==="mirror"&&(ce=A)),Z=bc(0,1,ue)*D}const le=F?{done:!1,value:r[0]}:ce.next(Z);T&&(le.value=T(le.value));let{done:he}=le;!F&&R!==null&&(he=m>=0?z>=M:z<=0);const Le=I===null&&(E==="finished"||E==="running"&&he);return h&&h(le.value),Le&&H(),le},G=()=>{_&&_.stop(),_=void 0},Y=()=>{E="idle",G(),x(),w(),N=k=null},H=()=>{E="finished",d&&d(),G(),x()},K=()=>{if(g)return;_||(_=n(B));const V=_.now();c&&c(),I!==null?N=V-I:(!N||E==="finished")&&(N=V),E==="finished"&&w(),k=N,I=null,E="running",_.start()};t&&K();const $={then(V,W){return v.then(V,W)},get time(){return Ya(z)},set time(V){V=ac(V),z=V,I!==null||!_||m===0?I=V:N=_.now()-V/m},get duration(){const V=j.calculatedDuration===null?Q2(j):j.calculatedDuration;return Ya(V)},get speed(){return m},set speed(V){V===m||!_||(m=V,$.time=Ya(z))},get state(){return E},play:K,pause:()=>{E="paused",I=z},stop:()=>{g=!0,E!=="idle"&&(E="idle",u&&u(),Y())},cancel:()=>{k!==null&&B(k),Y()},complete:()=>{E="finished"},sample:V=>(N=0,B(V))};return $}function Ice(t){let e;return()=>(e===void 0&&(e=t()),e)}const Nce=Ice(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Pce=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Jy=10,Ace=2e4,kce=(t,e)=>e.type==="spring"||t==="backgroundColor"||!T5(e.ease);function jce(t,e,{onUpdate:n,onComplete:r,...s}){if(!(Nce()&&Pce.has(e)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let o=!1,l,c,u=!1;const d=()=>{c=new Promise(C=>{l=C})};d();let{keyframes:h,duration:f=300,ease:m,times:g}=s;if(kce(e,s)){const C=dw({...s,repeat:0,delay:0});let T={done:!1,value:h[0]};const j=[];let A=0;for(;!T.done&&A<Ace;)T=C.sample(A),j.push(T.value),A+=Jy;g=void 0,h=j,f=A-Jy,m="linear"}const x=zle(t.owner.current,e,h,{...s,duration:f,ease:m,times:g}),v=()=>{u=!1,x.cancel()},w=()=>{u=!0,_n.update(v),l(),d()};return x.onfinish=()=>{u||(t.set(Gle(h,s)),r&&r(),w())},{then(C,T){return c.then(C,T)},attachTimeline(C){return x.timeline=C,x.onfinish=null,Ir},get time(){return Ya(x.currentTime||0)},set time(C){x.currentTime=ac(C)},get speed(){return x.playbackRate},set speed(C){x.playbackRate=C},get duration(){return Ya(f)},play:()=>{o||(x.play(),Vo(v))},pause:()=>x.pause(),stop:()=>{if(o=!0,x.playState==="idle")return;const{currentTime:C}=x;if(C){const T=dw({...s,autoplay:!1});t.setWithVelocity(T.sample(C-Jy).value,T.sample(C).value,Jy)}w()},complete:()=>{u||x.finish()},cancel:w}}function Rce({keyframes:t,delay:e,onUpdate:n,onComplete:r}){const s=()=>(n&&n(t[t.length-1]),r&&r(),{time:0,speed:1,duration:0,play:Ir,pause:Ir,stop:Ir,then:i=>(i(),Promise.resolve()),cancel:Ir,complete:Ir});return e?dw({keyframes:[0,1],duration:0,delay:e,onComplete:s}):s()}const Dce={type:"spring",stiffness:500,damping:25,restSpeed:10},Mce=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Lce={type:"keyframes",duration:.8},Fce={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Oce=(t,{keyframes:e})=>e.length>2?Lce:ud.has(t)?t.startsWith("scale")?Mce(e[1]):Dce:Fce,$E=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(_c.test(e)||e==="0")&&!e.startsWith("url(")),$ce=new Set(["brightness","contrast","saturate","opacity"]);function Vce(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(J0)||[];if(!r)return t;const s=n.replace(r,"");let i=$ce.has(e)?1:0;return r!==n&&(i*=100),e+"("+i+s+")"}const Uce=/([a-z-]*)\(.*?\)/g,VE={..._c,getAnimatableNone:t=>{const e=t.match(Uce);return e?e.map(Vce).join(" "):t}},Bce={...c5,color:Ws,backgroundColor:Ws,outlineColor:Ws,fill:Ws,stroke:Ws,borderColor:Ws,borderTopColor:Ws,borderRightColor:Ws,borderBottomColor:Ws,borderLeftColor:Ws,filter:VE,WebkitFilter:VE},dN=t=>Bce[t];function Y5(t,e){let n=dN(t);return n!==VE&&(n=_c),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const J5=t=>/^0[^.\s]+$/.test(t);function zce(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||J5(t)}function Gce(t,e,n,r){const s=$E(e,n);let i;Array.isArray(n)?i=[...n]:i=[null,n];const o=r.from!==void 0?r.from:t.get();let l;const c=[];for(let u=0;u<i.length;u++)i[u]===null&&(i[u]=u===0?o:i[u-1]),zce(i[u])&&c.push(u),typeof i[u]=="string"&&i[u]!=="none"&&i[u]!=="0"&&(l=i[u]);if(s&&c.length&&l)for(let u=0;u<c.length;u++){const d=c[u];i[d]=Y5(e,l)}return i}function Wce({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}function hN(t,e){return t[e]||t.default||t}const Hce={skipAnimations:!1},fN=(t,e,n,r={})=>s=>{const i=hN(r,t)||{},o=i.delay||r.delay||0;let{elapsed:l=0}=r;l=l-ac(o);const c=Gce(e,t,n,i),u=c[0],d=c[c.length-1],h=$E(t,u),f=$E(t,d);let m={keyframes:c,velocity:e.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:g=>{e.set(g),i.onUpdate&&i.onUpdate(g)},onComplete:()=>{s(),i.onComplete&&i.onComplete()}};if(Wce(i)||(m={...m,...Oce(t,m)}),m.duration&&(m.duration=ac(m.duration)),m.repeatDelay&&(m.repeatDelay=ac(m.repeatDelay)),!h||!f||Ble.current||i.type===!1||Hce.skipAnimations)return Rce(m);if(!r.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const g=jce(e,t,m);if(g)return g}return dw(m)};function hw(t){return!!(wi(t)&&t.add)}const Q5=t=>/^\-?\d*\.?\d+$/.test(t);function mN(t,e){t.indexOf(e)===-1&&t.push(e)}function pN(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class gN{constructor(){this.subscriptions=[]}add(e){return mN(this.subscriptions,e),()=>pN(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const qce=t=>!isNaN(parseFloat(t)),Ym={current:void 0};class Kce{constructor(e,n={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(r,s=!0)=>{this.prev=this.current,this.current=r;const{delta:i,timestamp:o}=hs;this.lastUpdated!==o&&(this.timeDelta=i,this.lastUpdated=o,_n.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>_n.postRender(this.velocityCheck),this.velocityCheck=({timestamp:r})=>{r!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=qce(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new gN);const r=this.events[e].add(n);return e==="change"?()=>{r(),_n.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=e,this.timeDelta=r}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return Ym.current&&Ym.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?uN(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ao(t,e){return new Kce(t,e)}const X5=t=>e=>e.test(t),Yce={test:t=>t==="auto",parse:t=>t},Z5=[dd,Bt,ma,Rl,sle,rle,Yce],Xf=t=>Z5.find(X5(t)),Jce=[...Z5,Ws,_c],Qce=t=>Jce.find(X5(t));function Xce(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Ao(n))}function Zce(t,e){const n=X0(t,e);let{transitionEnd:r={},transition:s={},...i}=n?t.makeTargetAnimatable(n,!1):{};i={...i,...r};for(const o in i){const l=xle(i[o]);Xce(t,o,l)}}function eue(t,e,n){var r,s;const i=Object.keys(e).filter(l=>!t.hasValue(l)),o=i.length;if(o)for(let l=0;l<o;l++){const c=i[l],u=e[c];let d=null;Array.isArray(u)&&(d=u[0]),d===null&&(d=(s=(r=n[c])!==null&&r!==void 0?r:t.readValue(c))!==null&&s!==void 0?s:e[c]),d!=null&&(typeof d=="string"&&(Q5(d)||J5(d))?d=parseFloat(d):!Qce(d)&&_c.test(u)&&(d=Y5(c,u)),t.addValue(c,Ao(d,{owner:t})),n[c]===void 0&&(n[c]=d),d!==null&&t.setBaseTarget(c,d))}}function tue(t,e){return e?(e[t]||e.default||e).from:void 0}function nue(t,e,n){const r={};for(const s in t){const i=tue(s,e);if(i!==void 0)r[s]=i;else{const o=n.getValue(s);o&&(r[s]=o.get())}}return r}function rue({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function sue(t,e){const n=t.get();if(Array.isArray(e)){for(let r=0;r<e.length;r++)if(e[r]!==n)return!0}else return n!==e}function e6(t,e,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...l}=t.makeTargetAnimatable(e);const c=t.getValue("willChange");r&&(i=r);const u=[],d=s&&t.animationState&&t.animationState.getState()[s];for(const h in l){const f=t.getValue(h),m=l[h];if(!f||m===void 0||d&&rue(d,h))continue;const g={delay:n,elapsed:0,...hN(i||{},h)};if(window.HandoffAppearAnimations){const w=t.getProps()[n5];if(w){const _=window.HandoffAppearAnimations(w,h,f,_n);_!==null&&(g.elapsed=_,g.isHandoff=!0)}}let x=!g.isHandoff&&!sue(f,m);if(g.type==="spring"&&(f.getVelocity()||g.velocity)&&(x=!1),f.animation&&(x=!1),x)continue;f.start(fN(h,f,m,t.shouldReduceMotion&&ud.has(h)?{type:!1}:g));const v=f.animation;hw(c)&&(c.add(h),v.then(()=>c.remove(h))),u.push(v)}return o&&Promise.all(u).then(()=>{o&&Zce(t,o)}),u}function UE(t,e,n={}){const r=X0(t,e,n.custom);let{transition:s=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(e6(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return iue(t,e,u+c,d,h,n)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(n.delay)])}function iue(t,e,n=0,r=0,s=1,i){const o=[],l=(t.variantChildren.size-1)*r,c=s===1?(u=0)=>u*r:(u=0)=>l-u*r;return Array.from(t.variantChildren).sort(oue).forEach((u,d)=>{u.notify("AnimationStart",e),o.push(UE(u,e,{...i,delay:n+c(d)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(o)}function oue(t,e){return t.sortNodePosition(e)}function aue(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>UE(t,i,n));r=Promise.all(s)}else if(typeof e=="string")r=UE(t,e,n);else{const s=typeof e=="function"?X0(t,e,n.custom):e;r=Promise.all(e6(t,s,n))}return r.then(()=>t.notify("AnimationComplete",e))}const lue=[...QI].reverse(),cue=QI.length;function uue(t){return e=>Promise.all(e.map(({animation:n,options:r})=>aue(t,n,r)))}function due(t){let e=uue(t);const n=fue();let r=!0;const s=(c,u)=>{const d=X0(t,u);if(d){const{transition:h,transitionEnd:f,...m}=d;c={...c,...m,...f}}return c};function i(c){e=c(t)}function o(c,u){const d=t.getProps(),h=t.getVariantContext(!0)||{},f=[],m=new Set;let g={},x=1/0;for(let w=0;w<cue;w++){const _=lue[w],C=n[_],T=d[_]!==void 0?d[_]:h[_],j=Up(T),A=_===u?C.isActive:null;A===!1&&(x=w);let E=T===h[_]&&T!==d[_]&&j;if(E&&r&&t.manuallyAnimateOnMount&&(E=!1),C.protectedKeys={...g},!C.isActive&&A===null||!T&&!C.prevProp||K0(T)||typeof T=="boolean")continue;let N=hue(C.prevProp,T)||_===u&&C.isActive&&!E&&j||w>x&&j,k=!1;const R=Array.isArray(T)?T:[T];let D=R.reduce(s,{});A===!1&&(D={});const{prevResolvedValues:M={}}=C,z={...M,...D},B=G=>{N=!0,m.has(G)&&(k=!0,m.delete(G)),C.needsAnimating[G]=!0};for(const G in z){const Y=D[G],H=M[G];if(g.hasOwnProperty(G))continue;let K=!1;lw(Y)&&lw(H)?K=!S5(Y,H):K=Y!==H,K?Y!==void 0?B(G):m.add(G):Y!==void 0&&m.has(G)?B(G):C.protectedKeys[G]=!0}C.prevProp=T,C.prevResolvedValues=D,C.isActive&&(g={...g,...D}),r&&t.blockInitialAnimation&&(N=!1),N&&(!E||k)&&f.push(...R.map(G=>({animation:G,options:{type:_,...c}})))}if(m.size){const w={};m.forEach(_=>{const C=t.getBaseTarget(_);C!==void 0&&(w[_]=C)}),f.push({animation:w})}let v=!!f.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(v=!1),r=!1,v?e(f):Promise.resolve()}function l(c,u,d){var h;if(n[c].isActive===u)return Promise.resolve();(h=t.variantChildren)===null||h===void 0||h.forEach(m=>{var g;return(g=m.animationState)===null||g===void 0?void 0:g.setActive(c,u)}),n[c].isActive=u;const f=o(d,c);for(const m in n)n[m].protectedKeys={};return f}return{animateChanges:o,setActive:l,setAnimateFunction:i,getState:()=>n}}function hue(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!S5(e,t):!1}function eu(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function fue(){return{animate:eu(!0),whileInView:eu(),whileHover:eu(),whileTap:eu(),whileDrag:eu(),whileFocus:eu(),exit:eu()}}class mue extends $c{constructor(e){super(e),e.animationState||(e.animationState=due(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),K0(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let pue=0;class gue extends $c{constructor(){super(...arguments),this.id=pue++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e,{custom:r??this.node.getProps().custom});n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const yue={animation:{Feature:mue},exit:{Feature:gue}},X2=(t,e)=>Math.abs(t-e);function xue(t,e){const n=X2(t.x,e.x),r=X2(t.y,e.y);return Math.sqrt(n**2+r**2)}class t6{constructor(e,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=pS(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,m=xue(h.offset,{x:0,y:0})>=3;if(!f&&!m)return;const{point:g}=h,{timestamp:x}=hs;this.history.push({...g,timestamp:x});const{onStart:v,onMove:w}=this.handlers;f||(v&&v(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=mS(f,this.transformPagePoint),_n.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:m,onSessionEnd:g,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=pS(h.type==="pointercancel"?this.lastMoveEventInfo:mS(f,this.transformPagePoint),this.history);this.startEvent&&m&&m(h,v),g&&g(h,v)},!x5(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const o=Q0(e),l=mS(o,this.transformPagePoint),{point:c}=l,{timestamp:u}=hs;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=n;d&&d(e,pS(l,this.history)),this.removeListeners=oc(Ka(this.contextWindow,"pointermove",this.handlePointerMove),Ka(this.contextWindow,"pointerup",this.handlePointerUp),Ka(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Vo(this.updatePoint)}}function mS(t,e){return e?{point:e(t.point)}:t}function Z2(t,e){return{x:t.x-e.x,y:t.y-e.y}}function pS({point:t},e){return{point:t,delta:Z2(t,n6(e)),offset:Z2(t,vue(e)),velocity:wue(e,.1)}}function vue(t){return t[0]}function n6(t){return t[t.length-1]}function wue(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=n6(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>ac(e)));)n--;if(!r)return{x:0,y:0};const i=Ya(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function qi(t){return t.max-t.min}function BE(t,e=0,n=.01){return Math.abs(t-e)<=n}function eD(t,e,n,r=.5){t.origin=r,t.originPoint=fr(e.min,e.max,t.origin),t.scale=qi(n)/qi(e),(BE(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=fr(n.min,n.max,t.origin)-t.originPoint,(BE(t.translate)||isNaN(t.translate))&&(t.translate=0)}function Jm(t,e,n,r){eD(t.x,e.x,n.x,r?r.originX:void 0),eD(t.y,e.y,n.y,r?r.originY:void 0)}function tD(t,e,n){t.min=n.min+e.min,t.max=t.min+qi(e)}function bue(t,e,n){tD(t.x,e.x,n.x),tD(t.y,e.y,n.y)}function nD(t,e,n){t.min=e.min-n.min,t.max=t.min+qi(e)}function Qm(t,e,n){nD(t.x,e.x,n.x),nD(t.y,e.y,n.y)}function _ue(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?fr(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?fr(n,t,r.max):Math.min(t,n)),t}function rD(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function Sue(t,{top:e,left:n,bottom:r,right:s}){return{x:rD(t.x,n,s),y:rD(t.y,e,r)}}function sD(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function Cue(t,e){return{x:sD(t.x,e.x),y:sD(t.y,e.y)}}function Eue(t,e){let n=.5;const r=qi(t),s=qi(e);return s>r?n=Wh(e.min,e.max-r,t.min):r>s&&(n=Wh(t.min,t.max-s,e.min)),bc(0,1,n)}function Tue(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const zE=.35;function Iue(t=zE){return t===!1?t=0:t===!0&&(t=zE),{x:iD(t,"left","right"),y:iD(t,"top","bottom")}}function iD(t,e,n){return{min:oD(t,e),max:oD(t,n)}}function oD(t,e){return typeof t=="number"?t:t[e]||0}const aD=()=>({translate:0,scale:1,origin:0,originPoint:0}),uh=()=>({x:aD(),y:aD()}),lD=()=>({min:0,max:0}),Lr=()=>({x:lD(),y:lD()});function Zi(t){return[t("x"),t("y")]}function r6({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function Nue({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Pue(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function gS(t){return t===void 0||t===1}function GE({scale:t,scaleX:e,scaleY:n}){return!gS(t)||!gS(e)||!gS(n)}function iu(t){return GE(t)||s6(t)||t.z||t.rotate||t.rotateX||t.rotateY}function s6(t){return cD(t.x)||cD(t.y)}function cD(t){return t&&t!=="0%"}function fw(t,e,n){const r=t-n,s=e*r;return n+s}function uD(t,e,n,r,s){return s!==void 0&&(t=fw(t,s,r)),fw(t,n,r)+e}function WE(t,e=0,n=1,r,s){t.min=uD(t.min,e,n,r,s),t.max=uD(t.max,e,n,r,s)}function i6(t,{x:e,y:n}){WE(t.x,e.translate,e.scale,e.originPoint),WE(t.y,n.translate,n.scale,n.originPoint)}function Aue(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let i,o;for(let l=0;l<s;l++){i=n[l],o=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&dh(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,i6(t,o)),r&&iu(i.latestValues)&&dh(t,i.latestValues))}e.x=dD(e.x),e.y=dD(e.y)}function dD(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function Ol(t,e){t.min=t.min+e,t.max=t.max+e}function hD(t,e,[n,r,s]){const i=e[s]!==void 0?e[s]:.5,o=fr(t.min,t.max,i);WE(t,e[n],e[r],o,e.scale)}const kue=["x","scaleX","originX"],jue=["y","scaleY","originY"];function dh(t,e){hD(t.x,e,kue),hD(t.y,e,jue)}function o6(t,e){return r6(Pue(t.getBoundingClientRect(),e))}function Rue(t,e,n){const r=o6(t,n),{scroll:s}=e;return s&&(Ol(r.x,s.offset.x),Ol(r.y,s.offset.y)),r}const a6=({current:t})=>t?t.ownerDocument.defaultView:null,Due=new WeakMap;class Mue{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Lr(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Q0(d,"page").point)},i=(d,h)=>{const{drag:f,dragPropagation:m,onDragStart:g}=this.getProps();if(f&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=w5(f),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Zi(v=>{let w=this.getAxisMotionValue(v).get()||0;if(ma.test(w)){const{projection:_}=this.visualElement;if(_&&_.layout){const C=_.layout.layoutBox[v];C&&(w=qi(C)*(parseFloat(w)/100))}}this.originPoint[v]=w}),g&&_n.update(()=>g(d,h),!1,!0);const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(d,h)=>{const{dragPropagation:f,dragDirectionLock:m,onDirectionLock:g,onDrag:x}=this.getProps();if(!f&&!this.openGlobalLock)return;const{offset:v}=h;if(m&&this.currentDirection===null){this.currentDirection=Lue(v),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",h.point,v),this.updateAxis("y",h.point,v),this.visualElement.render(),x&&x(d,h)},l=(d,h)=>this.stop(d,h),c=()=>Zi(d=>{var h;return this.getAnimationState(d)==="paused"&&((h=this.getAxisMotionValue(d).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new t6(e,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:a6(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&_n.update(()=>i(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!Qy(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=_ue(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&lh(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=Sue(s.layoutBox,n):this.constraints=!1,this.elastic=Iue(r),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Zi(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=Tue(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!lh(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=Rue(r,s.root,this.visualElement.getTransformPagePoint());let o=Cue(s.layout.layoutBox,i);if(n){const l=n(Nue(o));this.hasMutatedConstraints=!!l,l&&(o=r6(l))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=Zi(d=>{if(!Qy(d,n,this.currentDirection))return;let h=c&&c[d]||{};o&&(h={min:0,max:0});const f=s?200:1e6,m=s?40:1e7,g={type:"inertia",velocity:r?e[d]:0,bounceStiffness:f,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(d,g)});return Promise.all(u).then(l)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return r.start(fN(e,r,0,n))}stopAnimation(){Zi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Zi(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Zi(n=>{const{drag:r}=this.getProps();if(!Qy(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[n];i.set(e[n]-fr(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!lh(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Zi(o=>{const l=this.getAxisMotionValue(o);if(l){const c=l.get();s[o]=Eue({min:c,max:c},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Zi(o=>{if(!Qy(o,e,null))return;const l=this.getAxisMotionValue(o),{min:c,max:u}=this.constraints[o];l.set(fr(c,u,s[o]))})}addListeners(){if(!this.visualElement.current)return;Due.set(this.visualElement,this);const e=this.visualElement.current,n=Ka(e,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),r=()=>{const{dragConstraints:c}=this.getProps();lh(c)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),r();const o=Ba(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(Zi(d=>{const h=this.getAxisMotionValue(d);h&&(this.originPoint[d]+=c[d].translate,h.set(h.get()+c[d].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=zE,dragMomentum:l=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:l}}}function Qy(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function Lue(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class Fue extends $c{constructor(e){super(e),this.removeGroupControls=Ir,this.removeListeners=Ir,this.controls=new Mue(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ir}unmount(){this.removeGroupControls(),this.removeListeners()}}const fD=t=>(e,n)=>{t&&_n.update(()=>t(e,n))};class Oue extends $c{constructor(){super(...arguments),this.removePointerDownListener=Ir}onPointerDown(e){this.session=new t6(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:a6(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:fD(e),onStart:fD(n),onMove:r,onEnd:(i,o)=>{delete this.session,s&&_n.update(()=>s(i,o))}}}mount(){this.removePointerDownListener=Ka(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function $ue(){const t=p.useContext(H0);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:r}=t,s=p.useId();return p.useEffect(()=>r(s),[]),!e&&n?[!1,()=>n&&n(s)]:[!0]}const qx={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function mD(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Zf={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Bt.test(t))t=parseFloat(t);else return t;const n=mD(t,e.target.x),r=mD(t,e.target.y);return`${n}% ${r}%`}},Vue={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=_c.parse(t);if(s.length>5)return r;const i=_c.createTransformer(t),o=typeof s[0]!="number"?1:0,l=n.x.scale*e.x,c=n.y.scale*e.y;s[0+o]/=l,s[1+o]/=c;const u=fr(l,c,.5);return typeof s[2+o]=="number"&&(s[2+o]/=u),typeof s[3+o]=="number"&&(s[3+o]/=u),i(s)}};class Uue extends ht.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;Jae(Bue),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),qx.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,o=r.projection;return o&&(o.isPresent=i,s||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||_n.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function l6(t){const[e,n]=$ue(),r=p.useContext(ZI);return ht.createElement(Uue,{...t,layoutGroup:r,switchLayoutGroup:p.useContext(s5),isPresent:e,safeToRemove:n})}const Bue={borderRadius:{...Zf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Zf,borderTopRightRadius:Zf,borderBottomLeftRadius:Zf,borderBottomRightRadius:Zf,boxShadow:Vue},c6=["TopLeft","TopRight","BottomLeft","BottomRight"],zue=c6.length,pD=t=>typeof t=="string"?parseFloat(t):t,gD=t=>typeof t=="number"||Bt.test(t);function Gue(t,e,n,r,s,i){s?(t.opacity=fr(0,n.opacity!==void 0?n.opacity:1,Wue(r)),t.opacityExit=fr(e.opacity!==void 0?e.opacity:1,0,Hue(r))):i&&(t.opacity=fr(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<zue;o++){const l=`border${c6[o]}Radius`;let c=yD(e,l),u=yD(n,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||gD(c)===gD(u)?(t[l]=Math.max(fr(pD(c),pD(u),r),0),(ma.test(u)||ma.test(c))&&(t[l]+="%")):t[l]=u}(e.rotate||n.rotate)&&(t.rotate=fr(e.rotate||0,n.rotate||0,r))}function yD(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Wue=u6(0,.5,R5),Hue=u6(.5,.95,Ir);function u6(t,e,n){return r=>r<t?0:r>e?1:n(Wh(t,e,r))}function xD(t,e){t.min=e.min,t.max=e.max}function Xi(t,e){xD(t.x,e.x),xD(t.y,e.y)}function vD(t,e,n,r,s){return t-=e,t=fw(t,1/n,r),s!==void 0&&(t=fw(t,1/s,r)),t}function que(t,e=0,n=1,r=.5,s,i=t,o=t){if(ma.test(e)&&(e=parseFloat(e),e=fr(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=fr(i.min,i.max,r);t===i&&(l-=e),t.min=vD(t.min,e,n,l,s),t.max=vD(t.max,e,n,l,s)}function wD(t,e,[n,r,s],i,o){que(t,e[n],e[r],e[s],e.scale,i,o)}const Kue=["x","scaleX","originX"],Yue=["y","scaleY","originY"];function bD(t,e,n,r){wD(t.x,e,Kue,n?n.x:void 0,r?r.x:void 0),wD(t.y,e,Yue,n?n.y:void 0,r?r.y:void 0)}function _D(t){return t.translate===0&&t.scale===1}function d6(t){return _D(t.x)&&_D(t.y)}function Jue(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function h6(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function SD(t){return qi(t.x)/qi(t.y)}class Que{constructor(){this.members=[]}add(e){mN(this.members,e),e.scheduleRender()}remove(e){if(pN(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function CD(t,e,n){let r="";const s=t.x.translate/e.x,i=t.y.translate/e.y;if((s||i)&&(r=`translate3d(${s}px, ${i}px, 0) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:c,rotateX:u,rotateY:d}=n;c&&(r+=`rotate(${c}deg) `),u&&(r+=`rotateX(${u}deg) `),d&&(r+=`rotateY(${d}deg) `)}const o=t.x.scale*e.x,l=t.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const Xue=(t,e)=>t.depth-e.depth;class Zue{constructor(){this.children=[],this.isDirty=!1}add(e){mN(this.children,e),this.isDirty=!0}remove(e){pN(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Xue),this.isDirty=!1,this.children.forEach(e)}}function ede(t,e){const n=performance.now(),r=({timestamp:s})=>{const i=s-n;i>=e&&(Vo(r),t(i-e))};return _n.read(r,!0),()=>Vo(r)}function tde(t){window.MotionDebug&&window.MotionDebug.record(t)}function nde(t){return t instanceof SVGElement&&t.tagName!=="svg"}function rde(t,e,n){const r=wi(t)?t:Ao(t);return r.start(fN("",r,e,n)),r.animation}const ED=["","X","Y","Z"],sde={visibility:"hidden"},TD=1e3;let ide=0;const ou={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function f6({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(o={},l=e==null?void 0:e()){this.id=ide++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ou.totalNodes=ou.resolvedTargetDeltas=ou.recalculatedProjection=0,this.nodes.forEach(lde),this.nodes.forEach(fde),this.nodes.forEach(mde),this.nodes.forEach(cde),tde(ou)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new Zue)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new gN),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=nde(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(u||c)&&(this.isLayoutDirty=!0),t){let h;const f=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=ede(f,250),qx.hasAnimatedSinceResize&&(qx.hasAnimatedSinceResize=!1,this.nodes.forEach(ND))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeTargetChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||d.getDefaultTransition()||vde,{onLayoutAnimationStart:v,onLayoutAnimationComplete:w}=d.getProps(),_=!this.targetLayout||!h6(this.targetLayout,g)||m,C=!f&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||C||f&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,C);const T={...hN(x,"layout"),onPlay:v,onComplete:w};(d.shouldReduceMotion||this.options.layoutRoot)&&(T.delay=0,T.type=!1),this.startAnimation(T)}else f||ND(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Vo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(pde),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const h=this.path[d];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(ID);return}this.isUpdating||this.nodes.forEach(dde),this.isUpdating=!1,this.nodes.forEach(hde),this.nodes.forEach(ode),this.nodes.forEach(ade),this.clearAllSnapshots();const l=performance.now();hs.delta=bc(0,1e3/60,l-hs.timestamp),hs.timestamp=l,hs.isProcessing=!0,oS.update.process(hs),oS.preRender.process(hs),oS.render.process(hs),hs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(ude),this.sharedNodes.forEach(gde)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,_n.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){_n.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Lr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:r(this.instance),offset:n(this.instance)})}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!d6(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;o&&(l||iu(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),wde(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Lr();const l=o.measureViewportBox(),{scroll:c}=this.root;return c&&(Ol(l.x,c.offset.x),Ol(l.y,c.offset.y)),l}removeElementScroll(o){const l=Lr();Xi(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;if(u!==this.root&&d&&h.layoutScroll){if(d.isRoot){Xi(l,o);const{scroll:f}=this.root;f&&(Ol(l.x,-f.offset.x),Ol(l.y,-f.offset.y))}Ol(l.x,d.offset.x),Ol(l.y,d.offset.y)}}return l}applyTransform(o,l=!1){const c=Lr();Xi(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&dh(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),iu(d.latestValues)&&dh(c,d.latestValues)}return iu(this.latestValues)&&dh(c,this.latestValues),c}removeTransform(o){const l=Lr();Xi(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!iu(u.latestValues))continue;GE(u.latestValues)&&u.updateSnapshot();const d=Lr(),h=u.measurePageBox();Xi(d,h),bD(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return iu(this.latestValues)&&bD(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==hs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:f}=this.options;if(!(!this.layout||!(h||f))){if(this.resolvedRelativeTargetAt=hs.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Lr(),this.relativeTargetOrigin=Lr(),Qm(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Xi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Lr(),this.targetWithTransforms=Lr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),bue(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Xi(this.target,this.layout.layoutBox),i6(this.target,this.targetDelta)):Xi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Lr(),this.relativeTargetOrigin=Lr(),Qm(this.relativeTargetOrigin,this.target,m.target),Xi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}ou.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||GE(this.parent.latestValues)||s6(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===hs.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;Xi(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;Aue(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:g}=l;if(!g){this.projectionTransform&&(this.projectionDelta=uh(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=uh(),this.projectionDeltaWithTransform=uh());const x=this.projectionTransform;Jm(this.projectionDelta,this.layoutCorrected,g,this.latestValues),this.projectionTransform=CD(this.projectionDelta,this.treeScale),(this.projectionTransform!==x||this.treeScale.x!==f||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),ou.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},h=uh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const f=Lr(),m=c?c.source:void 0,g=this.layout?this.layout.source:void 0,x=m!==g,v=this.getStack(),w=!v||v.members.length<=1,_=!!(x&&!w&&this.options.crossfade===!0&&!this.path.some(xde));this.animationProgress=0;let C;this.mixTargetDelta=T=>{const j=T/1e3;PD(h.x,o.x,j),PD(h.y,o.y,j),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Qm(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),yde(this.relativeTarget,this.relativeTargetOrigin,f,j),C&&Jue(this.relativeTarget,C)&&(this.isProjectionDirty=!1),C||(C=Lr()),Xi(C,this.relativeTarget)),x&&(this.animationValues=d,Gue(d,u,this.latestValues,j,_,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=j},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Vo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=_n.update(()=>{qx.hasAnimatedSinceResize=!0,this.currentAnimation=rde(0,TD,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(TD),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=o;if(!(!l||!c||!u)){if(this!==o&&this.layout&&u&&m6(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Lr();const h=qi(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+h;const f=qi(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+f}Xi(l,c),dh(l,d),Jm(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Que),this.sharedNodes.get(o).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const u={};for(let d=0;d<ED.length;d++){const h="rotate"+ED[d];c[h]&&(u[h]=c[h],o.setStaticValue(h,0))}o.render();for(const d in u)o.setStaticValue(d,u[d]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return sde;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=Hx(o==null?void 0:o.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=Hx(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!iu(this.latestValues)&&(x.transform=d?d({},""):"none",this.hasProjected=!1),x}const f=h.animationValues||h.latestValues;this.applyTransformsToTarget(),u.transform=CD(this.projectionDeltaWithTransform,this.treeScale,f),d&&(u.transform=d(f,u.transform));const{x:m,y:g}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,h.animationValues?u.opacity=h===this?(c=(l=f.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:u.opacity=h===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const x in ow){if(f[x]===void 0)continue;const{correct:v,applyTo:w}=ow[x],_=u.transform==="none"?f[x]:v(f[x],h);if(w){const C=w.length;for(let T=0;T<C;T++)u[w[T]]=_}else u[x]=_}return this.options.layoutId&&(u.pointerEvents=h===this?Hx(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(ID),this.root.sharedNodes.clear()}}}function ode(t){t.updateLayout()}function ade(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;i==="size"?Zi(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],m=qi(f);f.min=r[h].min,f.max=f.min+m}):m6(i,n.layoutBox,r)&&Zi(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],m=qi(r[h]);f.max=f.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+m)});const l=uh();Jm(l,r,n.layoutBox);const c=uh();o?Jm(c,t.applyTransform(s,!0),n.measuredBox):Jm(c,r,n.layoutBox);const u=!d6(l);let d=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:m}=h;if(f&&m){const g=Lr();Qm(g,n.layoutBox,f.layoutBox);const x=Lr();Qm(x,r,m.layoutBox),h6(g,x)||(d=!0),h.options.layoutRoot&&(t.relativeTarget=x,t.relativeTargetOrigin=g,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function lde(t){ou.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function cde(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function ude(t){t.clearSnapshot()}function ID(t){t.clearMeasurements()}function dde(t){t.isLayoutDirty=!1}function hde(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function ND(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function fde(t){t.resolveTargetDelta()}function mde(t){t.calcProjection()}function pde(t){t.resetRotation()}function gde(t){t.removeLeadSnapshot()}function PD(t,e,n){t.translate=fr(e.translate,0,n),t.scale=fr(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function AD(t,e,n,r){t.min=fr(e.min,n.min,r),t.max=fr(e.max,n.max,r)}function yde(t,e,n,r){AD(t.x,e.x,n.x,r),AD(t.y,e.y,n.y,r)}function xde(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const vde={duration:.45,ease:[.4,0,.1,1]},kD=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),jD=kD("applewebkit/")&&!kD("chrome/")?Math.round:Ir;function RD(t){t.min=jD(t.min),t.max=jD(t.max)}function wde(t){RD(t.x),RD(t.y)}function m6(t,e,n){return t==="position"||t==="preserve-aspect"&&!BE(SD(e),SD(n),.2)}const bde=f6({attachResizeListener:(t,e)=>Ba(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),yS={current:void 0},p6=f6({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!yS.current){const t=new bde({});t.mount(window),t.setOptions({layoutScroll:!0}),yS.current=t}return yS.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),_de={pan:{Feature:Oue},drag:{Feature:Fue,ProjectionNode:p6,MeasureLayout:l6}},Sde=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Cde(t){const e=Sde.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]}function HE(t,e,n=1){const[r,s]=Cde(t);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const o=i.trim();return Q5(o)?parseFloat(o):o}else return ME(s)?HE(s,e,n+1):s}function Ede(t,{...e},n){const r=t.current;if(!(r instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(s=>{const i=s.get();if(!ME(i))return;const o=HE(i,r);o&&s.set(o)});for(const s in e){const i=e[s];if(!ME(i))continue;const o=HE(i,r);o&&(e[s]=o,n||(n={}),n[s]===void 0&&(n[s]=i))}return{target:e,transitionEnd:n}}const Tde=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),g6=t=>Tde.has(t),Ide=t=>Object.keys(t).some(g6),DD=t=>t===dd||t===Bt,MD=(t,e)=>parseFloat(t.split(", ")[e]),LD=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/);if(s)return MD(s[1],e);{const i=r.match(/^matrix\((.+)\)$/);return i?MD(i[1],t):0}},Nde=new Set(["x","y","z"]),Pde=Ag.filter(t=>!Nde.has(t));function Ade(t){const e=[];return Pde.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const Hh={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:LD(4,13),y:LD(5,14)};Hh.translateX=Hh.x;Hh.translateY=Hh.y;const kde=(t,e,n)=>{const r=e.measureViewportBox(),s=e.current,i=getComputedStyle(s),{display:o}=i,l={};o==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(u=>{l[u]=Hh[u](r,i)}),e.render();const c=e.measureViewportBox();return n.forEach(u=>{const d=e.getValue(u);d&&d.jump(l[u]),t[u]=Hh[u](c,i)}),t},jde=(t,e,n={},r={})=>{e={...e},r={...r};const s=Object.keys(e).filter(g6);let i=[],o=!1;const l=[];if(s.forEach(c=>{const u=t.getValue(c);if(!t.hasValue(c))return;let d=n[c],h=Xf(d);const f=e[c];let m;if(lw(f)){const g=f.length,x=f[0]===null?1:0;d=f[x],h=Xf(d);for(let v=x;v<g&&f[v]!==null;v++)m?Z0(Xf(f[v])===m):m=Xf(f[v])}else m=Xf(f);if(h!==m)if(DD(h)&&DD(m)){const g=u.get();typeof g=="string"&&u.set(parseFloat(g)),typeof f=="string"?e[c]=parseFloat(f):Array.isArray(f)&&m===Bt&&(e[c]=f.map(parseFloat))}else h!=null&&h.transform&&(m!=null&&m.transform)&&(d===0||f===0)?d===0?u.set(m.transform(d)):e[c]=h.transform(f):(o||(i=Ade(t),o=!0),l.push(c),r[c]=r[c]!==void 0?r[c]:e[c],u.jump(f))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,u=kde(e,t,l);return i.length&&i.forEach(([d,h])=>{t.getValue(d).set(h)}),t.render(),q0&&c!==null&&window.scrollTo({top:c}),{target:u,transitionEnd:r}}else return{target:e,transitionEnd:r}};function Rde(t,e,n,r){return Ide(e)?jde(t,e,n,r):{target:e,transitionEnd:r}}const Dde=(t,e,n,r)=>{const s=Ede(t,e,r);return e=s.target,r=s.transitionEnd,Rde(t,e,n,r)},qE={current:null},y6={current:!1};function Mde(){if(y6.current=!0,!!q0)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>qE.current=t.matches;t.addListener(e),e()}else qE.current=!1}function Lde(t,e,n){const{willChange:r}=e;for(const s in e){const i=e[s],o=n[s];if(wi(i))t.addValue(s,i),hw(r)&&r.add(s);else if(wi(o))t.addValue(s,Ao(i,{owner:t})),hw(r)&&r.remove(s);else if(o!==i)if(t.hasValue(s)){const l=t.getValue(s);!l.hasAnimated&&l.set(i)}else{const l=t.getStaticValue(s);t.addValue(s,Ao(l!==void 0?l:i,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const FD=new WeakMap,x6=Object.keys(Bp),Fde=x6.length,OD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Ode=XI.length;class $de{constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>_n.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.isControllingVariants=Y0(n),this.isVariantNode=r5(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{});for(const h in d){const f=d[h];l[h]!==void 0&&wi(f)&&(f.set(l[h],!1),hw(u)&&u.add(h))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,FD.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),y6.current||Mde(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:qE.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){FD.delete(this.current),this.projection&&this.projection.unmount(),Vo(this.notifyUpdate),Vo(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const r=ud.has(e),s=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&_n.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{s(),i()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},r,s,i){let o,l;for(let c=0;c<Fde;c++){const u=x6[c],{isEnabled:d,Feature:h,ProjectionNode:f,MeasureLayout:m}=Bp[u];f&&(o=f),d(n)&&(!this.features[u]&&h&&(this.features[u]=new h(this)),m&&(l=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:d,dragConstraints:h,layoutScroll:f,layoutRoot:m}=n;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||h&&lh(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:i,layoutScroll:f,layoutRoot:m})}return l}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Lr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<OD.length;r++){const s=OD[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i=e["on"+s];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=Lde(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const n={};for(let r=0;r<Ode;r++){const s=XI[r],i=this.props[s];(Up(i)||i===!1)&&(n[s]=i)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Ao(n,{owner:this}),this.addValue(e,r)),r}readValue(e){var n;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props,s=typeof r=="string"||typeof r=="object"?(n=oN(this.props,r))===null||n===void 0?void 0:n[e]:void 0;if(r&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!wi(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new gN),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class v6 extends $de{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...r},{transformValues:s},i){let o=nue(r,e||{},this);if(s&&(n&&(n=s(n)),r&&(r=s(r)),o&&(o=s(o))),i){eue(this,r,o);const l=Dde(this,r,o,n);n=l.transitionEnd,r=l.target}return{transition:e,transitionEnd:n,...r}}}function Vde(t){return window.getComputedStyle(t)}class Ude extends v6{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,n){if(ud.has(n)){const r=dN(n);return r&&r.default||0}else{const r=Vde(e),s=(a5(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return o6(e,n)}build(e,n,r,s){tN(e,n,r,s.transformTemplate)}scrapeMotionValuesFromProps(e,n){return iN(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;wi(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,r,s){f5(e,n,r,s)}}class Bde extends v6{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(ud.has(n)){const r=dN(n);return r&&r.default||0}return n=m5.has(n)?n:JI(n),e.getAttribute(n)}measureInstanceViewportBox(){return Lr()}scrapeMotionValuesFromProps(e,n){return g5(e,n)}build(e,n,r,s){rN(e,n,r,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,r,s){p5(e,n,r,s)}mount(e){this.isSVGTag=sN(e.tagName),super.mount(e)}}const zde=(t,e)=>eN(t)?new Bde(e,{enableHardwareAcceleration:!1}):new Ude(e,{enableHardwareAcceleration:!0}),Gde={layout:{ProjectionNode:p6,MeasureLayout:l6}},Wde={...yue,...$le,..._de,...Gde},It=Kae((t,e)=>Tle(t,e,Wde,zde));function w6(){const t=p.useRef(!1);return Pg(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function Hde(){const t=w6(),[e,n]=p.useState(0),r=p.useCallback(()=>{t.current&&n(e+1)},[e]);return[p.useCallback(()=>_n.postRender(r),[r]),e]}class qde extends p.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Kde({children:t,isPresent:e}){const n=p.useId(),r=p.useRef(null),s=p.useRef({width:0,height:0,top:0,left:0});return p.useInsertionEffect(()=>{const{width:i,height:o,top:l,left:c}=s.current;if(e||!r.current||!i||!o)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),p.createElement(qde,{isPresent:e,childRef:r,sizeRef:s},p.cloneElement(t,{ref:r}))}const xS=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:o})=>{const l=Rg(Yde),c=p.useId(),u=p.useMemo(()=>({id:c,initial:e,isPresent:n,custom:s,onExitComplete:d=>{l.set(d,!0);for(const h of l.values())if(!h)return;r&&r()},register:d=>(l.set(d,!1),()=>l.delete(d))}),i?void 0:[n]);return p.useMemo(()=>{l.forEach((d,h)=>l.set(h,!1))},[n]),p.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),o==="popLayout"&&(t=p.createElement(Kde,{isPresent:n},t)),p.createElement(H0.Provider,{value:u},t)};function Yde(){return new Map}function Jde(t){return p.useEffect(()=>()=>t(),[])}const au=t=>t.key||"";function Qde(t,e){t.forEach(n=>{const r=au(n);e.set(r,n)})}function Xde(t){const e=[];return p.Children.forEach(t,n=>{p.isValidElement(n)&&e.push(n)}),e}const Sc=({children:t,custom:e,initial:n=!0,onExitComplete:r,exitBeforeEnter:s,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const l=p.useContext(ZI).forceRender||Hde()[0],c=w6(),u=Xde(t);let d=u;const h=p.useRef(new Map).current,f=p.useRef(d),m=p.useRef(new Map).current,g=p.useRef(!0);if(Pg(()=>{g.current=!1,Qde(u,m),f.current=d}),Jde(()=>{g.current=!0,m.clear(),h.clear()}),g.current)return p.createElement(p.Fragment,null,d.map(_=>p.createElement(xS,{key:au(_),isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:i,mode:o},_)));d=[...d];const x=f.current.map(au),v=u.map(au),w=x.length;for(let _=0;_<w;_++){const C=x[_];v.indexOf(C)===-1&&!h.has(C)&&h.set(C,void 0)}return o==="wait"&&h.size&&(d=[]),h.forEach((_,C)=>{if(v.indexOf(C)!==-1)return;const T=m.get(C);if(!T)return;const j=x.indexOf(C);let A=_;if(!A){const E=()=>{h.delete(C);const I=Array.from(m.keys()).filter(N=>!v.includes(N));if(I.forEach(N=>m.delete(N)),f.current=u.filter(N=>{const k=au(N);return k===C||I.includes(k)}),!h.size){if(c.current===!1)return;l(),r&&r()}};A=p.createElement(xS,{key:au(T),isPresent:!1,onExitComplete:E,custom:e,presenceAffectsLayout:i,mode:o},T),h.set(C,A)}d.splice(j,0,A)}),d=d.map(_=>{const C=_.key;return h.has(C)?_:p.createElement(xS,{key:au(_),isPresent:!0,presenceAffectsLayout:i,mode:o},_)}),p.createElement(p.Fragment,null,h.size?d:d.map(_=>p.cloneElement(_)))};function Zde(t){const e=Rg(()=>Ao(t)),{isStatic:n}=p.useContext(YI);if(n){const[,r]=p.useState(t);p.useEffect(()=>e.on("change",r),[])}return e}const ehe=t=>t&&typeof t=="object"&&t.mix,the=t=>ehe(t)?t.mix:void 0;function nhe(...t){const e=!Array.isArray(t[0]),n=e?0:-1,r=t[0+n],s=t[1+n],i=t[2+n],o=t[3+n],l=eb(s,i,{mixer:the(i[0]),...o});return e?l(r):l}function b6(t,e){const n=Zde(e()),r=()=>n.set(e());return r(),Pg(()=>{const s=()=>_n.update(r,!1,!0),i=t.map(o=>o.on("change",s));return()=>{i.forEach(o=>o()),Vo(r)}}),n}function rhe(t){Ym.current=[],t();const e=b6(Ym.current,t);return Ym.current=void 0,e}function vS(t,e,n,r){if(typeof t=="function")return rhe(t);const s=typeof e=="function"?e:nhe(e,n,r);return Array.isArray(t)?$D(t,s):$D([t],([i])=>s(i))}function $D(t,e){const n=Rg(()=>[]);return b6(t,()=>{n.length=0;const r=t.length;for(let s=0;s<r;s++)n[s]=t[s].get();return e(n)})}function _6(t,e,n){var r;if(typeof t=="string"){let s=document;e&&(Z0(!!e.current),s=e.current),n?((r=n[t])!==null&&r!==void 0||(n[t]=s.querySelectorAll(t)),t=n[t]):t=s.querySelectorAll(t)}else t instanceof Element&&(t=[t]);return Array.from(t||[])}const Kx=new WeakMap;let Dl;function she(t,e){if(e){const{inlineSize:n,blockSize:r}=e[0];return{width:n,height:r}}else return t instanceof SVGElement&&"getBBox"in t?t.getBBox():{width:t.offsetWidth,height:t.offsetHeight}}function ihe({target:t,contentRect:e,borderBoxSize:n}){var r;(r=Kx.get(t))===null||r===void 0||r.forEach(s=>{s({target:t,contentSize:e,get size(){return she(t,n)}})})}function ohe(t){t.forEach(ihe)}function ahe(){typeof ResizeObserver>"u"||(Dl=new ResizeObserver(ohe))}function lhe(t,e){Dl||ahe();const n=_6(t);return n.forEach(r=>{let s=Kx.get(r);s||(s=new Set,Kx.set(r,s)),s.add(e),Dl==null||Dl.observe(r)}),()=>{n.forEach(r=>{const s=Kx.get(r);s==null||s.delete(e),s!=null&&s.size||Dl==null||Dl.unobserve(r)})}}const Yx=new Set;let Xm;function che(){Xm=()=>{const t={width:window.innerWidth,height:window.innerHeight},e={target:window,size:t,contentSize:t};Yx.forEach(n=>n(e))},window.addEventListener("resize",Xm)}function uhe(t){return Yx.add(t),Xm||che(),()=>{Yx.delete(t),!Yx.size&&Xm&&(Xm=void 0)}}function dhe(t,e){return typeof t=="function"?uhe(t):lhe(t,e)}const hhe=50,VD=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),fhe=()=>({time:0,x:VD(),y:VD()}),mhe={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function UD(t,e,n,r){const s=n[e],{length:i,position:o}=mhe[e],l=s.current,c=n.time;s.current=t["scroll"+o],s.scrollLength=t["scroll"+i]-t["client"+i],s.offset.length=0,s.offset[0]=0,s.offset[1]=s.scrollLength,s.progress=Wh(0,s.scrollLength,s.current);const u=r-c;s.velocity=u>hhe?0:uN(s.current-l,u)}function phe(t,e,n){UD(t,"x",e,n),UD(t,"y",e,n),e.time=n}function ghe(t,e){const n={x:0,y:0};let r=t;for(;r&&r!==e;)if(r instanceof HTMLElement)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;else if(r.tagName==="svg"){const s=r.getBoundingClientRect();r=r.parentElement;const i=r.getBoundingClientRect();n.x+=s.left-i.left,n.y+=s.top-i.top}else if(r instanceof SVGGraphicsElement){const{x:s,y:i}=r.getBBox();n.x+=s,n.y+=i;let o=null,l=r.parentNode;for(;!o;)l.tagName==="svg"&&(o=l),l=r.parentNode;r=o}else break;return n}const yhe={Enter:[[0,1],[1,1]],Exit:[[0,0],[1,0]],Any:[[1,0],[0,1]],All:[[0,0],[1,1]]},KE={start:0,center:.5,end:1};function BD(t,e,n=0){let r=0;if(KE[t]!==void 0&&(t=KE[t]),typeof t=="string"){const s=parseFloat(t);t.endsWith("px")?r=s:t.endsWith("%")?t=s/100:t.endsWith("vw")?r=s/100*document.documentElement.clientWidth:t.endsWith("vh")?r=s/100*document.documentElement.clientHeight:t=s}return typeof t=="number"&&(r=e*t),n+r}const xhe=[0,0];function vhe(t,e,n,r){let s=Array.isArray(t)?t:xhe,i=0,o=0;return typeof t=="number"?s=[t,t]:typeof t=="string"&&(t=t.trim(),t.includes(" ")?s=t.split(" "):s=[t,KE[t]?t:"0"]),i=BD(s[0],n,r),o=BD(s[1],e),i-o}const whe={x:0,y:0};function bhe(t){return"getBBox"in t&&t.tagName!=="svg"?t.getBBox():{width:t.clientWidth,height:t.clientHeight}}function _he(t,e,n){let{offset:r=yhe.All}=n;const{target:s=t,axis:i="y"}=n,o=i==="y"?"height":"width",l=s!==t?ghe(s,t):whe,c=s===t?{width:t.scrollWidth,height:t.scrollHeight}:bhe(s),u={width:t.clientWidth,height:t.clientHeight};e[i].offset.length=0;let d=!e[i].interpolate;const h=r.length;for(let f=0;f<h;f++){const m=vhe(r[f],u[o],c[o],l[i]);!d&&m!==e[i].interpolatorOffsets[f]&&(d=!0),e[i].offset[f]=m}d&&(e[i].interpolate=eb(e[i].offset,H5(r)),e[i].interpolatorOffsets=[...e[i].offset]),e[i].progress=e[i].interpolate(e[i].current)}function She(t,e=t,n){if(n.x.targetOffset=0,n.y.targetOffset=0,e!==t){let r=e;for(;r&&r!==t;)n.x.targetOffset+=r.offsetLeft,n.y.targetOffset+=r.offsetTop,r=r.offsetParent}n.x.targetLength=e===t?e.scrollWidth:e.clientWidth,n.y.targetLength=e===t?e.scrollHeight:e.clientHeight,n.x.containerLength=t.clientWidth,n.y.containerLength=t.clientHeight}function Che(t,e,n,r={}){return{measure:()=>She(t,r.target,n),update:s=>{phe(t,n,s),(r.offset||r.target)&&_he(t,n,r)},notify:()=>e(n)}}const em=new WeakMap,zD=new WeakMap,wS=new WeakMap,GD=t=>t===document.documentElement?window:t;function Ehe(t,{container:e=document.documentElement,...n}={}){let r=wS.get(e);r||(r=new Set,wS.set(e,r));const s=fhe(),i=Che(e,t,s,n);if(r.add(i),!em.has(e)){const l=()=>{for(const f of r)f.measure()},c=()=>{for(const f of r)f.update(hs.timestamp)},u=()=>{for(const f of r)f.notify()},d=()=>{_n.read(l,!1,!0),_n.read(c,!1,!0),_n.update(u,!1,!0)};em.set(e,d);const h=GD(e);window.addEventListener("resize",d,{passive:!0}),e!==document.documentElement&&zD.set(e,dhe(e,d)),h.addEventListener("scroll",d,{passive:!0})}const o=em.get(e);return _n.read(o,!1,!0),()=>{var l;Vo(o);const c=wS.get(e);if(!c||(c.delete(i),c.size))return;const u=em.get(e);em.delete(e),u&&(GD(e).removeEventListener("scroll",u),(l=zD.get(e))===null||l===void 0||l(),window.removeEventListener("resize",u))}}function WD(t,e){C5(!!(!e||e.current))}const The=()=>({scrollX:Ao(0),scrollY:Ao(0),scrollXProgress:Ao(0),scrollYProgress:Ao(0)});function Ihe({container:t,target:e,layoutEffect:n=!0,...r}={}){const s=Rg(The);return(n?Pg:p.useEffect)(()=>(WD("target",e),WD("container",t),Ehe(({x:o,y:l})=>{s.scrollX.set(o.current),s.scrollXProgress.set(o.progress),s.scrollY.set(l.current),s.scrollYProgress.set(l.progress)},{...r,container:(t==null?void 0:t.current)||void 0,target:(e==null?void 0:e.current)||void 0})),[t,e,JSON.stringify(r.offset)]),s}const Nhe={some:0,all:1};function Phe(t,e,{root:n,margin:r,amount:s="some"}={}){const i=_6(t),o=new WeakMap,l=u=>{u.forEach(d=>{const h=o.get(d.target);if(d.isIntersecting!==!!h)if(d.isIntersecting){const f=e(d);typeof f=="function"?o.set(d.target,f):c.unobserve(d.target)}else h&&(h(d),o.delete(d.target))})},c=new IntersectionObserver(l,{root:n,rootMargin:r,threshold:typeof s=="number"?s:Nhe[s]});return i.forEach(u=>c.observe(u)),()=>c.disconnect()}function Ahe(t,{root:e,margin:n,amount:r,once:s=!1}={}){const[i,o]=p.useState(!1);return p.useEffect(()=>{if(!t.current||s&&i)return;const l=()=>(o(!0),s?void 0:()=>o(!1)),c={root:e&&e.current||void 0,margin:n,amount:r};return Phe(t.current,l,c)},[e,t,n,s,r]),i}function khe(t,[e,n]){return Math.min(n,Math.max(e,t))}function jhe(t,e){return p.useReducer((n,r)=>e[n][r]??n,t)}var yN="ScrollArea",[S6,ERe]=bi(yN),[Rhe,xo]=S6(yN),C6=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...o}=t,[l,c]=p.useState(null),[u,d]=p.useState(null),[h,f]=p.useState(null),[m,g]=p.useState(null),[x,v]=p.useState(null),[w,_]=p.useState(0),[C,T]=p.useState(0),[j,A]=p.useState(!1),[E,I]=p.useState(!1),N=yn(e,R=>c(R)),k=U0(s);return a.jsx(Rhe,{scope:n,type:r,dir:k,scrollHideDelay:i,scrollArea:l,viewport:u,onViewportChange:d,content:h,onContentChange:f,scrollbarX:m,onScrollbarXChange:g,scrollbarXEnabled:j,onScrollbarXEnabledChange:A,scrollbarY:x,onScrollbarYChange:v,scrollbarYEnabled:E,onScrollbarYEnabledChange:I,onCornerWidthChange:_,onCornerHeightChange:T,children:a.jsx(Yt.div,{dir:k,...o,ref:N,style:{position:"relative","--radix-scroll-area-corner-width":w+"px","--radix-scroll-area-corner-height":C+"px",...t.style}})})});C6.displayName=yN;var E6="ScrollAreaViewport",T6=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=t,o=xo(E6,n),l=p.useRef(null),c=yn(e,l,o.onViewportChange);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),a.jsx(Yt.div,{"data-radix-scroll-area-viewport":"",...i,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...t.style},children:a.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});T6.displayName=E6;var Ta="ScrollAreaScrollbar",xN=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=xo(Ta,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=s,l=t.orientation==="horizontal";return p.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),s.type==="hover"?a.jsx(Dhe,{...r,ref:e,forceMount:n}):s.type==="scroll"?a.jsx(Mhe,{...r,ref:e,forceMount:n}):s.type==="auto"?a.jsx(I6,{...r,ref:e,forceMount:n}):s.type==="always"?a.jsx(vN,{...r,ref:e}):null});xN.displayName=Ta;var Dhe=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=xo(Ta,t.__scopeScrollArea),[i,o]=p.useState(!1);return p.useEffect(()=>{const l=s.scrollArea;let c=0;if(l){const u=()=>{window.clearTimeout(c),o(!0)},d=()=>{c=window.setTimeout(()=>o(!1),s.scrollHideDelay)};return l.addEventListener("pointerenter",u),l.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",u),l.removeEventListener("pointerleave",d)}}},[s.scrollArea,s.scrollHideDelay]),a.jsx(vs,{present:n||i,children:a.jsx(I6,{"data-state":i?"visible":"hidden",...r,ref:e})})}),Mhe=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=xo(Ta,t.__scopeScrollArea),i=t.orientation==="horizontal",o=nb(()=>c("SCROLL_END"),100),[l,c]=jhe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return p.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>c("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,s.scrollHideDelay,c]),p.useEffect(()=>{const u=s.viewport,d=i?"scrollLeft":"scrollTop";if(u){let h=u[d];const f=()=>{const m=u[d];h!==m&&(c("SCROLL"),o()),h=m};return u.addEventListener("scroll",f),()=>u.removeEventListener("scroll",f)}},[s.viewport,i,c,o]),a.jsx(vs,{present:n||l!=="hidden",children:a.jsx(vN,{"data-state":l==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:gt(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:gt(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),I6=p.forwardRef((t,e)=>{const n=xo(Ta,t.__scopeScrollArea),{forceMount:r,...s}=t,[i,o]=p.useState(!1),l=t.orientation==="horizontal",c=nb(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,d=n.viewport.offsetHeight<n.viewport.scrollHeight;o(l?u:d)}},10);return qh(n.viewport,c),qh(n.content,c),a.jsx(vs,{present:r||i,children:a.jsx(vN,{"data-state":i?"visible":"hidden",...s,ref:e})})}),vN=p.forwardRef((t,e)=>{const{orientation:n="vertical",...r}=t,s=xo(Ta,t.__scopeScrollArea),i=p.useRef(null),o=p.useRef(0),[l,c]=p.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=j6(l.viewport,l.content),d={...r,sizes:l,onSizesChange:c,hasThumb:u>0&&u<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function h(f,m){return Uhe(f,o.current,l,m)}return n==="horizontal"?a.jsx(Lhe,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollLeft,m=HD(f,l,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollLeft=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollLeft=h(f,s.dir))}}):n==="vertical"?a.jsx(Fhe,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollTop,m=HD(f,l);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollTop=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollTop=h(f))}}):null}),Lhe=p.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=xo(Ta,t.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=yn(e,c,i.onScrollbarXChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(P6,{"data-orientation":"horizontal",...s,ref:u,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":tb(n)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.x),onDragScroll:d=>t.onDragScroll(d.x),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+d.deltaX;t.onWheelScroll(f),D6(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:pw(o.paddingLeft),paddingEnd:pw(o.paddingRight)}})}})}),Fhe=p.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=xo(Ta,t.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=yn(e,c,i.onScrollbarYChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(P6,{"data-orientation":"vertical",...s,ref:u,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":tb(n)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.y),onDragScroll:d=>t.onDragScroll(d.y),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollTop+d.deltaY;t.onWheelScroll(f),D6(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:pw(o.paddingTop),paddingEnd:pw(o.paddingBottom)}})}})}),[Ohe,N6]=S6(Ta),P6=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:d,onResize:h,...f}=t,m=xo(Ta,n),[g,x]=p.useState(null),v=yn(e,N=>x(N)),w=p.useRef(null),_=p.useRef(""),C=m.viewport,T=r.content-r.viewport,j=$r(d),A=$r(c),E=nb(h,10);function I(N){if(w.current){const k=N.clientX-w.current.left,R=N.clientY-w.current.top;u({x:k,y:R})}}return p.useEffect(()=>{const N=k=>{const R=k.target;(g==null?void 0:g.contains(R))&&j(k,T)};return document.addEventListener("wheel",N,{passive:!1}),()=>document.removeEventListener("wheel",N,{passive:!1})},[C,g,T,j]),p.useEffect(A,[r,A]),qh(g,E),qh(m.content,E),a.jsx(Ohe,{scope:n,scrollbar:g,hasThumb:s,onThumbChange:$r(i),onThumbPointerUp:$r(o),onThumbPositionChange:A,onThumbPointerDown:$r(l),children:a.jsx(Yt.div,{...f,ref:v,style:{position:"absolute",...f.style},onPointerDown:gt(t.onPointerDown,N=>{N.button===0&&(N.target.setPointerCapture(N.pointerId),w.current=g.getBoundingClientRect(),_.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),I(N))}),onPointerMove:gt(t.onPointerMove,I),onPointerUp:gt(t.onPointerUp,N=>{const k=N.target;k.hasPointerCapture(N.pointerId)&&k.releasePointerCapture(N.pointerId),document.body.style.webkitUserSelect=_.current,m.viewport&&(m.viewport.style.scrollBehavior=""),w.current=null})})})}),mw="ScrollAreaThumb",A6=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=N6(mw,t.__scopeScrollArea);return a.jsx(vs,{present:n||s.hasThumb,children:a.jsx($he,{ref:e,...r})})}),$he=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:r,...s}=t,i=xo(mw,n),o=N6(mw,n),{onThumbPositionChange:l}=o,c=yn(e,h=>o.onThumbChange(h)),u=p.useRef(void 0),d=nb(()=>{u.current&&(u.current(),u.current=void 0)},100);return p.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(d(),!u.current){const m=Bhe(h,l);u.current=m,l()}};return l(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,d,l]),a.jsx(Yt.div,{"data-state":o.hasThumb?"visible":"hidden",...s,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:gt(t.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),g=h.clientX-m.left,x=h.clientY-m.top;o.onThumbPointerDown({x:g,y:x})}),onPointerUp:gt(t.onPointerUp,o.onThumbPointerUp)})});A6.displayName=mw;var wN="ScrollAreaCorner",k6=p.forwardRef((t,e)=>{const n=xo(wN,t.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?a.jsx(Vhe,{...t,ref:e}):null});k6.displayName=wN;var Vhe=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,...r}=t,s=xo(wN,n),[i,o]=p.useState(0),[l,c]=p.useState(0),u=!!(i&&l);return qh(s.scrollbarX,()=>{var h;const d=((h=s.scrollbarX)==null?void 0:h.offsetHeight)||0;s.onCornerHeightChange(d),c(d)}),qh(s.scrollbarY,()=>{var h;const d=((h=s.scrollbarY)==null?void 0:h.offsetWidth)||0;s.onCornerWidthChange(d),o(d)}),u?a.jsx(Yt.div,{...r,ref:e,style:{width:i,height:l,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function pw(t){return t?parseInt(t,10):0}function j6(t,e){const n=t/e;return isNaN(n)?0:n}function tb(t){const e=j6(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-n)*e;return Math.max(r,18)}function Uhe(t,e,n,r="ltr"){const s=tb(n),i=s/2,o=e||i,l=s-o,c=n.scrollbar.paddingStart+o,u=n.scrollbar.size-n.scrollbar.paddingEnd-l,d=n.content-n.viewport,h=r==="ltr"?[0,d]:[d*-1,0];return R6([c,u],h)(t)}function HD(t,e,n="ltr"){const r=tb(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-s,o=e.content-e.viewport,l=i-r,c=n==="ltr"?[0,o]:[o*-1,0],u=khe(t,c);return R6([0,o],[0,l])(u)}function R6(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function D6(t,e){return t>0&&t<e}var Bhe=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},r=0;return function s(){const i={left:t.scrollLeft,top:t.scrollTop},o=n.left!==i.left,l=n.top!==i.top;(o||l)&&e(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function nb(t,e){const n=$r(t),r=p.useRef(0);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),p.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,e)},[n,e])}function qh(t,e){const n=$r(e);xa(()=>{let r=0;if(t){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(t),()=>{window.cancelAnimationFrame(r),s.unobserve(t)}}},[t,n])}var M6=C6,zhe=T6,Ghe=k6;const Fs=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(M6,{ref:r,className:bt("relative overflow-hidden",t),...n,children:[a.jsx(zhe,{className:"h-full w-full rounded-[inherit]",children:e}),a.jsx(L6,{}),a.jsx(Ghe,{})]}));Fs.displayName=M6.displayName;const L6=ht.forwardRef(({className:t,orientation:e="vertical",...n},r)=>a.jsx(xN,{ref:r,orientation:e,className:bt("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:a.jsx(A6,{className:"relative flex-1 rounded-full bg-border"})}));L6.displayName=xN.displayName;const YE="RFC3986",JE={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},Whe="RFC1738",Hhe=Array.isArray,Ko=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),bS=1024,qhe=(t,e,n,r,s)=>{if(t.length===0)return t;let i=t;if(typeof t=="symbol"?i=Symbol.prototype.toString.call(t):typeof t!="string"&&(i=String(t)),n==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let o="";for(let l=0;l<i.length;l+=bS){const c=i.length>=bS?i.slice(l,l+bS):i,u=[];for(let d=0;d<c.length;++d){let h=c.charCodeAt(d);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||s===Whe&&(h===40||h===41)){u[u.length]=c.charAt(d);continue}if(h<128){u[u.length]=Ko[h];continue}if(h<2048){u[u.length]=Ko[192|h>>6]+Ko[128|h&63];continue}if(h<55296||h>=57344){u[u.length]=Ko[224|h>>12]+Ko[128|h>>6&63]+Ko[128|h&63];continue}d+=1,h=65536+((h&1023)<<10|c.charCodeAt(d)&1023),u[u.length]=Ko[240|h>>18]+Ko[128|h>>12&63]+Ko[128|h>>6&63]+Ko[128|h&63]}o+=u.join("")}return o};function Khe(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function qD(t,e){if(Hhe(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const Yhe=Object.prototype.hasOwnProperty,F6={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},Zo=Array.isArray,Jhe=Array.prototype.push,O6=function(t,e){Jhe.apply(t,Zo(e)?e:[e])},Qhe=Date.prototype.toISOString,Hr={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:qhe,encodeValuesOnly:!1,format:YE,formatter:JE[YE],indices:!1,serializeDate(t){return Qhe.call(t)},skipNulls:!1,strictNullHandling:!1};function Xhe(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const _S={};function $6(t,e,n,r,s,i,o,l,c,u,d,h,f,m,g,x,v,w){let _=t,C=w,T=0,j=!1;for(;(C=C.get(_S))!==void 0&&!j;){const k=C.get(t);if(T+=1,typeof k<"u"){if(k===T)throw new RangeError("Cyclic object value");j=!0}typeof C.get(_S)>"u"&&(T=0)}if(typeof u=="function"?_=u(e,_):_ instanceof Date?_=f==null?void 0:f(_):n==="comma"&&Zo(_)&&(_=qD(_,function(k){return k instanceof Date?f==null?void 0:f(k):k})),_===null){if(i)return c&&!x?c(e,Hr.encoder,v,"key",m):e;_=""}if(Xhe(_)||Khe(_)){if(c){const k=x?e:c(e,Hr.encoder,v,"key",m);return[(g==null?void 0:g(k))+"="+(g==null?void 0:g(c(_,Hr.encoder,v,"value",m)))]}return[(g==null?void 0:g(e))+"="+(g==null?void 0:g(String(_)))]}const A=[];if(typeof _>"u")return A;let E;if(n==="comma"&&Zo(_))x&&c&&(_=qD(_,c)),E=[{value:_.length>0?_.join(",")||null:void 0}];else if(Zo(u))E=u;else{const k=Object.keys(_);E=d?k.sort(d):k}const I=l?String(e).replace(/\./g,"%2E"):String(e),N=r&&Zo(_)&&_.length===1?I+"[]":I;if(s&&Zo(_)&&_.length===0)return N+"[]";for(let k=0;k<E.length;++k){const R=E[k],D=typeof R=="object"&&typeof R.value<"u"?R.value:_[R];if(o&&D===null)continue;const M=h&&l?R.replace(/\./g,"%2E"):R,z=Zo(_)?typeof n=="function"?n(N,M):N:N+(h?"."+M:"["+M+"]");w.set(t,T);const B=new WeakMap;B.set(_S,w),O6(A,$6(D,z,n,r,s,i,o,l,n==="comma"&&x&&Zo(_)?null:c,u,d,h,f,m,g,x,v,B))}return A}function Zhe(t=Hr){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Hr.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=YE;if(typeof t.format<"u"){if(!Yhe.call(JE,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=JE[n];let s=Hr.filter;(typeof t.filter=="function"||Zo(t.filter))&&(s=t.filter);let i;if(t.arrayFormat&&t.arrayFormat in F6?i=t.arrayFormat:"indices"in t?i=t.indices?"indices":"repeat":i=Hr.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Hr.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Hr.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Hr.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Hr.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Hr.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Hr.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Hr.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Hr.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Hr.encodeValuesOnly,filter:s,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Hr.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Hr.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Hr.strictNullHandling}}function efe(t,e={}){let n=t;const r=Zhe(e);let s,i;typeof r.filter=="function"?(i=r.filter,n=i("",n)):Zo(r.filter)&&(i=r.filter,s=i);const o=[];if(typeof n!="object"||n===null)return"";const l=F6[r.arrayFormat],c=l==="comma"&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const u=new WeakMap;for(let f=0;f<s.length;++f){const m=s[f];r.skipNulls&&n[m]===null||O6(o,$6(n[m],m,l,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}const d=o.join(r.delimiter);let h=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),d.length>0?h+d:""}const Bd="4.103.0";let KD=!1,Zm,V6,U6,QE,B6,z6,G6,W6,H6;function tfe(t,e={auto:!1}){if(KD)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(Zm)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${Zm}'\``);KD=e.auto,Zm=t.kind,V6=t.fetch,t.Request,t.Response,t.Headers,U6=t.FormData,t.Blob,QE=t.File,B6=t.ReadableStream,z6=t.getMultipartRequestOptions,G6=t.getDefaultAgent,W6=t.fileFromPath,H6=t.isFsReadStream}class nfe{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function rfe({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new nfe(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}const q6=()=>{Zm||tfe(rfe(),{auto:!0})};q6();class zt extends Error{}class xs extends zt{constructor(e,n,r,s){super(`${xs.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=n;const i=n;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e||!s)return new rb({message:r,cause:ZE(n)});const i=n==null?void 0:n.error;return e===400?new K6(e,i,r,s):e===401?new Y6(e,i,r,s):e===403?new J6(e,i,r,s):e===404?new Q6(e,i,r,s):e===409?new X6(e,i,r,s):e===422?new Z6(e,i,r,s):e===429?new eB(e,i,r,s):e>=500?new tB(e,i,r,s):new xs(e,i,r,s)}}class ao extends xs{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class rb extends xs{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class bN extends rb{constructor({message:e}={}){super({message:e??"Request timed out."})}}class K6 extends xs{}class Y6 extends xs{}class J6 extends xs{}class Q6 extends xs{}class X6 extends xs{}class Z6 extends xs{}class eB extends xs{}class tB extends xs{}class nB extends zt{constructor(){super("Could not parse response content as the length limit was reached")}}class rB extends zt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var Xy=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},tu=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ni;class sb{constructor(){Ni.set(this,void 0),this.buffer=new Uint8Array,Xy(this,Ni,null,"f")}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+n.length);r.set(this.buffer),r.set(n,this.buffer.length),this.buffer=r;const s=[];let i;for(;(i=sfe(this.buffer,tu(this,Ni,"f")))!=null;){if(i.carriage&&tu(this,Ni,"f")==null){Xy(this,Ni,i.index,"f");continue}if(tu(this,Ni,"f")!=null&&(i.index!==tu(this,Ni,"f")+1||i.carriage)){s.push(this.decodeText(this.buffer.slice(0,tu(this,Ni,"f")-1))),this.buffer=this.buffer.slice(tu(this,Ni,"f")),Xy(this,Ni,null,"f");continue}const o=tu(this,Ni,"f")!==null?i.preceding-1:i.preceding,l=this.decodeText(this.buffer.slice(0,o));s.push(l),this.buffer=this.buffer.slice(i.index),Xy(this,Ni,null,"f")}return s}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new zt(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new zt(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new zt("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}Ni=new WeakMap;sb.NEWLINE_CHARS=new Set([`
`,"\r"]);sb.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function sfe(t,e){for(let s=e??0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function ife(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}function sB(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class ia{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const o of ofe(e,n))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null||o.event.startsWith("response.")||o.event.startsWith("transcript.")){let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(l&&l.error)throw new xs(void 0,l.error,void 0,dB(e.headers));yield l}else{let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(o.event=="error")throw new xs(void 0,l.error,l.message,void 0);yield{event:o.event,data:l}}}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||n.abort()}}return new ia(s,n)}static fromReadableStream(e,n){let r=!1;async function*s(){const o=new sb,l=sB(e);for await(const c of l)for(const u of o.decode(c))yield u;for(const c of o.flush())yield c}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const l of s())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||n.abort()}}return new ia(i,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),n.push(o)}return i.shift()}});return[new ia(()=>s(e),this.controller),new ia(()=>s(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new B6({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:o}=await n.next();if(o)return s.close();const l=r.encode(JSON.stringify(i)+`
`);s.enqueue(l)}catch(i){s.error(i)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*ofe(t,e){if(!t.body)throw e.abort(),new zt("Attempted to iterate over a response with no body");const n=new lfe,r=new sb,s=sB(t.body);for await(const i of afe(s))for(const o of r.decode(i)){const l=n.decode(o);l&&(yield l)}for(const i of r.flush()){const o=n.decode(i);o&&(yield o)}}async function*afe(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=ife(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class lfe{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=cfe(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function cfe(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}const iB=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",oB=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&ib(t),ib=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",ufe=t=>oB(t)||iB(t)||H6(t);async function aB(t,e,n){var s;if(t=await t,oB(t))return t;if(iB(t)){const i=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=ib(i)?[await i.arrayBuffer()]:[i];return new QE(o,e,n)}const r=await dfe(t);if(e||(e=ffe(t)??"unknown_file"),!(n!=null&&n.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(n={...n,type:i})}return new QE(r,e,n)}async function dfe(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(ib(t))e.push(await t.arrayBuffer());else if(mfe(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(n=t==null?void 0:t.constructor)==null?void 0:n.name}; props: ${hfe(t)}`);return e}function hfe(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function ffe(t){var e;return SS(t.name)||SS(t.filename)||((e=SS(t.path))==null?void 0:e.split(/[\\/]/).pop())}const SS=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},mfe=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",YD=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",qu=async t=>{const e=await pfe(t.body);return z6(e,t)},pfe=async t=>{const e=new U6;return await Promise.all(Object.entries(t||{}).map(([n,r])=>XE(e,n,r))),e},XE=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(ufe(n)){const r=await aB(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>XE(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>XE(t,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var gfe=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},yfe=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Zy;q6();async function lB(t){var o;const{response:e}=t;if(t.options.stream)return lc("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):ia.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type"),r=(o=n==null?void 0:n.split(";")[0])==null?void 0:o.trim();if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.endsWith("+json"))){const l=await e.json();return lc("response",e.status,e.url,e.headers,l),cB(l,e)}const i=await e.text();return lc("response",e.status,e.url,e.headers,i),i}function cB(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class ob extends Promise{constructor(e,n=lB){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new ob(this.responsePromise,async n=>cB(e(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class xfe{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=CS("maxRetries",n),this.timeout=CS("timeout",r),this.httpAgent=s,this.fetch=i??V6}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Sfe(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${Ife()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&ib(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:n,...s,body:i}}))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:n=0}={}){var x;const r={...e},{method:s,path:i,query:o,headers:l={}}=r,c=ArrayBuffer.isView(r.body)||r.__binaryRequest&&typeof r.body=="string"?r.body:YD(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,u=this.calculateContentLength(c),d=this.buildURL(i,o);"timeout"in r&&CS("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const h=r.httpAgent??this.httpAgent??G6(d),f=r.timeout+1e3;typeof((x=h==null?void 0:h.options)==null?void 0:x.timeout)=="number"&&f>(h.options.timeout??0)&&(h.options.timeout=f),this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:r,headers:l,contentLength:u,retryCount:n});return{req:{method:s,...c&&{body:c},headers:m,...h&&{agent:h},signal:r.signal??null},url:d,timeout:r.timeout}}buildHeaders({options:e,headers:n,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const o=this.defaultHeaders(e);return ZD(i,o),ZD(i,n),YD(e.body)&&Zm!=="node"&&delete i["content-type"],tx(o,"x-stainless-retry-count")===void 0&&tx(n,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),tx(o,"x-stainless-timeout")===void 0&&tx(n,"x-stainless-timeout")===void 0&&e.timeout&&(i["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(i,n),i}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,s){return xs.generate(e,n,r,s)}request(e,n=null){return new ob(this.makeRequest(e,n))}async makeRequest(e,n){var h,f;const r=await e,s=r.maxRetries??this.maxRetries;n==null&&(n=s),await this.prepareOptions(r);const{req:i,url:o,timeout:l}=this.buildRequest(r,{retryCount:s-n});if(await this.prepareRequest(i,{url:o,options:r}),lc("request",o,r,i.headers),(h=r.signal)!=null&&h.aborted)throw new ao;const c=new AbortController,u=await this.fetchWithTimeout(o,i,l,c).catch(ZE);if(u instanceof Error){if((f=r.signal)!=null&&f.aborted)throw new ao;if(n)return this.retryRequest(r,n);throw u.name==="AbortError"?new bN:new rb({cause:u})}const d=dB(u.headers);if(!u.ok){if(n&&this.shouldRetry(u)){const _=`retrying, ${n} attempts remaining`;return lc(`response (error; ${_})`,u.status,o,d),this.retryRequest(r,n,d)}const m=await u.text().catch(_=>ZE(_).message),g=Cfe(m),x=g?void 0:m;throw lc(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,u.status,o,d,x),this.makeStatusError(u.status,g,x,d)}return{response:u,options:r,controller:c}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new vfe(this,r,e)}buildURL(e,n){const r=Tfe(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return hB(s)||(n={...s,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new zt(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,s){const{signal:i,...o}=n||{};i&&i.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),r),c={signal:s.signal,...o};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,e,c).finally(()=>{clearTimeout(l)})}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const l=parseFloat(i);Number.isNaN(l)||(s=l)}const o=r==null?void 0:r["retry-after"];if(o&&!s){const l=parseFloat(o);Number.isNaN(l)?s=Date.parse(o)-Date.now():s=l*1e3}if(!(s&&0<=s&&s<60*1e3)){const l=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,l)}return await Mg(s),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,o=Math.min(.5*Math.pow(2,i),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Bd}`}}class uB{constructor(e,n,r,s){Zy.set(this,void 0),gfe(this,Zy,e,"f"),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new zt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);n.query=void 0,n.path=e.url.toString()}return await yfe(this,Zy,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Zy=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class vfe extends ob{constructor(e,n,r){super(n,async s=>new r(e,s.response,await lB(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const dB=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),wfe={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},ar=t=>typeof t=="object"&&t!==null&&!hB(t)&&Object.keys(t).every(e=>fB(wfe,e)),bfe=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bd,"X-Stainless-OS":QD(Deno.build.os),"X-Stainless-Arch":JD(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bd,"X-Stainless-OS":QD(process.platform),"X-Stainless-Arch":JD(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=_fe();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function _fe(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${s}.${i}.${o}`}}}return null}const JD=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",QD=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let XD;const Sfe=()=>XD??(XD=bfe()),Cfe=t=>{try{return JSON.parse(t)}catch{return}},Efe=/^[a-z][a-z0-9+.-]*:/i,Tfe=t=>Efe.test(t),Mg=t=>new Promise(e=>setTimeout(e,t)),CS=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new zt(`${t} must be an integer`);if(e<0)throw new zt(`${t} must be a positive integer`);return e},ZE=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},ex=t=>{var e,n,r,s,i;if(typeof process<"u")return((n=(e=process.env)==null?void 0:e[t])==null?void 0:n.trim())??void 0;if(typeof Deno<"u")return(i=(s=(r=Deno.env)==null?void 0:r.get)==null?void 0:s.call(r,t))==null?void 0:i.trim()};function hB(t){if(!t)return!0;for(const e in t)return!1;return!0}function fB(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ZD(t,e){for(const n in e){if(!fB(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];s===null?delete t[r]:s!==void 0&&(t[r]=s)}}const eM=new Set(["authorization","api-key"]);function lc(t,...e){var n;if(typeof process<"u"&&((n=process==null?void 0:process.env)==null?void 0:n.DEBUG)==="true"){const r=e.map(s=>{if(!s)return s;if(s.headers){const o={...s,headers:{...s.headers}};for(const l in s.headers)eM.has(l.toLowerCase())&&(o.headers[l]="REDACTED");return o}let i=null;for(const o in s)eM.has(o.toLowerCase())&&(i??(i={...s}),i[o]="REDACTED");return i??s});console.log(`OpenAI:DEBUG:${t}`,...r)}}const Ife=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),Nfe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Pfe=t=>typeof(t==null?void 0:t.get)=="function",tx=(t,e)=>{var r;const n=e.toLowerCase();if(Pfe(t)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,o,l)=>o+l.toUpperCase());for(const i of[e,n,e.toUpperCase(),s]){const o=t.get(i);if(o)return o}}for(const[s,i]of Object.entries(t))if(s.toLowerCase()===n)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i},Afe=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=e.charCodeAt(s);return Array.from(new Float32Array(r.buffer))}};function ES(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class ab extends uB{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Qr extends uB{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const n=(r=e[e.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class Ht{constructor(e){this._client=e}}let mB=class extends Ht{list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/chat/completions/${e}/messages`,kfe,{query:n,...r})}},lb=class extends Ht{constructor(){super(...arguments),this.messages=new mB(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(`/chat/completions/${e}`,n)}update(e,n,r){return this._client.post(`/chat/completions/${e}`,{body:n,...r})}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/chat/completions",cb,{query:e,...n})}del(e,n){return this._client.delete(`/chat/completions/${e}`,n)}};class cb extends Qr{}class kfe extends Qr{}lb.ChatCompletionsPage=cb;lb.Messages=mB;let ub=class extends Ht{constructor(){super(...arguments),this.completions=new lb(this._client)}};ub.Completions=lb;ub.ChatCompletionsPage=cb;class pB extends Ht{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}class gB extends Ht{create(e,n){return this._client.post("/audio/transcriptions",qu({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}}))}}class yB extends Ht{create(e,n){return this._client.post("/audio/translations",qu({body:e,...n,__metadata:{model:e.model}}))}}class Lg extends Ht{constructor(){super(...arguments),this.transcriptions=new gB(this._client),this.translations=new yB(this._client),this.speech=new pB(this._client)}}Lg.Transcriptions=gB;Lg.Translations=yB;Lg.Speech=pB;class _N extends Ht{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/batches",SN,{query:e,...n})}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}}class SN extends Qr{}_N.BatchesPage=SN;var So=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},dr=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},eT,Jx,Qx,wm,bm,Xx,_m,Ra,Sm,gw,yw,zd,xB;class CN{constructor(){eT.add(this),this.controller=new AbortController,Jx.set(this,void 0),Qx.set(this,()=>{}),wm.set(this,()=>{}),bm.set(this,void 0),Xx.set(this,()=>{}),_m.set(this,()=>{}),Ra.set(this,{}),Sm.set(this,!1),gw.set(this,!1),yw.set(this,!1),zd.set(this,!1),So(this,Jx,new Promise((e,n)=>{So(this,Qx,e,"f"),So(this,wm,n,"f")}),"f"),So(this,bm,new Promise((e,n)=>{So(this,Xx,e,"f"),So(this,_m,n,"f")}),"f"),dr(this,Jx,"f").catch(()=>{}),dr(this,bm,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},dr(this,eT,"m",xB).bind(this))},0)}_connected(){this.ended||(dr(this,Qx,"f").call(this),this._emit("connect"))}get ended(){return dr(this,Sm,"f")}get errored(){return dr(this,gw,"f")}get aborted(){return dr(this,yw,"f")}abort(){this.controller.abort()}on(e,n){return(dr(this,Ra,"f")[e]||(dr(this,Ra,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=dr(this,Ra,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(dr(this,Ra,"f")[e]||(dr(this,Ra,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{So(this,zd,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){So(this,zd,!0,"f"),await dr(this,bm,"f")}_emit(e,...n){if(dr(this,Sm,"f"))return;e==="end"&&(So(this,Sm,!0,"f"),dr(this,Xx,"f").call(this));const r=dr(this,Ra,"f")[e];if(r&&(dr(this,Ra,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!dr(this,zd,"f")&&!(r!=null&&r.length)&&Promise.reject(s),dr(this,wm,"f").call(this,s),dr(this,_m,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!dr(this,zd,"f")&&!(r!=null&&r.length)&&Promise.reject(s),dr(this,wm,"f").call(this,s),dr(this,_m,"f").call(this,s),this._emit("end")}}_emitFinal(){}}Jx=new WeakMap,Qx=new WeakMap,wm=new WeakMap,bm=new WeakMap,Xx=new WeakMap,_m=new WeakMap,Ra=new WeakMap,Sm=new WeakMap,gw=new WeakMap,yw=new WeakMap,zd=new WeakMap,eT=new WeakSet,xB=function(e){if(So(this,gw,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new ao),e instanceof ao)return So(this,yw,!0,"f"),this._emit("abort",e);if(e instanceof zt)return this._emit("error",e);if(e instanceof Error){const n=new zt(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new zt(String(e)))};var At=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ii=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},fs,tT,ea,Zx,Eo,Iu,hh,fu,xw,Ai,ev,tv,ep,Cm,Em,tM,nM,rM,sM,iM,oM,aM;class ko extends CN{constructor(){super(...arguments),fs.add(this),tT.set(this,[]),ea.set(this,{}),Zx.set(this,{}),Eo.set(this,void 0),Iu.set(this,void 0),hh.set(this,void 0),fu.set(this,void 0),xw.set(this,void 0),Ai.set(this,void 0),ev.set(this,void 0),tv.set(this,void 0),ep.set(this,void 0)}[(tT=new WeakMap,ea=new WeakMap,Zx=new WeakMap,Eo=new WeakMap,Iu=new WeakMap,hh=new WeakMap,fu=new WeakMap,xw=new WeakMap,Ai=new WeakMap,ev=new WeakMap,tv=new WeakMap,ep=new WeakMap,fs=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new ko;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=ia.fromReadableStream(e,this.controller);for await(const o of s)At(this,fs,"m",Cm).call(this,o);if((i=s.controller.signal)!=null&&i.aborted)throw new ao;return this._addRun(At(this,fs,"m",Em).call(this))}toReadableStream(){return new ia(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,s,i){const o=new ko;return o._run(()=>o._runToolAssistantStream(e,n,r,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,n,r,s,i){var u;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...s,stream:!0},c=await e.submitToolOutputs(n,r,l,{...i,signal:this.controller.signal});this._connected();for await(const d of c)At(this,fs,"m",Cm).call(this,d);if((u=c.controller.signal)!=null&&u.aborted)throw new ao;return this._addRun(At(this,fs,"m",Em).call(this))}static createThreadAssistantStream(e,n,r){const s=new ko;return s._run(()=>s._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,n,r,s){const i=new ko;return i._run(()=>i._runAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return At(this,ev,"f")}currentRun(){return At(this,tv,"f")}currentMessageSnapshot(){return At(this,Eo,"f")}currentRunStepSnapshot(){return At(this,ep,"f")}async finalRunSteps(){return await this.done(),Object.values(At(this,ea,"f"))}async finalMessages(){return await this.done(),Object.values(At(this,Zx,"f"))}async finalRun(){if(await this.done(),!At(this,Iu,"f"))throw Error("Final run was not received.");return At(this,Iu,"f")}async _createThreadAssistantStream(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const c of o)At(this,fs,"m",Cm).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new ao;return this._addRun(At(this,fs,"m",Em).call(this))}async _createAssistantStream(e,n,r,s){var c;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},l=await e.create(n,o,{...s,signal:this.controller.signal});this._connected();for await(const u of l)At(this,fs,"m",Cm).call(this,u);if((c=l.controller.signal)!=null&&c.aborted)throw new ao;return this._addRun(At(this,fs,"m",Em).call(this))}static accumulateDelta(e,n){for(const[r,s]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(ES(i)&&ES(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...s);continue}for(const o of s){if(!ES(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const l=o.index;if(l==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const c=i[l];c==null?i.push(o):i[l]=this.accumulateDelta(c,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,s){return await this._createAssistantStream(n,e,r,s)}async _runToolAssistantStream(e,n,r,s,i){return await this._createToolAssistantStream(r,e,n,s,i)}}Cm=function(e){if(!this.ended)switch(Ii(this,ev,e,"f"),At(this,fs,"m",rM).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":At(this,fs,"m",aM).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":At(this,fs,"m",nM).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":At(this,fs,"m",tM).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Em=function(){if(this.ended)throw new zt("stream has ended, this shouldn't happen");if(!At(this,Iu,"f"))throw Error("Final run has not been received");return At(this,Iu,"f")},tM=function(e){const[n,r]=At(this,fs,"m",iM).call(this,e,At(this,Eo,"f"));Ii(this,Eo,n,"f"),At(this,Zx,"f")[n.id]=n;for(const s of r){const i=n.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,o=n.content[s.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=At(this,hh,"f")){if(At(this,fu,"f"))switch(At(this,fu,"f").type){case"text":this._emit("textDone",At(this,fu,"f").text,At(this,Eo,"f"));break;case"image_file":this._emit("imageFileDone",At(this,fu,"f").image_file,At(this,Eo,"f"));break}Ii(this,hh,s.index,"f")}Ii(this,fu,n.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(At(this,hh,"f")!==void 0){const s=e.data.content[At(this,hh,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,At(this,Eo,"f"));break;case"text":this._emit("textDone",s.text,At(this,Eo,"f"));break}}At(this,Eo,"f")&&this._emit("messageDone",e.data),Ii(this,Eo,void 0,"f")}},nM=function(e){const n=At(this,fs,"m",sM).call(this,e);switch(Ii(this,ep,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==At(this,xw,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(At(this,Ai,"f")&&this._emit("toolCallDone",At(this,Ai,"f")),Ii(this,xw,i.index,"f"),Ii(this,Ai,n.step_details.tool_calls[i.index],"f"),At(this,Ai,"f")&&this._emit("toolCallCreated",At(this,Ai,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Ii(this,ep,void 0,"f"),e.data.step_details.type=="tool_calls"&&At(this,Ai,"f")&&(this._emit("toolCallDone",At(this,Ai,"f")),Ii(this,Ai,void 0,"f")),this._emit("runStepDone",e.data,n);break}},rM=function(e){At(this,tT,"f").push(e),this._emit("event",e)},sM=function(e){switch(e.event){case"thread.run.step.created":return At(this,ea,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=At(this,ea,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=ko.accumulateDelta(n,r.delta);At(this,ea,"f")[e.data.id]=s}return At(this,ea,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":At(this,ea,"f")[e.data.id]=e.data;break}if(At(this,ea,"f")[e.data.id])return At(this,ea,"f")[e.data.id];throw new Error("No snapshot available")},iM=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in n.content){let o=n.content[i.index];n.content[i.index]=At(this,fs,"m",oM).call(this,i,o)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},oM=function(e,n){return ko.accumulateDelta(n,e)},aM=function(e){switch(Ii(this,tv,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Ii(this,Iu,e.data,"f"),At(this,Ai,"f")&&(this._emit("toolCallDone",At(this,Ai,"f")),Ii(this,Ai,void 0,"f"));break}};class EN extends Ht{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/assistants/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/assistants",TN,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class TN extends Qr{}EN.AssistantsPage=TN;function lM(t){return typeof t.parse=="function"}const Th=t=>(t==null?void 0:t.role)==="assistant",vB=t=>(t==null?void 0:t.role)==="function",wB=t=>(t==null?void 0:t.role)==="tool";function IN(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function Fg(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function jfe(t,e){return!e||!bB(e)?{...t,choices:t.choices.map(n=>({...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:NN(t,e)}function NN(t,e){const n=t.choices.map(r=>{var s;if(r.finish_reason==="length")throw new nB;if(r.finish_reason==="content_filter")throw new rB;return{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(i=>Dfe(e,i)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?Rfe(e,r.message.content):null}}});return{...t,choices:n}}function Rfe(t,e){var n,r;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=t.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function Dfe(t,e){var r;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Fg(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function Mfe(t,e){var r;if(!t)return!1;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return Fg(n)||(n==null?void 0:n.function.strict)||!1}function bB(t){var e;return IN(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>Fg(n)||n.type==="function"&&n.function.strict===!0))??!1}function Lfe(t){for(const e of t??[]){if(e.type!=="function")throw new zt(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new zt(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var ai=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ns,nT,vw,rT,sT,iT,_B,oT;const cM=10;class SB extends CN{constructor(){super(...arguments),Ns.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(vB(e)||wB(e))&&e.content)this._emit("functionCallResult",e.content);else if(Th(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Th(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new zt("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),ai(this,Ns,"m",nT).call(this)}async finalMessage(){return await this.done(),ai(this,Ns,"m",vw).call(this)}async finalFunctionCall(){return await this.done(),ai(this,Ns,"m",rT).call(this)}async finalFunctionCallResult(){return await this.done(),ai(this,Ns,"m",sT).call(this)}async totalUsage(){return await this.done(),ai(this,Ns,"m",iT).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=ai(this,Ns,"m",vw).call(this);n&&this._emit("finalMessage",n);const r=ai(this,Ns,"m",nT).call(this);r&&this._emit("finalContent",r);const s=ai(this,Ns,"m",rT).call(this);s&&this._emit("finalFunctionCall",s);const i=ai(this,Ns,"m",sT).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",ai(this,Ns,"m",iT).call(this))}async _createChatCompletion(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),ai(this,Ns,"m",_B).call(this,n);const i=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(NN(i,n))}async _runChatCompletion(e,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,n,r)}async _runFunctions(e,n,r){var f;const s="function",{function_call:i="auto",stream:o,...l}=n,c=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:u=cM}=r||{},d={};for(const m of n.functions)d[m.name||m.function.name]=m;const h=n.functions.map(m=>({name:m.name||m.function.name,parameters:m.parameters,description:m.description}));for(const m of n.messages)this._addMessage(m,!1);for(let m=0;m<u;++m){const x=(f=(await this._createChatCompletion(e,{...l,function_call:i,functions:h,messages:[...this.messages]},r)).choices[0])==null?void 0:f.message;if(!x)throw new zt("missing message in ChatCompletion response");if(!x.function_call)return;const{name:v,arguments:w}=x.function_call,_=d[v];if(_){if(c&&c!==v){const A=`Invalid function_call: ${JSON.stringify(v)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,name:v,content:A});continue}}else{const A=`Invalid function_call: ${JSON.stringify(v)}. Available options are: ${h.map(E=>JSON.stringify(E.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:v,content:A});continue}let C;try{C=lM(_)?await _.parse(w):w}catch(A){this._addMessage({role:s,name:v,content:A instanceof Error?A.message:String(A)});continue}const T=await _.function(C,this),j=ai(this,Ns,"m",oT).call(this,T);if(this._addMessage({role:s,name:v,content:j}),c)return}}async _runTools(e,n,r){var m,g,x;const s="tool",{tool_choice:i="auto",stream:o,...l}=n,c=typeof i!="string"&&((m=i==null?void 0:i.function)==null?void 0:m.name),{maxChatCompletions:u=cM}=r||{},d=n.tools.map(v=>{if(Fg(v)){if(!v.$callback)throw new zt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),h={};for(const v of d)v.type==="function"&&(h[v.function.name||v.function.function.name]=v.function);const f="tools"in n?d.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of n.messages)this._addMessage(v,!1);for(let v=0;v<u;++v){const _=(g=(await this._createChatCompletion(e,{...l,tool_choice:i,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:g.message;if(!_)throw new zt("missing message in ChatCompletion response");if(!((x=_.tool_calls)!=null&&x.length))return;for(const C of _.tool_calls){if(C.type!=="function")continue;const T=C.id,{name:j,arguments:A}=C.function,E=h[j];if(E){if(c&&c!==j){const R=`Invalid tool_call: ${JSON.stringify(j)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,tool_call_id:T,content:R});continue}}else{const R=`Invalid tool_call: ${JSON.stringify(j)}. Available options are: ${Object.keys(h).map(D=>JSON.stringify(D)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:T,content:R});continue}let I;try{I=lM(E)?await E.parse(A):A}catch(R){const D=R instanceof Error?R.message:String(R);this._addMessage({role:s,tool_call_id:T,content:D});continue}const N=await E.function(I,this),k=ai(this,Ns,"m",oT).call(this,N);if(this._addMessage({role:s,tool_call_id:T,content:k}),c)return}}}}Ns=new WeakSet,nT=function(){return ai(this,Ns,"m",vw).call(this).content??null},vw=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Th(n)){const{function_call:r,...s}=n,i={...s,content:n.content??null,refusal:n.refusal??null};return r&&(i.function_call=r),i}}throw new zt("stream ended without producing a ChatCompletionMessage with role=assistant")},rT=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Th(s)&&(s!=null&&s.function_call))return s.function_call;if(Th(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(n=s.tool_calls.at(-1))==null?void 0:n.function}},sT=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(vB(n)&&n.content!=null||wB(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},iT=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},_B=function(e){if(e.n!=null&&e.n>1)throw new zt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},oT=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class zp extends SB{static runFunctions(e,n,r){const s=new zp,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new zp,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}_addMessage(e,n=!0){super._addMessage(e,n),Th(e)&&e.content&&this._emit("content",e.content)}}const CB=1,EB=2,TB=4,IB=8,NB=16,PB=32,AB=64,kB=128,jB=256,RB=kB|jB,DB=NB|PB|RB|AB,MB=CB|EB|DB,LB=TB|IB,Ffe=MB|LB,ns={STR:CB,NUM:EB,ARR:TB,OBJ:IB,NULL:NB,BOOL:PB,NAN:AB,INFINITY:kB,MINUS_INFINITY:jB,INF:RB,SPECIAL:DB,ATOM:MB,COLLECTION:LB,ALL:Ffe};class Ofe extends Error{}class $fe extends Error{}function Vfe(t,e=ns.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return Ufe(t.trim(),e)}const Ufe=(t,e)=>{const n=t.length;let r=0;const s=f=>{throw new Ofe(`${f} at position ${r}`)},i=f=>{throw new $fe(`${f} at position ${r}`)},o=()=>(h(),r>=n&&s("Unexpected end of input"),t[r]==='"'?l():t[r]==="{"?c():t[r]==="["?u():t.substring(r,r+4)==="null"||ns.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||ns.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||ns.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||ns.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||ns.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||ns.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):d()),l=()=>{const f=r;let m=!1;for(r++;r<n&&(t[r]!=='"'||m&&t[r-1]==="\\");)m=t[r]==="\\"?!m:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(f,++r-Number(m)))}catch(g){i(String(g))}else if(ns.STR&e)try{return JSON.parse(t.substring(f,r-Number(m))+'"')}catch{return JSON.parse(t.substring(f,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{r++,h();const f={};try{for(;t[r]!=="}";){if(h(),r>=n&&ns.OBJ&e)return f;const m=l();h(),r++;try{const g=o();Object.defineProperty(f,m,{value:g,writable:!0,enumerable:!0,configurable:!0})}catch(g){if(ns.OBJ&e)return f;throw g}h(),t[r]===","&&r++}}catch{if(ns.OBJ&e)return f;s("Expected '}' at end of object")}return r++,f},u=()=>{r++;const f=[];try{for(;t[r]!=="]";)f.push(o()),h(),t[r]===","&&r++}catch{if(ns.ARR&e)return f;s("Expected ']' at end of array")}return r++,f},d=()=>{if(r===0){t==="-"&&ns.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(m){if(ns.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}i(String(m))}}const f=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(ns.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(t.substring(f,r))}catch{t.substring(f,r)==="-"&&ns.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(f,t.lastIndexOf("e")))}catch(g){i(String(g))}}},h=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return o()},uM=t=>Vfe(t,ns.ALL^ns.NUM);var Nd=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Ln=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Wr,ja,Pd,Sl,TS,nx,IS,NS,PS,rx,AS,dM;class Gp extends SB{constructor(e){super(),Wr.add(this),ja.set(this,void 0),Pd.set(this,void 0),Sl.set(this,void 0),Nd(this,ja,e,"f"),Nd(this,Pd,[],"f")}get currentChatCompletionSnapshot(){return Ln(this,Sl,"f")}static fromReadableStream(e){const n=new Gp(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const s=new Gp(n);return s._run(()=>s._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,n,r){var o;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Ln(this,Wr,"m",TS).call(this);const i=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const l of i)Ln(this,Wr,"m",IS).call(this,l);if((o=i.controller.signal)!=null&&o.aborted)throw new ao;return this._addChatCompletion(Ln(this,Wr,"m",rx).call(this))}async _fromReadableStream(e,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Ln(this,Wr,"m",TS).call(this),this._connected();const s=ia.fromReadableStream(e,this.controller);let i;for await(const l of s)i&&i!==l.id&&this._addChatCompletion(Ln(this,Wr,"m",rx).call(this)),Ln(this,Wr,"m",IS).call(this,l),i=l.id;if((o=s.controller.signal)!=null&&o.aborted)throw new ao;return this._addChatCompletion(Ln(this,Wr,"m",rx).call(this))}[(ja=new WeakMap,Pd=new WeakMap,Sl=new WeakMap,Wr=new WeakSet,TS=function(){this.ended||Nd(this,Sl,void 0,"f")},nx=function(n){let r=Ln(this,Pd,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Ln(this,Pd,"f")[n.index]=r,r)},IS=function(n){var s,i,o,l,c,u,d,h,f,m,g,x,v,w,_;if(this.ended)return;const r=Ln(this,Wr,"m",dM).call(this,n);this._emit("chunk",n,r);for(const C of n.choices){const T=r.choices[C.index];C.delta.content!=null&&((s=T.message)==null?void 0:s.role)==="assistant"&&((i=T.message)!=null&&i.content)&&(this._emit("content",C.delta.content,T.message.content),this._emit("content.delta",{delta:C.delta.content,snapshot:T.message.content,parsed:T.message.parsed})),C.delta.refusal!=null&&((o=T.message)==null?void 0:o.role)==="assistant"&&((l=T.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:C.delta.refusal,snapshot:T.message.refusal}),((c=C.logprobs)==null?void 0:c.content)!=null&&((u=T.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(d=C.logprobs)==null?void 0:d.content,snapshot:((h=T.logprobs)==null?void 0:h.content)??[]}),((f=C.logprobs)==null?void 0:f.refusal)!=null&&((m=T.message)==null?void 0:m.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(g=C.logprobs)==null?void 0:g.refusal,snapshot:((x=T.logprobs)==null?void 0:x.refusal)??[]});const j=Ln(this,Wr,"m",nx).call(this,T);T.finish_reason&&(Ln(this,Wr,"m",PS).call(this,T),j.current_tool_call_index!=null&&Ln(this,Wr,"m",NS).call(this,T,j.current_tool_call_index));for(const A of C.delta.tool_calls??[])j.current_tool_call_index!==A.index&&(Ln(this,Wr,"m",PS).call(this,T),j.current_tool_call_index!=null&&Ln(this,Wr,"m",NS).call(this,T,j.current_tool_call_index)),j.current_tool_call_index=A.index;for(const A of C.delta.tool_calls??[]){const E=(v=T.message.tool_calls)==null?void 0:v[A.index];E!=null&&E.type&&((E==null?void 0:E.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(w=E.function)==null?void 0:w.name,index:A.index,arguments:E.function.arguments,parsed_arguments:E.function.parsed_arguments,arguments_delta:((_=A.function)==null?void 0:_.arguments)??""}):(E==null||E.type,void 0))}}},NS=function(n,r){var o,l,c;if(Ln(this,Wr,"m",nx).call(this,n).done_tool_calls.has(r))return;const i=(o=n.message.tool_calls)==null?void 0:o[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const u=(c=(l=Ln(this,ja,"f"))==null?void 0:l.tools)==null?void 0:c.find(d=>d.type==="function"&&d.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:Fg(u)?u.$parseRaw(i.function.arguments):u!=null&&u.function.strict?JSON.parse(i.function.arguments):null})}else i.type},PS=function(n){var s,i;const r=Ln(this,Wr,"m",nx).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const o=Ln(this,Wr,"m",AS).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(s=n.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(i=n.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},rx=function(){if(this.ended)throw new zt("stream has ended, this shouldn't happen");const n=Ln(this,Sl,"f");if(!n)throw new zt("request ended without sending any chunks");return Nd(this,Sl,void 0,"f"),Nd(this,Pd,[],"f"),Bfe(n,Ln(this,ja,"f"))},AS=function(){var r;const n=(r=Ln(this,ja,"f"))==null?void 0:r.response_format;return IN(n)?n:null},dM=function(n){var r,s,i,o;let l=Ln(this,Sl,"f");const{choices:c,...u}=n;l?Object.assign(l,u):l=Nd(this,Sl,{...u,choices:[]},"f");for(const{delta:d,finish_reason:h,index:f,logprobs:m=null,...g}of n.choices){let x=l.choices[f];if(x||(x=l.choices[f]={finish_reason:h,index:f,message:{},logprobs:m,...g}),m)if(!x.logprobs)x.logprobs=Object.assign({},m);else{const{content:A,refusal:E,...I}=m;Object.assign(x.logprobs,I),A&&((r=x.logprobs).content??(r.content=[]),x.logprobs.content.push(...A)),E&&((s=x.logprobs).refusal??(s.refusal=[]),x.logprobs.refusal.push(...E))}if(h&&(x.finish_reason=h,Ln(this,ja,"f")&&bB(Ln(this,ja,"f")))){if(h==="length")throw new nB;if(h==="content_filter")throw new rB}if(Object.assign(x,g),!d)continue;const{content:v,refusal:w,function_call:_,role:C,tool_calls:T,...j}=d;if(Object.assign(x.message,j),w&&(x.message.refusal=(x.message.refusal||"")+w),C&&(x.message.role=C),_&&(x.message.function_call?(_.name&&(x.message.function_call.name=_.name),_.arguments&&((i=x.message.function_call).arguments??(i.arguments=""),x.message.function_call.arguments+=_.arguments)):x.message.function_call=_),v&&(x.message.content=(x.message.content||"")+v,!x.message.refusal&&Ln(this,Wr,"m",AS).call(this)&&(x.message.parsed=uM(x.message.content))),T){x.message.tool_calls||(x.message.tool_calls=[]);for(const{index:A,id:E,type:I,function:N,...k}of T){const R=(o=x.message.tool_calls)[A]??(o[A]={});Object.assign(R,k),E&&(R.id=E),I&&(R.type=I),N&&(R.function??(R.function={name:N.name??"",arguments:""})),N!=null&&N.name&&(R.function.name=N.name),N!=null&&N.arguments&&(R.function.arguments+=N.arguments,Mfe(Ln(this,ja,"f"),R)&&(R.function.parsed_arguments=uM(R.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ia(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Bfe(t,e){const{id:n,choices:r,created:s,model:i,system_fingerprint:o,...l}=t,c={...l,id:n,choices:r.map(({message:u,finish_reason:d,index:h,logprobs:f,...m})=>{if(!d)throw new zt(`missing finish_reason for choice ${h}`);const{content:g=null,function_call:x,tool_calls:v,...w}=u,_=u.role;if(!_)throw new zt(`missing role for choice ${h}`);if(x){const{arguments:C,name:T}=x;if(C==null)throw new zt(`missing function_call.arguments for choice ${h}`);if(!T)throw new zt(`missing function_call.name for choice ${h}`);return{...m,message:{content:g,function_call:{arguments:C,name:T},role:_,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}return v?{...m,index:h,finish_reason:d,logprobs:f,message:{...w,role:_,content:g,refusal:u.refusal??null,tool_calls:v.map((C,T)=>{const{function:j,type:A,id:E,...I}=C,{arguments:N,name:k,...R}=j||{};if(E==null)throw new zt(`missing choices[${h}].tool_calls[${T}].id
${sx(t)}`);if(A==null)throw new zt(`missing choices[${h}].tool_calls[${T}].type
${sx(t)}`);if(k==null)throw new zt(`missing choices[${h}].tool_calls[${T}].function.name
${sx(t)}`);if(N==null)throw new zt(`missing choices[${h}].tool_calls[${T}].function.arguments
${sx(t)}`);return{...I,id:E,type:A,function:{...R,name:k,arguments:N}}})}}:{...m,message:{...w,content:g,role:_,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}),created:s,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return jfe(c,e)}function sx(t){return JSON.stringify(t)}class Ih extends Gp{static fromReadableStream(e){const n=new Ih(null);return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,r){const s=new Ih(null),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Ih(n),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}}let FB=class extends Ht{parse(e,n){return Lfe(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>NN(r,e))}runFunctions(e,n){return e.stream?Ih.runFunctions(this._client,e,n):zp.runFunctions(this._client,e,n)}runTools(e,n){return e.stream?Ih.runTools(this._client,e,n):zp.runTools(this._client,e,n)}stream(e,n){return Gp.createChatCompletion(this._client,e,n)}};class aT extends Ht{constructor(){super(...arguments),this.completions=new FB(this._client)}}(function(t){t.Completions=FB})(aT||(aT={}));class OB extends Ht{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class $B extends Ht{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class db extends Ht{constructor(){super(...arguments),this.sessions=new OB(this._client),this.transcriptionSessions=new $B(this._client)}}db.Sessions=OB;db.TranscriptionSessions=$B;class PN extends Ht{create(e,n,r){return this._client.post(`/threads/${e}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/messages/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,AN,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class AN extends Qr{}PN.MessagesPage=AN;class kN extends Ht{retrieve(e,n,r,s={},i){return ar(s)?this.retrieve(e,n,r,{},s):this._client.get(`/threads/${e}/runs/${n}/steps/${r}`,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,n,r={},s){return ar(r)?this.list(e,n,{},r):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,jN,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class jN extends Qr{}kN.RunStepsPage=jN;let Og=class extends Ht{constructor(){super(...arguments),this.steps=new kN(this._client)}create(e,n,r){const{include:s,...i}=n;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:i,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(e,n,r){return this._client.get(`/threads/${e}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,RN,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}createAndStream(e,n,r){return ko.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await Mg(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,n,r){return ko.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,n,r,s){const i=await this.submitToolOutputs(e,n,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,n,r,s){return ko.createToolAssistantStream(e,n,this._client.beta.threads.runs,r,s)}};class RN extends Qr{}Og.RunsPage=RN;Og.Steps=kN;Og.RunStepsPage=jN;class _f extends Ht{constructor(){super(...arguments),this.runs=new Og(this._client),this.messages=new PN(this._client)}create(e={},n){return ar(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/threads/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(e,n){return ko.createThreadAssistantStream(e,this._client.beta.threads,n)}}_f.Runs=Og;_f.RunsPage=RN;_f.Messages=PN;_f.MessagesPage=AN;class Sf extends Ht{constructor(){super(...arguments),this.realtime=new db(this._client),this.chat=new aT(this._client),this.assistants=new EN(this._client),this.threads=new _f(this._client)}}Sf.Realtime=db;Sf.Assistants=EN;Sf.AssistantsPage=TN;Sf.Threads=_f;class VB extends Ht{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}let UB=class extends Ht{retrieve(e,n,r){return this._client.get(`/containers/${e}/files/${n}/content`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}},hb=class extends Ht{constructor(){super(...arguments),this.content=new UB(this._client)}create(e,n,r){return this._client.post(`/containers/${e}/files`,qu({body:n,...r}))}retrieve(e,n,r){return this._client.get(`/containers/${e}/files/${n}`,r)}list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/containers/${e}/files`,DN,{query:n,...r})}del(e,n,r){return this._client.delete(`/containers/${e}/files/${n}`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}};class DN extends Qr{}hb.FileListResponsesPage=DN;hb.Content=UB;class $g extends Ht{constructor(){super(...arguments),this.files=new hb(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(`/containers/${e}`,n)}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/containers",MN,{query:e,...n})}del(e,n){return this._client.delete(`/containers/${e}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}}class MN extends Qr{}$g.ContainerListResponsesPage=MN;$g.Files=hb;$g.FileListResponsesPage=DN;class BB extends Ht{create(e,n){const r=!!e.encoding_format;let s=r?e.encoding_format:"base64";r&&lc("Request","User defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:s},...n});return r?i:(lc("response","Decoding base64 embeddings to float32 array"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(l=>{const c=l.embedding;l.embedding=Afe(c)}),o)))}}class LN extends Ht{retrieve(e,n,r,s){return this._client.get(`/evals/${e}/runs/${n}/output_items/${r}`,s)}list(e,n,r={},s){return ar(r)?this.list(e,n,{},r):this._client.getAPIList(`/evals/${e}/runs/${n}/output_items`,FN,{query:r,...s})}}class FN extends Qr{}LN.OutputItemListResponsesPage=FN;class Vg extends Ht{constructor(){super(...arguments),this.outputItems=new LN(this._client)}create(e,n,r){return this._client.post(`/evals/${e}/runs`,{body:n,...r})}retrieve(e,n,r){return this._client.get(`/evals/${e}/runs/${n}`,r)}list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/evals/${e}/runs`,ON,{query:n,...r})}del(e,n,r){return this._client.delete(`/evals/${e}/runs/${n}`,r)}cancel(e,n,r){return this._client.post(`/evals/${e}/runs/${n}`,r)}}class ON extends Qr{}Vg.RunListResponsesPage=ON;Vg.OutputItems=LN;Vg.OutputItemListResponsesPage=FN;class Ug extends Ht{constructor(){super(...arguments),this.runs=new Vg(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(`/evals/${e}`,n)}update(e,n,r){return this._client.post(`/evals/${e}`,{body:n,...r})}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/evals",$N,{query:e,...n})}del(e,n){return this._client.delete(`/evals/${e}`,n)}}class $N extends Qr{}Ug.EvalListResponsesPage=$N;Ug.Runs=Vg;Ug.RunListResponsesPage=ON;let VN=class extends Ht{create(e,n){return this._client.post("/files",qu({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/files",UN,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,n)}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!s.has(o.status);)if(await Mg(n),o=await this.retrieve(e),Date.now()-i>r)throw new bN({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}};class UN extends Qr{}VN.FileObjectsPage=UN;class zB extends Ht{}let GB=class extends Ht{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class BN extends Ht{constructor(){super(...arguments),this.graders=new GB(this._client)}}BN.Graders=GB;class zN extends Ht{create(e,n,r){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,GN,{body:n,method:"post",...r})}retrieve(e,n={},r){return ar(n)?this.retrieve(e,{},n):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...r})}del(e,n,r){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${n}`,r)}}class GN extends ab{}zN.PermissionCreateResponsesPage=GN;let fb=class extends Ht{constructor(){super(...arguments),this.permissions=new zN(this._client)}};fb.Permissions=zN;fb.PermissionCreateResponsesPage=GN;class WN extends Ht{list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,HN,{query:n,...r})}}class HN extends Qr{}WN.FineTuningJobCheckpointsPage=HN;class Cf extends Ht{constructor(){super(...arguments),this.checkpoints=new WN(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",qN,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return ar(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,KN,{query:n,...r})}pause(e,n){return this._client.post(`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(`/fine_tuning/jobs/${e}/resume`,n)}}class qN extends Qr{}class KN extends Qr{}Cf.FineTuningJobsPage=qN;Cf.FineTuningJobEventsPage=KN;Cf.Checkpoints=WN;Cf.FineTuningJobCheckpointsPage=HN;class Vc extends Ht{constructor(){super(...arguments),this.methods=new zB(this._client),this.jobs=new Cf(this._client),this.checkpoints=new fb(this._client),this.alpha=new BN(this._client)}}Vc.Methods=zB;Vc.Jobs=Cf;Vc.FineTuningJobsPage=qN;Vc.FineTuningJobEventsPage=KN;Vc.Checkpoints=fb;Vc.Alpha=BN;class WB extends Ht{}class YN extends Ht{constructor(){super(...arguments),this.graderModels=new WB(this._client)}}YN.GraderModels=WB;class HB extends Ht{createVariation(e,n){return this._client.post("/images/variations",qu({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",qu({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}class JN extends Ht{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",QN,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class QN extends ab{}JN.ModelsPage=QN;class qB extends Ht{create(e,n){return this._client.post("/moderations",{body:e,...n})}}function zfe(t,e){return!e||!Wfe(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(r=>({...r,parsed:null}))}:n)}:KB(t,e)}function KB(t,e){const n=t.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:Kfe(e,s)};if(s.type==="message"){const i=s.content.map(o=>o.type==="output_text"?{...o,parsed:Gfe(e,o.text)}:o);return{...s,content:i}}return s}),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||lT(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const s of r.output)if(s.type==="message"){for(const i of s.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),r}function Gfe(t,e){var n,r,s,i;return((r=(n=t.text)==null?void 0:n.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((s=t.text)==null?void 0:s.format)?((i=t.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function Wfe(t){var e;return!!IN((e=t.text)==null?void 0:e.format)}function Hfe(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function qfe(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function Kfe(t,e){const n=qfe(t.tools??[],e.name);return{...e,...e,parsed_arguments:Hfe(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function lT(t){const e=[];for(const n of t.output)if(n.type==="message")for(const r of n.content)r.type==="output_text"&&e.push(r.text);t.output_text=e.join("")}class YB extends Ht{list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/responses/${e}/input_items`,Jfe,{query:n,...r})}}var Ad=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Cl=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},kd,ix,El,ox,hM,fM,mM,pM;class XN extends CN{constructor(e){super(),kd.add(this),ix.set(this,void 0),El.set(this,void 0),ox.set(this,void 0),Ad(this,ix,e,"f")}static createResponse(e,n,r){const s=new XN(n);return s._run(()=>s._createOrRetrieveResponse(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createOrRetrieveResponse(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Cl(this,kd,"m",hM).call(this);let i,o=null;"response_id"in n?(i=await e.responses.retrieve(n.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),o=n.starting_after??null):i=await e.responses.create({...n,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const c of i)Cl(this,kd,"m",fM).call(this,c,o);if((l=i.controller.signal)!=null&&l.aborted)throw new ao;return Cl(this,kd,"m",mM).call(this)}[(ix=new WeakMap,El=new WeakMap,ox=new WeakMap,kd=new WeakSet,hM=function(){this.ended||Ad(this,El,void 0,"f")},fM=function(n,r){if(this.ended)return;const s=(o,l)=>{(r==null||l.sequence_number>r)&&this._emit(o,l)},i=Cl(this,kd,"m",pM).call(this,n);switch(s("event",n),n.type){case"response.output_text.delta":{const o=i.output[n.output_index];if(!o)throw new zt(`missing output at index ${n.output_index}`);if(o.type==="message"){const l=o.content[n.content_index];if(!l)throw new zt(`missing content at index ${n.content_index}`);if(l.type!=="output_text")throw new zt(`expected content to be 'output_text', got ${l.type}`);s("response.output_text.delta",{...n,snapshot:l.text})}break}case"response.function_call_arguments.delta":{const o=i.output[n.output_index];if(!o)throw new zt(`missing output at index ${n.output_index}`);o.type==="function_call"&&s("response.function_call_arguments.delta",{...n,snapshot:o.arguments});break}default:s(n.type,n);break}},mM=function(){if(this.ended)throw new zt("stream has ended, this shouldn't happen");const n=Cl(this,El,"f");if(!n)throw new zt("request ended without sending any events");Ad(this,El,void 0,"f");const r=Yfe(n,Cl(this,ix,"f"));return Ad(this,ox,r,"f"),r},pM=function(n){let r=Cl(this,El,"f");if(!r){if(n.type!=="response.created")throw new zt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return r=Ad(this,El,n.response,"f"),r}switch(n.type){case"response.output_item.added":{r.output.push(n.item);break}case"response.content_part.added":{const s=r.output[n.output_index];if(!s)throw new zt(`missing output at index ${n.output_index}`);s.type==="message"&&s.content.push(n.part);break}case"response.output_text.delta":{const s=r.output[n.output_index];if(!s)throw new zt(`missing output at index ${n.output_index}`);if(s.type==="message"){const i=s.content[n.content_index];if(!i)throw new zt(`missing content at index ${n.content_index}`);if(i.type!=="output_text")throw new zt(`expected content to be 'output_text', got ${i.type}`);i.text+=n.delta}break}case"response.function_call_arguments.delta":{const s=r.output[n.output_index];if(!s)throw new zt(`missing output at index ${n.output_index}`);s.type==="function_call"&&(s.arguments+=n.delta);break}case"response.completed":{Ad(this,El,n.response,"f");break}}return r},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=Cl(this,ox,"f");if(!e)throw new zt("stream ended without producing a ChatCompletion");return e}}function Yfe(t,e){return zfe(t,e)}class ZN extends Ht{constructor(){super(...arguments),this.inputItems=new YB(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&lT(r),r))}retrieve(e,n={},r){return ar(n)&&r===void 0?this.retrieve(e,{},n):this._client.get(`/responses/${e}`,{query:n,...r,stream:n.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&lT(s),s))}del(e,n){return this._client.delete(`/responses/${e}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(r=>KB(r,e))}stream(e,n){return XN.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(`/responses/${e}/cancel`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}}class Jfe extends Qr{}ZN.InputItems=YB;class JB extends Ht{create(e,n,r){return this._client.post(`/uploads/${e}/parts`,qu({body:n,...r}))}}class eP extends Ht{constructor(){super(...arguments),this.parts=new JB(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(`/uploads/${e}/complete`,{body:n,...r})}}eP.Parts=JB;const Qfe=async t=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};class mb extends Ht{create(e,n,r){return this._client.post(`/vector_stores/${e}/files`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/vector_stores/${e}/files/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,pb,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,n,{...r,headers:s}).withResponse(),o=i.data;switch(o.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=i.response.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await Mg(l);break;case"failed":case"completed":return o}}}async upload(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,n,r){const s=await this.upload(e,n,r);return await this.poll(e,s.id,r)}content(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/files/${n}/content`,tP,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class pb extends Qr{}class tP extends ab{}mb.VectorStoreFilesPage=pb;mb.FileContentResponsesPage=tP;class QB extends Ht{create(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n);return await this.poll(e,s.id,r)}listFiles(e,n,r={},s){return ar(r)?this.listFiles(e,n,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,pb,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await Mg(l);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},s){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(s==null?void 0:s.maxConcurrency)??5,o=Math.min(i,n.length),l=this._client,c=n.values(),u=[...r];async function d(f){for(let m of f){const g=await l.files.create({file:m,purpose:"assistants"},s);u.push(g.id)}}const h=Array(o).fill(c).map(d);return await Qfe(h),await this.createAndPoll(e,{file_ids:u})}}class Uc extends Ht{constructor(){super(...arguments),this.files=new mb(this._client),this.fileBatches=new QB(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/vector_stores/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/vector_stores",nP,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}search(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/search`,rP,{body:n,method:"post",...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class nP extends Qr{}class rP extends ab{}Uc.VectorStoresPage=nP;Uc.VectorStoreSearchResponsesPage=rP;Uc.Files=mb;Uc.VectorStoreFilesPage=pb;Uc.FileContentResponsesPage=tP;Uc.FileBatches=QB;var XB;class Zt extends xfe{constructor({baseURL:e=ex("OPENAI_BASE_URL"),apiKey:n=ex("OPENAI_API_KEY"),organization:r=ex("OPENAI_ORG_ID")??null,project:s=ex("OPENAI_PROJECT_ID")??null,...i}={}){if(n===void 0)throw new zt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:n,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&Nfe())throw new zt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new VB(this),this.chat=new ub(this),this.embeddings=new BB(this),this.files=new VN(this),this.images=new HB(this),this.audio=new Lg(this),this.moderations=new qB(this),this.models=new JN(this),this.fineTuning=new Vc(this),this.graders=new YN(this),this.vectorStores=new Uc(this),this.beta=new Sf(this),this.batches=new _N(this),this.uploads=new eP(this),this.responses=new ZN(this),this.evals=new Ug(this),this.containers=new $g(this),this._options=o,this.apiKey=n,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return efe(e,{arrayFormat:"brackets"})}}XB=Zt;Zt.OpenAI=XB;Zt.DEFAULT_TIMEOUT=6e5;Zt.OpenAIError=zt;Zt.APIError=xs;Zt.APIConnectionError=rb;Zt.APIConnectionTimeoutError=bN;Zt.APIUserAbortError=ao;Zt.NotFoundError=Q6;Zt.ConflictError=X6;Zt.RateLimitError=eB;Zt.BadRequestError=K6;Zt.AuthenticationError=Y6;Zt.InternalServerError=tB;Zt.PermissionDeniedError=J6;Zt.UnprocessableEntityError=Z6;Zt.toFile=aB;Zt.fileFromPath=W6;Zt.Completions=VB;Zt.Chat=ub;Zt.ChatCompletionsPage=cb;Zt.Embeddings=BB;Zt.Files=VN;Zt.FileObjectsPage=UN;Zt.Images=HB;Zt.Audio=Lg;Zt.Moderations=qB;Zt.Models=JN;Zt.ModelsPage=QN;Zt.FineTuning=Vc;Zt.Graders=YN;Zt.VectorStores=Uc;Zt.VectorStoresPage=nP;Zt.VectorStoreSearchResponsesPage=rP;Zt.Beta=Sf;Zt.Batches=_N;Zt.BatchesPage=SN;Zt.Uploads=eP;Zt.Responses=ZN;Zt.Evals=Ug;Zt.EvalListResponsesPage=$N;Zt.Containers=$g;Zt.ContainerListResponsesPage=MN;const Xfe=Zt,Zfe="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",eme=new Xfe({apiKey:Zfe,dangerouslyAllowBrowser:!0});async function ZB(t,e={}){if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required for OpenAI image generation.");console.log(`[OpenAI] Generating image with prompt: "${t}"`);try{const n=await eme.images.generate({model:"gpt-image-1",prompt:t,n:e.n||1,size:e.size||"1024x1024",quality:e.quality||"auto",response_format:"b64_json"});if(console.log("[OpenAI] Image generation response:",n),n.data&&n.data.length>0&&n.data[0].b64_json)return{b64_json:n.data[0].b64_json,alt:`OpenAI generated image for: ${t.substring(0,50)}`,revised_prompt:n.data[0].revised_prompt};throw new Error("No image data found in OpenAI response.")}catch(n){throw console.error("[OpenAI] Error generating image:",n),n.response&&n.response.data&&n.response.data.error?new Error(`OpenAI API Error: ${n.response.data.error.message}`):n}}const tme=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ez=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},nme=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},tz={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,h=(i&3)<<4|l>>4;let f=(l&15)<<2|u>>6,m=u&63;c||(m=64,o||(f=64)),r.push(n[d],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ez(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):nme(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||h==null)throw new rme;const f=i<<2|l>>4;if(r.push(f),u!==64){const m=l<<4&240|u>>2;if(r.push(m),h!==64){const g=u<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class rme extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const sme=function(t){const e=ez(t);return tz.encodeByteArray(e,!0)},ww=function(t){return sme(t).replace(/\./g,"")},nz=function(t){try{return tz.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rz(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ime=()=>rz().__FIREBASE_DEFAULTS__,ome=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ame=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&nz(t[1]);return e&&JSON.parse(e)},gb=()=>{try{return tme()||ime()||ome()||ame()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},sz=t=>{var e,n;return(n=(e=gb())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},sP=t=>{const e=sz(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},iz=()=>{var t;return(t=gb())===null||t===void 0?void 0:t.config},oz=t=>{var e;return(e=gb())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lme{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(t){return t.endsWith(".cloudworkstations.dev")}async function yb(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function az(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[ww(JSON.stringify(n)),ww(JSON.stringify(o)),l].join(".")}const tp={};function cme(){const t={prod:[],emulator:[]};for(const e of Object.keys(tp))tp[e]?t.emulator.push(e):t.prod.push(e);return t}function ume(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let gM=!1;function xb(t,e){if(typeof window>"u"||typeof document>"u"||!Bc(window.location.host)||tp[t]===e||tp[t]||gM)return;tp[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=cme().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function l(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,m){f.setAttribute("width","24"),f.setAttribute("id",m),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function u(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{gM=!0,o()},f}function d(f,m){f.setAttribute("id",m),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=ume(r),m=n("text"),g=document.getElementById(m)||document.createElement("span"),x=n("learnmore"),v=document.getElementById(x)||document.createElement("a"),w=n("preprendIcon"),_=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const C=f.element;l(C),d(v,x);const T=u();c(_,w),C.append(_,g,v,T),document.body.appendChild(C)}i?(g.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function dme(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jr())}function lz(){var t;const e=(t=gb())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function hme(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function fme(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function mme(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function pme(){const t=Jr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function cz(){return!lz()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function uz(){return!lz()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function dz(){try{return typeof indexedDB=="object"}catch{return!1}}function gme(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yme="FirebaseError";class Go extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=yme,Object.setPrototypeOf(this,Go.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Bg.prototype.create)}}class Bg{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?xme(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Go(s,l,r)}}function xme(t,e){return t.replace(vme,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const vme=/\{\$([^}]+)}/g;function wme(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ku(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(yM(i)&&yM(o)){if(!Ku(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function yM(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zg(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Tm(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Im(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function bme(t,e){const n=new _me(t,e);return n.subscribe.bind(n)}class _me{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Sme(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=kS),s.error===void 0&&(s.error=kS),s.complete===void 0&&(s.complete=kS);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Sme(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function kS(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qn(t){return t&&t._delegate?t._delegate:t}class sl{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lu="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cme{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new lme;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Tme(e))try{this.getOrInitializeService({instanceIdentifier:lu})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=lu){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=lu){return this.instances.has(e)}getOptions(e=lu){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Eme(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=lu){return this.component?this.component.multipleInstances?e:lu:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Eme(t){return t===lu?void 0:t}function Tme(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ime{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Cme(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(dn||(dn={}));const Nme={debug:dn.DEBUG,verbose:dn.VERBOSE,info:dn.INFO,warn:dn.WARN,error:dn.ERROR,silent:dn.SILENT},Pme=dn.INFO,Ame={[dn.DEBUG]:"log",[dn.VERBOSE]:"log",[dn.INFO]:"info",[dn.WARN]:"warn",[dn.ERROR]:"error"},kme=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Ame[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class iP{constructor(e){this.name=e,this._logLevel=Pme,this._logHandler=kme,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Nme[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,dn.DEBUG,...e),this._logHandler(this,dn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,dn.VERBOSE,...e),this._logHandler(this,dn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,dn.INFO,...e),this._logHandler(this,dn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,dn.WARN,...e),this._logHandler(this,dn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,dn.ERROR,...e),this._logHandler(this,dn.ERROR,...e)}}const jme=(t,e)=>e.some(n=>t instanceof n);let xM,vM;function Rme(){return xM||(xM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Dme(){return vM||(vM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const hz=new WeakMap,cT=new WeakMap,fz=new WeakMap,jS=new WeakMap,oP=new WeakMap;function Mme(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(cc(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&hz.set(n,t)}).catch(()=>{}),oP.set(e,t),e}function Lme(t){if(cT.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});cT.set(t,e)}let uT={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return cT.get(t);if(e==="objectStoreNames")return t.objectStoreNames||fz.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return cc(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Fme(t){uT=t(uT)}function Ome(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(RS(this),e,...n);return fz.set(r,e.sort?e.sort():[e]),cc(r)}:Dme().includes(t)?function(...e){return t.apply(RS(this),e),cc(hz.get(this))}:function(...e){return cc(t.apply(RS(this),e))}}function $me(t){return typeof t=="function"?Ome(t):(t instanceof IDBTransaction&&Lme(t),jme(t,Rme())?new Proxy(t,uT):t)}function cc(t){if(t instanceof IDBRequest)return Mme(t);if(jS.has(t))return jS.get(t);const e=$me(t);return e!==t&&(jS.set(t,e),oP.set(e,t)),e}const RS=t=>oP.get(t);function Vme(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=cc(o);return r&&o.addEventListener("upgradeneeded",c=>{r(cc(o.result),c.oldVersion,c.newVersion,cc(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const Ume=["get","getKey","getAll","getAllKeys","count"],Bme=["put","add","delete","clear"],DS=new Map;function wM(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(DS.get(e))return DS.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Bme.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Ume.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return DS.set(e,i),i}Fme(t=>({...t,get:(e,n,r)=>wM(e,n)||t.get(e,n,r),has:(e,n)=>!!wM(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zme{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Gme(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Gme(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const dT="@firebase/app",bM="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const il=new iP("@firebase/app"),Wme="@firebase/app-compat",Hme="@firebase/analytics-compat",qme="@firebase/analytics",Kme="@firebase/app-check-compat",Yme="@firebase/app-check",Jme="@firebase/auth",Qme="@firebase/auth-compat",Xme="@firebase/database",Zme="@firebase/data-connect",epe="@firebase/database-compat",tpe="@firebase/functions",npe="@firebase/functions-compat",rpe="@firebase/installations",spe="@firebase/installations-compat",ipe="@firebase/messaging",ope="@firebase/messaging-compat",ape="@firebase/performance",lpe="@firebase/performance-compat",cpe="@firebase/remote-config",upe="@firebase/remote-config-compat",dpe="@firebase/storage",hpe="@firebase/storage-compat",fpe="@firebase/firestore",mpe="@firebase/ai",ppe="@firebase/firestore-compat",gpe="firebase",ype="11.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT="[DEFAULT]",xpe={[dT]:"fire-core",[Wme]:"fire-core-compat",[qme]:"fire-analytics",[Hme]:"fire-analytics-compat",[Yme]:"fire-app-check",[Kme]:"fire-app-check-compat",[Jme]:"fire-auth",[Qme]:"fire-auth-compat",[Xme]:"fire-rtdb",[Zme]:"fire-data-connect",[epe]:"fire-rtdb-compat",[tpe]:"fire-fn",[npe]:"fire-fn-compat",[rpe]:"fire-iid",[spe]:"fire-iid-compat",[ipe]:"fire-fcm",[ope]:"fire-fcm-compat",[ape]:"fire-perf",[lpe]:"fire-perf-compat",[cpe]:"fire-rc",[upe]:"fire-rc-compat",[dpe]:"fire-gcs",[hpe]:"fire-gcs-compat",[fpe]:"fire-fst",[ppe]:"fire-fst-compat",[mpe]:"fire-vertex","fire-js":"fire-js",[gpe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bw=new Map,vpe=new Map,fT=new Map;function _M(t,e){try{t.container.addComponent(e)}catch(n){il.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Cc(t){const e=t.name;if(fT.has(e))return il.debug(`There were multiple attempts to register component ${e}.`),!1;fT.set(e,t);for(const n of bw.values())_M(n,t);for(const n of vpe.values())_M(n,t);return!0}function Gg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function qs(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wpe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},uc=new Bg("app","Firebase",wpe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bpe{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new sl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw uc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hd=ype;function mz(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:hT,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw uc.create("bad-app-name",{appName:String(s)});if(n||(n=iz()),!n)throw uc.create("no-options");const i=bw.get(s);if(i){if(Ku(n,i.options)&&Ku(r,i.config))return i;throw uc.create("duplicate-app",{appName:s})}const o=new Ime(s);for(const c of fT.values())o.addComponent(c);const l=new bpe(n,r,o);return bw.set(s,l),l}function vb(t=hT){const e=bw.get(t);if(!e&&t===hT&&iz())return mz();if(!e)throw uc.create("no-app",{appName:t});return e}function uo(t,e,n){var r;let s=(r=xpe[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),il.warn(l.join(" "));return}Cc(new sl(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _pe="firebase-heartbeat-database",Spe=1,Wp="firebase-heartbeat-store";let MS=null;function pz(){return MS||(MS=Vme(_pe,Spe,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Wp)}catch(n){console.warn(n)}}}}).catch(t=>{throw uc.create("idb-open",{originalErrorMessage:t.message})})),MS}async function Cpe(t){try{const n=(await pz()).transaction(Wp),r=await n.objectStore(Wp).get(gz(t));return await n.done,r}catch(e){if(e instanceof Go)il.warn(e.message);else{const n=uc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});il.warn(n.message)}}}async function SM(t,e){try{const r=(await pz()).transaction(Wp,"readwrite");await r.objectStore(Wp).put(e,gz(t)),await r.done}catch(n){if(n instanceof Go)il.warn(n.message);else{const r=uc.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});il.warn(r.message)}}}function gz(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Epe=1024,Tpe=30;class Ipe{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Ppe(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=CM();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>Tpe){const o=Ape(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){il.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=CM(),{heartbeatsToSend:r,unsentEntries:s}=Npe(this._heartbeatsCache.heartbeats),i=ww(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return il.warn(n),""}}}function CM(){return new Date().toISOString().substring(0,10)}function Npe(t,e=Epe){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),EM(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),EM(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Ppe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return dz()?gme().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Cpe(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return SM(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return SM(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function EM(t){return ww(JSON.stringify({version:2,heartbeats:t})).length}function Ape(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kpe(t){Cc(new sl("platform-logger",e=>new zme(e),"PRIVATE")),Cc(new sl("heartbeat",e=>new Ipe(e),"PRIVATE")),uo(dT,bM,t),uo(dT,bM,"esm2017"),uo("fire-js","")}kpe("");var jpe="firebase",Rpe="11.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */uo(jpe,Rpe,"app");function yz(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Dpe=yz,xz=new Bg("auth","Firebase",yz());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _w=new iP("@firebase/auth");function Mpe(t,...e){_w.logLevel<=dn.WARN&&_w.warn(`Auth (${hd}): ${t}`,...e)}function nv(t,...e){_w.logLevel<=dn.ERROR&&_w.error(`Auth (${hd}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function go(t,...e){throw lP(t,...e)}function Fo(t,...e){return lP(t,...e)}function aP(t,e,n){const r=Object.assign(Object.assign({},Dpe()),{[e]:n});return new Bg("auth","Firebase",r).create(e,{appName:t.name})}function Ja(t){return aP(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Lpe(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&go(t,"argument-error"),aP(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function lP(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return xz.create(t,...e)}function Gt(t,e,...n){if(!t)throw lP(e,...n)}function za(t){const e="INTERNAL ASSERTION FAILED: "+t;throw nv(e),new Error(e)}function ol(t,e){t||za(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mT(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Fpe(){return TM()==="http:"||TM()==="https:"}function TM(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ope(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Fpe()||fme()||"connection"in navigator)?navigator.onLine:!0}function $pe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e,n){this.shortDelay=e,this.longDelay=n,ol(n>e,"Short delay should be less than long delay!"),this.isMobile=dme()||mme()}get(){return Ope()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cP(t,e){ol(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vz{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;za("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;za("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;za("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vpe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Upe=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Bpe=new Wg(3e4,6e4);function zc(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Gc(t,e,n,r,s={}){return wz(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=zg(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return hme()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Bc(t.emulatorConfig.host)&&(u.credentials="include"),vz.fetch()(await bz(t,t.config.apiHost,n,l),u)})}async function wz(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Vpe),e);try{const s=new Gpe(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw ax(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw ax(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw ax(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw ax(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw aP(t,d,u);go(t,d)}}catch(s){if(s instanceof Go)throw s;go(t,"network-request-failed",{message:String(s)})}}async function Hg(t,e,n,r,s={}){const i=await Gc(t,e,n,r,s);return"mfaPendingCredential"in i&&go(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function bz(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?cP(t.config,s):`${t.config.apiScheme}://${s}`;return Upe.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function zpe(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Gpe{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Fo(this.auth,"network-request-failed")),Bpe.get())})}}function ax(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Fo(t,e,r);return s.customData._tokenResponse=n,s}function IM(t){return t!==void 0&&t.enterprise!==void 0}class Wpe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return zpe(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Hpe(t,e){return Gc(t,"GET","/v2/recaptchaConfig",zc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qpe(t,e){return Gc(t,"POST","/v1/accounts:delete",e)}async function Sw(t,e){return Gc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function np(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Kpe(t,e=!1){const n=qn(t),r=await n.getIdToken(e),s=uP(r);Gt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:np(LS(s.auth_time)),issuedAtTime:np(LS(s.iat)),expirationTime:np(LS(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function LS(t){return Number(t)*1e3}function uP(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return nv("JWT malformed, contained fewer than 3 sections"),null;try{const s=nz(n);return s?JSON.parse(s):(nv("Failed to decode base64 JWT payload"),null)}catch(s){return nv("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function NM(t){const e=uP(t);return Gt(e,"internal-error"),Gt(typeof e.exp<"u","internal-error"),Gt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hp(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Go&&Ype(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Ype({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jpe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=np(this.lastLoginAt),this.creationTime=np(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cw(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Hp(t,Sw(n,{idToken:r}));Gt(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?_z(i.providerUserInfo):[],l=Xpe(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new pT(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function Qpe(t){const e=qn(t);await Cw(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Xpe(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function _z(t){return t.map(e=>{var{providerId:n}=e,r=bf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zpe(t,e){const n=await wz(t,{},async()=>{const r=zg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await bz(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",vz.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function ege(t,e){return Gc(t,"POST","/v2/accounts:revokeToken",zc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Gt(e.idToken,"internal-error"),Gt(typeof e.idToken<"u","internal-error"),Gt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):NM(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Gt(e.length!==0,"internal-error");const n=NM(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Gt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await Zpe(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Nh;return r&&(Gt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(Gt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(Gt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Nh,this.toJSON())}_performRefresh(){return za("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tl(t,e){Gt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class jo{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=bf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Jpe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new pT(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Hp(this,this.stsTokenManager.getToken(this.auth,e));return Gt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Kpe(this,e)}reload(){return Qpe(this)}_assign(e){this!==e&&(Gt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new jo(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Gt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Cw(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(qs(this.auth.app))return Promise.reject(Ja(this.auth));const e=await this.getIdToken();return await Hp(this,qpe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,u,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(s=n.email)!==null&&s!==void 0?s:void 0,m=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,g=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(l=n.tenantId)!==null&&l!==void 0?l:void 0,v=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,w=(u=n.createdAt)!==null&&u!==void 0?u:void 0,_=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:C,emailVerified:T,isAnonymous:j,providerData:A,stsTokenManager:E}=n;Gt(C&&E,e,"internal-error");const I=Nh.fromJSON(this.name,E);Gt(typeof C=="string",e,"internal-error"),Tl(h,e.name),Tl(f,e.name),Gt(typeof T=="boolean",e,"internal-error"),Gt(typeof j=="boolean",e,"internal-error"),Tl(m,e.name),Tl(g,e.name),Tl(x,e.name),Tl(v,e.name),Tl(w,e.name),Tl(_,e.name);const N=new jo({uid:C,auth:e,email:f,emailVerified:T,displayName:h,isAnonymous:j,photoURL:g,phoneNumber:m,tenantId:x,stsTokenManager:I,createdAt:w,lastLoginAt:_});return A&&Array.isArray(A)&&(N.providerData=A.map(k=>Object.assign({},k))),v&&(N._redirectEventId=v),N}static async _fromIdTokenResponse(e,n,r=!1){const s=new Nh;s.updateFromServerResponse(n);const i=new jo({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Cw(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Gt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?_z(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Nh;l.updateFromIdToken(r);const c=new jo({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new pT(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PM=new Map;function Ga(t){ol(t instanceof Function,"Expected a class definition");let e=PM.get(t);return e?(ol(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,PM.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sz{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Sz.type="NONE";const AM=Sz;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rv(t,e,n){return`firebase:${t}:${e}:${n}`}class Ph{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=rv(this.userKey,s.apiKey,i),this.fullPersistenceKey=rv("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Sw(this.auth,{idToken:e}).catch(()=>{});return n?jo._fromGetAccountInfoResponse(this.auth,n,e):null}return jo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ph(Ga(AM),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Ga(AM);const o=rv(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){let h;if(typeof d=="string"){const f=await Sw(e,{idToken:d}).catch(()=>{});if(!f)break;h=await jo._fromGetAccountInfoResponse(e,f,d)}else h=jo._fromJSON(e,d);u!==i&&(l=h),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Ph(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new Ph(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kM(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Iz(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Cz(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Pz(e))return"Blackberry";if(Az(e))return"Webos";if(Ez(e))return"Safari";if((e.includes("chrome/")||Tz(e))&&!e.includes("edge/"))return"Chrome";if(Nz(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Cz(t=Jr()){return/firefox\//i.test(t)}function Ez(t=Jr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Tz(t=Jr()){return/crios\//i.test(t)}function Iz(t=Jr()){return/iemobile/i.test(t)}function Nz(t=Jr()){return/android/i.test(t)}function Pz(t=Jr()){return/blackberry/i.test(t)}function Az(t=Jr()){return/webos/i.test(t)}function dP(t=Jr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function tge(t=Jr()){var e;return dP(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function nge(){return pme()&&document.documentMode===10}function kz(t=Jr()){return dP(t)||Nz(t)||Az(t)||Pz(t)||/windows phone/i.test(t)||Iz(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jz(t,e=[]){let n;switch(t){case"Browser":n=kM(Jr());break;case"Worker":n=`${kM(Jr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${hd}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rge{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sge(t,e={}){return Gc(t,"GET","/v2/passwordPolicy",zc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ige=6;class oge{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:ige,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class age{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jM(this),this.idTokenSubscription=new jM(this),this.beforeStateQueue=new rge(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xz,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ga(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Ph.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Sw(this,{idToken:e}),r=await jo._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(qs(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Gt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Cw(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$pe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(qs(this.app))return Promise.reject(Ja(this));const n=e?qn(e):null;return n&&Gt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Gt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return qs(this.app)?Promise.reject(Ja(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return qs(this.app)?Promise.reject(Ja(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ga(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await sge(this),n=new oge(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Bg("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await ege(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ga(e)||this._popupRedirectResolver;Gt(n,this,"argument-error"),this.redirectPersistenceManager=await Ph.create(this,[Ga(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Gt(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Gt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jz(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if(qs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Mpe(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Wc(t){return qn(t)}class jM{constructor(e){this.auth=e,this.observer=null,this.addObserver=bme(n=>this.observer=n)}get next(){return Gt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wb={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function lge(t){wb=t}function Rz(t){return wb.loadJS(t)}function cge(){return wb.recaptchaEnterpriseScript}function uge(){return wb.gapiScript}function dge(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class hge{constructor(){this.enterprise=new fge}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class fge{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const mge="recaptcha-enterprise",Dz="NO_RECAPTCHA";class pge{constructor(e){this.type=mge,this.auth=Wc(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{Hpe(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new Wpe(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;IM(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(Dz)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new hge().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&IM(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=cge();c.length!==0&&(c+=l),Rz(c).then(()=>{s(l,i,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function tm(t,e,n,r=!1,s=!1){const i=new pge(t);let o;if(s)o=Dz;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const l=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function gT(t,e,n,r,s){var i,o;if(s==="EMAIL_PASSWORD_PROVIDER")if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await tm(t,e,n,n==="getOobCode");return r(t,l)}else return r(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await tm(t,e,n,n==="getOobCode");return r(t,c)}else return Promise.reject(l)});else if(s==="PHONE_PROVIDER")if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){const l=await tm(t,e,n);return r(t,l).catch(async c=>{var u;if(((u=t._getRecaptchaConfig())===null||u===void 0?void 0:u.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const d=await tm(t,e,n,!1,!0);return r(t,d)}return Promise.reject(c)})}else{const l=await tm(t,e,n,!1,!0);return r(t,l)}else return Promise.reject(s+" provider is not supported.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gge(t,e){const n=Gg(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Ku(i,e??{}))return s;go(s,"already-initialized")}return n.initialize({options:e})}function yge(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ga);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function xge(t,e,n){const r=Wc(t);Gt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=Mz(e),{host:o,port:l}=vge(e),c=l===null?"":`:${l}`,u={url:`${i}//${o}${c}/`},d=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Gt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Gt(Ku(u,r.config.emulator)&&Ku(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Bc(o)?(yb(`${i}//${o}${c}`),xb("Auth",!0)):s||wge()}function Mz(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function vge(t){const e=Mz(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:RM(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:RM(o)}}}function RM(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function wge(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return za("not implemented")}_getIdTokenResponse(e){return za("not implemented")}_linkToIdToken(e,n){return za("not implemented")}_getReauthenticationResolver(e){return za("not implemented")}}async function bge(t,e){return Gc(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _ge(t,e){return Hg(t,"POST","/v1/accounts:signInWithPassword",zc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sge(t,e){return Hg(t,"POST","/v1/accounts:signInWithEmailLink",zc(t,e))}async function Cge(t,e){return Hg(t,"POST","/v1/accounts:signInWithEmailLink",zc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp extends hP{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new qp(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new qp(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gT(e,n,"signInWithPassword",_ge,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Sge(e,{email:this._email,oobCode:this._password});default:go(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gT(e,r,"signUpPassword",bge,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Cge(e,{idToken:n,email:this._email,oobCode:this._password});default:go(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ah(t,e){return Hg(t,"POST","/v1/accounts:signInWithIdp",zc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ege="http://localhost";class Yu extends hP{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Yu(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):go("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=bf(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Yu(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ah(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ah(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ah(e,n)}buildRequest(){const e={requestUri:Ege,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=zg(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tge(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Ige(t){const e=Tm(Im(t)).link,n=e?Tm(Im(e)).deep_link_id:null,r=Tm(Im(t)).deep_link_id;return(r?Tm(Im(r)).link:null)||r||n||e||t}class fP{constructor(e){var n,r,s,i,o,l;const c=Tm(Im(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=Tge((s=c.mode)!==null&&s!==void 0?s:null);Gt(u&&d&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=d,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.lang)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=Ige(e);try{return new fP(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(){this.providerId=Ef.PROVIDER_ID}static credential(e,n){return qp._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=fP.parseLink(n);return Gt(r,"argument-error"),qp._fromEmailAndCode(e,r.code,r.tenantId)}}Ef.PROVIDER_ID="password";Ef.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ef.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg extends mP{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul extends qg{constructor(){super("facebook.com")}static credential(e){return Yu._fromParams({providerId:Ul.PROVIDER_ID,signInMethod:Ul.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ul.credentialFromTaggedObject(e)}static credentialFromError(e){return Ul.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ul.credential(e.oauthAccessToken)}catch{return null}}}Ul.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ul.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa extends qg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Yu._fromParams({providerId:Oa.PROVIDER_ID,signInMethod:Oa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Oa.credentialFromTaggedObject(e)}static credentialFromError(e){return Oa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Oa.credential(n,r)}catch{return null}}}Oa.GOOGLE_SIGN_IN_METHOD="google.com";Oa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl extends qg{constructor(){super("github.com")}static credential(e){return Yu._fromParams({providerId:Bl.PROVIDER_ID,signInMethod:Bl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bl.credentialFromTaggedObject(e)}static credentialFromError(e){return Bl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bl.credential(e.oauthAccessToken)}catch{return null}}}Bl.GITHUB_SIGN_IN_METHOD="github.com";Bl.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl extends qg{constructor(){super("twitter.com")}static credential(e,n){return Yu._fromParams({providerId:zl.PROVIDER_ID,signInMethod:zl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return zl.credentialFromTaggedObject(e)}static credentialFromError(e){return zl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return zl.credential(n,r)}catch{return null}}}zl.TWITTER_SIGN_IN_METHOD="twitter.com";zl.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nge(t,e){return Hg(t,"POST","/v1/accounts:signUp",zc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await jo._fromIdTokenResponse(e,r,s),o=DM(r);return new Ju({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=DM(r);return new Ju({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function DM(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew extends Go{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Ew.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Ew(e,n,r,s)}}function Lz(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Ew._fromErrorAndOperation(t,i,e,r):i})}async function Pge(t,e,n=!1){const r=await Hp(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ju._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Age(t,e,n=!1){const{auth:r}=t;if(qs(r.app))return Promise.reject(Ja(r));const s="reauthenticate";try{const i=await Hp(t,Lz(r,s,e,t),n);Gt(i.idToken,r,"internal-error");const o=uP(i.idToken);Gt(o,r,"internal-error");const{sub:l}=o;return Gt(t.uid===l,r,"user-mismatch"),Ju._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&go(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fz(t,e,n=!1){if(qs(t.app))return Promise.reject(Ja(t));const r="signIn",s=await Lz(t,r,e),i=await Ju._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function kge(t,e){return Fz(Wc(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oz(t){const e=Wc(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function jge(t,e,n){if(qs(t.app))return Promise.reject(Ja(t));const r=Wc(t),o=await gT(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Nge,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Oz(t),c}),l=await Ju._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function Rge(t,e,n){return qs(t.app)?Promise.reject(Ja(t)):kge(qn(t),Ef.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Oz(t),r})}function Dge(t,e,n,r){return qn(t).onIdTokenChanged(e,n,r)}function Mge(t,e,n){return qn(t).beforeAuthStateChanged(e,n)}function Lge(t,e,n,r){return qn(t).onAuthStateChanged(e,n,r)}function Fge(t){return qn(t).signOut()}const Tw="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $z{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Tw,"1"),this.storage.removeItem(Tw),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oge=1e3,$ge=10;class Vz extends $z{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kz(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);nge()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,$ge):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Oge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Vz.type="LOCAL";const Vge=Vz;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uz extends $z{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Uz.type="SESSION";const Bz=Uz;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uge(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new bb(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await Uge(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}bb.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pP(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bge{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=pP("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(f.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pa(){return window}function zge(t){pa().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zz(){return typeof pa().WorkerGlobalScope<"u"&&typeof pa().importScripts=="function"}async function Gge(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Wge(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Hge(){return zz()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gz="firebaseLocalStorageDb",qge=1,Iw="firebaseLocalStorage",Wz="fbase_key";class Kg{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function _b(t,e){return t.transaction([Iw],e?"readwrite":"readonly").objectStore(Iw)}function Kge(){const t=indexedDB.deleteDatabase(Gz);return new Kg(t).toPromise()}function yT(){const t=indexedDB.open(Gz,qge);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Iw,{keyPath:Wz})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Iw)?e(r):(r.close(),await Kge(),e(await yT()))})})}async function MM(t,e,n){const r=_b(t,!0).put({[Wz]:e,value:n});return new Kg(r).toPromise()}async function Yge(t,e){const n=_b(t,!1).get(e),r=await new Kg(n).toPromise();return r===void 0?null:r.value}function LM(t,e){const n=_b(t,!0).delete(e);return new Kg(n).toPromise()}const Jge=800,Qge=3;class Hz{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await yT(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Qge)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zz()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=bb._getInstance(Hge()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Gge(),!this.activeServiceWorker)return;this.sender=new Bge(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Wge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await yT();return await MM(e,Tw,"1"),await LM(e,Tw),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>MM(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Yge(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>LM(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=_b(s,!1).getAll();return new Kg(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Jge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Hz.type="LOCAL";const Xge=Hz;new Wg(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qz(t,e){return e?Ga(e):(Gt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP extends hP{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ah(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ah(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ah(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Zge(t){return Fz(t.auth,new gP(t),t.bypassAuthState)}function eye(t){const{auth:e,user:n}=t;return Gt(n,e,"internal-error"),Age(n,new gP(t),t.bypassAuthState)}async function tye(t){const{auth:e,user:n}=t;return Gt(n,e,"internal-error"),Pge(n,new gP(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kz{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Zge;case"linkViaPopup":case"linkViaRedirect":return tye;case"reauthViaPopup":case"reauthViaRedirect":return eye;default:go(this.auth,"internal-error")}}resolve(e){ol(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ol(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nye=new Wg(2e3,1e4);async function rye(t,e,n){if(qs(t.app))return Promise.reject(Fo(t,"operation-not-supported-in-this-environment"));const r=Wc(t);Lpe(t,e,mP);const s=qz(r,n);return new Nu(r,"signInViaPopup",e,s).executeNotNull()}class Nu extends Kz{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Nu.currentPopupAction&&Nu.currentPopupAction.cancel(),Nu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Gt(e,this.auth,"internal-error"),e}async onExecution(){ol(this.filter.length===1,"Popup operations only handle one event");const e=pP();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Fo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Fo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Nu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,nye.get())};e()}}Nu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sye="pendingRedirect",sv=new Map;class iye extends Kz{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=sv.get(this.auth._key());if(!e){try{const r=await oye(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}sv.set(this.auth._key(),e)}return this.bypassAuthState||sv.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function oye(t,e){const n=cye(e),r=lye(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function aye(t,e){sv.set(t._key(),e)}function lye(t){return Ga(t._redirectPersistence)}function cye(t){return rv(sye,t.config.apiKey,t.name)}async function uye(t,e,n=!1){if(qs(t.app))return Promise.reject(Ja(t));const r=Wc(t),s=qz(r,e),o=await new iye(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dye=10*60*1e3;class hye{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!fye(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Yz(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Fo(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=dye&&this.cachedEventUids.clear(),this.cachedEventUids.has(FM(e))}saveEventToCache(e){this.cachedEventUids.add(FM(e)),this.lastProcessedEventTime=Date.now()}}function FM(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Yz({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function fye(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Yz(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mye(t,e={}){return Gc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pye=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,gye=/^https?/;async function yye(t){if(t.config.emulator)return;const{authorizedDomains:e}=await mye(t);for(const n of e)try{if(xye(n))return}catch{}go(t,"unauthorized-domain")}function xye(t){const e=mT(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!gye.test(n))return!1;if(pye.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vye=new Wg(3e4,6e4);function OM(){const t=pa().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function wye(t){return new Promise((e,n)=>{var r,s,i;function o(){OM(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{OM(),n(Fo(t,"network-request-failed"))},timeout:vye.get()})}if(!((s=(r=pa().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=pa().gapi)===null||i===void 0)&&i.load)o();else{const l=dge("iframefcb");return pa()[l]=()=>{gapi.load?o():n(Fo(t,"network-request-failed"))},Rz(`${uge()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw iv=null,e})}let iv=null;function bye(t){return iv=iv||wye(t),iv}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _ye=new Wg(5e3,15e3),Sye="__/auth/iframe",Cye="emulator/auth/iframe",Eye={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Tye=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Iye(t){const e=t.config;Gt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?cP(e,Cye):`https://${t.config.authDomain}/${Sye}`,r={apiKey:e.apiKey,appName:t.name,v:hd},s=Tye.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${zg(r).slice(1)}`}async function Nye(t){const e=await bye(t),n=pa().gapi;return Gt(n,t,"internal-error"),e.open({where:document.body,url:Iye(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Eye,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Fo(t,"network-request-failed"),l=pa().setTimeout(()=>{i(o)},_ye.get());function c(){pa().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pye={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Aye=500,kye=600,jye="_blank",Rye="http://localhost";class $M{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Dye(t,e,n,r=Aye,s=kye){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},Pye),{width:r.toString(),height:s.toString(),top:i,left:o}),u=Jr().toLowerCase();n&&(l=Tz(u)?jye:n),Cz(u)&&(e=e||Rye,c.scrollbars="yes");const d=Object.entries(c).reduce((f,[m,g])=>`${f}${m}=${g},`,"");if(tge(u)&&l!=="_self")return Mye(e||"",l),new $M(null);const h=window.open(e||"",l,d);Gt(h,t,"popup-blocked");try{h.focus()}catch{}return new $M(h)}function Mye(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lye="__/auth/handler",Fye="emulator/auth/handler",Oye=encodeURIComponent("fac");async function VM(t,e,n,r,s,i){Gt(t.config.authDomain,t,"auth-domain-config-required"),Gt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:hd,eventId:s};if(e instanceof mP){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",wme(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries(i||{}))o[d]=h}if(e instanceof qg){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${Oye}=${encodeURIComponent(c)}`:"";return`${$ye(t)}?${zg(l).slice(1)}${u}`}function $ye({config:t}){return t.emulator?cP(t,Fye):`https://${t.authDomain}/${Lye}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS="webStorageSupport";class Vye{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Bz,this._completeRedirectFn=uye,this._overrideRedirectResult=aye}async _openPopup(e,n,r,s){var i;ol((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await VM(e,n,r,mT(),s);return Dye(e,o,pP())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await VM(e,n,r,mT(),s);return zge(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(ol(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Nye(e),r=new hye(e);return n.register("authEvent",s=>(Gt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(FS,{type:FS},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[FS];o!==void 0&&n(!!o),go(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=yye(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return kz()||Ez()||dP()}}const Uye=Vye;var UM="@firebase/auth",BM="1.10.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bye{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Gt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zye(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Gye(t){Cc(new sl("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;Gt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jz(t)},u=new age(r,s,i,c);return yge(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Cc(new sl("auth-internal",e=>{const n=Wc(e.getProvider("auth").getImmediate());return(r=>new Bye(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),uo(UM,BM,zye(t)),uo(UM,BM,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wye=5*60,Hye=oz("authIdTokenMaxAge")||Wye;let zM=null;const qye=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Hye)return;const s=n==null?void 0:n.token;zM!==s&&(zM=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Kye(t=vb()){const e=Gg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=gge(t,{popupRedirectResolver:Uye,persistence:[Xge,Vge,Bz]}),r=oz("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=qye(i.toString());Mge(n,o,()=>o(n.currentUser)),Dge(n,l=>o(l))}}const s=sz("auth");return s&&xge(n,`http://${s}`),n}function Yye(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}lge({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Fo("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Yye().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Gye("Browser");var GM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dc,Jz;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,I){function N(){}N.prototype=I.prototype,E.D=I.prototype,E.prototype=new N,E.prototype.constructor=E,E.C=function(k,R,D){for(var M=Array(arguments.length-2),z=2;z<arguments.length;z++)M[z-2]=arguments[z];return I.prototype[R].apply(k,M)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,I,N){N||(N=0);var k=Array(16);if(typeof I=="string")for(var R=0;16>R;++R)k[R]=I.charCodeAt(N++)|I.charCodeAt(N++)<<8|I.charCodeAt(N++)<<16|I.charCodeAt(N++)<<24;else for(R=0;16>R;++R)k[R]=I[N++]|I[N++]<<8|I[N++]<<16|I[N++]<<24;I=E.g[0],N=E.g[1],R=E.g[2];var D=E.g[3],M=I+(D^N&(R^D))+k[0]+3614090360&4294967295;I=N+(M<<7&4294967295|M>>>25),M=D+(R^I&(N^R))+k[1]+3905402710&4294967295,D=I+(M<<12&4294967295|M>>>20),M=R+(N^D&(I^N))+k[2]+606105819&4294967295,R=D+(M<<17&4294967295|M>>>15),M=N+(I^R&(D^I))+k[3]+3250441966&4294967295,N=R+(M<<22&4294967295|M>>>10),M=I+(D^N&(R^D))+k[4]+4118548399&4294967295,I=N+(M<<7&4294967295|M>>>25),M=D+(R^I&(N^R))+k[5]+1200080426&4294967295,D=I+(M<<12&4294967295|M>>>20),M=R+(N^D&(I^N))+k[6]+2821735955&4294967295,R=D+(M<<17&4294967295|M>>>15),M=N+(I^R&(D^I))+k[7]+4249261313&4294967295,N=R+(M<<22&4294967295|M>>>10),M=I+(D^N&(R^D))+k[8]+1770035416&4294967295,I=N+(M<<7&4294967295|M>>>25),M=D+(R^I&(N^R))+k[9]+2336552879&4294967295,D=I+(M<<12&4294967295|M>>>20),M=R+(N^D&(I^N))+k[10]+4294925233&4294967295,R=D+(M<<17&4294967295|M>>>15),M=N+(I^R&(D^I))+k[11]+2304563134&4294967295,N=R+(M<<22&4294967295|M>>>10),M=I+(D^N&(R^D))+k[12]+1804603682&4294967295,I=N+(M<<7&4294967295|M>>>25),M=D+(R^I&(N^R))+k[13]+4254626195&4294967295,D=I+(M<<12&4294967295|M>>>20),M=R+(N^D&(I^N))+k[14]+2792965006&4294967295,R=D+(M<<17&4294967295|M>>>15),M=N+(I^R&(D^I))+k[15]+1236535329&4294967295,N=R+(M<<22&4294967295|M>>>10),M=I+(R^D&(N^R))+k[1]+4129170786&4294967295,I=N+(M<<5&4294967295|M>>>27),M=D+(N^R&(I^N))+k[6]+3225465664&4294967295,D=I+(M<<9&4294967295|M>>>23),M=R+(I^N&(D^I))+k[11]+643717713&4294967295,R=D+(M<<14&4294967295|M>>>18),M=N+(D^I&(R^D))+k[0]+3921069994&4294967295,N=R+(M<<20&4294967295|M>>>12),M=I+(R^D&(N^R))+k[5]+3593408605&4294967295,I=N+(M<<5&4294967295|M>>>27),M=D+(N^R&(I^N))+k[10]+38016083&4294967295,D=I+(M<<9&4294967295|M>>>23),M=R+(I^N&(D^I))+k[15]+3634488961&4294967295,R=D+(M<<14&4294967295|M>>>18),M=N+(D^I&(R^D))+k[4]+3889429448&4294967295,N=R+(M<<20&4294967295|M>>>12),M=I+(R^D&(N^R))+k[9]+568446438&4294967295,I=N+(M<<5&4294967295|M>>>27),M=D+(N^R&(I^N))+k[14]+3275163606&4294967295,D=I+(M<<9&4294967295|M>>>23),M=R+(I^N&(D^I))+k[3]+4107603335&4294967295,R=D+(M<<14&4294967295|M>>>18),M=N+(D^I&(R^D))+k[8]+1163531501&4294967295,N=R+(M<<20&4294967295|M>>>12),M=I+(R^D&(N^R))+k[13]+2850285829&4294967295,I=N+(M<<5&4294967295|M>>>27),M=D+(N^R&(I^N))+k[2]+4243563512&4294967295,D=I+(M<<9&4294967295|M>>>23),M=R+(I^N&(D^I))+k[7]+1735328473&4294967295,R=D+(M<<14&4294967295|M>>>18),M=N+(D^I&(R^D))+k[12]+2368359562&4294967295,N=R+(M<<20&4294967295|M>>>12),M=I+(N^R^D)+k[5]+4294588738&4294967295,I=N+(M<<4&4294967295|M>>>28),M=D+(I^N^R)+k[8]+2272392833&4294967295,D=I+(M<<11&4294967295|M>>>21),M=R+(D^I^N)+k[11]+1839030562&4294967295,R=D+(M<<16&4294967295|M>>>16),M=N+(R^D^I)+k[14]+4259657740&4294967295,N=R+(M<<23&4294967295|M>>>9),M=I+(N^R^D)+k[1]+2763975236&4294967295,I=N+(M<<4&4294967295|M>>>28),M=D+(I^N^R)+k[4]+1272893353&4294967295,D=I+(M<<11&4294967295|M>>>21),M=R+(D^I^N)+k[7]+4139469664&4294967295,R=D+(M<<16&4294967295|M>>>16),M=N+(R^D^I)+k[10]+3200236656&4294967295,N=R+(M<<23&4294967295|M>>>9),M=I+(N^R^D)+k[13]+681279174&4294967295,I=N+(M<<4&4294967295|M>>>28),M=D+(I^N^R)+k[0]+3936430074&4294967295,D=I+(M<<11&4294967295|M>>>21),M=R+(D^I^N)+k[3]+3572445317&4294967295,R=D+(M<<16&4294967295|M>>>16),M=N+(R^D^I)+k[6]+76029189&4294967295,N=R+(M<<23&4294967295|M>>>9),M=I+(N^R^D)+k[9]+3654602809&4294967295,I=N+(M<<4&4294967295|M>>>28),M=D+(I^N^R)+k[12]+3873151461&4294967295,D=I+(M<<11&4294967295|M>>>21),M=R+(D^I^N)+k[15]+530742520&4294967295,R=D+(M<<16&4294967295|M>>>16),M=N+(R^D^I)+k[2]+3299628645&4294967295,N=R+(M<<23&4294967295|M>>>9),M=I+(R^(N|~D))+k[0]+4096336452&4294967295,I=N+(M<<6&4294967295|M>>>26),M=D+(N^(I|~R))+k[7]+1126891415&4294967295,D=I+(M<<10&4294967295|M>>>22),M=R+(I^(D|~N))+k[14]+2878612391&4294967295,R=D+(M<<15&4294967295|M>>>17),M=N+(D^(R|~I))+k[5]+4237533241&4294967295,N=R+(M<<21&4294967295|M>>>11),M=I+(R^(N|~D))+k[12]+1700485571&4294967295,I=N+(M<<6&4294967295|M>>>26),M=D+(N^(I|~R))+k[3]+2399980690&4294967295,D=I+(M<<10&4294967295|M>>>22),M=R+(I^(D|~N))+k[10]+4293915773&4294967295,R=D+(M<<15&4294967295|M>>>17),M=N+(D^(R|~I))+k[1]+2240044497&4294967295,N=R+(M<<21&4294967295|M>>>11),M=I+(R^(N|~D))+k[8]+1873313359&4294967295,I=N+(M<<6&4294967295|M>>>26),M=D+(N^(I|~R))+k[15]+4264355552&4294967295,D=I+(M<<10&4294967295|M>>>22),M=R+(I^(D|~N))+k[6]+2734768916&4294967295,R=D+(M<<15&4294967295|M>>>17),M=N+(D^(R|~I))+k[13]+1309151649&4294967295,N=R+(M<<21&4294967295|M>>>11),M=I+(R^(N|~D))+k[4]+4149444226&4294967295,I=N+(M<<6&4294967295|M>>>26),M=D+(N^(I|~R))+k[11]+3174756917&4294967295,D=I+(M<<10&4294967295|M>>>22),M=R+(I^(D|~N))+k[2]+718787259&4294967295,R=D+(M<<15&4294967295|M>>>17),M=N+(D^(R|~I))+k[9]+3951481745&4294967295,E.g[0]=E.g[0]+I&4294967295,E.g[1]=E.g[1]+(R+(M<<21&4294967295|M>>>11))&4294967295,E.g[2]=E.g[2]+R&4294967295,E.g[3]=E.g[3]+D&4294967295}r.prototype.u=function(E,I){I===void 0&&(I=E.length);for(var N=I-this.blockSize,k=this.B,R=this.h,D=0;D<I;){if(R==0)for(;D<=N;)s(this,E,D),D+=this.blockSize;if(typeof E=="string"){for(;D<I;)if(k[R++]=E.charCodeAt(D++),R==this.blockSize){s(this,k),R=0;break}}else for(;D<I;)if(k[R++]=E[D++],R==this.blockSize){s(this,k),R=0;break}}this.h=R,this.o+=I},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var I=1;I<E.length-8;++I)E[I]=0;var N=8*this.o;for(I=E.length-8;I<E.length;++I)E[I]=N&255,N/=256;for(this.u(E),E=Array(16),I=N=0;4>I;++I)for(var k=0;32>k;k+=8)E[N++]=this.g[I]>>>k&255;return E};function i(E,I){var N=l;return Object.prototype.hasOwnProperty.call(N,E)?N[E]:N[E]=I(E)}function o(E,I){this.h=I;for(var N=[],k=!0,R=E.length-1;0<=R;R--){var D=E[R]|0;k&&D==I||(N[R]=D,k=!1)}this.g=N}var l={};function c(E){return-128<=E&&128>E?i(E,function(I){return new o([I|0],0>I?-1:0)}):new o([E|0],0>E?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return h;if(0>E)return v(u(-E));for(var I=[],N=1,k=0;E>=N;k++)I[k]=E/N|0,N*=4294967296;return new o(I,0)}function d(E,I){if(E.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(E.charAt(0)=="-")return v(d(E.substring(1),I));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=u(Math.pow(I,8)),k=h,R=0;R<E.length;R+=8){var D=Math.min(8,E.length-R),M=parseInt(E.substring(R,R+D),I);8>D?(D=u(Math.pow(I,D)),k=k.j(D).add(u(M))):(k=k.j(N),k=k.add(u(M)))}return k}var h=c(0),f=c(1),m=c(16777216);t=o.prototype,t.m=function(){if(x(this))return-v(this).m();for(var E=0,I=1,N=0;N<this.g.length;N++){var k=this.i(N);E+=(0<=k?k:4294967296+k)*I,I*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(g(this))return"0";if(x(this))return"-"+v(this).toString(E);for(var I=u(Math.pow(E,6)),N=this,k="";;){var R=T(N,I).g;N=w(N,R.j(I));var D=((0<N.g.length?N.g[0]:N.h)>>>0).toString(E);if(N=R,g(N))return D+k;for(;6>D.length;)D="0"+D;k=D+k}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function g(E){if(E.h!=0)return!1;for(var I=0;I<E.g.length;I++)if(E.g[I]!=0)return!1;return!0}function x(E){return E.h==-1}t.l=function(E){return E=w(this,E),x(E)?-1:g(E)?0:1};function v(E){for(var I=E.g.length,N=[],k=0;k<I;k++)N[k]=~E.g[k];return new o(N,~E.h).add(f)}t.abs=function(){return x(this)?v(this):this},t.add=function(E){for(var I=Math.max(this.g.length,E.g.length),N=[],k=0,R=0;R<=I;R++){var D=k+(this.i(R)&65535)+(E.i(R)&65535),M=(D>>>16)+(this.i(R)>>>16)+(E.i(R)>>>16);k=M>>>16,D&=65535,M&=65535,N[R]=M<<16|D}return new o(N,N[N.length-1]&-2147483648?-1:0)};function w(E,I){return E.add(v(I))}t.j=function(E){if(g(this)||g(E))return h;if(x(this))return x(E)?v(this).j(v(E)):v(v(this).j(E));if(x(E))return v(this.j(v(E)));if(0>this.l(m)&&0>E.l(m))return u(this.m()*E.m());for(var I=this.g.length+E.g.length,N=[],k=0;k<2*I;k++)N[k]=0;for(k=0;k<this.g.length;k++)for(var R=0;R<E.g.length;R++){var D=this.i(k)>>>16,M=this.i(k)&65535,z=E.i(R)>>>16,B=E.i(R)&65535;N[2*k+2*R]+=M*B,_(N,2*k+2*R),N[2*k+2*R+1]+=D*B,_(N,2*k+2*R+1),N[2*k+2*R+1]+=M*z,_(N,2*k+2*R+1),N[2*k+2*R+2]+=D*z,_(N,2*k+2*R+2)}for(k=0;k<I;k++)N[k]=N[2*k+1]<<16|N[2*k];for(k=I;k<2*I;k++)N[k]=0;return new o(N,0)};function _(E,I){for(;(E[I]&65535)!=E[I];)E[I+1]+=E[I]>>>16,E[I]&=65535,I++}function C(E,I){this.g=E,this.h=I}function T(E,I){if(g(I))throw Error("division by zero");if(g(E))return new C(h,h);if(x(E))return I=T(v(E),I),new C(v(I.g),v(I.h));if(x(I))return I=T(E,v(I)),new C(v(I.g),I.h);if(30<E.g.length){if(x(E)||x(I))throw Error("slowDivide_ only works with positive integers.");for(var N=f,k=I;0>=k.l(E);)N=j(N),k=j(k);var R=A(N,1),D=A(k,1);for(k=A(k,2),N=A(N,2);!g(k);){var M=D.add(k);0>=M.l(E)&&(R=R.add(N),D=M),k=A(k,1),N=A(N,1)}return I=w(E,R.j(I)),new C(R,I)}for(R=h;0<=E.l(I);){for(N=Math.max(1,Math.floor(E.m()/I.m())),k=Math.ceil(Math.log(N)/Math.LN2),k=48>=k?1:Math.pow(2,k-48),D=u(N),M=D.j(I);x(M)||0<M.l(E);)N-=k,D=u(N),M=D.j(I);g(D)&&(D=f),R=R.add(D),E=w(E,M)}return new C(R,E)}t.A=function(E){return T(this,E).h},t.and=function(E){for(var I=Math.max(this.g.length,E.g.length),N=[],k=0;k<I;k++)N[k]=this.i(k)&E.i(k);return new o(N,this.h&E.h)},t.or=function(E){for(var I=Math.max(this.g.length,E.g.length),N=[],k=0;k<I;k++)N[k]=this.i(k)|E.i(k);return new o(N,this.h|E.h)},t.xor=function(E){for(var I=Math.max(this.g.length,E.g.length),N=[],k=0;k<I;k++)N[k]=this.i(k)^E.i(k);return new o(N,this.h^E.h)};function j(E){for(var I=E.g.length+1,N=[],k=0;k<I;k++)N[k]=E.i(k)<<1|E.i(k-1)>>>31;return new o(N,E.h)}function A(E,I){var N=I>>5;I%=32;for(var k=E.g.length-N,R=[],D=0;D<k;D++)R[D]=0<I?E.i(D+N)>>>I|E.i(D+N+1)<<32-I:E.i(D+N);return new o(R,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Jz=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,dc=o}).apply(typeof GM<"u"?GM:typeof self<"u"?self:typeof window<"u"?window:{});var lx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Qz,Nm,Xz,ov,xT,Zz,e8,t8;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,P,L){return y==Array.prototype||y==Object.prototype||(y[P]=L.value),y};function n(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof lx=="object"&&lx];for(var P=0;P<y.length;++P){var L=y[P];if(L&&L.Math==Math)return L}throw Error("Cannot find global object")}var r=n(this);function s(y,P){if(P)e:{var L=r;y=y.split(".");for(var U=0;U<y.length-1;U++){var fe=y[U];if(!(fe in L))break e;L=L[fe]}y=y[y.length-1],U=L[y],P=P(U),P!=U&&P!=null&&e(L,y,{configurable:!0,writable:!0,value:P})}}function i(y,P){y instanceof String&&(y+="");var L=0,U=!1,fe={next:function(){if(!U&&L<y.length){var ke=L++;return{value:P(ke,y[ke]),done:!1}}return U=!0,{done:!0,value:void 0}}};return fe[Symbol.iterator]=function(){return fe},fe}s("Array.prototype.values",function(y){return y||function(){return i(this,function(P,L){return L})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(y){var P=typeof y;return P=P!="object"?P:y?Array.isArray(y)?"array":P:"null",P=="array"||P=="object"&&typeof y.length=="number"}function u(y){var P=typeof y;return P=="object"&&y!=null||P=="function"}function d(y,P,L){return y.call.apply(y.bind,arguments)}function h(y,P,L){if(!y)throw Error();if(2<arguments.length){var U=Array.prototype.slice.call(arguments,2);return function(){var fe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(fe,U),y.apply(P,fe)}}return function(){return y.apply(P,arguments)}}function f(y,P,L){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,f.apply(null,arguments)}function m(y,P){var L=Array.prototype.slice.call(arguments,1);return function(){var U=L.slice();return U.push.apply(U,arguments),y.apply(this,U)}}function g(y,P){function L(){}L.prototype=P.prototype,y.aa=P.prototype,y.prototype=new L,y.prototype.constructor=y,y.Qb=function(U,fe,ke){for(var at=Array(arguments.length-2),Un=2;Un<arguments.length;Un++)at[Un-2]=arguments[Un];return P.prototype[fe].apply(U,at)}}function x(y){const P=y.length;if(0<P){const L=Array(P);for(let U=0;U<P;U++)L[U]=y[U];return L}return[]}function v(y,P){for(let L=1;L<arguments.length;L++){const U=arguments[L];if(c(U)){const fe=y.length||0,ke=U.length||0;y.length=fe+ke;for(let at=0;at<ke;at++)y[fe+at]=U[at]}else y.push(U)}}class w{constructor(P,L){this.i=P,this.j=L,this.h=0,this.g=null}get(){let P;return 0<this.h?(this.h--,P=this.g,this.g=P.next,P.next=null):P=this.i(),P}}function _(y){return/^[\s\xa0]*$/.test(y)}function C(){var y=l.navigator;return y&&(y=y.userAgent)?y:""}function T(y){return T[" "](y),y}T[" "]=function(){};var j=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function A(y,P,L){for(const U in y)P.call(L,y[U],U,y)}function E(y,P){for(const L in y)P.call(void 0,y[L],L,y)}function I(y){const P={};for(const L in y)P[L]=y[L];return P}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(y,P){let L,U;for(let fe=1;fe<arguments.length;fe++){U=arguments[fe];for(L in U)y[L]=U[L];for(let ke=0;ke<N.length;ke++)L=N[ke],Object.prototype.hasOwnProperty.call(U,L)&&(y[L]=U[L])}}function R(y){var P=1;y=y.split(":");const L=[];for(;0<P&&y.length;)L.push(y.shift()),P--;return y.length&&L.push(y.join(":")),L}function D(y){l.setTimeout(()=>{throw y},0)}function M(){var y=K;let P=null;return y.g&&(P=y.g,y.g=y.g.next,y.g||(y.h=null),P.next=null),P}class z{constructor(){this.h=this.g=null}add(P,L){const U=B.get();U.set(P,L),this.h?this.h.next=U:this.g=U,this.h=U}}var B=new w(()=>new G,y=>y.reset());class G{constructor(){this.next=this.g=this.h=null}set(P,L){this.h=P,this.g=L,this.next=null}reset(){this.next=this.g=this.h=null}}let Y,H=!1,K=new z,$=()=>{const y=l.Promise.resolve(void 0);Y=()=>{y.then(V)}};var V=()=>{for(var y;y=M();){try{y.h.call(y.g)}catch(L){D(L)}var P=B;P.j(y),100>P.h&&(P.h++,y.next=P.g,P.g=y)}H=!1};function W(){this.s=this.s,this.C=this.C}W.prototype.s=!1,W.prototype.ma=function(){this.s||(this.s=!0,this.N())},W.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(y,P){this.type=y,this.g=this.target=P,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var Z=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var y=!1,P=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const L=()=>{};l.addEventListener("test",L,P),l.removeEventListener("test",L,P)}catch{}return y}();function ce(y,P){if(F.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y){var L=this.type=y.type,U=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;if(this.target=y.target||y.srcElement,this.g=P,P=y.relatedTarget){if(j){e:{try{T(P.nodeName);var fe=!0;break e}catch{}fe=!1}fe||(P=null)}}else L=="mouseover"?P=y.fromElement:L=="mouseout"&&(P=y.toElement);this.relatedTarget=P,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=typeof y.pointerType=="string"?y.pointerType:le[y.pointerType]||"",this.state=y.state,this.i=y,y.defaultPrevented&&ce.aa.h.call(this)}}g(ce,F);var le={2:"touch",3:"pen",4:"mouse"};ce.prototype.h=function(){ce.aa.h.call(this);var y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var he="closure_listenable_"+(1e6*Math.random()|0),Le=0;function Ve(y,P,L,U,fe){this.listener=y,this.proxy=null,this.src=P,this.type=L,this.capture=!!U,this.ha=fe,this.key=++Le,this.da=this.fa=!1}function Be(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function ue(y){this.src=y,this.g={},this.h=0}ue.prototype.add=function(y,P,L,U,fe){var ke=y.toString();y=this.g[ke],y||(y=this.g[ke]=[],this.h++);var at=Ie(y,P,U,fe);return-1<at?(P=y[at],L||(P.fa=!1)):(P=new Ve(P,this.src,ke,!!U,fe),P.fa=L,y.push(P)),P};function Ce(y,P){var L=P.type;if(L in y.g){var U=y.g[L],fe=Array.prototype.indexOf.call(U,P,void 0),ke;(ke=0<=fe)&&Array.prototype.splice.call(U,fe,1),ke&&(Be(P),y.g[L].length==0&&(delete y.g[L],y.h--))}}function Ie(y,P,L,U){for(var fe=0;fe<y.length;++fe){var ke=y[fe];if(!ke.da&&ke.listener==P&&ke.capture==!!L&&ke.ha==U)return fe}return-1}var ve="closure_lm_"+(1e6*Math.random()|0),ie={};function Me(y,P,L,U,fe){if(U&&U.once)return kt(y,P,L,U,fe);if(Array.isArray(P)){for(var ke=0;ke<P.length;ke++)Me(y,P[ke],L,U,fe);return null}return L=de(L),y&&y[he]?y.K(P,L,u(U)?!!U.capture:!!U,fe):He(y,P,L,!1,U,fe)}function He(y,P,L,U,fe,ke){if(!P)throw Error("Invalid event type");var at=u(fe)?!!fe.capture:!!fe,Un=Ue(y);if(Un||(y[ve]=Un=new ue(y)),L=Un.add(P,L,U,at,ke),L.proxy)return L;if(U=yt(),L.proxy=U,U.src=y,U.listener=L,y.addEventListener)Z||(fe=at),fe===void 0&&(fe=!1),y.addEventListener(P.toString(),U,fe);else if(y.attachEvent)y.attachEvent(cn(P.toString()),U);else if(y.addListener&&y.removeListener)y.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return L}function yt(){function y(L){return P.call(y.src,y.listener,L)}const P=fn;return y}function kt(y,P,L,U,fe){if(Array.isArray(P)){for(var ke=0;ke<P.length;ke++)kt(y,P[ke],L,U,fe);return null}return L=de(L),y&&y[he]?y.L(P,L,u(U)?!!U.capture:!!U,fe):He(y,P,L,!0,U,fe)}function en(y,P,L,U,fe){if(Array.isArray(P))for(var ke=0;ke<P.length;ke++)en(y,P[ke],L,U,fe);else U=u(U)?!!U.capture:!!U,L=de(L),y&&y[he]?(y=y.i,P=String(P).toString(),P in y.g&&(ke=y.g[P],L=Ie(ke,L,U,fe),-1<L&&(Be(ke[L]),Array.prototype.splice.call(ke,L,1),ke.length==0&&(delete y.g[P],y.h--)))):y&&(y=Ue(y))&&(P=y.g[P.toString()],y=-1,P&&(y=Ie(P,L,U,fe)),(L=-1<y?P[y]:null)&&mn(L))}function mn(y){if(typeof y!="number"&&y&&!y.da){var P=y.src;if(P&&P[he])Ce(P.i,y);else{var L=y.type,U=y.proxy;P.removeEventListener?P.removeEventListener(L,U,y.capture):P.detachEvent?P.detachEvent(cn(L),U):P.addListener&&P.removeListener&&P.removeListener(U),(L=Ue(P))?(Ce(L,y),L.h==0&&(L.src=null,P[ve]=null)):Be(y)}}}function cn(y){return y in ie?ie[y]:ie[y]="on"+y}function fn(y,P){if(y.da)y=!0;else{P=new ce(P,this);var L=y.listener,U=y.ha||y.src;y.fa&&mn(y),y=L.call(U,P)}return y}function Ue(y){return y=y[ve],y instanceof ue?y:null}var Et="__closure_events_fn_"+(1e9*Math.random()>>>0);function de(y){return typeof y=="function"?y:(y[Et]||(y[Et]=function(P){return y.handleEvent(P)}),y[Et])}function De(){W.call(this),this.i=new ue(this),this.M=this,this.F=null}g(De,W),De.prototype[he]=!0,De.prototype.removeEventListener=function(y,P,L,U){en(this,y,P,L,U)};function ee(y,P){var L,U=y.F;if(U)for(L=[];U;U=U.F)L.push(U);if(y=y.M,U=P.type||P,typeof P=="string")P=new F(P,y);else if(P instanceof F)P.target=P.target||y;else{var fe=P;P=new F(U,y),k(P,fe)}if(fe=!0,L)for(var ke=L.length-1;0<=ke;ke--){var at=P.g=L[ke];fe=ae(at,U,!0,P)&&fe}if(at=P.g=y,fe=ae(at,U,!0,P)&&fe,fe=ae(at,U,!1,P)&&fe,L)for(ke=0;ke<L.length;ke++)at=P.g=L[ke],fe=ae(at,U,!1,P)&&fe}De.prototype.N=function(){if(De.aa.N.call(this),this.i){var y=this.i,P;for(P in y.g){for(var L=y.g[P],U=0;U<L.length;U++)Be(L[U]);delete y.g[P],y.h--}}this.F=null},De.prototype.K=function(y,P,L,U){return this.i.add(String(y),P,!1,L,U)},De.prototype.L=function(y,P,L,U){return this.i.add(String(y),P,!0,L,U)};function ae(y,P,L,U){if(P=y.i.g[String(P)],!P)return!0;P=P.concat();for(var fe=!0,ke=0;ke<P.length;++ke){var at=P[ke];if(at&&!at.da&&at.capture==L){var Un=at.listener,cs=at.ha||at.src;at.fa&&Ce(y.i,at),fe=Un.call(cs,U)!==!1&&fe}}return fe&&!U.defaultPrevented}function X(y,P,L){if(typeof y=="function")L&&(y=f(y,L));else if(y&&typeof y.handleEvent=="function")y=f(y.handleEvent,y);else throw Error("Invalid listener argument");return 2147483647<Number(P)?-1:l.setTimeout(y,P||0)}function Pe(y){y.g=X(()=>{y.g=null,y.i&&(y.i=!1,Pe(y))},y.l);const P=y.h;y.h=null,y.m.apply(null,P)}class Ae extends W{constructor(P,L){super(),this.m=P,this.l=L,this.h=null,this.i=!1,this.g=null}j(P){this.h=arguments,this.g?this.i=!0:Pe(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $e(y){W.call(this),this.h=y,this.g={}}g($e,W);var qe=[];function oe(y){A(y.g,function(P,L){this.g.hasOwnProperty(L)&&mn(P)},y),y.g={}}$e.prototype.N=function(){$e.aa.N.call(this),oe(this)},$e.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _e=l.JSON.stringify,ze=l.JSON.parse,Te=class{stringify(y){return l.JSON.stringify(y,void 0)}parse(y){return l.JSON.parse(y,void 0)}};function Tt(){}Tt.prototype.h=null;function wt(y){return y.h||(y.h=y.i())}function xt(){}var pt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Pt(){F.call(this,"d")}g(Pt,F);function Rn(){F.call(this,"c")}g(Rn,F);var Sn={},cr=null;function sn(){return cr=cr||new De}Sn.La="serverreachability";function $t(y){F.call(this,Sn.La,y)}g($t,F);function tn(y){const P=sn();ee(P,new $t(P))}Sn.STAT_EVENT="statevent";function Zn(y,P){F.call(this,Sn.STAT_EVENT,y),this.stat=P}g(Zn,F);function J(y){const P=sn();ee(P,new Zn(P,y))}Sn.Ma="timingevent";function re(y,P){F.call(this,Sn.Ma,y),this.size=P}g(re,F);function ge(y,P){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){y()},P)}function Oe(){this.g=!0}Oe.prototype.xa=function(){this.g=!1};function tt(y,P,L,U,fe,ke){y.info(function(){if(y.g)if(ke)for(var at="",Un=ke.split("&"),cs=0;cs<Un.length;cs++){var vn=Un[cs].split("=");if(1<vn.length){var _s=vn[0];vn=vn[1];var Ss=_s.split("_");at=2<=Ss.length&&Ss[1]=="type"?at+(_s+"="+vn+"&"):at+(_s+"=redacted&")}}else at=null;else at=ke;return"XMLHTTP REQ ("+U+") [attempt "+fe+"]: "+P+`
`+L+`
`+at})}function Q(y,P,L,U,fe,ke,at){y.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+fe+"]: "+P+`
`+L+`
`+ke+" "+at})}function te(y,P,L,U){y.info(function(){return"XMLHTTP TEXT ("+P+"): "+q(y,L)+(U?" "+U:"")})}function me(y,P){y.info(function(){return"TIMEOUT: "+P})}Oe.prototype.info=function(){};function q(y,P){if(!y.g)return P;if(!P)return null;try{var L=JSON.parse(P);if(L){for(y=0;y<L.length;y++)if(Array.isArray(L[y])){var U=L[y];if(!(2>U.length)){var fe=U[1];if(Array.isArray(fe)&&!(1>fe.length)){var ke=fe[0];if(ke!="noop"&&ke!="stop"&&ke!="close")for(var at=1;at<fe.length;at++)fe[at]=""}}}}return _e(L)}catch{return P}}var ne={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},be={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ne;function Ge(){}g(Ge,Tt),Ge.prototype.g=function(){return new XMLHttpRequest},Ge.prototype.i=function(){return{}},Ne=new Ge;function Se(y,P,L,U){this.j=y,this.i=P,this.l=L,this.R=U||1,this.U=new $e(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ot}function ot(){this.i=null,this.g="",this.h=!1}var st={},Mt={};function xn(y,P,L){y.L=1,y.v=mt(Ee(P)),y.m=L,y.P=!0,Zr(y,null)}function Zr(y,P){y.F=Date.now(),bs(y),y.A=Ee(y.v);var L=y.A,U=y.R;Array.isArray(U)||(U=[String(U)]),ls(L.i,"t",U),y.C=0,L=y.j.J,y.h=new ot,y.g=Tk(y.j,L?P:null,!y.m),0<y.O&&(y.M=new Ae(f(y.Y,y,y.g),y.O)),P=y.U,L=y.g,U=y.ca;var fe="readystatechange";Array.isArray(fe)||(fe&&(qe[0]=fe.toString()),fe=qe);for(var ke=0;ke<fe.length;ke++){var at=Me(L,fe[ke],U||P.handleEvent,!1,P.h||P);if(!at)break;P.g[at.key]=at}P=y.H?I(y.H):{},y.m?(y.u||(y.u="POST"),P["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.A,y.u,y.m,P)):(y.u="GET",y.g.ea(y.A,y.u,null,P)),tn(),tt(y.i,y.u,y.A,y.l,y.R,y.m)}Se.prototype.ca=function(y){y=y.target;const P=this.M;P&&ka(y)==3?P.j():this.Y(y)},Se.prototype.Y=function(y){try{if(y==this.g)e:{const Ss=ka(this.g);var P=this.g.Ba();const _d=this.g.Z();if(!(3>Ss)&&(Ss!=3||this.g&&(this.h.h||this.g.oa()||pk(this.g)))){this.J||Ss!=4||P==7||(P==8||0>=_d?tn(3):tn(2)),Vs(this);var L=this.g.Z();this.X=L;t:if(Dn(this)){var U=pk(this.g);y="";var fe=U.length,ke=ka(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){es(this),Us(this);var at="";break t}this.h.i=new l.TextDecoder}for(P=0;P<fe;P++)this.h.h=!0,y+=this.h.i.decode(U[P],{stream:!(ke&&P==fe-1)});U.length=0,this.h.g+=y,this.C=0,at=this.h.g}else at=this.g.oa();if(this.o=L==200,Q(this.i,this.u,this.A,this.l,this.R,Ss,L),this.o){if(this.T&&!this.K){t:{if(this.g){var Un,cs=this.g;if((Un=cs.g?cs.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(Un)){var vn=Un;break t}}vn=null}if(L=vn)te(this.i,this.l,L,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,nn(this,L);else{this.o=!1,this.s=3,J(12),es(this),Us(this);break e}}if(this.P){L=!0;let wo;for(;!this.J&&this.C<at.length;)if(wo=Gr(this,at),wo==Mt){Ss==4&&(this.s=4,J(14),L=!1),te(this.i,this.l,null,"[Incomplete Response]");break}else if(wo==st){this.s=4,J(15),te(this.i,this.l,at,"[Invalid Chunk]"),L=!1;break}else te(this.i,this.l,wo,null),nn(this,wo);if(Dn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ss!=4||at.length!=0||this.h.h||(this.s=1,J(16),L=!1),this.o=this.o&&L,!L)te(this.i,this.l,at,"[Invalid Chunked Response]"),es(this),Us(this);else if(0<at.length&&!this.W){this.W=!0;var _s=this.j;_s.g==this&&_s.ba&&!_s.M&&(_s.j.info("Great, no buffering proxy detected. Bytes received: "+at.length),p_(_s),_s.M=!0,J(11))}}else te(this.i,this.l,at,null),nn(this,at);Ss==4&&es(this),this.o&&!this.J&&(Ss==4?_k(this.j,this):(this.o=!1,bs(this)))}else zq(this.g),L==400&&0<at.indexOf("Unknown SID")?(this.s=3,J(12)):(this.s=0,J(13)),es(this),Us(this)}}}catch{}finally{}};function Dn(y){return y.g?y.u=="GET"&&y.L!=2&&y.j.Ca:!1}function Gr(y,P){var L=y.C,U=P.indexOf(`
`,L);return U==-1?Mt:(L=Number(P.substring(L,U)),isNaN(L)?st:(U+=1,U+L>P.length?Mt:(P=P.slice(U,U+L),y.C=U+L,P)))}Se.prototype.cancel=function(){this.J=!0,es(this)};function bs(y){y.S=Date.now()+y.I,Ci(y,y.I)}function Ci(y,P){if(y.B!=null)throw Error("WatchDog timer not null");y.B=ge(f(y.ba,y),P)}function Vs(y){y.B&&(l.clearTimeout(y.B),y.B=null)}Se.prototype.ba=function(){this.B=null;const y=Date.now();0<=y-this.S?(me(this.i,this.A),this.L!=2&&(tn(),J(17)),es(this),this.s=2,Us(this)):Ci(this,this.S-y)};function Us(y){y.j.G==0||y.J||_k(y.j,y)}function es(y){Vs(y);var P=y.M;P&&typeof P.ma=="function"&&P.ma(),y.M=null,oe(y.U),y.g&&(P=y.g,y.g=null,P.abort(),P.ma())}function nn(y,P){try{var L=y.j;if(L.G!=0&&(L.g==y||Bs(L.h,y))){if(!y.K&&Bs(L.h,y)&&L.G==3){try{var U=L.Da.g.parse(P)}catch{U=null}if(Array.isArray(U)&&U.length==3){var fe=U;if(fe[0]==0){e:if(!L.u){if(L.g)if(L.g.F+3e3<y.F)py(L),fy(L);else break e;m_(L),J(18)}}else L.za=fe[1],0<L.za-L.T&&37500>fe[2]&&L.F&&L.v==0&&!L.C&&(L.C=ge(f(L.Za,L),6e3));if(1>=Mn(L.h)&&L.ca){try{L.ca()}catch{}L.ca=void 0}}else Zc(L,11)}else if((y.K||L.g==y)&&py(L),!_(P))for(fe=L.Da.g.parse(P),P=0;P<fe.length;P++){let vn=fe[P];if(L.T=vn[0],vn=vn[1],L.G==2)if(vn[0]=="c"){L.K=vn[1],L.ia=vn[2];const _s=vn[3];_s!=null&&(L.la=_s,L.j.info("VER="+L.la));const Ss=vn[4];Ss!=null&&(L.Aa=Ss,L.j.info("SVER="+L.Aa));const _d=vn[5];_d!=null&&typeof _d=="number"&&0<_d&&(U=1.5*_d,L.L=U,L.j.info("backChannelRequestTimeoutMs_="+U)),U=L;const wo=y.g;if(wo){const yy=wo.g?wo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yy){var ke=U.h;ke.g||yy.indexOf("spdy")==-1&&yy.indexOf("quic")==-1&&yy.indexOf("h2")==-1||(ke.j=ke.l,ke.g=new Set,ke.h&&(vo(ke,ke.h),ke.h=null))}if(U.D){const g_=wo.g?wo.g.getResponseHeader("X-HTTP-Session-Id"):null;g_&&(U.ya=g_,Re(U.I,U.D,g_))}}L.G=3,L.l&&L.l.ua(),L.ba&&(L.R=Date.now()-y.F,L.j.info("Handshake RTT: "+L.R+"ms")),U=L;var at=y;if(U.qa=Ek(U,U.J?U.ia:null,U.W),at.K){Wo(U.h,at);var Un=at,cs=U.L;cs&&(Un.I=cs),Un.B&&(Vs(Un),bs(Un)),U.g=at}else wk(U);0<L.i.length&&my(L)}else vn[0]!="stop"&&vn[0]!="close"||Zc(L,7);else L.G==3&&(vn[0]=="stop"||vn[0]=="close"?vn[0]=="stop"?Zc(L,7):f_(L):vn[0]!="noop"&&L.l&&L.l.ta(vn),L.v=0)}}tn(4)}catch{}}var Cn=class{constructor(y,P){this.g=y,this.map=P}};function si(y){this.l=y||10,l.PerformanceNavigationTiming?(y=l.performance.getEntriesByType("navigation"),y=0<y.length&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ii(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function Mn(y){return y.h?1:y.g?y.g.size:0}function Bs(y,P){return y.h?y.h==P:y.g?y.g.has(P):!1}function vo(y,P){y.g?y.g.add(P):y.h=P}function Wo(y,P){y.h&&y.h==P?y.h=null:y.g&&y.g.has(P)&&y.g.delete(P)}si.prototype.cancel=function(){if(this.i=Qc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Qc(y){if(y.h!=null)return y.i.concat(y.h.D);if(y.g!=null&&y.g.size!==0){let P=y.i;for(const L of y.g.values())P=P.concat(L.D);return P}return x(y.i)}function dy(y){if(y.V&&typeof y.V=="function")return y.V();if(typeof Map<"u"&&y instanceof Map||typeof Set<"u"&&y instanceof Set)return Array.from(y.values());if(typeof y=="string")return y.split("");if(c(y)){for(var P=[],L=y.length,U=0;U<L;U++)P.push(y[U]);return P}P=[],L=0;for(U in y)P[L++]=y[U];return P}function Pa(y){if(y.na&&typeof y.na=="function")return y.na();if(!y.V||typeof y.V!="function"){if(typeof Map<"u"&&y instanceof Map)return Array.from(y.keys());if(!(typeof Set<"u"&&y instanceof Set)){if(c(y)||typeof y=="string"){var P=[];y=y.length;for(var L=0;L<y;L++)P.push(L);return P}P=[],L=0;for(const U in y)P[L++]=U;return P}}}function xe(y,P){if(y.forEach&&typeof y.forEach=="function")y.forEach(P,void 0);else if(c(y)||typeof y=="string")Array.prototype.forEach.call(y,P,void 0);else for(var L=Pa(y),U=dy(y),fe=U.length,ke=0;ke<fe;ke++)P.call(void 0,U[ke],L&&L[ke],y)}var pe=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function we(y,P){if(y){y=y.split("&");for(var L=0;L<y.length;L++){var U=y[L].indexOf("="),fe=null;if(0<=U){var ke=y[L].substring(0,U);fe=y[L].substring(U+1)}else ke=y[L];P(ke,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function se(y){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,y instanceof se){this.h=y.h,We(this,y.j),this.o=y.o,this.g=y.g,nt(this,y.s),this.l=y.l;var P=y.i,L=new xr;L.i=P.i,P.g&&(L.g=new Map(P.g),L.h=P.h),Ye(this,L),this.m=y.m}else y&&(P=String(y).match(pe))?(this.h=!1,We(this,P[1]||"",!0),this.o=Rt(P[2]||""),this.g=Rt(P[3]||"",!0),nt(this,P[4]),this.l=Rt(P[5]||"",!0),Ye(this,P[6]||"",!0),this.m=Rt(P[7]||"")):(this.h=!1,this.i=new xr(null,this.h))}se.prototype.toString=function(){var y=[],P=this.j;P&&y.push(Dt(P,St,!0),":");var L=this.g;return(L||P=="file")&&(y.push("//"),(P=this.o)&&y.push(Dt(P,St,!0),"@"),y.push(encodeURIComponent(String(L)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L=this.s,L!=null&&y.push(":",String(L))),(L=this.l)&&(this.g&&L.charAt(0)!="/"&&y.push("/"),y.push(Dt(L,L.charAt(0)=="/"?Lt:Jt,!0))),(L=this.i.toString())&&y.push("?",L),(L=this.m)&&y.push("#",Dt(L,er)),y.join("")};function Ee(y){return new se(y)}function We(y,P,L){y.j=L?Rt(P,!0):P,y.j&&(y.j=y.j.replace(/:$/,""))}function nt(y,P){if(P){if(P=Number(P),isNaN(P)||0>P)throw Error("Bad port number "+P);y.s=P}else y.s=null}function Ye(y,P,L){P instanceof xr?(y.i=P,wr(y.i,y.h)):(L||(P=Dt(P,Vn)),y.i=new xr(P,y.h))}function Re(y,P,L){y.i.set(P,L)}function mt(y){return Re(y,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),y}function Rt(y,P){return y?P?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function Dt(y,P,L){return typeof y=="string"?(y=encodeURI(y).replace(P,Nn),L&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Nn(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var St=/[#\/\?@]/g,Jt=/[#\?:]/g,Lt=/[#\?]/g,Vn=/[#\?@]/g,er=/#/g;function xr(y,P){this.h=this.g=null,this.i=y||null,this.j=!!P}function ur(y){y.g||(y.g=new Map,y.h=0,y.i&&we(y.i,function(P,L){y.add(decodeURIComponent(P.replace(/\+/g," ")),L)}))}t=xr.prototype,t.add=function(y,P){ur(this),this.i=null,y=Ei(this,y);var L=this.g.get(y);return L||this.g.set(y,L=[]),L.push(P),this.h+=1,this};function Ct(y,P){ur(y),P=Ei(y,P),y.g.has(P)&&(y.i=null,y.h-=y.g.get(P).length,y.g.delete(P))}function vr(y,P){return ur(y),P=Ei(y,P),y.g.has(P)}t.forEach=function(y,P){ur(this),this.g.forEach(function(L,U){L.forEach(function(fe){y.call(P,fe,U,this)},this)},this)},t.na=function(){ur(this);const y=Array.from(this.g.values()),P=Array.from(this.g.keys()),L=[];for(let U=0;U<P.length;U++){const fe=y[U];for(let ke=0;ke<fe.length;ke++)L.push(P[U])}return L},t.V=function(y){ur(this);let P=[];if(typeof y=="string")vr(this,y)&&(P=P.concat(this.g.get(Ei(this,y))));else{y=Array.from(this.g.values());for(let L=0;L<y.length;L++)P=P.concat(y[L])}return P},t.set=function(y,P){return ur(this),this.i=null,y=Ei(this,y),vr(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[P]),this.h+=1,this},t.get=function(y,P){return y?(y=this.V(y),0<y.length?String(y[0]):P):P};function ls(y,P,L){Ct(y,P),0<L.length&&(y.i=null,y.g.set(Ei(y,P),x(L)),y.h+=L.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],P=Array.from(this.g.keys());for(var L=0;L<P.length;L++){var U=P[L];const ke=encodeURIComponent(String(U)),at=this.V(U);for(U=0;U<at.length;U++){var fe=ke;at[U]!==""&&(fe+="="+encodeURIComponent(String(at[U]))),y.push(fe)}}return this.i=y.join("&")};function Ei(y,P){return P=String(P),y.j&&(P=P.toLowerCase()),P}function wr(y,P){P&&!y.j&&(ur(y),y.i=null,y.g.forEach(function(L,U){var fe=U.toLowerCase();U!=fe&&(Ct(this,U),ls(this,fe,L))},y)),y.j=P}function Kn(y,P){const L=new Oe;if(l.Image){const U=new Image;U.onload=m(ts,L,"TestLoadImage: loaded",!0,P,U),U.onerror=m(ts,L,"TestLoadImage: error",!1,P,U),U.onabort=m(ts,L,"TestLoadImage: abort",!1,P,U),U.ontimeout=m(ts,L,"TestLoadImage: timeout",!1,P,U),l.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=y}else P(!1)}function br(y,P){const L=new Oe,U=new AbortController,fe=setTimeout(()=>{U.abort(),ts(L,"TestPingServer: timeout",!1,P)},1e4);fetch(y,{signal:U.signal}).then(ke=>{clearTimeout(fe),ke.ok?ts(L,"TestPingServer: ok",!0,P):ts(L,"TestPingServer: server error",!1,P)}).catch(()=>{clearTimeout(fe),ts(L,"TestPingServer: error",!1,P)})}function ts(y,P,L,U,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),U(L)}catch{}}function Ho(){this.g=new Te}function Aa(y,P,L){const U=L||"";try{xe(y,function(fe,ke){let at=fe;u(fe)&&(at=_e(fe)),P.push(U+ke+"="+encodeURIComponent(at))})}catch(fe){throw P.push(U+"type="+encodeURIComponent("_badmap")),fe}}function oi(y){this.l=y.Ub||null,this.j=y.eb||!1}g(oi,Tt),oi.prototype.g=function(){return new Xc(this.l,this.j)},oi.prototype.i=function(y){return function(){return y}}({});function Xc(y,P){De.call(this),this.D=y,this.o=P,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(Xc,De),t=Xc.prototype,t.open=function(y,P){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=y,this.A=P,this.readyState=1,Mf(this)},t.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const P={headers:this.u,method:this.B,credentials:this.m,cache:void 0};y&&(P.body=y),(this.D||l).fetch(new Request(this.A,P)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Df(this)),this.readyState=0},t.Sa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Mf(this)),this.g&&(this.readyState=3,Mf(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ck(this)}else y.text().then(this.Ra.bind(this),this.ga.bind(this))};function ck(y){y.j.read().then(y.Pa.bind(y)).catch(y.ga.bind(y))}t.Pa=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var P=y.value?y.value:new Uint8Array(0);(P=this.v.decode(P,{stream:!y.done}))&&(this.response=this.responseText+=P)}y.done?Df(this):Mf(this),this.readyState==3&&ck(this)}},t.Ra=function(y){this.g&&(this.response=this.responseText=y,Df(this))},t.Qa=function(y){this.g&&(this.response=y,Df(this))},t.ga=function(){this.g&&Df(this)};function Df(y){y.readyState=4,y.l=null,y.j=null,y.v=null,Mf(y)}t.setRequestHeader=function(y,P){this.u.append(y,P)},t.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],P=this.h.entries();for(var L=P.next();!L.done;)L=L.value,y.push(L[0]+": "+L[1]),L=P.next();return y.join(`\r
`)};function Mf(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Xc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function uk(y){let P="";return A(y,function(L,U){P+=U,P+=":",P+=L,P+=`\r
`}),P}function h_(y,P,L){e:{for(U in L){var U=!1;break e}U=!0}U||(L=uk(L),typeof y=="string"?L!=null&&encodeURIComponent(String(L)):Re(y,P,L))}function _r(y){De.call(this),this.headers=new Map,this.o=y||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(_r,De);var Uq=/^https?$/i,Bq=["POST","PUT"];t=_r.prototype,t.Ha=function(y){this.J=y},t.ea=function(y,P,L,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);P=P?P.toUpperCase():"GET",this.D=y,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ne.g(),this.v=this.o?wt(this.o):wt(Ne),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(P,String(y),!0),this.B=!1}catch(ke){dk(this,ke);return}if(y=L||"",L=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var fe in U)L.set(fe,U[fe]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const ke of U.keys())L.set(ke,U.get(ke));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(L.keys()).find(ke=>ke.toLowerCase()=="content-type"),fe=l.FormData&&y instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Bq,P,void 0))||U||fe||L.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ke,at]of L)this.g.setRequestHeader(ke,at);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{mk(this),this.u=!0,this.g.send(y),this.u=!1}catch(ke){dk(this,ke)}};function dk(y,P){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=P,y.m=5,hk(y),hy(y)}function hk(y){y.A||(y.A=!0,ee(y,"complete"),ee(y,"error"))}t.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=y||7,ee(this,"complete"),ee(this,"abort"),hy(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),hy(this,!0)),_r.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?fk(this):this.bb())},t.bb=function(){fk(this)};function fk(y){if(y.h&&typeof o<"u"&&(!y.v[1]||ka(y)!=4||y.Z()!=2)){if(y.u&&ka(y)==4)X(y.Ea,0,y);else if(ee(y,"readystatechange"),ka(y)==4){y.h=!1;try{const at=y.Z();e:switch(at){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var P=!0;break e;default:P=!1}var L;if(!(L=P)){var U;if(U=at===0){var fe=String(y.D).match(pe)[1]||null;!fe&&l.self&&l.self.location&&(fe=l.self.location.protocol.slice(0,-1)),U=!Uq.test(fe?fe.toLowerCase():"")}L=U}if(L)ee(y,"complete"),ee(y,"success");else{y.m=6;try{var ke=2<ka(y)?y.g.statusText:""}catch{ke=""}y.l=ke+" ["+y.Z()+"]",hk(y)}}finally{hy(y)}}}}function hy(y,P){if(y.g){mk(y);const L=y.g,U=y.v[0]?()=>{}:null;y.g=null,y.v=null,P||ee(y,"ready");try{L.onreadystatechange=U}catch{}}}function mk(y){y.I&&(l.clearTimeout(y.I),y.I=null)}t.isActive=function(){return!!this.g};function ka(y){return y.g?y.g.readyState:0}t.Z=function(){try{return 2<ka(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(y){if(this.g){var P=this.g.responseText;return y&&P.indexOf(y)==0&&(P=P.substring(y.length)),ze(P)}};function pk(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.H){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function zq(y){const P={};y=(y.g&&2<=ka(y)&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<y.length;U++){if(_(y[U]))continue;var L=R(y[U]);const fe=L[0];if(L=L[1],typeof L!="string")continue;L=L.trim();const ke=P[fe]||[];P[fe]=ke,ke.push(L)}E(P,function(U){return U.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Lf(y,P,L){return L&&L.internalChannelParams&&L.internalChannelParams[y]||P}function gk(y){this.Aa=0,this.i=[],this.j=new Oe,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Lf("failFast",!1,y),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Lf("baseRetryDelayMs",5e3,y),this.cb=Lf("retryDelaySeedMs",1e4,y),this.Wa=Lf("forwardChannelMaxRetries",2,y),this.wa=Lf("forwardChannelRequestTimeoutMs",2e4,y),this.pa=y&&y.xmlHttpFactory||void 0,this.Xa=y&&y.Tb||void 0,this.Ca=y&&y.useFetchStreams||!1,this.L=void 0,this.J=y&&y.supportsCrossDomainXhr||!1,this.K="",this.h=new si(y&&y.concurrentRequestLimit),this.Da=new Ho,this.P=y&&y.fastHandshake||!1,this.O=y&&y.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=y&&y.Rb||!1,y&&y.xa&&this.j.xa(),y&&y.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&y&&y.detectBufferingProxy||!1,this.ja=void 0,y&&y.longPollingTimeout&&0<y.longPollingTimeout&&(this.ja=y.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=gk.prototype,t.la=8,t.G=1,t.connect=function(y,P,L,U){J(0),this.W=y,this.H=P||{},L&&U!==void 0&&(this.H.OSID=L,this.H.OAID=U),this.F=this.X,this.I=Ek(this,null,this.W),my(this)};function f_(y){if(yk(y),y.G==3){var P=y.U++,L=Ee(y.I);if(Re(L,"SID",y.K),Re(L,"RID",P),Re(L,"TYPE","terminate"),Ff(y,L),P=new Se(y,y.j,P),P.L=2,P.v=mt(Ee(L)),L=!1,l.navigator&&l.navigator.sendBeacon)try{L=l.navigator.sendBeacon(P.v.toString(),"")}catch{}!L&&l.Image&&(new Image().src=P.v,L=!0),L||(P.g=Tk(P.j,null),P.g.ea(P.v)),P.F=Date.now(),bs(P)}Ck(y)}function fy(y){y.g&&(p_(y),y.g.cancel(),y.g=null)}function yk(y){fy(y),y.u&&(l.clearTimeout(y.u),y.u=null),py(y),y.h.cancel(),y.s&&(typeof y.s=="number"&&l.clearTimeout(y.s),y.s=null)}function my(y){if(!ii(y.h)&&!y.s){y.s=!0;var P=y.Ga;Y||$(),H||(Y(),H=!0),K.add(P,y),y.B=0}}function Gq(y,P){return Mn(y.h)>=y.h.j-(y.s?1:0)?!1:y.s?(y.i=P.D.concat(y.i),!0):y.G==1||y.G==2||y.B>=(y.Va?0:y.Wa)?!1:(y.s=ge(f(y.Ga,y,P),Sk(y,y.B)),y.B++,!0)}t.Ga=function(y){if(this.s)if(this.s=null,this.G==1){if(!y){this.U=Math.floor(1e5*Math.random()),y=this.U++;const fe=new Se(this,this.j,y);let ke=this.o;if(this.S&&(ke?(ke=I(ke),k(ke,this.S)):ke=this.S),this.m!==null||this.O||(fe.H=ke,ke=null),this.P)e:{for(var P=0,L=0;L<this.i.length;L++){t:{var U=this.i[L];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(P+=U,4096<P){P=L;break e}if(P===4096||L===this.i.length-1){P=L+1;break e}}P=1e3}else P=1e3;P=vk(this,fe,P),L=Ee(this.I),Re(L,"RID",y),Re(L,"CVER",22),this.D&&Re(L,"X-HTTP-Session-Id",this.D),Ff(this,L),ke&&(this.O?P="headers="+encodeURIComponent(String(uk(ke)))+"&"+P:this.m&&h_(L,this.m,ke)),vo(this.h,fe),this.Ua&&Re(L,"TYPE","init"),this.P?(Re(L,"$req",P),Re(L,"SID","null"),fe.T=!0,xn(fe,L,null)):xn(fe,L,P),this.G=2}}else this.G==3&&(y?xk(this,y):this.i.length==0||ii(this.h)||xk(this))};function xk(y,P){var L;P?L=P.l:L=y.U++;const U=Ee(y.I);Re(U,"SID",y.K),Re(U,"RID",L),Re(U,"AID",y.T),Ff(y,U),y.m&&y.o&&h_(U,y.m,y.o),L=new Se(y,y.j,L,y.B+1),y.m===null&&(L.H=y.o),P&&(y.i=P.D.concat(y.i)),P=vk(y,L,1e3),L.I=Math.round(.5*y.wa)+Math.round(.5*y.wa*Math.random()),vo(y.h,L),xn(L,U,P)}function Ff(y,P){y.H&&A(y.H,function(L,U){Re(P,U,L)}),y.l&&xe({},function(L,U){Re(P,U,L)})}function vk(y,P,L){L=Math.min(y.i.length,L);var U=y.l?f(y.l.Na,y.l,y):null;e:{var fe=y.i;let ke=-1;for(;;){const at=["count="+L];ke==-1?0<L?(ke=fe[0].g,at.push("ofs="+ke)):ke=0:at.push("ofs="+ke);let Un=!0;for(let cs=0;cs<L;cs++){let vn=fe[cs].g;const _s=fe[cs].map;if(vn-=ke,0>vn)ke=Math.max(0,fe[cs].g-100),Un=!1;else try{Aa(_s,at,"req"+vn+"_")}catch{U&&U(_s)}}if(Un){U=at.join("&");break e}}}return y=y.i.splice(0,L),P.D=y,U}function wk(y){if(!y.g&&!y.u){y.Y=1;var P=y.Fa;Y||$(),H||(Y(),H=!0),K.add(P,y),y.v=0}}function m_(y){return y.g||y.u||3<=y.v?!1:(y.Y++,y.u=ge(f(y.Fa,y),Sk(y,y.v)),y.v++,!0)}t.Fa=function(){if(this.u=null,bk(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var y=2*this.R;this.j.info("BP detection timer enabled: "+y),this.A=ge(f(this.ab,this),y)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,J(10),fy(this),bk(this))};function p_(y){y.A!=null&&(l.clearTimeout(y.A),y.A=null)}function bk(y){y.g=new Se(y,y.j,"rpc",y.Y),y.m===null&&(y.g.H=y.o),y.g.O=0;var P=Ee(y.qa);Re(P,"RID","rpc"),Re(P,"SID",y.K),Re(P,"AID",y.T),Re(P,"CI",y.F?"0":"1"),!y.F&&y.ja&&Re(P,"TO",y.ja),Re(P,"TYPE","xmlhttp"),Ff(y,P),y.m&&y.o&&h_(P,y.m,y.o),y.L&&(y.g.I=y.L);var L=y.g;y=y.ia,L.L=1,L.v=mt(Ee(P)),L.m=null,L.P=!0,Zr(L,y)}t.Za=function(){this.C!=null&&(this.C=null,fy(this),m_(this),J(19))};function py(y){y.C!=null&&(l.clearTimeout(y.C),y.C=null)}function _k(y,P){var L=null;if(y.g==P){py(y),p_(y),y.g=null;var U=2}else if(Bs(y.h,P))L=P.D,Wo(y.h,P),U=1;else return;if(y.G!=0){if(P.o)if(U==1){L=P.m?P.m.length:0,P=Date.now()-P.F;var fe=y.B;U=sn(),ee(U,new re(U,L)),my(y)}else wk(y);else if(fe=P.s,fe==3||fe==0&&0<P.X||!(U==1&&Gq(y,P)||U==2&&m_(y)))switch(L&&0<L.length&&(P=y.h,P.i=P.i.concat(L)),fe){case 1:Zc(y,5);break;case 4:Zc(y,10);break;case 3:Zc(y,6);break;default:Zc(y,2)}}}function Sk(y,P){let L=y.Ta+Math.floor(Math.random()*y.cb);return y.isActive()||(L*=2),L*P}function Zc(y,P){if(y.j.info("Error code "+P),P==2){var L=f(y.fb,y),U=y.Xa;const fe=!U;U=new se(U||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||We(U,"https"),mt(U),fe?Kn(U.toString(),L):br(U.toString(),L)}else J(2);y.G=0,y.l&&y.l.sa(P),Ck(y),yk(y)}t.fb=function(y){y?(this.j.info("Successfully pinged google.com"),J(2)):(this.j.info("Failed to ping google.com"),J(1))};function Ck(y){if(y.G=0,y.ka=[],y.l){const P=Qc(y.h);(P.length!=0||y.i.length!=0)&&(v(y.ka,P),v(y.ka,y.i),y.h.i.length=0,x(y.i),y.i.length=0),y.l.ra()}}function Ek(y,P,L){var U=L instanceof se?Ee(L):new se(L);if(U.g!="")P&&(U.g=P+"."+U.g),nt(U,U.s);else{var fe=l.location;U=fe.protocol,P=P?P+"."+fe.hostname:fe.hostname,fe=+fe.port;var ke=new se(null);U&&We(ke,U),P&&(ke.g=P),fe&&nt(ke,fe),L&&(ke.l=L),U=ke}return L=y.D,P=y.ya,L&&P&&Re(U,L,P),Re(U,"VER",y.la),Ff(y,U),U}function Tk(y,P,L){if(P&&!y.J)throw Error("Can't create secondary domain capable XhrIo object.");return P=y.Ca&&!y.pa?new _r(new oi({eb:L})):new _r(y.pa),P.Ha(y.J),P}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ik(){}t=Ik.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function gy(){}gy.prototype.g=function(y,P){return new Ti(y,P)};function Ti(y,P){De.call(this),this.g=new gk(P),this.l=y,this.h=P&&P.messageUrlParams||null,y=P&&P.messageHeaders||null,P&&P.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=P&&P.initMessageHeaders||null,P&&P.messageContentType&&(y?y["X-WebChannel-Content-Type"]=P.messageContentType:y={"X-WebChannel-Content-Type":P.messageContentType}),P&&P.va&&(y?y["X-WebChannel-Client-Profile"]=P.va:y={"X-WebChannel-Client-Profile":P.va}),this.g.S=y,(y=P&&P.Sb)&&!_(y)&&(this.g.m=y),this.v=P&&P.supportsCrossDomainXhr||!1,this.u=P&&P.sendRawJson||!1,(P=P&&P.httpSessionIdParam)&&!_(P)&&(this.g.D=P,y=this.h,y!==null&&P in y&&(y=this.h,P in y&&delete y[P])),this.j=new bd(this)}g(Ti,De),Ti.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ti.prototype.close=function(){f_(this.g)},Ti.prototype.o=function(y){var P=this.g;if(typeof y=="string"){var L={};L.__data__=y,y=L}else this.u&&(L={},L.__data__=_e(y),y=L);P.i.push(new Cn(P.Ya++,y)),P.G==3&&my(P)},Ti.prototype.N=function(){this.g.l=null,delete this.j,f_(this.g),delete this.g,Ti.aa.N.call(this)};function Nk(y){Pt.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var P=y.__sm__;if(P){e:{for(const L in P){y=L;break e}y=void 0}(this.i=y)&&(y=this.i,P=P!==null&&y in P?P[y]:void 0),this.data=P}else this.data=y}g(Nk,Pt);function Pk(){Rn.call(this),this.status=1}g(Pk,Rn);function bd(y){this.g=y}g(bd,Ik),bd.prototype.ua=function(){ee(this.g,"a")},bd.prototype.ta=function(y){ee(this.g,new Nk(y))},bd.prototype.sa=function(y){ee(this.g,new Pk)},bd.prototype.ra=function(){ee(this.g,"b")},gy.prototype.createWebChannel=gy.prototype.g,Ti.prototype.send=Ti.prototype.o,Ti.prototype.open=Ti.prototype.m,Ti.prototype.close=Ti.prototype.close,t8=function(){return new gy},e8=function(){return sn()},Zz=Sn,xT={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ne.NO_ERROR=0,ne.TIMEOUT=8,ne.HTTP_ERROR=6,ov=ne,be.COMPLETE="complete",Xz=be,xt.EventType=pt,pt.OPEN="a",pt.CLOSE="b",pt.ERROR="c",pt.MESSAGE="d",De.prototype.listen=De.prototype.K,Nm=xt,_r.prototype.listenOnce=_r.prototype.L,_r.prototype.getLastError=_r.prototype.Ka,_r.prototype.getLastErrorCode=_r.prototype.Ba,_r.prototype.getStatus=_r.prototype.Z,_r.prototype.getResponseJson=_r.prototype.Oa,_r.prototype.getResponseText=_r.prototype.oa,_r.prototype.send=_r.prototype.ea,_r.prototype.setWithCredentials=_r.prototype.Ha,Qz=_r}).apply(typeof lx<"u"?lx:typeof self<"u"?self:typeof window<"u"?window:{});const WM="@firebase/firestore",HM="4.7.16";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ms.UNAUTHENTICATED=new ms(null),ms.GOOGLE_CREDENTIALS=new ms("google-credentials-uid"),ms.FIRST_PARTY=new ms("first-party-uid"),ms.MOCK_USER=new ms("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tf="11.8.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu=new iP("@firebase/firestore");function Gd(){return Qu.logLevel}function Xe(t,...e){if(Qu.logLevel<=dn.DEBUG){const n=e.map(yP);Qu.debug(`Firestore (${Tf}): ${t}`,...n)}}function Ks(t,...e){if(Qu.logLevel<=dn.ERROR){const n=e.map(yP);Qu.error(`Firestore (${Tf}): ${t}`,...n)}}function Xu(t,...e){if(Qu.logLevel<=dn.WARN){const n=e.map(yP);Qu.warn(`Firestore (${Tf}): ${t}`,...n)}}function yP(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,n8(t,r,n)}function n8(t,e,n){let r=`FIRESTORE (${Tf}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ks(r),new Error(r)}function Nt(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||n8(e,s,r)}function Xt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ut extends Go{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r8{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Jye{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ms.UNAUTHENTICATED))}shutdown(){}}class Qye{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Xye{constructor(e){this.t=e,this.currentUser=ms.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Nt(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new ga;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ga,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ga)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Nt(typeof r.accessToken=="string",31837,{l:r}),new r8(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Nt(e===null||typeof e=="string",2055,{h:e}),new ms(e)}}class Zye{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=ms.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class exe{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new Zye(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(ms.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class qM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class txe{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,qs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Nt(this.o===void 0,3512);const r=i=>{i.error!=null&&Xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Xe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new qM(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Nt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new qM(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nxe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s8(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i8{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=nxe(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Wt(t,e){return t<e?-1:t>e?1:0}function vT(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return Wt(r,s);{const i=s8(),o=rxe(i.encode(KM(t,n)),i.encode(KM(e,n)));return o!==0?o:Wt(r,s)}}n+=r>65535?2:1}return Wt(t.length,e.length)}function KM(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function rxe(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return Wt(t[n],e[n]);return Wt(t.length,e.length)}function Kh(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function o8(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YM=-62135596800,JM=1e6;class gr{static now(){return gr.fromMillis(Date.now())}static fromDate(e){return gr.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*JM);return new gr(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ut(Fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ut(Fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<YM)throw new ut(Fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ut(Fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/JM}_compareTo(e){return this.seconds===e.seconds?Wt(this.nanoseconds,e.nanoseconds):Wt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-YM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{static fromTimestamp(e){return new jt(e)}static min(){return new jt(new gr(0,0))}static max(){return new jt(new gr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QM="__name__";class ta{constructor(e,n,r){n===void 0?n=0:n>e.length&&_t(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&_t(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ta.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ta?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=ta.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Wt(e.length,n.length)}static compareSegments(e,n){const r=ta.isNumericId(e),s=ta.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?ta.extractNumericId(e).compare(ta.extractNumericId(n)):vT(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return dc.fromString(e.substring(4,e.length-2))}}class Tn extends ta{construct(e,n,r){return new Tn(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ut(Fe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Tn(n)}static emptyPath(){return new Tn([])}}const sxe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mr extends ta{construct(e,n,r){return new mr(e,n,r)}static isValidIdentifier(e){return sxe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===QM}static keyField(){return new mr([QM])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ut(Fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new ut(Fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ut(Fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new ut(Fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mr(n)}static emptyPath(){return new mr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e){this.path=e}static fromPath(e){return new dt(Tn.fromString(e))}static fromName(e){return new dt(Tn.fromString(e).popFirst(5))}static empty(){return new dt(Tn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Tn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Tn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new dt(new Tn(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kp=-1;class Nw{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function wT(t){return t.fields.find(e=>e.kind===2)}function cu(t){return t.fields.filter(e=>e.kind!==2)}Nw.UNKNOWN_ID=-1;class av{constructor(e,n){this.fieldPath=e,this.kind=n}}class Yp{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Yp(0,Ki.min())}}function ixe(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=jt.fromTimestamp(r===1e9?new gr(n+1,0):new gr(n,r));return new Ki(s,dt.empty(),e)}function a8(t){return new Ki(t.readTime,t.key,Kp)}class Ki{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ki(jt.min(),dt.empty(),Kp)}static max(){return new Ki(jt.max(),dt.empty(),Kp)}}function xP(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=dt.comparator(t.documentKey,e.documentKey),n!==0?n:Wt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class c8{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fd(t){if(t.code!==Fe.FAILED_PRECONDITION||t.message!==l8)throw t;Xe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&_t(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ye((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ye?n:ye.resolve(n)}catch(n){return ye.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ye.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ye.reject(n)}static resolve(e){return new ye((n,r)=>{n(e)})}static reject(e){return new ye((n,r)=>{r(e)})}static waitFor(e){return new ye((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=ye.resolve(!1);for(const r of e)n=n.next(s=>s?ye.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new ye((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new ye((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di="SimpleDb";class Sb{static open(e,n,r,s){try{return new Sb(n,e.transaction(s,r))}catch(i){throw new rp(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new ga,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new rp(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=vP(r.target.error);this.S.reject(new rp(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Xe(Di,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new axe(n)}}class hc{static delete(e){return Xe(Di,"Removing database:",e),mu(rz().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!dz())return!1;if(hc.F())return!0;const e=Jr(),n=hc.M(e),r=0<n&&n<10,s=u8(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.B=r,this.L=null,hc.M(Jr())===12.2&&Ks("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(Xe(Di,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new rp(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new ut(Fe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new ut(Fe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new rp(e,o))},s.onupgradeneeded=i=>{Xe(Di,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;if(this.L!==null&&this.L!==i.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${i.oldVersion}, event.newVersion=${i.newVersion}, db.version=${o.version}`);this.B.q(o,s.transaction,i.oldVersion,this.version).next(()=>{Xe(Di,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",n=>{const r=n.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=n=>this.$(n)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const l=Sb.open(this.db,e,i?"readonly":"readwrite",r),c=s(l).next(u=>(l.v(),u)).catch(u=>(l.abort(u),ye.reject(u))).toPromise();return c.catch(()=>{}),await l.D,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(Xe(Di,"Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function u8(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class oxe{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return mu(this.K.delete())}}class rp extends ut{constructor(e,n){super(Fe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Hc(t){return t.name==="IndexedDbTransactionError"}class axe{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Xe(Di,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(Xe(Di,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),mu(r)}add(e){return Xe(Di,"ADD",this.store.name,e,e),mu(this.store.add(e))}get(e){return mu(this.store.get(e)).next(n=>(n===void 0&&(n=null),Xe(Di,"GET",this.store.name,e,n),n))}delete(e){return Xe(Di,"DELETE",this.store.name,e),mu(this.store.delete(e))}count(){return Xe(Di,"COUNT",this.store.name),mu(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new ye((o,l)=>{i.onerror=c=>{l(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.Y(i,(l,c)=>{o.push(c)}).next(()=>o)}}Z(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new ye((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}X(e,n){Xe(Di,"DELETE ALL",this.store.name);const r=this.options(e,n);r.ee=!1;const s=this.cursor(r);return this.Y(s,(i,o,l)=>l.delete())}te(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.Y(s,n)}ne(e){const n=this.cursor({});return new ye((r,s)=>{n.onerror=i=>{const o=vP(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():r()}):r()}})}Y(e,n){const r=[];return new ye((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const c=new oxe(l),u=n(l.primaryKey,l.value,c);if(u instanceof ye){const d=u.catch(h=>(c.done(),ye.reject(h)));r.push(d)}c.isDone?s():c.j===null?l.continue():l.continue(c.j)}}).next(()=>ye.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function mu(t){return new ye((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=vP(r.target.error);n(s)}})}let XM=!1;function vP(t){const e=hc.M(Jr());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ut("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return XM||(XM=!0,setTimeout(()=>{throw r},0)),r}}return t}const sp="IndexBackfiller";class lxe{constructor(e,n){this.asyncQueue=e,this.re=n,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){Xe(sp,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.re.se();Xe(sp,`Documents written: ${n}`)}catch(n){Hc(n)?Xe(sp,"Ignoring IndexedDB error during index backfill: ",n):await fd(n)}await this.ie(6e4)})}}class cxe{constructor(e,n){this.localStore=e,this.persistence=n}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.oe(n,e))}oe(e,n){const r=new Set;let s=n,i=!0;return ye.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Xe(sp,`Processing collection: ${o}`),this._e(e,o,s).next(l=>{s-=l,r.add(o)});i=!1})).next(()=>n-s)}_e(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ae(s,i)).next(l=>(Xe(sp,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,n,l))).next(()=>o.size)}))}ae(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=a8(i);xP(o,r)>0&&(r=o)}),new Ki(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>n.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}lo.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mu=-1;function Cb(t){return t==null}function Jp(t){return t===0&&1/t==-1/0}function uxe(t){return typeof t=="number"&&Number.isInteger(t)&&!Jp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pw="";function Ds(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=ZM(e)),e=dxe(t.get(n),e);return ZM(e)}function dxe(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Pw:n+="";break;default:n+=i}}return n}function ZM(t){return t+Pw+""}function oa(t){const e=t.length;if(Nt(e>=2,64408,{path:t}),e===2)return Nt(t.charAt(0)===Pw&&t.charAt(1)==="",56145,{path:t}),Tn.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(Pw,i);switch((o<0||o>n)&&_t(50515,{path:t}),t.charAt(o+1)){case"":const l=t.substring(i,o);let c;s.length===0?c=l:(s+=l,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:_t(61167,{path:t})}i=o+2}return new Tn(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uu="remoteDocuments",Yg="owner",jd="owner",Qp="mutationQueues",hxe="userId",No="mutations",e4="batchId",Pu="userMutationsIndex",t4=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lv(t,e){return[t,Ds(e)]}function d8(t,e,n){return[t,Ds(e),n]}const fxe={},Yh="documentMutations",Aw="remoteDocumentsV14",mxe=["prefixPath","collectionGroup","readTime","documentId"],cv="documentKeyIndex",pxe=["prefixPath","collectionGroup","documentId"],h8="collectionGroupIndex",gxe=["collectionGroup","readTime","prefixPath","documentId"],Xp="remoteDocumentGlobal",bT="remoteDocumentGlobalKey",Jh="targets",f8="queryTargetsIndex",yxe=["canonicalId","targetId"],Qh="targetDocuments",xxe=["targetId","path"],wP="documentTargetsIndex",vxe=["path","targetId"],kw="targetGlobalKey",Lu="targetGlobal",Zp="collectionParents",wxe=["collectionId","parent"],Xh="clientMetadata",bxe="clientId",Eb="bundles",_xe="bundleId",Tb="namedQueries",Sxe="name",bP="indexConfiguration",Cxe="indexId",_T="collectionGroupIndex",Exe="collectionGroup",ip="indexState",Txe=["indexId","uid"],m8="sequenceNumberIndex",Ixe=["uid","sequenceNumber"],op="indexEntries",Nxe=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],p8="documentKeyIndex",Pxe=["indexId","uid","orderedDocumentKey"],Ib="documentOverlays",Axe=["userId","collectionPath","documentId"],ST="collectionPathOverlayIndex",kxe=["userId","collectionPath","largestBatchId"],g8="collectionGroupOverlayIndex",jxe=["userId","collectionGroup","largestBatchId"],_P="globals",Rxe="name",y8=[Qp,No,Yh,uu,Jh,Yg,Lu,Qh,Xh,Xp,Zp,Eb,Tb],Dxe=[...y8,Ib],x8=[Qp,No,Yh,Aw,Jh,Yg,Lu,Qh,Xh,Xp,Zp,Eb,Tb,Ib],v8=x8,SP=[...v8,bP,ip,op],Mxe=SP,w8=[...SP,_P],Lxe=w8;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT extends c8{constructor(e,n){super(),this.he=e,this.currentSequenceNumber=n}}function Xr(t,e){const n=Xt(t);return hc.N(n.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function qc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function b8(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e,n){this.comparator=e,this.root=n||ps.EMPTY}insert(e,n){return new lr(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ps.BLACK,null,null))}remove(e){return new lr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ps.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cx(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cx(this.root,e,this.comparator,!1)}getReverseIterator(){return new cx(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cx(this.root,e,this.comparator,!0)}}class cx{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ps{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ps.RED,this.left=s??ps.EMPTY,this.right=i??ps.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ps(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ps.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ps.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ps.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ps.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _t(43730,{key:this.key,value:this.value});if(this.right.isRed())throw _t(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw _t(27949);return e+(this.isRed()?0:1)}}ps.EMPTY=null,ps.RED=!0,ps.BLACK=!1;ps.EMPTY=new class{constructor(){this.size=0}get key(){throw _t(57766)}get value(){throw _t(16141)}get color(){throw _t(16727)}get left(){throw _t(29726)}get right(){throw _t(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new ps(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.comparator=e,this.data=new lr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new r4(this.data.getIterator())}getIteratorFrom(e){return new r4(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof jn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new jn(this.comparator);return n.data=e,n}}class r4{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Rd(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e){this.fields=e,e.sort(mr.comparator)}static empty(){return new fi([])}unionWith(e){let n=new jn(mr.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new fi(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Kh(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _8 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new _8("Invalid base64 string: "+i):i}}(e);return new zr(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new zr(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Wt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zr.EMPTY_BYTE_STRING=new zr("");const Fxe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function al(t){if(Nt(!!t,39018),typeof t=="string"){let e=0;const n=Fxe.exec(t);if(Nt(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:sr(t.seconds),nanos:sr(t.nanos)}}function sr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ll(t){return typeof t=="string"?zr.fromBase64String(t):zr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S8="server_timestamp",C8="__type__",E8="__previous_value__",T8="__local_write_time__";function CP(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[C8])===null||n===void 0?void 0:n.stringValue)===S8}function Nb(t){const e=t.mapValue.fields[E8];return CP(e)?Nb(e):e}function eg(t){const e=al(t.mapValue.fields[T8].timestampValue);return new gr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oxe{constructor(e,n,r,s,i,o,l,c,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=d}}const jw="(default)";class Zu{constructor(e,n){this.projectId=e,this.database=n||jw}static empty(){return new Zu("","")}get isDefaultDatabase(){return this.database===jw}isEqual(e){return e instanceof Zu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EP="__type__",I8="__max__",Jl={mapValue:{fields:{__type__:{stringValue:I8}}}},TP="__vector__",Zh="value",uv={nullValue:"NULL_VALUE"};function Ec(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?CP(t)?4:N8(t)?9007199254740991:Pb(t)?10:11:_t(28295,{value:t})}function wa(t,e){if(t===e)return!0;const n=Ec(t);if(n!==Ec(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return eg(t).isEqual(eg(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=al(s.timestampValue),l=al(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ll(s.bytesValue).isEqual(ll(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return sr(s.geoPointValue.latitude)===sr(i.geoPointValue.latitude)&&sr(s.geoPointValue.longitude)===sr(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return sr(s.integerValue)===sr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=sr(s.doubleValue),l=sr(i.doubleValue);return o===l?Jp(o)===Jp(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Kh(t.arrayValue.values||[],e.arrayValue.values||[],wa);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(n4(o)!==n4(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!wa(o[c],l[c])))return!1;return!0}(t,e);default:return _t(52216,{left:t})}}function tg(t,e){return(t.values||[]).find(n=>wa(n,e))!==void 0}function Tc(t,e){if(t===e)return 0;const n=Ec(t),r=Ec(e);if(n!==r)return Wt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Wt(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=sr(i.integerValue||i.doubleValue),c=sr(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return s4(t.timestampValue,e.timestampValue);case 4:return s4(eg(t),eg(e));case 5:return vT(t.stringValue,e.stringValue);case 6:return function(i,o){const l=ll(i),c=ll(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Wt(l[u],c[u]);if(d!==0)return d}return Wt(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Wt(sr(i.latitude),sr(o.latitude));return l!==0?l:Wt(sr(i.longitude),sr(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return i4(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const h=i.fields||{},f=o.fields||{},m=(l=h[Zh])===null||l===void 0?void 0:l.arrayValue,g=(c=f[Zh])===null||c===void 0?void 0:c.arrayValue,x=Wt(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((d=g==null?void 0:g.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:i4(m,g)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Jl.mapValue&&o===Jl.mapValue)return 0;if(i===Jl.mapValue)return 1;if(o===Jl.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){const f=vT(c[h],d[h]);if(f!==0)return f;const m=Tc(l[c[h]],u[d[h]]);if(m!==0)return m}return Wt(c.length,d.length)}(t.mapValue,e.mapValue);default:throw _t(23264,{Pe:n})}}function s4(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Wt(t,e);const n=al(t),r=al(e),s=Wt(n.seconds,r.seconds);return s!==0?s:Wt(n.nanos,r.nanos)}function i4(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Tc(n[s],r[s]);if(i)return i}return Wt(n.length,r.length)}function ef(t){return ET(t)}function ET(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=al(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ll(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return dt.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=ET(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${ET(n.fields[o])}`;return s+"}"}(t.mapValue):_t(61005,{value:t})}function dv(t){switch(Ec(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Nb(t);return e?16+dv(e):16;case 5:return 2*t.stringValue.length;case 6:return ll(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+dv(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return qc(r.fields,(i,o)=>{s+=i.length+dv(o)}),s}(t.mapValue);default:throw _t(13486,{value:t})}}function ng(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function TT(t){return!!t&&"integerValue"in t}function rg(t){return!!t&&"arrayValue"in t}function o4(t){return!!t&&"nullValue"in t}function a4(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function hv(t){return!!t&&"mapValue"in t}function Pb(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[EP])===null||n===void 0?void 0:n.stringValue)===TP}function ap(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return qc(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ap(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ap(t.arrayValue.values[n]);return e}return Object.assign({},t)}function N8(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===I8}const P8={mapValue:{fields:{[EP]:{stringValue:TP},[Zh]:{arrayValue:{}}}}};function $xe(t){return"nullValue"in t?uv:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ng(Zu.empty(),dt.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Pb(t)?P8:{mapValue:{}}:_t(35942,{value:t})}function Vxe(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ng(Zu.empty(),dt.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?P8:"mapValue"in t?Pb(t)?{mapValue:{}}:Jl:_t(61959,{value:t})}function l4(t,e){const n=Tc(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function c4(t,e){const n=Tc(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e){this.value=e}static empty(){return new Rs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!hv(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ap(n)}setAll(e){let n=mr.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=ap(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());hv(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return wa(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];hv(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){qc(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Rs(ap(this.value))}}function A8(t){const e=[];return qc(t.fields,(n,r)=>{const s=new mr([n]);if(hv(r)){const i=A8(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new fi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tr(e,0,jt.min(),jt.min(),jt.min(),Rs.empty(),0)}static newFoundDocument(e,n,r,s){return new Tr(e,1,n,jt.min(),r,s,0)}static newNoDocument(e,n){return new Tr(e,2,n,jt.min(),jt.min(),Rs.empty(),0)}static newUnknownDocument(e,n){return new Tr(e,3,n,jt.min(),jt.min(),Rs.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(jt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=jt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,n){this.position=e,this.inclusive=n}}function u4(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=dt.comparator(dt.fromName(o.referenceValue),n.key):r=Tc(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function d4(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!wa(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rw{constructor(e,n="asc"){this.field=e,this.dir=n}}function Uxe(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k8{}class hn extends k8{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Bxe(e,n,r):n==="array-contains"?new Wxe(e,r):n==="in"?new F8(e,r):n==="not-in"?new Hxe(e,r):n==="array-contains-any"?new qxe(e,r):new hn(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new zxe(e,r):new Gxe(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Tc(n,this.value)):n!==null&&Ec(this.value)===Ec(n)&&this.matchesComparison(Tc(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _t(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class An extends k8{constructor(e,n){super(),this.filters=e,this.op=n,this.Te=null}static create(e,n){return new An(e,n)}matches(e){return nf(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function nf(t){return t.op==="and"}function IT(t){return t.op==="or"}function IP(t){return j8(t)&&nf(t)}function j8(t){for(const e of t.filters)if(e instanceof An)return!1;return!0}function NT(t){if(t instanceof hn)return t.field.canonicalString()+t.op.toString()+ef(t.value);if(IP(t))return t.filters.map(e=>NT(e)).join(",");{const e=t.filters.map(n=>NT(n)).join(",");return`${t.op}(${e})`}}function R8(t,e){return t instanceof hn?function(r,s){return s instanceof hn&&r.op===s.op&&r.field.isEqual(s.field)&&wa(r.value,s.value)}(t,e):t instanceof An?function(r,s){return s instanceof An&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&R8(o,s.filters[l]),!0):!1}(t,e):void _t(19439)}function D8(t,e){const n=t.filters.concat(e);return An.create(n,t.op)}function M8(t){return t instanceof hn?function(n){return`${n.field.canonicalString()} ${n.op} ${ef(n.value)}`}(t):t instanceof An?function(n){return n.op.toString()+" {"+n.getFilters().map(M8).join(" ,")+"}"}(t):"Filter"}class Bxe extends hn{constructor(e,n,r){super(e,n,r),this.key=dt.fromName(r.referenceValue)}matches(e){const n=dt.comparator(e.key,this.key);return this.matchesComparison(n)}}class zxe extends hn{constructor(e,n){super(e,"in",n),this.keys=L8("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Gxe extends hn{constructor(e,n){super(e,"not-in",n),this.keys=L8("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function L8(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>dt.fromName(r.referenceValue))}class Wxe extends hn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return rg(n)&&tg(n.arrayValue,this.value)}}class F8 extends hn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&tg(this.value.arrayValue,n)}}class Hxe extends hn{constructor(e,n){super(e,"not-in",n)}matches(e){if(tg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!tg(this.value.arrayValue,n)}}class qxe extends hn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!rg(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>tg(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kxe{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Ie=null}}function PT(t,e=null,n=[],r=[],s=null,i=null,o=null){return new Kxe(t,e,n,r,s,i,o)}function ed(t){const e=Xt(t);if(e.Ie===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>NT(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Cb(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ef(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ef(r)).join(",")),e.Ie=n}return e.Ie}function Jg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Uxe(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!R8(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!d4(t.startAt,e.startAt)&&d4(t.endAt,e.endAt)}function Dw(t){return dt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Mw(t,e){return t.filters.filter(n=>n instanceof hn&&n.field.isEqual(e))}function h4(t,e,n){let r=uv,s=!0;for(const i of Mw(t,e)){let o=uv,l=!0;switch(i.op){case"<":case"<=":o=$xe(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=uv}l4({value:r,inclusive:s},{value:o,inclusive:l})<0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];l4({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function f4(t,e,n){let r=Jl,s=!0;for(const i of Mw(t,e)){let o=Jl,l=!0;switch(i.op){case">=":case">":o=Vxe(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=Jl}c4({value:r,inclusive:s},{value:o,inclusive:l})>0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];c4({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function Yxe(t,e,n,r,s,i,o,l){return new Qg(t,e,n,r,s,i,o,l)}function Xg(t){return new Qg(t)}function m4(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function O8(t){return t.collectionGroup!==null}function lp(t){const e=Xt(t);if(e.Ee===null){e.Ee=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ee.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new jn(mr.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ee.push(new Rw(i,r))}),n.has(mr.keyField().canonicalString())||e.Ee.push(new Rw(mr.keyField(),r))}return e.Ee}function ho(t){const e=Xt(t);return e.de||(e.de=Jxe(e,lp(t))),e.de}function Jxe(t,e){if(t.limitType==="F")return PT(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Rw(s.field,i)});const n=t.endAt?new tf(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new tf(t.startAt.position,t.startAt.inclusive):null;return PT(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function AT(t,e){const n=t.filters.concat([e]);return new Qg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Lw(t,e,n){return new Qg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ab(t,e){return Jg(ho(t),ho(e))&&t.limitType===e.limitType}function $8(t){return`${ed(ho(t))}|lt:${t.limitType}`}function Wd(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>M8(s)).join(", ")}]`),Cb(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ef(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ef(s)).join(",")),`Target(${r})`}(ho(t))}; limitType=${t.limitType})`}function Zg(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):dt.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of lp(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=u4(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,lp(r),s)||r.endAt&&!function(o,l,c){const u=u4(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,lp(r),s))}(t,e)}function Qxe(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function V8(t){return(e,n)=>{let r=!1;for(const s of lp(t)){const i=Xxe(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function Xxe(t,e,n){const r=t.field.isKeyField()?dt.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Tc(c,u):_t(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return _t(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){qc(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return b8(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zxe=new lr(dt.comparator);function $i(){return Zxe}const U8=new lr(dt.comparator);function Pm(...t){let e=U8;for(const n of t)e=e.insert(n.key,n);return e}function B8(t){let e=U8;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function aa(){return cp()}function z8(){return cp()}function cp(){return new xl(t=>t.toString(),(t,e)=>t.isEqual(e))}const eve=new lr(dt.comparator),tve=new jn(dt.comparator);function on(...t){let e=tve;for(const n of t)e=e.add(n);return e}const nve=new jn(Wt);function rve(){return nve}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NP(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Jp(e)?"-0":e}}function G8(t){return{integerValue:""+t}}function sve(t,e){return uxe(e)?G8(e):NP(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(){this._=void 0}}function ive(t,e,n){return t instanceof sg?function(s,i){const o={fields:{[C8]:{stringValue:S8},[T8]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&CP(i)&&(i=Nb(i)),i&&(o.fields[E8]=i),{mapValue:o}}(n,e):t instanceof rf?H8(t,e):t instanceof sf?q8(t,e):function(s,i){const o=W8(s,i),l=p4(o)+p4(s.Re);return TT(o)&&TT(s.Re)?G8(l):NP(s.serializer,l)}(t,e)}function ove(t,e,n){return t instanceof rf?H8(t,e):t instanceof sf?q8(t,e):n}function W8(t,e){return t instanceof ig?function(r){return TT(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class sg extends kb{}class rf extends kb{constructor(e){super(),this.elements=e}}function H8(t,e){const n=K8(e);for(const r of t.elements)n.some(s=>wa(s,r))||n.push(r);return{arrayValue:{values:n}}}class sf extends kb{constructor(e){super(),this.elements=e}}function q8(t,e){let n=K8(e);for(const r of t.elements)n=n.filter(s=>!wa(s,r));return{arrayValue:{values:n}}}class ig extends kb{constructor(e,n){super(),this.serializer=e,this.Re=n}}function p4(t){return sr(t.integerValue||t.doubleValue)}function K8(t){return rg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ave{constructor(e,n){this.field=e,this.transform=n}}function lve(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof rf&&s instanceof rf||r instanceof sf&&s instanceof sf?Kh(r.elements,s.elements,wa):r instanceof ig&&s instanceof ig?wa(r.Re,s.Re):r instanceof sg&&s instanceof sg}(t.transform,e.transform)}class cve{constructor(e,n){this.version=e,this.transformResults=n}}class Js{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Js}static exists(e){return new Js(void 0,e)}static updateTime(e){return new Js(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function fv(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class jb{}function Y8(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Rb(t.key,Js.none()):new If(t.key,t.data,Js.none());{const n=t.data,r=Rs.empty();let s=new jn(mr.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new vl(t.key,r,new fi(s.toArray()),Js.none())}}function uve(t,e,n){t instanceof If?function(s,i,o){const l=s.value.clone(),c=y4(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof vl?function(s,i,o){if(!fv(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=y4(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(J8(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function up(t,e,n,r){return t instanceof If?function(i,o,l,c){if(!fv(i.precondition,o))return l;const u=i.value.clone(),d=x4(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof vl?function(i,o,l,c){if(!fv(i.precondition,o))return l;const u=x4(i.fieldTransforms,c,o),d=o.data;return d.setAll(J8(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,o,l){return fv(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function dve(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=W8(r.transform,s||null);i!=null&&(n===null&&(n=Rs.empty()),n.set(r.field,i))}return n||null}function g4(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Kh(r,s,(i,o)=>lve(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class If extends jb{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class vl extends jb{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function J8(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function y4(t,e,n){const r=new Map;Nt(t.length===n.length,32656,{Ve:n.length,me:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,ove(o,l,n[s]))}return r}function x4(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,ive(i,o,e))}return r}class Rb extends jb{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Q8 extends jb{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&uve(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=up(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=up(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=z8();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=Y8(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(jt.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),on())}isEqual(e){return this.batchId===e.batchId&&Kh(this.mutations,e.mutations,(n,r)=>g4(n,r))&&Kh(this.baseMutations,e.baseMutations,(n,r)=>g4(n,r))}}class AP{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Nt(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let s=function(){return eve}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new AP(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hve{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mr,pn;function fve(t){switch(t){case Fe.OK:return _t(64938);case Fe.CANCELLED:case Fe.UNKNOWN:case Fe.DEADLINE_EXCEEDED:case Fe.RESOURCE_EXHAUSTED:case Fe.INTERNAL:case Fe.UNAVAILABLE:case Fe.UNAUTHENTICATED:return!1;case Fe.INVALID_ARGUMENT:case Fe.NOT_FOUND:case Fe.ALREADY_EXISTS:case Fe.PERMISSION_DENIED:case Fe.FAILED_PRECONDITION:case Fe.ABORTED:case Fe.OUT_OF_RANGE:case Fe.UNIMPLEMENTED:case Fe.DATA_LOSS:return!0;default:return _t(15467,{code:t})}}function X8(t){if(t===void 0)return Ks("GRPC error has no .code"),Fe.UNKNOWN;switch(t){case Mr.OK:return Fe.OK;case Mr.CANCELLED:return Fe.CANCELLED;case Mr.UNKNOWN:return Fe.UNKNOWN;case Mr.DEADLINE_EXCEEDED:return Fe.DEADLINE_EXCEEDED;case Mr.RESOURCE_EXHAUSTED:return Fe.RESOURCE_EXHAUSTED;case Mr.INTERNAL:return Fe.INTERNAL;case Mr.UNAVAILABLE:return Fe.UNAVAILABLE;case Mr.UNAUTHENTICATED:return Fe.UNAUTHENTICATED;case Mr.INVALID_ARGUMENT:return Fe.INVALID_ARGUMENT;case Mr.NOT_FOUND:return Fe.NOT_FOUND;case Mr.ALREADY_EXISTS:return Fe.ALREADY_EXISTS;case Mr.PERMISSION_DENIED:return Fe.PERMISSION_DENIED;case Mr.FAILED_PRECONDITION:return Fe.FAILED_PRECONDITION;case Mr.ABORTED:return Fe.ABORTED;case Mr.OUT_OF_RANGE:return Fe.OUT_OF_RANGE;case Mr.UNIMPLEMENTED:return Fe.UNIMPLEMENTED;case Mr.DATA_LOSS:return Fe.DATA_LOSS;default:return _t(39323,{code:t})}}(pn=Mr||(Mr={}))[pn.OK=0]="OK",pn[pn.CANCELLED=1]="CANCELLED",pn[pn.UNKNOWN=2]="UNKNOWN",pn[pn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pn[pn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pn[pn.NOT_FOUND=5]="NOT_FOUND",pn[pn.ALREADY_EXISTS=6]="ALREADY_EXISTS",pn[pn.PERMISSION_DENIED=7]="PERMISSION_DENIED",pn[pn.UNAUTHENTICATED=16]="UNAUTHENTICATED",pn[pn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pn[pn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pn[pn.ABORTED=10]="ABORTED",pn[pn.OUT_OF_RANGE=11]="OUT_OF_RANGE",pn[pn.UNIMPLEMENTED=12]="UNIMPLEMENTED",pn[pn.INTERNAL=13]="INTERNAL",pn[pn.UNAVAILABLE=14]="UNAVAILABLE",pn[pn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mve=new dc([4294967295,4294967295],0);function v4(t){const e=s8().encode(t),n=new Jz;return n.update(e),new Uint8Array(n.digest())}function w4(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new dc([n,r],0),new dc([s,i],0)]}class jP{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Am(`Invalid padding: ${n}`);if(r<0)throw new Am(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Am(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Am(`Invalid padding when bitmap length is 0: ${n}`);this.pe=8*e.length-n,this.ye=dc.fromNumber(this.pe)}we(e,n,r){let s=e.add(n.multiply(dc.fromNumber(r)));return s.compare(mve)===1&&(s=new dc([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}Se(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const n=v4(e),[r,s]=w4(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);if(!this.Se(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new jP(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.pe===0)return;const n=v4(e),[r,s]=w4(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Am extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,ey.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Db(jt.min(),s,new lr(Wt),$i(),on())}}class ey{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ey(r,n,on(),on(),on())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e,n,r,s){this.De=e,this.removedTargetIds=n,this.key=r,this.ve=s}}class Z8{constructor(e,n){this.targetId=e,this.Ce=n}}class e9{constructor(e,n,r=zr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class b4{constructor(){this.Fe=0,this.Me=_4(),this.xe=zr.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=on(),n=on(),r=on();return this.Me.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:_t(38017,{changeType:i})}}),new ey(this.xe,this.Oe,e,n,r)}Qe(){this.Ne=!1,this.Me=_4()}$e(e,n){this.Ne=!0,this.Me=this.Me.insert(e,n)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Nt(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class pve{constructor(e){this.ze=e,this.je=new Map,this.He=$i(),this.Je=ux(),this.Ye=ux(),this.Ze=new lr(Wt)}Xe(e){for(const n of e.De)e.ve&&e.ve.isFoundDocument()?this.et(n,e.ve):this.tt(n,e.key,e.ve);for(const n of e.removedTargetIds)this.tt(n,e.key,e.ve)}nt(e){this.forEachTarget(e,n=>{const r=this.rt(n);switch(e.state){case 0:this.it(n)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(n);break;case 3:this.it(n)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(n)&&(this.st(n),r.ke(e.resumeToken));break;default:_t(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.je.forEach((r,s)=>{this.it(s)&&n(s)})}ot(e){const n=e.targetId,r=e.Ce.count,s=this._t(n);if(s){const i=s.target;if(Dw(i))if(r===0){const o=new dt(i.path);this.tt(n,o,Tr.newNoDocument(o,jt.min()))}else Nt(r===1,20013,{expectedCount:r});else{const o=this.ut(n);if(o!==r){const l=this.ct(e),c=l?this.lt(l,e,o):1;if(c!==0){this.st(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,u)}}}}}ct(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=ll(r).toUint8Array()}catch(c){if(c instanceof _8)return Xu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new jP(o,s,i)}catch(c){return Xu(c instanceof Am?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.pe===0?null:l}lt(e,n,r){return n.Ce.count===r-this.Tt(e,n.targetId)?0:2}Tt(e,n){const r=this.ze.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.ze.Pt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.tt(n,i,null),s++)}),s}It(e){const n=new Map;this.je.forEach((i,o)=>{const l=this._t(o);if(l){if(i.current&&Dw(l.target)){const c=new dt(l.target.path);this.Et(c).has(o)||this.dt(o,c)||this.tt(o,c,Tr.newNoDocument(c,e))}i.Le&&(n.set(o,i.qe()),i.Qe())}});let r=on();this.Ye.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this._t(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.He.forEach((i,o)=>o.setReadTime(e));const s=new Db(e,n,this.Ze,this.He,r);return this.He=$i(),this.Je=ux(),this.Ye=ux(),this.Ze=new lr(Wt),s}et(e,n){if(!this.it(e))return;const r=this.dt(e,n.key)?2:0;this.rt(e).$e(n.key,r),this.He=this.He.insert(n.key,n),this.Je=this.Je.insert(n.key,this.Et(n.key).add(e)),this.Ye=this.Ye.insert(n.key,this.At(n.key).add(e))}tt(e,n,r){if(!this.it(e))return;const s=this.rt(e);this.dt(e,n)?s.$e(n,1):s.Ue(n),this.Ye=this.Ye.insert(n,this.At(n).delete(e)),this.Ye=this.Ye.insert(n,this.At(n).add(e)),r&&(this.He=this.He.insert(n,r))}removeTarget(e){this.je.delete(e)}ut(e){const n=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let n=this.je.get(e);return n||(n=new b4,this.je.set(e,n)),n}At(e){let n=this.Ye.get(e);return n||(n=new jn(Wt),this.Ye=this.Ye.insert(e,n)),n}Et(e){let n=this.Je.get(e);return n||(n=new jn(Wt),this.Je=this.Je.insert(e,n)),n}it(e){const n=this._t(e)!==null;return n||Xe("WatchChangeAggregator","Detected inactive target",e),n}_t(e){const n=this.je.get(e);return n&&n.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new b4),this.ze.getRemoteKeysForTarget(e).forEach(n=>{this.tt(e,n,null)})}dt(e,n){return this.ze.getRemoteKeysForTarget(e).has(n)}}function ux(){return new lr(dt.comparator)}function _4(){return new lr(dt.comparator)}const gve=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),yve=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),xve=(()=>({and:"AND",or:"OR"}))();class vve{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function kT(t,e){return t.useProto3Json||Cb(e)?e:{value:e}}function of(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function t9(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function wve(t,e){return of(t,e.toTimestamp())}function Xs(t){return Nt(!!t,49232),jt.fromTimestamp(function(n){const r=al(n);return new gr(r.seconds,r.nanos)}(t))}function RP(t,e){return jT(t,e).canonicalString()}function jT(t,e){const n=function(s){return new Tn(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function n9(t){const e=Tn.fromString(t);return Nt(d9(e),10190,{key:e.toString()}),e}function Fw(t,e){return RP(t.databaseId,e.path)}function Fu(t,e){const n=n9(e);if(n.get(1)!==t.databaseId.projectId)throw new ut(Fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ut(Fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new dt(i9(n))}function r9(t,e){return RP(t.databaseId,e)}function s9(t){const e=n9(t);return e.length===4?Tn.emptyPath():i9(e)}function RT(t){return new Tn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function i9(t){return Nt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function S4(t,e,n){return{name:Fw(t,e),fields:n.value.mapValue.fields}}function bve(t,e,n){const r=Fu(t,e.name),s=Xs(e.updateTime),i=e.createTime?Xs(e.createTime):jt.min(),o=new Rs({mapValue:{fields:e.fields}}),l=Tr.newFoundDocument(r,s,i,o);return n&&l.setHasCommittedMutations(),n?l.setHasCommittedMutations():l}function _ve(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:_t(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Nt(d===void 0||typeof d=="string",58123),zr.fromBase64String(d||"")):(Nt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),zr.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?Fe.UNKNOWN:X8(u.code);return new ut(d,u.message||"")}(o);n=new e9(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Fu(t,r.document.name),i=Xs(r.document.updateTime),o=r.document.createTime?Xs(r.document.createTime):jt.min(),l=new Rs({mapValue:{fields:r.document.fields}}),c=Tr.newFoundDocument(s,i,o,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new mv(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Fu(t,r.document),i=r.readTime?Xs(r.readTime):jt.min(),o=Tr.newNoDocument(s,i),l=r.removedTargetIds||[];n=new mv([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Fu(t,r.document),i=r.removedTargetIds||[];n=new mv([],i,s,null)}else{if(!("filter"in e))return _t(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new hve(s,i),l=r.targetId;n=new Z8(l,o)}}return n}function Ow(t,e){let n;if(e instanceof If)n={update:S4(t,e.key,e.value)};else if(e instanceof Rb)n={delete:Fw(t,e.key)};else if(e instanceof vl)n={update:S4(t,e.key,e.data),updateMask:Nve(e.fieldMask)};else{if(!(e instanceof Q8))return _t(16599,{ft:e.type});n={verify:Fw(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof sg)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof rf)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof sf)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ig)return{fieldPath:o.field.canonicalString(),increment:l.Re};throw _t(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:wve(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:_t(27497)}(t,e.precondition)),n}function DT(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Js.updateTime(Xs(i.updateTime)):i.exists!==void 0?Js.exists(i.exists):Js.none()}(e.currentDocument):Js.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,l){let c=null;if("setToServerValue"in l)Nt(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),c=new sg;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new rf(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new sf(d)}else"increment"in l?c=new ig(o,l.increment):_t(16584,{proto:l});const u=mr.fromServerFormat(l.fieldPath);return new ave(u,c)}(t,s)):[];if(e.update){e.update.name;const s=Fu(t,e.update.name),i=new Rs({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new fi(u.map(d=>mr.fromServerFormat(d)))}(e.updateMask);return new vl(s,i,o,n,r)}return new If(s,i,n,r)}if(e.delete){const s=Fu(t,e.delete);return new Rb(s,n)}if(e.verify){const s=Fu(t,e.verify);return new Q8(s,n)}return _t(1463,{proto:e})}function Sve(t,e){return t&&t.length>0?(Nt(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Xs(s.updateTime):Xs(i);return o.isEqual(jt.min())&&(o=Xs(i)),new cve(o,s.transformResults||[])}(n,e))):[]}function o9(t,e){return{documents:[r9(t,e.path)]}}function a9(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=r9(t,s);const i=function(u){if(u.length!==0)return u9(An.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(f){return{field:Hd(f.field),direction:Eve(f.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=kT(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{gt:n,parent:s}}function l9(t){let e=s9(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Nt(r===1,65062);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(h){const f=c9(h);return f instanceof An&&IP(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(g){return new Rw(qd(g.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(f))}(n.orderBy));let l=null;n.limit&&(l=function(h){let f;return f=typeof h=="object"?h.value:h,Cb(f)?null:f}(n.limit));let c=null;n.startAt&&(c=function(h){const f=!!h.before,m=h.values||[];return new tf(m,f)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const f=!h.before,m=h.values||[];return new tf(m,f)}(n.endAt)),Yxe(e,s,o,i,l,"F",c,u)}function Cve(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _t(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function c9(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=qd(n.unaryFilter.field);return hn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=qd(n.unaryFilter.field);return hn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=qd(n.unaryFilter.field);return hn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=qd(n.unaryFilter.field);return hn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return _t(61313);default:return _t(60726)}}(t):t.fieldFilter!==void 0?function(n){return hn.create(qd(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return _t(58110);default:return _t(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return An.create(n.compositeFilter.filters.map(r=>c9(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return _t(1026)}}(n.compositeFilter.op))}(t):_t(30097,{filter:t})}function Eve(t){return gve[t]}function Tve(t){return yve[t]}function Ive(t){return xve[t]}function Hd(t){return{fieldPath:t.canonicalString()}}function qd(t){return mr.fromServerFormat(t.fieldPath)}function u9(t){return t instanceof hn?function(n){if(n.op==="=="){if(a4(n.value))return{unaryFilter:{field:Hd(n.field),op:"IS_NAN"}};if(o4(n.value))return{unaryFilter:{field:Hd(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(a4(n.value))return{unaryFilter:{field:Hd(n.field),op:"IS_NOT_NAN"}};if(o4(n.value))return{unaryFilter:{field:Hd(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hd(n.field),op:Tve(n.op),value:n.value}}}(t):t instanceof An?function(n){const r=n.getFilters().map(s=>u9(s));return r.length===1?r[0]:{compositeFilter:{op:Ive(n.op),filters:r}}}(t):_t(54877,{filter:t})}function Nve(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function d9(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e,n,r,s,i=jt.min(),o=jt.min(),l=zr.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Wa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Wa(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h9{constructor(e){this.wt=e}}function Pve(t,e){let n;if(e.document)n=bve(t.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=dt.fromSegments(e.noDocument.path),s=nd(e.noDocument.readTime);n=Tr.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return _t(56709);{const r=dt.fromSegments(e.unknownDocument.path),s=nd(e.unknownDocument.version);n=Tr.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new gr(s[0],s[1]);return jt.fromTimestamp(i)}(e.readTime)),n}function C4(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:$w(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Fw(i,o.key),fields:o.data.value.mapValue.fields,updateTime:of(i,o.version.toTimestamp()),createTime:of(i,o.createTime.toTimestamp())}}(t.wt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:td(e.version)};else{if(!e.isUnknownDocument())return _t(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:td(e.version)}}return r}function $w(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function td(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function nd(t){const e=new gr(t.seconds,t.nanoseconds);return jt.fromTimestamp(e)}function pu(t,e){const n=(e.baseMutations||[]).map(i=>DT(t.wt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>DT(t.wt,i)),s=gr.fromMillis(e.localWriteTimeMs);return new PP(e.batchId,s,n,r)}function km(t){const e=nd(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?nd(t.lastLimboFreeSnapshotVersion):jt.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return Nt(o===1,1966,{count:o}),ho(Xg(s9(i.documents[0])))}(t.query):function(i){return ho(l9(i))}(t.query),new Wa(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,zr.fromBase64String(t.resumeToken))}function f9(t,e){const n=td(e.snapshotVersion),r=td(e.lastLimboFreeSnapshotVersion);let s;s=Dw(e.target)?o9(t.wt,e.target):a9(t.wt,e.target).gt;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ed(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function m9(t){const e=l9({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Lw(e,e.limit,"L"):e}function OS(t,e){return new kP(e.largestBatchId,DT(t.wt,e.overlayMutation))}function E4(t,e){const n=e.path.lastSegment();return[t,Ds(e.path.popLast()),n]}function T4(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:td(r.readTime),documentKey:Ds(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ave{getBundleMetadata(e,n){return I4(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:nd(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return I4(e).put(function(s){return{bundleId:s.id,createTime:td(Xs(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return N4(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:m9(i.bundledQuery),readTime:nd(i.readTime)}}(r)})}saveNamedQuery(e,n){return N4(e).put(function(s){return{name:s.name,readTime:td(Xs(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function I4(t){return Xr(t,Eb)}function N4(t){return Xr(t,Tb)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e,n){this.serializer=e,this.userId=n}static St(e,n){const r=n.uid||"";return new Mb(e,r)}getOverlay(e,n){return nm(e).get(E4(this.userId,n)).next(r=>r?OS(this.serializer,r):null)}getOverlays(e,n){const r=aa();return ye.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const l=new kP(n,o);s.push(this.bt(e,l))}),ye.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Ds(o.getCollectionPath())));const i=[];return s.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(nm(e).X(ST,l))}),ye.waitFor(i)}getOverlaysForCollection(e,n,r){const s=aa(),i=Ds(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return nm(e).J(ST,o).next(l=>{for(const c of l){const u=OS(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=aa();let o;const l=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return nm(e).te({index:g8,range:l},(c,u,d)=>{const h=OS(this.serializer,u);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>i)}bt(e,n){return nm(e).put(function(s,i,o){const[l,c,u]=E4(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ow(s.wt,o.mutation)}}(this.serializer,this.userId,n))}}function nm(t){return Xr(t,Ib)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kve{Dt(e){return Xr(e,_P)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?zr.fromUint8Array(r):zr.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Dt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(){}vt(e,n){this.Ct(e,n),n.Ft()}Ct(e,n){if("nullValue"in e)this.Mt(n,5);else if("booleanValue"in e)this.Mt(n,10),n.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(n,15),n.xt(sr(e.integerValue));else if("doubleValue"in e){const r=sr(e.doubleValue);isNaN(r)?this.Mt(n,13):(this.Mt(n,15),Jp(r)?n.xt(0):n.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(n,20),typeof r=="string"&&(r=al(r)),n.Ot(`${r.seconds||""}`),n.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,n),this.Bt(n);else if("bytesValue"in e)this.Mt(n,30),n.Lt(ll(e.bytesValue)),this.Bt(n);else if("referenceValue"in e)this.kt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Mt(n,45),n.xt(r.latitude||0),n.xt(r.longitude||0)}else"mapValue"in e?N8(e)?this.Mt(n,Number.MAX_SAFE_INTEGER):Pb(e)?this.qt(e.mapValue,n):(this.Qt(e.mapValue,n),this.Bt(n)):"arrayValue"in e?(this.$t(e.arrayValue,n),this.Bt(n)):_t(19022,{Ut:e})}Nt(e,n){this.Mt(n,25),this.Kt(e,n)}Kt(e,n){n.Ot(e)}Qt(e,n){const r=e.fields||{};this.Mt(n,55);for(const s of Object.keys(r))this.Nt(s,n),this.Ct(r[s],n)}qt(e,n){var r,s;const i=e.fields||{};this.Mt(n,53);const o=Zh,l=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Mt(n,15),n.xt(sr(l)),this.Nt(o,n),this.Ct(i[o],n)}$t(e,n){const r=e.values||[];this.Mt(n,50);for(const s of r)this.Ct(s,n)}kt(e,n){this.Mt(n,37),dt.fromName(e).path.forEach(r=>{this.Mt(n,60),this.Kt(r,n)})}Mt(e,n){e.xt(n)}Bt(e){e.xt(2)}}gu.Wt=new gu;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dd=255;function jve(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function P4(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=jve(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class Rve{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.zt(r.value),r=n.next();this.jt()}Ht(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Yt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{const s=n.codePointAt(0);this.zt(240|s>>>18),this.zt(128|63&s>>>12),this.zt(128|63&s>>>6),this.zt(128|63&s)}}this.jt()}Xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Yt()}en(e){const n=this.tn(e),r=P4(n);this.nn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}rn(e){const n=this.tn(e),r=P4(n);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}sn(){this._n(Dd),this._n(255)}an(){this.un(Dd),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}zt(e){const n=255&e;n===0?(this._n(0),this._n(255)):n===Dd?(this._n(Dd),this._n(0)):this._n(n)}Jt(e){const n=255&e;n===0?(this.un(0),this.un(255)):n===Dd?(this.un(Dd),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class Dve{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class Mve{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class rm{constructor(){this.ln=new Rve,this.hn=new Dve(this.ln),this.Pn=new Mve(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(e,n,r,s){this.In=e,this.En=n,this.dn=r,this.An=s}Rn(){const e=this.An.length,n=e===0||this.An[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.An,0),n!==e?r.set([0],this.An.length):++r[r.length-1],new yu(this.In,this.En,this.dn,r)}Vn(e,n,r){return{indexId:this.In,uid:e,arrayValue:pv(this.dn),directionalValue:pv(this.An),orderedDocumentKey:pv(n),documentKey:r.path.toArray()}}mn(e,n,r){const s=this.Vn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Il(t,e){let n=t.In-e.In;return n!==0?n:(n=A4(t.dn,e.dn),n!==0?n:(n=A4(t.An,e.An),n!==0?n:dt.comparator(t.En,e.En)))}function A4(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function pv(t){return uz()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function k4(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class j4{constructor(e){this.fn=new jn((n,r)=>mr.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const n of e.filters){const r=n;r.isInequality()?this.fn=this.fn.add(r):this.pn.push(r)}}get yn(){return this.fn.size>1}wn(e){if(Nt(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const n=wT(e);if(n!==void 0&&!this.Sn(n))return!1;const r=cu(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.Sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.fn.size>0){const l=this.fn.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=r[i];if(!this.bn(l,c)||!this.Dn(this.gn[o++],c))return!1}++i}for(;i<r.length;++i){const l=r[i];if(o>=this.gn.length||!this.Dn(this.gn[o++],l))return!1}return!0}vn(){if(this.yn)return null;let e=new jn(mr.comparator);const n=[];for(const r of this.pn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new av(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new av(r.field,0))}for(const r of this.gn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new av(r.field,r.dir==="asc"?0:1)));return new Nw(Nw.UNKNOWN_ID,this.collectionId,n,Yp.empty())}Sn(e){for(const n of this.pn)if(this.bn(n,e))return!0;return!1}bn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}Dn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p9(t){var e,n;if(Nt(t instanceof hn||t instanceof An,20012),t instanceof hn){if(t instanceof F8){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>hn.create(t.field,"==",i)))||[];return An.create(s,"or")}return t}const r=t.filters.map(s=>p9(s));return An.create(r,t.op)}function Lve(t){if(t.getFilters().length===0)return[];const e=FT(p9(t));return Nt(g9(e),7391),MT(e)||LT(e)?[e]:e.getFilters()}function MT(t){return t instanceof hn}function LT(t){return t instanceof An&&IP(t)}function g9(t){return MT(t)||LT(t)||function(n){if(n instanceof An&&IT(n)){for(const r of n.getFilters())if(!MT(r)&&!LT(r))return!1;return!0}return!1}(t)}function FT(t){if(Nt(t instanceof hn||t instanceof An,34018),t instanceof hn)return t;if(t.filters.length===1)return FT(t.filters[0]);const e=t.filters.map(r=>FT(r));let n=An.create(e,t.op);return n=Vw(n),g9(n)?n:(Nt(n instanceof An,64498),Nt(nf(n),40251),Nt(n.filters.length>1,57927),n.filters.reduce((r,s)=>DP(r,s)))}function DP(t,e){let n;return Nt(t instanceof hn||t instanceof An,38388),Nt(e instanceof hn||e instanceof An,25473),n=t instanceof hn?e instanceof hn?function(s,i){return An.create([s,i],"and")}(t,e):R4(t,e):e instanceof hn?R4(e,t):function(s,i){if(Nt(s.filters.length>0&&i.filters.length>0,48005),nf(s)&&nf(i))return D8(s,i.getFilters());const o=IT(s)?s:i,l=IT(s)?i:s,c=o.filters.map(u=>DP(u,l));return An.create(c,"or")}(t,e),Vw(n)}function R4(t,e){if(nf(e))return D8(e,t.getFilters());{const n=e.filters.map(r=>DP(t,r));return An.create(n,"or")}}function Vw(t){if(Nt(t instanceof hn||t instanceof An,11850),t instanceof hn)return t;const e=t.getFilters();if(e.length===1)return Vw(e[0]);if(j8(t))return t;const n=e.map(s=>Vw(s)),r=[];return n.forEach(s=>{s instanceof hn?r.push(s):s instanceof An&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:An.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fve{constructor(){this.Cn=new MP}addToCollectionParentIndex(e,n){return this.Cn.add(n),ye.resolve()}getCollectionParents(e,n){return ye.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ye.resolve()}deleteFieldIndex(e,n){return ye.resolve()}deleteAllFieldIndexes(e){return ye.resolve()}createTargetIndexes(e,n){return ye.resolve()}getDocumentsMatchingTarget(e,n){return ye.resolve(null)}getIndexType(e,n){return ye.resolve(0)}getFieldIndexes(e,n){return ye.resolve([])}getNextCollectionGroupToUpdate(e){return ye.resolve(null)}getMinOffset(e,n){return ye.resolve(Ki.min())}getMinOffsetFromCollectionGroup(e,n){return ye.resolve(Ki.min())}updateCollectionGroup(e,n,r){return ye.resolve()}updateIndexEntries(e,n){return ye.resolve()}}class MP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new jn(Tn.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new jn(Tn.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4="IndexedDbIndexManager",dx=new Uint8Array(0);class Ove{constructor(e,n){this.databaseId=n,this.Fn=new MP,this.Mn=new xl(r=>ed(r),(r,s)=>Jg(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Fn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.Fn.add(n)});const i={collectionId:r,parent:Ds(s)};return M4(e).put(i)}return ye.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[o8(n),""],!1,!0);return M4(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(oa(o.parent))}return r})}addFieldIndex(e,n){const r=sm(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Ld(e);return i.next(l=>{o.put(T4(l,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=sm(e),s=Ld(e),i=Md(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=sm(e),r=Md(e),s=Ld(e);return n.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,n){return ye.forEach(this.xn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new j4(r).vn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Md(e);let s=!0;const i=new Map;return ye.forEach(this.xn(n),o=>this.On(e,o).next(l=>{s&&(s=!!l),i.set(o,l)})).next(()=>{if(s){let o=on();const l=[];return ye.forEach(i,(c,u)=>{Xe(D4,`Using index ${function(C){return`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map(T=>`${T.fieldPath}:${T.kind}`).join(",")}`}(c)} to execute ${ed(n)}`);const d=function(C,T){const j=wT(T);if(j===void 0)return null;for(const A of Mw(C,j.fieldPath))switch(A.op){case"array-contains-any":return A.value.arrayValue.values||[];case"array-contains":return[A.value]}return null}(u,c),h=function(C,T){const j=new Map;for(const A of cu(T))for(const E of Mw(C,A.fieldPath))switch(E.op){case"==":case"in":j.set(A.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return j.set(A.fieldPath.canonicalString(),E.value),Array.from(j.values())}return null}(u,c),f=function(C,T){const j=[];let A=!0;for(const E of cu(T)){const I=E.kind===0?h4(C,E.fieldPath,C.startAt):f4(C,E.fieldPath,C.startAt);j.push(I.value),A&&(A=I.inclusive)}return new tf(j,A)}(u,c),m=function(C,T){const j=[];let A=!0;for(const E of cu(T)){const I=E.kind===0?f4(C,E.fieldPath,C.endAt):h4(C,E.fieldPath,C.endAt);j.push(I.value),A&&(A=I.inclusive)}return new tf(j,A)}(u,c),g=this.Nn(c,u,f),x=this.Nn(c,u,m),v=this.Bn(c,u,h),w=this.Ln(c.indexId,d,g,f.inclusive,x,m.inclusive,v);return ye.forEach(w,_=>r.Z(_,n.limit).next(C=>{C.forEach(T=>{const j=dt.fromSegments(T.documentKey);o.has(j)||(o=o.add(j),l.push(j))})}))}).next(()=>l)}return ye.resolve(null)})}xn(e){let n=this.Mn.get(e);return n||(e.filters.length===0?n=[e]:n=Lve(An.create(e.filters,"and")).map(r=>PT(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,n),n)}Ln(e,n,r,s,i,o,l){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),u=c/(n!=null?n.length:1),d=[];for(let h=0;h<c;++h){const f=n?this.kn(n[h/u]):dx,m=this.qn(e,f,r[h%u],s),g=this.Qn(e,f,i[h%u],o),x=l.map(v=>this.qn(e,f,v,!0));d.push(...this.createRange(m,g,x))}return d}qn(e,n,r,s){const i=new yu(e,dt.empty(),n,r);return s?i:i.Rn()}Qn(e,n,r,s){const i=new yu(e,dt.empty(),n,r);return s?i.Rn():i}On(e,n){const r=new j4(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const l of i)r.wn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,n){let r=2;const s=this.xn(n);return ye.forEach(s,i=>this.On(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new jn(mr.comparator),d=!1;for(const h of c.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?d=!0:u=u.add(f.field));for(const h of c.orderBy)h.field.isKeyField()||(u=u.add(h.field));return u.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}$n(e,n){const r=new rm;for(const s of cu(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Tn(s.kind);gu.Wt.vt(i,o)}return r.cn()}kn(e){const n=new rm;return gu.Wt.vt(e,n.Tn(0)),n.cn()}Un(e,n){const r=new rm;return gu.Wt.vt(ng(this.databaseId,n),r.Tn(function(i){const o=cu(i);return o.length===0?0:o[o.length-1].kind}(e))),r.cn()}Bn(e,n,r){if(r===null)return[];let s=[];s.push(new rm);let i=0;for(const o of cu(e)){const l=r[i++];for(const c of s)if(this.Kn(n,o.fieldPath)&&rg(l))s=this.Wn(s,o,l);else{const u=c.Tn(o.kind);gu.Wt.vt(l,u)}}return this.Gn(s)}Nn(e,n,r){return this.Bn(e,n,r.position)}Gn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].cn();return n}Wn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const l of s){const c=new rm;c.seed(l.cn()),gu.Wt.vt(o,c.Tn(n.kind)),i.push(c)}return i}Kn(e,n){return!!e.filters.find(r=>r instanceof hn&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=sm(e),s=Ld(e);return(n?r.J(_T,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return ye.forEach(i,l=>s.get([l.indexId,this.uid]).next(c=>{o.push(function(d,h){const f=h?new Yp(h.sequenceNumber,new Ki(nd(h.readTime),new dt(oa(h.documentKey)),h.largestBatchId)):Yp.empty(),m=d.fields.map(([g,x])=>new av(mr.fromServerFormat(g),x));return new Nw(d.indexId,d.collectionGroup,m,f)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Wt(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=sm(e),i=Ld(e);return this.zn(e).next(o=>s.J(_T,IDBKeyRange.bound(n,n)).next(l=>ye.forEach(l,c=>i.put(T4(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return ye.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?ye.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(r.set(s.collectionGroup,l),ye.forEach(l,c=>this.jn(e,s,c).next(u=>{const d=this.Hn(i,c);return u.isEqual(d)?ye.resolve():this.Jn(e,i,c,u,d)}))))})}Yn(e,n,r,s){return Md(e).put(s.Vn(this.uid,this.Un(r,n.key),n.key))}Zn(e,n,r,s){return Md(e).delete(s.mn(this.uid,this.Un(r,n.key),n.key))}jn(e,n,r){const s=Md(e);let i=new jn(Il);return s.te({index:p8,range:IDBKeyRange.only([r.indexId,this.uid,pv(this.Un(r,n))])},(o,l)=>{i=i.add(new yu(r.indexId,n,k4(l.arrayValue),k4(l.directionalValue)))}).next(()=>i)}Hn(e,n){let r=new jn(Il);const s=this.$n(n,e);if(s==null)return r;const i=wT(n);if(i!=null){const o=e.data.field(i.fieldPath);if(rg(o))for(const l of o.arrayValue.values||[])r=r.add(new yu(n.indexId,e.key,this.kn(l),s))}else r=r.add(new yu(n.indexId,e.key,dx,s));return r}Jn(e,n,r,s,i){Xe(D4,"Updating index entries for document '%s'",n.key);const o=[];return function(c,u,d,h,f){const m=c.getIterator(),g=u.getIterator();let x=Rd(m),v=Rd(g);for(;x||v;){let w=!1,_=!1;if(x&&v){const C=d(x,v);C<0?_=!0:C>0&&(w=!0)}else x!=null?_=!0:w=!0;w?(h(v),v=Rd(g)):_?(f(x),x=Rd(m)):(x=Rd(m),v=Rd(g))}}(s,i,Il,l=>{o.push(this.Yn(e,n,r,l))},l=>{o.push(this.Zn(e,n,r,l))}),ye.waitFor(o)}zn(e){let n=1;return Ld(e).te({index:m8,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,l)=>Il(o,l)).filter((o,l,c)=>!l||Il(o,c[l-1])!==0);const s=[];s.push(e);for(const o of r){const l=Il(o,e),c=Il(o,n);if(l===0)s[0]=e.Rn();else if(l>0&&c<0)s.push(o),s.push(o.Rn());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Xn(s[o],s[o+1]))return[];const l=s[o].mn(this.uid,dx,dt.empty()),c=s[o+1].mn(this.uid,dx,dt.empty());i.push(IDBKeyRange.bound(l,c))}return i}Xn(e,n){return Il(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(L4)}getMinOffset(e,n){return ye.mapArray(this.xn(n),r=>this.On(e,r).next(s=>s||_t(44426))).next(L4)}}function M4(t){return Xr(t,Zp)}function Md(t){return Xr(t,op)}function sm(t){return Xr(t,bP)}function Ld(t){return Xr(t,ip)}function L4(t){Nt(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;xP(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Ki(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F4={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},y9=41943040;class As{static withCacheSize(e){return new As(e,As.DEFAULT_COLLECTION_PERCENTILE,As.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x9(t,e,n){const r=t.store(No),s=t.store(Yh),i=[],o=IDBKeyRange.only(n.batchId);let l=0;const c=r.te({range:o},(d,h,f)=>(l++,f.delete()));i.push(c.next(()=>{Nt(l===1,47070,{batchId:n.batchId})}));const u=[];for(const d of n.mutations){const h=d8(e,d.key.path,n.batchId);i.push(s.delete(h)),u.push(d.key)}return ye.waitFor(i).next(()=>u)}function Uw(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw _t(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */As.DEFAULT_COLLECTION_PERCENTILE=10,As.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,As.DEFAULT=new As(y9,As.DEFAULT_COLLECTION_PERCENTILE,As.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),As.DISABLED=new As(-1,0,0);class Lb{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.er={}}static St(e,n,r,s){Nt(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Lb(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Nl(e).te({index:Pu,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Kd(e),o=Nl(e);return o.add({}).next(l=>{Nt(typeof l=="number",49019);const c=new PP(l,n,r,s),u=function(m,g,x){const v=x.baseMutations.map(_=>Ow(m.wt,_)),w=x.mutations.map(_=>Ow(m.wt,_));return{userId:g,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:v,mutations:w}}(this.serializer,this.userId,c),d=[];let h=new jn((f,m)=>Wt(f.canonicalString(),m.canonicalString()));for(const f of s){const m=d8(this.userId,f.key.path,l);h=h.add(f.key.path.popLast()),d.push(o.put(u)),d.push(i.put(m,fxe))}return h.forEach(f=>{d.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.er[l]=c.keys()}),ye.waitFor(d).next(()=>c)})}lookupMutationBatch(e,n){return Nl(e).get(n).next(r=>r?(Nt(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),pu(this.serializer,r)):null)}tr(e,n){return this.er[n]?ye.resolve(this.er[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.er[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Nl(e).te({index:Pu,range:s},(o,l,c)=>{l.userId===this.userId&&(Nt(l.batchId>=r,47524,{nr:r}),i=pu(this.serializer,l)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Mu;return Nl(e).te({index:Pu,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Mu],[this.userId,Number.POSITIVE_INFINITY]);return Nl(e).J(Pu,n).next(r=>r.map(s=>pu(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=lv(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Kd(e).te({range:s},(o,l,c)=>{const[u,d,h]=o,f=oa(d);if(u===this.userId&&n.path.isEqual(f))return Nl(e).get(h).next(m=>{if(!m)throw _t(61480,{rr:o,batchId:h});Nt(m.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:m.userId,batchId:h}),i.push(pu(this.serializer,m))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new jn(Wt);const s=[];return n.forEach(i=>{const o=lv(this.userId,i.path),l=IDBKeyRange.lowerBound(o),c=Kd(e).te({range:l},(u,d,h)=>{const[f,m,g]=u,x=oa(m);f===this.userId&&i.path.isEqual(x)?r=r.add(g):h.done()});s.push(c)}),ye.waitFor(s).next(()=>this.ir(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=lv(this.userId,r),o=IDBKeyRange.lowerBound(i);let l=new jn(Wt);return Kd(e).te({range:o},(c,u,d)=>{const[h,f,m]=c,g=oa(f);h===this.userId&&r.isPrefixOf(g)?g.length===s&&(l=l.add(m)):d.done()}).next(()=>this.ir(e,l))}ir(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Nl(e).get(i).next(o=>{if(o===null)throw _t(35274,{batchId:i});Nt(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(pu(this.serializer,o))}))}),ye.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return x9(e.he,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.sr(n.batchId)}),ye.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return ye.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Kd(e).te({range:r},(i,o,l)=>{if(i[0]===this.userId){const c=oa(i[1]);s.push(c)}else l.done()}).next(()=>{Nt(s.length===0,56720,{_r:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return v9(e,this.userId,n)}ar(e){return w9(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Mu,lastStreamToken:""})}}function v9(t,e,n){const r=lv(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Kd(t).te({range:i,ee:!0},(l,c,u)=>{const[d,h,f]=l;d===e&&h===s&&(o=!0),u.done()}).next(()=>o)}function Nl(t){return Xr(t,No)}function Kd(t){return Xr(t,Yh)}function w9(t){return Xr(t,Qp)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new rd(0)}static lr(){return new rd(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $ve{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.hr(e).next(n=>{const r=new rd(n.highestTargetId);return n.highestTargetId=r.next(),this.Pr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(n=>jt.fromTimestamp(new gr(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.hr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Pr(e,s)))}addTargetData(e,n){return this.Tr(e,n).next(()=>this.hr(e).next(r=>(r.targetCount+=1,this.Ir(n,r),this.Pr(e,r))))}updateTargetData(e,n){return this.Tr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Fd(e).delete(n.targetId)).next(()=>this.hr(e)).next(r=>(Nt(r.targetCount>0,8065),r.targetCount-=1,this.Pr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Fd(e).te((o,l)=>{const c=km(l);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>ye.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Fd(e).te((r,s)=>{const i=km(s);n(i)})}hr(e){return O4(e).get(kw).next(n=>(Nt(n!==null,2888),n))}Pr(e,n){return O4(e).put(kw,n)}Tr(e,n){return Fd(e).put(f9(this.serializer,n))}Ir(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.hr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=ed(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Fd(e).te({range:s,index:f8},(o,l,c)=>{const u=km(l);Jg(n,u.target)&&(i=u,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Gl(e);return n.forEach(o=>{const l=Ds(o.path);s.push(i.put({targetId:r,path:l})),s.push(this.referenceDelegate.addReference(e,r,o))}),ye.waitFor(s)}removeMatchingKeys(e,n,r){const s=Gl(e);return ye.forEach(n,i=>{const o=Ds(i.path);return ye.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Gl(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Gl(e);let i=on();return s.te({range:r,ee:!0},(o,l,c)=>{const u=oa(o[1]),d=new dt(u);i=i.add(d)}).next(()=>i)}containsKey(e,n){const r=Ds(n.path),s=IDBKeyRange.bound([r],[o8(r)],!1,!0);let i=0;return Gl(e).te({index:wP,ee:!0,range:s},([o,l],c,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}Rt(e,n){return Fd(e).get(n).next(r=>r?km(r):null)}}function Fd(t){return Xr(t,Jh)}function O4(t){return Xr(t,Lu)}function Gl(t){return Xr(t,Qh)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $4="LruGarbageCollector",Vve=1048576;function V4([t,e],[n,r]){const s=Wt(t,n);return s===0?Wt(e,r):s}class Uve{constructor(e){this.Er=e,this.buffer=new jn(V4),this.dr=0}Ar(){return++this.dr}Rr(e){const n=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();V4(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class b9{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Xe($4,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Hc(n)?Xe($4,"Ignoring IndexedDB error during garbage collection: ",n):await fd(n)}await this.mr(3e5)})}}class Bve{constructor(e,n){this.gr=e,this.params=n}calculateTargetCount(e,n){return this.gr.pr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return ye.resolve(lo.le);const r=new Uve(n);return this.gr.forEachTarget(e,s=>r.Rr(s.sequenceNumber)).next(()=>this.gr.yr(e,s=>r.Rr(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.gr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.gr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Xe("LruGarbageCollector","Garbage collection skipped; disabled"),ye.resolve(F4)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Xe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),F4):this.wr(e,n))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,n){let r,s,i,o,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Xe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,l=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),Gd()<=dn.DEBUG&&Xe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),ye.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function _9(t,e){return new Bve(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zve{constructor(e,n){this.db=e,this.garbageCollector=_9(this,n)}pr(e){const n=this.Sr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Sr(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}yr(e,n){return this.br(e,(r,s)=>n(s))}addReference(e,n,r){return hx(e,r)}removeReference(e,n,r){return hx(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return hx(e,n)}Dr(e,n){return function(s,i){let o=!1;return w9(s).ne(l=>v9(s,l,i).next(c=>(c&&(o=!0),ye.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.br(e,(o,l)=>{if(l<=n){const c=this.Dr(e,o).next(u=>{if(!u)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,jt.min()),Gl(e).delete(function(h){return[0,Ds(h.path)]}(o))))});s.push(c)}}).next(()=>ye.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return hx(e,n)}br(e,n){const r=Gl(e);let s,i=lo.le;return r.te({index:wP},([o,l],{path:c,sequenceNumber:u})=>{o===0?(i!==lo.le&&n(new dt(oa(s)),i),i=u,s=c):i=lo.le}).next(()=>{i!==lo.le&&n(new dt(oa(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function hx(t,e){return Gl(t).put(function(r,s){return{targetId:0,path:Ds(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S9{constructor(){this.changes=new xl(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Tr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ye.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gve{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return nu(e).put(r)}removeEntry(e,n,r){return nu(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],$w(o),l[l.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.vr(e,r)))}getEntry(e,n){let r=Tr.newInvalidDocument(n);return nu(e).te({index:cv,range:IDBKeyRange.only(im(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}Fr(e,n){let r={size:0,document:Tr.newInvalidDocument(n)};return nu(e).te({index:cv,range:IDBKeyRange.only(im(n))},(s,i)=>{r={document:this.Cr(n,i),size:Uw(i)}}).next(()=>r)}getEntries(e,n){let r=$i();return this.Mr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Or(e,n){let r=$i(),s=new lr(dt.comparator);return this.Mr(e,n,(i,o)=>{const l=this.Cr(i,o);r=r.insert(i,l),s=s.insert(i,Uw(o))}).next(()=>({documents:r,Nr:s}))}Mr(e,n,r){if(n.isEmpty())return ye.resolve();let s=new jn(z4);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(im(s.first()),im(s.last())),o=s.getIterator();let l=o.getNext();return nu(e).te({index:cv,range:i},(c,u,d)=>{const h=dt.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&z4(l,h)<0;)r(l,null),l=o.getNext();l&&l.isEqual(h)&&(r(l,u),l=o.hasNext()?o.getNext():null),l?d.H(im(l)):d.done()}).next(()=>{for(;l;)r(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,l=[o.popLast().toArray(),o.lastSegment(),$w(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return nu(e).J(IDBKeyRange.bound(l,c,!0)).next(u=>{i==null||i.incrementDocumentReadCount(u.length);let d=$i();for(const h of u){const f=this.Cr(dt.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(Zg(n,f)||s.has(f.key))&&(d=d.insert(f.key,f))}return d})}getAllFromCollectionGroup(e,n,r,s){let i=$i();const o=B4(n,r),l=B4(n,Ki.max());return nu(e).te({index:h8,range:IDBKeyRange.bound(o,l,!0)},(c,u,d)=>{const h=this.Cr(dt.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(h.key,h),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new Wve(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return U4(e).get(bT).next(n=>(Nt(!!n,20021),n))}vr(e,n){return U4(e).put(bT,n)}Cr(e,n){if(n){const r=Pve(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(jt.min())))return r}return Tr.newInvalidDocument(e)}}function C9(t){return new Gve(t)}class Wve extends S9{constructor(e,n){super(),this.Br=e,this.trackRemovals=n,this.Lr=new xl(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new jn((i,o)=>Wt(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.Lr.get(i);if(n.push(this.Br.removeEntry(e,i,l.readTime)),o.isValidDocument()){const c=C4(this.Br.serializer,o);s=s.add(i.path.popLast());const u=Uw(c);r+=u-l.size,n.push(this.Br.addEntry(e,i,c))}else if(r-=l.size,this.trackRemovals){const c=C4(this.Br.serializer,o.convertToNoDocument(jt.min()));n.push(this.Br.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.Br.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Br.updateMetadata(e,r)),ye.waitFor(n)}getFromCache(e,n){return this.Br.Fr(e,n).next(r=>(this.Lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Br.Or(e,n).next(({documents:r,Nr:s})=>(s.forEach((i,o)=>{this.Lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function U4(t){return Xr(t,Xp)}function nu(t){return Xr(t,Aw)}function im(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function B4(t,e){const n=e.documentKey.path.toArray();return[t,$w(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function z4(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=Wt(n[i],r[i]),s)return s;return s=Wt(n.length,r.length),s||(s=Wt(n[n.length-2],r[r.length-2]),s||Wt(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hve{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E9{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&up(r.mutation,s,fi.empty(),gr.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,on()).next(()=>r))}getLocalViewOfDocuments(e,n,r=on()){const s=aa();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Pm();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=aa();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,on()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=$i();const o=cp(),l=function(){return cp()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof vl)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),up(d.mutation,u,d.mutation.getFieldMask(),gr.now())):o.set(u.key,fi.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var h;return l.set(u,new Hve(d,(h=o.get(u))!==null&&h!==void 0?h:null))}),l))}recalculateAndSaveOverlays(e,n){const r=cp();let s=new lr((o,l)=>o-l),i=on();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||fi.empty();d=l.applyToLocalView(u,d),r.set(c,d);const h=(s.get(l.batchId)||on()).add(c);s=s.insert(l.batchId,h)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,h=z8();d.forEach(f=>{if(!i.has(f)){const m=Y8(n.get(f),r.get(f));m!==null&&h.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return ye.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return dt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):O8(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):ye.resolve(aa());let l=Kp,c=i;return o.next(u=>ye.forEach(u,(d,h)=>(l<h.largestBatchId&&(l=h.largestBatchId),i.get(d)?ye.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{c=c.insert(d,f)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,on())).next(d=>({batchId:l,changes:B8(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new dt(n)).next(r=>{let s=Pm();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Pm();return this.indexManager.getCollectionParents(e,i).next(l=>ye.forEach(l,c=>{const u=function(h,f){return new Qg(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Tr.newInvalidDocument(d)))});let l=Pm();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&up(d.mutation,u,fi.empty(),gr.now()),Zg(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qve{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,n){return ye.resolve(this.kr.get(n))}saveBundleMetadata(e,n){return this.kr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Xs(s.createTime)}}(n)),ye.resolve()}getNamedQuery(e,n){return ye.resolve(this.qr.get(n))}saveNamedQuery(e,n){return this.qr.set(n.name,function(s){return{name:s.name,query:m9(s.bundledQuery),readTime:Xs(s.readTime)}}(n)),ye.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kve{constructor(){this.overlays=new lr(dt.comparator),this.Qr=new Map}getOverlay(e,n){return ye.resolve(this.overlays.get(n))}getOverlays(e,n){const r=aa();return ye.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.bt(e,n,i)}),ye.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Qr.delete(r)),ye.resolve()}getOverlaysForCollection(e,n,r){const s=aa(),i=n.length+1,o=new dt(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return ye.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new lr((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=aa(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=aa(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return ye.resolve(l)}bt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Qr.get(s.largestBatchId).delete(r.key);this.Qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new kP(n,r));let i=this.Qr.get(n);i===void 0&&(i=on(),this.Qr.set(n,i)),this.Qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yve{constructor(){this.sessionToken=zr.EMPTY_BYTE_STRING}getSessionToken(e){return ye.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ye.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(){this.$r=new jn(rs.Ur),this.Kr=new jn(rs.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,n){const r=new rs(e,n);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.zr(new rs(e,n))}jr(e,n){e.forEach(r=>this.removeReference(r,n))}Hr(e){const n=new dt(new Tn([])),r=new rs(n,e),s=new rs(n,e+1),i=[];return this.Kr.forEachInRange([r,s],o=>{this.zr(o),i.push(o.key)}),i}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const n=new dt(new Tn([])),r=new rs(n,e),s=new rs(n,e+1);let i=on();return this.Kr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new rs(e,0),r=this.$r.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class rs{constructor(e,n){this.key=e,this.Zr=n}static Ur(e,n){return dt.comparator(e.key,n.key)||Wt(e.Zr,n.Zr)}static Wr(e,n){return Wt(e.Zr,n.Zr)||dt.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jve{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.nr=1,this.Xr=new jn(rs.Ur)}checkEmpty(e){return ye.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new PP(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Xr=this.Xr.add(new rs(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ye.resolve(o)}lookupMutationBatch(e,n){return ye.resolve(this.ei(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ti(r),i=s<0?0:s;return ye.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(this.mutationQueue.length===0?Mu:this.nr-1)}getAllMutationBatches(e){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new rs(n,0),s=new rs(n,Number.POSITIVE_INFINITY),i=[];return this.Xr.forEachInRange([r,s],o=>{const l=this.ei(o.Zr);i.push(l)}),ye.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new jn(Wt);return n.forEach(s=>{const i=new rs(s,0),o=new rs(s,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([i,o],l=>{r=r.add(l.Zr)})}),ye.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;dt.isDocumentKey(i)||(i=i.child(""));const o=new rs(new dt(i),0);let l=new jn(Wt);return this.Xr.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.Zr)),!0)},o),ye.resolve(this.ni(l))}ni(e){const n=[];return e.forEach(r=>{const s=this.ei(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Nt(this.ri(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return ye.forEach(n.mutations,s=>{const i=new rs(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,n){const r=new rs(n,0),s=this.Xr.firstAfterOrEqual(r);return ye.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ye.resolve()}ri(e,n){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const n=this.ti(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qve{constructor(e){this.ii=e,this.docs=function(){return new lr(dt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ii(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ye.resolve(r?r.document.mutableCopy():Tr.newInvalidDocument(n))}getEntries(e,n){let r=$i();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Tr.newInvalidDocument(s))}),ye.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=$i();const o=n.path,l=new dt(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||xP(a8(d),r)<=0||(s.has(d.key)||Zg(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return ye.resolve(i)}getAllFromCollectionGroup(e,n,r,s){_t(9500)}si(e,n){return ye.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Xve(this)}getSize(e){return ye.resolve(this.size)}}class Xve extends S9{constructor(e){super(),this.Br=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Br.addEntry(e,s)):this.Br.removeEntry(r)}),ye.waitFor(n)}getFromCache(e,n){return this.Br.getEntry(e,n)}getAllFromCache(e,n){return this.Br.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zve{constructor(e){this.persistence=e,this.oi=new xl(n=>ed(n),Jg),this.lastRemoteSnapshotVersion=jt.min(),this.highestTargetId=0,this._i=0,this.ai=new LP,this.targetCount=0,this.ui=rd.cr()}forEachTarget(e,n){return this.oi.forEach((r,s)=>n(s)),ye.resolve()}getLastRemoteSnapshotVersion(e){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ye.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this._i&&(this._i=n),ye.resolve()}Tr(e){this.oi.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ui=new rd(n),this.highestTargetId=n),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,n){return this.Tr(n),this.targetCount+=1,ye.resolve()}updateTargetData(e,n){return this.Tr(n),ye.resolve()}removeTargetData(e,n){return this.oi.delete(n.target),this.ai.Hr(n.targetId),this.targetCount-=1,ye.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.oi.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.oi.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),ye.waitFor(i).next(()=>s)}getTargetCount(e){return ye.resolve(this.targetCount)}getTargetData(e,n){const r=this.oi.get(n)||null;return ye.resolve(r)}addMatchingKeys(e,n,r){return this.ai.Gr(n,r),ye.resolve()}removeMatchingKeys(e,n,r){this.ai.jr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),ye.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.ai.Hr(n),ye.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ai.Yr(n);return ye.resolve(r)}containsKey(e,n){return ye.resolve(this.ai.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e,n){this.ci={},this.overlays={},this.li=new lo(0),this.hi=!1,this.hi=!0,this.Pi=new Yve,this.referenceDelegate=e(this),this.Ti=new Zve(this),this.indexManager=new Fve,this.remoteDocumentCache=function(s){return new Qve(s)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new h9(n),this.Ei=new qve(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Kve,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ci[e.toKey()];return r||(r=new Jve(n,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,n,r){Xe("MemoryPersistence","Starting transaction:",e);const s=new ewe(this.li.next());return this.referenceDelegate.di(),r(s).next(i=>this.referenceDelegate.Ai(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ri(e,n){return ye.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,n)))}}class ewe extends c8{constructor(e){super(),this.currentSequenceNumber=e}}class Fb{constructor(e){this.persistence=e,this.Vi=new LP,this.mi=null}static fi(e){return new Fb(e)}get gi(){if(this.mi)return this.mi;throw _t(60996)}addReference(e,n,r){return this.Vi.addReference(r,n),this.gi.delete(r.toString()),ye.resolve()}removeReference(e,n,r){return this.Vi.removeReference(r,n),this.gi.add(r.toString()),ye.resolve()}markPotentiallyOrphaned(e,n){return this.gi.add(n.toString()),ye.resolve()}removeTarget(e,n){this.Vi.Hr(n.targetId).forEach(s=>this.gi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.gi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}di(){this.mi=new Set}Ai(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.gi,r=>{const s=dt.fromPath(r);return this.pi(e,s).next(i=>{i||n.removeEntry(s,jt.min())})}).next(()=>(this.mi=null,n.apply(e)))}updateLimboDocument(e,n){return this.pi(e,n).next(r=>{r?this.gi.delete(n.toString()):this.gi.add(n.toString())})}Ii(e){return 0}pi(e,n){return ye.or([()=>ye.resolve(this.Vi.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ri(e,n)])}}class Bw{constructor(e,n){this.persistence=e,this.yi=new xl(r=>Ds(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=_9(this,n)}static fi(e,n){return new Bw(e,n)}di(){}Ai(e){return ye.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}pr(e){const n=this.Sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Sr(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}yr(e,n){return ye.forEach(this.yi,(r,s)=>this.Dr(e,r,s).next(i=>i?ye.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.si(e,o=>this.Dr(e,o,n).next(l=>{l||(r++,i.removeEntry(o,jt.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.yi.set(n,e.currentSequenceNumber),ye.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),ye.resolve()}removeReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),ye.resolve()}updateLimboDocument(e,n){return this.yi.set(n,e.currentSequenceNumber),ye.resolve()}Ii(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=dv(e.data.value)),n}Dr(e,n,r){return ye.or([()=>this.persistence.Ri(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.yi.get(n);return ye.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class twe{constructor(e){this.serializer=e}q(e,n,r,s){const i=new Sb("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore(Yg)}(e),function(c){c.createObjectStore(Qp,{keyPath:hxe}),c.createObjectStore(No,{keyPath:e4,autoIncrement:!0}).createIndex(Pu,t4,{unique:!0}),c.createObjectStore(Yh)}(e),G4(e),function(c){c.createObjectStore(uu)}(e));let o=ye.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore(Qh),c.deleteObjectStore(Jh),c.deleteObjectStore(Lu)}(e),G4(e)),o=o.next(()=>function(c){const u=c.store(Lu),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:jt.min().toTimestamp(),targetCount:0};return u.put(kw,d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store(No).J().next(h=>{c.deleteObjectStore(No),c.createObjectStore(No,{keyPath:e4,autoIncrement:!0}).createIndex(Pu,t4,{unique:!0});const f=u.store(No),m=h.map(g=>f.put(g));return ye.waitFor(m)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore(Xh,{keyPath:bxe})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.wi(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore(Xp)}(e),this.Si(i)))),r<7&&s>=7&&(o=o.next(()=>this.bi(i))),r<8&&s>=8&&(o=o.next(()=>this.Di(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Ci(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(Eb,{keyPath:_xe})})(e),function(c){c.createObjectStore(Tb,{keyPath:Sxe})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore(Ib,{keyPath:Axe});u.createIndex(ST,kxe,{unique:!1}),u.createIndex(g8,jxe,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore(Aw,{keyPath:mxe});u.createIndex(cv,pxe),u.createIndex(h8,gxe)}(e)).next(()=>this.Fi(e,i)).next(()=>e.deleteObjectStore(uu))),r<14&&s>=14&&(o=o.next(()=>this.Mi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore(bP,{keyPath:Cxe,autoIncrement:!0}).createIndex(_T,Exe,{unique:!1}),c.createObjectStore(ip,{keyPath:Txe}).createIndex(m8,Ixe,{unique:!1}),c.createObjectStore(op,{keyPath:Nxe}).createIndex(p8,Pxe,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(ip).clear()}).next(()=>{n.objectStore(op).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(_P,{keyPath:Rxe})})(e)})),r<18&&s>=18&&uz()&&(o=o.next(()=>{n.objectStore(ip).clear()}).next(()=>{n.objectStore(op).clear()})),o}Si(e){let n=0;return e.store(uu).te((r,s)=>{n+=Uw(s)}).next(()=>{const r={byteSize:n};return e.store(Xp).put(bT,r)})}wi(e){const n=e.store(Qp),r=e.store(No);return n.J().next(s=>ye.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,Mu],[i.userId,i.lastAcknowledgedBatchId]);return r.J(Pu,o).next(l=>ye.forEach(l,c=>{Nt(c.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const u=pu(this.serializer,c);return x9(e,i.userId,u).next(()=>{})}))}))}bi(e){const n=e.store(Qh),r=e.store(uu);return e.store(Lu).get(kw).next(s=>{const i=[];return r.te((o,l)=>{const c=new Tn(o),u=function(h){return[0,Ds(h)]}(c);i.push(n.get(u).next(d=>d?ye.resolve():(h=>n.put({targetId:0,path:Ds(h),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>ye.waitFor(i))})}Di(e,n){e.createObjectStore(Zp,{keyPath:wxe});const r=n.store(Zp),s=new MP,i=o=>{if(s.add(o)){const l=o.lastSegment(),c=o.popLast();return r.put({collectionId:l,parent:Ds(c)})}};return n.store(uu).te({ee:!0},(o,l)=>{const c=new Tn(o);return i(c.popLast())}).next(()=>n.store(Yh).te({ee:!0},([o,l,c],u)=>{const d=oa(l);return i(d.popLast())}))}Ci(e){const n=e.store(Jh);return n.te((r,s)=>{const i=km(s),o=f9(this.serializer,i);return n.put(o)})}Fi(e,n){const r=n.store(uu),s=[];return r.te((i,o)=>{const l=n.store(Aw),c=function(h){return h.document?new dt(Tn.fromString(h.document.name).popFirst(5)):h.noDocument?dt.fromSegments(h.noDocument.path):h.unknownDocument?dt.fromSegments(h.unknownDocument.path):_t(36783)}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(l.put(u))}).next(()=>ye.waitFor(s))}Mi(e,n){const r=n.store(No),s=C9(this.serializer),i=new FP(Fb.fi,this.serializer.wt);return r.J().next(o=>{const l=new Map;return o.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:on();pu(this.serializer,c).keys().forEach(h=>d=d.add(h)),l.set(c.userId,d)}),ye.forEach(l,(c,u)=>{const d=new ms(u),h=Mb.St(this.serializer,d),f=i.getIndexManager(d),m=Lb.St(d,this.serializer,f,i.referenceDelegate);return new E9(s,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new CT(n,lo.le),c).next()})})}}function G4(t){t.createObjectStore(Qh,{keyPath:xxe}).createIndex(wP,vxe,{unique:!0}),t.createObjectStore(Jh,{keyPath:"targetId"}).createIndex(f8,yxe,{unique:!0}),t.createObjectStore(Lu)}const Pl="IndexedDbPersistence",$S=18e5,VS=5e3,US="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",nwe="main";class OP{constructor(e,n,r,s,i,o,l,c,u,d,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.xi=i,this.window=o,this.document=l,this.Oi=u,this.Ni=d,this.Bi=h,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=f=>Promise.resolve(),!OP.C())throw new ut(Fe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new zve(this,s),this.Ui=n+nwe,this.serializer=new h9(c),this.Ki=new hc(this.Ui,this.Bi,new twe(this.serializer)),this.Pi=new kve,this.Ti=new $ve(this.referenceDelegate,this.serializer),this.remoteDocumentCache=C9(this.serializer),this.Ei=new Ave,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,d===!1&&Ks(Pl,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ut(Fe.FAILED_PRECONDITION,US);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new lo(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>fx(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(n=>{n||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(n=>this.isPrimary&&!n?this.Xi(e).next(()=>!1):!!n&&this.es(e).next(()=>!0))).catch(e=>{if(Hc(e))return Xe(Pl,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Xe(Pl,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return om(e).get(jd).next(n=>ye.resolve(this.ts(n)))}ns(e){return fx(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,$S)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Xr(n,Xh);return r.J().next(s=>{const i=this._s(s,$S),o=s.filter(l=>i.indexOf(l)===-1);return ye.forEach(o,l=>r.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Wi)for(const n of e)this.Wi.removeItem(this.us(n.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?ye.resolve(!0):om(e).get(jd).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,VS)&&!this.cs(n.ownerId)){if(this.ts(n)&&this.networkEnabled)return!0;if(!this.ts(n)){if(!n.allowTabSynchronization)throw new ut(Fe.FAILED_PRECONDITION,US);return!1}}return!(!this.networkEnabled||!this.inForeground)||fx(e).J().next(r=>this._s(r,VS).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&Xe(Pl,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[Yg,Xh],e=>{const n=new CT(e,lo.le);return this.Xi(n).next(()=>this.ns(n))}),this.Ki.close(),this.Ts()}_s(e,n){return e.filter(r=>this.ss(r.updateTimeMs,n)&&!this.cs(r.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>fx(e).J().next(n=>this._s(n,$S).map(r=>r.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,n){return Lb.St(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Ove(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return Mb.St(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,n,r){Xe(Pl,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===18?Lxe:c===17?w8:c===16?Mxe:c===15?SP:c===14?v8:c===13?x8:c===12?Dxe:c===11?y8:void _t(60245)}(this.Bi);let o;return this.Ki.runTransaction(e,s,i,l=>(o=new CT(l,this.li?this.li.next():lo.le),n==="readwrite-primary"?this.Yi(o).next(c=>!!c||this.Zi(o)).next(c=>{if(!c)throw Ks(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new ut(Fe.FAILED_PRECONDITION,l8);return r(o)}).next(c=>this.es(o).next(()=>c)):this.Es(o).next(()=>r(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Es(e){return om(e).get(jd).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,VS)&&!this.cs(n.ownerId)&&!this.ts(n)&&!(this.Ni||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ut(Fe.FAILED_PRECONDITION,US)})}es(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return om(e).put(jd,n)}static C(){return hc.C()}Xi(e){const n=om(e);return n.get(jd).next(r=>this.ts(r)?(Xe(Pl,"Releasing primary lease."),n.delete(jd)):ye.resolve())}ss(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Ks(`Detected an update time that is in the future: ${e} > ${r}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const n=/(?:Version|Mobile)\/1[456]/;cz()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var n;try{const r=((n=this.Wi)===null||n===void 0?void 0:n.getItem(this.us(e)))!==null;return Xe(Pl,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ks(Pl,"Failed to get zombied client id.",r),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){Ks("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function om(t){return Xr(t,Yg)}function fx(t){return Xr(t,Xh)}function rwe(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.ds=r,this.As=s}static Rs(e,n){let r=on(),s=on();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new $P(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class swe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T9{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return cz()?8:u8(Jr())>0?6:4}()}initialize(e,n){this.ys=e,this.indexManager=n,this.Vs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ws(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Ss(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new swe;return this.bs(e,n,o).next(l=>{if(i.result=l,this.fs)return this.Ds(e,n,o,l.size)})}).next(()=>i.result)}Ds(e,n,r,s){return r.documentReadCount<this.gs?(Gd()<=dn.DEBUG&&Xe("QueryEngine","SDK will not create cache indexes for query:",Wd(n),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),ye.resolve()):(Gd()<=dn.DEBUG&&Xe("QueryEngine","Query:",Wd(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ps*s?(Gd()<=dn.DEBUG&&Xe("QueryEngine","The SDK decides to create cache indexes for query:",Wd(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ho(n))):ye.resolve())}ws(e,n){if(m4(n))return ye.resolve(null);let r=ho(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Lw(n,null,"F"),r=ho(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=on(...i);return this.ys.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.vs(n,l);return this.Cs(n,u,o,c.readTime)?this.ws(e,Lw(n,null,"F")):this.Fs(e,u,n,c)}))})))}Ss(e,n,r,s){return m4(n)||s.isEqual(jt.min())?ye.resolve(null):this.ys.getDocuments(e,r).next(i=>{const o=this.vs(n,i);return this.Cs(n,o,r,s)?ye.resolve(null):(Gd()<=dn.DEBUG&&Xe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Wd(n)),this.Fs(e,o,n,ixe(s,Kp)).next(l=>l))})}vs(e,n){let r=new jn(V8(e));return n.forEach((s,i)=>{Zg(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}bs(e,n,r){return Gd()<=dn.DEBUG&&Xe("QueryEngine","Using full collection scan to execute query:",Wd(n)),this.ys.getDocumentsMatchingQuery(e,n,Ki.min(),r)}Fs(e,n,r,s){return this.ys.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP="LocalStore",iwe=3e8;class owe{constructor(e,n,r,s){this.persistence=e,this.Ms=n,this.serializer=s,this.xs=new lr(Wt),this.Os=new xl(i=>ed(i),Jg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new E9(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.xs))}}function I9(t,e,n,r){return new owe(t,e,n,r)}async function N9(t,e){const n=Xt(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=on();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({ks:u,removedBatchIds:o,addedBatchIds:l}))})})}function awe(t,e){const n=Xt(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Bs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const h=u.batch,f=h.keys();let m=ye.resolve();return f.forEach(g=>{m=m.next(()=>d.getEntry(c,g)).next(x=>{const v=u.docVersions.get(g);Nt(v!==null,48541),x.version.compareTo(v)<0&&(h.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),d.addEntry(x)))})}),m.next(()=>l.mutationQueue.removeMutationBatch(c,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=on();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function P9(t){const e=Xt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ti.getLastRemoteSnapshotVersion(n))}function lwe(t,e){const n=Xt(t),r=e.snapshotVersion;let s=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Bs.newChangeBuffer({trackRemovals:!0});s=n.xs;const l=[];e.targetChanges.forEach((d,h)=>{const f=s.get(h);if(!f)return;l.push(n.Ti.removeMatchingKeys(i,d.removedDocuments,h).next(()=>n.Ti.addMatchingKeys(i,d.addedDocuments,h)));let m=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(zr.EMPTY_BYTE_STRING,jt.min()).withLastLimboFreeSnapshotVersion(jt.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),s=s.insert(h,m),function(x,v,w){return x.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=iwe?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(f,m,d)&&l.push(n.Ti.updateTargetData(i,m))});let c=$i(),u=on();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(cwe(i,o,e.documentUpdates).next(d=>{c=d.qs,u=d.Qs})),!r.isEqual(jt.min())){const d=n.Ti.getLastRemoteSnapshotVersion(i).next(h=>n.Ti.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return ye.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.xs=s,i))}function cwe(t,e,n){let r=on(),s=on();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=$i();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(jt.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Xe(VP,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{qs:o,Qs:s}})}function uwe(t,e){const n=Xt(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Mu),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function dwe(t,e){const n=Xt(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ti.getTargetData(r,e).next(i=>i?(s=i,ye.resolve(s)):n.Ti.allocateTargetId(r).next(o=>(s=new Wa(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ti.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.xs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.xs=n.xs.insert(r.targetId,r),n.Os.set(e,r.targetId)),r})}async function OT(t,e,n){const r=Xt(t),s=r.xs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Hc(o))throw o;Xe(VP,`Failed to update sequence numbers for target ${e}: ${o}`)}r.xs=r.xs.remove(e),r.Os.delete(s.target)}function W4(t,e,n){const r=Xt(t);let s=jt.min(),i=on();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const h=Xt(c),f=h.Os.get(d);return f!==void 0?ye.resolve(h.xs.get(f)):h.Ti.getTargetData(u,d)}(r,o,ho(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.Ms.getDocumentsMatchingQuery(o,e,n?s:jt.min(),n?i:on())).next(l=>(hwe(r,Qxe(e),l),{documents:l,$s:i})))}function hwe(t,e,n){let r=t.Ns.get(e)||jt.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ns.set(e,r)}class H4{constructor(){this.activeTargetIds=rve()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class A9{constructor(){this.xo=new H4,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,n,r){this.Oo[e]=n}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new H4,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fwe{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4="ConnectivityMonitor";class K4{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Xe(q4,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Xe(q4,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mx=null;function $T(){return mx===null?mx=function(){return 268435456+Math.round(2147483648*Math.random())}():mx++,"0x"+mx.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS="RestConnection",mwe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class pwe{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ko=n+"://"+e.host,this.Wo=`projects/${r}/databases/${s}`,this.Go=this.databaseId.database===jw?`project_id=${r}`:`project_id=${r}&database_id=${s}`}zo(e,n,r,s,i){const o=$T(),l=this.jo(e,n.toUriEncodedString());Xe(BS,`Sending RPC '${e}' ${o}:`,l,r);const c={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(c,s,i);const{host:u}=new URL(l),d=Bc(u);return this.Jo(e,l,c,r,d).then(h=>(Xe(BS,`Received RPC '${e}' ${o}: `,h),h),h=>{throw Xu(BS,`RPC '${e}' ${o} failed with error: `,h,"url: ",l,"request:",r),h})}Yo(e,n,r,s,i,o){return this.zo(e,n,r,s,i)}Ho(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Tf}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}jo(e,n){const r=mwe[e];return`${this.Ko}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gwe{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts="WebChannelConnection";class ywe extends pwe{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=$T();return new Promise((l,c)=>{const u=new Qz;u.setWithCredentials(!0),u.listenOnce(Xz.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case ov.NO_ERROR:const h=u.getResponseJson();Xe(Ts,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),l(h);break;case ov.TIMEOUT:Xe(Ts,`RPC '${e}' ${o} timed out`),c(new ut(Fe.DEADLINE_EXCEEDED,"Request time out"));break;case ov.HTTP_ERROR:const f=u.getStatus();if(Xe(Ts,`RPC '${e}' ${o} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const x=function(w){const _=w.toLowerCase().replace(/_/g,"-");return Object.values(Fe).indexOf(_)>=0?_:Fe.UNKNOWN}(g.status);c(new ut(x,g.message))}else c(new ut(Fe.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new ut(Fe.UNAVAILABLE,"Connection failed."));break;default:_t(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Xe(Ts,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);Xe(Ts,`RPC '${e}' ${o} sending request:`,s),u.send(n,"POST",d,r,15)})}T_(e,n,r){const s=$T(),i=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=t8(),l=e8(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Ho(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");Xe(Ts,`Creating RPC '${e}' stream ${s}: ${d}`,c);const h=o.createWebChannel(d,c);let f=!1,m=!1;const g=new gwe({Zo:v=>{m?Xe(Ts,`Not sending because RPC '${e}' stream ${s} is closed:`,v):(f||(Xe(Ts,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),Xe(Ts,`RPC '${e}' stream ${s} sending:`,v),h.send(v))},Xo:()=>h.close()}),x=(v,w,_)=>{v.listen(w,C=>{try{_(C)}catch(T){setTimeout(()=>{throw T},0)}})};return x(h,Nm.EventType.OPEN,()=>{m||(Xe(Ts,`RPC '${e}' stream ${s} transport opened.`),g.__())}),x(h,Nm.EventType.CLOSE,()=>{m||(m=!0,Xe(Ts,`RPC '${e}' stream ${s} transport closed`),g.u_())}),x(h,Nm.EventType.ERROR,v=>{m||(m=!0,Xu(Ts,`RPC '${e}' stream ${s} transport errored. Name:`,v.name,"Message:",v.message),g.u_(new ut(Fe.UNAVAILABLE,"The operation could not be completed")))}),x(h,Nm.EventType.MESSAGE,v=>{var w;if(!m){const _=v.data[0];Nt(!!_,16349);const C=_,T=(C==null?void 0:C.error)||((w=C[0])===null||w===void 0?void 0:w.error);if(T){Xe(Ts,`RPC '${e}' stream ${s} received error:`,T);const j=T.status;let A=function(N){const k=Mr[N];if(k!==void 0)return X8(k)}(j),E=T.message;A===void 0&&(A=Fe.INTERNAL,E="Unknown error status: "+j+" with message "+T.message),m=!0,g.u_(new ut(A,E)),h.close()}else Xe(Ts,`RPC '${e}' stream ${s} received:`,_),g.c_(_)}}),x(l,Zz.STAT_EVENT,v=>{v.stat===xT.PROXY?Xe(Ts,`RPC '${e}' stream ${s} detected buffering proxy`):v.stat===xT.NOPROXY&&Xe(Ts,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.a_()},0),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xwe(){return typeof window<"u"?window:null}function gv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ob(t){return new vve(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k9{constructor(e,n,r=1e3,s=1.5,i=6e4){this.xi=e,this.timerId=n,this.I_=r,this.E_=s,this.d_=i,this.A_=0,this.R_=null,this.V_=Date.now(),this.reset()}reset(){this.A_=0}m_(){this.A_=this.d_}f_(e){this.cancel();const n=Math.floor(this.A_+this.g_()),r=Math.max(0,Date.now()-this.V_),s=Math.max(0,n-r);s>0&&Xe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.A_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.R_=this.xi.enqueueAfterDelay(this.timerId,s,()=>(this.V_=Date.now(),e())),this.A_*=this.E_,this.A_<this.I_&&(this.A_=this.I_),this.A_>this.d_&&(this.A_=this.d_)}p_(){this.R_!==null&&(this.R_.skipDelay(),this.R_=null)}cancel(){this.R_!==null&&(this.R_.cancel(),this.R_=null)}g_(){return(Math.random()-.5)*this.A_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y4="PersistentStream";class j9{constructor(e,n,r,s,i,o,l,c){this.xi=e,this.y_=r,this.w_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.S_=0,this.b_=null,this.D_=null,this.stream=null,this.v_=0,this.C_=new k9(e,n)}F_(){return this.state===1||this.state===5||this.M_()}M_(){return this.state===2||this.state===3}start(){this.v_=0,this.state!==4?this.auth():this.x_()}async stop(){this.F_()&&await this.close(0)}O_(){this.state=0,this.C_.reset()}N_(){this.M_()&&this.b_===null&&(this.b_=this.xi.enqueueAfterDelay(this.y_,6e4,()=>this.B_()))}L_(e){this.k_(),this.stream.send(e)}async B_(){if(this.M_())return this.close(0)}k_(){this.b_&&(this.b_.cancel(),this.b_=null)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}async close(e,n){this.k_(),this.q_(),this.C_.cancel(),this.S_++,e!==4?this.C_.reset():n&&n.code===Fe.RESOURCE_EXHAUSTED?(Ks(n.toString()),Ks("Using maximum backoff delay to prevent overloading the backend."),this.C_.m_()):n&&n.code===Fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Q_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(n)}Q_(){}auth(){this.state=1;const e=this.U_(this.S_),n=this.S_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.S_===n&&this.K_(r,s)},r=>{e(()=>{const s=new ut(Fe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.W_(s)})})}K_(e,n){const r=this.U_(this.S_);this.stream=this.G_(e,n),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.D_=this.xi.enqueueAfterDelay(this.w_,1e4,()=>(this.M_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(s=>{r(()=>this.W_(s))}),this.stream.onMessage(s=>{r(()=>++this.v_==1?this.z_(s):this.onNext(s))})}x_(){this.state=5,this.C_.f_(async()=>{this.state=0,this.start()})}W_(e){return Xe(Y4,`close with error: ${e}`),this.stream=null,this.close(4,e)}U_(e){return n=>{this.xi.enqueueAndForget(()=>this.S_===e?n():(Xe(Y4,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class vwe extends j9{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}G_(e,n){return this.connection.T_("Listen",e,n)}z_(e){return this.onNext(e)}onNext(e){this.C_.reset();const n=_ve(this.serializer,e),r=function(i){if(!("targetChange"in i))return jt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?jt.min():o.readTime?Xs(o.readTime):jt.min()}(e);return this.listener.j_(n,r)}H_(e){const n={};n.database=RT(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=Dw(c)?{documents:o9(i,c)}:{query:a9(i,c).gt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=t9(i,o.resumeToken);const u=kT(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(jt.min())>0){l.readTime=of(i,o.snapshotVersion.toTimestamp());const u=kT(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=Cve(this.serializer,e);r&&(n.labels=r),this.L_(n)}J_(e){const n={};n.database=RT(this.serializer),n.removeTarget=e,this.L_(n)}}class wwe extends j9{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Y_(){return this.v_>0}start(){this.lastStreamToken=void 0,super.start()}Q_(){this.Y_&&this.Z_([])}G_(e,n){return this.connection.T_("Write",e,n)}z_(e){return Nt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Nt(!e.writeResults||e.writeResults.length===0,55816),this.listener.X_()}onNext(e){Nt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.C_.reset();const n=Sve(e.writeResults,e.commitTime),r=Xs(e.commitTime);return this.listener.ea(r,n)}ta(){const e={};e.database=RT(this.serializer),this.L_(e)}Z_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Ow(this.serializer,r))};this.L_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bwe{}class _we extends bwe{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.na=!1}ra(){if(this.na)throw new ut(Fe.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,n,r,s){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.zo(e,jT(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ut(Fe.UNKNOWN,i.toString())})}Yo(e,n,r,s,i){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Yo(e,jT(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ut(Fe.UNKNOWN,o.toString())})}terminate(){this.na=!0,this.connection.terminate()}}class Swe{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.ia=0,this.sa=null,this.oa=!0}_a(){this.ia===0&&(this.aa("Unknown"),this.sa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.sa=null,this.ua("Backend didn't respond within 10 seconds."),this.aa("Offline"),Promise.resolve())))}ca(e){this.state==="Online"?this.aa("Unknown"):(this.ia++,this.ia>=1&&(this.la(),this.ua(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.aa("Offline")))}set(e){this.la(),this.ia=0,e==="Online"&&(this.oa=!1),this.aa(e)}aa(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ua(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.oa?(Ks(n),this.oa=!1):Xe("OnlineStateTracker",n)}la(){this.sa!==null&&(this.sa.cancel(),this.sa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sd="RemoteStore";class Cwe{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.ha=[],this.Pa=new Map,this.Ta=new Set,this.Ia=[],this.Ea=i,this.Ea.No(o=>{r.enqueueAndForget(async()=>{md(this)&&(Xe(sd,"Restarting streams for network reachability change."),await async function(c){const u=Xt(c);u.Ta.add(4),await ty(u),u.da.set("Unknown"),u.Ta.delete(4),await $b(u)}(this))})}),this.da=new Swe(r,s)}}async function $b(t){if(md(t))for(const e of t.Ia)await e(!0)}async function ty(t){for(const e of t.Ia)await e(!1)}function R9(t,e){const n=Xt(t);n.Pa.has(e.targetId)||(n.Pa.set(e.targetId,e),GP(n)?zP(n):Nf(n).M_()&&BP(n,e))}function UP(t,e){const n=Xt(t),r=Nf(n);n.Pa.delete(e),r.M_()&&D9(n,e),n.Pa.size===0&&(r.M_()?r.N_():md(n)&&n.da.set("Unknown"))}function BP(t,e){if(t.Aa.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(jt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Nf(t).H_(e)}function D9(t,e){t.Aa.Ke(e),Nf(t).J_(e)}function zP(t){t.Aa=new pve({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Pa.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),Nf(t).start(),t.da._a()}function GP(t){return md(t)&&!Nf(t).F_()&&t.Pa.size>0}function md(t){return Xt(t).Ta.size===0}function M9(t){t.Aa=void 0}async function Ewe(t){t.da.set("Online")}async function Twe(t){t.Pa.forEach((e,n)=>{BP(t,e)})}async function Iwe(t,e){M9(t),GP(t)?(t.da.ca(e),zP(t)):t.da.set("Unknown")}async function Nwe(t,e,n){if(t.da.set("Online"),e instanceof e9&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Pa.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Pa.delete(l),s.Aa.removeTarget(l))}(t,e)}catch(r){Xe(sd,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await zw(t,r)}else if(e instanceof mv?t.Aa.Xe(e):e instanceof Z8?t.Aa.ot(e):t.Aa.nt(e),!n.isEqual(jt.min()))try{const r=await P9(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Aa.It(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.Pa.get(u);d&&i.Pa.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.Pa.get(c);if(!d)return;i.Pa.set(c,d.withResumeToken(zr.EMPTY_BYTE_STRING,d.snapshotVersion)),D9(i,c);const h=new Wa(d.target,c,u,d.sequenceNumber);BP(i,h)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Xe(sd,"Failed to raise snapshot:",r),await zw(t,r)}}async function zw(t,e,n){if(!Hc(e))throw e;t.Ta.add(1),await ty(t),t.da.set("Offline"),n||(n=()=>P9(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Xe(sd,"Retrying IndexedDB access"),await n(),t.Ta.delete(1),await $b(t)})}function L9(t,e){return e().catch(n=>zw(t,n,e))}async function ny(t){const e=Xt(t),n=Ic(e);let r=e.ha.length>0?e.ha[e.ha.length-1].batchId:Mu;for(;Pwe(e);)try{const s=await uwe(e.localStore,r);if(s===null){e.ha.length===0&&n.N_();break}r=s.batchId,Awe(e,s)}catch(s){await zw(e,s)}F9(e)&&O9(e)}function Pwe(t){return md(t)&&t.ha.length<10}function Awe(t,e){t.ha.push(e);const n=Ic(t);n.M_()&&n.Y_&&n.Z_(e.mutations)}function F9(t){return md(t)&&!Ic(t).F_()&&t.ha.length>0}function O9(t){Ic(t).start()}async function kwe(t){Ic(t).ta()}async function jwe(t){const e=Ic(t);for(const n of t.ha)e.Z_(n.mutations)}async function Rwe(t,e,n){const r=t.ha.shift(),s=AP.from(r,e,n);await L9(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ny(t)}async function Dwe(t,e){e&&Ic(t).Y_&&await async function(r,s){if(function(o){return fve(o)&&o!==Fe.ABORTED}(s.code)){const i=r.ha.shift();Ic(r).O_(),await L9(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ny(r)}}(t,e),F9(t)&&O9(t)}async function J4(t,e){const n=Xt(t);n.asyncQueue.verifyOperationInProgress(),Xe(sd,"RemoteStore received new credentials");const r=md(n);n.Ta.add(3),await ty(n),r&&n.da.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ta.delete(3),await $b(n)}async function Mwe(t,e){const n=Xt(t);e?(n.Ta.delete(2),await $b(n)):e||(n.Ta.add(2),await ty(n),n.da.set("Unknown"))}function Nf(t){return t.Ra||(t.Ra=function(n,r,s){const i=Xt(n);return i.ra(),new vwe(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:Ewe.bind(null,t),n_:Twe.bind(null,t),i_:Iwe.bind(null,t),j_:Nwe.bind(null,t)}),t.Ia.push(async e=>{e?(t.Ra.O_(),GP(t)?zP(t):t.da.set("Unknown")):(await t.Ra.stop(),M9(t))})),t.Ra}function Ic(t){return t.Va||(t.Va=function(n,r,s){const i=Xt(n);return i.ra(),new wwe(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:kwe.bind(null,t),i_:Dwe.bind(null,t),X_:jwe.bind(null,t),ea:Rwe.bind(null,t)}),t.Ia.push(async e=>{e?(t.Va.O_(),await ny(t)):(await t.Va.stop(),t.ha.length>0&&(Xe(sd,`Stopping write stream with ${t.ha.length} pending writes`),t.ha=[]))})),t.Va}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ga,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new WP(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ut(Fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function HP(t,e){if(Ks("AsyncQueue",`${e}: ${t}`),Hc(t))return new ut(Fe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{static emptySet(e){return new kh(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||dt.comparator(n.key,r.key):(n,r)=>dt.comparator(n.key,r.key),this.keyedMap=Pm(),this.sortedSet=new lr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof kh)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new kh;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(){this.ma=new lr(dt.comparator)}track(e){const n=e.doc.key,r=this.ma.get(n);r?e.type!==0&&r.type===3?this.ma=this.ma.insert(n,e):e.type===3&&r.type!==1?this.ma=this.ma.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ma=this.ma.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ma=this.ma.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ma=this.ma.remove(n):e.type===1&&r.type===2?this.ma=this.ma.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ma=this.ma.insert(n,{type:2,doc:e.doc}):_t(63341,{Vt:e,fa:r}):this.ma=this.ma.insert(n,e)}ga(){const e=[];return this.ma.inorderTraversal((n,r)=>{e.push(r)}),e}}class af{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new af(e,n,kh.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ab(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lwe{constructor(){this.pa=void 0,this.ya=[]}wa(){return this.ya.some(e=>e.Sa())}}class Fwe{constructor(){this.queries=X4(),this.onlineState="Unknown",this.ba=new Set}terminate(){(function(n,r){const s=Xt(n),i=s.queries;s.queries=X4(),i.forEach((o,l)=>{for(const c of l.ya)c.onError(r)})})(this,new ut(Fe.ABORTED,"Firestore shutting down"))}}function X4(){return new xl(t=>$8(t),Ab)}async function qP(t,e){const n=Xt(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.wa()&&e.Sa()&&(r=2):(i=new Lwe,r=e.Sa()?0:1);try{switch(r){case 0:i.pa=await n.onListen(s,!0);break;case 1:i.pa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=HP(o,`Initialization of query '${Wd(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.ya.push(e),e.Da(n.onlineState),i.pa&&e.va(i.pa)&&YP(n)}async function KP(t,e){const n=Xt(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ya.indexOf(e);o>=0&&(i.ya.splice(o,1),i.ya.length===0?s=e.Sa()?0:1:!i.wa()&&e.Sa()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Owe(t,e){const n=Xt(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.ya)l.va(s)&&(r=!0);o.pa=s}}r&&YP(n)}function $we(t,e,n){const r=Xt(t),s=r.queries.get(e);if(s)for(const i of s.ya)i.onError(n);r.queries.delete(e)}function YP(t){t.ba.forEach(e=>{e.next()})}var VT,Z4;(Z4=VT||(VT={})).Ca="default",Z4.Cache="cache";class JP{constructor(e,n,r){this.query=e,this.Fa=n,this.Ma=!1,this.xa=null,this.onlineState="Unknown",this.options=r||{}}va(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new af(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Ma?this.Oa(e)&&(this.Fa.next(e),n=!0):this.Na(e,this.onlineState)&&(this.Ba(e),n=!0),this.xa=e,n}onError(e){this.Fa.error(e)}Da(e){this.onlineState=e;let n=!1;return this.xa&&!this.Ma&&this.Na(this.xa,e)&&(this.Ba(this.xa),n=!0),n}Na(e,n){if(!e.fromCache||!this.Sa())return!0;const r=n!=="Offline";return(!this.options.La||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Oa(e){if(e.docChanges.length>0)return!0;const n=this.xa&&this.xa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Ba(e){e=af.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Ma=!0,this.Fa.next(e)}Sa(){return this.options.source!==VT.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $9{constructor(e){this.key=e}}class V9{constructor(e){this.key=e}}class Vwe{constructor(e,n){this.query=e,this.Ga=n,this.za=null,this.hasCachedResults=!1,this.current=!1,this.ja=on(),this.mutatedKeys=on(),this.Ha=V8(e),this.Ja=new kh(this.Ha)}get Ya(){return this.Ga}Za(e,n){const r=n?n.Xa:new Q4,s=n?n.Ja:this.Ja;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,h)=>{const f=s.get(d),m=Zg(this.query,h)?h:null,g=!!f&&this.mutatedKeys.has(f.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let v=!1;f&&m?f.data.isEqual(m.data)?g!==x&&(r.track({type:3,doc:m}),v=!0):this.eu(f,m)||(r.track({type:2,doc:m}),v=!0,(c&&this.Ha(m,c)>0||u&&this.Ha(m,u)<0)&&(l=!0)):!f&&m?(r.track({type:0,doc:m}),v=!0):f&&!m&&(r.track({type:1,doc:f}),v=!0,(c||u)&&(l=!0)),v&&(m?(o=o.add(m),i=x?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ja:o,Xa:r,Cs:l,mutatedKeys:i}}eu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ja;this.Ja=e.Ja,this.mutatedKeys=e.mutatedKeys;const o=e.Xa.ga();o.sort((d,h)=>function(m,g){const x=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _t(20277,{Vt:v})}};return x(m)-x(g)}(d.type,h.type)||this.Ha(d.doc,h.doc)),this.tu(r),s=s!=null&&s;const l=n&&!s?this.nu():[],c=this.ja.size===0&&this.current&&!s?1:0,u=c!==this.za;return this.za=c,o.length!==0||u?{snapshot:new af(this.query,e.Ja,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),ru:l}:{ru:l}}Da(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ja:this.Ja,Xa:new Q4,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ru:[]}}iu(e){return!this.Ga.has(e)&&!!this.Ja.has(e)&&!this.Ja.get(e).hasLocalMutations}tu(e){e&&(e.addedDocuments.forEach(n=>this.Ga=this.Ga.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ga=this.Ga.delete(n)),this.current=e.current)}nu(){if(!this.current)return[];const e=this.ja;this.ja=on(),this.Ja.forEach(r=>{this.iu(r.key)&&(this.ja=this.ja.add(r.key))});const n=[];return e.forEach(r=>{this.ja.has(r)||n.push(new V9(r))}),this.ja.forEach(r=>{e.has(r)||n.push(new $9(r))}),n}su(e){this.Ga=e.$s,this.ja=on();const n=this.Za(e.documents);return this.applyChanges(n,!0)}ou(){return af.fromInitialDocuments(this.query,this.Ja,this.mutatedKeys,this.za===0,this.hasCachedResults)}}const QP="SyncEngine";class Uwe{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Bwe{constructor(e){this.key=e,this._u=!1}}class zwe{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.au={},this.uu=new xl(l=>$8(l),Ab),this.cu=new Map,this.lu=new Set,this.hu=new lr(dt.comparator),this.Pu=new Map,this.Tu=new LP,this.Iu={},this.Eu=new Map,this.du=rd.lr(),this.onlineState="Unknown",this.Au=void 0}get isPrimaryClient(){return this.Au===!0}}async function Gwe(t,e,n=!0){const r=H9(t);let s;const i=r.uu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.ou()):s=await U9(r,e,n,!0),s}async function Wwe(t,e){const n=H9(t);await U9(n,e,!0,!1)}async function U9(t,e,n,r){const s=await dwe(t.localStore,ho(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await Hwe(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&R9(t.remoteStore,s),l}async function Hwe(t,e,n,r,s){t.Ru=(h,f,m)=>async function(x,v,w,_){let C=v.view.Za(w);C.Cs&&(C=await W4(x.localStore,v.query,!1).then(({documents:E})=>v.view.Za(E,C)));const T=_&&_.targetChanges.get(v.targetId),j=_&&_.targetMismatches.get(v.targetId)!=null,A=v.view.applyChanges(C,x.isPrimaryClient,T,j);return tL(x,v.targetId,A.ru),A.snapshot}(t,h,f,m);const i=await W4(t.localStore,e,!0),o=new Vwe(e,i.$s),l=o.Za(i.documents),c=ey.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);tL(t,n,u.ru);const d=new Uwe(e,n,o);return t.uu.set(e,d),t.cu.has(n)?t.cu.get(n).push(e):t.cu.set(n,[e]),u.snapshot}async function qwe(t,e,n){const r=Xt(t),s=r.uu.get(e),i=r.cu.get(s.targetId);if(i.length>1)return r.cu.set(s.targetId,i.filter(o=>!Ab(o,e))),void r.uu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await OT(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&UP(r.remoteStore,s.targetId),UT(r,s.targetId)}).catch(fd)):(UT(r,s.targetId),await OT(r.localStore,s.targetId,!0))}async function Kwe(t,e){const n=Xt(t),r=n.uu.get(e),s=n.cu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),UP(n.remoteStore,r.targetId))}async function Ywe(t,e,n){const r=q9(t);try{const s=await function(o,l){const c=Xt(o),u=gr.now(),d=l.reduce((m,g)=>m.add(g.key),on());let h,f;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=$i(),x=on();return c.Bs.getEntries(m,d).next(v=>{g=v,g.forEach((w,_)=>{_.isValidDocument()||(x=x.add(w))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,g)).next(v=>{h=v;const w=[];for(const _ of l){const C=dve(_,h.get(_.key).overlayedDocument);C!=null&&w.push(new vl(_.key,C,A8(C.value.mapValue),Js.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,w,l)}).next(v=>{f=v;const w=v.applyToLocalDocumentSet(h,x);return c.documentOverlayCache.saveOverlays(m,v.batchId,w)})}).then(()=>({batchId:f.batchId,changes:B8(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Iu[o.currentUser.toKey()];u||(u=new lr(Wt)),u=u.insert(l,c),o.Iu[o.currentUser.toKey()]=u}(r,s.batchId,n),await ry(r,s.changes),await ny(r.remoteStore)}catch(s){const i=HP(s,"Failed to persist write");n.reject(i)}}async function B9(t,e){const n=Xt(t);try{const r=await lwe(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Pu.get(i);o&&(Nt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o._u=!0:s.modifiedDocuments.size>0?Nt(o._u,14607):s.removedDocuments.size>0&&(Nt(o._u,42227),o._u=!1))}),await ry(n,r,e)}catch(r){await fd(r)}}function eL(t,e,n){const r=Xt(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.uu.forEach((i,o)=>{const l=o.view.Da(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=Xt(o);c.onlineState=l;let u=!1;c.queries.forEach((d,h)=>{for(const f of h.ya)f.Da(l)&&(u=!0)}),u&&YP(c)}(r.eventManager,e),s.length&&r.au.j_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Jwe(t,e,n){const r=Xt(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Pu.get(e),i=s&&s.key;if(i){let o=new lr(dt.comparator);o=o.insert(i,Tr.newNoDocument(i,jt.min()));const l=on().add(i),c=new Db(jt.min(),new Map,new lr(Wt),o,l);await B9(r,c),r.hu=r.hu.remove(i),r.Pu.delete(e),XP(r)}else await OT(r.localStore,e,!1).then(()=>UT(r,e,n)).catch(fd)}async function Qwe(t,e){const n=Xt(t),r=e.batch.batchId;try{const s=await awe(n.localStore,e);G9(n,r,null),z9(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ry(n,s)}catch(s){await fd(s)}}async function Xwe(t,e,n){const r=Xt(t);try{const s=await function(o,l){const c=Xt(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(h=>(Nt(h!==null,37113),d=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);G9(r,e,n),z9(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ry(r,s)}catch(s){await fd(s)}}function z9(t,e){(t.Eu.get(e)||[]).forEach(n=>{n.resolve()}),t.Eu.delete(e)}function G9(t,e,n){const r=Xt(t);let s=r.Iu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Iu[r.currentUser.toKey()]=s}}function UT(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.cu.get(e))t.uu.delete(r),n&&t.au.Vu(r,n);t.cu.delete(e),t.isPrimaryClient&&t.Tu.Hr(e).forEach(r=>{t.Tu.containsKey(r)||W9(t,r)})}function W9(t,e){t.lu.delete(e.path.canonicalString());const n=t.hu.get(e);n!==null&&(UP(t.remoteStore,n),t.hu=t.hu.remove(e),t.Pu.delete(n),XP(t))}function tL(t,e,n){for(const r of n)r instanceof $9?(t.Tu.addReference(r.key,e),Zwe(t,r)):r instanceof V9?(Xe(QP,"Document no longer in limbo: "+r.key),t.Tu.removeReference(r.key,e),t.Tu.containsKey(r.key)||W9(t,r.key)):_t(19791,{mu:r})}function Zwe(t,e){const n=e.key,r=n.path.canonicalString();t.hu.get(n)||t.lu.has(r)||(Xe(QP,"New document in limbo: "+n),t.lu.add(r),XP(t))}function XP(t){for(;t.lu.size>0&&t.hu.size<t.maxConcurrentLimboResolutions;){const e=t.lu.values().next().value;t.lu.delete(e);const n=new dt(Tn.fromString(e)),r=t.du.next();t.Pu.set(r,new Bwe(n)),t.hu=t.hu.insert(n,r),R9(t.remoteStore,new Wa(ho(Xg(n.path)),r,"TargetPurposeLimboResolution",lo.le))}}async function ry(t,e,n){const r=Xt(t),s=[],i=[],o=[];r.uu.isEmpty()||(r.uu.forEach((l,c)=>{o.push(r.Ru(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const h=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){s.push(u);const h=$P.Rs(c.targetId,u);i.push(h)}}))}),await Promise.all(o),r.au.j_(s),await async function(c,u){const d=Xt(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ye.forEach(u,f=>ye.forEach(f.ds,m=>d.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>ye.forEach(f.As,m=>d.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!Hc(h))throw h;Xe(VP,"Failed to update sequence numbers: "+h)}for(const h of u){const f=h.targetId;if(!h.fromCache){const m=d.xs.get(f),g=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(g);d.xs=d.xs.insert(f,x)}}}(r.localStore,i))}async function e0e(t,e){const n=Xt(t);if(!n.currentUser.isEqual(e)){Xe(QP,"User change. New user:",e.toKey());const r=await N9(n.localStore,e);n.currentUser=e,function(i,o){i.Eu.forEach(l=>{l.forEach(c=>{c.reject(new ut(Fe.CANCELLED,o))})}),i.Eu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ry(n,r.ks)}}function t0e(t,e){const n=Xt(t),r=n.Pu.get(e);if(r&&r._u)return on().add(r.key);{let s=on();const i=n.cu.get(e);if(!i)return s;for(const o of i){const l=n.uu.get(o);s=s.unionWith(l.view.Ya)}return s}}function H9(t){const e=Xt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=B9.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=t0e.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Jwe.bind(null,e),e.au.j_=Owe.bind(null,e.eventManager),e.au.Vu=$we.bind(null,e.eventManager),e}function q9(t){const e=Xt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Qwe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Xwe.bind(null,e),e}class og{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ob(e.databaseInfo.databaseId),this.sharedClientState=this.pu(e),this.persistence=this.yu(e),await this.persistence.start(),this.localStore=this.wu(e),this.gcScheduler=this.Su(e,this.localStore),this.indexBackfillerScheduler=this.bu(e,this.localStore)}Su(e,n){return null}bu(e,n){return null}wu(e){return I9(this.persistence,new T9,e.initialUser,this.serializer)}yu(e){return new FP(Fb.fi,this.serializer)}pu(e){return new A9}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}og.provider={build:()=>new og};class n0e extends og{constructor(e){super(),this.cacheSizeBytes=e}Su(e,n){Nt(this.persistence.referenceDelegate instanceof Bw,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new b9(r,e.asyncQueue,n)}yu(e){const n=this.cacheSizeBytes!==void 0?As.withCacheSize(this.cacheSizeBytes):As.DEFAULT;return new FP(r=>Bw.fi(r,n),this.serializer)}}class r0e extends og{constructor(e,n,r){super(),this.Du=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Du.initialize(this,e),await q9(this.Du.syncEngine),await ny(this.Du.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}wu(e){return I9(this.persistence,new T9,e.initialUser,this.serializer)}Su(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new b9(r,e.asyncQueue,n)}bu(e,n){const r=new cxe(n,this.persistence);return new lxe(e.asyncQueue,r)}yu(e){const n=rwe(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?As.withCacheSize(this.cacheSizeBytes):As.DEFAULT;return new OP(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,xwe(),gv(),this.serializer,this.sharedClientState,!!this.forceOwnership)}pu(e){return new A9}}class Gw{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>eL(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=e0e.bind(null,this.syncEngine),await Mwe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Fwe}()}createDatastore(e){const n=Ob(e.databaseInfo.databaseId),r=function(i){return new ywe(i)}(e.databaseInfo);return function(i,o,l,c){return new _we(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new Cwe(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>eL(this.syncEngine,n,0),function(){return K4.C()?new K4:new fwe}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,d){const h=new zwe(s,i,o,l,c,u);return d&&(h.Au=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Xt(s);Xe(sd,"RemoteStore shutting down."),i.Ta.add(5),await ty(i),i.Ea.shutdown(),i.da.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Gw.provider={build:()=>new Gw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.vu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.vu(this.observer.error,e):Ks("Uncaught Error in snapshot listener:",e.toString()))}Cu(){this.muted=!0}vu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc="FirestoreClient";class s0e{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=ms.UNAUTHENTICATED,this.clientId=i8.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Xe(Nc,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Xe(Nc,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ga;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=HP(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function zS(t,e){t.asyncQueue.verifyOperationInProgress(),Xe(Nc,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await N9(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function nL(t,e){t.asyncQueue.verifyOperationInProgress();const n=await i0e(t);Xe(Nc,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>J4(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>J4(e.remoteStore,s)),t._onlineComponents=e}async function i0e(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Xe(Nc,"Using user provided OfflineComponentProvider");try{await zS(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===Fe.FAILED_PRECONDITION||s.code===Fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Xu("Error using user provided cache. Falling back to memory cache: "+n),await zS(t,new og)}}else Xe(Nc,"Using default OfflineComponentProvider"),await zS(t,new n0e(void 0));return t._offlineComponents}async function K9(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Xe(Nc,"Using user provided OnlineComponentProvider"),await nL(t,t._uninitializedComponentsProvider._online)):(Xe(Nc,"Using default OnlineComponentProvider"),await nL(t,new Gw))),t._onlineComponents}function o0e(t){return K9(t).then(e=>e.syncEngine)}async function Ww(t){const e=await K9(t),n=e.eventManager;return n.onListen=Gwe.bind(null,e.syncEngine),n.onUnlisten=qwe.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Wwe.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Kwe.bind(null,e.syncEngine),n}function a0e(t,e,n={}){const r=new ga;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new ZP({next:f=>{d.Cu(),o.enqueueAndForget(()=>KP(i,h));const m=f.docs.has(l);!m&&f.fromCache?u.reject(new ut(Fe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&c&&c.source==="server"?u.reject(new ut(Fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new JP(Xg(l.path),d,{includeMetadataChanges:!0,La:!0});return qP(i,h)}(await Ww(t),t.asyncQueue,e,n,r)),r.promise}function l0e(t,e,n={}){const r=new ga;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new ZP({next:f=>{d.Cu(),o.enqueueAndForget(()=>KP(i,h)),f.fromCache&&c.source==="server"?u.reject(new ut(Fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new JP(l,d,{includeMetadataChanges:!0,La:!0});return qP(i,h)}(await Ww(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y9(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rL=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J9(t,e,n){if(!n)throw new ut(Fe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function c0e(t,e,n,r){if(e===!0&&r===!0)throw new ut(Fe.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function sL(t){if(!dt.isDocumentKey(t))throw new ut(Fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function iL(t){if(dt.isDocumentKey(t))throw new ut(Fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Vb(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":_t(12329,{type:typeof t})}function xi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ut(Fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Vb(t);throw new ut(Fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function u0e(t,e){if(e<=0)throw new ut(Fe.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q9="firestore.googleapis.com",oL=!0;class aL{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ut(Fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Q9,this.ssl=oL}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:oL;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=y9;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Vve)throw new ut(Fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}c0e("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Y9((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ut(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ut(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ut(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ub{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new aL({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ut(Fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ut(Fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new aL(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Jye;switch(r.type){case"firstParty":return new exe(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ut(Fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=rL.get(n);r&&(Xe("ComponentProvider","Removing Datastore"),rL.delete(n),r.terminate())}(this),Promise.resolve()}}function d0e(t,e,n,r={}){var s;t=xi(t,Ub);const i=Bc(e),o=t._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),c=`${e}:${n}`;i&&(yb(`https://${c}`),xb("Firestore",!0)),o.host!==Q9&&o.host!==c&&Xu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},o),{host:c,ssl:i,emulatorOptions:r});if(!Ku(u,l)&&(t._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=ms.MOCK_USER;else{d=az(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new ut(Fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new ms(f)}t._authCredentials=new Qye(new r8(d,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Kc(this.firestore,e,this._query)}}class Ms{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ms(this.firestore,e,this._key)}}class fc extends Kc{constructor(e,n,r){super(e,n,Xg(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ms(this.firestore,null,new dt(e))}withConverter(e){return new fc(this.firestore,e,this._path)}}function Yo(t,e,...n){if(t=qn(t),J9("collection","path",e),t instanceof Ub){const r=Tn.fromString(e,...n);return iL(r),new fc(t,null,r)}{if(!(t instanceof Ms||t instanceof fc))throw new ut(Fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Tn.fromString(e,...n));return iL(r),new fc(t.firestore,null,r)}}function ki(t,e,...n){if(t=qn(t),arguments.length===1&&(e=i8.newId()),J9("doc","path",e),t instanceof Ub){const r=Tn.fromString(e,...n);return sL(r),new Ms(t,null,new dt(r))}{if(!(t instanceof Ms||t instanceof fc))throw new ut(Fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Tn.fromString(e,...n));return sL(r),new Ms(t.firestore,t instanceof fc?t.converter:null,new dt(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lL="AsyncQueue";class cL{constructor(e=Promise.resolve()){this.zu=[],this.ju=!1,this.Hu=[],this.Ju=null,this.Yu=!1,this.Zu=!1,this.Xu=[],this.C_=new k9(this,"async_queue_retry"),this.ec=()=>{const r=gv();r&&Xe(lL,"Visibility state changed to "+r.visibilityState),this.C_.p_()},this.tc=e;const n=gv();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.ec)}get isShuttingDown(){return this.ju}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nc(),this.rc(e)}enterRestrictedMode(e){if(!this.ju){this.ju=!0,this.Zu=e||!1;const n=gv();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.ec)}}enqueue(e){if(this.nc(),this.ju)return new Promise(()=>{});const n=new ga;return this.rc(()=>this.ju&&this.Zu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.zu.push(e),this.sc()))}async sc(){if(this.zu.length!==0){try{await this.zu[0](),this.zu.shift(),this.C_.reset()}catch(e){if(!Hc(e))throw e;Xe(lL,"Operation failed with retryable error: "+e)}this.zu.length>0&&this.C_.f_(()=>this.sc())}}rc(e){const n=this.tc.then(()=>(this.Yu=!0,e().catch(r=>{throw this.Ju=r,this.Yu=!1,Ks("INTERNAL UNHANDLED ERROR: ",uL(r)),r}).then(r=>(this.Yu=!1,r))));return this.tc=n,n}enqueueAfterDelay(e,n,r){this.nc(),this.Xu.indexOf(e)>-1&&(n=0);const s=WP.createAndSchedule(this,e,n,r,i=>this.oc(i));return this.Hu.push(s),s}nc(){this.Ju&&_t(47125,{_c:uL(this.Ju)})}verifyOperationInProgress(){}async ac(){let e;do e=this.tc,await e;while(e!==this.tc)}uc(e){for(const n of this.Hu)if(n.timerId===e)return!0;return!1}cc(e){return this.ac().then(()=>{this.Hu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Hu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.ac()})}lc(e){this.Xu.push(e)}oc(e){const n=this.Hu.indexOf(e);this.Hu.splice(n,1)}}function uL(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dL(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h0e=-1;class cl extends Ub{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new cL,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new cL(e),this._firestoreClient=void 0,await e}}}function f0e(t,e){const n=typeof t=="object"?t:vb(),r=typeof t=="string"?t:e||jw,s=Gg(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=sP("firestore");i&&d0e(s,...i)}return s}function Bb(t){if(t._terminated)throw new ut(Fe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||X9(t),t._firestoreClient}function X9(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new Oxe(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Y9(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new s0e(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function m0e(t,e){Xu("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return p0e(t,Gw.provider,{build:r=>new r0e(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function p0e(t,e,n){if((t=xi(t,cl))._firestoreClient||t._terminated)throw new ut(Fe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new ut(Fe.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},X9(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new lf(zr.fromBase64String(e))}catch(n){throw new ut(Fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new lf(zr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ut(Fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ut(Fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ut(Fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Wt(this._lat,e._lat)||Wt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0e=/^__.*__$/;class y0e{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new vl(e,this.data,this.fieldMask,n,this.fieldTransforms):new If(e,this.data,n,this.fieldTransforms)}}class Z9{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new vl(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function eG(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _t(40011,{hc:t})}}class rA{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Pc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get hc(){return this.settings.hc}Tc(e){return new rA(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ic(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tc({path:r,Ec:!1});return s.dc(e),s}Ac(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tc({path:r,Ec:!1});return s.Pc(),s}Rc(e){return this.Tc({path:void 0,Ec:!0})}Vc(e){return Hw(e,this.settings.methodName,this.settings.mc||!1,this.path,this.settings.fc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pc(){if(this.path)for(let e=0;e<this.path.length;e++)this.dc(this.path.get(e))}dc(e){if(e.length===0)throw this.Vc("Document fields must not be empty");if(eG(this.hc)&&g0e.test(e))throw this.Vc('Document fields cannot begin and end with "__"')}}class x0e{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Ob(e)}gc(e,n,r,s=!1){return new rA({hc:e,methodName:n,fc:r,path:mr.emptyPath(),Ec:!1,mc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function sA(t){const e=t._freezeSettings(),n=Ob(t._databaseId);return new x0e(t._databaseId,!!e.ignoreUndefinedProperties,n)}function v0e(t,e,n,r,s,i={}){const o=t.gc(i.merge||i.mergeFields?2:0,e,n,s);iA("Data must be an object, but it was:",o,r);const l=tG(r,o);let c,u;if(i.merge)c=new fi(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const f=BT(e,h,n);if(!o.contains(f))throw new ut(Fe.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);rG(d,f)||d.push(f)}c=new fi(d),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new y0e(new Rs(l),c,u)}class Gb extends eA{_toFieldTransform(e){if(e.hc!==2)throw e.hc===1?e.Vc(`${this._methodName}() can only appear at the top level of your update data`):e.Vc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Gb}}function w0e(t,e,n,r){const s=t.gc(1,e,n);iA("Data must be an object, but it was:",s,r);const i=[],o=Rs.empty();qc(r,(c,u)=>{const d=oA(e,c,n);u=qn(u);const h=s.Ac(d);if(u instanceof Gb)i.push(d);else{const f=sy(u,h);f!=null&&(i.push(d),o.set(d,f))}});const l=new fi(i);return new Z9(o,l,s.fieldTransforms)}function b0e(t,e,n,r,s,i){const o=t.gc(1,e,n),l=[BT(e,r,n)],c=[s];if(i.length%2!=0)throw new ut(Fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)l.push(BT(e,i[f])),c.push(i[f+1]);const u=[],d=Rs.empty();for(let f=l.length-1;f>=0;--f)if(!rG(u,l[f])){const m=l[f];let g=c[f];g=qn(g);const x=o.Ac(m);if(g instanceof Gb)u.push(m);else{const v=sy(g,x);v!=null&&(u.push(m),d.set(m,v))}}const h=new fi(u);return new Z9(d,h,o.fieldTransforms)}function _0e(t,e,n,r=!1){return sy(n,t.gc(r?4:3,e))}function sy(t,e){if(nG(t=qn(t)))return iA("Unsupported field value:",e,t),tG(t,e);if(t instanceof eA)return function(r,s){if(!eG(s.hc))throw s.Vc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Vc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Ec&&e.hc!==4)throw e.Vc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=sy(l,s.Rc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=qn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return sve(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=gr.fromDate(r);return{timestampValue:of(s.serializer,i)}}if(r instanceof gr){const i=new gr(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:of(s.serializer,i)}}if(r instanceof tA)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof lf)return{bytesValue:t9(s.serializer,r._byteString)};if(r instanceof Ms){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Vc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:RP(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof nA)return function(o,l){return{mapValue:{fields:{[EP]:{stringValue:TP},[Zh]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Vc("VectorValues must only contain numeric values.");return NP(l.serializer,u)})}}}}}}(r,s);throw s.Vc(`Unsupported field value: ${Vb(r)}`)}(t,e)}function tG(t,e){const n={};return b8(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qc(t,(r,s)=>{const i=sy(s,e.Ic(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function nG(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof gr||t instanceof tA||t instanceof lf||t instanceof Ms||t instanceof eA||t instanceof nA)}function iA(t,e,n){if(!nG(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Vb(n);throw r==="an object"?e.Vc(t+" a custom object"):e.Vc(t+" "+r)}}function BT(t,e,n){if((e=qn(e))instanceof zb)return e._internalPath;if(typeof e=="string")return oA(t,e);throw Hw("Field path arguments must be of type string or ",t,!1,void 0,n)}const S0e=new RegExp("[~\\*/\\[\\]]");function oA(t,e,n){if(e.search(S0e)>=0)throw Hw(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new zb(...e.split("."))._internalPath}catch{throw Hw(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Hw(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new ut(Fe.INVALID_ARGUMENT,l+t+c)}function rG(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sG{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ms(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new C0e(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(aA("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class C0e extends sG{data(){return super.data()}}function aA(t,e){return typeof e=="string"?oA(t,e):e instanceof zb?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iG(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ut(Fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lA{}class oG extends lA{}function zT(t,e,...n){let r=[];e instanceof lA&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof cA).length,l=i.filter(c=>c instanceof Wb).length;if(o>1||o>0&&l>0)throw new ut(Fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Wb extends oG{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Wb(e,n,r)}_apply(e){const n=this._parse(e);return aG(e._query,n),new Kc(e.firestore,e.converter,AT(e._query,n))}_parse(e){const n=sA(e.firestore);return function(i,o,l,c,u,d,h){let f;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new ut(Fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){fL(h,d);const g=[];for(const x of h)g.push(hL(c,i,x));f={arrayValue:{values:g}}}else f=hL(c,i,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||fL(h,d),f=_0e(l,o,h,d==="in"||d==="not-in");return hn.create(u,d,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function GT(t,e,n){const r=e,s=aA("where",t);return Wb._create(s,r,n)}class cA extends lA{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new cA(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:An.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)aG(o,c),o=AT(o,c)}(e._query,n),new Kc(e.firestore,e.converter,AT(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class uA extends oG{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new uA(e,n,r)}_apply(e){return new Kc(e.firestore,e.converter,Lw(e._query,this._limit,this._limitType))}}function E0e(t){return u0e("limit",t),uA._create("limit",t,"F")}function hL(t,e,n){if(typeof(n=qn(n))=="string"){if(n==="")throw new ut(Fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!O8(e)&&n.indexOf("/")!==-1)throw new ut(Fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Tn.fromString(n));if(!dt.isDocumentKey(r))throw new ut(Fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ng(t,new dt(r))}if(n instanceof Ms)return ng(t,n._key);throw new ut(Fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vb(n)}.`)}function fL(t,e){if(!Array.isArray(t)||t.length===0)throw new ut(Fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function aG(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ut(Fe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ut(Fe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class T0e{convertValue(e,n="none"){switch(Ec(e)){case 0:return null;case 1:return e.booleanValue;case 2:return sr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ll(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw _t(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return qc(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[Zh].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>sr(o.doubleValue));return new nA(i)}convertGeoPoint(e){return new tA(sr(e.latitude),sr(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Nb(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(eg(e));default:return null}}convertTimestamp(e){const n=al(e);return new gr(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Tn.fromString(e);Nt(d9(r),9688,{name:e});const s=new Zu(r.get(1),r.get(3)),i=new dt(r.popFirst(5));return s.isEqual(n)||Ks(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I0e(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class lG extends sG{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new yv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(aA("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class yv extends lG{data(e={}){return super.data(e)}}class cG{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new jm(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new yv(this._firestore,this._userDataWriter,r.key,r,new jm(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ut(Fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new yv(s._firestore,s._userDataWriter,l.doc.key,l.doc,new jm(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new yv(s._firestore,s._userDataWriter,l.doc.key,l.doc,new jm(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:N0e(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function N0e(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _t(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0e(t){t=xi(t,Ms);const e=xi(t.firestore,cl);return a0e(Bb(e),t._key).then(n=>uG(e,t,n))}class dA extends T0e{constructor(e){super(),this.firestore=e}convertBytes(e){return new lf(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ms(this.firestore,null,n)}}function Jo(t){t=xi(t,Kc);const e=xi(t.firestore,cl),n=Bb(e),r=new dA(e);return iG(t._query),l0e(n,t._query).then(s=>new cG(e,r,t,s))}function dp(t,e,n){t=xi(t,Ms);const r=xi(t.firestore,cl),s=I0e(t.converter,e,n);return hA(r,[v0e(sA(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Js.none())])}function px(t,e,n,...r){t=xi(t,Ms);const s=xi(t.firestore,cl),i=sA(s);let o;return o=typeof(e=qn(e))=="string"||e instanceof zb?b0e(i,"updateDoc",t._key,e,n,r):w0e(i,"updateDoc",t._key,e),hA(s,[o.toMutation(t._key,Js.exists(!0))])}function GS(t){return hA(xi(t.firestore,cl),[new Rb(t._key,Js.none())])}function A0e(t,...e){var n,r,s;t=qn(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||dL(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(dL(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let c,u,d;if(t instanceof Ms)u=xi(t.firestore,cl),d=Xg(t._key.path),c={next:h=>{e[o]&&e[o](uG(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=xi(t,Kc);u=xi(h.firestore,cl),d=h._query;const f=new dA(u);c={next:m=>{e[o]&&e[o](new cG(u,f,h,m))},error:e[o+1],complete:e[o+2]},iG(t._query)}return function(f,m,g,x){const v=new ZP(x),w=new JP(m,v,g);return f.asyncQueue.enqueueAndForget(async()=>qP(await Ww(f),w)),()=>{v.Cu(),f.asyncQueue.enqueueAndForget(async()=>KP(await Ww(f),w))}}(Bb(u),d,l,c)}function hA(t,e){return function(r,s){const i=new ga;return r.asyncQueue.enqueueAndForget(async()=>Ywe(await o0e(r),s,i)),i.promise}(Bb(t),e)}function uG(t,e,n){const r=n.docs.get(e._key),s=new dA(t);return new lG(t,s,e._key,r,new jm(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){Tf=s})(hd),Cc(new sl("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new cl(new Xye(r.getProvider("auth-internal")),new txe(o,r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ut(Fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zu(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),uo(WM,HM,e),uo(WM,HM,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dG="firebasestorage.googleapis.com",hG="storageBucket",k0e=2*60*1e3,j0e=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr extends Go{constructor(e,n,r=0){super(WS(e),`Firebase Storage: ${n} (${WS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,jr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return WS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var kr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(kr||(kr={}));function WS(t){return"storage/"+t}function fA(){const t="An unknown error occurred, please check the error payload for server response.";return new jr(kr.UNKNOWN,t)}function R0e(t){return new jr(kr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function D0e(t){return new jr(kr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function M0e(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new jr(kr.UNAUTHENTICATED,t)}function L0e(){return new jr(kr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function F0e(t){return new jr(kr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function O0e(){return new jr(kr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function $0e(){return new jr(kr.CANCELED,"User canceled the upload/download.")}function V0e(t){return new jr(kr.INVALID_URL,"Invalid URL '"+t+"'.")}function U0e(t){return new jr(kr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function B0e(){return new jr(kr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+hG+"' property when initializing the app?")}function z0e(){return new jr(kr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function G0e(){return new jr(kr.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function W0e(t){return new jr(kr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function WT(t){return new jr(kr.INVALID_ARGUMENT,t)}function fG(){return new jr(kr.APP_DELETED,"The Firebase app was deleted.")}function H0e(t){return new jr(kr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function hp(t,e){return new jr(kr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function am(t){throw new jr(kr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Vi.makeFromUrl(e,n)}catch{return new Vi(e,"")}if(r.path==="")return r;throw U0e(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(T){T.path.charAt(T.path.length-1)==="/"&&(T.path_=T.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function u(T){T.path_=decodeURIComponent(T.path)}const d="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${d}/b/${s}/o${f}`,"i"),g={bucket:1,path:3},x=n===dG?"(?:storage.googleapis.com|storage.cloud.google.com)":n,v="([^?#]*)",w=new RegExp(`^https?://${x}/${s}/${v}`,"i"),C=[{regex:l,indices:c,postModify:i},{regex:m,indices:g,postModify:u},{regex:w,indices:{bucket:1,path:2},postModify:u}];for(let T=0;T<C.length;T++){const j=C[T],A=j.regex.exec(e);if(A){const E=A[j.indices.bucket];let I=A[j.indices.path];I||(I=""),r=new Vi(E,I),j.postModify(r);break}}if(r==null)throw V0e(e);return r}}class q0e{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K0e(t,e,n){let r=1,s=null,i=null,o=!1,l=0;function c(){return l===2}let u=!1;function d(...v){u||(u=!0,e.apply(null,v))}function h(v){s=setTimeout(()=>{s=null,t(m,c())},v)}function f(){i&&clearTimeout(i)}function m(v,...w){if(u){f();return}if(v){f(),d.call(null,v,...w);return}if(c()||o){f(),d.call(null,v,...w);return}r<64&&(r*=2);let C;l===1?(l=2,C=0):C=(r+Math.random())*1e3,h(C)}let g=!1;function x(v){g||(g=!0,f(),!u&&(s!==null?(v||(l=2),clearTimeout(s),h(0)):v||(l=1)))}return h(0),i=setTimeout(()=>{o=!0,x(!0)},n),x}function Y0e(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J0e(t){return t!==void 0}function Q0e(t){return typeof t=="object"&&!Array.isArray(t)}function mA(t){return typeof t=="string"||t instanceof String}function mL(t){return pA()&&t instanceof Blob}function pA(){return typeof Blob<"u"}function pL(t,e,n,r){if(r<e)throw WT(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw WT(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gA(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function mG(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Ou;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Ou||(Ou={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X0e(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0e{constructor(e,n,r,s,i,o,l,c,u,d,h,f=!0,m=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,x)=>{this.resolve_=g,this.reject_=x,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new gx(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===Ou.NO_ERROR,c=i.getStatus();if(!l||X0e(c,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===Ou.ABORT;r(!1,new gx(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new gx(u,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());J0e(c)?i(c):i()}catch(c){o(c)}else if(l!==null){const c=fA();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(s.canceled){const c=this.appDelete_?fG():$0e();o(c)}else{const c=O0e();o(c)}};this.canceled_?n(!1,new gx(!1,null,!0)):this.backoffId_=K0e(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Y0e(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class gx{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function ebe(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function tbe(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function nbe(t,e){e&&(t["X-Firebase-GMPID"]=e)}function rbe(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function sbe(t,e,n,r,s,i,o=!0,l=!1){const c=mG(t.urlParams),u=t.url+c,d=Object.assign({},t.headers);return nbe(d,e),ebe(d,n),tbe(d,i),rbe(d,r),new Z0e(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ibe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function obe(...t){const e=ibe();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(pA())return new Blob(t);throw new jr(kr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function abe(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lbe(t){if(typeof atob>"u")throw W0e("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class HS{constructor(e,n){this.data=e,this.contentType=n||null}}function cbe(t,e){switch(t){case la.RAW:return new HS(pG(e));case la.BASE64:case la.BASE64URL:return new HS(gG(t,e));case la.DATA_URL:return new HS(dbe(e),hbe(e))}throw fA()}function pG(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function ube(t){let e;try{e=decodeURIComponent(t)}catch{throw hp(la.DATA_URL,"Malformed data URL.")}return pG(e)}function gG(t,e){switch(t){case la.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw hp(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case la.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw hp(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=lbe(e)}catch(s){throw s.message.includes("polyfill")?s:hp(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class yG{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw hp(la.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=fbe(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function dbe(t){const e=new yG(t);return e.base64?gG(la.BASE64,e.rest):ube(e.rest)}function hbe(t){return new yG(t).contentType}function fbe(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(e,n){let r=0,s="";mL(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(mL(this.data_)){const r=this.data_,s=abe(r,e,n);return s===null?null:new Wl(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Wl(r,!0)}}static getBlob(...e){if(pA()){const n=e.map(r=>r instanceof Wl?r.data_:r);return new Wl(obe.apply(null,n))}else{const n=e.map(o=>mA(o)?cbe(la.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new Wl(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xG(t){let e;try{e=JSON.parse(t)}catch{return null}return Q0e(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mbe(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function pbe(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function vG(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gbe(t,e){return e}class zs{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||gbe}}let yx=null;function ybe(t){return!mA(t)||t.length<2?t:vG(t)}function wG(){if(yx)return yx;const t=[];t.push(new zs("bucket")),t.push(new zs("generation")),t.push(new zs("metageneration")),t.push(new zs("name","fullPath",!0));function e(i,o){return ybe(o)}const n=new zs("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new zs("size");return s.xform=r,t.push(s),t.push(new zs("timeCreated")),t.push(new zs("updated")),t.push(new zs("md5Hash",null,!0)),t.push(new zs("cacheControl",null,!0)),t.push(new zs("contentDisposition",null,!0)),t.push(new zs("contentEncoding",null,!0)),t.push(new zs("contentLanguage",null,!0)),t.push(new zs("contentType",null,!0)),t.push(new zs("metadata","customMetadata",!0)),yx=t,yx}function xbe(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Vi(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function vbe(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return xbe(r,t),r}function bG(t,e,n){const r=xG(e);return r===null?null:vbe(t,r,n)}function wbe(t,e,n,r){const s=xG(e);if(s===null||!mA(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,h=t.fullPath,f="/b/"+o(d)+"/o/"+o(h),m=gA(f,n,r),g=mG({alt:"media",token:u});return m+g})[0]}function bbe(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class _G{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SG(t){if(!t)throw fA()}function _be(t,e){function n(r,s){const i=bG(t,s,e);return SG(i!==null),i}return n}function Sbe(t,e){function n(r,s){const i=bG(t,s,e);return SG(i!==null),wbe(i,s,t.host,t._protocol)}return n}function CG(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=L0e():s=M0e():n.getStatus()===402?s=D0e(t.bucket):n.getStatus()===403?s=F0e(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function Cbe(t){const e=CG(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=R0e(t.path)),i.serverResponse=s.serverResponse,i}return n}function Ebe(t,e,n){const r=e.fullServerUrl(),s=gA(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new _G(s,i,Sbe(t,n),o);return l.errorHandler=Cbe(e),l}function Tbe(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Ibe(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=Tbe(null,e)),r}function Nbe(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let C="";for(let T=0;T<2;T++)C=C+Math.random().toString().slice(2);return C}const c=l();o["Content-Type"]="multipart/related; boundary="+c;const u=Ibe(e,r,s),d=bbe(u,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,f=`\r
--`+c+"--",m=Wl.getBlob(h,r,f);if(m===null)throw z0e();const g={name:u.fullPath},x=gA(i,t.host,t._protocol),v="POST",w=t.maxUploadRetryTime,_=new _G(x,v,_be(t,n),w);return _.urlParams=g,_.headers=o,_.body=m.uploadData(),_.errorHandler=CG(e),_}class Pbe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ou.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ou.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ou.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw am("cannot .send() more than once");if(Bc(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw am("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw am("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw am("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw am("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Abe extends Pbe{initXhr(){this.xhr_.responseType="text"}}function EG(){return new Abe}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e,n){this._service=e,n instanceof Vi?this._location=n:this._location=Vi.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new id(e,n)}get root(){const e=new Vi(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return vG(this._location.path)}get storage(){return this._service}get parent(){const e=mbe(this._location.path);if(e===null)return null;const n=new Vi(this._location.bucket,e);return new id(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw H0e(e)}}function kbe(t,e,n){t._throwIfRoot("uploadBytes");const r=Nbe(t.storage,t._location,wG(),new Wl(e,!0),n);return t.storage.makeRequestWithTokens(r,EG).then(s=>({metadata:s,ref:t}))}function jbe(t){t._throwIfRoot("getDownloadURL");const e=Ebe(t.storage,t._location,wG());return t.storage.makeRequestWithTokens(e,EG).then(n=>{if(n===null)throw G0e();return n})}function Rbe(t,e){const n=pbe(t._location.path,e),r=new Vi(t._location.bucket,n);return new id(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dbe(t){return/^[A-Za-z]+:\/\//.test(t)}function Mbe(t,e){return new id(t,e)}function TG(t,e){if(t instanceof yA){const n=t;if(n._bucket==null)throw B0e();const r=new id(n,n._bucket);return e!=null?TG(r,e):r}else return e!==void 0?Rbe(t,e):t}function Lbe(t,e){if(e&&Dbe(e)){if(t instanceof yA)return Mbe(t,e);throw WT("To use ref(service, url), the first argument must be a Storage instance.")}else return TG(t,e)}function gL(t,e){const n=e==null?void 0:e[hG];return n==null?null:Vi.makeFromBucketSpec(n,t)}function Fbe(t,e,n,r={}){t.host=`${e}:${n}`;const s=Bc(e);s&&(yb(`https://${t.host}`),xb("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:az(i,t.app.options.projectId))}class yA{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=dG,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=k0e,this._maxUploadRetryTime=j0e,this._requests=new Set,s!=null?this._bucket=Vi.makeFromBucketSpec(s,this._host):this._bucket=gL(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Vi.makeFromBucketSpec(this._url,e):this._bucket=gL(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){pL("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){pL("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(qs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new id(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new q0e(fG());{const o=sbe(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const yL="@firebase/storage",xL="0.13.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IG="storage";function fh(t,e,n){return t=qn(t),kbe(t,e,n)}function mh(t){return t=qn(t),jbe(t)}function ph(t,e){return t=qn(t),Lbe(t,e)}function Obe(t=vb(),e){t=qn(t);const r=Gg(t,IG).getImmediate({identifier:e}),s=sP("storage");return s&&$be(r,...s),r}function $be(t,e,n,r={}){Fbe(t,e,n,r)}function Vbe(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new yA(n,r,s,e,hd)}function Ube(){Cc(new sl(IG,Vbe,"PUBLIC").setMultipleInstances(!0)),uo(yL,xL,""),uo(yL,xL,"esm2017")}Ube();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bbe="type.googleapis.com/google.protobuf.Int64Value",zbe="type.googleapis.com/google.protobuf.UInt64Value";function NG(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function qw(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>qw(e));if(typeof t=="function"||typeof t=="object")return NG(t,e=>qw(e));throw new Error("Data cannot be encoded in JSON: "+t)}function cf(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case Bbe:case zbe:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>cf(e)):typeof t=="function"||typeof t=="object"?NG(t,e=>cf(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vL={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class mi extends Go{constructor(e,n,r){super(`${xA}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,mi.prototype)}}function Gbe(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Kw(t,e){let n=Gbe(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!vL[o])return new mi("internal","internal");n=vL[o],r=o}const l=i.message;typeof l=="string"&&(r=l),s=i.details,s!==void 0&&(s=cf(s))}}catch{}return n==="ok"?null:new mi(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wbe{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,qs(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HT="us-central1",Hbe=/^data: (.*?)(?:\n|$)/;function qbe(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new mi("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class Kbe{constructor(e,n,r,s,i=HT,o=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new Wbe(e,n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=HT}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function Ybe(t,e,n){const r=Bc(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(yb(t.emulatorOrigin),xb("Functions",!0))}function Jbe(t,e,n){const r=s=>Xbe(t,e,s,n||{});return r.stream=(s,i)=>e_e(t,e,s,i),r}async function Qbe(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}async function PG(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function Xbe(t,e,n,r){const s=t._url(e);return Zbe(t,s,n,r)}async function Zbe(t,e,n,r){n=qw(n);const s={data:n},i=await PG(t,r),o=r.timeout||7e4,l=qbe(o),c=await Promise.race([Qbe(e,s,i,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!c)throw new mi("cancelled","Firebase Functions instance was deleted.");const u=Kw(c.status,c.json);if(u)throw u;if(!c.json)throw new mi("internal","Response is not valid JSON object.");let d=c.json.data;if(typeof d>"u"&&(d=c.json.result),typeof d>"u")throw new mi("internal","Response is missing data field.");return{data:cf(d)}}function e_e(t,e,n,r){const s=t._url(e);return t_e(t,s,n,r||{})}async function t_e(t,e,n,r){var s;n=qw(n);const i={data:n},o=await PG(t,r);o["Content-Type"]="application/json",o.Accept="text/event-stream";let l;try{l=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(i),headers:o,signal:r==null?void 0:r.signal})}catch(m){if(m instanceof Error&&m.name==="AbortError"){const x=new mi("cancelled","Request was cancelled.");return{data:Promise.reject(x),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(x)}}}}}}const g=Kw(0,null);return{data:Promise.reject(g),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(g)}}}}}}let c,u;const d=new Promise((m,g)=>{c=m,u=g});(s=r==null?void 0:r.signal)===null||s===void 0||s.addEventListener("abort",()=>{const m=new mi("cancelled","Request was cancelled.");u(m)});const h=l.body.getReader(),f=n_e(h,c,u,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const m=f.getReader();return{async next(){const{value:g,done:x}=await m.read();return{value:g,done:x}},async return(){return await m.cancel(),{done:!0,value:void 0}}}}},data:d}}function n_e(t,e,n,r){const s=(o,l)=>{const c=o.match(Hbe);if(!c)return;const u=c[1];try{const d=JSON.parse(u);if("result"in d){e(cf(d.result));return}if("message"in d){l.enqueue(cf(d.message));return}if("error"in d){const h=Kw(0,d);l.error(h),n(h);return}}catch(d){if(d instanceof mi){l.error(d),n(d);return}}},i=new TextDecoder;return new ReadableStream({start(o){let l="";return c();async function c(){if(r!=null&&r.aborted){const u=new mi("cancelled","Request was cancelled");return o.error(u),n(u),Promise.resolve()}try{const{value:u,done:d}=await t.read();if(d){l.trim()&&s(l.trim(),o),o.close();return}if(r!=null&&r.aborted){const f=new mi("cancelled","Request was cancelled");o.error(f),n(f),await t.cancel();return}l+=i.decode(u,{stream:!0});const h=l.split(`
`);l=h.pop()||"";for(const f of h)f.trim()&&s(f.trim(),o);return c()}catch(u){const d=u instanceof mi?u:Kw(0,null);o.error(d),n(d)}}},cancel(){return t.cancel()}})}const wL="@firebase/functions",bL="0.12.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_e="auth-internal",s_e="app-check-internal",i_e="messaging-internal";function o_e(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(r_e),o=n.getProvider(i_e),l=n.getProvider(s_e);return new Kbe(s,i,o,l,r)};Cc(new sl(xA,e,"PUBLIC").setMultipleInstances(!0)),uo(wL,bL,t),uo(wL,bL,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uf(t=vb(),e=HT){const r=Gg(qn(t),xA).getImmediate({identifier:e}),s=sP("functions");return s&&a_e(r,...s),r}function a_e(t,e,n){Ybe(qn(t),e,n)}function mc(t,e,n){return Jbe(qn(t),e,n)}o_e();function pc(t){return t?t.toLowerCase().replace(/\s+/g,"-"):""}const l_e={apiKey:"AIzaSyAI8iWuP1P20OZDIGsUNX6BluSCF40A7AU",authDomain:"freshfront-c3181.firebaseapp.com",projectId:"freshfront-c3181",storageBucket:"freshfront-c3181.firebasestorage.app",messagingSenderId:"925329325314",appId:"1:925329325314:web:67f69c02b9ff7580e6561b"},Hb=mz(l_e),fp=Kye(Hb),AG=f0e(Hb),gh=Obe(Hb),qS=uf(Hb);try{m0e(AG,{cacheSizeBytes:h0e}).then(()=>{console.log("Firestore offline persistence enabled.")}).catch(t=>{t.code=="failed-precondition"?console.warn("Firestore offline persistence failed: Multiple tabs open or other precondition failed.",t):t.code=="unimplemented"?console.warn("Firestore offline persistence failed: Browser does not support required features.",t):console.error("Firestore offline persistence failed with error: ",t)})}catch(t){console.error("Error enabling Firestore offline persistence: ",t)}const nr=AG;async function qT(t){if(!t||typeof t!="string"||t.trim()==="")return!1;const e=pc(t.trim());try{const n=Yo(nr,"stores"),r=zT(n,GT("urlSlug","==",e),E0e(1));return!(await Jo(r)).empty}catch(n){throw console.error("Error checking store name availability in Firestore:",n),new Error("Failed to check store name availability due to a database error.")}}const kG=p.createContext(),c_e=({children:t})=>{const[e,n]=p.useState(null),[r,s]=p.useState(null),[i,o]=p.useState(null),[l,c]=p.useState(!0),[u,d]=p.useState(null);p.useEffect(()=>{let g=()=>{};const x=Lge(fp,async v=>{if(c(!0),n(v),s(v),g(),v){const w=ki(nr,"profiles",v.uid);g=A0e(w,_=>{if(_.exists()){const C=_.data();o(C),d((C==null?void 0:C.role)||"store_owner"),console.log("AuthContext: Profile updated from snapshot:",C)}else console.warn("AuthContext: No profile found for user:",v.uid),o(null),d("store_owner");c(!1)},_=>{console.error("AuthContext: Error listening to profile:",_.message),o(null),d(null),c(!1)})}else o(null),d(null),c(!1)});return()=>{x(),g()}},[]);const m={user:e,session:r,profile:i,isAuthenticated:!!r&&!!e,userRole:u,loadingRole:l,logout:async()=>{try{await Fge(fp),console.log("User signed out successfully.")}catch(g){console.error("Error signing out: ",g)}},subscriptionStatus:"active"};return a.jsx(kG.Provider,{value:m,children:t})},Ia=()=>{const t=p.useContext(kG);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},eo=[{name:"Canvas",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Canvas.jpeg?alt=media&token=bfcade71-3242-4fc1-a623-1779f4b4773c",category:"Wall Art"},{name:"Hat",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Hat.jpeg?alt=media&token=e71e8dd0-2fc8-49ba-be13-98fd3909db3c",category:"Apparel"},{name:"Black hoodie",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Hoodie.jpeg?alt=media&token=90fee73f-96f5-4372-9f15-44e44403adca",category:"Apparel"},{name:"Mug",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Mug.png?alt=media&token=ff8dd2df-7dad-4ef7-8fa8-7867a6770dba",category:"Drinkware"},{name:"Notebook",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Notebook.jpeg?alt=media&token=807b6222-96ad-4179-a11a-16406c4b4509",category:"Stationery"},{name:"Pillow",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Pillow.webp?alt=media&token=50f5c317-8c39-4c48-b55c-d1da9216fa2e",category:"Home Decor"},{name:"Shirt",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Shirt.webp?alt=media&token=7c5f9b2f-6161-4a01-b9eb-1ae7813f3d6c",category:"Apparel"},{name:"Totebag",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Totebag.jpeg?alt=media&token=2d4dad9f-53d8-45b5-afce-5cef1a8e9f1c",category:"Accessories"},{name:"Travel mug",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Travelmug.jpeg?alt=media&token=312cd2d7-add0-4180-8872-355ec15ed00e",category:"Drinkware"},{name:"Blanket",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Bl.webp?alt=media&token=882cefc9-c725-40e7-a225-69f91d3ea2f6",category:"Home Decor"}],Yw=[{value:"fashion",label:"Fashion & Apparel"},{value:"electronics",label:"Electronics & Gadgets"},{value:"food",label:"Food & Beverage"},{value:"jewelry",label:"Jewelry & Accessories"},{value:"homedecor",label:"Home Decor & Furnishings"},{value:"beauty",label:"Beauty & Personal Care"},{value:"books",label:"Books & Media"},{value:"sports",label:"Sports & Outdoors"},{value:"toys",label:"Toys & Games"},{value:"art_collectibles",label:"Art & Collectibles"},{value:"general",label:"General Merchandise"}],ag=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{const c=s.toDataURL("image/png").split(",")[1];e({base64ImageData:c,mimeType:"image/png"})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed, possibly due to CORS or tainted canvas."))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),u_e=t=>new Promise((e,n)=>{if(!t||!(t instanceof File))return n(new Error("Invalid file object provided."));const r=new FileReader;r.onload=()=>{const s=r.result;try{const i=s.split(",");if(i.length<2)throw new Error("Invalid data URL structure from FileReader.");const o=i[1];e({base64ImageData:o,mimeType:t.type})}catch(i){console.error("Error parsing data URL from FileReader:",s,i),n(new Error(`Invalid data URL format from FileReader: ${i.message}`))}},r.onerror=s=>{console.error("FileReader error:",s),n(new Error("Failed to read the file."))},r.readAsDataURL(t)}),d_e="AIzaSyCWUzTb8AC8d6CvHm4_MLgXSeufRQcHQAE",h_e=[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE}],f_e=t=>{if(!t)return null;const e=t.split(",");if(e.length<2)return null;const n=e[0].match(/:(.*?);/);if(!n||n.length<2)return null;const r=n[1],s=atob(e[1]);let i=s.length;const o=new Uint8Array(i);for(;i--;)o[i]=s.charCodeAt(i);return new Blob([o],{type:r})};async function jG(t,e,n=null,r="image/png",s=[],i=(u,d)=>console.log(`ProductGen Progress: ${u}%, Message: ${d||""}`),o=0,l=5,c=""){if(!t||!e)throw new Error("Product type and store name are required to generate a product.");const u=new On({apiKey:d_e});let d=`You are an expert product creator for e-commerce stores.
Generate a product for a store named "${e}" that sells ${t}.
The overall theme and request for the store is: "${c}". Use this full prompt to ensure the product aligns well with the user's vision.

The product should include:
1. A catchy title.
2. A brief description (15-25 words).
3. A realistic price (e.g., 29.99, 45.00).
4. Relevant product options/variants (e.g., for a shirt: Size [S, M, L, XL], Color [White, Black, Blue]; for a shoe: Size [8, 9, 10], Color [Red, Grey]). Generate 1 to 2 variant types, each with 2 to 5 option values. If no variants are typically applicable for the product type, return an empty array for "variants".
5. A visually appealing product image.

Return the text details (title, description, price, variants) as a single JSON object in the text part of your response.
Your entire text response MUST be ONLY a valid JSON object. Do not include any other words, phrases, or conversational text before or after the JSON object.
The JSON object should strictly follow this format:
{
  "title": "Example Product Title",
  "description": "This is a fantastic example product, perfect for your needs and desires.",
  "price": "19.99",
  "variants": [
    { "name": "Size", "values": ["S", "M", "L", "XL"] },
    { "name": "Color", "values": ["White", "Black", "Blue"] }
  ]
}
Or, if no variants apply:
{
  "title": "Example Product Title",
  "description": "This is a fantastic example product, perfect for your needs and desires.",
  "price": "19.99",
  "variants": []
}


Generate an image for this product in the image part of your response.`,h=d;if(s&&s.length>0&&(h+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),n){let _=d;s&&s.length>0&&(_+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),n&&(_+=`

A logo image is also provided. Subtly incorporate this logo onto the product, its packaging, or in the scene if appropriate. For example, it could be a small brand mark on the item or a logo in the background if it's a lifestyle shot. Ensure the product remains the main focus.`),console.log(n?`[geminiProductGeneration Function] Generating product with logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`:`[geminiProductGeneration Function] Generating product without logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`)}else{let _=d;s&&s.length>0&&(_+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),console.log(`[geminiProductGeneration Function] Generating product without logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`)}let f=null,m=null,g="",x=0;const v=3;let w=[];for(;x<v;){x++,console.log(`[geminiProductGeneration Function] Attempt ${x} to generate content...`);const _=o+(x-1)/v*(l*.2);i(_,`Generating product (attempt ${x}/${v})...`);let C=d;s&&s.length>0&&(C+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),w.length>0&&(C+=`

ADDITIONALLY IMPORTANT: Avoid re-generating the following titles which were duplicates in previous attempts of THIS request: "${w.join('", "')}". Ensure the new title is truly novel and not similar to these.`),n&&(C+=`

A logo image is also provided. Subtly incorporate this logo onto the product, its packaging, or in the scene if appropriate. For example, it could be a small brand mark on the item or a logo in the background if it's a lifestyle shot. Ensure the product remains the main focus.`);const T=[{text:C}];if(n&&T.push({inlineData:{data:n,mimeType:r}}),x===1){const j=[...s,...w];console.log(`[geminiProductGeneration Function] Generating product for type: ${t}, store: ${e}. Initial exclusions (if any): ${j.join(", ")||"None"}. Logo: ${n?"Yes":"No"}`)}try{const j=await u.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:T,safetySettings:h_e,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});f=null,m=null;let A="";if(j.candidates&&j.candidates.length>0&&j.candidates[0].content&&j.candidates[0].content.parts)for(const E of j.candidates[0].content.parts)if(E.text){A+=E.text;try{const I=E.text.trim();let N=null;const k=I.match(/```json\s*([\s\S]*?)\s*```/);if(k&&k[1])N=k[1],console.log(`[geminiProductGeneration Function] Attempt ${x}: Found JSON in markdown block.`);else{const R=I.indexOf("{"),D=I.lastIndexOf("}");R!==-1&&D>R&&(N=I.substring(R,D+1),console.log(`[geminiProductGeneration Function] Attempt ${x}: Extracted potential JSON between first '{' and last '}'.`))}N?(f=JSON.parse(N),console.log(`[geminiProductGeneration Function] Attempt ${x}: Successfully parsed JSON.`)):E.text&&(E.text.includes("{")||E.text.includes("}"))?console.warn(`[geminiProductGeneration Function] Attempt ${x}: Text part contained braces but simple extraction failed. Text:`,E.text):E.text&&console.warn(`[geminiProductGeneration Function] Attempt ${x}: No JSON structure (markdown or simple braces) found in text part:`,E.text)}catch(I){console.warn(`[geminiProductGeneration Function] Attempt ${x}: Error parsing JSON. Attempted to parse: "${typeof jsonStringToParse=="string"?jsonStringToParse:"[jsonStringToParse was not a string or was null]"}". Original text from part:`,E.text,"Error:",I.message),f=null}}else E.inlineData&&E.inlineData.data&&(m=E.inlineData.data,console.log(`[geminiProductGeneration Function] Attempt ${x}: Image data found.`));if(g+=(g?`
---
Attempt `+x+`:
`:"Attempt "+x+`:
`)+A,f&&f.title){const E=f.title.toLowerCase();i(o+l*.8,`Validating product details for "${f.title}"...`);const I=s.some(k=>k.toLowerCase()===E),N=w.some(k=>k.toLowerCase()===E);if(I||N)console.warn(`[geminiProductGeneration Function] Attempt ${x}: Generated title "${f.title}" is a duplicate. Adding to exclusion list for next attempt.`),w.push(f.title),f=null;else if(!f.price||typeof f.price!="string"&&typeof f.price!="number"||String(f.price).trim()==="")console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" is unique, but price is missing or invalid. Price:`,f.price),f=null;else if(!f.variants||!Array.isArray(f.variants))console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" is unique and price is valid, but variants are missing or not an array. Variants:`,f.variants),f=null;else for(const k of f.variants)if(!k.name||typeof k.name!="string"||!Array.isArray(k.values)||!k.values.every(R=>typeof R=="string")){console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" has malformed variant entry. Variant:`,k),f=null;break}}if(f&&f.title&&(f.price||f.price===0)&&f.variants&&m){console.log(`[geminiProductGeneration Function] Successfully generated complete and unique product data (including variants) on attempt ${x}.`);break}else m||console.warn(`[geminiProductGeneration Function] Attempt ${x} missing image data.`),f?(f.title||console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing title.`),!f.price&&f.price!==0&&console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing price.`),f.variants||console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing variants or variants malformed.`)):console.warn(`[geminiProductGeneration Function] Attempt ${x} missing text details (or title was duplicate/price missing/variants malformed).`)}catch(j){console.error(`[geminiProductGeneration Function] Error during attempt ${x}:`,j.message,j.stack),g+=(g?`
---
`:"")+`Attempt ${x} Error: ${j.message}`}x>=v&&(!f||!m)&&console.error(`[geminiProductGeneration Function] Exhausted ${v} attempts. Product generation failed.`)}if(!f||!m){let _=`Failed to generate complete and unique product data after ${v} attempts. `;throw f||(_+="Text details (or unique title) missing. "),m||(_+="Image data missing. "),console.error(_,"Accumulated raw text responses:",g),new Error(_+`Last raw text (if any): ${g}`)}if(typeof f.title!="string"||typeof f.description!="string"||typeof f.price!="string"&&typeof f.price!="number"||!Array.isArray(f.variants)||!f.variants.every(_=>typeof _.name=="string"&&Array.isArray(_.values)&&_.values.every(C=>typeof C=="string")))throw console.error("[geminiProductGeneration Function] Parsed product details are not in the expected format:",f),new Error("AI response for product details was not in the expected format (title, description, price, variants).");if(f.price=String(f.price),console.log("[geminiProductGeneration Function] Successfully generated product details (including variants) and image data."),m){const _=`data:image/png;base64,${m}`,C=f_e(_);if(C){const T=Ft(),A=`product_images_generated/${`${e.replace(/\s+/g,"_").toLowerCase()}_${f.title.replace(/\s+/g,"_").toLowerCase().substring(0,20)}_${T}.png`}`,E=ph(gh,A);try{i(o+l*.9,`Uploading image for "${f.title}"...`),await fh(E,C);const I=await mh(E);return console.log(`[geminiProductGeneration Function] Image uploaded to Firebase Storage: ${I}`),i(o+l,`Product "${f.title}" generated successfully.`),{...f,images:[I]}}catch(I){throw console.error("[geminiProductGeneration Function] Error uploading image to Firebase Storage:",I),new Error(`Failed to upload generated image to Firebase Storage: ${I.message}`)}}else throw console.error("[geminiProductGeneration Function] Failed to convert base64 image data to Blob."),new Error("Failed to process generated image data for upload.")}else return i(o+l,`Product "${f.title}" generated (no image).`),{...f,images:[]}}const m_e="AIzaSyCWUzTb8AC8d6CvHm4_MLgXSeufRQcHQAE",_L=new On({apiKey:m_e});async function RG(t,e,n,r=[],s=(l,c)=>console.log(`CollectionGen Progress: ${l}%, Message: ${c||""}`),i=0,o=5){const l=()=>null,c=n&&n.length>0?n.map(h=>`- ${h.name}: ${h.description||"No description."}`).filter(Boolean).join(`
`):"various items",u=r.length>0?`Do NOT use any of the following names: ${r.join(", ")}.`:"",d=`
    You are an AI assistant for an e-commerce store named "${e}" that sells "${t}".
    Based on the following products (name and description): 
${c}
Suggest a compelling and UNIQUE collection name and a short, engaging description (max 2 sentences) for a new collection.
    The collection should group related products or highlight a specific theme.
    ${u}
    Provide the output in a JSON format like this:
    {
      "name": "Collection Name",
      "description": "Collection Description",
      "product_names": ["Product Name 1", "Product Name 2"]
    }
    Ensure the collection name is concise, unique from the provided list (if any), and the description is appealing.
    The "product_names" array should contain a selection of 2 to 4 relevant product names from the provided product list that fit well within this new collection.
  `;s(i+o*.1,"Generating collection details...");try{const h=await _L.models.generateContent({model:"gemini-2.0-flash",contents:[{text:d}],config:{responseModalities:[wn.TEXT]}});let f="";if(h&&h.candidates&&h.candidates.length>0&&h.candidates[0].content&&h.candidates[0].content.parts&&h.candidates[0].content.parts.length>0)for(const _ of h.candidates[0].content.parts)_.text&&(f+=_.text);if(!f)return console.error("Gemini text generation did not return any text content. Full response:",h),console.warn("Returning fallback collection due to no text from AI."),l();let m;try{const _=f.match(/```json\n([\s\S]*?)\n```/);if(_&&_[1])m=JSON.parse(_[1]);else try{m=JSON.parse(f)}catch{console.warn("Failed to parse Gemini response as JSON directly, trying to extract from text:",f);const T=f.indexOf("{"),j=f.lastIndexOf("}");if(T!==-1&&j!==-1&&j>T){const A=f.substring(T,j+1);try{m=JSON.parse(A)}catch(E){throw console.error("Final attempt to parse extracted JSON failed:",A,E),E}}else throw new Error("No valid JSON structure found in response.")}}catch(_){return console.error("Failed to parse Gemini response as JSON:",f,_),console.warn("Returning fallback collection due to JSON parsing error."),l()}if(!m||!m.name||!m.description||!Array.isArray(m.product_names)||m.product_names.length===0)return console.error("AI did not return valid collection data (name, description, or non-empty product_names array):",m),console.warn("Returning fallback collection due to invalid/incomplete AI data."),s(i+o*.5,"Failed to get valid collection details."),l();s(i+o*.5,`Collection details "${m.name}" received.`);const g=_=>{if(typeof _!="string")return"";let C=_.toLowerCase();return C=C.replace(/\b(a|an|the)\b/g,""),C.endsWith("s")&&C.length>3&&(C=C.slice(0,-1)),C=C.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),C},x=[];m.product_names&&n&&m.product_names.forEach(_=>{const C=g(_);if(!C){console.warn(`AI product name "${_}" normalized to an empty string. Skipping.`);return}let T=null;T=n.find(j=>g(j.name)===C),T||(T=n.find(j=>{const A=g(j.name);return A.includes(C)||C.includes(A)})),T&&T.name?(x.push(T.name),console.log(`Matched AI product "${_}" (normalized: "${C}") to existing product "${T.name}" (using name as ID)`)):console.warn(`Product name "${_}" (normalized: "${C}") from AI response not found in provided product list or missing name after normalization and fallback search.`)});const v=`A vibrant and appealing e-commerce collection image for "${m.name}", described as "${m.description}", suitable for a store selling ${t}.`;let w=null;s(i+o*.6,`Generating image for collection "${m.name}"...`);try{const _=[{text:v}],C=await _L.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:_,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});if(C&&C.candidates&&C.candidates.length>0&&C.candidates[0].content&&C.candidates[0].content.parts&&C.candidates[0].content.parts.length>0){for(const T of C.candidates[0].content.parts)if(T.inlineData&&T.inlineData.data){w=T.inlineData.data;break}}w?s(void 0,`Image generated for collection "${m.name}".`):(console.warn(`Gemini image generation did not return image data for collection: "${m.name}". Full Response:`,C),s(void 0,`Image generation failed for collection "${m.name}".`))}catch(_){console.error(`Error generating image for collection "${m.name}" with Gemini:`,_),s(void 0,`Error generating image for collection "${m.name}".`)}return s(i+o,`Collection "${m.name}" processing complete.`),{name:m.name,description:m.description,imageData:w,product_ids:x}}catch(h){return console.error("Error generating collection with Gemini:",h),console.warn("Returning fallback collection due to an unexpected error in generation process."),s(i+o,"Collection generation failed (unexpected error)."),l()}}const p_e="AIzaSyCWUzTb8AC8d6CvHm4_MLgXSeufRQcHQAE",DG=async t=>{var i,o;if(!t||t.length===0)return{error:"No images provided for analysis."};const e=new On({apiKey:p_e}),n=t.map(l=>{if(!l.base64||!l.mimeType)throw console.error("Image object is missing base64 or mimeType:",l.name),new Error(`Image ${l.name} is missing data for AI processing.`);return{inlineData:{data:l.base64.startsWith("data:")?l.base64.split(",")[1]:l.base64,mimeType:l.mimeType}}}),r=`
    Analyze the following product images (${t.map(l=>l.name).join(", ")}). 
    Based on these images, provide the following details for setting up an e-commerce store.
    Please format your response as a single, valid JSON object with the exact keys specified below.

    1.  "productType": A concise category or niche for these products (e.g., "Handcrafted Leather Goods", "Vintage Streetwear", "Artisanal Coffee Beans").
    2.  "storeNameSuggestions": An array of 3-5 creative and relevant store name suggestions.
    3.  "logoDescription": A brief description of a suitable logo concept (e.g., "A minimalist line art of a coffee bean with earthy tones").
    4.  "products": An array of objects, one for each uploaded image. For each product, analyze its specific image content to generate the following:
        *   "originalImageName": The filename of the original image (use the names provided in this prompt, e.g., "${((i=t[0])==null?void 0:i.name)||"example_image.jpg"}").
        *   "name": A catchy and descriptive product name directly inspired by the visual details in THIS specific image.
        *   "price": A suggested retail price for THIS specific product, considering its appearance and likely category (e.g., "29.99"). Ensure this is a string representing a number.
        *   "description": A compelling product description (2-3 sentences) highlighting key visual features and benefits of THIS specific product shown in its image.
    5.  "collections": An array of 3 distinct collection suggestions, each with:
        *   "name": Collection name (e.g., "New Arrivals", "Essentials", "Gifts Under $50").
        *   "description": A brief description for the collection.
    6.  "storePrompt": A short paragraph describing the overall style, feel, and target audience for a store selling these products. This will be used as a base for further AI generation of store content.

    Example for a single product in the "products" array:
    {
      "originalImageName": "${((o=t[0])==null?void 0:o.name)||"example_image.jpg"}",
      "name": "Rustic Leather Wallet",
      "price": "45.00",
      "description": "Hand-stitched full-grain leather wallet with a timeless design. Perfect for everyday carry, offering both style and durability."
    }
  `,s={type:rt.OBJECT,properties:{productType:{type:rt.STRING},storeNameSuggestions:{type:rt.ARRAY,items:{type:rt.STRING}},logoDescription:{type:rt.STRING},products:{type:rt.ARRAY,items:{type:rt.OBJECT,properties:{originalImageName:{type:rt.STRING},name:{type:rt.STRING},price:{type:rt.STRING},description:{type:rt.STRING}},required:["originalImageName","name","price","description"]}},collections:{type:rt.ARRAY,items:{type:rt.OBJECT,properties:{name:{type:rt.STRING},description:{type:rt.STRING}},required:["name","description"]}},storePrompt:{type:rt.STRING}},required:["productType","storeNameSuggestions","logoDescription","products","collections","storePrompt"]};try{console.log("[geminiImageUnderstanding] Sending prompt to Gemini with images:",t.map(h=>h.name));const l=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:r},...n]}],config:{responseMimeType:"application/json",responseSchema:s}});if(console.log("[geminiImageUnderstanding] Full API call response object:",JSON.stringify(l,null,2)),!l||typeof l.text!="string"){let h="Invalid or missing response from API.";return l&&l.promptFeedback&&l.promptFeedback.blockReason?(h=`Request blocked: ${l.promptFeedback.blockReason}. ${l.promptFeedback.blockReasonMessage||""}`,console.error(`[geminiImageUnderstanding] Request blocked. Reason: ${l.promptFeedback.blockReason}, Message: ${l.promptFeedback.blockReasonMessage}`)):l&&l.candidates&&l.candidates.length>0&&l.candidates[0].finishReason!=="STOP"&&l.candidates[0].finishReason!=="MODEL_SPECIFIED_STOP"?(h=`Generation stopped for reason: ${l.candidates[0].finishReason}.`,console.error(`[geminiImageUnderstanding] Generation stopped. Reason: ${l.candidates[0].finishReason}`)):console.error("[geminiImageUnderstanding] API response is invalid or text property is missing/not a string. Full response:",l),{error:`AI analysis failed: ${h}`}}const c=l.text;if(c.trim()==="")return console.error("[geminiImageUnderstanding] Model did not return a text response (empty string). Full API Response:",JSON.stringify(l)),{error:"AI analysis failed: Model response was empty or not text."};let u;try{u=JSON.parse(c)}catch(h){return console.error("[geminiImageUnderstanding] Failed to parse Gemini JSON response:",c,"ParseError:",h),{error:"AI analysis failed: Could not understand the response from Gemini (invalid JSON)."}}if(!u.productType||!Array.isArray(u.storeNameSuggestions)||!Array.isArray(u.products)||!Array.isArray(u.collections)||!u.storePrompt)return console.error("[geminiImageUnderstanding] Gemini response missing required fields or incorrect types:",u),{error:"AI analysis failed: The response from Gemini was incomplete or malformed."};const d=u.products.map(h=>{let f=[],m="Untitled Product (AI)",g="0.00",x="No description provided by AI.",v=null;if(h&&typeof h=="object")if(m=h.name||m,g=h.price||g,x=h.description||x,v=h.originalImageName||null,typeof h.originalImageName=="string"){const w=t.find(_=>_&&_.name===h.originalImageName);w&&typeof w.base64=="string"?f=[w.base64]:console.warn(`[geminiImageUnderstanding] Original image or its base64 not found for product with AI-provided originalImageName: "${h.originalImageName}". AI Product Name: "${h.name}"`)}else console.warn("[geminiImageUnderstanding] Product item from AI is missing 'originalImageName' string or is invalid:",h);else console.warn("[geminiImageUnderstanding] Invalid product item received from AI (not an object):",h);return{...h&&typeof h=="object"?h:{},name:m,price:g,description:x,originalImageName:v,images:f}});return{productType:u.productType,storeNameSuggestions:u.storeNameSuggestions,logoDescription:u.logoDescription,products:d,collections:u.collections,storePrompt:u.storePrompt,error:null}}catch(l){return console.error("[geminiImageUnderstanding] Error calling Gemini API or processing response:",l),{error:`AI analysis API call failed: ${l.message}`}}},MG=new On({apiKey:"AIzaSyCWUzTb8AC8d6CvHm4_MLgXSeufRQcHQAE"}),g_e=async t=>{if(!t)throw new Error("URL is required for analysis.");try{const e=MG.getGenerativeModel({model:"gemini-1.5-flash-preview-0514",tools:[{urlContext:{}}]}),n=`
      Analyze the content of the provided URL and extract the following information:
      1.  **Primary Topic/Theme:** What is the main subject of the page? (e.g., "E-commerce site for handmade leather goods", "Blog about minimalist interior design").
      2.  **Brand/Store Name:** Identify the name of the brand or store.
      3.  **Key Products/Services:** List the main products or services offered.
      4.  **Target Audience:** Describe the likely target audience.
      5.  **Visual Style/Aesthetics:** Describe the visual design, color palette, and overall aesthetic of the website.
      6.  **Key Marketing Phrases/Slogans:** Extract any prominent marketing messages or slogans.

      URL: ${t}
    `;return(await(await e.generateContent({contents:[{role:"user",parts:[{text:n}]}]})).response).text()}catch(e){throw console.error(`Error analyzing URL ${t}:`,e),new Error(`Failed to analyze content for URL: ${t}.`)}},y_e=async t=>{if(!t||t.length===0)return"";try{const e=await Promise.all(t.map(o=>g_e(o)));if(e.length===1)return e[0];const n=MG.getGenerativeModel({model:"gemini-1.5-flash-preview-0514"}),r=`
      You have been provided with analyses from multiple URLs. Synthesize this information into a single, coherent summary. 
      Identify common themes, brand identity, product categories, and target audience. 
      If there are conflicting details, note them. The goal is to create a unified creative brief that can be used to generate a new online store.

      Analyses:
      ${e.join(`

---

`)}
    `;return(await(await n.generateContent({contents:[{role:"user",parts:[{text:r}]}]})).response).text()}catch(e){throw console.error("Error synthesizing URL analyses:",e),new Error("Failed to synthesize analyses from multiple URLs.")}},x_e="2025-04",qb=async(t,e,n,r={})=>{var l,c;if(!t||t==="your-shop-name.myshopify.com"||!e||e==="YOUR_SHOPIFY_STOREFRONT_ACCESS_TOKEN")throw new Error("Shopify domain or access token is not configured or is using placeholder values.");let s=t.trim().replace(/^(https?:\/\/)/,"").replace(/\/$/,"");s.includes(".")?!s.endsWith(".myshopify.com")&&s.includes("."):s=`${s}.myshopify.com`,s.includes(".")||(s=`${s}.myshopify.com`);let i=t.trim().replace(/^(https?:\/\/)/,"").replace(/\/$/,"");i.includes(".")||(i=`${i}.myshopify.com`);const o=`https://${i}/api/${x_e}/graphql.json`;try{const u=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":e},body:JSON.stringify({query:n,variables:r})});if(!u.ok){let h;try{h=await u.json()}catch{}const f=((c=(l=h==null?void 0:h.errors)==null?void 0:l[0])==null?void 0:c.message)||`Shopify API request failed: ${u.status} ${u.statusText}`;throw console.error("Shopify API Error:",h||u.statusText),new Error(f)}const d=await u.json();if(d.errors)throw console.error("Shopify GraphQL Errors:",d.errors),new Error(d.errors.map(h=>h.message).join(", "));return d.data}catch(u){throw console.error("Error fetching from Shopify Storefront API:",u),u}},v_e=`
  query GetShopMetadata {
    shop {
      name
      description 
      primaryDomain {
        host
        url
      }
      brand {
        logo {
          image { # Reverted to use image field
            url
            altText
          }
        }
        squareLogo { # Added, assuming similar structure
          image {
            url
            altText # Assuming altText is available, can be removed if not
          }
        }
        coverImage {
          image { # Reverted to use image field
            url
            altText
          }
        }
        slogan
        shortDescription # Added
        colors {
          primary {
            background
            foreground
          }
          secondary {
            background
            foreground
          }
        }
      }
    }
  }
`,w_e=`
  query GetProducts($first: Int = 10, $cursor: String) {
    products(first: $first, after: $cursor) {
      edges {
        node {
          id
          title
          description # Changed from descriptionHtml
          handle
          tags
          images(first: 5) { # Changed from first: 1
            edges {
              node {
                url
                altText
              }
            }
          }
          variants(first: 5) { # Changed from first: 1
            edges {
              node {
                id # Added for variants
                title # Added for variants
                availableForSale # Added
                sku # Added from debug guide example
                price: priceV2 { # Changed from priceRange.minVariantPrice to priceV2, aliased to price
                    amount
                    currencyCode
                }
                image {
                   url
                   altText
                }
              }
            }
          }
        }
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
`,b_e=`
  query GetCollections($first: Int = 10, $cursor: String) {
    collections(first: $first, after: $cursor) {
      edges {
        node {
          id
          title
          description
          handle
          products(first: 5) { # Example: fetch first 5 products in each collection
            edges {
              node {
                id
                title
              }
            }
          }
        }
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
`,__e=`
  query GetLocalizationInfo @inContext(country: "US") { # Defaulting to US, can be parameterized
    localization {
      availableCountries {
        isoCode
        name
        currency {
          isoCode
          name
          symbol
        }
      }
      availableLanguages {
        isoCode
        name
        endonymName
      }
    }
  }
`,df=()=>["#3B82F6","#8B5CF6","#EC4899","#10B981","#F59E0B","#EF4444","#6366F1","#14B8A6","#F97316"][Math.floor(Math.random()*9)],vA=()=>["Inter","Roboto","Poppins","Montserrat","Open Sans"][Math.floor(Math.random()*5)],wA=()=>["grid","list"][Math.floor(Math.random()*2)],S_e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>{e({base64:r.result,mimeType:t.type,name:t.name})},r.onerror=s=>n(s)}),C_e=async(t,e,n,r,{fetchPexelsImages:s=io,generateId:i=Ft}={})=>{const o=[],l={fashion:{min:20,max:200},electronics:{min:50,max:1300},food:{min:5,max:50},jewelry:{min:100,max:1e3},general:{min:10,max:300}},c=l[t]||l.general,u={fashion:["Classic Tee","Urban Jeans","Silk Scarf","Leather Boots","Summer Dress","Knit Sweater"],electronics:["HD Webcam","Noise-Cancelling Buds","Smart Display","Gaming Pad","Portable Drive","VR Headset"],food:["Artisan Bread","Gourmet Cheese","Organic Berries","Craft Coffee","Spiced Nuts","Dark Chocolate Bar"],jewelry:["Pearl Necklace","Sapphire Ring","Gold Hoops","Charm Bracelet","Silver Cufflinks","Diamond Studs"],general:["Utility Tool","Desk Organizer","Travel Mug","Yoga Mat","Scented Candle","Board Game"]},h=[...u[t]||u.general].sort(()=>.5-Math.random()).slice(0,e),f=h.map(g=>`${t} ${g} product shot`),m=await s(f.join(";"),e,"square");for(let g=0;g<e;g++){const x=h[g],v=m[g];let w;if(v&&v.src&&v.src.medium&&r)try{console.log(`[generateAIProductsData] Overlaying logo on Pexels image: ${v.src.medium}`),w=await overlayLogoOnProductImage(v.src.medium,r)}catch(_){console.error(`[generateAIProductsData] Failed to overlay logo on ${v.src.medium}, using original.`,_),w=v.src.medium}else v&&v.src&&v.src.medium?w=v.src.medium:w=`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(x)}`;o.push({id:`product-ai-${i()}`,name:x,price:parseFloat((Math.random()*(c.max-c.min)+c.min).toFixed(2)),description:Dse(t,x),rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,image:{id:v&&v.id||i(),src:{medium:w},alt:v&&v.alt||`Product image for ${x}`},storeName:n})}return o},E_e=async(t,{fetchPexelsImages:e=io,generateId:n=Ft}={})=>{var T,j,A,E,I,N,k,R,D,M,z,B,G;const r=`store-wizard-${n()}`,{productType:s,storeName:i,logoUrl:o,products:l,prompt:c}=t;let u=[];(l.source==="ai"||l.source==="printOnDemand"||l.source==="manual")&&(u=l.items.map(Y=>({id:Y.id||`product-wizard-${n()}`,name:Y.name,price:parseFloat(Y.price)||0,description:Y.description||"",images:Y.images&&Y.images.length>0?Y.images:[`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(Y.name||"Product")}`],image:{id:n(),src:{medium:Y.images&&Y.images.length>0?Y.images[0]:`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(Y.name||"Product")}`},alt:Y.name||"Product Image"},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,isPrintOnDemand:Y.isPrintOnDemand||!1,podDetails:Y.podDetails||null,variants:Y.variants||[]})));const d=3,h=await e(`${s} ${i} hero slideshow ${c}`,d,"landscape"),f=h.length>0?h[0]:{src:{large:"https://via.placeholder.com/1200x800.png?text=Hero+Image"},alt:"Placeholder Hero Image"},m=await Fa(`${s} ${i} store ambiance ${c}`,1,"landscape"),g=await bI(s,i,c),x=await Fa(g.featuresVideoQuery,1,"landscape");g.featuresVideoUrl=((T=x[0])==null?void 0:T.url)||null;const v=await e(`${i} ${s} abstract background`,1,"landscape"),w=((A=(j=v[0])==null?void 0:j.src)==null?void 0:A.large)||((I=(E=v[0])==null?void 0:E.src)==null?void 0:I.original)||"",_="v1";let C={...g,heroSlideshowImages:h.map(Y=>({src:Y.src.large,alt:Y.alt||i+" hero image"})),...((N=t.content)==null?void 0:N.hero)&&{heroTitle:t.content.hero.heroTitle||g.heroTitle,heroDescription:t.content.hero.heroDescription||g.heroDescription},...((k=t.content)==null?void 0:k.storeWay)&&{storeWay:t.content.storeWay},imageRightSection:null,videoLeftSection:null};if(t.template_version==="sharp"){u.slice(0,3).map($=>$.name).join(", ");const Y={name:i,niche:s,description:c||`A ${s} store called ${i}`},H=await t3(Y);if(H&&!H.error){const $=H.title||`${i} craftsmanship`,V=await e($,1,"landscape");C.imageRightSection={...H,imageUrl:((D=(R=V[0])==null?void 0:R.src)==null?void 0:D.large)||"https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}}const K=await n3(Y);if(K&&!K.error){const $=K.title||`${i} product action`,V=await Fa($,1,"landscape");C.videoLeftSection={...K,videoUrl:((M=V[0])==null?void 0:M.url)||null,videoPosterUrl:((z=V[0])==null?void 0:z.image)||null}}}return{id:r,name:i,template_version:_,type:s,description:C.heroDescription||g.heroDescription,prompt:c||`A ${s} store called ${i}`,products:u,collections:t.collections.items.map(Y=>({id:Y.id||`collection-wizard-${n()}`,name:Y.name,description:Y.description,imageUrl:Y.imageUrl,product_ids:Y.product_ids||[]})),hero_image:f,content:C,hero_video_url:((B=m[0])==null?void 0:B.url)||null,hero_video_poster_url:((G=m[0])==null?void 0:G.image)||null,logo_url:t.logoUrlDark||t.logoUrlLight||`https://via.placeholder.com/100x100.png?text=${i.substring(0,1)}`,logo_url_light:t.logoUrlLight||null,logo_url_dark:t.logoUrlDark||null,theme:{primaryColor:df(),secondaryColor:df(),fontFamily:vA(),layout:wA()},data_source:"wizard",card_background_url:w}},KS=async(t,{storeNameOverride:e=null,nicheDetails:n=null,isPrintOnDemand:r=!1,isDropshipping:s=!1,contextFiles:i=[],contextURLs:o=[],generateProducts:l=!0,fetchPexelsImages:c=io,generateId:u=Ft}={},d=(h,f)=>{console.log(`Progress: ${h}%, Message: ${f||"(no message)"}`)})=>{var Be,ue,Ce,Ie,ve,ie,Me,He,yt,kt,en,mn,cn,fn;const h=(Ue,Et)=>{typeof Ue=="number"&&!isNaN(Ue)?d(Ue,Et):Et&&d(void 0,Et)};h(0,"Initializing store generation...");const f=`store-ai-${u()}`;let m=t,g=null,x=null;if(o&&o.length>0&&o.some(Ue=>Ue.trim()!=="")){h(2,"Analyzing context URLs...");try{const Ue=await y_e(o.filter(Et=>Et.trim()!==""));Ue?(m=`${t}

--- AI URL Analysis Context ---
${Ue}`,h(5,"URL analysis complete.")):h(5,"URL analysis did not return content.")}catch(Ue){console.error("[generateStoreFromPromptData] Error during URL analysis:",Ue),h(5,"URL analysis failed, continuing with prompt.")}}const v=i.filter(Ue=>Ue.type.startsWith("image/"));if(v.length>0){h(5,"Analyzing context images...");try{const Ue=v.map(S_e),Et=await Promise.all(Ue);g=await DG(Et),g&&!g.error?(console.log("[generateStoreFromPromptData] Image analysis successful:",g),h(10,"Image analysis complete."),m+=`

--- AI Image Analysis Context ---
${g.storePrompt}`,x=g.productType):(console.warn("[generateStoreFromPromptData] Image analysis failed or returned an error:",g==null?void 0:g.error),h(10,"Image analysis failed, continuing with prompt."))}catch(Ue){console.error("[generateStoreFromPromptData] Error during image analysis preparation:",Ue),h(10,"Image analysis failed, continuing with prompt.")}}const w=i.filter(Ue=>!Ue.type.startsWith("image/"));w.length>0&&(m+=`

--- Additional Context Files ---
`+w.map(Ue=>Ue.name).join(`
`));const _=m.toLowerCase().split(" ");let C="general";x?C=x:n&&n.name?C=n.name.toLowerCase().replace(/ /g,"-")||"general":_.some(Ue=>["clothing","fashion","apparel","wear"].includes(Ue))?C="fashion":_.some(Ue=>["tech","electronics","gadget","digital"].includes(Ue))?C="electronics":_.some(Ue=>["food","grocery","meal","organic"].includes(Ue))?C="food":_.some(Ue=>["jewelry","accessory","watch","luxury"].includes(Ue))&&(C="jewelry");let T=e,j=null;if(!T&&g&&g.storeNameSuggestions&&g.storeNameSuggestions.length>0&&(T=g.storeNameSuggestions[0],console.log(`[generateStoreFromPromptData] Using store name from image analysis: "${T}"`)),!T)try{j=await Ise(t),j&&(T=j,console.log(`[generateStoreFromPromptData] Extracted store name via Gemini Function Calling: "${T}" (Raw response: "${j}")`))}catch(Ue){console.error("[generateStoreFromPromptData] Error during Gemini function call for name extraction:",Ue)}if(!T)try{console.log(`[generateStoreFromPromptData] No name from override or function call. Attempting AI name suggestion using prompt: "${t}"`),h(void 0,"Suggesting store names...");const Ue=await vI(t);if(Ue&&Ue.suggestions&&Ue.suggestions.length>0)T=Ue.suggestions[0],console.log(`[generateStoreFromPromptData] AI generated store name: ${T}`);else{console.warn("[generateStoreFromPromptData] AI name generation yielded no suggestions. Falling back to heuristic.");const Et=t.split(" ").filter(de=>de.charAt(0)===de.charAt(0).toUpperCase()&&de.length>2);Et.length>0&&(T=Et[0])}}catch(Ue){console.error("[generateStoreFromPromptData] Error during AI store name generation:",Ue);const Et=t.split(" ").filter(de=>de.charAt(0)===de.charAt(0).toUpperCase()&&de.length>2);Et.length>0&&(T=Et[0])}T||(T=`${C.charAt(0).toUpperCase()+C.slice(1)} Emporium ${u().substring(0,4)}`,console.log(`[generateStoreFromPromptData] Using final fallback store name: ${T}`)),T&&T.length>50&&(T=T.substring(0,50));let A=null,E=null,I=null,N=`https://via.placeholder.com/100x100.png?text=${T.substring(0,1)}`;try{console.log(`[generateStoreFromPromptData] Generating logo for: ${T}`),h(10,`Generating logo for ${T}...`);const Ue=(g==null?void 0:g.logoDescription)||m,Et=await Ig(Ue,h);if(Et){E=Et.logoUrlLight,I=Et.logoUrlDark,I?N=I:E&&(N=E);const de=E||I;if(de&&de.startsWith("data:image/")){const De=de.split(",");De.length===2&&(A=De[1])}console.log(`[generateStoreFromPromptData] Logos generated for ${T}. Light: ${!!E}, Dark: ${!!I}`),d(20,`${T} logo generated.`)}else console.warn(`[generateStoreFromPromptData] Logo generation did not return expected result for ${T}.`),h(20,`Logo generation issue for ${T}.`)}catch(Ue){console.error(`[generateStoreFromPromptData] Error generating logo for ${T}:`,Ue),h(20,`Error generating logo for ${T}.`)}h(25,`Generating ${C} products...`);const k=[],R=[],D=25,M=45;if(l)if(g&&g.products&&g.products.length>0)console.log("[generateStoreFromPromptData] Using products from image analysis."),h(25,"Populating products from image analysis..."),g.products.forEach(Ue=>{k.push({id:`product-img-analysis-${u()}`,name:Ue.name,price:parseFloat(Ue.price)||0,description:Ue.description,images:Ue.images,image:{id:u(),src:{medium:Ue.images[0]},alt:Ue.name},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,variants:[]}),R.push(Ue.name.toLowerCase().trim())}),h(D+M,`${k.length} products populated from analysis.`);else{let de=0;for(console.log(`[generateStoreFromPromptData] Attempting to generate 6 unique products for ${T} (type: ${C}).`);k.length<6&&de<12;){de++;const De=D+Math.floor(k.length/6*M);h(De,`Generating product ${k.length+1}/6...`);try{console.log(`[generateStoreFromPromptData] Generating product attempt ${de} (aiming for ${k.length+1}/6 unique products)... Excluding titles: ${R.join(", ")}`);const ee=await jG(C,T,A,"image/png",R,h,De,M/6,m);if(ee&&ee.images&&ee.images.length>0&&ee.title&&ee.title.trim()!==""&&typeof ee.price=="string"&&typeof ee.description=="string"){const ae=ee.title.toLowerCase().trim();if(R.includes(ae))console.warn(`[generateStoreFromPromptData] Duplicate product title generated and skipped: "${ee.title}". Attempt ${de}/12.`);else{let X=ee.variants||[];if(C==="fashion"){const Pe=X.some($e=>$e.name.toLowerCase()==="size"),Ae=X.some($e=>$e.name.toLowerCase()==="color");Pe||X.push({name:"Size",values:["S","M","L","XL"]}),Ae||X.push({name:"Color",values:["White","Black","Blue","Red"]})}k.push({id:`product-gemini-${u()}`,name:ee.title,price:parseFloat(ee.price)||0,description:ee.description,images:ee.images,image:{id:u(),src:{medium:ee.images[0]},alt:ee.title},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,variants:X}),R.push(ae),console.log(`[generateStoreFromPromptData] Product "${ee.title}" generated successfully and is unique. (${k.length}/6)`),h(D+Math.floor(k.length/6*M),`Product "${ee.title}" generated.`)}}else console.warn(`[generateStoreFromPromptData] Failed to generate complete data (or image) for product attempt ${de}. Data:`,ee)}catch(ee){console.error(`[generateStoreFromPromptData] Error during product generation attempt ${de}:`,ee)}}h(D+M,`${k.length} products generated.`),k.length<6&&console.warn(`[generateStoreFromPromptData] Could only generate ${k.length} unique products after 12 total attempts.`),k.length===0&&6>0&&console.warn("[generateStoreFromPromptData] No products were generated successfully. The store will be created with an empty product list.")}const z=3,B=await c(`${C} ${T} hero slideshow ${t}`,z,"landscape"),G=B.length>0?B[0]:{src:{large:"https://via.placeholder.com/1200x800.png?text=Hero+Image"},alt:"Placeholder Hero Image"},Y=await Fa(`${C} ${T} store ambiance ${t}`,1,"landscape"),H=await Fa(`${T} ${C} product showcase`,1,"landscape");await Fa(`${T} ${C} craftsmanship process`,1,"landscape");const K={name:T,niche:C,description:m},$=await ZV(K),V=await e3(K),W=await wI(K),F=await bI(C,T,m),Z=await c(`${T} ${C} store background`,1,"landscape"),ce=((ue=(Be=Z[0])==null?void 0:Be.src)==null?void 0:ue.large)||((Ie=(Ce=Z[0])==null?void 0:Ce.src)==null?void 0:Ie.original)||"";let le="fresh";if(n&&n.templates&&n.templates.length>0){const Ue=n.templates.some(Et=>Et.toLowerCase()==="sharp");if(C==="technology"&&Ue)le="sharp";else{const Et=n.templates[0].toLowerCase();["classic","modern","v1"].includes(Et)?le="v1":Et==="premium"?le="premium":Et==="sharp"?le="sharp":Et==="sleek"&&(le="sleek")}}else t.toLowerCase().includes("modern")?le="v1":t.toLowerCase().includes("premium")?le="premium":t.toLowerCase().includes("sharp")?le="sharp":t.toLowerCase().includes("sleek")&&(le="sleek");le==="modern"&&(le="v1");let he={url:null,poster:null};if(le==="v2"){const Ue=await Fa(`${T} ${C} customer experience why choose us`,1,"landscape");he.url=((ve=Ue[0])==null?void 0:ve.url)||null,he.poster=((ie=Ue[0])==null?void 0:ie.image)||null}const Le=[];h(95,"Loading storefront...");let Ve={id:f,name:T,template_version:le,type:C,description:$&&!$.error?$.heroDescription:F.heroDescription,prompt:m,products:k,collections:Le,hero_image:G,hero_video_url:((Me=Y[0])==null?void 0:Me.url)||null,hero_video_poster_url:((He=Y[0])==null?void 0:He.image)||null,logo_url:N,logo_url_light:E,logo_url_dark:I,theme:{primaryColor:(n==null?void 0:n.primaryColor)||df(),secondaryColor:(n==null?void 0:n.secondaryColor)||df(),fontFamily:vA(),layout:wA()},content:{...F,...$&&!$.error&&{heroTitle:$.heroTitle||F.heroTitle,heroDescription:$.heroDescription||F.heroDescription},...V&&!V.error&&{storeWay:V},...W&&!W.error&&{storeFeatures:W},heroSlideshowImages:B.map(Ue=>({src:Ue.src.large,alt:Ue.alt||T+" hero image"})),imageRightSection:null,videoLeftSection:null},data_source:"ai",card_background_url:ce};if(le==="sharp"){k.slice(0,3).map(de=>de.name).join(", ");const Ue=await t3(K);if(Ue&&!Ue.error){const de=Ue.title||`${T} craftsmanship`,De=await c(de,1,"landscape");Ve.content.imageRightSection={...Ue,imageUrl:((kt=(yt=De[0])==null?void 0:yt.src)==null?void 0:kt.large)||"https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}}const Et=await n3(K);if(Et&&!Et.error){const de=Et.title||`${T} product action`,De=await Fa(de,1,"landscape");Ve.content.videoLeftSection={...Et,videoUrl:((en=De[0])==null?void 0:en.url)||null,videoPosterUrl:((mn=De[0])==null?void 0:mn.image)||null}}Ve.content.heroFollowUpVideoUrl=((cn=H[0])==null?void 0:cn.url)||null,Ve.content.heroFollowUpVideoPosterUrl=((fn=H[0])==null?void 0:fn.image)||null}else le==="fresh"&&(Ve.content.featuresVideoUrl=he.url,Ve.content.featuresVideoPosterUrl=he.poster);return le!=="sharp"&&(Ve.content.heroFollowUpVideoUrl=null,Ve.content.heroFollowUpVideoPosterUrl=null),le!=="fresh"&&(Ve.content.featuresVideoUrl=null,Ve.content.featuresVideoPosterUrl=null),Ve},YS=async(t,e,n,r,s,i,o,l,c)=>{var d,h;const u=[];if(n.length>0){const f=r||s?3:2,m=[],g=f*2;let x=0;for(i(o,"Generating collections for products..."),console.log(`[generateCollectionsForProducts] Attempting to generate ${f} collections for ${e}.`);u.length<f&&x<g;){x++;const v=o+Math.floor((u.length+1)/f*l);i(v,`Generating collection ${u.length+1}/${f} (Attempt ${x})...`);try{const w=await RG(t,e,n,m,i,v,l/f);if(w&&!w.error&&w.name){let _="";if(w.imageData)_=`data:image/png;base64,${w.imageData}`;else{const C=`${w.name} ${t} collection banner`;_=((h=(d=(await io(C,1,"landscape"))[0])==null?void 0:d.src)==null?void 0:h.large)||`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(w.name||"Collection")}`}u.push({id:`collection-gemini-${c()}`,name:w.name,description:w.description,imageUrl:_,product_ids:w.product_ids||[]}),m.push(w.name),i(v,`Collection "${w.name}" generated.`)}else console.warn(w===null?`[generateCollectionsForProducts] Collection generation returned null (fallback prevented), attempt ${x}.`:`[generateCollectionsForProducts] Failed to generate complete data for collection attempt ${x}. Error: ${w==null?void 0:w.error}`)}catch(w){console.error(`[generateCollectionsForProducts] Error during collection generation attempt ${x}:`,w)}}i(o+l,`${u.length} collections generated.`)}else console.warn(`[generateCollectionsForProducts] Skipping collection generation as no products were provided for ${e}.`),i(o+l,"Skipped collection generation (no products).");return u},T_e=async(t,e)=>(await qb(t,e,v_e)).shop,I_e=async(t,e,n=10,r=null)=>(await qb(t,e,b_e,{first:n,cursor:r})).collections,N_e=async(t,e,n=10,r=null)=>(await qb(t,e,w_e,{first:n,cursor:r})).products,P_e=async(t,e,n="US",r="EN")=>(await qb(t,e,__e,{})).localization,A_e=async(t,e,n,{generateId:r=Ft}={},s=null)=>{var h,f,m,g,x,v,w,_,C,T,j;console.log("Mapping BigCommerce Data:",{bcStoreSettings:t,bcProducts:e,domain:n,generatedLogoDataUrl:s});const i=e.map(A=>{var E,I,N,k,R,D,M;return{id:((E=A.entityId)==null?void 0:E.toString())||`bc-product-${r()}`,name:A.name||"Unnamed Product",description:A.description||`Product: ${A.name||"Unnamed Product"}`,price:parseFloat(((N=(I=A.prices)==null?void 0:I.price)==null?void 0:N.value)||0),currencyCode:((R=(k=A.prices)==null?void 0:k.price)==null?void 0:R.currencyCode)||"USD",image:{id:`bc-img-${r()}`,src:{medium:((D=A.defaultImage)==null?void 0:D.url)||`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(A.name||"Product")}`},alt:((M=A.defaultImage)==null?void 0:M.altText)||A.name||"Product Image"},sku:A.sku||"",rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*100)+10}}),o=s||((f=(h=t.logo)==null?void 0:h.image)==null?void 0:f.url)||`https://via.placeholder.com/100x100.png?text=${(t.storeName||"S").substring(0,1)}`,l=await bI("general",t.storeName||"My BigCommerce Store",t.description),c=await Fa(l.featuresVideoQuery,1,"landscape");l.featuresVideoUrl=((m=c[0])==null?void 0:m.url)||null;const u=await io(`${t.storeName||"store"} background`,1,"landscape"),d=((x=(g=u[0])==null?void 0:g.src)==null?void 0:x.large)||((w=(v=u[0])==null?void 0:v.src)==null?void 0:w.original)||"";return{id:`store-bc-${(t.storeHash||n).replace(/[\.\/\:]/g,"-")}-${r()}`,name:t.storeName||"My BigCommerce Store",type:"bigcommerce-imported",description:t.description||`Store imported from ${n}`||l.heroDescription,products:i,hero_image:{id:r(),src:{large:((C=(_=t.logo)==null?void 0:_.image)==null?void 0:C.url)||`https://via.placeholder.com/1200x800.png?text=${encodeURIComponent(t.storeName||"Store")}`},alt:((j=(T=t.logo)==null?void 0:T.image)==null?void 0:j.altText)||t.storeName||"Store Hero"},logo_url:o,theme:{primaryColor:df(),secondaryColor:df(),fontFamily:vA(),layout:wA()},content:{...l,heroTitle:`Welcome to ${t.storeName||"Our Store"}`,heroDescription:t.description||l.heroDescription},data_source:"bigcommerce",card_background_url:d}};async function k_e(t,e){const n=`
    query StoreSettings {
      site {
        settings {
          storeName
          storeHash
          status
          logo {
            title
            image {
              url(width: 500)
              altText
            }
          }
        }
      }
    }
  `;if(typeof t!="string"||!t.trim()){const i=new TypeError("Invalid or empty storeDomain provided to fetchStoreSettings.");throw console.error(i.message,{storeDomain:t}),i}if(typeof e!="string"||!e.trim()){const i=new TypeError("Invalid or empty token provided to fetchStoreSettings.");throw console.error(i.message,{tokenProvided:typeof e=="string"&&e.length>0?"Yes":"No"}),i}const r=`https://${t}/graphql`,s={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:n})};console.log(`[fetchStoreSettings] Attempting to fetch: ${r}`,{domain:t,tokenProvided:!!e,queryLength:n.length});try{let i;try{i=await fetch(r,s)}catch(l){console.error(`[fetchStoreSettings] Initial fetch to ${r} failed:`,l);let c=`Initial fetch to ${r} failed.`;throw l.name==="TypeError"?c+=` This is often due to a CORS misconfiguration (check 'allowed_cors_origins' for your BigCommerce Storefront API token), a DNS issue, or the server not being reachable. Please check the browser's Network DevTools for more specific error messages. Original error: ${l.message}`:c+=` Error: ${l.message||"Unknown network error"}`,new Error(c)}if(console.log(`[fetchStoreSettings] Response from ${r} - Status: ${i.status}, Complexity: ${i.headers.get("X-Bc-GraphQL-Complexity")}`),!i.ok){let l=`Could not retrieve error body (status: ${i.status}).`;try{l=await i.text()}catch(c){console.warn("Failed to read error response body:",c)}throw new Error(`HTTP error ${i.status} for ${r}: ${l}`)}let o;try{o=await i.json()}catch(l){let c="Could not retrieve raw response text after JSON parse failure.";try{c=await(await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:n})})).text()}catch(u){console.warn("Failed to re-fetch for raw text:",u)}throw console.error("Failed to parse JSON response from BigCommerce.",l,{graphqlUrl:r,rawTextPreview:c.substring(0,500)}),new Error(`Failed to parse JSON response from ${r}. Preview: ${c.substring(0,200)}...`)}if(o.errors)throw console.error("BigCommerce GraphQL errors (fetchStoreSettings):",o.errors,{graphqlUrl:r}),new Error(`GraphQL error: ${o.errors.map(l=>l.message).join(", ")}`);if(!o.data||!o.data.site||!o.data.site.settings)throw console.error("Invalid data structure in BigCommerce response (fetchStoreSettings):",o.data,{graphqlUrl:r}),new Error("Invalid data structure received from BigCommerce API for store settings.");return o.data.site.settings}catch(i){throw i.message.startsWith("Invalid or empty storeDomain")||i.message.startsWith("Invalid or empty token")||i.message.startsWith("HTTP error")||i.message.startsWith("GraphQL error")||i.message.startsWith("Failed to parse JSON")||i.message.startsWith("Network error")||console.error(`[fetchStoreSettings] Unexpected error for ${r}:`,i.name,i.message,i.stack,i),i}}async function SL(t,e){var l,c;let n=[],r=null,s=!0;if(typeof t!="string"||!t.trim()){const u=new TypeError("Invalid or empty storeDomain provided to fetchAllProducts.");throw console.error(u.message,{storeDomain:t}),u}if(typeof e!="string"||!e.trim()){const u=new TypeError("Invalid or empty token provided to fetchAllProducts.");throw console.error(u.message,{tokenProvided:typeof e=="string"&&e.length>0?"Yes":"No"}),u}const i=`https://${t}/graphql`,o=`
    query ProductsPage($first: Int!, $after: String) {
      site {
        products(first: $first, after: $after) {
          pageInfo {
            hasNextPage
            endCursor
          }
          edges {
            node {
              entityId
              name
              sku
              defaultImage {
                url(width: 800)
                altText
              }
              prices {
                price { value currencyCode }
                retailPrice { value currencyCode }
              }
            }
          }
        }
      }
    }
  `;console.log(`[fetchAllProducts] Starting to fetch products from: ${i}`,{domain:t,tokenProvided:!!e});try{let u=1;for(;s;){const d={first:50,after:r},h={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:o,variables:d})};let f;try{f=await fetch(i,h)}catch(x){console.error(`[fetchAllProducts] Initial fetch (Page ${u}) to ${i} failed:`,x);let v=`Initial fetch (Page ${u}) to ${i} failed.`;throw x.name==="TypeError"?v+=` This is often due to a CORS misconfiguration (check 'allowed_cors_origins' for your BigCommerce Storefront API token), a DNS issue, or the server not being reachable. Please check the browser's Network DevTools for more specific error messages. Original error: ${x.message}`:v+=` Error: ${x.message||"Unknown network error"}`,new Error(v)}if(console.log(`[fetchAllProducts] Response (Page ${u}) from ${i} - Status: ${f.status}, Complexity: ${f.headers.get("X-Bc-GraphQL-Complexity")}`),u++,!f.ok){let x=`Could not retrieve error body (status: ${f.status}).`;try{x=await f.text()}catch(v){console.warn("[fetchAllProducts] Failed to read error response body:",v)}throw new Error(`HTTP error ${f.status} for ${i} (products): ${x}`)}let m;try{m=await f.json()}catch(x){let v="Could not retrieve raw response text after JSON parse failure (fetchAllProducts).";try{v=await(await fetch(i,h)).text()}catch{}throw console.error("[fetchAllProducts] Failed to parse JSON response from BigCommerce.",x,{graphqlUrl:i,rawTextPreview:v.substring(0,500)}),new Error(`Failed to parse JSON response from ${i} (products). Preview: ${v.substring(0,200)}...`)}if(m.errors)throw console.error("[fetchAllProducts] BigCommerce GraphQL errors:",m.errors,{graphqlUrl:i}),new Error(`GraphQL error (products): ${m.errors.map(x=>x.message).join(", ")}`);const g=(c=(l=m.data)==null?void 0:l.site)==null?void 0:c.products;if(!g||!g.edges||!g.pageInfo)throw console.error("[fetchAllProducts] Invalid data structure in BigCommerce response:",m.data,{graphqlUrl:i}),new Error("Invalid data structure received from BigCommerce API for products.");g.edges.forEach(x=>n.push(x.node)),s=g.pageInfo.hasNextPage,r=g.pageInfo.endCursor}return n}catch(u){throw u.message.startsWith("Invalid or empty storeDomain")||u.message.startsWith("Invalid or empty token")||u.message.startsWith("HTTP error")||u.message.startsWith("GraphQL error")||u.message.startsWith("Failed to parse JSON")||u.message.startsWith("Network error")||console.error(`[fetchAllProducts] Unexpected error for ${i}:`,u.name,u.message,u.stack,u),u}}const Qe=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("rounded-xl border bg-card text-card-foreground shadow-sm",t),...e}));Qe.displayName="Card";const lt=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("flex flex-col space-y-1.5 p-6",t),...e}));lt.displayName="CardHeader";const ct=ht.forwardRef(({className:t,...e},n)=>a.jsx("h3",{ref:n,className:bt("text-2xl font-semibold leading-none tracking-tight",t),...e}));ct.displayName="CardTitle";const Qt=ht.forwardRef(({className:t,...e},n)=>a.jsx("p",{ref:n,className:bt("text-sm text-muted-foreground",t),...e}));Qt.displayName="CardDescription";const it=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("p-6 pt-0",t),...e}));it.displayName="CardContent";const pd=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("flex items-center p-6 pt-0",t),...e}));pd.displayName="CardFooter";const j_e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),R_e=({isOpen:t,onClose:e,products:n,onFinalize:r})=>{const[s,i]=p.useState([]),[o,l]=p.useState(!1),[c,u]=p.useState({}),[d,h]=p.useState({}),[f,m]=p.useState(null),[g,x]=p.useState(!1),{toast:v}=as(),{generatePodCollectionFromDesign:w,addPendingPodCollectionData:_,isGeneratingPodCollection:C,currentStore:T,isGenerating:j}=$n();p.useEffect(()=>{n&&i(n.map(V=>{var F,Z,ce;let W=[];if(Array.isArray(V.images)?W=[...V.images]:(Z=(F=V.image)==null?void 0:F.src)!=null&&Z.medium&&(W=[V.image.src.medium]),V.isPrintOnDemand&&((ce=V.podDetails)!=null&&ce.originalDesignImageUrl)){const le=W.findIndex(he=>he!==V.podDetails.originalDesignImageUrl);if(le>0){const he=W.splice(le,1)[0];W.unshift(he)}}return{...V,images:W,variants:Array.isArray(V.variants)?V.variants.map(le=>({...le,values:Array.isArray(le.values)?[...le.values]:[]})):[]}}))},[n]);const A=(V,W,F)=>{i(Z=>{const ce=[...Z];return ce[V]={...ce[V],[W]:F},ce})},E=async(V,W)=>{if(W)try{const F=await j_e(W);i(Z=>{const ce=[...Z],le=Array.isArray(ce[V].images)?ce[V].images:[];return ce[V].images=[...le,F],ce})}catch(F){console.error("Error converting file to base64:",F),v({title:"Image Upload Error",description:"Could not process image.",variant:"destructive"})}},I=(V,W)=>{i(F=>{const Z=[...F];return Z[V].images=Z[V].images.filter((ce,le)=>le!==W),Z})},N=async V=>{v({title:"Image Generation",description:"AI Image generation for this product is not yet implemented in this modal."}),console.log("Attempting to generate image for product at index:",V,s[V].name)},k=async V=>{const W=s[V];if(!W||!W.name){v({title:"Missing Product Info",description:"Product name is required to generate visuals.",variant:"destructive"});return}const F=W.images&&W.images.length>0?W.images[0]:null;if(!F){v({title:"Missing Base Image",description:"At least one image is required to generate more visuals.",variant:"destructive"});return}u(Z=>({...Z,[V]:!0}));try{const{base64ImageData:Z,mimeType:ce}=await ag(F),le=W.name;let he=[];try{const Ve=await G0(Z,ce,le);Ve&&Ve.length>0&&he.push(...Ve.slice(0,2)),v({title:"Angles Generated",description:`${Math.min(2,(Ve==null?void 0:Ve.length)||0)} angle images generated.`,variant:"success"})}catch(Ve){console.error("Error generating angles:",Ve),v({title:"Angle Generation Failed",description:Ve.message,variant:"destructive"})}const Le=[`Place this product, "${le}", in a realistic home setting where it might be used or displayed. Focus on a natural context.`,`Show this product, "${le}", in an outdoor lifestyle setting, highlighting its use case or appeal.`];for(const Ve of Le)try{const Be=await $o(Z,ce,Ve);Be&&Be.editedImageData&&he.push(`data:${Be.newMimeType};base64,${Be.editedImageData}`)}catch(Be){console.error(`Error generating context image with prompt "${Ve}":`,Be),v({title:"Context Image Failed",description:`Failed for: ${Ve.substring(0,30)}...`,variant:"destructive"})}v({title:"Context Images Attempted",description:`Attempted to generate ${Le.length} context images.`,variant:"success"}),he.length>0?i(Ve=>{const Be=[...Ve],ue=Be[V],Ce=Array.isArray(ue.images)?ue.images:[],Ie=new Set(Ce),ve=he.filter(ie=>!Ie.has(ie));return ve.length>0?(ue.images=[...Ce,...ve],v({title:"Visuals Added",description:`${ve.length} new images added.`,variant:"success"})):v({title:"Visuals Generated",description:"Generated images were already present.",variant:"default"}),Be}):v({title:"No New Visuals",description:"Could not generate additional visuals.",variant:"default"})}catch(Z){console.error("Error in handleGenerateMoreVisuals:",Z),v({title:"Visual Generation Error",description:Z.message,variant:"destructive"})}finally{u(Z=>({...Z,[V]:!1}))}},R=(V,W,F)=>{i(Z=>{const ce=[...Z],le={...ce[V]};return le.variants=[...le.variants||[]],le.variants[W]={...le.variants[W],name:F},ce[V]=le,ce})},D=(V,W,F,Z)=>{i(ce=>{const le=[...ce],he={...le[V]};he.variants=[...he.variants||[]];const Le={...he.variants[W]};return Le.values=[...Le.values||[]],Le.values[F]=Z,he.variants[W]=Le,le[V]=he,le})},M=(V,W)=>{i(F=>{const Z=[...F],ce={...Z[V]};ce.variants=[...ce.variants||[]];const le={...ce.variants[W]};return le.values=[...le.values||[],""],ce.variants[W]=le,Z[V]=ce,Z})},z=(V,W,F)=>{i(Z=>{const ce=[...Z],le={...ce[V]};le.variants=[...le.variants||[]];const he={...le.variants[W]};return he.values=(he.values||[]).filter((Le,Ve)=>Ve!==F),le.variants[W]=he,ce[V]=le,ce})},B=V=>{i(W=>{const F=[...W],Z={...F[V]};return Z.variants=[...Z.variants||[],{name:"",values:[""]}],F[V]=Z,F})},G=(V,W)=>{i(F=>{const Z=[...F],ce={...Z[V]};return ce.variants=(ce.variants||[]).filter((le,he)=>he!==W),Z[V]=ce,Z})},Y=()=>{if(!s.every(W=>W.name&&W.name.trim()!==""&&(W.price||W.price===0)&&String(W.price).trim()!=="")){v({title:"Missing Information",description:"Please ensure all products have a name and a valid price.",variant:"destructive"});return}r(s)},H=V=>{m(V),x(!0)},K=async V=>{var he;const W=s[V];if(!W||!((he=W.podDetails)!=null&&he.originalDesignImageUrl)){v({title:"Error",description:"Product details or original design image missing for POD collection.",variant:"destructive"});return}const F=W.podDetails.originalDesignImageUrl,Z=W.podDetails.designPrompt||`Design based on ${W.name}`,ce=W.podDetails.baseProductName||W.name,le=await w(F,Z,ce);le&&le.newProducts&&le.newCollection?_({newProducts:le.newProducts,newCollection:le.newCollection}):console.error("POD Collection generation in modal failed or returned no data.")},$=async V=>{const W=s[V];if(!W||!W.name){v({title:"Missing Product Name",description:"Product name is required to generate a description.",variant:"destructive"});return}h(F=>({...F,[V]:!0}));try{const F={name:T==null?void 0:T.name,niche:T==null?void 0:T.niche,targetAudience:T==null?void 0:T.targetAudience,style:T==null?void 0:T.style},Z=await Nse(W,F);if(Z.description)A(V,"description",Z.description),v({title:"Description Generated",description:"The product description has been updated.",variant:"success"});else throw new Error(Z.error||"Failed to generate description.")}catch(F){console.error("Error generating product description:",F),v({title:"Description Generation Failed",description:F.message,variant:"destructive"})}finally{h(F=>({...F,[V]:!1}))}};return t?a.jsxs(a.Fragment,{children:[a.jsx(Yr,{open:t,onOpenChange:V=>!V&&e(),children:a.jsxs(Vr,{className:"max-w-3xl",children:[a.jsxs(Ur,{children:[a.jsx(Br,{children:"Finalize Your Products"}),a.jsx(Qi,{children:"Review and edit the AI-generated products before creating your store."})]}),a.jsx(Fs,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"space-y-6 pr-4",children:s.map((V,W)=>{var F;return a.jsxs(Qe,{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:`productName-${W}`,children:"Product Name"}),a.jsx(Je,{id:`productName-${W}`,value:V.name,onChange:Z=>A(W,"name",Z.target.value),placeholder:"Product Name"})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:`productPrice-${W}`,children:"Price (USD)"}),a.jsx(Je,{id:`productPrice-${W}`,type:"number",value:V.price,onChange:Z=>A(W,"price",Z.target.value),placeholder:"0.00"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(je,{htmlFor:`productDescription-${W}`,children:"Description"}),a.jsx(En,{id:`productDescription-${W}`,value:V.description,onChange:Z=>A(W,"description",Z.target.value),placeholder:"Product Description",rows:3}),V.isDropshipping&&a.jsxs(O,{type:"button",variant:"outline",size:"sm",className:"absolute bottom-2 right-2 text-xs h-7",onClick:()=>$(W),disabled:d[W]||!V.name,children:[d[W]?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate"]})]}),a.jsxs("div",{className:"space-y-2 mb-[3px]",children:[a.jsx(je,{children:"Product Images"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(V.images||[]).map((Z,ce)=>a.jsxs("div",{className:"relative group w-24 h-24 cursor-pointer",onClick:()=>H(Z),children:[a.jsx("img",{src:Z,alt:`Product ${W+1} image ${ce+1}`,className:"w-full h-full object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>I(W,ce),children:a.jsx(Fn,{className:"h-3 w-3"})})]},ce))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`productImageUpload-${W}`).click(),children:[a.jsx(Lo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsx(Je,{id:`productImageUpload-${W}`,type:"file",accept:"image/*",className:"hidden",onChange:Z=>E(W,Z.target.files[0])}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>N(W),disabled:o||!V.name,children:[o?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Image"]}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>k(W),disabled:c[W]||!V.name||!V.images||V.images.length===0,children:[c[W]?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"More Angles/Context"]})]}),V.isPrintOnDemand&&((F=V.podDetails)==null?void 0:F.originalDesignImageUrl)&&a.jsxs(O,{type:"button",variant:"outline",size:"sm",className:"mt-2 w-full",onClick:()=>K(W),disabled:c[W]||C,children:[C&&c[W]!==!0?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Vie,{className:"mr-2 h-4 w-4"}),"Create Full POD Collection"]})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(V.variants||[]).map((Z,ce)=>a.jsxs(Qe,{className:"p-2 space-y-2 bg-muted/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(je,{htmlFor:`variantName-${W}-${ce}`,className:"text-xs",children:"Option Name"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>G(W,ce),className:"h-6 w-6",children:a.jsx(Fn,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(Je,{id:`variantName-${W}-${ce}`,value:Z.name||"",onChange:le=>R(W,ce,le.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(je,{className:"text-xs",children:"Option Values (comma-separated or add one by one)"}),(Z.values||[]).map((le,he)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Je,{value:le||"",onChange:Le=>D(W,ce,he,Le.target.value),placeholder:"e.g., Red",className:"text-sm h-8"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>z(W,ce,he),className:"h-6 w-6",children:a.jsx(Fn,{className:"h-3 w-3 text-destructive"})})]},he)),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>M(W,ce),className:"text-xs h-7",children:[a.jsx(Fi,{className:"mr-1 h-3 w-3"})," Add Value"]})]},ce)),a.jsxs(O,{variant:"outline",onClick:()=>B(W),className:"w-full text-sm h-8",children:[a.jsx(Fi,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]},V.id||W)})})}),a.jsxs(Ar,{children:[a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",onClick:e,disabled:j,children:"Cancel"})}),a.jsxs(O,{type:"button",onClick:Y,disabled:j,children:[j?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Finalize and Create Store"]})]})]})}),g&&f&&a.jsx(Yr,{open:g,onOpenChange:x,children:a.jsxs(Vr,{className:"max-w-xl max-h-[80vh]",children:[a.jsx(Ur,{children:a.jsx(Br,{children:"Enlarged Image"})}),a.jsx("div",{className:"flex justify-center items-center p-4 max-h-[70vh]",children:a.jsx("img",{src:f,alt:"Enlarged product",className:"max-w-full max-h-full object-contain"})})]})})]}):null};function In(){return In=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},In.apply(null,arguments)}function CL(t,[e,n]){return Math.min(n,Math.max(e,t))}function is(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function bA(t,e=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];function u(h){const{scope:f,children:m,...g}=h,x=(f==null?void 0:f[t][c])||l,v=p.useMemo(()=>g,Object.values(g));return p.createElement(x.Provider,{value:v},m)}function d(h,f){const m=(f==null?void 0:f[t][c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,d]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return p.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,D_e(s,...e)]}function D_e(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function M_e(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function LG(...t){return e=>t.forEach(n=>M_e(n,e))}function Os(...t){return p.useCallback(LG(...t),t)}const lg=p.forwardRef((t,e)=>{const{children:n,...r}=t,s=p.Children.toArray(n),i=s.find(F_e);if(i){const o=i.props.children,l=s.map(c=>c===i?p.Children.count(o)>1?p.Children.only(null):p.isValidElement(o)?o.props.children:null:c);return p.createElement(KT,In({},r,{ref:e}),p.isValidElement(o)?p.cloneElement(o,void 0,l):null)}return p.createElement(KT,In({},r,{ref:e}),n)});lg.displayName="Slot";const KT=p.forwardRef((t,e)=>{const{children:n,...r}=t;return p.isValidElement(n)?p.cloneElement(n,{...O_e(r,n.props),ref:e?LG(e,n.ref):n.ref}):p.Children.count(n)>1?p.Children.only(null):null});KT.displayName="SlotClone";const L_e=({children:t})=>p.createElement(p.Fragment,null,t);function F_e(t){return p.isValidElement(t)&&t.type===L_e}function O_e(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{i(...l),s(...l)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function $_e(t){const e=t+"CollectionProvider",[n,r]=bA(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=m=>{const{scope:g,children:x}=m,v=ht.useRef(null),w=ht.useRef(new Map).current;return ht.createElement(s,{scope:g,itemMap:w,collectionRef:v},x)},l=t+"CollectionSlot",c=ht.forwardRef((m,g)=>{const{scope:x,children:v}=m,w=i(l,x),_=Os(g,w.collectionRef);return ht.createElement(lg,{ref:_},v)}),u=t+"CollectionItemSlot",d="data-radix-collection-item",h=ht.forwardRef((m,g)=>{const{scope:x,children:v,...w}=m,_=ht.useRef(null),C=Os(g,_),T=i(u,x);return ht.useEffect(()=>(T.itemMap.set(_,{ref:_,...w}),()=>void T.itemMap.delete(_))),ht.createElement(lg,{[d]:"",ref:C},v)});function f(m){const g=i(t+"CollectionConsumer",m);return ht.useCallback(()=>{const v=g.collectionRef.current;if(!v)return[];const w=Array.from(v.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((T,j)=>w.indexOf(T.ref.current)-w.indexOf(j.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:o,Slot:c,ItemSlot:h},f,r]}const V_e=p.createContext(void 0);function U_e(t){const e=p.useContext(V_e);return t||e||"ltr"}const B_e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],ws=B_e.reduce((t,e)=>{const n=p.forwardRef((r,s)=>{const{asChild:i,...o}=r,l=i?lg:e;return p.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),p.createElement(l,In({},o,{ref:s}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function z_e(t,e){t&&ml.flushSync(()=>t.dispatchEvent(e))}function ul(t){const e=p.useRef(t);return p.useEffect(()=>{e.current=t}),p.useMemo(()=>(...n)=>{var r;return(r=e.current)===null||r===void 0?void 0:r.call(e,...n)},[])}function G_e(t,e=globalThis==null?void 0:globalThis.document){const n=ul(t);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r),()=>e.removeEventListener("keydown",r)},[n,e])}const YT="dismissableLayer.update",W_e="dismissableLayer.pointerDownOutside",H_e="dismissableLayer.focusOutside";let EL;const q_e=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),K_e=p.forwardRef((t,e)=>{var n;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:l,onDismiss:c,...u}=t,d=p.useContext(q_e),[h,f]=p.useState(null),m=(n=h==null?void 0:h.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,g]=p.useState({}),x=Os(e,I=>f(I)),v=Array.from(d.layers),[w]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),_=v.indexOf(w),C=h?v.indexOf(h):-1,T=d.layersWithOutsidePointerEventsDisabled.size>0,j=C>=_,A=Y_e(I=>{const N=I.target,k=[...d.branches].some(R=>R.contains(N));!j||k||(i==null||i(I),l==null||l(I),I.defaultPrevented||c==null||c())},m),E=J_e(I=>{const N=I.target;[...d.branches].some(R=>R.contains(N))||(o==null||o(I),l==null||l(I),I.defaultPrevented||c==null||c())},m);return G_e(I=>{C===d.layers.size-1&&(s==null||s(I),!I.defaultPrevented&&c&&(I.preventDefault(),c()))},m),p.useEffect(()=>{if(h)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(EL=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(h)),d.layers.add(h),TL(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=EL)}},[h,m,r,d]),p.useEffect(()=>()=>{h&&(d.layers.delete(h),d.layersWithOutsidePointerEventsDisabled.delete(h),TL())},[h,d]),p.useEffect(()=>{const I=()=>g({});return document.addEventListener(YT,I),()=>document.removeEventListener(YT,I)},[]),p.createElement(ws.div,In({},u,{ref:x,style:{pointerEvents:T?j?"auto":"none":void 0,...t.style},onFocusCapture:is(t.onFocusCapture,E.onFocusCapture),onBlurCapture:is(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:is(t.onPointerDownCapture,A.onPointerDownCapture)}))});function Y_e(t,e=globalThis==null?void 0:globalThis.document){const n=ul(t),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let u=function(){FG(W_e,n,c,{discrete:!0})};const c={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=u,e.addEventListener("click",s.current,{once:!0})):u()}r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function J_e(t,e=globalThis==null?void 0:globalThis.document){const n=ul(t),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&FG(H_e,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function TL(){const t=new CustomEvent(YT);document.dispatchEvent(t)}function FG(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?z_e(s,i):s.dispatchEvent(i)}let JS=0;function Q_e(){p.useEffect(()=>{var t,e;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=n[0])!==null&&t!==void 0?t:IL()),document.body.insertAdjacentElement("beforeend",(e=n[1])!==null&&e!==void 0?e:IL()),JS++,()=>{JS===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),JS--}},[])}function IL(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}const QS="focusScope.autoFocusOnMount",XS="focusScope.autoFocusOnUnmount",NL={bubbles:!1,cancelable:!0},X_e=p.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[l,c]=p.useState(null),u=ul(s),d=ul(i),h=p.useRef(null),f=Os(e,x=>c(x)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let x=function(C){if(m.paused||!l)return;const T=C.target;l.contains(T)?h.current=T:Ml(h.current,{select:!0})},v=function(C){if(m.paused||!l)return;const T=C.relatedTarget;T!==null&&(l.contains(T)||Ml(h.current,{select:!0}))},w=function(C){const T=document.activeElement;for(const j of C)j.removedNodes.length>0&&(l!=null&&l.contains(T)||Ml(l))};document.addEventListener("focusin",x),document.addEventListener("focusout",v);const _=new MutationObserver(w);return l&&_.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",v),_.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){AL.add(m);const x=document.activeElement;if(!l.contains(x)){const w=new CustomEvent(QS,NL);l.addEventListener(QS,u),l.dispatchEvent(w),w.defaultPrevented||(Z_e(sSe(OG(l)),{select:!0}),document.activeElement===x&&Ml(l))}return()=>{l.removeEventListener(QS,u),setTimeout(()=>{const w=new CustomEvent(XS,NL);l.addEventListener(XS,d),l.dispatchEvent(w),w.defaultPrevented||Ml(x??document.body,{select:!0}),l.removeEventListener(XS,d),AL.remove(m)},0)}}},[l,u,d,m]);const g=p.useCallback(x=>{if(!n&&!r||m.paused)return;const v=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,w=document.activeElement;if(v&&w){const _=x.currentTarget,[C,T]=eSe(_);C&&T?!x.shiftKey&&w===T?(x.preventDefault(),n&&Ml(C,{select:!0})):x.shiftKey&&w===C&&(x.preventDefault(),n&&Ml(T,{select:!0})):w===_&&x.preventDefault()}},[n,r,m.paused]);return p.createElement(ws.div,In({tabIndex:-1},o,{ref:f,onKeyDown:g}))});function Z_e(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Ml(r,{select:e}),document.activeElement!==n)return}function eSe(t){const e=OG(t),n=PL(e,t),r=PL(e.reverse(),t);return[n,r]}function OG(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function PL(t,e){for(const n of t)if(!tSe(n,{upTo:e}))return n}function tSe(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function nSe(t){return t instanceof HTMLInputElement&&"select"in t}function Ml(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&nSe(t)&&e&&t.select()}}const AL=rSe();function rSe(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=kL(t,e),t.unshift(e)},remove(e){var n;t=kL(t,e),(n=t[0])===null||n===void 0||n.resume()}}}function kL(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function sSe(t){return t.filter(e=>e.tagName!=="A")}const yo=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},iSe=a0["useId".toString()]||(()=>{});let oSe=0;function $G(t){const[e,n]=p.useState(iSe());return yo(()=>{t||n(r=>r??String(oSe++))},[t]),t||(e?`radix-${e}`:"")}const aSe=["top","right","bottom","left"],Pc=Math.min,Mi=Math.max,Jw=Math.round,xx=Math.floor,ya=t=>({x:t,y:t}),lSe={left:"right",right:"left",bottom:"top",top:"bottom"},cSe={start:"end",end:"start"};function JT(t,e,n){return Mi(t,Pc(e,n))}function dl(t,e){return typeof t=="function"?t(e):t}function hl(t){return t.split("-")[0]}function Pf(t){return t.split("-")[1]}function _A(t){return t==="x"?"y":"x"}function SA(t){return t==="y"?"height":"width"}function ca(t){return["top","bottom"].includes(hl(t))?"y":"x"}function CA(t){return _A(ca(t))}function uSe(t,e,n){n===void 0&&(n=!1);const r=Pf(t),s=CA(t),i=SA(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Qw(o)),[o,Qw(o)]}function dSe(t){const e=Qw(t);return[QT(t),e,QT(e)]}function QT(t){return t.replace(/start|end/g,e=>cSe[e])}function hSe(t,e,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?s:r:e?r:s;case"left":case"right":return e?i:o;default:return[]}}function fSe(t,e,n,r){const s=Pf(t);let i=hSe(hl(t),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(QT)))),i}function Qw(t){return t.replace(/left|right|bottom|top/g,e=>lSe[e])}function mSe(t){return{top:0,right:0,bottom:0,left:0,...t}}function VG(t){return typeof t!="number"?mSe(t):{top:t,right:t,bottom:t,left:t}}function Xw(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function jL(t,e,n){let{reference:r,floating:s}=t;const i=ca(e),o=CA(e),l=SA(o),c=hl(e),u=i==="y",d=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,f=r[l]/2-s[l]/2;let m;switch(c){case"top":m={x:d,y:r.y-s.height};break;case"bottom":m={x:d,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:h};break;case"left":m={x:r.x-s.width,y:h};break;default:m={x:r.x,y:r.y}}switch(Pf(e)){case"start":m[o]-=f*(n&&u?-1:1);break;case"end":m[o]+=f*(n&&u?-1:1);break}return m}const pSe=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:d,y:h}=jL(u,r,c),f=r,m={},g=0;for(let x=0;x<l.length;x++){const{name:v,fn:w}=l[x],{x:_,y:C,data:T,reset:j}=await w({x:d,y:h,initialPlacement:r,placement:f,strategy:s,middlewareData:m,rects:u,platform:o,elements:{reference:t,floating:e}});d=_??d,h=C??h,m={...m,[v]:{...m[v],...T}},j&&g<=50&&(g++,typeof j=="object"&&(j.placement&&(f=j.placement),j.rects&&(u=j.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):j.rects),{x:d,y:h}=jL(u,f,c)),x=-1)}return{x:d,y:h,placement:f,strategy:s,middlewareData:m}};async function cg(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:l,strategy:c}=t,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:m=0}=dl(e,t),g=VG(m),v=l[f?h==="floating"?"reference":"floating":h],w=Xw(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),_=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,C=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),T=await(i.isElement==null?void 0:i.isElement(C))?await(i.getScale==null?void 0:i.getScale(C))||{x:1,y:1}:{x:1,y:1},j=Xw(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:_,offsetParent:C,strategy:c}):_);return{top:(w.top-j.top+g.top)/T.y,bottom:(j.bottom-w.bottom+g.bottom)/T.y,left:(w.left-j.left+g.left)/T.x,right:(j.right-w.right+g.right)/T.x}}const gSe=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:o,elements:l,middlewareData:c}=e,{element:u,padding:d=0}=dl(t,e)||{};if(u==null)return{};const h=VG(d),f={x:n,y:r},m=CA(s),g=SA(m),x=await o.getDimensions(u),v=m==="y",w=v?"top":"left",_=v?"bottom":"right",C=v?"clientHeight":"clientWidth",T=i.reference[g]+i.reference[m]-f[m]-i.floating[g],j=f[m]-i.reference[m],A=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let E=A?A[C]:0;(!E||!await(o.isElement==null?void 0:o.isElement(A)))&&(E=l.floating[C]||i.floating[g]);const I=T/2-j/2,N=E/2-x[g]/2-1,k=Pc(h[w],N),R=Pc(h[_],N),D=k,M=E-x[g]-R,z=E/2-x[g]/2+I,B=JT(D,z,M),G=!c.arrow&&Pf(s)!=null&&z!==B&&i.reference[g]/2-(z<D?k:R)-x[g]/2<0,Y=G?z<D?z-D:z-M:0;return{[m]:f[m]+Y,data:{[m]:B,centerOffset:z-B-Y,...G&&{alignmentOffset:Y}},reset:G}}}),ySe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:x=!0,...v}=dl(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const w=hl(s),_=ca(l),C=hl(l)===l,T=await(c.isRTL==null?void 0:c.isRTL(u.floating)),j=f||(C||!x?[Qw(l)]:dSe(l)),A=g!=="none";!f&&A&&j.push(...fSe(l,x,g,T));const E=[l,...j],I=await cg(e,v),N=[];let k=((r=i.flip)==null?void 0:r.overflows)||[];if(d&&N.push(I[w]),h){const z=uSe(s,o,T);N.push(I[z[0]],I[z[1]])}if(k=[...k,{placement:s,overflows:N}],!N.every(z=>z<=0)){var R,D;const z=(((R=i.flip)==null?void 0:R.index)||0)+1,B=E[z];if(B&&(!(h==="alignment"?_!==ca(B):!1)||k.every(H=>H.overflows[0]>0&&ca(H.placement)===_)))return{data:{index:z,overflows:k},reset:{placement:B}};let G=(D=k.filter(Y=>Y.overflows[0]<=0).sort((Y,H)=>Y.overflows[1]-H.overflows[1])[0])==null?void 0:D.placement;if(!G)switch(m){case"bestFit":{var M;const Y=(M=k.filter(H=>{if(A){const K=ca(H.placement);return K===_||K==="y"}return!0}).map(H=>[H.placement,H.overflows.filter(K=>K>0).reduce((K,$)=>K+$,0)]).sort((H,K)=>H[1]-K[1])[0])==null?void 0:M[0];Y&&(G=Y);break}case"initialPlacement":G=l;break}if(s!==G)return{reset:{placement:G}}}return{}}}};function RL(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function DL(t){return aSe.some(e=>t[e]>=0)}const xSe=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=dl(t,e);switch(r){case"referenceHidden":{const i=await cg(e,{...s,elementContext:"reference"}),o=RL(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:DL(o)}}}case"escaped":{const i=await cg(e,{...s,altBoundary:!0}),o=RL(i,n.floating);return{data:{escapedOffsets:o,escaped:DL(o)}}}default:return{}}}}};async function vSe(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=hl(n),l=Pf(n),c=ca(n)==="y",u=["left","top"].includes(o)?-1:1,d=i&&c?-1:1,h=dl(e,t);let{mainAxis:f,crossAxis:m,alignmentAxis:g}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof g=="number"&&(m=l==="end"?g*-1:g),c?{x:m*d,y:f*u}:{x:f*u,y:m*d}}const wSe=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:o,middlewareData:l}=e,c=await vSe(e,t);return o===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:o}}}}},bSe=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:v=>{let{x:w,y:_}=v;return{x:w,y:_}}},...c}=dl(t,e),u={x:n,y:r},d=await cg(e,c),h=ca(hl(s)),f=_A(h);let m=u[f],g=u[h];if(i){const v=f==="y"?"top":"left",w=f==="y"?"bottom":"right",_=m+d[v],C=m-d[w];m=JT(_,m,C)}if(o){const v=h==="y"?"top":"left",w=h==="y"?"bottom":"right",_=g+d[v],C=g-d[w];g=JT(_,g,C)}const x=l.fn({...e,[f]:m,[h]:g});return{...x,data:{x:x.x-n,y:x.y-r,enabled:{[f]:i,[h]:o}}}}}},_Se=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=dl(t,e),d={x:n,y:r},h=ca(s),f=_A(h);let m=d[f],g=d[h];const x=dl(l,e),v=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(c){const C=f==="y"?"height":"width",T=i.reference[f]-i.floating[C]+v.mainAxis,j=i.reference[f]+i.reference[C]-v.mainAxis;m<T?m=T:m>j&&(m=j)}if(u){var w,_;const C=f==="y"?"width":"height",T=["top","left"].includes(hl(s)),j=i.reference[h]-i.floating[C]+(T&&((w=o.offset)==null?void 0:w[h])||0)+(T?0:v.crossAxis),A=i.reference[h]+i.reference[C]+(T?0:((_=o.offset)==null?void 0:_[h])||0)-(T?v.crossAxis:0);g<j?g=j:g>A&&(g=A)}return{[f]:m,[h]:g}}}},SSe=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:s,rects:i,platform:o,elements:l}=e,{apply:c=()=>{},...u}=dl(t,e),d=await cg(e,u),h=hl(s),f=Pf(s),m=ca(s)==="y",{width:g,height:x}=i.floating;let v,w;h==="top"||h==="bottom"?(v=h,w=f===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(w=h,v=f==="end"?"top":"bottom");const _=x-d.top-d.bottom,C=g-d.left-d.right,T=Pc(x-d[v],_),j=Pc(g-d[w],C),A=!e.middlewareData.shift;let E=T,I=j;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(I=C),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(E=_),A&&!f){const k=Mi(d.left,0),R=Mi(d.right,0),D=Mi(d.top,0),M=Mi(d.bottom,0);m?I=g-2*(k!==0||R!==0?k+R:Mi(d.left,d.right)):E=x-2*(D!==0||M!==0?D+M:Mi(d.top,d.bottom))}await c({...e,availableWidth:I,availableHeight:E});const N=await o.getDimensions(l.floating);return g!==N.width||x!==N.height?{reset:{rects:!0}}:{}}}};function Kb(){return typeof window<"u"}function Af(t){return UG(t)?(t.nodeName||"").toLowerCase():"#document"}function zi(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Na(t){var e;return(e=(UG(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function UG(t){return Kb()?t instanceof Node||t instanceof zi(t).Node:!1}function Uo(t){return Kb()?t instanceof Element||t instanceof zi(t).Element:!1}function ba(t){return Kb()?t instanceof HTMLElement||t instanceof zi(t).HTMLElement:!1}function ML(t){return!Kb()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof zi(t).ShadowRoot}function iy(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=Bo(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(s)}function CSe(t){return["table","td","th"].includes(Af(t))}function Yb(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function EA(t){const e=TA(),n=Uo(t)?Bo(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function ESe(t){let e=Ac(t);for(;ba(e)&&!hf(e);){if(EA(e))return e;if(Yb(e))return null;e=Ac(e)}return null}function TA(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function hf(t){return["html","body","#document"].includes(Af(t))}function Bo(t){return zi(t).getComputedStyle(t)}function Jb(t){return Uo(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Ac(t){if(Af(t)==="html")return t;const e=t.assignedSlot||t.parentNode||ML(t)&&t.host||Na(t);return ML(e)?e.host:e}function BG(t){const e=Ac(t);return hf(e)?t.ownerDocument?t.ownerDocument.body:t.body:ba(e)&&iy(e)?e:BG(e)}function ug(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=BG(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),o=zi(s);if(i){const l=XT(o);return e.concat(o,o.visualViewport||[],iy(s)?s:[],l&&n?ug(l):[])}return e.concat(s,ug(s,[],n))}function XT(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function zG(t){const e=Bo(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=ba(t),i=s?t.offsetWidth:n,o=s?t.offsetHeight:r,l=Jw(n)!==i||Jw(r)!==o;return l&&(n=i,r=o),{width:n,height:r,$:l}}function IA(t){return Uo(t)?t:t.contextElement}function jh(t){const e=IA(t);if(!ba(e))return ya(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=zG(e);let o=(i?Jw(n.width):n.width)/r,l=(i?Jw(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const TSe=ya(0);function GG(t){const e=zi(t);return!TA()||!e.visualViewport?TSe:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function ISe(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==zi(t)?!1:e}function od(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=IA(t);let o=ya(1);e&&(r?Uo(r)&&(o=jh(r)):o=jh(t));const l=ISe(i,n,r)?GG(i):ya(0);let c=(s.left+l.x)/o.x,u=(s.top+l.y)/o.y,d=s.width/o.x,h=s.height/o.y;if(i){const f=zi(i),m=r&&Uo(r)?zi(r):r;let g=f,x=XT(g);for(;x&&r&&m!==g;){const v=jh(x),w=x.getBoundingClientRect(),_=Bo(x),C=w.left+(x.clientLeft+parseFloat(_.paddingLeft))*v.x,T=w.top+(x.clientTop+parseFloat(_.paddingTop))*v.y;c*=v.x,u*=v.y,d*=v.x,h*=v.y,c+=C,u+=T,g=zi(x),x=XT(g)}}return Xw({width:d,height:h,x:c,y:u})}function NA(t,e){const n=Jb(t).scrollLeft;return e?e.left+n:od(Na(t)).left+n}function WG(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=r.left+e.scrollLeft-(n?0:NA(t,r)),i=r.top+e.scrollTop;return{x:s,y:i}}function NSe(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",o=Na(r),l=e?Yb(e.floating):!1;if(r===o||l&&i)return n;let c={scrollLeft:0,scrollTop:0},u=ya(1);const d=ya(0),h=ba(r);if((h||!h&&!i)&&((Af(r)!=="body"||iy(o))&&(c=Jb(r)),ba(r))){const m=od(r);u=jh(r),d.x=m.x+r.clientLeft,d.y=m.y+r.clientTop}const f=o&&!h&&!i?WG(o,c,!0):ya(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-c.scrollLeft*u.x+d.x+f.x,y:n.y*u.y-c.scrollTop*u.y+d.y+f.y}}function PSe(t){return Array.from(t.getClientRects())}function ASe(t){const e=Na(t),n=Jb(t),r=t.ownerDocument.body,s=Mi(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=Mi(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+NA(t);const l=-n.scrollTop;return Bo(r).direction==="rtl"&&(o+=Mi(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:l}}function kSe(t,e){const n=zi(t),r=Na(t),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,l=0,c=0;if(s){i=s.width,o=s.height;const u=TA();(!u||u&&e==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:i,height:o,x:l,y:c}}function jSe(t,e){const n=od(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=ba(t)?jh(t):ya(1),o=t.clientWidth*i.x,l=t.clientHeight*i.y,c=s*i.x,u=r*i.y;return{width:o,height:l,x:c,y:u}}function LL(t,e,n){let r;if(e==="viewport")r=kSe(t,n);else if(e==="document")r=ASe(Na(t));else if(Uo(e))r=jSe(e,n);else{const s=GG(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Xw(r)}function HG(t,e){const n=Ac(t);return n===e||!Uo(n)||hf(n)?!1:Bo(n).position==="fixed"||HG(n,e)}function RSe(t,e){const n=e.get(t);if(n)return n;let r=ug(t,[],!1).filter(l=>Uo(l)&&Af(l)!=="body"),s=null;const i=Bo(t).position==="fixed";let o=i?Ac(t):t;for(;Uo(o)&&!hf(o);){const l=Bo(o),c=EA(o);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||iy(o)&&!c&&HG(t,o))?r=r.filter(d=>d!==o):s=l,o=Ac(o)}return e.set(t,r),r}function DSe(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?Yb(e)?[]:RSe(e,this._c):[].concat(n),r],l=o[0],c=o.reduce((u,d)=>{const h=LL(e,d,s);return u.top=Mi(h.top,u.top),u.right=Pc(h.right,u.right),u.bottom=Pc(h.bottom,u.bottom),u.left=Mi(h.left,u.left),u},LL(e,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function MSe(t){const{width:e,height:n}=zG(t);return{width:e,height:n}}function LSe(t,e,n){const r=ba(e),s=Na(e),i=n==="fixed",o=od(t,!0,i,e);let l={scrollLeft:0,scrollTop:0};const c=ya(0);function u(){c.x=NA(s)}if(r||!r&&!i)if((Af(e)!=="body"||iy(s))&&(l=Jb(e)),r){const m=od(e,!0,i,e);c.x=m.x+e.clientLeft,c.y=m.y+e.clientTop}else s&&u();i&&!r&&s&&u();const d=s&&!r&&!i?WG(s,l):ya(0),h=o.left+l.scrollLeft-c.x-d.x,f=o.top+l.scrollTop-c.y-d.y;return{x:h,y:f,width:o.width,height:o.height}}function ZS(t){return Bo(t).position==="static"}function FL(t,e){if(!ba(t)||Bo(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Na(t)===n&&(n=n.ownerDocument.body),n}function qG(t,e){const n=zi(t);if(Yb(t))return n;if(!ba(t)){let s=Ac(t);for(;s&&!hf(s);){if(Uo(s)&&!ZS(s))return s;s=Ac(s)}return n}let r=FL(t,e);for(;r&&CSe(r)&&ZS(r);)r=FL(r,e);return r&&hf(r)&&ZS(r)&&!EA(r)?n:r||ESe(t)||n}const FSe=async function(t){const e=this.getOffsetParent||qG,n=this.getDimensions,r=await n(t.floating);return{reference:LSe(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function OSe(t){return Bo(t).direction==="rtl"}const $Se={convertOffsetParentRelativeRectToViewportRelativeRect:NSe,getDocumentElement:Na,getClippingRect:DSe,getOffsetParent:qG,getElementRects:FSe,getClientRects:PSe,getDimensions:MSe,getScale:jh,isElement:Uo,isRTL:OSe};function KG(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function VSe(t,e){let n=null,r;const s=Na(t);function i(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const u=t.getBoundingClientRect(),{left:d,top:h,width:f,height:m}=u;if(l||e(),!f||!m)return;const g=xx(h),x=xx(s.clientWidth-(d+f)),v=xx(s.clientHeight-(h+m)),w=xx(d),C={rootMargin:-g+"px "+-x+"px "+-v+"px "+-w+"px",threshold:Mi(0,Pc(1,c))||1};let T=!0;function j(A){const E=A[0].intersectionRatio;if(E!==c){if(!T)return o();E?o(!1,E):r=setTimeout(()=>{o(!1,1e-7)},1e3)}E===1&&!KG(u,t.getBoundingClientRect())&&o(),T=!1}try{n=new IntersectionObserver(j,{...C,root:s.ownerDocument})}catch{n=new IntersectionObserver(j,C)}n.observe(t)}return o(!0),i}function YG(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,u=IA(t),d=s||i?[...u?ug(u):[],...ug(e)]:[];d.forEach(w=>{s&&w.addEventListener("scroll",n,{passive:!0}),i&&w.addEventListener("resize",n)});const h=u&&l?VSe(u,n):null;let f=-1,m=null;o&&(m=new ResizeObserver(w=>{let[_]=w;_&&_.target===u&&m&&(m.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var C;(C=m)==null||C.observe(e)})),n()}),u&&!c&&m.observe(u),m.observe(e));let g,x=c?od(t):null;c&&v();function v(){const w=od(t);x&&!KG(x,w)&&n(),x=w,g=requestAnimationFrame(v)}return n(),()=>{var w;d.forEach(_=>{s&&_.removeEventListener("scroll",n),i&&_.removeEventListener("resize",n)}),h==null||h(),(w=m)==null||w.disconnect(),m=null,c&&cancelAnimationFrame(g)}}const USe=wSe,BSe=bSe,zSe=ySe,GSe=SSe,WSe=xSe,OL=gSe,HSe=_Se,qSe=(t,e,n)=>{const r=new Map,s={platform:$Se,...n},i={...s.platform,_c:r};return pSe(t,e,{...s,platform:i})};var KSe=typeof document<"u",YSe=function(){},xv=KSe?p.useLayoutEffect:YSe;function Zw(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!Zw(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!Zw(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function JG(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function $L(t,e){const n=JG(t);return Math.round(e*n)/n}function eC(t){const e=p.useRef(t);return xv(()=>{e.current=t}),e}function QG(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=t,[d,h]=p.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,m]=p.useState(r);Zw(f,r)||m(r);const[g,x]=p.useState(null),[v,w]=p.useState(null),_=p.useCallback(H=>{H!==A.current&&(A.current=H,x(H))},[]),C=p.useCallback(H=>{H!==E.current&&(E.current=H,w(H))},[]),T=i||g,j=o||v,A=p.useRef(null),E=p.useRef(null),I=p.useRef(d),N=c!=null,k=eC(c),R=eC(s),D=eC(u),M=p.useCallback(()=>{if(!A.current||!E.current)return;const H={placement:e,strategy:n,middleware:f};R.current&&(H.platform=R.current),qSe(A.current,E.current,H).then(K=>{const $={...K,isPositioned:D.current!==!1};z.current&&!Zw(I.current,$)&&(I.current=$,ml.flushSync(()=>{h($)}))})},[f,e,n,R,D]);xv(()=>{u===!1&&I.current.isPositioned&&(I.current.isPositioned=!1,h(H=>({...H,isPositioned:!1})))},[u]);const z=p.useRef(!1);xv(()=>(z.current=!0,()=>{z.current=!1}),[]),xv(()=>{if(T&&(A.current=T),j&&(E.current=j),T&&j){if(k.current)return k.current(T,j,M);M()}},[T,j,M,k,N]);const B=p.useMemo(()=>({reference:A,floating:E,setReference:_,setFloating:C}),[_,C]),G=p.useMemo(()=>({reference:T,floating:j}),[T,j]),Y=p.useMemo(()=>{const H={position:n,left:0,top:0};if(!G.floating)return H;const K=$L(G.floating,d.x),$=$L(G.floating,d.y);return l?{...H,transform:"translate("+K+"px, "+$+"px)",...JG(G.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:K,top:$}},[n,l,G.floating,d.x,d.y]);return p.useMemo(()=>({...d,update:M,refs:B,elements:G,floatingStyles:Y}),[d,M,B,G,Y])}const JSe=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?OL({element:r.current,padding:s}).fn(n):{}:r?OL({element:r,padding:s}).fn(n):{}}}},XG=(t,e)=>({...USe(t),options:[t,e]}),ZG=(t,e)=>({...BSe(t),options:[t,e]}),e7=(t,e)=>({...HSe(t),options:[t,e]}),t7=(t,e)=>({...zSe(t),options:[t,e]}),n7=(t,e)=>({...GSe(t),options:[t,e]}),r7=(t,e)=>({...WSe(t),options:[t,e]}),s7=(t,e)=>({...JSe(t),options:[t,e]});function QSe(t){const[e,n]=p.useState(void 0);return yo(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}const i7="Popper",[o7,a7]=bA(i7),[XSe,l7]=o7(i7),ZSe=t=>{const{__scopePopper:e,children:n}=t,[r,s]=p.useState(null);return p.createElement(XSe,{scope:e,anchor:r,onAnchorChange:s},n)},eCe="PopperAnchor",tCe=p.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=l7(eCe,n),o=p.useRef(null),l=Os(e,o);return p.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:p.createElement(ws.div,In({},s,{ref:l}))}),c7="PopperContent",[nCe,URe]=o7(c7),rCe=p.forwardRef((t,e)=>{var n,r,s,i,o,l,c,u;const{__scopePopper:d,side:h="bottom",sideOffset:f=0,align:m="center",alignOffset:g=0,arrowPadding:x=0,collisionBoundary:v=[],collisionPadding:w=0,sticky:_="partial",hideWhenDetached:C=!1,avoidCollisions:T=!0,onPlaced:j,...A}=t,E=l7(c7,d),[I,N]=p.useState(null),k=Os(e,ve=>N(ve)),[R,D]=p.useState(null),M=QSe(R),z=(n=M==null?void 0:M.width)!==null&&n!==void 0?n:0,B=(r=M==null?void 0:M.height)!==null&&r!==void 0?r:0,G=h+(m!=="center"?"-"+m:""),Y=typeof w=="number"?w:{top:0,right:0,bottom:0,left:0,...w},H=Array.isArray(v)?v:[v],K=H.length>0,$={padding:Y,boundary:H.filter(sCe),altBoundary:K},{refs:V,floatingStyles:W,placement:F,isPositioned:Z,middlewareData:ce}=QG({strategy:"fixed",placement:G,whileElementsMounted:YG,elements:{reference:E.anchor},middleware:[XG({mainAxis:f+B,alignmentAxis:g}),T&&ZG({mainAxis:!0,crossAxis:!1,limiter:_==="partial"?e7():void 0,...$}),T&&t7({...$}),n7({...$,apply:({elements:ve,rects:ie,availableWidth:Me,availableHeight:He})=>{const{width:yt,height:kt}=ie.reference,en=ve.floating.style;en.setProperty("--radix-popper-available-width",`${Me}px`),en.setProperty("--radix-popper-available-height",`${He}px`),en.setProperty("--radix-popper-anchor-width",`${yt}px`),en.setProperty("--radix-popper-anchor-height",`${kt}px`)}}),R&&s7({element:R,padding:x}),iCe({arrowWidth:z,arrowHeight:B}),C&&r7({strategy:"referenceHidden"})]}),[le,he]=u7(F),Le=ul(j);yo(()=>{Z&&(Le==null||Le())},[Z,Le]);const Ve=(s=ce.arrow)===null||s===void 0?void 0:s.x,Be=(i=ce.arrow)===null||i===void 0?void 0:i.y,ue=((o=ce.arrow)===null||o===void 0?void 0:o.centerOffset)!==0,[Ce,Ie]=p.useState();return yo(()=>{I&&Ie(window.getComputedStyle(I).zIndex)},[I]),p.createElement("div",{ref:V.setFloating,"data-radix-popper-content-wrapper":"",style:{...W,transform:Z?W.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ce,"--radix-popper-transform-origin":[(l=ce.transformOrigin)===null||l===void 0?void 0:l.x,(c=ce.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:t.dir},p.createElement(nCe,{scope:d,placedSide:le,onArrowChange:D,arrowX:Ve,arrowY:Be,shouldHideArrow:ue},p.createElement(ws.div,In({"data-side":le,"data-align":he},A,{ref:k,style:{...A.style,animation:Z?void 0:"none",opacity:(u=ce.hide)!==null&&u!==void 0&&u.referenceHidden?0:void 0}}))))});function sCe(t){return t!==null}const iCe=t=>({name:"transformOrigin",options:t,fn(e){var n,r,s,i,o;const{placement:l,rects:c,middlewareData:u}=e,h=((n=u.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,f=h?0:t.arrowWidth,m=h?0:t.arrowHeight,[g,x]=u7(l),v={start:"0%",center:"50%",end:"100%"}[x],w=((r=(s=u.arrow)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:0)+f/2,_=((i=(o=u.arrow)===null||o===void 0?void 0:o.y)!==null&&i!==void 0?i:0)+m/2;let C="",T="";return g==="bottom"?(C=h?v:`${w}px`,T=`${-m}px`):g==="top"?(C=h?v:`${w}px`,T=`${c.floating.height+m}px`):g==="right"?(C=`${-m}px`,T=h?v:`${_}px`):g==="left"&&(C=`${c.floating.width+m}px`,T=h?v:`${_}px`),{data:{x:C,y:T}}}});function u7(t){const[e,n="center"]=t.split("-");return[e,n]}const oCe=ZSe,aCe=tCe,lCe=rCe,cCe=p.forwardRef((t,e)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...s}=t;return r?hI.createPortal(p.createElement(ws.div,In({},s,{ref:e})),r):null});function VL({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=uCe({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,l=ul(n),c=p.useCallback(u=>{if(i){const h=typeof u=="function"?u(t):u;h!==t&&l(h)}else s(u)},[i,t,s,l]);return[o,c]}function uCe({defaultProp:t,onChange:e}){const n=p.useState(t),[r]=n,s=p.useRef(r),i=ul(e);return p.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}function dCe(t){const e=p.useRef({value:t,previous:t});return p.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}const hCe=p.forwardRef((t,e)=>p.createElement(ws.span,In({},t,{ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}})));var d7=Y3(),tC=function(){},Qb=p.forwardRef(function(t,e){var n=p.useRef(null),r=p.useState({onScrollCapture:tC,onWheelCapture:tC,onTouchMoveCapture:tC}),s=r[0],i=r[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,m=t.noIsolation,g=t.inert,x=t.allowPinchZoom,v=t.as,w=v===void 0?"div":v,_=bf(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),C=f,T=K3([n,e]),j=js(js({},_),s);return p.createElement(p.Fragment,null,d&&p.createElement(C,{sideCar:d7,removeScrollBar:u,shards:h,noIsolation:m,inert:g,setCallbacks:i,allowPinchZoom:!!x,lockRef:n}),o?p.cloneElement(p.Children.only(l),js(js({},j),{ref:T})):p.createElement(w,js({},j,{className:c,ref:T}),l))});Qb.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Qb.classNames={fullWidth:Hm,zeroRight:Wm};var ZT=!1;if(typeof window<"u")try{var vx=Object.defineProperty({},"passive",{get:function(){return ZT=!0,!0}});window.addEventListener("test",vx,vx),window.removeEventListener("test",vx,vx)}catch{ZT=!1}var Od=ZT?{passive:!1}:!1,fCe=function(t){return t.tagName==="TEXTAREA"},h7=function(t,e){var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!fCe(t)&&n[e]==="visible")},mCe=function(t){return h7(t,"overflowY")},pCe=function(t){return h7(t,"overflowX")},UL=function(t,e){var n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=f7(t,n);if(r){var s=m7(t,n),i=s[1],o=s[2];if(i>o)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},gCe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},yCe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},f7=function(t,e){return t==="v"?mCe(e):pCe(e)},m7=function(t,e){return t==="v"?gCe(e):yCe(e)},xCe=function(t,e){return t==="h"&&e==="rtl"?-1:1},vCe=function(t,e,n,r,s){var i=xCe(t,window.getComputedStyle(e).direction),o=i*r,l=n.target,c=e.contains(l),u=!1,d=o>0,h=0,f=0;do{var m=m7(t,l),g=m[0],x=m[1],v=m[2],w=x-v-i*g;(g||w)&&f7(t,l)&&(h+=w,f+=g),l=l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&(s&&h===0||!s&&o>h)||!d&&(s&&f===0||!s&&-o>f))&&(u=!0),u},wx=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},BL=function(t){return[t.deltaX,t.deltaY]},zL=function(t){return t&&"current"in t?t.current:t},wCe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},bCe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},_Ce=0,$d=[];function SCe(t){var e=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(_Ce++)[0],i=p.useState(function(){return MI()})[0],o=p.useRef(t);p.useEffect(function(){o.current=t},[t]),p.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var x=q3([t.lockRef.current],(t.shards||[]).map(zL),!0).filter(Boolean);return x.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),x.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=p.useCallback(function(x,v){if("touches"in x&&x.touches.length===2)return!o.current.allowPinchZoom;var w=wx(x),_=n.current,C="deltaX"in x?x.deltaX:_[0]-w[0],T="deltaY"in x?x.deltaY:_[1]-w[1],j,A=x.target,E=Math.abs(C)>Math.abs(T)?"h":"v";if("touches"in x&&E==="h"&&A.type==="range")return!1;var I=UL(E,A);if(!I)return!0;if(I?j=E:(j=E==="v"?"h":"v",I=UL(E,A)),!I)return!1;if(!r.current&&"changedTouches"in x&&(C||T)&&(r.current=j),!j)return!0;var N=r.current||j;return vCe(N,v,x,N==="h"?C:T,!0)},[]),c=p.useCallback(function(x){var v=x;if(!(!$d.length||$d[$d.length-1]!==i)){var w="deltaY"in v?BL(v):wx(v),_=e.current.filter(function(j){return j.name===v.type&&j.target===v.target&&wCe(j.delta,w)})[0];if(_&&_.should){v.cancelable&&v.preventDefault();return}if(!_){var C=(o.current.shards||[]).map(zL).filter(Boolean).filter(function(j){return j.contains(v.target)}),T=C.length>0?l(v,C[0]):!o.current.noIsolation;T&&v.cancelable&&v.preventDefault()}}},[]),u=p.useCallback(function(x,v,w,_){var C={name:x,delta:v,target:w,should:_};e.current.push(C),setTimeout(function(){e.current=e.current.filter(function(T){return T!==C})},1)},[]),d=p.useCallback(function(x){n.current=wx(x),r.current=void 0},[]),h=p.useCallback(function(x){u(x.type,BL(x),x.target,l(x,t.lockRef.current))},[]),f=p.useCallback(function(x){u(x.type,wx(x),x.target,l(x,t.lockRef.current))},[]);p.useEffect(function(){return $d.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Od),document.addEventListener("touchmove",c,Od),document.addEventListener("touchstart",d,Od),function(){$d=$d.filter(function(x){return x!==i}),document.removeEventListener("wheel",c,Od),document.removeEventListener("touchmove",c,Od),document.removeEventListener("touchstart",d,Od)}},[]);var m=t.removeScrollBar,g=t.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:bCe(s)}):null,m?p.createElement(Z3,{gapMode:"margin"}):null)}const CCe=Q3(d7,SCe);var p7=p.forwardRef(function(t,e){return p.createElement(Qb,js({},t,{ref:e,sideCar:CCe}))});p7.classNames=Qb.classNames;const ECe=p7,TCe=[" ","Enter","ArrowUp","ArrowDown"],ICe=[" ","Enter"],Xb="Select",[Zb,e_,NCe]=$_e(Xb),[kf,BRe]=bA(Xb,[NCe,a7]),PA=a7(),[PCe,gd]=kf(Xb),[ACe,kCe]=kf(Xb),jCe=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:s,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:u,name:d,autoComplete:h,disabled:f,required:m}=t,g=PA(e),[x,v]=p.useState(null),[w,_]=p.useState(null),[C,T]=p.useState(!1),j=U_e(u),[A=!1,E]=VL({prop:r,defaultProp:s,onChange:i}),[I,N]=VL({prop:o,defaultProp:l,onChange:c}),k=p.useRef(null),R=x?!!x.closest("form"):!0,[D,M]=p.useState(new Set),z=Array.from(D).map(B=>B.props.value).join(";");return p.createElement(oCe,g,p.createElement(PCe,{required:m,scope:e,trigger:x,onTriggerChange:v,valueNode:w,onValueNodeChange:_,valueNodeHasChildren:C,onValueNodeHasChildrenChange:T,contentId:$G(),value:I,onValueChange:N,open:A,onOpenChange:E,dir:j,triggerPointerDownPosRef:k,disabled:f},p.createElement(Zb.Provider,{scope:e},p.createElement(ACe,{scope:t.__scopeSelect,onNativeOptionAdd:p.useCallback(B=>{M(G=>new Set(G).add(B))},[]),onNativeOptionRemove:p.useCallback(B=>{M(G=>{const Y=new Set(G);return Y.delete(B),Y})},[])},n)),R?p.createElement(v7,{key:z,"aria-hidden":!0,required:m,tabIndex:-1,name:d,autoComplete:h,value:I,onChange:B=>N(B.target.value),disabled:f},I===void 0?p.createElement("option",{value:""}):null,Array.from(D)):null))},RCe="SelectTrigger",DCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...s}=t,i=PA(n),o=gd(RCe,n),l=o.disabled||r,c=Os(e,o.onTriggerChange),u=e_(n),[d,h,f]=w7(g=>{const x=u().filter(_=>!_.disabled),v=x.find(_=>_.value===o.value),w=b7(x,g,v);w!==void 0&&o.onValueChange(w.value)}),m=()=>{l||(o.onOpenChange(!0),f())};return p.createElement(aCe,In({asChild:!0},i),p.createElement(ws.button,In({type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":o.value===void 0?"":void 0},s,{ref:c,onClick:is(s.onClick,g=>{g.currentTarget.focus()}),onPointerDown:is(s.onPointerDown,g=>{const x=g.target;x.hasPointerCapture(g.pointerId)&&x.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&(m(),o.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)},g.preventDefault())}),onKeyDown:is(s.onKeyDown,g=>{const x=d.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&h(g.key),!(x&&g.key===" ")&&TCe.includes(g.key)&&(m(),g.preventDefault())})})))}),MCe="SelectValue",LCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:o,...l}=t,c=gd(MCe,n),{onValueNodeHasChildrenChange:u}=c,d=i!==void 0,h=Os(e,c.onValueNodeChange);return yo(()=>{u(d)},[u,d]),p.createElement(ws.span,In({},l,{ref:h,style:{pointerEvents:"none"}}),c.value===void 0&&o!==void 0?o:i)}),FCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...s}=t;return p.createElement(ws.span,In({"aria-hidden":!0},s,{ref:e}),r||"▼")}),OCe=t=>p.createElement(cCe,In({asChild:!0},t)),ff="SelectContent",$Ce=p.forwardRef((t,e)=>{const n=gd(ff,t.__scopeSelect),[r,s]=p.useState();if(yo(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?ml.createPortal(p.createElement(g7,{scope:t.__scopeSelect},p.createElement(Zb.Slot,{scope:t.__scopeSelect},p.createElement("div",null,t.children))),i):null}return p.createElement(VCe,In({},t,{ref:e}))}),Ma=10,[g7,yd]=kf(ff),VCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:x,avoidCollisions:v,...w}=t,_=gd(ff,n),[C,T]=p.useState(null),[j,A]=p.useState(null),E=Os(e,he=>T(he)),[I,N]=p.useState(null),[k,R]=p.useState(null),D=e_(n),[M,z]=p.useState(!1),B=p.useRef(!1);p.useEffect(()=>{if(C)return O0(C)},[C]),Q_e();const G=p.useCallback(he=>{const[Le,...Ve]=D().map(Ce=>Ce.ref.current),[Be]=Ve.slice(-1),ue=document.activeElement;for(const Ce of he)if(Ce===ue||(Ce==null||Ce.scrollIntoView({block:"nearest"}),Ce===Le&&j&&(j.scrollTop=0),Ce===Be&&j&&(j.scrollTop=j.scrollHeight),Ce==null||Ce.focus(),document.activeElement!==ue))return},[D,j]),Y=p.useCallback(()=>G([I,C]),[G,I,C]);p.useEffect(()=>{M&&Y()},[M,Y]);const{onOpenChange:H,triggerPointerDownPosRef:K}=_;p.useEffect(()=>{if(C){let he={x:0,y:0};const Le=Be=>{var ue,Ce,Ie,ve;he={x:Math.abs(Math.round(Be.pageX)-((ue=(Ce=K.current)===null||Ce===void 0?void 0:Ce.x)!==null&&ue!==void 0?ue:0)),y:Math.abs(Math.round(Be.pageY)-((Ie=(ve=K.current)===null||ve===void 0?void 0:ve.y)!==null&&Ie!==void 0?Ie:0))}},Ve=Be=>{he.x<=10&&he.y<=10?Be.preventDefault():C.contains(Be.target)||H(!1),document.removeEventListener("pointermove",Le),K.current=null};return K.current!==null&&(document.addEventListener("pointermove",Le),document.addEventListener("pointerup",Ve,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Le),document.removeEventListener("pointerup",Ve,{capture:!0})}}},[C,H,K]),p.useEffect(()=>{const he=()=>H(!1);return window.addEventListener("blur",he),window.addEventListener("resize",he),()=>{window.removeEventListener("blur",he),window.removeEventListener("resize",he)}},[H]);const[$,V]=w7(he=>{const Le=D().filter(ue=>!ue.disabled),Ve=Le.find(ue=>ue.ref.current===document.activeElement),Be=b7(Le,he,Ve);Be&&setTimeout(()=>Be.ref.current.focus())}),W=p.useCallback((he,Le,Ve)=>{const Be=!B.current&&!Ve;(_.value!==void 0&&_.value===Le||Be)&&(N(he),Be&&(B.current=!0))},[_.value]),F=p.useCallback(()=>C==null?void 0:C.focus(),[C]),Z=p.useCallback((he,Le,Ve)=>{const Be=!B.current&&!Ve;(_.value!==void 0&&_.value===Le||Be)&&R(he)},[_.value]),ce=r==="popper"?GL:UCe,le=ce===GL?{side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:x,avoidCollisions:v}:{};return p.createElement(g7,{scope:n,content:C,viewport:j,onViewportChange:A,itemRefCallback:W,selectedItem:I,onItemLeave:F,itemTextRefCallback:Z,focusSelectedItem:Y,selectedItemText:k,position:r,isPositioned:M,searchRef:$},p.createElement(ECe,{as:lg,allowPinchZoom:!0},p.createElement(X_e,{asChild:!0,trapped:_.open,onMountAutoFocus:he=>{he.preventDefault()},onUnmountAutoFocus:is(s,he=>{var Le;(Le=_.trigger)===null||Le===void 0||Le.focus({preventScroll:!0}),he.preventDefault()})},p.createElement(K_e,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:he=>he.preventDefault(),onDismiss:()=>_.onOpenChange(!1)},p.createElement(ce,In({role:"listbox",id:_.contentId,"data-state":_.open?"open":"closed",dir:_.dir,onContextMenu:he=>he.preventDefault()},w,le,{onPlaced:()=>z(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...w.style},onKeyDown:is(w.onKeyDown,he=>{const Le=he.ctrlKey||he.altKey||he.metaKey;if(he.key==="Tab"&&he.preventDefault(),!Le&&he.key.length===1&&V(he.key),["ArrowUp","ArrowDown","Home","End"].includes(he.key)){let Be=D().filter(ue=>!ue.disabled).map(ue=>ue.ref.current);if(["ArrowUp","End"].includes(he.key)&&(Be=Be.slice().reverse()),["ArrowUp","ArrowDown"].includes(he.key)){const ue=he.target,Ce=Be.indexOf(ue);Be=Be.slice(Ce+1)}setTimeout(()=>G(Be)),he.preventDefault()}})}))))))}),UCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...s}=t,i=gd(ff,n),o=yd(ff,n),[l,c]=p.useState(null),[u,d]=p.useState(null),h=Os(e,E=>d(E)),f=e_(n),m=p.useRef(!1),g=p.useRef(!0),{viewport:x,selectedItem:v,selectedItemText:w,focusSelectedItem:_}=o,C=p.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&u&&x&&v&&w){const E=i.trigger.getBoundingClientRect(),I=u.getBoundingClientRect(),N=i.valueNode.getBoundingClientRect(),k=w.getBoundingClientRect();if(i.dir!=="rtl"){const ue=k.left-I.left,Ce=N.left-ue,Ie=E.left-Ce,ve=E.width+Ie,ie=Math.max(ve,I.width),Me=window.innerWidth-Ma,He=CL(Ce,[Ma,Me-ie]);l.style.minWidth=ve+"px",l.style.left=He+"px"}else{const ue=I.right-k.right,Ce=window.innerWidth-N.right-ue,Ie=window.innerWidth-E.right-Ce,ve=E.width+Ie,ie=Math.max(ve,I.width),Me=window.innerWidth-Ma,He=CL(Ce,[Ma,Me-ie]);l.style.minWidth=ve+"px",l.style.right=He+"px"}const R=f(),D=window.innerHeight-Ma*2,M=x.scrollHeight,z=window.getComputedStyle(u),B=parseInt(z.borderTopWidth,10),G=parseInt(z.paddingTop,10),Y=parseInt(z.borderBottomWidth,10),H=parseInt(z.paddingBottom,10),K=B+G+M+H+Y,$=Math.min(v.offsetHeight*5,K),V=window.getComputedStyle(x),W=parseInt(V.paddingTop,10),F=parseInt(V.paddingBottom,10),Z=E.top+E.height/2-Ma,ce=D-Z,le=v.offsetHeight/2,he=v.offsetTop+le,Le=B+G+he,Ve=K-Le;if(Le<=Z){const ue=v===R[R.length-1].ref.current;l.style.bottom="0px";const Ce=u.clientHeight-x.offsetTop-x.offsetHeight,Ie=Math.max(ce,le+(ue?F:0)+Ce+Y),ve=Le+Ie;l.style.height=ve+"px"}else{const ue=v===R[0].ref.current;l.style.top="0px";const Ie=Math.max(Z,B+x.offsetTop+(ue?W:0)+le)+Ve;l.style.height=Ie+"px",x.scrollTop=Le-Z+x.offsetTop}l.style.margin=`${Ma}px 0`,l.style.minHeight=$+"px",l.style.maxHeight=D+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[f,i.trigger,i.valueNode,l,u,x,v,w,i.dir,r]);yo(()=>C(),[C]);const[T,j]=p.useState();yo(()=>{u&&j(window.getComputedStyle(u).zIndex)},[u]);const A=p.useCallback(E=>{E&&g.current===!0&&(C(),_==null||_(),g.current=!1)},[C,_]);return p.createElement(BCe,{scope:n,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:A},p.createElement("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:T}},p.createElement(ws.div,In({},s,{ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}}))))}),GL=p.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=Ma,...i}=t,o=PA(n);return p.createElement(lCe,In({},o,i,{ref:e,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[BCe,AA]=kf(ff,{}),WL="SelectViewport",zCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=yd(WL,n),i=AA(WL,n),o=Os(e,s.onViewportChange),l=p.useRef(0);return p.createElement(p.Fragment,null,p.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),p.createElement(Zb.Slot,{scope:n},p.createElement(ws.div,In({"data-radix-select-viewport":"",role:"presentation"},r,{ref:o,style:{position:"relative",flex:1,overflow:"auto",...r.style},onScroll:is(r.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=i;if(h!=null&&h.current&&d){const f=Math.abs(l.current-u.scrollTop);if(f>0){const m=window.innerHeight-Ma*2,g=parseFloat(d.style.minHeight),x=parseFloat(d.style.height),v=Math.max(g,x);if(v<m){const w=v+f,_=Math.min(m,w),C=w-_;d.style.height=_+"px",d.style.bottom==="0px"&&(u.scrollTop=C>0?C:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})}))))}),GCe="SelectGroup",[zRe,WCe]=kf(GCe),HCe="SelectLabel",qCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=WCe(HCe,n);return p.createElement(ws.div,In({id:s.id},r,{ref:e}))}),e1="SelectItem",[KCe,y7]=kf(e1),YCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...o}=t,l=gd(e1,n),c=yd(e1,n),u=l.value===r,[d,h]=p.useState(i??""),[f,m]=p.useState(!1),g=Os(e,w=>{var _;return(_=c.itemRefCallback)===null||_===void 0?void 0:_.call(c,w,r,s)}),x=$G(),v=()=>{s||(l.onValueChange(r),l.onOpenChange(!1))};return p.createElement(KCe,{scope:n,value:r,disabled:s,textId:x,isSelected:u,onItemTextChange:p.useCallback(w=>{h(_=>{var C;return _||((C=w==null?void 0:w.textContent)!==null&&C!==void 0?C:"").trim()})},[])},p.createElement(Zb.ItemSlot,{scope:n,value:r,disabled:s,textValue:d},p.createElement(ws.div,In({role:"option","aria-labelledby":x,"data-highlighted":f?"":void 0,"aria-selected":u&&f,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1},o,{ref:g,onFocus:is(o.onFocus,()=>m(!0)),onBlur:is(o.onBlur,()=>m(!1)),onPointerUp:is(o.onPointerUp,v),onPointerMove:is(o.onPointerMove,w=>{if(s){var _;(_=c.onItemLeave)===null||_===void 0||_.call(c)}else w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:is(o.onPointerLeave,w=>{if(w.currentTarget===document.activeElement){var _;(_=c.onItemLeave)===null||_===void 0||_.call(c)}}),onKeyDown:is(o.onKeyDown,w=>{var _;((_=c.searchRef)===null||_===void 0?void 0:_.current)!==""&&w.key===" "||(ICe.includes(w.key)&&v(),w.key===" "&&w.preventDefault())})}))))}),bx="SelectItemText",JCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,...i}=t,o=gd(bx,n),l=yd(bx,n),c=y7(bx,n),u=kCe(bx,n),[d,h]=p.useState(null),f=Os(e,w=>h(w),c.onItemTextChange,w=>{var _;return(_=l.itemTextRefCallback)===null||_===void 0?void 0:_.call(l,w,c.value,c.disabled)}),m=d==null?void 0:d.textContent,g=p.useMemo(()=>p.createElement("option",{key:c.value,value:c.value,disabled:c.disabled},m),[c.disabled,c.value,m]),{onNativeOptionAdd:x,onNativeOptionRemove:v}=u;return yo(()=>(x(g),()=>v(g)),[x,v,g]),p.createElement(p.Fragment,null,p.createElement(ws.span,In({id:c.textId},i,{ref:f})),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?ml.createPortal(i.children,o.valueNode):null)}),QCe="SelectItemIndicator",XCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return y7(QCe,n).isSelected?p.createElement(ws.span,In({"aria-hidden":!0},r,{ref:e})):null}),HL="SelectScrollUpButton",ZCe=p.forwardRef((t,e)=>{const n=yd(HL,t.__scopeSelect),r=AA(HL,t.__scopeSelect),[s,i]=p.useState(!1),o=Os(e,r.onScrollButtonChange);return yo(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=l.scrollTop>0;i(u)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),s?p.createElement(x7,In({},t,{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}})):null}),qL="SelectScrollDownButton",eEe=p.forwardRef((t,e)=>{const n=yd(qL,t.__scopeSelect),r=AA(qL,t.__scopeSelect),[s,i]=p.useState(!1),o=Os(e,r.onScrollButtonChange);return yo(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=l.scrollHeight-l.clientHeight,d=Math.ceil(l.scrollTop)<u;i(d)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),s?p.createElement(x7,In({},t,{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}})):null}),x7=p.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=t,i=yd("SelectScrollButton",n),o=p.useRef(null),l=e_(n),c=p.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),yo(()=>{var u;const d=l().find(h=>h.ref.current===document.activeElement);d==null||(u=d.ref.current)===null||u===void 0||u.scrollIntoView({block:"nearest"})},[l]),p.createElement(ws.div,In({"aria-hidden":!0},s,{ref:e,style:{flexShrink:0,...s.style},onPointerDown:is(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:is(s.onPointerMove,()=>{var u;(u=i.onItemLeave)===null||u===void 0||u.call(i),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:is(s.onPointerLeave,()=>{c()})}))}),tEe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return p.createElement(ws.div,In({"aria-hidden":!0},r,{ref:e}))}),v7=p.forwardRef((t,e)=>{const{value:n,...r}=t,s=p.useRef(null),i=Os(e,s),o=dCe(n);return p.useEffect(()=>{const l=s.current,c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==n&&d){const h=new Event("change",{bubbles:!0});d.call(l,n),l.dispatchEvent(h)}},[o,n]),p.createElement(hCe,{asChild:!0},p.createElement("select",In({},r,{ref:i,defaultValue:n})))});v7.displayName="BubbleSelect";function w7(t){const e=ul(t),n=p.useRef(""),r=p.useRef(0),s=p.useCallback(o=>{const l=n.current+o;e(l),function c(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(l)},[e]),i=p.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function b7(t,e,n){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=nEe(t,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function nEe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}const rEe=jCe,_7=DCe,sEe=LCe,iEe=FCe,oEe=OCe,S7=$Ce,aEe=zCe,C7=qCe,E7=YCe,lEe=JCe,cEe=XCe,T7=ZCe,I7=eEe,N7=tEe,gc=rEe,yc=sEe,Qa=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(_7,{ref:r,className:bt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,a.jsx(iEe,{asChild:!0,children:a.jsx(Cu,{className:"h-4 w-4 opacity-50"})})]}));Qa.displayName=_7.displayName;const P7=ht.forwardRef(({className:t,...e},n)=>a.jsx(T7,{ref:n,className:bt("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(I3,{className:"h-4 w-4"})}));P7.displayName=T7.displayName;const A7=ht.forwardRef(({className:t,...e},n)=>a.jsx(I7,{ref:n,className:bt("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(Cu,{className:"h-4 w-4"})}));A7.displayName=I7.displayName;const Xa=ht.forwardRef(({className:t,children:e,position:n="popper",...r},s)=>a.jsx(oEe,{children:a.jsxs(S7,{ref:s,className:bt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[a.jsx(P7,{}),a.jsx(aEe,{className:bt("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),a.jsx(A7,{})]})}));Xa.displayName=S7.displayName;const uEe=ht.forwardRef(({className:t,...e},n)=>a.jsx(C7,{ref:n,className:bt("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));uEe.displayName=C7.displayName;const Qn=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(E7,{ref:r,className:bt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(cEe,{children:a.jsx(Eg,{className:"h-4 w-4"})})}),a.jsx(lEe,{children:e})]}));Qn.displayName=E7.displayName;const dEe=ht.forwardRef(({className:t,...e},n)=>a.jsx(N7,{ref:n,className:bt("-mx-1 my-1 h-px bg-muted",t),...e}));dEe.displayName=N7.displayName;const hEe=({isOpen:t,onClose:e,designs:n,onContinue:r})=>{const[s,i]=p.useState([]),[o,l]=p.useState({}),[c,u]=p.useState(""),[d,h]=p.useState(null),{toast:f}=as();p.useEffect(()=>{n&&i(n)},[n]);const m=(_,C)=>{const T=eo.find(j=>j.name===C);T&&i(j=>{const A=[...j];return A[_].podProductInfo=T,A[_].name=T.name,A})},g=_=>{const C=s[_],T={...C,id:Ft()};i(j=>[...j,T]),f({title:"Design Duplicated",description:`A copy of ${C.name} has been added.`})},x=_=>{const C=s[_];i(T=>T.filter((j,A)=>A!==_)),f({title:"Design Removed",description:`${C.name} has been removed.`,variant:"destructive"})},v=async _=>{if(!c){f({title:"Prompt Required",description:"Please enter a prompt to edit the image.",variant:"destructive"});return}l({[_]:{edit:!0}});const C=s[_];try{const{base64ImageData:T,mimeType:j}=await ag(C.images[0]),A=await $o(T,j,c);if(A&&A.editedImageData){const E=[...s],I=`data:${A.newMimeType};base64,${A.editedImageData}`;E[_].images[0]=I,i(E),f({title:"Design Edited",description:"The design has been updated.",variant:"success"})}else throw new Error("Failed to get edited image data.")}catch(T){console.error("Error editing design:",T),f({title:"Edit Failed",description:T.message,variant:"destructive"})}finally{l({}),h(null),u("")}},w=async _=>{if(!c){f({title:"Prompt Required",description:"Please enter a prompt to replace the image.",variant:"destructive"});return}l({[_]:{replace:!0}});try{const C=await Ng({prompt:c});if(C&&C.imageData){const T=[...s],j=`data:${C.imageMimeType};base64,${C.imageData}`;T[_].images[0]=j,i(T),f({title:"Design Replaced",description:"A new design has been generated.",variant:"success"})}else throw new Error("Failed to get new image data.")}catch(C){console.error("Error replacing design:",C),f({title:"Replace Failed",description:C.message,variant:"destructive"})}finally{l({}),h(null),u("")}};return t?a.jsx(Yr,{open:t,onOpenChange:_=>!_&&e(),children:a.jsxs(Vr,{className:"max-w-4xl",children:[a.jsxs(Ur,{children:[a.jsx(Br,{children:"Review and Edit Your Designs"}),a.jsx(Qi,{children:"Modify the generated designs before we create your logo and products."})]}),a.jsx(Fs,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pr-4",children:s.map((_,C)=>{var T,j,A,E;return a.jsxs(Qe,{className:"p-4 space-y-3 flex flex-col",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:_.images[0],alt:`Design for ${_.name}`,className:"w-full h-48 object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6",onClick:()=>x(C),children:a.jsx(Fn,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow space-y-2",children:[a.jsx("h4",{className:"font-semibold",children:_.name}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:`product-type-${C}`,className:"text-sm font-medium",children:"Product Type"}),a.jsxs(gc,{value:_.podProductInfo.name,onValueChange:I=>m(C,I),children:[a.jsx(Qa,{children:a.jsx(yc,{placeholder:"Select product type"})}),a.jsx(Xa,{children:eo.map(I=>a.jsx(Qn,{value:I.name,children:I.name},I.name))})]})]})]}),d===C?a.jsxs("div",{className:"space-y-2 mt-auto",children:[a.jsx(En,{placeholder:"Enter prompt to edit or replace...",value:c,onChange:I=>u(I.target.value)}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{onClick:()=>v(C),disabled:(T=o[C])==null?void 0:T.edit,children:[(j=o[C])!=null&&j.edit?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Op,{className:"mr-2 h-4 w-4"}),"Apply Edit"]}),a.jsxs(O,{onClick:()=>w(C),disabled:(A=o[C])==null?void 0:A.replace,children:[(E=o[C])!=null&&E.replace?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(L3,{className:"mr-2 h-4 w-4"}),"Replace"]}),a.jsx(O,{variant:"ghost",onClick:()=>h(null),children:"Cancel"})]})]}):a.jsxs(O,{onClick:()=>{h(C),u("")},className:"w-full",children:[a.jsx(Er,{className:"mr-2 h-4 w-4"})," Edit or Replace"]}),a.jsxs(O,{onClick:()=>g(C),variant:"outline",className:"w-full mt-2",children:[a.jsx(AI,{className:"mr-2 h-4 w-4"})," Duplicate"]})]},_.id||C)})})}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel Generation"}),a.jsx(O,{type:"button",onClick:()=>r(s),children:"Continue with These Designs"})]})]})}):null},tr="/placeholder-image.png",k7=p.createContext(null),$n=()=>{const t=p.useContext(k7);if(!t)throw new Error("useStore must be used within a StoreProvider");return t},KL="ecommerce-cart",fEe=({children:t})=>{const[e,n]=p.useState([]),[r,s]=p.useState(null),[i,o]=p.useState(!1),[l,c]=p.useState(0),[u,d]=p.useState(""),[h,f]=p.useState(!1),[m,g]=p.useState([]),[x,v]=p.useState("published"),{toast:w}=as(),_=ti(),{user:C,session:T,profile:j}=Ia(),A=xe=>{xe==="published"||xe==="edit"?v(xe):(console.warn(`Invalid view mode: ${xe}. Defaulting to 'published'.`),v("published"))},[E,I]=p.useState(0),[N,k]=p.useState(""),[R,D]=p.useState(""),[M,z]=p.useState(null),[B,G]=p.useState({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[Y,H]=p.useState({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[K,$]=p.useState(null),[V,W]=p.useState(!1),[F,Z]=p.useState(null),[ce,le]=p.useState(null),[he,Le]=p.useState(!1),[Ve,Be]=p.useState(null),[ue,Ce]=p.useState(null),[Ie,ve]=p.useState(!1),[ie,Me]=p.useState(!1),[He,yt]=p.useState(!1),[kt,en]=p.useState([]),[mn,cn]=p.useState(null),[fn,Ue]=p.useState(!1),[Et,de]=p.useState(!1),[De,ee]=p.useState([]),[ae,X]=p.useState(null),[Pe,Ae]=p.useState(!1),$e=p.useCallback(({newProducts:xe,newCollection:pe})=>{en(we=>[...we,...xe]),cn(we=>({...we,collections:[...(we==null?void 0:we.collections)||[],pe]})),w({title:"POD Items Added",description:`${xe.length} products and 1 collection are ready for finalization.`,variant:"success"})},[en,cn,w]),[qe,oe]=p.useState(0),[_e,ze]=p.useState(""),[Te,Tt]=p.useState(""),[wt,xt]=p.useState(null),[pt,Pt]=p.useState({items:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[Rn,Sn]=p.useState(!1),[cr,sn]=p.useState(null),$t=async(xe,pe)=>{if(!xe||!pe)return console.error("Missing base64 string or path for Firebase Storage upload."),null;const we=xe.split(",")[1];if(!we)return console.error("Invalid base64 string provided for upload."),null;const se=ph(gh,pe),Ee={contentType:"image/png"};try{const We=atob(we),nt=new Array(We.length);for(let Rt=0;Rt<We.length;Rt++)nt[Rt]=We.charCodeAt(Rt);const Ye=new Uint8Array(nt),Re=await fh(se,Ye,Ee),mt=await mh(Re.ref);return console.log(`Uploaded ${pe} to Firebase Storage. URL: ${mt}`),mt}catch(We){throw console.error(`Error uploading ${pe} to Firebase Storage:`,We),We}},tn=xe=>xe?xe.map(pe=>{const we={...pe};if(we.logo_url&&we.logo_url.startsWith("data:image/")&&we.logo_url.length>2048&&(we.logo_url=`${we.logo_url.substring(0,30)}...[truncated]`),we.hero_image&&we.hero_image.src){const se={...we.hero_image.src};se.large&&se.large.startsWith("data:image/")&&se.large.length>2048&&(se.large=`${se.large.substring(0,30)}...[truncated]`),se.medium&&se.medium.startsWith("data:image/")&&se.medium.length>2048&&(se.medium=`${se.medium.substring(0,30)}...[truncated]`),we.hero_image={...we.hero_image,src:se}}return we.products&&Array.isArray(we.products)&&(we.products=we.products.map(se=>{const Ee={...se};if(Ee.image&&Ee.image.src){const We={...Ee.image.src};We.medium&&We.medium.startsWith("data:image/")&&We.medium.length>2048&&(We.medium=`${We.medium.substring(0,30)}...[truncated]`),We.large&&We.large.startsWith("data:image/")&&We.large.length>2048&&(We.large=`${We.large.substring(0,30)}...[truncated]`),Ee.image={...Ee.image,src:We}}return Ee})),we.collections&&Array.isArray(we.collections)&&(we.collections=we.collections.map(se=>{const{products:Ee,...We}=se;return We})),we}):[],Zn=p.useCallback(async()=>{f(!0),console.log("[StoreContext] loadStores called for all public stores.");let xe=[],pe=[];const we=localStorage.getItem("ecommerce-stores");if(we)try{xe=JSON.parse(we),console.log(`[StoreContext] Loaded ${xe.length} stores from localStorage.`)}catch(Ee){console.error("[StoreContext] Failed to parse localStorage stores:",Ee),w({title:"Local Cache Error",description:"Failed to load stores from local cache.",variant:"warning"}),xe=[]}n(xe),console.log("[StoreContext] Fetching all public stores from Firestore.");try{const Ee=Yo(nr,"stores"),We=await Jo(Ee);if(We.empty)console.log("[StoreContext] No public stores found in Firestore.");else{console.log(`[StoreContext] Fetched ${We.size} stores from Firestore. Processing details...`);const nt=We.docs.map(Re=>({id:Re.id,...Re.data()}));pe=await Promise.all(nt.map(async Re=>{var mt,Rt;try{const Dt=Yo(nr,"stores",Re.id,"products"),Jt=(await Jo(Dt)).docs.map(Ct=>({id:Ct.id,...Ct.data()})).map(Ct=>{let vr={src:{large:"",medium:""}};return Ct.images&&Array.isArray(Ct.images)&&Ct.images.length>0&&(vr.src.large=Ct.images[0],vr.src.medium=Ct.images[0]),{...Ct,price:Ct.priceAmount,image:vr,variants:Ct.variants||[]}}),Lt={...Re,createdAt:((Rt=(mt=Re.created_at)==null?void 0:mt.toDate())==null?void 0:Rt.toISOString())||new Date().toISOString()};let Vn=[];const er=Yo(nr,"stores",Re.id,"collections"),ur=(await Jo(er)).docs.map(Ct=>({id:Ct.id,...Ct.data()}));return ur&&ur.length>0&&(Vn=await Promise.all(ur.map(async Ct=>{let vr=[];return Ct.product_ids&&Ct.product_ids.length>0&&(vr=Jt.filter(ls=>Ct.product_ids.includes(ls.id))),{...Ct,image:{src:Ct.image_url||""},products:vr}}))),{...Lt,products:Jt,collections:Vn}}catch(Dt){return console.error(`[StoreContext] Critical error processing details for store ${Re.id}:`,Dt),{...Re,products:[],collections:[]}}})),console.log(`[StoreContext] Finished processing details for ${pe.length} cloud stores.`)}}catch(Ee){console.error("[StoreContext] Overall critical error in fetching cloud stores:",Ee),w({title:"Cloud Loading Error",description:"A critical error occurred while fetching cloud store data.",variant:"destructive"})}const se=[...xe];pe.forEach(Ee=>{const We=se.findIndex(nt=>nt.id===Ee.id);We>-1?se[We]=Ee:se.push(Ee)}),se.sort((Ee,We)=>new Date(We.createdAt||We.created_at)-new Date(Ee.createdAt||Ee.created_at)),n(se);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(se))),console.log("[StoreContext] Updated localStorage with merged stores.")}catch(Ee){console.error("[StoreContext] Failed to save merged stores to localStorage:",Ee),w({title:"Local Cache Update Failed",description:"Could not update the local cache after cloud sync.",variant:"warning",duration:7e3})}f(!1),console.log(`[StoreContext] loadStores finished. isLoadingStores: false. Final stores count: ${e.length}`)},[w,nr,tn]),J=p.useCallback(async(xe,pe)=>{var Ee,We;const we=e.find(nt=>nt.id===xe);if(!we){console.warn(`[StoreContext] updateStore: Store with ID ${xe} not found in current state.`),w({title:"Update Failed",description:"Store not found for update.",variant:"destructive"});return}const se={...we,...pe};if(console.log(`[StoreContext] updateStore: updatedLocalStore for store ${xe} - Products: ${((Ee=se.products)==null?void 0:Ee.length)||0}, Collections: ${((We=se.collections)==null?void 0:We.length)||0}`),n(nt=>{const Ye=nt.map(Re=>Re.id===xe?se:Re);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(Ye))),console.log(`[StoreContext] updateStore: Saved ${Ye.length} stores to localStorage.`)}catch(Re){console.error("Failed to save stores to localStorage during update:",Re),w({title:"Local Cache Update Failed",description:"Could not update the local cache for the store.",variant:"warning",duration:7e3})}return Ye}),r&&r.id===xe&&(s(se),console.log(`[StoreContext] updateStore: currentStore updated for store ${xe}.`)),w({title:"Store Updated (Locally)",description:"Changes saved locally."}),C){f(!0);try{const{settings:nt,products:Ye,collections:Re,user_id:mt,...Rt}=pe,Dt=ki(nr,"stores",xe);await px(Dt,Rt),console.log(`Store ${xe} synced to Firestore asynchronously.`)}catch(nt){console.error("Unexpected error during async Firestore updateStore:",nt),w({title:"Cloud Sync Error",description:"An unexpected error occurred during cloud sync.",variant:"destructive"})}finally{f(!1)}}},[e,C,w,r,s,n,f,tn]),re=p.useCallback(async(xe,pe)=>{if(!r||!r.id){w({title:"Error",description:"No current store selected to update.",variant:"destructive"});return}if(typeof xe!="string"||xe.trim()===""){w({title:"Error",description:"Invalid identifier for text content.",variant:"destructive"});return}const we=r.id,se=typeof r.content=="object"&&r.content!==null?r.content:{};let Ee=JSON.parse(JSON.stringify(se));const We=xe.split(".");let nt=Ee;for(let Ye=0;Ye<We.length-1;Ye++){const Re=We[Ye];(!nt[Re]||typeof nt[Re]!="object")&&(nt[Re]={}),nt=nt[Re]}nt[We[We.length-1]]=pe,await J(we,{content:Ee})},[r,J,w]);p.useEffect(()=>{localStorage.setItem(KL,JSON.stringify(m))},[m]),p.useEffect(()=>{const xe=localStorage.getItem(KL);if(xe)try{g(JSON.parse(xe))}catch(pe){console.error("Failed to parse stored cart:",pe)}},[]);const ge=async xe=>{let pe={...xe};try{const St=pe.type||pe.name||"business",Jt=await io(St,1);Jt.length>0&&(pe.card_background_url=Jt[0].src.large)}catch(St){console.error("Failed to fetch background image from Pexels:",St),pe.card_background_url=tr}const we=pe.name||`Store-${Ft().substring(0,6)}`;pe.name||(pe.name=we);const se=await Oe(we);if(!se.available){const St=se.error===!0?`Failed to verify store name "${we}". Please try again.`:`The store name "${we}" or a similar URL is already in use. Please choose a different name.`;throw w({title:"Store Name Unavailable",description:St,variant:"destructive"}),new Error(St)}pe.urlSlug=se.slug,pe.template_version||(pe.template_version="v1");const Ee=pe.id||Ft(),We={...pe,id:Ee,createdAt:new Date().toISOString()};let nt=We.products||[];const Ye=new Map;let Re=[];if(nt=nt.map(St=>({...St,id:St.id||Ft()})),nt.forEach(St=>{Ye.set(St.name,St.id)}),C&&C.uid)try{const{id:St,settings:Jt,products:Lt,collections:Vn,user_id:er,...xr}=We,ur=ki(nr,"stores",St);let Ct=xr.logo_url;if(Ct&&Ct.startsWith("data:image/"))try{const wr=`store_logos/${St}/logo_${Ft()}.png`;Ct=await $t(Ct,wr)}catch(wr){console.error("Error uploading store logo to Firebase Storage:",wr),w({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),Ct=tr}else Ct||(Ct=tr);let vr=xr.logo_url_light;if(vr&&vr.startsWith("data:image/"))try{const wr=`store_logos/${St}/logo_light_${Ft()}.png`;vr=await $t(vr,wr)}catch(wr){console.error("Error uploading store logo to Firebase Storage:",wr),w({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),vr=tr}let ls=xr.logo_url_dark;if(ls&&ls.startsWith("data:image/"))try{const wr=`store_logos/${St}/logo_dark_${Ft()}.png`;ls=await $t(ls,wr)}catch(wr){console.error("Error uploading store logo to Firebase Storage:",wr),w({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),ls=tr}const Ei={...xr,merchant_id:C.uid,created_at:new Date,logo_url:Ct||tr,logo_url_light:vr,logo_url_dark:ls,urlSlug:We.urlSlug,card_background_url:We.card_background_url};if(await dp(ur,Ei),console.log(`Store ${St} saved to Firestore asynchronously.`),We.products&&We.products.length>0){const wr=[];for(const Kn of We.products){let br=[];if(Kn.images&&Array.isArray(Kn.images))for(const Aa of Kn.images)if(Aa.startsWith("data:image/"))try{const oi=`store_products/${St}/${Kn.id||Ft()}/${Ft()}.png`,Xc=await $t(Aa,oi);Xc?br.push(Xc):br.push(tr)}catch(oi){console.error(`Error uploading product image for ${Kn.name}:`,oi),w({title:"Product Image Upload Failed",description:`Could not upload image for ${Kn.name}.`,variant:"warning"}),br.push(tr)}else Aa?br.push(Aa):br.push(tr);br.length===0&&br.push(tr);const ts={store_id:St,name:Kn.name||`Product ${Ft().substring(0,8)}`,description:Kn.description||"No description available.",images:br,priceAmount:Number(Kn.price)>=0?Number(Kn.price):0,currency:"usd",variants:Kn.variants||[],created_at:new Date},Ho=ki(nr,"stores",St,"products",Kn.id||Ft());wr.push(dp(Ho,ts)),Ye.set(Kn.name,Ho.id)}await Promise.all(wr)}if(We.collections&&We.collections.length>0){const wr=[];for(const Kn of We.collections){let br=Kn.imageUrl;if(br&&br.startsWith("data:image/"))try{const oi=`store_collections/${St}/${Kn.id||Ft()}/${Ft()}.png`;br=await $t(br,oi)}catch(oi){console.error("Error uploading collection image to Firebase Storage:",oi),w({title:"Collection Image Upload Failed",description:"Could not upload collection image.",variant:"warning"}),br=tr}else br||(br=tr);const ts=(Kn.product_ids||[]).map(oi=>Ye.get(oi)).filter(Boolean),Ho={store_id:St,name:Kn.name,description:Kn.description,image_url:br||tr,product_ids:ts,created_at:new Date},Aa=ki(nr,"stores",St,"collections",Kn.id||Ft());wr.push(dp(Aa,Ho)),Re.push({id:Aa.id,...Ho})}await Promise.all(wr)}}catch(St){console.error("Overall async Firestore store creation error. Code:",St.code,"Message:",St.message,"Full Error:",St),setTimeout(()=>{w({title:"Cloud Sync Error",description:`Firestore error (${St.code||"Unknown Code"}): ${St.message}`,variant:"destructive"})},0)}else C&&!C.uid&&(console.error("Firestore save skipped: User object is present but user.uid is undefined."),setTimeout(()=>{w({title:"User UID Missing",description:"Cannot save to cloud: User UID is missing. Please try logging out and back in.",variant:"destructive"})},0));let mt=[];const Rt=We.collections||[],Dt=nt.map(St=>{const Jt=Array.isArray(St.images)&&St.images.length>0?St.images[0]:tr;return{...St,image:{src:{medium:Jt,large:Jt}}}});Rt.length>0&&(mt=Rt.map(St=>{let Jt={};if(C&&Re&&Re.length>0){const er=Re.find(xr=>xr.name===St.name);er&&(Jt=er)}let Lt=[];St.product_ids&&St.product_ids.length>0&&St.product_ids.forEach(er=>{const xr=Ye.get(er);let ur=null;xr?(ur=Dt.find(Ct=>Ct.id===xr),ur||er!==xr&&(ur=Dt.find(Ct=>Ct.id===er))):ur=Dt.find(Ct=>Ct.id===er),ur&&Lt.push(ur)});const Vn=(Jt==null?void 0:Jt.image_url)||St.imageUrl||"";return{...St,...Jt,image:{src:Vn},products:Lt}}));const Nn={...We,products:Dt,collections:mt};return n(St=>{const Jt=[Nn,...St.filter(Lt=>Lt.id!==Nn.id)];try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(Jt)))}catch(Lt){console.error("Failed to save stores to localStorage during store creation:",Lt),w({title:"Local Cache Update Failed",description:"Could not update the local cache after creating the store.",variant:"warning",duration:7e3})}return Jt}),s(Nn),Nn},Oe=async xe=>{if(!xe||typeof xe!="string"||xe.trim()==="")return{available:!0,slug:"",error:"Name cannot be empty."};const pe=pc(xe.trim());if(!pe)return{available:!0,slug:"",error:"Invalid name for URL generation."};try{const we=Yo(nr,"stores"),se=zT(we,GT("urlSlug","==",pe));return{available:(await Jo(se)).empty,slug:pe}}catch(we){return console.error("Error checking store name availability:",we),w({title:"Name Check Failed",description:"Could not verify store name uniqueness.",variant:"destructive"}),{available:!1,slug:pe,error:!0}}},tt=async xe=>{var pe,we;o(!0),c(0),d("Initializing wizard-based store generation...");try{const se=await E_e(xe,{fetchPexelsImages:io,generateId:Ft}),Ee=await ge(se);return c(100),d("Store generation complete!"),Ee}catch(se){return console.error("Error generating store from wizard:",se),!((pe=se.message)!=null&&pe.includes("already in use"))&&!((we=se.message)!=null&&we.includes("Failed to verify store name"))&&w({title:"Wizard Generation Failed",description:se.message||"Failed to generate store.",variant:"destructive"}),c(0),d("Generation failed."),null}finally{o(!1)}},Q=async(xe,pe=null,we=null,se=[],Ee=!1,We=!1,nt=[],Ye=[])=>{o(!0),c(0),d("Initializing generation...");try{if(Ee){d("Generating initial designs...");const mt=[eo.find(Dt=>Dt.name==="Canvas"),eo.find(Dt=>Dt.name==="Hat"),eo.find(Dt=>Dt.name==="Black hoodie"),eo.find(Dt=>Dt.name==="Mug"),eo.find(Dt=>Dt.name==="Notebook"),eo.find(Dt=>Dt.name==="Pillow")].filter(Boolean);let Rt=[];if(mt.length>0){const Dt=mt.slice(0,6);let Nn=null;if(nt&&nt.length>0){const St=nt.find(Jt=>Jt.file.type.startsWith("image/"));if(St)try{const{base64ImageData:Jt,mimeType:Lt}=await u_e(St.file);Nn={base64Data:Jt,mimeType:Lt},d("Processing reference image...")}catch(Jt){console.error("Error processing reference image:",Jt),w({title:"Image Error",description:"Could not process the uploaded reference image.",variant:"destructive"})}}for(const[St,Jt]of Dt.entries()){c(St/Dt.length*100),d(`Generating design for ${Jt.name}...`);const Lt=await Ng({prompt:xe,referenceImage:Nn});if(Lt&&Lt.imageData){const Vn=`data:${Lt.imageMimeType};base64,${Lt.imageData}`;Rt.push({id:Ft(),name:Jt.name,images:[Vn],podProductInfo:Jt})}}}X({prompt:xe,storeNameOverride:pe,productTypeOverride:we}),ee(Rt),de(!0),o(!1);return}let Re;if(Ye.length>0){const mt=(Nn,St)=>{c(Nn),St&&d(St)};Re=await KS(xe,{storeNameOverride:pe,productTypeOverride:we,fetchPexelsImages:io,generateId:Ft,isPrintOnDemand:!1,isDropshipping:!0,contextFiles:nt,contextURLs:[],generateProducts:!1},mt);const Rt=Ye.map(Nn=>({id:String(Nn.product_id),name:Nn.product_title,description:Nn.product_description,price:parseFloat(Nn.target_sale_price)||0,images:Nn.product_photos,isDropshipping:!0}));Re.products=Rt;const Dt=await YS(Re.type,Re.name,Rt,!1,!0,mt,70,20,Ft);Re.collections=Dt}else{const mt=(Rt,Dt)=>{c(Rt),Dt&&d(Dt)};if(Re=await KS(xe,{storeNameOverride:pe,productTypeOverride:we,fetchPexelsImages:io,generateId:Ft,isPrintOnDemand:!1,contextFiles:nt,contextURLs:[]},mt),Re.products.length>0){const Rt=await YS(Re.type,Re.name,Re.products,Ee,We,mt,70,20,Ft);Re.collections=Rt}}en(Re.products||[]),cn(Re),o(!1),yt(!0),d("Products generated. Please review and finalize."),c(90)}catch(Re){console.error("Error generating store from prompt:",Re),w({title:"Generation Failed",description:Re.message||"Failed to generate store.",variant:"destructive"}),c(0),d("Generation failed."),o(!1)}},te=async xe=>{de(!1),o(!0),c(0),d("Re-visualizing designs on products...");const{prompt:pe,storeNameOverride:we,productTypeOverride:se}=ae;let Ee=[];try{for(const[Re,mt]of xe.entries()){const Rt=Re/xe.length*50;c(Rt);const Dt=mt.podProductInfo,Nn=mt.images[0],{base64ImageData:St,mimeType:Jt}=await ag(Nn);d(`Visualizing design on ${Dt.name}...`);const Lt=await Vp(St,Jt,Dt.imageUrl,pe,Dt.name);if(Lt&&Lt.visualizedImageData&&Lt.productDetails){const Vn=`data:${Lt.visualizedImageMimeType};base64,${Lt.visualizedImageData}`;Ee.push({id:Ft(),name:Lt.productDetails.title||`${Dt.name} with design`,description:Lt.productDetails.description||`A unique ${Dt.name}.`,price:Lt.productDetails.price||"29.99",images:[Nn,Vn],variants:Lt.productDetails.variants||[],isPrintOnDemand:!0,podDetails:{originalDesignImageUrl:Nn,designPrompt:pe,baseProductName:Dt.name,baseProductImageUrl:Dt.imageUrl},category:Dt.category||"Print on Demand"})}}const We=(Re,mt)=>{c(50+Re/2),mt&&d(mt)};let nt=await KS(pe,{storeNameOverride:we,productTypeOverride:se,fetchPexelsImages:io,generateId:Ft,isPrintOnDemand:!0},We);const Ye=[...Ee,...nt.products||[]];if(nt.products=Ye,nt.products.length>0){const Re=await YS(nt.type,nt.name,nt.products,!0,!1,We,80,10,Ft);nt.collections=Re}en(Ye),cn(nt),o(!1),yt(!0),d("Products generated. Please review and finalize."),c(90)}catch(We){console.error("Error continuing store generation:",We),w({title:"Generation Failed",description:We.message||"Failed to continue store generation.",variant:"destructive"}),c(0),d("Generation failed."),o(!1)}},me=async(xe,pe,we,se=null)=>{if(!xe)return w({title:"Error",description:"Missing design image for POD collection generation.",variant:"destructive"}),null;if(se===null)console.log("Generating POD collection data for pre-finalization stage.");else{if(!se)return w({title:"Error",description:"Store ID is invalid for updating POD collection.",variant:"destructive"}),null;console.log(`Generating POD collection for existing store: ${se}`)}Ue(!0),w({title:"Generating POD Collection",description:"Applying design to all mockups..."});let Ee=[],We=`Collection from ${we} Design`;try{const{base64ImageData:nt,mimeType:Ye}=await ag(xe);for(const mt of eo){if(mt.name===we){console.log(`Skipping visualization for base product: ${we}`);continue}console.log(`Visualizing design on mockup: ${mt.name}`);const Rt=await Vp(nt,Ye,mt.imageUrl,pe||`Product based on ${we} design`,mt.name);if(Rt&&Rt.visualizedImageData&&Rt.productDetails){const Dt=`data:${Rt.visualizedImageMimeType};base64,${Rt.visualizedImageData}`;Ee.push({id:Ft(),name:Rt.productDetails.title,price:parseFloat(Rt.productDetails.price),description:Rt.productDetails.description,images:[Dt],isPrintOnDemand:!0,podDetails:{originalDesignImageUrl:xe,designPrompt:pe,baseProductName:mt.name,baseProductImageUrl:mt.imageUrl},variants:Rt.productDetails.variants||[]})}else console.warn(`Failed to visualize design on ${mt.name} for collection. Error: ${Rt==null?void 0:Rt.error}`)}if(Ee.length===0)return w({title:"Collection Generation Incomplete",description:"Could not create any new products for the collection.",variant:"warning"}),null;const Re={id:Ft(),name:We,description:`A collection of products featuring the design from ${we}. Original design prompt: ${pe||"N/A"}`,imageUrl:Ee[0].images[0]||tr,product_ids:Ee.map(mt=>mt.id)};if(se||(Re.products=[...Ee]),se){const mt=e.find(Nn=>Nn.id===se);if(!mt)throw new Error("Store not found to add the new collection.");const Rt=[...mt.products||[],...Ee],Dt=[...mt.collections||[],Re];return await J(se,{products:Rt,collections:Dt}),w({title:"POD Collection Created",description:`Collection "${We}" with ${Ee.length} products added to store.`,variant:"success"}),{success:!0}}else return w({title:"POD Items Generated",description:`${Ee.length} products and 1 collection ready.`,variant:"info"}),{newProducts:Ee,newCollection:Re}}catch(nt){return console.error("Error generating POD collection from design:",nt),w({title:"POD Collection Error",description:nt.message,variant:"destructive"}),null}finally{Ue(!1)}},q=p.useCallback(()=>{I(0),k(""),D(""),z(null),G({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),H({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),$(null),W(!1),Z(null),le(null),Le(!1),Be(null)},[]),ne=p.useCallback(async(xe,pe)=>{k(xe),D(pe),W(!0),Z(null),z(null);try{w({title:"Connecting to Shopify...",description:"Fetching store information."});const we=await T_e(xe,pe);if(!we)throw new Error("Failed to fetch Shopify store metadata. The store might not exist or the token might be invalid.");return z(we),I(2),!0}catch(we){return console.error("Error starting Shopify import wizard (fetching metadata):",we),Z(we.message||"Failed to connect to Shopify and fetch store information."),w({title:"Connection Failed",description:we.message||"Could not fetch store information.",variant:"destructive"}),!1}finally{W(!1)}},[w,k,D,W,Z,z,I]),be=p.useCallback(()=>{oe(0),ze(""),Tt(""),xt(null),Pt({items:[],pageInfo:{hasNextPage:!1,endCursor:null}}),Sn(!1),sn(null)},[]),Ne=p.useCallback(async(xe,pe)=>{const we=xe||_e,se=pe||Te;if(!we||!se){sn("Domain or token missing for fetching BigCommerce settings.");return}W(!0),sn(null);try{const Ee=await k_e(we,se);xt(Ee)}catch(Ee){console.error("Error fetching BigCommerce settings for wizard:",Ee),sn(Ee.message||"Failed to fetch store settings."),w({title:"BigCommerce Settings Fetch Failed",description:Ee.message,variant:"destructive"})}finally{W(!1)}},[_e,Te,w,sn,xt,W]),Ge=p.useCallback(async(xe,pe)=>{ze(xe),Tt(pe),oe(2),await Ne(xe,pe)},[ze,Tt,oe,Ne]),Se=p.useCallback(async(xe=10)=>{if(!_e||!Te){sn("Domain or token missing for fetching BigCommerce products.");return}Sn(!0),sn(null);try{const pe=`
      query ProductsPreview($first: Int!) {
        site {
          products(first: $first) {
            edges {
              node {
                entityId name sku defaultImage { url(width: 200) altText }
                prices { price { value currencyCode } }
              }
            }
          }
        }
      }
    `,we={first:xe},Ee=await(await fetch(`https://${_e}/graphql`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Te}`},body:JSON.stringify({query:pe,variables:we})})).json();if(Ee.errors)throw new Error(Ee.errors.map(We=>We.message).join(", "));Pt({items:Ee.data.site.products.edges.map(We=>We.node),pageInfo:{hasNextPage:!1,endCursor:null}})}catch(pe){console.error("Error fetching BigCommerce products for wizard:",pe),sn(pe.message||"Failed to fetch products."),w({title:"BigCommerce Product Fetch Failed",description:pe.message,variant:"destructive"})}finally{Sn(!1)}},[_e,Te,w,sn,Pt,Sn]),ot=p.useCallback(async()=>{if(!wt||!_e||!Te)return w({title:"Import Error",description:"Missing BigCommerce data to finalize import.",variant:"destructive"}),!1;o(!0),sn(null);try{const xe=await SL(_e,Te),pe=A_e(wt,xe,_e,{generateId:Ft},null);return await ge(pe)?(be(),!0):!1}catch(xe){return console.error("Error finalizing BigCommerce import from wizard:",xe),sn(xe.message||"Failed to finalize BigCommerce import."),w({title:"BigCommerce Import Failed",description:xe.message,variant:"destructive"}),!1}finally{o(!1)}},[wt,_e,Te,ge,be,w,o,sn,SL]),st=p.useCallback(async(xe=10,pe=null)=>{if(!N||!R){Z("Domain or token missing for fetching products.");return}W(!0),Z(null);try{const we=await N_e(N,R,xe,pe);G(se=>({edges:pe?[...se.edges,...we.edges]:we.edges,pageInfo:we.pageInfo}))}catch(we){console.error("Error fetching Shopify products for wizard:",we),Z(we.message||"Failed to fetch products."),w({title:"Product Fetch Failed",description:we.message,variant:"destructive"})}finally{W(!1)}},[N,R,w,Z,G,W]),Mt=p.useCallback(async(xe=10,pe=null)=>{if(!N||!R){Z("Domain or token missing for fetching collections.");return}W(!0),Z(null);try{const we=await I_e(N,R,xe,pe);H(se=>({edges:pe?[...se.edges,...we.edges]:we.edges,pageInfo:we.pageInfo}))}catch(we){console.error("Error fetching Shopify collections for wizard:",we),Z(we.message||"Failed to fetch collections."),w({title:"Collection Fetch Failed",description:we.message,variant:"destructive"})}finally{W(!1)}},[N,R,w,Z,H,W]),xn=p.useCallback(async(xe="US",pe="EN")=>{if(!N||!R){Z("Domain or token missing for fetching localization.");return}W(!0),Z(null);try{const we=await P_e(N,R,xe,pe);$(we)}catch(we){console.error("Error fetching Shopify localization for wizard:",we),Z(we.message||"Failed to fetch localization info."),w({title:"Localization Info Fetch Failed",description:we.message,variant:"default"})}finally{W(!1)}},[N,R,w,Z,$,W]),Zr=p.useCallback(async()=>{if(console.log("[StoreContext] Attempting to generate Shopify store logo..."),!M||!M.name){console.warn("[StoreContext] Cannot generate logo: Shopify preview metadata or store name is missing.",M),Be("Store name is not available to generate a logo."),w({title:"Logo Generation Error",description:"Store name missing. Ensure Shopify store details were fetched correctly.",variant:"destructive"});return}const xe=M.name;console.log(`[StoreContext] Generating logo for store name: "${xe}"`),Le(!0),Be(null),le(null);try{console.log("[StoreContext] Calling generateLogoWithGemini...");const{imageData:pe,textResponse:we}=await Ig(xe);if(console.log("[StoreContext] generateLogoWithGemini response:",{imageData:pe?"imageData received (see next log)":"no imageData",textResponse:we}),pe)console.log("[StoreContext] imageData (first 50 chars):",pe.substring(0,50)),le(`data:image/png;base64,${pe}`),w({title:"Logo Generated!",description:"A new logo has been generated successfully."}),console.log("[StoreContext] Logo generated and state updated.");else throw console.error("[StoreContext] generateLogoWithGemini returned no imageData. Text response:",we),new Error(we||"Gemini did not return image data.")}catch(pe){console.error("[StoreContext] Error during Shopify store logo generation:",pe.message,pe.stack),Be(pe.message||"Failed to generate logo."),w({title:"Logo Generation Failed",description:`Error: ${pe.message}`,variant:"destructive"})}finally{Le(!1),console.log("[StoreContext] Finished logo generation attempt.")}},[M,w,Be,Le,le]),Dn=p.useCallback(async()=>{var xe,pe,we,se,Ee,We,nt,Ye,Re,mt,Rt,Dt,Nn,St;if(!M||!N||!R)return w({title:"Import Error",description:"Missing essential Shopify data to finalize import.",variant:"destructive"}),!1;o(!0),Z(null);try{const Jt=B.edges.map(Ct=>Ct.node),Lt=Y.edges.map(Ct=>Ct.node);let Vn=`Create a store named '${M.name}'.`;M.description&&(Vn+=` The store's description is: "${M.description}".`),(xe=M.brand)!=null&&xe.slogan&&(Vn+=` Slogan: "${M.brand.slogan}".`),Jt.length>0&&(Vn+=` It sells products like ${Jt.slice(0,3).map(Ct=>Ct.title).join(", ")}.`),Lt.length>0&&(Vn+=` Key collections include ${Lt.slice(0,2).map(Ct=>Ct.title).join(", ")}.`),(se=(we=(pe=M.brand)==null?void 0:pe.colors)==null?void 0:we.primary)!=null&&se.background&&(Vn+=` The primary brand color is ${M.brand.colors.primary.background}.`),(nt=(We=(Ee=M.brand)==null?void 0:Ee.colors)==null?void 0:We.secondary)!=null&&nt.background&&(Vn+=` The secondary brand color is ${M.brand.colors.secondary.background}.`);const er=Jt.map(Ct=>{var vr,ls,Ei,wr,Kn,br;return{name:Ct.title,price:((wr=(Ei=(ls=(vr=Ct.variants)==null?void 0:vr.edges[0])==null?void 0:ls.node)==null?void 0:Ei.price)==null?void 0:wr.amount)||"0",description:Ct.descriptionHtml?Ct.descriptionHtml.replace(/<[^>]*>?/gm,""):Ct.description||"",images:((Kn=Ct.images)==null?void 0:Kn.edges.map(ts=>ts.node.url))||[],variants:((br=Ct.variants)==null?void 0:br.edges.map(ts=>{var Ho;return{id:ts.node.id,title:ts.node.title,price:((Ho=ts.node.price)==null?void 0:Ho.amount)||"0"}}))||[]}}),xr=Lt.map(Ct=>{var vr,ls;return{name:Ct.title,description:Ct.descriptionHtml?Ct.descriptionHtml.replace(/<[^>]*>?/gm,""):Ct.description||"",imageUrl:((vr=Ct.image)==null?void 0:vr.url)||"",product_ids:((ls=Ct.products)==null?void 0:ls.edges.map(Ei=>Ei.node.id))||[]}}),ur={name:M.name,prompt:Vn,logoUrl:ce||((mt=(Re=(Ye=M==null?void 0:M.brand)==null?void 0:Ye.logo)==null?void 0:Re.image)==null?void 0:mt.url)||((Nn=(Dt=(Rt=M==null?void 0:M.brand)==null?void 0:Rt.squareLogo)==null?void 0:Dt.image)==null?void 0:Nn.url),products:er,collections:xr,brandColors:(St=M.brand)==null?void 0:St.colors};return Ce(ur),ve(!0),q(),I(4),Me(!0),w({title:"Import Successful",description:"Store data imported. Proceed to configure and generate your store.",duration:5e3}),!0}catch(Jt){return console.error("Error preparing data for StoreGenerator from Shopify import:",Jt),Z(Jt.message||"Failed to process Shopify data for generator."),w({title:"Import Processing Failed",description:Jt.message||"Could not prepare imported data.",variant:"destructive"}),!1}finally{o(!1)}},[M,N,R,B,Y,ce,ge,q,I,Me,Ce,ve,w,o,Z]),Gr=p.useCallback(()=>{Ce(null),ve(!1)},[]),bs=p.useCallback(xe=>{const pe=e.find(we=>we.id===xe);return pe?{...pe}:null},[e]),Ci=p.useCallback(xe=>{const pe=e.find(we=>pc(we.name)===xe);return pe?{...pe}:null},[e]),Vs=async xe=>{console.log(`[StoreContext] getStoreBySlug called for slug: ${xe}`);try{const pe=Yo(nr,"stores"),we=zT(pe,GT("urlSlug","==",xe)),se=await Jo(we);if(se.empty)return console.log(`[StoreContext] No store found with slug: ${xe}`),null;const Ee=se.docs[0],We={id:Ee.id,...Ee.data()};console.log(`[StoreContext] Found store with slug ${xe}. Fetching details...`);const nt=Yo(nr,"stores",We.id,"products"),mt=(await Jo(nt)).docs.map(Lt=>({id:Lt.id,...Lt.data()})).map(Lt=>{var Vn,er;return{...Lt,price:Lt.priceAmount,image:{src:{large:((Vn=Lt.images)==null?void 0:Vn[0])||"",medium:((er=Lt.images)==null?void 0:er[0])||""}},variants:Lt.variants||[]}}),Rt=Yo(nr,"stores",We.id,"collections"),Nn=(await Jo(Rt)).docs.map(Lt=>({id:Lt.id,...Lt.data()})),St=await Promise.all(Nn.map(async Lt=>{const Vn=mt.filter(er=>{var xr;return(xr=Lt.product_ids)==null?void 0:xr.includes(er.id)});return{...Lt,image:{src:Lt.image_url||""},products:Vn}})),Jt={...We,products:mt,collections:St};return n(Lt=>{const Vn=Lt.findIndex(er=>er.id===Jt.id);if(Vn>-1){const er=[...Lt];return er[Vn]=Jt,er}return[...Lt,Jt]}),Jt}catch(pe){return console.error(`[StoreContext] Error fetching store by slug ${xe}:`,pe),w({title:"Error Fetching Store",description:"Could not retrieve store data from the server.",variant:"destructive"}),null}},Us=p.useCallback((xe,pe)=>{const we=bs(xe),se=we==null?void 0:we.products.find(Ee=>Ee.id===pe);return se?{...se}:null},[bs]),es=async(xe,pe)=>{if(!C){w({title:"Authentication Required",description:"Please log in to set a pass key.",variant:"destructive"});return}f(!0);try{const we=ki(nr,"stores",xe);await px(we,{pass_key:pe}),n(se=>{const Ee=se.map(We=>We.id===xe?{...We,pass_key:pe}:We);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(Ee)))}catch(We){console.error("Failed to save stores to localStorage after pass key update:",We),w({title:"Local Cache Update Failed",description:"Could not update the local cache after pass key update.",variant:"warning",duration:7e3})}return Ee}),r&&r.id===xe&&s(se=>se?{...se,pass_key:pe}:null),w({title:"Store Pass Key Set",description:"The pass key for the store has been updated."})}catch(we){console.error("Unexpected error in updateStorePassKey:",we),w({title:"Pass Key Update Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{f(!1)}},nn=async(xe,pe)=>{if(!C){w({title:"Authentication Required",description:"Please log in to assign a manager.",variant:"destructive"});return}if(!xe||!pe){w({title:"Missing Information",description:"Store ID and Manager Email are required.",variant:"destructive"});return}f(!0);try{console.warn("Assign Store Manager functionality needs to be migrated to a Firebase Cloud Function or direct Firestore logic."),w({title:"Manager Assignment (Placeholder)",description:"Functionality needs Firebase Cloud Function implementation.",variant:"info"}),w({title:"Store Manager Assigned",description:`Manager ${pe} assigned to store.`})}catch(we){console.error("Unexpected error in assignStoreManager:",we),w({title:"Manager Assignment Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{f(!1)}},Cn=async(xe,pe,we)=>{if(!C){w({title:"Authentication Required",description:"Please log in to update product images.",variant:"destructive"});return}const se=e.find(nt=>nt.id===xe);if(!se){console.warn(`[StoreContext] updateProductImage: Store with ID ${xe} not found.`),w({title:"Update Failed",description:"Store not found for updating product image.",variant:"destructive"});return}let Ee=we.src.large;if(Ee&&Ee.startsWith("data:image/"))try{const nt=`store_products/${xe}/${pe}/image_${Ft()}.png`,Ye=await $t(Ee,nt);Ye?Ee=Ye:(Ee=Ee.startsWith("data:image/")?tr:Ee,w({title:"Image Upload Failed",description:"Could not upload new product image. Using placeholder or existing.",variant:"warning"}))}catch(nt){console.error(`Error uploading new product image for ${pe}:`,nt),w({title:"Image Upload Failed",description:"Could not upload new product image.",variant:"destructive"}),Ee=tr}else Ee||(Ee=tr);const We=se.products.map(nt=>nt.id===pe?{...nt,image:{...nt.image,src:{large:Ee,medium:Ee}},images:nt.images?[...nt.images.filter(Ye=>Ye!==nt.image.src.large),Ee]:[Ee]}:nt);try{const nt=ki(nr,"stores",xe,"products",pe);await px(nt,{images:We.find(Ye=>Ye.id===pe).images,image:{src:{large:Ee,medium:Ee}}}),w({title:"Product Image Updated",description:"The product image has been changed."})}catch(nt){console.error("Error updating product image in Firestore:",nt),w({title:"Cloud Sync Failed",description:`Failed to save product image to cloud: ${nt.message}`,variant:"destructive"});return}n(nt=>{const Ye=nt.map(Re=>Re.id===xe?{...Re,products:We}:Re);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(Ye)))}catch(Re){console.error("Failed to save stores to localStorage during product image update:",Re),w({title:"Local Cache Update Failed",description:"Could not update the local cache for product image.",variant:"warning",duration:7e3})}return Ye}),r&&r.id===xe&&s(nt=>nt?{...nt,products:We}:null)},si=async xe=>{if(!C){w({title:"Authentication Required",description:"Please log in to delete a store.",variant:"destructive"});return}const pe=[...e];n(we=>{const se=we.filter(Ee=>Ee.id!==xe);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(se)))}catch(Ee){console.error("Failed to save stores to localStorage during optimistic delete:",Ee),w({title:"Local Cache Update Issue",description:"Could not update the local cache during store deletion. Cloud operation will proceed.",variant:"warning",duration:7e3})}return se}),r&&r.id===xe&&s(null);try{const we=Yo(nr,"stores",xe,"products"),se=await Jo(we),Ee=[];for(const mt of se.docs)Ee.push(GS(ki(nr,"stores",xe,"products",mt.id)));await Promise.all(Ee),console.log(`Deleted ${se.size} products for store ${xe}.`);const We=Yo(nr,"stores",xe,"collections"),nt=await Jo(We),Ye=[];for(const mt of nt.docs)Ye.push(GS(ki(nr,"stores",xe,"collections",mt.id)));await Promise.all(Ye),console.log(`Deleted ${nt.size} collections for store ${xe}.`);const Re=ki(nr,"stores",xe);await GS(Re),console.log(`Store ${xe} deleted from Firestore.`),w({title:"Store Deleted",description:"Your store has been deleted."})}catch(we){console.error("Error deleting store from Firestore:",we),w({title:"Deletion Failed",description:we.message,variant:"destructive"}),n(pe);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(pe)))}catch(se){console.error("Failed to save stores to localStorage during delete rollback:",se),w({title:"Local Cache Revert Failed",description:"Could not revert local cache changes after a failed deletion.",variant:"error",duration:8e3})}pe.find(se=>se.id===xe)&&s(pe.find(se=>se.id===xe)||null);return}},ii=async(xe,pe,we)=>{if(!C){w({title:"Authentication Required",description:"Please log in to update product images.",variant:"destructive"});return}const se=e.find(Ye=>Ye.id===xe);if(!se){console.warn(`[StoreContext] updateProductImagesArray: Store with ID ${xe} not found.`),w({title:"Update Failed",description:"Store not found for updating product images.",variant:"destructive"});return}let Ee=!1,We=[];for(const Ye of we)if(typeof Ye=="string"&&Ye.startsWith("data:image/"))try{const Re=`store_products/${xe}/${pe}/gallery_${Ft()}.png`,mt=await $t(Ye,Re);mt?We.push(mt):We.push(tr)}catch(Re){console.error(`Error uploading gallery image for product ${pe}:`,Re),w({title:"Image Upload Failed",description:"Could not upload one or more product gallery images.",variant:"destructive"}),We.push(tr)}else typeof Ye=="string"&&Ye?We.push(Ye):(console.warn(`[StoreContext] updateProductImagesArray: Invalid or empty image in newImagesArray for product ${pe}`,Ye),We.push(tr));We.length===0&&we.length>0&&We.push(tr);const nt=se.products.map(Ye=>{var Re,mt;if(Ye.id===pe){Ee=!0;const Rt=We.length>0?We[0]:((mt=(Re=Ye.image)==null?void 0:Re.src)==null?void 0:mt.medium)||tr;return{...Ye,images:We.length>0?We:[tr],image:{...Ye.image||{id:Ft(),alt:Ye.name||"Product Image"},src:{medium:Rt,large:Rt}}}}return Ye});if(!Ee){console.warn(`[StoreContext] updateProductImagesArray: Product with ID ${pe} not found in store ${xe}.`),w({title:"Update Failed",description:"Product not found for updating images.",variant:"destructive"});return}try{const Ye=ki(nr,"stores",xe,"products",pe),Re=nt.find(mt=>mt.id===pe);if(Re)await px(Ye,{images:Re.images,image:Re.image}),w({title:"Product Images Updated",description:"The product's image gallery has been updated."});else throw new Error("Updated product data not found for Firestore update.")}catch(Ye){console.error("Error updating product images array in Firestore:",Ye),w({title:"Cloud Sync Failed",description:`Failed to save product images to cloud: ${Ye.message}`,variant:"destructive"});return}n(Ye=>{const Re=Ye.map(mt=>mt.id===xe?{...mt,products:nt}:mt);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(Re)))}catch(mt){console.error("Failed to save stores to localStorage during product images array update:",mt),w({title:"Local Cache Update Failed",description:"Could not update the local cache for product images array.",variant:"warning",duration:7e3})}return Re}),r&&r.id===xe&&s(Ye=>Ye?{...Ye,products:nt}:null)},Mn=(xe,pe)=>{g(we=>we.find(Ee=>Ee.id===xe.id&&Ee.storeId===pe)?we.map(Ee=>Ee.id===xe.id&&Ee.storeId===pe?{...Ee,quantity:Ee.quantity+1}:Ee):[...we,{...xe,quantity:1,storeId:pe}]),w({title:"Added to Cart",description:`${xe.name} has been added to your cart.`})},Bs=(xe,pe)=>{g(we=>we.filter(se=>!(se.id===xe&&se.storeId===pe))),w({title:"Removed from Cart",description:"Item removed from your cart.",variant:"destructive"})},vo=(xe,pe,we)=>{if(we<1){Bs(xe,pe);return}g(se=>se.map(Ee=>Ee.id===xe&&Ee.storeId===pe?{...Ee,quantity:we}:Ee))},Wo=()=>{g([]),w({title:"Cart Cleared",description:"Your shopping cart is now empty."})},Qc=p.useCallback((xe,pe)=>{const we=e.find(We=>We.id===xe);if(!we)return console.warn(`[getUpdatesForVersion] Store with ID ${xe} not found.`),{template_version:pe};let se={template_version:pe};const Ee=we.theme||{};return we.template_version,pe==="v1"?["Montserrat","PremiumMain","SharpFont","FreshFont","SleekFont"].includes(Ee.fontFamily)||!Ee.fontFamily?se.theme={...Ee,fontFamily:"Inter"}:se.theme={...Ee}:pe==="premium"&&(se.theme={...Ee,fontFamily:"PremiumMain"}),se},[e]),Pa={stores:e,currentStore:r,isGenerating:i,isLoadingStores:h,cart:m,user:C,progress:l,statusMessage:u,loadStores:Zn,generateStore:Q,updateStoreTextContent:re,checkStoreNameAvailability:Oe,getStoreById:bs,getStoreByName:Ci,getStoreBySlug:Vs,updateStore:J,deleteStore:si,setCurrentStore:s,updateStorePassKey:es,assignStoreManager:nn,updateStoreTemplateVersion:async(xe,pe)=>{if(!xe||!pe){w({title:"Error",description:"Store ID and new template version are required.",variant:"destructive"});return}const we=Qc(xe,pe);await J(xe,we);let se=pe;pe==="v1"?se="Modern":pe==="premium"?se="Premium":pe==="sharp"?se="Sharp":pe==="fresh"?se="Fresh":pe==="sleek"?se="Sleek":se=pe.charAt(0).toUpperCase()+pe.slice(1),w({title:"Template Updated",description:`Store template is now ${se}.`})},getProductById:Us,updateProductImage:Cn,generateStoreFromWizard:tt,addToCart:Mn,removeFromCart:Bs,updateQuantity:vo,clearCart:Wo,generateAIProducts:C_e,updateProductImagesArray:ii,generatePodCollectionFromDesign:me,addPendingPodCollectionData:$e,isGeneratingPodCollection:fn,viewMode:x,setViewMode:A,shopifyWizardStep:E,setShopifyWizardStep:I,shopifyDomain:N,setShopifyDomain:k,shopifyToken:R,setShopifyToken:D,shopifyPreviewMetadata:M,shopifyPreviewProducts:B,shopifyPreviewCollections:Y,shopifyLocalization:K,isFetchingShopifyPreviewData:V,shopifyImportError:F,generatedLogoImage:ce,isGeneratingLogo:he,logoGenerationError:Ve,shopifyWizardShouldShowGenerator:ie,setShopifyWizardShouldShowGenerator:Me,startShopifyImportWizard:ne,fetchShopifyWizardProducts:st,importedStoreDataForGenerator:ue,isImportDataReadyForGenerator:Ie,clearImportedStoreDataForGenerator:Gr,fetchShopifyWizardCollections:Mt,fetchShopifyWizardLocalization:xn,generateShopifyStoreLogo:Zr,finalizeShopifyImportFromWizard:Dn,resetShopifyWizardState:q,updateShopifyPreviewMetadata:xe=>{z(xe)},updateShopifyPreviewProduct:xe=>{G(pe=>{const we=pe.edges.map(se=>se.node.id===xe.id?{...se,node:xe}:se);return{...pe,edges:we}})},updateShopifyPreviewCollection:xe=>{H(pe=>{const we=pe.edges.map(se=>se.node.id===xe.id?{...se,node:xe}:se);return{...pe,edges:we}})},isAuthModalOpen:Pe,openAuthModal:()=>Ae(!0),closeAuthModal:()=>Ae(!1),bigCommerceWizardStep:qe,setBigCommerceWizardStep:oe,bigCommerceStoreDomain:_e,bigCommerceApiToken:Te,bigCommercePreviewSettings:wt,bigCommercePreviewProducts:pt,isFetchingBigCommercePreviewData:Rn,bigCommerceImportError:cr,startBigCommerceImportWizard:Ge,fetchBigCommerceWizardSettings:Ne,fetchBigCommerceWizardProducts:Se,finalizeBigCommerceImportFromWizard:ot,resetBigCommerceWizardState:be,closeDesignEditModal:()=>{de(!1),ee([]),X(null),o(!1),c(0),d("")},continueGenerationWithDesigns:te,openProductFinalizationModal:(xe,pe)=>{en(xe),cn(pe),yt(!0)},closeProductFinalizationModal:()=>{yt(!1),en([]),cn(null),o(!1),c(0),d("")},handleFinalizeProducts:async xe=>{if(!mn){w({title:"Error",description:"Store data for finalization is missing.",variant:"destructive"}),yt(!1),o(!1);return}o(!0),d("Finalizing store creation..."),c(95);const pe={...mn,products:xe};try{const we=await ge(pe);if(we)c(100),d("Store generation complete!"),w({title:"Store Created!",description:`Store "${we.name}" has been created.`}),_(`/${we.urlSlug||pc(we.name)}`);else throw new Error("Store creation returned no result after finalization.")}catch(we){console.error("Error during final store creation after product finalization:",we),w({title:"Finalization Failed",description:we.message||"Failed to create store after finalization.",variant:"destructive"}),c(0),d("Finalization failed.")}finally{yt(!1),en([]),cn(null),o(!1)}}};return a.jsxs(k7.Provider,{value:Pa,children:[t,a.jsx(hEe,{isOpen:Et,onClose:Pa.closeDesignEditModal,designs:De,onContinue:te}),a.jsx(R_e,{isOpen:He,onClose:Pa.closeProductFinalizationModal,products:kt,onFinalize:Pa.handleFinalizeProducts})]})},lm=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),mEe=({product:t,storeId:e,onContentCreated:n})=>{var ee,ae;const{toast:r}=as(),{storeName:s}=I0(),i=Ca(),o=(ee=i.state)==null?void 0:ee.product,l=(ae=i.state)==null?void 0:ae.storeData,c=t||o,{getStoreById:u,getStoreByName:d}=$n(),[h,f]=p.useState("text-to-image"),[m,g]=p.useState(""),[x,v]=p.useState(""),[w,_]=p.useState(!1),[C,T]=p.useState(!1),[j,A]=p.useState(null),[E,I]=p.useState([]),[N,k]=p.useState(!1),[R,D]=p.useState(""),[M,z]=p.useState(null),[B,G]=p.useState(!1),[Y,H]=p.useState(null),[K,$]=p.useState([]),[V,W]=p.useState(""),[F,Z]=p.useState(!1),[ce,le]=p.useState(null),[he,Le]=p.useState(!1),[Ve,Be]=p.useState([]),[ue,Ce]=p.useState(!1),[Ie,ve]=p.useState(!1),[ie,Me]=p.useState(null),He=async()=>{var X,Pe;if(!(!ie||!ie.url))try{const Ae=document.createElement("a");let $e="download";if(ie.url.startsWith("data:")){const qe=ie.url.match(/:(.*?);/),_e=(qe?qe[1]:"application/octet-stream").split("/")[1]||"bin";$e=`${((X=ie.caption)==null?void 0:X.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${_e}`,Ae.href=ie.url}else{const oe=await(await fetch(ie.url)).blob();Ae.href=URL.createObjectURL(oe);const _e=ie.url.substring(ie.url.lastIndexOf("/")+1).split("?")[0],ze=_e.includes(".")?_e.substring(_e.lastIndexOf(".")+1):"",Te=ie.type==="video"?"mp4":"png";$e=_e||`${((Pe=ie.caption)==null?void 0:Pe.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${ze||Te}`}Ae.download=$e,document.body.appendChild(Ae),Ae.click(),document.body.removeChild(Ae),ie.url.startsWith("data:")||URL.revokeObjectURL(Ae.href),r({title:"Download Started",description:`Downloading ${$e}`})}catch(Ae){console.error("Error downloading media:",Ae),r({title:"Download Failed",description:Ae.message,variant:"destructive"})}};p.useEffect(()=>{let X=l;if(X||(s?X=d(s):e?X=u(e):c&&c.store_id&&(X=u(c.store_id))),X&&X.products){Ce(!0);const Pe=X.products.map(Ae=>{var $e,qe,oe;return{id:Ae.id,name:Ae.name,image:{src:{medium:((qe=($e=Ae.image)==null?void 0:$e.src)==null?void 0:qe.medium)||`https://via.placeholder.com/100x100.png?text=${encodeURIComponent(((oe=Ae.name)==null?void 0:oe.substring(0,10))||"P")}`}}}});Be(Pe),Ce(!1)}else console.warn("[ContentCreationPage] No current store products found. Falling back to sample product catalog."),Be([{id:"sample_prod_1",name:"Sample Product Alpha",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Alpha"}}},{id:"sample_prod_2",name:"Sample Product Beta",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Beta"}}},{id:"sample_prod_3",name:"Sample Product Gamma",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Gamma"}}}]),Ce(!1);c&&c.name&&(g(`A captivating image of ${c.name}`),(async()=>{k(!0);try{const Ae={name:c.name,description:c.description||"",niche:(X==null?void 0:X.type)||c.niche||"",storeName:(X==null?void 0:X.name)||c.storeName||""},$e=await Tse(Ae);$e.suggestions&&$e.suggestions.length>0?I($e.suggestions):$e.error&&console.warn("Could not fetch prompt suggestions:",$e.error)}catch(Ae){console.error("Error fetching prompt suggestions:",Ae)}finally{k(!1)}})())},[c,l,s,e,u,d]);const yt=async()=>{if(!m.trim()){r({title:"Error",description:"Please enter a prompt for image generation",variant:"destructive"});return}_(!0),A(null),W("");try{const X=await j0(m);let Pe=X.alt?[X.alt]:[`Image for: ${m.substring(0,30)}`];if(X.url)try{const{base64ImageData:Ae,mimeType:$e}=await lm(X.url);Pe=await sa(Ae,$e,`Image of ${m}`)}catch(Ae){console.error("Error generating caption for Gemini image:",Ae),Pe=[`Failed to generate caption for: ${m.substring(0,30)}`]}A({url:X.url,captions:Pe,sourceApi:"gemini"}),Pe&&Pe.length>0&&W(Pe[0])}catch(X){console.error("Error generating image with Gemini:",X),r({title:"Image Generation Failed",description:X.message,variant:"destructive"})}finally{_(!1)}},kt=async()=>{if(!x.trim()){r({title:"Error",description:"Please enter a prompt for OpenAI image generation",variant:"destructive"});return}T(!0),A(null),W("");try{const X=await ZB(x),Pe=`data:image/png;base64,${X.b64_json}`;let Ae=X.alt?[X.alt]:[`OpenAI image for: ${x.substring(0,30)}`];try{const{base64ImageData:$e,mimeType:qe}=await lm(Pe);Ae=await sa($e,qe,`OpenAI-generated image of ${x}`)}catch($e){console.error("Error generating caption for OpenAI image:",$e),Ae=[`Failed to generate caption for: ${x.substring(0,30)}`]}A({url:Pe,captions:Ae,sourceApi:"openai"}),Ae&&Ae.length>0&&W(Ae[0]),r({title:"Image Generated (OpenAI)",description:"Image successfully generated using OpenAI."})}catch(X){console.error("Error generating image with OpenAI:",X),r({title:"OpenAI Image Generation Failed",description:X.message,variant:"destructive"})}finally{T(!1)}},en=async(X,Pe)=>{if(!X||!X.url){r({title:"Error",description:"No image selected to edit with Gemini.",variant:"destructive"});return}if(!Pe.trim()){r({title:"Error",description:"Please enter an edit prompt for Gemini.",variant:"destructive"});return}G(!0),H(null),W("");try{const{base64ImageData:Ae,mimeType:$e}=await lm(X.url),qe=await $o(Ae,$e,Pe);if(qe&&qe.editedImageData){const oe=`data:${qe.newMimeType};base64,${qe.editedImageData}`;let _e=qe.editTextResponse?[qe.editTextResponse]:[`Edited with Gemini: ${X.caption||X.id}`];try{_e=await sa(qe.editedImageData,qe.newMimeType,`Edited image based on: ${Pe}`)}catch(ze){console.error("Error generating caption for Gemini edited image:",ze)}H({url:oe,captions:_e,sourceApi:"gemini"}),_e&&_e.length>0&&W(_e[0]),r({title:"Image Edited (Gemini)",description:"Image successfully edited with Gemini."})}else throw new Error("Gemini image edit did not return image data.")}catch(Ae){console.error("Error editing image with Gemini:",Ae),r({title:"Gemini Edit Failed",description:Ae.message,variant:"destructive"})}finally{G(!1)}},mn=async X=>{const Pe=X.target.files[0];if(Pe){Le(!0),le(null),W("");try{const Ae=new FileReader;Ae.onload=async $e=>{const qe=$e.target.result,oe=Pe.type.startsWith("video/")?"video":"image";let _e=[Pe.name];if(oe==="image")try{const{base64ImageData:ze,mimeType:Te}=await lm(qe);_e=await sa(ze,Te,"Uploaded image caption")}catch(ze){console.error("Error generating caption for uploaded image:",ze)}else _e=[`Uploaded video: ${Pe.name}`];le({url:qe,captions:_e,type:oe}),_e&&_e.length>0&&W(_e[0]),Le(!1)},Ae.onerror=()=>{r({title:"Upload Failed",description:"Failed to read the selected file",variant:"destructive"}),Le(!1)},Ae.readAsDataURL(Pe)}catch(Ae){console.error("Error processing uploaded file:",Ae),r({title:"Upload Failed",description:Ae.message,variant:"destructive"}),Le(!1)}}},cn=(X,Pe,Ae="image")=>{if(!X){r({title:"Cannot Add",description:"Item URL is missing.",variant:"destructive"});return}const $e={id:Ft(),type:Ae,url:X,caption:Pe||`Item ${K.length+1}`,isVideo:Ae==="video"};$(qe=>[...qe,$e]),r({title:"Added to Timeline",description:`${Ae==="video"?"Video":"Image"} added to your content timeline.`}),A(null),H(null),le(null),z(null),W("")},fn=(X,Pe)=>{const Ae=[...K],$e=Ae[X],qe=X+Pe;qe<0||qe>=Ae.length||(Ae.splice(X,1),Ae.splice(qe,0,$e),$(Ae))},Ue=X=>{$(Pe=>Pe.filter(Ae=>Ae.id!==X)),r({title:"Removed from Timeline",description:"Item removed."})},Et=async(X,Pe)=>{if(X.isVideo){r({title:"Already a Video",description:"This item is already a video."});return}Z(!0);try{const{base64ImageData:Ae,mimeType:$e}=await lm(X.url),qe=X.caption||`Create a short video from this image: ${c?c.name:"product showcase"}`,oe=await KI(qe,Ae,$e),_e=[...K];_e[Pe]={...X,url:oe,isVideo:!0,type:"video",caption:X.caption+" (Veo Video)"},$(_e),r({title:"Veo Video Generated",description:"Image converted to video using Veo."})}catch(Ae){console.error("Error converting to Veo video:",Ae),r({title:"Veo Conversion Failed",description:Ae.message,variant:"destructive"})}finally{Z(!1)}},de=X=>{const Pe=K.find($e=>$e.id===X);if(!Pe)return;const Ae=prompt("Edit caption:",Pe.caption);Ae!==null&&Ae.trim()!==Pe.caption&&($($e=>$e.map(qe=>qe.id===X?{...qe,caption:Ae.trim()}:qe)),r({title:"Caption Updated"}))},De=X=>{if(X.image&&X.image.src&&X.image.src.medium){const Pe=`Product: ${X.name}`;cn(X.image.src.medium,Pe,"image")}else r({title:"No Image",description:`Product ${X.name} has no image.`,variant:"destructive"});ve(!1)};return a.jsxs("div",{className:"container mx-auto p-4 md:p-6 lg:p-8 space-y-8 bg-background",children:[" ",a.jsxs("header",{className:"relative text-center pb-4",children:[a.jsx(zn,{to:"/",className:"absolute left-0 top-0",children:a.jsxs(O,{variant:"outline",size:"icon",children:[a.jsx(Wi,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Back to Home"})]})}),a.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight",children:"AI Content Creation Studio"}),a.jsx("p",{className:"text-muted-foreground mt-2 text-lg",children:"Generate images, edit them, create videos, and build your content sequence."})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 xl:gap-8",children:[a.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[a.jsxs(_i,{value:h,onValueChange:f,className:"w-full",children:[a.jsxs(ni,{className:"grid w-full grid-cols-3",children:[a.jsxs(Vt,{value:"text-to-image",children:[a.jsx(fa,{className:"mr-1 h-4 w-4 inline-block"}),"Gen Image"]}),a.jsxs(Vt,{value:"image-edit",children:[a.jsx(tw,{className:"mr-1 h-4 w-4 inline-block"}),"Edit Image"]}),a.jsxs(Vt,{value:"upload",children:[a.jsx($3,{className:"mr-1 h-4 w-4 inline-block"}),"Upload"]})]}),a.jsxs(Ut,{value:"text-to-image",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(je,{htmlFor:"text-prompt-model1",className:"text-lg font-semibold",children:"Text-to-Image (Quick)"}),a.jsx(En,{id:"text-prompt-model1",placeholder:"e.g., 'A futuristic cityscape at sunset'",value:m,onChange:X=>g(X.target.value),rows:3,className:"mt-2",disabled:w||C}),N&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Loading prompt suggestions..."}),E.length>0&&!N&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx(je,{className:"text-xs text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:E.map((X,Pe)=>a.jsx(O,{variant:"outline",size:"xs",onClick:()=>g(X),className:"text-xs",children:X.length>40?X.substring(0,37)+"...":X},Pe))})]}),a.jsxs(O,{onClick:yt,disabled:w||C||!m.trim(),className:"w-full mt-3",children:[w?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(fa,{className:"mr-2 h-4 w-4"}),"Generate with Quick"]}),a.jsx(Ys,{className:"my-4"}),a.jsx(je,{htmlFor:"text-prompt-model2",className:"text-lg font-semibold",children:"Text-to-Image (Quality)"}),a.jsx(En,{id:"text-prompt-model2",placeholder:"e.g., 'A photorealistic cat astronaut'",value:x,onChange:X=>v(X.target.value),rows:3,className:"mt-2",disabled:w||C}),a.jsxs(O,{onClick:kt,disabled:w||C||!x.trim(),className:"w-full mt-3",children:[C?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(A3,{className:"mr-2 h-4 w-4"}),"Generate with Quality"]}),j&&j.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:j.url,alt:`Generated by ${j.sourceApi==="gemini"?"Quick":j.sourceApi==="openai"?"Quality":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",j.sourceApi==="gemini"?"Quick":j.sourceApi==="openai"?"Quality":"AI"]}),a.jsx(je,{className:"text-sm font-medium",children:"Choose a caption:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(j.captions||[]).map((X,Pe)=>a.jsx(O,{variant:V===X?"default":"outline",size:"sm",onClick:()=>W(X),className:"text-xs",children:X},Pe))}),a.jsxs(O,{onClick:()=>cn(j.url,V),size:"sm",className:"w-full mt-2",disabled:!V,children:[a.jsx(Eu,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]}),a.jsxs(Ut,{value:"image-edit",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(je,{className:"text-lg font-semibold",children:"Image Editing"}),!M&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select an image from the timeline to enable editing."}),M&&a.jsxs("div",{className:"mt-2 space-y-3",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Editing: ",a.jsx("span",{className:"text-primary truncate",children:M.caption})]}),a.jsx("img",{src:M.url,alt:"Selected for editing",className:"w-full rounded-md object-contain max-h-48 border"}),a.jsx(je,{htmlFor:"edit-prompt-model1",children:"Edit with Quick"}),a.jsx(En,{id:"edit-prompt-model1",placeholder:"Describe edits (e.g., 'change background to a beach')",value:R,onChange:X=>D(X.target.value),rows:2,disabled:B}),a.jsxs(O,{onClick:()=>en(M,R),disabled:B||!R.trim(),className:"w-full",children:[B?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(fa,{className:"mr-2 h-4 w-4"}),"Edit with Quick"]})]}),Y&&Y.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:Y.url,alt:`Edited by ${Y.sourceApi==="gemini"?"Quick":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",Y.sourceApi==="gemini"?"Quick":"AI"]}),a.jsx(je,{className:"text-sm font-medium",children:"Choose a caption for the edited image:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(Y.captions||[]).map((X,Pe)=>a.jsx(O,{variant:V===X?"default":"outline",size:"sm",onClick:()=>W(X),className:"text-xs",children:X},Pe))}),a.jsxs(O,{onClick:()=>cn(Y.url,V),size:"sm",className:"w-full mt-2",disabled:!V,children:[a.jsx(Eu,{className:"mr-2 h-4 w-4"})," Add Edited to Timeline"]})]})]}),a.jsxs(Ut,{value:"upload",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(je,{htmlFor:"file-upload",className:"text-lg font-semibold",children:"Upload Image or Video"}),a.jsx(Je,{id:"file-upload",type:"file",accept:"image/*,video/*",onChange:mn,className:"mt-2",disabled:he}),he&&a.jsxs("div",{className:"mt-2 flex items-center text-sm text-muted-foreground",children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"})," Processing..."]}),ce&&ce.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[ce.type==="image"?a.jsx("img",{src:ce.url,alt:"Uploaded content",className:"w-full rounded-md object-contain max-h-96"}):a.jsx("video",{src:ce.url,controls:!0,className:"w-full rounded-md max-h-96",children:"Your browser does not support the video tag."}),a.jsx(je,{className:"text-sm font-medium",children:"Choose a caption for the uploaded content:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(ce.captions||[]).map((X,Pe)=>a.jsx(O,{variant:V===X?"default":"outline",size:"sm",onClick:()=>W(X),className:"text-xs",children:X},Pe))}),a.jsxs(O,{onClick:()=>cn(ce.url,V,ce.type),size:"sm",className:"w-full mt-2",disabled:!V,children:[a.jsx(Eu,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Product Catalog"}),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>ve(!Ie),children:[Ie?"Hide":"Show"," Products ",a.jsx(Die,{className:"ml-2 h-4 w-4"})]})]}),Ie&&a.jsx(Fs,{className:"mt-2 h-48 border rounded-md p-2",children:a.jsx("div",{className:"space-y-2",children:Ve.map(X=>{var Pe,Ae;return a.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md hover:bg-muted cursor-pointer",onClick:()=>De(X),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:(Ae=(Pe=X.image)==null?void 0:Pe.src)==null?void 0:Ae.medium,alt:X.name,className:"w-10 h-10 object-cover rounded"}),a.jsx("span",{className:"text-sm",children:X.name})]}),a.jsx(O,{size:"xs",variant:"ghost",children:a.jsx(Eu,{className:"h-4 w-4"})})]},X.id)})})})]})]}),a.jsx("div",{className:"lg:col-span-2 space-y-6",children:a.jsxs("div",{className:"p-4 md:p-6 border rounded-lg bg-card shadow min-h-[400px]",children:[a.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Content Timeline"}),a.jsx(Fs,{className:"h-[calc(100vh-350px)] min-h-[300px] pr-3",children:K.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[a.jsx(N3,{className:"h-12 w-12 mb-3"}),a.jsx("p",{children:"Your timeline is empty."}),a.jsx("p",{className:"text-sm",children:"Generate or upload content to get started."})]}):a.jsx(Sc,{children:K.map((X,Pe)=>a.jsxs(It.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-50},transition:{type:"spring",stiffness:300,damping:30},className:"mb-3 p-3 border rounded-md flex items-start gap-3 hover:shadow-md transition-shadow bg-background cursor-pointer",onClick:()=>Me(X),children:[a.jsxs("div",{className:"w-24 h-24 flex-shrink-0 relative rounded overflow-hidden group bg-muted",children:[X.isVideo?a.jsx("video",{src:X.url,className:"w-full h-full object-cover",controls:!1,muted:!0,loop:!0,onMouseOver:Ae=>Ae.target.play(),onMouseOut:Ae=>Ae.target.pause()}):a.jsx("img",{src:X.url,alt:X.caption,className:"w-full h-full object-cover"}),!X.isVideo&&a.jsx(O,{size:"icon",variant:"secondary",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Ae=>{Ae.stopPropagation(),Et(X,Pe)},disabled:F,title:"Convert to Veo Video",children:F?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(jI,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"outline",className:"absolute bottom-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Ae=>{Ae.stopPropagation(),z(X),f("image-edit")},disabled:X.isVideo,title:"Edit this image",children:a.jsx(tw,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:`text-xs font-semibold px-1.5 py-0.5 rounded-sm ${X.isVideo?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:[X.isVideo?"Video":"Image"," ",Pe+1]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(O,{size:"icon",variant:"ghost",onClick:Ae=>{Ae.stopPropagation(),fn(Pe,-1)},disabled:Pe===0,className:"h-7 w-7",children:a.jsx(D3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ae=>{Ae.stopPropagation(),fn(Pe,1)},disabled:Pe===K.length-1,className:"h-7 w-7",children:a.jsx(R3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ae=>{Ae.stopPropagation(),de(X.id)},className:"h-7 w-7",children:a.jsx(M3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ae=>{Ae.stopPropagation(),Ue(X.id)},className:"h-7 w-7 text-destructive",children:a.jsx(Fn,{className:"h-4 w-4"})})]})]}),a.jsx("p",{className:"text-sm mt-1 text-muted-foreground line-clamp-3",title:X.caption,children:X.caption})]})]},X.id))})}),K.length>0&&a.jsx(Ys,{className:"my-4"}),ie&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Media Viewer"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(O,{variant:"outline",size:"sm",onClick:He,children:[a.jsx(kI,{className:"mr-2 h-4 w-4"}),"Download"]}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>Me(null),children:a.jsx(Hi,{className:"h-5 w-5"})})]})]}),ie.type==="image"||!ie.isVideo?a.jsx("img",{src:ie.url,alt:ie.caption||"Viewing media",className:"w-full max-h-[60vh] rounded-md object-contain border"}):a.jsx("video",{src:ie.url,controls:!0,className:"w-full max-h-[60vh] rounded-md border bg-black",children:"Your browser does not support the video tag."}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:ie.caption})]})]})})]})]})};function j7(t){const e=p.useRef({value:t,previous:t});return p.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}function kA(t){const[e,n]=p.useState(void 0);return xa(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var t_="Switch",[pEe,GRe]=bi(t_),[gEe,yEe]=pEe(t_),R7=p.forwardRef((t,e)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:u,form:d,...h}=t,[f,m]=p.useState(null),g=yn(e,C=>m(C)),x=p.useRef(!1),v=f?d||!!f.closest("form"):!0,[w,_]=Oc({prop:s,defaultProp:i??!1,onChange:u,caller:t_});return a.jsxs(gEe,{scope:n,checked:w,disabled:l,children:[a.jsx(Yt.button,{type:"button",role:"switch","aria-checked":w,"aria-required":o,"data-state":F7(w),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:g,onClick:gt(t.onClick,C=>{_(T=>!T),v&&(x.current=C.isPropagationStopped(),x.current||C.stopPropagation())})}),v&&a.jsx(L7,{control:f,bubbles:!x.current,name:r,value:c,checked:w,required:o,disabled:l,form:d,style:{transform:"translateX(-100%)"}})]})});R7.displayName=t_;var D7="SwitchThumb",M7=p.forwardRef((t,e)=>{const{__scopeSwitch:n,...r}=t,s=yEe(D7,n);return a.jsx(Yt.span,{"data-state":F7(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:e})});M7.displayName=D7;var xEe="SwitchBubbleInput",L7=p.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:r=!0,...s},i)=>{const o=p.useRef(null),l=yn(o,i),c=j7(n),u=kA(e);return p.useEffect(()=>{const d=o.current;if(!d)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(c!==n&&m){const g=new Event("click",{bubbles:r});m.call(d,n),d.dispatchEvent(g)}},[c,n,r]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:l,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});L7.displayName=xEe;function F7(t){return t?"checked":"unchecked"}var O7=R7,vEe=M7;const Ro=ht.forwardRef(({className:t,...e},n)=>a.jsx(O7,{className:bt("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...e,ref:n,children:a.jsx(vEe,{className:bt("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Ro.displayName=O7.displayName;var wEe="Arrow",$7=p.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return a.jsx(Yt.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});$7.displayName=wEe;var bEe=$7,jA="Popper",[V7,n_]=bi(jA),[_Ee,U7]=V7(jA),B7=t=>{const{__scopePopper:e,children:n}=t,[r,s]=p.useState(null);return a.jsx(_Ee,{scope:e,anchor:r,onAnchorChange:s,children:n})};B7.displayName=jA;var z7="PopperAnchor",G7=p.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=U7(z7,n),o=p.useRef(null),l=yn(e,o);return p.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:a.jsx(Yt.div,{...s,ref:l})});G7.displayName=z7;var RA="PopperContent",[SEe,CEe]=V7(RA),W7=p.forwardRef((t,e)=>{var he,Le,Ve,Be,ue,Ce;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:m="optimized",onPlaced:g,...x}=t,v=U7(RA,n),[w,_]=p.useState(null),C=yn(e,Ie=>_(Ie)),[T,j]=p.useState(null),A=kA(T),E=(A==null?void 0:A.width)??0,I=(A==null?void 0:A.height)??0,N=r+(i!=="center"?"-"+i:""),k=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},R=Array.isArray(u)?u:[u],D=R.length>0,M={padding:k,boundary:R.filter(TEe),altBoundary:D},{refs:z,floatingStyles:B,placement:G,isPositioned:Y,middlewareData:H}=QG({strategy:"fixed",placement:N,whileElementsMounted:(...Ie)=>YG(...Ie,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[XG({mainAxis:s+I,alignmentAxis:o}),c&&ZG({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?e7():void 0,...M}),c&&t7({...M}),n7({...M,apply:({elements:Ie,rects:ve,availableWidth:ie,availableHeight:Me})=>{const{width:He,height:yt}=ve.reference,kt=Ie.floating.style;kt.setProperty("--radix-popper-available-width",`${ie}px`),kt.setProperty("--radix-popper-available-height",`${Me}px`),kt.setProperty("--radix-popper-anchor-width",`${He}px`),kt.setProperty("--radix-popper-anchor-height",`${yt}px`)}}),T&&s7({element:T,padding:l}),IEe({arrowWidth:E,arrowHeight:I}),f&&r7({strategy:"referenceHidden",...M})]}),[K,$]=K7(G),V=$r(g);xa(()=>{Y&&(V==null||V())},[Y,V]);const W=(he=H.arrow)==null?void 0:he.x,F=(Le=H.arrow)==null?void 0:Le.y,Z=((Ve=H.arrow)==null?void 0:Ve.centerOffset)!==0,[ce,le]=p.useState();return xa(()=>{w&&le(window.getComputedStyle(w).zIndex)},[w]),a.jsx("div",{ref:z.setFloating,"data-radix-popper-content-wrapper":"",style:{...B,transform:Y?B.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[(Be=H.transformOrigin)==null?void 0:Be.x,(ue=H.transformOrigin)==null?void 0:ue.y].join(" "),...((Ce=H.hide)==null?void 0:Ce.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:a.jsx(SEe,{scope:n,placedSide:K,onArrowChange:j,arrowX:W,arrowY:F,shouldHideArrow:Z,children:a.jsx(Yt.div,{"data-side":K,"data-align":$,...x,ref:C,style:{...x.style,animation:Y?void 0:"none"}})})})});W7.displayName=RA;var H7="PopperArrow",EEe={top:"bottom",right:"left",bottom:"top",left:"right"},q7=p.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=CEe(H7,r),o=EEe[i.placedSide];return a.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:a.jsx(bEe,{...s,ref:n,style:{...s.style,display:"block"}})})});q7.displayName=H7;function TEe(t){return t!==null}var IEe=t=>({name:"transformOrigin",options:t,fn(e){var v,w,_;const{placement:n,rects:r,middlewareData:s}=e,o=((v=s.arrow)==null?void 0:v.centerOffset)!==0,l=o?0:t.arrowWidth,c=o?0:t.arrowHeight,[u,d]=K7(n),h={start:"0%",center:"50%",end:"100%"}[d],f=(((w=s.arrow)==null?void 0:w.x)??0)+l/2,m=(((_=s.arrow)==null?void 0:_.y)??0)+c/2;let g="",x="";return u==="bottom"?(g=o?h:`${f}px`,x=`${-c}px`):u==="top"?(g=o?h:`${f}px`,x=`${r.floating.height+c}px`):u==="right"?(g=`${-c}px`,x=o?h:`${m}px`):u==="left"&&(g=`${r.floating.width+c}px`,x=o?h:`${m}px`),{data:{x:g,y:x}}}});function K7(t){const[e,n="center"]=t.split("-");return[e,n]}var Y7=B7,DA=G7,J7=W7,Q7=q7,t1=["Enter"," "],NEe=["ArrowDown","PageUp","Home"],X7=["ArrowUp","PageDown","End"],PEe=[...NEe,...X7],AEe={ltr:[...t1,"ArrowRight"],rtl:[...t1,"ArrowLeft"]},kEe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},oy="Menu",[dg,jEe,REe]=_I(oy),[xd,Z7]=bi(oy,[REe,n_,B0]),r_=n_(),eW=B0(),[DEe,vd]=xd(oy),[MEe,ay]=xd(oy),tW=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:s,onOpenChange:i,modal:o=!0}=t,l=r_(e),[c,u]=p.useState(null),d=p.useRef(!1),h=$r(i),f=U0(s);return p.useEffect(()=>{const m=()=>{d.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>d.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),a.jsx(Y7,{...l,children:a.jsx(DEe,{scope:e,open:n,onOpenChange:h,content:c,onContentChange:u,children:a.jsx(MEe,{scope:e,onClose:p.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:f,modal:o,children:r})})})};tW.displayName=oy;var LEe="MenuAnchor",MA=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=r_(n);return a.jsx(DA,{...s,...r,ref:e})});MA.displayName=LEe;var LA="MenuPortal",[FEe,nW]=xd(LA,{forceMount:void 0}),rW=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:s}=t,i=vd(LA,e);return a.jsx(FEe,{scope:e,forceMount:n,children:a.jsx(vs,{present:n||i.open,children:a.jsx(_g,{asChild:!0,container:s,children:r})})})};rW.displayName=LA;var fo="MenuContent",[OEe,FA]=xd(fo),sW=p.forwardRef((t,e)=>{const n=nW(fo,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=vd(fo,t.__scopeMenu),o=ay(fo,t.__scopeMenu);return a.jsx(dg.Provider,{scope:t.__scopeMenu,children:a.jsx(vs,{present:r||i.open,children:a.jsx(dg.Slot,{scope:t.__scopeMenu,children:o.modal?a.jsx($Ee,{...s,ref:e}):a.jsx(VEe,{...s,ref:e})})})})}),$Ee=p.forwardRef((t,e)=>{const n=vd(fo,t.__scopeMenu),r=p.useRef(null),s=yn(e,r);return p.useEffect(()=>{const i=r.current;if(i)return O0(i)},[]),a.jsx(OA,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:gt(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),VEe=p.forwardRef((t,e)=>{const n=vd(fo,t.__scopeMenu);return a.jsx(OA,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),UEe=Wu("MenuContent.ScrollLock"),OA=p.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,disableOutsideScroll:g,...x}=t,v=vd(fo,n),w=ay(fo,n),_=r_(n),C=eW(n),T=jEe(n),[j,A]=p.useState(null),E=p.useRef(null),I=yn(e,E,v.onContentChange),N=p.useRef(0),k=p.useRef(""),R=p.useRef(0),D=p.useRef(null),M=p.useRef("right"),z=p.useRef(0),B=g?LI:p.Fragment,G=g?{as:UEe,allowPinchZoom:!0}:void 0,Y=K=>{var he,Le;const $=k.current+K,V=T().filter(Ve=>!Ve.disabled),W=document.activeElement,F=(he=V.find(Ve=>Ve.ref.current===W))==null?void 0:he.textValue,Z=V.map(Ve=>Ve.textValue),ce=ZEe(Z,$,F),le=(Le=V.find(Ve=>Ve.textValue===ce))==null?void 0:Le.ref.current;(function Ve(Be){k.current=Be,window.clearTimeout(N.current),Be!==""&&(N.current=window.setTimeout(()=>Ve(""),1e3))})($),le&&setTimeout(()=>le.focus())};p.useEffect(()=>()=>window.clearTimeout(N.current),[]),DI();const H=p.useCallback(K=>{var V,W;return M.current===((V=D.current)==null?void 0:V.side)&&tTe(K,(W=D.current)==null?void 0:W.area)},[]);return a.jsx(OEe,{scope:n,searchRef:k,onItemEnter:p.useCallback(K=>{H(K)&&K.preventDefault()},[H]),onItemLeave:p.useCallback(K=>{var $;H(K)||(($=E.current)==null||$.focus(),A(null))},[H]),onTriggerLeave:p.useCallback(K=>{H(K)&&K.preventDefault()},[H]),pointerGraceTimerRef:R,onPointerGraceIntentChange:p.useCallback(K=>{D.current=K},[]),children:a.jsx(B,{...G,children:a.jsx(L0,{asChild:!0,trapped:s,onMountAutoFocus:gt(i,K=>{var $;K.preventDefault(),($=E.current)==null||$.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:a.jsx(bg,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,children:a.jsx(jU,{asChild:!0,...C,dir:w.dir,orientation:"vertical",loop:r,currentTabStopId:j,onCurrentTabStopIdChange:A,onEntryFocus:gt(c,K=>{w.isUsingKeyboardRef.current||K.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(J7,{role:"menu","aria-orientation":"vertical","data-state":wW(v.open),"data-radix-menu-content":"",dir:w.dir,..._,...x,ref:I,style:{outline:"none",...x.style},onKeyDown:gt(x.onKeyDown,K=>{const V=K.target.closest("[data-radix-menu-content]")===K.currentTarget,W=K.ctrlKey||K.altKey||K.metaKey,F=K.key.length===1;V&&(K.key==="Tab"&&K.preventDefault(),!W&&F&&Y(K.key));const Z=E.current;if(K.target!==Z||!PEe.includes(K.key))return;K.preventDefault();const le=T().filter(he=>!he.disabled).map(he=>he.ref.current);X7.includes(K.key)&&le.reverse(),QEe(le)}),onBlur:gt(t.onBlur,K=>{K.currentTarget.contains(K.target)||(window.clearTimeout(N.current),k.current="")}),onPointerMove:gt(t.onPointerMove,hg(K=>{const $=K.target,V=z.current!==K.clientX;if(K.currentTarget.contains($)&&V){const W=K.clientX>z.current?"right":"left";M.current=W,z.current=K.clientX}}))})})})})})})});sW.displayName=fo;var BEe="MenuGroup",$A=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Yt.div,{role:"group",...r,ref:e})});$A.displayName=BEe;var zEe="MenuLabel",iW=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Yt.div,{...r,ref:e})});iW.displayName=zEe;var e0="MenuItem",YL="menu.itemSelect",s_=p.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...s}=t,i=p.useRef(null),o=ay(e0,t.__scopeMenu),l=FA(e0,t.__scopeMenu),c=yn(e,i),u=p.useRef(!1),d=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent(YL,{bubbles:!0,cancelable:!0});h.addEventListener(YL,m=>r==null?void 0:r(m),{once:!0}),SI(h,f),f.defaultPrevented?u.current=!1:o.onClose()}};return a.jsx(oW,{...s,ref:c,disabled:n,onClick:gt(t.onClick,d),onPointerDown:h=>{var f;(f=t.onPointerDown)==null||f.call(t,h),u.current=!0},onPointerUp:gt(t.onPointerUp,h=>{var f;u.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:gt(t.onKeyDown,h=>{const f=l.searchRef.current!=="";n||f&&h.key===" "||t1.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});s_.displayName=e0;var oW=p.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=t,o=FA(e0,n),l=eW(n),c=p.useRef(null),u=yn(e,c),[d,h]=p.useState(!1),[f,m]=p.useState("");return p.useEffect(()=>{const g=c.current;g&&m((g.textContent??"").trim())},[i.children]),a.jsx(dg.ItemSlot,{scope:n,disabled:r,textValue:s??f,children:a.jsx(RU,{asChild:!0,...l,focusable:!r,children:a.jsx(Yt.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:u,onPointerMove:gt(t.onPointerMove,hg(g=>{r?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:gt(t.onPointerLeave,hg(g=>o.onItemLeave(g))),onFocus:gt(t.onFocus,()=>h(!0)),onBlur:gt(t.onBlur,()=>h(!1))})})})}),GEe="MenuCheckboxItem",aW=p.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...s}=t;return a.jsx(hW,{scope:t.__scopeMenu,checked:n,children:a.jsx(s_,{role:"menuitemcheckbox","aria-checked":t0(n)?"mixed":n,...s,ref:e,"data-state":UA(n),onSelect:gt(s.onSelect,()=>r==null?void 0:r(t0(n)?!0:!n),{checkForDefaultPrevented:!1})})})});aW.displayName=GEe;var lW="MenuRadioGroup",[WEe,HEe]=xd(lW,{value:void 0,onValueChange:()=>{}}),cW=p.forwardRef((t,e)=>{const{value:n,onValueChange:r,...s}=t,i=$r(r);return a.jsx(WEe,{scope:t.__scopeMenu,value:n,onValueChange:i,children:a.jsx($A,{...s,ref:e})})});cW.displayName=lW;var uW="MenuRadioItem",dW=p.forwardRef((t,e)=>{const{value:n,...r}=t,s=HEe(uW,t.__scopeMenu),i=n===s.value;return a.jsx(hW,{scope:t.__scopeMenu,checked:i,children:a.jsx(s_,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":UA(i),onSelect:gt(r.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,n)},{checkForDefaultPrevented:!1})})})});dW.displayName=uW;var VA="MenuItemIndicator",[hW,qEe]=xd(VA,{checked:!1}),fW=p.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...s}=t,i=qEe(VA,n);return a.jsx(vs,{present:r||t0(i.checked)||i.checked===!0,children:a.jsx(Yt.span,{...s,ref:e,"data-state":UA(i.checked)})})});fW.displayName=VA;var KEe="MenuSeparator",mW=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Yt.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});mW.displayName=KEe;var YEe="MenuArrow",pW=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=r_(n);return a.jsx(Q7,{...s,...r,ref:e})});pW.displayName=YEe;var JEe="MenuSub",[WRe,gW]=xd(JEe),Rm="MenuSubTrigger",yW=p.forwardRef((t,e)=>{const n=vd(Rm,t.__scopeMenu),r=ay(Rm,t.__scopeMenu),s=gW(Rm,t.__scopeMenu),i=FA(Rm,t.__scopeMenu),o=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,u={__scopeMenu:t.__scopeMenu},d=p.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return p.useEffect(()=>d,[d]),p.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),a.jsx(MA,{asChild:!0,...u,children:a.jsx(oW,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":wW(n.open),...t,ref:R0(e,s.onTriggerChange),onClick:h=>{var f;(f=t.onClick)==null||f.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:gt(t.onPointerMove,hg(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:gt(t.onPointerLeave,hg(h=>{var m,g;d();const f=(m=n.content)==null?void 0:m.getBoundingClientRect();if(f){const x=(g=n.content)==null?void 0:g.dataset.side,v=x==="right",w=v?-5:5,_=f[v?"left":"right"],C=f[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+w,y:h.clientY},{x:_,y:f.top},{x:C,y:f.top},{x:C,y:f.bottom},{x:_,y:f.bottom}],side:x}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:gt(t.onKeyDown,h=>{var m;const f=i.searchRef.current!=="";t.disabled||f&&h.key===" "||AEe[r.dir].includes(h.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),h.preventDefault())})})})});yW.displayName=Rm;var xW="MenuSubContent",vW=p.forwardRef((t,e)=>{const n=nW(fo,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=vd(fo,t.__scopeMenu),o=ay(fo,t.__scopeMenu),l=gW(xW,t.__scopeMenu),c=p.useRef(null),u=yn(e,c);return a.jsx(dg.Provider,{scope:t.__scopeMenu,children:a.jsx(vs,{present:r||i.open,children:a.jsx(dg.Slot,{scope:t.__scopeMenu,children:a.jsx(OA,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;o.isUsingKeyboardRef.current&&((h=c.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:gt(t.onFocusOutside,d=>{d.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:gt(t.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:gt(t.onKeyDown,d=>{var m;const h=d.currentTarget.contains(d.target),f=kEe[o.dir].includes(d.key);h&&f&&(i.onOpenChange(!1),(m=l.trigger)==null||m.focus(),d.preventDefault())})})})})})});vW.displayName=xW;function wW(t){return t?"open":"closed"}function t0(t){return t==="indeterminate"}function UA(t){return t0(t)?"indeterminate":t?"checked":"unchecked"}function QEe(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function XEe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function ZEe(t,e,n){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=XEe(t,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function eTe(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const l=e[i],c=e[o],u=l.x,d=l.y,h=c.x,f=c.y;d>r!=f>r&&n<(h-u)*(r-d)/(f-d)+u&&(s=!s)}return s}function tTe(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return eTe(n,e)}function hg(t){return e=>e.pointerType==="mouse"?t(e):void 0}var nTe=tW,rTe=MA,sTe=rW,iTe=sW,oTe=$A,aTe=iW,lTe=s_,cTe=aW,uTe=cW,dTe=dW,hTe=fW,fTe=mW,mTe=pW,pTe=yW,gTe=vW,i_="DropdownMenu",[yTe,HRe]=bi(i_,[Z7]),ri=Z7(),[xTe,bW]=yTe(i_),_W=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:o,modal:l=!0}=t,c=ri(e),u=p.useRef(null),[d,h]=Oc({prop:s,defaultProp:i??!1,onChange:o,caller:i_});return a.jsx(xTe,{scope:e,triggerId:ic(),triggerRef:u,contentId:ic(),open:d,onOpenChange:h,onOpenToggle:p.useCallback(()=>h(f=>!f),[h]),modal:l,children:a.jsx(nTe,{...c,open:d,onOpenChange:h,dir:r,modal:l,children:n})})};_W.displayName=i_;var SW="DropdownMenuTrigger",CW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=t,i=bW(SW,n),o=ri(n);return a.jsx(rTe,{asChild:!0,...o,children:a.jsx(Yt.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:R0(e,i.triggerRef),onPointerDown:gt(t.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:gt(t.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});CW.displayName=SW;var vTe="DropdownMenuPortal",EW=t=>{const{__scopeDropdownMenu:e,...n}=t,r=ri(e);return a.jsx(sTe,{...r,...n})};EW.displayName=vTe;var TW="DropdownMenuContent",IW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=bW(TW,n),i=ri(n),o=p.useRef(!1);return a.jsx(iTe,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:e,onCloseAutoFocus:gt(t.onCloseAutoFocus,l=>{var c;o.current||(c=s.triggerRef.current)==null||c.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:gt(t.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,d=c.button===2||u;(!s.modal||d)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});IW.displayName=TW;var wTe="DropdownMenuGroup",bTe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ri(n);return a.jsx(oTe,{...s,...r,ref:e})});bTe.displayName=wTe;var _Te="DropdownMenuLabel",NW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ri(n);return a.jsx(aTe,{...s,...r,ref:e})});NW.displayName=_Te;var STe="DropdownMenuItem",PW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ri(n);return a.jsx(lTe,{...s,...r,ref:e})});PW.displayName=STe;var CTe="DropdownMenuCheckboxItem",AW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ri(n);return a.jsx(cTe,{...s,...r,ref:e})});AW.displayName=CTe;var ETe="DropdownMenuRadioGroup",TTe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ri(n);return a.jsx(uTe,{...s,...r,ref:e})});TTe.displayName=ETe;var ITe="DropdownMenuRadioItem",kW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ri(n);return a.jsx(dTe,{...s,...r,ref:e})});kW.displayName=ITe;var NTe="DropdownMenuItemIndicator",jW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ri(n);return a.jsx(hTe,{...s,...r,ref:e})});jW.displayName=NTe;var PTe="DropdownMenuSeparator",RW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ri(n);return a.jsx(fTe,{...s,...r,ref:e})});RW.displayName=PTe;var ATe="DropdownMenuArrow",kTe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ri(n);return a.jsx(mTe,{...s,...r,ref:e})});kTe.displayName=ATe;var jTe="DropdownMenuSubTrigger",DW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ri(n);return a.jsx(pTe,{...s,...r,ref:e})});DW.displayName=jTe;var RTe="DropdownMenuSubContent",MW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ri(n);return a.jsx(gTe,{...s,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});MW.displayName=RTe;var DTe=_W,MTe=CW,LTe=EW,LW=IW,FW=NW,OW=PW,$W=AW,VW=kW,UW=jW,BW=RW,zW=DW,GW=MW;const _x=DTe,Sx=MTe,FTe=p.forwardRef(({className:t,inset:e,children:n,...r},s)=>a.jsxs(zW,{ref:s,className:bt("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...r,children:[n,a.jsx(Rie,{className:"ml-auto"})]}));FTe.displayName=zW.displayName;const OTe=p.forwardRef(({className:t,...e},n)=>a.jsx(GW,{ref:n,className:bt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...e}));OTe.displayName=GW.displayName;const Dm=p.forwardRef(({className:t,sideOffset:e=4,...n},r)=>a.jsx(LTe,{children:a.jsx(LW,{ref:r,sideOffset:e,className:bt("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n})}));Dm.displayName=LW.displayName;const Is=p.forwardRef(({className:t,inset:e,...n},r)=>a.jsx(OW,{ref:r,className:bt("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",e&&"pl-8",t),...n}));Is.displayName=OW.displayName;const $Te=p.forwardRef(({className:t,children:e,checked:n,...r},s)=>a.jsxs($W,{ref:s,className:bt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(UW,{children:a.jsx(Eg,{className:"h-4 w-4"})})}),e]}));$Te.displayName=$W.displayName;const VTe=p.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(VW,{ref:r,className:bt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(UW,{children:a.jsx(Mie,{className:"h-2 w-2 fill-current"})})}),e]}));VTe.displayName=VW.displayName;const n1=p.forwardRef(({className:t,inset:e,...n},r)=>a.jsx(FW,{ref:r,className:bt("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));n1.displayName=FW.displayName;const r1=p.forwardRef(({className:t,...e},n)=>a.jsx(BW,{ref:n,className:bt("-mx-1 my-1 h-px bg-muted",t),...e}));r1.displayName=BW.displayName;var WW="basil",UTe=function(e){return e===3?"v3":e},HW="https://js.stripe.com",BTe="".concat(HW,"/").concat(WW,"/stripe.js"),zTe=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,GTe=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,JL="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",WTe=function(e){return zTe.test(e)||GTe.test(e)},HTe=function(){for(var e=document.querySelectorAll('script[src^="'.concat(HW,'"]')),n=0;n<e.length;n++){var r=e[n];if(WTe(r.src))return r}return null},QL=function(e){var n=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(BTe).concat(n);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(r),r},qTe=function(e,n){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"7.3.0",startTime:n})},cm=null,Cx=null,Ex=null,KTe=function(e){return function(n){e(new Error("Failed to load Stripe.js",{cause:n}))}},YTe=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},JTe=function(e){return cm!==null?cm:(cm=new Promise(function(n,r){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe&&e&&console.warn(JL),window.Stripe){n(window.Stripe);return}try{var s=HTe();if(s&&e)console.warn(JL);else if(!s)s=QL(e);else if(s&&Ex!==null&&Cx!==null){var i;s.removeEventListener("load",Ex),s.removeEventListener("error",Cx),(i=s.parentNode)===null||i===void 0||i.removeChild(s),s=QL(e)}Ex=YTe(n,r),Cx=KTe(r),s.addEventListener("load",Ex),s.addEventListener("error",Cx)}catch(o){r(o);return}}),cm.catch(function(n){return cm=null,Promise.reject(n)}))},QTe=function(e,n,r){if(e===null)return null;var s=n[0],i=s.match(/^pk_test/),o=UTe(e.version),l=WW;i&&o!==l&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("7.3.0"," expected Stripe.js@").concat(l,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var c=e.apply(void 0,n);return qTe(c,r),c},um,qW=!1,KW=function(){return um||(um=JTe(null).catch(function(e){return um=null,Promise.reject(e)}),um)};Promise.resolve().then(function(){return KW()}).catch(function(t){qW||console.warn(t)});var BA=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];qW=!0;var s=Date.now();return KW().then(function(i){return QTe(i,n,s)})};const XTe="pk_live_51NAoUjDktew9heHOJD5Px4jn9IaolhvVvqoE6NukJV7MxZa8PhIVSwcOVWXdQx6MFNgIGmEYeg64lFUGlYfAyVqu004n16tAdG",ZTe=BA(XTe),e1e={}.VITE_STRIPE_PRO_PLAN_PRICE_ID||"price_1RPDinDktew9heHOLkkL3ZDv",s1=({onSubscribed:t,className:e=""})=>{const{user:n,isAuthenticated:r}=Ia(),[s,i]=p.useState(!1),[o,l]=p.useState(null),c=async()=>{if(!r||!n){l("You must be logged in to subscribe.");return}i(!0),l(null);try{const u=uf(),d=mc(u,"createStripeCheckoutSession"),h=`${window.location.origin}/dashboard?subscription_success=true`,f=`${window.location.origin}/pricing`,m={priceId:e1e,quantity:1,successUrl:h,cancelUrl:f};console.log("Calling createStripeCheckoutSession with payload:",m);const g=await d(m),{sessionId:x,error:v}=g.data;if(v)throw console.error("Firebase function error:",v),new Error(v.message||"Failed to create subscription session via Firebase function.");if(!x)throw console.error("No sessionId returned from Firebase function"),new Error("Failed to retrieve a session ID from the server.");console.log("Received sessionId:",x);const w=await ZTe,{error:_}=await w.redirectToCheckout({sessionId:x});_?(console.error("Stripe redirect error:",_),l(_.message)):t&&t()}catch(u){console.error("Subscription error:",u.message,u),l(u.message)}finally{i(!1)}};return a.jsxs("div",{children:[a.jsx(O,{onClick:c,disabled:s,className:`bg-gradient-to-r from-[#77B8B8] to-[#3B82F6] hover:from-[#6AB0B0] hover:to-[#2F73E0] text-white ${e}`,children:s?"Processing...":"Subscribe to Pro"}),o&&a.jsxs("p",{style:{color:"red",marginTop:"10px",fontSize:"0.8rem"},children:["Error: ",o]})," "]})},YW=()=>{const{isAuthenticated:t,user:e,logout:n,session:r,subscriptionStatus:s,loadingProfile:i,profile:o}=Ia(),l=ti(),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),[g,x]=p.useState(null),[v,w]=p.useState(!1),[_,C]=p.useState(!1),T=s==="active",j=(o==null?void 0:o.stripe_account_id)&&(o==null?void 0:o.stripe_account_details_submitted);p.useEffect(()=>{const R=localStorage.getItem("theme"),D=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;R==="dark"||!R&&D?(document.documentElement.classList.add("dark"),w(!0)):(document.documentElement.classList.remove("dark"),w(!1))},[]);const A=()=>{v?(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")),w(!v)},E=async()=>{try{await n(),l("/auth")}catch(R){console.error("Error logging out:",R)}},I=async()=>{if(!e){h("Authentication required. Please log in again.");return}u(!0),h(null);try{const M=(await mc(qS,"stripeCreatePortalSession")()).data;if(M&&M.url)window.location.href=M.url;else throw new Error(M.error||"Failed to create portal session URL.")}catch(R){console.error("Portal session error:",R),h(R.message||"An unexpected error occurred.")}finally{u(!1)}},N=async()=>{if(!e){x("Authentication required.");return}m(!0),x(null);try{const M=(await mc(qS,"stripeCreateConnectAccount")({email:e.email})).data;if(M&&M.accountLinkUrl)window.location.href=M.accountLinkUrl;else throw new Error(M.error||"Failed to create Stripe Connect account link.")}catch(R){console.error("Stripe Connect account creation error:",R),x(R.message||"An unexpected error occurred.")}finally{m(!1)}},k=async()=>{if(!e||!(o!=null&&o.stripe_account_id)){x("Stripe account not connected or user not authenticated.");return}m(!0),x(null);try{const M=(await mc(qS,"stripeCreateLoginLink")({stripeAccountId:o.stripe_account_id})).data;if(M&&M.loginLinkUrl)window.location.href=M.loginLinkUrl;else throw new Error(M.error||"Failed to create Stripe login link.")}catch(R){console.error("Stripe login link error:",R),x(R.message||"An unexpected error occurred.")}finally{m(!1)}};return a.jsxs(a.Fragment,{children:[!i&&t&&!(o!=null&&o.stripe_account_id&&(o!=null&&o.stripe_account_details_submitted))&&a.jsxs("div",{className:"bg-foreground text-background py-2 px-4 text-center text-sm dark:bg-blue-700 dark:text-white",children:[a.jsxs("button",{onClick:N,disabled:f,className:"relative hover:underline focus:outline-none",children:[f?"Processing...":"Create Your Business",a.jsx(Kie,{className:"absolute bottom-[-10px] right-[-13px] h-4 w-4 text-white"})]}),g&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:g})]}),a.jsxs(It.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full py-4 px-6 flex justify-between items-center sticky top-0 z-50 bg-background/80 backdrop-blur-md border-b",children:[a.jsxs(zn,{to:"/",className:"flex items-center gap-2",children:[a.jsx("img",{src:v?"https://static.wixstatic.com/media/bd2e29_20f2a8a94b7e492a9d76e0b8b14e623b~mv2.png":"https://static.wixstatic.com/media/bd2e29_695f70787cc24db4891e63da7e7529b3~mv2.png",alt:"FreshFront Logo",className:"h-10 sm:h-[60px] w-auto transition-all"}),a.jsx("span",{className:"font-bold text-lg sm:text-xl transition-all",children:"FreshFront"})]}),a.jsxs("nav",{className:"hidden md:flex items-center gap-3",children:[a.jsxs(_x,{children:[a.jsx(Sx,{asChild:!0,children:a.jsxs(O,{variant:"ghost",size:"sm",children:["Create ",a.jsx(Cu,{className:"ml-1 h-4 w-4"})]})}),a.jsxs(Dm,{align:"end",children:[a.jsx(Is,{asChild:!0,children:a.jsx(zn,{to:"/designer",children:"Designer"})}),a.jsx(Is,{asChild:!0,children:a.jsx("a",{href:"https://www.musicmigo.com",target:"_blank",rel:"noopener noreferrer",children:"Music"})}),a.jsx(Is,{asChild:!0,children:a.jsx(zn,{to:"/podcast",children:"Podcast"})}),a.jsx(Is,{asChild:!0,children:a.jsx(zn,{to:"/video",children:"Video"})})]})]}),a.jsx(s1,{className:"px-3 py-1.5 rounded-full text-sm font-medium",showIcon:!0}),t&&!i&&a.jsx(a.Fragment,{children:a.jsxs(_x,{children:[a.jsx(Sx,{asChild:!0,children:a.jsxs(O,{variant:"outline",size:"sm",className:"rounded-full px-3 py-1.5 text-sm font-medium",children:[a.jsx(jie,{className:"mr-2 h-4 w-4"})," Business ",a.jsx(Cu,{className:"ml-1 h-4 w-4"})]})}),a.jsxs(Dm,{align:"end",children:[a.jsx(n1,{children:"Stripe Connect"}),a.jsx(r1,{}),j?a.jsxs(Is,{onClick:k,disabled:f,children:[a.jsx(Yl,{className:"mr-2 h-4 w-4"})," ",f?"Processing...":"Dashboard"]}):a.jsxs(Is,{onClick:N,disabled:f,children:[a.jsx(Yl,{className:"mr-2 h-4 w-4"}),f?"Processing...":"Create Business Account"]}),T&&a.jsxs(Is,{onClick:I,disabled:c,children:[a.jsx(Ch,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Billing"]}),g&&a.jsx(Is,{disabled:!0,children:a.jsx("p",{className:"text-xs text-destructive",children:g})}),d&&a.jsx(Is,{disabled:!0,children:a.jsx("p",{className:"text-xs text-destructive",children:d})})]})]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ro,{id:"theme-switcher-desktop",checked:v,onCheckedChange:A,"aria-label":"Toggle dark mode"}),v?a.jsx(PE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(kE,{className:"h-5 w-5 text-muted-foreground"})]}),t?a.jsxs(_x,{children:[a.jsx(Sx,{asChild:!0,children:a.jsxs(O,{variant:"ghost",className:"flex items-center gap-2",children:[(e==null?void 0:e.photoURL)&&a.jsx("img",{src:e.photoURL,alt:"User avatar",className:"h-6 w-6 rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground hidden lg:inline",children:e==null?void 0:e.email}),a.jsx(Cu,{className:"h-4 w-4"})]})}),a.jsxs(Dm,{align:"end",children:[a.jsx(n1,{children:"My Account"}),a.jsx(r1,{}),T&&a.jsxs(Is,{onClick:I,disabled:c,children:[a.jsx(Ch,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Billing"]}),a.jsxs(Is,{onClick:E,children:[a.jsx(w2,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(zn,{to:"/auth",children:a.jsx(O,{variant:"ghost",size:"sm",children:"Log In"})}),a.jsx(zn,{to:"/auth",children:a.jsx(O,{size:"sm",children:"Sign Up"})})]})]}),a.jsx("div",{className:"md:hidden",children:a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>C(!_),children:_?a.jsx(Hi,{className:"h-6 w-6"}):a.jsx(j3,{className:"h-6 w-6"})})})]}),a.jsx(Sc,{children:_&&a.jsx(It.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"md:hidden fixed inset-x-0 top-[117px] z-40 bg-background/95 backdrop-blur-sm p-6 border-b shadow-lg",children:a.jsxs("nav",{className:"flex flex-col gap-4",children:[a.jsxs(_x,{children:[a.jsx(Sx,{asChild:!0,children:a.jsxs(O,{variant:"ghost",className:"w-full justify-start px-3 py-2 text-base",children:["Create ",a.jsx(Cu,{className:"ml-auto h-4 w-4"})]})}),a.jsxs(Dm,{align:"end",children:[a.jsx(Is,{asChild:!0,children:a.jsx(zn,{to:"/designer",children:"Designer"})}),a.jsx(Is,{asChild:!0,children:a.jsx("a",{href:"https://www.musicmigo.com",target:"_blank",rel:"noopener noreferrer",children:"Music"})}),a.jsx(Is,{asChild:!0,children:a.jsx(zn,{to:"/podcast",children:"Podcast"})}),a.jsx(Is,{asChild:!0,children:a.jsx(zn,{to:"/video",children:"Video"})})]})]}),a.jsx(s1,{className:"w-full justify-start px-3 py-2 text-base",showIcon:!0}),t&&!i&&a.jsxs(a.Fragment,{children:[j?a.jsxs(O,{variant:"outline",onClick:k,disabled:f,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(Yl,{className:"mr-2 h-4 w-4"})," ",f?"Processing...":"Dashboard"]}):a.jsxs(O,{variant:"outline",onClick:N,disabled:f,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(Yl,{className:"mr-2 h-4 w-4"}),f?"Processing...":"Create Business Account"]}),T&&a.jsxs(O,{variant:"outline",onClick:I,disabled:c,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(Ch,{className:"mr-2 h-4 w-4"})," ",c?"Loading...":"Manage Billing"]}),g&&a.jsx("p",{className:"text-xs text-destructive px-3 py-1",children:g}),d&&a.jsx("p",{className:"text-xs text-destructive px-3 py-1",children:d})]}),a.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[a.jsx("span",{className:"text-base",children:"Dark Mode"}),a.jsx(Ro,{id:"theme-switcher-mobile",checked:v,onCheckedChange:A,"aria-label":"Toggle dark mode"})]}),t?a.jsxs(a.Fragment,{children:[(e==null?void 0:e.photoURL)&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",children:[a.jsx("img",{src:e.photoURL,alt:"User avatar",className:"h-8 w-8 rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:e==null?void 0:e.email})]}),a.jsxs(O,{variant:"outline",onClick:E,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(w2,{className:"mr-2 h-4 w-4"})," Logout"]})]}):a.jsxs(a.Fragment,{children:[a.jsx(zn,{to:"/auth",className:"w-full",children:a.jsx(O,{variant:"ghost",className:"w-full justify-start px-3 py-2 text-base",children:"Log In"})}),a.jsx(zn,{to:"/auth",className:"w-full",children:a.jsx(O,{className:"w-full justify-start px-3 py-2 text-base",children:"Sign Up"})})]})]})})})]})},t1e=({rating:t})=>{const n=Math.round(t);return a.jsx("div",{className:"flex items-center",children:[...Array(5)].map((r,s)=>a.jsx(RI,{className:`h-4 w-4 ${s<n?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},s))})},n1e=({isOpen:t,onClose:e,onAddProducts:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState(!1),[l,c]=p.useState([]),[u,d]=p.useState([]),[h,f]=p.useState({}),m=async()=>{if(r.trim()){o(!0),c([]);try{const w=await(await fetch(`https://us-central1-freshfront-c3181.cloudfunctions.net/aliexpressProxy?keywords=${encodeURIComponent(r)}`)).json();w&&w.products&&Array.isArray(w.products.product)?c(w.products.product):(console.warn("Unexpected API response structure:",w),c([]))}catch(v){console.error("Error fetching from AliExpress API:",v),c([])}finally{o(!1)}}},g=async v=>{if(u.some(_=>_.product_id===v.product_id))d(_=>_.filter(C=>C.product_id!==v.product_id));else if(d(_=>[..._,v]),!h[v.product_id])try{const C=await(await fetch(`https://us-central1-freshfront-c3181.cloudfunctions.net/aliexpressProxy?productId=${v.product_id}`)).json();C&&C.product_description&&f(T=>({...T,[v.product_id]:C}))}catch(_){console.error("Error fetching product details:",_)}},x=()=>{const v=u.map(w=>{const _=h[w.product_id]||{};return{...w,..._,product_photos:_.product_photos||[w.product_main_image_url]}});n(v),e()};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs(Vr,{className:"max-w-4xl h-[80vh] flex flex-col",children:[a.jsx(Ur,{children:a.jsx(Br,{children:"Search AliExpress Products"})}),a.jsxs("div",{className:"flex gap-2 p-4 border-b",children:[a.jsx(Je,{placeholder:"Search for products...",value:r,onChange:v=>s(v.target.value),onKeyPress:v=>v.key==="Enter"&&m(),className:"flex-grow"}),a.jsx(O,{onClick:m,disabled:i,children:i?a.jsx(ft,{className:"animate-spin"}):a.jsx(Du,{})})]}),a.jsxs("div",{className:"flex-grow overflow-y-auto p-4",children:[i&&a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(ft,{className:"animate-spin h-8 w-8"})}),!i&&l.length===0&&a.jsx("div",{className:"text-center text-gray-500",children:"No products found."}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:l.map(v=>{const w=parseFloat(v.target_sale_price),_=(w*1.5).toFixed(2),C=(_-w).toFixed(2);return a.jsxs("div",{className:`border rounded-lg p-2 cursor-pointer ${u.some(T=>T.product_id===v.product_id)?"border-blue-500 ring-2 ring-blue-500":""}`,onClick:()=>g(v),children:[a.jsx("img",{src:v.product_main_image_url,alt:v.product_title,className:"w-full h-40 object-cover rounded-md mb-2"}),a.jsx("h3",{className:"text-sm font-semibold truncate",children:v.product_title}),a.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[a.jsxs("span",{children:["$",_]}),a.jsxs("span",{className:"text-sm text-green-500 ml-2",children:["(Profit: $",C,")"]})]}),a.jsxs("p",{className:"text-xs text-gray-500 truncate",children:["by ",v.shop_name]}),a.jsxs("div",{className:"flex items-center mt-1",children:[a.jsx(t1e,{rating:parseFloat(v.evaluate_rate)/20}),a.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",v.evaluate_rate,")"]})]}),a.jsx(O,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:T=>{T.stopPropagation(),window.open(v.product_detail_url,"_blank")},children:"Visit"})]},v.product_id)})})]}),a.jsxs(Ar,{className:"p-4 border-t",children:[a.jsx(O,{variant:"outline",onClick:e,children:"Cancel"}),a.jsxs(O,{onClick:x,disabled:u.length===0,children:["Add ",u.length," Products to Store"]})]})]})})};var zA="Progress",GA=100,[r1e,qRe]=bi(zA),[s1e,i1e]=r1e(zA),JW=p.forwardRef((t,e)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=o1e,...o}=t;(s||s===0)&&!XL(s)&&console.error(a1e(`${s}`,"Progress"));const l=XL(s)?s:GA;r!==null&&!ZL(r,l)&&console.error(l1e(`${r}`,"Progress"));const c=ZL(r,l)?r:null,u=n0(c)?i(c,l):void 0;return a.jsx(s1e,{scope:n,value:c,max:l,children:a.jsx(Yt.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":n0(c)?c:void 0,"aria-valuetext":u,role:"progressbar","data-state":ZW(c,l),"data-value":c??void 0,"data-max":l,...o,ref:e})})});JW.displayName=zA;var QW="ProgressIndicator",XW=p.forwardRef((t,e)=>{const{__scopeProgress:n,...r}=t,s=i1e(QW,n);return a.jsx(Yt.div,{"data-state":ZW(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:e})});XW.displayName=QW;function o1e(t,e){return`${Math.round(t/e*100)}%`}function ZW(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function n0(t){return typeof t=="number"}function XL(t){return n0(t)&&!isNaN(t)&&t>0}function ZL(t,e){return n0(t)&&!isNaN(t)&&t<=e&&t>=0}function a1e(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${GA}\`.`}function l1e(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${GA} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var eH=JW,c1e=XW;const $a=p.forwardRef(({className:t,value:e,...n},r)=>a.jsx(eH,{ref:r,className:bt("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:a.jsx(c1e,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));$a.displayName=eH.displayName;const u1e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),d1e=({isOpen:t,onClose:e,product:n,onSave:r,storeId:s,theme:i})=>{const[o,l]=p.useState(null),[c,u]=p.useState(!1),[d,h]=p.useState(!1),[f,m]=p.useState(null),[g,x]=p.useState(!1),{toast:v}=as();p.useEffect(()=>{n&&l({...n,name:n.name||n.product_title,description:n.description||n.product_description||"",price:n.price||n.target_sale_price*1.5,cost:n.cost||n.target_sale_price,shipping:n.shipping||n.shipping_cost||0,images:n.images||[n.product_main_image_url],variants:n.variants||[],inventory_count:n.inventory_count||0})},[n]);const w=(B,G)=>{l(Y=>({...Y,[B]:G}))},_=async B=>{if(B)try{const G=await u1e(B);l(Y=>{const H=Array.isArray(Y.images)?Y.images:[];return{...Y,images:[...H,G]}})}catch(G){console.error("Error converting file to base64:",G),v({title:"Image Upload Error",description:"Could not process image.",variant:"destructive"})}},C=B=>{l(G=>({...G,images:G.images.filter((Y,H)=>H!==B)}))},T=async()=>{if(!o||!o.name){v({title:"Missing Product Info",description:"Product name is required to generate visuals.",variant:"destructive"});return}const B=o.images&&o.images.length>0?o.images[0]:null;if(!B){v({title:"Missing Base Image",description:"At least one image is required to generate more visuals.",variant:"destructive"});return}h(!0);try{const{base64ImageData:G,mimeType:Y}=await ag(B),H=o.name;let K=[];try{const V=await G0(G,Y,H);V&&V.length>0&&K.push(...V.slice(0,2)),v({title:"Angles Generated",description:`${Math.min(2,(V==null?void 0:V.length)||0)} angle images generated.`,variant:"success"})}catch(V){console.error("Error generating angles:",V),v({title:"Angle Generation Failed",description:V.message,variant:"destructive"})}const $=[`Place this product, "${H}", in a realistic home setting where it might be used or displayed. Focus on a natural context.`,`Show this product, "${H}", in an outdoor lifestyle setting, highlighting its use case or appeal.`];for(const V of $)try{const W=await $o(G,Y,V);W&&W.editedImageData&&K.push(`data:${W.newMimeType};base64,${W.editedImageData}`)}catch(W){console.error(`Error generating context image with prompt "${V}":`,W),v({title:"Context Image Failed",description:`Failed for: ${V.substring(0,30)}...`,variant:"destructive"})}v({title:"Context Images Attempted",description:`Attempted to generate ${$.length} context images.`,variant:"success"}),K.length>0?l(V=>{const W=Array.isArray(V.images)?V.images:[],F=new Set(W),Z=K.filter(ce=>!F.has(ce));return Z.length>0?{...V,images:[...W,...Z]}:(v({title:"Visuals Generated",description:"Generated images were already present.",variant:"default"}),V)}):v({title:"No New Visuals",description:"Could not generate additional visuals.",variant:"default"})}catch(G){console.error("Error in handleGenerateMoreVisuals:",G),v({title:"Visual Generation Error",description:G.message,variant:"destructive"})}finally{h(!1)}},j=(B,G)=>{l(Y=>{const H=[...Y.variants||[]];return H[B]={...H[B],name:G},{...Y,variants:H}})},A=(B,G,Y)=>{l(H=>{const K=[...H.variants||[]],$={...K[B]};return $.values=[...$.values||[]],$.values[G]=Y,K[B]=$,{...H,variants:K}})},E=B=>{l(G=>{const Y=[...G.variants||[]],H={...Y[B]};return H.values=[...H.values||[],""],Y[B]=H,{...G,variants:Y}})},I=(B,G)=>{l(Y=>{const H=[...Y.variants||[]],K={...H[B]};return K.values=(K.values||[]).filter(($,V)=>V!==G),H[B]=K,{...Y,variants:H}})},N=()=>{l(B=>({...B,variants:[...B.variants||[],{name:"",values:[""]}]}))},k=B=>{l(G=>({...G,variants:(G.variants||[]).filter((Y,H)=>H!==B)}))},R=async()=>{if(u(!0),!o.name||o.name.trim()===""||o.price===void 0||String(o.price).trim()===""){v({title:"Missing Information",description:"Please ensure the product has a name and a valid price.",variant:"destructive"}),u(!1);return}try{const B={...o,product_title:o.name,product_description:o.description,sale_price:o.price,target_sale_price:o.cost,shipping_cost:o.shipping,product_main_image_url:o.images[0]};await r(B),e()}catch{v({title:"Save Error",description:"Could not save product changes.",variant:"destructive"})}finally{u(!1)}},D=B=>{m(B),x(!0)};if(!t||!o)return null;const M=o.price-o.cost-o.shipping,z=o.price>0?M/o.price*100:0;return a.jsxs(a.Fragment,{children:[a.jsx(Yr,{open:t,onOpenChange:B=>!B&&e(),children:a.jsxs(Vr,{className:"max-w-2xl",children:[a.jsxs(Ur,{children:[a.jsxs(Br,{children:["Edit Product: ",n.product_title]}),a.jsx(Qi,{children:"Make changes to the product details below."})]}),a.jsx(Fs,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"space-y-4 pr-4",children:a.jsxs(Qe,{className:"p-4 space-y-3",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"productName-edit",children:"Product Name"}),a.jsx(Je,{id:"productName-edit",value:o.name,onChange:B=>w("name",B.target.value),placeholder:"Product Name"})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"productDescription-edit",children:"Description"}),a.jsx(En,{id:"productDescription-edit",value:o.description,onChange:B=>w("description",B.target.value),placeholder:"Product Description",rows:3})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs(je,{htmlFor:"productPrice-edit",children:["Price (",o.currencyCode||"USD",")"]}),a.jsx(Je,{id:"productPrice-edit",type:"number",value:o.price,onChange:B=>w("price",parseFloat(B.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),a.jsx($a,{value:100,className:"h-2"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(je,{htmlFor:"productCost-edit",children:"Cost"}),a.jsx(Je,{id:"productCost-edit",type:"number",value:o.cost,onChange:B=>w("cost",parseFloat(B.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),a.jsx($a,{value:o.price>0?o.cost/o.price*100:0,className:"h-2 [&>div]:bg-red-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(je,{htmlFor:"productShipping-edit",children:"Shipping"}),a.jsx(Je,{id:"productShipping-edit",type:"number",value:o.shipping,onChange:B=>w("shipping",parseFloat(B.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),a.jsx($a,{value:o.price>0?o.shipping/o.price*100:0,className:"h-2 [&>div]:bg-orange-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(je,{children:"Profit"}),a.jsx(Je,{value:M.toFixed(2),disabled:!0,className:"w-24 text-right"})]}),a.jsx($a,{value:z,className:"h-2 [&>div]:bg-green-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(je,{children:"Profit Margin"}),a.jsx(Je,{value:`${z.toFixed(2)}%`,disabled:!0,className:"w-24 text-right"})]}),a.jsx($a,{value:z,className:"h-2 [&>div]:bg-green-500"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{children:"Product Images"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(o.images||[]).map((B,G)=>a.jsxs("div",{className:"relative group w-24 h-24 cursor-pointer",onClick:()=>D(B),children:[a.jsx("img",{src:B,alt:`Product image ${G+1}`,className:"w-full h-full object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Y=>{Y.stopPropagation(),C(G)},children:a.jsx(Fn,{className:"h-3 w-3"})})]},G))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById("productImageUpload-edit").click(),children:[a.jsx(Lo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsx(Je,{id:"productImageUpload-edit",type:"file",accept:"image/*",className:"hidden",onChange:B=>_(B.target.files[0])}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:T,disabled:c||d||!o.name||!o.images||o.images.length===0,children:[d?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"More Angles/Context (AI)"]})]})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(o.variants||[]).map((B,G)=>a.jsxs(Qe,{className:"p-2 space-y-2 bg-muted/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(je,{htmlFor:`variantName-edit-${G}`,className:"text-xs",children:"Option Name"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>k(G),className:"h-6 w-6",children:a.jsx(Fn,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(Je,{id:`variantName-edit-${G}`,value:B.name||"",onChange:Y=>j(G,Y.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(je,{className:"text-xs",children:"Option Values"}),(B.values||[]).map((Y,H)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Je,{value:Y||"",onChange:K=>A(G,H,K.target.value),placeholder:"e.g., Red",className:"text-sm h-8"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>I(G,H),className:"h-6 w-6",children:a.jsx(Fn,{className:"h-3 w-3 text-destructive"})})]},H)),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>E(G),className:"text-xs h-7",children:[a.jsx(Fi,{className:"mr-1 h-3 w-3"})," Add Value"]})]},G)),a.jsxs(O,{variant:"outline",onClick:N,className:"w-full text-sm h-8",children:[a.jsx(Fi,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]}),a.jsxs("div",{className:"pt-3 border-t mt-3",children:[a.jsx(je,{htmlFor:"productInventory-edit",children:"Inventory Count"}),a.jsx(Je,{id:"productInventory-edit",type:"number",value:o.inventory_count||"",onChange:B=>w("inventory_count",parseInt(B.target.value)||0),placeholder:"0"})]})]})})}),a.jsxs(Ar,{children:[a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel"})}),a.jsxs(O,{type:"button",onClick:R,disabled:c,children:[c?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Save Changes"]})]})]})}),g&&f&&a.jsx(Yr,{open:g,onOpenChange:x,children:a.jsxs(Vr,{className:"max-w-xl max-h-[80vh]",children:[a.jsxs(Ur,{children:[a.jsx(Br,{children:"Enlarged Image"}),a.jsx(rl,{asChild:!0,children:a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-4 right-4",onClick:()=>x(!1),children:a.jsx(Fi,{className:"h-4 w-4 rotate-45"})})})]}),a.jsx("div",{className:"flex justify-center items-center p-4",children:a.jsx("img",{src:f,alt:"Enlarged product",className:"max-w-full max-h-[70vh] object-contain"})})]})})]})},eF=["Create a luxury jewelry store called 'Elegance' with diamond rings and gold necklaces, featuring a dark, sophisticated theme.","Build a tech gadget store named 'FutureTech' with the latest smartphones and accessories, using a futuristic blue and silver color scheme.","Design an organic food market 'GreenHarvest' with fresh produce and healthy snacks, emphasizing natural textures and earthy tones.","Make a trendy fashion boutique 'Urban Threads' with summer dresses and casual wear, aiming for a bright, minimalist aesthetic."],nC={"Healthy Food":{keywords:["healthy food","organic food","greenharvest","fresh produce","natural food","health store"],primaryColor:"green",secondaryColor:"orange",templates:["Classic","Fresh","Sleek"]},"Fast Food":{keywords:["fast food","burgers","fries","pizza","takeaway","quick serve"],primaryColor:"red",secondaryColor:"orange",templates:["Premium","Modern","Classic","Fresh","Sleek"]},Technology:{keywords:["tech","gadget","electronics","software","computer","phone","futuretech"],primaryColor:"blue",secondaryColor:"purple",templates:["Classic","Fresh","Sleek","Sharp","Premium","Modern"]},"General Store":{keywords:["general store","variety store","convenience store","department store"],primaryColor:"navy",secondaryColor:"grey",templates:["Classic","Fresh","Sleek","Premium","Modern"]},"Female Fashion/Beauty":{keywords:["female fashion","beauty","cosmetics","makeup","women's clothing","boutique","urban threads"],primaryColor:"peach",secondaryColor:"purple",templates:["Classic","Fresh","Sleek"]},Jewelry:{keywords:["jewelry","rings","necklaces","earrings","diamonds","gold","elegance"],primaryColor:"grey",secondaryColor:"darkpurple",templates:["Classic","Fresh","Sleek","Premium","Modern"]},Fashion:{keywords:["fashion","clothing","apparel","style","wear"],primaryColor:"navyblue",secondaryColor:"mediumred",templates:["Classic","Fresh","Sleek","Premium","Modern"]},Furniture:{keywords:["furniture","home decor","sofa","table","chair","furnishings"],primaryColor:"brown",secondaryColor:"darkgrey",templates:["Classic","Fresh","Sleek"]},Default:{keywords:[],primaryColor:"blue",secondaryColor:"gray",templates:["Fresh","Classic","Sleek","Modern"]}},h1e=t=>{const e=t.toLowerCase();for(const n in nC){if(n==="Default")continue;const r=nC[n];if(r.keywords.some(s=>e.includes(s.toLowerCase())))return{...r,name:n}}return{...nC.Default,name:"General Store"}},f1e=({generatedImage:t})=>{const[e,n]=p.useState(""),[r,s]=p.useState(""),[i,o]=p.useState(null),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[h,f]=p.useState(!1),[m,g]=p.useState([]),[x,v]=p.useState(null),[w,_]=p.useState(!1),[C,T]=p.useState([]),j=p.useRef(null),{generateStore:A,isGenerating:E,importedStoreDataForGenerator:I,isImportDataReadyForGenerator:N,clearImportedStoreDataForGenerator:k,stores:R,openAuthModal:D}=$n(),{isAuthenticated:M}=Ia(),[z,B]=p.useState(!1),[G,Y]=p.useState(null),[H,K]=p.useState([]),[$,V]=p.useState(!1),[W,F]=p.useState(null),Z=Mse(e,500);p.useEffect(()=>{if(t){const ie=atob(t.split(",")[1]),Me=t.split(",")[0].split(":")[1].split(";")[0],He=new ArrayBuffer(ie.length),yt=new Uint8Array(He);for(let mn=0;mn<ie.length;mn++)yt[mn]=ie.charCodeAt(mn);const kt=new Blob([He],{type:Me}),en=new File([kt],"design.png",{type:Me});T([{file:en,previewUrl:t}])}},[t]),p.useEffect(()=>{(async()=>{if(!Z.trim()||$)return;V(!0),F(null),K([]);const Me=await vI(Z);Me.suggestions?K(Me.suggestions):F(Me.error||"Failed to get suggestions."),V(!1)})()},[Z]),p.useEffect(()=>()=>{C.forEach(ie=>{ie.previewUrl&&URL.revokeObjectURL(ie.previewUrl)})},[C]),p.useEffect(()=>{N&&I&&(n(I.name||""),s(I.prompt||""),I.name&&he(I.name),k())},[N,I,k]);const ce=ie=>{n(ie.target.value),Y(null),K([]),F(null)},le=ie=>{n(ie),K([]),Y(null),setTimeout(()=>he(ie),0)},he=p.useCallback(async ie=>{const Me=ie||e;if(!Me.trim())return Y({status:"error",message:"Store name cannot be empty."}),!1;B(!0),Y(null);try{return await qT(Me.trim())?(Y({status:"claimed",message:"Not available"}),!1):(Y({status:"available",message:"Available"}),!0)}catch(He){return console.error("Store name availability check failed in StoreGenerator:",He),Y({status:"error",message:He.message||"Failed to check name. Please try again."}),!1}finally{B(!1)}},[e]),Le=ie=>{o(ie);const Me=eF[ie],He=Me.match(/(?:store called|store named|market|boutique) '([^']+)'/i),yt=He&&He[1]?He[1]:"";n(yt),s(Me),Y(null),yt&&setTimeout(()=>he(yt),0)},Ve=async ie=>{if(ie.preventDefault(),!M&&R.length>=1){D();return}let Me=!1;if(G&&G.status==="available"?Me=!0:e.trim()?Me=await he(e):Y({status:"error",message:"Store name cannot be empty."}),!Me)return;if(!r.trim()){alert("Please provide a description for your store.");return}if(E||z)return;const He=h1e(r);try{await A(r,e,He,[],l,u,C,m)}catch(yt){console.error("Error calling generateStore from StoreGenerator:",yt),alert(`An error occurred during the store generation step: ${yt.message}`)}},Be=ie=>{const He=Array.from(ie.target.files).map(yt=>({file:yt,previewUrl:yt.type.startsWith("image/")?URL.createObjectURL(yt):null}));T(yt=>[...yt,...He])},ue=ie=>{const Me=C[ie];Me.previewUrl&&URL.revokeObjectURL(Me.previewUrl),T(He=>He.filter((yt,kt)=>kt!==ie))},Ce=ie=>{g(ie)},Ie=ie=>{v(ie),_(!0)},ve=ie=>{g(m.map(Me=>Me.product_id===ie.product_id?ie:Me)),_(!1)};return a.jsxs(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full",children:[a.jsxs("form",{onSubmit:Ve,children:[a.jsxs("div",{className:"mb-[13px]",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"storeName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 ml-[6px]",children:"Store Name"}),a.jsxs("div",{className:"relative flex items-center",children:[a.jsx(Je,{id:"storeName",type:"text",placeholder:"ex. Future Furniture",className:bt("text-base flex-grow",(G==null?void 0:G.status)==="claimed"&&"border-red-500 focus:border-red-500 dark:border-red-500 dark:focus:border-red-500",(G==null?void 0:G.status)==="error"&&"border-yellow-500 focus:border-yellow-500 dark:border-yellow-500 dark:focus:border-yellow-500",(G==null?void 0:G.status)==="available"&&"border-green-500 focus:border-green-500 dark:border-green-500 dark:focus:border-green-500","pr-24"),value:e,onChange:ce,disabled:E||z}),a.jsxs(O,{type:"button",variant:"ghost",size:"sm",onClick:()=>he(),disabled:!e.trim()||z,className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 px-2 z-10",children:[z?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(ha,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-1 hidden sm:inline",children:"Check"})]})]}),a.jsxs("div",{className:"mt-1",children:[" ",z&&e.trim()&&a.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[a.jsx(ft,{className:"h-4 w-4 animate-spin mr-2"})," Checking..."]}),G&&e.trim()&&!z&&a.jsxs("p",{className:`text-sm font-medium flex items-center ${G.status==="available"?"text-green-600":G.status==="claimed"?"text-red-600":G.status==="error"?"text-yellow-600":"text-muted-foreground"}`,children:[G.status==="available"&&a.jsx(ha,{className:"h-4 w-4 mr-1"}),G.status==="claimed"&&a.jsx(K_,{className:"h-4 w-4 mr-1"}),G.status==="error"&&a.jsx(K_,{className:"h-4 w-4 mr-1"}),G.message]})]}),($||H.length>0||W)&&a.jsxs("div",{className:"mt-[7px] mb-[13px]",children:[$&&a.jsxs("div",{className:"flex items-center space-x-2 animate-pulse h-8",children:[a.jsx("div",{className:"h-8 w-28 bg-gray-200 dark:bg-gray-700 rounded-md"}),a.jsx("div",{className:"h-8 w-32 bg-gray-200 dark:bg-gray-700 rounded-md"}),a.jsx("div",{className:"h-8 w-24 bg-gray-200 dark:bg-gray-700 rounded-md"})]}),!$&&H.length>0&&a.jsxs(It.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-wrap gap-2",children:[a.jsx("span",{className:"text-sm text-muted-foreground mr-2 self-center",children:"Suggestions:"}),H.map((ie,Me)=>a.jsx(O,{type:"button",variant:"outline",size:"sm",onClick:()=>le(ie),className:"bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 dark:border-gray-600 saturate-0",children:ie},Me))]}),W&&a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(K_,{className:"h-4 w-4 mr-1"})," ",W]})]})]}),a.jsxs("div",{className:"pt-0 mt-[14px] mb-[13px]",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("label",{htmlFor:"storePrompt",className:"text-sm font-medium text-gray-700 dark:text-gray-300 ml-[6px]",children:"Prompt"}),a.jsxs("div",{className:"flex items-center",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"printOnDemandCheckbox",checked:l,onChange:ie=>c(ie.target.checked),className:bt("appearance-none h-4 w-4 border rounded-full checked:border-transparent focus:outline-none focus:ring-2 focus:ring-offset-1 dark:focus:ring-offset-gray-900 cursor-pointer","border-gray-400 dark:border-gray-500","focus:ring-orange-500",l&&"bg-orange-500 border-orange-500 animate-radiate-orange")}),a.jsx("label",{htmlFor:"printOnDemandCheckbox",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Print on Demand"})]}),a.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[a.jsx("input",{type:"checkbox",id:"dropshippingCheckbox",checked:u,onChange:ie=>{d(ie.target.checked),ie.target.checked&&f(!0)},className:bt("appearance-none h-4 w-4 border rounded-full checked:border-transparent focus:outline-none focus:ring-2 focus:ring-offset-1 dark:focus:ring-offset-gray-900 cursor-pointer","border-gray-400 dark:border-gray-500","focus:ring-blue-500",u&&"bg-blue-500 border-blue-500 animate-radiate-blue")}),a.jsx("label",{htmlFor:"dropshippingCheckbox",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Dropshipping"})]})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(En,{id:"storePrompt",placeholder:"ex. 'A modern furniture store specializing in sustainable and innovative designs for the contemporary home. Focus on minimalist aesthetics and smart functionality.'",className:"min-h-[120px] text-base resize-none w-full pr-12",value:r,onChange:ie=>s(ie.target.value),disabled:E}),a.jsxs("div",{className:"absolute bottom-2 right-2 flex items-center",children:[a.jsx("div",{className:"flex items-center gap-2 mr-2",children:C.map((ie,Me)=>a.jsxs("div",{className:"relative group",children:[ie.previewUrl?a.jsx("img",{src:ie.previewUrl,alt:"Preview",className:"h-8 w-8 rounded-md object-cover"}):a.jsx("div",{className:"h-8 w-8 rounded-md bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:a.jsx(Sr,{className:"h-5 w-5 text-gray-500"})}),a.jsx(O,{variant:"ghost",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 rounded-full bg-red-500 text-white opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>ue(Me),children:a.jsx(Hi,{className:"h-3 w-3"})})]},Me))}),a.jsx(O,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",onClick:()=>j.current.click(),disabled:E,children:a.jsx(Yie,{className:"h-5 w-5"})})]}),a.jsx("input",{type:"file",ref:j,multiple:!0,onChange:Be,className:"hidden",accept:"application/pdf,image/*"})]})]}),m.length>0&&a.jsxs("div",{className:"mt-4",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Selected Dropshipping Products"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:m.map(ie=>a.jsxs("div",{className:"border rounded-lg p-2 cursor-pointer",onClick:()=>Ie(ie),children:[a.jsx("img",{src:ie.product_main_image_url,alt:ie.product_title,className:"w-full h-24 object-cover rounded-md mb-2"}),a.jsx("p",{className:"text-sm truncate",children:ie.product_title})]},ie.product_id))})]})]}),a.jsx(O,{type:"submit",disabled:!e.trim()||!r.trim()||E||z||G&&G.status!=="available",className:"w-full bg-gradient-to-r from-green-600 to-cyan-600 hover:from-green-700 hover:to-cyan-700 text-white mt-6",size:"lg",children:E?a.jsxs(a.Fragment,{children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Store..."]}):a.jsxs(a.Fragment,{children:[a.jsx(va,{className:"mr-2 h-4 w-4"}),"Generate Store"]})}),a.jsxs("div",{className:"space-y-2 mt-6",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Or try one of these examples for inspiration:"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:eF.map((ie,Me)=>a.jsx(O,{type:"button",variant:"outline",className:bt("h-auto py-2 px-3 justify-start text-left text-sm font-normal",i===Me?"bg-[#c9ccd1] text-black hover:bg-[#c9ccd1] dark:bg-[#242424] dark:text-gray-300 dark:hover:bg-[#242424]":"hover:bg-accent hover:text-accent-foreground"),onClick:()=>Le(Me),disabled:E,children:ie},Me))})]})]}),a.jsx(n1e,{isOpen:h,onClose:()=>f(!1),onAddProducts:Ce}),x&&a.jsx(d1e,{isOpen:w,onClose:()=>_(!1),product:x,onSave:ve})]})};var tH="AlertDialog",[m1e,KRe]=bi(tH,[oU]),wl=oU(),nH=t=>{const{__scopeAlertDialog:e,...n}=t,r=wl(e);return a.jsx(_U,{...r,...n,modal:!0})};nH.displayName=tH;var p1e="AlertDialogTrigger",rH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=wl(n);return a.jsx(mae,{...s,...r,ref:e})});rH.displayName=p1e;var g1e="AlertDialogPortal",sH=t=>{const{__scopeAlertDialog:e,...n}=t,r=wl(e);return a.jsx(SU,{...r,...n})};sH.displayName=g1e;var y1e="AlertDialogOverlay",iH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=wl(n);return a.jsx(VI,{...s,...r,ref:e})});iH.displayName=y1e;var Rh="AlertDialogContent",[x1e,v1e]=m1e(Rh),w1e=Vse("AlertDialogContent"),oH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,children:r,...s}=t,i=wl(n),o=p.useRef(null),l=yn(e,o),c=p.useRef(null);return a.jsx(uae,{contentName:Rh,titleName:aH,docsSlug:"alert-dialog",children:a.jsx(x1e,{scope:n,cancelRef:c,children:a.jsxs(UI,{role:"alertdialog",...i,...s,ref:l,onOpenAutoFocus:gt(s.onOpenAutoFocus,u=>{var d;u.preventDefault(),(d=c.current)==null||d.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[a.jsx(w1e,{children:r}),a.jsx(_1e,{contentRef:o})]})})})});oH.displayName=Rh;var aH="AlertDialogTitle",lH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=wl(n);return a.jsx(BI,{...s,...r,ref:e})});lH.displayName=aH;var cH="AlertDialogDescription",uH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=wl(n);return a.jsx(zI,{...s,...r,ref:e})});uH.displayName=cH;var b1e="AlertDialogAction",dH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=wl(n);return a.jsx(V0,{...s,...r,ref:e})});dH.displayName=b1e;var hH="AlertDialogCancel",fH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,{cancelRef:s}=v1e(hH,n),i=wl(n),o=yn(e,s);return a.jsx(V0,{...i,...r,ref:o})});fH.displayName=hH;var _1e=({contentRef:t})=>{const e=`\`${Rh}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Rh}\` by passing a \`${cH}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Rh}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{var r;document.getElementById((r=t.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(e)},[e,t]),null},S1e=nH,C1e=rH,E1e=sH,mH=iH,pH=oH,gH=dH,yH=fH,xH=lH,vH=uH;const T1e=S1e,I1e=C1e,N1e=E1e,wH=ht.forwardRef(({className:t,...e},n)=>a.jsx(mH,{className:bt("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:n}));wH.displayName=mH.displayName;const bH=ht.forwardRef(({className:t,...e},n)=>a.jsxs(N1e,{children:[a.jsx(wH,{}),a.jsx(pH,{ref:n,className:bt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e})]}));bH.displayName=pH.displayName;const _H=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col space-y-2 text-center sm:text-left",t),...e});_H.displayName="AlertDialogHeader";const SH=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});SH.displayName="AlertDialogFooter";const CH=ht.forwardRef(({className:t,...e},n)=>a.jsx(xH,{ref:n,className:bt("text-lg font-semibold",t),...e}));CH.displayName=xH.displayName;const EH=ht.forwardRef(({className:t,...e},n)=>a.jsx(vH,{ref:n,className:bt("text-sm text-muted-foreground",t),...e}));EH.displayName=vH.displayName;const TH=ht.forwardRef(({className:t,...e},n)=>a.jsx(gH,{ref:n,className:bt(GI(),t),...e}));TH.displayName=gH.displayName;const IH=ht.forwardRef(({className:t,...e},n)=>a.jsx(yH,{ref:n,className:bt(GI({variant:"outline"}),"mt-2 sm:mt-0",t),...e}));IH.displayName=yH.displayName;const P1e=({store:t})=>{const e=ti(),{deleteStore:n,updateStorePassKey:r,assignStoreManager:s,updateStoreTemplateVersion:i}=$n(),[o,l]=ht.useState(""),[c,u]=ht.useState(""),[d,h]=ht.useState(!1),f=()=>{r&&o&&t.id&&r(t.id,o)},m=()=>{s&&c&&t.id&&s(t.id,c)},g=v=>{if(!v)return"N/A";try{const w=new Date(v);return isNaN(w.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(w)}catch(w){return console.error("Error formatting date:",v,w),"Error Date"}},x=v=>{switch(v){case"fashion":return a.jsx(F3,{className:"h-5 w-5 text-pink-500"});case"electronics":return a.jsx(zy,{className:"h-5 w-5 text-blue-500"});case"food":return a.jsx(zy,{className:"h-5 w-5 text-green-500"});case"jewelry":return a.jsx(zy,{className:"h-5 w-5 text-amber-500"});default:return a.jsx(zy,{className:"h-5 w-5 text-gray-500"})}};return a.jsx(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"store-preview relative bg-cover bg-center rounded-[15px] overflow-hidden",style:t.card_background_url?{backgroundImage:`url(${t.card_background_url})`}:{backgroundColor:"#374151"},children:a.jsxs(Qe,{className:"h-full overflow-hidden border-2 border-white/20 hover:border-primary/50 transition-all duration-300 bg-black/30 backdrop-blur-sm text-white rounded-[15px]",children:[" ",a.jsxs("div",{className:"relative z-10 p-1 rounded-[15px]",children:[" ",a.jsxs(lt,{className:"pb-2",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[t.logo_url?a.jsx("img",{src:t.logo_url,alt:`${t.name} logo`,className:"h-6 w-6 rounded-sm object-contain bg-white/30 p-0.5"}):x(t.type),a.jsx(ct,{className:"text-xl text-white drop-shadow-md",children:t.name})]}),a.jsx("span",{className:"px-2 py-1 bg-white/10 text-gray-200 text-xs rounded-full backdrop-blur-xs",children:t.type.charAt(0).toUpperCase()+t.type.slice(1)})]}),a.jsx(Qt,{className:"line-clamp-2 mt-1 text-gray-300 drop-shadow-sm",children:t.description})]}),a.jsxs(it,{className:"pb-2",children:[a.jsxs("div",{className:"flex items-center text-sm text-gray-300 drop-shadow-sm gap-1 mb-3",children:[a.jsx(PI,{className:"h-3.5 w-3.5 mr-1 text-gray-400"}),"Created on ",g(t.created_at||t.createdAt)]}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:t&&t.products&&Array.isArray(t.products)&&t.products.length>0?t.products.slice(0,4).map(v=>a.jsxs("div",{className:"bg-white/10 p-2 rounded-md text-xs flex flex-col backdrop-blur-xs",children:[a.jsx("span",{className:"font-medium truncate text-gray-200",children:v.name||"Unnamed Product"}),a.jsxs("span",{className:"text-sky-300",children:[" ",typeof v.price=="number"?`$${v.price.toFixed(2)}`:"Price N/A"]})]},v.id)):a.jsx("p",{className:"text-xs text-gray-400 col-span-2",children:t&&t.products&&t.products.length===0?"No products yet.":"Product data unavailable."})})]}),a.jsxs(pd,{className:"flex flex-col items-start gap-2 pt-2",children:[a.jsxs("div",{className:"flex w-full justify-between items-center",children:[a.jsx(O,{variant:"outline",size:"sm",className:"bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:()=>{t&&t.name?e(`/${pc(t.name)}`):console.error("Store name is missing, cannot navigate to preview.")},children:"Preview"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-300 hover:text-white hover:bg-white/10",onClick:()=>t&&t.name&&e(`/${pc(t.name)}?edit=true`),children:[a.jsx(Op,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Edit"})]}),a.jsxs(T1e,{children:[a.jsx(I1e,{asChild:!0,children:a.jsxs(O,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-400 hover:text-red-300 hover:bg-red-500/10",children:[a.jsx(Fn,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Delete"})]})}),a.jsxs(bH,{children:[a.jsxs(_H,{children:[a.jsx(CH,{children:"Are you sure?"}),a.jsxs(EH,{children:['This will permanently delete the "',t.name,'" store and all its data. This action cannot be undone.']})]}),a.jsxs(SH,{children:[a.jsx(IH,{children:"Cancel"}),a.jsx(TH,{className:"bg-red-500 text-white hover:bg-red-600",onClick:()=>n(t.id),children:"Delete"})]})]})]})]})]}),a.jsxs("div",{className:"flex w-full items-center gap-2 mt-2",children:[a.jsx(Je,{type:"password",placeholder:"Set Pass Key",value:o,onChange:v=>l(v.target.value),className:"h-8 text-xs flex-grow bg-neutral-700/60 dark:bg-neutral-800/60 border-neutral-500 dark:border-neutral-600 placeholder-zinc-400 text-white focus:outline-none"}),a.jsxs(O,{variant:"outline",size:"icon",className:"h-8 w-8 bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:f,disabled:!o.trim(),children:[a.jsx(k3,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Set Pass Key"})]})]}),a.jsxs("div",{className:"w-full mt-2",children:[a.jsx(O,{variant:"outline",size:"sm",className:"w-full bg-white/10 hover:bg-white/20 text-gray-200 border-gray-500 hover:border-gray-400",onClick:()=>h(!d),children:d?"Cancel Assignment":"Assign Manager"}),d&&a.jsxs("div",{className:"flex w-full items-center gap-2 mt-2",children:[a.jsx(Je,{type:"email",placeholder:"Manager Email",value:c,onChange:v=>u(v.target.value),className:"h-8 text-xs flex-grow bg-neutral-700/60 dark:bg-neutral-800/60 border-neutral-500 dark:border-neutral-600 placeholder-zinc-400 text-white focus:outline-none"}),a.jsxs(O,{variant:"outline",size:"icon",className:"h-8 w-8 bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:()=>{m()},disabled:!c.trim(),children:[a.jsx(ooe,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Confirm Assign Manager"})]})]})]})]})]})]})})},A1e=()=>{const{stores:t,loadStores:e,isLoadingStores:n}=$n(),{user:r}=Ia();return p.useEffect(()=>{r!=null&&r.uid&&e(r.uid)},[r,e]),a.jsxs(It.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},className:"w-full max-w-6xl mx-auto mt-8",children:[a.jsx("div",{className:"flex justify-between items-center mb-4",children:a.jsx("h2",{className:"text-2xl font-bold",children:"Browse Stores"})}),n&&t.length===0&&a.jsx("div",{className:"text-center py-10",children:a.jsx("p",{className:"text-muted-foreground",children:"Loading your stores..."})}),!n&&t.length===0&&a.jsx("div",{className:"text-center py-10",children:a.jsx("p",{className:"text-muted-foreground",children:"You haven't created any stores yet. Get started by generating a new store!"})}),t.length>0&&a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(s=>a.jsx(P1e,{store:s},s.id))})]})},k1e=({open:t,onOpenChange:e,onSuccessfulConnect:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState(""),{startShopifyImportWizard:l,isFetchingShopifyPreviewData:c,shopifyImportError:u,setShopifyWizardStep:d}=$n(),h=async f=>{if(f.preventDefault(),!r||!i){alert("Please enter both Shopify domain and access token.");return}await l(r,i)&&n&&n()};return a.jsx(Yr,{open:t,onOpenChange:f=>{e(f)},children:a.jsxs(Vr,{className:"sm:max-w-[425px] sm:rounded-xl",children:[" ",a.jsxs(Ur,{children:[a.jsx(Br,{children:"Connect to Shopify"}),a.jsxs(Qi,{className:"text-slate-500 dark:text-slate-400",children:[" ","Enter your Shopify store domain and Storefront Access Token to begin importing."]})]}),a.jsxs("form",{onSubmit:h,className:"grid gap-4 py-4",children:[u&&a.jsx("div",{className:"col-span-4 p-2 text-sm text-red-600 bg-red-100 border border-red-300 rounded",children:u}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"domain",className:"text-right",children:"Domain"}),a.jsx(Je,{id:"domain",value:r,onChange:f=>s(f.target.value),placeholder:Rse,className:"col-span-3",disabled:c})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"token",className:"text-right",children:"Token"}),a.jsx(Je,{id:"token",type:"password",value:i,onChange:f=>o(f.target.value),placeholder:"Storefront Access Token",className:"col-span-3",disabled:c})]}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",disabled:c,onClick:()=>e(!1),children:"Cancel"}),a.jsx(O,{type:"submit",disabled:c||!r||!i,children:c?a.jsxs(a.Fragment,{children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Connecting..."]}):"Connect & Fetch Info"})]})]})]})})},j1e=({open:t,onOpenChange:e,onSuccessfulConnect:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState("");p.useState(!1),p.useState(null),p.useState("");const{startBigCommerceImportWizard:l,bigCommerceImportError:c,isFetchingBigCommercePreviewData:u}=$n(),d=async h=>{if(h.preventDefault(),!r||!i){alert("Both Store Domain and API Token are required.");return}await l(r,i),n&&n({storeDomain:r,apiToken:i})};return t?a.jsx("div",{className:"w-full",children:a.jsxs("form",{onSubmit:d,children:[a.jsxs(it,{className:"space-y-4 pt-6",children:[" ",a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"bc-store-domain",children:"Store Domain"}),a.jsx(Je,{id:"bc-store-domain",type:"text",placeholder:"e.g., mystore.mybigcommerce.com",value:r,onChange:h=>s(h.target.value.trim()),disabled:u})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"bc-api-token",children:"Storefront API Token"}),a.jsx(Je,{id:"bc-api-token",type:"password",placeholder:"Enter your Storefront API Token",value:i,onChange:h=>o(h.target.value.trim()),disabled:u})]}),c&&a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(rw,{className:"mr-2 h-4 w-4"})," ",c]})]}),a.jsx(pd,{className:"flex flex-col space-y-2",children:a.jsxs(O,{type:"submit",className:"w-full",disabled:u,children:[u?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(ha,{className:"mr-2 h-4 w-4"}),u?"Connecting...":"Connect to BigCommerce"]})})]})}):null},R1e="modulepreload",D1e=function(t){return"/"+t},tF={},Ot=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=D1e(i),i in tF)return;tF[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const h=s[d];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":R1e,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},M1e="AIzaSyCWUzTb8AC8d6CvHm4_MLgXSeufRQcHQAE",L1e=[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE}],F1e=["Shirt","Mug","Hat","Totebag","Poster"];async function O1e(t,e){var l;if(!t)return console.warn("[geminiPromptAnalysis] User store prompt is empty. Defaulting to standard strategy."),{strategy:"standard",theme:"General",requestedProductTypes:[],isPod:!1,podConfidence:0,suggestedPodProducts:[]};const r=new On({apiKey:M1e}).getGenerativeModel({model:"gemini-1.5-flash-latest",safetySettings:L1e}),s=eo.map(c=>c.name).join(", "),i=((l=Yw.find(c=>c.value===e))==null?void 0:l.label)||e||"General",o=`
    Analyze the following user prompt for an e-commerce store and the store's product niche.
    User Prompt: "${t}"
    Product Niche: "${i}"
    Available Print-on-Demand (POD) base product types: ${s}.

    Your goal is to determine the best product generation strategy.

    Consider these scenarios:
    1.  If the prompt explicitly mentions "print on demand", "POD", "custom designs on products", "merch", or implies selling items like t-shirts, mugs, posters with custom graphics, or a store themed around a concept (e.g., "Spiderman store", "cat lovers store") where designs are applied to standard products.
    2.  If the prompt requests specific products that are typically print-on-demand (e.g., "I want to sell t-shirts and hoodies with my art", "custom phone cases").
    3.  If the prompt describes a theme (e.g., "a store for coffee lovers", "a store about space exploration") but doesn't specify products, AND the niche is NOT typically print-on-demand (e.g., food, high-end jewelry, complex electronics, furniture). In this case, a POD strategy might be appropriate to offer themed merchandise.
    4.  If the prompt requests products that are clearly NOT print-on-demand (e.g., "gourmet chocolates", "handmade silver necklaces", "custom-built drones", "artisanal wooden tables"), or if the niche itself strongly indicates non-POD products (e.g., "Restaurant", "Tech Repair Service").
    5.  If the prompt is very generic or doesn't give enough information to lean towards POD.

    Based on your analysis, return a JSON object with the following structure:
    {
      "isPod": boolean, // True if the store is likely print-on-demand focused or should use POD products.
      "podConfidence": number, // Confidence score (0.0 to 1.0) for isPod.
      "theme": "string", // A concise theme extracted from the prompt (e.g., "Vintage Cars", "Abstract Art", "Funny Quotes", "Spiderman"). If no clear theme, use "General".
      "requestedProductTypes": ["string"], // Array of specific product names mentioned in the prompt that match or are very similar to the available POD base product types. (e.g., ["Shirt", "Mug"]). Empty if none.
      "suggestedPodProducts": ["string"], // If isPod is true and requestedProductTypes is empty, suggest 3-5 relevant POD base product types from the available list based on the theme/niche. (e.g., ["Shirt", "Mug", "Poster"]). Empty otherwise.
      "generationStrategy": "string" // One of: "standard", "pod_theme_visualization", "pod_specific_products", "error"
    }

    Strategy decision logic:
    -   If "isPod" is true AND "requestedProductTypes" has items: "generationStrategy" should be "pod_specific_products".
    -   If "isPod" is true AND "requestedProductTypes" is empty (implying a themed POD store but no specific products mentioned by user): "generationStrategy" should be "pod_theme_visualization". Use "suggestedPodProducts" for this.
    -   If "isPod" is false: "generationStrategy" should be "standard".
    -   If the niche is something like food, complex tech, high-end jewelry, furniture, and the prompt doesn't strongly push for POD merch, lean towards "standard" even if a theme is mentioned. For example, a "Spiderman themed restaurant" is still "standard" for food products. A "Spiderman store" (general merch) is "pod_theme_visualization".

    Example 1 (Specific POD products):
    User Prompt: "I want to create a store selling t-shirts and coffee mugs with cool dog designs."
    Product Niche: "Fashion & Apparel"
    Expected Output: { "isPod": true, "podConfidence": 0.9, "theme": "Cool Dog Designs", "requestedProductTypes": ["Shirt", "Mug"], "suggestedPodProducts": [], "generationStrategy": "pod_specific_products" }

    Example 2 (Themed POD store, no specific products):
    User Prompt: "A store for fans of classic horror movies, with iconic imagery."
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": true, "podConfidence": 0.8, "theme": "Classic Horror Movies", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug", "Canvas"], "generationStrategy": "pod_theme_visualization" }

    Example 3 (Standard store, non-POD niche):
    User Prompt: "Selling delicious artisanal cookies and pastries."
    Product Niche: "Food & Beverage"
    Expected Output: { "isPod": false, "podConfidence": 0.1, "theme": "Artisanal Cookies and Pastries", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 4 (Themed store, but niche is non-POD, so standard products for niche, POD for merch):
    User Prompt: "A high-tech gadget store with a cyberpunk theme."
    Product Niche: "Electronics & Gadgets"
    Expected Output: { "isPod": false, "podConfidence": 0.3, "theme": "Cyberpunk", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }
    (Note: The task description implies if niche is non-POD but theme is present, we *should* call POD flow. Let's adjust this example's expectation for the AI)
    Revised Example 4 (Themed store, niche non-POD, but POD for merch is desired):
    User Prompt: "A high-tech gadget store with a cyberpunk theme. I want some cool merch too."
    Product Niche: "Electronics & Gadgets"
    Expected Output: { "isPod": true, "podConfidence": 0.7, "theme": "Cyberpunk", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug"], "generationStrategy": "pod_theme_visualization" }


    Example 5 (Unique products, not POD):
    User Prompt: "I craft unique, handmade wooden sculptures."
    Product Niche: "Art & Collectibles"
    Expected Output: { "isPod": false, "podConfidence": 0.05, "theme": "Handmade Wooden Sculptures", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 6 (Generic prompt, default to standard):
    User Prompt: "My new online shop"
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": false, "podConfidence": 0.2, "theme": "General", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 7 (Store theme implies POD, niche is general):
    User Prompt: "A store for all things Spiderman!"
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": true, "podConfidence": 0.9, "theme": "Spiderman", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug", "Hat", "Canvas"], "generationStrategy": "pod_theme_visualization" }

    Ensure the "theme" is concise. If "requestedProductTypes" are found, "suggestedPodProducts" should usually be empty. If "isPod" is true and "requestedProductTypes" is empty, "suggestedPodProducts" MUST be populated with 3-5 relevant items from the available POD list.
    The entire response MUST be a single JSON object.
  `;try{const d=(await r.generateContent(o)).response.text();let h;const f=d.match(/```json\s*([\s\S]*?)\s*```/);if(f&&f[1])h=JSON.parse(f[1]);else{const m=d.indexOf("{"),g=d.lastIndexOf("}");if(m!==-1&&g>m)h=JSON.parse(d.substring(m,g+1));else throw new Error("No JSON object found in response.")}return h.isPod&&(!h.requestedProductTypes||h.requestedProductTypes.length===0)&&(!h.suggestedPodProducts||h.suggestedPodProducts.length===0)&&(h.suggestedPodProducts=F1e.slice(0,Math.floor(Math.random()*3)+3),console.warn(`[geminiPromptAnalysis] POD strategy indicated but no specific or suggested POD products returned by AI. Defaulting suggestions: ${h.suggestedPodProducts.join(", ")}`)),h.strategy||(h.isPod&&h.requestedProductTypes&&h.requestedProductTypes.length>0?h.strategy="pod_specific_products":h.isPod?h.strategy="pod_theme_visualization":h.strategy="standard"),console.log("[geminiPromptAnalysis] Analysis result:",h),h}catch(c){return console.error("[geminiPromptAnalysis] Error analyzing store prompt:",c),{error:c.message,strategy:"error",theme:"General",requestedProductTypes:[],isPod:!1,podConfidence:0,suggestedPodProducts:[]}}}const $1e=NI("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function fg({className:t,variant:e,...n}){return a.jsx("div",{className:bt($1e({variant:e}),t),...n})}var o_="Checkbox",[V1e,YRe]=bi(o_),[U1e,WA]=V1e(o_);function B1e(t){const{__scopeCheckbox:e,checked:n,children:r,defaultChecked:s,disabled:i,form:o,name:l,onCheckedChange:c,required:u,value:d="on",internal_do_not_use_render:h}=t,[f,m]=Oc({prop:n,defaultProp:s??!1,onChange:c,caller:o_}),[g,x]=p.useState(null),[v,w]=p.useState(null),_=p.useRef(!1),C=g?!!o||!!g.closest("form"):!0,T={checked:f,disabled:i,setChecked:m,control:g,setControl:x,name:l,form:o,value:d,hasConsumerStoppedPropagationRef:_,required:u,defaultChecked:xc(s)?!1:s,isFormControl:C,bubbleInput:v,setBubbleInput:w};return a.jsx(U1e,{scope:e,...T,children:z1e(h)?h(T):r})}var NH="CheckboxTrigger",PH=p.forwardRef(({__scopeCheckbox:t,onKeyDown:e,onClick:n,...r},s)=>{const{control:i,value:o,disabled:l,checked:c,required:u,setControl:d,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:m,bubbleInput:g}=WA(NH,t),x=yn(s,d),v=p.useRef(c);return p.useEffect(()=>{const w=i==null?void 0:i.form;if(w){const _=()=>h(v.current);return w.addEventListener("reset",_),()=>w.removeEventListener("reset",_)}},[i,h]),a.jsx(Yt.button,{type:"button",role:"checkbox","aria-checked":xc(c)?"mixed":c,"aria-required":u,"data-state":DH(c),"data-disabled":l?"":void 0,disabled:l,value:o,...r,ref:x,onKeyDown:gt(e,w=>{w.key==="Enter"&&w.preventDefault()}),onClick:gt(n,w=>{h(_=>xc(_)?!0:!_),g&&m&&(f.current=w.isPropagationStopped(),f.current||w.stopPropagation())})})});PH.displayName=NH;var HA=p.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c,onCheckedChange:u,form:d,...h}=t;return a.jsx(B1e,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:l,required:o,onCheckedChange:u,name:r,form:d,value:c,internal_do_not_use_render:({isFormControl:f})=>a.jsxs(a.Fragment,{children:[a.jsx(PH,{...h,ref:e,__scopeCheckbox:n}),f&&a.jsx(RH,{__scopeCheckbox:n})]})})});HA.displayName=o_;var AH="CheckboxIndicator",kH=p.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...s}=t,i=WA(AH,n);return a.jsx(vs,{present:r||xc(i.checked)||i.checked===!0,children:a.jsx(Yt.span,{"data-state":DH(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...t.style}})})});kH.displayName=AH;var jH="CheckboxBubbleInput",RH=p.forwardRef(({__scopeCheckbox:t,...e},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:o,required:l,disabled:c,name:u,value:d,form:h,bubbleInput:f,setBubbleInput:m}=WA(jH,t),g=yn(n,m),x=j7(i),v=kA(r);p.useEffect(()=>{const _=f;if(!_)return;const C=window.HTMLInputElement.prototype,j=Object.getOwnPropertyDescriptor(C,"checked").set,A=!s.current;if(x!==i&&j){const E=new Event("click",{bubbles:A});_.indeterminate=xc(i),j.call(_,xc(i)?!1:i),_.dispatchEvent(E)}},[f,x,i,s]);const w=p.useRef(xc(i)?!1:i);return a.jsx(Yt.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??w.current,required:l,disabled:c,name:u,value:d,form:h,...e,tabIndex:-1,ref:g,style:{...e.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});RH.displayName=jH;function z1e(t){return typeof t=="function"}function xc(t){return t==="indeterminate"}function DH(t){return xc(t)?"indeterminate":t?"checked":"unchecked"}const MH=p.forwardRef(({className:t,...e},n)=>a.jsx(HA,{ref:n,className:bt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:a.jsx(kH,{className:bt("flex items-center justify-center text-current"),children:a.jsx(Eg,{className:"h-4 w-4"})})}));MH.displayName=HA.displayName;const G1e=({isOpen:t,onClose:e,collection:n,allProducts:r,onSave:s})=>{const[i,o]=p.useState([]),[l,c]=p.useState("");if(p.useEffect(()=>{n&&n.product_ids?o(n.product_ids):o([])},[n]),!n)return null;const u=h=>{o(f=>f.includes(h)?f.filter(m=>m!==h):[...f,h])},d=()=>{s(n.id??n.name,i),e()};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs(Vr,{className:"sm:max-w-[525px]",children:[a.jsxs(Ur,{children:[a.jsxs(Br,{children:['Manage Products for "',n.name||"Unnamed Collection",'"']}),a.jsx(Qi,{children:"Select or unselect products to include in this collection. Use the search bar to filter products."})]}),a.jsxs("div",{className:"py-4",children:[a.jsx(Je,{type:"text",placeholder:"Search products...",value:l,onChange:h=>c(h.target.value),className:"mb-4"}),r&&r.length>0?a.jsxs(Fs,{className:"h-[250px] pr-4",children:[" ",a.jsx("div",{className:"space-y-3",children:r.filter(h=>h.name.toLowerCase().includes(l.toLowerCase())).map(h=>a.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-md hover:bg-muted/50 transition-colors",children:[a.jsx(MH,{id:`product-${n.id??n.name}-${h.id??h.name}`,checked:i.includes(h.id??h.name),onCheckedChange:()=>u(h.id??h.name)}),a.jsx(je,{htmlFor:`product-${n.id??n.name}-${h.id??h.name}`,className:"flex-1 cursor-pointer",children:a.jsxs("div",{className:"flex items-center gap-3",children:[h.images&&h.images.length>0?a.jsx("img",{src:h.images[0],alt:h.name,className:"w-12 h-12 object-cover rounded-sm"}):a.jsx("div",{className:"w-12 h-12 bg-muted rounded-sm flex items-center justify-center text-xs text-muted-foreground",children:"No Img"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:h.name||"Untitled Product"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",h.price||"0.00"]})]})]})})]},h.id??h.name))})]}):a.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No products available to add to this collection. Please add products to your store first."})]}),a.jsxs(Ar,{children:[a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",children:"Cancel"})}),a.jsx(O,{type:"button",onClick:d,disabled:!r||r.length===0,children:"Save Changes"})]})]})})},W1e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),H1e=({isOpen:t,onClose:e,product:n,onSave:r,onGenerateMainImage:s,onGenerateMoreAngles:i,productIndexInWizard:o,isGeneratingProductImage:l,isGeneratingAngles:c})=>{const[u,d]=p.useState(null),{toast:h}=as();p.useEffect(()=>{if(n){const N=n.variants?n.variants.map(D=>({...D,values:Array.isArray(D.values)?[...D.values]:typeof D.values=="string"?D.values.split(",").map(M=>M.trim()).filter(M=>M):[]})):[],k=Array.isArray(n.images)?[...n.images]:[],R={...n,variants:N,images:k};k.length===0&&n.imageUrl&&(R.images=[n.imageUrl]),d(R)}else d(null)},[n,t]);const f=N=>{const{name:k,value:R,type:D}=N.target;d(M=>({...M,[k]:D==="number"?parseFloat(R)||0:R}))},m=N=>{d(k=>({...k,images:N}))},g=async N=>{if(N.target.files&&N.target.files.length>0){const R=Array.from(N.target.files).map(D=>W1e(D));try{const D=await Promise.all(R);m([...u.images||[],...D])}catch{h({title:"Image Upload Error",description:"Could not process some images.",variant:"destructive"})}}},x=N=>{m((u.images||[]).filter((k,R)=>R!==N))},v=async()=>{s&&o!==null&&u&&await s(o,u)},w=async()=>{i&&o!==null&&u&&u.images&&u.images.length>0?await i(o,u):h({title:"Cannot Generate Angles",description:"A main image is required first.",variant:"warning"})},_=(N,k,R)=>{d(D=>{const M=[...D.variants||[]];return M[N]={...M[N],[k]:R},{...D,variants:M}})},C=(N,k,R)=>{d(D=>{const M=[...D.variants||[]],z=[...M[N].values];return z[k]=R,M[N]={...M[N],values:z},{...D,variants:M}})},T=N=>{d(k=>{const R=[...k.variants||[]],D=[...R[N].values,""];return R[N]={...R[N],values:D},{...k,variants:R}})},j=(N,k)=>{d(R=>{const D=[...R.variants||[]],M=D[N].values.filter((z,B)=>B!==k);return D[N]={...D[N],values:M},M.length===0&&h({title:"Info",description:`Variant option "${D[N].name}" has no values.`,variant:"default"}),{...R,variants:D}})},A=()=>{d(N=>({...N,variants:[...N.variants||[],{name:"",values:[""]}]}))},E=N=>{d(k=>({...k,variants:(k.variants||[]).filter((R,D)=>D!==N)}))},I=()=>{if(!u.name||u.name.trim()===""){h({title:"Validation Error",description:"Product name cannot be empty.",variant:"destructive"});return}if(u.price===void 0||u.price===null||isNaN(parseFloat(u.price))||parseFloat(u.price)<0){h({title:"Validation Error",description:"Product price must be a valid non-negative number.",variant:"destructive"});return}const N=u.variants?u.variants.map(k=>({...k,name:k.name.trim(),values:k.values.map(R=>R.trim()).filter(R=>R!=="")})).filter(k=>k.name!==""&&k.values.length>0):[];r({...u,variants:N}),e()};return!t||!u?null:a.jsx(Yr,{open:t,onOpenChange:N=>{N||e()},children:a.jsxs(Vr,{className:"sm:max-w-2xl",children:[a.jsxs(Ur,{children:[a.jsx(Br,{children:"Edit AI Generated Product"}),a.jsx(Qi,{children:"Modify the details of the generated product below."})]}),a.jsx(Fs,{className:"max-h-[70vh] p-1 pr-3",children:a.jsxs("div",{className:"space-y-4 py-4 pr-2",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"name",children:"Product Name"}),a.jsx(Je,{id:"name",name:"name",value:u.name||"",onChange:f})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"price",children:"Price (USD)"}),a.jsx(Je,{id:"price",name:"price",type:"number",value:u.price||0,onChange:f})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"description",children:"Description"}),a.jsx(En,{id:"description",name:"description",value:u.description||"",onChange:f,rows:4})]}),a.jsxs("div",{className:"space-y-2 border p-3 rounded-md",children:[a.jsx(je,{className:"text-md font-semibold",children:"Product Images"}),u.images&&u.images.length>0?a.jsx("div",{className:"overflow-x-auto py-2",children:a.jsx("div",{className:"flex flex-row gap-2 mb-2 min-w-max",children:u.images.map((N,k)=>a.jsxs("div",{className:"relative group flex-shrink-0",children:[a.jsx("img",{src:N,alt:`Product image ${k+1}`,className:"w-24 h-24 object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>x(k),children:a.jsx(Fn,{className:"h-3.5 w-3.5"})})]},`${N}-${k}`))})}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No images yet."}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>document.getElementById("editAiProductImageUpload").click(),children:[a.jsx(Lo,{className:"mr-2 h-4 w-4"})," Upload Images"]}),a.jsx(Je,{id:"editAiProductImageUpload",type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:g}),a.jsxs(O,{variant:"outline",size:"sm",onClick:v,disabled:l||!u.name,children:[l?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),u.images&&u.images.length>0?"Regenerate Main":"Generate Main"]}),u.images&&u.images.length>0&&a.jsxs(O,{variant:"outline",size:"sm",onClick:w,disabled:c,children:[c?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"More Angles"]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-md font-semibold",children:"Variants"}),(u.variants||[]).map((N,k)=>a.jsxs(Qe,{className:"p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(je,{htmlFor:`variantName-${k}`,children:"Option Name"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>E(k),className:"h-7 w-7",children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})})]}),a.jsx(Je,{id:`variantName-${k}`,value:N.name||"",onChange:R=>_(k,"name",R.target.value),placeholder:"e.g., Color, Size"}),a.jsx(je,{children:"Option Values"}),N.values.map((R,D)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Je,{value:R||"",onChange:M=>C(k,D,M.target.value),placeholder:"e.g., Red, Large"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>j(k,D),className:"h-7 w-7",children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})})]},D)),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>T(k),children:[a.jsx(Fi,{className:"mr-2 h-4 w-4"})," Add Value"]})]},k)),a.jsxs(O,{variant:"outline",onClick:A,className:"w-full",children:[a.jsx(Fi,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]})}),a.jsxs(Ar,{children:[a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel"})}),a.jsx(O,{type:"button",onClick:I,children:"Save Changes"})]})]})})},Vd=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),nF=(t,e)=>{const{formData:n,setFormData:r,handleInputChange:s,handleProductTypeChange:i,handleProductSourceChange:o,handleProductCountChange:l,handleManualProductChange:c,addManualProduct:u,removeManualProduct:d,suggestStoreName:h,generateLogo:f,generateAiProducts:m,generateAiCollections:g,handleGenerateManualProductImage:x,handleGenerateMoreAngles:v,isProcessing:w,isGeneratingProductImageForIndex:_,productImageGenerationError:C,isGeneratingAnglesForIndex:T,angleGenerationError:j,storeNameSuggestions:A,handleSuggestionClick:E,suggestionError:I,handleInitialImportMethodChange:N,handleProductPhotoUpload:k,uploadedProductPhotos:R,removeUploadedProductPhoto:D,isProcessingPhotos:M,handleGenerateCollectionImage:z,isGeneratingCollectionImageForIndex:B,collectionImageGenerationError:G,isCheckingStoreName:Y,storeNameAvailability:H,handleManualStoreNameCheck:K}=e,[$,V]=p.useState(""),[W,F]=p.useState(""),[Z,ce]=p.useState(null),[le,he]=p.useState(null),[Le,Ve]=p.useState(""),[Be,ue]=p.useState(""),[Ce,Ie]=p.useState([]),[ve,ie]=p.useState([]);p.useState(null);const[Me,He]=p.useState([]),[yt,kt]=p.useState(!1),[en,mn]=p.useState(!1),[cn,fn]=p.useState(""),{toast:Ue}=as(),[Et,de]=p.useState(!1),[De,ee]=p.useState(null),[ae,X]=p.useState(null),Pe=(Q,te,me)=>{r(q=>{const ne=[...q.products.items],be={...ne[Q]};return be.variants=[...be.variants||[]],be.variants[te]={...be.variants[te],name:me},ne[Q]=be,{...q,products:{...q.products,items:ne}}})},Ae=(Q,te,me,q)=>{r(ne=>{const be=[...ne.products.items],Ne={...be[Q]};Ne.variants=[...Ne.variants||[]];const Ge={...Ne.variants[te]};return Ge.values=[...Ge.values||[]],Ge.values[me]=q,Ne.variants[te]=Ge,be[Q]=Ne,{...ne,products:{...ne.products,items:be}}})},$e=(Q,te)=>{r(me=>{const q=[...me.products.items],ne={...q[Q]};ne.variants=[...ne.variants||[]];const be={...ne.variants[te]};return be.values=[...be.values||[],""],ne.variants[te]=be,q[Q]=ne,{...me,products:{...me.products,items:q}}})},qe=(Q,te,me)=>{r(q=>{const ne=[...q.products.items],be={...ne[Q]};be.variants=[...be.variants||[]];const Ne={...be.variants[te]};return Ne.values=(Ne.values||[]).filter((Ge,Se)=>Se!==me),be.variants[te]=Ne,Ne.values.length===0&&Ue({title:"Info",description:`Variant option "${Ne.name}" has no values. Consider removing the option or adding values.`,variant:"default"}),ne[Q]=be,{...q,products:{...q.products,items:ne}}})},oe=Q=>{r(te=>{const me=[...te.products.items],q={...me[Q]};return q.variants=[...q.variants||[],{name:"",values:[""]}],me[Q]=q,{...te,products:{...te.products,items:me}}})},_e=(Q,te)=>{r(me=>{const q=[...me.products.items],ne={...q[Q]};return ne.variants=(ne.variants||[]).filter((be,Ne)=>Ne!==te),q[Q]=ne,{...me,products:{...me.products,items:q}}})},ze=async Q=>{const te=Q.target.files[0];if(te){fn(""),ce(te);try{const me=await Vd(te);F(me),V(""),Ue({title:"Image Uploaded",description:"Your image is ready for visualization."})}catch(me){console.error("Error converting uploaded file to base64:",me),fn("Failed to load uploaded image. Please try again."),Ue({variant:"destructive",title:"Upload Failed",description:"Could not process the uploaded image."}),F(""),ce(null)}}},Te=()=>{F(""),ce(null),V(""),fn("");const Q=document.getElementById("podImageUpload");Q&&(Q.value="")},Tt=async Q=>{const te=Q.target.files[0];if(te){fn(""),he(te);try{const me=await Vd(te);Ve(me),Ue({title:"Reference Image Added",description:"This image will be used with your prompt for generation."})}catch(me){console.error("Error converting reference file to base64:",me),fn("Failed to load reference image. Please try again."),Ue({variant:"destructive",title:"Reference Image Load Failed",description:"Could not process the reference image."}),Ve(""),he(null)}}},wt=()=>{Ve(""),he(null),fn("");const Q=document.getElementById("podReferenceImageUpload");Q&&(Q.value="")},xt=async()=>{if(!$){Ue({title:"Missing Prompt",description:"Please enter a prompt for image generation.",variant:"destructive"});return}if(Z){Ue({title:"Image Already Uploaded",description:"An image has already been uploaded. Clear it if you want to generate a new one.",variant:"warning"});return}kt(!0),fn(""),F("");let Q={prompt:$};if(le&&Le){const[te,me]=Le.split(","),q=te.match(/:(.*?);/)[1];Q.referenceImage={base64Data:me,mimeType:q,fileName:le.name},console.log("Attempting to generate POD image preview with prompt and reference image:",$,le.name)}else console.log("Attempting to generate POD image preview for prompt:",$);try{const te=await Ng(Q);if(te.imageData&&te.imageMimeType){const me=`data:${te.imageMimeType};base64,${te.imageData}`;F(me),console.log("POD Image preview generated successfully.")}else throw new Error(te.textResponse||"Image data not returned from API.")}catch(te){console.error("Error generating POD image preview:",te);const me=te.message||"Failed to generate image preview.";fn(me),Ue({variant:"destructive",title:"Image Generation Failed",description:me})}finally{kt(!1)}},pt=Q=>{const te=Q.target.value;ue(te),Ie(te?eo.filter(me=>me.name.toLowerCase().includes(te.toLowerCase())):[])},Pt=Q=>{ie(te=>te.some(q=>q.name===Q.name)?te.filter(q=>q.name!==Q.name):[...te,Q])},Rn=async()=>{if(!W||ve.length===0){Ue({title:"Missing Selections",description:"Please provide an image (generate or upload) and select at least one product type to visualize.",variant:"destructive"});return}let Q;if(Z&&Z.name?Q=`Uploaded: ${Z.name}`:$?Q=$:Q="Custom design",!Z&&!$){Ue({title:"Missing Prompt",description:"If not uploading an image, please enter a prompt to generate an image first.",variant:"destructive"});return}mn(!0),fn(""),He([]);const[te,me]=W.split(","),q=te.match(/:(.*?);/)[1];let ne=!0;const be=[];for(const Ne of ve)try{console.log("Attempting to visualize POD product:",Ne.name);const Ge=await Vp(me,q,Ne.imageUrl,Q,Ne.name);if(Ge.visualizedImageData&&Ge.productDetails){const Se=`data:${Ge.visualizedImageMimeType};base64,${Ge.visualizedImageData}`;be.push({title:Ge.productDetails.title,price:parseFloat(Ge.productDetails.price).toFixed(2),description:Ge.productDetails.description,finalImageUrl:Se,baseProductName:Ne.name,generatedImagePrompt:Q,baseProductImageUrl:Ne.imageUrl,sourceImageUsedForVisualization:W,tempId:`${Ne.name}-${Date.now()}`}),console.log("POD Product visualized successfully:",Ne.name)}else ne=!1,console.error("Visualization failed for product:",Ne.name,Ge),fn(Se=>Se+`Visualization failed for ${Ne.name}. `)}catch(Ge){ne=!1,console.error("Error visualizing POD product:",Ne.name,Ge);const Se=Ge.message||`Failed to visualize ${Ne.name}.`;fn(ot=>ot+Se+" ")}He(be),ne?be.length>0&&Ue({title:"Visualization Complete",description:`${be.length} product(s) visualized. You can now add them to your store.`}):Ue({variant:"destructive",title:"Some Visualizations Failed",description:"Check errors below. Some products may not have visualized correctly."}),mn(!1)},Sn=Q=>{if(!Q)return;const te={name:Q.title,price:Q.price,description:Q.description,imageUrl:Q.finalImageUrl,isPrintOnDemand:!0,podDetails:{...Q}};delete te.podDetails.tempId,r(me=>({...me,products:{...me.products,items:[...me.products.items,te]}})),He(me=>me.filter(q=>q.tempId!==Q.tempId)),Me.length===1&&Me[0].tempId===Q.tempId&&(ie([]),ue("")),Ue({title:"Product Added",description:`"${te.name}" added to your store's products.`})},cr=Q=>{r(te=>({...te,products:{...te.products,items:te.products.items.filter((me,q)=>q!==Q)}})),Ue({title:"Product Removed",description:"The Print on Demand product has been removed from your list.",variant:"destructive"})},[sn,$t]=p.useState(!1),[tn,Zn]=p.useState(null),J=(Q,te,me)=>{r(q=>{const ne=[...q.collections.items];return ne[Q][te]=me,{...q,collections:{...q.collections,items:ne}}})},re=()=>{r(Q=>({...Q,collections:{...Q.collections,items:[...Q.collections.items,{name:"",description:"",imageUrl:""}]}}))},ge=Q=>{r(te=>{const me=te.collections.items.filter((q,ne)=>ne!==Q);return{...te,collections:{...te.collections,items:me}}})},Oe=Q=>{Zn(Q),$t(!0)},tt=(Q,te)=>{r(me=>{const q=me.collections.items.map(ne=>ne.id&&ne.id===Q||ne.name===Q?{...ne,product_ids:te}:ne);return{...me,collections:{...me.collections,items:q}}}),$t(!1),Zn(null)};switch(t){case 1:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"initialImportMethod",className:"text-lg font-semibold",children:"How would you like to start?"}),a.jsxs(gc,{onValueChange:N,value:n.initialImportMethod||"productType",children:[a.jsx(Qa,{id:"initialImportMethod",className:"mt-2",children:a.jsx(yc,{placeholder:"Choose starting method..."})}),a.jsxs(Xa,{children:[a.jsx(Qn,{value:"productType",children:"Describe Product Type"}),a.jsx(Qn,{value:"photos",children:"Start from Product Photos"})]})]})]}),n.initialImportMethod==="productType"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(je,{htmlFor:"productType",className:"text-md font-medium",children:"What kind of products will your store sell?"}),a.jsx(Je,{id:"productType",name:"productType",value:n.productType,onChange:Q=>i(Q.target.value),placeholder:"e.g., Fashion, Electronics, Home Decor",list:"productTypeSuggestions"}),a.jsx("datalist",{id:"productTypeSuggestions",children:Yw.map(Q=>a.jsx("option",{value:Q.label},Q.value))}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This helps us tailor product suggestions and store design. Type to see suggestions."})]}),n.initialImportMethod==="photos"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(je,{htmlFor:"productPhotosUpload",className:"text-md font-medium",children:"Upload Product Photos"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload multiple photos of your products. We'll use AI to understand them and pre-fill store details."}),a.jsx(Je,{id:"productPhotosUpload",type:"file",multiple:!0,accept:"image/*",onChange:k,className:`block w-full text-sm text-slate-500
                  file:mr-4 file:py-2 file:px-4
                  file:rounded-full file:border-0
                  file:text-sm file:font-semibold
                  file:bg-primary/10 file:text-primary
                  hover:file:bg-primary/20`,disabled:M}),M&&a.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing uploaded photos..."]}),R&&R.length>0&&a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Uploaded Photos (",R.length,"):"]}),a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3",children:R.map((Q,te)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:Q.previewUrl||Q,alt:`Uploaded product ${te+1}`,className:"w-full aspect-square object-cover rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:()=>D(te),disabled:M,children:a.jsx(Fn,{className:"h-3.5 w-3.5"})})]},te))})]})]})]},"step1");case 2:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-4 w-full",children:[a.jsx(je,{htmlFor:"storeName",className:"text-lg font-semibold",children:"What's your store name?"}),a.jsxs("div",{className:"relative flex items-center gap-2",children:[a.jsx(Je,{id:"storeName",name:"storeName",value:n.storeName,onChange:s,placeholder:"e.g., 'The Cozy Corner Bookstore'",className:"flex-grow pr-20"}),a.jsxs(O,{type:"button",variant:"ghost",size:"sm",onClick:K,disabled:!n.storeName||Y,className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 px-2 z-10",children:[Y?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(ha,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-1 hidden sm:inline",children:"Check"})]})]}),a.jsxs(O,{type:"button",variant:"outline",onClick:h,disabled:w||Y||!n.productType,className:"w-full mt-2 sm:w-auto sm:mt-0",children:[w&&!Y?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(Er,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2",children:"Suggest Names"})]}),a.jsxs("div",{className:"h-5 mt-1",children:[" ",Y&&n.storeName&&a.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[a.jsx(ft,{className:"h-4 w-4 animate-spin mr-2"})," Checking..."]}),H&&n.storeName&&!Y&&a.jsxs("p",{className:`text-sm font-medium ${H.status==="available"?"text-green-600":H.status==="claimed"?"text-red-600":H.status==="error"?"text-yellow-600":"text-muted-foreground"}`,children:[H.message==="Available"?a.jsx(ha,{className:"inline h-4 w-4 mr-1"}):"",H.message]})]}),!n.storeName&&!Y&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:'Choose a catchy name or let us suggest one. Click "Check" to verify availability.'}),I&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:I}),A&&A.length>0&&a.jsxs("div",{className:"mt-3 space-y-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:A.map((Q,te)=>a.jsx(O,{variant:"outline",size:"sm",onClick:()=>E(Q),className:"bg-primary-foreground dark:bg-neutral-800 hover:bg-primary/10 dark:hover:bg-neutral-700",children:Q},te))})]})]},"step2");case 3:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(je,{className:"text-lg font-semibold",children:"Design a logo for your store"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center p-4 border rounded-md",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(je,{className:"text-sm mb-2",children:"For Light Backgrounds"}),n.logoUrlDark?a.jsx("img",{src:n.logoUrlDark,alt:"Logo for light backgrounds",className:"w-48 h-48 object-contain rounded-md border bg-white"}):a.jsx("div",{className:"w-48 h-48 bg-gray-100 rounded-md flex items-center justify-center text-muted-foreground",children:"Light Bg Preview"})]}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(je,{className:"text-sm mb-2",children:"For Dark Backgrounds"}),n.logoUrlLight?a.jsx("img",{src:n.logoUrlLight,alt:"Logo for dark backgrounds",className:"w-48 h-48 object-contain rounded-md border bg-gray-800"}):a.jsx("div",{className:"w-48 h-48 bg-gray-700 rounded-md flex items-center justify-center text-gray-400",children:"Dark Bg Preview"})]})]}),a.jsxs(O,{type:"button",onClick:f,disabled:w||!n.storeName,className:"w-full",children:[w?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(va,{className:"mr-2 h-4 w-4"}),"Generate Logo with AI (Light & Dark Versions)"]}),a.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"AI will generate a logo, remove its background, and attempt to create light/dark mode versions."}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(je,{className:"text-sm",children:"Manually set logos (optional):"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"logoUrlDarkUpload",className:"text-xs",children:"Logo for Light Background (e.g., black logo)"}),a.jsx(Je,{id:"logoUrlDarkUpload",type:"file",accept:"image/*",className:"mt-1 text-xs",onChange:async Q=>{if(Q.target.files&&Q.target.files[0]){const te=Q.target.files[0];try{const me=await Vd(te);r(q=>({...q,logoUrlDark:me}))}catch(me){console.error("Error converting file for logoUrlDark:",me)}}}})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"logoUrlLightUpload",className:"text-xs",children:"Logo for Dark Background (e.g., white logo)"}),a.jsx(Je,{id:"logoUrlLightUpload",type:"file",accept:"image/*",className:"mt-1 text-xs",onChange:async Q=>{if(Q.target.files&&Q.target.files[0]){const te=Q.target.files[0];try{const me=await Vd(te);r(q=>({...q,logoUrlLight:me}))}catch(me){console.error("Error converting file for logoUrlLight:",me)}}}})]})]})]}),(n.logoUrlLight||n.logoUrlDark)&&a.jsxs(O,{variant:"destructive",size:"sm",onClick:()=>r(Q=>({...Q,logoUrlLight:"",logoUrlDark:""})),className:"mt-4 w-full",children:[a.jsx(Fn,{className:"mr-2 h-4 w-4"})," Remove All Logos"]})]},"step3");case 4:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(je,{className:"text-lg font-semibold",children:"How do you want to add products?"}),a.jsxs(gc,{onValueChange:o,value:n.products.source,children:[a.jsx(Qa,{children:a.jsx(yc,{placeholder:"Choose product source..."})}),a.jsxs(Xa,{children:[a.jsx(Qn,{value:"ai",children:"Generate with AI"}),a.jsx(Qn,{value:"manual",children:"Add Manually"}),a.jsx(Qn,{value:"printOnDemand",children:"Print on Demand"}),a.jsx(Qn,{value:"csv",disabled:!0,children:"Upload CSV (Coming Soon)"})]})]}),n.products.source==="ai"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"productCount",children:"Number of AI Products to Generate"}),a.jsx(Je,{id:"productCount",type:"number",min:"1",max:"5",value:n.products.count,onChange:l})]}),a.jsxs(O,{type:"button",onClick:m,disabled:w||!n.productType||!n.storeName,className:"w-full",children:[w?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Products with AI"]}),I&&n.products.source==="ai"&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:I}),n.products.items.length>0&&a.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2 mt-4",children:[" ",a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Generated Products:"}),n.products.items.map((Q,te)=>a.jsxs(Qe,{className:"p-4 flex gap-4 items-start relative",children:[Q.images&&Q.images.length>0?a.jsx("img",{src:Q.images[0],alt:Q.name,className:"w-24 h-24 object-cover rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-md",children:Q.name||"Untitled Product"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["$",Q.price||"0.00"]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:Q.description||"No description."}),Q.variants&&Q.variants.length>0&&a.jsx("div",{className:"mt-1.5",children:Q.variants.map((me,q)=>a.jsxs("div",{className:"text-xs",children:[a.jsxs("span",{className:"font-medium text-muted-foreground",children:[me.name,": "]}),a.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:Array.isArray(me.values)?me.values.join(", "):me.values})]},q))})]}),a.jsx(O,{variant:"outline",size:"icon",className:"absolute top-2 right-2 h-8 w-8",onClick:()=>{ee({...Q}),X(te),de(!0)},children:a.jsx(ew,{className:"h-4 w-4"})})]},te))]})]}),Et&&ae!==null&&n.products.items[ae]&&a.jsx(H1e,{isOpen:Et,onClose:()=>{de(!1),X(null)},product:n.products.items[ae],onSave:Q=>{r(te=>{const me=[...te.products.items];return ae!==null&&me[ae]&&(me[ae]=Q),{...te,products:{...te.products,items:me}}}),de(!1),ee(null),X(null),Ue({title:"Product Updated",description:`"${Q.name}" has been updated.`})},onGenerateMainImage:x,onGenerateMoreAngles:v,productIndexInWizard:ae,isGeneratingProductImage:_===ae,isGeneratingAngles:T===ae}),n.products.source==="manual"&&a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[" ",n.products.items.map((Q,te)=>a.jsxs(Qe,{className:"p-4 space-y-3 relative",children:[a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7",onClick:()=>d(te),disabled:n.products.items.length<=1,children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:`productName-${te}`,children:"Product Name"}),a.jsx(Je,{id:`productName-${te}`,value:Q.name,onChange:me=>c(te,"name",me.target.value),placeholder:"e.g., 'Handmade Coffee Mug'"})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:`productPrice-${te}`,children:"Price (USD)"}),a.jsx(Je,{id:`productPrice-${te}`,type:"number",value:Q.price,onChange:me=>c(te,"price",me.target.value),placeholder:"e.g., '24.99'"})]})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:`productDescription-${te}`,children:"Short Description (Optional)"}),a.jsx(En,{id:`productDescription-${te}`,value:Q.description,onChange:me=>c(te,"description",me.target.value),placeholder:"e.g., 'Beautifully crafted ceramic mug, perfect for your morning coffee.'",rows:2})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 border rounded-md",children:[Q.images&&Q.images.length>0?a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:Q.images.map((me,q)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:me,alt:`${Q.name||"Product"} image ${q+1}`,className:"w-20 h-20 object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{const ne=Q.images.filter((be,Ne)=>Ne!==q);c(te,"images",ne)},children:a.jsx(Fn,{className:"h-3 w-3"})})]},q))}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground mb-2",children:"No Images"}),a.jsx(je,{htmlFor:`productImageUpload-${te}`,className:"text-sm sr-only",children:"Upload Product Images"}),a.jsx(Je,{id:`productImageUpload-${te}`,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:async me=>{if(me.target.files&&me.target.files.length>0){const ne=Array.from(me.target.files).map(be=>Vd(be));try{const be=await Promise.all(ne),Ne=[...Q.images||[],...be];c(te,"images",Ne)}catch(be){console.error("Error converting files to base64:",be),Ue({title:"Image Upload Error",description:"Could not process some images.",variant:"destructive"})}}}}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`productImageUpload-${te}`).click(),children:[a.jsx(Lo,{className:"mr-2 h-4 w-4"})," Upload Images"]}),Q.images&&Q.images.length>0&&a.jsxs(O,{variant:"destructive",size:"sm",onClick:()=>c(te,"images",[]),children:[a.jsx(Fn,{className:"mr-2 h-4 w-4"})," Remove All"]}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>x(te),disabled:_===te||!Q.name,children:[_===te?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Main Image"]}),Q.images&&Q.images.length>0&&a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>v(te),disabled:T===te,children:[T===te?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate More Angles"]})]}),C&&_===te&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:C}),j&&T===te&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:j})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(Q.variants||[]).map((me,q)=>a.jsxs(Qe,{className:"p-2 space-y-2 bg-muted/50",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(je,{htmlFor:`manualVariantName-${te}-${q}`,className:"text-xs",children:"Option Name"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>_e(te,q),className:"h-6 w-6",children:a.jsx(Fn,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(Je,{id:`manualVariantName-${te}-${q}`,value:me.name||"",onChange:ne=>Pe(te,q,ne.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(je,{className:"text-xs",children:"Option Values"}),(me.values||[]).map((ne,be)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Je,{value:ne||"",onChange:Ne=>Ae(te,q,be,Ne.target.value),placeholder:"e.g., Red, Large",className:"text-sm h-8"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>qe(te,q,be),className:"h-6 w-6",children:a.jsx(Fn,{className:"h-3 w-3 text-destructive"})})]},be)),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>$e(te,q),className:"text-xs h-7",children:[a.jsx(Fi,{className:"mr-1 h-3 w-3"})," Add Value"]})]},q)),a.jsxs(O,{variant:"outline",onClick:()=>oe(te),className:"w-full text-sm h-8",children:[a.jsx(Fi,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]},te)),a.jsxs(O,{type:"button",variant:"outline",onClick:()=>{u()},className:"w-full",children:[a.jsx(Fi,{className:"mr-2 h-4 w-4"})," Add Another Product"]})]}),n.products.source==="printOnDemand"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-md font-semibold",children:"Configure Print on Demand Product"}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"podImagePrompt",children:"Image Generation Prompt"}),a.jsx(En,{id:"podImagePrompt",placeholder:"e.g., A majestic wolf howling at a vibrant aurora borealis",value:$,onChange:Q=>V(Q.target.value),rows:2}),a.jsxs(O,{type:"button",onClick:xt,disabled:w||yt||!$||!!Z,className:"mt-2",variant:"outline",children:[yt?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Image"]}),a.jsxs(O,{type:"button",variant:"outline",className:"mt-2 ml-2",onClick:()=>document.getElementById("podReferenceImageUpload").click(),disabled:w||yt||!!Z,children:[a.jsx(Lo,{className:"mr-2 h-4 w-4"})," Add Ref. Image"]}),a.jsx(Je,{id:"podReferenceImageUpload",type:"file",accept:"image/*",className:"hidden",onChange:Tt})]}),Le&&a.jsxs("div",{className:"mt-2 flex flex-col items-start text-sm",children:[a.jsx(je,{className:"mb-1",children:"Reference Image:"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:Le,alt:"Reference preview",className:"w-16 h-16 object-contain rounded-md border bg-muted"}),a.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[150px]",children:le==null?void 0:le.name}),a.jsx(O,{type:"button",variant:"ghost",size:"icon",onClick:wt,className:"h-7 w-7",children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})})]})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t",children:[a.jsx(je,{htmlFor:"podImageUpload",children:"Or Upload Final Image for Product"}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(Je,{id:"podImageUpload",type:"file",accept:"image/*",onChange:ze,className:"flex-grow",disabled:yt}),W&&Z&&a.jsx(O,{type:"button",variant:"ghost",size:"icon",onClick:Te,className:"h-9 w-9",children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})})]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"If you upload an image, it will be used instead of the generated one."})]}),cn&&a.jsxs("div",{className:"mt-2 p-2 bg-destructive/10 border border-destructive/50 rounded-md text-destructive text-sm flex items-center gap-2",children:[a.jsx(Cg,{className:"h-5 w-5"}),a.jsx("p",{children:cn})]}),W&&a.jsxs("div",{className:"mt-2 flex flex-col items-center",children:[a.jsx(je,{className:"mb-1",children:"Image Preview:"}),a.jsx("img",{src:W,alt:"Generated preview",className:"w-40 h-40 object-contain rounded-md border bg-muted"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(je,{htmlFor:"podProductSearch",children:"Search Print on Demand Products"}),a.jsx(Je,{id:"podProductSearch",placeholder:"e.g., T-shirt, Mug",value:Be,onChange:pt,disabled:!W}),Ce.length>0&&a.jsx(Qe,{className:"absolute z-10 w-full mt-1 max-h-48 overflow-y-auto border bg-background shadow-lg",children:Ce.map(Q=>{const te=ve.some(me=>me.name===Q.name);return a.jsxs("div",{className:`p-2 hover:bg-muted cursor-pointer flex items-center gap-2 ${te?"bg-primary/10":""}`,onClick:()=>Pt(Q),children:[a.jsx("img",{src:Q.imageUrl,alt:Q.name,className:"w-8 h-8 object-contain rounded-sm"}),a.jsx("span",{children:Q.name}),te&&a.jsx(ha,{className:"h-4 w-4 text-primary ml-auto"})]},Q.name)})})]}),ve.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsx(je,{className:"text-sm mb-1 block",children:"Selected Product Types:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ve.map(Q=>a.jsxs(fg,{variant:"secondary",className:"flex items-center gap-1.5 pr-1",children:[Q.name,a.jsx(O,{variant:"ghost",size:"icon",className:"h-5 w-5 hover:bg-destructive/20",onClick:()=>Pt(Q),children:a.jsx(Hi,{className:"h-3 w-3 text-destructive"})})]},Q.name))})]}),a.jsxs(O,{type:"button",onClick:Rn,disabled:w||en||!W||ve.length===0,className:"w-full mt-2",children:[en?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(va,{className:"mr-2 h-4 w-4"}),`Visualize Design on ${ve.length} Product(s)`]}),Me.length>0&&a.jsxs("div",{className:"mt-4 space-y-3",children:[a.jsx("h4",{className:"font-semibold text-md",children:"Visualized Products:"}),Me.map(Q=>a.jsxs(Qe,{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"flex gap-4 items-start",children:[a.jsx("img",{src:Q.finalImageUrl,alt:Q.title,className:"w-24 h-24 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("p",{className:"font-semibold",children:Q.title}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Base: ",Q.baseProductName]}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Price: $",Q.price]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-3",children:Q.description})]})]}),a.jsxs(O,{type:"button",onClick:()=>Sn(Q),className:"w-full bg-green-600 hover:bg-green-700",disabled:w,children:[a.jsx(Fi,{className:"mr-2 h-4 w-4"}),"Add This Product to Store"]})]},Q.tempId))]}),n.products.items.filter(Q=>Q.isPrintOnDemand).length>0&&a.jsxs("div",{className:"mt-6 space-y-3",children:[a.jsx("p",{className:"text-md font-semibold",children:"Added Print on Demand Products:"}),a.jsxs("div",{className:"max-h-96 overflow-y-auto pr-2 space-y-3",children:[" ",n.products.items.map((Q,te)=>Q.isPrintOnDemand?a.jsxs(Qe,{className:"p-3 flex gap-3 items-start relative",children:[a.jsx("img",{src:Q.imageUrl,alt:Q.name,className:"w-20 h-20 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-sm",children:Q.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",Q.price]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:Q.description})]}),a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-6 w-6",onClick:()=>cr(te),children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})})]},`pod-item-${te}`):null)]})]})]})]},"step4");case 5:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(je,{className:"text-lg font-semibold",children:"How do you want to add collections?"}),a.jsxs(gc,{onValueChange:Q=>r(te=>({...te,collections:{...te.collections,source:Q}})),value:n.collections.source,children:[a.jsx(Qa,{children:a.jsx(yc,{placeholder:"Choose collection source..."})}),a.jsxs(Xa,{children:[a.jsx(Qn,{value:"ai",children:"Generate with AI"}),a.jsx(Qn,{value:"manual",children:"Add Manually"})]})]}),I&&n.collections.source==="ai"&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:I}),G&&n.collections.source==="manual"&&B===null&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:G}),n.collections.source==="ai"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"collectionCount",children:"Number of AI Collections to Generate"}),a.jsx(Je,{id:"collectionCount",type:"number",min:"1",max:"5",value:n.collections.count,onChange:Q=>r(te=>({...te,collections:{...te.collections,count:parseInt(Q.target.value)||1}}))})]}),a.jsxs(O,{type:"button",onClick:g,disabled:w||!n.productType||!n.storeName||n.products.items.length===0,className:"w-full",children:[w?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Collections with AI"]}),n.collections.items.length>0&&a.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2 mt-4",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Generated Collections:"}),n.collections.items.map((Q,te)=>a.jsxs(Qe,{className:"p-4 flex gap-4 items-start",children:[Q.imageUrl?a.jsx("img",{src:Q.imageUrl,alt:Q.name,className:"w-24 h-24 object-cover rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-md",children:Q.name||"Untitled Collection"}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:Q.description||"No description."})]}),a.jsx("div",{className:"flex flex-col gap-1",children:a.jsx(O,{variant:"outline",size:"sm",className:"text-xs h-auto py-1 mt-2",onClick:()=>Oe(Q),children:"Manage Products"})})]},te))]}),tn&&a.jsx(G1e,{isOpen:sn,onClose:()=>{$t(!1),Zn(null)},collection:tn,allProducts:n.products.items,onSave:tt})]}),n.collections.source==="manual"&&a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Your Collections:"}),n.collections.items.map((Q,te)=>a.jsxs(Qe,{className:"p-4 space-y-3 relative",children:[a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7",onClick:()=>ge(te),disabled:n.collections.items.length<=1&&!Q.name&&!Q.description&&!Q.imageUrl,children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.jsxs("div",{children:[a.jsx(je,{htmlFor:`collectionName-${te}`,children:"Collection Name"}),a.jsx(Je,{id:`collectionName-${te}`,value:Q.name,onChange:me=>J(te,"name",me.target.value),placeholder:"e.g., 'Summer Collection'"})]})}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:`collectionDescription-${te}`,children:"Short Description (Optional)"}),a.jsx(En,{id:`collectionDescription-${te}`,value:Q.description,onChange:me=>J(te,"description",me.target.value),placeholder:"e.g., 'A curated selection of products perfect for the summer season.'",rows:2})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 border rounded-md",children:[Q.imageUrl?a.jsx("img",{src:Q.imageUrl,alt:Q.name||"Collection image",className:"w-24 h-24 object-contain rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsx(je,{htmlFor:`collectionImageUpload-${te}`,className:"text-sm sr-only",children:"Upload Collection Image"}),a.jsx(Je,{id:`collectionImageUpload-${te}`,type:"file",accept:"image/*",className:"hidden",onChange:async me=>{if(me.target.files&&me.target.files[0]){const q=me.target.files[0];try{const ne=await Vd(q);J(te,"imageUrl",ne)}catch(ne){console.error("Error converting file to base64:",ne)}}}}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`collectionImageUpload-${te}`).click(),children:[a.jsx(Lo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>z(te),disabled:B===te||!Q.name,children:[B===te?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate"]}),Q.imageUrl&&a.jsxs(O,{variant:"destructive",size:"sm",onClick:()=>J(te,"imageUrl",""),children:[a.jsx(Fn,{className:"mr-1 h-3 w-3"})," Remove Img"]})]})]}),G&&B===te&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:G})]},te)),a.jsxs(O,{type:"button",variant:"outline",onClick:re,className:"w-full",children:[a.jsx(Fi,{className:"mr-2 h-4 w-4"})," Add Another Collection"]})]})]},"step5");case 6:return a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-4 w-full",children:[a.jsx(je,{htmlFor:"prompt",className:"text-lg font-semibold",children:"Describe your store's overall style and feel"}),a.jsx(En,{id:"prompt",name:"prompt",value:n.prompt,onChange:s,placeholder:"e.g., 'A minimalist and modern design with a focus on high-quality product imagery. Use a cool color palette.' OR 'A vibrant and playful store with bold colors and fun animations.'",className:"min-h-[100px]"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This will influence the theme, layout, and imagery. Your store name, logo, and products are already included. You can also pick from the examples below."}),a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsx(je,{className:"text-md font-semibold",children:"AI Prompt Examples:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"elegance",displayName:"Elegance",storeName:"Elegant Finds",promptText:"A sophisticated and elegant store experience, focusing on timeless design and high-quality craftsmanship. The aesthetic is refined, with a clean layout and luxurious feel, using a palette of soft neutrals, gold accents, and rich textures."},{key:"futuretech",displayName:"FutureTech",storeName:"Nexus Innovations",promptText:"A cutting-edge, futuristic store specializing in the latest technology and gadgets. The design is sleek, minimalist, and dark-themed with neon blue or cyan accents, interactive elements, and a high-tech vibe."},{key:"greenharvest",displayName:"GreenHarvest",storeName:"Evergreen Market",promptText:"An eco-friendly and organic store focusing on sustainable and natural products. The design should feel earthy, warm, and inviting, using natural materials, green and brown tones, and imagery of nature."},{key:"urbanthreads",displayName:"UrbanThreads",storeName:"Metro Threads Co.",promptText:"A trendy, urban streetwear store with a gritty yet stylish aesthetic. Think industrial-chic, graffiti art influences, bold typography, and a dynamic, energetic feel. Muted colors with pops of vibrant color."}].map(Q=>a.jsx(O,{variant:"outline",size:"sm",onClick:()=>{e.setFormData(te=>({...te,storeName:Q.storeName,prompt:Q.promptText}))},className:"bg-primary-foreground dark:bg-neutral-800 hover:bg-primary/10 dark:hover:bg-neutral-700",children:Q.displayName},Q.key))})]})]},"step6");default:return null}},rF=(t,e,n)=>!!(t===1&&(e.initialImportMethod==="productType"&&!e.productType||e.initialImportMethod==="photos"&&(!n||n.length===0))||t===2&&!e.storeName||t===4&&(e.products.source==="manual"&&e.products.items.some(r=>!r.name||!r.price)||e.products.source==="ai"&&e.products.items.length===0&&e.products.count>0)||t===5&&(e.collections.source==="ai"&&e.collections.items.length===0&&e.collections.count>0||e.collections.source==="manual"&&e.collections.items.some(r=>!r.name))||t===6&&!e.prompt),LH=({isEmbedded:t=!1,onGenerationComplete:e,initialDataFromImport:n=null})=>{const r=ti(),[s,i]=p.useState(1),[o,l]=p.useState([]),[c,u]=p.useState({initialImportMethod:"productType",productType:"",storeName:"",logoUrlLight:"",logoUrlDark:"",products:{source:"ai",count:3,items:[]},collections:{source:"ai",count:3,items:[]},prompt:""}),[d,h]=p.useState([]),[f,m]=p.useState(!1),[g,x]=p.useState(!1),[v,w]=p.useState(null),[_,C]=p.useState(null),[T,j]=p.useState(null),[A,E]=p.useState(null),[I,N]=p.useState(null),[k,R]=p.useState(null),[D,M]=p.useState(null),[z,B]=p.useState(!1),[G,Y]=p.useState(null),{generateStoreFromWizard:H,isGenerating:K,checkStoreNameAvailability:$,importedStoreDataForGenerator:V,isImportDataReadyForGenerator:W,clearImportedStoreDataForGenerator:F}=$n();p.useEffect(()=>{t&&W&&V?(console.log("StoreWizard (Embedded) consuming imported data:",V),u(ee=>({...ee,storeName:V.name||ee.storeName,prompt:V.prompt||ee.prompt,logoUrlLight:V.logoUrl||ee.logoUrlLight,logoUrlDark:V.logoUrl||ee.logoUrlDark,products:V.products&&V.products.length>0?{source:"manual",count:V.products.length,items:V.products.map(ae=>({name:ae.name||"",price:ae.price||"",description:ae.description||"",images:ae.images||[],variants:ae.variants||[]}))}:ee.products,collections:V.collections&&V.collections.length>0?{source:"manual",count:V.collections.length,items:V.collections.map(ae=>({name:ae.name||"",description:ae.description||"",imageUrl:ae.imageUrl||"",product_ids:ae.product_ids||[]}))}:ee.collections})),V.name&&Z(V.name),F()):n&&(u(ee=>({...ee,storeName:n.name||ee.storeName,prompt:n.prompt||ee.prompt,logoUrlLight:n.logoUrl||ee.logoUrlLight,logoUrlDark:n.logoUrl||ee.logoUrlDark,products:n.products&&n.products.length>0?{source:"manual",count:n.products.length,items:n.products.map(ae=>({name:ae.name||"",price:ae.price||"",description:ae.description||"",images:ae.images||[],variants:ae.variants||[]}))}:ee.products,collections:n.collections&&n.collections.length>0?{source:"manual",count:n.collections.length,items:n.collections.map(ae=>({name:ae.name||"",description:ae.description||"",imageUrl:ae.imageUrl||"",product_ids:ae.product_ids||[]}))}:ee.collections})),n.name&&Z(n.name))},[t,W,V,F,n]);const Z=async ee=>{if(!(ee||c.storeName)){Y({status:"error",message:"Please enter a store name to check."});return}B(!0),Y(null),w(null);try{const X=await qT(c.storeName);Y(X?{status:"claimed",message:"Not available"}:{status:"available",message:"Available"})}catch(X){console.error("Store name availability check failed:",X),Y({status:"error",message:X.message||"Could not check store name. Please try again."})}finally{B(!1)}};p.useEffect(()=>{if(c.storeName&&v){const ee=v.toLowerCase();ee.includes("store name")&&(ee.includes("empty")||ee.includes("required"))&&w(null)}if(c.storeName&&s===2){const ee=setTimeout(async()=>{B(!0),Y(null),w(null);try{const ae=await qT(c.storeName);Y(ae?{status:"claimed",message:"This store name is already taken."}:{status:"available",message:"Store name is available!"})}catch(ae){console.error("Store name availability check failed:",ae),Y({status:"error",message:ae.message||"Could not check store name. Please try again."})}finally{B(!1)}},750);return()=>{clearTimeout(ee)}}else!c.storeName&&s===2&&Y(null)},[c.storeName,s,v]);const ce=ee=>{u(ae=>({...ae,initialImportMethod:ee,productType:ee==="photos"?"":ae.productType})),ee==="productType"&&h([])},le=ee=>new Promise((ae,X)=>{const Pe=new FileReader;Pe.onload=()=>ae(Pe.result),Pe.onerror=X,Pe.readAsDataURL(ee)}),he=async ee=>{const ae=Array.from(ee.target.files);if(ae.length===0)return;const X=10;if(d.length+ae.length>X){w(`You can upload a maximum of ${X} photos.`);return}w(null);const Pe=ae.map(async $e=>{try{const qe=await le($e);return{file:$e,previewUrl:URL.createObjectURL($e),base64:qe,name:$e.name,type:$e.type}}catch(qe){return console.error("Error processing file:",$e.name,qe),null}}),Ae=(await Promise.all(Pe)).filter(Boolean);if(h($e=>{const qe=[...$e,...Ae];return $e.forEach(oe=>{oe.previewUrl&&oe.previewUrl.startsWith("blob:")}),qe}),c.initialImportMethod==="photos"&&Ae.length>0){m(!0),w(null);try{const $e=d.concat(Ae).map(oe=>({base64:oe.base64,mimeType:oe.type,name:oe.name})),qe=await DG($e);qe.error?w(qe.error):(u(oe=>({...oe,productType:qe.productType||oe.productType,storeName:qe.storeNameSuggestions&&qe.storeNameSuggestions.length>0?qe.storeNameSuggestions[0]:oe.storeName,products:{source:"manual",count:qe.products.length,items:qe.products.map(_e=>({name:_e.name||"",price:_e.price||"",description:_e.description||"",images:_e.images||[],variants:[],isFromPhotoAI:!0}))},collections:{source:"manual",count:qe.collections.length,items:qe.collections.map(_e=>({name:_e.name||"",description:_e.description||"",imageUrl:"",product_ids:[],isFromPhotoAI:!0}))},prompt:qe.storePrompt||oe.prompt})),qe.storeNameSuggestions&&qe.storeNameSuggestions.length>0&&l(qe.storeNameSuggestions),qe.logoDescription&&console.log("AI Logo Description:",qe.logoDescription))}catch($e){console.error("Error processing photos with AI:",$e),w(`Failed to process images with AI: ${$e.message}`)}finally{m(!1)}}},Le=ee=>{h(ae=>{const X=ae[ee];return X&&X.previewUrl&&X.previewUrl.startsWith("blob:")&&URL.revokeObjectURL(X.previewUrl),ae.filter((Pe,Ae)=>Ae!==ee)})},Ve=ee=>{const{name:ae,value:X}=ee.target;u(Pe=>({...Pe,[ae]:X}))},Be=ee=>{u(ae=>({...ae,productType:ee}))},ue=ee=>{u(ae=>({...ae,products:{...ae.products,source:ee}}))},Ce=ee=>{u(ae=>({...ae,products:{...ae.products,count:parseInt(ee.target.value)||1}}))},Ie=(ee,ae,X)=>{const Pe=[...c.products.items];Pe[ee][ae]=X,u(Ae=>({...Ae,products:{...Ae.products,items:Pe}}))},ve=()=>{u(ee=>({...ee,products:{...ee.products,items:[...ee.products.items,{name:"",price:"",description:"",images:[]}]}}))},ie=ee=>{const ae=c.products.items.filter((X,Pe)=>Pe!==ee);u(X=>({...X,products:{...X.products,items:ae}}))},Me=async()=>{var ee;if(!c.productType){w("Please select a product type first.");return}x(!0),l([]),w(null);try{const ae=((ee=Yw.find(Pe=>Pe.value===c.productType))==null?void 0:ee.label)||c.productType,X=await vI(ae);X.error?(console.error("Failed to suggest store names:",X.error),w(X.error),l([])):X.suggestions&&X.suggestions.length>0?l(X.suggestions):(w("No suggestions received, or response was empty."),l([]))}catch(ae){console.error("Error in suggestStoreNameHandler:",ae),w(`An unexpected error occurred: ${ae.message}`),l([])}x(!1)},He=ee=>{u(ae=>({...ae,storeName:ee})),l([])},yt=async()=>{if(!c.storeName){console.warn("Store name is required to generate a logo."),w("Please ensure a store name is set before generating a logo.");return}x(!0),w(null);try{const ee=await Ig(c.storeName);ee&&(ee.logoUrlLight||ee.logoUrlDark)?(u(ae=>({...ae,logoUrlLight:ee.logoUrlLight||"",logoUrlDark:ee.logoUrlDark||""})),console.log("Logos generated and URLs set:",ee),ee.textResponse&&console.log("Gemini text response for logo generation:",ee.textResponse)):(console.error("Failed to generate logos: No image data received for either version."),w("Failed to generate logo. The AI did not return sufficient image data."))}catch(ee){console.error("Failed to generate logos:",ee),w(`Logo generation failed: ${ee.message}`)}x(!1)},kt=async()=>{if(!c.productType||!c.storeName){w("Please provide a product type and store name before generating AI products.");return}x(!0),w(null);let ee=[];try{const ae=await O1e(c.prompt,c.productType);if(console.log("Prompt Analysis Result:",ae),ae.error||ae.strategy==="error"){w(ae.error||"Failed to analyze store prompt for product strategy."),x(!1);return}let X=null,Pe="image/png";const Ae=c.logoUrlLight||c.logoUrlDark;if(Ae&&Ae.startsWith("data:")){const $e=Ae.split(",");if($e.length===2){X=$e[1];const qe=$e[0].match(/:(.*?);/);qe&&qe[1]&&(Pe=qe[1])}}if(ae.strategy==="standard"){console.log("Strategy: Standard Product Generation");for(let $e=0;$e<c.products.count;$e++){console.log(`Generating AI product ${$e+1} of ${c.products.count}...`);const qe=await jG(c.productType,c.storeName,X,Pe,ee.map(oe=>oe.name),void 0,void 0,void 0,c.prompt);qe&&qe.images&&qe.images.length>0?ee.push({name:qe.title,description:qe.description,price:qe.price,images:qe.images,variants:qe.variants||[]}):console.warn(`Failed to generate full data for standard product ${$e+1}. Skipping.`)}}else if(ae.strategy==="pod_theme_visualization"||ae.strategy==="pod_specific_products"){console.log(`Strategy: Print on Demand - ${ae.strategy}`);const $e=ae.theme&&ae.theme!=="General"?`Design for print-on-demand products for a store themed '${ae.theme}'. Store name: ${c.storeName}. User prompt: ${c.prompt}`:`Versatile design for print-on-demand products based on store prompt: "${c.prompt}". Store name: ${c.storeName}.`,qe=6;let oe=[];for(let Te=0;Te<qe;Te++){const Tt=`${$e} (Design variation ${Te+1} of ${qe}, ensure it's distinct from previous designs for this store if any were made).`;console.log(`Generating POD design ${Te+1}/${qe}...`);const wt=await Ng({prompt:Tt});wt&&wt.imageData?oe.push({base64:wt.imageData,mimeType:wt.imageMimeType||"image/png",prompt:Tt}):console.warn(`Failed to generate POD design ${Te+1}.`)}if(oe.length===0){w("Failed to generate any base designs for POD products."),x(!1);return}let _e=[...eo],ze=[];for(let Te=0;Te<Math.min(oe.length,_e.length);Te++){const Tt=Math.floor(Math.random()*_e.length);ze.push(_e.splice(Tt,1)[0])}if(ze.length===0){w("No POD mockup products available for visualization."),x(!1);return}for(let Te=0;Te<Math.min(oe.length,ze.length);Te++){const Tt=oe[Te],wt=ze[Te];console.log(`Visualizing design ${Te+1} on ${wt.name}...`);const xt=await Vp(Tt.base64,Tt.mimeType,wt.imageUrl,ae.theme||c.prompt,wt.name);if(xt&&xt.visualizedImageData&&xt.productDetails){const pt=`data:${Tt.mimeType};base64,${Tt.base64}`,Pt=`data:${xt.visualizedImageMimeType};base64,${xt.visualizedImageData}`;ee.push({name:xt.productDetails.title,price:parseFloat(xt.productDetails.price).toFixed(2),description:xt.productDetails.description,images:[pt,Pt],isPrintOnDemand:!0,podDetails:{originalDesignImageUrl:pt,designPrompt:Tt.prompt,baseProductName:wt.name,baseProductImageUrl:wt.imageUrl},variants:xt.productDetails.variants||[]})}else console.warn(`Failed to visualize design ${Te+1} on ${wt.name}. Skipping.`)}}u($e=>({...$e,products:{...$e.products,items:ee}})),ee.length===0&&c.products.count>0&&w("AI failed to generate any products with the selected strategy. Please try again or adjust settings.")}catch(ae){console.error("Error generating AI products:",ae),w(`Failed to generate AI products: ${ae.message}`)}x(!1)},en=async()=>{if(!c.productType||!c.storeName||c.products.items.length===0){w("Please ensure product type, store name, and at least one product are set before generating AI collections.");return}x(!0),w(null);const ee=[],ae=c.collections.items.map(X=>X.name);try{for(let X=0;X<c.collections.count;X++){console.log(`Generating AI collection ${X+1} of ${c.collections.count}...`);const Pe=await RG(c.productType,c.storeName,c.products.items,ae);if(Pe&&!Pe.error&&Pe.name&&Pe.description&&Pe.product_ids){let Ae=`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(Pe.name||"Collection")}`;Pe.imageData&&(Ae=`data:image/png;base64,${Pe.imageData}`),ee.push({name:Pe.name,description:Pe.description,imageUrl:Ae,product_ids:Pe.product_ids}),Pe.name&&ae.push(Pe.name)}else console.warn(`Failed to generate full data for collection ${X+1}. Skipping.`)}u(X=>({...X,collections:{...X.collections,items:ee}})),ee.length===0&&c.collections.count>0&&w("AI failed to generate any collections. Please try again or adjust settings.")}catch(X){console.error("Error generating AI collections:",X),w(`Failed to generate AI collections: ${X.message}`)}x(!1)},mn=async ee=>{const ae=c.products.items[ee];if(!ae||!ae.name){j("Product name is required to generate an image.");return}C(ee),j(null);try{const X=await XU(ae.name,ae.description);if(X&&X.imageData){const Pe=`data:image/png;base64,${X.imageData}`,Ae=[...c.products.items];Ae[ee].images=[Pe],u($e=>({...$e,products:{...$e.products,items:Ae}}))}else throw new Error(X.textResponse||"Failed to generate product image data.")}catch(X){console.error(`Error generating image for product ${ee}:`,X),j(X.message)}finally{C(null)}},cn=async ee=>{const ae=c.products.items[ee];if(!ae||!ae.images||ae.images.length===0){N("At least one image must be uploaded or generated first to create more angles.");return}const X=ae.images[0];E(ee),N(null);try{const{generateDifferentAnglesFromImage:Pe}=await Ot(()=>Promise.resolve().then(()=>Fae),void 0),Ae=X.split(",");if(Ae.length!==2)throw new Error("Invalid base image URL format for angle generation.");const $e=Ae[0],qe=Ae[1],oe=$e.match(/:(.*?);/);if(!oe||!oe[1])throw new Error("Could not determine mime type from base image URL.");const _e=oe[1],ze=await Pe(qe,_e,ae.name||"Product"),Te=[...c.products.items],Tt=Te[ee].images||[];Te[ee].images=[...Tt,...ze.filter(wt=>!Tt.includes(wt))],u(wt=>({...wt,products:{...wt.products,items:Te}}))}catch(Pe){console.error(`Error generating more angles for product ${ee}:`,Pe),N(Pe.message||"Failed to generate additional angles.")}finally{E(null)}},fn=async ee=>{const ae=c.collections.items[ee];if(!ae||!ae.name){M("Collection name is required to generate an image.");return}R(ee),M(null),w(null);try{const X=await ZU(ae.name,ae.description);if(X&&X.imageData&&X.imageMimeType){const Pe=`data:${X.imageMimeType};base64,${X.imageData}`,Ae=[...c.collections.items];Ae[ee].imageUrl=Pe,u($e=>({...$e,collections:{...$e.collections,items:Ae}}))}else throw new Error(X.textResponse||"Failed to generate collection image data.")}catch(X){console.error(`Error generating image for collection ${ee} ("${ae.name}"):`,X),M(X.message||"Unknown error during collection image generation.");const Pe=[...c.collections.items];Pe[ee].imageUrl="",u(Ae=>({...Ae,collections:{...Ae.collections,items:Pe}}))}finally{R(null)}},Ue=()=>i(ee=>ee+1),Et=()=>i(ee=>ee-1),de=async()=>{x(!0),w(null);try{const ee={name:c.storeName,niche:c.productType,description:c.prompt},ae=await ZV(ee);ae.error&&console.warn("Failed to generate hero content:",ae.error);const X=await e3(ee);X.error&&console.warn("Failed to generate store way content:",X.error);const Pe=await wI(ee);Pe.error&&console.warn("Failed to generate store features content:",Pe.error);const Ae={...c,content:{...c.content||{},hero:ae&&!ae.error?ae:void 0,storeWay:X&&!X.error?X:void 0,storeFeatures:Pe&&!Pe.error?Pe:void 0}},$e=await H(Ae);if($e){if(t&&e)e($e);else if(!t){const qe=`/${$e.urlSlug||pc($e.name)}`;r(qe)}}}catch(ee){console.error("Error during final store generation steps or navigation:",ee),w(`An error occurred during final store setup: ${ee.message}`)}finally{x(!1)}},De={formData:c,setFormData:u,handleInputChange:Ve,handleProductTypeChange:Be,handleProductSourceChange:ue,handleProductCountChange:Ce,handleManualProductChange:Ie,addManualProduct:ve,removeManualProduct:ie,suggestStoreName:Me,generateLogo:yt,generateAiProducts:kt,generateAiCollections:en,handleGenerateManualProductImage:mn,handleGenerateMoreAngles:cn,isProcessing:g,isGeneratingProductImageForIndex:_,productImageGenerationError:T,isGeneratingAnglesForIndex:A,angleGenerationError:I,productTypeOptions:Yw,storeNameSuggestions:o,handleSuggestionClick:He,suggestionError:v,handleInitialImportMethodChange:ce,handleProductPhotoUpload:he,uploadedProductPhotos:d,removeUploadedProductPhoto:Le,isProcessingPhotos:f,handleGenerateCollectionImage:fn,isGeneratingCollectionImageForIndex:k,collectionImageGenerationError:D,isCheckingStoreName:z,storeNameAvailability:G,handleManualStoreNameCheck:Z};return t?a.jsxs("div",{className:"w-full p-2",children:[" ",a.jsx(Sc,{mode:"wait",children:nF(s,De)}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsxs(O,{variant:"outline",onClick:Et,disabled:s===1||K||f,children:[a.jsx(Wi,{className:"mr-2 h-4 w-4"})," Previous"]}),s<6?a.jsxs(O,{onClick:Ue,disabled:rF(s,c,d)||K||f,children:["Next ",a.jsx(ju,{className:"ml-2 h-4 w-4"})]}):a.jsxs(O,{onClick:de,disabled:g||K||f||!c.prompt,className:"bg-primary hover:bg-primary/90",children:[g||K?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(va,{className:"mr-2 h-4 w-4"}),"Generate Store"]})]})]}):a.jsxs("div",{className:"w-full max-w-2xl mx-auto",children:[" ",a.jsxs(lt,{children:[a.jsx(ct,{className:"text-2xl font-bold",children:"Store Creation Wizard"}),a.jsxs(Qt,{children:["Step ",s," of 6: Let's build your online store together!"]}),a.jsx("div",{className:"w-full bg-green-200 dark:bg-green-800 rounded-full h-2.5 mt-2",children:a.jsx(It.div,{className:"bg-green-600 dark:bg-green-500 h-2.5 rounded-full",initial:{width:"0%"},animate:{width:`${s/6*100}%`},transition:{duration:.5,ease:"easeInOut"}})})]}),a.jsx(it,{className:"min-h-[250px] flex items-center",children:a.jsx(Sc,{mode:"wait",children:nF(s,De)})}),a.jsxs(pd,{className:"flex justify-between",children:[a.jsxs(O,{variant:"outline",onClick:Et,disabled:s===1||K||f,children:[a.jsx(Wi,{className:"mr-2 h-4 w-4"})," Previous"]}),s<6?a.jsxs(O,{onClick:Ue,disabled:rF(s,c,d)||K||f,children:["Next ",a.jsx(ju,{className:"ml-2 h-4 w-4"})]}):a.jsxs(O,{onClick:de,disabled:g||K||f||!c.prompt,children:[g||K?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(va,{className:"mr-2 h-4 w-4"}),"Generate Store"]})]})]})},q1e=({isOpen:t,onClose:e,product:n,onSave:r})=>{const[s,i]=p.useState(null);if(p.useEffect(()=>{var d,h,f,m,g,x,v;if(n){const w=(h=(d=n.variants)==null?void 0:d.edges[0])==null?void 0:h.node;i({...n,name:n.title||"",price:((f=w==null?void 0:w.price)==null?void 0:f.amount)||0,currencyCode:((m=w==null?void 0:w.price)==null?void 0:m.currencyCode)||"USD",imageUrl:((v=(x=(g=n.images)==null?void 0:g.edges[0])==null?void 0:x.node)==null?void 0:v.url)||""})}else i(null)},[n]),!t||!s)return null;const o=d=>{const{name:h,value:f}=d.target;i(m=>({...m,[h]:f}))},l=d=>{const{value:h}=d.target;i(f=>({...f,price:parseFloat(h)||0}))},c=d=>{const{value:h}=d.target;i(f=>({...f,imageUrl:h}))},u=()=>{var h,f,m,g;const d={...s,title:s.name,images:{edges:[{node:{url:s.imageUrl,altText:s.name}}]},variants:{...s.variants,edges:[{node:{...((f=(h=s.variants)==null?void 0:h.edges[0])==null?void 0:f.node)||{},price:{amount:s.price,currencyCode:s.currencyCode}}},...((g=(m=s.variants)==null?void 0:m.edges)==null?void 0:g.slice(1))||[]]}};r(d),e()};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs(Vr,{className:"sm:max-w-lg",children:[a.jsxs(Ur,{children:[a.jsxs(Br,{children:["Edit Product: ",n.title]}),a.jsx(Qi,{children:"Make changes to the product details below."})]}),a.jsx(Fs,{className:"max-h-[60vh] p-1",children:a.jsxs("div",{className:"grid gap-4 py-4 pr-3",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"name",className:"text-right",children:"Name"}),a.jsx(Je,{id:"name",name:"name",value:s.name,onChange:o,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"description",className:"text-right",children:"Description"}),a.jsx(En,{id:"description",name:"description",value:s.description,onChange:o,className:"col-span-3",rows:4})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"price",className:"text-right",children:"Price"}),a.jsx(Je,{id:"price",name:"price",type:"number",value:s.price,onChange:l,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"imageUrl",className:"text-right",children:"Image URL"}),a.jsx(Je,{id:"imageUrl",name:"imageUrl",value:s.imageUrl,onChange:c,className:"col-span-3"})]})]})}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel"}),a.jsx(O,{type:"button",onClick:u,children:"Save Changes"})]})]})})},K1e=({isOpen:t,onClose:e,collection:n,onSave:r})=>{const[s,i]=p.useState(null);if(p.useEffect(()=>{i(n?{...n,name:n.title||""}:null)},[n]),!t||!s)return null;const o=c=>{const{name:u,value:d}=c.target;i(h=>({...h,[u]:d}))},l=()=>{const c={...s,title:s.name};r(c),e()};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs(Vr,{className:"sm:max-w-lg",children:[a.jsxs(Ur,{children:[a.jsxs(Br,{children:["Edit Collection: ",n.title]}),a.jsx(Qi,{children:"Make changes to the collection details below."})]}),a.jsx(Fs,{className:"max-h-[60vh] p-1",children:a.jsxs("div",{className:"grid gap-4 py-4 pr-3",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"name",className:"text-right",children:"Name"}),a.jsx(Je,{id:"name",name:"name",value:s.name,onChange:o,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(je,{htmlFor:"description",className:"text-right",children:"Description"}),a.jsx(En,{id:"description",name:"description",value:s.description||"",onChange:o,className:"col-span-3",rows:4})]})]})}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel"}),a.jsx(O,{type:"button",onClick:l,children:"Save Changes"})]})]})})},Y1e=()=>{var x,v,w,_,C,T,j,A,E,I,N,k,R,D,M;const{shopifyPreviewMetadata:t,isFetchingShopifyPreviewData:e,shopifyImportError:n,updateShopifyPreviewMetadata:r}=$n(),[s,i]=p.useState(((w=(v=(x=t==null?void 0:t.brand)==null?void 0:x.colors)==null?void 0:v.primary)==null?void 0:w.background)||"#000000"),[o,l]=p.useState(((T=(C=(_=t==null?void 0:t.brand)==null?void 0:_.colors)==null?void 0:C.secondary)==null?void 0:T.background)||"#ffffff");ht.useEffect(()=>{var z,B,G;(z=t==null?void 0:t.brand)!=null&&z.colors&&(i(((B=t.brand.colors.primary)==null?void 0:B.background)||"#000000"),l(((G=t.brand.colors.secondary)==null?void 0:G.background)||"#ffffff"))},[t]);const c=z=>{var G,Y,H;const B=z.target.value;i(B),r&&r({...t,brand:{...t.brand,colors:{...(G=t.brand)==null?void 0:G.colors,primary:{...(H=(Y=t.brand)==null?void 0:Y.colors)==null?void 0:H.primary,background:B}}}})},u=z=>{var G,Y,H;const B=z.target.value;l(B),r&&r({...t,brand:{...t.brand,colors:{...(G=t.brand)==null?void 0:G.colors,secondary:{...(H=(Y=t.brand)==null?void 0:Y.colors)==null?void 0:H.secondary,background:B}}}})};if(e&&!t)return a.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Fetching store information..."})]});if(n&&!t)return a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-destructive",children:[a.jsx(Cg,{className:"h-12 w-12 mb-4"}),a.jsx("p",{className:"font-semibold",children:"Error Fetching Store Info"}),a.jsx("p",{className:"text-sm text-center",children:n})]});if(!t)return a.jsx("div",{className:"text-center text-muted-foreground",children:"No store metadata to display."});const{name:d,description:h,primaryDomain:f,brand:m}=t,g=((A=(j=m==null?void 0:m.logo)==null?void 0:j.image)==null?void 0:A.url)||((I=(E=m==null?void 0:m.squareLogo)==null?void 0:E.image)==null?void 0:I.url);return a.jsxs("div",{className:"w-full p-4",children:[a.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Store Preview"}),a.jsxs(Qe,{className:"mb-4",children:[a.jsx(lt,{children:a.jsxs("div",{className:"flex items-center space-x-4",children:[g?a.jsx("img",{src:g,alt:`${d} logo`,className:"h-16 w-16 object-contain rounded border"}):a.jsx("div",{className:"h-16 w-16 bg-muted rounded border flex items-center justify-center text-muted-foreground",children:a.jsx(NE,{size:32})}),a.jsxs("div",{children:[a.jsx(ct,{children:d||"N/A"}),(f==null?void 0:f.host)&&a.jsx(Qt,{children:f.host})]})]})}),a.jsxs(it,{children:[a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[a.jsx("strong",{children:"Slogan:"})," ",(m==null?void 0:m.slogan)||"N/A"]}),a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[a.jsx("strong",{children:"Description:"})," ",h||(m==null?void 0:m.shortDescription)||"N/A"]}),((N=m==null?void 0:m.coverImage)==null?void 0:N.url)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-sm font-medium mb-1",children:"Cover Image:"}),a.jsx("img",{src:m.coverImage.url,alt:"Store cover",className:"rounded max-h-40 w-auto mx-auto border"})]})]})]}),(m==null?void 0:m.colors)&&a.jsxs(Qe,{className:"mt-4",children:[a.jsx(lt,{children:a.jsx(ct,{className:"text-lg",children:"Brand Colors"})}),a.jsxs(it,{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"primaryColorPicker",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Primary Color"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"color",id:"primaryColorPicker",value:s,onChange:c,className:"h-10 w-10 rounded border cursor-pointer"}),a.jsx("div",{className:"w-12 h-10 rounded border",style:{backgroundColor:s},title:`Primary Background: ${s}`}),a.jsx("span",{className:"text-sm",children:s})]}),((R=(k=m==null?void 0:m.colors)==null?void 0:k.primary)==null?void 0:R.foreground)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-xs text-muted-foreground",children:"Text/Icon Color (from Shopify):"}),a.jsx("div",{className:"w-full h-6 rounded border mt-1",style:{backgroundColor:m.colors.primary.foreground},title:`Primary Foreground: ${m.colors.primary.foreground}`})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"secondaryColorPicker",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Secondary Color"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"color",id:"secondaryColorPicker",value:o,onChange:u,className:"h-10 w-10 rounded border cursor-pointer"}),a.jsx("div",{className:"w-12 h-10 rounded border",style:{backgroundColor:o},title:`Secondary Background: ${o}`}),a.jsx("span",{className:"text-sm",children:o})]}),((M=(D=m==null?void 0:m.colors)==null?void 0:D.secondary)==null?void 0:M.foreground)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-xs text-muted-foreground",children:"Text/Icon Color (from Shopify):"}),a.jsx("div",{className:"w-full h-6 rounded border mt-1",style:{backgroundColor:m.colors.secondary.foreground},title:`Secondary Foreground: ${m.colors.secondary.foreground}`})]})]})]})]})]})},J1e=()=>{var B,G,Y,H,K,$;const{shopifyPreviewProducts:t,shopifyPreviewCollections:e,fetchShopifyWizardProducts:n,fetchShopifyWizardCollections:r,isFetchingShopifyPreviewData:s,shopifyImportError:i,shopifyPreviewMetadata:o,generatedLogoImage:l,isGeneratingLogo:c,logoGenerationError:u,generateShopifyStoreLogo:d,updateShopifyPreviewProduct:h,updateShopifyPreviewCollection:f}=$n(),[m,g]=p.useState(!1),[x,v]=p.useState(null),[w,_]=p.useState(!1),[C,T]=p.useState(null),j=V=>{v(V),g(!0)},A=()=>{g(!1),v(null)},E=V=>{h(V)},I=V=>{T(V),_(!0)},N=()=>{_(!1),T(null)},k=V=>{f(V)},R=()=>{t.pageInfo.hasNextPage&&n(10,t.pageInfo.endCursor)},D=()=>{e.pageInfo.hasNextPage&&r(10,e.pageInfo.endCursor)},M=(o==null?void 0:o.name)||"Your Store",z=((Y=(G=(B=o==null?void 0:o.brand)==null?void 0:B.logo)==null?void 0:G.image)==null?void 0:Y.url)||(($=(K=(H=o==null?void 0:o.brand)==null?void 0:H.squareLogo)==null?void 0:K.image)==null?void 0:$.url);return a.jsxs("div",{className:"w-full p-4 space-y-6",children:[a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Generate Store Logo"}),a.jsxs(Qt,{children:['Optionally, generate a new logo for "',M,'" using AI. The generated logo will be used for your new store if you proceed.']})]}),a.jsxs(it,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Current Shopify Logo (if any):"}),z?a.jsx("img",{src:z,alt:`${M} current logo`,className:"h-48 w-auto object-contain"}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No logo found in Shopify data."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Generated Logo Preview:"}),c&&a.jsxs("div",{className:"h-48 w-full flex items-center justify-center",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary"})," "]}),!c&&l&&a.jsx("div",{className:"h-48 w-auto flex items-center justify-center",children:a.jsx("img",{src:l,alt:`${M} AI generated logo`,className:"h-full w-auto object-contain"})}),!c&&!l&&a.jsxs("div",{className:"h-48 w-full flex items-center justify-center text-muted-foreground",children:[a.jsx(NE,{className:"h-12 w-12 mr-2"})," ",a.jsx("span",{children:"Logo will appear here"})]})]})]}),a.jsxs(O,{onClick:d,disabled:c||!(o!=null&&o.name),className:"w-full md:w-auto",children:[c?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate New Logo with AI"]}),u&&a.jsxs("p",{className:"text-sm text-destructive text-center mt-2",children:[a.jsx(Cg,{className:"inline h-4 w-4 mr-1"}),u]}),!(o!=null&&o.name)&&a.jsx("p",{className:"text-sm text-amber-600 text-center mt-2",children:"Store name from Shopify is required to generate a logo."})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Products (",t.edges.length," loaded)"]}),i&&i.includes("products")&&a.jsx("p",{className:"text-destructive text-sm mb-2",children:i}),a.jsxs(Fs,{className:"h-60 border rounded p-2",children:[t.edges.length===0&&!s&&a.jsx("p",{className:"text-muted-foreground text-sm p-2",children:"No products loaded yet or none found."}),t.edges.map(({node:V})=>{var W,F,Z,ce,le,he,Le,Ve,Be;return a.jsx("div",{className:"p-3 border-b last:border-b-0",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[((Z=(F=(W=V.images)==null?void 0:W.edges[0])==null?void 0:F.node)==null?void 0:Z.url)&&a.jsx("img",{src:V.images.edges[0].node.url,alt:V.title,className:"h-16 w-16 rounded object-cover border"}),!((he=(le=(ce=V.images)==null?void 0:ce.edges[0])==null?void 0:le.node)!=null&&he.url)&&a.jsx("div",{className:"h-16 w-16 bg-muted rounded border flex items-center justify-center text-muted-foreground",children:a.jsx(NE,{size:24})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm",children:V.title}),((Be=(Ve=(Le=V.variants)==null?void 0:Le.edges[0])==null?void 0:Ve.node)==null?void 0:Be.price)&&a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Price: ",V.variants.edges[0].node.price.amount," ",V.variants.edges[0].node.price.currencyCode]}),V.description&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1 truncate",title:V.description,children:["Desc: ",V.description.substring(0,50),V.description.length>50?"...":""]}),V.tags&&V.tags.length>0&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Tags: ",V.tags.join(", ")]})]}),a.jsx(O,{variant:"ghost",size:"sm",onClick:()=>j(V),className:"ml-auto",children:a.jsx(ew,{className:"h-4 w-4"})})]})},V.id)}),s&&t.pageInfo.hasNextPage&&a.jsx("div",{className:"flex justify-center py-2",children:a.jsx(ft,{className:"h-5 w-5 animate-spin"})})]}),t.pageInfo.hasNextPage&&a.jsx(O,{onClick:R,disabled:s,className:"mt-2 w-full",children:s?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):"Load More Products"}),!t.pageInfo.hasNextPage&&t.edges.length>0&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"All products loaded."})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Collections (",e.edges.length," loaded)"]}),i&&i.includes("collections")&&a.jsx("p",{className:"text-destructive text-sm mb-2",children:i}),a.jsxs(Fs,{className:"h-60 border rounded p-2",children:[e.edges.length===0&&!s&&a.jsx("p",{className:"text-muted-foreground text-sm p-2",children:"No collections loaded yet or none found."}),e.edges.map(({node:V})=>a.jsxs("div",{className:"p-2 border-b text-sm flex justify-between items-center",children:[a.jsx("span",{children:V.title}),a.jsx(O,{variant:"ghost",size:"sm",onClick:()=>I(V),children:a.jsx(ew,{className:"h-4 w-4"})})]},V.id)),s&&e.pageInfo.hasNextPage&&a.jsx("div",{className:"flex justify-center py-2",children:a.jsx(ft,{className:"h-5 w-5 animate-spin"})})]}),e.pageInfo.hasNextPage&&a.jsx(O,{onClick:D,disabled:s,className:"mt-2 w-full",children:s?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):"Load More Collections"}),!e.pageInfo.hasNextPage&&e.edges.length>0&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"All collections loaded."})]})]}),x&&a.jsx(q1e,{isOpen:m,onClose:A,product:x,onSave:E}),C&&a.jsx(K1e,{isOpen:w,onClose:N,collection:C,onSave:k})]})},Q1e=()=>{var r,s;const{bigCommercePreviewSettings:t,isFetchingBigCommercePreviewData:e,bigCommerceImportError:n}=$n();return e&&!t?a.jsxs("div",{className:"flex items-center justify-center p-8",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin"})," ",a.jsx("span",{className:"ml-2",children:"Fetching store settings..."})]}):n&&!t?a.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error: ",n]}):t?a.jsxs(Qe,{className:"w-full",children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Store Settings Preview (BigCommerce)"}),a.jsx(Qt,{children:"Review your BigCommerce store's basic information."})]}),a.jsxs(it,{className:"space-y-2",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Store Name:"})," ",t.storeName||"N/A"]}),((s=(r=t.logo)==null?void 0:r.image)==null?void 0:s.url)&&a.jsxs("div",{children:[a.jsx("strong",{children:"Logo:"}),a.jsx("img",{src:t.logo.image.url,alt:t.logo.image.altText||"Store Logo",className:"mt-2 max-w-xs max-h-24 object-contain border rounded"})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Store Hash:"})," ",t.storeHash||"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Status:"})," ",t.status||"N/A"]})]})]}):a.jsx("div",{className:"text-center p-4",children:"Connect to BigCommerce to see store settings, or settings are being fetched."})},X1e=()=>{const{bigCommercePreviewProducts:t,fetchBigCommerceWizardProducts:e,isFetchingBigCommercePreviewData:n,bigCommerceImportError:r}=$n(),s=(t==null?void 0:t.items)||[];return n&&s.length===0?a.jsxs("div",{className:"flex items-center justify-center p-8",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin"})," ",a.jsx("span",{className:"ml-2",children:"Fetching products..."})]}):r&&s.length===0?a.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error fetching products: ",r]}):s.length===0?a.jsxs("div",{className:"text-center p-4",children:[a.jsx("p",{className:"mb-4",children:"No products loaded yet for BigCommerce."}),a.jsxs(O,{onClick:()=>e(10),disabled:n,children:[n?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Load Products Preview"]})]}):a.jsxs(Qe,{className:"w-full",children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Products Preview (BigCommerce)"}),a.jsx(Qt,{children:"A sample of products from your BigCommerce store."})]}),a.jsxs(it,{children:[a.jsx("ul",{className:"space-y-2 max-h-96 overflow-y-auto",children:s.slice(0,10).map(i=>{var o,l,c,u,d;return a.jsxs("li",{className:"p-2 border rounded text-sm flex justify-between items-center",children:[a.jsxs("div",{children:[i.name," - ",(l=(o=i.prices)==null?void 0:o.price)==null?void 0:l.value," ",(u=(c=i.prices)==null?void 0:c.price)==null?void 0:u.currencyCode]}),((d=i.defaultImage)==null?void 0:d.url)&&a.jsx("img",{src:i.defaultImage.url,alt:i.defaultImage.altText||i.name,className:"w-12 h-12 object-cover rounded ml-2"})]},i.entityId)})}),s.length>10&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Showing 10 of ",s.length," products fetched for preview."]})]})]})},Z1e=({isOpen:t,onClose:e,initialImportSource:n="shopify"})=>{const r=ti(),[s,i]=p.useState(n),{shopifyWizardStep:o,setShopifyWizardStep:l,resetShopifyWizardState:c,shopifyPreviewMetadata:u,shopifyPreviewProducts:d,shopifyPreviewCollections:h,isFetchingShopifyPreviewData:f,shopifyImportError:m,fetchShopifyWizardProducts:g,fetchShopifyWizardCollections:x,finalizeShopifyImportFromWizard:v,shopifyWizardShouldShowGenerator:w,setShopifyWizardShouldShowGenerator:_,bigCommerceWizardStep:C,setBigCommerceWizardStep:T,resetBigCommerceWizardState:j,bigCommercePreviewSettings:A,bigCommercePreviewProducts:E,isFetchingBigCommercePreviewData:I,bigCommerceImportError:N,fetchBigCommerceWizardProducts:k,finalizeBigCommerceImportFromWizard:R,isGenerating:D,generateStoreFromWizard:M}=$n(),z={shopify:{wizardStep:o,setWizardStep:l,resetWizardState:c,previewMetadata:u,previewProducts:d,previewCollections:h,isFetchingPreviewData:f,importError:m,fetchWizardProducts:g,fetchWizardCollections:x,finalizeImportFromWizard:v,ConnectFormComponent:k1e,MetadataPreviewComponent:Y1e,ItemsPreviewComponent:J1e,wizardShouldShowGenerator:w,setWizardShouldShowGenerator:_,totalSteps:5},bigcommerce:{wizardStep:C,setWizardStep:T,resetWizardState:j,previewMetadata:A,previewProducts:E,isFetchingPreviewData:I,importError:N,fetchWizardProducts:k,finalizeImportFromWizard:R,ConnectFormComponent:j1e,MetadataPreviewComponent:Q1e,ItemsPreviewComponent:X1e,totalSteps:4}},B=z[s],{wizardStep:G,setWizardStep:Y,resetWizardState:H,previewMetadata:K,previewProducts:$,previewCollections:V,isFetchingPreviewData:W,importError:F,fetchWizardProducts:Z,fetchWizardCollections:ce,finalizeImportFromWizard:le,ConnectFormComponent:he,MetadataPreviewComponent:Le,ItemsPreviewComponent:Ve,totalSteps:Be,wizardShouldShowGenerator:ue,setWizardShouldShowGenerator:Ce}=B;if(p.useEffect(()=>{i(n),n==="shopify"&&z.bigcommerce.resetWizardState&&z.bigcommerce.resetWizardState(),n==="bigcommerce"&&z.shopify.resetWizardState&&z.shopify.resetWizardState()},[n,z.bigcommerce,z.shopify]),p.useEffect(()=>{t&&G===0&&Y(1),!t&&G!==0&&H()},[t,G,Y,H]),!t||G===0)return null;const Ie=async()=>{G<Be&&(s==="shopify"?G===2?((!$||$.edges.length===0)&&await Z(10),(!V||V.edges.length===0)&&await ce(10),Y(3)):G===3&&await le():s==="bigcommerce"&&(G===1||(G===2?((!$||$.items.length===0)&&await Z(10),Y(3)):G===3&&await Me())))},ve=()=>{G>1&&Y(G-1)},ie=()=>{H(),Ce&&Ce(!1),e&&e()},Me=async()=>{await le()&&e&&e()},He=()=>{switch(G){case 1:return a.jsx(he,{open:G===1,onOpenChange:kt=>{kt||ie()},onSuccessfulConnect:kt=>{s==="shopify"&&startShopifyImportWizard(kt.domain,kt.token)}});case 2:return a.jsx(Le,{});case 3:return a.jsx(Ve,{});case 4:return s==="shopify"&&ue?a.jsx(LH,{isEmbedded:!0,onGenerationComplete:kt=>{if(kt&&(kt.urlSlug||kt.name)){const en=`/${kt.urlSlug||pc(kt.name)}`;r(en)}e&&e(),Ce&&Ce(!1)}}):a.jsx("div",{children:"Loading generator..."});default:return G===Be&&D?a.jsxs("div",{className:"flex flex-col items-center justify-center p-8",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin mb-4"})," ",a.jsx("p",{children:"Processing..."})]}):a.jsxs("div",{children:["Invalid Wizard Step or processing... (",G,")"]})}};if(G===1&&s==="shopify")return He();const yt=s==="shopify"?"Import from Shopify":s==="bigcommerce"?"Import from BigCommerce":"Import Store Data";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs(Qe,{className:"w-full max-w-2xl mx-auto shadow-xl",children:[a.jsxs(lt,{children:[a.jsx(ct,{className:"text-2xl font-bold",children:G===1&&s==="bigcommerce"?"Connect to BigCommerce":yt}),a.jsx(Qt,{children:G===1&&s==="bigcommerce"?"Enter your store domain and API token.":G===4&&s==="shopify"?"Configure and generate your new store.":`Step ${G} of ${Be-1}`}),a.jsx("div",{className:"w-full bg-muted rounded-full h-2.5 mt-2",children:a.jsx(It.div,{className:"bg-primary h-2.5 rounded-full",initial:{width:"0%"},animate:{width:`${G/Be*100}%`},transition:{duration:.5,ease:"easeInOut"}})})]}),a.jsx(it,{className:"min-h-[250px] max-h-[60vh] overflow-y-auto flex items-center justify-center",children:He()}),a.jsxs(pd,{className:"flex justify-between",children:[G>1&&G!==4&&a.jsxs(O,{variant:"outline",onClick:ie,disabled:D||W,children:[a.jsx(rw,{className:"mr-2 h-4 w-4"})," Cancel"]}),G===4&&s==="shopify"&&a.jsxs(O,{variant:"outline",onClick:ie,disabled:D||W,children:[a.jsx(rw,{className:"mr-2 h-4 w-4"})," Cancel Import"]}),a.jsxs("div",{children:[G>1&&G<Be-1&&a.jsxs(O,{variant:"outline",onClick:ve,disabled:D||W,className:"mr-2",children:[a.jsx(Wi,{className:"mr-2 h-4 w-4"})," Previous"]}),G===1&&s==="bigcommerce"&&a.jsxs(O,{onClick:Ie,disabled:D||W,children:["Next ",a.jsx(ju,{className:"ml-2 h-4 w-4"})]}),G===2&&a.jsxs(O,{onClick:Ie,disabled:D||W,children:["Next ",a.jsx(ju,{className:"ml-2 h-4 w-4"})]}),G===3&&a.jsxs(O,{onClick:Ie,disabled:D||W,children:[D?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(ju,{className:"ml-2 h-4 w-4"}),"Configure Store"]}),G===Be&&D&&a.jsxs(O,{disabled:!0,children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]})]})]})]})})},eIe=({onSelectSource:t,onClose:e})=>a.jsxs(Qe,{className:"w-full max-w-md mx-auto relative",children:[" ",a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 text-muted-foreground hover:text-foreground",onClick:e,children:a.jsx(Hi,{className:"h-5 w-5"})}),a.jsxs(lt,{children:[a.jsx(ct,{children:"Import Store Data"}),a.jsxs(Qt,{className:"text-slate-500 dark:text-slate-400",children:[" ","Select your e-commerce platform to begin importing your store and product data."]})]}),a.jsx(it,{children:a.jsxs(_i,{defaultValue:"shopify",className:"w-full",children:[a.jsxs(ni,{className:"grid w-full grid-cols-2",children:[a.jsx(Vt,{value:"shopify",children:"Shopify"}),a.jsx(Vt,{value:"bigcommerce",children:"BigCommerce"})]}),a.jsxs(Ut,{value:"shopify",className:"mt-4",children:[a.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:[" ","Connect to your Shopify store to import your shop details, products, and collections."]}),a.jsx(O,{className:"w-full",onClick:()=>t("shopify"),children:"Connect Shopify"})]}),a.jsxs(Ut,{value:"bigcommerce",className:"mt-4",children:[a.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:[" ","Connect to your BigCommerce store to import your store settings and product catalog."]}),a.jsx(O,{className:"w-full",onClick:()=>t("bigcommerce"),children:"Connect BigCommerce"})]})]})}),a.jsx(pd,{children:a.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[" ","You will be guided through a few steps to connect and confirm the data to be imported."]})})]}),tIe=({onClose:t})=>a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-8 max-w-sm w-full text-center",children:[a.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800 dark:hover:text-gray-200",children:a.jsx(Hi,{size:24})}),a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create Unlimited Stores"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Sign up or log in to create more stores and unlock all features."}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx(zn,{to:"/auth",children:a.jsx(O,{size:"lg",className:"w-full",children:"Sign Up"})}),a.jsx(zn,{to:"/auth",children:a.jsx(O,{variant:"outline",size:"lg",className:"w-full",children:"Log In"})})]})]})}),nIe=()=>{var w;const t=Ca(),[e,n]=p.useState(!1),[r,s]=p.useState(!1),[i,o]=p.useState(null),[l,c]=p.useState("ai-prompt"),[u,d]=p.useState(!1),{isAuthModalOpen:h,closeAuthModal:f}=$n(),m=()=>{n(!0)},g=()=>{n(!1)},x=_=>{o(_),n(!1),s(!0)},v=()=>{s(!1),o(null)};return p.useEffect(()=>{let _,C;return _=setInterval(()=>{d(!0),C=setTimeout(()=>{d(!1)},2500)},5e3),()=>{clearInterval(_),clearTimeout(C)}},[]),a.jsxs("div",{className:"min-h-screen flex flex-col bg-[#ededed] dark:bg-[#131314]",children:[" ",a.jsx(YW,{}),a.jsxs(It.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"flex-1 container mx-auto px-4 py-8",children:[a.jsxs(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-10",children:[a.jsx("h1",{className:`text-4xl md:text-5xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-gray-600 to-gray-200 dark:from-gray-500 dark:to-gray-300 ${u?"animate-shimmer bg-200%":"bg-auto"}`,children:"Start Fresh"}),a.jsxs("p",{className:"text-lg font-inter text-muted-foreground max-w-3xl mx-auto",children:["You can create a store 3 ways: ",a.jsx("br",{})," Prompt, Steps or Import."]})]}),a.jsxs(_i,{value:l,onValueChange:c,className:"w-full max-w-3xl mx-auto mb-12",children:[a.jsxs(ni,{className:"grid w-full grid-cols-2 md:grid-cols-3 mb-6",children:[a.jsxs(Vt,{value:"ai-prompt",children:[a.jsx("span",{className:"hidden sm:inline",children:"AI Prompt"}),a.jsx("span",{className:"sm:hidden",children:"AI Prompt"})]}),a.jsxs(Vt,{value:"wizard",children:[a.jsx("span",{className:"hidden sm:inline",children:"Step-by-Step"}),a.jsx("span",{className:"sm:hidden",children:"Steps"})]}),a.jsx(Vt,{value:"store-import",className:"hidden md:inline-flex",onClick:m,children:"Import Store"})]}),a.jsx(Ut,{value:"ai-prompt",children:a.jsx(f1e,{generatedImage:(w=t.state)==null?void 0:w.generatedImage})}),a.jsx(Ut,{value:"wizard",children:a.jsx(LH,{})}),a.jsxs(Ut,{value:"store-import",className:"text-center py-8",children:[" ",a.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Import data from Shopify or BigCommerce."})," ",a.jsxs(O,{onClick:m,variant:"default",size:"lg",children:[a.jsx(x2,{className:"mr-2 h-5 w-5"}),"Select Import Source"]})]})]}),a.jsxs("div",{className:"mb-8 flex justify-center md:hidden",children:[" ",a.jsxs(O,{onClick:m,variant:"outline",size:"lg",className:"w-full max-w-xs",children:[a.jsx(x2,{className:"mr-2 h-5 w-5"}),"Import Store Data"]})]}),a.jsx(A1e,{})]}),a.jsx("footer",{className:"mt-auto py-6 text-center text-sm text-muted-foreground",children:a.jsxs("p",{children:["© ",new Date().getFullYear()," FreshFront. All rights reserved."]})}),e&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx(eIe,{onSelectSource:x,onClose:g})}),i&&a.jsx(Z1e,{isOpen:r,onClose:v,initialImportSource:i}),h&&a.jsx(tIe,{onClose:f})]})};var a_="Popover",[FH,JRe]=bi(a_,[n_]),ly=n_(),[rIe,Yc]=FH(a_),OH=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!1}=t,l=ly(e),c=p.useRef(null),[u,d]=p.useState(!1),[h,f]=Oc({prop:r,defaultProp:s??!1,onChange:i,caller:a_});return a.jsx(Y7,{...l,children:a.jsx(rIe,{scope:e,contentId:ic(),triggerRef:c,open:h,onOpenChange:f,onOpenToggle:p.useCallback(()=>f(m=>!m),[f]),hasCustomAnchor:u,onCustomAnchorAdd:p.useCallback(()=>d(!0),[]),onCustomAnchorRemove:p.useCallback(()=>d(!1),[]),modal:o,children:n})})};OH.displayName=a_;var $H="PopoverAnchor",sIe=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Yc($H,n),i=ly(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=s;return p.useEffect(()=>(o(),()=>l()),[o,l]),a.jsx(DA,{...i,...r,ref:e})});sIe.displayName=$H;var VH="PopoverTrigger",UH=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Yc(VH,n),i=ly(n),o=yn(e,s.triggerRef),l=a.jsx(Yt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":HH(s.open),...r,ref:o,onClick:gt(t.onClick,s.onOpenToggle)});return s.hasCustomAnchor?l:a.jsx(DA,{asChild:!0,...i,children:l})});UH.displayName=VH;var qA="PopoverPortal",[iIe,oIe]=FH(qA,{forceMount:void 0}),BH=t=>{const{__scopePopover:e,forceMount:n,children:r,container:s}=t,i=Yc(qA,e);return a.jsx(iIe,{scope:e,forceMount:n,children:a.jsx(vs,{present:n||i.open,children:a.jsx(_g,{asChild:!0,container:s,children:r})})})};BH.displayName=qA;var mf="PopoverContent",zH=p.forwardRef((t,e)=>{const n=oIe(mf,t.__scopePopover),{forceMount:r=n.forceMount,...s}=t,i=Yc(mf,t.__scopePopover);return a.jsx(vs,{present:r||i.open,children:i.modal?a.jsx(lIe,{...s,ref:e}):a.jsx(cIe,{...s,ref:e})})});zH.displayName=mf;var aIe=Wu("PopoverContent.RemoveScroll"),lIe=p.forwardRef((t,e)=>{const n=Yc(mf,t.__scopePopover),r=p.useRef(null),s=yn(e,r),i=p.useRef(!1);return p.useEffect(()=>{const o=r.current;if(o)return O0(o)},[]),a.jsx(LI,{as:aIe,allowPinchZoom:!0,children:a.jsx(GH,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gt(t.onCloseAutoFocus,o=>{var l;o.preventDefault(),i.current||(l=n.triggerRef.current)==null||l.focus()}),onPointerDownOutside:gt(t.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:gt(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),cIe=p.forwardRef((t,e)=>{const n=Yc(mf,t.__scopePopover),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(GH,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),GH=p.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:d,...h}=t,f=Yc(mf,n),m=ly(n);return DI(),a.jsx(L0,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(bg,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:d,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>f.onOpenChange(!1),children:a.jsx(J7,{"data-state":HH(f.open),role:"dialog",id:f.contentId,...m,...h,ref:e,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),WH="PopoverClose",uIe=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Yc(WH,n);return a.jsx(Yt.button,{type:"button",...r,ref:e,onClick:gt(t.onClick,()=>s.onOpenChange(!1))})});uIe.displayName=WH;var dIe="PopoverArrow",hIe=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=ly(n);return a.jsx(Q7,{...s,...r,ref:e})});hIe.displayName=dIe;function HH(t){return t?"open":"closed"}var fIe=OH,mIe=UH,pIe=BH,qH=zH;const sF=fIe,iF=mIe,i1=p.forwardRef(({className:t,align:e="center",sideOffset:n=4,...r},s)=>a.jsx(pIe,{children:a.jsx(qH,{ref:s,align:e,sideOffset:n,className:bt("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));i1.displayName=qH.displayName;const gIe=({store:t,onEdit:e,currentTemplate:n,onTemplateChange:r,availableTemplates:s=[]})=>{const i=ti(),{toast:o}=as(),{viewMode:l,setViewMode:c,currentStore:u,updateStore:d,updateStoreTemplateVersion:h,user:f}=$n(),m=async()=>{if(!f||!f.email){o({title:"Authentication Error",description:"You must be logged in with a valid email to onboard with Stripe.",variant:"destructive"});return}o({title:"Redirecting to Stripe...",description:"Please wait while we connect you to Stripe for onboarding."});try{const j=uf(),E=await mc(j,"stripeCreateConnectAccount")({email:f.email}),{accountLinkUrl:I}=E.data;if(I)window.location.href=I;else throw new Error("Account link URL not returned from function.")}catch(j){console.error("Error creating Stripe Connect account link:",j),o({title:"Error",description:"Could not initiate Stripe onboarding. Please try again.",variant:"destructive"})}},g=async()=>{if(!(!u||!u.stripe_account_id)){o({title:"Generating Dashboard Link...",description:"Please wait while we connect you to Stripe."});try{const j=uf(),E=await mc(j,"stripeCreateLoginLink")({stripeAccountId:u.stripe_account_id}),{loginLinkUrl:I}=E.data;if(I)window.open(I,"_blank");else throw new Error("Login link URL not returned from function.")}catch(j){console.error("Error creating Stripe login link:",j),o({title:"Error",description:"Could not create a link to the Stripe dashboard. Please try again.",variant:"destructive"})}}},x=()=>{t&&t.name?(navigator.clipboard.writeText(`${window.location.origin}/${t.name}`),o({title:"Link Copied",description:"Store link has been copied to clipboard."})):o({title:"Error",description:"Could not copy link: Store name not available.",variant:"destructive"})},v=()=>{const j=l==="edit"?"published":"edit";c(j),o({title:`Switched to ${j==="published"?"Consumer View":"Admin View"}`,description:`Store is now in ${j==="published"?"consumer":"admin editing"} mode.`})},w=j=>{r&&r(j)},_=async j=>{let A=j;if(j==="classic"&&(A="v1"),t&&t.id&&A&&A!==t.template_version)try{await h(t.id,A),o({title:"Template Saved",description:`Store template successfully changed to ${j}.`,className:"bg-green-500 text-white"})}catch(E){console.error("Failed to save template:",E),o({title:"Save Failed",description:"Could not save the template change. Please try again.",variant:"destructive"})}else A===t.template_version&&o({title:"No Change",description:`Store is already using the ${j} template.`})},C=()=>{l!=="edit"&&c("edit"),e()},T=async()=>{if(t&&t.id)try{await d(t.id,{published_at:new Date().toISOString(),status:"published"}),o({title:"Store Published!",description:`${t.name} is now live.`,className:"bg-green-500 text-white"})}catch(j){console.error("Failed to publish store:",j),o({title:"Publish Failed",description:"Could not publish the store. Please try again.",variant:"destructive"})}};return l==="published"?a.jsx("button",{onClick:()=>c("edit"),className:"fixed bottom-4 left-4 p-2 z-50 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:"Open Admin Controls","aria-label":"Open Admin Controls",children:a.jsx(Ch,{className:"h-6 w-6 text-gray-500 opacity-50 hover:opacity-75 dark:text-gray-400"})}):a.jsx(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"fixed bottom-0 left-0 right-0 bg-background/80 backdrop-blur-md border-t z-50 py-3",children:a.jsxs("div",{className:"container mx-auto px-4 flex items-center justify-between overflow-x-auto",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O,{variant:"outline",size:"icon",className:"aspect-square",onClick:()=>i("/"),title:"Back",children:a.jsx(Wi,{className:"h-4 w-4"})}),a.jsxs("div",{className:"hidden sm:flex items-center gap-1",children:[a.jsxs(gc,{value:n||"",onValueChange:w,children:[a.jsxs(Qa,{className:"w-[180px] h-9 text-sm",children:[a.jsx(Zv,{className:"mr-2 h-4 w-4"}),a.jsx(yc,{placeholder:"Switch Template"})]}),a.jsx(Xa,{children:s.map(j=>a.jsx(Qn,{value:j,children:j.charAt(0).toUpperCase()+j.slice(1)},j))})]}),n&&n!==(t==null?void 0:t.template_version)&&a.jsx(O,{variant:"outline",size:"icon",className:"h-9 w-9 border-green-500 text-green-500 hover:bg-green-50 hover:text-green-600",onClick:()=>_(n),title:`Save ${n.charAt(0).toUpperCase()+n.slice(1)} Template`,children:a.jsx(Eg,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"sm:hidden",children:a.jsxs(sF,{children:[a.jsx(iF,{asChild:!0,children:a.jsx(O,{variant:"outline",size:"icon",children:a.jsx(Zv,{className:"h-4 w-4"})})}),a.jsx(i1,{className:"w-48",children:a.jsx("div",{className:"grid gap-2",children:s.map(j=>a.jsx(O,{variant:n===j?"solid":"ghost",onClick:()=>w(j),className:"w-full justify-start",children:j.charAt(0).toUpperCase()+j.slice(1)},j))})})]})}),a.jsx(O,{variant:"outline",size:"icon",onClick:x,title:"Copy Link",children:a.jsx(AI,{className:"h-4 w-4"})}),u&&u.stripe_account_id?a.jsxs(O,{variant:"outline",size:"sm",onClick:g,children:[a.jsx("span",{className:"hidden sm:inline",children:"Dashboard"}),a.jsx(Yl,{className:"sm:ml-2 h-4 w-4"})]}):a.jsxs(sF,{children:[a.jsx(iF,{asChild:!0,children:a.jsxs(O,{variant:"outline",size:"sm",children:[a.jsx("span",{className:"hidden sm:inline",children:"Dashboard"}),a.jsx(Yl,{className:"sm:ml-2 h-4 w-4"})]})}),a.jsx(i1,{className:"w-80",children:a.jsxs("div",{className:"grid gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"font-medium leading-none",children:"No active business account"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect with Stripe to manage your payments and payouts."})]}),a.jsxs(O,{onClick:m,children:["Onboard with ",a.jsx("img",{src:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Stripelogo.PNG?alt=media&token=7b989f42-b2c9-4a3c-a7e1-9ed280b6a9ea",alt:"Stripe",className:"inline-block h-4 ml-2"})]})]})})]}),a.jsx(O,{asChild:!0,size:"sm",variant:"outline",disabled:!u||!u.name,children:a.jsxs(zn,{to:u&&u.name?`/${u.name}/content-creation`:"#",state:{storeData:u},children:[a.jsx(Er,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Create"})]})}),a.jsxs(O,{size:"sm",onClick:C,children:[a.jsx(Op,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),a.jsxs(O,{size:"sm",onClick:v,variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-50 hover:text-green-700",children:[a.jsx(Lie,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Customer"})]}),a.jsxs(O,{size:"sm",onClick:T,className:"bg-green-500 hover:bg-green-600 text-white hidden sm:flex",children:[a.jsx(Lo,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Publish"})]})]})]})})},yIe=({store:t,open:e,onOpenChange:n})=>{var h;ti();const{updateStore:r,isLoadingStores:s}=$n(),[i,o]=p.useState({name:t.name,description:t.description,type:t.type,theme:{primaryColor:t.theme.primaryColor,secondaryColor:t.theme.secondaryColor,fontFamily:t.theme.fontFamily,layout:t.theme.layout},settings:{showThemeToggle:((h=t.settings)==null?void 0:h.showThemeToggle)??!0}}),l=f=>{const{name:m,value:g}=f.target;o(x=>({...x,[m]:g}))},c=(f,m)=>{o(g=>({...g,theme:{...g.theme,[f]:m}}))},u=(f,m)=>{o(g=>({...g,settings:{...g.settings,[f]:m}}))},d=f=>{f.preventDefault();const m={name:i.name,description:i.description,type:i.type,theme:i.theme,settings:i.settings};r(t.id,m),n(!1)};return a.jsx(Yr,{open:e,onOpenChange:n,children:a.jsxs(Vr,{className:"sm:max-w-[600px] max-h-[85vh] overflow-y-auto",children:[a.jsxs(Ur,{children:[a.jsx(Br,{children:"Edit Store"}),a.jsx(Qi,{children:"Customize your store's details and appearance."})]}),a.jsxs("form",{onSubmit:d,className:"space-y-6 py-4",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"name",children:"Store Name"}),a.jsx(Je,{id:"name",name:"name",value:i.name,onChange:l,required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"description",children:"Description"}),a.jsx(En,{id:"description",name:"description",value:i.description,onChange:l,rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"type",children:"Store Type"}),a.jsxs(gc,{value:i.type,onValueChange:f=>o(m=>({...m,type:f})),children:[a.jsx(Qa,{id:"type",children:a.jsx(yc,{placeholder:"Select store type"})}),a.jsxs(Xa,{children:[a.jsx(Qn,{value:"fashion",children:"Fashion"}),a.jsx(Qn,{value:"electronics",children:"Electronics"}),a.jsx(Qn,{value:"food",children:"Food"}),a.jsx(Qn,{value:"jewelry",children:"Jewelry"}),a.jsx(Qn,{value:"general",children:"General"})]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-sm font-medium",children:"Theme Settings"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"primaryColor",children:"Primary Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{id:"primaryColor",name:"primaryColor",type:"color",value:i.theme.primaryColor,onChange:f=>c("primaryColor",f.target.value),className:"w-12 h-10 p-1"}),a.jsx(Je,{value:i.theme.primaryColor,onChange:f=>c("primaryColor",f.target.value),className:"flex-1"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"secondaryColor",children:"Secondary Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{id:"secondaryColor",name:"secondaryColor",type:"color",value:i.theme.secondaryColor,onChange:f=>c("secondaryColor",f.target.value),className:"w-12 h-10 p-1"}),a.jsx(Je,{value:i.theme.secondaryColor,onChange:f=>c("secondaryColor",f.target.value),className:"flex-1"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"fontFamily",children:"Font Family"}),a.jsxs(gc,{value:i.theme.fontFamily,onValueChange:f=>c("fontFamily",f),children:[a.jsx(Qa,{id:"fontFamily",children:a.jsx(yc,{placeholder:"Select font"})}),a.jsxs(Xa,{children:[a.jsx(Qn,{value:"Inter",children:"Inter"}),a.jsx(Qn,{value:"Roboto",children:"Roboto"}),a.jsx(Qn,{value:"Poppins",children:"Poppins"}),a.jsx(Qn,{value:"Montserrat",children:"Montserrat"}),a.jsx(Qn,{value:"Open Sans",children:"Open Sans"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"layout",children:"Layout Style"}),a.jsxs(gc,{value:i.theme.layout,onValueChange:f=>c("layout",f),children:[a.jsx(Qa,{id:"layout",children:a.jsx(yc,{placeholder:"Select layout"})}),a.jsxs(Xa,{children:[a.jsx(Qn,{value:"grid",children:"Grid"}),a.jsx(Qn,{value:"list",children:"List"}),a.jsx(Qn,{value:"masonry",children:"Masonry"}),a.jsx(Qn,{value:"carousel",children:"Carousel"})]})]})]}),a.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[a.jsx(je,{htmlFor:"showThemeToggle",className:"flex items-center",children:"Show Light/Dark Mode Toggle in Store Header"}),a.jsx(Ro,{id:"showThemeToggle",checked:i.settings.showThemeToggle,onCheckedChange:f=>u("showThemeToggle",f),disabled:s}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Allows customers to switch between light and dark themes on your store page."})]})]})]})]}),a.jsx(Ar,{children:a.jsx(O,{type:"submit",disabled:s,children:"Save Changes"})})]})]})})};function xIe(t,e){const n=e||{};return(t[t.length-1]===""?[...t,""]:t).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const vIe=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,wIe=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,bIe={};function oF(t,e){return((e||bIe).jsx?wIe:vIe).test(t)}const _Ie=/[ \t\n\f\r]/g;function SIe(t){return typeof t=="object"?t.type==="text"?aF(t.value):!1:aF(t)}function aF(t){return t.replace(_Ie,"")===""}class cy{constructor(e,n,r){this.normal=n,this.property=e,r&&(this.space=r)}}cy.prototype.normal={};cy.prototype.property={};cy.prototype.space=void 0;function KH(t,e){const n={},r={};for(const s of t)Object.assign(n,s.property),Object.assign(r,s.normal);return new cy(n,r,e)}function o1(t){return t.toLowerCase()}class Si{constructor(e,n){this.attribute=n,this.property=e}}Si.prototype.attribute="";Si.prototype.booleanish=!1;Si.prototype.boolean=!1;Si.prototype.commaOrSpaceSeparated=!1;Si.prototype.commaSeparated=!1;Si.prototype.defined=!1;Si.prototype.mustUseProperty=!1;Si.prototype.number=!1;Si.prototype.overloadedBoolean=!1;Si.prototype.property="";Si.prototype.spaceSeparated=!1;Si.prototype.space=void 0;let CIe=0;const rn=wd(),Fr=wd(),a1=wd(),et=wd(),Bn=wd(),Dh=wd(),Pi=wd();function wd(){return 2**++CIe}const l1=Object.freeze(Object.defineProperty({__proto__:null,boolean:rn,booleanish:Fr,commaOrSpaceSeparated:Pi,commaSeparated:Dh,number:et,overloadedBoolean:a1,spaceSeparated:Bn},Symbol.toStringTag,{value:"Module"})),rC=Object.keys(l1);class KA extends Si{constructor(e,n,r,s){let i=-1;if(super(e,n),lF(this,"space",s),typeof r=="number")for(;++i<rC.length;){const o=rC[i];lF(this,rC[i],(r&l1[o])===l1[o])}}}KA.prototype.defined=!0;function lF(t,e,n){n&&(t[e]=n)}function jf(t){const e={},n={};for(const[r,s]of Object.entries(t.properties)){const i=new KA(r,t.transform(t.attributes||{},r),s,t.space);t.mustUseProperty&&t.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),e[r]=i,n[o1(r)]=r,n[o1(i.attribute)]=r}return new cy(e,n,t.space)}const YH=jf({properties:{ariaActiveDescendant:null,ariaAtomic:Fr,ariaAutoComplete:null,ariaBusy:Fr,ariaChecked:Fr,ariaColCount:et,ariaColIndex:et,ariaColSpan:et,ariaControls:Bn,ariaCurrent:null,ariaDescribedBy:Bn,ariaDetails:null,ariaDisabled:Fr,ariaDropEffect:Bn,ariaErrorMessage:null,ariaExpanded:Fr,ariaFlowTo:Bn,ariaGrabbed:Fr,ariaHasPopup:null,ariaHidden:Fr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Bn,ariaLevel:et,ariaLive:null,ariaModal:Fr,ariaMultiLine:Fr,ariaMultiSelectable:Fr,ariaOrientation:null,ariaOwns:Bn,ariaPlaceholder:null,ariaPosInSet:et,ariaPressed:Fr,ariaReadOnly:Fr,ariaRelevant:null,ariaRequired:Fr,ariaRoleDescription:Bn,ariaRowCount:et,ariaRowIndex:et,ariaRowSpan:et,ariaSelected:Fr,ariaSetSize:et,ariaSort:null,ariaValueMax:et,ariaValueMin:et,ariaValueNow:et,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function JH(t,e){return e in t?t[e]:e}function QH(t,e){return JH(t,e.toLowerCase())}const EIe=jf({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Dh,acceptCharset:Bn,accessKey:Bn,action:null,allow:null,allowFullScreen:rn,allowPaymentRequest:rn,allowUserMedia:rn,alt:null,as:null,async:rn,autoCapitalize:null,autoComplete:Bn,autoFocus:rn,autoPlay:rn,blocking:Bn,capture:null,charSet:null,checked:rn,cite:null,className:Bn,cols:et,colSpan:null,content:null,contentEditable:Fr,controls:rn,controlsList:Bn,coords:et|Dh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:rn,defer:rn,dir:null,dirName:null,disabled:rn,download:a1,draggable:Fr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:rn,formTarget:null,headers:Bn,height:et,hidden:a1,high:et,href:null,hrefLang:null,htmlFor:Bn,httpEquiv:Bn,id:null,imageSizes:null,imageSrcSet:null,inert:rn,inputMode:null,integrity:null,is:null,isMap:rn,itemId:null,itemProp:Bn,itemRef:Bn,itemScope:rn,itemType:Bn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:rn,low:et,manifest:null,max:null,maxLength:et,media:null,method:null,min:null,minLength:et,multiple:rn,muted:rn,name:null,nonce:null,noModule:rn,noValidate:rn,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:rn,optimum:et,pattern:null,ping:Bn,placeholder:null,playsInline:rn,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:rn,referrerPolicy:null,rel:Bn,required:rn,reversed:rn,rows:et,rowSpan:et,sandbox:Bn,scope:null,scoped:rn,seamless:rn,selected:rn,shadowRootClonable:rn,shadowRootDelegatesFocus:rn,shadowRootMode:null,shape:null,size:et,sizes:null,slot:null,span:et,spellCheck:Fr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:et,step:null,style:null,tabIndex:et,target:null,title:null,translate:null,type:null,typeMustMatch:rn,useMap:null,value:Fr,width:et,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Bn,axis:null,background:null,bgColor:null,border:et,borderColor:null,bottomMargin:et,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:rn,declare:rn,event:null,face:null,frame:null,frameBorder:null,hSpace:et,leftMargin:et,link:null,longDesc:null,lowSrc:null,marginHeight:et,marginWidth:et,noResize:rn,noHref:rn,noShade:rn,noWrap:rn,object:null,profile:null,prompt:null,rev:null,rightMargin:et,rules:null,scheme:null,scrolling:Fr,standby:null,summary:null,text:null,topMargin:et,valueType:null,version:null,vAlign:null,vLink:null,vSpace:et,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:rn,disableRemotePlayback:rn,prefix:null,property:null,results:et,security:null,unselectable:null},space:"html",transform:QH}),TIe=jf({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Pi,accentHeight:et,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:et,amplitude:et,arabicForm:null,ascent:et,attributeName:null,attributeType:null,azimuth:et,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:et,by:null,calcMode:null,capHeight:et,className:Bn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:et,diffuseConstant:et,direction:null,display:null,dur:null,divisor:et,dominantBaseline:null,download:rn,dx:null,dy:null,edgeMode:null,editable:null,elevation:et,enableBackground:null,end:null,event:null,exponent:et,externalResourcesRequired:null,fill:null,fillOpacity:et,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Dh,g2:Dh,glyphName:Dh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:et,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:et,horizOriginX:et,horizOriginY:et,id:null,ideographic:et,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:et,k:et,k1:et,k2:et,k3:et,k4:et,kernelMatrix:Pi,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:et,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:et,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:et,overlineThickness:et,paintOrder:null,panose1:null,path:null,pathLength:et,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Bn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:et,pointsAtY:et,pointsAtZ:et,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Pi,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Pi,rev:Pi,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Pi,requiredFeatures:Pi,requiredFonts:Pi,requiredFormats:Pi,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:et,specularExponent:et,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:et,strikethroughThickness:et,string:null,stroke:null,strokeDashArray:Pi,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:et,strokeOpacity:et,strokeWidth:null,style:null,surfaceScale:et,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Pi,tabIndex:et,tableValues:null,target:null,targetX:et,targetY:et,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Pi,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:et,underlineThickness:et,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:et,values:null,vAlphabetic:et,vMathematical:et,vectorEffect:null,vHanging:et,vIdeographic:et,version:null,vertAdvY:et,vertOriginX:et,vertOriginY:et,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:et,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:JH}),XH=jf({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),ZH=jf({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:QH}),eq=jf({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),IIe={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},NIe=/[A-Z]/g,cF=/-[a-z]/g,PIe=/^data[-\w.:]+$/i;function AIe(t,e){const n=o1(e);let r=e,s=Si;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&PIe.test(e)){if(e.charAt(4)==="-"){const i=e.slice(5).replace(cF,jIe);r="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=e.slice(4);if(!cF.test(i)){let o=i.replace(NIe,kIe);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}s=KA}return new s(r,e)}function kIe(t){return"-"+t.toLowerCase()}function jIe(t){return t.charAt(1).toUpperCase()}const RIe=KH([YH,EIe,XH,ZH,eq],"html"),YA=KH([YH,TIe,XH,ZH,eq],"svg");function DIe(t){return t.join(" ").trim()}var JA={},uF=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,MIe=/\n/g,LIe=/^\s*/,FIe=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,OIe=/^:\s*/,$Ie=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,VIe=/^[;\s]*/,UIe=/^\s+|\s+$/g,BIe=`
`,dF="/",hF="*",xu="",zIe="comment",GIe="declaration",WIe=function(t,e){if(typeof t!="string")throw new TypeError("First argument must be a string");if(!t)return[];e=e||{};var n=1,r=1;function s(g){var x=g.match(MIe);x&&(n+=x.length);var v=g.lastIndexOf(BIe);r=~v?g.length-v:r+g.length}function i(){var g={line:n,column:r};return function(x){return x.position=new o(g),u(),x}}function o(g){this.start=g,this.end={line:n,column:r},this.source=e.source}o.prototype.content=t;function l(g){var x=new Error(e.source+":"+n+":"+r+": "+g);if(x.reason=g,x.filename=e.source,x.line=n,x.column=r,x.source=t,!e.silent)throw x}function c(g){var x=g.exec(t);if(x){var v=x[0];return s(v),t=t.slice(v.length),x}}function u(){c(LIe)}function d(g){var x;for(g=g||[];x=h();)x!==!1&&g.push(x);return g}function h(){var g=i();if(!(dF!=t.charAt(0)||hF!=t.charAt(1))){for(var x=2;xu!=t.charAt(x)&&(hF!=t.charAt(x)||dF!=t.charAt(x+1));)++x;if(x+=2,xu===t.charAt(x-1))return l("End of comment missing");var v=t.slice(2,x-2);return r+=2,s(v),t=t.slice(x),r+=2,g({type:zIe,comment:v})}}function f(){var g=i(),x=c(FIe);if(x){if(h(),!c(OIe))return l("property missing ':'");var v=c($Ie),w=g({type:GIe,property:fF(x[0].replace(uF,xu)),value:v?fF(v[0].replace(uF,xu)):xu});return c(VIe),w}}function m(){var g=[];d(g);for(var x;x=f();)x!==!1&&(g.push(x),d(g));return g}return u(),m()};function fF(t){return t?t.replace(UIe,xu):xu}var HIe=_v&&_v.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(JA,"__esModule",{value:!0});JA.default=KIe;var qIe=HIe(WIe);function KIe(t,e){var n=null;if(!t||typeof t!="string")return n;var r=(0,qIe.default)(t),s=typeof e=="function";return r.forEach(function(i){if(i.type==="declaration"){var o=i.property,l=i.value;s?e(o,l,i):l&&(n=n||{},n[o]=l)}}),n}var l_={};Object.defineProperty(l_,"__esModule",{value:!0});l_.camelCase=void 0;var YIe=/^--[a-zA-Z0-9_-]+$/,JIe=/-([a-z])/g,QIe=/^[^-]+$/,XIe=/^-(webkit|moz|ms|o|khtml)-/,ZIe=/^-(ms)-/,eNe=function(t){return!t||QIe.test(t)||YIe.test(t)},tNe=function(t,e){return e.toUpperCase()},mF=function(t,e){return"".concat(e,"-")},nNe=function(t,e){return e===void 0&&(e={}),eNe(t)?t:(t=t.toLowerCase(),e.reactCompat?t=t.replace(ZIe,mF):t=t.replace(XIe,mF),t.replace(JIe,tNe))};l_.camelCase=nNe;var rNe=_v&&_v.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},sNe=rNe(JA),iNe=l_;function c1(t,e){var n={};return!t||typeof t!="string"||(0,sNe.default)(t,function(r,s){r&&s&&(n[(0,iNe.camelCase)(r,e)]=s)}),n}c1.default=c1;var oNe=c1;const aNe=i0(oNe),tq=nq("end"),QA=nq("start");function nq(t){return e;function e(n){const r=n&&n.position&&n.position[t]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function lNe(t){const e=QA(t),n=tq(t);if(e&&n)return{start:e,end:n}}function mp(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?pF(t.position):"start"in t||"end"in t?pF(t):"line"in t||"column"in t?u1(t):""}function u1(t){return gF(t&&t.line)+":"+gF(t&&t.column)}function pF(t){return u1(t&&t.start)+"-"+u1(t&&t.end)}function gF(t){return t&&typeof t=="number"?t:1}class $s extends Error{constructor(e,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let s="",i={},o=!1;if(n&&("line"in n&&"column"in n?i={place:n}:"start"in n&&"end"in n?i={place:n}:"type"in n?i={ancestors:[n],place:n.position}:i={...n}),typeof e=="string"?s=e:!i.cause&&e&&(o=!0,s=e.message,i.cause=e),!i.ruleId&&!i.source&&typeof r=="string"){const c=r.indexOf(":");c===-1?i.ruleId=r:(i.source=r.slice(0,c),i.ruleId=r.slice(c+1))}if(!i.place&&i.ancestors&&i.ancestors){const c=i.ancestors[i.ancestors.length-1];c&&(i.place=c.position)}const l=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=l?l.line:void 0,this.name=mp(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=o&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}$s.prototype.file="";$s.prototype.name="";$s.prototype.reason="";$s.prototype.message="";$s.prototype.stack="";$s.prototype.column=void 0;$s.prototype.line=void 0;$s.prototype.ancestors=void 0;$s.prototype.cause=void 0;$s.prototype.fatal=void 0;$s.prototype.place=void 0;$s.prototype.ruleId=void 0;$s.prototype.source=void 0;const XA={}.hasOwnProperty,cNe=new Map,uNe=/[A-Z]/g,dNe=new Set(["table","tbody","thead","tfoot","tr"]),hNe=new Set(["td","th"]),rq="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function fNe(t,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=bNe(n,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=wNe(n,e.jsx,e.jsxs)}const s={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?YA:RIe,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},i=sq(s,t,void 0);return i&&typeof i!="string"?i:s.create(t,s.Fragment,{children:i||void 0},void 0)}function sq(t,e,n){if(e.type==="element")return mNe(t,e,n);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return pNe(t,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return yNe(t,e,n);if(e.type==="mdxjsEsm")return gNe(t,e);if(e.type==="root")return xNe(t,e,n);if(e.type==="text")return vNe(t,e)}function mNe(t,e,n){const r=t.schema;let s=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(s=YA,t.schema=s),t.ancestors.push(e);const i=oq(t,e.tagName,!1),o=_Ne(t,e);let l=ek(t,e);return dNe.has(e.tagName)&&(l=l.filter(function(c){return typeof c=="string"?!SIe(c):!0})),iq(t,o,i,e),ZA(o,l),t.ancestors.pop(),t.schema=r,t.create(e,i,o,n)}function pNe(t,e){if(e.data&&e.data.estree&&t.evaluater){const r=e.data.estree.body[0];return r.type,t.evaluater.evaluateExpression(r.expression)}mg(t,e.position)}function gNe(t,e){if(e.data&&e.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(e.data.estree);mg(t,e.position)}function yNe(t,e,n){const r=t.schema;let s=r;e.name==="svg"&&r.space==="html"&&(s=YA,t.schema=s),t.ancestors.push(e);const i=e.name===null?t.Fragment:oq(t,e.name,!0),o=SNe(t,e),l=ek(t,e);return iq(t,o,i,e),ZA(o,l),t.ancestors.pop(),t.schema=r,t.create(e,i,o,n)}function xNe(t,e,n){const r={};return ZA(r,ek(t,e)),t.create(e,t.Fragment,r,n)}function vNe(t,e){return e.value}function iq(t,e,n,r){typeof n!="string"&&n!==t.Fragment&&t.passNode&&(e.node=r)}function ZA(t,e){if(e.length>0){const n=e.length>1?e:e[0];n&&(t.children=n)}}function wNe(t,e,n){return r;function r(s,i,o,l){const u=Array.isArray(o.children)?n:e;return l?u(i,o,l):u(i,o)}}function bNe(t,e){return n;function n(r,s,i,o){const l=Array.isArray(i.children),c=QA(r);return e(s,i,o,l,{columnNumber:c?c.column-1:void 0,fileName:t,lineNumber:c?c.line:void 0},void 0)}}function _Ne(t,e){const n={};let r,s;for(s in e.properties)if(s!=="children"&&XA.call(e.properties,s)){const i=CNe(t,s,e.properties[s]);if(i){const[o,l]=i;t.tableCellAlignToStyle&&o==="align"&&typeof l=="string"&&hNe.has(e.tagName)?r=l:n[o]=l}}if(r){const i=n.style||(n.style={});i[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function SNe(t,e){const n={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&t.evaluater){const i=r.data.estree.body[0];i.type;const o=i.expression;o.type;const l=o.properties[0];l.type,Object.assign(n,t.evaluater.evaluateExpression(l.argument))}else mg(t,e.position);else{const s=r.name;let i;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&t.evaluater){const l=r.value.data.estree.body[0];l.type,i=t.evaluater.evaluateExpression(l.expression)}else mg(t,e.position);else i=r.value===null?!0:r.value;n[s]=i}return n}function ek(t,e){const n=[];let r=-1;const s=t.passKeys?new Map:cNe;for(;++r<e.children.length;){const i=e.children[r];let o;if(t.passKeys){const c=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(c){const u=s.get(c)||0;o=c+"-"+u,s.set(c,u+1)}}const l=sq(t,i,o);l!==void 0&&n.push(l)}return n}function CNe(t,e,n){const r=AIe(t.schema,e);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?xIe(n):DIe(n)),r.property==="style"){let s=typeof n=="object"?n:ENe(t,String(n));return t.stylePropertyNameCase==="css"&&(s=TNe(s)),["style",s]}return[t.elementAttributeNameCase==="react"&&r.space?IIe[r.property]||r.property:r.attribute,n]}}function ENe(t,e){try{return aNe(e,{reactCompat:!0})}catch(n){if(t.ignoreInvalidStyle)return{};const r=n,s=new $s("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw s.file=t.filePath||void 0,s.url=rq+"#cannot-parse-style-attribute",s}}function oq(t,e,n){let r;if(!n)r={type:"Literal",value:e};else if(e.includes(".")){const s=e.split(".");let i=-1,o;for(;++i<s.length;){const l=oF(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};o=o?{type:"MemberExpression",object:o,property:l,computed:!!(i&&l.type==="Literal"),optional:!1}:l}r=o}else r=oF(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const s=r.value;return XA.call(t.components,s)?t.components[s]:s}if(t.evaluater)return t.evaluater.evaluateExpression(r);mg(t)}function mg(t,e){const n=new $s("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=t.filePath||void 0,n.url=rq+"#cannot-handle-mdx-estrees-without-createevaluater",n}function TNe(t){const e={};let n;for(n in t)XA.call(t,n)&&(e[INe(n)]=t[n]);return e}function INe(t){let e=t.replace(uNe,NNe);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function NNe(t){return"-"+t.toLowerCase()}const sC={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},PNe={};function ANe(t,e){const n=e||PNe,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,s=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return aq(t,r,s)}function aq(t,e,n){if(kNe(t)){if("value"in t)return t.type==="html"&&!n?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return yF(t.children,e,n)}return Array.isArray(t)?yF(t,e,n):""}function yF(t,e,n){const r=[];let s=-1;for(;++s<t.length;)r[s]=aq(t[s],e,n);return r.join("")}function kNe(t){return!!(t&&typeof t=="object")}const xF=document.createElement("i");function tk(t){const e="&"+t+";";xF.innerHTML=e;const n=xF.textContent;return n.charCodeAt(n.length-1)===59&&t!=="semi"||n===e?!1:n}function _a(t,e,n,r){const s=t.length;let i=0,o;if(e<0?e=-e>s?0:s+e:e=e>s?s:e,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(e,n),t.splice(...o);else for(n&&t.splice(e,n);i<r.length;)o=r.slice(i,i+1e4),o.unshift(e,0),t.splice(...o),i+=1e4,e+=1e4}function so(t,e){return t.length>0?(_a(t,t.length,0,e),t):e}const vF={}.hasOwnProperty;function jNe(t){const e={};let n=-1;for(;++n<t.length;)RNe(e,t[n]);return e}function RNe(t,e){let n;for(n in e){const s=(vF.call(t,n)?t[n]:void 0)||(t[n]={}),i=e[n];let o;if(i)for(o in i){vF.call(s,o)||(s[o]=[]);const l=i[o];DNe(s[o],Array.isArray(l)?l:l?[l]:[])}}}function DNe(t,e){let n=-1;const r=[];for(;++n<e.length;)(e[n].add==="after"?t:r).push(e[n]);_a(t,0,0,r)}function lq(t,e){const n=Number.parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"�":String.fromCodePoint(n)}function Mh(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const ra=Jc(/[A-Za-z]/),Ui=Jc(/[\dA-Za-z]/),MNe=Jc(/[#-'*+\--9=?A-Z^-~]/);function d1(t){return t!==null&&(t<32||t===127)}const h1=Jc(/\d/),LNe=Jc(/[\dA-Fa-f]/),FNe=Jc(/[!-/:-@[-`{-~]/);function Kt(t){return t!==null&&t<-2}function vi(t){return t!==null&&(t<0||t===32)}function bn(t){return t===-2||t===-1||t===32}const ONe=Jc(/\p{P}|\p{S}/u),$Ne=Jc(/\s/);function Jc(t){return e;function e(n){return n!==null&&n>-1&&t.test(String.fromCharCode(n))}}function Rf(t){const e=[];let n=-1,r=0,s=0;for(;++n<t.length;){const i=t.charCodeAt(n);let o="";if(i===37&&Ui(t.charCodeAt(n+1))&&Ui(t.charCodeAt(n+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(o=String.fromCharCode(i));else if(i>55295&&i<57344){const l=t.charCodeAt(n+1);i<56320&&l>56319&&l<57344?(o=String.fromCharCode(i,l),s=1):o="�"}else o=String.fromCharCode(i);o&&(e.push(t.slice(r,n),encodeURIComponent(o)),r=n+s+1,o=""),s&&(n+=s,s=0)}return e.join("")+t.slice(r)}function Hn(t,e,n,r){const s=r?r-1:Number.POSITIVE_INFINITY;let i=0;return o;function o(c){return bn(c)?(t.enter(n),l(c)):e(c)}function l(c){return bn(c)&&i++<s?(t.consume(c),l):(t.exit(n),e(c))}}const VNe={tokenize:UNe};function UNe(t){const e=t.attempt(this.parser.constructs.contentInitial,r,s);let n;return e;function r(l){if(l===null){t.consume(l);return}return t.enter("lineEnding"),t.consume(l),t.exit("lineEnding"),Hn(t,e,"linePrefix")}function s(l){return t.enter("paragraph"),i(l)}function i(l){const c=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=c),n=c,o(l)}function o(l){if(l===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(l);return}return Kt(l)?(t.consume(l),t.exit("chunkText"),i):(t.consume(l),o)}}const BNe={tokenize:zNe},wF={tokenize:GNe};function zNe(t){const e=this,n=[];let r=0,s,i,o;return l;function l(C){if(r<n.length){const T=n[r];return e.containerState=T[1],t.attempt(T[0].continuation,c,u)(C)}return u(C)}function c(C){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,s&&_();const T=e.events.length;let j=T,A;for(;j--;)if(e.events[j][0]==="exit"&&e.events[j][1].type==="chunkFlow"){A=e.events[j][1].end;break}w(r);let E=T;for(;E<e.events.length;)e.events[E][1].end={...A},E++;return _a(e.events,j+1,0,e.events.slice(T)),e.events.length=E,u(C)}return l(C)}function u(C){if(r===n.length){if(!s)return f(C);if(s.currentConstruct&&s.currentConstruct.concrete)return g(C);e.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(wF,d,h)(C)}function d(C){return s&&_(),w(r),f(C)}function h(C){return e.parser.lazy[e.now().line]=r!==n.length,o=e.now().offset,g(C)}function f(C){return e.containerState={},t.attempt(wF,m,g)(C)}function m(C){return r++,n.push([e.currentConstruct,e.containerState]),f(C)}function g(C){if(C===null){s&&_(),w(0),t.consume(C);return}return s=s||e.parser.flow(e.now()),t.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),x(C)}function x(C){if(C===null){v(t.exit("chunkFlow"),!0),w(0),t.consume(C);return}return Kt(C)?(t.consume(C),v(t.exit("chunkFlow")),r=0,e.interrupt=void 0,l):(t.consume(C),x)}function v(C,T){const j=e.sliceStream(C);if(T&&j.push(null),C.previous=i,i&&(i.next=C),i=C,s.defineSkip(C.start),s.write(j),e.parser.lazy[C.start.line]){let A=s.events.length;for(;A--;)if(s.events[A][1].start.offset<o&&(!s.events[A][1].end||s.events[A][1].end.offset>o))return;const E=e.events.length;let I=E,N,k;for(;I--;)if(e.events[I][0]==="exit"&&e.events[I][1].type==="chunkFlow"){if(N){k=e.events[I][1].end;break}N=!0}for(w(r),A=E;A<e.events.length;)e.events[A][1].end={...k},A++;_a(e.events,I+1,0,e.events.slice(E)),e.events.length=A}}function w(C){let T=n.length;for(;T-- >C;){const j=n[T];e.containerState=j[1],j[0].exit.call(e,t)}n.length=C}function _(){s.write([null]),i=void 0,s=void 0,e.containerState._closeFlow=void 0}}function GNe(t,e,n){return Hn(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function bF(t){if(t===null||vi(t)||$Ne(t))return 1;if(ONe(t))return 2}function nk(t,e,n){const r=[];let s=-1;for(;++s<t.length;){const i=t[s].resolveAll;i&&!r.includes(i)&&(e=i(e,n),r.push(i))}return e}const f1={name:"attention",resolveAll:WNe,tokenize:HNe};function WNe(t,e){let n=-1,r,s,i,o,l,c,u,d;for(;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(r=n;r--;)if(t[r][0]==="exit"&&t[r][1].type==="attentionSequence"&&t[r][1]._open&&e.sliceSerialize(t[r][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[r][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[r][1].end.offset-t[r][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;c=t[r][1].end.offset-t[r][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1;const h={...t[r][1].end},f={...t[n][1].start};_F(h,-c),_F(f,c),o={type:c>1?"strongSequence":"emphasisSequence",start:h,end:{...t[r][1].end}},l={type:c>1?"strongSequence":"emphasisSequence",start:{...t[n][1].start},end:f},i={type:c>1?"strongText":"emphasisText",start:{...t[r][1].end},end:{...t[n][1].start}},s={type:c>1?"strong":"emphasis",start:{...o.start},end:{...l.end}},t[r][1].end={...o.start},t[n][1].start={...l.end},u=[],t[r][1].end.offset-t[r][1].start.offset&&(u=so(u,[["enter",t[r][1],e],["exit",t[r][1],e]])),u=so(u,[["enter",s,e],["enter",o,e],["exit",o,e],["enter",i,e]]),u=so(u,nk(e.parser.constructs.insideSpan.null,t.slice(r+1,n),e)),u=so(u,[["exit",i,e],["enter",l,e],["exit",l,e],["exit",s,e]]),t[n][1].end.offset-t[n][1].start.offset?(d=2,u=so(u,[["enter",t[n][1],e],["exit",t[n][1],e]])):d=0,_a(t,r-1,n-r+3,u),n=r+u.length-d-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function HNe(t,e){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,s=bF(r);let i;return o;function o(c){return i=c,t.enter("attentionSequence"),l(c)}function l(c){if(c===i)return t.consume(c),l;const u=t.exit("attentionSequence"),d=bF(c),h=!d||d===2&&s||n.includes(c),f=!s||s===2&&d||n.includes(r);return u._open=!!(i===42?h:h&&(s||!f)),u._close=!!(i===42?f:f&&(d||!h)),e(c)}}function _F(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const qNe={name:"autolink",tokenize:KNe};function KNe(t,e,n){let r=0;return s;function s(m){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),i}function i(m){return ra(m)?(t.consume(m),o):m===64?n(m):u(m)}function o(m){return m===43||m===45||m===46||Ui(m)?(r=1,l(m)):u(m)}function l(m){return m===58?(t.consume(m),r=0,c):(m===43||m===45||m===46||Ui(m))&&r++<32?(t.consume(m),l):(r=0,u(m))}function c(m){return m===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):m===null||m===32||m===60||d1(m)?n(m):(t.consume(m),c)}function u(m){return m===64?(t.consume(m),d):MNe(m)?(t.consume(m),u):n(m)}function d(m){return Ui(m)?h(m):n(m)}function h(m){return m===46?(t.consume(m),r=0,d):m===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):f(m)}function f(m){if((m===45||Ui(m))&&r++<63){const g=m===45?f:h;return t.consume(m),g}return n(m)}}const c_={partial:!0,tokenize:YNe};function YNe(t,e,n){return r;function r(i){return bn(i)?Hn(t,s,"linePrefix")(i):s(i)}function s(i){return i===null||Kt(i)?e(i):n(i)}}const cq={continuation:{tokenize:QNe},exit:XNe,name:"blockQuote",tokenize:JNe};function JNe(t,e,n){const r=this;return s;function s(o){if(o===62){const l=r.containerState;return l.open||(t.enter("blockQuote",{_container:!0}),l.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(o),t.exit("blockQuoteMarker"),i}return n(o)}function i(o){return bn(o)?(t.enter("blockQuotePrefixWhitespace"),t.consume(o),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(o))}}function QNe(t,e,n){const r=this;return s;function s(o){return bn(o)?Hn(t,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):i(o)}function i(o){return t.attempt(cq,e,n)(o)}}function XNe(t){t.exit("blockQuote")}const uq={name:"characterEscape",tokenize:ZNe};function ZNe(t,e,n){return r;function r(i){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(i),t.exit("escapeMarker"),s}function s(i){return FNe(i)?(t.enter("characterEscapeValue"),t.consume(i),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(i)}}const dq={name:"characterReference",tokenize:ePe};function ePe(t,e,n){const r=this;let s=0,i,o;return l;function l(h){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),c}function c(h){return h===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(h),t.exit("characterReferenceMarkerNumeric"),u):(t.enter("characterReferenceValue"),i=31,o=Ui,d(h))}function u(h){return h===88||h===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(h),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),i=6,o=LNe,d):(t.enter("characterReferenceValue"),i=7,o=h1,d(h))}function d(h){if(h===59&&s){const f=t.exit("characterReferenceValue");return o===Ui&&!tk(r.sliceSerialize(f))?n(h):(t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return o(h)&&s++<i?(t.consume(h),d):n(h)}}const SF={partial:!0,tokenize:nPe},CF={concrete:!0,name:"codeFenced",tokenize:tPe};function tPe(t,e,n){const r=this,s={partial:!0,tokenize:j};let i=0,o=0,l;return c;function c(A){return u(A)}function u(A){const E=r.events[r.events.length-1];return i=E&&E[1].type==="linePrefix"?E[2].sliceSerialize(E[1],!0).length:0,l=A,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),d(A)}function d(A){return A===l?(o++,t.consume(A),d):o<3?n(A):(t.exit("codeFencedFenceSequence"),bn(A)?Hn(t,h,"whitespace")(A):h(A))}function h(A){return A===null||Kt(A)?(t.exit("codeFencedFence"),r.interrupt?e(A):t.check(SF,x,T)(A)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),f(A))}function f(A){return A===null||Kt(A)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),h(A)):bn(A)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),Hn(t,m,"whitespace")(A)):A===96&&A===l?n(A):(t.consume(A),f)}function m(A){return A===null||Kt(A)?h(A):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),g(A))}function g(A){return A===null||Kt(A)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),h(A)):A===96&&A===l?n(A):(t.consume(A),g)}function x(A){return t.attempt(s,T,v)(A)}function v(A){return t.enter("lineEnding"),t.consume(A),t.exit("lineEnding"),w}function w(A){return i>0&&bn(A)?Hn(t,_,"linePrefix",i+1)(A):_(A)}function _(A){return A===null||Kt(A)?t.check(SF,x,T)(A):(t.enter("codeFlowValue"),C(A))}function C(A){return A===null||Kt(A)?(t.exit("codeFlowValue"),_(A)):(t.consume(A),C)}function T(A){return t.exit("codeFenced"),e(A)}function j(A,E,I){let N=0;return k;function k(B){return A.enter("lineEnding"),A.consume(B),A.exit("lineEnding"),R}function R(B){return A.enter("codeFencedFence"),bn(B)?Hn(A,D,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(B):D(B)}function D(B){return B===l?(A.enter("codeFencedFenceSequence"),M(B)):I(B)}function M(B){return B===l?(N++,A.consume(B),M):N>=o?(A.exit("codeFencedFenceSequence"),bn(B)?Hn(A,z,"whitespace")(B):z(B)):I(B)}function z(B){return B===null||Kt(B)?(A.exit("codeFencedFence"),E(B)):I(B)}}}function nPe(t,e,n){const r=this;return s;function s(o){return o===null?n(o):(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i)}function i(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}const iC={name:"codeIndented",tokenize:sPe},rPe={partial:!0,tokenize:iPe};function sPe(t,e,n){const r=this;return s;function s(u){return t.enter("codeIndented"),Hn(t,i,"linePrefix",4+1)(u)}function i(u){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?o(u):n(u)}function o(u){return u===null?c(u):Kt(u)?t.attempt(rPe,o,c)(u):(t.enter("codeFlowValue"),l(u))}function l(u){return u===null||Kt(u)?(t.exit("codeFlowValue"),o(u)):(t.consume(u),l)}function c(u){return t.exit("codeIndented"),e(u)}}function iPe(t,e,n){const r=this;return s;function s(o){return r.parser.lazy[r.now().line]?n(o):Kt(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),s):Hn(t,i,"linePrefix",4+1)(o)}function i(o){const l=r.events[r.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(o):Kt(o)?s(o):n(o)}}const oPe={name:"codeText",previous:lPe,resolve:aPe,tokenize:cPe};function aPe(t){let e=t.length-4,n=3,r,s;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(r=n;++r<e;)if(t[r][1].type==="codeTextData"){t[n][1].type="codeTextPadding",t[e][1].type="codeTextPadding",n+=2,e-=2;break}}for(r=n-1,e++;++r<=e;)s===void 0?r!==e&&t[r][1].type!=="lineEnding"&&(s=r):(r===e||t[r][1].type==="lineEnding")&&(t[s][1].type="codeTextData",r!==s+2&&(t[s][1].end=t[r-1][1].end,t.splice(s+2,r-s-2),e-=r-s-2,r=s+2),s=void 0);return t}function lPe(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function cPe(t,e,n){let r=0,s,i;return o;function o(h){return t.enter("codeText"),t.enter("codeTextSequence"),l(h)}function l(h){return h===96?(t.consume(h),r++,l):(t.exit("codeTextSequence"),c(h))}function c(h){return h===null?n(h):h===32?(t.enter("space"),t.consume(h),t.exit("space"),c):h===96?(i=t.enter("codeTextSequence"),s=0,d(h)):Kt(h)?(t.enter("lineEnding"),t.consume(h),t.exit("lineEnding"),c):(t.enter("codeTextData"),u(h))}function u(h){return h===null||h===32||h===96||Kt(h)?(t.exit("codeTextData"),c(h)):(t.consume(h),u)}function d(h){return h===96?(t.consume(h),s++,d):s===r?(t.exit("codeTextSequence"),t.exit("codeText"),e(h)):(i.type="codeTextData",u(h))}}class uPe{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,n,r){const s=n||0;this.setCursor(Math.trunc(e));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return r&&dm(this.left,r),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),dm(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),dm(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const n=this.left.splice(e,Number.POSITIVE_INFINITY);dm(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);dm(this.left,n.reverse())}}}function dm(t,e){let n=0;if(e.length<1e4)t.push(...e);else for(;n<e.length;)t.push(...e.slice(n,n+1e4)),n+=1e4}function hq(t){const e={};let n=-1,r,s,i,o,l,c,u;const d=new uPe(t);for(;++n<d.length;){for(;n in e;)n=e[n];if(r=d.get(n),n&&r[1].type==="chunkFlow"&&d.get(n-1)[1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,i=0,i<c.length&&c[i][1].type==="lineEndingBlank"&&(i+=2),i<c.length&&c[i][1].type==="content"))for(;++i<c.length&&c[i][1].type!=="content";)c[i][1].type==="chunkText"&&(c[i][1]._isInFirstContentOfListItem=!0,i++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,dPe(d,n)),n=e[n],u=!0);else if(r[1]._container){for(i=n,s=void 0;i--;)if(o=d.get(i),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),o[1].type="lineEnding",s=i);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;s&&(r[1].end={...d.get(s)[1].start},l=d.slice(s,n),l.unshift(r),d.splice(s,n-s+1,l))}}return _a(t,0,Number.POSITIVE_INFINITY,d.slice(0)),!u}function dPe(t,e){const n=t.get(e)[1],r=t.get(e)[2];let s=e-1;const i=[];let o=n._tokenizer;o||(o=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const l=o.events,c=[],u={};let d,h,f=-1,m=n,g=0,x=0;const v=[x];for(;m;){for(;t.get(++s)[1]!==m;);i.push(s),m._tokenizer||(d=r.sliceStream(m),m.next||d.push(null),h&&o.defineSkip(m.start),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(d),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),h=m,m=m.next}for(m=n;++f<l.length;)l[f][0]==="exit"&&l[f-1][0]==="enter"&&l[f][1].type===l[f-1][1].type&&l[f][1].start.line!==l[f][1].end.line&&(x=f+1,v.push(x),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(o.events=[],m?(m._tokenizer=void 0,m.previous=void 0):v.pop(),f=v.length;f--;){const w=l.slice(v[f],v[f+1]),_=i.pop();c.push([_,_+w.length-1]),t.splice(_,2,w)}for(c.reverse(),f=-1;++f<c.length;)u[g+c[f][0]]=g+c[f][1],g+=c[f][1]-c[f][0]-1;return u}const hPe={resolve:mPe,tokenize:pPe},fPe={partial:!0,tokenize:gPe};function mPe(t){return hq(t),t}function pPe(t,e){let n;return r;function r(l){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),s(l)}function s(l){return l===null?i(l):Kt(l)?t.check(fPe,o,i)(l):(t.consume(l),s)}function i(l){return t.exit("chunkContent"),t.exit("content"),e(l)}function o(l){return t.consume(l),t.exit("chunkContent"),n.next=t.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,s}}function gPe(t,e,n){const r=this;return s;function s(o){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),Hn(t,i,"linePrefix")}function i(o){if(o===null||Kt(o))return n(o);const l=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(o):t.interrupt(r.parser.constructs.flow,n,e)(o)}}function fq(t,e,n,r,s,i,o,l,c){const u=c||Number.POSITIVE_INFINITY;let d=0;return h;function h(w){return w===60?(t.enter(r),t.enter(s),t.enter(i),t.consume(w),t.exit(i),f):w===null||w===32||w===41||d1(w)?n(w):(t.enter(r),t.enter(o),t.enter(l),t.enter("chunkString",{contentType:"string"}),x(w))}function f(w){return w===62?(t.enter(i),t.consume(w),t.exit(i),t.exit(s),t.exit(r),e):(t.enter(l),t.enter("chunkString",{contentType:"string"}),m(w))}function m(w){return w===62?(t.exit("chunkString"),t.exit(l),f(w)):w===null||w===60||Kt(w)?n(w):(t.consume(w),w===92?g:m)}function g(w){return w===60||w===62||w===92?(t.consume(w),m):m(w)}function x(w){return!d&&(w===null||w===41||vi(w))?(t.exit("chunkString"),t.exit(l),t.exit(o),t.exit(r),e(w)):d<u&&w===40?(t.consume(w),d++,x):w===41?(t.consume(w),d--,x):w===null||w===32||w===40||d1(w)?n(w):(t.consume(w),w===92?v:x)}function v(w){return w===40||w===41||w===92?(t.consume(w),x):x(w)}}function mq(t,e,n,r,s,i){const o=this;let l=0,c;return u;function u(m){return t.enter(r),t.enter(s),t.consume(m),t.exit(s),t.enter(i),d}function d(m){return l>999||m===null||m===91||m===93&&!c||m===94&&!l&&"_hiddenFootnoteSupport"in o.parser.constructs?n(m):m===93?(t.exit(i),t.enter(s),t.consume(m),t.exit(s),t.exit(r),e):Kt(m)?(t.enter("lineEnding"),t.consume(m),t.exit("lineEnding"),d):(t.enter("chunkString",{contentType:"string"}),h(m))}function h(m){return m===null||m===91||m===93||Kt(m)||l++>999?(t.exit("chunkString"),d(m)):(t.consume(m),c||(c=!bn(m)),m===92?f:h)}function f(m){return m===91||m===92||m===93?(t.consume(m),l++,h):h(m)}}function pq(t,e,n,r,s,i){let o;return l;function l(f){return f===34||f===39||f===40?(t.enter(r),t.enter(s),t.consume(f),t.exit(s),o=f===40?41:f,c):n(f)}function c(f){return f===o?(t.enter(s),t.consume(f),t.exit(s),t.exit(r),e):(t.enter(i),u(f))}function u(f){return f===o?(t.exit(i),c(o)):f===null?n(f):Kt(f)?(t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),Hn(t,u,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===o||f===null||Kt(f)?(t.exit("chunkString"),u(f)):(t.consume(f),f===92?h:d)}function h(f){return f===o||f===92?(t.consume(f),d):d(f)}}function pp(t,e){let n;return r;function r(s){return Kt(s)?(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),n=!0,r):bn(s)?Hn(t,r,n?"linePrefix":"lineSuffix")(s):e(s)}}const yPe={name:"definition",tokenize:vPe},xPe={partial:!0,tokenize:wPe};function vPe(t,e,n){const r=this;let s;return i;function i(m){return t.enter("definition"),o(m)}function o(m){return mq.call(r,t,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(m)}function l(m){return s=Mh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),m===58?(t.enter("definitionMarker"),t.consume(m),t.exit("definitionMarker"),c):n(m)}function c(m){return vi(m)?pp(t,u)(m):u(m)}function u(m){return fq(t,d,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(m)}function d(m){return t.attempt(xPe,h,h)(m)}function h(m){return bn(m)?Hn(t,f,"whitespace")(m):f(m)}function f(m){return m===null||Kt(m)?(t.exit("definition"),r.parser.defined.push(s),e(m)):n(m)}}function wPe(t,e,n){return r;function r(l){return vi(l)?pp(t,s)(l):n(l)}function s(l){return pq(t,i,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function i(l){return bn(l)?Hn(t,o,"whitespace")(l):o(l)}function o(l){return l===null||Kt(l)?e(l):n(l)}}const bPe={name:"hardBreakEscape",tokenize:_Pe};function _Pe(t,e,n){return r;function r(i){return t.enter("hardBreakEscape"),t.consume(i),s}function s(i){return Kt(i)?(t.exit("hardBreakEscape"),e(i)):n(i)}}const SPe={name:"headingAtx",resolve:CPe,tokenize:EPe};function CPe(t,e){let n=t.length-2,r=3,s,i;return t[r][1].type==="whitespace"&&(r+=2),n-2>r&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&t[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(s={type:"atxHeadingText",start:t[r][1].start,end:t[n][1].end},i={type:"chunkText",start:t[r][1].start,end:t[n][1].end,contentType:"text"},_a(t,r,n-r+1,[["enter",s,e],["enter",i,e],["exit",i,e],["exit",s,e]])),t}function EPe(t,e,n){let r=0;return s;function s(d){return t.enter("atxHeading"),i(d)}function i(d){return t.enter("atxHeadingSequence"),o(d)}function o(d){return d===35&&r++<6?(t.consume(d),o):d===null||vi(d)?(t.exit("atxHeadingSequence"),l(d)):n(d)}function l(d){return d===35?(t.enter("atxHeadingSequence"),c(d)):d===null||Kt(d)?(t.exit("atxHeading"),e(d)):bn(d)?Hn(t,l,"whitespace")(d):(t.enter("atxHeadingText"),u(d))}function c(d){return d===35?(t.consume(d),c):(t.exit("atxHeadingSequence"),l(d))}function u(d){return d===null||d===35||vi(d)?(t.exit("atxHeadingText"),l(d)):(t.consume(d),u)}}const TPe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],EF=["pre","script","style","textarea"],IPe={concrete:!0,name:"htmlFlow",resolveTo:APe,tokenize:kPe},NPe={partial:!0,tokenize:RPe},PPe={partial:!0,tokenize:jPe};function APe(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function kPe(t,e,n){const r=this;let s,i,o,l,c;return u;function u(F){return d(F)}function d(F){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(F),h}function h(F){return F===33?(t.consume(F),f):F===47?(t.consume(F),i=!0,x):F===63?(t.consume(F),s=3,r.interrupt?e:$):ra(F)?(t.consume(F),o=String.fromCharCode(F),v):n(F)}function f(F){return F===45?(t.consume(F),s=2,m):F===91?(t.consume(F),s=5,l=0,g):ra(F)?(t.consume(F),s=4,r.interrupt?e:$):n(F)}function m(F){return F===45?(t.consume(F),r.interrupt?e:$):n(F)}function g(F){const Z="CDATA[";return F===Z.charCodeAt(l++)?(t.consume(F),l===Z.length?r.interrupt?e:D:g):n(F)}function x(F){return ra(F)?(t.consume(F),o=String.fromCharCode(F),v):n(F)}function v(F){if(F===null||F===47||F===62||vi(F)){const Z=F===47,ce=o.toLowerCase();return!Z&&!i&&EF.includes(ce)?(s=1,r.interrupt?e(F):D(F)):TPe.includes(o.toLowerCase())?(s=6,Z?(t.consume(F),w):r.interrupt?e(F):D(F)):(s=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(F):i?_(F):C(F))}return F===45||Ui(F)?(t.consume(F),o+=String.fromCharCode(F),v):n(F)}function w(F){return F===62?(t.consume(F),r.interrupt?e:D):n(F)}function _(F){return bn(F)?(t.consume(F),_):k(F)}function C(F){return F===47?(t.consume(F),k):F===58||F===95||ra(F)?(t.consume(F),T):bn(F)?(t.consume(F),C):k(F)}function T(F){return F===45||F===46||F===58||F===95||Ui(F)?(t.consume(F),T):j(F)}function j(F){return F===61?(t.consume(F),A):bn(F)?(t.consume(F),j):C(F)}function A(F){return F===null||F===60||F===61||F===62||F===96?n(F):F===34||F===39?(t.consume(F),c=F,E):bn(F)?(t.consume(F),A):I(F)}function E(F){return F===c?(t.consume(F),c=null,N):F===null||Kt(F)?n(F):(t.consume(F),E)}function I(F){return F===null||F===34||F===39||F===47||F===60||F===61||F===62||F===96||vi(F)?j(F):(t.consume(F),I)}function N(F){return F===47||F===62||bn(F)?C(F):n(F)}function k(F){return F===62?(t.consume(F),R):n(F)}function R(F){return F===null||Kt(F)?D(F):bn(F)?(t.consume(F),R):n(F)}function D(F){return F===45&&s===2?(t.consume(F),G):F===60&&s===1?(t.consume(F),Y):F===62&&s===4?(t.consume(F),V):F===63&&s===3?(t.consume(F),$):F===93&&s===5?(t.consume(F),K):Kt(F)&&(s===6||s===7)?(t.exit("htmlFlowData"),t.check(NPe,W,M)(F)):F===null||Kt(F)?(t.exit("htmlFlowData"),M(F)):(t.consume(F),D)}function M(F){return t.check(PPe,z,W)(F)}function z(F){return t.enter("lineEnding"),t.consume(F),t.exit("lineEnding"),B}function B(F){return F===null||Kt(F)?M(F):(t.enter("htmlFlowData"),D(F))}function G(F){return F===45?(t.consume(F),$):D(F)}function Y(F){return F===47?(t.consume(F),o="",H):D(F)}function H(F){if(F===62){const Z=o.toLowerCase();return EF.includes(Z)?(t.consume(F),V):D(F)}return ra(F)&&o.length<8?(t.consume(F),o+=String.fromCharCode(F),H):D(F)}function K(F){return F===93?(t.consume(F),$):D(F)}function $(F){return F===62?(t.consume(F),V):F===45&&s===2?(t.consume(F),$):D(F)}function V(F){return F===null||Kt(F)?(t.exit("htmlFlowData"),W(F)):(t.consume(F),V)}function W(F){return t.exit("htmlFlow"),e(F)}}function jPe(t,e,n){const r=this;return s;function s(o){return Kt(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i):n(o)}function i(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}function RPe(t,e,n){return r;function r(s){return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),t.attempt(c_,e,n)}}const DPe={name:"htmlText",tokenize:MPe};function MPe(t,e,n){const r=this;let s,i,o;return l;function l($){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume($),c}function c($){return $===33?(t.consume($),u):$===47?(t.consume($),j):$===63?(t.consume($),C):ra($)?(t.consume($),I):n($)}function u($){return $===45?(t.consume($),d):$===91?(t.consume($),i=0,g):ra($)?(t.consume($),_):n($)}function d($){return $===45?(t.consume($),m):n($)}function h($){return $===null?n($):$===45?(t.consume($),f):Kt($)?(o=h,Y($)):(t.consume($),h)}function f($){return $===45?(t.consume($),m):h($)}function m($){return $===62?G($):$===45?f($):h($)}function g($){const V="CDATA[";return $===V.charCodeAt(i++)?(t.consume($),i===V.length?x:g):n($)}function x($){return $===null?n($):$===93?(t.consume($),v):Kt($)?(o=x,Y($)):(t.consume($),x)}function v($){return $===93?(t.consume($),w):x($)}function w($){return $===62?G($):$===93?(t.consume($),w):x($)}function _($){return $===null||$===62?G($):Kt($)?(o=_,Y($)):(t.consume($),_)}function C($){return $===null?n($):$===63?(t.consume($),T):Kt($)?(o=C,Y($)):(t.consume($),C)}function T($){return $===62?G($):C($)}function j($){return ra($)?(t.consume($),A):n($)}function A($){return $===45||Ui($)?(t.consume($),A):E($)}function E($){return Kt($)?(o=E,Y($)):bn($)?(t.consume($),E):G($)}function I($){return $===45||Ui($)?(t.consume($),I):$===47||$===62||vi($)?N($):n($)}function N($){return $===47?(t.consume($),G):$===58||$===95||ra($)?(t.consume($),k):Kt($)?(o=N,Y($)):bn($)?(t.consume($),N):G($)}function k($){return $===45||$===46||$===58||$===95||Ui($)?(t.consume($),k):R($)}function R($){return $===61?(t.consume($),D):Kt($)?(o=R,Y($)):bn($)?(t.consume($),R):N($)}function D($){return $===null||$===60||$===61||$===62||$===96?n($):$===34||$===39?(t.consume($),s=$,M):Kt($)?(o=D,Y($)):bn($)?(t.consume($),D):(t.consume($),z)}function M($){return $===s?(t.consume($),s=void 0,B):$===null?n($):Kt($)?(o=M,Y($)):(t.consume($),M)}function z($){return $===null||$===34||$===39||$===60||$===61||$===96?n($):$===47||$===62||vi($)?N($):(t.consume($),z)}function B($){return $===47||$===62||vi($)?N($):n($)}function G($){return $===62?(t.consume($),t.exit("htmlTextData"),t.exit("htmlText"),e):n($)}function Y($){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume($),t.exit("lineEnding"),H}function H($){return bn($)?Hn(t,K,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)($):K($)}function K($){return t.enter("htmlTextData"),o($)}}const rk={name:"labelEnd",resolveAll:$Pe,resolveTo:VPe,tokenize:UPe},LPe={tokenize:BPe},FPe={tokenize:zPe},OPe={tokenize:GPe};function $Pe(t){let e=-1;const n=[];for(;++e<t.length;){const r=t[e][1];if(n.push(t[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const s=r.type==="labelImage"?4:2;r.type="data",e+=s}}return t.length!==n.length&&_a(t,0,t.length,n),t}function VPe(t,e){let n=t.length,r=0,s,i,o,l;for(;n--;)if(s=t[n][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;t[n][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(o){if(t[n][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=n,s.type!=="labelLink")){r=2;break}}else s.type==="labelEnd"&&(o=n);const c={type:t[i][1].type==="labelLink"?"link":"image",start:{...t[i][1].start},end:{...t[t.length-1][1].end}},u={type:"label",start:{...t[i][1].start},end:{...t[o][1].end}},d={type:"labelText",start:{...t[i+r+2][1].end},end:{...t[o-2][1].start}};return l=[["enter",c,e],["enter",u,e]],l=so(l,t.slice(i+1,i+r+3)),l=so(l,[["enter",d,e]]),l=so(l,nk(e.parser.constructs.insideSpan.null,t.slice(i+r+4,o-3),e)),l=so(l,[["exit",d,e],t[o-2],t[o-1],["exit",u,e]]),l=so(l,t.slice(o+1)),l=so(l,[["exit",c,e]]),_a(t,i,t.length,l),t}function UPe(t,e,n){const r=this;let s=r.events.length,i,o;for(;s--;)if((r.events[s][1].type==="labelImage"||r.events[s][1].type==="labelLink")&&!r.events[s][1]._balanced){i=r.events[s][1];break}return l;function l(f){return i?i._inactive?h(f):(o=r.parser.defined.includes(Mh(r.sliceSerialize({start:i.end,end:r.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(f),t.exit("labelMarker"),t.exit("labelEnd"),c):n(f)}function c(f){return f===40?t.attempt(LPe,d,o?d:h)(f):f===91?t.attempt(FPe,d,o?u:h)(f):o?d(f):h(f)}function u(f){return t.attempt(OPe,d,h)(f)}function d(f){return e(f)}function h(f){return i._balanced=!0,n(f)}}function BPe(t,e,n){return r;function r(h){return t.enter("resource"),t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),s}function s(h){return vi(h)?pp(t,i)(h):i(h)}function i(h){return h===41?d(h):fq(t,o,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function o(h){return vi(h)?pp(t,c)(h):d(h)}function l(h){return n(h)}function c(h){return h===34||h===39||h===40?pq(t,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):d(h)}function u(h){return vi(h)?pp(t,d)(h):d(h)}function d(h){return h===41?(t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),t.exit("resource"),e):n(h)}}function zPe(t,e,n){const r=this;return s;function s(l){return mq.call(r,t,i,o,"reference","referenceMarker","referenceString")(l)}function i(l){return r.parser.defined.includes(Mh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(l):n(l)}function o(l){return n(l)}}function GPe(t,e,n){return r;function r(i){return t.enter("reference"),t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),s}function s(i){return i===93?(t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),t.exit("reference"),e):n(i)}}const WPe={name:"labelStartImage",resolveAll:rk.resolveAll,tokenize:HPe};function HPe(t,e,n){const r=this;return s;function s(l){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(l),t.exit("labelImageMarker"),i}function i(l){return l===91?(t.enter("labelMarker"),t.consume(l),t.exit("labelMarker"),t.exit("labelImage"),o):n(l)}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(l):e(l)}}const qPe={name:"labelStartLink",resolveAll:rk.resolveAll,tokenize:KPe};function KPe(t,e,n){const r=this;return s;function s(o){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(o),t.exit("labelMarker"),t.exit("labelLink"),i}function i(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):e(o)}}const oC={name:"lineEnding",tokenize:YPe};function YPe(t,e){return n;function n(r){return t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),Hn(t,e,"linePrefix")}}const vv={name:"thematicBreak",tokenize:JPe};function JPe(t,e,n){let r=0,s;return i;function i(u){return t.enter("thematicBreak"),o(u)}function o(u){return s=u,l(u)}function l(u){return u===s?(t.enter("thematicBreakSequence"),c(u)):r>=3&&(u===null||Kt(u))?(t.exit("thematicBreak"),e(u)):n(u)}function c(u){return u===s?(t.consume(u),r++,c):(t.exit("thematicBreakSequence"),bn(u)?Hn(t,l,"whitespace")(u):l(u))}}const li={continuation:{tokenize:eAe},exit:nAe,name:"list",tokenize:ZPe},QPe={partial:!0,tokenize:rAe},XPe={partial:!0,tokenize:tAe};function ZPe(t,e,n){const r=this,s=r.events[r.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,o=0;return l;function l(m){const g=r.containerState.type||(m===42||m===43||m===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!r.containerState.marker||m===r.containerState.marker:h1(m)){if(r.containerState.type||(r.containerState.type=g,t.enter(g,{_container:!0})),g==="listUnordered")return t.enter("listItemPrefix"),m===42||m===45?t.check(vv,n,u)(m):u(m);if(!r.interrupt||m===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),c(m)}return n(m)}function c(m){return h1(m)&&++o<10?(t.consume(m),c):(!r.interrupt||o<2)&&(r.containerState.marker?m===r.containerState.marker:m===41||m===46)?(t.exit("listItemValue"),u(m)):n(m)}function u(m){return t.enter("listItemMarker"),t.consume(m),t.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||m,t.check(c_,r.interrupt?n:d,t.attempt(QPe,f,h))}function d(m){return r.containerState.initialBlankLine=!0,i++,f(m)}function h(m){return bn(m)?(t.enter("listItemPrefixWhitespace"),t.consume(m),t.exit("listItemPrefixWhitespace"),f):n(m)}function f(m){return r.containerState.size=i+r.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(m)}}function eAe(t,e,n){const r=this;return r.containerState._closeFlow=void 0,t.check(c_,s,i);function s(l){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Hn(t,e,"listItemIndent",r.containerState.size+1)(l)}function i(l){return r.containerState.furtherBlankLines||!bn(l)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(l)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,t.attempt(XPe,e,o)(l))}function o(l){return r.containerState._closeFlow=!0,r.interrupt=void 0,Hn(t,t.attempt(li,e,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function tAe(t,e,n){const r=this;return Hn(t,s,"listItemIndent",r.containerState.size+1);function s(i){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?e(i):n(i)}}function nAe(t){t.exit(this.containerState.type)}function rAe(t,e,n){const r=this;return Hn(t,s,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4+1);function s(i){const o=r.events[r.events.length-1];return!bn(i)&&o&&o[1].type==="listItemPrefixWhitespace"?e(i):n(i)}}const TF={name:"setextUnderline",resolveTo:sAe,tokenize:iAe};function sAe(t,e){let n=t.length,r,s,i;for(;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){r=n;break}t[n][1].type==="paragraph"&&(s=n)}else t[n][1].type==="content"&&t.splice(n,1),!i&&t[n][1].type==="definition"&&(i=n);const o={type:"setextHeading",start:{...t[r][1].start},end:{...t[t.length-1][1].end}};return t[s][1].type="setextHeadingText",i?(t.splice(s,0,["enter",o,e]),t.splice(i+1,0,["exit",t[r][1],e]),t[r][1].end={...t[i][1].end}):t[r][1]=o,t.push(["exit",o,e]),t}function iAe(t,e,n){const r=this;let s;return i;function i(u){let d=r.events.length,h;for(;d--;)if(r.events[d][1].type!=="lineEnding"&&r.events[d][1].type!=="linePrefix"&&r.events[d][1].type!=="content"){h=r.events[d][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||h)?(t.enter("setextHeadingLine"),s=u,o(u)):n(u)}function o(u){return t.enter("setextHeadingLineSequence"),l(u)}function l(u){return u===s?(t.consume(u),l):(t.exit("setextHeadingLineSequence"),bn(u)?Hn(t,c,"lineSuffix")(u):c(u))}function c(u){return u===null||Kt(u)?(t.exit("setextHeadingLine"),e(u)):n(u)}}const oAe={tokenize:aAe};function aAe(t){const e=this,n=t.attempt(c_,r,t.attempt(this.parser.constructs.flowInitial,s,Hn(t,t.attempt(this.parser.constructs.flow,s,t.attempt(hPe,s)),"linePrefix")));return n;function r(i){if(i===null){t.consume(i);return}return t.enter("lineEndingBlank"),t.consume(i),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function s(i){if(i===null){t.consume(i);return}return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),e.currentConstruct=void 0,n}}const lAe={resolveAll:yq()},cAe=gq("string"),uAe=gq("text");function gq(t){return{resolveAll:yq(t==="text"?dAe:void 0),tokenize:e};function e(n){const r=this,s=this.parser.constructs[t],i=n.attempt(s,o,l);return o;function o(d){return u(d)?i(d):l(d)}function l(d){if(d===null){n.consume(d);return}return n.enter("data"),n.consume(d),c}function c(d){return u(d)?(n.exit("data"),i(d)):(n.consume(d),c)}function u(d){if(d===null)return!0;const h=s[d];let f=-1;if(h)for(;++f<h.length;){const m=h[f];if(!m.previous||m.previous.call(r,r.previous))return!0}return!1}}}function yq(t){return e;function e(n,r){let s=-1,i;for(;++s<=n.length;)i===void 0?n[s]&&n[s][1].type==="data"&&(i=s,s++):(!n[s]||n[s][1].type!=="data")&&(s!==i+2&&(n[i][1].end=n[s-1][1].end,n.splice(i+2,s-i-2),s=i+2),i=void 0);return t?t(n,r):n}}function dAe(t,e){let n=0;for(;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){const r=t[n-1][1],s=e.sliceStream(r);let i=s.length,o=-1,l=0,c;for(;i--;){const u=s[i];if(typeof u=="string"){for(o=u.length;u.charCodeAt(o-1)===32;)l++,o--;if(o)break;o=-1}else if(u===-2)c=!0,l++;else if(u!==-1){i++;break}}if(e._contentTypeTextTrailing&&n===t.length&&(l=0),l){const u={type:n===t.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?o:r.start._bufferIndex+o,_index:r.start._index+i,line:r.end.line,column:r.end.column-l,offset:r.end.offset-l},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(t.splice(n,0,["enter",u,e],["exit",u,e]),n+=2)}n++}return t}const hAe={42:li,43:li,45:li,48:li,49:li,50:li,51:li,52:li,53:li,54:li,55:li,56:li,57:li,62:cq},fAe={91:yPe},mAe={[-2]:iC,[-1]:iC,32:iC},pAe={35:SPe,42:vv,45:[TF,vv],60:IPe,61:TF,95:vv,96:CF,126:CF},gAe={38:dq,92:uq},yAe={[-5]:oC,[-4]:oC,[-3]:oC,33:WPe,38:dq,42:f1,60:[qNe,DPe],91:qPe,92:[bPe,uq],93:rk,95:f1,96:oPe},xAe={null:[f1,lAe]},vAe={null:[42,95]},wAe={null:[]},bAe=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:vAe,contentInitial:fAe,disable:wAe,document:hAe,flow:pAe,flowInitial:mAe,insideSpan:xAe,string:gAe,text:yAe},Symbol.toStringTag,{value:"Module"}));function _Ae(t,e,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const s={},i=[];let o=[],l=[];const c={attempt:E(j),check:E(A),consume:_,enter:C,exit:T,interrupt:E(A,{interrupt:!0})},u={code:null,containerState:{},defineSkip:x,events:[],now:g,parser:t,previous:null,sliceSerialize:f,sliceStream:m,write:h};let d=e.tokenize.call(u,c);return e.resolveAll&&i.push(e),u;function h(R){return o=so(o,R),v(),o[o.length-1]!==null?[]:(I(e,0),u.events=nk(i,u.events,u),u.events)}function f(R,D){return CAe(m(R),D)}function m(R){return SAe(o,R)}function g(){const{_bufferIndex:R,_index:D,line:M,column:z,offset:B}=r;return{_bufferIndex:R,_index:D,line:M,column:z,offset:B}}function x(R){s[R.line]=R.column,k()}function v(){let R;for(;r._index<o.length;){const D=o[r._index];if(typeof D=="string")for(R=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===R&&r._bufferIndex<D.length;)w(D.charCodeAt(r._bufferIndex));else w(D)}}function w(R){d=d(R)}function _(R){Kt(R)?(r.line++,r.column=1,r.offset+=R===-3?2:1,k()):R!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=R}function C(R,D){const M=D||{};return M.type=R,M.start=g(),u.events.push(["enter",M,u]),l.push(M),M}function T(R){const D=l.pop();return D.end=g(),u.events.push(["exit",D,u]),D}function j(R,D){I(R,D.from)}function A(R,D){D.restore()}function E(R,D){return M;function M(z,B,G){let Y,H,K,$;return Array.isArray(z)?W(z):"tokenize"in z?W([z]):V(z);function V(le){return he;function he(Le){const Ve=Le!==null&&le[Le],Be=Le!==null&&le.null,ue=[...Array.isArray(Ve)?Ve:Ve?[Ve]:[],...Array.isArray(Be)?Be:Be?[Be]:[]];return W(ue)(Le)}}function W(le){return Y=le,H=0,le.length===0?G:F(le[H])}function F(le){return he;function he(Le){return $=N(),K=le,le.partial||(u.currentConstruct=le),le.name&&u.parser.constructs.disable.null.includes(le.name)?ce():le.tokenize.call(D?Object.assign(Object.create(u),D):u,c,Z,ce)(Le)}}function Z(le){return R(K,$),B}function ce(le){return $.restore(),++H<Y.length?F(Y[H]):G}}}function I(R,D){R.resolveAll&&!i.includes(R)&&i.push(R),R.resolve&&_a(u.events,D,u.events.length-D,R.resolve(u.events.slice(D),u)),R.resolveTo&&(u.events=R.resolveTo(u.events,u))}function N(){const R=g(),D=u.previous,M=u.currentConstruct,z=u.events.length,B=Array.from(l);return{from:z,restore:G};function G(){r=R,u.previous=D,u.currentConstruct=M,u.events.length=z,l=B,k()}}function k(){r.line in s&&r.column<2&&(r.column=s[r.line],r.offset+=s[r.line]-1)}}function SAe(t,e){const n=e.start._index,r=e.start._bufferIndex,s=e.end._index,i=e.end._bufferIndex;let o;if(n===s)o=[t[n].slice(r,i)];else{if(o=t.slice(n,s),r>-1){const l=o[0];typeof l=="string"?o[0]=l.slice(r):o.shift()}i>0&&o.push(t[s].slice(0,i))}return o}function CAe(t,e){let n=-1;const r=[];let s;for(;++n<t.length;){const i=t[n];let o;if(typeof i=="string")o=i;else switch(i){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=e?" ":"	";break}case-1:{if(!e&&s)continue;o=" ";break}default:o=String.fromCharCode(i)}s=i===-2,r.push(o)}return r.join("")}function EAe(t){const r={constructs:jNe([bAe,...(t||{}).extensions||[]]),content:s(VNe),defined:[],document:s(BNe),flow:s(oAe),lazy:{},string:s(cAe),text:s(uAe)};return r;function s(i){return o;function o(l){return _Ae(r,i,l)}}}function TAe(t){for(;!hq(t););return t}const IF=/[\0\t\n\r]/g;function IAe(){let t=1,e="",n=!0,r;return s;function s(i,o,l){const c=[];let u,d,h,f,m;for(i=e+(typeof i=="string"?i.toString():new TextDecoder(o||void 0).decode(i)),h=0,e="",n&&(i.charCodeAt(0)===65279&&h++,n=void 0);h<i.length;){if(IF.lastIndex=h,u=IF.exec(i),f=u&&u.index!==void 0?u.index:i.length,m=i.charCodeAt(f),!u){e=i.slice(h);break}if(m===10&&h===f&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),h<f&&(c.push(i.slice(h,f)),t+=f-h),m){case 0:{c.push(65533),t++;break}case 9:{for(d=Math.ceil(t/4)*4,c.push(-2);t++<d;)c.push(-1);break}case 10:{c.push(-4),t=1;break}default:r=!0,t=1}h=f+1}return l&&(r&&c.push(-5),e&&c.push(e),c.push(null)),c}}const NAe=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function PAe(t){return t.replace(NAe,AAe)}function AAe(t,e,n){if(e)return e;if(n.charCodeAt(0)===35){const s=n.charCodeAt(1),i=s===120||s===88;return lq(n.slice(i?2:1),i?16:10)}return tk(n)||t}const xq={}.hasOwnProperty;function kAe(t,e,n){return typeof e!="string"&&(n=e,e=void 0),jAe(n)(TAe(EAe(n).document().write(IAe()(t,e,!0))))}function jAe(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(kt),autolinkProtocol:N,autolinkEmail:N,atxHeading:i(ie),blockQuote:i(Be),characterEscape:N,characterReference:N,codeFenced:i(ue),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:i(ue,o),codeText:i(Ce,o),codeTextData:N,data:N,codeFlowValue:N,definition:i(Ie),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:i(ve),hardBreakEscape:i(Me),hardBreakTrailing:i(Me),htmlFlow:i(He,o),htmlFlowData:N,htmlText:i(He,o),htmlTextData:N,image:i(yt),label:o,link:i(kt),listItem:i(mn),listItemValue:f,listOrdered:i(en,h),listUnordered:i(en),paragraph:i(cn),reference:F,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:i(ie),strong:i(fn),thematicBreak:i(Et)},exit:{atxHeading:c(),atxHeadingSequence:j,autolink:c(),autolinkEmail:Ve,autolinkProtocol:Le,blockQuote:c(),characterEscapeValue:k,characterReferenceMarkerHexadecimal:ce,characterReferenceMarkerNumeric:ce,characterReferenceValue:le,characterReference:he,codeFenced:c(v),codeFencedFence:x,codeFencedFenceInfo:m,codeFencedFenceMeta:g,codeFlowValue:k,codeIndented:c(w),codeText:c(B),codeTextData:k,data:k,definition:c(),definitionDestinationString:T,definitionLabelString:_,definitionTitleString:C,emphasis:c(),hardBreakEscape:c(D),hardBreakTrailing:c(D),htmlFlow:c(M),htmlFlowData:k,htmlText:c(z),htmlTextData:k,image:c(Y),label:K,labelText:H,lineEnding:R,link:c(G),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:Z,resourceDestinationString:$,resourceTitleString:V,resource:W,setextHeading:c(I),setextHeadingLineSequence:E,setextHeadingText:A,strong:c(),thematicBreak:c()}};vq(e,(t||{}).mdastExtensions||[]);const n={};return r;function r(de){let De={type:"root",children:[]};const ee={stack:[De],tokenStack:[],config:e,enter:l,exit:u,buffer:o,resume:d,data:n},ae=[];let X=-1;for(;++X<de.length;)if(de[X][1].type==="listOrdered"||de[X][1].type==="listUnordered")if(de[X][0]==="enter")ae.push(X);else{const Pe=ae.pop();X=s(de,Pe,X)}for(X=-1;++X<de.length;){const Pe=e[de[X][0]];xq.call(Pe,de[X][1].type)&&Pe[de[X][1].type].call(Object.assign({sliceSerialize:de[X][2].sliceSerialize},ee),de[X][1])}if(ee.tokenStack.length>0){const Pe=ee.tokenStack[ee.tokenStack.length-1];(Pe[1]||NF).call(ee,void 0,Pe[0])}for(De.position={start:Al(de.length>0?de[0][1].start:{line:1,column:1,offset:0}),end:Al(de.length>0?de[de.length-2][1].end:{line:1,column:1,offset:0})},X=-1;++X<e.transforms.length;)De=e.transforms[X](De)||De;return De}function s(de,De,ee){let ae=De-1,X=-1,Pe=!1,Ae,$e,qe,oe;for(;++ae<=ee;){const _e=de[ae];switch(_e[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{_e[0]==="enter"?X++:X--,oe=void 0;break}case"lineEndingBlank":{_e[0]==="enter"&&(Ae&&!oe&&!X&&!qe&&(qe=ae),oe=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:oe=void 0}if(!X&&_e[0]==="enter"&&_e[1].type==="listItemPrefix"||X===-1&&_e[0]==="exit"&&(_e[1].type==="listUnordered"||_e[1].type==="listOrdered")){if(Ae){let ze=ae;for($e=void 0;ze--;){const Te=de[ze];if(Te[1].type==="lineEnding"||Te[1].type==="lineEndingBlank"){if(Te[0]==="exit")continue;$e&&(de[$e][1].type="lineEndingBlank",Pe=!0),Te[1].type="lineEnding",$e=ze}else if(!(Te[1].type==="linePrefix"||Te[1].type==="blockQuotePrefix"||Te[1].type==="blockQuotePrefixWhitespace"||Te[1].type==="blockQuoteMarker"||Te[1].type==="listItemIndent"))break}qe&&(!$e||qe<$e)&&(Ae._spread=!0),Ae.end=Object.assign({},$e?de[$e][1].start:_e[1].end),de.splice($e||ae,0,["exit",Ae,_e[2]]),ae++,ee++}if(_e[1].type==="listItemPrefix"){const ze={type:"listItem",_spread:!1,start:Object.assign({},_e[1].start),end:void 0};Ae=ze,de.splice(ae,0,["enter",ze,_e[2]]),ae++,ee++,qe=void 0,oe=!0}}}return de[De][1]._spread=Pe,ee}function i(de,De){return ee;function ee(ae){l.call(this,de(ae),ae),De&&De.call(this,ae)}}function o(){this.stack.push({type:"fragment",children:[]})}function l(de,De,ee){this.stack[this.stack.length-1].children.push(de),this.stack.push(de),this.tokenStack.push([De,ee||void 0]),de.position={start:Al(De.start),end:void 0}}function c(de){return De;function De(ee){de&&de.call(this,ee),u.call(this,ee)}}function u(de,De){const ee=this.stack.pop(),ae=this.tokenStack.pop();if(ae)ae[0].type!==de.type&&(De?De.call(this,de,ae[0]):(ae[1]||NF).call(this,de,ae[0]));else throw new Error("Cannot close `"+de.type+"` ("+mp({start:de.start,end:de.end})+"): it’s not open");ee.position.end=Al(de.end)}function d(){return ANe(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function f(de){if(this.data.expectingFirstListItemValue){const De=this.stack[this.stack.length-2];De.start=Number.parseInt(this.sliceSerialize(de),10),this.data.expectingFirstListItemValue=void 0}}function m(){const de=this.resume(),De=this.stack[this.stack.length-1];De.lang=de}function g(){const de=this.resume(),De=this.stack[this.stack.length-1];De.meta=de}function x(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function v(){const de=this.resume(),De=this.stack[this.stack.length-1];De.value=de.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function w(){const de=this.resume(),De=this.stack[this.stack.length-1];De.value=de.replace(/(\r?\n|\r)$/g,"")}function _(de){const De=this.resume(),ee=this.stack[this.stack.length-1];ee.label=De,ee.identifier=Mh(this.sliceSerialize(de)).toLowerCase()}function C(){const de=this.resume(),De=this.stack[this.stack.length-1];De.title=de}function T(){const de=this.resume(),De=this.stack[this.stack.length-1];De.url=de}function j(de){const De=this.stack[this.stack.length-1];if(!De.depth){const ee=this.sliceSerialize(de).length;De.depth=ee}}function A(){this.data.setextHeadingSlurpLineEnding=!0}function E(de){const De=this.stack[this.stack.length-1];De.depth=this.sliceSerialize(de).codePointAt(0)===61?1:2}function I(){this.data.setextHeadingSlurpLineEnding=void 0}function N(de){const ee=this.stack[this.stack.length-1].children;let ae=ee[ee.length-1];(!ae||ae.type!=="text")&&(ae=Ue(),ae.position={start:Al(de.start),end:void 0},ee.push(ae)),this.stack.push(ae)}function k(de){const De=this.stack.pop();De.value+=this.sliceSerialize(de),De.position.end=Al(de.end)}function R(de){const De=this.stack[this.stack.length-1];if(this.data.atHardBreak){const ee=De.children[De.children.length-1];ee.position.end=Al(de.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(De.type)&&(N.call(this,de),k.call(this,de))}function D(){this.data.atHardBreak=!0}function M(){const de=this.resume(),De=this.stack[this.stack.length-1];De.value=de}function z(){const de=this.resume(),De=this.stack[this.stack.length-1];De.value=de}function B(){const de=this.resume(),De=this.stack[this.stack.length-1];De.value=de}function G(){const de=this.stack[this.stack.length-1];if(this.data.inReference){const De=this.data.referenceType||"shortcut";de.type+="Reference",de.referenceType=De,delete de.url,delete de.title}else delete de.identifier,delete de.label;this.data.referenceType=void 0}function Y(){const de=this.stack[this.stack.length-1];if(this.data.inReference){const De=this.data.referenceType||"shortcut";de.type+="Reference",de.referenceType=De,delete de.url,delete de.title}else delete de.identifier,delete de.label;this.data.referenceType=void 0}function H(de){const De=this.sliceSerialize(de),ee=this.stack[this.stack.length-2];ee.label=PAe(De),ee.identifier=Mh(De).toLowerCase()}function K(){const de=this.stack[this.stack.length-1],De=this.resume(),ee=this.stack[this.stack.length-1];if(this.data.inReference=!0,ee.type==="link"){const ae=de.children;ee.children=ae}else ee.alt=De}function $(){const de=this.resume(),De=this.stack[this.stack.length-1];De.url=de}function V(){const de=this.resume(),De=this.stack[this.stack.length-1];De.title=de}function W(){this.data.inReference=void 0}function F(){this.data.referenceType="collapsed"}function Z(de){const De=this.resume(),ee=this.stack[this.stack.length-1];ee.label=De,ee.identifier=Mh(this.sliceSerialize(de)).toLowerCase(),this.data.referenceType="full"}function ce(de){this.data.characterReferenceType=de.type}function le(de){const De=this.sliceSerialize(de),ee=this.data.characterReferenceType;let ae;ee?(ae=lq(De,ee==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):ae=tk(De);const X=this.stack[this.stack.length-1];X.value+=ae}function he(de){const De=this.stack.pop();De.position.end=Al(de.end)}function Le(de){k.call(this,de);const De=this.stack[this.stack.length-1];De.url=this.sliceSerialize(de)}function Ve(de){k.call(this,de);const De=this.stack[this.stack.length-1];De.url="mailto:"+this.sliceSerialize(de)}function Be(){return{type:"blockquote",children:[]}}function ue(){return{type:"code",lang:null,meta:null,value:""}}function Ce(){return{type:"inlineCode",value:""}}function Ie(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function ve(){return{type:"emphasis",children:[]}}function ie(){return{type:"heading",depth:0,children:[]}}function Me(){return{type:"break"}}function He(){return{type:"html",value:""}}function yt(){return{type:"image",title:null,url:"",alt:null}}function kt(){return{type:"link",title:null,url:"",children:[]}}function en(de){return{type:"list",ordered:de.type==="listOrdered",start:null,spread:de._spread,children:[]}}function mn(de){return{type:"listItem",spread:de._spread,checked:null,children:[]}}function cn(){return{type:"paragraph",children:[]}}function fn(){return{type:"strong",children:[]}}function Ue(){return{type:"text",value:""}}function Et(){return{type:"thematicBreak"}}}function Al(t){return{line:t.line,column:t.column,offset:t.offset}}function vq(t,e){let n=-1;for(;++n<e.length;){const r=e[n];Array.isArray(r)?vq(t,r):RAe(t,r)}}function RAe(t,e){let n;for(n in e)if(xq.call(e,n))switch(n){case"canContainEols":{const r=e[n];r&&t[n].push(...r);break}case"transforms":{const r=e[n];r&&t[n].push(...r);break}case"enter":case"exit":{const r=e[n];r&&Object.assign(t[n],r);break}}}function NF(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+mp({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+mp({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+mp({start:e.start,end:e.end})+") is still open")}function DAe(t){const e=this;e.parser=n;function n(r){return kAe(r,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function MAe(t,e){const n={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(e),!0)};return t.patch(e,n),t.applyData(e,n)}function LAe(t,e){const n={type:"element",tagName:"br",properties:{},children:[]};return t.patch(e,n),[t.applyData(e,n),{type:"text",value:`
`}]}function FAe(t,e){const n=e.value?e.value+`
`:"",r={};e.lang&&(r.className=["language-"+e.lang]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return e.meta&&(s.data={meta:e.meta}),t.patch(e,s),s=t.applyData(e,s),s={type:"element",tagName:"pre",properties:{},children:[s]},t.patch(e,s),s}function OAe(t,e){const n={type:"element",tagName:"del",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function $Ae(t,e){const n={type:"element",tagName:"em",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function VAe(t,e){const n=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),s=Rf(r.toLowerCase()),i=t.footnoteOrder.indexOf(r);let o,l=t.footnoteCounts.get(r);l===void 0?(l=0,t.footnoteOrder.push(r),o=t.footnoteOrder.length):o=i+1,l+=1,t.footnoteCounts.set(r,l);const c={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+s,id:n+"fnref-"+s+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};t.patch(e,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return t.patch(e,u),t.applyData(e,u)}function UAe(t,e){const n={type:"element",tagName:"h"+e.depth,properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function BAe(t,e){if(t.options.allowDangerousHtml){const n={type:"raw",value:e.value};return t.patch(e,n),t.applyData(e,n)}}function wq(t,e){const n=e.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const s=t.all(e),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const o=s[s.length-1];return o&&o.type==="text"?o.value+=r:s.push({type:"text",value:r}),s}function zAe(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return wq(t,e);const s={src:Rf(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"img",properties:s,children:[]};return t.patch(e,i),t.applyData(e,i)}function GAe(t,e){const n={src:Rf(e.url)};e.alt!==null&&e.alt!==void 0&&(n.alt=e.alt),e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"img",properties:n,children:[]};return t.patch(e,r),t.applyData(e,r)}function WAe(t,e){const n={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};t.patch(e,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return t.patch(e,r),t.applyData(e,r)}function HAe(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return wq(t,e);const s={href:Rf(r.url||"")};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"a",properties:s,children:t.all(e)};return t.patch(e,i),t.applyData(e,i)}function qAe(t,e){const n={href:Rf(e.url)};e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"a",properties:n,children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function KAe(t,e,n){const r=t.all(e),s=n?YAe(n):bq(e),i={},o=[];if(typeof e.checked=="boolean"){const d=r[0];let h;d&&d.type==="element"&&d.tagName==="p"?h=d:(h={type:"element",tagName:"p",properties:{},children:[]},r.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let l=-1;for(;++l<r.length;){const d=r[l];(s||l!==0||d.type!=="element"||d.tagName!=="p")&&o.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?o.push(...d.children):o.push(d)}const c=r[r.length-1];c&&(s||c.type!=="element"||c.tagName!=="p")&&o.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:i,children:o};return t.patch(e,u),t.applyData(e,u)}function YAe(t){let e=!1;if(t.type==="list"){e=t.spread||!1;const n=t.children;let r=-1;for(;!e&&++r<n.length;)e=bq(n[r])}return e}function bq(t){const e=t.spread;return e??t.children.length>1}function JAe(t,e){const n={},r=t.all(e);let s=-1;for(typeof e.start=="number"&&e.start!==1&&(n.start=e.start);++s<r.length;){const o=r[s];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const i={type:"element",tagName:e.ordered?"ol":"ul",properties:n,children:t.wrap(r,!0)};return t.patch(e,i),t.applyData(e,i)}function QAe(t,e){const n={type:"element",tagName:"p",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function XAe(t,e){const n={type:"root",children:t.wrap(t.all(e))};return t.patch(e,n),t.applyData(e,n)}function ZAe(t,e){const n={type:"element",tagName:"strong",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function eke(t,e){const n=t.all(e),r=n.shift(),s=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:t.wrap([r],!0)};t.patch(e.children[0],o),s.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:t.wrap(n,!0)},l=QA(e.children[1]),c=tq(e.children[e.children.length-1]);l&&c&&(o.position={start:l,end:c}),s.push(o)}const i={type:"element",tagName:"table",properties:{},children:t.wrap(s,!0)};return t.patch(e,i),t.applyData(e,i)}function tke(t,e,n){const r=n?n.children:void 0,i=(r?r.indexOf(e):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,l=o?o.length:e.children.length;let c=-1;const u=[];for(;++c<l;){const h=e.children[c],f={},m=o?o[c]:void 0;m&&(f.align=m);let g={type:"element",tagName:i,properties:f,children:[]};h&&(g.children=t.all(h),t.patch(h,g),g=t.applyData(h,g)),u.push(g)}const d={type:"element",tagName:"tr",properties:{},children:t.wrap(u,!0)};return t.patch(e,d),t.applyData(e,d)}function nke(t,e){const n={type:"element",tagName:"td",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}const PF=9,AF=32;function rke(t){const e=String(t),n=/\r?\n|\r/g;let r=n.exec(e),s=0;const i=[];for(;r;)i.push(kF(e.slice(s,r.index),s>0,!0),r[0]),s=r.index+r[0].length,r=n.exec(e);return i.push(kF(e.slice(s),s>0,!1)),i.join("")}function kF(t,e,n){let r=0,s=t.length;if(e){let i=t.codePointAt(r);for(;i===PF||i===AF;)r++,i=t.codePointAt(r)}if(n){let i=t.codePointAt(s-1);for(;i===PF||i===AF;)s--,i=t.codePointAt(s-1)}return s>r?t.slice(r,s):""}function ske(t,e){const n={type:"text",value:rke(String(e.value))};return t.patch(e,n),t.applyData(e,n)}function ike(t,e){const n={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(e,n),t.applyData(e,n)}const oke={blockquote:MAe,break:LAe,code:FAe,delete:OAe,emphasis:$Ae,footnoteReference:VAe,heading:UAe,html:BAe,imageReference:zAe,image:GAe,inlineCode:WAe,linkReference:HAe,link:qAe,listItem:KAe,list:JAe,paragraph:QAe,root:XAe,strong:ZAe,table:eke,tableCell:nke,tableRow:tke,text:ske,thematicBreak:ike,toml:Tx,yaml:Tx,definition:Tx,footnoteDefinition:Tx};function Tx(){}const _q=-1,u_=0,gp=1,r0=2,sk=3,ik=4,ok=5,ak=6,Sq=7,Cq=8,jF=typeof self=="object"?self:globalThis,ake=(t,e)=>{const n=(s,i)=>(t.set(i,s),s),r=s=>{if(t.has(s))return t.get(s);const[i,o]=e[s];switch(i){case u_:case _q:return n(o,s);case gp:{const l=n([],s);for(const c of o)l.push(r(c));return l}case r0:{const l=n({},s);for(const[c,u]of o)l[r(c)]=r(u);return l}case sk:return n(new Date(o),s);case ik:{const{source:l,flags:c}=o;return n(new RegExp(l,c),s)}case ok:{const l=n(new Map,s);for(const[c,u]of o)l.set(r(c),r(u));return l}case ak:{const l=n(new Set,s);for(const c of o)l.add(r(c));return l}case Sq:{const{name:l,message:c}=o;return n(new jF[l](c),s)}case Cq:return n(BigInt(o),s);case"BigInt":return n(Object(BigInt(o)),s);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:l}=new Uint8Array(o);return n(new DataView(l),o)}}return n(new jF[i](o),s)};return r},RF=t=>ake(new Map,t)(0),Ud="",{toString:lke}={},{keys:cke}=Object,hm=t=>{const e=typeof t;if(e!=="object"||!t)return[u_,e];const n=lke.call(t).slice(8,-1);switch(n){case"Array":return[gp,Ud];case"Object":return[r0,Ud];case"Date":return[sk,Ud];case"RegExp":return[ik,Ud];case"Map":return[ok,Ud];case"Set":return[ak,Ud];case"DataView":return[gp,n]}return n.includes("Array")?[gp,n]:n.includes("Error")?[Sq,n]:[r0,n]},Ix=([t,e])=>t===u_&&(e==="function"||e==="symbol"),uke=(t,e,n,r)=>{const s=(o,l)=>{const c=r.push(o)-1;return n.set(l,c),c},i=o=>{if(n.has(o))return n.get(o);let[l,c]=hm(o);switch(l){case u_:{let d=o;switch(c){case"bigint":l=Cq,d=o.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+c);d=null;break;case"undefined":return s([_q],o)}return s([l,d],o)}case gp:{if(c){let f=o;return c==="DataView"?f=new Uint8Array(o.buffer):c==="ArrayBuffer"&&(f=new Uint8Array(o)),s([c,[...f]],o)}const d=[],h=s([l,d],o);for(const f of o)d.push(i(f));return h}case r0:{if(c)switch(c){case"BigInt":return s([c,o.toString()],o);case"Boolean":case"Number":case"String":return s([c,o.valueOf()],o)}if(e&&"toJSON"in o)return i(o.toJSON());const d=[],h=s([l,d],o);for(const f of cke(o))(t||!Ix(hm(o[f])))&&d.push([i(f),i(o[f])]);return h}case sk:return s([l,o.toISOString()],o);case ik:{const{source:d,flags:h}=o;return s([l,{source:d,flags:h}],o)}case ok:{const d=[],h=s([l,d],o);for(const[f,m]of o)(t||!(Ix(hm(f))||Ix(hm(m))))&&d.push([i(f),i(m)]);return h}case ak:{const d=[],h=s([l,d],o);for(const f of o)(t||!Ix(hm(f)))&&d.push(i(f));return h}}const{message:u}=o;return s([l,{name:c,message:u}],o)};return i},DF=(t,{json:e,lossy:n}={})=>{const r=[];return uke(!(e||n),!!e,new Map,r)(t),r},s0=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?RF(DF(t,e)):structuredClone(t):(t,e)=>RF(DF(t,e));function dke(t,e){const n=[{type:"text",value:"↩"}];return e>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),n}function hke(t,e){return"Back to reference "+(t+1)+(e>1?"-"+e:"")}function fke(t){const e=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",n=t.options.footnoteBackContent||dke,r=t.options.footnoteBackLabel||hke,s=t.options.footnoteLabel||"Footnotes",i=t.options.footnoteLabelTagName||"h2",o=t.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<t.footnoteOrder.length;){const u=t.footnoteById.get(t.footnoteOrder[c]);if(!u)continue;const d=t.all(u),h=String(u.identifier).toUpperCase(),f=Rf(h.toLowerCase());let m=0;const g=[],x=t.footnoteCounts.get(h);for(;x!==void 0&&++m<=x;){g.length>0&&g.push({type:"text",value:" "});let _=typeof n=="string"?n:n(c,m);typeof _=="string"&&(_={type:"text",value:_}),g.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+f+(m>1?"-"+m:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(c,m),className:["data-footnote-backref"]},children:Array.isArray(_)?_:[_]})}const v=d[d.length-1];if(v&&v.type==="element"&&v.tagName==="p"){const _=v.children[v.children.length-1];_&&_.type==="text"?_.value+=" ":v.children.push({type:"text",value:" "}),v.children.push(...g)}else d.push(...g);const w={type:"element",tagName:"li",properties:{id:e+"fn-"+f},children:t.wrap(d,!0)};t.patch(u,w),l.push(w)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...s0(o),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(l,!0)},{type:"text",value:`
`}]}}const Eq=function(t){if(t==null)return yke;if(typeof t=="function")return d_(t);if(typeof t=="object")return Array.isArray(t)?mke(t):pke(t);if(typeof t=="string")return gke(t);throw new Error("Expected function, string, or object as test")};function mke(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=Eq(t[n]);return d_(r);function r(...s){let i=-1;for(;++i<e.length;)if(e[i].apply(this,s))return!0;return!1}}function pke(t){const e=t;return d_(n);function n(r){const s=r;let i;for(i in t)if(s[i]!==e[i])return!1;return!0}}function gke(t){return d_(e);function e(n){return n&&n.type===t}}function d_(t){return e;function e(n,r,s){return!!(xke(n)&&t.call(this,n,typeof r=="number"?r:void 0,s||void 0))}}function yke(){return!0}function xke(t){return t!==null&&typeof t=="object"&&"type"in t}const Tq=[],vke=!0,MF=!1,wke="skip";function bke(t,e,n,r){let s;typeof e=="function"&&typeof n!="function"?(r=n,n=e):s=e;const i=Eq(s),o=r?-1:1;l(t,void 0,[])();function l(c,u,d){const h=c&&typeof c=="object"?c:{};if(typeof h.type=="string"){const m=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(c.type+(m?"<"+m+">":""))+")"})}return f;function f(){let m=Tq,g,x,v;if((!e||i(c,u,d[d.length-1]||void 0))&&(m=_ke(n(c,d)),m[0]===MF))return m;if("children"in c&&c.children){const w=c;if(w.children&&m[0]!==wke)for(x=(r?w.children.length:-1)+o,v=d.concat(w);x>-1&&x<w.children.length;){const _=w.children[x];if(g=l(_,x,v)(),g[0]===MF)return g;x=typeof g[1]=="number"?g[1]:x+o}}return m}}}function _ke(t){return Array.isArray(t)?t:typeof t=="number"?[vke,t]:t==null?Tq:[t]}function Iq(t,e,n,r){let s,i,o;typeof e=="function"&&typeof n!="function"?(i=void 0,o=e,s=n):(i=e,o=n,s=r),bke(t,i,l,s);function l(c,u){const d=u[u.length-1],h=d?d.children.indexOf(c):void 0;return o(c,h,d)}}const m1={}.hasOwnProperty,Ske={};function Cke(t,e){const n=e||Ske,r=new Map,s=new Map,i=new Map,o={...oke,...n.handlers},l={all:u,applyData:Tke,definitionById:r,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:o,one:c,options:n,patch:Eke,wrap:Nke};return Iq(t,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const h=d.type==="definition"?r:s,f=String(d.identifier).toUpperCase();h.has(f)||h.set(f,d)}}),l;function c(d,h){const f=d.type,m=l.handlers[f];if(m1.call(l.handlers,f)&&m)return m(l,d,h);if(l.options.passThrough&&l.options.passThrough.includes(f)){if("children"in d){const{children:x,...v}=d,w=s0(v);return w.children=l.all(d),w}return s0(d)}return(l.options.unknownHandler||Ike)(l,d,h)}function u(d){const h=[];if("children"in d){const f=d.children;let m=-1;for(;++m<f.length;){const g=l.one(f[m],d);if(g){if(m&&f[m-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=LF(g.value)),!Array.isArray(g)&&g.type==="element")){const x=g.children[0];x&&x.type==="text"&&(x.value=LF(x.value))}Array.isArray(g)?h.push(...g):h.push(g)}}}return h}}function Eke(t,e){t.position&&(e.position=lNe(t))}function Tke(t,e){let n=e;if(t&&t.data){const r=t.data.hName,s=t.data.hChildren,i=t.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const o="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:o}}n.type==="element"&&i&&Object.assign(n.properties,s0(i)),"children"in n&&n.children&&s!==null&&s!==void 0&&(n.children=s)}return n}function Ike(t,e){const n=e.data||{},r="value"in e&&!(m1.call(n,"hProperties")||m1.call(n,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function Nke(t,e){const n=[];let r=-1;for(e&&n.push({type:"text",value:`
`});++r<t.length;)r&&n.push({type:"text",value:`
`}),n.push(t[r]);return e&&t.length>0&&n.push({type:"text",value:`
`}),n}function LF(t){let e=0,n=t.charCodeAt(e);for(;n===9||n===32;)e++,n=t.charCodeAt(e);return t.slice(e)}function FF(t,e){const n=Cke(t,e),r=n.one(t,void 0),s=fke(n),i=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function Pke(t,e){return t&&"run"in t?async function(n,r){const s=FF(n,{file:r,...e});await t.run(s,r)}:function(n,r){return FF(n,{file:r,...t||e})}}function OF(t){if(t)throw t}var wv=Object.prototype.hasOwnProperty,Nq=Object.prototype.toString,$F=Object.defineProperty,VF=Object.getOwnPropertyDescriptor,UF=function(e){return typeof Array.isArray=="function"?Array.isArray(e):Nq.call(e)==="[object Array]"},BF=function(e){if(!e||Nq.call(e)!=="[object Object]")return!1;var n=wv.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&wv.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;var s;for(s in e);return typeof s>"u"||wv.call(e,s)},zF=function(e,n){$F&&n.name==="__proto__"?$F(e,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):e[n.name]=n.newValue},GF=function(e,n){if(n==="__proto__")if(wv.call(e,n)){if(VF)return VF(e,n).value}else return;return e[n]},Ake=function t(){var e,n,r,s,i,o,l=arguments[0],c=1,u=arguments.length,d=!1;for(typeof l=="boolean"&&(d=l,l=arguments[1]||{},c=2),(l==null||typeof l!="object"&&typeof l!="function")&&(l={});c<u;++c)if(e=arguments[c],e!=null)for(n in e)r=GF(l,n),s=GF(e,n),l!==s&&(d&&s&&(BF(s)||(i=UF(s)))?(i?(i=!1,o=r&&UF(r)?r:[]):o=r&&BF(r)?r:{},zF(l,{name:n,newValue:t(d,o,s)})):typeof s<"u"&&zF(l,{name:n,newValue:s}));return l};const aC=i0(Ake);function p1(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function kke(){const t=[],e={run:n,use:r};return e;function n(...s){let i=-1;const o=s.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);l(null,...s);function l(c,...u){const d=t[++i];let h=-1;if(c){o(c);return}for(;++h<s.length;)(u[h]===null||u[h]===void 0)&&(u[h]=s[h]);s=u,d?jke(d,l)(...u):o(null,...u)}}function r(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return t.push(s),e}}function jke(t,e){let n;return r;function r(...o){const l=t.length>o.length;let c;l&&o.push(s);try{c=t.apply(this,o)}catch(u){const d=u;if(l&&n)throw d;return s(d)}l||(c&&c.then&&typeof c.then=="function"?c.then(i,s):c instanceof Error?s(c):i(c))}function s(o,...l){n||(n=!0,e(o,...l))}function i(o){s(null,o)}}const Xo={basename:Rke,dirname:Dke,extname:Mke,join:Lke,sep:"/"};function Rke(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');uy(t);let n=0,r=-1,s=t.length,i;if(e===void 0||e.length===0||e.length>t.length){for(;s--;)if(t.codePointAt(s)===47){if(i){n=s+1;break}}else r<0&&(i=!0,r=s+1);return r<0?"":t.slice(n,r)}if(e===t)return"";let o=-1,l=e.length-1;for(;s--;)if(t.codePointAt(s)===47){if(i){n=s+1;break}}else o<0&&(i=!0,o=s+1),l>-1&&(t.codePointAt(s)===e.codePointAt(l--)?l<0&&(r=s):(l=-1,r=o));return n===r?r=o:r<0&&(r=t.length),t.slice(n,r)}function Dke(t){if(uy(t),t.length===0)return".";let e=-1,n=t.length,r;for(;--n;)if(t.codePointAt(n)===47){if(r){e=n;break}}else r||(r=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function Mke(t){uy(t);let e=t.length,n=-1,r=0,s=-1,i=0,o;for(;e--;){const l=t.codePointAt(e);if(l===47){if(o){r=e+1;break}continue}n<0&&(o=!0,n=e+1),l===46?s<0?s=e:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||n<0||i===0||i===1&&s===n-1&&s===r+1?"":t.slice(s,n)}function Lke(...t){let e=-1,n;for(;++e<t.length;)uy(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":Fke(n)}function Fke(t){uy(t);const e=t.codePointAt(0)===47;let n=Oke(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.codePointAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function Oke(t,e){let n="",r=0,s=-1,i=0,o=-1,l,c;for(;++o<=t.length;){if(o<t.length)l=t.codePointAt(o);else{if(l===47)break;l=47}if(l===47){if(!(s===o-1||i===1))if(s!==o-1&&i===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(c=n.lastIndexOf("/"),c!==n.length-1){c<0?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}}else if(n.length>0){n="",r=0,s=o,i=0;continue}}e&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+t.slice(s+1,o):n=t.slice(s+1,o),r=o-s-1;s=o,i=0}else l===46&&i>-1?i++:i=-1}return n}function uy(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const $ke={cwd:Vke};function Vke(){return"/"}function g1(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function Uke(t){if(typeof t=="string")t=new URL(t);else if(!g1(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return Bke(t)}function Bke(t){if(t.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.codePointAt(n)===37&&e.codePointAt(n+1)===50){const r=e.codePointAt(n+2);if(r===70||r===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(e)}const lC=["history","path","basename","stem","extname","dirname"];class Pq{constructor(e){let n;e?g1(e)?n={path:e}:typeof e=="string"||zke(e)?n={value:e}:n=e:n={},this.cwd="cwd"in n?"":$ke.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<lC.length;){const i=lC[r];i in n&&n[i]!==void 0&&n[i]!==null&&(this[i]=i==="history"?[...n[i]]:n[i])}let s;for(s in n)lC.includes(s)||(this[s]=n[s])}get basename(){return typeof this.path=="string"?Xo.basename(this.path):void 0}set basename(e){uC(e,"basename"),cC(e,"basename"),this.path=Xo.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?Xo.dirname(this.path):void 0}set dirname(e){WF(this.basename,"dirname"),this.path=Xo.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?Xo.extname(this.path):void 0}set extname(e){if(cC(e,"extname"),WF(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Xo.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){g1(e)&&(e=Uke(e)),uC(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?Xo.basename(this.path,this.extname):void 0}set stem(e){uC(e,"stem"),cC(e,"stem"),this.path=Xo.join(this.dirname||"",e+(this.extname||""))}fail(e,n,r){const s=this.message(e,n,r);throw s.fatal=!0,s}info(e,n,r){const s=this.message(e,n,r);return s.fatal=void 0,s}message(e,n,r){const s=new $s(e,n,r);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function cC(t,e){if(t&&t.includes(Xo.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+Xo.sep+"`")}function uC(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function WF(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function zke(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const Gke=function(t){const r=this.constructor.prototype,s=r[t],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,r),i},Wke={}.hasOwnProperty;class lk extends Gke{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=kke()}copy(){const e=new lk;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];e.use(...r)}return e.data(aC(!0,{},this.namespace)),e}data(e,n){return typeof e=="string"?arguments.length===2?(fC("data",this.frozen),this.namespace[e]=n,this):Wke.call(this.namespace,e)&&this.namespace[e]||void 0:e?(fC("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const s=n.call(e,...r);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const n=Nx(e),r=this.parser||this.Parser;return dC("parse",r),r(String(n),n)}process(e,n){const r=this;return this.freeze(),dC("process",this.parser||this.Parser),hC("process",this.compiler||this.Compiler),n?s(void 0,n):new Promise(s);function s(i,o){const l=Nx(e),c=r.parse(l);r.run(c,l,function(d,h,f){if(d||!h||!f)return u(d);const m=h,g=r.stringify(m,f);Kke(g)?f.value=g:f.result=g,u(d,f)});function u(d,h){d||!h?o(d):i?i(h):n(void 0,h)}}}processSync(e){let n=!1,r;return this.freeze(),dC("processSync",this.parser||this.Parser),hC("processSync",this.compiler||this.Compiler),this.process(e,s),qF("processSync","process",n),r;function s(i,o){n=!0,OF(i),r=o}}run(e,n,r){HF(e),this.freeze();const s=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?i(void 0,r):new Promise(i);function i(o,l){const c=Nx(n);s.run(e,c,u);function u(d,h,f){const m=h||e;d?l(d):o?o(m):r(void 0,m,f)}}}runSync(e,n){let r=!1,s;return this.run(e,n,i),qF("runSync","run",r),s;function i(o,l){OF(o),s=l,r=!0}}stringify(e,n){this.freeze();const r=Nx(n),s=this.compiler||this.Compiler;return hC("stringify",s),HF(e),s(e,r)}use(e,...n){const r=this.attachers,s=this.namespace;if(fC("use",this.frozen),e!=null)if(typeof e=="function")c(e,n);else if(typeof e=="object")Array.isArray(e)?l(e):o(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function i(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[d,...h]=u;c(d,h)}else o(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function o(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(u.plugins),u.settings&&(s.settings=aC(!0,s.settings,u.settings))}function l(u){let d=-1;if(u!=null)if(Array.isArray(u))for(;++d<u.length;){const h=u[d];i(h)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,d){let h=-1,f=-1;for(;++h<r.length;)if(r[h][0]===u){f=h;break}if(f===-1)r.push([u,...d]);else if(d.length>0){let[m,...g]=d;const x=r[f][1];p1(x)&&p1(m)&&(m=aC(!0,x,m)),r[f]=[u,m,...g]}}}}const Hke=new lk().freeze();function dC(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function hC(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function fC(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function HF(t){if(!p1(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function qF(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function Nx(t){return qke(t)?t:new Pq(t)}function qke(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function Kke(t){return typeof t=="string"||Yke(t)}function Yke(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const Jke="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",KF=[],YF={allowDangerousHtml:!0},Qke=/^(https?|ircs?|mailto|xmpp)$/i,Xke=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Zke(t){const e=eje(t),n=tje(t);return nje(e.runSync(e.parse(n),n),t)}function eje(t){const e=t.rehypePlugins||KF,n=t.remarkPlugins||KF,r=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...YF}:YF;return Hke().use(DAe).use(n).use(Pke,r).use(e)}function tje(t){const e=t.children||"",n=new Pq;return typeof e=="string"&&(n.value=e),n}function nje(t,e){const n=e.allowedElements,r=e.allowElement,s=e.components,i=e.disallowedElements,o=e.skipHtml,l=e.unwrapDisallowed,c=e.urlTransform||rje;for(const d of Xke)Object.hasOwn(e,d.from)&&(""+d.from+(d.to?"use `"+d.to+"` instead":"remove it")+Jke+d.id,void 0);return Iq(t,u),fNe(t,{Fragment:a.Fragment,components:s,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function u(d,h,f){if(d.type==="raw"&&f&&typeof h=="number")return o?f.children.splice(h,1):f.children[h]={type:"text",value:d.value},h;if(d.type==="element"){let m;for(m in sC)if(Object.hasOwn(sC,m)&&Object.hasOwn(d.properties,m)){const g=d.properties[m],x=sC[m];(x===null||x.includes(d.tagName))&&(d.properties[m]=c(String(g||""),m,d))}}if(d.type==="element"){let m=n?!n.includes(d.tagName):i?i.includes(d.tagName):!1;if(!m&&r&&typeof h=="number"&&(m=!r(d,h,f)),m&&f&&typeof h=="number")return l&&d.children?f.children.splice(h,1,...d.children):f.children.splice(h,1),h}}}function rje(t){const e=t.indexOf(":"),n=t.indexOf("?"),r=t.indexOf("#"),s=t.indexOf("/");return e===-1||s!==-1&&e>s||n!==-1&&e>n||r!==-1&&e>r||Qke.test(t.slice(0,e))?t:""}const sje=({productData:t,onViewDetails:e,onAddToCart:n,onBuyNow:r,onVisualize:s})=>{if(!t)return null;const{name:i,description:o,price:l,imageUrl:c,id:u}=t;return a.jsxs(Qe,{className:"mb-2 w-full max-w-xs sm:max-w-sm overflow-hidden shadow-md border border-border",children:[c&&a.jsx("div",{className:"w-full h-32 sm:h-40 overflow-hidden bg-muted",children:a.jsx("img",{src:c,alt:i||"Product image",className:"w-full h-full object-contain"})}),a.jsx(lt,{className:"p-3",children:i&&a.jsx(ct,{className:"text-sm sm:text-base font-semibold leading-tight line-clamp-2",children:i})}),a.jsxs(it,{className:"p-3 pt-0 text-xs sm:text-sm",children:[o&&a.jsx(Qt,{className:"mb-2 line-clamp-2 sm:line-clamp-3 text-muted-foreground",children:o}),l&&a.jsx("p",{className:"font-semibold text-sm sm:text-base",children:typeof l=="number"?`$${l.toFixed(2)}`:l}),a.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row sm:space-x-2 space-y-2 sm:space-y-0",children:[e&&a.jsx(O,{size:"sm",variant:"outline",className:"flex-1 text-xs sm:text-sm",onClick:()=>e(u,i),children:"View"}),n&&a.jsx(O,{size:"sm",variant:"secondary",className:"flex-1 text-xs sm:text-sm",onClick:()=>n(u,i),children:"Add to Cart"}),r&&a.jsx(O,{size:"sm",variant:"default",className:"flex-1 text-xs sm:text-sm",onClick:()=>r(u,i),children:"Buy Now"})]}),s&&a.jsxs(O,{size:"sm",variant:"outline",className:"w-full mt-2 text-xs sm:text-sm",onClick:()=>s(u,i),children:[a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Visualize with Image"]})]})]})},ije="AIzaSyCWUzTb8AC8d6CvHm4_MLgXSeufRQcHQAE",oje=new On({apiKey:ije}),aje="gemini-2.0-flash-preview-image-generation";async function mC(t,e){if(!t)throw new Error("Image source is undefined or null.");let n,r=e;if(typeof t=="string"&&(t.startsWith("http://")||t.startsWith("https://"))){console.log(`Fetching image from URL: ${t}`);const i=await fetch(t);if(!i.ok)throw new Error(`Failed to fetch image from ${t}: ${i.statusText}`);const o=await i.blob();r=o.type||r||"image/jpeg",n=await new Promise((l,c)=>{const u=new FileReader;u.onloadend=()=>{typeof u.result=="string"?l(u.result.split(",")[1]):c(new Error("FileReader did not return a string for URL image."))},u.onerror=d=>c(new Error(`FileReader failed for URL image: ${d}`)),u.readAsDataURL(o)})}else if(typeof t=="string"&&t.startsWith("data:")){console.log("Processing Data URL image.");try{const i=t.split(",");if(i.length<2)throw new Error("Invalid data URL structure.");const o=i[0];n=i[1];const l=o.match(/:(.*?);/);if(!l||!l[1])throw new Error("Could not parse MIME type from data URL.");r=l[1]}catch(i){throw console.error("Error parsing data URL:",t,i),new Error(`Invalid data URL format: ${i.message}`)}}else if(typeof File<"u"&&t instanceof File)console.log(`Processing File object: ${t.name}`),r=t.type,n=await new Promise((i,o)=>{const l=new FileReader;l.onloadend=()=>{typeof l.result=="string"?i(l.result.split(",")[1]):o(new Error("FileReader did not return a string for File object."))},l.onerror=c=>o(new Error(`FileReader failed for File object: ${c}`)),l.readAsDataURL(t)});else if(typeof t=="string"){console.warn(`Received string imageSource that is not a URL or Data URL: "${t}". This path is intended for Node.js file paths.`);try{console.log(`Attempting to read image from local path (Node.js context): ${t}`),n=(await(await Ot(()=>import("./__vite-browser-external-b25bb000.js"),[])).readFile(t)).toString("base64");const c=(await Ot(()=>import("./__vite-browser-external-b25bb000.js"),[])).extname(t).toLowerCase();if(!r)if(c===".png")r="image/png";else if(c===".jpg"||c===".jpeg")r="image/jpeg";else if(c===".webp")r="image/webp";else if(c===".gif")r="image/gif";else throw new Error(`Unsupported image extension or MIME type not provided for path: ${t}`)}catch(i){throw console.error("Failed to process string as Node.js file path (this is expected in browser):",i),new Error("Unsupported string imageSource in browser. Must be URL or Data URL, or provide a File object.")}}else throw new Error("Unsupported image source type. Provide a URL, Data URL, or File object.");if(!n)throw new Error("Could not obtain base64 image data.");r||(r="image/jpeg",console.warn("MIME type could not be determined, defaulting to image/jpeg."));const s=["image/png","image/jpeg","image/webp","image/heic","image/heif"];return s.includes(r)||console.warn(`MIME type ${r} may not be optimally supported. Supported types are: ${s.join(", ")}.`),{inlineData:{data:n,mimeType:r}}}async function Aq({mainProduct:t,referenceSceneSource:e,additionalProducts:n=[],customInstructions:r=""}){var o,l,c,u,d,h,f,m;if(!t||!t.name||!t.imageSource)throw new Error("Main product with name and imageSource is required.");if(!e)throw new Error("Reference scene imageSource is required.");const s=[];let i=`Visually integrate the product named "${t.name}" into a scene inspired by the provided reference scene image.
The main product is described as: "${t.description||"Not specified"}".
The reference scene image sets the style, lighting, and overall environment.
Make the main product the primary focus, well-lit, and naturally fitting the scene's perspective.
`;n.length>0&&(i+=`
Also, incorporate the following additional products naturally into the scene:
`,n.forEach((g,x)=>{i+=`- Product ${x+1}: "${g.name}" (Description: "${g.description||"Not specified"}")
`})),r.trim()!==""&&(i+=`
Specific User Instructions: "${r.trim()}"
`),i+=`
Please generate a high-quality, photorealistic image based on these instructions and the provided images. Also provide a brief text commentary about the generated image or any challenges encountered.`,s.push({text:i});try{s.push(await mC(e)),s.push(await mC(t.imageSource));for(const g of n)if(g.imageSource)try{s.push(await mC(g.imageSource))}catch(x){console.warn(`Could not process image for additional product "${g.name}": ${x.message}. Skipping this image.`)}}catch(g){throw new Error(`Failed to process one or more input images: ${g.message}`)}console.log("Constructed prompt parts. Total parts:",s.length);try{const g=await oje.models.generateContent({model:aje,contents:[{role:"user",parts:s}],generationConfig:{temperature:.6,candidateCount:1},safetySettings:[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE}],config:{responseModalities:[wn.TEXT,wn.IMAGE]}}),x=g;if(!x)throw console.error("Full API result from Gemini was undefined:",g),new Error("Invalid or empty response from Gemini API.");let v=null,w="No specific commentary from the model.";console.log("Full API response from Gemini:",JSON.stringify(x,null,2)),(o=x.promptFeedback)!=null&&o.blockReason&&(w=`Image generation may have been blocked. Reason: ${x.promptFeedback.blockReason}.`,console.warn(w));const _=(l=x.candidates)==null?void 0:l[0];if(_){if(_.finishReason&&_.finishReason!=="STOP"&&_.finishReason!=="MAX_TOKENS"){const C=`Generation stopped. Reason: ${_.finishReason}.`;w=w==="No specific commentary from the model."?C:`${w}. ${C}`,console.warn(C)}if(((u=(c=_.content)==null?void 0:c.parts)==null?void 0:u.length)>0)for(const C of _.content.parts)C.text?w=w==="No specific commentary from the model."||!w.includes(C.text)?w==="No specific commentary from the model."?C.text:w+" "+C.text:w:(h=(d=C.inlineData)==null?void 0:d.mimeType)!=null&&h.startsWith("image/")&&(v=`data:${C.inlineData.mimeType};base64,${C.inlineData.data}`,console.log(`Image generated successfully. MIME type: ${C.inlineData.mimeType}`))}else(f=x.promptFeedback)!=null&&f.blockReason||(w=w==="No specific commentary from the model."?"No candidates returned by the model.":`${w}. Also, no candidates were returned.`);return!v&&w==="No specific commentary from the model."&&(w="Image generation failed, and no specific reason or commentary was provided."),{imageUrl:v,commentary:w,promptUsed:i}}catch(g){console.error("Error during Gemini API call or response processing:",g);let x=g.message;throw(m=g.response)!=null&&m.message?x=g.response.message:g.response&&(x=JSON.stringify(g.response)),new Error(`Product visualization failed: ${x}`)}}BA("pk_live_51NAoUjDktew9heHOJD5Px4jn9IaolhvVvqoE6NukJV7MxZa8PhIVSwcOVWXdQx6MFNgIGmEYeg64lFUGlYfAyVqu004n16tAdG");const kq=()=>{var qe;const t=ti(),{currentStore:e,addToCart:n,getProductById:r,updateQuantity:s,viewMode:i}=$n(),{userRole:o}=Ia(),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[h,f]=p.useState('You are a friendly and helpful AI assistant for an e-commerce store. Be concise and helpful. Always format your responses using Markdown. If a user asks you to find a product, your primary action should be to use the `find_and_open_product` function. **Only after the `find_and_open_product` function successfully returns product details (indicated by `product_found: true` in the function\'s result) should you then say something like "Here is the product I found for you:".** At that point, a product card will also be displayed by the UI. Following your acknowledgment, you MUST ask a relevant follow-up question, such as "Would you like to see more details, add it to your cart, or keep browsing?". If the function call indicates the product was not found (`product_found: false`), you should inform the user you could not find the product and offer to search again or help with something else. Do not repeat raw product data (like image URLs or full product objects) in your text response, as the card already displays this information.'),[m,g]=p.useState(""),[x,v]=p.useState([]),[w,_]=p.useState(null),[C,T]=p.useState(null),[j,A]=p.useState(!1),[E,I]=p.useState(null),N=p.useRef(null),k=p.useRef([]),R=p.useRef(null),D=p.useRef(null),[M,z]=p.useState(null),[B,G]=p.useState(!1),Y=p.useRef(!1),H={name:"find_and_open_product",description:"Finds a product based on a query (name, keywords, or ID) and returns its details for display. It does NOT navigate. After displaying, ask if the user wants to navigate or add to cart.",parameters:{type:rt.OBJECT,properties:{product_query:{type:rt.STRING,description:"The name, keywords, or ID of the product to find."}},required:["product_query"]}},K={name:"navigate_to_product_detail_page",description:"Navigates the user to the detailed page for a specific product, given its ID.",parameters:{type:rt.OBJECT,properties:{product_id:{type:rt.STRING,description:"The unique ID of the product."},product_name:{type:rt.STRING,description:"The name of the product (for confirmation)."}},required:["product_id"]}},$={name:"add_to_cart",description:"Adds a specified product to the user's shopping cart.",parameters:{type:rt.OBJECT,properties:{product_id:{type:rt.STRING,description:"The unique ID of the product to add."},product_name:{type:rt.STRING,description:"The name of the product (for confirmation)."},quantity:{type:rt.NUMBER,description:"The quantity to add. Defaults to 1 if not specified."}},required:["product_id"]}},V={name:"initiate_purchase",description:"Initiates the purchase process for a specified product, potentially by adding to cart and navigating to checkout or directly to a payment page.",parameters:{type:rt.OBJECT,properties:{product_id:{type:rt.STRING,description:"The unique ID of the product to purchase."},product_name:{type:rt.STRING,description:"The name of the product (for confirmation)."}},required:["product_id"]}},W={name:"navigate_home",description:`Navigates the user to the application's home page (typically the root path "/").`,parameters:{type:rt.OBJECT,properties:{}}},F={name:"navigate_to_content_creation_page",description:"Navigates the user to the content creation page.",parameters:{type:rt.OBJECT,properties:{}}},Z={name:"navigate_to_store_dashboard",description:"Navigates the user to the store dashboard page.",parameters:{type:rt.OBJECT,properties:{}}},ce={name:"navigate_to_route",description:'Navigates the user to a specified route within the application. Use for requests like "go to a specific page". This is a generic navigation tool.',parameters:{type:rt.OBJECT,properties:{route:{type:rt.STRING,description:'The path to navigate to (e.g., "/", "/content-creation", "/dashboard").'}},required:["route"]}},le={name:"toggle_theme_mode",description:"Toggles the application's visual theme between light and dark mode.",parameters:{type:rt.OBJECT,properties:{}}},he={name:"open_import_store_dialog",description:"Opens the dialog or interface for importing a store from another platform.",parameters:{type:rt.OBJECT,properties:{}}},Le={name:"go_to_cart",description:"Navigates the user to their shopping cart page.",parameters:{type:rt.OBJECT,properties:{}}},Ve=[H,K,$,V,ce,le,he,Le,W,F,Z],Be=()=>{var oe;(oe=R.current)==null||oe.scrollIntoView({behavior:"smooth"})};p.useEffect(Be,[x]);const ue=()=>c(!l),Ce=()=>d(!u),Ie=()=>{d(!1)},ve=(oe=null)=>{const _e=typeof oe=="string"?oe:m;if(_e.trim()==="")return;const ze=`user-text-${Date.now()}`;v(Te=>[...Te,{id:ze,role:"user",text:_e}]),typeof oe!="string"&&g(""),w==="gemini"&&C?ie(_e):console.error("Error: Gemini chat not active. Cannot send message.")},ie=async oe=>{if(!C){console.error("Gemini chat not initialized.");return}try{const _e=await C.sendMessageStream({message:[{text:oe}]}),ze=`assistant-gemini-${Date.now()}`;v(wt=>[...wt,{id:ze,role:"assistant",text:"",functionCallData:null}]);let Te="",Tt=null;for await(const wt of _e){let xt=null;wt.functionCalls&&wt.functionCalls.length>0?xt=wt.functionCalls[0]:wt.functionCall&&(xt=wt.functionCall),xt&&(Tt=xt);const pt=wt.text;pt&&(Te+=pt,v(Pt=>Pt.map(Rn=>Rn.id===ze?{...Rn,text:Te}:Rn)))}Tt?(v(wt=>wt.map(xt=>{if(xt.id===ze){let pt=`(Function call: ${Tt.name})`;Tt.name==="find_and_open_product"&&(pt="Searching for product…");const Pt=Te.trim()===""?pt:`${Te}
${pt}`;return{...xt,text:Pt,functionCallData:Tt}}return xt})),await Ue(Tt,ze)):Te.trim()!==""||v(wt=>wt.map(xt=>xt.id===ze?{...xt,text:"(Assistant responded without text)"}:xt))}catch(_e){console.error("Error sending/receiving Gemini message:",_e)}},Me=oe=>{const _e=oe.route;if(_e)try{return t(_e),{success:!0,detail:`Successfully navigated to ${_e}`}}catch(ze){return console.error("Navigation error:",ze),{success:!1,detail:`Failed to navigate: ${ze.message}`}}return{success:!1,detail:"Route not provided in arguments."}},He=oe=>({success:!0,detail:"Theme toggled (placeholder action)."}),yt=oe=>({success:!0,detail:"Import store dialog would be shown (placeholder action)."}),kt=oe=>{try{return t("/cart"),{success:!0,detail:"Navigated to cart page."}}catch(_e){return console.error("Navigation to cart error:",_e),{success:!1,detail:`Failed to navigate to cart: ${_e.message}`}}},en=oe=>{var Tt,wt,xt,pt,Pt,Rn,Sn,cr,sn;const _e=(Tt=oe.product_query)==null?void 0:Tt.toLowerCase().trim();if(!_e)return{success:!0,product_found:!1,detail:"Product query not provided."};if(!e||!e.products||e.products.length===0)return{success:!0,product_found:!1,detail:"No products available in the current store to search."};const ze=e.products;let Te=null;if(Te=ze.find($t=>{var tn;return((tn=$t.name)==null?void 0:tn.toLowerCase())===_e}),!Te){const $t=_e.split(/\s+/).filter(tn=>tn.length>1);if($t.length>0){let tn=ze.map(Zn=>{var Oe,tt;const J=((Oe=Zn.name)==null?void 0:Oe.toLowerCase())||"",re=((tt=Zn.description)==null?void 0:tt.toLowerCase())||"";let ge=0;return $t.forEach(Q=>{J.includes(Q)&&(ge+=2),re.includes(Q)&&(ge+=1)}),J.includes(_e)&&(ge+=5),re.includes(_e)&&(ge+=2),{product:Zn,score:ge}});tn=tn.filter(Zn=>Zn.score>0).sort((Zn,J)=>J.score-Zn.score),tn.length>0&&(Te=tn[0].product)}}if(Te||/^[a-zA-Z0-9-_]+$/.test(_e)&&!_e.includes(" ")&&(Te=ze.find($t=>{var tn;return((tn=$t.id)==null?void 0:tn.toString())===_e})),Te){let $t=null;return(xt=(wt=Te.image)==null?void 0:wt.src)!=null&&xt.large&&typeof Te.image.src.large=="string"?$t=Te.image.src.large:(Pt=(pt=Te.image)==null?void 0:pt.src)!=null&&Pt.medium&&typeof Te.image.src.medium=="string"?$t=Te.image.src.medium:(Sn=(Rn=Te.image)==null?void 0:Rn.src)!=null&&Sn.small&&typeof Te.image.src.small=="string"?$t=Te.image.src.small:Te.image_url&&typeof Te.image_url=="string"?$t=Te.image_url:Te.imageUrl&&typeof Te.imageUrl=="string"?$t=Te.imageUrl:Te.image&&typeof Te.image=="string"?$t=Te.image:Te.images&&Array.isArray(Te.images)&&Te.images.length>0&&((cr=Te.images[0])!=null&&cr.src)&&typeof Te.images[0].src=="string"?$t=Te.images[0].src:(sn=Te.featuredImage)!=null&&sn.url&&typeof Te.featuredImage.url=="string"&&($t=Te.featuredImage.url),$t&&typeof $t=="string"&&$t.trim()!==""?$t=$t.trim():$t=null,{success:!0,product_found:!0,product_data:{id:Te.id,name:Te.name,description:Te.description||"No description available.",price:Te.price||"Price not available.",imageUrl:$t},detail:`Found product: ${Te.name}`}}else return{success:!0,product_found:!1,detail:`Could not find a matching or relevant product for query: "${oe.product_query}"`}},mn=oe=>oe.product_id&&e&&e.id?(t(`/store/${e.id}/product/${oe.product_id}`),{success:!0,detail:`Navigated to product page for ID ${oe.product_id} in store ${e.id}`}):!e||!e.id?{success:!1,detail:"Current store information is not available for navigation."}:{success:!1,detail:"Product ID not provided for navigation."},cn=oe=>{if(!e||!e.id)return{success:!1,detail:"Current store not available for cart operation."};if(!oe.product_id)return{success:!1,detail:"Product ID not provided to add to cart."};const _e=r(e.id,oe.product_id);if(_e){const ze=oe.quantity||1;return n(_e,e.id),ze>1&&s(oe.product_id,e.id,ze),{success:!0,detail:`${oe.product_name||_e.name||"Product"} added/updated in cart with quantity ${ze}.`}}else return{success:!1,detail:`Product with ID ${oe.product_id} not found.`}},fn=oe=>{const{product_id:_e,product_name:ze}=oe;if(!e||!e.id)return console.error("Buy Now: Current store not available."),{success:!1,detail:"Current store information is not available to initiate purchase."};if(!_e)return console.error("Buy Now: Product ID not provided."),{success:!1,detail:"Product ID not provided."};const Te=r(e.id,_e);if(!Te)return console.error(`Buy Now: Product with ID ${_e} not found.`),{success:!1,detail:`Product with ID ${_e} not found.`};try{return n(Te,e.id),t("/checkout",{state:{action:"buyNow",productToAddId:Te.id,storeId:e.id}}),{success:!0,detail:`Added ${Te.name||"product"} to cart and navigated to checkout.`}}catch(Tt){return console.error("Error during Buy Now (add to cart & navigate) process:",Tt),{success:!1,detail:Tt.message||"Could not process Buy Now action."}}},Ue=async(oe,_e)=>{let ze,Te=!1;switch(oe.name){case"navigate_to_route":ze=Me(oe.args),Te=ze.success;break;case"toggle_theme_mode":ze=He(oe.args),Te=ze.success;break;case"open_import_store_dialog":ze=yt(oe.args),Te=ze.success;break;case"go_to_cart":ze=kt(oe.args),Te=ze.success;break;case"navigate_home":ze=Me({route:"/"}),Te=ze.success;break;case"navigate_to_content_creation_page":ze=Me({route:"/content-creation"}),Te=ze.success;break;case"navigate_to_store_dashboard":ze=Me({route:"/dashboard"}),Te=ze.success;break;case"find_and_open_product":ze=en(oe.args),Te=ze.success;break;case"navigate_to_product_detail_page":ze=mn(oe.args),Te=ze.success;break;case"add_to_cart":ze=cn(oe.args),Te=ze.success;break;case"initiate_purchase":ze=fn(oe.args),Te=ze.success;break;default:ze={success:!1,detail:`Error: Unknown function ${oe.name}`}}if(!Te){console.error(`Function ${oe.name} execution failed: ${ze.detail}`),v(wt=>wt.map(xt=>xt.id===_e?{...xt,text:(xt.text.replace(/\(Function call: .*\)/,"").trim()+`
(Function ${oe.name} failed)`).trim(),functionCallData:null}:xt));return}const Tt={message:[{functionResponse:{name:oe.name,response:{result:ze}}}]};try{const wt=await C.sendMessageStream(Tt);let xt="";v(pt=>pt.map(Pt=>Pt.id===_e?{...Pt,text:"",functionCallData:null,productCardData:null}:Pt));for await(const pt of wt){if(pt.functionCalls||pt.functionCall){console.error("Model attempted another function call immediately after a function response.");break}const Pt=pt.text;Pt&&(xt+=Pt,v(Rn=>Rn.map(Sn=>{if(Sn.id===_e){const cr={...Sn,text:xt};return oe.name==="find_and_open_product"&&ze.success&&ze.product_found&&(cr.productCardData=ze.product_data),cr}return Sn})))}oe.name==="find_and_open_product"&&ze.success&&ze.product_found&&v(pt=>pt.map(Pt=>Pt.id===_e?{...Pt,productCardData:ze.product_data}:Pt)),xt.trim()===""&&(oe.name==="find_and_open_product"&&ze.product_found?v(pt=>pt.map(Pt=>Pt.id===_e&&Pt.text.trim()===""?{...Pt,text:"Here is the product information:"}:Pt)):v(pt=>pt.map(Pt=>Pt.id===_e&&Pt.text.trim()===""?{...Pt,text:"(Function processed)"}:Pt)))}catch(wt){console.error("Error sending function response or getting final response from Gemini:",wt),v(xt=>xt.map(pt=>pt.id===_e?{...pt,text:(pt.text+`
(Error processing function result)`).trim(),functionCallData:null}:pt))}},Et=async()=>{if(C||B)return;G(!0);const oe="AIzaSyCWUzTb8AC8d6CvHm4_MLgXSeufRQcHQAE";try{const _e=new On({apiKey:oe}),Te=x.filter(xt=>xt.role==="user"||xt.role==="assistant").map(xt=>({role:xt.role==="assistant"?"model":"user",parts:[{text:xt.text||""}]})).filter(xt=>xt.parts.every(pt=>typeof pt.text=="string"&&pt.text.trim()!=="")),Tt={tools:[{functionDeclarations:Ve}],systemInstruction:h},wt=_e.chats.create({model:"gemini-2.0-flash",history:Te,config:Tt,generationConfig:{}});if(!wt)throw new Error("genAI.chats.create() returned a null or undefined chat instance.");T(wt),_("gemini"),Y.current=!1}catch(_e){console.error("Error initializing Gemini chat:",_e),T(null),_(null)}finally{G(!1)}},de=()=>{T(null),G(!1),_(null),Y.current=!1};p.useEffect(()=>(l?!C&&!B&&Et():de(),()=>de()),[l]),p.useEffect(()=>{w==="gemini"?Y.current?h&&!B&&C&&(T(null),Y.current=!1,Et()):Y.current=!0:Y.current=!1},[h,w,B,C]);const De=(oe,_e)=>{mn({product_id:oe})},ee=(oe,_e)=>{if(!e||!e.id){console.error("Cannot add to cart: current store not available.");return}const ze=r(e.id,oe);ze?n(ze,e.id):console.error(`Product with ID ${oe} not found, cannot add to cart.`)},ae=async(oe,_e)=>{const ze=await fn({product_id:oe,product_name:_e});ze.success||console.error("Buy Now failed:",ze.detail)},X=(oe,_e)=>{var ze;z({id:oe,name:_e}),(ze=D.current)==null||ze.click()},Pe=oe=>{var ze,Te,Tt,wt,xt,pt,Pt,Rn;if(!oe)return null;let _e=null;return(Te=(ze=oe.image)==null?void 0:ze.src)!=null&&Te.large&&typeof oe.image.src.large=="string"?_e=oe.image.src.large:(wt=(Tt=oe.image)==null?void 0:Tt.src)!=null&&wt.medium&&typeof oe.image.src.medium=="string"?_e=oe.image.src.medium:(pt=(xt=oe.image)==null?void 0:xt.src)!=null&&pt.small&&typeof oe.image.src.small=="string"?_e=oe.image.src.small:oe.image_url&&typeof oe.image_url=="string"?_e=oe.image_url:oe.imageUrl&&typeof oe.imageUrl=="string"?_e=oe.imageUrl:oe.image&&typeof oe.image=="string"?_e=oe.image:oe.images&&Array.isArray(oe.images)&&oe.images.length>0&&((Pt=oe.images[0])!=null&&Pt.src)?_e=oe.images[0].src:(Rn=oe.featuredImage)!=null&&Rn.url&&(_e=oe.featuredImage.url),_e&&typeof _e=="string"&&_e.trim()!==""?_e.trim():null},Ae=async oe=>{var ze;const _e=(ze=oe.target.files)==null?void 0:ze[0];if(!_e||!M){z(null),D.current&&(D.current.value="");return}v(Te=>[...Te,{id:`system-visualizing-${Date.now()}`,role:"system",text:`Visualizing ${M.name} with your uploaded image. This may take a moment...`}]);try{console.log("[ChatViz] Getting product details for ID:",M.id);const Te=r(e.id,M.id);if(!Te)throw console.error("[ChatViz] Product not found for ID:",M.id),new Error("Product details not found for visualization.");console.log("[ChatViz] Product found:",Te.name);const Tt=Pe(Te);if(!Tt)throw console.error("[ChatViz] Product actual image URL is missing or invalid for product:",Te.name,"Raw product data:",Te),new Error("Product does not have a valid existing image to use for visualization context.");console.log("[ChatViz] Actual Product imageUrl to use:",Tt);const wt={name:Te.name,description:Te.description,imageSource:Tt},xt=`Visualize the product "${Te.name}" in a new scene inspired by the provided reference image. Focus on a creative and appealing composition.`;console.log("[ChatViz] Calling generateProductVisualization...");const pt=await Aq({mainProduct:wt,referenceSceneSource:_e,additionalProducts:[],customInstructions:xt});if(console.log("[ChatViz] generateProductVisualization result:",pt),pt&&pt.imageUrl)v(Pt=>[...Pt,{id:`assistant-viz-${Date.now()}`,role:"assistant",text:pt.commentary||`Here's a new visualization for ${Te.name}:`,imageDataUrl:pt.imageUrl}]);else throw console.error("[ChatViz] generateProductVisualization did not return an imageUrl. Commentary:",pt==null?void 0:pt.commentary),new Error((pt==null?void 0:pt.commentary)||"Visualization did not return an image.")}catch(Te){console.error("Error during visualization in chat:",Te.name,Te.message,Te.stack),v(Tt=>[...Tt,{id:`error-viz-${Date.now()}`,role:"system",text:`Sorry, I couldn't visualize the product. Error: ${Te.name} - ${Te.message}`}])}finally{z(null),D.current&&(D.current.value="")}},$e=async()=>{if(j)N.current&&N.current.state==="recording"&&N.current.stop(),A(!1);else try{const oe=await navigator.mediaDevices.getUserMedia({audio:!0});N.current=new MediaRecorder(oe),k.current=[],N.current.ondataavailable=_e=>{k.current.push(_e.data)},N.current.onstop=async()=>{const _e=new Blob(k.current,{type:"audio/webm"});k.current=[],console.log("Audio recorded:",_e),v(ze=>[...ze,{id:`user-audio-${Date.now()}`,role:"user",text:"[User sent audio]"}]),setTimeout(()=>{const ze=`assistant-audio-${Date.now()}`;v(Te=>[...Te,{id:ze,role:"assistant",text:"[Assistant audio response]"}])},2e3)},N.current.start(),A(!0),v(_e=>[..._e,{id:`system-rec-${Date.now()}`,role:"system",text:"Recording started..."}])}catch(oe){console.error("Error accessing microphone:",oe),v(_e=>[..._e,{id:`error-mic-${Date.now()}`,role:"system",text:"Error: Could not access microphone."}])}};return p.useEffect(()=>()=>{E&&E.context.state!=="closed"&&E.context.close(),N.current&&N.current.stream&&N.current.stream.getTracks().forEach(oe=>oe.stop())},[E]),a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"file",ref:D,style:{display:"none"},accept:"image/*",onChange:Ae}),!l&&a.jsx(O,{onClick:ue,className:"fixed bottom-[96px] right-0 py-4 pl-4 pr-1.5 shadow-lg z-50 rounded-tl-[20px] rounded-bl-[20px] rounded-tr-none rounded-br-none",size:"icon","aria-label":"Open Chatbot",style:{backgroundColor:((qe=e==null?void 0:e.theme)==null?void 0:qe.primaryColor)||"#007bff"},children:a.jsx(Hie,{size:20})}),l&&a.jsxs(Qe,{className:"fixed bottom-[96px] right-4 w-full max-w-md h-[70vh] max-h-[600px] shadow-xl z-[1000] flex flex-col bg-background border rounded-lg",children:[a.jsxs(lt,{className:"flex flex-row items-center justify-between p-3 border-b",children:[a.jsx(ct,{className:"text-md font-semibold",children:"Gemini Assistant"}),a.jsxs("div",{className:"flex items-center gap-1",children:[(o==="admin"||i==="edit")&&a.jsx(O,{variant:"ghost",size:"icon",onClick:Ce,title:"Set Knowledge Base",children:a.jsx(toe,{size:18})}),a.jsx(O,{variant:"ghost",size:"icon",onClick:ue,title:"Close Chat",children:a.jsx(Hi,{size:18})})]})]}),u&&a.jsxs("div",{className:"p-3 border-b bg-muted/40",children:[a.jsx("label",{htmlFor:"knowledgeBaseInput",className:"text-xs font-medium mb-1 block text-muted-foreground",children:"Knowledge Base (Instructions for Gemini)"}),a.jsx(En,{id:"knowledgeBaseInput",placeholder:"Enter instructions for the assistant...",value:h,onChange:oe=>f(oe.target.value),className:"h-28 text-xs mb-2 rounded-md"}),a.jsx(O,{onClick:Ie,size:"sm",className:"w-full",disabled:B||!C,children:"Save & Apply Instructions"})]}),a.jsxs(it,{className:"flex-grow p-3 overflow-y-auto space-y-3",children:[x.map(oe=>(oe.role==="user"||oe.role==="assistant")&&a.jsx("div",{className:`flex flex-col ${oe.role==="user"?"items-end":"items-start"}`,children:a.jsx("div",{className:`max-w-[80%] p-2.5 rounded-lg text-sm ${oe.role==="user"?"bg-primary text-primary-foreground rounded-br-none":"bg-muted rounded-bl-none"}`,children:oe.role==="assistant"?a.jsxs(a.Fragment,{children:[oe.productCardData&&a.jsx(sje,{productData:oe.productCardData,onViewDetails:De,onAddToCart:ee,onBuyNow:ae,onVisualize:oe.productCardData.imageUrl&&typeof oe.productCardData.imageUrl=="string"&&oe.productCardData.imageUrl.trim()!==""?X:null}),oe.imageDataUrl&&a.jsx("img",{src:oe.imageDataUrl,alt:"Generated visualization",className:"max-w-full h-auto rounded-md my-2"}),oe.text&&a.jsx("div",{className:`prose prose-sm max-w-none dark:prose-invert ${oe.productCardData||oe.imageDataUrl?"mt-2":""}`,children:a.jsx(Zke,{children:oe.text})}),!oe.productCardData&&!oe.text&&!oe.imageDataUrl&&a.jsx("p",{className:"whitespace-pre-wrap",children:"(Assistant message)"})]}):a.jsx("p",{className:"whitespace-pre-wrap",children:oe.text})})},oe.id)),a.jsx("div",{ref:R})]}),a.jsx(pd,{className:"p-3 border-t",children:a.jsxs("div",{className:"flex w-full items-center gap-2",children:[a.jsx(O,{onClick:$e,size:"icon",variant:j?"destructive":"outline",title:j?"Stop Recording":"Start Recording",disabled:!w||B,className:"p-2",children:j?a.jsx(roe,{size:18}):a.jsx(qie,{size:18})}),a.jsx(En,{placeholder:j?"Recording audio...":"Type a message or use microphone...",value:m,onChange:oe=>g(oe.target.value),onKeyPress:oe=>{oe.key==="Enter"&&!oe.shiftKey&&(oe.preventDefault(),ve())},className:"flex-grow resize-none text-sm p-2 rounded-md min-h-[40px] max-h-[100px]",rows:1,disabled:!w||B||j}),a.jsx(O,{onClick:()=>ve(),size:"icon",title:"Send Message",disabled:!m.trim()||!w||B||j,children:a.jsx(eoe,{size:18})})]})})]})]})};function lje({title:t,titleId:e,...n},r){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?p.createElement("title",{id:e},t):null,p.createElement("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"}))}const cje=p.forwardRef(lje),uje=cje;function dje({title:t,titleId:e,...n},r){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?p.createElement("title",{id:e},t):null,p.createElement("path",{d:"M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z"}))}const hje=p.forwardRef(dje),fje=hje,Gn=({initialText:t,onSave:e,isAdmin:n,placeholder:r="Enter text...",as:s="span",className:i="",textClassName:o="",inputClassName:l="",useTextarea:c=!1})=>{const[u,d]=p.useState(!1),[h,f]=p.useState(t),m=p.useRef(null);p.useEffect(()=>{f(t)},[t]),p.useEffect(()=>{u&&m.current&&(m.current.focus(),m.current.select(),c&&(m.current.style.height="auto",m.current.style.height=`${m.current.scrollHeight}px`))},[u,c]);const g=()=>{e&&e(h),d(!1)},x=_=>{f(_.target.value),c&&m.current&&(m.current.style.height="auto",m.current.style.height=`${m.current.scrollHeight}px`)},v=_=>{_.key==="Enter"&&!c?g():_.key==="Escape"&&(f(t),d(!1))},w=s;return n?a.jsx(w,{className:`inline-text-edit-container relative group ${i} ${u?"w-full":""}`,children:u?a.jsxs("div",{className:"flex items-start space-x-1 w-full",children:[" ",c?a.jsx("textarea",{ref:m,value:h,onChange:x,onKeyDown:v,onBlur:g,className:`p-0 m-0 border-none focus:ring-0 focus:outline-none resize-none overflow-hidden bg-transparent text-inherit font-inherit w-full ${o} ${l}`,placeholder:r,rows:1}):a.jsx("input",{ref:m,type:"text",value:h,onChange:x,onKeyDown:v,onBlur:g,className:`p-0 m-0 border-none focus:ring-0 focus:outline-none bg-transparent text-inherit font-inherit w-full ${o} ${l}`,placeholder:r}),a.jsx("button",{onClick:g,className:"p-1 text-green-500 hover:text-green-700 flex-shrink-0",title:"Save",children:a.jsx(uje,{className:"h-5 w-5"})})]}):a.jsxs("div",{className:`flex items-center space-x-1 cursor-pointer w-full ${o}`,onClick:()=>d(!0),role:"button",tabIndex:0,onKeyDown:_=>{_.key==="Enter"&&d(!0)},children:[a.jsx("span",{className:"flex-grow",children:h||r}),a.jsx(fje,{className:"h-4 w-4 text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"})]})}):a.jsx(w,{className:o,children:h||r})},mje=({store:t,isPublishedView:e=!1})=>{var f;const{updateStore:n}=$n(),r=(t==null?void 0:t.name)||"Our Store",s=t==null?void 0:t.id,i=!e,o={title:`The ${r} Way`,subtitle:"Discover the core values that make us unique.",items:[{emoji:"✨",icon:Er,title:"Quality First",description:"We prioritize premium materials and craftsmanship in every product."},{emoji:"🌿",icon:Bie,title:"Sustainable Practices",description:"Committed to eco-friendly sourcing and ethical production."},{emoji:"⚡️",icon:V3,title:"Innovative Design",description:"Blending timeless styles with modern, cutting-edge aesthetics."},{emoji:"💖",icon:P3,title:"Customer Love",description:"Our customers are at the heart of everything we do."}]},l=((f=t==null?void 0:t.content)==null?void 0:f.storeWay)||o,c=l.items&&l.items.length>0?l.items:o.items,u=async(m,g,x=null)=>{if(!s)return;let v={title:l.title,subtitle:l.subtitle,items:[...c].map(w=>({...w}))};x!==null&&v.items[x]?m==="itemTitle"?v.items[x].title=g:m==="itemDescription"?v.items[x].description=g:m==="itemEmoji"&&(v.items[x].emoji=g):m==="title"?v.title=g:m==="subtitle"&&(v.subtitle=g);try{await n(s,{content:{...t.content,storeWay:v}})}catch(w){console.error(`Failed to update store way content for ${m}:`,w)}},d=({item:m})=>{const g=m.icon||O3;return a.jsx(g,{className:"w-8 h-8 mb-4 text-[var(--theme-primary)]"})},h=(t==null?void 0:t.template_version)||"classic";return a.jsx("section",{className:"py-16 md:py-24 bg-background",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12 md:mb-16",children:[a.jsx("div",{className:`inline-flex items-center justify-center bg-[var(--theme-primary-10)] p-3 mb-4 ${h!=="sleek"?"rounded-full":""}`,children:a.jsx(Zv,{className:"h-8 w-8 text-[var(--theme-primary)]"})}),a.jsx(Gn,{initialText:l.title,onSave:m=>u("title",m),isAdmin:i,placeholder:"Section Title",as:"h2",textClassName:"text-4xl md:text-5xl font-bold tracking-tight text-foreground"}),a.jsx(Gn,{initialText:l.subtitle,onSave:m=>u("subtitle",m),isAdmin:i,placeholder:"Section Subtitle",as:"p",textClassName:"text-lg text-muted-foreground max-w-xl mx-auto mt-3"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:c.map((m,g)=>a.jsxs(It.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.4,delay:g*.1+.2},className:`bg-card p-6 shadow-lg text-center border border-border/50 hover:shadow-2xl transition-shadow ${h!=="sleek"?"rounded-xl":""}`,children:[a.jsxs("div",{className:"flex justify-center items-center mb-4",children:[i?a.jsx(Gn,{initialText:m.emoji,onSave:x=>u("itemEmoji",x,g),isAdmin:i,placeholder:"✨",textClassName:"text-4xl"}):a.jsx("span",{className:"text-4xl",children:m.emoji}),!m.emoji&&a.jsx(d,{item:m})]}),a.jsx("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:a.jsx(Gn,{initialText:m.title,onSave:x=>u("itemTitle",x,g),isAdmin:i,placeholder:"Item Title"})}),a.jsx("p",{className:"text-muted-foreground text-sm",children:a.jsx(Gn,{initialText:m.description,onSave:x=>u("itemDescription",x,g),isAdmin:i,placeholder:"Item Description",useTextarea:!0})})]},g))})]})})},jq="CEVWpXluVU77FgaVriTzqBCoN4FD3f0VL2Y8bXNPynNfqUg2DoUgPt8t",pje="https://api.pexels.com/videos",gje="https://api.pexels.com/v1";async function Rq(t,e=15){if(!t||!t.trim())return{error:"Search query cannot be empty."};const n=t.split(" ")[0],r=`${pje}/search?query=${encodeURIComponent(n)}&per_page=${e}`;try{const s=await fetch(r,{headers:{Authorization:jq}});if(!s.ok){const d=await s.json().catch(()=>({message:s.statusText}));return console.error("Pexels API error:",s.status,d),{error:`Pexels API error: ${d.message||s.statusText}`}}const i=await s.json();if(!i.videos||i.videos.length===0)return{videos:[],totalResults:0};const o=Math.floor(Math.random()*i.videos.length),l=i.videos[o],c=l.video_files.find(d=>d.file_type==="video/mp4"&&(d.quality==="hd"||d.quality==="sd"))||l.video_files.find(d=>d.file_type==="video/mp4");return{video:{id:l.id,width:l.width,height:l.height,duration:l.duration,imageUrl:l.image,videoUrl:c?c.link:l.video_files[0]?l.video_files[0].link:null,photographer:l.user.name,pexelsUrl:l.url},totalResults:i.total_results}}catch(s){return console.error("Error fetching from Pexels API:",s),{error:`Network error or other issue fetching Pexels videos: ${s.message}`}}}async function yje(t,e=9){if(!t||!t.trim())return{error:"Search query cannot be empty."};const n=`${gje}/search?query=${encodeURIComponent(t)}&per_page=${e}`;try{const r=await fetch(n,{headers:{Authorization:jq}});if(!r.ok){const o=await r.json().catch(()=>({message:r.statusText}));return console.error("Pexels API error:",r.status,o),{error:`Pexels API error: ${o.message||r.statusText}`}}const s=await r.json();return{photos:s.photos.map(o=>({id:o.id,width:o.width,height:o.height,src:o.src.medium,alt:o.alt,photographer:o.photographer,pexelsUrl:o.url})),totalResults:s.total_results,page:s.page,perPage:s.per_page}}catch(r){return console.error("Error fetching from Pexels API:",r),{error:`Network error or other issue fetching Pexels photos: ${r.message}`}}}const xje=({open:t,onOpenChange:e,storeId:n,currentVideoUrl:r,onVideoReplaced:s})=>{const[i,o]=p.useState("ai"),[l,c]=p.useState(""),[u,d]=p.useState(!1),[h,f]=p.useState(null),[m,g]=p.useState(""),[x,v]=p.useState(null),[w,_]=p.useState(!1),[C,T]=p.useState(null),[j,A]=p.useState(null),[E,I]=p.useState(null),[N,k]=p.useState(!1);p.useEffect(()=>{t&&(c(""),d(!1),f(null),g(""),v(null),_(!1),T(null),A(null),I(null),k(!1))},[t]);const R=async()=>{if(!l.trim()){f("Please enter a prompt for the video.");return}d(!0),f(null);try{console.log(`Generating video for store ${n} with prompt: "${l}"`);const G=await Oae(l);s&&s(G),e(!1),c("")}catch(G){console.error("Error generating video with AI:",G),f(G.message||"Failed to generate video. Please try again.")}finally{d(!1)}},D=async()=>{if(!m.trim()){T("Please enter a search query for Pexels.");return}_(!0),T(null),v(null);try{const G=await Rq(m);G.error?T(G.error):G.video?v(G.video):T("No video found for your query.")}catch(G){console.error("Error searching Pexels videos:",G),T(G.message||"Failed to search Pexels. Please try again.")}finally{_(!1)}},M=G=>{s&&G?(s(G),e(!1)):T("Invalid video URL selected or replacement handler missing.")},z=G=>{const Y=G.target.files[0];if(Y){if(Y.size>50*1024*1024){I("File is too large. Please select a video under 50MB."),A(null);return}if(!Y.type.startsWith("video/")){I("Invalid file type. Please select a video file."),A(null);return}A(Y),I(null)}},B=()=>{if(j&&s){k(!0),I(null);const G=new FileReader;G.onloadend=()=>{s(G.result),e(!1),A(null),k(!1)},G.onerror=()=>{I("Failed to read video file for upload."),k(!1)},G.readAsDataURL(j)}else I("No video file selected or replacement handler missing.")};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs(Vr,{className:"sm:max-w-[672px]",children:[a.jsxs(Ur,{className:"text-left",children:[a.jsx(Br,{children:"Replace Hero Video"}),a.jsxs(Qi,{className:"text-left",children:["Current video: ",a.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline truncate block max-w-full",children:r||"No video set"})]})]}),a.jsxs(_i,{value:i,onValueChange:o,className:"w-full",children:[a.jsxs(ni,{className:"grid w-full grid-cols-3",children:[" ",a.jsx(Vt,{value:"ai",children:"AI Generation (Veo)"}),a.jsx(Vt,{value:"pexels",children:"Search Pexels"}),a.jsx(Vt,{value:"upload",children:"Upload Video"})," "]}),a.jsxs(Ut,{value:"ai",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"aiPrompt",className:"text-left block mb-1",children:"AI Video Prompt"}),a.jsx(Je,{id:"aiPrompt",value:l,onChange:G=>c(G.target.value),placeholder:"e.g., A futuristic cityscape at sunset",disabled:u})]}),h&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:h}),a.jsxs(Ar,{className:"justify-start pt-4",children:[a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:u,children:"Cancel"}),a.jsx(O,{onClick:R,disabled:u||!l.trim(),children:u?"Generating...":"Generate Video"})]})]}),a.jsxs(Ut,{value:"pexels",className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{id:"pexelsQuery",value:m,onChange:G=>g(G.target.value),placeholder:"e.g., Nature, Business, Technology",disabled:w,className:"flex-grow"}),a.jsx(O,{onClick:D,disabled:w||!m.trim(),children:w?"Searching...":"Search"})]}),C&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:C}),w&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Loading Pexels video..."}),!w&&x&&a.jsx("div",{className:"flex justify-center",children:a.jsxs("div",{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border hover:border-primary w-full max-w-md",onClick:()=>M(x.videoUrl),children:[a.jsx("img",{src:x.imageUrl,alt:`Pexels video by ${x.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),a.jsx("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:a.jsx("p",{className:"text-white text-lg font-semibold text-center p-2 bg-black/50 rounded",children:"Use This Video"})})]})}),a.jsx(Ar,{className:"justify-start pt-4",children:a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:w,children:"Cancel"})})]}),a.jsxs(Ut,{value:"upload",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"video-upload-input",className:"text-left block mb-1",children:"Select Video File"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(Je,{id:"video-upload-input",type:"file",accept:"video/*",onChange:z,className:"flex-grow",disabled:N})}),j&&a.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected: ",j.name," (",(j.size/1024/1024).toFixed(2)," MB)"]}),E&&a.jsx("p",{className:"text-sm text-red-500 text-center mt-2",children:E})]}),a.jsxs(Ar,{className:"justify-start pt-4",children:[a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:N,children:"Cancel"}),a.jsx(O,{onClick:B,disabled:N||!j,children:N?"Uploading...":"Confirm Upload"})]})]})]})]})})},vje=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),wje=({isOpen:t,onOpenChange:e,currentImageUrl:n,onImageSelected:r,imageSearchContext:s="image",modalTitle:i="Change Image",storeName:o="your store"})=>{const{toast:l}=as(),[c,u]=p.useState("search"),[d,h]=p.useState(s),[f,m]=p.useState([]),[g,x]=p.useState(!1),[v,w]=p.useState(`A visually appealing ${s} for ${o}`),_=async()=>{if(d.trim()){x(!0),m([]);try{const A=await io(d,9,"landscape");m(A.map(E=>({id:E.id.toString(),src:{medium:E.src.large,large:E.src.large},alt:E.alt||d,photographer:E.photographer})))}catch(A){l({title:"Pexels Search Failed",description:A.message,variant:"destructive"})}x(!1)}},C=async()=>{if(v.trim()){x(!0),m([]);try{const A=await j0(v);if(A&&A.url)m([{id:Ft(),src:{medium:A.url,large:A.url},alt:A.alt||v,photographer:"Generated by AI"}]),l({title:"AI Image Generated",description:"Select the image below or generate more."});else throw new Error("AI did not return an image URL.")}catch(A){l({title:"AI Image Generation Failed",description:A.message,variant:"destructive"})}x(!1)}},T=async A=>{const E=A.target.files[0];if(E){x(!0);try{const I=await vje(E);r(I),l({title:"Image Uploaded",description:"Your image has been selected."}),e(!1)}catch{l({title:"Upload Failed",description:"Could not process the uploaded file.",variant:"destructive"})}x(!1)}},j=A=>{r(A),e(!1)};return p.useEffect(()=>{t&&(h(s||"abstract background"),w(`A visually appealing ${s||"image"} for ${o||"a store"}`),m([]),u("search"))},[t,s,o]),a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs(Vr,{className:"sm:max-w-2xl md:max-w-3xl lg:max-w-4xl",children:[a.jsx(Ur,{children:a.jsx(Br,{children:i})}),a.jsxs("div",{className:"py-4",children:[a.jsxs(_i,{value:c,onValueChange:u,className:"w-full",children:[a.jsxs(ni,{className:"grid w-full grid-cols-3",children:[a.jsx(Vt,{value:"search",children:"Search Pexels"}),a.jsx(Vt,{value:"ai",children:"Generate with AI"}),a.jsx(Vt,{value:"upload",children:"Upload"})]}),a.jsx(Ut,{value:"search",className:"mt-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{placeholder:"Search for images on Pexels...",value:d,onChange:A=>h(A.target.value),onKeyPress:A=>A.key==="Enter"&&_()}),a.jsxs(O,{onClick:_,disabled:g||!d.trim(),children:[g?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(Du,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Search"})]})]})}),a.jsx(Ut,{value:"ai",className:"mt-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{placeholder:"Describe the image you want AI to generate...",value:v,onChange:A=>w(A.target.value),onKeyPress:A=>A.key==="Enter"&&C()}),a.jsxs(O,{onClick:C,disabled:g||!v.trim(),children:[g?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(va,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Generate"})]})]})}),a.jsxs(Ut,{value:"upload",className:"mt-4",children:[a.jsx(je,{htmlFor:"image-upload-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Upload your own image:"}),a.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-md",children:a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsx(Lo,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsxs("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:[a.jsxs("label",{htmlFor:"image-upload-input-file",className:"relative cursor-pointer bg-white dark:bg-gray-800 rounded-md font-medium text-primary hover:text-primary-focus focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary-ring",children:[a.jsx("span",{children:"Upload a file"}),a.jsx(Je,{id:"image-upload-input-file",name:"image-upload-input-file",type:"file",className:"sr-only",accept:"image/*",onChange:T})]}),a.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF up to 10MB"})]})})]})]}),g&&f.length===0&&a.jsxs("div",{className:"text-center py-10",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin mx-auto text-primary"}),a.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Fetching images..."})]}),f.length>0&&a.jsx(ScrollArea,{className:"mt-4 max-h-[50vh]",children:a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 p-1",children:f.map(A=>a.jsxs(It.div,{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border-2 border-transparent hover:border-primary transition-all",onClick:()=>j(A.src.large||A.src.medium),whileHover:{scale:1.03},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[a.jsx("img",{src:A.src.medium,alt:A.alt||"Search result",className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(bje,{className:"h-10 w-10 text-white"})}),a.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] p-1 truncate text-center",children:A.photographer||A.alt||"Untitled"})]},A.id))})})]}),a.jsx(Ar,{children:a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",children:"Cancel"})})})]})})},bje=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),_je=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");e({base64ImageData:i,mimeType:o[1]})}catch(r){n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o=s.toDataURL("image/png"),l="image/png";(!o||o.length<100)&&(o=s.toDataURL("image/jpeg"),l="image/jpeg");const c=o.split(",");e({base64ImageData:c[1],mimeType:l})}catch(o){n(new Error("Canvas toDataURL failed: "+o.message))}},r.onerror=()=>n(new Error("Failed to load image from URL for conversion.")),r.src=t}}),Sje=({isOpen:t,onOpenChange:e,currentImageUrl:n,onImageEdited:r,imageContext:s="image",modalTitle:i="Edit Image with AI"})=>{const{toast:o}=as(),[l,c]=p.useState(""),[u,d]=p.useState(!1),[h,f]=p.useState("");p.useEffect(()=>{t&&n&&(f(n),c(""))},[t,n]);const m=async()=>{if(!l.trim()||!h){o({title:"Missing data",description:"Image or edit prompt is missing.",variant:"destructive"});return}d(!0);try{const{base64ImageData:g,mimeType:x}=await _je(h),v=await $o(g,x,l);if(v&&v.editedImageData&&v.newMimeType){const w=`data:${v.newMimeType};base64,${v.editedImageData}`;r(w),o({title:"Image Edited",description:"Image updated with AI edit."}),e(!1)}else throw new Error((v==null?void 0:v.textResponse)||"AI did not return an edited image.")}catch(g){console.error("Error editing image:",g),o({title:"Image Edit Failed",description:g.message,variant:"destructive"})}d(!1)};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs(Vr,{className:"sm:max-w-md",children:[a.jsx(Ur,{children:a.jsx(Br,{children:i})}),a.jsxs("div",{className:"space-y-4 py-4",children:[h&&a.jsxs("div",{className:"flex flex-col items-center space-y-2 mb-4",children:[a.jsx("img",{src:h,alt:`Current ${s} to edit`,className:"max-h-48 w-auto object-contain rounded border"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Editing: Current ",s]})]}),a.jsx(je,{htmlFor:"editPrompt",className:"text-left",children:"Edit Instruction:"}),a.jsx(En,{id:"editPrompt",placeholder:`e.g., 'make the background blue', 'add sparkles to the ${s}'`,value:l,onChange:g=>c(g.target.value),rows:3,className:"resize-none"})]}),a.jsxs(Ar,{children:[a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",disabled:u,children:"Cancel"})}),a.jsxs(O,{onClick:m,disabled:u||!l.trim(),children:[u?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(va,{className:"mr-2 h-4 w-4"}),"Apply Edit"]})]})]})})},Dq=({store:t,isPublishedView:e=!1})=>{var F,Z,ce,le,he,Le,Ve,Be,ue,Ce,Ie;const{updateStore:n,updateStoreTextContent:r}=$n(),[s,i]=p.useState(0),[o,l]=p.useState(null),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(!1),[g,x]=p.useState(!1),[v,w]=p.useState(null),_=p.useRef(null),C={Shield:noe,Truck:nw,CreditCard:ro,Headphones:v2,Star:RI,Zap:V3,GlobeIcon:Ru,AwardIcon:Aie,UsersIcon:M0,HeartIcon:P3,CheckCircle:ha,Sparkles:Er,ArrowRight:ju,Play:jI,Pause:Jie,Package:Li},T=Ahe(_,{once:!0,margin:"-100px"}),{scrollYProgress:j}=Ihe({target:_,offset:["start end","end start"]}),A=vS(j,[0,1],[100,-100]),E=vS(j,[0,.2,.8,1],[0,1,1,0]),I=vS(j,[0,.2,.8,1],[.9,1,1,.9]),N=((F=t==null?void 0:t.theme)==null?void 0:F.primaryColor)||"#6366F1",k=t==null?void 0:t.id,R=!e,D={title:"An Exceptional Experience",subtitle:"We're committed to providing you with the best shopping experience through our premium services and customer-first approach.",items:[{emoji:"",iconName:"Zap",title:"Smart Solutions",description:"Innovative products designed for modern living and efficiency.",color:"#007AFF",stats:"Future Ready",image:"https://images.pexels.com/photos/373543/pexels-photo-373543.jpeg?auto=compress&cs=tinysrgb&w=600&q=80",videoUrl:""},{emoji:"🚚",icon:nw,title:"Fast Delivery",description:"Free shipping worldwide with express delivery options available.",color:"#3B82F6",stats:"2-3 Days",image:"https://images.unsplash.com/photo-1566576912321-d58ddd7a6088?w=600&q=80"},{emoji:"💳",icon:ro,title:"Easy Returns",description:"30-day hassle-free returns with full refund guarantee.",color:"#8B5CF6",stats:"30 Days",image:"https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=600&q=80"},{emoji:"🎧",icon:v2,title:"24/7 Support",description:"Round-the-clock customer support via chat, email, and phone.",color:"#F59E0B",stats:"Always On",image:"https://images.unsplash.com/photo-1553484771-371a605b060b?w=600&q=80"}],secondaryItems:[{iconName:"GlobeIcon",title:"Global Reach",description:"Serving customers in 50+ countries"},{iconName:"AwardIcon",title:"Premium Quality",description:"Certified products with quality guarantee"},{iconName:"UsersIcon",title:"Community Driven",description:"Join 100K+ satisfied customers"},{iconName:"HeartIcon",title:"Eco-Conscious",description:"Sustainable packaging and practices"}],statsItems:[{iconName:"UsersIcon",number:"50K+",label:"Happy Customers"},{iconName:"ZapIcon",number:"99.9%",label:"Uptime"},{iconName:"HeadphonesIcon",number:"24/7",label:"Support"},{iconName:"StarIcon",number:"4.9★",label:"Rating"}]},M=(Z=t==null?void 0:t.content)!=null&&Z.storeFeatures?{...D,...t.content.storeFeatures,items:t.content.storeFeatures.items&&t.content.storeFeatures.items.length>0?t.content.storeFeatures.items:D.items,secondaryItems:t.content.storeFeatures.secondaryItems&&t.content.storeFeatures.secondaryItems.length>0?t.content.storeFeatures.secondaryItems:D.secondaryItems,statsItems:t.content.storeFeatures.statsItems&&t.content.storeFeatures.statsItems.length>0?t.content.storeFeatures.statsItems:D.statsItems}:D,z=M.items&&M.items.length>0?M.items:D.items;p.useEffect(()=>{const ve=async()=>{const ie=z[s];if(ie&&!ie.videoUrl){const Me=ie.title||ie.description||"modern abstract motion";try{console.log(`[Modern StoreFeatures] Fetching Pexels video for active feature "${Me}"`);const He=await Rq(Me);He&&He.video?(l(He.video.videoUrl),u(He.video.imageUrl)):(console.warn(`No Pexels video found for query: "${Me}". Clearing previous Pexels video.`),l(null),u(null))}catch(He){console.error(`Failed to fetch Pexels video for query "${Me}":`,He),l(null),u(null)}}else ie&&ie.videoUrl&&(l(null),u(null))};z&&z.length>0&&s<z.length&&ve()},[s,z]);const B=async(ve,ie)=>{!k||!R||console.log(`[ModernStoreFeatures] handleSaveText called with field: ${ve}, value: ${ie}. This might be redundant if InlineTextEdit is used.`)},G=ve=>{w(ve),m(!0)},Y=async ve=>{if(k==null||v==null||!ve)return;const ie=JSON.parse(JSON.stringify(M));if(ie.items&&ie.items[v])ie.items[v].image=ve,ie.items[v].videoUrl="";else{console.error("Cannot update feature image: active feature item not found."),m(!1);return}try{await n(k,{content:{...t.content,storeFeatures:ie}})}catch(Me){console.error("Failed to update store with new feature image URL:",Me)}m(!1),w(null)},H=()=>h(!0),K=async ve=>{if(!k||!R||s===null||!z[s])return;const ie=JSON.parse(JSON.stringify(M));if(ie.items&&ie.items[s])ie.items[s].videoUrl=ve,ie.items[s].image="",l(null),u(null);else{console.error("Cannot update video URL: active feature item not found."),h(!1);return}try{await n(k,{content:{...t.content,storeFeatures:ie}})}catch(Me){console.error("Failed to update store with new feature video URL:",Me)}h(!1)},$={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},V={hidden:{opacity:0,y:30},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.25,.46,.45,.94]}}},W={hidden:{opacity:0,x:-50},visible:{opacity:1,x:0,transition:{duration:.8,ease:[.25,.46,.45,.94]}}};return a.jsxs("section",{ref:_,className:"relative py-20 gradient-bg overflow-hidden",id:`features-${k}`,children:[a.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[a.jsx(It.div,{className:"absolute top-20 left-20 w-96 h-96 bg-primary/5 blur-3xl rounded-full",style:{backgroundColor:`${N}10`,y:A}}),a.jsx(It.div,{className:"absolute bottom-20 right-20 w-80 h-80 bg-secondary/5 blur-3xl rounded-full",style:{y:A}}),a.jsx(It.div,{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-accent/5 blur-3xl rounded-full",animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},transition:{duration:8,repeat:1/0}})]}),a.jsxs(It.div,{className:"container mx-auto px-6 relative z-10",style:{opacity:E,scale:I},children:[a.jsxs(It.div,{variants:$,initial:"hidden",animate:T?"visible":"hidden",className:"text-center mb-20",children:[a.jsxs(It.div,{variants:V,className:"inline-flex items-center gap-2 px-4 py-2 bg-white/10 dark:bg-black/10 backdrop-blur-md border border-white/20 dark:border-white/10 rounded-full text-sm font-medium mb-6",style:{color:N,borderColor:`${N}30`},children:[a.jsx(Er,{className:"w-4 h-4"}),a.jsx("span",{children:"Why Choose Us"})]}),a.jsx(It.h2,{variants:V,className:"text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 dark:text-white mb-6 tracking-tight",children:a.jsx(Gn,{initialText:M.title,onSave:ve=>B("title",ve),isAdmin:R,placeholder:"Section Title",as:"span",textClassName:"bg-gradient-to-r from-gray-900 via-primary to-gray-900 dark:from-white dark:via-primary dark:to-white bg-clip-text text-transparent",style:{backgroundImage:`linear-gradient(90deg, currentColor, ${N}, currentColor)`}})}),a.jsx(It.p,{variants:V,className:"text-xl text-muted-foreground max-w-3xl mx-auto leading-relaxed",children:a.jsx(Gn,{initialText:M.subtitle,onSave:ve=>B("subtitle",ve),isAdmin:R,placeholder:"Section Subtitle",as:"span"})})]}),a.jsxs(It.div,{variants:$,initial:"hidden",animate:T?"visible":"hidden",className:"grid lg:grid-cols-2 gap-16 mb-20",children:[a.jsx(It.div,{variants:W,className:"space-y-6",children:z.map((ve,ie)=>{const Me=ve.icon||Li,He=s===ie;return a.jsx(It.div,{className:`p-6 rounded-3xl border transition-all duration-500 cursor-pointer ${He?"bg-white/20 dark:bg-black/20 border-white/30 dark:border-white/20 shadow-float-lg":"bg-white/10 dark:bg-black/10 border-white/20 dark:border-white/10 hover:bg-white/15 dark:hover:bg-black/15"}`,onClick:()=>i(ie),whileHover:{scale:1.02,y:-5},whileTap:{scale:.98},initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{delay:ie*.1},children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center shadow-lg text-3xl",style:{backgroundColor:ve.color||N+"30"},children:ve.emoji||a.jsx(Me,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a.jsx(Gn,{initialText:ve.title,onSave:yt=>B("itemTitle",yt),isAdmin:R,placeholder:"Feature Title"})}),ve.stats&&a.jsx(fg,{variant:"secondary",className:"text-xs font-medium",style:{backgroundColor:`${ve.color||N}20`,color:ve.color||N},children:ve.stats})]}),a.jsx("p",{className:"text-muted-foreground leading-relaxed",children:a.jsx(Gn,{initialText:ve.description,onSave:yt=>B("itemDescription",yt),isAdmin:R,placeholder:"Feature Description",useTextarea:!0})}),He&&a.jsx(It.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t border-white/20 dark:border-white/10",children:a.jsxs(O,{variant:"outline",size:"sm",className:"group",style:{borderColor:ve.color||N,color:ve.color||N},children:["Learn More",a.jsx(ju,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})})]})]})},ve.title+ie)})}),z[s]&&a.jsxs(It.div,{variants:V,className:"relative aspect-square lg:aspect-[4/3] rounded-3xl overflow-hidden shadow-float-lg group",children:[!e&&z[s]&&a.jsx("div",{className:"absolute top-3 left-3 z-20 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(ce=z[s])!=null&&ce.videoUrl||o?a.jsxs(O,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:H,title:"Replace Feature Video",children:[a.jsx(b2,{className:"h-4 w-4 mr-1"})," Replace Video"]}):a.jsxs(a.Fragment,{children:[a.jsxs(O,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:()=>G(s),title:"Change Feature Image",children:[a.jsx(b2,{className:"h-4 w-4 mr-1"})," Change Image"]}),a.jsxs(O,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:()=>{w(s),x(!0)},title:"Edit Feature Image with AI",children:[a.jsx(va,{className:"h-4 w-4 mr-1"})," Edit with AI"]})]})}),(le=z[s])!=null&&le.videoUrl?a.jsx("video",{src:z[s].videoUrl,poster:z[s].image||c||"",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"},`feat-video-${s}`):o?a.jsx("video",{src:o,poster:c||((he=z[s])==null?void 0:he.image)||"",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"},`current-pexels-video-${s}`):(Le=z[s])!=null&&Le.image?a.jsx(It.img,{src:z[s].image,alt:z[s].title||"Modern feature image",className:"absolute inset-0 w-full h-full object-cover",initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},transition:{duration:.8}},`feat-img-${s}`):a.jsx(It.img,{src:"https://images.pexels.com/photos/1571460/pexels-photo-1571460.jpeg?auto=compress&cs=tinysrgb&w=600",alt:"Default modern feature background",className:"absolute inset-0 w-full h-full object-cover",initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},transition:{duration:.8}},`fallback-img-${s}`),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent"}),a.jsx(It.div,{className:"absolute bottom-6 left-6 right-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:a.jsxs("div",{className:"bg-white/10 dark:bg-black/10 backdrop-blur-md border border-white/20 dark:border-white/10 rounded-2xl p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl",style:{backgroundColor:z[s].color||N+"30"},children:z[s].emoji||ht.createElement(z[s].icon||Li,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-bold text-white",children:z[s].title}),z[s].stats&&a.jsx("p",{className:"text-sm text-gray-200",children:z[s].stats})]})]}),a.jsx("p",{className:"text-gray-200 text-sm leading-relaxed",children:z[s].description})]})},`overlay-${s}`),a.jsx(It.div,{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/20 dark:bg-black/20 backdrop-blur-md rounded-2xl flex items-center justify-center border border-white/30 dark:border-white/20 z-10",animate:{y:[-8,8,-8],rotate:[0,10,0]},transition:{duration:6,repeat:1/0},children:a.jsx(ha,{className:"w-12 h-12 text-green-400"})})]})]}),a.jsx(It.div,{variants:$,initial:"hidden",animate:T?"visible":"hidden",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16",children:(M.secondaryItems||[]).map((ve,ie)=>{const Me=C[ve.iconName]||Li;return a.jsxs(It.div,{variants:V,className:"text-center p-6 bg-white/10 dark:bg-black/10 backdrop-blur-md rounded-3xl border border-white/20 dark:border-white/10 hover:bg-white/15 dark:hover:bg-black/15 transition-all duration-300",whileHover:{scale:1.05,y:-5},children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center shadow-lg",style:{backgroundColor:N},children:a.jsx(Me,{className:"w-8 h-8 text-white"})}),a.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:a.jsx(Gn,{initialText:ve.title,onSave:He=>B(`secondaryItemTitle.${ie}`,He),isAdmin:R,placeholder:"Feature Title"})}),a.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:a.jsx(Gn,{initialText:ve.description,onSave:He=>B(`secondaryItemDescription.${ie}`,He),isAdmin:R,placeholder:"Feature Description",useTextarea:!0})})]},ve.title+ie)})}),a.jsx(It.div,{variants:$,initial:"hidden",animate:T?"visible":"hidden",className:"grid grid-cols-2 md:grid-cols-4 gap-8 p-8 bg-white/10 dark:bg-black/10 backdrop-blur-md rounded-3xl border border-white/20 dark:border-white/10",children:(M.statsItems||[]).map((ve,ie)=>{const Me=C[ve.iconName]||Li;return a.jsxs(It.div,{variants:V,className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-xl flex items-center justify-center",style:{backgroundColor:`${N}20`},children:a.jsx(Me,{className:"w-6 h-6",style:{color:N}})}),a.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-1",children:a.jsx(Gn,{initialText:ve.number,onSave:He=>B("statsItemNumber",He),isAdmin:R,placeholder:"Stat Number"})}),a.jsx("div",{className:"text-sm text-muted-foreground",children:a.jsx(Gn,{initialText:ve.label,onSave:He=>B("statsItemLabel",He),isAdmin:R,placeholder:"Stat Label"})})]},ve.label+ie)})})]}),!e&&k&&a.jsx(xje,{open:d,onOpenChange:h,storeId:k,currentVideoUrl:((Ve=z[s])==null?void 0:Ve.videoUrl)||o,onVideoReplaced:K}),!e&&k&&v!==null&&z[v]&&a.jsx(wje,{isOpen:f,onOpenChange:m,currentImageUrl:(Be=z[v])==null?void 0:Be.image,onImageSelected:ve=>Y(ve),imageSearchContext:`feature image for ${((ue=z[v])==null?void 0:ue.title)||"section"}`,modalTitle:"Change Feature Image",storeName:t.name}),!e&&k&&v!==null&&z[v]&&a.jsx(Sje,{isOpen:g,onOpenChange:x,currentImageUrl:(Ce=z[v])==null?void 0:Ce.image,onImageEdited:ve=>Y(ve),imageContext:`feature image for "${((Ie=z[v])==null?void 0:Ie.title)||"section"}"`,modalTitle:"Edit Feature Image with AI"})]})},Cje=Object.freeze(Object.defineProperty({__proto__:null,default:Dq},Symbol.toStringTag,{value:"Module"})),Eje=()=>{var We,nt;console.log("[StorePreview] Component mounted.");const{storeName:t,productHandle:e}=I0();console.log("[StorePreview] storeName from params:",t);const{getStoreByName:n,getStoreBySlug:r,getStoreById:s,currentStore:i,setCurrentStore:o,updateStore:l,viewMode:c,isLoadingStores:u,user:d}=$n(),{toast:h}=as(),[f,m]=p.useState(null),[g,x]=p.useState(!1),[v,w]=p.useState(null),[_,C]=p.useState(null),[T,j]=p.useState(null),[A,E]=p.useState(null),[I,N]=p.useState(null),[k,R]=p.useState(null),[D,M]=p.useState(null),[z,B]=p.useState(null),[G,Y]=p.useState(null),[H,K]=p.useState(null),[$,V]=p.useState(null),[W,F]=p.useState(null),[Z,ce]=p.useState(null),[le,he]=p.useState(null),[Le,Ve]=p.useState(null),[Be,ue]=p.useState(null),[Ce,Ie]=p.useState(null),[ve,ie]=p.useState(null),[Me,He]=p.useState(null),[yt,kt]=p.useState(null),[en,mn]=p.useState(null),[cn,fn]=p.useState(null),[Ue,Et]=p.useState(null),[de,De]=p.useState(null),[ee,ae]=p.useState(null),[X,Pe]=p.useState(null),[Ae,$e]=p.useState(null),[qe,oe]=p.useState(null),[_e,ze]=p.useState(null),[Te,Tt]=p.useState(null),[wt,xt]=p.useState(null),[pt,Pt]=p.useState(null),[Rn,Sn]=p.useState(null),[cr,sn]=p.useState(null),[$t,tn]=p.useState(null),[Zn,J]=p.useState(null),[re,ge]=p.useState(null),[Oe,tt]=p.useState(null),[Q,te]=p.useState(null),[me,q]=p.useState(null),[ne,be]=p.useState(null),[Ne,Ge]=p.useState(null),[Se,ot]=p.useState(null),[st,Mt]=p.useState(null),[xn,Zr]=p.useState(null),[Dn,Gr]=p.useState(null),[bs,Ci]=p.useState(null),[Vs,Us]=p.useState(null),[es,nn]=p.useState(null),[Cn,si]=p.useState(null),[ii,Mn]=p.useState(null),[Bs,vo]=p.useState(!1),[Wo,Qc]=p.useState(""),[dy,Pa]=p.useState(!1),[xe,pe]=p.useState(!1);p.useEffect(()=>{(async()=>{if(!t||g)return;x(!0);let Re=null;i&&i.urlSlug===t?Re=i:(Re=n(t),Re||(Re=await r(t))),Re?(m(Re),(!i||i.id!==Re.id)&&o(Re)):u||(h({title:"Store Not Found",description:`Could not find store with slug: ${t}`,variant:"destructive"}),m(null)),x(!1)})()},[t,u,g,i,n,r,o,h]),p.useEffect(()=>{const Ye=v||(f==null?void 0:f.template_version),Re=document.documentElement;f&&f.theme?(f.theme.primaryColor?Re.style.setProperty("--theme-primary-color",f.theme.primaryColor):Re.style.removeProperty("--theme-primary-color"),f.theme.secondaryColor?Re.style.setProperty("--theme-secondary-color",f.theme.secondaryColor):Re.style.removeProperty("--theme-secondary-color"),Ye==="premium"?(Re.style.setProperty("--premium-gradient-start-color",f.theme.primaryColor||"#667eea"),Re.style.setProperty("--premium-gradient-end-color",f.theme.secondaryColor||"#764ba2")):(Re.style.removeProperty("--premium-gradient-start-color"),Re.style.removeProperty("--premium-gradient-end-color"))):(Re.style.removeProperty("--theme-primary-color"),Re.style.removeProperty("--theme-secondary-color"),Re.style.removeProperty("--premium-gradient-start-color"),Re.style.removeProperty("--premium-gradient-end-color"));let mt=!1;return Ye==="sharp"&&(Re.classList.contains("dark")||(Re.classList.add("dark"),mt=!0)),()=>{mt&&Ye!=="sharp"&&Re.classList.contains("dark")}},[f==null?void 0:f.theme,f==null?void 0:f.template_version,v]),p.useEffect(()=>{if(f){const Ye=v||f.template_version||"classic";console.log(`[StorePreview] Loading components for template: ${Ye}`),Mt(null),Zr(null),Gr(null),Ci(null),Us(null),nn(null),si(null),Mn(null),C(null),j(null),E(null),N(null),R(null),M(null),B(null),Y(null),K(null),V(null),F(null),ce(null),he(null),Ve(null),ue(null),Ie(null),ie(null),He(null),kt(null),mn(null),fn(null),Et(null),De(null),ae(null),Pe(null),$e(null),oe(null),ze(null),Tt(null),xt(null),Pt(null),Sn(null),sn(null),tn(null),J(null),ge(null),tt(null),te(null),q(null),be(null),Ge(null),ot(null),Ge(()=>mje),ot(()=>Dq),Ye==="classic"?(Mt(()=>p.lazy(()=>Ot(()=>Promise.resolve().then(()=>Ije),void 0))),Zr(()=>p.lazy(()=>Ot(()=>import("./StoreHero-61057b6d.js"),[]))),Gr(()=>p.lazy(()=>Ot(()=>import("./StoreCollections-06327e48.js"),["assets/StoreCollections-06327e48.js","assets/CollectionProductsDialog-601dfd33.js"]))),Ci(()=>p.lazy(()=>Ot(()=>import("./ProductGrid-f1563892.js"),["assets/ProductGrid-f1563892.js","assets/list-5010198e.js","assets/filter-0f312d72.js"]))),Us(()=>p.lazy(()=>Ot(()=>import("./StoreFeatures-27395548.js"),["assets/StoreFeatures-27395548.js","assets/shield-check-a3e982ed.js","assets/message-square-422fc660.js"]))),nn(()=>p.lazy(()=>Ot(()=>import("./StoreTestimonials-30717c77.js"),["assets/StoreTestimonials-30717c77.js","assets/user-circle-fa5fb87e.js"]))),si(()=>p.lazy(()=>Ot(()=>import("./StoreNewsletter-b21e9c45.js"),[]))),Mn(()=>p.lazy(()=>Ot(()=>Promise.resolve().then(()=>Nje),void 0)))):Ye==="modern"?(C(()=>p.lazy(()=>Ot(()=>import("./StoreHeader-c51f1dc8.js"),["assets/StoreHeader-c51f1dc8.js","assets/minus-acdf1b07.js"]))),j(()=>p.lazy(()=>Ot(()=>import("./StoreHero-8c8a1dac.js"),[]))),E(()=>p.lazy(()=>Ot(()=>Promise.resolve().then(()=>Cje),void 0))),N(()=>p.lazy(()=>Ot(()=>import("./StoreCollections-648c90ac.js"),[]))),R(()=>p.lazy(()=>Ot(()=>import("./ProductGrid-655cf3c1.js"),["assets/ProductGrid-655cf3c1.js","assets/minus-acdf1b07.js","assets/crown-f74bc2de.js","assets/list-5010198e.js"]))),M(()=>p.lazy(()=>Ot(()=>import("./Footer-d9ca2d0b.js"),[])))):Ye==="premium"?(B(()=>p.lazy(()=>Ot(()=>import("./Header-5503b3bc.js"),[]))),Y(()=>p.lazy(()=>Ot(()=>import("./Hero-c4941fb1.js"),[]))),K(()=>p.lazy(()=>Ot(()=>import("./FeaturedProducts-3f634804.js"),["assets/FeaturedProducts-3f634804.js","assets/minus-acdf1b07.js","assets/crown-f74bc2de.js","assets/list-5010198e.js","assets/filter-0f312d72.js"]))),V(()=>p.lazy(()=>Ot(()=>import("./CategoryShowcase-af4ae90e.js"),["assets/CategoryShowcase-af4ae90e.js","assets/CollectionProductsDialog-601dfd33.js"]))),F(()=>p.lazy(()=>Ot(()=>import("./SocialProof-1d8cb6a5.js"),[]))),ce(()=>p.lazy(()=>Ot(()=>import("./Newsletter-969c0a8f.js"),[]))),he(()=>p.lazy(()=>Ot(()=>import("./Footer-139a25e6.js"),[])))):Ye==="sharp"?(Ve(()=>p.lazy(()=>Ot(()=>import("./StoreHeader-0691a700.js"),[]))),ue(()=>p.lazy(()=>Ot(()=>import("./StoreHero-e95341aa.js"),["assets/StoreHero-e95341aa.js","assets/ReplaceVideoModal-bf488c7c.js"]))),Ie(()=>p.lazy(()=>Ot(()=>import("./StoreFeatures-839e97e9.js"),[]))),ie(()=>p.lazy(()=>Ot(()=>import("./ProductGrid-0b9cc267.js"),["assets/ProductGrid-0b9cc267.js","assets/list-5010198e.js"]))),He(()=>p.lazy(()=>Ot(()=>import("./Testimonials-64994fdc.js"),["assets/Testimonials-64994fdc.js","assets/message-square-422fc660.js","assets/user-circle-fa5fb87e.js"]))),kt(()=>p.lazy(()=>Ot(()=>import("./ImageRightSection-0b6aa501.js"),[]))),mn(()=>p.lazy(()=>Ot(()=>import("./VideoLeftSection-f2d9cede.js"),["assets/VideoLeftSection-f2d9cede.js","assets/ReplaceVideoModal-bf488c7c.js"]))),fn(()=>p.lazy(()=>Ot(()=>import("./HeroFollowUpVideo-f0490d05.js"),["assets/HeroFollowUpVideo-f0490d05.js","assets/ReplaceVideoModal-bf488c7c.js"]))),Et(()=>p.lazy(()=>Ot(()=>import("./Newsletter-d421047e.js"),[]))),De(()=>p.lazy(()=>Ot(()=>import("./Footer-61541e1b.js"),[])))):Ye==="fresh"?(ae(()=>p.lazy(()=>Ot(()=>import("./StoreHeader-bc58f10a.js"),[]))),Pe(()=>p.lazy(()=>Ot(()=>import("./StoreHero-3e5e34cb.js"),[]))),$e(()=>p.lazy(()=>Ot(()=>import("./StoreFeatures-52ccb35d.js"),[]))),oe(()=>p.lazy(()=>Ot(()=>import("./ProductGrid-b132c67d.js"),["assets/ProductGrid-b132c67d.js","assets/list-5010198e.js"]))),ze(()=>p.lazy(()=>Ot(()=>import("./StoreCollections-9d3fc309.js"),["assets/StoreCollections-9d3fc309.js","assets/CollectionProductsDialog-601dfd33.js"]))),Tt(()=>p.lazy(()=>Ot(()=>import("./Testimonials-75454dfe.js"),["assets/Testimonials-75454dfe.js","assets/user-circle-fa5fb87e.js"]))),xt(()=>p.lazy(()=>Ot(()=>import("./Newsletter-c3af8cd4.js"),[]))),Pt(()=>p.lazy(()=>Ot(()=>import("./Footer-8f81bc90.js"),["assets/Footer-8f81bc90.js","assets/shield-check-a3e982ed.js"])))):Ye==="sleek"&&(Sn(()=>p.lazy(()=>Ot(()=>import("./StoreHeader-d530f822.js"),[]))),sn(()=>p.lazy(()=>Ot(()=>import("./StoreHero-08a39bec.js"),[]))),tn(()=>p.lazy(()=>Ot(()=>import("./ProductGrid-52707ddf.js"),["assets/ProductGrid-52707ddf.js","assets/list-5010198e.js","assets/filter-0f312d72.js"]))),J(()=>p.lazy(()=>Ot(()=>import("./StoreFeatures-e5f79d7d.js"),[]))),ge(()=>p.lazy(()=>Ot(()=>import("./Testimonials-953c1d79.js"),["assets/Testimonials-953c1d79.js","assets/user-circle-fa5fb87e.js"]))),tt(()=>p.lazy(()=>Ot(()=>import("./Newsletter-01ce7535.js"),[]))),te(()=>p.lazy(()=>Ot(()=>import("./Footer-fe17fbc1.js"),[]))),q(()=>p.lazy(()=>Ot(()=>import("./StoreCollections-f684e2e4.js"),[]))),be(()=>p.lazy(()=>Ot(()=>import("./StoreWaySection-c95b9dd5.js"),[]))))}},[f==null?void 0:f.id,v]);const we=()=>{if(!f||!f.pass_key){Pa(!0);return}pe(!0),setTimeout(()=>{Wo===f.pass_key?(Pa(!0),h({title:"Access Granted",description:"Welcome to the store!"})):(h({title:"Access Denied",description:"Incorrect pass key.",variant:"destructive"}),Qc("")),pe(!1)},500)};if(u)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading store..."})]})});if(!f)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("p",{className:"text-xl text-destructive",children:"Store not found."})});if(!dy&&f.pass_key)return a.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 p-4",children:a.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-2xl w-full max-w-md text-center",children:[a.jsx(k3,{className:"h-16 w-16 text-primary mx-auto mb-6"}),a.jsx("h2",{className:"text-3xl font-bold text-card-foreground mb-3",children:"Protected Store"}),a.jsx("p",{className:"text-muted-foreground mb-8",children:"This store requires a pass key to view its content."}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx(Je,{type:"password",placeholder:"Enter Pass Key",value:Wo,onChange:Ye=>Qc(Ye.target.value),className:"h-12 text-lg text-center bg-input border-border focus:ring-primary focus:border-primary",onKeyPress:Ye=>Ye.key==="Enter"&&we()}),a.jsx(O,{onClick:we,disabled:xe||!Wo.trim(),className:"h-12 text-lg w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:xe?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-current"}):a.jsxs(a.Fragment,{children:[a.jsx(ioe,{className:"mr-2 h-5 w-5"})," Access Store"]})})]})]})});const se=c==="published";let Ee=v;if(Ee||(Ee=(f==null?void 0:f.template_version)==="v1"||!(f!=null&&f.template_version)?"classic":f.template_version),console.log(`[StorePreview] Determined templateVersionToRender: ${Ee}. (previewTemplateVersion: ${v}, store.template_version: ${f==null?void 0:f.template_version})`),console.log(`[StorePreview] Rendering template: ${Ee}. Store products: ${((We=f==null?void 0:f.products)==null?void 0:We.length)||0}, collections: ${((nt=f==null?void 0:f.collections)==null?void 0:nt.length)||0}`),Ee==="classic"){if(!st||!xn||!Dn||!bs||!Vs||!es||!Cn||!ii)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Classic Template Components..."})]})})}else if(Ee==="modern"){if(!_||!T||!A||!I||!k||!D)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Modern Template Components..."})]})})}else if(Ee==="premium"){if(!z||!G||!H||!$||!W||!Z||!le)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Premium Template Components..."})]})})}else if(Ee==="sharp"){if(!Le||!Be||!cn||!Ce||!ve||!Me||!yt||!en||!Ue||!de)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Sharp Template Components..."})]})})}else if(Ee==="sleek"){if(!Rn||!cr||!$t||!me||!Zn||!re||!Oe||!Q)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Sleek Template Components..."})]})})}else if(Ee==="fresh"&&(!ee||!X||!Ae||!qe||!_e||!wt||!pt))return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Fresh Template Components..."})]})});return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx(p.Suspense,{fallback:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading Store Content..."}),children:Ee==="classic"?a.jsxs(ht.Fragment,{children:[st&&a.jsx(st,{store:f,isPublishedView:se}),xn&&a.jsx(xn,{store:f,isPublishedView:se}),bs&&a.jsx(bs,{store:f,isPublishedView:se}),Dn&&a.jsx(Dn,{store:f,isPublishedView:se}),Se&&a.jsx(Se,{store:f,isPublishedView:se}),Ne&&a.jsx(Ne,{store:f,isPublishedView:se}),es&&a.jsx(es,{store:f,isPublishedView:se}),Cn&&a.jsx(Cn,{store:f,isPublishedView:se}),ii&&a.jsx(ii,{store:f,isPublishedView:se})]},"classic"):Ee==="modern"?a.jsx(ht.Fragment,{children:a.jsxs("div",{className:"min-h-screen flex flex-col",children:[a.jsxs("main",{className:"flex-1",children:[_&&a.jsx(_,{store:f,isPublishedView:se}),T&&a.jsx(T,{store:f,isPublishedView:se}),A?a.jsx(A,{store:f,isPublishedView:se}):Se&&a.jsx(Se,{store:f,isPublishedView:se}),k&&a.jsx(k,{store:f,products:(f==null?void 0:f.products)||[],isPublishedView:se}),I&&a.jsx(I,{store:f,isPublishedView:se}),Ne&&a.jsx(Ne,{store:f,isPublishedView:se})]}),a.jsx("footer",{className:"mt-auto",children:D&&a.jsx(D,{store:f,isPublishedView:se})})]})},"modern"):Ee==="premium"?a.jsxs(ht.Fragment,{children:[z&&a.jsx(z,{store:f,isPublishedView:se}),G&&a.jsx(G,{store:f,isPublishedView:se}),H&&a.jsx(H,{store:f,isPublishedView:se}),$&&a.jsx($,{store:f,isPublishedView:se}),Se&&a.jsx(Se,{store:f,isPublishedView:se}),Ne&&a.jsx(Ne,{store:f,isPublishedView:se}),W&&a.jsx(W,{store:f,isPublishedView:se}),Z&&a.jsx(Z,{store:f,isPublishedView:se}),le&&a.jsx(le,{store:f,isPublishedView:se})]},"premium"):Ee==="sharp"?a.jsxs(ht.Fragment,{children:[Le&&a.jsx(Le,{store:f,isPublishedView:se}),Be&&a.jsx(Be,{store:f,isPublishedView:se}),cn&&a.jsx(cn,{store:f}),ve&&a.jsx(ve,{store:f,isPublishedView:se}),Ce?a.jsx(Ce,{store:f,isPublishedView:se}):Se&&a.jsx(Se,{store:f,isPublishedView:se}),Ne&&a.jsx(Ne,{store:f,isPublishedView:se}),yt&&a.jsx(yt,{store:f,isPublishedView:se}),en&&a.jsx(en,{store:f,isPublishedView:se}),Me&&a.jsx(Me,{store:f,isPublishedView:se}),Ue&&a.jsx(Ue,{store:f}),de&&a.jsx(de,{store:f})]},"sharp"):Ee==="fresh"?a.jsxs(ht.Fragment,{children:[ee&&a.jsx(ee,{store:f,isPublishedView:se}),X&&a.jsx(X,{store:f,isPublishedView:se}),qe&&a.jsx(qe,{store:f,isPublishedView:se})," ",_e&&a.jsx(_e,{store:f,isPublishedView:se})," ",Ae?a.jsx(Ae,{store:f,isPublishedView:se}):Se&&a.jsx(Se,{store:f,isPublishedView:se}),Te&&a.jsx(Te,{store:f,isPublishedView:se}),Ne&&a.jsx(Ne,{store:f,isPublishedView:se}),wt&&a.jsx(wt,{store:f}),pt&&a.jsx(pt,{store:f})]},"fresh"):Ee==="sleek"?a.jsxs(ht.Fragment,{children:[Rn&&a.jsx(Rn,{store:f,isPublishedView:se}),cr&&a.jsx(cr,{store:f,isPublishedView:se}),$t&&a.jsx($t,{store:f,isPublishedView:se}),me&&a.jsx(me,{store:f,isPublishedView:se}),Zn?a.jsx(Zn,{store:f,isPublishedView:se}):Se&&a.jsx(Se,{store:f,isPublishedView:se}),ne?a.jsx(ne,{store:f,isPublishedView:se}):Ne&&a.jsx(Ne,{store:f,isPublishedView:se}),re&&a.jsx(re,{store:f,isPublishedView:se}),Oe&&a.jsx(Oe,{store:f,isPublishedView:se}),Q&&a.jsx(Q,{store:f,isPublishedView:se})]},"sleek"):null}),d&&f&&d.uid===f.merchant_id&&a.jsx(gIe,{store:f,onEdit:()=>vo(!0),currentTemplate:v,onTemplateChange:w,availableTemplates:["classic","modern","premium","sharp","fresh","sleek"]}),!se&&f&&a.jsx(yIe,{store:f,open:Bs,onOpenChange:vo,onStoreUpdate:Ye=>{m(Re=>({...Re,...Ye})),Ye.template_version&&Ye.template_version!==v&&w(Ye.template_version),(f&&f.id===Ye.id||i&&i.id===Ye.id)&&l(Ye.id,Ye)}}),a.jsx(kq,{storeId:f==null?void 0:f.id})," "]})},Tje=({open:t,onOpenChange:e,storeId:n,storeName:r,currentLogoUrlLight:s,currentLogoUrlDark:i,onLogoReplaced:o})=>{const[l,c]=p.useState("ai"),[u,d]=p.useState(r||""),[h,f]=p.useState(!1),[m,g]=p.useState(null),[x,v]=p.useState({light:null,dark:null}),[w,_]=p.useState(""),[C,T]=p.useState([]),[j,A]=p.useState(!1),[E,I]=p.useState(null),[N,k]=p.useState(null),[R,D]=p.useState(null),[M,z]=p.useState(!1),[B,G]=p.useState(null);p.useEffect(()=>{t&&(d(r||""),f(!1),g(null),v({light:null,dark:null}),_(""),T([]),A(!1),I(null),k(null),D(null),z(!1),G(null))},[t,r]);const Y=async()=>{if(!r){g("Store name is required to generate a logo with AI.");return}f(!0),g(null),v({light:null,dark:null});try{console.log(`Generating light/dark logos for store ${r}`);const F=await Ig(r);F&&(F.logoUrlLight||F.logoUrlDark)?v({light:F.logoUrlLight,dark:F.logoUrlDark}):g(F.textResponse||"AI did not return sufficient image data for logos.")}catch(F){console.error("Error generating logos with AI:",F),g(F.message||"Failed to generate logos. Please try again.")}finally{f(!1)}},H=async()=>{if(!w.trim()){I("Please enter a search query for Pexels.");return}A(!0),I(null),T([]);try{const F=await yje(w);F.error?(I(F.error),T([])):(T(F.photos||[]),(F.photos||[]).length===0&&I("No images found for your query."))}catch(F){console.error("Error searching Pexels images:",F),I(F.message||"Failed to search Pexels. Please try again.")}finally{A(!1)}},K=F=>{o&&F?(o({logoUrlLight:F,logoUrlDark:F}),e(!1)):I("Invalid image URL selected or replacement handler missing.")},$=F=>{const Z=F.target.files[0];if(Z){if(Z.size>10*1024*1024){D("File is too large. Please select an image under 10MB."),k(null),G(null);return}if(!Z.type.startsWith("image/")){D("Invalid file type. Please select an image file (e.g., PNG, JPG, GIF)."),k(null),G(null);return}k(Z),D(null);const ce=new FileReader;ce.onloadend=()=>{G(ce.result)},ce.readAsDataURL(Z)}},V=()=>{if(N&&o){z(!0),D(null);const F=new FileReader;F.onloadend=()=>{const Z=F.result;o({logoUrlLight:Z,logoUrlDark:Z}),e(!1),k(null),G(null),z(!1)},F.onerror=()=>{D("Failed to read image file for upload."),z(!1)},F.readAsDataURL(N)}else D("No image file selected or replacement handler missing.")},W=()=>{x.light||x.dark?(o({logoUrlLight:x.light,logoUrlDark:x.dark}),e(!1)):g("No AI generated logos available to confirm.")};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs(Vr,{className:"sm:max-w-[728px]",children:[" ",a.jsxs(Ur,{className:"text-left",children:[a.jsx(Br,{children:"Change Store Logo"}),a.jsxs(Qi,{className:"text-left space-y-2",children:[a.jsx("p",{children:"Current Logos:"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx(je,{className:"text-xs text-muted-foreground",children:"For Dark Backgrounds (Light Logo)"}),s?a.jsx("img",{src:s,alt:"Current light logo",className:"h-20 w-auto mx-auto max-w-full object-contain my-1 border rounded bg-gray-700 p-1"}):a.jsx("div",{className:"h-20 flex items-center justify-center text-xs text-muted-foreground bg-gray-200 dark:bg-gray-700 rounded my-1",children:"Not set"})]}),a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx(je,{className:"text-xs text-muted-foreground",children:"For Light Backgrounds (Dark Logo)"}),i?a.jsx("img",{src:i,alt:"Current dark logo",className:"h-20 w-auto mx-auto max-w-full object-contain my-1 border rounded bg-white p-1"}):a.jsx("div",{className:"h-20 flex items-center justify-center text-xs text-muted-foreground bg-gray-200 dark:bg-gray-700 rounded my-1",children:"Not set"})]})]})]})]}),a.jsxs(_i,{value:l,onValueChange:c,className:"w-full",children:[a.jsxs(ni,{className:"grid w-full grid-cols-3",children:[a.jsx(Vt,{value:"ai",children:"Generate with AI"}),a.jsx(Vt,{value:"pexels",children:"Search Pexels"}),a.jsx(Vt,{value:"upload",children:"Upload Image"})]}),a.jsxs(Ut,{value:"ai",className:"space-y-4 py-4",children:[a.jsxs("p",{className:"text-sm text-muted-foreground",children:["AI will generate a logo based on your store name: ",a.jsx("strong",{children:r}),"."]}),m&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:m}),h&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Generating logos..."}),(x.light||x.dark)&&!h&&a.jsxs("div",{className:"flex flex-col items-center gap-4 mt-3",children:[a.jsx("p",{className:"text-sm font-medium",children:"Generated Previews:"}),a.jsxs("div",{className:"flex gap-4",children:[x.dark&&a.jsxs("div",{className:"text-center",children:[a.jsx(je,{className:"text-xs text-muted-foreground",children:"For Light BG"}),a.jsx("img",{src:x.dark,alt:"AI Generated Dark Logo",className:"h-24 w-24 object-contain border rounded-md bg-white p-1"})]}),x.light&&a.jsxs("div",{className:"text-center",children:[a.jsx(je,{className:"text-xs text-muted-foreground",children:"For Dark BG"}),a.jsx("img",{src:x.light,alt:"AI Generated Light Logo",className:"h-24 w-24 object-contain border rounded-md bg-gray-700 p-1"})]})]})]}),a.jsxs(Ar,{className:"justify-start pt-4",children:[a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:h,children:"Cancel"}),a.jsxs(O,{onClick:Y,disabled:h||!r,children:[a.jsx(Zv,{className:"mr-2 h-4 w-4"}),h?"Generating...":x.light||x.dark?"Regenerate Logos":"Generate Logos"]}),(x.light||x.dark)&&a.jsx(O,{onClick:W,disabled:h,children:"Use These Logos"})]})]}),a.jsxs(Ut,{value:"pexels",className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{id:"pexelsQuery",value:w,onChange:F=>_(F.target.value),placeholder:"e.g., Abstract, Minimal, Tech",disabled:j,className:"flex-grow"}),a.jsx(O,{onClick:H,disabled:j||!w.trim(),children:j?"Searching...":"Search Images"})]}),E&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:E}),j&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Loading Pexels images..."}),!j&&C.length>0&&a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-3 max-h-[300px] overflow-y-auto pr-2",children:C.map(F=>a.jsxs("div",{className:"relative aspect-square rounded-md overflow-hidden cursor-pointer group border hover:border-primary",onClick:()=>K(F.src.large2x||F.src.large||F.src.original),children:[a.jsx("img",{src:F.src.medium,alt:F.alt||`Pexels image by ${F.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),a.jsx("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:a.jsx("p",{className:"text-white text-xs text-center p-1 bg-black/50 rounded",children:"Use Image"})})]},F.id))}),a.jsx(Ar,{className:"justify-start pt-4",children:a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:j,children:"Cancel"})})]}),a.jsxs(Ut,{value:"upload",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"image-upload-input",className:"text-left block mb-1",children:"Select Image File"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(Je,{id:"image-upload-input",type:"file",accept:"image/*",onChange:$,className:"flex-grow",disabled:M})}),B&&a.jsxs("div",{className:"mt-3 flex flex-col items-center",children:[a.jsx("p",{className:"text-sm font-medium mb-1",children:"Preview:"}),a.jsx("img",{src:B,alt:"Upload preview",className:"h-32 w-32 object-contain border rounded-md"})]}),N&&!B&&a.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected: ",N.name," (",(N.size/1024/1024).toFixed(2)," MB)"]}),R&&a.jsx("p",{className:"text-sm text-red-500 text-center mt-2",children:R})]}),a.jsxs(Ar,{className:"justify-start pt-4",children:[a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:M,children:"Cancel"}),a.jsx(O,{onClick:V,disabled:M||!N,children:M?"Uploading...":"Confirm Upload"})]})]})]})]})})},Mq=({store:t,isPublishedView:e=!1,productName:n})=>{const{name:r,theme:s,logo_url_light:i,logo_url_dark:o,id:l,settings:c,content:u,template_version:d}=t,{cart:h,removeFromCart:f,updateQuantity:m,updateStore:g,updateStoreTemplateVersion:x}=$n(),[v,w]=p.useState(!1),[_,C]=p.useState(!1),[T,j]=p.useState(!1),A=!e,[E,I]=p.useState(!1),N=ti(),k=h.filter(F=>F.storeId===l),R=k.reduce((F,Z)=>F+Z.quantity,0),D=k.reduce((F,Z)=>F+Z.price*Z.quantity,0);p.useEffect(()=>{const F=localStorage.getItem("theme"),Z=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;I(!!(F==="dark"||!F&&Z))},[]);const M=async(F,Z,ce=null)=>{if(l)try{if(F==="storeName")await g(l,{name:Z});else if(F==="navLink"&&ce!==null){const he=((u==null?void 0:u.navLinks)||$.map(Le=>({label:Le.label,href:Le.href}))).map((Le,Ve)=>Ve===ce?{...Le,label:Z}:Le);await g(l,{content:{...u,navLinks:he}})}await z()}catch(le){console.error(`Failed to update store ${F} or refresh template:`,le)}},z=async()=>{const F=d||"v1";console.log(`Performing template refresh. Current version: ${F}`),F==="v1"?(await x(l,"v2"),await x(l,"v1"),console.log("Template refreshed: v1 -> v2 -> v1")):F==="v2"&&(await x(l,"v1"),await x(l,"v2"),console.log("Template refreshed: v2 -> v1 -> v2"))},B=()=>{j(!0),console.log("Open change image dialog (placeholder)")},G=async F=>{if(l&&F)try{await g(l,{logo_url_light:F.logoUrlLight||t.logo_url_light,logo_url_dark:F.logoUrlDark||t.logo_url_dark}),console.log("Store logos updated successfully.")}catch(Z){console.error("Failed to update store logos:",Z)}},Y=()=>{const F=!E;I(F),F?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},H=`/store/${l}`,K=[{href:H,label:"Home"},{href:`#products-${l}`,label:"Products"},{href:`#features-${l}`,label:"Features"},{href:`#contact-${l}`,label:"Contact"}],$=u!=null&&u.navLinks&&u.navLinks.length===K.length?u.navLinks.map((F,Z)=>({...K[Z],label:F.label||K[Z].label})):K,V=(F,Z)=>{if(F.preventDefault(),w(!1),Z.startsWith("/store/"))N(Z);else{const ce=Z.substring(1),le=document.getElementById(ce);le?le.scrollIntoView({behavior:"smooth"}):N(H)}},W=()=>{C(!1),N("/checkout",{state:{cart:k,storeName:r,storeId:l}})};return a.jsxs(a.Fragment,{children:[a.jsx(It.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"sticky top-0 z-40 w-full bg-background/90 backdrop-blur-md border-b",style:{borderColor:`${s.primaryColor}30`},children:a.jsxs("div",{className:"container mx-auto px-4 py-3 flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center gap-2",children:n?a.jsx("h1",{className:"font-bold text-xl tracking-tight",style:{color:s.primaryColor},children:n}):a.jsxs(a.Fragment,{children:[a.jsx(zn,{to:H,className:"group",children:(E?i:o)?a.jsx("img",{src:E?i:o,alt:`${r} logo`,className:"h-16 w-16 object-contain group-hover:scale-105 transition-transform duration-200"}):i||o?a.jsx("img",{src:i||o,alt:`${r} logo (fallback)`,className:"h-16 w-16 object-contain group-hover:scale-105 transition-transform duration-200"}):null}),A&&(i||o)&&a.jsx(O,{variant:"outline",size:"icon",onClick:B,className:"h-8 w-8 p-0 -ml-2 relative z-10 bg-background hover:bg-muted",children:a.jsx(Op,{className:"h-4 w-4"})}),a.jsx(zn,{to:H,className:"group ml-2",children:a.jsx("span",{className:"font-bold text-xl tracking-tight group-hover:text-primary transition-colors",style:{color:s.primaryColor},children:a.jsx(Gn,{initialText:r,onSave:F=>M("storeName",F),isAdmin:A,placeholder:"Store Name"})})})]})}),!n&&a.jsx("nav",{className:"hidden md:flex items-center gap-x-6",children:$.map((F,Z)=>a.jsx("a",{href:F.href,onClick:ce=>V(ce,F.href),className:"text-sm font-medium text-muted-foreground hover:text-primary transition-colors",style:{"--hover-color":s.primaryColor},children:a.jsx(Gn,{initialText:F.label,onSave:ce=>M("navLink",ce,Z),isAdmin:A,placeholder:`Link ${Z+1}`})},F.label+Z))}),a.jsxs("div",{className:"flex items-center gap-2",children:[((c==null?void 0:c.showThemeToggle)??!0)&&a.jsxs("div",{className:"hidden md:flex items-center gap-2 mr-2",children:[a.jsx(Ro,{id:`store-theme-switcher-${l}`,checked:E,onCheckedChange:Y,"aria-label":"Toggle dark mode"}),E?a.jsx(PE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(kE,{className:"h-5 w-5 text-muted-foreground"})]}),a.jsx(O,{variant:"ghost",size:"icon",className:"hidden md:flex text-muted-foreground hover:text-primary",style:{"--hover-color":s.primaryColor},children:a.jsx(Du,{className:"h-5 w-5"})}),a.jsxs(O,{variant:"outline",className:"relative",onClick:()=>C(!0),style:{borderColor:s.primaryColor,color:s.primaryColor},children:[a.jsx($p,{className:"h-5 w-5"}),R>0&&a.jsx(fg,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center text-xs",style:{backgroundColor:s.secondaryColor||"red"},children:R}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Cart"})]}),!n&&a.jsx(O,{variant:"ghost",size:"icon",className:"md:hidden text-muted-foreground hover:text-primary",onClick:()=>w(!0),style:{"--hover-color":s.primaryColor},children:a.jsx(j3,{className:"h-6 w-6"})})]})]})}),a.jsx(Sc,{children:v&&a.jsxs(It.div,{initial:{opacity:0,x:"100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"100%"},transition:{type:"spring",stiffness:300,damping:30},className:"fixed inset-0 z-50 bg-background p-6 md:hidden",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(zn,{to:H,className:"group",onClick:()=>w(!1),children:(E?i:o)?a.jsx("img",{src:E?i:o,alt:`${r} logo`,className:"h-16 w-16 object-contain"}):i||o?a.jsx("img",{src:i||o,alt:`${r} logo (fallback)`,className:"h-16 w-16 object-contain"}):null}),A&&(i||o)&&a.jsx(O,{variant:"outline",size:"icon",onClick:()=>{B(),w(!1)},className:"h-8 w-8 p-0 -ml-2 relative z-10 bg-background hover:bg-muted",children:a.jsx(Op,{className:"h-4 w-4"})}),a.jsx(zn,{to:H,className:"group ml-2",onClick:()=>w(!1),children:a.jsx("span",{className:"font-bold text-xl",style:{color:s.primaryColor},children:a.jsx(Gn,{initialText:r,onSave:F=>M("storeName",F),isAdmin:A,placeholder:"Store Name"})})})]})," ",a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>w(!1),children:a.jsx(Hi,{className:"h-6 w-6"})})]}),a.jsxs("nav",{className:"flex flex-col gap-y-4",children:[$.map((F,Z)=>a.jsx("a",{href:F.href,onClick:ce=>V(ce,F.href),className:"text-lg font-medium text-foreground hover:text-primary transition-colors",style:{"--hover-color":s.primaryColor},children:a.jsx(Gn,{initialText:F.label,onSave:ce=>M("navLink",ce,Z),isAdmin:A,placeholder:`Link ${Z+1}`})},F.label+Z)),((c==null?void 0:c.showThemeToggle)??!0)&&a.jsxs("div",{className:"flex items-center gap-2 mt-4 pt-4 border-t border-border",children:[a.jsx(Ro,{id:`mobile-store-theme-switcher-${l}`,checked:E,onCheckedChange:Y,"aria-label":"Toggle dark mode"}),E?a.jsx(PE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(kE,{className:"h-5 w-5 text-muted-foreground"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:E?"Dark Mode":"Light Mode"})]})]})]})}),a.jsx(Sc,{children:_&&a.jsx(yh.Root,{open:_,onOpenChange:C,children:a.jsxs(yh.Portal,{children:[a.jsx(yh.Overlay,{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm"}),a.jsxs(yh.Content,{className:"fixed z-50 inset-y-0 right-0 h-full w-full max-w-md bg-background border-l shadow-xl flex flex-col",as:It.div,initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30},children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Your Cart"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>C(!1),children:a.jsx(Hi,{className:"h-5 w-5"})})]}),k.length===0?a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 text-center",children:[a.jsx($p,{className:"h-16 w-16 text-muted-foreground mb-4"}),a.jsx("p",{className:"text-lg font-medium",children:"Your cart is empty"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Looks like you haven't added anything yet."}),a.jsx(O,{onClick:()=>C(!1),className:"mt-6",style:{backgroundColor:s.primaryColor},children:"Continue Shopping"})]}):a.jsxs(a.Fragment,{children:[a.jsx(Fs,{className:"flex-1 p-6",children:a.jsx("div",{className:"space-y-4",children:k.map(F=>{var Z,ce,le,he;return a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("img",{src:((ce=(Z=F.image)==null?void 0:Z.src)==null?void 0:ce.tiny)||((he=(le=F.image)==null?void 0:le.src)==null?void 0:he.medium)||`https://via.placeholder.com/80x80.png?text=${F.name.substring(0,1)}`,alt:F.name,className:"w-20 h-20 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-medium text-sm line-clamp-1",children:F.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Price: $",F.price.toFixed(2)]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(O,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>m(F.id,l,F.quantity-1),children:a.jsx("span",{className:"text-lg leading-none",children:"-"})}),a.jsx("span",{className:"text-sm w-4 text-center",children:F.quantity}),a.jsx(O,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>m(F.id,l,F.quantity+1),children:a.jsx("span",{className:"text-lg leading-none",children:"+"})})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-semibold text-sm",children:["$",(F.price*F.quantity).toFixed(2)]}),a.jsx(O,{variant:"ghost",size:"icon",className:"h-7 w-7 mt-1 text-muted-foreground hover:text-destructive",onClick:()=>f(F.id,l),children:a.jsx(Fn,{className:"h-4 w-4"})})]})]},F.id)})})}),a.jsx(Ys,{}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex justify-between font-medium",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:["$",D.toFixed(2)]})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Shipping and taxes calculated at checkout."}),a.jsx(O,{className:"w-full",size:"lg",style:{backgroundColor:s.primaryColor},onClick:W,children:"Proceed to Checkout"})]})]})]})]})})}),A&&a.jsx(Tje,{open:T,onOpenChange:j,storeId:l,storeName:r,currentLogoUrl:o,currentLogoUrlLight:i,currentLogoUrlDark:o,onLogoReplaced:G})]})},yh={Root:({children:t,...e})=>a.jsx("div",{...e,children:t}),Portal:({children:t})=>a.jsx(a.Fragment,{children:t}),Overlay:ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("fixed inset-0 z-50",t),...e})),Content:ht.forwardRef(({className:t,children:e,...n},r)=>a.jsx("div",{ref:r,className:bt("fixed z-50",t),...n,children:e}))};yh.Overlay.displayName="DialogPrimitive.Overlay";yh.Content.displayName="DialogPrimitive.Content";const Ije=Object.freeze(Object.defineProperty({__proto__:null,default:Mq},Symbol.toStringTag,{value:"Module"})),Lq=({store:t,isPublishedView:e=!1})=>{const{name:n,theme:r,id:s,content:i}=t,{updateStore:o}=$n(),l=!e,c=new Date().getFullYear(),u=[{icon:Fie,href:"#",label:"Facebook"},{icon:Wx,href:"#",label:"Instagram"},{icon:soe,href:"#",label:"Twitter"},{icon:zie,href:"#",label:"LinkedIn"},{icon:aoe,href:"#",label:"YouTube"}],h=[{href:`/store/${s}`,label:"Home"},{href:`#products-${s}`,label:"Products"},{href:"#",label:"About Us"},{href:"#",label:"Contact"},{href:"#",label:"FAQ"},{href:"#",label:"Privacy Policy"},{href:"#",label:"Terms of Service"},{href:"#",label:"Shipping Info"},{href:"#",label:"Returns"}],f=i!=null&&i.footerNavLinks&&Array.isArray(i.footerNavLinks)&&i.footerNavLinks.length>0?i.footerNavLinks.map((A,E)=>{var I,N;return{href:A.href||((I=h[E])==null?void 0:I.href)||"#",label:A.label||((N=h[E])==null?void 0:N.label)||`Link ${E+1}`}}):h,m=()=>{window.scrollTo({top:0,behavior:"smooth"})},g=async(A,E,I=null)=>{if(s)try{if(A.startsWith("content.footerNavLinks")){const N=f.map((k,R)=>R===I?{...k,label:E}:k);await o(s,{content:{...i,footerNavLinks:N}})}else{const N=A.split(".");N.length===2&&N[0]==="content"?await o(s,{content:{...i,[N[1]]:E}}):console.warn("Unsupported identifier for footer text save:",A)}}catch(N){console.error(`Failed to update store footer text for ${A}:`,N)}},x=(i==null?void 0:i.footerStoreInfo)||`Your favorite destination for ${t.type||"quality products"}. We are committed to bringing you the best experience with premium quality and exceptional service.`,v=(i==null?void 0:i.footerQuickLinksTitle)||"Quick Links",w=(i==null?void 0:i.footerCustomerServiceTitle)||"Customer Service",_=(i==null?void 0:i.footerContactUsTitle)||"Contact Us",C=(i==null?void 0:i.footerAddress)||"123 Store Street, Cityville, ST 12345",T=(i==null?void 0:i.footerPhoneNumber)||"(123) 456-7890",j=(i==null?void 0:i.footerCopyrightSuffix)||"All Rights Reserved. Powered by FreshFront.";return a.jsxs("footer",{className:"bg-muted dark:bg-slate-900 text-muted-foreground relative overflow-hidden",id:`contact-${s}`,children:[a.jsx(It.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},viewport:{once:!0},className:"pt-16 pb-8",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-xl font-bold text-foreground font-poppins",style:{color:r.primaryColor},children:n}),a.jsx("div",{className:"text-sm",children:a.jsx(Gn,{initialText:x,onSave:A=>g("content.footerStoreInfo",A),isAdmin:l,placeholder:"Store information paragraph",useTextarea:!0,textClassName:"text-sm"})}),a.jsx("div",{className:"flex space-x-3 pt-2",children:u.map(A=>a.jsx("a",{href:A.href,"aria-label":A.label,className:"p-2 rounded-full bg-background/50 hover:bg-primary/10 hover:scale-110 transition-all duration-300",style:{"--hover-bg-color":`${r.primaryColor}1A`,"--hover-text-color":r.primaryColor},children:a.jsx(A.icon,{className:"h-5 w-5"})},A.label))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(Gn,{initialText:v,onSave:A=>g("content.footerQuickLinksTitle",A),isAdmin:l,placeholder:"Quick Links Title",textClassName:"font-bold text-foreground"})}),a.jsx("ul",{className:"space-y-2",children:f.slice(0,5).map((A,E)=>a.jsx("li",{children:a.jsx("a",{href:A.href,className:"text-sm hover:text-primary transition-colors hover:translate-x-1 inline-block hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:a.jsx(Gn,{initialText:A.label,onSave:I=>g("content.footerNavLinks",I,E),isAdmin:l,placeholder:`Link ${E+1}`,textClassName:"text-sm"})})},A.label+E))})]}),a.jsxs(It.div,{variants:{hidden:{opacity:0,x:-30},visible:{opacity:1,x:0,transition:{duration:.5,ease:"easeOut",delay:.2}}},children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(Gn,{initialText:w,onSave:A=>g("content.footerCustomerServiceTitle",A),isAdmin:l,placeholder:"Customer Service Title",textClassName:"font-bold text-foreground"})}),a.jsx("ul",{className:"space-y-2",children:f.slice(5).map((A,E)=>a.jsx("li",{children:a.jsx("a",{href:A.href,className:"text-sm hover:text-primary transition-colors hover:translate-x-1 inline-block hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:a.jsx(Gn,{initialText:A.label,onSave:I=>g("content.footerNavLinks",I,E+5),isAdmin:l,placeholder:`Link ${E+6}`,textClassName:"text-sm"})})},A.label+E+5))})]}),a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(Gn,{initialText:_,onSave:A=>g("content.footerContactUsTitle",A),isAdmin:l,placeholder:"Contact Us Title",textClassName:"font-bold text-foreground"})}),a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(Gie,{className:"h-5 w-5 mt-0.5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsx(Gn,{initialText:C,onSave:A=>g("content.footerAddress",A),isAdmin:l,placeholder:"Store Address",useTextarea:!0,textClassName:"text-sm"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(ah,{className:"h-5 w-5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsxs("a",{href:`mailto:info@${n.toLowerCase().replace(/\s+/g,"")}.com`,className:"hover:text-primary hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:["info@",n.toLowerCase().replace(/\s+/g,""),".com"]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Qie,{className:"h-5 w-5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsx(Gn,{initialText:T,onSave:A=>g("content.footerPhoneNumber",A),isAdmin:l,placeholder:"Store Phone Number",textClassName:"text-sm hover:text-primary hover:underline decoration-primary/30 underline-offset-4"})]})]})]}),a.jsxs("div",{className:"border-t border-border/50 pt-6 flex flex-col md:flex-row justify-between items-center text-sm",children:[a.jsxs("p",{children:["© ",c," ",n,". ",a.jsx(Gn,{initialText:j,onSave:A=>g("content.footerCopyrightSuffix",A),isAdmin:l,placeholder:"Copyright suffix",textClassName:"text-sm",as:"span"})]}),a.jsx("div",{className:"flex items-center mt-4 md:mt-0",children:a.jsx(O,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-primary/10 transition-all duration-300",onClick:m,style:{"--hover-bg-color":`${r.primaryColor}1A`},children:a.jsx(Pie,{className:"h-5 w-5",style:{color:r.primaryColor}})})})]})]})}),a.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary/5 rounded-full translate-x-1/2 -translate-y-1/2 blur-3xl"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-secondary/5 rounded-full -translate-x-1/3 translate-y-1/3 blur-3xl"})]})},Nje=Object.freeze(Object.defineProperty({__proto__:null,default:Lq},Symbol.toStringTag,{value:"Module"})),Pje=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),Aje=({open:t,onOpenChange:e,product:n,onVideoGenerated:r})=>{var T,j,A,E;const[s,i]=p.useState(""),[o,l]=p.useState(null),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(!1),[g,x]=p.useState(null),{toast:v}=as(),w=((j=(T=n==null?void 0:n.image)==null?void 0:T.src)==null?void 0:j.large)||((E=(A=n==null?void 0:n.image)==null?void 0:A.src)==null?void 0:E.medium);p.useEffect(()=>{t&&w&&(x(null),i(""),l(null),u(null),Pje(w).then(I=>{l(I.base64ImageData),u(I.mimeType)}).catch(I=>{console.error("Error loading product image data:",I),x(`Failed to load product image: ${I.message}`),v({title:"Error",description:`Failed to load product image: ${I.message}`,variant:"destructive"})}))},[t,w,v]);const _=async()=>{if(!o||!c){v({title:"Error",description:"Product image data is not available to suggest a prompt.",variant:"destructive"});return}h(!0),x(null);try{const I=await sa(o,c);i(I)}catch(I){console.error("Error generating prompt suggestion:",I),x(`Failed to suggest prompt: ${I.message}`),v({title:"Suggestion Failed",description:`Could not suggest a prompt: ${I.message}`,variant:"destructive"})}finally{h(!1)}},C=async()=>{if(!s.trim()){x("Please enter a prompt for the video.");return}if(!o||!c){x("Product image data is not available.");return}m(!0),x(null);try{const I=await KI(s,o,c);r&&r(I),e(!1)}catch(I){console.error("Error generating product video:",I),x(I.message||"Failed to generate video. Please try again."),v({title:"Video Generation Failed",description:I.message,variant:"destructive"})}finally{m(!1)}};return n?a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs(Vr,{className:"sm:max-w-lg",children:[a.jsxs(Ur,{children:[a.jsx(Br,{children:"Generate Product Video"}),a.jsxs(Qi,{children:['Create a short video for "',n.name,'" using its image and a prompt.']})]}),a.jsxs("div",{className:"grid gap-4 py-4",children:[w&&a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx("img",{src:w,alt:n.name,className:"w-32 h-32 object-contain rounded border"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Using this image as the base."})]}),a.jsxs("div",{className:"grid w-full gap-1.5",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(je,{htmlFor:"video-prompt",children:"Video Prompt"}),a.jsxs(O,{variant:"outline",size:"sm",onClick:_,disabled:d||f||!o,children:[d?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(fa,{className:"mr-2 h-4 w-4"}),"Suggest"]})]}),a.jsx(En,{id:"video-prompt",value:s,onChange:I=>i(I.target.value),placeholder:"e.g., A dynamic shot of the product with vibrant background...",rows:4,disabled:d||f}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"AI will use the product image and this prompt to create a video."})]}),g&&a.jsx("p",{className:"text-sm text-red-500 col-span-4 text-center",children:g})]}),a.jsxs(Ar,{children:[a.jsx(rl,{asChild:!0,children:a.jsx(O,{variant:"outline",disabled:f,children:"Cancel"})}),a.jsxs(O,{onClick:C,disabled:d||f||!s.trim()||!o,children:[f?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(fa,{className:"mr-2 h-4 w-4"}),"Generate Video"]})]})]})}):null},JF="msy_4wQeZBKbKsyGKmfCOGWk0Ux9F7zGIByWSgwC",QF="https://api.meshy.ai/openapi/v1",kje=({open:t,onOpenChange:e,product:n,storeId:r,onModelGenerated:s})=>{const{toast:i}=as(),[o,l]=p.useState([]),[c,u]=p.useState(null),[d,h]=p.useState(0),[f,m]=p.useState(""),[g,x]=p.useState(""),[v,w]=p.useState(!1),[_,C]=p.useState(null),T=p.useCallback(()=>{var k,R,D,M,z,B,G;return n?(R=(k=n.image)==null?void 0:k.src)!=null&&R.large||(M=(D=n.image)==null?void 0:D.src)!=null&&M.medium?[{name:"Main Product Image",url:n.image.src.large||n.image.src.medium}]:((B=(z=n.images)==null?void 0:z.edges)==null?void 0:B.length)>0&&((G=n.images.edges[0].node)!=null&&G.url)?n.images.edges.map((Y,H)=>({name:`Product Image ${H+1}`,url:Y.node.url})).slice(0,4):[]:[]},[n]);p.useEffect(()=>{t&&n?(l(T().slice(0,1)),u(null),h(0),m(""),x(""),w(!1),_&&(clearInterval(_),C(null))):!t&&_&&(clearInterval(_),C(null))},[t,n,T,_]);const j=k=>{const R=Array.from(k.target.files);if(R.length===0)return;const D=[];let M=o.length;R.forEach(z=>{if(M>=4){i({title:"Limit Reached",description:"You can select up to 4 images.",variant:"warning"});return}const B=new FileReader;B.onload=G=>{D.push({name:z.name,url:G.target.result,file:z}),D.length===Math.min(R.length,4-o.length)&&l(Y=>[...Y,...D].slice(0,4))},B.readAsDataURL(z),M++})},A=k=>{l(R=>R.filter((D,M)=>M!==k))},E=async()=>{if(o.length===0){i({title:"No Image Selected",description:"Please select at least one image.",variant:"destructive"});return}w(!0),x(""),m("PENDING"),h(5);const k=o.length>1?"/multi-image-to-3d":"/image-to-3d",R=o.length>1?{image_urls:o.map(D=>D.url)}:{image_url:o[0].url};R.enable_pbr=!0,R.should_texture=!0,o.length===1&&(n!=null&&n.name);try{const D=await fetch(`${QF}${k}`,{method:"POST",headers:{Authorization:`Bearer ${JF}`,"Content-Type":"application/json"},body:JSON.stringify(R)}),M=await D.json();if(!D.ok)throw new Error(M.detail||M.message||`API Error: ${D.status}`);if(M.result){u(M.result),m("IN_PROGRESS"),h(10);const z=setInterval(()=>I(M.result,k),5e3);C(z)}else throw new Error("Task ID not found in response.")}catch(D){console.error("Error creating Meshy task:",D),x(`Error creating task: ${D.message}`),m("FAILED"),w(!1)}},I=async(k,R)=>{var D,M;try{const z=await fetch(`${QF}${R}/${k}`,{headers:{Authorization:`Bearer ${JF}`}}),B=await z.json();if(!z.ok){if(z.status===404&&d<30){h(G=>Math.min(G+5,30));return}throw new Error(B.detail||B.message||`API Error: ${z.status}`)}if(h(B.progress||d),m(B.status),B.status==="SUCCEEDED")if(_&&clearInterval(_),C(null),w(!1),(D=B.model_urls)!=null&&D.glb)s(B.model_urls.glb),i({title:"3D Model Generated!",description:"The model has been successfully created."}),e(!1);else throw new Error("GLB model URL not found in successful response.");else B.status==="FAILED"?(_&&clearInterval(_),C(null),x(((M=B.task_error)==null?void 0:M.message)||"Generation failed for an unknown reason."),w(!1)):(B.status==="PENDING"||B.status==="IN_PROGRESS")&&B.progress===100&&B.status==="IN_PROGRESS"&&h(99)}catch(z){console.error("Error polling Meshy task status:",z),x(`Error polling status: ${z.message}`),_&&clearInterval(_),C(null),m("FAILED"),w(!1)}},N=()=>{_&&(clearInterval(_),C(null)),e(!1)};return a.jsx(Yr,{open:t,onOpenChange:N,children:a.jsxs(Vr,{className:"sm:max-w-lg",children:[a.jsx(Ur,{children:a.jsxs(Br,{children:["Generate 3D Model for ",(n==null?void 0:n.name)||(n==null?void 0:n.title)||"Product"]})}),a.jsxs("div",{className:"py-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"image-upload",children:"Product Images (select 1-4)"}),a.jsxs("div",{className:"mt-2 grid grid-cols-2 sm:grid-cols-4 gap-2 mb-2",children:[o.map((k,R)=>a.jsxs("div",{className:"relative group aspect-square border rounded-md overflow-hidden",children:[a.jsx("img",{src:k.url,alt:k.name,className:"w-full h-full object-cover"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 opacity-50 group-hover:opacity-100",onClick:()=>A(R),disabled:v||f==="IN_PROGRESS",children:a.jsx(Fn,{size:14})})]},R)),o.length<4&&a.jsxs(je,{htmlFor:"image-upload-input",className:"aspect-square border-2 border-dashed rounded-md flex flex-col items-center justify-center cursor-pointer hover:border-primary transition-colors text-muted-foreground",children:[a.jsx(Lo,{size:24,className:"mb-1"}),a.jsx("span",{className:"text-xs",children:"Add Image"})]})]}),a.jsx(Je,{id:"image-upload-input",type:"file",multiple:!0,accept:"image/png, image/jpeg, image/jpg",onChange:j,className:"hidden",disabled:v||f==="IN_PROGRESS"||o.length>=4}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Default is main product image. You can add up to 4 images (PNG, JPG). More images can improve quality."})]}),f&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs(je,{children:["Status: ",f]}),f==="SUCCEEDED"&&a.jsx(ha,{className:"h-5 w-5 text-green-500"}),f==="FAILED"&&a.jsx(rw,{className:"h-5 w-5 text-red-500"}),(f==="PENDING"||f==="IN_PROGRESS")&&a.jsx(ft,{className:"h-5 w-5 animate-spin"})]}),a.jsx($a,{value:d,className:"w-full"}),g&&a.jsx("p",{className:"text-sm text-red-500",children:g})]})]}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",onClick:N,disabled:v&&f==="IN_PROGRESS",children:"Cancel"}),a.jsxs(O,{type:"button",onClick:E,disabled:v||o.length===0||f==="IN_PROGRESS"||f==="SUCCEEDED",children:[v&&(f==="PENDING"||f==="IN_PROGRESS")?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,f==="IN_PROGRESS"?"Generating...":"Generate 3D Model"]})]})]})})},jje=({modelUrl:t,thumbnailUrl:e,productName:n="Product",className:r="",height:s="400px",showControls:i=!0,autoRotate:o=!1,cameraControls:l=!0,ar:c=!0})=>{const u=p.useRef(null);p.useEffect(()=>{if(!window.customElements.get("model-viewer")){const m=document.createElement("script");m.type="module",m.src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js",document.head.appendChild(m)}},[]);const d=()=>{u.current&&(u.current.resetTurntableRotation(),u.current.jumpCameraToGoal())},h=()=>{u.current&&u.current.requestFullscreen&&u.current.requestFullscreen()},f=()=>{if(t){const m=document.createElement("a");m.href=t,m.download=`${n.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_3d_model.glb`,document.body.appendChild(m),m.click(),document.body.removeChild(m)}};return t?a.jsx(Qe,{className:r,children:a.jsxs(it,{className:"p-0 relative",children:[a.jsxs("model-viewer",{ref:u,src:t,poster:e,alt:`3D model of ${n}`,style:{width:"100%",height:s,backgroundColor:"#f8f9fa"},"camera-controls":l,"auto-rotate":o,ar:c,"ar-modes":"webxr scene-viewer quick-look","environment-image":"neutral","shadow-intensity":"1",exposure:"1","tone-mapping":"neutral",loading:"eager",children:[a.jsx("div",{slot:"progress-bar",className:"absolute inset-0 flex items-center justify-center bg-background/80",children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading 3D model..."})]})}),a.jsx("div",{slot:"error",className:"absolute inset-0 flex items-center justify-center bg-background",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-destructive mb-2",children:"Failed to load 3D model"}),a.jsx(O,{variant:"outline",size:"sm",onClick:()=>window.location.reload(),children:"Retry"})]})})]}),i&&a.jsxs("div",{className:"absolute top-2 right-2 flex flex-col space-y-1",children:[a.jsx(O,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:d,title:"Reset camera",children:a.jsx(Zie,{className:"h-4 w-4"})}),a.jsx(O,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:h,title:"Fullscreen",children:a.jsx(Wie,{className:"h-4 w-4"})}),a.jsx(O,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:f,title:"Download model",children:a.jsx(kI,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"absolute bottom-2 right-2"})]})}):a.jsx(Qe,{className:r,children:a.jsx(it,{className:"flex items-center justify-center p-6",style:{height:s},children:a.jsx("p",{className:"text-muted-foreground",children:"No 3D model available"})})})},Rje=({product:t,storeId:e,isPublishedView:n=!1})=>{const{toast:r}=as(),{getStoreById:s}=$n(),[i,o]=p.useState(null),[l,c]=p.useState(null),[u,d]=p.useState(""),[h,f]=p.useState([]),[m,g]=p.useState([]),[x,v]=p.useState(null),[w,_]=p.useState(!1),[C,T]=p.useState(""),[j,A]=p.useState("#FFFFFF"),[E,I]=p.useState({}),[N,k]=p.useState(""),[R,D]=p.useState(""),[M,z]=p.useState(!1),[B,G]=p.useState(!1);p.useEffect(()=>{if(e){const V=s(e);o(V),V&&t&&f(V.products.filter(W=>{var F,Z;return W.id!==t.id&&((Z=(F=W.image)==null?void 0:F.src)==null?void 0:Z.medium)}))}},[e,t,s]);const Y=V=>{const W=V.target.files[0];if(W){W.size>5*1024*1024&&r({title:"File too large",description:"Reference image should ideally be under 5MB.",variant:"destructive"}),c(W);const F=new FileReader;F.onloadend=()=>d(F.result),F.readAsDataURL(W),v(null),k(""),D("")}},H=()=>{c(null),d(""),v(null),k(""),D("")},K=V=>{g(W=>W.find(F=>F.id===V.id)?W.filter(F=>F.id!==V.id):[...W,V]),v(null),k(""),D("")},$=async()=>{var F,Z,ce,le;if(!t||!l){r({title:"Missing inputs",description:"Main product and a reference image are required.",variant:"destructive"});return}_(!0),v(null),k(""),D("Generating visualization, please wait...");let V=C;j&&j!=="#FFFFFF"&&(V=`${V} The main product's color should be ${j}.`.trim());const W=Object.entries(E);if(W.length>0){const he=W.map(([Le,Ve])=>`${Le}: ${Ve}`).join(", ");V=`${V} Apply these product attributes: ${he}.`.trim()}try{const he={name:t.name,description:t.description,imageSource:((Z=(F=t.image)==null?void 0:F.src)==null?void 0:Z.large)||((le=(ce=t.image)==null?void 0:ce.src)==null?void 0:le.medium)},Le=m.map(Be=>{var ue,Ce,Ie,ve;return{name:Be.name,description:Be.description,imageSource:((Ce=(ue=Be.image)==null?void 0:ue.src)==null?void 0:Ce.large)||((ve=(Ie=Be.image)==null?void 0:Ie.src)==null?void 0:ve.medium)}}),Ve=await Aq({mainProduct:he,referenceSceneSource:l,additionalProducts:Le,customInstructions:V});k(Ve.promptUsed||"Prompt details not available."),D(Ve.commentary||"Processing complete."),Ve&&Ve.imageUrl?(v(Ve.imageUrl),r({title:"Visualization Generated!",description:Ve.commentary||"Image created."})):r({title:"Visualization Issue",description:Ve.commentary||"No image generated by AI.",variant:"default",duration:7e3})}catch(he){console.error("Error in ProductVisualizer calling generateProductVisualization:",he);const Le=he.message||"An unknown error occurred during visualization.";D(`Error: ${Le}`),r({title:"Visualization Failed",description:Le,variant:"destructive",duration:1e4})}finally{_(!1)}};return!t||!i?a.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"Initializing Product Visualizer..."}):a.jsxs("div",{className:"my-8 border rounded-lg shadow-sm bg-card",children:[a.jsxs("div",{className:"p-4 md:p-6 cursor-pointer flex justify-between items-center",onClick:()=>G(!B),role:"button",tabIndex:0,onKeyDown:V=>(V.key==="Enter"||V.key===" ")&&G(!B),"aria-expanded":B,"aria-controls":"product-visualizer-content-area",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl md:text-2xl font-semibold",children:"Product Visualizer"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["See how ",a.jsx("span",{className:"font-medium text-primary",children:t.name})," looks in different settings."]})]}),a.jsx(O,{variant:"ghost",size:"icon","aria-label":B?"Collapse visualizer":"Expand visualizer",children:B?a.jsx(I3,{className:"h-6 w-6"}):a.jsx(Cu,{className:"h-6 w-6"})})]}),B&&a.jsxs("div",{id:"product-visualizer-content-area",className:"p-4 md:p-6 border-t",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[a.jsxs("div",{className:"space-y-4 md:space-y-6",children:[a.jsxs("div",{children:[a.jsx(je,{htmlFor:"visualizer-reference-image-upload",className:"text-md font-medium block mb-1",children:"1. Upload Reference Scene"}),a.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"E.g., a room, a model. (Max ~5MB recommended)"}),u?a.jsxs("div",{className:"relative group aspect-video rounded-md border overflow-hidden bg-muted/20",children:[a.jsx("img",{src:u,alt:"Reference scene preview",className:"w-full h-full object-contain"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute top-2 right-2 opacity-50 group-hover:opacity-100 transition-opacity",onClick:H,"aria-label":"Remove reference image",children:a.jsx(Hi,{className:"h-4 w-4"})})]}):a.jsxs("label",{htmlFor:"visualizer-reference-image-input",className:"mt-1 flex flex-col justify-center items-center w-full h-40 md:h-48 px-6 py-5 border-2 border-dashed rounded-md cursor-pointer hover:border-primary transition-colors",children:[a.jsx(Lo,{className:"mx-auto h-8 md:h-10 w-8 md:w-10 text-muted-foreground mb-2"}),a.jsx("span",{className:"font-semibold text-primary text-sm",children:"Click to upload image"}),a.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG, GIF, WEBP"}),a.jsx(Je,{id:"visualizer-reference-image-input",type:"file",className:"sr-only",accept:"image/*",onChange:Y})]})]}),h.length>0&&a.jsxs("div",{children:[a.jsx(je,{className:"text-md font-medium block mb-1",children:"2. Add Other Products (Optional)"}),a.jsx(Fs,{className:"h-32 md:h-40 border rounded-md p-2",children:a.jsx("div",{className:"space-y-1.5",children:h.map(V=>a.jsxs("div",{className:`flex items-center justify-between p-2 rounded-md cursor-pointer transition-all text-sm ${m.some(W=>W.id===V.id)?"bg-primary/10 ring-1 ring-primary":"hover:bg-muted/50"}`,onClick:()=>K(V),role:"checkbox","aria-checked":m.some(W=>W.id===V.id),tabIndex:0,onKeyDown:W=>(W.key==="Enter"||W.key===" ")&&K(V),children:[a.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[a.jsx("img",{src:V.image.src.medium,alt:V.name,className:"w-8 h-8 object-cover rounded flex-shrink-0"}),a.jsx("span",{className:"truncate",title:V.name,children:V.name})]}),m.some(W=>W.id===V.id)&&a.jsx(ha,{className:"h-4 w-4 text-primary flex-shrink-0"})]},V.id))})})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"visualizer-product-color",className:"text-md font-medium block mb-1",children:"3. Main Product Color (Optional)"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Je,{type:"color",id:"visualizer-product-color",value:j,onChange:V=>A(V.target.value),className:"w-12 h-10 p-1"}),a.jsx(Je,{type:"text",value:j,onChange:V=>A(V.target.value),placeholder:"#FFFFFF",className:"flex-grow h-10 text-sm"})]})]}),t.variants&&t.variants.length>0&&a.jsxs("div",{children:[a.jsx(je,{className:"text-md font-medium block mb-1",children:"3. Main Product Variants (Optional)"}),a.jsx("div",{className:"space-y-2",children:t.variants.map(V=>!V.name||!V.values||V.values.length===0?null:a.jsxs("div",{children:[a.jsx(je,{htmlFor:`visualizer-variant-${V.name}`,className:"text-sm text-muted-foreground",children:V.name}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:V.values.map(W=>a.jsx(O,{variant:E[V.name]===W?"default":"outline",size:"xs",onClick:()=>I(F=>({...F,[V.name]:W})),className:"text-xs px-2 py-1 h-auto",children:W},W))})]},V.name))})]}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"visualizer-custom-prompt",className:"text-md font-medium block mb-1",children:t.variants&&t.variants.length>0?"5. Additional Custom Instructions (Optional)":"4. Custom Instructions (Optional)"}),a.jsx(En,{id:"visualizer-custom-prompt",placeholder:"e.g., 'place the sofa by the window', 'make it a sunny day'",value:C,onChange:V=>T(V.target.value),rows:2,className:"resize-none text-sm"})]}),a.jsxs(O,{onClick:$,disabled:w||!l,className:"w-full py-2.5 text-sm md:text-base",size:"lg",children:[w?a.jsx(ft,{className:"mr-2 h-5 w-5 animate-spin"}):a.jsx(va,{className:"mr-2 h-5 w-5"}),"Generate Visualization"]})]}),a.jsx("div",{className:"flex flex-col items-center justify-center border rounded-md p-2 md:p-4 bg-muted/30 min-h-[250px] md:min-h-[300px] lg:min-h-full relative",children:w?a.jsxs("div",{className:"text-center",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary mb-3"}),a.jsx("p",{className:"text-muted-foreground font-medium",children:R||"Generating your scene..."})]}):x?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:x,alt:"Generated Product Visualization",className:"max-w-full max-h-[calc(100%-40px)] object-contain rounded-md"}),R&&!R.toLowerCase().includes("error")&&a.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center max-w-xs mx-auto",children:R}),a.jsxs(O,{variant:"ghost",size:"sm",onClick:()=>z(!M),className:"absolute bottom-1 right-1 text-muted-foreground hover:text-primary h-auto p-1","aria-label":"Toggle prompt information",children:[a.jsx($ie,{className:"h-4 w-4 mr-1"})," ",a.jsx("span",{className:"text-xs",children:"Info"})]})]}):a.jsxs("div",{className:"text-center text-muted-foreground p-4",children:[R&&a.jsx("p",{className:`text-sm mb-2 ${R.toLowerCase().includes("error")||R.toLowerCase().includes("failed")?"text-destructive":""}`,children:R}),a.jsx(va,{className:"h-12 w-12 mx-auto mb-3"}),a.jsx("p",{className:"font-medium",children:"Your product visualization will appear here."}),!x&&a.jsx("p",{className:"text-xs mt-1",children:'Upload a reference scene and click "Generate".'})]})})]}),M&&N&&!n&&a.jsxs("div",{className:"mt-4 p-3 border rounded-md bg-muted/50",children:[a.jsx(je,{className:"text-xs font-semibold text-muted-foreground",children:"Technical Prompt Sent to AI:"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1 whitespace-pre-wrap",children:N})]}),a.jsx(Ys,{className:"mt-6 md:mt-8 mb-0"})]})]})};var Fq=p.forwardRef(({transition:t,...e},n)=>{let r={position:"absolute",top:0,left:0,width:"100%",height:"100%",transition:t?`clip-path ${t}`:void 0,userSelect:"none",willChange:"clip-path, transition",KhtmlUserSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none"};return a.jsx("div",{...e,style:r,"data-rcs":"clip-item",ref:n})});Fq.displayName="ContainerClip";var Oq=p.forwardRef(({children:t,disabled:e,portrait:n,position:r,transition:s},i)=>{let o={position:"absolute",top:0,width:n?"100%":void 0,height:n?void 0:"100%",background:"none",border:0,padding:0,pointerEvents:"all",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",outline:0,transform:n?"translate3d(0, -50% ,0)":"translate3d(-50%, 0, 0)",transition:s?`${n?"top":"left"} ${s}`:void 0};return a.jsx("button",{ref:i,"aria-label":"Drag to move or focus and use arrow keys","aria-orientation":n?"vertical":"horizontal","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":r,"data-rcs":"handle-container",disabled:e,role:"slider",style:o,children:t})});Oq.displayName="ThisHandleContainer";var XF=({flip:t})=>a.jsx("div",{className:"__rcs-handle-arrow",style:{width:0,height:0,borderTop:"8px solid transparent",borderRight:"10px solid",borderBottom:"8px solid transparent",transform:t?"rotate(180deg)":void 0}}),Dje=({className:t="__rcs-handle-root",disabled:e,buttonStyle:n,linesStyle:r,portrait:s,style:i,...o})=>{let l={display:"flex",flexDirection:s?"row":"column",placeItems:"center",height:"100%",cursor:e?"not-allowed":s?"ns-resize":"ew-resize",pointerEvents:"none",color:"#fff",...i},c={flexGrow:1,height:s?2:"100%",width:s?"100%":2,backgroundColor:"currentColor",pointerEvents:"auto",boxShadow:"0 0 4px rgba(0,0,0,.5)",...r},u={display:"grid",gridAutoFlow:"column",gap:8,placeContent:"center",flexShrink:0,width:56,height:56,borderRadius:"50%",borderStyle:"solid",borderWidth:2,pointerEvents:"auto",backdropFilter:"blur(7px)",WebkitBackdropFilter:"blur(7px)",backgroundColor:"rgba(0, 0, 0, 0.125)",boxShadow:"0 0 4px rgba(0,0,0,.35)",transform:s?"rotate(90deg)":void 0,...n};return a.jsxs("div",{...o,className:t,style:l,children:[a.jsx("div",{className:"__rcs-handle-line",style:c}),a.jsxs("div",{className:"__rcs-handle-button",style:u,children:[a.jsx(XF,{}),a.jsx(XF,{flip:!0})]}),a.jsx("div",{className:"__rcs-handle-line",style:c})]})},$q=(t=>(t.ARROW_LEFT="ArrowLeft",t.ARROW_RIGHT="ArrowRight",t.ARROW_UP="ArrowUp",t.ARROW_DOWN="ArrowDown",t))($q||{}),Mje=({boxSizing:t="border-box",objectFit:e="cover",objectPosition:n="center center",...r}={})=>({display:"block",width:"100%",height:"100%",maxWidth:"100%",boxSizing:t,objectFit:e,objectPosition:n,...r}),Lje=t=>{let e=p.useRef(t);return p.useEffect(()=>{e.current=t}),e.current},pC=(t,e,n,r)=>{let s=p.useRef();p.useEffect(()=>{s.current=e},[e]),p.useEffect(()=>{if(!(n&&n.addEventListener))return;let i=o=>s.current&&s.current(o);return n.addEventListener(t,i,r),()=>{n.removeEventListener(t,i,r)}},[t,n,r])},Fje=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect,Oje=(t,e)=>{let n=p.useRef(),r=p.useCallback(()=>{t.current&&n.current&&n.current.observe(t.current)},[t]);Fje(()=>(n.current=new ResizeObserver(([s])=>e(s.contentRect)),r(),()=>{n.current&&n.current.disconnect()}),[e,r])},Px={capture:!1,passive:!0},gC={capture:!0,passive:!1},$je=t=>{t.preventDefault(),t.currentTarget.focus()},Vq=p.forwardRef(({boundsPadding:t=0,browsingContext:e=globalThis,changePositionOnHover:n=!1,disabled:r=!1,handle:s,itemOne:i,itemTwo:o,keyboardIncrement:l="5%",onlyHandleDraggable:c=!1,onPositionChange:u,portrait:d=!1,position:h=50,style:f,transition:m,...g},x)=>{let v=p.useRef(null),w=p.useRef(null),_=p.useRef(null),C=p.useRef(h),[T,j]=p.useState(!1),[A,E]=p.useState(!0),I=p.useRef(!1),[N,k]=p.useState(),R=Lje(h),D=p.useCallback(function({x:V,y:W,isOffset:F}){let Z=v.current,ce=_.current,le=w.current,{width:he,height:Le,left:Ve,top:Be}=Z.getBoundingClientRect();if(he===0||Le===0)return;let ue=d?F?W-Be-e.scrollY:W:F?V-Ve-e.scrollX:V,Ce=Math.min(Math.max(ue/(d?Le:he)*100,0),100),Ie=d?Le/(Z.offsetHeight||1):he/(Z.offsetWidth||1),ve=t*Ie/(d?Le:he)*100,ie=Math.min(Math.max(Ce,ve*Ie),100-ve*Ie);C.current=Ce,ce.setAttribute("aria-valuenow",`${Math.round(C.current)}`),ce.style.top=d?`${ie}%`:"0",ce.style.left=d?"0":`${ie}%`,le.style.clipPath=d?`inset(${ie}% 0 0 0)`:`inset(0 0 0 ${ie}%)`,u&&u(C.current)},[t,u,d,e]);p.useEffect(()=>{let{width:V,height:W}=v.current.getBoundingClientRect(),F=h===R?C.current:h;D({x:V/100*F,y:W/100*F})},[t,h,d,R,D]);let M=p.useCallback(V=>{V.preventDefault(),!(r||V.button!==0)&&(D({isOffset:!0,x:V.pageX,y:V.pageY}),j(!0),E(!0))},[r,D]),z=p.useCallback(function(V){D({isOffset:!0,x:V.pageX,y:V.pageY}),E(!1)},[D]),B=p.useCallback(()=>{j(!1),E(!0)},[]),G=p.useCallback(({width:V,height:W})=>{let{width:F,height:Z}=v.current.getBoundingClientRect();D({x:V/100*C.current*F/V,y:W/100*C.current*Z/W})},[D]),Y=p.useCallback(V=>{if(!Object.values($q).includes(V.key))return;V.preventDefault(),E(!0);let{top:W,left:F}=_.current.getBoundingClientRect(),{width:Z,height:ce}=v.current.getBoundingClientRect(),le=typeof l=="string"?parseFloat(l):l/Z*100,he=d?V.key==="ArrowLeft"||V.key==="ArrowDown":V.key==="ArrowRight"||V.key==="ArrowUp",Le=Math.min(Math.max(he?C.current+le:C.current-le,0),100);D({x:d?F:Z*Le/100,y:d?ce*Le/100:W})},[l,d,D]);p.useEffect(()=>{k(c?_.current:v.current)},[c]),p.useEffect(()=>{let V=v.current,W=()=>{T||B()};return n&&(V.addEventListener("pointermove",z,Px),V.addEventListener("pointerleave",W,Px)),()=>{V.removeEventListener("pointermove",z),V.removeEventListener("pointerleave",W)}},[n,z,B,T]),p.useEffect(()=>(T&&!I.current&&(e.addEventListener("pointermove",z,Px),e.addEventListener("pointerup",B,Px),I.current=!0),()=>{I.current&&(e.removeEventListener("pointermove",z),e.removeEventListener("pointerup",B),I.current=!1)}),[z,B,T,e]),p.useImperativeHandle(x,()=>({rootContainer:v.current,handleContainer:_.current,setPosition(V){let{width:W,height:F}=v.current.getBoundingClientRect();D({x:W/100*V,y:F/100*V})}}),[D]),Oje(v,G),pC("keydown",Y,_.current,gC),pC("click",$je,_.current,gC),pC("pointerdown",M,N,gC);let H=s||a.jsx(Dje,{disabled:r,portrait:d}),K=A?m:void 0,$={position:"relative",display:"flex",overflow:"hidden",cursor:T?d?"ns-resize":"ew-resize":void 0,touchAction:"none",userSelect:"none",KhtmlUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",...f};return a.jsxs("div",{...g,ref:v,style:$,"data-rcs":"root",children:[i,a.jsx(Fq,{ref:w,transition:K,children:o}),a.jsx(Oq,{disabled:r,portrait:d,position:Math.round(C.current),ref:_,transition:K,children:H})]})});Vq.displayName="ReactCompareSlider";var y1=p.forwardRef(({style:t,...e},n)=>{let r=Mje(t);return a.jsx("img",{ref:n,...e,style:r,"data-rcs":"image"})});y1.displayName="ReactCompareSliderImage";const Vje=()=>{var J,re,ge,Oe,tt,Q,te,me;const t=I0(),e=t.storeName,n=decodeURIComponent(t.productId),{getStoreByName:r,getProductById:s,updateProductImage:i,updateStore:o,isLoadingStores:l,viewMode:c,updateProductImagesArray:u}=$n(),d=c==="published",{toast:h}=as(),f=ti(),m=uf(),[g,x]=p.useState(null),[v,w]=p.useState(null),[_,C]=p.useState(1),[T,j]=p.useState({}),[A,E]=p.useState(null),[I,N]=p.useState(!1),[k,R]=p.useState(""),[D,M]=p.useState([]),[z,B]=p.useState(!1),[G,Y]=p.useState(!1),[H,K]=p.useState(null),[$,V]=p.useState(""),[W,F]=p.useState(!1),[Z,ce]=p.useState(!1),[le,he]=p.useState(""),[Le,Ve]=p.useState(!1),[Be,ue]=p.useState(""),[Ce,Ie]=p.useState(""),[ve,ie]=p.useState(""),[Me,He]=p.useState([]),[yt,kt]=p.useState(!1),[en,mn]=p.useState(null),[cn,fn]=p.useState(""),[Ue,Et]=p.useState(""),[de,De]=p.useState(!1),[ee,ae]=p.useState(!1),X=q=>{let ne=q.split(","),be=ne[0].match(/:(.*?);/)[1],Ne=atob(ne[1]),Ge=Ne.length,Se=new Uint8Array(Ge);for(;Ge--;)Se[Ge]=Ne.charCodeAt(Ge);return new Blob([Se],{type:be})},Pe=async()=>{if(!ve||!v||!g){h({title:"Missing data",description:"Cannot generate angles without an active image, product, or store context.",variant:"destructive"});return}De(!0);try{const{base64ImageData:q,mimeType:ne}=await $e(ve),be=await G0(q,ne,v.name||"Product");if(be&&be.length>0){const Ne=[];for(const st of be)if(st.startsWith("data:")){const Mt=X(st),xn=`angle-${Date.now()}-${Math.random().toString(36).substring(2,15)}.png`,Zr=`products/${g.id}/${v.id}/angles/${xn}`,Dn=ph(gh,Zr);await fh(Dn,Mt);const Gr=await mh(Dn);Ne.push(Gr)}else Ne.push(st);const Ge=Ne.map((st,Mt)=>({id:`angle-${v.id}-${Me.length+Mt}-${Ft()}`,src:{medium:st,large:st},alt:`${v.name} - Angle ${Me.length+Mt+1}`})),Se=[...Me,...Ge];He(Se);const ot=Se.map(st=>st.src.large||st.src.medium);await u(g.id,v.id,ot),h({title:"Angles Generated & Stored",description:`${Ne.length} new angle images added to gallery and storage.`})}else h({title:"No Angles Generated",description:"The AI did not return any new angle images.",variant:"default"})}catch(q){console.error("Error generating or storing angles on detail page:",q),h({title:"Angle Generation/Storage Failed",description:q.message,variant:"destructive"})}De(!1)},Ae=async q=>{var Ne,Ge;if(!g||!v)return;const ne=Me.filter(Se=>Se.id!==q);if(ne.length===0){const Se=`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(v.name||"Product")}`;He([{id:`placeholder-${v.id}`,src:{medium:Se,large:Se},alt:v.name||"Product image"}]),ie(Se)}else He(ne),(ve===((Ne=Me.find(Se=>Se.id===q))==null?void 0:Ne.src.large)||ve===((Ge=Me.find(Se=>Se.id===q))==null?void 0:Ge.src.medium))&&ie(ne[0].src.large||ne[0].src.medium);const be=ne.map(Se=>Se.src.large||Se.src.medium).filter(Se=>!Se.includes("via.placeholder.com"));await u(g.id,v.id,be),h({title:"Image Deleted",description:"Image removed from gallery.",variant:"destructive"})},$e=p.useCallback(q=>new Promise((ne,be)=>{if(!q)return be(new Error("Image source is undefined or null."));if(q.startsWith("data:"))try{const Ne=q.split(",");if(Ne.length<2)throw new Error("Invalid data URL structure.");const Ge=Ne[0],Se=Ne[1],ot=Ge.match(/:(.*?);/);if(!ot||!ot[1])throw new Error("Could not parse MIME type from data URL.");const st=ot[1];ne({base64ImageData:Se,mimeType:st})}catch(Ne){console.error("Error parsing data URL:",q,Ne),be(new Error(`Invalid data URL format: ${Ne.message}`))}else{const Ne=new Image;Ne.crossOrigin="Anonymous",Ne.onload=()=>{const Ge=document.createElement("canvas");Ge.width=Ne.naturalWidth,Ge.height=Ne.naturalHeight,Ge.getContext("2d").drawImage(Ne,0,0);try{const Mt=Ge.toDataURL("image/png").split(",")[1];ne({base64ImageData:Mt,mimeType:"image/png"})}catch(ot){console.error("Canvas toDataURL failed:",ot),be(new Error("Canvas toDataURL failed, possibly due to CORS or tainted canvas. "+ot.message))}},Ne.onerror=Ge=>{console.error("Failed to load image from URL for conversion:",q,Ge),be(new Error("Failed to load image from URL for conversion."))},Ne.src=q}}),[]);p.useCallback(async()=>{if(!$.trim()||!ve||!v||!g){h({title:"Missing data",description:"Active image, edit prompt, product, or store context is missing.",variant:"destructive"});return}F(!0);try{const{base64ImageData:q,mimeType:ne}=await $e(ve),be=await $o(q,ne,$);if(be&&be.editedImageData&&be.newMimeType){const Ne=`data:${be.newMimeType};base64,${be.editedImageData}`,Ge=X(Ne),Se=`edited-${Date.now()}.png`,ot=`products/${g.id}/${v.id}/images/${Se}`,st=ph(gh,ot);await fh(st,Ge);const Mt=await mh(st),xn={id:Ft(),src:{medium:Mt,large:Mt},alt:`${v.name} (edited: ${$.substring(0,20)}...)`,photographer:"Edited with Gemini AI via Firebase Storage"};await i(g.id,n,xn);const Zr=Me.map(Dn=>Dn.src.medium===ve||Dn.src.large===ve?xn:Dn);Me.some(Dn=>Dn.src.medium===ve||Dn.src.large===ve)||Zr.push(xn),He(Zr),ie(Mt),h({title:"Image Edited & Stored",description:"Product image updated and saved to storage."}),Y(!1),V("")}else throw new Error("AI did not return valid edited image data.")}catch(q){console.error("Error editing image or uploading to storage:",q),h({title:"Image Edit Failed",description:q.message,variant:"destructive"})}F(!1)},[ve,$,v,g,n,i,Me,h,$e,X]),p.useEffect(()=>{var ne,be,Ne,Ge;if(l)return;const q=r(e);if(q){x(q);const Se=s(q.id,n);if(Se){w(Se),R(Se.name),he(Se.video_url||""),ue(Se.model_3d_url||""),Ie(Se.model_3d_thumbnail_url||"");let ot=[];Se.images&&Array.isArray(Se.images)&&Se.images.length>0?ot=Se.images.map((Mt,xn)=>({id:`gallery-img-${Se.id}-${xn}-${Ft()}`,src:{medium:Mt,large:Mt},alt:`${Se.name||"Product"} image ${xn+1}`})):Se.image&&Se.image.src?ot=[{id:Se.image.id||`gallery-img-${Se.id}-0-${Ft()}`,src:Se.image.src,alt:Se.image.alt||`${Se.name||"Product"} image`}]:ot=[{id:`placeholder-${Se.id||Ft()}`,src:{medium:`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(Se.name||"Product")}`,large:`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(Se.name||"Product")}`},alt:Se.name||"Product image"}],Se.video_url&&ot.push({id:`video-${Se.id}-${Ft()}`,src:{medium:Se.video_url,large:Se.video_url},alt:`${Se.name} video`,type:"video"}),He(ot),ie(((be=(ne=ot[0])==null?void 0:ne.src)==null?void 0:be.large)||((Ge=(Ne=ot[0])==null?void 0:Ne.src)==null?void 0:Ge.medium)||"");let st=[];if(Se.options&&Array.isArray(Se.options)?st=Se.options:Se.variants&&Array.isArray(Se.variants)&&Se.variants.length>0&&Se.variants[0].name&&Se.variants[0].values&&(st=Se.variants),st.length>0){const Mt={};st.forEach(xn=>{xn.values&&xn.values.length>0&&(Mt[xn.name]=xn.values[0])}),j(Mt)}}else h({title:"Product not found",description:`Product ID ${n} not found in store ${q.name}.`,variant:"destructive"}),f(`/${e}`)}else h({title:"Store not found",description:`Could not find store: ${e}`,variant:"destructive"}),f("/")},[e,n,r,s,f,h,l]),p.useEffect(()=>{var q,ne,be,Ne,Ge;if(v&&Object.keys(T).length>0){if(((ne=(q=v.variants)==null?void 0:q.edges)==null?void 0:ne.length)>0){const Se=(be=v.variants.edges.find(ot=>!ot.node||!ot.node.selectedOptions?!1:ot.node.selectedOptions.every(st=>T[st.name]===st.value)))==null?void 0:be.node;if(Se){E(Se);return}}}else v&&((Ge=(Ne=v.variants)==null?void 0:Ne.edges)==null?void 0:Ge.length)>0&&Object.keys(T).length},[v,T]);const qe=q=>{const ne=parseInt(q.target.value);ne>0&&C(ne)},oe=async()=>{if(!g||!v||!Pt||Sn===void 0||!cr){h({title:"Error",description:"Product or store data is incomplete for checkout.",variant:"destructive"});return}ae(!0);try{const q=Me.map(st=>st.src.large||st.src.medium).filter(st=>st&&!st.includes("via.placeholder.com")&&!st.startsWith("data:")).slice(0,8),ne=`${window.location.origin}/${e}/product/${productIdFromUrl}`,be=mc(m,"createStripePaymentLink"),Ne={productName:v.name,description:v.description||`High-quality ${v.name}`,images:q.length>0?q:Pt&&!Pt.includes("via.placeholder.com")&&!Pt.startsWith("data:")?[Pt]:[],unitAmount:Math.round(Sn*100),currency:cr.toLowerCase(),productUrl:ne,productMetadata:{productId:v.id,storeId:g.id,storeName:g.name},quantity:_,successUrl:`${window.location.origin}/order-confirmation?storeId=${g.id}&source=paymentlink&product_id=${v.id}`},Ge=await be(Ne),{paymentLinkUrl:Se,error:ot}=Ge.data;if(ot)throw new Error(ot.message||"Failed to create Stripe Payment Link.");if(!Se)throw new Error("Stripe Payment Link URL not received.");window.location.href=Se}catch(q){console.error("Error creating Stripe Payment Link or redirecting:",q),h({title:"Checkout Setup Failed",description:q.message||"Could not prepare for checkout.",variant:"destructive"})}finally{ae(!1)}},_e=async()=>{if(k.trim()){B(!0);try{const q=await io(k,5,"square");M(q)}catch(q){h({title:"Image search failed",description:q.message,variant:"destructive"})}B(!1)}},ze=async()=>{if(!k.trim()||!g||!v){h({title:"Missing context",description:"Store or product context is missing for image generation.",variant:"destructive"});return}B(!0);try{const q=`Product image for: ${k}, ${(v==null?void 0:v.type)||(g==null?void 0:g.type)||"item"}`,ne=await j0(q);if(!ne||!ne.url||!ne.url.startsWith("data:"))throw new Error("AI did not return a valid base64 image data URL.");const be=`gemini-${Date.now()}.png`,Ne=`products/${g.id}/${v.id}/images/${be}`,Ge=ph(gh,Ne),ot=await(await fetch(ne.url)).blob();await fh(Ge,ot);const st=await mh(Ge),Mt={id:Date.now().toString(),src:{medium:st,large:st},alt:ne.alt||k,photographer:"Gemini AI via Firebase Storage"};M(xn=>[Mt,...xn.slice(0,4)]),h({title:"Image Generated & Stored",description:"Gemini AI generated an image, and it has been uploaded to storage."})}catch(q){console.error("Gemini image generation or storage upload failed:",q),h({title:"Gemini Process Failed",description:q.message,variant:"destructive"})}B(!1)},Te=q=>{const ne=q.target.files[0];if(ne&&g&&v){B(!0);const be=`uploaded-${Date.now()}-${ne.name}`,Ne=`products/${g.id}/${v.id}/images/${be}`,Ge=ph(gh,Ne);fh(Ge,ne).then(()=>mh(Ge)).then(Se=>{const ot={id:Ft(),src:{medium:Se,large:Se},alt:ne.name,photographer:"Uploaded by user via Firebase Storage"};M(st=>[ot,...st.slice(0,4)]),h({title:"Image Uploaded & Stored",description:`${ne.name} uploaded. Select it from the results to use.`})}).catch(Se=>{console.error("Error uploading image to Firebase Storage:",Se),h({title:"Storage Upload Failed",description:Se.message,variant:"destructive"})}).finally(()=>{B(!1)})}else ne&&(h({title:"Missing context",description:"Store or product context is missing for image upload.",variant:"destructive"}),B(!1))},Tt=async q=>{if(!g||!v)return;const ne={id:`video-${v.id}-${Ft()}`,src:{medium:q,large:q},alt:`${v.name} video`,type:"video"},be=[...Me,ne];He(be);const Ne=be.filter(Se=>Se.type!=="video").map(Se=>Se.src.large||Se.src.medium),Ge=g.products.map(Se=>Se.id===n?{...Se,video_url:q,images:Ne}:Se);try{g&&g.id?(await o(g.id,{products:Ge}),he(q),h({title:"Product Video Generated",description:"The video has been added to the product gallery."})):h({title:"Error",description:"Store ID not available for video update.",variant:"destructive"})}catch(Se){console.error("Failed to update store with product video:",Se),h({title:"Update Failed",description:"Could not save the product video.",variant:"destructive"})}},wt=async q=>{if(!g||!v)return;const ne=g.products.map(be=>be.id===n?{...be,model_3d_url:q,model_3d_thumbnail_url:q}:be);try{g&&g.id?(await o(g.id,{products:ne}),ue(q),Ie(q),h({title:"3D Model Generated",description:"The 3D model has been added to the product."})):h({title:"Error",description:"Store ID not available for 3D model update.",variant:"destructive"})}catch(be){console.error("Failed to update store with 3D model:",be),h({title:"Update Failed",description:"Could not save the 3D model.",variant:"destructive"})}},xt=q=>{if(g&&g.id&&v&&q&&q.src&&(q.src.medium||q.src.large)){const ne=q.src.large||q.src.medium;if(ne.startsWith("https://firebasestorage.googleapis.com")||ne.startsWith("http://localhost:")||ne.startsWith("https://images.pexels.com")){const be={id:q.id||Ft(),src:{medium:ne,large:ne},alt:q.alt||v.name,photographer:q.photographer||"User"};if(i(g.id,n,be),!Me.find(Ge=>Ge.src.medium===ne||Ge.src.large===ne)){const Ge={...be,id:be.id||Ft()};He(Se=>{const ot=Se.filter(st=>!st.src.medium.includes("via.placeholder.com"));return[Ge,...ot.filter(st=>st.src.medium!==ne)]})}ie(ne),h({title:"Image Selected",description:"Product image updated."})}else h({title:"Invalid Image URL",description:"Selected image does not have a valid storage or Pexels URL.",variant:"destructive"})}else h({title:"Error",description:"Cannot select image. Store, product, or image data missing.",variant:"destructive"});N(!1),M([])};if(l||!g||!v)return a.jsxs("div",{className:"min-h-screen flex items-center justify-center",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary"}),a.jsx("p",{className:"ml-4 text-muted-foreground",children:"Loading product details..."})]});const pt=Me.find(q=>q.src.large===ve||q.src.medium===ve),Pt=ve||((re=(J=v.image)==null?void 0:J.src)==null?void 0:re.large)||((Oe=(ge=v.image)==null?void 0:ge.src)==null?void 0:Oe.medium)||`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(v.name)}`,Rn=(pt==null?void 0:pt.alt)||((tt=v.image)==null?void 0:tt.alt)||v.name,Sn=((Q=A==null?void 0:A.price)==null?void 0:Q.amount)!==void 0?parseFloat(A.price.amount):v.price,cr=((te=A==null?void 0:A.price)==null?void 0:te.currencyCode)||v.currencyCode||"USD";let sn;v.inventory_count!==void 0?sn=v.inventory_count:v.stock!==void 0?sn=v.stock:sn=v.availableForSale?1:0;const $t=((me=g==null?void 0:g.theme)==null?void 0:me.primaryColor)||"#000000";let tn=[];v&&(v.options&&Array.isArray(v.options)?tn=v.options.map(q=>({...q,name:q.name,values:q.values})):v.variants&&Array.isArray(v.variants)&&v.variants.length>0&&v.variants[0].name&&v.variants[0].values&&(tn=v.variants.map(q=>({...q,name:q.name,values:q.values}))));const Zn=async()=>{if(!v||!ve||Object.keys(T).length===0){h({title:"Cannot Visualize",description:"Product data, main image, or selected variants missing.",variant:"destructive"});return}kt(!0),mn(null),Et(ve);try{const{base64ImageData:q,mimeType:ne}=await $e(ve);let be=[];for(const ot in T)be.push(`${ot}: ${T[ot]}`);const Ne=be.join(", "),Ge=`Visualize the product "${v.name}" with the following attributes: ${Ne}. Apply these changes to the provided image.`,Se=await $o(q,ne,Ge);if(Se&&Se.editedImageData&&Se.newMimeType&&typeof Se.newMimeType=="string"&&Se.newMimeType.includes("/")){const ot=`data:${Se.newMimeType};base64,${Se.editedImageData}`,st={id:`visualized-${Ft()}`,src:{medium:ot,large:ot},alt:`${v.name} visualized with ${Ne}`,photographer:"Variant Visualization by Gemini AI"};He(Mt=>[st,...Mt]),fn(st.src.medium||st.src.large),h({title:"Variant Visualized",description:"Comparison slider generated below."})}else{let ot="AI image generation failed: ";throw Se?Se.editedImageData?Se.newMimeType?ot+=`Invalid MIME type from AI ('${Se.newMimeType}').`:ot+="Missing MIME type from AI.":ot+="Missing image data from AI.":ot+="No result from AI.",new Error(ot)}}catch(q){console.error("Error visualizing variant:",q),mn(q.message),h({title:"Visualization Failed",description:q.message,variant:"destructive"})}kt(!1)};return a.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[a.jsx(Mq,{store:g,isPublishedView:d,productName:v.name}),a.jsxs(It.main,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"container mx-auto px-4 py-8 md:py-12 flex-grow",children:[a.jsxs(O,{variant:"outline",onClick:()=>f(`/${e}`),className:"mb-6",children:[a.jsx(Wi,{className:"mr-2 h-4 w-4"})," Back to Store"]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12",children:[a.jsxs(It.div,{initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},className:"flex flex-col items-center",children:[a.jsxs("div",{className:"relative group w-full",children:[ve&&Me.find(q=>(q.src.large===ve||q.src.medium===ve)&&q.type==="video")?a.jsx("video",{src:ve,controls:!0,autoPlay:!0,loop:!0,playsInline:!0,className:"w-full h-auto aspect-square object-cover rounded-xl shadow-lg border",children:"Your browser does not support the video tag."},ve):a.jsx("img",{src:Pt,alt:Rn,className:"w-full h-auto aspect-square object-cover rounded-xl shadow-lg border"},ve),!d&&a.jsxs(a.Fragment,{children:[a.jsxs(O,{variant:"secondary",onClick:()=>N(!0),className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(L3,{className:"mr-2 h-4 w-4"})," Change Image"]}),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>{K(v),Y(!0)},className:"absolute top-16 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(ew,{className:"mr-2 h-4 w-4"})," Edit Product"]}),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>ce(!0),className:"absolute top-28 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(_2,{className:"mr-2 h-4 w-4"})," Gen Video"]}),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>Ve(!0),className:"absolute top-40 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(kie,{className:"mr-2 h-4 w-4"})," Gen 3D"]})]})]}),Me.length>0&&a.jsxs(It.div,{className:"mt-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2,duration:.5},children:[a.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 gap-2",children:Me.map((q,ne)=>{var be,Ne;return a.jsxs(It.div,{className:"relative group",whileHover:{scale:1.05},children:[a.jsx("div",{className:`aspect-square rounded-md overflow-hidden cursor-pointer border-2 transition-all hover:opacity-80
                                    ${q.src.large===ve||q.src.medium===ve?"border-primary shadow-sm":"border-transparent"}`,onClick:()=>ie(q.src.large||q.src.medium),children:q.type==="video"?a.jsxs("div",{className:"relative w-full h-full",children:[a.jsx("video",{src:q.src.medium||q.src.large,className:"w-full h-full object-cover",poster:((Ne=(be=v.image)==null?void 0:be.src)==null?void 0:Ne.medium)||`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(v.name)}`}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50",children:a.jsx(_2,{className:"h-8 w-8 text-white"})})]}):a.jsx("img",{src:q.src.medium||q.src.large,alt:q.alt||`Product image ${ne+1}`,className:"w-full h-full object-cover"})}),!d&&Me.length>1&&!q.src.medium.includes("via.placeholder.com")&&a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:Ge=>{Ge.stopPropagation(),Ae(q.id)},"aria-label":"Delete image",children:a.jsx(Fn,{className:"h-3 w-3"})})]},q.id||`gallery-${ne}`)})}),!d&&ve&&!ve.includes("via.placeholder.com")&&a.jsxs(O,{variant:"outline",size:"sm",className:"mt-3 w-full",onClick:Pe,disabled:de,children:[de?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Uie,{className:"mr-2 h-4 w-4"}),"Generate More Angles from Active Image"]})]})]}),a.jsxs(It.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"space-y-6",children:[a.jsx("h1",{className:"text-3xl lg:text-4xl font-bold tracking-tight text-foreground",children:v.name}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"flex items-center",children:[...Array(5)].map((q,ne)=>a.jsx(RI,{className:`h-5 w-5 ${ne<Math.floor(v.rating)?"text-amber-400 fill-amber-400":"text-muted-foreground/30"}`},ne))}),a.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",v.rating," reviews)"]}),a.jsx(Ys,{orientation:"vertical",className:"h-5"}),a.jsx(fg,{variant:"outline",style:{borderColor:g.theme.primaryColor,color:g.theme.primaryColor},children:sn>0?"In Stock":"Out of Stock"})]}),a.jsxs("p",{className:"text-2xl lg:text-3xl font-semibold",style:{color:g.theme.primaryColor},children:[cr," ",Sn.toFixed(2)]}),tn.length>0&&a.jsxs("div",{className:"space-y-4 pt-4",children:[tn.map(q=>a.jsxs("div",{children:[a.jsxs(je,{className:"text-sm font-medium text-foreground",children:[q.name,":",a.jsx("span",{className:"text-muted-foreground font-normal ml-1",children:T[q.name]||""})]}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:q.values.map(ne=>a.jsx(O,{variant:T[q.name]===ne?"default":"outline",size:"sm",onClick:()=>{j(be=>({...be,[q.name]:ne}))},style:T[q.name]===ne?{backgroundColor:$t,color:"white",borderColor:$t}:{borderColor:g.theme.secondaryColor||"#cccccc",color:g.theme.secondaryColor||"#333333"},children:ne},ne))})]},q.name)),tn.length>0&&Object.keys(T).length>0&&a.jsxs("div",{className:"mt-4 w-full",children:[cn&&Ue&&a.jsx("div",{className:"mb-3 flex justify-center",children:a.jsx(Vq,{itemOne:a.jsx(y1,{src:Ue,alt:"Original Image"}),itemTwo:a.jsx(y1,{src:cn,alt:"Visualized Variant"}),className:"w-full max-w-md h-auto aspect-square rounded-md border shadow-md"})}),a.jsxs(O,{onClick:Zn,disabled:yt,className:"w-full",variant:"outline",children:[yt?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(fa,{className:"mr-2 h-4 w-4"}),"Visualize Variant"]}),en&&a.jsx("p",{className:"text-red-500 text-xs mt-2",children:en})]})]}),a.jsx("div",{className:"prose prose-sm sm:prose dark:prose-invert max-w-none text-muted-foreground pt-4",children:a.jsx("p",{children:v.description})}),v.tags&&v.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:v.tags.map(q=>a.jsx(fg,{variant:"secondary",children:q},q))}),a.jsx(Ys,{className:"my-6"}),a.jsxs("div",{className:"flex items-end gap-4 pt-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(je,{htmlFor:"quantity",className:"text-sm",children:"Quantity"}),a.jsx(Je,{id:"quantity",type:"number",value:_,onChange:qe,min:"1",max:sn,className:"w-20 h-10 text-center",disabled:sn===0})]}),a.jsxs(O,{size:"lg",onClick:oe,className:"flex-1 h-10",style:{backgroundColor:$t,color:"white"},disabled:sn===0,children:[a.jsx($p,{className:"mr-2 h-5 w-5"}),ee?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,sn===0?"Out of Stock":ee?"Processing...":"Proceed to Checkout"]})]})]})]}),Be&&a.jsxs(It.div,{className:"mt-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 text-foreground",children:"3D Model"}),a.jsx(jje,{modelUrl:Be,thumbnailUrl:Ce,productName:v.name,height:"500px",className:"w-full"})]}),v&&g&&g.id&&a.jsx(It.div,{className:"mt-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.5},children:a.jsx(Rje,{product:v,storeId:g.id,isPublishedView:d})})]}),a.jsx(Lq,{store:g,isPublishedView:d}),!d&&a.jsxs(a.Fragment,{children:[a.jsx(Yr,{open:I,onOpenChange:N,children:a.jsxs(Vr,{className:"sm:max-w-2xl",children:[a.jsx(Ur,{children:a.jsx(Br,{children:"Change Product Image"})}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{placeholder:"Search Pexels or describe for AI...",value:k,onChange:q=>R(q.target.value)}),a.jsxs(O,{onClick:_e,disabled:z||!k.trim(),children:[z&&D.length===0?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(Oie,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Pexels"})]}),a.jsxs(O,{onClick:ze,variant:"outline",disabled:z||!k.trim(),children:[z&&D.length>0?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(fa,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Gemini"})]}),a.jsxs(O,{variant:"outline",onClick:()=>{var q;return(q=document.getElementById("upload-image-input"))==null?void 0:q.click()},disabled:z,children:[a.jsx(Lo,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Upload"})]}),a.jsx(Je,{type:"file",id:"upload-image-input",className:"hidden",accept:"image/*",onChange:Te})]}),z&&D.length===0&&a.jsx("p",{className:"text-center text-sm text-muted-foreground",children:"Searching for images or processing upload..."}),D.length>0&&a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-80 overflow-y-auto",children:D.map(q=>a.jsxs(It.div,{className:"relative aspect-square rounded-md overflow-hidden cursor-pointer group border-2 border-transparent hover:border-primary transition-all",onClick:()=>xt(q),whileHover:{scale:1.05},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},children:[a.jsx("img",{src:q.src.medium,alt:q.alt||"Search result",className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(Uje,{className:"h-8 w-8 text-white"})}),a.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/70 text-white text-xs p-1 truncate",children:q.photographer||q.alt})]},q.id))})]}),a.jsx(Ar,{children:a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",children:"Cancel"})})})]})}),H&&a.jsx(ProductEditModal,{isOpen:G,onClose:()=>Y(!1),product:H,onSave:async q=>{if(!g||!v)return;const ne=g.products.map(be=>be.id===q.id?{...be,...q}:be);await o(g.id,{products:ne}),w(q),h({title:"Product Updated",description:"Your product has been successfully updated."})},storeId:g.id}),v&&a.jsx(Aje,{open:Z,onOpenChange:ce,product:v,onVideoGenerated:Tt}),v&&a.jsx(kje,{open:Le,onOpenChange:Ve,product:v,onModelGenerated:wt,storeId:g==null?void 0:g.id})]})]})},Uje=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),Bje=BA("pk_live_51NAoUjDktew9heHOJD5Px4jn9IaolhvVvqoE6NukJV7MxZa8PhIVSwcOVWXdQx6MFNgIGmEYeg64lFUGlYfAyVqu004n16tAdG"),zje=()=>{var A,E,I,N,k,R;const t=Ca(),e=ti(),{getStoreById:n}=$n(),{toast:r}=as(),s=uf(),[i,o]=p.useState(null),[l,c]=p.useState("Your"),[u,d]=p.useState(null),[h,f]=p.useState(null),[m,g]=p.useState(!1),[x,v]=p.useState("");p.useEffect(()=>{const{stripePriceId:D,productName:M,productImage:z,quantity:B,unitAmount:G,currency:Y,storeId:H,storeName:K}=t.state||{};if(D&&M&&z&&B&&G&&Y&&H&&K){o({stripePriceId:D,name:M,image:z,quantity:parseInt(B,10),unitAmount:parseInt(G,10),currency:Y.toLowerCase()}),d(H),c(K);const $=n(H);f($)}else r({title:"Checkout Error",description:"Missing product information for checkout. Redirecting...",variant:"destructive"}),e("/")},[t.state,e,r,n]);const w=i?i.unitAmount/100*i.quantity:0,_=w>0?5:0,C=w*.08,T=w+_+C,j=async D=>{if(D.preventDefault(),!i||!x.trim()){r({title:"Missing Information",description:"Please enter your email address.",variant:"destructive"});return}g(!0);try{const z=await mc(s,"createStripeCheckoutSession")({priceId:i.stripePriceId,quantity:i.quantity,customerEmail:x,successUrl:`${window.location.origin}/order-confirmation?session_id={CHECKOUT_SESSION_ID}&storeId=${u}`,cancelUrl:`${window.location.origin}/checkout?storeId=${u}&canceled=true`}),{sessionId:B,error:G}=z.data;if(G)throw new Error(G.message||"Failed to create checkout session.");if(!B)throw new Error("Checkout session ID not received.");const Y=await Bje,{error:H}=await Y.redirectToCheckout({sessionId:B});H&&(console.error("Stripe redirect error:",H),r({title:"Payment Error",description:H.message,variant:"destructive"}),g(!1))}catch(M){console.error("Error creating Stripe Checkout session:",M),r({title:"Checkout Failed",description:M.message||"Could not initiate payment.",variant:"destructive"}),g(!1)}};return!i&&!m?a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-900 dark:to-slate-900",children:[a.jsx(F3,{className:"h-24 w-24 text-primary mb-6"}),a.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Your Cart is Empty"}),a.jsx("p",{className:"text-muted-foreground mb-8",children:"There's nothing to check out yet."}),a.jsx(O,{asChild:!0,children:a.jsxs(zn,{to:u?`/preview/${u}`:"/",children:[a.jsx(Wi,{className:"mr-2 h-4 w-4"})," Continue Shopping"]})})]}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-gray-800 dark:to-slate-800 py-8 px-4",children:a.jsxs(It.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"container mx-auto max-w-4xl",children:[a.jsxs(O,{variant:"ghost",onClick:()=>e(u?`/preview/${u}`:"/"),className:"mb-6 text-primary hover:text-primary/80",children:[a.jsx(Wi,{className:"mr-2 h-4 w-4"})," Back to ",l]}),a.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-center mb-8 text-gray-800 dark:text-gray-100",children:"Checkout"}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[a.jsxs(Qe,{className:"md:col-span-1 h-fit sticky top-8 shadow-lg",children:[a.jsxs(lt,{children:[a.jsx(ct,{className:"text-xl",children:"Order Summary"}),a.jsxs(Qt,{children:["Review your item from ",l,"."]})]}),a.jsxs(it,{className:"space-y-4",children:[i&&a.jsxs("div",{className:"flex justify-between items-center text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:((E=(A=i.image)==null?void 0:A.src)==null?void 0:E.tiny)||((I=i.image)==null?void 0:I.medium)||((N=i.image)==null?void 0:N.large)||`https://via.placeholder.com/40x40.png?text=${(k=i.name)==null?void 0:k.substring(0,1)}`,alt:i.name,className:"w-10 h-10 rounded object-cover"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium line-clamp-1",children:i.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Qty: ",i.quantity]})]})]}),a.jsxs("p",{className:"font-medium",children:["$",(i.unitAmount/100*i.quantity).toFixed(2)]})]}),a.jsx(Ys,{}),a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Subtotal:"}),a.jsxs("span",{children:["$",w.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Shipping:"}),a.jsxs("span",{children:["$",_.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Taxes (est.):"}),a.jsxs("span",{children:["$",C.toFixed(2)]})]})]}),a.jsx(Ys,{}),a.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{children:["$",T.toFixed(2)]})]})]})]}),a.jsxs("form",{onSubmit:j,className:"md:col-span-2 space-y-6",children:[a.jsxs(Qe,{className:"shadow-lg",children:[a.jsx(lt,{children:a.jsx(ct,{className:"text-xl",children:"Contact Information"})}),a.jsx(it,{className:"grid grid-cols-1 gap-4",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx(je,{htmlFor:"email",children:"Email Address"}),a.jsx(Je,{id:"email",name:"email",type:"email",placeholder:"you@example.com",value:x,onChange:D=>v(D.target.value),required:!0})]})})]}),a.jsxs(O,{type:"submit",size:"lg",className:"w-full text-lg",disabled:m||!x.trim(),style:{backgroundColor:((R=h==null?void 0:h.theme)==null?void 0:R.primaryColor)||"#3B82F6"},children:[m?a.jsx(ft,{className:"mr-2 h-5 w-5 animate-spin"}):a.jsx(ro,{className:"mr-2 h-5 w-5"}),m?"Processing Payment...":`Pay $${T.toFixed(2)}`]})]})]})]})})},Gje="https://static.wixstatic.com/media/bd2e29_20f2a8a94b7e492a9d76e0b8b14e623b~mv2.png",Wje="https://static.wixstatic.com/media/bd2e29_c6677c7824044124b64fe765d0e9b88d~mv2.png";function Hje(){const[t,e]=p.useState(!0),[n,r]=p.useState(""),[s,i]=p.useState(!1),o=p.useRef(),l=p.useRef(),c=ti();p.useEffect(()=>{const h=localStorage.getItem("theme"),f=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;h==="dark"||!h&&f?(document.documentElement.classList.add("dark"),i(!0)):(document.documentElement.classList.remove("dark"),i(!1))},[]);const u=async h=>{r("");const f=o.current.value,m=l.current.value;if(!f||!m){r("Please enter both email and password.");return}try{let g;h==="login"?g=await Rge(fp,f,m):(g=await jge(fp,f,m),await dp(ki(nr,"profiles",g.user.uid),{id:g.user.uid,email:g.user.email,role:"store_owner",created_at:new Date})),c("/")}catch(g){console.error("Authentication error (Email/Password):",g.message),r(g.message)}},d=async()=>{r("");const h=new Oa;try{const m=(await rye(fp,h)).user,g=ki(nr,"profiles",m.uid);(await P0e(g)).exists()||await dp(g,{id:m.uid,email:m.email,displayName:m.displayName,photoURL:m.photoURL,role:"store_owner",created_at:new Date}),c("/")}catch(f){console.error("Google Sign-In error:",f.message),f.code==="auth/popup-closed-by-user"?r("Google Sign-In was cancelled. Please try again."):f.code==="auth/account-exists-with-different-credential"?r("An account already exists with the same email address but different sign-in credentials. Try signing in with your original method."):r(`Google Sign-In failed: ${f.message}`)}};return a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-cover bg-center bg-no-repeat p-4",style:{backgroundImage:`url(${Wje})`},children:a.jsxs("div",{className:`w-full max-w-md p-8 md:p-10 space-y-6
                   bg-white/10 dark:bg-black/30 backdrop-blur-lg
                   shadow-2xl rounded-xl border border-white/20 dark:border-black/20`,children:[a.jsx("div",{className:"flex justify-center mb-6",children:a.jsx("img",{src:Gje,alt:"FreshFront Logo",className:"h-12 w-auto"})}),a.jsx("h2",{className:"text-center text-3xl font-extrabold text-white mb-6",children:t?"Sign In":"Sign Up"}),n&&a.jsx("p",{className:"text-red-500 text-center",children:n}),a.jsxs("form",{onSubmit:h=>{h.preventDefault(),u(t?"login":"signup")},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-white mb-1",children:"Email"}),a.jsx("input",{type:"email",id:"email",ref:o,required:!0,className:"w-full p-3 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"you@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-white mb-1",children:"Password"}),a.jsx("input",{type:"password",id:"password",ref:l,required:!0,className:"w-full p-3 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"••••••••"})]}),a.jsx("button",{type:"submit",className:"w-full bg-black text-white py-3 rounded-md font-semibold hover:bg-gray-800 transition-colors",children:t?"Sign In":"Sign Up"})]}),a.jsxs("div",{className:"relative my-6",children:[a.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:a.jsx("div",{className:"w-full border-t border-white/30"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-2 bg-white/10 dark:bg-black/30 text-white rounded-md",children:"Or continue with"})})]}),a.jsx("div",{children:a.jsxs("button",{type:"button",onClick:d,className:"w-full flex items-center justify-center gap-2 bg-white/90 dark:bg-white/10 text-black dark:text-white py-3 rounded-md font-semibold hover:bg-white dark:hover:bg-white/20 transition-colors border border-white/20",children:[a.jsx("svg",{className:"w-5 h-5","aria-hidden":"true",focusable:"false",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 18",children:a.jsxs("g",{fill:"none","fill-rule":"evenodd",children:[a.jsx("path",{d:"M17.64 9.2045c0-.6381-.0573-1.2518-.1636-1.8409H9v3.4818h4.8436c-.2086 1.125-.8427 2.0782-1.7777 2.7218v2.2582h2.9082c1.7018-1.5668 2.6836-3.8741 2.6836-6.621Z",fill:"#4285F4"}),a.jsx("path",{d:"M9 18c2.43 0 4.4673-.8055 5.9564-2.1818l-2.9082-2.2582c-.8055.5436-1.8368.8618-2.9945.8618-2.3127 0-4.2609-1.5668-4.9582-3.6709H1.0718v2.3318C2.5564 16.1632 5.5218 18 9 18Z",fill:"#34A853"}),a.jsx("path",{d:"M4.0418 10.7318c-.1164-.3464-.18-.7173-.18-1.0909 0-.3736.0636-.7445.18-1.0909V6.2182H1.0718C.3859 7.5614 0 9.0182 0 10.6409s.3859 3.0795 1.0718 4.4227l2.97-2.3318Z",fill:"#FBBC05"}),a.jsx("path",{d:"M9 3.5818c1.3218 0 2.5077.4559 3.4405 1.3468l2.5818-2.5818C13.4632.9918 11.43 0 9 0 5.5218 0 2.5564 1.8368 1.0718 4.5727l2.97 2.3318C4.7391 4.9855 6.6873 3.5818 9 3.5818Z",fill:"#EA4335"})]})}),t?"Sign in with Google":"Sign up with Google"]})}),a.jsxs("p",{className:"text-center text-sm text-white pt-4",children:[t?"Don't have an account?":"Already have an account?"," ",a.jsx("button",{onClick:()=>e(!t),className:"text-white hover:underline font-medium",children:t?"Sign Up":"Sign In"})]})]})})}const qje=()=>{const{isAuthenticated:t,user:e}=Ia();return a.jsxs(a.Fragment,{children:[a.jsx(YW,{}),a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Our Plan"}),a.jsx("p",{children:"Get full access to all store creation and management features."}),a.jsxs("div",{style:{border:"1px solid #ccc",padding:"20px",margin:"20px auto",maxWidth:"400px",borderRadius:"8px"},children:[a.jsx("h2",{children:"Store Creator Plan"}),a.jsx("p",{style:{fontSize:"2em",fontWeight:"bold",margin:"10px 0"},children:"$24.99 / month"}),a.jsxs("ul",{children:[a.jsx("li",{children:"Full access to publishing"}),a.jsx("li",{children:"Accept payments for your store"}),a.jsx("li",{children:"Unlimited products"}),a.jsx("li",{children:"And more!"})]}),t?a.jsx(s1,{}):a.jsxs("p",{children:["Please ",a.jsx(zn,{to:"/auth",children:"log in or sign up"})," to subscribe."]})]})]})]})};function Kje(){return new URLSearchParams(Ca().search)}const Yje=()=>{const e=Kje().get("session_id");p.useState(null);const[n,r]=p.useState(!0),[s,i]=p.useState(null);return p.useEffect(()=>{if(!e){i("No session ID found. Your order might still be processing."),r(!1);return}r(!1)},[e]),n?a.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"Loading order details..."}):s?a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Order Status"}),a.jsx("p",{style:{color:"red"},children:s}),a.jsx(zn,{to:"/",children:"Go to Homepage"})]}):a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Thank You for Your Order!"}),a.jsx("p",{children:"Your payment was successful and your order is being processed."}),a.jsxs("p",{children:["Order (Session ID): ",e]}),a.jsx("p",{children:"You will receive an email confirmation shortly."}),a.jsx(zn,{to:"/",children:"Continue Shopping"})]})},Jje=()=>{const{isGenerating:t,progress:e,statusMessage:n}=$n();return a.jsx(Sc,{children:t&&a.jsx(It.div,{initial:{y:"-100%",opacity:0},animate:{y:"20px",opacity:1},exit:{y:"-100%",opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"fixed top-0 left-0 right-0 flex justify-center z-[9999] p-4",children:a.jsxs(Qe,{className:"shadow-2xl rounded-xl overflow-hidden w-full max-w-md",children:[" ",a.jsxs(it,{className:"p-6 space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Store Generation"}),a.jsxs("p",{className:"text-sm font-semibold text-blue-600 dark:text-blue-400",children:[Math.floor(e),"%"]})]}),a.jsx($a,{value:e,className:"w-full h-2 [&>div]:bg-blue-600"}),a.jsx("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 pt-1 min-h-[1.2em]",children:n||"Processing..."})]})]})})})},Qje=()=>a.jsxs(fEe,{children:[a.jsx(Jje,{})," ",a.jsxs("main",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-900 dark:to-slate-900",children:[a.jsx(AQ,{})," ",a.jsx(moe,{}),a.jsx(kq,{})," "]})]});const Xje=({children:t,activeTab:e,setActiveTab:n,storeId:r,storeName:s})=>{const[i,o]=p.useState(""),[l,c]=p.useState([]),u=[{id:"orders",label:"Orders",icon:a.jsx($p,{className:"h-5 w-5"})},{id:"products",label:"Products",icon:a.jsx(Li,{className:"h-5 w-5"})},{id:"customers",label:"Customers",icon:a.jsx(M0,{className:"h-5 w-5"})},{id:"payments",label:"Payments",icon:a.jsx(ro,{className:"h-5 w-5"})},{id:"analytics",label:"Analytics",icon:a.jsx(Xv,{className:"h-5 w-5"})},{id:"marketing",label:"Marketing",icon:a.jsx(ah,{className:"h-5 w-5"})},{id:"shipping",label:"Shipping",icon:a.jsx(nw,{className:"h-5 w-5"})},{id:"settings",label:"Settings",icon:a.jsx(Ch,{className:"h-5 w-5"})}],d=u.map(m=>({id:m.id,label:m.label,tab:m.id})),h=m=>{const g=m.target.value;if(o(g),g.trim()===""){c([]);return}const x=g.toLowerCase(),v=[];d.forEach(w=>{w.label.toLowerCase().includes(x)&&v.push({id:`${w.id}-main`,label:w.label,tab:w.tab}),w.subItems&&w.subItems.forEach(_=>{_.label.toLowerCase().includes(x)&&v.push({id:_.id,label:`${w.label} > ${_.label}`,tab:w.tab})})}),c(v)},f=m=>{n(m.tab),o(""),c([])};return a.jsxs("div",{className:"flex h-screen bg-muted/40",children:[" ",a.jsxs("div",{className:"w-64 bg-card border-r border-border flex flex-col",children:[" ",a.jsxs("div",{className:"p-4 border-b flex items-center gap-2",children:[" ",s&&a.jsx(O,{asChild:!0,variant:"outline",size:"icon",className:"flex-shrink-0",children:a.jsxs(zn,{to:`/${s}`,children:[" ",a.jsx(Wi,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Back to Store"})]})}),a.jsxs("div",{className:"relative flex-grow",children:[" ",a.jsx(Du,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),a.jsx(Je,{type:"text",placeholder:"Search dashboard...",className:"pl-9 w-full",value:i,onChange:h}),l.length>0&&a.jsxs(Qe,{className:"absolute mt-1 w-full z-50 max-h-64 overflow-y-auto shadow-lg",children:[" ",a.jsxs("div",{className:"p-1",children:[" ",l.map(m=>a.jsx("button",{className:"w-full text-left px-3 py-1.5 hover:bg-accent rounded-md text-sm",onClick:()=>f(m),children:m.label},m.id))]})]})]})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:[" ",u.map(m=>a.jsxs(O,{variant:e===m.id?"secondary":"ghost",className:"w-full justify-start text-left h-10 px-3",onClick:()=>n(m.id),children:[a.jsx("span",{className:"mr-3",children:m.icon})," ",m.label]},m.id))]}),a.jsx("div",{className:"p-4 border-t",children:a.jsx(O,{variant:"ghost",className:"w-full justify-start text-left",children:"Help & Support"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[" ",t]})]})},ZF=()=>{const[t,e]=p.useState("all"),n=[{id:"ORD-1234",customer:"John Doe",date:"2023-05-15",total:"$129.99",status:"Fulfilled"},{id:"ORD-1235",customer:"Jane Smith",date:"2023-05-14",total:"$89.50",status:"Processing"},{id:"ORD-1236",customer:"Robert Johnson",date:"2023-05-13",total:"$210.75",status:"Pending"}],r=[{id:"CART-567",customer:"Emily Davis",date:"2023-05-15",items:3,total:"$78.45",timeSpent:"12m 30s"},{id:"CART-568",customer:"Michael Brown",date:"2023-05-14",items:2,total:"$45.99",timeSpent:"5m 15s"}],s=[{id:"RET-890",orderId:"ORD-1230",customer:"Sarah Wilson",date:"2023-05-10",amount:"$65.00",reason:"Wrong size"},{id:"RET-891",orderId:"ORD-1228",customer:"David Miller",date:"2023-05-09",amount:"$120.50",reason:"Damaged item"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Orders"}),a.jsxs(_i,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ni,{className:"grid grid-cols-4 mb-6",children:[a.jsxs(Vt,{value:"all",children:[a.jsx($p,{className:"mr-2 h-4 w-4"}),"All Orders"]}),a.jsxs(Vt,{value:"abandoned",children:[a.jsx(Cg,{className:"mr-2 h-4 w-4"}),"Abandoned Checkouts"]}),a.jsxs(Vt,{value:"returns",children:[a.jsx(AE,{className:"mr-2 h-4 w-4"}),"Returns & Refunds"]}),a.jsxs(Vt,{value:"fulfillment",children:[a.jsx(Li,{className:"mr-2 h-4 w-4"}),"Order Fulfillment"]})]}),a.jsx(Ut,{value:"all",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"All Orders"}),a.jsx(Qt,{children:"View and manage all customer orders"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="Fulfilled"?"bg-green-100 text-green-800":i.status==="Processing"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:i.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View"})})]},i.id))})]})})})]})}),a.jsx(Ut,{value:"abandoned",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Abandoned Checkouts"}),a.jsx(Qt,{children:"View details of abandoned shopping carts"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Cart ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Items"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Time Spent"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.items}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:i.timeSpent}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View Details"})})]},i.id))})]})})})]})}),a.jsx(Ut,{value:"returns",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Returns & Refunds"}),a.jsx(Qt,{children:"Manage customer returns and process refunds"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Return ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.orderId}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.amount}),a.jsx("td",{className:"py-3 px-4",children:i.reason}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(O,{variant:"outline",size:"sm",children:"Process"})]})]},i.id))})]})})})]})}),a.jsx(Ut,{value:"fulfillment",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Order Fulfillment"}),a.jsx(Qt,{children:"Manage and fulfill pending orders"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Fraud Risk"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer Score"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="Fulfilled"?"bg-green-100 text-green-800":i.status==="Processing"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:i.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Low"})}),a.jsxs("td",{className:"py-3 px-4",children:[Math.floor(Math.random()*100),"/100"]}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(O,{variant:"default",size:"sm",disabled:i.status==="Fulfilled",children:"Fulfill"})]})]},i.id))})]})})})]})})]})]})},Zje=()=>{const[t,e]=p.useState("all"),n=[{id:"PRD-1234",name:"Premium T-Shirt",category:"Apparel",price:"$29.99",inventory:45,status:"Active"},{id:"PRD-1235",name:"Wireless Headphones",category:"Electronics",price:"$89.50",inventory:12,status:"Active"},{id:"PRD-1236",name:"Leather Wallet",category:"Accessories",price:"$49.99",inventory:0,status:"Out of Stock"}],r=[{id:"COL-567",name:"Summer Collection",products:12,type:"Manual",status:"Active"},{id:"COL-568",name:"Holiday Specials",products:8,type:"AI Generated",status:"Draft"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Products"}),a.jsxs(_i,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ni,{className:"grid grid-cols-3 mb-6",children:[a.jsxs(Vt,{value:"all",children:[a.jsx(Li,{className:"mr-2 h-4 w-4"}),"All Products"]}),a.jsxs(Vt,{value:"inventory",children:[a.jsx(Gm,{className:"mr-2 h-4 w-4"}),"Inventory"]}),a.jsxs(Vt,{value:"collections",children:[a.jsx(Y_,{className:"mr-2 h-4 w-4"}),"Collections"]})]}),a.jsx(Ut,{value:"all",children:a.jsxs(Qe,{children:[a.jsxs(lt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ct,{children:"All Products"}),a.jsx(Qt,{children:"Manage your product catalog"})]}),a.jsxs(O,{children:[a.jsx(Li,{className:"mr-2 h-4 w-4"}),"Add Product"]})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"mb-4 flex items-center",children:[a.jsx(Je,{placeholder:"Search products...",className:"max-w-sm mr-2"}),a.jsx(O,{variant:"outline",children:"Search"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Category"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Price"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Inventory"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.category}),a.jsx("td",{className:"py-3 px-4",children:s.price}),a.jsx("td",{className:"py-3 px-4",children:s.inventory}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(O,{variant:"outline",size:"sm",children:"Delete"})]})]},s.id))})]})})]})]})}),a.jsx(Ut,{value:"inventory",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Inventory Management"}),a.jsx(Qt,{children:"Track and update product inventory levels"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Current Stock"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Low Stock Alert"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.inventory}),a.jsx("td",{className:"py-3 px-4",children:"10"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.inventory>10?"bg-green-100 text-green-800":s.inventory>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.inventory>10?"In Stock":s.inventory>0?"Low Stock":"Out of Stock"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Update Stock"})})]},s.id))})]})})})]})}),a.jsx(Ut,{value:"collections",children:a.jsxs(Qe,{children:[a.jsxs(lt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ct,{children:"Collections"}),a.jsx(Qt,{children:"Organize products into collections"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(Y_,{className:"mr-2 h-4 w-4"}),"Create Manual Collection"]}),a.jsxs(O,{children:[a.jsx(Y_,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Collection Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Products"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.products}),a.jsx("td",{className:"py-3 px-4",children:s.type}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(O,{variant:"outline",size:"sm",children:"Delete"})]})]},s.id))})]})})})]})})]})]})},eRe=()=>{const t=[{id:"CUS-1234",name:"John Doe",email:"john.doe@example.com",orders:5,totalSpent:"$345.75",lastOrder:"2023-05-10",segment:"Loyal"},{id:"CUS-1235",name:"Jane Smith",email:"jane.smith@example.com",orders:2,totalSpent:"$129.50",lastOrder:"2023-04-22",segment:"New"},{id:"CUS-1236",name:"Robert Johnson",email:"robert.j@example.com",orders:8,totalSpent:"$780.25",lastOrder:"2023-05-15",segment:"VIP"}],e=[{id:"SEG-1",name:"New Customers",count:124,description:"Customers with 1-2 orders"},{id:"SEG-2",name:"Loyal Customers",count:86,description:"Customers with 3-7 orders"},{id:"SEG-3",name:"VIP Customers",count:32,description:"Customers with 8+ orders"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Customers"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:e.map(n=>a.jsxs(Qe,{children:[a.jsxs(lt,{className:"pb-2",children:[a.jsx(ct,{className:"text-lg",children:n.name}),a.jsx(Qt,{children:n.description})]}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:n.count}),a.jsx(O,{variant:"link",className:"p-0",children:"View customers"})]})]},n.id))}),a.jsxs(Qe,{className:"mb-6",children:[a.jsxs(lt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ct,{children:"Customer Insights"}),a.jsx(Qt,{children:"AI-generated insights about your customer base"})]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Xie,{className:"mr-2 h-4 w-4"}),"Generate New Insights"]})]}),a.jsx(it,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Demographics"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-card rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Demographics chart placeholder"})}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Your customer base is primarily 25-34 years old (45%), followed by 35-44 years old (30%). The gender distribution is 55% female and 45% male."})]}),a.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Geographic Distribution"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-card rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Geographic map placeholder"})}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Most of your customers are from California (25%), New York (18%), and Texas (12%). International customers make up 15% of your customer base."})]})]})})]}),a.jsxs(Qe,{children:[a.jsxs(lt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ct,{children:"All Customers"}),a.jsx(Qt,{children:"View and manage your customer database"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(Gm,{className:"mr-2 h-4 w-4"}),"Add Tags"]}),a.jsxs(O,{children:[a.jsx(M0,{className:"mr-2 h-4 w-4"}),"Create Segment"]})]})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"mb-4 flex items-center",children:[a.jsx(Je,{placeholder:"Search customers...",className:"max-w-sm mr-2"}),a.jsx(O,{variant:"outline",children:"Search"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Email"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Orders"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total Spent"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Last Order"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Segment"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:t.map(n=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:n.id}),a.jsx("td",{className:"py-3 px-4",children:n.name}),a.jsx("td",{className:"py-3 px-4",children:n.email}),a.jsx("td",{className:"py-3 px-4",children:n.orders}),a.jsx("td",{className:"py-3 px-4",children:n.totalSpent}),a.jsx("td",{className:"py-3 px-4",children:n.lastOrder}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${n.segment==="VIP"?"bg-purple-100 text-purple-800":n.segment==="Loyal"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:n.segment})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View Profile"})})]},n.id))})]})})]})]})]})},tRe=()=>{const[t,e]=p.useState("transactions"),{session:n,user:r}=Ia(),[s,i]=p.useState(!1),[o,l]=p.useState(null),c=async()=>{if(!(n!=null&&n.access_token)||!r){l("Authentication token not found. Please log in again.");return}i(!0),l(null);try{const f=await fetch(`${{}.VITE_SUPABASE_URL}/functions/v1/create-stripe-connect-account`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n.access_token}`},body:JSON.stringify({record:{id:r.id,email:r.email}})}),m=await f.json();if(!f.ok){const g=m.error||m.data&&m.data.error||"Failed to create Stripe Connect account link.";throw new Error(g)}if(m.account_link_url)window.location.href=m.account_link_url;else if(m.url)window.location.href=m.url;else throw new Error("No URL returned from Stripe Connect account creation.")}catch(f){console.error("Stripe Connect account creation error:",f),l(f.message)}finally{i(!1)}},u=[{id:"TRX-1234",orderId:"ORD-1234",customer:"John Doe",date:"2023-05-15",amount:"$129.99",status:"Completed",method:"Credit Card"},{id:"TRX-1235",orderId:"ORD-1235",customer:"Jane Smith",date:"2023-05-14",amount:"$89.50",status:"Completed",method:"PayPal"},{id:"TRX-1236",orderId:"ORD-1236",customer:"Robert Johnson",date:"2023-05-13",amount:"$210.75",status:"Pending",method:"Credit Card"}],d=[{id:"PAY-567",date:"2023-05-15",amount:"$1,245.75",status:"Completed",destination:"Bank Account (****1234)"},{id:"PAY-568",date:"2023-05-01",amount:"$980.50",status:"Completed",destination:"Bank Account (****1234)"},{id:"PAY-569",scheduledDate:"2023-06-01",estimatedAmount:"$1,500.00",status:"Scheduled",destination:"Bank Account (****1234)"}],h=[{id:"DSP-890",transactionId:"TRX-1230",customer:"Sarah Wilson",date:"2023-05-10",amount:"$65.00",reason:"Item not received",status:"Under Review"},{id:"DSP-891",transactionId:"TRX-1228",customer:"David Miller",date:"2023-05-09",amount:"$120.50",reason:"Unauthorized charge",status:"Lost"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Payments & Payouts"}),a.jsxs(_i,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ni,{className:"grid grid-cols-4 mb-6",children:[" ",a.jsxs(Vt,{value:"overview",children:[" ",a.jsx(Yl,{className:"mr-2 h-4 w-4"}),"Connect Account"]}),a.jsxs(Vt,{value:"transactions",children:[a.jsx(ro,{className:"mr-2 h-4 w-4"}),"Transactions"]}),a.jsxs(Vt,{value:"payouts",children:[a.jsx(PI,{className:"mr-2 h-4 w-4"}),"Payout Schedule"]}),a.jsxs(Vt,{value:"disputes",children:[a.jsx(Cg,{className:"mr-2 h-4 w-4"}),"Disputes & Chargebacks"]})]}),a.jsxs(Ut,{value:"overview",children:[" ",a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Connect Stripe Account"}),a.jsx(Qt,{children:"Connect your Stripe account to start accepting payments and manage payouts."})]}),a.jsxs(it,{children:[a.jsxs(O,{onClick:c,disabled:s,children:[a.jsx(Yl,{className:"mr-2 h-4 w-4"}),s?"Connecting...":"Connect with Stripe"]}),o&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:o})]})]})]}),a.jsx(Ut,{value:"transactions",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"All Transactions"}),a.jsx(Qt,{children:"View all payment transactions"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Transaction ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Method"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:u.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.orderId}),a.jsx("td",{className:"py-3 px-4",children:f.customer}),a.jsx("td",{className:"py-3 px-4",children:f.date}),a.jsx("td",{className:"py-3 px-4",children:f.amount}),a.jsx("td",{className:"py-3 px-4",children:f.method}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View Details"})})]},f.id))})]})})})]})}),a.jsx(Ut,{value:"payouts",children:a.jsxs(Qe,{className:"mb-6",children:[a.jsxs(lt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ct,{children:"Payout Schedule"}),a.jsx(Qt,{children:"Manage your payout schedule and instant transfers"})]}),a.jsxs(O,{children:[a.jsx(ro,{className:"mr-2 h-4 w-4"}),"Instant Transfer"]})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Current Balance"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$1,845.75"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Available for payout"})]})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Next Payout"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$1,500.00"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Scheduled for June 1, 2023"})]})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Payout Schedule"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-xl font-medium",children:"Monthly"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Every 1st of the month"}),a.jsx(O,{variant:"link",className:"p-0 mt-2",children:"Change schedule"})]})]})]}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Payout History"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Payout ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Destination"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:d.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.date||f.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:f.amount||f.estimatedAmount}),a.jsx("td",{className:"py-3 px-4",children:f.destination}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Completed"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View Details"})})]},f.id))})]})]})]})]})}),a.jsx(Ut,{value:"disputes",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Disputes & Chargebacks"}),a.jsx(Qt,{children:"Manage payment disputes and chargebacks"})]}),a.jsx(it,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Dispute ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Transaction ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"AI Analysis"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:h.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.transactionId}),a.jsx("td",{className:"py-3 px-4",children:f.customer}),a.jsx("td",{className:"py-3 px-4",children:f.date}),a.jsx("td",{className:"py-3 px-4",children:f.amount}),a.jsx("td",{className:"py-3 px-4",children:f.reason}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Under Review"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:f.status==="Under Review"?a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"High chance of winning"}):a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"Insufficient evidence"})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),f.status==="Under Review"&&a.jsx(O,{variant:"default",size:"sm",children:"Respond"})]})]},f.id))})]})})})]})})]})]})},nRe=()=>{const[t,e]=p.useState("sales");return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Analytics & Reports"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Total Sales"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$12,845.75"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(Qf,{className:"h-4 w-4 mr-1"})," +15% from last month"]})]})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Orders"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"156"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(Qf,{className:"h-4 w-4 mr-1"})," +8% from last month"]})]})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Conversion Rate"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"3.2%"}),a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(Qf,{className:"h-4 w-4 mr-1"})," -0.5% from last month"]})]})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Avg. Order Value"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$82.34"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(Qf,{className:"h-4 w-4 mr-1"})," +5% from last month"]})]})]})]}),a.jsxs(_i,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ni,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(Vt,{value:"sales",children:[a.jsx(Xv,{className:"mr-2 h-4 w-4"}),"Sales Reports"]}),a.jsxs(Vt,{value:"traffic",children:[a.jsx(Qf,{className:"mr-2 h-4 w-4"}),"Traffic & Conversion"]}),a.jsxs(Vt,{value:"customers",children:[a.jsx(M0,{className:"mr-2 h-4 w-4"}),"Customer Insights"]}),a.jsxs(Vt,{value:"marketing",children:[a.jsx(O3,{className:"mr-2 h-4 w-4"}),"Marketing Attribution"]}),a.jsxs(Vt,{value:"products",children:[a.jsx(Li,{className:"mr-2 h-4 w-4"}),"Product Performance"]})]}),a.jsx(Ut,{value:"sales",children:a.jsxs(Qe,{children:[a.jsxs(lt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ct,{children:"Sales Overview"}),a.jsx(Qt,{children:"Comprehensive sales data with AI summarization"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(O,{variant:"outline",children:"Export"}),a.jsx(O,{variant:"outline",children:"Print"})]})]}),a.jsxs(it,{children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"h-80 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Sales chart placeholder"})})}),a.jsxs(Qe,{className:"bg-muted/30",children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"AI Sales Summary"})}),a.jsxs(it,{children:[a.jsxs("p",{className:"text-sm",children:[a.jsx("strong",{children:"Key Insights:"}),' Your sales have increased by 15% compared to last month, with the highest growth in the "Electronics" category (+24%). Weekend sales are particularly strong, accounting for 45% of your weekly revenue. The average order value has increased by 5%, indicating customers are purchasing higher-value items.']}),a.jsxs("p",{className:"text-sm mt-2",children:[a.jsx("strong",{children:"Recommendations:"}),' Consider running promotions on weekdays to boost sales during slower periods. The "Apparel" category has seen a slight decline (-3%) and may benefit from new product additions or targeted marketing.']})]})]})]})]})}),a.jsx(Ut,{value:"traffic",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Traffic & Conversion Analysis"}),a.jsx(Qt,{children:"Website traffic sources and conversion rates"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Traffic Sources"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Traffic sources chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Conversion Funnel"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Conversion funnel chart placeholder"})})]})]}),a.jsxs(Qe,{className:"bg-muted/30",children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"AI Conversion Recommendations"})}),a.jsxs(it,{children:[a.jsx("p",{className:"text-sm",children:"Your current conversion rate of 3.2% is below the industry average of 4.5% for e-commerce stores in your category. The biggest drop-off occurs at the checkout page (45% abandonment rate)."}),a.jsx("p",{className:"text-sm mt-2",children:a.jsx("strong",{children:"Recommendations:"})}),a.jsxs("ul",{className:"text-sm list-disc pl-5 mt-1",children:[a.jsx("li",{children:"Simplify your checkout process by reducing the number of form fields"}),a.jsx("li",{children:"Add trust badges and security indicators near payment information"}),a.jsx("li",{children:"Implement exit-intent popups with discount offers to reduce cart abandonment"}),a.jsx("li",{children:"Optimize product page load times (currently averaging 3.2s, aim for under 2s)"})]})]})]})]})]})}),a.jsx(Ut,{value:"customers",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Customer Insights"}),a.jsx(Qt,{children:"Detailed analysis of customer behavior and demographics"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Customer Demographics"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Demographics chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Purchase Frequency"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Purchase frequency chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Customer Lifetime Value"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"CLV chart placeholder"})})]})]}),a.jsxs(Qe,{className:"bg-muted/30",children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Customer Personas"})}),a.jsx(it,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Tech-Savvy Millennials"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"25-34 years old, urban areas, high income"}),a.jsx("p",{className:"text-sm mt-2",children:"Prefer electronics and premium products, shop primarily on mobile devices"})]}),a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Budget-Conscious Families"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"35-44 years old, suburban areas, middle income"}),a.jsx("p",{className:"text-sm mt-2",children:"Focus on value, frequently use discount codes, buy in bulk"})]}),a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Luxury Shoppers"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"45-60 years old, various locations, high income"}),a.jsx("p",{className:"text-sm mt-2",children:"Purchase high-end products, less price sensitive, value quality and service"})]})]})})]})]})]})}),a.jsx(Ut,{value:"marketing",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Marketing Attribution"}),a.jsx(Qt,{children:"Track the effectiveness of your marketing channels"})]}),a.jsxs(it,{children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"h-80 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Marketing attribution chart placeholder"})})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Channel"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Sessions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conversions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conv. Rate"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"ROAS"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Organic Search"}),a.jsx("td",{className:"py-3 px-4",children:"2,456"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:"4.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$7,845.00"}),a.jsx("td",{className:"py-3 px-4",children:"N/A"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Paid Search"}),a.jsx("td",{className:"py-3 px-4",children:"1,245"}),a.jsx("td",{className:"py-3 px-4",children:"62"}),a.jsx("td",{className:"py-3 px-4",children:"5.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$4,980.00"}),a.jsx("td",{className:"py-3 px-4",children:"3.2x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Social Media"}),a.jsx("td",{className:"py-3 px-4",children:"3,120"}),a.jsx("td",{className:"py-3 px-4",children:"78"}),a.jsx("td",{className:"py-3 px-4",children:"2.5%"}),a.jsx("td",{className:"py-3 px-4",children:"$5,460.00"}),a.jsx("td",{className:"py-3 px-4",children:"2.8x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Email Marketing"}),a.jsx("td",{className:"py-3 px-4",children:"980"}),a.jsx("td",{className:"py-3 px-4",children:"49"}),a.jsx("td",{className:"py-3 px-4",children:"5.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$3,920.00"}),a.jsx("td",{className:"py-3 px-4",children:"4.5x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Direct"}),a.jsx("td",{className:"py-3 px-4",children:"1,560"}),a.jsx("td",{className:"py-3 px-4",children:"47"}),a.jsx("td",{className:"py-3 px-4",children:"3.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$3,760.00"}),a.jsx("td",{className:"py-3 px-4",children:"N/A"})]})]})]})})]})]})}),a.jsx(Ut,{value:"products",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Product Performance"}),a.jsx(Qt,{children:"Detailed analysis of product sales and performance"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Top Selling Products"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Top products chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Product Category Performance"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Category performance chart placeholder"})})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Category"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Units Sold"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Profit Margin"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Return Rate"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Rating"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Premium T-Shirt"}),a.jsx("td",{className:"py-3 px-4",children:"Apparel"}),a.jsx("td",{className:"py-3 px-4",children:"245"}),a.jsx("td",{className:"py-3 px-4",children:"$7,345.55"}),a.jsx("td",{className:"py-3 px-4",children:"45%"}),a.jsx("td",{className:"py-3 px-4",children:"2.1%"}),a.jsx("td",{className:"py-3 px-4",children:"4.8/5"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Wireless Headphones"}),a.jsx("td",{className:"py-3 px-4",children:"Electronics"}),a.jsx("td",{className:"py-3 px-4",children:"124"}),a.jsx("td",{className:"py-3 px-4",children:"$11,098.00"}),a.jsx("td",{className:"py-3 px-4",children:"32%"}),a.jsx("td",{className:"py-3 px-4",children:"3.5%"}),a.jsx("td",{className:"py-3 px-4",children:"4.6/5"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Leather Wallet"}),a.jsx("td",{className:"py-3 px-4",children:"Accessories"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:"$4,899.02"}),a.jsx("td",{className:"py-3 px-4",children:"55%"}),a.jsx("td",{className:"py-3 px-4",children:"1.2%"}),a.jsx("td",{className:"py-3 px-4",children:"4.9/5"})]})]})]})})]})]})})]})]})},rRe=()=>{const[t,e]=p.useState("email"),n=[{id:"EM-1234",name:"Summer Sale Announcement",status:"Sent",sentDate:"2023-05-15",opens:1245,clicks:356,conversions:28,revenue:"$2,450"},{id:"EM-1235",name:"New Product Launch",status:"Draft",lastEdited:"2023-05-14"},{id:"EM-1236",name:"Customer Feedback Request",status:"Scheduled",scheduledDate:"2023-05-20"},{id:"EM-1237",name:"Abandoned Cart Recovery",status:"Sent",sentDate:"2023-05-12",opens:876,clicks:234,conversions:15,revenue:"$1,280"}],r=[{id:"SM-567",platform:"Instagram",content:"Summer collection now available!",status:"Published",publishDate:"2023-05-15",engagement:245,likes:189,comments:32},{id:"SM-568",platform:"Facebook",content:"Limited time offer: 20% off all accessories",status:"Scheduled",scheduledDate:"2023-05-18"},{id:"SM-569",platform:"Twitter",content:"Flash sale today only! Use code FLASH25",status:"Published",publishDate:"2023-05-14",engagement:178,likes:45,comments:12},{id:"SM-570",platform:"TikTok",content:"Behind the scenes of our latest photoshoot",status:"Draft",lastEdited:"2023-05-16"}],s=[{id:"BLG-890",title:"10 Summer Fashion Trends",status:"Published",publishDate:"2023-05-10",views:1245,comments:23,shares:56},{id:"BLG-891",title:"How to Choose the Perfect Headphones",status:"Draft",lastEdited:"2023-05-14"},{id:"BLG-892",title:"Sustainable Fashion: Our Commitment",status:"Published",publishDate:"2023-05-05",views:980,comments:18,shares:42},{id:"BLG-893",title:"Gift Guide: Father's Day Edition",status:"Scheduled",scheduledDate:"2023-05-25"}],i=[{id:"PROMO-123",name:"Summer Sale",type:"Discount",value:"20% off",status:"Active",startDate:"2023-05-01",endDate:"2023-05-31",usageCount:245},{id:"PROMO-124",name:"Free Shipping",type:"Free Shipping",value:"Orders over $50",status:"Active",startDate:"2023-05-01",endDate:"2023-06-30",usageCount:189},{id:"PROMO-125",name:"WELCOME10",type:"Discount",value:"10% off first order",status:"Active",startDate:"2023-01-01",endDate:"2023-12-31",usageCount:567},{id:"PROMO-126",name:"Holiday Bundle",type:"Bundle",value:"Buy 2 Get 1 Free",status:"Draft",startDate:"2023-11-15",endDate:"2023-12-25"}];return a.jsxs("div",{className:"bg-background",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Marketing"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(O,{variant:"outline",size:"sm",children:[a.jsx(PI,{className:"h-4 w-4 mr-2"}),"Content Calendar"]}),a.jsxs(O,{size:"sm",children:[a.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Create Campaign"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Email Performance"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"24.5%"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Average open rate"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+2.3% from last month"})]})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Social Engagement"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"1,245"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Total interactions"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+15% from last month"})]})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Blog Traffic"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"3,890"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Monthly page views"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+8% from last month"})]})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Promo Conversions"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"12.8%"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Conversion rate"}),a.jsx("p",{className:"text-sm text-red-600 mt-2",children:"-1.2% from last month"})]})]})]}),a.jsxs(_i,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ni,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(Vt,{value:"email",children:[a.jsx(ah,{className:"mr-2 h-4 w-4"}),"Email Campaigns"]}),a.jsxs(Vt,{value:"social",children:[a.jsx(Wx,{className:"mr-2 h-4 w-4"}),"Social Media"]}),a.jsxs(Vt,{value:"seo",children:[a.jsx(Du,{className:"mr-2 h-4 w-4"}),"SEO Tools"]}),a.jsxs(Vt,{value:"blog",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Blog"]}),a.jsxs(Vt,{value:"promotions",children:[a.jsx(Gm,{className:"mr-2 h-4 w-4"}),"Promotions"]})]}),a.jsx(Ut,{value:"email",children:a.jsxs(Qe,{children:[a.jsxs(lt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ct,{children:"Email Campaigns"}),a.jsx(Qt,{children:"Create and manage email marketing campaigns"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(ah,{className:"mr-2 h-4 w-4"}),"Import Template"]}),a.jsxs(O,{children:[a.jsx(ah,{className:"mr-2 h-4 w-4"}),"Create Campaign"]})]})]}),a.jsxs(it,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Campaign Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Opens"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Clicks"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conversions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Sent"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.sentDate||o.lastEdited||o.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:o.opens||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.clicks||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.conversions||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.revenue||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),o.status!=="Sent"&&a.jsx(O,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Email Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate professional marketing emails with AI, including copy and layout suggestions."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(ah,{className:"mr-2 h-4 w-4"}),"Generate New Email"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Xv,{className:"mr-2 h-4 w-4"}),"A/B Test Generator"]})]})]})]})]})}),a.jsx(Ut,{value:"social",children:a.jsxs(Qe,{children:[a.jsxs(lt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ct,{children:"Social Media Campaigns"}),a.jsx(Qt,{children:"Create and schedule social media content"})]}),a.jsxs(O,{children:[a.jsx(Wx,{className:"mr-2 h-4 w-4"}),"Create Post"]})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Content Calendar"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Content calendar placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Platform Performance"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Performance chart placeholder"})})]})]}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Recent Posts"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Platform"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Content"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Engagement"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Likes"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Comments"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.platform}),a.jsx("td",{className:"py-3 px-4",children:o.content}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Published"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.publishDate||o.scheduledDate||o.lastEdited}),a.jsx("td",{className:"py-3 px-4",children:o.engagement||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.likes||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.comments||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),o.status!=="Published"&&a.jsx(O,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Content Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Transform product images into engaging social media content with AI."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(Wx,{className:"mr-2 h-4 w-4"}),"Generate Social Media Images"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Caption Ideas"]})]})]})]})]})}),a.jsx(Ut,{value:"seo",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"SEO Tools"}),a.jsx(Qt,{children:"Optimize your store for search engines"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Keyword Research"})}),a.jsxs(it,{children:[a.jsxs("div",{className:"mb-4 flex gap-2",children:[a.jsx(Je,{placeholder:"Enter a keyword to research...",className:"flex-1"}),a.jsxs(O,{children:[a.jsx(Du,{className:"mr-2 h-4 w-4"}),"Analyze"]})]}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Recent searches: wireless headphones, premium t-shirts, leather wallet"})]})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"SEO Performance"})}),a.jsx(it,{children:a.jsx("div",{className:"h-40 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"SEO performance chart placeholder"})})})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Top Keywords"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Keyword"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Search Volume"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Difficulty"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Current Ranking"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Traffic"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"wireless headphones"}),a.jsx("td",{className:"py-3 px-4",children:"12,400"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800",children:"Medium"})}),a.jsx("td",{className:"py-3 px-4",children:"#8"}),a.jsx("td",{className:"py-3 px-4",children:"245"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Optimize"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"premium t-shirts"}),a.jsx("td",{className:"py-3 px-4",children:"5,800"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Low"})}),a.jsx("td",{className:"py-3 px-4",children:"#3"}),a.jsx("td",{className:"py-3 px-4",children:"320"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Optimize"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"leather wallet men"}),a.jsx("td",{className:"py-3 px-4",children:"8,200"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"High"})}),a.jsx("td",{className:"py-3 px-4",children:"#15"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Optimize"})})]})]})]})})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Content Optimizer"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate SEO-optimized content for your product pages and blog posts."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate SEO Content"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Du,{className:"mr-2 h-4 w-4"}),"Analyze Page SEO"]})]})]})]})]})}),a.jsx(Ut,{value:"blog",children:a.jsxs(Qe,{children:[a.jsxs(lt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ct,{children:"Blog"}),a.jsx(Qt,{children:"Create and manage blog content"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Import Article"]}),a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Create New Post"]})]})]}),a.jsxs(it,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Title"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Views"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Comments"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Shares"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.title}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Published"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.publishDate||o.lastEdited||o.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:o.views||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.comments||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.shares||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(O,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Blog Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate engaging blog content with AI based on your products and target audience."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Blog Post"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Topic Ideas"]})]})]})]})]})}),a.jsx(Ut,{value:"promotions",children:a.jsxs(Qe,{children:[a.jsxs(lt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ct,{children:"Promotions"}),a.jsx(Qt,{children:"Create and manage promotional campaigns"})]}),a.jsxs(O,{children:[a.jsx(Gm,{className:"mr-2 h-4 w-4"}),"Create Promotion"]})]}),a.jsxs(it,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Value"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Start Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"End Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Usage"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:i.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.name}),a.jsx("td",{className:"py-3 px-4",children:o.type}),a.jsx("td",{className:"py-3 px-4",children:o.value}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.startDate}),a.jsx("td",{className:"py-3 px-4",children:o.endDate}),a.jsx("td",{className:"py-3 px-4",children:o.usageCount||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(O,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Promotion Optimizer"}),a.jsx("p",{className:"text-sm mb-4",children:"Get AI recommendations for optimal discount levels and promotion timing based on your sales data."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(Gm,{className:"mr-2 h-4 w-4"}),"Generate Promotion Strategy"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Xv,{className:"mr-2 h-4 w-4"}),"Analyze Past Promotions"]})]})]})]})]})})]})]})},sRe=()=>{const[t,e]=p.useState("rates"),n=[{id:"ZONE-1",name:"Domestic",countries:["United States"],methods:[{name:"Standard",price:"$5.99",deliveryTime:"3-5 business days"},{name:"Express",price:"$12.99",deliveryTime:"1-2 business days"}]},{id:"ZONE-2",name:"Canada & Mexico",countries:["Canada","Mexico"],methods:[{name:"Standard",price:"$9.99",deliveryTime:"5-7 business days"},{name:"Express",price:"$19.99",deliveryTime:"2-3 business days"}]},{id:"ZONE-3",name:"International",countries:["Rest of World"],methods:[{name:"Standard",price:"$14.99",deliveryTime:"7-14 business days"},{name:"Express",price:"$29.99",deliveryTime:"3-5 business days"}]}],r=[{id:"SUP-1",name:"GlobalDropship Inc.",products:245,avgShippingTime:"4-7 days",status:"Connected"},{id:"SUP-2",name:"FastShip Solutions",products:189,avgShippingTime:"3-5 days",status:"Pending"},{id:"SUP-3",name:"EcoPackaging Co.",products:78,avgShippingTime:"5-8 days",status:"Connected"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Shipping & Delivery"}),a.jsxs(_i,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ni,{className:"grid grid-cols-3 mb-6",children:[a.jsxs(Vt,{value:"rates",children:[a.jsx(nw,{className:"mr-2 h-4 w-4"}),"Shipping Rates"]}),a.jsxs(Vt,{value:"dropshipping",children:[a.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Dropshipping"]}),a.jsxs(Vt,{value:"policy",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Shipping Policy"]})]}),a.jsx(Ut,{value:"rates",children:a.jsxs(Qe,{children:[a.jsxs(lt,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ct,{children:"Shipping Zones & Rates"}),a.jsx(Qt,{children:"Configure shipping rates by zone and package type"})]}),a.jsxs(O,{children:[a.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Add Shipping Zone"]})]}),a.jsxs(it,{children:[n.map(s=>a.jsxs(Qe,{className:"mb-6",children:[a.jsxs(lt,{className:"pb-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(ct,{className:"text-lg",children:s.name}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(O,{variant:"outline",size:"sm",children:"Edit"}),a.jsx(O,{variant:"outline",size:"sm",children:"Delete"})]})]}),a.jsxs(Qt,{children:["Countries: ",s.countries.join(", ")]})]}),a.jsxs(it,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Method"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Price"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Delivery Time"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.methods.map((i,o)=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.name}),a.jsx("td",{className:"py-3 px-4",children:i.price}),a.jsx("td",{className:"py-3 px-4",children:i.deliveryTime}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(O,{variant:"outline",size:"sm",children:"Delete"})]})]},o))})]})}),a.jsxs(O,{variant:"outline",size:"sm",className:"mt-4",children:[a.jsx(Li,{className:"mr-2 h-4 w-4"}),"Add Shipping Method"]})]})]},s.id)),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Package Types"}),a.jsx("p",{className:"text-sm mb-4",children:"Define standard package types to calculate shipping rates accurately."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Small Package"}),a.jsx(O,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 1 lb, 9" x 6" x 2"'})]}),a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Medium Package"}),a.jsx(O,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 5 lbs, 12" x 9" x 4"'})]}),a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Large Package"}),a.jsx(O,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 10 lbs, 18" x 12" x 6"'})]})]}),a.jsxs(O,{variant:"outline",size:"sm",children:[a.jsx(Li,{className:"mr-2 h-4 w-4"}),"Add Package Type"]})]})]})]})}),a.jsx(Ut,{value:"dropshipping",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Dropshipping Integration"}),a.jsx(Qt,{children:"Connect with dropshipping suppliers and manage fulfillment"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Fulfillment Mode"})}),a.jsxs(it,{children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(O,{variant:"outline",className:"flex-1",children:"Self-Fulfillment"}),a.jsx(O,{variant:"default",className:"flex-1",children:"Dropshipping"}),a.jsx(O,{variant:"outline",className:"flex-1",children:"Hybrid"})]}),a.jsxs("p",{className:"text-sm text-muted-foreground mt-4",children:["Current mode: ",a.jsx("strong",{children:"Dropshipping"}),". Products will be shipped directly from suppliers to customers."]})]})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Connect Supplier"})}),a.jsxs(it,{children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{placeholder:"Enter supplier API key or ID",className:"flex-1"}),a.jsxs(O,{children:[a.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Connect"]})]}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"We support direct integration with AliExpress, Spocket, Oberlo, and more."})]})]})]}),a.jsx("h3",{className:"font-medium mb-3",children:"Connected Suppliers"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Supplier"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Products"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Avg. Shipping Time"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.products}),a.jsx("td",{className:"py-3 px-4",children:s.avgShippingTime}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Connected"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View Products"}),a.jsx(O,{variant:"outline",size:"sm",children:"Disconnect"})]})]},s.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Automatic Order Routing"}),a.jsx("p",{className:"text-sm mb-4",children:"Configure how orders are routed to different suppliers based on product, location, or other criteria."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(AE,{className:"mr-2 h-4 w-4"}),"Configure Routing Rules"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Li,{className:"mr-2 h-4 w-4"}),"View Order Queue"]})]})]})]})]})}),a.jsx(Ut,{value:"policy",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Shipping Policy & Returns"}),a.jsx(Qt,{children:"Configure your shipping policy and return management settings"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Shipping Policy"}),a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Shipping Policy"}),a.jsx("p",{children:"We ship to all 50 US states and select international destinations. Orders are typically processed within 1-2 business days."}),a.jsx("h5",{children:"Domestic Shipping"}),a.jsxs("p",{children:["Standard shipping (3-5 business days): $5.99",a.jsx("br",{}),"Express shipping (1-2 business days): $12.99"]}),a.jsx("h5",{children:"International Shipping"}),a.jsxs("p",{children:["Standard shipping (7-14 business days): $14.99",a.jsx("br",{}),"Express shipping (3-5 business days): $29.99"]}),a.jsx("p",{children:"Free shipping on all domestic orders over $50. Shipping times may vary during peak seasons and holidays."})]})}),a.jsxs(O,{className:"mt-4",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Shipping Policy"]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Return Policy"}),a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Return Policy"}),a.jsx("p",{children:"We offer a 30-day return policy for most items. To be eligible for a return, your item must be unused and in the same condition that you received it."}),a.jsx("h5",{children:"Return Process"}),a.jsxs("p",{children:["1. Contact our customer service team",a.jsx("br",{}),"2. Receive a Return Merchandise Authorization (RMA) number",a.jsx("br",{}),"3. Ship the item back with the RMA number clearly marked",a.jsx("br",{}),"4. Once received, we will process your refund within 5-7 business days"]}),a.jsx("h5",{children:"Exceptions"}),a.jsxs("p",{children:["Certain items cannot be returned, including:",a.jsx("br",{}),"- Personalized or custom-made products",a.jsx("br",{}),"- Digital downloads",a.jsx("br",{}),"- Gift cards"]})]})}),a.jsxs(O,{className:"mt-4",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Return Policy"]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Return Management"}),a.jsx("p",{className:"text-sm mb-4",children:"Configure how returns are processed and managed."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Return Window"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Je,{type:"number",defaultValue:"30",className:"w-20"}),a.jsx("span",{className:"text-sm",children:"days after delivery"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Restocking Fee"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Je,{type:"number",defaultValue:"10",className:"w-20"}),a.jsx("span",{className:"text-sm",children:"% of item price"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Return Labels"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O,{variant:"outline",size:"sm",children:"Customer Pays"}),a.jsx(O,{variant:"default",size:"sm",children:"Store Provides"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Refund Method"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O,{variant:"default",size:"sm",children:"Original Payment"}),a.jsx(O,{variant:"outline",size:"sm",children:"Store Credit"})]})]})]}),a.jsxs(O,{className:"mt-4",children:[a.jsx(AE,{className:"mr-2 h-4 w-4"}),"Save Return Settings"]})]})]})]})})]})]})},iRe=({store:t})=>{var w,_,C,T;const[e,n]=p.useState("store"),{user:r,session:s,subscriptionStatus:i}=Ia(),{updateStore:o,isLoadingStores:l}=$n(),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),g=i==="active",x=async()=>{if(!(s!=null&&s.access_token)){h("Authentication token not found. Please log in again.");return}u(!0),h(null);try{const j=await fetch(`${{}.VITE_SUPABASE_URL}/functions/v1/create-portal-session`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`}}),A=await j.json();if(!j.ok)throw new Error(A.error||"Failed to create portal session.");window.location.href=A.url}catch(j){console.error("Portal session error:",j),h(j.message)}finally{u(!1)}},v=()=>{var A;const j=((A=r==null?void 0:r.store)==null?void 0:A.subdomain)||"your-store";navigator.clipboard.writeText(`${j}.storegen.app`),m(!0),setTimeout(()=>m(!1),2e3)};return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Settings"}),a.jsxs(_i,{value:e,onValueChange:n,className:"w-full",children:[a.jsxs(ni,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(Vt,{value:"store",children:[a.jsx(Ch,{className:"mr-2 h-4 w-4"}),"Store Details"]}),a.jsxs(Vt,{value:"billing",children:[a.jsx(ro,{className:"mr-2 h-4 w-4"}),"Billing"]}),a.jsxs(Vt,{value:"domain",children:[a.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Domain Management"]}),a.jsxs(Vt,{value:"legal",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Legal Pages"]}),a.jsxs(Vt,{value:"footer",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Footer Editor"]})]}),a.jsx(Ut,{value:"store",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Store Details"}),a.jsx(Qt,{children:"Update your store information and preferences"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-name",children:"Store Name"}),a.jsx(Je,{id:"store-name",placeholder:"Your Store Name",defaultValue:"My Awesome Store"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-email",children:"Store Email"}),a.jsx(Je,{id:"store-email",type:"email",placeholder:"contact@yourstore.com",defaultValue:(r==null?void 0:r.email)||""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-phone",children:"Store Phone"}),a.jsx(Je,{id:"store-phone",placeholder:"+1 (555) 123-4567",defaultValue:"+1 (555) 123-4567"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-address",children:"Store Address"}),a.jsx(En,{id:"store-address",placeholder:"123 Main St, City, State, ZIP",defaultValue:"123 Main St\\nNew York, NY 10001\\nUnited States",rows:3})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-currency",children:"Currency"}),a.jsxs("select",{id:"store-currency",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",defaultValue:"USD",children:[a.jsx("option",{value:"USD",children:"USD ($)"}),a.jsx("option",{value:"EUR",children:"EUR (€)"}),a.jsx("option",{value:"GBP",children:"GBP (£)"}),a.jsx("option",{value:"CAD",children:"CAD ($)"}),a.jsx("option",{value:"AUD",children:"AUD ($)"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-timezone",children:"Timezone"}),a.jsxs("select",{id:"store-timezone",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",defaultValue:"America/New_York",children:[a.jsx("option",{value:"America/New_York",children:"Eastern Time (ET)"}),a.jsx("option",{value:"America/Chicago",children:"Central Time (CT)"}),a.jsx("option",{value:"America/Denver",children:"Mountain Time (MT)"}),a.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PT)"}),a.jsx("option",{value:"Europe/London",children:"London (GMT)"})]})]})]})]})]}),a.jsxs("div",{className:"mt-6 space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"store-description",children:"Store Description"}),a.jsx(En,{id:"store-description",placeholder:"Tell customers about your store...",defaultValue:"Welcome to My Awesome Store! We offer high-quality products at competitive prices. Our mission is to provide exceptional customer service and a seamless shopping experience.",rows:4})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ro,{id:"enable-reviews",defaultChecked:!0}),a.jsx(je,{htmlFor:"enable-reviews",children:"Enable customer reviews"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ro,{id:"enable-inventory",defaultChecked:!0}),a.jsx(je,{htmlFor:"enable-inventory",children:"Show inventory warnings on product pages"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ro,{id:"enable-tax",defaultChecked:!0}),a.jsx(je,{htmlFor:"enable-tax",children:"Enable automatic tax calculation"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ro,{id:"enable-store-theme-toggle",checked:((w=t==null?void 0:t.settings)==null?void 0:w.showThemeToggle)??!0,onCheckedChange:j=>{t&&o&&o(t.id,{settings:{...t.settings,showThemeToggle:j}})},disabled:l||!t}),a.jsx(je,{htmlFor:"enable-store-theme-toggle",children:"Show theme (light/dark) toggle in store header"})]})]}),a.jsxs(O,{className:"mt-6",disabled:l||!t,children:[a.jsx(J_,{className:"mr-2 h-4 w-4"}),"Save Store Details"]})]})]})}),a.jsx(Ut,{value:"billing",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Billing Information"}),a.jsx(Qt,{children:"Manage your subscription and payment methods"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Current Plan"})}),a.jsxs(it,{children:[a.jsx("div",{className:"text-xl font-medium",children:g?"Store Creator Plan":"Free Plan"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g?"$29.99/month, billed monthly":"Limited features"}),a.jsxs("div",{className:"mt-4",children:[g?a.jsxs(O,{onClick:x,disabled:c,children:[a.jsx(ro,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Subscription"]}):a.jsxs(O,{onClick:x,disabled:c,children:[" ",a.jsx(ro,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Upgrade to Pro"]}),d&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:d})]})]})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Payment Methods"})}),a.jsx(it,{children:g?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"bg-blue-100 p-2 rounded-md mr-3",children:a.jsx(ro,{className:"h-5 w-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Visa ending in 4242"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Expires 12/2025"})]})]}),a.jsx(O,{variant:"outline",size:"sm",onClick:x,disabled:c,children:"Edit"})]}),a.jsxs(O,{variant:"outline",onClick:x,disabled:c,children:[a.jsx(ro,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Add Payment Method"]})]}):a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsxs("p",{className:"text-muted-foreground",children:["No payment methods available.",a.jsx("br",{}),"Upgrade to add payment methods."]})})})]})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Billing History"})}),a.jsx(it,{children:g?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Description"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Invoice"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"May 1, 2023"}),a.jsx("td",{className:"py-3 px-4",children:"Store Creator Plan"}),a.jsx("td",{className:"py-3 px-4",children:"$29.99"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Paid"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Download"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Apr 1, 2023"}),a.jsx("td",{className:"py-3 px-4",children:"Store Creator Plan"}),a.jsx("td",{className:"py-3 px-4",children:"$29.99"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Paid"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Download"})})]})]})]})}):a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsxs("p",{className:"text-muted-foreground",children:["No billing history available.",a.jsx("br",{}),"Upgrade to view billing history."]})})})]})]})]})}),a.jsx(Ut,{value:"domain",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Domain Management"}),a.jsx(Qt,{children:"Configure your store's domain and URL settings"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Subdomain"})}),a.jsxs(it,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Je,{defaultValue:((_=r==null?void 0:r.store)==null?void 0:_.subdomain)||"your-store",className:"flex-grow"}),a.jsx("span",{className:"text-muted-foreground",children:".storegen.app"})]}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsxs(O,{children:[a.jsx(J_,{className:"mr-2 h-4 w-4"}),"Save Subdomain"]}),a.jsx(O,{variant:"outline",onClick:v,children:f?a.jsxs(a.Fragment,{children:[a.jsx(Eg,{className:"mr-2 h-4 w-4"})," Copied"]}):a.jsxs(a.Fragment,{children:[a.jsx(AI,{className:"mr-2 h-4 w-4"})," Copy URL"]})})]})]})]}),a.jsxs(Qe,{children:[a.jsxs(lt,{className:"pb-2",children:[a.jsx(ct,{className:"text-lg",children:"Custom Domain"}),!g&&a.jsx(Qt,{children:a.jsx("span",{className:"text-yellow-600",children:"Available on paid plans only"})})]}),a.jsx(it,{children:g?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Je,{placeholder:"yourdomain.com",className:"flex-grow"}),a.jsxs(O,{children:[a.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Connect"]})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your domain name without http:// or www."})]}):a.jsxs("div",{className:"flex flex-col items-center justify-center h-32 space-y-4",children:[a.jsx("p",{className:"text-muted-foreground text-center",children:"Custom domains are available on paid plans only."}),a.jsxs(O,{onClick:x,disabled:c,children:[a.jsx(ro,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Upgrade to Pro"]})]})})]})]}),g&&a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"DNS Configuration"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm",children:"To connect your custom domain, add these DNS records in your domain provider's dashboard:"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Value"}),a.jsx("th",{className:"text-left py-3 px-4",children:"TTL"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"CNAME"}),a.jsx("td",{className:"py-3 px-4",children:"@"}),a.jsxs("td",{className:"py-3 px-4",children:[((C=r==null?void 0:r.store)==null?void 0:C.subdomain)||"your-store",".storegen.app"]}),a.jsx("td",{className:"py-3 px-4",children:"3600"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"CNAME"}),a.jsx("td",{className:"py-3 px-4",children:"www"}),a.jsxs("td",{className:"py-3 px-4",children:[((T=r==null?void 0:r.store)==null?void 0:T.subdomain)||"your-store",".storegen.app"]}),a.jsx("td",{className:"py-3 px-4",children:"3600"})]})]})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"View DNS Guide"]}),a.jsxs(O,{children:[a.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Verify DNS"]})]})]})})]})]})]})}),a.jsx(Ut,{value:"legal",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Legal Pages"}),a.jsx(Qt,{children:"Configure your store's legal documents and policies"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Privacy Policy"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Privacy Policy"}),a.jsx("p",{children:"This Privacy Policy describes how your personal information is collected, used, and shared when you visit or make a purchase from our store."}),a.jsx("h5",{children:"Personal Information We Collect"}),a.jsx("p",{children:"When you visit the Site, we automatically collect certain information about your device, including information about your web browser, IP address, time zone, and some of the cookies that are installed on your device."}),a.jsx("p",{children:"Additionally, as you browse the Site, we collect information about the individual web pages or products that you view, what websites or search terms referred you to the Site, and information about how you interact with the Site."}),a.jsx("h5",{children:"How We Use Your Personal Information"}),a.jsx("p",{children:"We use the information that we collect generally to fulfill any orders placed through the Site (including processing your payment information, arranging for shipping, and providing you with invoices and/or order confirmations)."})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Privacy Policy"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Terms of Service"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Terms of Service"}),a.jsx("p",{children:"These Terms of Service govern your use of our website and the products and services provided by us."}),a.jsx("h5",{children:"Overview"}),a.jsx("p",{children:"By accessing our website, you agree to these Terms of Service. If you do not agree with any part of these terms, you may not access the website or use our services."}),a.jsx("h5",{children:"Products and Services"}),a.jsx("p",{children:"All products and services displayed on our website are subject to availability. We reserve the right to discontinue any product or service at any time."}),a.jsx("h5",{children:"Accuracy of Information"}),a.jsx("p",{children:"We make every effort to ensure that the information on our website is accurate and up-to-date. However, we do not warrant that product descriptions or other content is accurate, complete, reliable, current, or error-free."})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Terms of Service"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Refund Policy"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Refund Policy"}),a.jsx("p",{children:"We offer a 30-day return policy for most items. To be eligible for a return, your item must be unused and in the same condition that you received it."}),a.jsx("h5",{children:"Return Process"}),a.jsxs("p",{children:["1. Contact our customer service team",a.jsx("br",{}),"2. Receive a Return Merchandise Authorization (RMA) number",a.jsx("br",{}),"3. Ship the item back with the RMA number clearly marked",a.jsx("br",{}),"4. Once received, we will process your refund within 5-7 business days"]}),a.jsx("h5",{children:"Exceptions"}),a.jsxs("p",{children:["Certain items cannot be returned, including:",a.jsx("br",{}),"- Personalized or custom-made products",a.jsx("br",{}),"- Digital downloads",a.jsx("br",{}),"- Gift cards"]})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Refund Policy"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Cookie Policy"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Cookie Policy"}),a.jsx("p",{children:"This Cookie Policy explains how we use cookies and similar technologies to recognize you when you visit our website."}),a.jsx("h5",{children:"What are cookies?"}),a.jsx("p",{children:"Cookies are small data files that are placed on your computer or mobile device when you visit a website. Cookies are widely used by website owners in order to make their websites work, or to work more efficiently, as well as to provide reporting information."}),a.jsx("h5",{children:"How we use cookies"}),a.jsx("p",{children:'We use cookies for several reasons. Some cookies are required for technical reasons in order for our website to operate, and we refer to these as "essential" or "strictly necessary" cookies. Other cookies enable us to track and target the interests of our users to enhance the experience on our website.'})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Cookie Policy"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]})]})]})]})}),a.jsx(Ut,{value:"footer",children:a.jsxs(Qe,{children:[a.jsxs(lt,{children:[a.jsx(ct,{children:"Footer Editor"}),a.jsx(Qt,{children:"Customize your store's footer information"})]}),a.jsxs(it,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Contact Information"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-email",children:"Email"}),a.jsx(Je,{id:"footer-email",type:"email",placeholder:"contact@yourstore.com",defaultValue:(r==null?void 0:r.email)||""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-phone",children:"Phone"}),a.jsx(Je,{id:"footer-phone",placeholder:"+1 (555) 123-4567",defaultValue:"+1 (555) 123-4567"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-address",children:"Address"}),a.jsx(En,{id:"footer-address",placeholder:"123 Main St, City, State, ZIP",defaultValue:"123 Main St\\nNew York, NY 10001\\nUnited States",rows:3})]})]})})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Business Hours"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-hours",children:"Hours of Operation"}),a.jsx(En,{id:"footer-hours",placeholder:"Monday-Friday: 9am-5pm",defaultValue:"Monday-Friday: 9am-5pm\\nSaturday: 10am-4pm\\nSunday: Closed",rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-support",children:"Customer Support Hours"}),a.jsx(En,{id:"footer-support",placeholder:"Monday-Friday: 9am-5pm",defaultValue:"Monday-Friday: 9am-6pm\\nSaturday: 10am-2pm\\nSunday: Closed",rows:3})]})]})})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"Social Media"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-facebook",children:"Facebook"}),a.jsx(Je,{id:"footer-facebook",placeholder:"https://facebook.com/yourstore",defaultValue:"https://facebook.com/yourstore"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-instagram",children:"Instagram"}),a.jsx(Je,{id:"footer-instagram",placeholder:"https://instagram.com/yourstore",defaultValue:"https://instagram.com/yourstore"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-twitter",children:"Twitter"}),a.jsx(Je,{id:"footer-twitter",placeholder:"https://twitter.com/yourstore",defaultValue:"https://twitter.com/yourstore"})]})]})})]})]}),a.jsxs(Qe,{children:[a.jsx(lt,{className:"pb-2",children:a.jsx(ct,{className:"text-lg",children:"About Us"})}),a.jsx(it,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-about",children:"About Us Text"}),a.jsx(En,{id:"footer-about",placeholder:"Tell customers about your business...",defaultValue:"My Awesome Store was founded in 2023 with a mission to provide high-quality products at competitive prices. We are committed to exceptional customer service and a seamless shopping experience.",rows:4})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(je,{htmlFor:"footer-copyright",children:"Copyright Text"}),a.jsx(Je,{id:"footer-copyright",placeholder:"© 2023 Your Store. All rights reserved.",defaultValue:`© ${new Date().getFullYear()} My Awesome Store. All rights reserved.`})]})]})})]}),a.jsx("div",{className:"mt-6",children:a.jsxs(O,{children:[a.jsx(J_,{className:"mr-2 h-4 w-4"}),"Save Footer Settings"]})})]})]})})]})]})},oRe=()=>{const{storeName:t}=I0(),e=Ca(),{getStoreById:n,getStoreByName:r,setCurrentStore:s,isLoadingStores:i}=$n(),o=new URLSearchParams(e.search),l=o.get("tab")||"orders",[c,u]=p.useState(l),[d,h]=p.useState(null);p.useEffect(()=>{if(!i&&t){const m=r(t);m?(h(m),s(m)):console.error(`Store with name ${t} not found.`)}},[t,r,s,i]),p.useEffect(()=>{const m=o.get("tab");m&&m!==c&&u(m)},[e.search]);const f=()=>{switch(c){case"orders":return a.jsx(ZF,{store:d});case"products":return a.jsx(Zje,{store:d});case"customers":return a.jsx(eRe,{store:d});case"payments":return a.jsx(tRe,{store:d});case"analytics":return a.jsx(nRe,{store:d});case"marketing":return a.jsx(rRe,{store:d});case"shipping":return a.jsx(sRe,{store:d});case"settings":return a.jsx(iRe,{store:d});default:return a.jsx(ZF,{store:d})}};return i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading dashboard..."})]})}):!d&&!i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Store Not Found"}),a.jsxs("p",{className:"text-muted-foreground",children:["Could not load dashboard for store: ",t]})]})}):a.jsx(Xje,{activeTab:c,setActiveTab:u,storeId:d==null?void 0:d.id,storeName:d==null?void 0:d.name,children:f()})},aRe=[{id:"ref1",name:"Modern Minimalist",imageUrl:"https://via.placeholder.com/150/f8f9fa/000000?text=Modern"},{id:"ref2",name:"Vintage Charm",imageUrl:"https://via.placeholder.com/150/e9ecef/000000?text=Vintage"},{id:"ref3",name:"Abstract Art",imageUrl:"https://via.placeholder.com/150/dee2e6/000000?text=Abstract"},{id:"ref4",name:"Nature Inspired",imageUrl:"https://via.placeholder.com/150/ced4da/000000?text=Nature"}],lRe=()=>{const[t,e]=p.useState(""),[n,r]=p.useState(null),[s,i]=p.useState(null),[o,l]=p.useState(null),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),[g,x]=p.useState([]),[v,w]=p.useState(""),_=ti(),C=A=>{const E=A.target.files[0];if(E){const I=new FileReader;I.onloadend=()=>{r(I.result),l(I.result)},I.readAsDataURL(E)}},T=A=>{const E=Array.from(A.target.files);if(E.length+g.length>3){h("You can upload a maximum of 3 ingredient images.");return}E.forEach(I=>{const N=new FileReader;N.onloadend=()=>{x(k=>[...k,N.result])},N.readAsDataURL(I)})},j=async()=>{u(!0),h(null),l(null);try{let A;const E=n?n.split(",")[1]:null,I=g.map(N=>({mimeType:"image/png",data:N.split(",")[1]}));if(f&&E)A=await DE(t,E,"image/png",I);else{const N=s?`${t} in the style of ${s.name}`:t;A=await e5(N,I)}A.imageData?l(`data:image/png;base64,${A.imageData}`):h(A.text||"Failed to generate image. No image data returned.")}catch(A){console.error("Error generating image:",A),h(A.message||"An unexpected error occurred.")}finally{u(!1)}};return a.jsxs("div",{className:"flex flex-col md:flex-row h-screen bg-black md:bg-gradient-to-b from-black to-white",children:[a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-4 left-4 z-10 md:hidden",onClick:()=>window.history.back(),children:a.jsx(Wi,{className:"text-white"})}),a.jsxs("main",{className:"flex-1 flex items-center justify-center p-0 md:p-6 relative bg-black md:order-2",style:{paddingTop:"60px"},children:[o&&a.jsx("div",{className:"absolute top-0 left-0 right-0 bg-blue-600 text-white p-2 text-center md:hidden",children:a.jsxs(O,{className:"bg-transparent hover:bg-blue-700",children:[a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Create Store with Design"]})}),a.jsxs("div",{className:"w-full md:max-w-2xl aspect-square flex items-center justify-center relative",children:[c&&a.jsx("p",{className:"text-white",children:"Loading..."}),d&&a.jsx("p",{className:"text-red-500",children:d}),o&&a.jsx("img",{src:o,alt:"Generated result",className:"max-w-full max-h-full object-contain"}),!c&&!d&&!o&&a.jsx("div",{className:"text-center text-gray-400",children:a.jsx("p",{children:"Your design will appear here."})}),o&&a.jsx("div",{className:"absolute top-4 right-4 hidden md:block",children:a.jsxs(O,{className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>_("/",{state:{generatedImage:o}}),children:[a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Create Store with Design"]})}),o&&a.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex items-center gap-2",children:[a.jsx(Je,{type:"text",value:v,onChange:A=>w(A.target.value),placeholder:"Describe your edit...",className:"bg-white/80 backdrop-blur-sm"}),a.jsx(O,{onClick:async()=>{if(v){u(!0),h(null);try{const A=o.split(",")[1],E=await DE(v,A,"image/png");E.imageData?l(`data:image/png;base64,${E.imageData}`):h(E.text||"Failed to edit image.")}catch(A){h(A.message)}finally{u(!1),w("")}}},disabled:c,className:"bg-gray-200 hover:bg-gray-300 text-black",children:"Edit"})]})]})]}),a.jsxs("aside",{className:"w-full md:w-1/3 md:max-w-sm p-6 bg-white shadow-md relative md:order-1",children:[a.jsx(Fs,{className:"h-full",children:a.jsxs("div",{className:"space-y-6 pb-20",children:[a.jsxs("div",{className:"hidden md:flex items-center justify-between",children:[a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>window.history.back(),children:a.jsx(Wi,{})}),a.jsx("h1",{className:"text-2xl font-bold",children:"Designer"}),a.jsx("img",{src:"https://static.wixstatic.com/media/bd2e29_695f70787cc24db4891e63da7e7529b3~mv2.png",alt:"Logo",className:"h-8"})]}),a.jsx("div",{className:"md:hidden text-center"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ro,{id:"use-own-image",checked:f,onCheckedChange:m}),a.jsx(je,{htmlFor:"use-own-image",children:"Use your own image"})]}),f&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Upload Your Image"}),a.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Upload an image to edit."}),a.jsx(Je,{id:"image-upload",type:"file",accept:"image/*",onChange:C,className:"mt-2"}),n&&a.jsxs("div",{className:"mt-4",children:[a.jsx("img",{src:n,alt:"Uploaded preview",className:"w-full rounded-lg shadow-sm"}),a.jsx(O,{variant:"link",size:"sm",onClick:()=>r(null),className:"mt-1 px-0",children:"Remove"})]})]}),a.jsx(Ys,{}),a.jsxs("div",{children:[a.jsx(je,{htmlFor:"prompt",className:"text-lg font-semibold",children:"Prompt"}),a.jsx(Je,{id:"prompt",type:"text",value:t,onChange:A=>e(A.target.value),placeholder:"e.g., a futuristic cityscape",className:"mt-2"})]}),a.jsx(Ys,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Ingredients"}),a.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Add up to 3 images to include in the generation."}),a.jsx(Je,{id:"ingredient-upload",type:"file",accept:"image/*",multiple:!0,onChange:T,className:"mt-2"}),a.jsx("div",{className:"grid grid-cols-3 gap-2 mt-4",children:g.map((A,E)=>a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:A,alt:`Ingredient ${E+1}`,className:"w-full rounded-lg shadow-sm"}),a.jsx(O,{variant:"destructive",size:"sm",className:"absolute top-1 right-1 h-6 w-6 p-0",onClick:()=>x(I=>I.filter((N,k)=>k!==E)),children:"X"})]},E))})]}),a.jsx(Ys,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Reference Styles"}),a.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Optionally select a style to influence the generation."}),a.jsx("div",{className:"grid grid-cols-2 gap-4",children:aRe.map(A=>a.jsxs("div",{className:`cursor-pointer border-2 rounded-lg overflow-hidden ${(s==null?void 0:s.id)===A.id?"border-blue-500":"border-transparent"}`,onClick:()=>i((s==null?void 0:s.id)===A.id?null:A),children:[a.jsx("img",{src:A.imageUrl,alt:A.name,className:"w-full h-24 object-cover"}),a.jsx("p",{className:"text-center text-sm p-1 bg-gray-100",children:A.name})]},A.id))})]}),a.jsx(Ys,{})]})}),a.jsx("div",{className:"absolute bottom-6 left-6 right-6",children:a.jsx(O,{onClick:j,disabled:c||!t,className:"w-full",children:c?"Generating...":"Generate Image"})})]})]})},cRe=()=>a.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[a.jsx("h1",{className:"text-4xl font-bold",children:"Music Page"}),a.jsx("p",{className:"text-lg text-gray-600",children:"This page is under construction."})]}),uRe=()=>{const[t,e]=p.useState(""),[n,r]=p.useState(""),[s,i]=p.useState(!1),[o,l]=p.useState([]),[c,u]=p.useState(0),d=async()=>{var f,m,g,x,v,w;if(!t.trim())return;i(!0),r(""),l([]),u(0);const h=new On({apiKey:"AIzaSyCWUzTb8AC8d6CvHm4_MLgXSeufRQcHQAE"});try{l(N=>[...N,"Generating transcript..."]),u(25);const C=(await h.models.generateContent({model:"gemini-2.0-flash",contents:`Generate a short podcast transcript with two speakers, Joe and Jane, discussing ${t}.`})).text;l(N=>[...N,"Transcript generated."]),u(50),l(N=>[...N,"Generating audio..."]),u(75);const j=(w=(v=(x=(g=(m=(f=(await h.models.generateContent({model:"gemini-2.5-flash-preview-tts",contents:[{parts:[{text:C}]}],config:{responseModalities:["AUDIO"],speechConfig:{multiSpeakerVoiceConfig:{speakerVoiceConfigs:[{speaker:"Joe",voiceConfig:{prebuiltVoiceConfig:{voiceName:"Kore"}}},{speaker:"Jane",voiceConfig:{prebuiltVoiceConfig:{voiceName:"Puck"}}}]}}}})).candidates)==null?void 0:f[0])==null?void 0:m.content)==null?void 0:g.parts)==null?void 0:x[0])==null?void 0:v.inlineData)==null?void 0:w.data,A=Buffer.from(j,"base64"),E=new Blob([A],{type:"audio/wav"}),I=URL.createObjectURL(E);r(I),l(N=>[...N,"Audio generated."]),u(100)}catch(_){console.error("Error generating podcast:",_),l(C=>[...C,"Error generating podcast."])}finally{i(!1)}};return a.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-100 relative",children:[a.jsx(zn,{to:"/",className:"absolute top-4 left-4",children:a.jsx(O,{variant:"ghost",size:"icon",children:a.jsx(Wi,{})})}),!n&&!s&&a.jsxs("div",{className:"w-full max-w-md p-8 space-y-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-center",children:"Create a Podcast"}),a.jsx("div",{className:"space-y-2",children:a.jsx(Je,{type:"text",placeholder:"Enter a topic, ex. 2025 print on demand trends...",value:t,onChange:h=>e(h.target.value),className:"w-full bg-gray-200/50 rounded-[18px]"})}),a.jsx(O,{onClick:d,className:"w-full bg-blue-600 hover:bg-blue-700",children:"Create"})]}),s&&a.jsxs("div",{className:"w-full max-w-md p-8 space-y-6",children:[a.jsx($a,{value:c,className:"w-full"}),a.jsx("div",{className:"text-center",children:o.map((h,f)=>a.jsx("p",{children:h},f))})]}),n&&!s&&a.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-white rounded-lg shadow-md",children:[a.jsx("h1",{className:"text-3xl font-bold text-center",children:"Your Podcast"}),a.jsx("audio",{controls:!0,src:n,className:"w-full"})]})]})},fm=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),dRe=()=>{const{toast:t}=as(),[e,n]=p.useState("text-to-image"),[r,s]=p.useState(""),[i,o]=p.useState(""),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[h,f]=p.useState(null),[m,g]=p.useState([]),[x,v]=p.useState(!1),[w,_]=p.useState(""),[C,T]=p.useState(null),[j,A]=p.useState(!1),[E,I]=p.useState(null),[N,k]=p.useState([]),[R,D]=p.useState(""),[M,z]=p.useState(!1),[B,G]=p.useState(null),[Y,H]=p.useState(!1),[K,$]=p.useState(null),V=async()=>{var ue,Ce;if(!(!K||!K.url))try{const Ie=document.createElement("a");let ve="download";if(K.url.startsWith("data:")){const ie=K.url.match(/:(.*?);/),He=(ie?ie[1]:"application/octet-stream").split("/")[1]||"bin";ve=`${((ue=K.caption)==null?void 0:ue.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${He}`,Ie.href=K.url}else{const Me=await(await fetch(K.url)).blob();Ie.href=URL.createObjectURL(Me);const He=K.url.substring(K.url.lastIndexOf("/")+1).split("?")[0],yt=He.includes(".")?He.substring(He.lastIndexOf(".")+1):"",kt=K.type==="video"?"mp4":"png";ve=He||`${((Ce=K.caption)==null?void 0:Ce.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${yt||kt}`}Ie.download=ve,document.body.appendChild(Ie),Ie.click(),document.body.removeChild(Ie),K.url.startsWith("data:")||URL.revokeObjectURL(Ie.href),t({title:"Download Started",description:`Downloading ${ve}`})}catch(Ie){console.error("Error downloading media:",Ie),t({title:"Download Failed",description:Ie.message,variant:"destructive"})}},W=async()=>{if(!r.trim()){t({title:"Error",description:"Please enter a prompt for image generation",variant:"destructive"});return}c(!0),f(null),D("");try{const ue=await j0(r);let Ce=ue.alt?[ue.alt]:[`Image for: ${r.substring(0,30)}`];if(ue.url)try{const{base64ImageData:Ie,mimeType:ve}=await fm(ue.url);Ce=await sa(Ie,ve,`Image of ${r}`)}catch(Ie){console.error("Error generating caption for Gemini image:",Ie),Ce=[`Failed to generate caption for: ${r.substring(0,30)}`]}f({url:ue.url,captions:Ce,sourceApi:"gemini"}),Ce&&Ce.length>0&&D(Ce[0])}catch(ue){console.error("Error generating image with Gemini:",ue),t({title:"Image Generation Failed",description:ue.message,variant:"destructive"})}finally{c(!1)}},F=async()=>{if(!i.trim()){t({title:"Error",description:"Please enter a prompt for OpenAI image generation",variant:"destructive"});return}d(!0),f(null),D("");try{const ue=await ZB(i),Ce=`data:image/png;base64,${ue.b64_json}`;let Ie=ue.alt?[ue.alt]:[`OpenAI image for: ${i.substring(0,30)}`];try{const{base64ImageData:ve,mimeType:ie}=await fm(Ce);Ie=await sa(ve,ie,`OpenAI-generated image of ${i}`)}catch(ve){console.error("Error generating caption for OpenAI image:",ve),Ie=[`Failed to generate caption for: ${i.substring(0,30)}`]}f({url:Ce,captions:Ie,sourceApi:"openai"}),Ie&&Ie.length>0&&D(Ie[0]),t({title:"Image Generated (OpenAI)",description:"Image successfully generated using OpenAI."})}catch(ue){console.error("Error generating image with OpenAI:",ue),t({title:"OpenAI Image Generation Failed",description:ue.message,variant:"destructive"})}finally{d(!1)}},Z=async(ue,Ce)=>{if(!ue||!ue.url){t({title:"Error",description:"No image selected to edit with Gemini.",variant:"destructive"});return}if(!Ce.trim()){t({title:"Error",description:"Please enter an edit prompt for Gemini.",variant:"destructive"});return}A(!0),I(null),D("");try{const{base64ImageData:Ie,mimeType:ve}=await fm(ue.url),ie=await $o(Ie,ve,Ce);if(ie&&ie.editedImageData){const Me=`data:${ie.newMimeType};base64,${ie.editedImageData}`;let He=ie.editTextResponse?[ie.editTextResponse]:[`Edited with Gemini: ${ue.caption||ue.id}`];try{He=await sa(ie.editedImageData,ie.newMimeType,`Edited image based on: ${Ce}`)}catch(yt){console.error("Error generating caption for Gemini edited image:",yt)}I({url:Me,captions:He,sourceApi:"gemini"}),He&&He.length>0&&D(He[0]),t({title:"Image Edited (Gemini)",description:"Image successfully edited with Gemini."})}else throw new Error("Gemini image edit did not return image data.")}catch(Ie){console.error("Error editing image with Gemini:",Ie),t({title:"Gemini Edit Failed",description:Ie.message,variant:"destructive"})}finally{A(!1)}},ce=async ue=>{const Ce=ue.target.files[0];if(Ce){H(!0),G(null),D("");try{const Ie=new FileReader;Ie.onload=async ve=>{const ie=ve.target.result,Me=Ce.type.startsWith("video/")?"video":"image";let He=[Ce.name];if(Me==="image")try{const{base64ImageData:yt,mimeType:kt}=await fm(ie);He=await sa(yt,kt,"Uploaded image caption")}catch(yt){console.error("Error generating caption for uploaded image:",yt)}else He=[`Uploaded video: ${Ce.name}`];G({url:ie,captions:He,type:Me}),He&&He.length>0&&D(He[0]),H(!1)},Ie.onerror=()=>{t({title:"Upload Failed",description:"Failed to read the selected file",variant:"destructive"}),H(!1)},Ie.readAsDataURL(Ce)}catch(Ie){console.error("Error processing uploaded file:",Ie),t({title:"Upload Failed",description:Ie.message,variant:"destructive"}),H(!1)}}},le=(ue,Ce,Ie="image")=>{if(!ue){t({title:"Cannot Add",description:"Item URL is missing.",variant:"destructive"});return}const ve={id:Ft(),type:Ie,url:ue,caption:Ce||`Item ${N.length+1}`,isVideo:Ie==="video"};k(ie=>[...ie,ve]),t({title:"Added to Timeline",description:`${Ie==="video"?"Video":"Image"} added to your content timeline.`}),f(null),I(null),G(null),T(null),D("")},he=(ue,Ce)=>{const Ie=[...N],ve=Ie[ue],ie=ue+Ce;ie<0||ie>=Ie.length||(Ie.splice(ue,1),Ie.splice(ie,0,ve),k(Ie))},Le=ue=>{k(Ce=>Ce.filter(Ie=>Ie.id!==ue)),t({title:"Removed from Timeline",description:"Item removed."})},Ve=async(ue,Ce)=>{if(ue.isVideo){t({title:"Already a Video",description:"This item is already a video."});return}z(!0);try{const{base64ImageData:Ie,mimeType:ve}=await fm(ue.url),ie=ue.caption||"Create a short video from this image",Me=await KI(ie,Ie,ve),He=[...N];He[Ce]={...ue,url:Me,isVideo:!0,type:"video",caption:ue.caption+" (Veo Video)"},k(He),t({title:"Veo Video Generated",description:"Image converted to video using Veo."})}catch(Ie){console.error("Error converting to Veo video:",Ie),t({title:"Veo Conversion Failed",description:Ie.message,variant:"destructive"})}finally{z(!1)}},Be=ue=>{const Ce=N.find(ve=>ve.id===ue);if(!Ce)return;const Ie=prompt("Edit caption:",Ce.caption);Ie!==null&&Ie.trim()!==Ce.caption&&(k(ve=>ve.map(ie=>ie.id===ue?{...ie,caption:Ie.trim()}:ie)),t({title:"Caption Updated"}))};return a.jsxs("div",{className:"container mx-auto p-4 md:p-6 lg:p-8 space-y-8 bg-background",children:[a.jsxs("header",{className:"relative text-center pb-4",children:[a.jsx(zn,{to:"/",className:"absolute left-0 top-0",children:a.jsxs(O,{variant:"outline",size:"icon",children:[a.jsx(Wi,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Back to Home"})]})}),a.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight",children:"AI Content Creation Studio"}),a.jsx("p",{className:"text-muted-foreground mt-2 text-lg",children:"Generate images, edit them, create videos, and build your content sequence."})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 xl:gap-8",children:[a.jsx("div",{className:"lg:col-span-1 space-y-6",children:a.jsxs(_i,{value:e,onValueChange:n,className:"w-full",children:[a.jsxs(ni,{className:"grid w-full grid-cols-3",children:[a.jsxs(Vt,{value:"text-to-image",children:[a.jsx(fa,{className:"mr-1 h-4 w-4 inline-block"}),"Gen Image"]}),a.jsxs(Vt,{value:"image-edit",children:[a.jsx(tw,{className:"mr-1 h-4 w-4 inline-block"}),"Edit Image"]}),a.jsxs(Vt,{value:"upload",children:[a.jsx($3,{className:"mr-1 h-4 w-4 inline-block"}),"Upload"]})]}),a.jsxs(Ut,{value:"text-to-image",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(je,{htmlFor:"text-prompt-model1",className:"text-lg font-semibold",children:"Text-to-Image (Quick)"}),a.jsx(En,{id:"text-prompt-model1",placeholder:"e.g., 'A futuristic cityscape at sunset'",value:r,onChange:ue=>s(ue.target.value),rows:3,className:"mt-2",disabled:l||u}),x&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Loading prompt suggestions..."}),m.length>0&&!x&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx(je,{className:"text-xs text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:m.map((ue,Ce)=>a.jsx(O,{variant:"outline",size:"xs",onClick:()=>s(ue),className:"text-xs",children:ue.length>40?ue.substring(0,37)+"...":ue},Ce))})]}),a.jsxs(O,{onClick:W,disabled:l||u||!r.trim(),className:"w-full mt-3",children:[l?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(fa,{className:"mr-2 h-4 w-4"}),"Generate with Quick"]}),a.jsx(Ys,{className:"my-4"}),a.jsx(je,{htmlFor:"text-prompt-model2",className:"text-lg font-semibold",children:"Text-to-Image (Quality)"}),a.jsx(En,{id:"text-prompt-model2",placeholder:"e.g., 'A photorealistic cat astronaut'",value:i,onChange:ue=>o(ue.target.value),rows:3,className:"mt-2",disabled:l||u}),a.jsxs(O,{onClick:F,disabled:l||u||!i.trim(),className:"w-full mt-3",children:[u?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(A3,{className:"mr-2 h-4 w-4"}),"Generate with Quality"]}),h&&h.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:h.url,alt:`Generated by ${h.sourceApi==="gemini"?"Quick":h.sourceApi==="openai"?"Quality":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",h.sourceApi==="gemini"?"Quick":h.sourceApi==="openai"?"Quality":"AI"]}),a.jsx(je,{className:"text-sm font-medium",children:"Choose a caption:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(h.captions||[]).map((ue,Ce)=>a.jsx(O,{variant:R===ue?"default":"outline",size:"sm",onClick:()=>D(ue),className:"text-xs",children:ue},Ce))}),a.jsxs(O,{onClick:()=>le(h.url,R),size:"sm",className:"w-full mt-2",disabled:!R,children:[a.jsx(Eu,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]}),a.jsxs(Ut,{value:"image-edit",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(je,{className:"text-lg font-semibold",children:"Image Editing"}),!C&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select an image from the timeline to enable editing."}),C&&a.jsxs("div",{className:"mt-2 space-y-3",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Editing: ",a.jsx("span",{className:"text-primary truncate",children:C.caption})]}),a.jsx("img",{src:C.url,alt:"Selected for editing",className:"w-full rounded-md object-contain max-h-48 border"}),a.jsx(je,{htmlFor:"edit-prompt-model1",children:"Edit with Quick"}),a.jsx(En,{id:"edit-prompt-model1",placeholder:"Describe edits (e.g., 'change background to a beach')",value:w,onChange:ue=>_(ue.target.value),rows:2,disabled:j}),a.jsxs(O,{onClick:()=>Z(C,w),disabled:j||!w.trim(),className:"w-full",children:[j?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(fa,{className:"mr-2 h-4 w-4"}),"Edit with Quick"]})]}),E&&E.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:E.url,alt:`Edited by ${E.sourceApi==="gemini"?"Quick":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",E.sourceApi==="gemini"?"Quick":"AI"]}),a.jsx(je,{className:"text-sm font-medium",children:"Choose a caption for the edited image:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(E.captions||[]).map((ue,Ce)=>a.jsx(O,{variant:R===ue?"default":"outline",size:"sm",onClick:()=>D(ue),className:"text-xs",children:ue},Ce))}),a.jsxs(O,{onClick:()=>le(E.url,R),size:"sm",className:"w-full mt-2",disabled:!R,children:[a.jsx(Eu,{className:"mr-2 h-4 w-4"})," Add Edited to Timeline"]})]})]}),a.jsxs(Ut,{value:"upload",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(je,{htmlFor:"file-upload",className:"text-lg font-semibold",children:"Upload Image or Video"}),a.jsx(Je,{id:"file-upload",type:"file",accept:"image/*,video/*",onChange:ce,className:"mt-2",disabled:Y}),Y&&a.jsxs("div",{className:"mt-2 flex items-center text-sm text-muted-foreground",children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"})," Processing..."]}),B&&B.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[B.type==="image"?a.jsx("img",{src:B.url,alt:"Uploaded content",className:"w-full rounded-md object-contain max-h-96"}):a.jsx("video",{src:B.url,controls:!0,className:"w-full rounded-md max-h-96",children:"Your browser does not support the video tag."}),a.jsx(je,{className:"text-sm font-medium",children:"Choose a caption for the uploaded content:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(B.captions||[]).map((ue,Ce)=>a.jsx(O,{variant:R===ue?"default":"outline",size:"sm",onClick:()=>D(ue),className:"text-xs",children:ue},Ce))}),a.jsxs(O,{onClick:()=>le(B.url,R,B.type),size:"sm",className:"w-full mt-2",disabled:!R,children:[a.jsx(Eu,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]})]})}),a.jsx("div",{className:"lg:col-span-2 space-y-6",children:a.jsxs("div",{className:"p-4 md:p-6 border rounded-lg bg-card shadow min-h-[400px]",children:[a.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Content Timeline"}),a.jsx(Fs,{className:"h-[calc(100vh-350px)] min-h-[300px] pr-3",children:N.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[a.jsx(N3,{className:"h-12 w-12 mb-3"}),a.jsx("p",{children:"Your timeline is empty."}),a.jsx("p",{className:"text-sm",children:"Generate or upload content to get started."})]}):a.jsx(Sc,{children:N.map((ue,Ce)=>a.jsxs(It.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-50},transition:{type:"spring",stiffness:300,damping:30},className:"mb-3 p-3 border rounded-md flex items-start gap-3 hover:shadow-md transition-shadow bg-background cursor-pointer",onClick:()=>$(ue),children:[a.jsxs("div",{className:"w-24 h-24 flex-shrink-0 relative rounded overflow-hidden group bg-muted",children:[ue.isVideo?a.jsx("video",{src:ue.url,className:"w-full h-full object-cover",controls:!1,muted:!0,loop:!0,onMouseOver:Ie=>Ie.target.play(),onMouseOut:Ie=>Ie.target.pause()}):a.jsx("img",{src:ue.url,alt:ue.caption,className:"w-full h-full object-cover"}),!ue.isVideo&&a.jsx(O,{size:"icon",variant:"secondary",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Ie=>{Ie.stopPropagation(),Ve(ue,Ce)},disabled:M,title:"Convert to Veo Video",children:M?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(jI,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"outline",className:"absolute bottom-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Ie=>{Ie.stopPropagation(),T(ue),n("image-edit")},disabled:ue.isVideo,title:"Edit this image",children:a.jsx(tw,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:`text-xs font-semibold px-1.5 py-0.5 rounded-sm ${ue.isVideo?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:[ue.isVideo?"Video":"Image"," ",Ce+1]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(O,{size:"icon",variant:"ghost",onClick:Ie=>{Ie.stopPropagation(),he(Ce,-1)},disabled:Ce===0,className:"h-7 w-7",children:a.jsx(D3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ie=>{Ie.stopPropagation(),he(Ce,1)},disabled:Ce===N.length-1,className:"h-7 w-7",children:a.jsx(R3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ie=>{Ie.stopPropagation(),Be(ue.id)},className:"h-7 w-7",children:a.jsx(M3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ie=>{Ie.stopPropagation(),Le(ue.id)},className:"h-7 w-7 text-destructive",children:a.jsx(Fn,{className:"h-4 w-4"})})]})]}),a.jsx("p",{className:"text-sm mt-1 text-muted-foreground line-clamp-3",title:ue.caption,children:ue.caption})]})]},ue.id))})}),N.length>0&&a.jsx(Ys,{className:"my-4"}),K&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Media Viewer"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(O,{variant:"outline",size:"sm",onClick:V,children:[a.jsx(kI,{className:"mr-2 h-4 w-4"}),"Download"]}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>$(null),children:a.jsx(Hi,{className:"h-5 w-5"})})]})]}),K.type==="image"||!K.isVideo?a.jsx("img",{src:K.url,alt:K.caption||"Viewing media",className:"w-full max-h-[60vh] rounded-md object-contain border"}):a.jsx("video",{src:K.url,controls:!0,className:"w-full max-h-[60vh] rounded-md border bg-black",children:"Your browser does not support the video tag."}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:K.caption})]})]})})]})]})},hRe=()=>a.jsx(nIe,{}),fRe=()=>{const{isAuthenticated:t,loadingProfile:e}=Ia();return e?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("p",{className:"text-xl",children:"Loading..."})}):t?a.jsx(PV,{to:"/",replace:!0}):a.jsx(Hje,{})},mRe=[{element:a.jsxs(c_e,{children:[a.jsx(Qje,{})," "]}),children:[{index:!0,element:a.jsx(hRe,{})},{path:"auth",element:a.jsx(fRe,{})},{path:"pricing",element:a.jsx(qje,{})},{path:"designer",element:a.jsx(lRe,{})},{path:"music",element:a.jsx(cRe,{})},{path:"podcast",element:a.jsx(uRe,{})},{path:"video",element:a.jsx(dRe,{})},{path:":storeName",element:a.jsx(Eje,{})},{path:":storeName/product/:productId",element:a.jsx(Vje,{})},{path:"checkout",element:a.jsx(zje,{})},{path:"order-confirmation",element:a.jsx(Yje,{})},{path:":storeName/content-creation",element:a.jsx(mEe,{})},{path:":storeName/dashboard",element:a.jsx(oRe,{})},{path:"*",element:a.jsx(PV,{to:"/",replace:!0})}]}],pRe=!0,gRe=!0,yRe=OQ(mRe,{future:{v7_startTransition:pRe,v7_relativeSplatPath:gRe}}),bv=document.getElementById("root");bv._reactRoot||(bv._reactRoot=yC.createRoot(bv));const eO=bv._reactRoot;try{eO.render(a.jsx(ht.StrictMode,{children:a.jsx(qQ,{router:yRe})}))}catch(t){console.error("Application initialization failed:",t);let e="Application failed to load. Please check the console for details.";t.message.includes("VITE_")&&t.message.includes("is not set")&&(e=`Configuration Error: ${t.message}. Please ensure all required environment variables are correctly set in your .env file and the application is rebuilt if necessary.`),eO.render(a.jsx(ht.StrictMode,{children:a.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",fontFamily:"sans-serif"},children:[a.jsx("h1",{children:"Application Load Error"}),a.jsx("p",{children:e}),a.jsxs("p",{children:["Please check your ",a.jsx("code",{children:".env"})," file and ensure all necessary environment variables are configured."]})]})}))}export{Pg as $,Sc as A,O as B,Qe as C,Eu as D,Lie as E,Fn as F,Y_ as G,P3 as H,Gn as I,PE as J,kE as K,zn as L,ah as M,j3 as N,Ru as O,b2 as P,YI as Q,ht as R,Er as S,Qf as T,Zde as U,wi as V,dw as W,Hi as X,hs as Y,V3 as Z,Ya as _,Ihe as a,fg as a0,F3 as a1,jI as a2,M0 as a3,ha as a4,Wie as a5,Qie as a6,Gie as a7,Pie as a8,Fie as a9,va as aA,wje as aB,Sje as aC,Eg as aD,eoe as aE,rl as aF,N3 as aG,Lo as aH,Vie as aI,Zv as aJ,Bie as aK,soe as aa,Wx as ab,aoe as ac,zie as ad,noe as ae,v2 as af,ti as ag,Ro as ah,Fs as ai,Yr as aj,Vr as ak,Ur as al,Br as am,Qi as an,_i as ao,ni as ap,Vt as aq,Ut as ar,je as as,Ar as at,Oae as au,Rq as av,O3 as aw,Ahe as ax,Li as ay,Jie as az,vS as b,RI as c,ju as d,xje as e,Fa as f,it as g,pd as h,$p as i,a as j,Op as k,d1e as l,It as m,Du as n,pc as o,Ke as p,nw as q,p as r,ZTe as s,ro as t,$n as u,Aie as v,yje as w,bt as x,as as y,Je as z};
